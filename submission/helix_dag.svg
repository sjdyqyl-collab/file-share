<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_Two_Level_Attention_Partitioning Pages: 1 -->
<svg width="1440pt" height="201pt"
 viewBox="0.00 0.00 1440.00 201.36" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.2 0.2) rotate(0) translate(4 999.48)">
<title>Helix_Two_Level_Attention_Partitioning</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-999.48 7172.33,-999.48 7172.33,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu0</title>
<path fill="lightgray" stroke="black" d="M440,-396.87C440,-396.87 828,-396.87 828,-396.87 834,-396.87 840,-402.87 840,-408.87 840,-408.87 840,-866.48 840,-866.48 840,-872.48 834,-878.48 828,-878.48 828,-878.48 440,-878.48 440,-878.48 434,-878.48 428,-872.48 428,-866.48 428,-866.48 428,-408.87 428,-408.87 428,-402.87 434,-396.87 440,-396.87"/>
<text text-anchor="middle" x="634" y="-863.28" font-family="Arial" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="634" y="-848.28" font-family="Arial" font-size="14.00">Group 0, Slice 0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu1</title>
<path fill="lightgray" stroke="black" d="M860,-396.87C860,-396.87 1248,-396.87 1248,-396.87 1254,-396.87 1260,-402.87 1260,-408.87 1260,-408.87 1260,-739.74 1260,-739.74 1260,-745.74 1254,-751.74 1248,-751.74 1248,-751.74 860,-751.74 860,-751.74 854,-751.74 848,-745.74 848,-739.74 848,-739.74 848,-408.87 848,-408.87 848,-402.87 854,-396.87 860,-396.87"/>
<text text-anchor="middle" x="1054" y="-736.54" font-family="Arial" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1054" y="-721.54" font-family="Arial" font-size="14.00">Group 0, Slice 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu2</title>
<path fill="lightgray" stroke="black" d="M1280,-396.87C1280,-396.87 1668,-396.87 1668,-396.87 1674,-396.87 1680,-402.87 1680,-408.87 1680,-408.87 1680,-739.74 1680,-739.74 1680,-745.74 1674,-751.74 1668,-751.74 1668,-751.74 1280,-751.74 1280,-751.74 1274,-751.74 1268,-745.74 1268,-739.74 1268,-739.74 1268,-408.87 1268,-408.87 1268,-402.87 1274,-396.87 1280,-396.87"/>
<text text-anchor="middle" x="1474" y="-736.54" font-family="Arial" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1474" y="-721.54" font-family="Arial" font-size="14.00">Group 0, Slice 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu3</title>
<path fill="lightgray" stroke="black" d="M20,-396.87C20,-396.87 408,-396.87 408,-396.87 414,-396.87 420,-402.87 420,-408.87 420,-408.87 420,-739.74 420,-739.74 420,-745.74 414,-751.74 408,-751.74 408,-751.74 20,-751.74 20,-751.74 14,-751.74 8,-745.74 8,-739.74 8,-739.74 8,-408.87 8,-408.87 8,-402.87 14,-396.87 20,-396.87"/>
<text text-anchor="middle" x="214" y="-736.54" font-family="Arial" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="214" y="-721.54" font-family="Arial" font-size="14.00">Group 0, Slice 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu4</title>
<path fill="lightgray" stroke="black" d="M2764,-396.87C2764,-396.87 3152,-396.87 3152,-396.87 3158,-396.87 3164,-402.87 3164,-408.87 3164,-408.87 3164,-739.74 3164,-739.74 3164,-745.74 3158,-751.74 3152,-751.74 3152,-751.74 2764,-751.74 2764,-751.74 2758,-751.74 2752,-745.74 2752,-739.74 2752,-739.74 2752,-408.87 2752,-408.87 2752,-402.87 2758,-396.87 2764,-396.87"/>
<text text-anchor="middle" x="2958" y="-736.54" font-family="Arial" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2958" y="-721.54" font-family="Arial" font-size="14.00">Group 1, Slice 0</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu5</title>
<path fill="lightgray" stroke="black" d="M3184,-396.87C3184,-396.87 3572,-396.87 3572,-396.87 3578,-396.87 3584,-402.87 3584,-408.87 3584,-408.87 3584,-739.74 3584,-739.74 3584,-745.74 3578,-751.74 3572,-751.74 3572,-751.74 3184,-751.74 3184,-751.74 3178,-751.74 3172,-745.74 3172,-739.74 3172,-739.74 3172,-408.87 3172,-408.87 3172,-402.87 3178,-396.87 3184,-396.87"/>
<text text-anchor="middle" x="3378" y="-736.54" font-family="Arial" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3378" y="-721.54" font-family="Arial" font-size="14.00">Group 1, Slice 1</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu6</title>
<path fill="lightgray" stroke="black" d="M1812,-396.87C1812,-396.87 2200,-396.87 2200,-396.87 2206,-396.87 2212,-402.87 2212,-408.87 2212,-408.87 2212,-739.74 2212,-739.74 2212,-745.74 2206,-751.74 2200,-751.74 2200,-751.74 1812,-751.74 1812,-751.74 1806,-751.74 1800,-745.74 1800,-739.74 1800,-739.74 1800,-408.87 1800,-408.87 1800,-402.87 1806,-396.87 1812,-396.87"/>
<text text-anchor="middle" x="2006" y="-736.54" font-family="Arial" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2006" y="-721.54" font-family="Arial" font-size="14.00">Group 1, Slice 2</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu7</title>
<path fill="lightgray" stroke="black" d="M2232,-396.87C2232,-396.87 2620,-396.87 2620,-396.87 2626,-396.87 2632,-402.87 2632,-408.87 2632,-408.87 2632,-739.74 2632,-739.74 2632,-745.74 2626,-751.74 2620,-751.74 2620,-751.74 2232,-751.74 2232,-751.74 2226,-751.74 2220,-745.74 2220,-739.74 2220,-739.74 2220,-408.87 2220,-408.87 2220,-402.87 2226,-396.87 2232,-396.87"/>
<text text-anchor="middle" x="2426" y="-736.54" font-family="Arial" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2426" y="-721.54" font-family="Arial" font-size="14.00">Group 1, Slice 3</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu8</title>
<path fill="lightgray" stroke="black" d="M4976,-396.87C4976,-396.87 5364,-396.87 5364,-396.87 5370,-396.87 5376,-402.87 5376,-408.87 5376,-408.87 5376,-739.74 5376,-739.74 5376,-745.74 5370,-751.74 5364,-751.74 5364,-751.74 4976,-751.74 4976,-751.74 4970,-751.74 4964,-745.74 4964,-739.74 4964,-739.74 4964,-408.87 4964,-408.87 4964,-402.87 4970,-396.87 4976,-396.87"/>
<text text-anchor="middle" x="5170" y="-736.54" font-family="Arial" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="5170" y="-721.54" font-family="Arial" font-size="14.00">Group 2, Slice 0</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu9</title>
<path fill="lightgray" stroke="black" d="M3604,-396.87C3604,-396.87 3992,-396.87 3992,-396.87 3998,-396.87 4004,-402.87 4004,-408.87 4004,-408.87 4004,-739.74 4004,-739.74 4004,-745.74 3998,-751.74 3992,-751.74 3992,-751.74 3604,-751.74 3604,-751.74 3598,-751.74 3592,-745.74 3592,-739.74 3592,-739.74 3592,-408.87 3592,-408.87 3592,-402.87 3598,-396.87 3604,-396.87"/>
<text text-anchor="middle" x="3798" y="-736.54" font-family="Arial" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="3798" y="-721.54" font-family="Arial" font-size="14.00">Group 2, Slice 1</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu10</title>
<path fill="lightgray" stroke="black" d="M4024,-396.87C4024,-396.87 4412,-396.87 4412,-396.87 4418,-396.87 4424,-402.87 4424,-408.87 4424,-408.87 4424,-739.74 4424,-739.74 4424,-745.74 4418,-751.74 4412,-751.74 4412,-751.74 4024,-751.74 4024,-751.74 4018,-751.74 4012,-745.74 4012,-739.74 4012,-739.74 4012,-408.87 4012,-408.87 4012,-402.87 4018,-396.87 4024,-396.87"/>
<text text-anchor="middle" x="4218" y="-736.54" font-family="Arial" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="4218" y="-721.54" font-family="Arial" font-size="14.00">Group 2, Slice 2</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu11</title>
<path fill="lightgray" stroke="black" d="M4444,-396.87C4444,-396.87 4832,-396.87 4832,-396.87 4838,-396.87 4844,-402.87 4844,-408.87 4844,-408.87 4844,-739.74 4844,-739.74 4844,-745.74 4838,-751.74 4832,-751.74 4832,-751.74 4444,-751.74 4444,-751.74 4438,-751.74 4432,-745.74 4432,-739.74 4432,-739.74 4432,-408.87 4432,-408.87 4432,-402.87 4438,-396.87 4444,-396.87"/>
<text text-anchor="middle" x="4638" y="-736.54" font-family="Arial" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4638" y="-721.54" font-family="Arial" font-size="14.00">Group 2, Slice 3</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu12</title>
<path fill="lightgray" stroke="black" d="M5396,-396.87C5396,-396.87 5784,-396.87 5784,-396.87 5790,-396.87 5796,-402.87 5796,-408.87 5796,-408.87 5796,-739.74 5796,-739.74 5796,-745.74 5790,-751.74 5784,-751.74 5784,-751.74 5396,-751.74 5396,-751.74 5390,-751.74 5384,-745.74 5384,-739.74 5384,-739.74 5384,-408.87 5384,-408.87 5384,-402.87 5390,-396.87 5396,-396.87"/>
<text text-anchor="middle" x="5590" y="-736.54" font-family="Arial" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5590" y="-721.54" font-family="Arial" font-size="14.00">Group 3, Slice 0</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu13</title>
<path fill="lightgray" stroke="black" d="M5816,-396.87C5816,-396.87 6204,-396.87 6204,-396.87 6210,-396.87 6216,-402.87 6216,-408.87 6216,-408.87 6216,-739.74 6216,-739.74 6216,-745.74 6210,-751.74 6204,-751.74 6204,-751.74 5816,-751.74 5816,-751.74 5810,-751.74 5804,-745.74 5804,-739.74 5804,-739.74 5804,-408.87 5804,-408.87 5804,-402.87 5810,-396.87 5816,-396.87"/>
<text text-anchor="middle" x="6010" y="-736.54" font-family="Arial" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6010" y="-721.54" font-family="Arial" font-size="14.00">Group 3, Slice 1</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu14</title>
<path fill="lightgray" stroke="black" d="M6236,-396.87C6236,-396.87 6624,-396.87 6624,-396.87 6630,-396.87 6636,-402.87 6636,-408.87 6636,-408.87 6636,-739.74 6636,-739.74 6636,-745.74 6630,-751.74 6624,-751.74 6624,-751.74 6236,-751.74 6236,-751.74 6230,-751.74 6224,-745.74 6224,-739.74 6224,-739.74 6224,-408.87 6224,-408.87 6224,-402.87 6230,-396.87 6236,-396.87"/>
<text text-anchor="middle" x="6430" y="-736.54" font-family="Arial" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="6430" y="-721.54" font-family="Arial" font-size="14.00">Group 3, Slice 2</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu15</title>
<path fill="lightgray" stroke="black" d="M6656,-396.87C6656,-396.87 7044,-396.87 7044,-396.87 7050,-396.87 7056,-402.87 7056,-408.87 7056,-408.87 7056,-739.74 7056,-739.74 7056,-745.74 7050,-751.74 7044,-751.74 7044,-751.74 6656,-751.74 6656,-751.74 6650,-751.74 6644,-745.74 6644,-739.74 6644,-739.74 6644,-408.87 6644,-408.87 6644,-402.87 6650,-396.87 6656,-396.87"/>
<text text-anchor="middle" x="6850" y="-736.54" font-family="Arial" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="6850" y="-721.54" font-family="Arial" font-size="14.00">Group 3, Slice 3</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightblue" stroke="black" points="930.54,-995.48 671.97,-995.48 605.46,-919.48 864.03,-919.48 930.54,-995.48"/>
<text text-anchor="middle" x="768" y="-961.28" font-family="Arial" font-size="14.00">Input Tensor</text>
<text text-anchor="middle" x="768" y="-946.28" font-family="Arial" font-size="14.00">X ∈ ℝ^(1024×L×8192)</text>
</g>
<!-- broadcast -->
<g id="node2" class="node">
<title>broadcast</title>
<ellipse fill="lightgreen" stroke="black" cx="768" cy="-805.61" rx="64.19" ry="26.74"/>
<text text-anchor="middle" x="768" y="-809.41" font-family="Arial" font-size="14.00">Broadcast</text>
<text text-anchor="middle" x="768" y="-794.41" font-family="Arial" font-size="14.00">All 16 GPUs</text>
</g>
<!-- input&#45;&gt;broadcast -->
<g id="edge1" class="edge">
<title>input&#45;&gt;broadcast</title>
<path fill="none" stroke="black" d="M768,-919.43C768,-896.13 768,-866.2 768,-843.02"/>
<polygon fill="black" stroke="black" points="771.5,-842.89 768,-832.89 764.5,-842.89 771.5,-842.89"/>
<text text-anchor="middle" x="800" y="-890.28" font-family="Arial" font-size="14.00">Full tensor</text>
</g>
<!-- proj_q_0 -->
<g id="node3" class="node">
<title>proj_q_0</title>
<polygon fill="lightyellow" stroke="black" points="560,-705.74 456,-705.74 456,-652.74 560,-652.74 560,-705.74"/>
<text text-anchor="middle" x="508" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="508" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(0,0)</text>
<text text-anchor="middle" x="508" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_0 -->
<g id="edge2" class="edge">
<title>broadcast&#45;&gt;proj_q_0</title>
<path fill="none" stroke="black" d="M708.47,-795.18C670.71,-787.42 621.85,-773.98 583,-751.74 565.61,-741.79 549.16,-726.96 536.12,-713.38"/>
<polygon fill="black" stroke="black" points="538.62,-710.94 529.24,-706.01 533.5,-715.71 538.62,-710.94"/>
</g>
<!-- proj_k_0 -->
<g id="node4" class="node">
<title>proj_k_0</title>
<polygon fill="lightyellow" stroke="black" points="696,-705.74 592,-705.74 592,-652.74 696,-652.74 696,-705.74"/>
<text text-anchor="middle" x="644" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="644" y="-675.54" font-family="Arial" font-size="14.00">W_K^(0,0)</text>
<text text-anchor="middle" x="644" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_0 -->
<g id="edge3" class="edge">
<title>broadcast&#45;&gt;proj_k_0</title>
<path fill="none" stroke="black" d="M740.2,-781.32C729.85,-772.34 718.15,-761.81 708,-751.74 695.97,-739.8 683.4,-726.07 672.61,-713.84"/>
<polygon fill="black" stroke="black" points="675.02,-711.28 665.8,-706.06 669.75,-715.89 675.02,-711.28"/>
</g>
<!-- proj_v_0 -->
<g id="node5" class="node">
<title>proj_v_0</title>
<polygon fill="lightyellow" stroke="black" points="821,-705.74 717,-705.74 717,-652.74 821,-652.74 821,-705.74"/>
<text text-anchor="middle" x="769" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="769" y="-675.54" font-family="Arial" font-size="14.00">W_V^(0,0)</text>
<text text-anchor="middle" x="769" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_0 -->
<g id="edge4" class="edge">
<title>broadcast&#45;&gt;proj_v_0</title>
<path fill="none" stroke="black" d="M768.21,-778.54C768.36,-760.42 768.55,-736.06 768.71,-716.11"/>
<polygon fill="black" stroke="black" points="772.21,-715.88 768.79,-705.85 765.21,-715.82 772.21,-715.88"/>
</g>
<!-- proj_q_1 -->
<g id="node11" class="node">
<title>proj_q_1</title>
<polygon fill="lightyellow" stroke="black" points="1231,-705.74 1127,-705.74 1127,-652.74 1231,-652.74 1231,-705.74"/>
<text text-anchor="middle" x="1179" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1179" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(0,1)</text>
<text text-anchor="middle" x="1179" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_1 -->
<g id="edge12" class="edge">
<title>broadcast&#45;&gt;proj_q_1</title>
<path fill="none" stroke="black" d="M830.71,-799.32C914.54,-791.48 1058.01,-775.13 1105,-751.74 1123.22,-742.67 1139.87,-727.52 1152.75,-713.49"/>
<polygon fill="black" stroke="black" points="1155.5,-715.67 1159.5,-705.86 1150.25,-711.03 1155.5,-715.67"/>
</g>
<!-- proj_k_1 -->
<g id="node12" class="node">
<title>proj_k_1</title>
<polygon fill="lightyellow" stroke="black" points="964,-705.74 860,-705.74 860,-652.74 964,-652.74 964,-705.74"/>
<text text-anchor="middle" x="912" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="912" y="-675.54" font-family="Arial" font-size="14.00">W_K^(0,1)</text>
<text text-anchor="middle" x="912" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_1 -->
<g id="edge13" class="edge">
<title>broadcast&#45;&gt;proj_k_1</title>
<path fill="none" stroke="black" d="M802.38,-782.85C815.82,-773.81 831.07,-762.83 844,-751.74 857.57,-740.1 871.37,-726.07 882.96,-713.53"/>
<polygon fill="black" stroke="black" points="885.72,-715.7 889.88,-705.95 880.55,-710.98 885.72,-715.7"/>
</g>
<!-- proj_v_1 -->
<g id="node13" class="node">
<title>proj_v_1</title>
<polygon fill="lightyellow" stroke="black" points="1096,-705.74 992,-705.74 992,-652.74 1096,-652.74 1096,-705.74"/>
<text text-anchor="middle" x="1044" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1044" y="-675.54" font-family="Arial" font-size="14.00">W_V^(0,1)</text>
<text text-anchor="middle" x="1044" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_1 -->
<g id="edge14" class="edge">
<title>broadcast&#45;&gt;proj_v_1</title>
<path fill="none" stroke="black" d="M829.55,-797.5C872.05,-790.56 928.68,-777.15 973,-751.74 989.87,-742.07 1005.48,-727.31 1017.74,-713.71"/>
<polygon fill="black" stroke="black" points="1020.63,-715.72 1024.56,-705.88 1015.35,-711.12 1020.63,-715.72"/>
</g>
<!-- proj_q_2 -->
<g id="node19" class="node">
<title>proj_q_2</title>
<polygon fill="lightyellow" stroke="black" points="1651,-705.74 1547,-705.74 1547,-652.74 1651,-652.74 1651,-705.74"/>
<text text-anchor="middle" x="1599" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1599" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(0,2)</text>
<text text-anchor="middle" x="1599" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_2 -->
<g id="edge22" class="edge">
<title>broadcast&#45;&gt;proj_q_2</title>
<path fill="none" stroke="black" d="M832.18,-802.64C1003.45,-797.03 1462.53,-779.56 1525,-751.74 1543.86,-743.34 1560.78,-727.95 1573.66,-713.59"/>
<polygon fill="black" stroke="black" points="1576.52,-715.63 1580.39,-705.77 1571.21,-711.07 1576.52,-715.63"/>
</g>
<!-- proj_k_2 -->
<g id="node20" class="node">
<title>proj_k_2</title>
<polygon fill="lightyellow" stroke="black" points="1384,-705.74 1280,-705.74 1280,-652.74 1384,-652.74 1384,-705.74"/>
<text text-anchor="middle" x="1332" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1332" y="-675.54" font-family="Arial" font-size="14.00">W_K^(0,2)</text>
<text text-anchor="middle" x="1332" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_2 -->
<g id="edge23" class="edge">
<title>broadcast&#45;&gt;proj_k_2</title>
<path fill="none" stroke="black" d="M832.43,-803.22C948.98,-799.81 1189.64,-788.43 1264,-751.74 1281.47,-743.12 1296.83,-728.06 1308.51,-713.97"/>
<polygon fill="black" stroke="black" points="1311.48,-715.86 1314.96,-705.85 1306,-711.51 1311.48,-715.86"/>
</g>
<!-- proj_v_2 -->
<g id="node21" class="node">
<title>proj_v_2</title>
<polygon fill="lightyellow" stroke="black" points="1516,-705.74 1412,-705.74 1412,-652.74 1516,-652.74 1516,-705.74"/>
<text text-anchor="middle" x="1464" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1464" y="-675.54" font-family="Arial" font-size="14.00">W_V^(0,2)</text>
<text text-anchor="middle" x="1464" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_2 -->
<g id="edge24" class="edge">
<title>broadcast&#45;&gt;proj_v_2</title>
<path fill="none" stroke="black" d="M832.55,-804.73C971.61,-804.09 1294.82,-797.56 1393,-751.74 1411.19,-743.25 1427.34,-728.01 1439.62,-713.77"/>
<polygon fill="black" stroke="black" points="1442.36,-715.95 1446.04,-706.01 1436.97,-711.49 1442.36,-715.95"/>
</g>
<!-- proj_q_3 -->
<g id="node27" class="node">
<title>proj_q_3</title>
<polygon fill="lightyellow" stroke="black" points="136,-705.74 32,-705.74 32,-652.74 136,-652.74 136,-705.74"/>
<text text-anchor="middle" x="84" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="84" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(0,3)</text>
<text text-anchor="middle" x="84" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_3 -->
<g id="edge32" class="edge">
<title>broadcast&#45;&gt;proj_q_3</title>
<path fill="none" stroke="black" d="M703.64,-804.01C568.65,-801.94 260.55,-792.74 165,-751.74 145.04,-743.17 126.56,-727.73 112.31,-713.37"/>
<polygon fill="black" stroke="black" points="114.7,-710.81 105.25,-706.01 109.64,-715.65 114.7,-710.81"/>
</g>
<!-- proj_k_3 -->
<g id="node28" class="node">
<title>proj_k_3</title>
<polygon fill="lightyellow" stroke="black" points="278,-705.74 174,-705.74 174,-652.74 278,-652.74 278,-705.74"/>
<text text-anchor="middle" x="226" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="226" y="-675.54" font-family="Arial" font-size="14.00">W_K^(0,3)</text>
<text text-anchor="middle" x="226" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_3 -->
<g id="edge33" class="edge">
<title>broadcast&#45;&gt;proj_k_3</title>
<path fill="none" stroke="black" d="M703.82,-802.65C592.14,-798.37 367.28,-785.72 297,-751.74 278.93,-743 262.79,-727.73 250.49,-713.54"/>
<polygon fill="black" stroke="black" points="253.14,-711.26 244.06,-705.82 247.76,-715.74 253.14,-711.26"/>
</g>
<!-- proj_v_3 -->
<g id="node29" class="node">
<title>proj_v_3</title>
<polygon fill="lightyellow" stroke="black" points="410,-705.74 306,-705.74 306,-652.74 410,-652.74 410,-705.74"/>
<text text-anchor="middle" x="358" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="358" y="-675.54" font-family="Arial" font-size="14.00">W_V^(0,3)</text>
<text text-anchor="middle" x="358" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_3 -->
<g id="edge34" class="edge">
<title>broadcast&#45;&gt;proj_v_3</title>
<path fill="none" stroke="black" d="M704.88,-799.91C619.24,-792.69 471.48,-777 424,-751.74 407.17,-742.79 392.35,-727.83 381.04,-713.91"/>
<polygon fill="black" stroke="black" points="383.7,-711.63 374.8,-705.88 378.18,-715.92 383.7,-711.63"/>
</g>
<!-- proj_q_4 -->
<g id="node35" class="node">
<title>proj_q_4</title>
<polygon fill="lightyellow" stroke="black" points="3135,-705.74 3031,-705.74 3031,-652.74 3135,-652.74 3135,-705.74"/>
<text text-anchor="middle" x="3083" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3083" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(1,0)</text>
<text text-anchor="middle" x="3083" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_4 -->
<g id="edge42" class="edge">
<title>broadcast&#45;&gt;proj_q_4</title>
<path fill="none" stroke="black" d="M832.26,-804.06C1087.29,-801.7 2052.89,-791.17 2847,-760.74 2919.06,-757.98 2942.92,-780.61 3009,-751.74 3027.92,-743.47 3044.85,-728.09 3057.71,-713.71"/>
<polygon fill="black" stroke="black" points="3060.58,-715.74 3064.43,-705.87 3055.27,-711.19 3060.58,-715.74"/>
</g>
<!-- proj_k_4 -->
<g id="node36" class="node">
<title>proj_k_4</title>
<polygon fill="lightyellow" stroke="black" points="2868,-705.74 2764,-705.74 2764,-652.74 2868,-652.74 2868,-705.74"/>
<text text-anchor="middle" x="2816" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2816" y="-675.54" font-family="Arial" font-size="14.00">W_K^(1,0)</text>
<text text-anchor="middle" x="2816" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_4 -->
<g id="edge43" class="edge">
<title>broadcast&#45;&gt;proj_k_4</title>
<path fill="none" stroke="black" d="M832.17,-802.93C1047.21,-797.27 1762.1,-778.31 2353,-760.74 2478.79,-757 2512.79,-777.35 2636,-751.74 2677.53,-743.11 2721.83,-725.62 2756.1,-710.11"/>
<polygon fill="black" stroke="black" points="2757.86,-713.15 2765.48,-705.79 2754.94,-706.79 2757.86,-713.15"/>
</g>
<!-- proj_v_4 -->
<g id="node37" class="node">
<title>proj_v_4</title>
<polygon fill="lightyellow" stroke="black" points="3000,-705.74 2896,-705.74 2896,-652.74 3000,-652.74 3000,-705.74"/>
<text text-anchor="middle" x="2948" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2948" y="-675.54" font-family="Arial" font-size="14.00">W_V^(1,0)</text>
<text text-anchor="middle" x="2948" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_4 -->
<g id="edge44" class="edge">
<title>broadcast&#45;&gt;proj_v_4</title>
<path fill="none" stroke="black" d="M832.46,-804.34C1176.13,-802.76 2780.93,-793.15 2877,-751.74 2895.57,-743.74 2911.85,-728.38 2924.11,-713.95"/>
<polygon fill="black" stroke="black" points="2926.92,-716.05 2930.5,-706.08 2921.48,-711.63 2926.92,-716.05"/>
</g>
<!-- proj_q_5 -->
<g id="node43" class="node">
<title>proj_q_5</title>
<polygon fill="lightyellow" stroke="black" points="3555,-705.74 3451,-705.74 3451,-652.74 3555,-652.74 3555,-705.74"/>
<text text-anchor="middle" x="3503" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3503" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(1,1)</text>
<text text-anchor="middle" x="3503" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_5 -->
<g id="edge52" class="edge">
<title>broadcast&#45;&gt;proj_q_5</title>
<path fill="none" stroke="black" d="M832.28,-803.54C1104.23,-799 2187.13,-780.57 3077,-760.74 3233.46,-757.25 3284.67,-812.23 3429,-751.74 3448.04,-743.76 3464.98,-728.41 3477.82,-713.97"/>
<polygon fill="black" stroke="black" points="3480.71,-715.98 3484.53,-706.09 3475.38,-711.44 3480.71,-715.98"/>
</g>
<!-- proj_k_5 -->
<g id="node44" class="node">
<title>proj_k_5</title>
<polygon fill="lightyellow" stroke="black" points="3288,-705.74 3184,-705.74 3184,-652.74 3288,-652.74 3288,-705.74"/>
<text text-anchor="middle" x="3236" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3236" y="-675.54" font-family="Arial" font-size="14.00">W_K^(1,1)</text>
<text text-anchor="middle" x="3236" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_5 -->
<g id="edge53" class="edge">
<title>broadcast&#45;&gt;proj_k_5</title>
<path fill="none" stroke="black" d="M832.57,-803.71C1094.27,-799.99 2101.6,-784.81 2930,-760.74 3035.81,-757.67 3071.53,-795.3 3168,-751.74 3185.88,-743.67 3201.37,-728.51 3213.03,-714.22"/>
<polygon fill="black" stroke="black" points="3216.07,-716.01 3219.45,-705.96 3210.55,-711.71 3216.07,-716.01"/>
</g>
<!-- proj_v_5 -->
<g id="node45" class="node">
<title>proj_v_5</title>
<polygon fill="lightyellow" stroke="black" points="3420,-705.74 3316,-705.74 3316,-652.74 3420,-652.74 3420,-705.74"/>
<text text-anchor="middle" x="3368" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3368" y="-675.54" font-family="Arial" font-size="14.00">W_V^(1,1)</text>
<text text-anchor="middle" x="3368" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_5 -->
<g id="edge54" class="edge">
<title>broadcast&#45;&gt;proj_v_5</title>
<path fill="none" stroke="black" d="M832.47,-803.78C1102.89,-800.22 2172.26,-785.26 3051,-760.74 3160.36,-757.69 3196.78,-795.63 3297,-751.74 3315.52,-743.63 3331.79,-728.26 3344.07,-713.85"/>
<polygon fill="black" stroke="black" points="3346.87,-715.96 3350.47,-705.99 3341.44,-711.54 3346.87,-715.96"/>
</g>
<!-- proj_q_6 -->
<g id="node51" class="node">
<title>proj_q_6</title>
<polygon fill="lightyellow" stroke="black" points="2183,-705.74 2079,-705.74 2079,-652.74 2183,-652.74 2183,-705.74"/>
<text text-anchor="middle" x="2131" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2131" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(1,2)</text>
<text text-anchor="middle" x="2131" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_6 -->
<g id="edge62" class="edge">
<title>broadcast&#45;&gt;proj_q_6</title>
<path fill="none" stroke="black" d="M831.99,-802.64C1005.29,-797.19 1498.26,-781 1908,-760.74 1974.26,-757.46 1996.27,-778.44 2057,-751.74 2075.9,-743.43 2092.82,-728.04 2105.7,-713.67"/>
<polygon fill="black" stroke="black" points="2108.56,-715.71 2112.42,-705.84 2103.25,-711.15 2108.56,-715.71"/>
</g>
<!-- proj_k_6 -->
<g id="node52" class="node">
<title>proj_k_6</title>
<polygon fill="lightyellow" stroke="black" points="1916,-705.74 1812,-705.74 1812,-652.74 1916,-652.74 1916,-705.74"/>
<text text-anchor="middle" x="1864" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1864" y="-675.54" font-family="Arial" font-size="14.00">W_K^(1,2)</text>
<text text-anchor="middle" x="1864" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_6 -->
<g id="edge63" class="edge">
<title>broadcast&#45;&gt;proj_k_6</title>
<path fill="none" stroke="black" d="M832.21,-803.57C1012.58,-800.22 1521.28,-787.77 1684,-751.74 1725.11,-742.64 1769.07,-725.33 1803.26,-710.03"/>
<polygon fill="black" stroke="black" points="1804.97,-713.09 1812.63,-705.77 1802.08,-706.72 1804.97,-713.09"/>
</g>
<!-- proj_v_6 -->
<g id="node53" class="node">
<title>proj_v_6</title>
<polygon fill="lightyellow" stroke="black" points="2048,-705.74 1944,-705.74 1944,-652.74 2048,-652.74 2048,-705.74"/>
<text text-anchor="middle" x="1996" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1996" y="-675.54" font-family="Arial" font-size="14.00">W_V^(1,2)</text>
<text text-anchor="middle" x="1996" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_6 -->
<g id="edge64" class="edge">
<title>broadcast&#45;&gt;proj_v_6</title>
<path fill="none" stroke="black" d="M832.64,-804.39C1061.53,-803.22 1825.16,-796 1925,-751.74 1943.49,-743.54 1959.75,-728.17 1972.04,-713.78"/>
<polygon fill="black" stroke="black" points="1974.83,-715.89 1978.44,-705.93 1969.41,-711.46 1974.83,-715.89"/>
</g>
<!-- proj_q_7 -->
<g id="node59" class="node">
<title>proj_q_7</title>
<polygon fill="lightyellow" stroke="black" points="2603,-705.74 2499,-705.74 2499,-652.74 2603,-652.74 2603,-705.74"/>
<text text-anchor="middle" x="2551" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2551" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(1,3)</text>
<text text-anchor="middle" x="2551" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_7 -->
<g id="edge72" class="edge">
<title>broadcast&#45;&gt;proj_q_7</title>
<path fill="none" stroke="black" d="M832.32,-802.81C1036.32,-797.06 1687.21,-778.51 2226,-760.74 2337.57,-757.06 2374.27,-795.42 2477,-751.74 2496,-743.66 2512.93,-728.3 2525.79,-713.88"/>
<polygon fill="black" stroke="black" points="2528.67,-715.9 2532.5,-706.02 2523.34,-711.35 2528.67,-715.9"/>
</g>
<!-- proj_k_7 -->
<g id="node60" class="node">
<title>proj_k_7</title>
<polygon fill="lightyellow" stroke="black" points="2336,-705.74 2232,-705.74 2232,-652.74 2336,-652.74 2336,-705.74"/>
<text text-anchor="middle" x="2284" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2284" y="-675.54" font-family="Arial" font-size="14.00">W_K^(1,3)</text>
<text text-anchor="middle" x="2284" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_7 -->
<g id="edge73" class="edge">
<title>broadcast&#45;&gt;proj_k_7</title>
<path fill="none" stroke="black" d="M831.95,-802.36C1012.78,-796 1543.33,-777.24 1984,-760.74 2087.12,-756.88 2121.98,-794.25 2216,-751.74 2233.88,-743.66 2249.37,-728.5 2261.03,-714.21"/>
<polygon fill="black" stroke="black" points="2264.07,-716 2267.44,-705.96 2258.54,-711.71 2264.07,-716"/>
</g>
<!-- proj_v_7 -->
<g id="node61" class="node">
<title>proj_v_7</title>
<polygon fill="lightyellow" stroke="black" points="2468,-705.74 2364,-705.74 2364,-652.74 2468,-652.74 2468,-705.74"/>
<text text-anchor="middle" x="2416" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2416" y="-675.54" font-family="Arial" font-size="14.00">W_V^(1,3)</text>
<text text-anchor="middle" x="2416" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_7 -->
<g id="edge74" class="edge">
<title>broadcast&#45;&gt;proj_v_7</title>
<path fill="none" stroke="black" d="M832.26,-802.6C1024.87,-796.54 1614.29,-777.86 2103,-760.74 2210.56,-756.97 2246.42,-794.94 2345,-751.74 2363.52,-743.62 2379.79,-728.26 2392.07,-713.85"/>
<polygon fill="black" stroke="black" points="2394.87,-715.95 2398.47,-705.99 2389.44,-711.53 2394.87,-715.95"/>
</g>
<!-- proj_q_8 -->
<g id="node67" class="node">
<title>proj_q_8</title>
<polygon fill="lightyellow" stroke="black" points="5347,-705.74 5243,-705.74 5243,-652.74 5347,-652.74 5347,-705.74"/>
<text text-anchor="middle" x="5295" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5295" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(2,0)</text>
<text text-anchor="middle" x="5295" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_8 -->
<g id="edge82" class="edge">
<title>broadcast&#45;&gt;proj_q_8</title>
<path fill="none" stroke="black" d="M832.45,-804.1C1208.58,-801.05 3158.32,-784.71 4750,-760.74 4959.35,-757.59 5027.64,-832.05 5221,-751.74 5240.21,-743.76 5257.25,-728.25 5270.13,-713.71"/>
<polygon fill="black" stroke="black" points="5273.05,-715.68 5276.84,-705.78 5267.71,-711.15 5273.05,-715.68"/>
</g>
<!-- proj_k_8 -->
<g id="node68" class="node">
<title>proj_k_8</title>
<polygon fill="lightyellow" stroke="black" points="5080,-705.74 4976,-705.74 4976,-652.74 5080,-652.74 5080,-705.74"/>
<text text-anchor="middle" x="5028" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5028" y="-675.54" font-family="Arial" font-size="14.00">W_K^(2,0)</text>
<text text-anchor="middle" x="5028" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_8 -->
<g id="edge83" class="edge">
<title>broadcast&#45;&gt;proj_k_8</title>
<path fill="none" stroke="black" d="M832.6,-804.59C1202.44,-804.36 3088.97,-801.12 4629,-760.74 4726.38,-758.19 4752.72,-772.01 4848,-751.74 4889.34,-742.95 4933.47,-725.55 4967.69,-710.12"/>
<polygon fill="black" stroke="black" points="4969.43,-713.18 4977.07,-705.83 4966.52,-706.81 4969.43,-713.18"/>
</g>
<!-- proj_v_8 -->
<g id="node69" class="node">
<title>proj_v_8</title>
<polygon fill="lightyellow" stroke="black" points="5212,-705.74 5108,-705.74 5108,-652.74 5212,-652.74 5212,-705.74"/>
<text text-anchor="middle" x="5160" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5160" y="-675.54" font-family="Arial" font-size="14.00">W_V^(2,0)</text>
<text text-anchor="middle" x="5160" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_8 -->
<g id="edge84" class="edge">
<title>broadcast&#45;&gt;proj_v_8</title>
<path fill="none" stroke="black" d="M832.38,-804.23C1207.1,-801.94 3145.02,-789.17 4727,-760.74 4887.91,-757.85 4941.2,-815.43 5089,-751.74 5107.57,-743.74 5123.85,-728.38 5136.11,-713.95"/>
<polygon fill="black" stroke="black" points="5138.92,-716.05 5142.51,-706.08 5133.48,-711.63 5138.92,-716.05"/>
</g>
<!-- proj_q_9 -->
<g id="node75" class="node">
<title>proj_q_9</title>
<polygon fill="lightyellow" stroke="black" points="3975,-705.74 3871,-705.74 3871,-652.74 3975,-652.74 3975,-705.74"/>
<text text-anchor="middle" x="3923" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3923" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(2,1)</text>
<text text-anchor="middle" x="3923" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_9 -->
<g id="edge92" class="edge">
<title>broadcast&#45;&gt;proj_q_9</title>
<path fill="none" stroke="black" d="M832.51,-804.3C1143.25,-802.65 2516.89,-793.78 3642,-760.74 3734.05,-758.04 3764.39,-788.09 3849,-751.74 3867.97,-743.59 3884.9,-728.22 3897.76,-713.81"/>
<polygon fill="black" stroke="black" points="3900.63,-715.84 3904.47,-705.96 3895.31,-711.29 3900.63,-715.84"/>
</g>
<!-- proj_k_9 -->
<g id="node76" class="node">
<title>proj_k_9</title>
<polygon fill="lightyellow" stroke="black" points="3708,-705.74 3604,-705.74 3604,-652.74 3708,-652.74 3708,-705.74"/>
<text text-anchor="middle" x="3656" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3656" y="-675.54" font-family="Arial" font-size="14.00">W_K^(2,1)</text>
<text text-anchor="middle" x="3656" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_9 -->
<g id="edge93" class="edge">
<title>broadcast&#45;&gt;proj_k_9</title>
<path fill="none" stroke="black" d="M832.62,-804.81C1241.64,-805.88 3457.85,-809.02 3588,-751.74 3605.96,-743.84 3621.46,-728.7 3633.1,-714.37"/>
<polygon fill="black" stroke="black" points="3636.15,-716.15 3639.5,-706.1 3630.62,-711.87 3636.15,-716.15"/>
</g>
<!-- proj_v_9 -->
<g id="node77" class="node">
<title>proj_v_9</title>
<polygon fill="lightyellow" stroke="black" points="3840,-705.74 3736,-705.74 3736,-652.74 3840,-652.74 3840,-705.74"/>
<text text-anchor="middle" x="3788" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3788" y="-675.54" font-family="Arial" font-size="14.00">W_V^(2,1)</text>
<text text-anchor="middle" x="3788" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_9 -->
<g id="edge94" class="edge">
<title>broadcast&#45;&gt;proj_v_9</title>
<path fill="none" stroke="black" d="M832.49,-804.61C1138.04,-804.37 2470.59,-800.98 3562,-760.74 3630.96,-758.2 3654.09,-780.09 3717,-751.74 3735.44,-743.43 3751.7,-728.05 3763.99,-713.67"/>
<polygon fill="black" stroke="black" points="3766.78,-715.8 3770.4,-705.84 3761.36,-711.36 3766.78,-715.8"/>
</g>
<!-- proj_q_10 -->
<g id="node83" class="node">
<title>proj_q_10</title>
<polygon fill="lightyellow" stroke="black" points="4395,-705.74 4291,-705.74 4291,-652.74 4395,-652.74 4395,-705.74"/>
<text text-anchor="middle" x="4343" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4343" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(2,2)</text>
<text text-anchor="middle" x="4343" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_10 -->
<g id="edge102" class="edge">
<title>broadcast&#45;&gt;proj_q_10</title>
<path fill="none" stroke="black" d="M832.26,-803.99C1159.65,-800.76 2674.9,-785.15 3915,-760.74 4072.35,-757.64 4123.85,-812.57 4269,-751.74 4288.05,-743.76 4304.98,-728.41 4317.82,-713.97"/>
<polygon fill="black" stroke="black" points="4320.71,-715.98 4324.53,-706.09 4315.38,-711.44 4320.71,-715.98"/>
</g>
<!-- proj_k_10 -->
<g id="node84" class="node">
<title>proj_k_10</title>
<polygon fill="lightyellow" stroke="black" points="4128,-705.74 4024,-705.74 4024,-652.74 4128,-652.74 4128,-705.74"/>
<text text-anchor="middle" x="4076" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4076" y="-675.54" font-family="Arial" font-size="14.00">W_K^(2,2)</text>
<text text-anchor="middle" x="4076" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_10 -->
<g id="edge103" class="edge">
<title>broadcast&#45;&gt;proj_k_10</title>
<path fill="none" stroke="black" d="M832.26,-803.9C1144.02,-800.42 2530.31,-784.28 3666,-760.74 3818.02,-757.59 3869.06,-813.52 4008,-751.74 4025.93,-743.77 4041.42,-728.62 4053.08,-714.31"/>
<polygon fill="black" stroke="black" points="4056.12,-716.09 4059.48,-706.04 4050.59,-711.81 4056.12,-716.09"/>
</g>
<!-- proj_v_10 -->
<g id="node85" class="node">
<title>proj_v_10</title>
<polygon fill="lightyellow" stroke="black" points="4260,-705.74 4156,-705.74 4156,-652.74 4260,-652.74 4260,-705.74"/>
<text text-anchor="middle" x="4208" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4208" y="-675.54" font-family="Arial" font-size="14.00">W_V^(2,2)</text>
<text text-anchor="middle" x="4208" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_10 -->
<g id="edge104" class="edge">
<title>broadcast&#45;&gt;proj_v_10</title>
<path fill="none" stroke="black" d="M832.22,-803.76C1145.31,-799.62 2542.99,-780.82 3688,-760.74 3887.56,-757.24 3953.51,-830.29 4137,-751.74 4155.73,-743.72 4172.11,-728.21 4184.4,-713.67"/>
<polygon fill="black" stroke="black" points="4187.24,-715.73 4190.8,-705.75 4181.79,-711.33 4187.24,-715.73"/>
</g>
<!-- proj_q_11 -->
<g id="node91" class="node">
<title>proj_q_11</title>
<polygon fill="lightyellow" stroke="black" points="4815,-705.74 4711,-705.74 4711,-652.74 4815,-652.74 4815,-705.74"/>
<text text-anchor="middle" x="4763" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4763" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(2,3)</text>
<text text-anchor="middle" x="4763" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_11 -->
<g id="edge112" class="edge">
<title>broadcast&#45;&gt;proj_q_11</title>
<path fill="none" stroke="black" d="M832.35,-804.4C1333.59,-802.68 4596.03,-790.05 4689,-751.74 4708.23,-743.82 4725.28,-728.31 4738.15,-713.76"/>
<polygon fill="black" stroke="black" points="4741.07,-715.72 4744.86,-705.82 4735.73,-711.2 4741.07,-715.72"/>
</g>
<!-- proj_k_11 -->
<g id="node92" class="node">
<title>proj_k_11</title>
<polygon fill="lightyellow" stroke="black" points="4548,-705.74 4444,-705.74 4444,-652.74 4548,-652.74 4548,-705.74"/>
<text text-anchor="middle" x="4496" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4496" y="-675.54" font-family="Arial" font-size="14.00">W_K^(2,3)</text>
<text text-anchor="middle" x="4496" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_11 -->
<g id="edge113" class="edge">
<title>broadcast&#45;&gt;proj_k_11</title>
<path fill="none" stroke="black" d="M832.46,-803.83C1161.65,-799.8 2688.41,-780.86 3938,-760.74 4155.79,-757.23 4228.62,-839.45 4428,-751.74 4446.09,-743.78 4461.68,-728.48 4473.36,-714.06"/>
<polygon fill="black" stroke="black" points="4476.44,-715.8 4479.77,-705.74 4470.89,-711.53 4476.44,-715.8"/>
</g>
<!-- proj_v_11 -->
<g id="node93" class="node">
<title>proj_v_11</title>
<polygon fill="lightyellow" stroke="black" points="4680,-705.74 4576,-705.74 4576,-652.74 4680,-652.74 4680,-705.74"/>
<text text-anchor="middle" x="4628" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4628" y="-675.54" font-family="Arial" font-size="14.00">W_V^(2,3)</text>
<text text-anchor="middle" x="4628" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_11 -->
<g id="edge114" class="edge">
<title>broadcast&#45;&gt;proj_v_11</title>
<path fill="none" stroke="black" d="M832.44,-803.76C1163.18,-799.39 2703.44,-778.96 3964,-760.74 4227.56,-756.93 4314.43,-854.88 4557,-751.74 4575.74,-743.77 4592.13,-728.26 4604.42,-713.71"/>
<polygon fill="black" stroke="black" points="4607.26,-715.77 4610.81,-705.79 4601.81,-711.37 4607.26,-715.77"/>
</g>
<!-- proj_q_12 -->
<g id="node99" class="node">
<title>proj_q_12</title>
<polygon fill="lightyellow" stroke="black" points="5767,-705.74 5663,-705.74 5663,-652.74 5767,-652.74 5767,-705.74"/>
<text text-anchor="middle" x="5715" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5715" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(3,0)</text>
<text text-anchor="middle" x="5715" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_12 -->
<g id="edge122" class="edge">
<title>broadcast&#45;&gt;proj_q_12</title>
<path fill="none" stroke="black" d="M832.49,-804.06C1223.9,-800.67 3321.08,-782.18 5032,-760.74 5302.67,-757.35 5390.79,-855.03 5641,-751.74 5660.23,-743.8 5677.27,-728.29 5690.14,-713.74"/>
<polygon fill="black" stroke="black" points="5693.07,-715.71 5696.85,-705.81 5687.72,-711.19 5693.07,-715.71"/>
</g>
<!-- proj_k_12 -->
<g id="node100" class="node">
<title>proj_k_12</title>
<polygon fill="lightyellow" stroke="black" points="5500,-705.74 5396,-705.74 5396,-652.74 5500,-652.74 5500,-705.74"/>
<text text-anchor="middle" x="5448" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5448" y="-675.54" font-family="Arial" font-size="14.00">W_K^(3,0)</text>
<text text-anchor="middle" x="5448" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_12 -->
<g id="edge123" class="edge">
<title>broadcast&#45;&gt;proj_k_12</title>
<path fill="none" stroke="black" d="M832.46,-804.24C1221.46,-801.97 3295.75,-788.96 4988,-760.74 5162.24,-757.83 5220.65,-822.28 5380,-751.74 5397.94,-743.8 5413.44,-728.65 5425.09,-714.34"/>
<polygon fill="black" stroke="black" points="5428.14,-716.12 5431.49,-706.07 5422.6,-711.83 5428.14,-716.12"/>
</g>
<!-- proj_v_12 -->
<g id="node101" class="node">
<title>proj_v_12</title>
<polygon fill="lightyellow" stroke="black" points="5632,-705.74 5528,-705.74 5528,-652.74 5632,-652.74 5632,-705.74"/>
<text text-anchor="middle" x="5580" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5580" y="-675.54" font-family="Arial" font-size="14.00">W_V^(3,0)</text>
<text text-anchor="middle" x="5580" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_12 -->
<g id="edge124" class="edge">
<title>broadcast&#45;&gt;proj_v_12</title>
<path fill="none" stroke="black" d="M832.51,-804.13C1222.89,-801.2 3309.6,-784.95 5012,-760.74 5232.9,-757.6 5305.82,-838.49 5509,-751.74 5527.73,-743.74 5544.11,-728.23 5556.41,-713.69"/>
<polygon fill="black" stroke="black" points="5559.24,-715.75 5562.8,-705.77 5553.8,-711.35 5559.24,-715.75"/>
</g>
<!-- proj_q_13 -->
<g id="node107" class="node">
<title>proj_q_13</title>
<polygon fill="lightyellow" stroke="black" points="6187,-705.74 6083,-705.74 6083,-652.74 6187,-652.74 6187,-705.74"/>
<text text-anchor="middle" x="6135" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6135" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(3,1)</text>
<text text-anchor="middle" x="6135" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_13 -->
<g id="edge132" class="edge">
<title>broadcast&#45;&gt;proj_q_13</title>
<path fill="none" stroke="black" d="M832.4,-804.18C1247.79,-801.37 3592.32,-785 5503,-760.74 5751.01,-757.59 5831.8,-846.54 6061,-751.74 6080.22,-743.79 6097.27,-728.28 6110.14,-713.73"/>
<polygon fill="black" stroke="black" points="6113.06,-715.7 6116.85,-705.8 6107.72,-711.18 6113.06,-715.7"/>
</g>
<!-- proj_k_13 -->
<g id="node108" class="node">
<title>proj_k_13</title>
<polygon fill="lightyellow" stroke="black" points="5920,-705.74 5816,-705.74 5816,-652.74 5920,-652.74 5920,-705.74"/>
<text text-anchor="middle" x="5868" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5868" y="-675.54" font-family="Arial" font-size="14.00">W_K^(3,1)</text>
<text text-anchor="middle" x="5868" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_13 -->
<g id="edge133" class="edge">
<title>broadcast&#45;&gt;proj_k_13</title>
<path fill="none" stroke="black" d="M832.5,-803.99C1225.1,-800.24 3333.76,-779.92 5054,-760.74 5219.78,-758.89 5648.03,-818.02 5800,-751.74 5818.11,-743.84 5833.71,-728.54 5845.38,-714.12"/>
<polygon fill="black" stroke="black" points="5848.47,-715.85 5851.79,-705.79 5842.92,-711.58 5848.47,-715.85"/>
</g>
<!-- proj_v_13 -->
<g id="node109" class="node">
<title>proj_v_13</title>
<polygon fill="lightyellow" stroke="black" points="6052,-705.74 5948,-705.74 5948,-652.74 6052,-652.74 6052,-705.74"/>
<text text-anchor="middle" x="6000" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6000" y="-675.54" font-family="Arial" font-size="14.00">W_V^(3,1)</text>
<text text-anchor="middle" x="6000" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_13 -->
<g id="edge134" class="edge">
<title>broadcast&#45;&gt;proj_v_13</title>
<path fill="none" stroke="black" d="M832.47,-803.96C1225.98,-800 3344.65,-778.63 5073,-760.74 5263.22,-758.77 5753.76,-825.77 5929,-751.74 5947.76,-743.81 5964.15,-728.31 5976.43,-713.75"/>
<polygon fill="black" stroke="black" points="5979.28,-715.8 5982.83,-705.82 5973.83,-711.41 5979.28,-715.8"/>
</g>
<!-- proj_q_14 -->
<g id="node115" class="node">
<title>proj_q_14</title>
<polygon fill="lightyellow" stroke="black" points="6607,-705.74 6503,-705.74 6503,-652.74 6607,-652.74 6607,-705.74"/>
<text text-anchor="middle" x="6555" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6555" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(3,2)</text>
<text text-anchor="middle" x="6555" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_14 -->
<g id="edge142" class="edge">
<title>broadcast&#45;&gt;proj_q_14</title>
<path fill="none" stroke="black" d="M832.51,-804.04C1251.11,-800.3 3625.81,-779.06 5561,-760.74 5765.45,-758.8 6291.82,-829.28 6481,-751.74 6500.25,-743.85 6517.29,-728.35 6530.16,-713.79"/>
<polygon fill="black" stroke="black" points="6533.09,-715.75 6536.87,-705.85 6527.74,-711.23 6533.09,-715.75"/>
</g>
<!-- proj_k_14 -->
<g id="node116" class="node">
<title>proj_k_14</title>
<polygon fill="lightyellow" stroke="black" points="6340,-705.74 6236,-705.74 6236,-652.74 6340,-652.74 6340,-705.74"/>
<text text-anchor="middle" x="6288" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6288" y="-675.54" font-family="Arial" font-size="14.00">W_K^(3,2)</text>
<text text-anchor="middle" x="6288" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_14 -->
<g id="edge143" class="edge">
<title>broadcast&#45;&gt;proj_k_14</title>
<path fill="none" stroke="black" d="M832.34,-804.11C1248.65,-800.83 3604.3,-782.01 5524,-760.74 5678.67,-759.03 6078.25,-813.64 6220,-751.74 6238.11,-743.83 6253.71,-728.53 6265.38,-714.11"/>
<polygon fill="black" stroke="black" points="6268.46,-715.84 6271.79,-705.78 6262.91,-711.57 6268.46,-715.84"/>
</g>
<!-- proj_v_14 -->
<g id="node117" class="node">
<title>proj_v_14</title>
<polygon fill="lightyellow" stroke="black" points="6472,-705.74 6368,-705.74 6368,-652.74 6472,-652.74 6472,-705.74"/>
<text text-anchor="middle" x="6420" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6420" y="-675.54" font-family="Arial" font-size="14.00">W_V^(3,2)</text>
<text text-anchor="middle" x="6420" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_14 -->
<g id="edge144" class="edge">
<title>broadcast&#45;&gt;proj_v_14</title>
<path fill="none" stroke="black" d="M832.25,-804.07C1249.19,-800.53 3614.5,-780.34 5542,-760.74 5721.34,-758.92 6183.81,-821.59 6349,-751.74 6367.76,-743.81 6384.14,-728.3 6396.43,-713.75"/>
<polygon fill="black" stroke="black" points="6399.27,-715.8 6402.82,-705.82 6393.82,-711.41 6399.27,-715.8"/>
</g>
<!-- proj_q_15 -->
<g id="node123" class="node">
<title>proj_q_15</title>
<polygon fill="lightyellow" stroke="black" points="7027,-705.74 6923,-705.74 6923,-652.74 7027,-652.74 7027,-705.74"/>
<text text-anchor="middle" x="6975" y="-690.54" font-family="Arial" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6975" y="-675.54" font-family="Arial" font-size="14.00">W_Q^(3,3)</text>
<text text-anchor="middle" x="6975" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_q_15 -->
<g id="edge152" class="edge">
<title>broadcast&#45;&gt;proj_q_15</title>
<path fill="none" stroke="black" d="M832.34,-804.14C1274.81,-800.87 3913.63,-781.16 6062,-760.74 6248.45,-758.97 6728.51,-822.54 6901,-751.74 6920.24,-743.84 6937.29,-728.34 6950.16,-713.78"/>
<polygon fill="black" stroke="black" points="6953.08,-715.74 6956.86,-705.84 6947.74,-711.22 6953.08,-715.74"/>
</g>
<!-- proj_k_15 -->
<g id="node124" class="node">
<title>proj_k_15</title>
<polygon fill="lightyellow" stroke="black" points="6760,-705.74 6656,-705.74 6656,-652.74 6760,-652.74 6760,-705.74"/>
<text text-anchor="middle" x="6708" y="-690.54" font-family="Arial" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6708" y="-675.54" font-family="Arial" font-size="14.00">W_K^(3,3)</text>
<text text-anchor="middle" x="6708" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_k_15 -->
<g id="edge153" class="edge">
<title>broadcast&#45;&gt;proj_k_15</title>
<path fill="none" stroke="black" d="M832.56,-804.22C1273.79,-801.54 3891.05,-785.15 6022,-760.74 6296.68,-757.59 6388.35,-861.87 6640,-751.74 6658.1,-743.82 6673.7,-728.52 6685.37,-714.09"/>
<polygon fill="black" stroke="black" points="6688.46,-715.83 6691.78,-705.77 6682.91,-711.56 6688.46,-715.83"/>
</g>
<!-- proj_v_15 -->
<g id="node125" class="node">
<title>proj_v_15</title>
<polygon fill="lightyellow" stroke="black" points="6892,-705.74 6788,-705.74 6788,-652.74 6892,-652.74 6892,-705.74"/>
<text text-anchor="middle" x="6840" y="-690.54" font-family="Arial" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6840" y="-675.54" font-family="Arial" font-size="14.00">W_V^(3,3)</text>
<text text-anchor="middle" x="6840" y="-660.54" font-family="Arial" font-size="14.00">ℝ^(8192×128)</text>
</g>
<!-- broadcast&#45;&gt;proj_v_15 -->
<g id="edge154" class="edge">
<title>broadcast&#45;&gt;proj_v_15</title>
<path fill="none" stroke="black" d="M832.47,-804.17C1274.49,-801.16 3903.53,-782.92 6044,-760.74 6205.11,-759.07 6620.64,-814.58 6769,-751.74 6787.76,-743.8 6804.14,-728.29 6816.43,-713.74"/>
<polygon fill="black" stroke="black" points="6819.27,-715.79 6822.82,-705.81 6813.82,-711.4 6819.27,-715.79"/>
</g>
<!-- q_0 -->
<g id="node6" class="node">
<title>q_0</title>
<polygon fill="lightcyan" stroke="black" points="556,-615.74 436,-615.74 436,-577.74 556,-577.74 556,-615.74"/>
<text text-anchor="middle" x="496" y="-600.54" font-family="Arial" font-size="14.00">Q^(0,0)</text>
<text text-anchor="middle" x="496" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_0&#45;&gt;q_0 -->
<g id="edge5" class="edge">
<title>proj_q_0&#45;&gt;q_0</title>
<path fill="none" stroke="black" d="M504.14,-652.33C502.89,-643.96 501.5,-634.65 500.23,-626.11"/>
<polygon fill="black" stroke="black" points="503.69,-625.58 498.75,-616.21 496.77,-626.62 503.69,-625.58"/>
</g>
<!-- k_0 -->
<g id="node7" class="node">
<title>k_0</title>
<polygon fill="lightcyan" stroke="black" points="694,-615.74 574,-615.74 574,-577.74 694,-577.74 694,-615.74"/>
<text text-anchor="middle" x="634" y="-600.54" font-family="Arial" font-size="14.00">K^(0,0)</text>
<text text-anchor="middle" x="634" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_0&#45;&gt;k_0 -->
<g id="edge6" class="edge">
<title>proj_k_0&#45;&gt;k_0</title>
<path fill="none" stroke="black" d="M640.78,-652.33C639.75,-644.05 638.61,-634.85 637.56,-626.39"/>
<polygon fill="black" stroke="black" points="641,-625.7 636.29,-616.21 634.05,-626.56 641,-625.7"/>
</g>
<!-- v_0 -->
<g id="node8" class="node">
<title>v_0</title>
<polygon fill="lightcyan" stroke="black" points="832,-615.74 712,-615.74 712,-577.74 832,-577.74 832,-615.74"/>
<text text-anchor="middle" x="772" y="-600.54" font-family="Arial" font-size="14.00">V^(0,0)</text>
<text text-anchor="middle" x="772" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_0&#45;&gt;v_0 -->
<g id="edge7" class="edge">
<title>proj_v_0&#45;&gt;v_0</title>
<path fill="none" stroke="black" d="M769.97,-652.33C770.27,-644.05 770.62,-634.85 770.93,-626.39"/>
<polygon fill="black" stroke="black" points="774.44,-626.33 771.31,-616.21 767.44,-626.07 774.44,-626.33"/>
</g>
<!-- attn_0 -->
<g id="node9" class="node">
<title>attn_0</title>
<polygon fill="lightpink" stroke="black" points="721.5,-540.74 598.5,-540.74 598.5,-487.74 721.5,-487.74 721.5,-540.74"/>
<text text-anchor="middle" x="660" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="660" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="660" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_0&#45;&gt;attn_0 -->
<g id="edge8" class="edge">
<title>q_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M532.8,-577.67C552.23,-568.14 576.57,-556.19 598.75,-545.31"/>
<polygon fill="black" stroke="black" points="600.33,-548.43 607.77,-540.88 597.25,-542.14 600.33,-548.43"/>
</g>
<!-- k_0&#45;&gt;attn_0 -->
<g id="edge9" class="edge">
<title>k_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M639.9,-577.47C642.5,-569.42 645.65,-559.67 648.68,-550.3"/>
<polygon fill="black" stroke="black" points="652.02,-551.35 651.76,-540.76 645.35,-549.2 652.02,-551.35"/>
</g>
<!-- v_0&#45;&gt;attn_0 -->
<g id="edge10" class="edge">
<title>v_0&#45;&gt;attn_0</title>
<path fill="none" stroke="black" d="M746.87,-577.67C734.25,-568.61 718.59,-557.35 704.06,-546.91"/>
<polygon fill="black" stroke="black" points="705.83,-543.87 695.67,-540.88 701.75,-549.56 705.83,-543.87"/>
</g>
<!-- out_0 -->
<g id="node10" class="node">
<title>out_0</title>
<polygon fill="lightgreen" stroke="black" points="763,-442.87 643,-442.87 643,-404.87 763,-404.87 763,-442.87"/>
<text text-anchor="middle" x="703" y="-427.67" font-family="Arial" font-size="14.00">Attention^(0,0)</text>
<text text-anchor="middle" x="703" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_0&#45;&gt;out_0 -->
<g id="edge11" class="edge">
<title>attn_0&#45;&gt;out_0</title>
<path fill="none" stroke="black" d="M672.44,-487.68C677.86,-476.53 684.23,-463.44 689.75,-452.11"/>
<polygon fill="black" stroke="black" points="692.91,-453.6 694.14,-443.08 686.62,-450.54 692.91,-453.6"/>
</g>
<!-- concat_group_0 -->
<g id="node131" class="node">
<title>concat_group_0</title>
<polygon fill="orange" stroke="black" points="1239,-346 1110,-293 1239,-240 1368,-293 1239,-346"/>
<text text-anchor="middle" x="1239" y="-304.3" font-family="Arial" font-size="14.00">Intra&#45;group Concat</text>
<text text-anchor="middle" x="1239" y="-289.3" font-family="Arial" font-size="14.00">Group 0</text>
<text text-anchor="middle" x="1239" y="-274.3" font-family="Arial" font-size="14.00">ℝ^(1024×L×512)</text>
</g>
<!-- out_0&#45;&gt;concat_group_0 -->
<g id="edge162" class="edge">
<title>out_0&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M763.18,-408.4C857.2,-385.8 1039.47,-341.97 1149.1,-315.62"/>
<polygon fill="black" stroke="black" points="1150.24,-318.94 1159.15,-313.2 1148.61,-312.13 1150.24,-318.94"/>
<text text-anchor="middle" x="974.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 0 slice</text>
</g>
<!-- q_1 -->
<g id="node14" class="node">
<title>q_1</title>
<polygon fill="lightcyan" stroke="black" points="1252,-615.74 1132,-615.74 1132,-577.74 1252,-577.74 1252,-615.74"/>
<text text-anchor="middle" x="1192" y="-600.54" font-family="Arial" font-size="14.00">Q^(0,1)</text>
<text text-anchor="middle" x="1192" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_1&#45;&gt;q_1 -->
<g id="edge15" class="edge">
<title>proj_q_1&#45;&gt;q_1</title>
<path fill="none" stroke="black" d="M1183.18,-652.33C1184.54,-643.96 1186.04,-634.65 1187.42,-626.11"/>
<polygon fill="black" stroke="black" points="1190.88,-626.64 1189.02,-616.21 1183.97,-625.52 1190.88,-626.64"/>
</g>
<!-- k_1 -->
<g id="node15" class="node">
<title>k_1</title>
<polygon fill="lightcyan" stroke="black" points="976,-615.74 856,-615.74 856,-577.74 976,-577.74 976,-615.74"/>
<text text-anchor="middle" x="916" y="-600.54" font-family="Arial" font-size="14.00">K^(0,1)</text>
<text text-anchor="middle" x="916" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_1&#45;&gt;k_1 -->
<g id="edge16" class="edge">
<title>proj_k_1&#45;&gt;k_1</title>
<path fill="none" stroke="black" d="M913.29,-652.33C913.7,-644.05 914.16,-634.85 914.58,-626.39"/>
<polygon fill="black" stroke="black" points="918.08,-626.37 915.08,-616.21 911.09,-626.02 918.08,-626.37"/>
</g>
<!-- v_1 -->
<g id="node16" class="node">
<title>v_1</title>
<polygon fill="lightcyan" stroke="black" points="1114,-615.74 994,-615.74 994,-577.74 1114,-577.74 1114,-615.74"/>
<text text-anchor="middle" x="1054" y="-600.54" font-family="Arial" font-size="14.00">V^(0,1)</text>
<text text-anchor="middle" x="1054" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_1&#45;&gt;v_1 -->
<g id="edge17" class="edge">
<title>proj_v_1&#45;&gt;v_1</title>
<path fill="none" stroke="black" d="M1047.22,-652.33C1048.25,-644.05 1049.39,-634.85 1050.44,-626.39"/>
<polygon fill="black" stroke="black" points="1053.95,-626.56 1051.71,-616.21 1047,-625.7 1053.95,-626.56"/>
</g>
<!-- attn_1 -->
<g id="node17" class="node">
<title>attn_1</title>
<polygon fill="lightpink" stroke="black" points="1127.5,-540.74 1004.5,-540.74 1004.5,-487.74 1127.5,-487.74 1127.5,-540.74"/>
<text text-anchor="middle" x="1066" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="1066" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="1066" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_1&#45;&gt;attn_1 -->
<g id="edge18" class="edge">
<title>q_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M1163.72,-577.67C1149.27,-568.44 1131.26,-556.93 1114.66,-546.33"/>
<polygon fill="black" stroke="black" points="1116.44,-543.31 1106.13,-540.88 1112.67,-549.21 1116.44,-543.31"/>
</g>
<!-- k_1&#45;&gt;attn_1 -->
<g id="edge19" class="edge">
<title>k_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M949.66,-577.67C967.19,-568.27 989.1,-556.51 1009.16,-545.74"/>
<polygon fill="black" stroke="black" points="1011.07,-548.69 1018.23,-540.88 1007.76,-542.52 1011.07,-548.69"/>
</g>
<!-- v_1&#45;&gt;attn_1 -->
<g id="edge20" class="edge">
<title>v_1&#45;&gt;attn_1</title>
<path fill="none" stroke="black" d="M1056.72,-577.47C1057.9,-569.59 1059.32,-560.08 1060.69,-550.89"/>
<polygon fill="black" stroke="black" points="1064.18,-551.16 1062.2,-540.76 1057.26,-550.13 1064.18,-551.16"/>
</g>
<!-- out_1 -->
<g id="node18" class="node">
<title>out_1</title>
<polygon fill="lightgreen" stroke="black" points="1212,-442.87 1092,-442.87 1092,-404.87 1212,-404.87 1212,-442.87"/>
<text text-anchor="middle" x="1152" y="-427.67" font-family="Arial" font-size="14.00">Attention^(0,1)</text>
<text text-anchor="middle" x="1152" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_1&#45;&gt;out_1 -->
<g id="edge21" class="edge">
<title>attn_1&#45;&gt;out_1</title>
<path fill="none" stroke="black" d="M1090.87,-487.68C1102.27,-475.97 1115.74,-462.13 1127.13,-450.42"/>
<polygon fill="black" stroke="black" points="1129.81,-452.69 1134.28,-443.08 1124.8,-447.81 1129.81,-452.69"/>
</g>
<!-- out_1&#45;&gt;concat_group_0 -->
<g id="edge163" class="edge">
<title>out_1&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1164.28,-404.68C1175.03,-388.75 1191.16,-364.86 1205.68,-343.35"/>
<polygon fill="black" stroke="black" points="1208.67,-345.18 1211.37,-334.93 1202.87,-341.26 1208.67,-345.18"/>
<text text-anchor="middle" x="1226.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 1 slice</text>
</g>
<!-- q_2 -->
<g id="node22" class="node">
<title>q_2</title>
<polygon fill="lightcyan" stroke="black" points="1672,-615.74 1552,-615.74 1552,-577.74 1672,-577.74 1672,-615.74"/>
<text text-anchor="middle" x="1612" y="-600.54" font-family="Arial" font-size="14.00">Q^(0,2)</text>
<text text-anchor="middle" x="1612" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_2&#45;&gt;q_2 -->
<g id="edge25" class="edge">
<title>proj_q_2&#45;&gt;q_2</title>
<path fill="none" stroke="black" d="M1603.18,-652.33C1604.54,-643.96 1606.04,-634.65 1607.42,-626.11"/>
<polygon fill="black" stroke="black" points="1610.88,-626.64 1609.02,-616.21 1603.97,-625.52 1610.88,-626.64"/>
</g>
<!-- k_2 -->
<g id="node23" class="node">
<title>k_2</title>
<polygon fill="lightcyan" stroke="black" points="1396,-615.74 1276,-615.74 1276,-577.74 1396,-577.74 1396,-615.74"/>
<text text-anchor="middle" x="1336" y="-600.54" font-family="Arial" font-size="14.00">K^(0,2)</text>
<text text-anchor="middle" x="1336" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_2&#45;&gt;k_2 -->
<g id="edge26" class="edge">
<title>proj_k_2&#45;&gt;k_2</title>
<path fill="none" stroke="black" d="M1333.29,-652.33C1333.7,-644.05 1334.16,-634.85 1334.58,-626.39"/>
<polygon fill="black" stroke="black" points="1338.08,-626.37 1335.08,-616.21 1331.09,-626.02 1338.08,-626.37"/>
</g>
<!-- v_2 -->
<g id="node24" class="node">
<title>v_2</title>
<polygon fill="lightcyan" stroke="black" points="1534,-615.74 1414,-615.74 1414,-577.74 1534,-577.74 1534,-615.74"/>
<text text-anchor="middle" x="1474" y="-600.54" font-family="Arial" font-size="14.00">V^(0,2)</text>
<text text-anchor="middle" x="1474" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_2&#45;&gt;v_2 -->
<g id="edge27" class="edge">
<title>proj_v_2&#45;&gt;v_2</title>
<path fill="none" stroke="black" d="M1467.22,-652.33C1468.25,-644.05 1469.39,-634.85 1470.44,-626.39"/>
<polygon fill="black" stroke="black" points="1473.95,-626.56 1471.71,-616.21 1467,-625.7 1473.95,-626.56"/>
</g>
<!-- attn_2 -->
<g id="node25" class="node">
<title>attn_2</title>
<polygon fill="lightpink" stroke="black" points="1434.5,-540.74 1311.5,-540.74 1311.5,-487.74 1434.5,-487.74 1434.5,-540.74"/>
<text text-anchor="middle" x="1373" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="1373" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="1373" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_2&#45;&gt;attn_2 -->
<g id="edge28" class="edge">
<title>q_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M1558.36,-577.67C1524.76,-566.36 1481.05,-551.63 1444.51,-539.33"/>
<polygon fill="black" stroke="black" points="1445.49,-535.96 1434.9,-536.09 1443.26,-542.6 1445.49,-535.96"/>
</g>
<!-- k_2&#45;&gt;attn_2 -->
<g id="edge29" class="edge">
<title>k_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M1344.4,-577.47C1348.14,-569.33 1352.68,-559.46 1357.02,-550"/>
<polygon fill="black" stroke="black" points="1360.28,-551.31 1361.27,-540.76 1353.92,-548.38 1360.28,-551.31"/>
</g>
<!-- v_2&#45;&gt;attn_2 -->
<g id="edge30" class="edge">
<title>v_2&#45;&gt;attn_2</title>
<path fill="none" stroke="black" d="M1451.33,-577.67C1440.06,-568.69 1426.1,-557.56 1413.1,-547.2"/>
<polygon fill="black" stroke="black" points="1415.17,-544.37 1405.17,-540.88 1410.8,-549.85 1415.17,-544.37"/>
</g>
<!-- out_2 -->
<g id="node26" class="node">
<title>out_2</title>
<polygon fill="lightgreen" stroke="black" points="1414,-442.87 1294,-442.87 1294,-404.87 1414,-404.87 1414,-442.87"/>
<text text-anchor="middle" x="1354" y="-427.67" font-family="Arial" font-size="14.00">Attention^(0,2)</text>
<text text-anchor="middle" x="1354" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_2&#45;&gt;out_2 -->
<g id="edge31" class="edge">
<title>attn_2&#45;&gt;out_2</title>
<path fill="none" stroke="black" d="M1367.5,-487.68C1365.18,-476.86 1362.46,-464.22 1360.08,-453.13"/>
<polygon fill="black" stroke="black" points="1363.44,-452.12 1357.92,-443.08 1356.6,-453.59 1363.44,-452.12"/>
</g>
<!-- out_2&#45;&gt;concat_group_0 -->
<g id="edge164" class="edge">
<title>out_2&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1337.77,-404.68C1322.81,-387.92 1299.99,-362.35 1280.05,-340"/>
<polygon fill="black" stroke="black" points="1282.4,-337.38 1273.13,-332.25 1277.18,-342.04 1282.4,-337.38"/>
<text text-anchor="middle" x="1349.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 2 slice</text>
</g>
<!-- q_3 -->
<g id="node30" class="node">
<title>q_3</title>
<polygon fill="lightcyan" stroke="black" points="136,-615.74 16,-615.74 16,-577.74 136,-577.74 136,-615.74"/>
<text text-anchor="middle" x="76" y="-600.54" font-family="Arial" font-size="14.00">Q^(0,3)</text>
<text text-anchor="middle" x="76" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_3&#45;&gt;q_3 -->
<g id="edge35" class="edge">
<title>proj_q_3&#45;&gt;q_3</title>
<path fill="none" stroke="black" d="M81.42,-652.33C80.6,-644.05 79.69,-634.85 78.85,-626.39"/>
<polygon fill="black" stroke="black" points="82.31,-625.81 77.84,-616.21 75.34,-626.51 82.31,-625.81"/>
</g>
<!-- k_3 -->
<g id="node31" class="node">
<title>k_3</title>
<polygon fill="lightcyan" stroke="black" points="274,-615.74 154,-615.74 154,-577.74 274,-577.74 274,-615.74"/>
<text text-anchor="middle" x="214" y="-600.54" font-family="Arial" font-size="14.00">K^(0,3)</text>
<text text-anchor="middle" x="214" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_3&#45;&gt;k_3 -->
<g id="edge36" class="edge">
<title>proj_k_3&#45;&gt;k_3</title>
<path fill="none" stroke="black" d="M222.14,-652.33C220.89,-643.96 219.5,-634.65 218.23,-626.11"/>
<polygon fill="black" stroke="black" points="221.69,-625.58 216.75,-616.21 214.77,-626.62 221.69,-625.58"/>
</g>
<!-- v_3 -->
<g id="node32" class="node">
<title>v_3</title>
<polygon fill="lightcyan" stroke="black" points="412,-615.74 292,-615.74 292,-577.74 412,-577.74 412,-615.74"/>
<text text-anchor="middle" x="352" y="-600.54" font-family="Arial" font-size="14.00">V^(0,3)</text>
<text text-anchor="middle" x="352" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_3&#45;&gt;v_3 -->
<g id="edge37" class="edge">
<title>proj_v_3&#45;&gt;v_3</title>
<path fill="none" stroke="black" d="M356.07,-652.33C355.45,-644.05 354.77,-634.85 354.14,-626.39"/>
<polygon fill="black" stroke="black" points="357.61,-625.92 353.38,-616.21 350.63,-626.44 357.61,-625.92"/>
</g>
<!-- attn_3 -->
<g id="node33" class="node">
<title>attn_3</title>
<polygon fill="lightpink" stroke="black" points="301.5,-540.74 178.5,-540.74 178.5,-487.74 301.5,-487.74 301.5,-540.74"/>
<text text-anchor="middle" x="240" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="240" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="240" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_3&#45;&gt;attn_3 -->
<g id="edge38" class="edge">
<title>q_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M112.8,-577.67C132.23,-568.14 156.57,-556.19 178.75,-545.31"/>
<polygon fill="black" stroke="black" points="180.33,-548.43 187.77,-540.88 177.25,-542.14 180.33,-548.43"/>
</g>
<!-- k_3&#45;&gt;attn_3 -->
<g id="edge39" class="edge">
<title>k_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M219.9,-577.47C222.5,-569.42 225.65,-559.67 228.68,-550.3"/>
<polygon fill="black" stroke="black" points="232.02,-551.35 231.76,-540.76 225.35,-549.2 232.02,-551.35"/>
</g>
<!-- v_3&#45;&gt;attn_3 -->
<g id="edge40" class="edge">
<title>v_3&#45;&gt;attn_3</title>
<path fill="none" stroke="black" d="M326.87,-577.67C314.25,-568.61 298.59,-557.35 284.06,-546.91"/>
<polygon fill="black" stroke="black" points="285.83,-543.87 275.67,-540.88 281.75,-549.56 285.83,-543.87"/>
</g>
<!-- out_3 -->
<g id="node34" class="node">
<title>out_3</title>
<polygon fill="lightgreen" stroke="black" points="403,-442.87 283,-442.87 283,-404.87 403,-404.87 403,-442.87"/>
<text text-anchor="middle" x="343" y="-427.67" font-family="Arial" font-size="14.00">Attention^(0,3)</text>
<text text-anchor="middle" x="343" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_3&#45;&gt;out_3 -->
<g id="edge41" class="edge">
<title>attn_3&#45;&gt;out_3</title>
<path fill="none" stroke="black" d="M269.79,-487.68C283.7,-475.75 300.19,-461.6 314,-449.75"/>
<polygon fill="black" stroke="black" points="316.46,-452.25 321.78,-443.08 311.91,-446.94 316.46,-452.25"/>
</g>
<!-- out_3&#45;&gt;concat_group_0 -->
<g id="edge165" class="edge">
<title>out_3&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M394.46,-404.78C404.19,-401.81 414.34,-399.01 424,-396.87 668.05,-342.79 959.97,-314.54 1119.8,-302.1"/>
<polygon fill="black" stroke="black" points="1120.43,-305.56 1130.13,-301.31 1119.89,-298.58 1120.43,-305.56"/>
<text text-anchor="middle" x="614.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 3 slice</text>
</g>
<!-- q_4 -->
<g id="node38" class="node">
<title>q_4</title>
<polygon fill="lightcyan" stroke="black" points="3156,-615.74 3036,-615.74 3036,-577.74 3156,-577.74 3156,-615.74"/>
<text text-anchor="middle" x="3096" y="-600.54" font-family="Arial" font-size="14.00">Q^(1,0)</text>
<text text-anchor="middle" x="3096" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_4&#45;&gt;q_4 -->
<g id="edge45" class="edge">
<title>proj_q_4&#45;&gt;q_4</title>
<path fill="none" stroke="black" d="M3087.18,-652.33C3088.54,-643.96 3090.04,-634.65 3091.42,-626.11"/>
<polygon fill="black" stroke="black" points="3094.88,-626.64 3093.02,-616.21 3087.97,-625.52 3094.88,-626.64"/>
</g>
<!-- k_4 -->
<g id="node39" class="node">
<title>k_4</title>
<polygon fill="lightcyan" stroke="black" points="2880,-615.74 2760,-615.74 2760,-577.74 2880,-577.74 2880,-615.74"/>
<text text-anchor="middle" x="2820" y="-600.54" font-family="Arial" font-size="14.00">K^(1,0)</text>
<text text-anchor="middle" x="2820" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_4&#45;&gt;k_4 -->
<g id="edge46" class="edge">
<title>proj_k_4&#45;&gt;k_4</title>
<path fill="none" stroke="black" d="M2817.29,-652.33C2817.7,-644.05 2818.16,-634.85 2818.58,-626.39"/>
<polygon fill="black" stroke="black" points="2822.08,-626.37 2819.08,-616.21 2815.09,-626.02 2822.08,-626.37"/>
</g>
<!-- v_4 -->
<g id="node40" class="node">
<title>v_4</title>
<polygon fill="lightcyan" stroke="black" points="3018,-615.74 2898,-615.74 2898,-577.74 3018,-577.74 3018,-615.74"/>
<text text-anchor="middle" x="2958" y="-600.54" font-family="Arial" font-size="14.00">V^(1,0)</text>
<text text-anchor="middle" x="2958" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_4&#45;&gt;v_4 -->
<g id="edge47" class="edge">
<title>proj_v_4&#45;&gt;v_4</title>
<path fill="none" stroke="black" d="M2951.22,-652.33C2952.25,-644.05 2953.39,-634.85 2954.44,-626.39"/>
<polygon fill="black" stroke="black" points="2957.95,-626.56 2955.71,-616.21 2951,-625.7 2957.95,-626.56"/>
</g>
<!-- attn_4 -->
<g id="node41" class="node">
<title>attn_4</title>
<polygon fill="lightpink" stroke="black" points="2968.5,-540.74 2845.5,-540.74 2845.5,-487.74 2968.5,-487.74 2968.5,-540.74"/>
<text text-anchor="middle" x="2907" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="2907" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="2907" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_4&#45;&gt;attn_4 -->
<g id="edge48" class="edge">
<title>q_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M3053.58,-577.67C3030.9,-568.01 3002.4,-555.87 2976.57,-544.87"/>
<polygon fill="black" stroke="black" points="2977.76,-541.58 2967.19,-540.88 2975.02,-548.02 2977.76,-541.58"/>
</g>
<!-- k_4&#45;&gt;attn_4 -->
<g id="edge49" class="edge">
<title>k_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M2839.74,-577.47C2849.27,-568.65 2861,-557.8 2871.98,-547.65"/>
<polygon fill="black" stroke="black" points="2874.46,-550.12 2879.42,-540.76 2869.71,-544.98 2874.46,-550.12"/>
</g>
<!-- v_4&#45;&gt;attn_4 -->
<g id="edge50" class="edge">
<title>v_4&#45;&gt;attn_4</title>
<path fill="none" stroke="black" d="M2946.43,-577.47C2941.16,-569.16 2934.75,-559.05 2928.65,-549.41"/>
<polygon fill="black" stroke="black" points="2931.47,-547.33 2923.17,-540.76 2925.56,-551.08 2931.47,-547.33"/>
</g>
<!-- out_4 -->
<g id="node42" class="node">
<title>out_4</title>
<polygon fill="lightgreen" stroke="black" points="2891,-442.87 2771,-442.87 2771,-404.87 2891,-404.87 2891,-442.87"/>
<text text-anchor="middle" x="2831" y="-427.67" font-family="Arial" font-size="14.00">Attention^(1,0)</text>
<text text-anchor="middle" x="2831" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_4&#45;&gt;out_4 -->
<g id="edge51" class="edge">
<title>attn_4&#45;&gt;out_4</title>
<path fill="none" stroke="black" d="M2885.02,-487.68C2875.04,-476.08 2863.27,-462.39 2853.26,-450.76"/>
<polygon fill="black" stroke="black" points="2855.83,-448.38 2846.66,-443.08 2850.53,-452.94 2855.83,-448.38"/>
</g>
<!-- concat_group_1 -->
<g id="node132" class="node">
<title>concat_group_1</title>
<polygon fill="orange" stroke="black" points="2754,-346 2625,-293 2754,-240 2883,-293 2754,-346"/>
<text text-anchor="middle" x="2754" y="-304.3" font-family="Arial" font-size="14.00">Intra&#45;group Concat</text>
<text text-anchor="middle" x="2754" y="-289.3" font-family="Arial" font-size="14.00">Group 1</text>
<text text-anchor="middle" x="2754" y="-274.3" font-family="Arial" font-size="14.00">ℝ^(1024×L×512)</text>
</g>
<!-- out_4&#45;&gt;concat_group_1 -->
<g id="edge166" class="edge">
<title>out_4&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2820.13,-404.68C2810.8,-389.07 2796.9,-365.8 2784.25,-344.63"/>
<polygon fill="black" stroke="black" points="2787.24,-342.81 2779.11,-336.02 2781.23,-346.4 2787.24,-342.81"/>
<text text-anchor="middle" x="2839.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 4 slice</text>
</g>
<!-- q_5 -->
<g id="node46" class="node">
<title>q_5</title>
<polygon fill="lightcyan" stroke="black" points="3576,-615.74 3456,-615.74 3456,-577.74 3576,-577.74 3576,-615.74"/>
<text text-anchor="middle" x="3516" y="-600.54" font-family="Arial" font-size="14.00">Q^(1,1)</text>
<text text-anchor="middle" x="3516" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_5&#45;&gt;q_5 -->
<g id="edge55" class="edge">
<title>proj_q_5&#45;&gt;q_5</title>
<path fill="none" stroke="black" d="M3507.18,-652.33C3508.54,-643.96 3510.04,-634.65 3511.42,-626.11"/>
<polygon fill="black" stroke="black" points="3514.88,-626.64 3513.02,-616.21 3507.97,-625.52 3514.88,-626.64"/>
</g>
<!-- k_5 -->
<g id="node47" class="node">
<title>k_5</title>
<polygon fill="lightcyan" stroke="black" points="3300,-615.74 3180,-615.74 3180,-577.74 3300,-577.74 3300,-615.74"/>
<text text-anchor="middle" x="3240" y="-600.54" font-family="Arial" font-size="14.00">K^(1,1)</text>
<text text-anchor="middle" x="3240" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_5&#45;&gt;k_5 -->
<g id="edge56" class="edge">
<title>proj_k_5&#45;&gt;k_5</title>
<path fill="none" stroke="black" d="M3237.29,-652.33C3237.7,-644.05 3238.16,-634.85 3238.58,-626.39"/>
<polygon fill="black" stroke="black" points="3242.08,-626.37 3239.08,-616.21 3235.09,-626.02 3242.08,-626.37"/>
</g>
<!-- v_5 -->
<g id="node48" class="node">
<title>v_5</title>
<polygon fill="lightcyan" stroke="black" points="3438,-615.74 3318,-615.74 3318,-577.74 3438,-577.74 3438,-615.74"/>
<text text-anchor="middle" x="3378" y="-600.54" font-family="Arial" font-size="14.00">V^(1,1)</text>
<text text-anchor="middle" x="3378" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_5&#45;&gt;v_5 -->
<g id="edge57" class="edge">
<title>proj_v_5&#45;&gt;v_5</title>
<path fill="none" stroke="black" d="M3371.22,-652.33C3372.25,-644.05 3373.39,-634.85 3374.44,-626.39"/>
<polygon fill="black" stroke="black" points="3377.95,-626.56 3375.71,-616.21 3371,-625.7 3377.95,-626.56"/>
</g>
<!-- attn_5 -->
<g id="node49" class="node">
<title>attn_5</title>
<polygon fill="lightpink" stroke="black" points="3397.5,-540.74 3274.5,-540.74 3274.5,-487.74 3397.5,-487.74 3397.5,-540.74"/>
<text text-anchor="middle" x="3336" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="3336" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="3336" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_5&#45;&gt;attn_5 -->
<g id="edge58" class="edge">
<title>q_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M3475.6,-577.67C3454.1,-568.06 3427.09,-555.98 3402.58,-545.02"/>
<polygon fill="black" stroke="black" points="3403.88,-541.77 3393.33,-540.88 3401.03,-548.16 3403.88,-541.77"/>
</g>
<!-- k_5&#45;&gt;attn_5 -->
<g id="edge59" class="edge">
<title>k_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M3261.78,-577.47C3272.4,-568.57 3285.49,-557.59 3297.7,-547.35"/>
<polygon fill="black" stroke="black" points="3300.16,-549.86 3305.57,-540.76 3295.66,-544.5 3300.16,-549.86"/>
</g>
<!-- v_5&#45;&gt;attn_5 -->
<g id="edge60" class="edge">
<title>v_5&#45;&gt;attn_5</title>
<path fill="none" stroke="black" d="M3368.47,-577.47C3364.18,-569.25 3358.96,-559.25 3353.98,-549.7"/>
<polygon fill="black" stroke="black" points="3357.04,-548 3349.31,-540.76 3350.84,-551.24 3357.04,-548"/>
</g>
<!-- out_5 -->
<g id="node50" class="node">
<title>out_5</title>
<polygon fill="lightgreen" stroke="black" points="3336,-442.87 3216,-442.87 3216,-404.87 3336,-404.87 3336,-442.87"/>
<text text-anchor="middle" x="3276" y="-427.67" font-family="Arial" font-size="14.00">Attention^(1,1)</text>
<text text-anchor="middle" x="3276" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_5&#45;&gt;out_5 -->
<g id="edge61" class="edge">
<title>attn_5&#45;&gt;out_5</title>
<path fill="none" stroke="black" d="M3318.65,-487.68C3310.92,-476.31 3301.83,-462.92 3294.03,-451.43"/>
<polygon fill="black" stroke="black" points="3296.88,-449.39 3288.36,-443.08 3291.09,-453.32 3296.88,-449.39"/>
</g>
<!-- out_5&#45;&gt;concat_group_1 -->
<g id="edge167" class="edge">
<title>out_5&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3215.87,-408.02C3124.36,-385.43 2949.58,-342.28 2843.23,-316.03"/>
<polygon fill="black" stroke="black" points="2844.02,-312.62 2833.48,-313.62 2842.35,-319.42 2844.02,-312.62"/>
<text text-anchor="middle" x="3128.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 5 slice</text>
</g>
<!-- q_6 -->
<g id="node54" class="node">
<title>q_6</title>
<polygon fill="lightcyan" stroke="black" points="2204,-615.74 2084,-615.74 2084,-577.74 2204,-577.74 2204,-615.74"/>
<text text-anchor="middle" x="2144" y="-600.54" font-family="Arial" font-size="14.00">Q^(1,2)</text>
<text text-anchor="middle" x="2144" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_6&#45;&gt;q_6 -->
<g id="edge65" class="edge">
<title>proj_q_6&#45;&gt;q_6</title>
<path fill="none" stroke="black" d="M2135.18,-652.33C2136.54,-643.96 2138.04,-634.65 2139.42,-626.11"/>
<polygon fill="black" stroke="black" points="2142.88,-626.64 2141.02,-616.21 2135.97,-625.52 2142.88,-626.64"/>
</g>
<!-- k_6 -->
<g id="node55" class="node">
<title>k_6</title>
<polygon fill="lightcyan" stroke="black" points="1928,-615.74 1808,-615.74 1808,-577.74 1928,-577.74 1928,-615.74"/>
<text text-anchor="middle" x="1868" y="-600.54" font-family="Arial" font-size="14.00">K^(1,2)</text>
<text text-anchor="middle" x="1868" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_6&#45;&gt;k_6 -->
<g id="edge66" class="edge">
<title>proj_k_6&#45;&gt;k_6</title>
<path fill="none" stroke="black" d="M1865.29,-652.33C1865.7,-644.05 1866.16,-634.85 1866.58,-626.39"/>
<polygon fill="black" stroke="black" points="1870.08,-626.37 1867.08,-616.21 1863.09,-626.02 1870.08,-626.37"/>
</g>
<!-- v_6 -->
<g id="node56" class="node">
<title>v_6</title>
<polygon fill="lightcyan" stroke="black" points="2066,-615.74 1946,-615.74 1946,-577.74 2066,-577.74 2066,-615.74"/>
<text text-anchor="middle" x="2006" y="-600.54" font-family="Arial" font-size="14.00">V^(1,2)</text>
<text text-anchor="middle" x="2006" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_6&#45;&gt;v_6 -->
<g id="edge67" class="edge">
<title>proj_v_6&#45;&gt;v_6</title>
<path fill="none" stroke="black" d="M1999.22,-652.33C2000.25,-644.05 2001.39,-634.85 2002.44,-626.39"/>
<polygon fill="black" stroke="black" points="2005.95,-626.56 2003.71,-616.21 1999,-625.7 2005.95,-626.56"/>
</g>
<!-- attn_6 -->
<g id="node57" class="node">
<title>attn_6</title>
<polygon fill="lightpink" stroke="black" points="2093.5,-540.74 1970.5,-540.74 1970.5,-487.74 2093.5,-487.74 2093.5,-540.74"/>
<text text-anchor="middle" x="2032" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="2032" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="2032" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_6&#45;&gt;attn_6 -->
<g id="edge68" class="edge">
<title>q_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M2118.87,-577.67C2106.25,-568.61 2090.59,-557.35 2076.06,-546.91"/>
<polygon fill="black" stroke="black" points="2077.83,-543.87 2067.67,-540.88 2073.75,-549.56 2077.83,-543.87"/>
</g>
<!-- k_6&#45;&gt;attn_6 -->
<g id="edge69" class="edge">
<title>k_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M1904.8,-577.67C1924.23,-568.14 1948.57,-556.19 1970.75,-545.31"/>
<polygon fill="black" stroke="black" points="1972.33,-548.43 1979.77,-540.88 1969.25,-542.14 1972.33,-548.43"/>
</g>
<!-- v_6&#45;&gt;attn_6 -->
<g id="edge70" class="edge">
<title>v_6&#45;&gt;attn_6</title>
<path fill="none" stroke="black" d="M2011.9,-577.47C2014.5,-569.42 2017.65,-559.67 2020.68,-550.3"/>
<polygon fill="black" stroke="black" points="2024.02,-551.35 2023.76,-540.76 2017.35,-549.2 2024.02,-551.35"/>
</g>
<!-- out_6 -->
<g id="node58" class="node">
<title>out_6</title>
<polygon fill="lightgreen" stroke="black" points="2195,-442.87 2075,-442.87 2075,-404.87 2195,-404.87 2195,-442.87"/>
<text text-anchor="middle" x="2135" y="-427.67" font-family="Arial" font-size="14.00">Attention^(1,2)</text>
<text text-anchor="middle" x="2135" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_6&#45;&gt;out_6 -->
<g id="edge71" class="edge">
<title>attn_6&#45;&gt;out_6</title>
<path fill="none" stroke="black" d="M2061.79,-487.68C2075.7,-475.75 2092.19,-461.6 2106,-449.75"/>
<polygon fill="black" stroke="black" points="2108.46,-452.25 2113.78,-443.08 2103.91,-446.94 2108.46,-452.25"/>
</g>
<!-- out_6&#45;&gt;concat_group_1 -->
<g id="edge168" class="edge">
<title>out_6&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2188.32,-404.74C2197.5,-401.91 2206.98,-399.17 2216,-396.87 2365.89,-358.63 2542.52,-327.45 2651.39,-309.8"/>
<polygon fill="black" stroke="black" points="2652.07,-313.24 2661.38,-308.19 2650.95,-306.33 2652.07,-313.24"/>
<text text-anchor="middle" x="2383.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 6 slice</text>
</g>
<!-- q_7 -->
<g id="node62" class="node">
<title>q_7</title>
<polygon fill="lightcyan" stroke="black" points="2624,-615.74 2504,-615.74 2504,-577.74 2624,-577.74 2624,-615.74"/>
<text text-anchor="middle" x="2564" y="-600.54" font-family="Arial" font-size="14.00">Q^(1,3)</text>
<text text-anchor="middle" x="2564" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_7&#45;&gt;q_7 -->
<g id="edge75" class="edge">
<title>proj_q_7&#45;&gt;q_7</title>
<path fill="none" stroke="black" d="M2555.18,-652.33C2556.54,-643.96 2558.04,-634.65 2559.42,-626.11"/>
<polygon fill="black" stroke="black" points="2562.88,-626.64 2561.02,-616.21 2555.97,-625.52 2562.88,-626.64"/>
</g>
<!-- k_7 -->
<g id="node63" class="node">
<title>k_7</title>
<polygon fill="lightcyan" stroke="black" points="2348,-615.74 2228,-615.74 2228,-577.74 2348,-577.74 2348,-615.74"/>
<text text-anchor="middle" x="2288" y="-600.54" font-family="Arial" font-size="14.00">K^(1,3)</text>
<text text-anchor="middle" x="2288" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_7&#45;&gt;k_7 -->
<g id="edge76" class="edge">
<title>proj_k_7&#45;&gt;k_7</title>
<path fill="none" stroke="black" d="M2285.29,-652.33C2285.7,-644.05 2286.16,-634.85 2286.58,-626.39"/>
<polygon fill="black" stroke="black" points="2290.08,-626.37 2287.08,-616.21 2283.09,-626.02 2290.08,-626.37"/>
</g>
<!-- v_7 -->
<g id="node64" class="node">
<title>v_7</title>
<polygon fill="lightcyan" stroke="black" points="2486,-615.74 2366,-615.74 2366,-577.74 2486,-577.74 2486,-615.74"/>
<text text-anchor="middle" x="2426" y="-600.54" font-family="Arial" font-size="14.00">V^(1,3)</text>
<text text-anchor="middle" x="2426" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_7&#45;&gt;v_7 -->
<g id="edge77" class="edge">
<title>proj_v_7&#45;&gt;v_7</title>
<path fill="none" stroke="black" d="M2419.22,-652.33C2420.25,-644.05 2421.39,-634.85 2422.44,-626.39"/>
<polygon fill="black" stroke="black" points="2425.95,-626.56 2423.71,-616.21 2419,-625.7 2425.95,-626.56"/>
</g>
<!-- attn_7 -->
<g id="node65" class="node">
<title>attn_7</title>
<polygon fill="lightpink" stroke="black" points="2512.5,-540.74 2389.5,-540.74 2389.5,-487.74 2512.5,-487.74 2512.5,-540.74"/>
<text text-anchor="middle" x="2451" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="2451" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="2451" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_7&#45;&gt;attn_7 -->
<g id="edge78" class="edge">
<title>q_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M2538.64,-577.67C2525.91,-568.61 2510.12,-557.35 2495.46,-546.91"/>
<polygon fill="black" stroke="black" points="2497.16,-543.83 2486.99,-540.88 2493.1,-549.53 2497.16,-543.83"/>
</g>
<!-- k_7&#45;&gt;attn_7 -->
<g id="edge79" class="edge">
<title>k_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M2324.58,-577.67C2343.88,-568.14 2368.08,-556.19 2390.12,-545.31"/>
<polygon fill="black" stroke="black" points="2391.67,-548.44 2399.09,-540.88 2388.57,-542.17 2391.67,-548.44"/>
</g>
<!-- v_7&#45;&gt;attn_7 -->
<g id="edge80" class="edge">
<title>v_7&#45;&gt;attn_7</title>
<path fill="none" stroke="black" d="M2431.67,-577.47C2434.15,-569.5 2437.14,-559.87 2440.02,-550.59"/>
<polygon fill="black" stroke="black" points="2443.45,-551.35 2443.08,-540.76 2436.77,-549.27 2443.45,-551.35"/>
</g>
<!-- out_7 -->
<g id="node66" class="node">
<title>out_7</title>
<polygon fill="lightgreen" stroke="black" points="2554,-442.87 2434,-442.87 2434,-404.87 2554,-404.87 2554,-442.87"/>
<text text-anchor="middle" x="2494" y="-427.67" font-family="Arial" font-size="14.00">Attention^(1,3)</text>
<text text-anchor="middle" x="2494" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_7&#45;&gt;out_7 -->
<g id="edge81" class="edge">
<title>attn_7&#45;&gt;out_7</title>
<path fill="none" stroke="black" d="M2463.44,-487.68C2468.86,-476.53 2475.23,-463.44 2480.75,-452.11"/>
<polygon fill="black" stroke="black" points="2483.91,-453.6 2485.14,-443.08 2477.62,-450.54 2483.91,-453.6"/>
</g>
<!-- out_7&#45;&gt;concat_group_1 -->
<g id="edge169" class="edge">
<title>out_7&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2530.43,-404.82C2570.95,-384.73 2637.28,-351.85 2687.19,-327.12"/>
<polygon fill="black" stroke="black" points="2688.9,-330.17 2696.31,-322.6 2685.79,-323.9 2688.9,-330.17"/>
<text text-anchor="middle" x="2644.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 7 slice</text>
</g>
<!-- q_8 -->
<g id="node70" class="node">
<title>q_8</title>
<polygon fill="lightcyan" stroke="black" points="5368,-615.74 5248,-615.74 5248,-577.74 5368,-577.74 5368,-615.74"/>
<text text-anchor="middle" x="5308" y="-600.54" font-family="Arial" font-size="14.00">Q^(2,0)</text>
<text text-anchor="middle" x="5308" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_8&#45;&gt;q_8 -->
<g id="edge85" class="edge">
<title>proj_q_8&#45;&gt;q_8</title>
<path fill="none" stroke="black" d="M5299.18,-652.33C5300.54,-643.96 5302.04,-634.65 5303.42,-626.11"/>
<polygon fill="black" stroke="black" points="5306.88,-626.64 5305.02,-616.21 5299.97,-625.52 5306.88,-626.64"/>
</g>
<!-- k_8 -->
<g id="node71" class="node">
<title>k_8</title>
<polygon fill="lightcyan" stroke="black" points="5092,-615.74 4972,-615.74 4972,-577.74 5092,-577.74 5092,-615.74"/>
<text text-anchor="middle" x="5032" y="-600.54" font-family="Arial" font-size="14.00">K^(2,0)</text>
<text text-anchor="middle" x="5032" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_8&#45;&gt;k_8 -->
<g id="edge86" class="edge">
<title>proj_k_8&#45;&gt;k_8</title>
<path fill="none" stroke="black" d="M5029.29,-652.33C5029.7,-644.05 5030.16,-634.85 5030.58,-626.39"/>
<polygon fill="black" stroke="black" points="5034.08,-626.37 5031.08,-616.21 5027.09,-626.02 5034.08,-626.37"/>
</g>
<!-- v_8 -->
<g id="node72" class="node">
<title>v_8</title>
<polygon fill="lightcyan" stroke="black" points="5230,-615.74 5110,-615.74 5110,-577.74 5230,-577.74 5230,-615.74"/>
<text text-anchor="middle" x="5170" y="-600.54" font-family="Arial" font-size="14.00">V^(2,0)</text>
<text text-anchor="middle" x="5170" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_8&#45;&gt;v_8 -->
<g id="edge87" class="edge">
<title>proj_v_8&#45;&gt;v_8</title>
<path fill="none" stroke="black" d="M5163.22,-652.33C5164.25,-644.05 5165.39,-634.85 5166.44,-626.39"/>
<polygon fill="black" stroke="black" points="5169.95,-626.56 5167.71,-616.21 5163,-625.7 5169.95,-626.56"/>
</g>
<!-- attn_8 -->
<g id="node73" class="node">
<title>attn_8</title>
<polygon fill="lightpink" stroke="black" points="5181.5,-540.74 5058.5,-540.74 5058.5,-487.74 5181.5,-487.74 5181.5,-540.74"/>
<text text-anchor="middle" x="5120" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="5120" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="5120" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_8&#45;&gt;attn_8 -->
<g id="edge88" class="edge">
<title>q_8&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M5265.81,-577.67C5243.25,-568.01 5214.89,-555.87 5189.2,-544.87"/>
<polygon fill="black" stroke="black" points="5190.44,-541.6 5179.87,-540.88 5187.69,-548.03 5190.44,-541.6"/>
</g>
<!-- k_8&#45;&gt;attn_8 -->
<g id="edge89" class="edge">
<title>k_8&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M5051.97,-577.47C5061.61,-568.65 5073.47,-557.8 5084.58,-547.65"/>
<polygon fill="black" stroke="black" points="5087.09,-550.09 5092.11,-540.76 5082.36,-544.92 5087.09,-550.09"/>
</g>
<!-- v_8&#45;&gt;attn_8 -->
<g id="edge90" class="edge">
<title>v_8&#45;&gt;attn_8</title>
<path fill="none" stroke="black" d="M5158.65,-577.47C5153.49,-569.16 5147.21,-559.05 5141.22,-549.41"/>
<polygon fill="black" stroke="black" points="5144.1,-547.41 5135.85,-540.76 5138.15,-551.1 5144.1,-547.41"/>
</g>
<!-- out_8 -->
<g id="node74" class="node">
<title>out_8</title>
<polygon fill="lightgreen" stroke="black" points="5096,-442.87 4976,-442.87 4976,-404.87 5096,-404.87 5096,-442.87"/>
<text text-anchor="middle" x="5036" y="-427.67" font-family="Arial" font-size="14.00">Attention^(2,0)</text>
<text text-anchor="middle" x="5036" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_8&#45;&gt;out_8 -->
<g id="edge91" class="edge">
<title>attn_8&#45;&gt;out_8</title>
<path fill="none" stroke="black" d="M5095.7,-487.68C5084.57,-475.97 5071.42,-462.13 5060.29,-450.42"/>
<polygon fill="black" stroke="black" points="5062.74,-447.92 5053.31,-443.08 5057.66,-452.74 5062.74,-447.92"/>
</g>
<!-- concat_group_2 -->
<g id="node133" class="node">
<title>concat_group_2</title>
<polygon fill="orange" stroke="black" points="4638,-346 4509,-293 4638,-240 4767,-293 4638,-346"/>
<text text-anchor="middle" x="4638" y="-304.3" font-family="Arial" font-size="14.00">Intra&#45;group Concat</text>
<text text-anchor="middle" x="4638" y="-289.3" font-family="Arial" font-size="14.00">Group 2</text>
<text text-anchor="middle" x="4638" y="-274.3" font-family="Arial" font-size="14.00">ℝ^(1024×L×512)</text>
</g>
<!-- out_8&#45;&gt;concat_group_2 -->
<g id="edge170" class="edge">
<title>out_8&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5000.24,-404.85C4974.27,-392.26 4938.03,-375.66 4905,-364 4848.11,-343.92 4782.61,-326.66 4730.72,-314.3"/>
<polygon fill="black" stroke="black" points="4731.4,-310.87 4720.86,-311.98 4729.79,-317.68 4731.4,-310.87"/>
<text text-anchor="middle" x="4977.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 8 slice</text>
</g>
<!-- q_9 -->
<g id="node78" class="node">
<title>q_9</title>
<polygon fill="lightcyan" stroke="black" points="3996,-615.74 3876,-615.74 3876,-577.74 3996,-577.74 3996,-615.74"/>
<text text-anchor="middle" x="3936" y="-600.54" font-family="Arial" font-size="14.00">Q^(2,1)</text>
<text text-anchor="middle" x="3936" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_9&#45;&gt;q_9 -->
<g id="edge95" class="edge">
<title>proj_q_9&#45;&gt;q_9</title>
<path fill="none" stroke="black" d="M3927.18,-652.33C3928.54,-643.96 3930.04,-634.65 3931.42,-626.11"/>
<polygon fill="black" stroke="black" points="3934.88,-626.64 3933.02,-616.21 3927.97,-625.52 3934.88,-626.64"/>
</g>
<!-- k_9 -->
<g id="node79" class="node">
<title>k_9</title>
<polygon fill="lightcyan" stroke="black" points="3720,-615.74 3600,-615.74 3600,-577.74 3720,-577.74 3720,-615.74"/>
<text text-anchor="middle" x="3660" y="-600.54" font-family="Arial" font-size="14.00">K^(2,1)</text>
<text text-anchor="middle" x="3660" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_9&#45;&gt;k_9 -->
<g id="edge96" class="edge">
<title>proj_k_9&#45;&gt;k_9</title>
<path fill="none" stroke="black" d="M3657.29,-652.33C3657.7,-644.05 3658.16,-634.85 3658.58,-626.39"/>
<polygon fill="black" stroke="black" points="3662.08,-626.37 3659.08,-616.21 3655.09,-626.02 3662.08,-626.37"/>
</g>
<!-- v_9 -->
<g id="node80" class="node">
<title>v_9</title>
<polygon fill="lightcyan" stroke="black" points="3858,-615.74 3738,-615.74 3738,-577.74 3858,-577.74 3858,-615.74"/>
<text text-anchor="middle" x="3798" y="-600.54" font-family="Arial" font-size="14.00">V^(2,1)</text>
<text text-anchor="middle" x="3798" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_9&#45;&gt;v_9 -->
<g id="edge97" class="edge">
<title>proj_v_9&#45;&gt;v_9</title>
<path fill="none" stroke="black" d="M3791.22,-652.33C3792.25,-644.05 3793.39,-634.85 3794.44,-626.39"/>
<polygon fill="black" stroke="black" points="3797.95,-626.56 3795.71,-616.21 3791,-625.7 3797.95,-626.56"/>
</g>
<!-- attn_9 -->
<g id="node81" class="node">
<title>attn_9</title>
<polygon fill="lightpink" stroke="black" points="3885.5,-540.74 3762.5,-540.74 3762.5,-487.74 3885.5,-487.74 3885.5,-540.74"/>
<text text-anchor="middle" x="3824" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="3824" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="3824" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_9&#45;&gt;attn_9 -->
<g id="edge98" class="edge">
<title>q_9&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M3910.87,-577.67C3898.25,-568.61 3882.59,-557.35 3868.06,-546.91"/>
<polygon fill="black" stroke="black" points="3869.83,-543.87 3859.67,-540.88 3865.75,-549.56 3869.83,-543.87"/>
</g>
<!-- k_9&#45;&gt;attn_9 -->
<g id="edge99" class="edge">
<title>k_9&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M3696.8,-577.67C3716.23,-568.14 3740.57,-556.19 3762.75,-545.31"/>
<polygon fill="black" stroke="black" points="3764.33,-548.43 3771.77,-540.88 3761.25,-542.14 3764.33,-548.43"/>
</g>
<!-- v_9&#45;&gt;attn_9 -->
<g id="edge100" class="edge">
<title>v_9&#45;&gt;attn_9</title>
<path fill="none" stroke="black" d="M3803.9,-577.47C3806.5,-569.42 3809.65,-559.67 3812.68,-550.3"/>
<polygon fill="black" stroke="black" points="3816.02,-551.35 3815.76,-540.76 3809.35,-549.2 3816.02,-551.35"/>
</g>
<!-- out_9 -->
<g id="node82" class="node">
<title>out_9</title>
<polygon fill="lightgreen" stroke="black" points="3987,-442.87 3867,-442.87 3867,-404.87 3987,-404.87 3987,-442.87"/>
<text text-anchor="middle" x="3927" y="-427.67" font-family="Arial" font-size="14.00">Attention^(2,1)</text>
<text text-anchor="middle" x="3927" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_9&#45;&gt;out_9 -->
<g id="edge101" class="edge">
<title>attn_9&#45;&gt;out_9</title>
<path fill="none" stroke="black" d="M3853.79,-487.68C3867.7,-475.75 3884.19,-461.6 3898,-449.75"/>
<polygon fill="black" stroke="black" points="3900.46,-452.25 3905.78,-443.08 3895.91,-446.94 3900.46,-452.25"/>
</g>
<!-- out_9&#45;&gt;concat_group_2 -->
<g id="edge171" class="edge">
<title>out_9&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3979.4,-404.8C3988.85,-401.9 3998.67,-399.12 4008,-396.87 4188.57,-353.4 4402.71,-322.76 4529.08,-306.78"/>
<polygon fill="black" stroke="black" points="4529.67,-310.24 4539.16,-305.52 4528.8,-303.29 4529.67,-310.24"/>
<text text-anchor="middle" x="4180.5" y="-367.8" font-family="Arial" font-size="14.00">GPU 9 slice</text>
</g>
<!-- q_10 -->
<g id="node86" class="node">
<title>q_10</title>
<polygon fill="lightcyan" stroke="black" points="4416,-615.74 4296,-615.74 4296,-577.74 4416,-577.74 4416,-615.74"/>
<text text-anchor="middle" x="4356" y="-600.54" font-family="Arial" font-size="14.00">Q^(2,2)</text>
<text text-anchor="middle" x="4356" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_10&#45;&gt;q_10 -->
<g id="edge105" class="edge">
<title>proj_q_10&#45;&gt;q_10</title>
<path fill="none" stroke="black" d="M4347.18,-652.33C4348.54,-643.96 4350.04,-634.65 4351.42,-626.11"/>
<polygon fill="black" stroke="black" points="4354.88,-626.64 4353.02,-616.21 4347.97,-625.52 4354.88,-626.64"/>
</g>
<!-- k_10 -->
<g id="node87" class="node">
<title>k_10</title>
<polygon fill="lightcyan" stroke="black" points="4140,-615.74 4020,-615.74 4020,-577.74 4140,-577.74 4140,-615.74"/>
<text text-anchor="middle" x="4080" y="-600.54" font-family="Arial" font-size="14.00">K^(2,2)</text>
<text text-anchor="middle" x="4080" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_10&#45;&gt;k_10 -->
<g id="edge106" class="edge">
<title>proj_k_10&#45;&gt;k_10</title>
<path fill="none" stroke="black" d="M4077.29,-652.33C4077.7,-644.05 4078.16,-634.85 4078.58,-626.39"/>
<polygon fill="black" stroke="black" points="4082.08,-626.37 4079.08,-616.21 4075.09,-626.02 4082.08,-626.37"/>
</g>
<!-- v_10 -->
<g id="node88" class="node">
<title>v_10</title>
<polygon fill="lightcyan" stroke="black" points="4278,-615.74 4158,-615.74 4158,-577.74 4278,-577.74 4278,-615.74"/>
<text text-anchor="middle" x="4218" y="-600.54" font-family="Arial" font-size="14.00">V^(2,2)</text>
<text text-anchor="middle" x="4218" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_10&#45;&gt;v_10 -->
<g id="edge107" class="edge">
<title>proj_v_10&#45;&gt;v_10</title>
<path fill="none" stroke="black" d="M4211.22,-652.33C4212.25,-644.05 4213.39,-634.85 4214.44,-626.39"/>
<polygon fill="black" stroke="black" points="4217.95,-626.56 4215.71,-616.21 4211,-625.7 4217.95,-626.56"/>
</g>
<!-- attn_10 -->
<g id="node89" class="node">
<title>attn_10</title>
<polygon fill="lightpink" stroke="black" points="4305.5,-540.74 4182.5,-540.74 4182.5,-487.74 4305.5,-487.74 4305.5,-540.74"/>
<text text-anchor="middle" x="4244" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="4244" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="4244" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_10&#45;&gt;attn_10 -->
<g id="edge108" class="edge">
<title>q_10&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M4330.87,-577.67C4318.25,-568.61 4302.59,-557.35 4288.06,-546.91"/>
<polygon fill="black" stroke="black" points="4289.83,-543.87 4279.67,-540.88 4285.75,-549.56 4289.83,-543.87"/>
</g>
<!-- k_10&#45;&gt;attn_10 -->
<g id="edge109" class="edge">
<title>k_10&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M4116.8,-577.67C4136.23,-568.14 4160.57,-556.19 4182.75,-545.31"/>
<polygon fill="black" stroke="black" points="4184.33,-548.43 4191.77,-540.88 4181.25,-542.14 4184.33,-548.43"/>
</g>
<!-- v_10&#45;&gt;attn_10 -->
<g id="edge110" class="edge">
<title>v_10&#45;&gt;attn_10</title>
<path fill="none" stroke="black" d="M4223.9,-577.47C4226.5,-569.42 4229.65,-559.67 4232.68,-550.3"/>
<polygon fill="black" stroke="black" points="4236.02,-551.35 4235.76,-540.76 4229.35,-549.2 4236.02,-551.35"/>
</g>
<!-- out_10 -->
<g id="node90" class="node">
<title>out_10</title>
<polygon fill="lightgreen" stroke="black" points="4347,-442.87 4227,-442.87 4227,-404.87 4347,-404.87 4347,-442.87"/>
<text text-anchor="middle" x="4287" y="-427.67" font-family="Arial" font-size="14.00">Attention^(2,2)</text>
<text text-anchor="middle" x="4287" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_10&#45;&gt;out_10 -->
<g id="edge111" class="edge">
<title>attn_10&#45;&gt;out_10</title>
<path fill="none" stroke="black" d="M4256.44,-487.68C4261.86,-476.53 4268.23,-463.44 4273.75,-452.11"/>
<polygon fill="black" stroke="black" points="4276.91,-453.6 4278.14,-443.08 4270.62,-450.54 4276.91,-453.6"/>
</g>
<!-- out_10&#45;&gt;concat_group_2 -->
<g id="edge172" class="edge">
<title>out_10&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4336.17,-404.82C4394.65,-383.35 4492.92,-347.26 4561.39,-322.13"/>
<polygon fill="black" stroke="black" points="4562.66,-325.39 4570.85,-318.66 4560.25,-318.82 4562.66,-325.39"/>
<text text-anchor="middle" x="4481" y="-367.8" font-family="Arial" font-size="14.00">GPU 10 slice</text>
</g>
<!-- q_11 -->
<g id="node94" class="node">
<title>q_11</title>
<polygon fill="lightcyan" stroke="black" points="4836,-615.74 4716,-615.74 4716,-577.74 4836,-577.74 4836,-615.74"/>
<text text-anchor="middle" x="4776" y="-600.54" font-family="Arial" font-size="14.00">Q^(2,3)</text>
<text text-anchor="middle" x="4776" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_11&#45;&gt;q_11 -->
<g id="edge115" class="edge">
<title>proj_q_11&#45;&gt;q_11</title>
<path fill="none" stroke="black" d="M4767.18,-652.33C4768.54,-643.96 4770.04,-634.65 4771.42,-626.11"/>
<polygon fill="black" stroke="black" points="4774.88,-626.64 4773.02,-616.21 4767.97,-625.52 4774.88,-626.64"/>
</g>
<!-- k_11 -->
<g id="node95" class="node">
<title>k_11</title>
<polygon fill="lightcyan" stroke="black" points="4560,-615.74 4440,-615.74 4440,-577.74 4560,-577.74 4560,-615.74"/>
<text text-anchor="middle" x="4500" y="-600.54" font-family="Arial" font-size="14.00">K^(2,3)</text>
<text text-anchor="middle" x="4500" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_11&#45;&gt;k_11 -->
<g id="edge116" class="edge">
<title>proj_k_11&#45;&gt;k_11</title>
<path fill="none" stroke="black" d="M4497.29,-652.33C4497.7,-644.05 4498.16,-634.85 4498.58,-626.39"/>
<polygon fill="black" stroke="black" points="4502.08,-626.37 4499.08,-616.21 4495.09,-626.02 4502.08,-626.37"/>
</g>
<!-- v_11 -->
<g id="node96" class="node">
<title>v_11</title>
<polygon fill="lightcyan" stroke="black" points="4698,-615.74 4578,-615.74 4578,-577.74 4698,-577.74 4698,-615.74"/>
<text text-anchor="middle" x="4638" y="-600.54" font-family="Arial" font-size="14.00">V^(2,3)</text>
<text text-anchor="middle" x="4638" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_11&#45;&gt;v_11 -->
<g id="edge117" class="edge">
<title>proj_v_11&#45;&gt;v_11</title>
<path fill="none" stroke="black" d="M4631.22,-652.33C4632.25,-644.05 4633.39,-634.85 4634.44,-626.39"/>
<polygon fill="black" stroke="black" points="4637.95,-626.56 4635.71,-616.21 4631,-625.7 4637.95,-626.56"/>
</g>
<!-- attn_11 -->
<g id="node97" class="node">
<title>attn_11</title>
<polygon fill="lightpink" stroke="black" points="4699.5,-540.74 4576.5,-540.74 4576.5,-487.74 4699.5,-487.74 4699.5,-540.74"/>
<text text-anchor="middle" x="4638" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="4638" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="4638" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_11&#45;&gt;attn_11 -->
<g id="edge118" class="edge">
<title>q_11&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M4745.03,-577.67C4729.05,-568.35 4709.11,-556.72 4690.79,-546.03"/>
<polygon fill="black" stroke="black" points="4692.35,-542.89 4681.95,-540.88 4688.82,-548.94 4692.35,-542.89"/>
</g>
<!-- k_11&#45;&gt;attn_11 -->
<g id="edge119" class="edge">
<title>k_11&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M4530.97,-577.67C4546.95,-568.35 4566.89,-556.72 4585.21,-546.03"/>
<polygon fill="black" stroke="black" points="4587.18,-548.94 4594.05,-540.88 4583.65,-542.89 4587.18,-548.94"/>
</g>
<!-- v_11&#45;&gt;attn_11 -->
<g id="edge120" class="edge">
<title>v_11&#45;&gt;attn_11</title>
<path fill="none" stroke="black" d="M4638,-577.47C4638,-569.59 4638,-560.08 4638,-550.89"/>
<polygon fill="black" stroke="black" points="4641.5,-550.76 4638,-540.76 4634.5,-550.76 4641.5,-550.76"/>
</g>
<!-- out_11 -->
<g id="node98" class="node">
<title>out_11</title>
<polygon fill="lightgreen" stroke="black" points="4698,-442.87 4578,-442.87 4578,-404.87 4698,-404.87 4698,-442.87"/>
<text text-anchor="middle" x="4638" y="-427.67" font-family="Arial" font-size="14.00">Attention^(2,3)</text>
<text text-anchor="middle" x="4638" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_11&#45;&gt;out_11 -->
<g id="edge121" class="edge">
<title>attn_11&#45;&gt;out_11</title>
<path fill="none" stroke="black" d="M4638,-487.68C4638,-476.86 4638,-464.22 4638,-453.13"/>
<polygon fill="black" stroke="black" points="4641.5,-453.08 4638,-443.08 4634.5,-453.08 4641.5,-453.08"/>
</g>
<!-- out_11&#45;&gt;concat_group_2 -->
<g id="edge173" class="edge">
<title>out_11&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4638,-404.68C4638,-391.92 4638,-374.05 4638,-356.38"/>
<polygon fill="black" stroke="black" points="4641.5,-356.04 4638,-346.04 4634.5,-356.04 4641.5,-356.04"/>
<text text-anchor="middle" x="4678" y="-367.8" font-family="Arial" font-size="14.00">GPU 11 slice</text>
</g>
<!-- q_12 -->
<g id="node102" class="node">
<title>q_12</title>
<polygon fill="lightcyan" stroke="black" points="5788,-615.74 5668,-615.74 5668,-577.74 5788,-577.74 5788,-615.74"/>
<text text-anchor="middle" x="5728" y="-600.54" font-family="Arial" font-size="14.00">Q^(3,0)</text>
<text text-anchor="middle" x="5728" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_12&#45;&gt;q_12 -->
<g id="edge125" class="edge">
<title>proj_q_12&#45;&gt;q_12</title>
<path fill="none" stroke="black" d="M5719.18,-652.33C5720.54,-643.96 5722.04,-634.65 5723.42,-626.11"/>
<polygon fill="black" stroke="black" points="5726.88,-626.64 5725.02,-616.21 5719.97,-625.52 5726.88,-626.64"/>
</g>
<!-- k_12 -->
<g id="node103" class="node">
<title>k_12</title>
<polygon fill="lightcyan" stroke="black" points="5512,-615.74 5392,-615.74 5392,-577.74 5512,-577.74 5512,-615.74"/>
<text text-anchor="middle" x="5452" y="-600.54" font-family="Arial" font-size="14.00">K^(3,0)</text>
<text text-anchor="middle" x="5452" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_12&#45;&gt;k_12 -->
<g id="edge126" class="edge">
<title>proj_k_12&#45;&gt;k_12</title>
<path fill="none" stroke="black" d="M5449.29,-652.33C5449.7,-644.05 5450.16,-634.85 5450.58,-626.39"/>
<polygon fill="black" stroke="black" points="5454.08,-626.37 5451.08,-616.21 5447.09,-626.02 5454.08,-626.37"/>
</g>
<!-- v_12 -->
<g id="node104" class="node">
<title>v_12</title>
<polygon fill="lightcyan" stroke="black" points="5650,-615.74 5530,-615.74 5530,-577.74 5650,-577.74 5650,-615.74"/>
<text text-anchor="middle" x="5590" y="-600.54" font-family="Arial" font-size="14.00">V^(3,0)</text>
<text text-anchor="middle" x="5590" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_12&#45;&gt;v_12 -->
<g id="edge127" class="edge">
<title>proj_v_12&#45;&gt;v_12</title>
<path fill="none" stroke="black" d="M5583.22,-652.33C5584.25,-644.05 5585.39,-634.85 5586.44,-626.39"/>
<polygon fill="black" stroke="black" points="5589.95,-626.56 5587.71,-616.21 5583,-625.7 5589.95,-626.56"/>
</g>
<!-- attn_12 -->
<g id="node105" class="node">
<title>attn_12</title>
<polygon fill="lightpink" stroke="black" points="5677.5,-540.74 5554.5,-540.74 5554.5,-487.74 5677.5,-487.74 5677.5,-540.74"/>
<text text-anchor="middle" x="5616" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="5616" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="5616" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_12&#45;&gt;attn_12 -->
<g id="edge128" class="edge">
<title>q_12&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M5702.87,-577.67C5690.25,-568.61 5674.59,-557.35 5660.06,-546.91"/>
<polygon fill="black" stroke="black" points="5661.83,-543.87 5651.67,-540.88 5657.75,-549.56 5661.83,-543.87"/>
</g>
<!-- k_12&#45;&gt;attn_12 -->
<g id="edge129" class="edge">
<title>k_12&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M5488.8,-577.67C5508.23,-568.14 5532.57,-556.19 5554.75,-545.31"/>
<polygon fill="black" stroke="black" points="5556.33,-548.43 5563.77,-540.88 5553.25,-542.14 5556.33,-548.43"/>
</g>
<!-- v_12&#45;&gt;attn_12 -->
<g id="edge130" class="edge">
<title>v_12&#45;&gt;attn_12</title>
<path fill="none" stroke="black" d="M5595.9,-577.47C5598.5,-569.42 5601.65,-559.67 5604.68,-550.3"/>
<polygon fill="black" stroke="black" points="5608.02,-551.35 5607.76,-540.76 5601.35,-549.2 5608.02,-551.35"/>
</g>
<!-- out_12 -->
<g id="node106" class="node">
<title>out_12</title>
<polygon fill="lightgreen" stroke="black" points="5719,-442.87 5599,-442.87 5599,-404.87 5719,-404.87 5719,-442.87"/>
<text text-anchor="middle" x="5659" y="-427.67" font-family="Arial" font-size="14.00">Attention^(3,0)</text>
<text text-anchor="middle" x="5659" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_12&#45;&gt;out_12 -->
<g id="edge131" class="edge">
<title>attn_12&#45;&gt;out_12</title>
<path fill="none" stroke="black" d="M5628.44,-487.68C5633.86,-476.53 5640.23,-463.44 5645.75,-452.11"/>
<polygon fill="black" stroke="black" points="5648.91,-453.6 5650.14,-443.08 5642.62,-450.54 5648.91,-453.6"/>
</g>
<!-- concat_group_3 -->
<g id="node134" class="node">
<title>concat_group_3</title>
<polygon fill="orange" stroke="black" points="6010,-346 5881,-293 6010,-240 6139,-293 6010,-346"/>
<text text-anchor="middle" x="6010" y="-304.3" font-family="Arial" font-size="14.00">Intra&#45;group Concat</text>
<text text-anchor="middle" x="6010" y="-289.3" font-family="Arial" font-size="14.00">Group 3</text>
<text text-anchor="middle" x="6010" y="-274.3" font-family="Arial" font-size="14.00">ℝ^(1024×L×512)</text>
</g>
<!-- out_12&#45;&gt;concat_group_3 -->
<g id="edge174" class="edge">
<title>out_12&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5708.17,-404.82C5766.65,-383.35 5864.92,-347.26 5933.39,-322.13"/>
<polygon fill="black" stroke="black" points="5934.66,-325.39 5942.85,-318.66 5932.25,-318.82 5934.66,-325.39"/>
<text text-anchor="middle" x="5853" y="-367.8" font-family="Arial" font-size="14.00">GPU 12 slice</text>
</g>
<!-- q_13 -->
<g id="node110" class="node">
<title>q_13</title>
<polygon fill="lightcyan" stroke="black" points="6208,-615.74 6088,-615.74 6088,-577.74 6208,-577.74 6208,-615.74"/>
<text text-anchor="middle" x="6148" y="-600.54" font-family="Arial" font-size="14.00">Q^(3,1)</text>
<text text-anchor="middle" x="6148" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_13&#45;&gt;q_13 -->
<g id="edge135" class="edge">
<title>proj_q_13&#45;&gt;q_13</title>
<path fill="none" stroke="black" d="M6139.18,-652.33C6140.54,-643.96 6142.04,-634.65 6143.42,-626.11"/>
<polygon fill="black" stroke="black" points="6146.88,-626.64 6145.02,-616.21 6139.97,-625.52 6146.88,-626.64"/>
</g>
<!-- k_13 -->
<g id="node111" class="node">
<title>k_13</title>
<polygon fill="lightcyan" stroke="black" points="5932,-615.74 5812,-615.74 5812,-577.74 5932,-577.74 5932,-615.74"/>
<text text-anchor="middle" x="5872" y="-600.54" font-family="Arial" font-size="14.00">K^(3,1)</text>
<text text-anchor="middle" x="5872" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_13&#45;&gt;k_13 -->
<g id="edge136" class="edge">
<title>proj_k_13&#45;&gt;k_13</title>
<path fill="none" stroke="black" d="M5869.29,-652.33C5869.7,-644.05 5870.16,-634.85 5870.58,-626.39"/>
<polygon fill="black" stroke="black" points="5874.08,-626.37 5871.08,-616.21 5867.09,-626.02 5874.08,-626.37"/>
</g>
<!-- v_13 -->
<g id="node112" class="node">
<title>v_13</title>
<polygon fill="lightcyan" stroke="black" points="6070,-615.74 5950,-615.74 5950,-577.74 6070,-577.74 6070,-615.74"/>
<text text-anchor="middle" x="6010" y="-600.54" font-family="Arial" font-size="14.00">V^(3,1)</text>
<text text-anchor="middle" x="6010" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_13&#45;&gt;v_13 -->
<g id="edge137" class="edge">
<title>proj_v_13&#45;&gt;v_13</title>
<path fill="none" stroke="black" d="M6003.22,-652.33C6004.25,-644.05 6005.39,-634.85 6006.44,-626.39"/>
<polygon fill="black" stroke="black" points="6009.95,-626.56 6007.71,-616.21 6003,-625.7 6009.95,-626.56"/>
</g>
<!-- attn_13 -->
<g id="node113" class="node">
<title>attn_13</title>
<polygon fill="lightpink" stroke="black" points="6071.5,-540.74 5948.5,-540.74 5948.5,-487.74 6071.5,-487.74 6071.5,-540.74"/>
<text text-anchor="middle" x="6010" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6010" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="6010" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_13&#45;&gt;attn_13 -->
<g id="edge138" class="edge">
<title>q_13&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M6117.03,-577.67C6101.05,-568.35 6081.11,-556.72 6062.79,-546.03"/>
<polygon fill="black" stroke="black" points="6064.35,-542.89 6053.95,-540.88 6060.82,-548.94 6064.35,-542.89"/>
</g>
<!-- k_13&#45;&gt;attn_13 -->
<g id="edge139" class="edge">
<title>k_13&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M5902.97,-577.67C5918.95,-568.35 5938.89,-556.72 5957.21,-546.03"/>
<polygon fill="black" stroke="black" points="5959.18,-548.94 5966.05,-540.88 5955.65,-542.89 5959.18,-548.94"/>
</g>
<!-- v_13&#45;&gt;attn_13 -->
<g id="edge140" class="edge">
<title>v_13&#45;&gt;attn_13</title>
<path fill="none" stroke="black" d="M6010,-577.47C6010,-569.59 6010,-560.08 6010,-550.89"/>
<polygon fill="black" stroke="black" points="6013.5,-550.76 6010,-540.76 6006.5,-550.76 6013.5,-550.76"/>
</g>
<!-- out_13 -->
<g id="node114" class="node">
<title>out_13</title>
<polygon fill="lightgreen" stroke="black" points="6070,-442.87 5950,-442.87 5950,-404.87 6070,-404.87 6070,-442.87"/>
<text text-anchor="middle" x="6010" y="-427.67" font-family="Arial" font-size="14.00">Attention^(3,1)</text>
<text text-anchor="middle" x="6010" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_13&#45;&gt;out_13 -->
<g id="edge141" class="edge">
<title>attn_13&#45;&gt;out_13</title>
<path fill="none" stroke="black" d="M6010,-487.68C6010,-476.86 6010,-464.22 6010,-453.13"/>
<polygon fill="black" stroke="black" points="6013.5,-453.08 6010,-443.08 6006.5,-453.08 6013.5,-453.08"/>
</g>
<!-- out_13&#45;&gt;concat_group_3 -->
<g id="edge175" class="edge">
<title>out_13&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6010,-404.68C6010,-391.92 6010,-374.05 6010,-356.38"/>
<polygon fill="black" stroke="black" points="6013.5,-356.04 6010,-346.04 6006.5,-356.04 6013.5,-356.04"/>
<text text-anchor="middle" x="6050" y="-367.8" font-family="Arial" font-size="14.00">GPU 13 slice</text>
</g>
<!-- q_14 -->
<g id="node118" class="node">
<title>q_14</title>
<polygon fill="lightcyan" stroke="black" points="6628,-615.74 6508,-615.74 6508,-577.74 6628,-577.74 6628,-615.74"/>
<text text-anchor="middle" x="6568" y="-600.54" font-family="Arial" font-size="14.00">Q^(3,2)</text>
<text text-anchor="middle" x="6568" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_14&#45;&gt;q_14 -->
<g id="edge145" class="edge">
<title>proj_q_14&#45;&gt;q_14</title>
<path fill="none" stroke="black" d="M6559.18,-652.33C6560.54,-643.96 6562.04,-634.65 6563.42,-626.11"/>
<polygon fill="black" stroke="black" points="6566.88,-626.64 6565.02,-616.21 6559.97,-625.52 6566.88,-626.64"/>
</g>
<!-- k_14 -->
<g id="node119" class="node">
<title>k_14</title>
<polygon fill="lightcyan" stroke="black" points="6352,-615.74 6232,-615.74 6232,-577.74 6352,-577.74 6352,-615.74"/>
<text text-anchor="middle" x="6292" y="-600.54" font-family="Arial" font-size="14.00">K^(3,2)</text>
<text text-anchor="middle" x="6292" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_14&#45;&gt;k_14 -->
<g id="edge146" class="edge">
<title>proj_k_14&#45;&gt;k_14</title>
<path fill="none" stroke="black" d="M6289.29,-652.33C6289.7,-644.05 6290.16,-634.85 6290.58,-626.39"/>
<polygon fill="black" stroke="black" points="6294.08,-626.37 6291.08,-616.21 6287.09,-626.02 6294.08,-626.37"/>
</g>
<!-- v_14 -->
<g id="node120" class="node">
<title>v_14</title>
<polygon fill="lightcyan" stroke="black" points="6490,-615.74 6370,-615.74 6370,-577.74 6490,-577.74 6490,-615.74"/>
<text text-anchor="middle" x="6430" y="-600.54" font-family="Arial" font-size="14.00">V^(3,2)</text>
<text text-anchor="middle" x="6430" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_14&#45;&gt;v_14 -->
<g id="edge147" class="edge">
<title>proj_v_14&#45;&gt;v_14</title>
<path fill="none" stroke="black" d="M6423.22,-652.33C6424.25,-644.05 6425.39,-634.85 6426.44,-626.39"/>
<polygon fill="black" stroke="black" points="6429.95,-626.56 6427.71,-616.21 6423,-625.7 6429.95,-626.56"/>
</g>
<!-- attn_14 -->
<g id="node121" class="node">
<title>attn_14</title>
<polygon fill="lightpink" stroke="black" points="6417.5,-540.74 6294.5,-540.74 6294.5,-487.74 6417.5,-487.74 6417.5,-540.74"/>
<text text-anchor="middle" x="6356" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6356" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="6356" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_14&#45;&gt;attn_14 -->
<g id="edge148" class="edge">
<title>q_14&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M6520.42,-577.67C6492.88,-567.21 6457.67,-553.85 6426.91,-542.17"/>
<polygon fill="black" stroke="black" points="6428.11,-538.88 6417.52,-538.6 6425.63,-545.42 6428.11,-538.88"/>
</g>
<!-- k_14&#45;&gt;attn_14 -->
<g id="edge149" class="edge">
<title>k_14&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M6306.52,-577.47C6313.26,-568.99 6321.5,-558.63 6329.3,-548.82"/>
<polygon fill="black" stroke="black" points="6332.23,-550.76 6335.71,-540.76 6326.75,-546.41 6332.23,-550.76"/>
</g>
<!-- v_14&#45;&gt;attn_14 -->
<g id="edge150" class="edge">
<title>v_14&#45;&gt;attn_14</title>
<path fill="none" stroke="black" d="M6413.21,-577.47C6405.26,-568.82 6395.51,-558.22 6386.33,-548.23"/>
<polygon fill="black" stroke="black" points="6388.8,-545.75 6379.46,-540.76 6383.65,-550.49 6388.8,-545.75"/>
</g>
<!-- out_14 -->
<g id="node122" class="node">
<title>out_14</title>
<polygon fill="lightgreen" stroke="black" points="6362,-442.87 6242,-442.87 6242,-404.87 6362,-404.87 6362,-442.87"/>
<text text-anchor="middle" x="6302" y="-427.67" font-family="Arial" font-size="14.00">Attention^(3,2)</text>
<text text-anchor="middle" x="6302" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_14&#45;&gt;out_14 -->
<g id="edge151" class="edge">
<title>attn_14&#45;&gt;out_14</title>
<path fill="none" stroke="black" d="M6340.38,-487.68C6333.5,-476.42 6325.41,-463.18 6318.44,-451.77"/>
<polygon fill="black" stroke="black" points="6321.33,-449.79 6313.13,-443.08 6315.36,-453.44 6321.33,-449.79"/>
</g>
<!-- out_14&#45;&gt;concat_group_3 -->
<g id="edge176" class="edge">
<title>out_14&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6261.09,-404.82C6214.33,-384.18 6136.98,-350.04 6080.46,-325.1"/>
<polygon fill="black" stroke="black" points="6081.79,-321.86 6071.23,-321.02 6078.96,-328.26 6081.79,-321.86"/>
<text text-anchor="middle" x="6239" y="-367.8" font-family="Arial" font-size="14.00">GPU 14 slice</text>
</g>
<!-- q_15 -->
<g id="node126" class="node">
<title>q_15</title>
<polygon fill="lightcyan" stroke="black" points="7048,-615.74 6928,-615.74 6928,-577.74 7048,-577.74 7048,-615.74"/>
<text text-anchor="middle" x="6988" y="-600.54" font-family="Arial" font-size="14.00">Q^(3,3)</text>
<text text-anchor="middle" x="6988" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_q_15&#45;&gt;q_15 -->
<g id="edge155" class="edge">
<title>proj_q_15&#45;&gt;q_15</title>
<path fill="none" stroke="black" d="M6979.18,-652.33C6980.54,-643.96 6982.04,-634.65 6983.42,-626.11"/>
<polygon fill="black" stroke="black" points="6986.88,-626.64 6985.02,-616.21 6979.97,-625.52 6986.88,-626.64"/>
</g>
<!-- k_15 -->
<g id="node127" class="node">
<title>k_15</title>
<polygon fill="lightcyan" stroke="black" points="6772,-615.74 6652,-615.74 6652,-577.74 6772,-577.74 6772,-615.74"/>
<text text-anchor="middle" x="6712" y="-600.54" font-family="Arial" font-size="14.00">K^(3,3)</text>
<text text-anchor="middle" x="6712" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_k_15&#45;&gt;k_15 -->
<g id="edge156" class="edge">
<title>proj_k_15&#45;&gt;k_15</title>
<path fill="none" stroke="black" d="M6709.29,-652.33C6709.7,-644.05 6710.16,-634.85 6710.58,-626.39"/>
<polygon fill="black" stroke="black" points="6714.08,-626.37 6711.08,-616.21 6707.09,-626.02 6714.08,-626.37"/>
</g>
<!-- v_15 -->
<g id="node128" class="node">
<title>v_15</title>
<polygon fill="lightcyan" stroke="black" points="6910,-615.74 6790,-615.74 6790,-577.74 6910,-577.74 6910,-615.74"/>
<text text-anchor="middle" x="6850" y="-600.54" font-family="Arial" font-size="14.00">V^(3,3)</text>
<text text-anchor="middle" x="6850" y="-585.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- proj_v_15&#45;&gt;v_15 -->
<g id="edge157" class="edge">
<title>proj_v_15&#45;&gt;v_15</title>
<path fill="none" stroke="black" d="M6843.22,-652.33C6844.25,-644.05 6845.39,-634.85 6846.44,-626.39"/>
<polygon fill="black" stroke="black" points="6849.95,-626.56 6847.71,-616.21 6843,-625.7 6849.95,-626.56"/>
</g>
<!-- attn_15 -->
<g id="node129" class="node">
<title>attn_15</title>
<polygon fill="lightpink" stroke="black" points="6811.5,-540.74 6688.5,-540.74 6688.5,-487.74 6811.5,-487.74 6811.5,-540.74"/>
<text text-anchor="middle" x="6750" y="-525.54" font-family="Arial" font-size="14.00">Softmax Attention</text>
<text text-anchor="middle" x="6750" y="-510.54" font-family="Arial" font-size="14.00">QK^TV/√128</text>
<text text-anchor="middle" x="6750" y="-495.54" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- q_15&#45;&gt;attn_15 -->
<g id="edge158" class="edge">
<title>q_15&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M6934.59,-577.67C6901.12,-566.36 6857.59,-551.63 6821.21,-539.33"/>
<polygon fill="black" stroke="black" points="6822.24,-535.98 6811.64,-536.09 6819.99,-542.61 6822.24,-535.98"/>
</g>
<!-- k_15&#45;&gt;attn_15 -->
<g id="edge159" class="edge">
<title>k_15&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M6720.62,-577.47C6724.47,-569.33 6729.13,-559.46 6733.59,-550"/>
<polygon fill="black" stroke="black" points="6736.85,-551.29 6737.95,-540.76 6730.52,-548.31 6736.85,-551.29"/>
</g>
<!-- v_15&#45;&gt;attn_15 -->
<g id="edge160" class="edge">
<title>v_15&#45;&gt;attn_15</title>
<path fill="none" stroke="black" d="M6827.31,-577.47C6816.14,-568.48 6802.35,-557.38 6789.53,-547.06"/>
<polygon fill="black" stroke="black" points="6791.68,-544.3 6781.7,-540.76 6787.29,-549.75 6791.68,-544.3"/>
</g>
<!-- out_15 -->
<g id="node130" class="node">
<title>out_15</title>
<polygon fill="lightgreen" stroke="black" points="6782,-442.87 6662,-442.87 6662,-404.87 6782,-404.87 6782,-442.87"/>
<text text-anchor="middle" x="6722" y="-427.67" font-family="Arial" font-size="14.00">Attention^(3,3)</text>
<text text-anchor="middle" x="6722" y="-412.67" font-family="Arial" font-size="14.00">ℝ^(1024×L×128)</text>
</g>
<!-- attn_15&#45;&gt;out_15 -->
<g id="edge161" class="edge">
<title>attn_15&#45;&gt;out_15</title>
<path fill="none" stroke="black" d="M6741.9,-487.68C6738.44,-476.75 6734.39,-463.96 6730.85,-452.79"/>
<polygon fill="black" stroke="black" points="6734.13,-451.56 6727.77,-443.08 6727.45,-453.67 6734.13,-451.56"/>
</g>
<!-- out_15&#45;&gt;concat_group_3 -->
<g id="edge177" class="edge">
<title>out_15&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6670.37,-404.74C6660.39,-401.74 6649.94,-398.94 6640,-396.87 6586.19,-385.68 6201.49,-358.62 6148,-346 6125.63,-340.72 6101.99,-332.75 6080.71,-324.63"/>
<polygon fill="black" stroke="black" points="6081.7,-321.26 6071.11,-320.9 6079.16,-327.78 6081.7,-321.26"/>
<text text-anchor="middle" x="6511" y="-367.8" font-family="Arial" font-size="14.00">GPU 15 slice</text>
</g>
<!-- final_concat -->
<g id="node135" class="node">
<title>final_concat</title>
<polygon fill="gold" stroke="black" points="4638,-189 4501,-151 4638,-113 4775,-151 4638,-189"/>
<text text-anchor="middle" x="4638" y="-154.8" font-family="Arial" font-size="14.00">Final Concatenation</text>
<text text-anchor="middle" x="4638" y="-139.8" font-family="Arial" font-size="14.00">ℝ^(1024×L×8192)</text>
</g>
<!-- concat_group_0&#45;&gt;final_concat -->
<g id="edge178" class="edge">
<title>concat_group_0&#45;&gt;final_concat</title>
<path fill="none" stroke="black" stroke-width="2" d="M1354.04,-287.26C1870.41,-265.99 3972.47,-179.41 4511.54,-157.21"/>
<polygon fill="black" stroke="black" stroke-width="2" points="4511.83,-160.7 4521.68,-156.79 4511.55,-153.71 4511.83,-160.7"/>
<text text-anchor="middle" x="3287.5" y="-210.8" font-family="Arial" font-size="14.00">Group 0 output</text>
</g>
<!-- concat_group_1&#45;&gt;final_concat -->
<g id="edge179" class="edge">
<title>concat_group_1&#45;&gt;final_concat</title>
<path fill="none" stroke="black" stroke-width="2" d="M2861.37,-284.02C3190.39,-259.57 4182.8,-185.83 4522.49,-160.58"/>
<polygon fill="black" stroke="black" stroke-width="2" points="4522.88,-164.06 4532.59,-159.83 4522.36,-157.08 4522.88,-164.06"/>
<text text-anchor="middle" x="3909.5" y="-210.8" font-family="Arial" font-size="14.00">Group 1 output</text>
</g>
<!-- concat_group_2&#45;&gt;final_concat -->
<g id="edge180" class="edge">
<title>concat_group_2&#45;&gt;final_concat</title>
<path fill="none" stroke="black" stroke-width="2" d="M4638,-239.87C4638,-226.62 4638,-212.45 4638,-199.45"/>
<polygon fill="black" stroke="black" stroke-width="2" points="4641.5,-199.31 4638,-189.31 4634.5,-199.31 4641.5,-199.31"/>
<text text-anchor="middle" x="4683.5" y="-210.8" font-family="Arial" font-size="14.00">Group 2 output</text>
</g>
<!-- concat_group_3&#45;&gt;final_concat -->
<g id="edge181" class="edge">
<title>concat_group_3&#45;&gt;final_concat</title>
<path fill="none" stroke="black" stroke-width="2" d="M5908.56,-281.65C5656.66,-255.95 5004.38,-189.39 4745.85,-163"/>
<polygon fill="black" stroke="black" stroke-width="2" points="4746,-159.5 4735.7,-161.97 4745.29,-166.47 4746,-159.5"/>
<text text-anchor="middle" x="5369.5" y="-210.8" font-family="Arial" font-size="14.00">Group 3 output</text>
</g>
<!-- output -->
<g id="node136" class="node">
<title>output</title>
<polygon fill="lightblue" stroke="black" points="4770.91,-76 4559.48,-76 4505.09,0 4716.52,0 4770.91,-76"/>
<text text-anchor="middle" x="4638" y="-41.8" font-family="Arial" font-size="14.00">Output Tensor</text>
<text text-anchor="middle" x="4638" y="-26.8" font-family="Arial" font-size="14.00">ℝ^(1024×L×8192)</text>
</g>
<!-- final_concat&#45;&gt;output -->
<g id="edge182" class="edge">
<title>final_concat&#45;&gt;output</title>
<path fill="none" stroke="black" d="M4638,-112.73C4638,-104.31 4638,-95.26 4638,-86.48"/>
<polygon fill="black" stroke="black" points="4641.5,-86.36 4638,-76.36 4634.5,-86.36 4641.5,-86.36"/>
</g>
<!-- comm_group_0 -->
<g id="node137" class="node">
<title>comm_group_0</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1740" cy="-423.87" rx="52.15" ry="26.74"/>
<text text-anchor="middle" x="1740" y="-427.67" font-family="Arial" font-size="14.00">All&#45;gather</text>
<text text-anchor="middle" x="1740" y="-412.67" font-family="Arial" font-size="14.00">Group 0</text>
</g>
<!-- comm_group_0&#45;&gt;concat_group_0 -->
<g id="edge183" class="edge">
<title>comm_group_0&#45;&gt;concat_group_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1703.4,-404.56C1697.02,-401.75 1690.39,-399.06 1684,-396.87 1568.35,-357.14 1430.54,-327.94 1339.25,-311.01"/>
<polygon fill="black" stroke="black" points="1339.65,-307.53 1329.18,-309.16 1338.38,-314.41 1339.65,-307.53"/>
<text text-anchor="middle" x="1669.5" y="-367.8" font-family="Arial" font-size="14.00">Gather 4 slices</text>
</g>
<!-- comm_group_1 -->
<g id="node138" class="node">
<title>comm_group_1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2692" cy="-423.87" rx="52.15" ry="26.74"/>
<text text-anchor="middle" x="2692" y="-427.67" font-family="Arial" font-size="14.00">All&#45;gather</text>
<text text-anchor="middle" x="2692" y="-412.67" font-family="Arial" font-size="14.00">Group 1</text>
</g>
<!-- comm_group_1&#45;&gt;concat_group_1 -->
<g id="edge184" class="edge">
<title>comm_group_1&#45;&gt;concat_group_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2693.75,-396.92C2695.14,-386.38 2697.6,-374.3 2702,-364 2705.38,-356.09 2709.81,-348.25 2714.67,-340.83"/>
<polygon fill="black" stroke="black" points="2717.73,-342.56 2720.54,-332.34 2711.97,-338.58 2717.73,-342.56"/>
<text text-anchor="middle" x="2747.5" y="-367.8" font-family="Arial" font-size="14.00">Gather 4 slices</text>
</g>
<!-- comm_group_2 -->
<g id="node139" class="node">
<title>comm_group_2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4904" cy="-423.87" rx="52.15" ry="26.74"/>
<text text-anchor="middle" x="4904" y="-427.67" font-family="Arial" font-size="14.00">All&#45;gather</text>
<text text-anchor="middle" x="4904" y="-412.67" font-family="Arial" font-size="14.00">Group 2</text>
</g>
<!-- comm_group_2&#45;&gt;concat_group_2 -->
<g id="edge185" class="edge">
<title>comm_group_2&#45;&gt;concat_group_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4866.73,-404.82C4824.99,-384.59 4756.47,-351.4 4705.29,-326.6"/>
<polygon fill="black" stroke="black" points="4706.8,-323.44 4696.27,-322.23 4703.74,-329.74 4706.8,-323.44"/>
<text text-anchor="middle" x="4855.5" y="-367.8" font-family="Arial" font-size="14.00">Gather 4 slices</text>
</g>
<!-- comm_group_3 -->
<g id="node140" class="node">
<title>comm_group_3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="7116" cy="-423.87" rx="52.15" ry="26.74"/>
<text text-anchor="middle" x="7116" y="-427.67" font-family="Arial" font-size="14.00">All&#45;gather</text>
<text text-anchor="middle" x="7116" y="-412.67" font-family="Arial" font-size="14.00">Group 3</text>
</g>
<!-- comm_group_3&#45;&gt;concat_group_3 -->
<g id="edge186" class="edge">
<title>comm_group_3&#45;&gt;concat_group_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7080.58,-404.05C7073.9,-401.19 7066.85,-398.62 7060,-396.87 6842.06,-341.26 6779.58,-376.27 6555,-364 6464.6,-359.06 6236.69,-364.19 6148,-346 6125.17,-341.32 6101.13,-333.39 6079.62,-325.12"/>
<polygon fill="black" stroke="black" points="6080.84,-321.84 6070.25,-321.43 6078.28,-328.35 6080.84,-321.84"/>
<text text-anchor="middle" x="7021.5" y="-367.8" font-family="Arial" font-size="14.00">Gather 4 slices</text>
</g>
<!-- final_comm -->
<g id="node141" class="node">
<title>final_comm</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="6233" cy="-293" rx="75.82" ry="26.74"/>
<text text-anchor="middle" x="6233" y="-296.8" font-family="Arial" font-size="14.00">Final Gather</text>
<text text-anchor="middle" x="6233" y="-281.8" font-family="Arial" font-size="14.00">Across Groups</text>
</g>
<!-- final_comm&#45;&gt;final_concat -->
<g id="edge187" class="edge">
<title>final_comm&#45;&gt;final_concat</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6202.51,-268.28C6187.06,-257.63 6167.48,-246.1 6148,-240 5896.42,-161.18 5110.52,-151.87 4783.28,-151.52"/>
<polygon fill="black" stroke="black" points="4783.26,-148.02 4773.25,-151.51 4783.25,-155.02 4783.26,-148.02"/>
<text text-anchor="middle" x="6125" y="-210.8" font-family="Arial" font-size="14.00">Gather 4 group outputs</text>
</g>
</g>
</svg>
