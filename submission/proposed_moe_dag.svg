<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: proposed_moe Pages: 1 -->
<svg width="2160pt" height="700pt"
 viewBox="0.00 0.00 2160.00 700.01" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.27 0.27) rotate(0) translate(4 2594.48)">
<title>proposed_moe</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2594.48 8014,-2594.48 8014,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="black" points="155,-1906.74 155,-2509.74 7976,-2509.74 7976,-1906.74 155,-1906.74"/>
<text text-anchor="middle" x="4065.5" y="-2494.54" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" points="181,-1298.74 181,-1887.74 8002,-1887.74 8002,-1298.74 181,-1298.74"/>
<text text-anchor="middle" x="4091.5" y="-1872.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" points="99,-690.74 99,-1279.74 7920,-1279.74 7920,-690.74 99,-690.74"/>
<text text-anchor="middle" x="4009.5" y="-1264.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" points="8,-82.74 8,-671.74 7829,-671.74 7829,-82.74 8,-82.74"/>
<text text-anchor="middle" x="3918.5" y="-656.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcoral" stroke="black" cx="4065" cy="-2563.61" rx="146.24" ry="26.74"/>
<text text-anchor="middle" x="4065" y="-2567.41" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="4065" y="-2552.41" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_size]</text>
</g>
<!-- route_0 -->
<g id="node2" class="node">
<title>route_0</title>
<polygon fill="lightyellow" stroke="black" points="4217.31,-2478.74 3975.02,-2478.74 3912.69,-2372.74 4154.98,-2372.74 4217.31,-2478.74"/>
<text text-anchor="middle" x="4065" y="-2437.04" font-family="Times,serif" font-size="14.00">Routing Layer 1</text>
<text text-anchor="middle" x="4065" y="-2422.04" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="4065" y="-2407.04" font-family="Times,serif" font-size="14.00">Gate Computation</text>
</g>
<!-- input&#45;&gt;route_0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;route_0</title>
<path fill="none" stroke="black" d="M4065,-2536.73C4065,-2523.22 4065,-2506.04 4065,-2489.3"/>
<polygon fill="black" stroke="black" points="4068.5,-2488.96 4065,-2478.96 4061.5,-2488.96 4068.5,-2488.96"/>
</g>
<!-- split_0 -->
<g id="node3" class="node">
<title>split_0</title>
<polygon fill="lightyellow" stroke="black" points="4289.95,-2335.74 3932.1,-2335.74 3840.05,-2259.74 4197.9,-2259.74 4289.95,-2335.74"/>
<text text-anchor="middle" x="4065" y="-2301.54" font-family="Times,serif" font-size="14.00">Split Tokens Layer 1</text>
<text text-anchor="middle" x="4065" y="-2286.54" font-family="Times,serif" font-size="14.00">[Variable tokens per expert]</text>
</g>
<!-- route_0&#45;&gt;split_0 -->
<g id="edge2" class="edge">
<title>route_0&#45;&gt;split_0</title>
<path fill="none" stroke="black" d="M4065,-2372.4C4065,-2363.65 4065,-2354.62 4065,-2346.01"/>
<polygon fill="black" stroke="black" points="4068.5,-2345.76 4065,-2335.76 4061.5,-2345.76 4068.5,-2345.76"/>
</g>
<!-- expert_0_0 -->
<g id="node4" class="node">
<title>expert_0_0</title>
<polygon fill="lightblue" stroke="black" points="633.19,-2208.74 259.06,-2208.74 162.81,-2102.74 536.94,-2102.74 633.19,-2208.74"/>
<text text-anchor="middle" x="398" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="398" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="398" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_0 -->
<g id="edge3" class="edge">
<title>split_0&#45;&gt;expert_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3883.41,-2295.84C3429.5,-2293.03 2208.91,-2282.02 1192,-2241.74 947.75,-2232.07 885.23,-2241.54 643,-2208.74 642.66,-2208.69 642.31,-2208.65 641.97,-2208.6"/>
<polygon fill="black" stroke="black" points="642.33,-2205.12 631.94,-2207.18 641.35,-2212.05 642.33,-2205.12"/>
<text text-anchor="middle" x="1240.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_1 -->
<g id="node5" class="node">
<title>expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="1122.19,-2208.74 748.06,-2208.74 651.81,-2102.74 1025.94,-2102.74 1122.19,-2208.74"/>
<text text-anchor="middle" x="887" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="887" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="887" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_1 -->
<g id="edge4" class="edge">
<title>split_0&#45;&gt;expert_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3882.35,-2294.75C3483.91,-2289.93 2506.82,-2275.42 1689,-2241.74 1441.22,-2231.54 1377.76,-2241.91 1132,-2208.74 1131.66,-2208.69 1131.31,-2208.65 1130.97,-2208.6"/>
<polygon fill="black" stroke="black" points="1131.33,-2205.12 1120.94,-2207.19 1130.35,-2212.05 1131.33,-2205.12"/>
<text text-anchor="middle" x="1737.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_2 -->
<g id="node6" class="node">
<title>expert_0_2</title>
<polygon fill="lightblue" stroke="black" points="1611.19,-2208.74 1237.06,-2208.74 1140.81,-2102.74 1514.94,-2102.74 1611.19,-2208.74"/>
<text text-anchor="middle" x="1376" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1376" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1376" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_2 -->
<g id="edge5" class="edge">
<title>split_0&#45;&gt;expert_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3879.91,-2292.9C3545.57,-2285.61 2818.71,-2268.08 2206,-2241.74 1945.83,-2230.56 1879.12,-2243.21 1621,-2208.74 1620.66,-2208.69 1620.31,-2208.65 1619.97,-2208.6"/>
<polygon fill="black" stroke="black" points="1620.32,-2205.12 1609.93,-2207.2 1619.35,-2212.05 1620.32,-2205.12"/>
<text text-anchor="middle" x="2254.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_3 -->
<g id="node7" class="node">
<title>expert_0_3</title>
<polygon fill="lightblue" stroke="black" points="2100.19,-2208.74 1726.06,-2208.74 1629.81,-2102.74 2003.94,-2102.74 2100.19,-2208.74"/>
<text text-anchor="middle" x="1865" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1865" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1865" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_3 -->
<g id="edge6" class="edge">
<title>split_0&#45;&gt;expert_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3879.91,-2292.65C3460.59,-2282.7 2448.36,-2254.61 2110,-2208.74 2109.66,-2208.69 2109.31,-2208.65 2108.97,-2208.6"/>
<polygon fill="black" stroke="black" points="2109.33,-2205.12 2098.94,-2207.18 2108.35,-2212.05 2109.33,-2205.12"/>
<text text-anchor="middle" x="2526.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_4 -->
<g id="node8" class="node">
<title>expert_0_4</title>
<polygon fill="lightblue" stroke="black" points="2589.19,-2208.74 2215.06,-2208.74 2118.81,-2102.74 2492.94,-2102.74 2589.19,-2208.74"/>
<text text-anchor="middle" x="2354" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2354" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2354" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_4 -->
<g id="edge7" class="edge">
<title>split_0&#45;&gt;expert_0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3881.88,-2294.5C3603.56,-2289.13 3057.91,-2270.86 2599,-2208.74 2598.66,-2208.69 2598.31,-2208.65 2597.97,-2208.6"/>
<polygon fill="black" stroke="black" points="2598.33,-2205.12 2587.94,-2207.18 2597.35,-2212.05 2598.33,-2205.12"/>
<text text-anchor="middle" x="2926.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_5 -->
<g id="node9" class="node">
<title>expert_0_5</title>
<polygon fill="lightblue" stroke="black" points="3078.19,-2208.74 2704.06,-2208.74 2607.81,-2102.74 2981.94,-2102.74 3078.19,-2208.74"/>
<text text-anchor="middle" x="2843" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2843" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2843" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_5 -->
<g id="edge8" class="edge">
<title>split_0&#45;&gt;expert_0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3864.31,-2279.95C3600.73,-2257.71 3162.49,-2219.96 3088,-2208.74 3087.53,-2208.67 3087.06,-2208.6 3086.59,-2208.53"/>
<polygon fill="black" stroke="black" points="3087.05,-2205.06 3076.63,-2206.98 3085.97,-2211.97 3087.05,-2205.06"/>
<text text-anchor="middle" x="3445.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_6 -->
<g id="node10" class="node">
<title>expert_0_6</title>
<polygon fill="lightblue" stroke="black" points="3567.19,-2208.74 3193.06,-2208.74 3096.81,-2102.74 3470.94,-2102.74 3567.19,-2208.74"/>
<text text-anchor="middle" x="3332" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3332" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3332" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_6 -->
<g id="edge9" class="edge">
<title>split_0&#45;&gt;expert_0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3851.55,-2259.71C3766.07,-2244.51 3666.76,-2226.35 3577,-2208.74 3576.38,-2208.62 3575.77,-2208.5 3575.15,-2208.38"/>
<polygon fill="black" stroke="black" points="3575.55,-2204.89 3565.06,-2206.38 3574.19,-2211.76 3575.55,-2204.89"/>
<text text-anchor="middle" x="3799.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_7 -->
<g id="node11" class="node">
<title>expert_0_7</title>
<polygon fill="lightblue" stroke="black" points="4056.19,-2208.74 3682.06,-2208.74 3585.81,-2102.74 3959.94,-2102.74 4056.19,-2208.74"/>
<text text-anchor="middle" x="3821" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3821" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3821" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_7 -->
<g id="edge10" class="edge">
<title>split_0&#45;&gt;expert_0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4000.25,-2259.59C3975.79,-2245.56 3947.36,-2229.24 3920.45,-2213.8"/>
<polygon fill="black" stroke="black" points="3922.19,-2210.76 3911.77,-2208.82 3918.7,-2216.83 3922.19,-2210.76"/>
<text text-anchor="middle" x="4012.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_8 -->
<g id="node12" class="node">
<title>expert_0_8</title>
<polygon fill="lightblue" stroke="black" points="4545.19,-2208.74 4171.06,-2208.74 4074.81,-2102.74 4448.94,-2102.74 4545.19,-2208.74"/>
<text text-anchor="middle" x="4310" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="4310" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4310" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_8 -->
<g id="edge11" class="edge">
<title>split_0&#45;&gt;expert_0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4130.01,-2259.59C4154.57,-2245.56 4183.12,-2229.24 4210.14,-2213.8"/>
<polygon fill="black" stroke="black" points="4211.91,-2216.82 4218.86,-2208.82 4208.44,-2210.74 4211.91,-2216.82"/>
<text text-anchor="middle" x="4235.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_9 -->
<g id="node13" class="node">
<title>expert_0_9</title>
<polygon fill="lightblue" stroke="black" points="5034.19,-2208.74 4660.06,-2208.74 4563.81,-2102.74 4937.94,-2102.74 5034.19,-2208.74"/>
<text text-anchor="middle" x="4799" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4799" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="4799" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_9 -->
<g id="edge12" class="edge">
<title>split_0&#45;&gt;expert_0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4212.34,-2271.46C4309.51,-2254.48 4439.51,-2231.19 4554,-2208.74 4579.63,-2203.71 4606.73,-2198.18 4633.19,-2192.66"/>
<polygon fill="black" stroke="black" points="4634.22,-2196.02 4643.29,-2190.55 4632.79,-2189.17 4634.22,-2196.02"/>
<text text-anchor="middle" x="4495.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_10 -->
<g id="node14" class="node">
<title>expert_0_10</title>
<polygon fill="lightblue" stroke="black" points="5523.19,-2208.74 5149.06,-2208.74 5052.81,-2102.74 5426.94,-2102.74 5523.19,-2208.74"/>
<text text-anchor="middle" x="5288" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="5288" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="5288" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_10 -->
<g id="edge13" class="edge">
<title>split_0&#45;&gt;expert_0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4232.28,-2287.78C4427.6,-2275.92 4760,-2251.35 5043,-2208.74 5069.33,-2204.78 5097.08,-2199.73 5124.06,-2194.36"/>
<polygon fill="black" stroke="black" points="5124.85,-2197.77 5133.97,-2192.36 5123.47,-2190.9 5124.85,-2197.77"/>
<text text-anchor="middle" x="4958.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_11 -->
<g id="node15" class="node">
<title>expert_0_11</title>
<polygon fill="lightblue" stroke="black" points="6012.19,-2208.74 5638.06,-2208.74 5541.81,-2102.74 5915.94,-2102.74 6012.19,-2208.74"/>
<text text-anchor="middle" x="5777" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="5777" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="5777" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_11 -->
<g id="edge14" class="edge">
<title>split_0&#45;&gt;expert_0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4240.57,-2294.84C4516.66,-2289.92 5068.62,-2272.25 5532,-2208.74 5558.47,-2205.11 5586.36,-2200.23 5613.44,-2194.9"/>
<polygon fill="black" stroke="black" points="5614.26,-2198.31 5623.38,-2192.92 5612.89,-2191.44 5614.26,-2198.31"/>
<text text-anchor="middle" x="5421.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_12 -->
<g id="node16" class="node">
<title>expert_0_12</title>
<polygon fill="lightblue" stroke="black" points="6501.19,-2208.74 6127.06,-2208.74 6030.81,-2102.74 6404.94,-2102.74 6501.19,-2208.74"/>
<text text-anchor="middle" x="6266" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="6266" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="6266" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_12 -->
<g id="edge15" class="edge">
<title>split_0&#45;&gt;expert_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4238.22,-2292.94C4650.13,-2283.24 5679.2,-2255.06 6021,-2208.74 6047.48,-2205.15 6075.36,-2200.29 6102.45,-2194.97"/>
<polygon fill="black" stroke="black" points="6103.27,-2198.38 6112.39,-2192.99 6101.9,-2191.51 6103.27,-2198.38"/>
<text text-anchor="middle" x="5871.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_13 -->
<g id="node17" class="node">
<title>expert_0_13</title>
<polygon fill="lightblue" stroke="black" points="6990.19,-2208.74 6616.06,-2208.74 6519.81,-2102.74 6893.94,-2102.74 6990.19,-2208.74"/>
<text text-anchor="middle" x="6755" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6755" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6755" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_13 -->
<g id="edge16" class="edge">
<title>split_0&#45;&gt;expert_0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4238.37,-2293.15C4567.19,-2286.01 5304.03,-2268.36 5924,-2241.74 6184.62,-2230.55 6251.44,-2243.25 6510,-2208.74 6536.58,-2205.19 6564.58,-2200.34 6591.76,-2195.01"/>
<polygon fill="black" stroke="black" points="6592.61,-2198.41 6601.73,-2193.02 6591.24,-2191.54 6592.61,-2198.41"/>
<text text-anchor="middle" x="6388.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_14 -->
<g id="node18" class="node">
<title>expert_0_14</title>
<polygon fill="lightblue" stroke="black" points="7479.19,-2208.74 7105.06,-2208.74 7008.81,-2102.74 7382.94,-2102.74 7479.19,-2208.74"/>
<text text-anchor="middle" x="7244" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7244" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="7244" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_14 -->
<g id="edge17" class="edge">
<title>split_0&#45;&gt;expert_0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4240.56,-2294.83C4634.39,-2290.08 5618.28,-2275.58 6441,-2241.74 6689.22,-2231.53 6752.8,-2241.96 6999,-2208.74 7025.58,-2205.15 7053.57,-2200.28 7080.75,-2194.94"/>
<polygon fill="black" stroke="black" points="7081.6,-2198.34 7090.72,-2192.96 7080.23,-2191.48 7081.6,-2198.34"/>
<text text-anchor="middle" x="6885.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- expert_0_15 -->
<g id="node19" class="node">
<title>expert_0_15</title>
<polygon fill="lightblue" stroke="black" points="7968.19,-2208.74 7594.06,-2208.74 7497.81,-2102.74 7871.94,-2102.74 7968.19,-2208.74"/>
<text text-anchor="middle" x="7733" y="-2167.04" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="7733" y="-2152.04" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="7733" y="-2137.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_0&#45;&gt;expert_0_15 -->
<g id="edge18" class="edge">
<title>split_0&#45;&gt;expert_0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4242.03,-2295.86C4692.27,-2293.08 5917.66,-2282.1 6938,-2241.74 7182.69,-2232.06 7245.33,-2241.59 7488,-2208.74 7514.48,-2205.16 7542.36,-2200.3 7569.45,-2194.98"/>
<polygon fill="black" stroke="black" points="7570.27,-2198.39 7579.39,-2193 7568.9,-2191.52 7570.27,-2198.39"/>
<text text-anchor="middle" x="7376.5" y="-2230.54" font-family="Times,serif" font-size="14.00">token routing</text>
</g>
<!-- gather_0 -->
<g id="node20" class="node">
<title>gather_0</title>
<polygon fill="lightyellow" stroke="black" points="4185.88,-2065.74 3885.42,-2065.74 3808.12,-1989.74 4108.58,-1989.74 4185.88,-2065.74"/>
<text text-anchor="middle" x="3997" y="-2031.54" font-family="Times,serif" font-size="14.00">Gather Results Layer 1</text>
<text text-anchor="middle" x="3997" y="-2016.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- expert_0_0&#45;&gt;gather_0 -->
<g id="edge19" class="edge">
<title>expert_0_0&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M550.85,-2117.83C581.22,-2111.77 612.99,-2106.3 643,-2102.74 950.73,-2066.2 1030.2,-2091.17 1340,-2083.74 2289.44,-2060.97 3429.85,-2039.26 3840.3,-2031.63"/>
<polygon fill="black" stroke="black" points="3840.52,-2035.12 3850.46,-2031.44 3840.39,-2028.12 3840.52,-2035.12"/>
</g>
<!-- expert_0_1&#45;&gt;gather_0 -->
<g id="edge20" class="edge">
<title>expert_0_1&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M1039.85,-2117.84C1070.22,-2111.77 1101.99,-2106.31 1132,-2102.74 1436.64,-2066.52 1515.32,-2091.84 1822,-2083.74 2578.88,-2063.75 3483.95,-2041.34 3841.12,-2032.56"/>
<polygon fill="black" stroke="black" points="3841.35,-2036.06 3851.26,-2032.31 3841.18,-2029.06 3841.35,-2036.06"/>
</g>
<!-- expert_0_2&#45;&gt;gather_0 -->
<g id="edge21" class="edge">
<title>expert_0_2&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M1528.86,-2117.92C1559.23,-2111.85 1591,-2106.36 1621,-2102.74 2052,-2050.71 3379.31,-2034.22 3838.63,-2030"/>
<polygon fill="black" stroke="black" points="3838.68,-2033.5 3848.65,-2029.9 3838.62,-2026.5 3838.68,-2033.5"/>
</g>
<!-- expert_0_3&#45;&gt;gather_0 -->
<g id="edge22" class="edge">
<title>expert_0_3&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M2018.21,-2118.05C2048.48,-2111.99 2080.12,-2106.47 2110,-2102.74 2442.95,-2061.18 3449.8,-2038.77 3840.07,-2031.46"/>
<polygon fill="black" stroke="black" points="3840.37,-2034.95 3850.31,-2031.27 3840.24,-2027.96 3840.37,-2034.95"/>
</g>
<!-- expert_0_4&#45;&gt;gather_0 -->
<g id="edge23" class="edge">
<title>expert_0_4&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M2507.26,-2118.38C2537.52,-2112.28 2569.15,-2106.67 2599,-2102.74 3045.15,-2043.95 3577.22,-2031.49 3837.56,-2029.1"/>
<polygon fill="black" stroke="black" points="3837.87,-2032.6 3847.84,-2029.01 3837.81,-2025.6 3837.87,-2032.6"/>
</g>
<!-- expert_0_5&#45;&gt;gather_0 -->
<g id="edge24" class="edge">
<title>expert_0_5&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M2997.01,-2118.92C3027.06,-2112.82 3058.42,-2107.07 3088,-2102.74 3351.89,-2064.16 3662.05,-2044.31 3843.34,-2035.25"/>
<polygon fill="black" stroke="black" points="3843.67,-2038.74 3853.48,-2034.74 3843.32,-2031.74 3843.67,-2038.74"/>
</g>
<!-- expert_0_6&#45;&gt;gather_0 -->
<g id="edge25" class="edge">
<title>expert_0_6&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M3487.69,-2120.85C3517.31,-2114.64 3548.08,-2108.35 3577,-2102.74 3670.94,-2084.5 3777.08,-2065.82 3859.16,-2051.79"/>
<polygon fill="black" stroke="black" points="3859.77,-2055.23 3869.04,-2050.1 3858.6,-2048.33 3859.77,-2055.23"/>
</g>
<!-- expert_0_7&#45;&gt;gather_0 -->
<g id="edge26" class="edge">
<title>expert_0_7&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M3893.86,-2102.58C3908.11,-2092.38 3922.91,-2081.78 3936.7,-2071.91"/>
<polygon fill="black" stroke="black" points="3939.05,-2074.53 3945.14,-2065.87 3934.97,-2068.84 3939.05,-2074.53"/>
</g>
<!-- expert_0_8&#45;&gt;gather_0 -->
<g id="edge27" class="edge">
<title>expert_0_8&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M4180.43,-2102.58C4153.17,-2091.61 4124.79,-2080.18 4098.72,-2069.69"/>
<polygon fill="black" stroke="black" points="4099.81,-2066.36 4089.23,-2065.87 4097.2,-2072.85 4099.81,-2066.36"/>
</g>
<!-- expert_0_9&#45;&gt;gather_0 -->
<g id="edge28" class="edge">
<title>expert_0_9&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M4565.66,-2104.78C4561.74,-2104.09 4557.86,-2103.4 4554,-2102.74 4428.96,-2081.2 4287.2,-2062.44 4177.99,-2049.21"/>
<polygon fill="black" stroke="black" points="4178.2,-2045.71 4167.85,-2047.98 4177.36,-2052.66 4178.2,-2045.71"/>
</g>
<!-- expert_0_10&#45;&gt;gather_0 -->
<g id="edge29" class="edge">
<title>expert_0_10&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M5054.06,-2104.35C5050.35,-2103.79 5046.66,-2103.26 5043,-2102.74 4733.94,-2059.22 4369.71,-2040.8 4162.81,-2033.38"/>
<polygon fill="black" stroke="black" points="4162.89,-2029.88 4152.77,-2033.03 4162.64,-2036.88 4162.89,-2029.88"/>
</g>
<!-- expert_0_11&#45;&gt;gather_0 -->
<g id="edge30" class="edge">
<title>expert_0_11&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M5543.07,-2104.24C5539.36,-2103.71 5535.67,-2103.21 5532,-2102.74 5033.77,-2038.28 4438.01,-2028.61 4157.75,-2028.01"/>
<polygon fill="black" stroke="black" points="4157.51,-2024.5 4147.5,-2027.99 4157.5,-2031.5 4157.51,-2024.5"/>
</g>
<!-- expert_0_12&#45;&gt;gather_0 -->
<g id="edge31" class="edge">
<title>expert_0_12&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M6032.08,-2104.18C6028.36,-2103.67 6024.67,-2103.19 6021,-2102.74 5662.59,-2058.49 4576.3,-2037.61 4160.92,-2031.08"/>
<polygon fill="black" stroke="black" points="4160.69,-2027.58 4150.63,-2030.92 4160.58,-2034.58 4160.69,-2027.58"/>
</g>
<!-- expert_0_13&#45;&gt;gather_0 -->
<g id="edge32" class="edge">
<title>expert_0_13&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M6521.08,-2104.14C6517.37,-2103.65 6513.67,-2103.18 6510,-2102.74 6052.53,-2047.91 4640.49,-2033.19 4159.45,-2029.71"/>
<polygon fill="black" stroke="black" points="4159.33,-2026.21 4149.3,-2029.64 4159.28,-2033.21 4159.33,-2026.21"/>
</g>
<!-- expert_0_14&#45;&gt;gather_0 -->
<g id="edge33" class="edge">
<title>expert_0_14&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M7009.76,-2104.09C7006.15,-2103.61 7002.56,-2103.16 6999,-2102.74 6694.36,-2066.52 6615.68,-2091.61 6309,-2083.74 5504.06,-2063.08 4541.42,-2041.04 4162.14,-2032.46"/>
<polygon fill="black" stroke="black" points="4161.99,-2028.95 4151.92,-2032.23 4161.84,-2035.95 4161.99,-2028.95"/>
</g>
<!-- expert_0_15&#45;&gt;gather_0 -->
<g id="edge34" class="edge">
<title>expert_0_15&#45;&gt;gather_0</title>
<path fill="none" stroke="black" d="M7498.76,-2104.06C7495.15,-2103.59 7491.56,-2103.15 7488,-2102.74 6830.4,-2026.67 4754,-2026.54 4158.24,-2028.14"/>
<polygon fill="black" stroke="black" points="4157.86,-2024.64 4147.87,-2028.17 4157.88,-2031.64 4157.86,-2024.64"/>
</g>
<!-- residual_0 -->
<g id="node21" class="node">
<title>residual_0</title>
<polygon fill="orange" stroke="black" points="4081.5,-1952.74 3912.5,-1952.74 3912.5,-1914.74 4081.5,-1914.74 4081.5,-1952.74"/>
<text text-anchor="middle" x="3997" y="-1937.54" font-family="Times,serif" font-size="14.00">Residual Add Layer 1</text>
<text text-anchor="middle" x="3997" y="-1922.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- gather_0&#45;&gt;residual_0 -->
<g id="edge35" class="edge">
<title>gather_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M3997,-1989.59C3997,-1980.68 3997,-1971.31 3997,-1962.89"/>
<polygon fill="black" stroke="black" points="4000.5,-1962.83 3997,-1952.83 3993.5,-1962.83 4000.5,-1962.83"/>
</g>
<!-- route_1 -->
<g id="node22" class="node">
<title>route_1</title>
<polygon fill="lightyellow" stroke="black" points="4149.31,-1856.74 3907.02,-1856.74 3844.69,-1750.74 4086.98,-1750.74 4149.31,-1856.74"/>
<text text-anchor="middle" x="3997" y="-1815.04" font-family="Times,serif" font-size="14.00">Routing Layer 2</text>
<text text-anchor="middle" x="3997" y="-1800.04" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3997" y="-1785.04" font-family="Times,serif" font-size="14.00">Gate Computation</text>
</g>
<!-- residual_0&#45;&gt;route_1 -->
<g id="edge36" class="edge">
<title>residual_0&#45;&gt;route_1</title>
<path fill="none" stroke="black" d="M3992.13,-1914.67C3990.84,-1902.11 3990.21,-1884.57 3990.25,-1867.18"/>
<polygon fill="black" stroke="black" points="3993.75,-1867.03 3990.35,-1856.99 3986.75,-1866.96 3993.75,-1867.03"/>
</g>
<!-- residual_0&#45;&gt;route_1 -->
<g id="edge37" class="edge">
<title>residual_0&#45;&gt;route_1</title>
<path fill="none" stroke="black" d="M4001.87,-1914.67C4003.16,-1902.11 4003.79,-1884.57 4003.75,-1867.18"/>
<polygon fill="black" stroke="black" points="4007.25,-1866.96 4003.65,-1856.99 4000.25,-1867.03 4007.25,-1866.96"/>
</g>
<!-- split_1 -->
<g id="node23" class="node">
<title>split_1</title>
<polygon fill="lightyellow" stroke="black" points="4221.95,-1713.74 3864.1,-1713.74 3772.05,-1637.74 4129.9,-1637.74 4221.95,-1713.74"/>
<text text-anchor="middle" x="3997" y="-1679.54" font-family="Times,serif" font-size="14.00">Split Tokens Layer 2</text>
<text text-anchor="middle" x="3997" y="-1664.54" font-family="Times,serif" font-size="14.00">[Variable tokens per expert]</text>
</g>
<!-- route_1&#45;&gt;split_1 -->
<g id="edge38" class="edge">
<title>route_1&#45;&gt;split_1</title>
<path fill="none" stroke="black" d="M3997,-1750.4C3997,-1741.65 3997,-1732.62 3997,-1724.01"/>
<polygon fill="black" stroke="black" points="4000.5,-1723.76 3997,-1713.76 3993.5,-1723.76 4000.5,-1723.76"/>
</g>
<!-- expert_1_0 -->
<g id="node24" class="node">
<title>expert_1_0</title>
<polygon fill="lightblue" stroke="black" points="659.19,-1600.74 285.06,-1600.74 188.81,-1494.74 562.94,-1494.74 659.19,-1600.74"/>
<text text-anchor="middle" x="424" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="424" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 16</text>
<text text-anchor="middle" x="424" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_0 -->
<g id="edge39" class="edge">
<title>split_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3812.62,-1671.32C3382.59,-1663.26 2279.69,-1642.05 1358,-1619.74 1051.75,-1612.33 973.2,-1636.91 669,-1600.74 668.78,-1600.71 668.55,-1600.69 668.33,-1600.66"/>
<polygon fill="black" stroke="black" points="668.6,-1597.17 658.24,-1599.39 667.73,-1604.11 668.6,-1597.17"/>
</g>
<!-- expert_1_1 -->
<g id="node25" class="node">
<title>expert_1_1</title>
<polygon fill="lightblue" stroke="black" points="1148.19,-1600.74 774.06,-1600.74 677.81,-1494.74 1051.94,-1494.74 1148.19,-1600.74"/>
<text text-anchor="middle" x="913" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="913" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 17</text>
<text text-anchor="middle" x="913" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_1 -->
<g id="edge41" class="edge">
<title>split_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3815.93,-1674.35C3274.86,-1672.51 1675.65,-1661.9 1158,-1600.74 1157.78,-1600.71 1157.55,-1600.69 1157.33,-1600.66"/>
<polygon fill="black" stroke="black" points="1157.6,-1597.17 1147.24,-1599.4 1156.73,-1604.11 1157.6,-1597.17"/>
</g>
<!-- expert_1_2 -->
<g id="node26" class="node">
<title>expert_1_2</title>
<polygon fill="lightblue" stroke="black" points="1637.19,-1600.74 1263.06,-1600.74 1166.81,-1494.74 1540.94,-1494.74 1637.19,-1600.74"/>
<text text-anchor="middle" x="1402" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="1402" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 18</text>
<text text-anchor="middle" x="1402" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_2 -->
<g id="edge43" class="edge">
<title>split_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3810.13,-1669.3C3263.15,-1653.31 1700.46,-1607.2 1647,-1600.74 1646.66,-1600.7 1646.31,-1600.66 1645.97,-1600.61"/>
<polygon fill="black" stroke="black" points="1646.28,-1597.13 1635.92,-1599.33 1645.39,-1604.07 1646.28,-1597.13"/>
</g>
<!-- expert_1_3 -->
<g id="node27" class="node">
<title>expert_1_3</title>
<polygon fill="lightblue" stroke="black" points="2126.19,-1600.74 1752.06,-1600.74 1655.81,-1494.74 2029.94,-1494.74 2126.19,-1600.74"/>
<text text-anchor="middle" x="1891" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="1891" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 19</text>
<text text-anchor="middle" x="1891" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_3 -->
<g id="edge45" class="edge">
<title>split_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3805.45,-1665.36C3558.52,-1653.47 3115.82,-1632.83 2737,-1618.74 2469.95,-1608.81 2401.32,-1632.61 2136,-1600.74 2135.66,-1600.7 2135.31,-1600.66 2134.97,-1600.62"/>
<polygon fill="black" stroke="black" points="2135.28,-1597.13 2124.92,-1599.34 2134.4,-1604.07 2135.28,-1597.13"/>
</g>
<!-- expert_1_4 -->
<g id="node28" class="node">
<title>expert_1_4</title>
<polygon fill="lightblue" stroke="black" points="2615.19,-1600.74 2241.06,-1600.74 2144.81,-1494.74 2518.94,-1494.74 2615.19,-1600.74"/>
<text text-anchor="middle" x="2380" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="2380" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 20</text>
<text text-anchor="middle" x="2380" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_4 -->
<g id="edge47" class="edge">
<title>split_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3801.5,-1662.33C3609.09,-1650.33 3306.87,-1632.05 3045,-1618.74 2858.4,-1609.25 2810.36,-1624.22 2625,-1600.74 2624.66,-1600.7 2624.31,-1600.65 2623.97,-1600.61"/>
<polygon fill="black" stroke="black" points="2624.3,-1597.12 2613.93,-1599.27 2623.38,-1604.06 2624.3,-1597.12"/>
</g>
<!-- expert_1_5 -->
<g id="node29" class="node">
<title>expert_1_5</title>
<polygon fill="lightblue" stroke="black" points="3104.19,-1600.74 2730.06,-1600.74 2633.81,-1494.74 3007.94,-1494.74 3104.19,-1600.74"/>
<text text-anchor="middle" x="2869" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="2869" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 21</text>
<text text-anchor="middle" x="2869" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_5 -->
<g id="edge49" class="edge">
<title>split_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3805.44,-1665.64C3626.05,-1655.47 3350.85,-1635.66 3114,-1600.74 3113.53,-1600.67 3113.06,-1600.6 3112.59,-1600.53"/>
<polygon fill="black" stroke="black" points="3113.04,-1597.06 3102.63,-1599.01 3111.98,-1603.98 3113.04,-1597.06"/>
</g>
<!-- expert_1_6 -->
<g id="node30" class="node">
<title>expert_1_6</title>
<polygon fill="lightblue" stroke="black" points="3593.19,-1600.74 3219.06,-1600.74 3122.81,-1494.74 3496.94,-1494.74 3593.19,-1600.74"/>
<text text-anchor="middle" x="3358" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="3358" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 22</text>
<text text-anchor="middle" x="3358" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_6 -->
<g id="edge51" class="edge">
<title>split_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3794.87,-1637.72C3733.21,-1626.17 3665.28,-1613.2 3603,-1600.74 3602.38,-1600.62 3601.77,-1600.49 3601.15,-1600.37"/>
<polygon fill="black" stroke="black" points="3601.56,-1596.88 3591.07,-1598.34 3600.18,-1603.75 3601.56,-1596.88"/>
</g>
<!-- expert_1_7 -->
<g id="node31" class="node">
<title>expert_1_7</title>
<polygon fill="lightblue" stroke="black" points="4082.19,-1600.74 3708.06,-1600.74 3611.81,-1494.74 3985.94,-1494.74 4082.19,-1600.74"/>
<text text-anchor="middle" x="3847" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="3847" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 23</text>
<text text-anchor="middle" x="3847" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_7 -->
<g id="edge53" class="edge">
<title>split_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3952.81,-1637.62C3941.53,-1628.15 3929.14,-1617.74 3916.92,-1607.48"/>
<polygon fill="black" stroke="black" points="3918.85,-1604.52 3908.94,-1600.77 3914.34,-1609.88 3918.85,-1604.52"/>
</g>
<!-- expert_1_8 -->
<g id="node32" class="node">
<title>expert_1_8</title>
<polygon fill="lightblue" stroke="black" points="4571.19,-1600.74 4197.06,-1600.74 4100.81,-1494.74 4474.94,-1494.74 4571.19,-1600.74"/>
<text text-anchor="middle" x="4336" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="4336" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 24</text>
<text text-anchor="middle" x="4336" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_8 -->
<g id="edge55" class="edge">
<title>split_1&#45;&gt;expert_1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4096.88,-1637.62C4125.2,-1627.09 4156.65,-1615.4 4187.2,-1604.05"/>
<polygon fill="black" stroke="black" points="4188.49,-1607.3 4196.65,-1600.53 4186.06,-1600.74 4188.49,-1607.3"/>
</g>
<!-- expert_1_9 -->
<g id="node33" class="node">
<title>expert_1_9</title>
<polygon fill="lightblue" stroke="black" points="5060.19,-1600.74 4686.06,-1600.74 4589.81,-1494.74 4963.94,-1494.74 5060.19,-1600.74"/>
<text text-anchor="middle" x="4825" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="4825" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 25</text>
<text text-anchor="middle" x="4825" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_9 -->
<g id="edge57" class="edge">
<title>split_1&#45;&gt;expert_1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4154.96,-1658.28C4272.54,-1645.15 4436.78,-1624.99 4580,-1600.74 4606.06,-1596.33 4633.56,-1591.08 4660.34,-1585.64"/>
<polygon fill="black" stroke="black" points="4661.08,-1589.06 4670.17,-1583.63 4659.67,-1582.21 4661.08,-1589.06"/>
</g>
<!-- expert_1_10 -->
<g id="node34" class="node">
<title>expert_1_10</title>
<polygon fill="lightblue" stroke="black" points="5549.19,-1600.74 5175.06,-1600.74 5078.81,-1494.74 5452.94,-1494.74 5549.19,-1600.74"/>
<text text-anchor="middle" x="5314" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="5314" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 26</text>
<text text-anchor="middle" x="5314" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_10 -->
<g id="edge59" class="edge">
<title>split_1&#45;&gt;expert_1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4169.51,-1670.27C4381.98,-1663.06 4753.53,-1644.88 5069,-1600.74 5095.46,-1597.04 5123.34,-1592.12 5150.43,-1586.77"/>
<polygon fill="black" stroke="black" points="5151.24,-1590.18 5160.36,-1584.79 5149.87,-1583.31 5151.24,-1590.18"/>
</g>
<!-- expert_1_11 -->
<g id="node35" class="node">
<title>expert_1_11</title>
<polygon fill="lightblue" stroke="black" points="6038.19,-1600.74 5664.06,-1600.74 5567.81,-1494.74 5941.94,-1494.74 6038.19,-1600.74"/>
<text text-anchor="middle" x="5803" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="5803" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 27</text>
<text text-anchor="middle" x="5803" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_11 -->
<g id="edge61" class="edge">
<title>split_1&#45;&gt;expert_1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4176.03,-1675.63C4467.07,-1674.99 5060.36,-1664.92 5558,-1600.74 5584.6,-1597.31 5612.6,-1592.51 5639.79,-1587.21"/>
<polygon fill="black" stroke="black" points="5640.63,-1590.61 5649.76,-1585.23 5639.27,-1583.74 5640.63,-1590.61"/>
</g>
<!-- expert_1_12 -->
<g id="node36" class="node">
<title>expert_1_12</title>
<polygon fill="lightblue" stroke="black" points="6527.19,-1600.74 6153.06,-1600.74 6056.81,-1494.74 6430.94,-1494.74 6527.19,-1600.74"/>
<text text-anchor="middle" x="6292" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="6292" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 28</text>
<text text-anchor="middle" x="6292" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_12 -->
<g id="edge63" class="edge">
<title>split_1&#45;&gt;expert_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4172.15,-1672.31C4599.43,-1665.77 5686.58,-1645.15 6047,-1600.74 6073.71,-1597.45 6101.83,-1592.71 6129.11,-1587.41"/>
<polygon fill="black" stroke="black" points="6129.99,-1590.81 6139.12,-1585.44 6128.63,-1583.94 6129.99,-1590.81"/>
</g>
<!-- expert_1_13 -->
<g id="node37" class="node">
<title>expert_1_13</title>
<polygon fill="lightblue" stroke="black" points="7016.19,-1600.74 6642.06,-1600.74 6545.81,-1494.74 6919.94,-1494.74 7016.19,-1600.74"/>
<text text-anchor="middle" x="6781" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="6781" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 29</text>
<text text-anchor="middle" x="6781" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_13 -->
<g id="edge65" class="edge">
<title>split_1&#45;&gt;expert_1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4173.82,-1673.73C4671.5,-1670.22 6077.75,-1655.6 6536,-1600.74 6562.72,-1597.54 6590.85,-1592.85 6618.13,-1587.57"/>
<polygon fill="black" stroke="black" points="6619.01,-1590.97 6628.14,-1585.6 6617.66,-1584.1 6619.01,-1590.97"/>
</g>
<!-- expert_1_14 -->
<g id="node38" class="node">
<title>expert_1_14</title>
<polygon fill="lightblue" stroke="black" points="7505.19,-1600.74 7131.06,-1600.74 7034.81,-1494.74 7408.94,-1494.74 7505.19,-1600.74"/>
<text text-anchor="middle" x="7270" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="7270" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 30</text>
<text text-anchor="middle" x="7270" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_14 -->
<g id="edge67" class="edge">
<title>split_1&#45;&gt;expert_1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4170.27,-1670.89C4557.83,-1662.23 5524.21,-1640.36 6333,-1619.74 6640.57,-1611.9 6719.48,-1637.05 7025,-1600.74 7051.73,-1597.56 7079.85,-1592.88 7107.14,-1587.61"/>
<polygon fill="black" stroke="black" points="7108.01,-1591.01 7117.15,-1585.64 7106.66,-1584.14 7108.01,-1591.01"/>
</g>
<!-- expert_1_15 -->
<g id="node39" class="node">
<title>expert_1_15</title>
<polygon fill="lightblue" stroke="black" points="7994.19,-1600.74 7620.06,-1600.74 7523.81,-1494.74 7897.94,-1494.74 7994.19,-1600.74"/>
<text text-anchor="middle" x="7759" y="-1559.04" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="7759" y="-1544.04" font-family="Times,serif" font-size="14.00">GPU 31</text>
<text text-anchor="middle" x="7759" y="-1529.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_1&#45;&gt;expert_1_15 -->
<g id="edge69" class="edge">
<title>split_1&#45;&gt;expert_1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4172.78,-1672.98C4838.14,-1666.06 7181.41,-1639.19 7514,-1600.74 7540.74,-1597.65 7568.87,-1593.01 7596.16,-1587.76"/>
<polygon fill="black" stroke="black" points="7597.03,-1591.16 7606.17,-1585.8 7595.68,-1584.29 7597.03,-1591.16"/>
</g>
<!-- gather_1 -->
<g id="node40" class="node">
<title>gather_1</title>
<polygon fill="lightyellow" stroke="black" points="4149.88,-1457.74 3849.42,-1457.74 3772.12,-1381.74 4072.58,-1381.74 4149.88,-1457.74"/>
<text text-anchor="middle" x="3961" y="-1423.54" font-family="Times,serif" font-size="14.00">Gather Results Layer 2</text>
<text text-anchor="middle" x="3961" y="-1408.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- expert_1_0&#45;&gt;gather_1 -->
<g id="edge40" class="edge">
<title>expert_1_0&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M576.85,-1509.83C607.22,-1503.76 638.99,-1498.3 669,-1494.74 977.61,-1458.1 1057.31,-1483.26 1368,-1475.74 2291.56,-1453.39 3400.27,-1431.54 3804.14,-1423.74"/>
<polygon fill="black" stroke="black" points="3804.5,-1427.24 3814.43,-1423.54 3804.36,-1420.24 3804.5,-1427.24"/>
</g>
<!-- expert_1_1&#45;&gt;gather_1 -->
<g id="edge42" class="edge">
<title>expert_1_1&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M1065.85,-1509.83C1096.22,-1503.77 1127.99,-1498.3 1158,-1494.74 1465.29,-1458.24 1544.66,-1484 1854,-1475.74 2583.87,-1456.25 3455.99,-1433.73 3805.22,-1424.74"/>
<polygon fill="black" stroke="black" points="3805.49,-1428.24 3815.39,-1424.48 3805.31,-1421.24 3805.49,-1428.24"/>
</g>
<!-- expert_1_2&#45;&gt;gather_1 -->
<g id="edge44" class="edge">
<title>expert_1_2&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M1554.86,-1509.94C1585.23,-1503.87 1617,-1498.37 1647,-1494.74 2065.53,-1444.04 3351.93,-1426.74 3802.85,-1422.15"/>
<polygon fill="black" stroke="black" points="3803.05,-1425.65 3813.02,-1422.04 3802.98,-1418.65 3803.05,-1425.65"/>
</g>
<!-- expert_1_3&#45;&gt;gather_1 -->
<g id="edge46" class="edge">
<title>expert_1_3&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M2044.22,-1510.08C2074.48,-1504.02 2106.12,-1498.49 2136,-1494.74 2456.56,-1454.51 3423.06,-1431.44 3804.12,-1423.7"/>
<polygon fill="black" stroke="black" points="3804.46,-1427.19 3814.39,-1423.49 3804.32,-1420.2 3804.46,-1427.19"/>
</g>
<!-- expert_1_4&#45;&gt;gather_1 -->
<g id="edge48" class="edge">
<title>expert_1_4&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M2533.26,-1510.44C2563.52,-1504.34 2595.15,-1498.71 2625,-1494.74 3047.73,-1438.51 3551.21,-1424.87 3802.23,-1421.66"/>
<polygon fill="black" stroke="black" points="3802.57,-1425.15 3812.53,-1421.53 3802.48,-1418.15 3802.57,-1425.15"/>
</g>
<!-- expert_1_5&#45;&gt;gather_1 -->
<g id="edge50" class="edge">
<title>expert_1_5&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M3023.03,-1511.06C3053.08,-1504.95 3084.43,-1499.15 3114,-1494.74 3355.55,-1458.69 3638.67,-1438.33 3808.73,-1428.43"/>
<polygon fill="black" stroke="black" points="3808.97,-1431.93 3818.76,-1427.86 3808.57,-1424.94 3808.97,-1431.93"/>
</g>
<!-- expert_1_6&#45;&gt;gather_1 -->
<g id="edge52" class="edge">
<title>expert_1_6&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M3514.16,-1513.47C3543.66,-1507.22 3574.27,-1500.76 3603,-1494.74 3677.3,-1479.18 3760.33,-1462 3827.71,-1448.12"/>
<polygon fill="black" stroke="black" points="3828.44,-1451.54 3837.53,-1446.09 3827.03,-1444.68 3828.44,-1451.54"/>
</g>
<!-- expert_1_7&#45;&gt;gather_1 -->
<g id="edge54" class="edge">
<title>expert_1_7&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M3894.36,-1494.4C3903.14,-1484.69 3912.24,-1474.63 3920.79,-1465.18"/>
<polygon fill="black" stroke="black" points="3923.39,-1467.52 3927.51,-1457.76 3918.2,-1462.83 3923.39,-1467.52"/>
</g>
<!-- expert_1_8&#45;&gt;gather_1 -->
<g id="edge56" class="edge">
<title>expert_1_8&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M4181.04,-1494.67C4147.69,-1483.47 4112.93,-1471.79 4081.14,-1461.11"/>
<polygon fill="black" stroke="black" points="4081.97,-1457.69 4071.38,-1457.83 4079.74,-1464.33 4081.97,-1457.69"/>
</g>
<!-- expert_1_9&#45;&gt;gather_1 -->
<g id="edge58" class="edge">
<title>expert_1_9&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M4591.34,-1496.66C4587.54,-1496 4583.75,-1495.36 4580,-1494.74 4431.85,-1470.21 4262.47,-1450.54 4138.39,-1437.66"/>
<polygon fill="black" stroke="black" points="4138.71,-1434.17 4128.41,-1436.63 4137.99,-1441.14 4138.71,-1434.17"/>
</g>
<!-- expert_1_10&#45;&gt;gather_1 -->
<g id="edge60" class="edge">
<title>expert_1_10&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M5080.06,-1496.33C5076.35,-1495.78 5072.66,-1495.25 5069,-1494.74 4736.28,-1448.56 4343.21,-1430.96 4126.07,-1424.43"/>
<polygon fill="black" stroke="black" points="4125.96,-1420.93 4115.86,-1424.13 4125.75,-1427.92 4125.96,-1420.93"/>
</g>
<!-- expert_1_11&#45;&gt;gather_1 -->
<g id="edge62" class="edge">
<title>expert_1_11&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M5569.07,-1496.23C5565.36,-1495.71 5561.67,-1495.21 5558,-1494.74 5285.14,-1459.7 4477.28,-1434.55 4126.57,-1424.99"/>
<polygon fill="black" stroke="black" points="4126.42,-1421.49 4116.33,-1424.71 4126.23,-1428.48 4126.42,-1421.49"/>
</g>
<!-- expert_1_12&#45;&gt;gather_1 -->
<g id="edge64" class="edge">
<title>expert_1_12&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M6058.08,-1496.17C6054.36,-1495.67 6050.67,-1495.19 6047,-1494.74 5676.06,-1449.15 4548.69,-1428.98 4124.62,-1422.87"/>
<polygon fill="black" stroke="black" points="4124.48,-1419.37 4114.43,-1422.73 4124.38,-1426.37 4124.48,-1419.37"/>
</g>
<!-- expert_1_13&#45;&gt;gather_1 -->
<g id="edge66" class="edge">
<title>expert_1_13&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M6547.08,-1496.14C6543.37,-1495.65 6539.67,-1495.18 6536,-1494.74 6066,-1438.57 4612.7,-1424.7 4123.56,-1421.58"/>
<polygon fill="black" stroke="black" points="4123.27,-1418.07 4113.25,-1421.51 4123.23,-1425.07 4123.27,-1418.07"/>
</g>
<!-- expert_1_14&#45;&gt;gather_1 -->
<g id="edge68" class="edge">
<title>expert_1_14&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M7035.76,-1496.09C7032.15,-1495.61 7028.56,-1495.16 7025,-1494.74 6718.15,-1458.29 6638.91,-1483.55 6330,-1475.74 5502.22,-1454.82 4511.65,-1432.8 4125.99,-1424.34"/>
<polygon fill="black" stroke="black" points="4125.95,-1420.84 4115.87,-1424.12 4125.8,-1427.83 4125.95,-1420.84"/>
</g>
<!-- expert_1_15&#45;&gt;gather_1 -->
<g id="edge70" class="edge">
<title>expert_1_15&#45;&gt;gather_1</title>
<path fill="none" stroke="black" d="M7524.76,-1496.06C7521.15,-1495.59 7517.56,-1495.15 7514,-1494.74 7175.57,-1455.65 4776.35,-1428.93 4124.24,-1422.33"/>
<polygon fill="black" stroke="black" points="4123.87,-1418.83 4113.83,-1422.22 4123.79,-1425.83 4123.87,-1418.83"/>
</g>
<!-- residual_1 -->
<g id="node41" class="node">
<title>residual_1</title>
<polygon fill="orange" stroke="black" points="4045.5,-1344.74 3876.5,-1344.74 3876.5,-1306.74 4045.5,-1306.74 4045.5,-1344.74"/>
<text text-anchor="middle" x="3961" y="-1329.54" font-family="Times,serif" font-size="14.00">Residual Add Layer 2</text>
<text text-anchor="middle" x="3961" y="-1314.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- gather_1&#45;&gt;residual_1 -->
<g id="edge71" class="edge">
<title>gather_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M3961,-1381.59C3961,-1372.68 3961,-1363.31 3961,-1354.89"/>
<polygon fill="black" stroke="black" points="3964.5,-1354.83 3961,-1344.83 3957.5,-1354.83 3964.5,-1354.83"/>
</g>
<!-- route_2 -->
<g id="node42" class="node">
<title>route_2</title>
<polygon fill="lightyellow" stroke="black" points="4113.31,-1248.74 3871.02,-1248.74 3808.69,-1142.74 4050.98,-1142.74 4113.31,-1248.74"/>
<text text-anchor="middle" x="3961" y="-1207.04" font-family="Times,serif" font-size="14.00">Routing Layer 3</text>
<text text-anchor="middle" x="3961" y="-1192.04" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3961" y="-1177.04" font-family="Times,serif" font-size="14.00">Gate Computation</text>
</g>
<!-- residual_1&#45;&gt;route_2 -->
<g id="edge72" class="edge">
<title>residual_1&#45;&gt;route_2</title>
<path fill="none" stroke="black" d="M3961,-1306.67C3961,-1294.11 3961,-1276.57 3961,-1259.18"/>
<polygon fill="black" stroke="black" points="3964.5,-1258.99 3961,-1248.99 3957.5,-1258.99 3964.5,-1258.99"/>
</g>
<!-- split_2 -->
<g id="node43" class="node">
<title>split_2</title>
<polygon fill="lightyellow" stroke="black" points="4185.95,-1105.74 3828.1,-1105.74 3736.05,-1029.74 4093.9,-1029.74 4185.95,-1105.74"/>
<text text-anchor="middle" x="3961" y="-1071.54" font-family="Times,serif" font-size="14.00">Split Tokens Layer 3</text>
<text text-anchor="middle" x="3961" y="-1056.54" font-family="Times,serif" font-size="14.00">[Variable tokens per expert]</text>
</g>
<!-- route_2&#45;&gt;split_2 -->
<g id="edge73" class="edge">
<title>route_2&#45;&gt;split_2</title>
<path fill="none" stroke="black" d="M3961,-1142.4C3961,-1133.65 3961,-1124.62 3961,-1116.01"/>
<polygon fill="black" stroke="black" points="3964.5,-1115.76 3961,-1105.76 3957.5,-1115.76 3964.5,-1115.76"/>
</g>
<!-- expert_2_0 -->
<g id="node44" class="node">
<title>expert_2_0</title>
<polygon fill="lightblue" stroke="black" points="577.19,-992.74 203.06,-992.74 106.81,-886.74 480.94,-886.74 577.19,-992.74"/>
<text text-anchor="middle" x="342" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="342" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 32</text>
<text text-anchor="middle" x="342" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_0 -->
<g id="edge74" class="edge">
<title>split_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.47,-1063.37C3342.15,-1055.35 2221.36,-1034.11 1285,-1011.74 974.75,-1004.33 895.17,-1029.33 587,-992.74 586.78,-992.71 586.55,-992.69 586.33,-992.66"/>
<polygon fill="black" stroke="black" points="586.6,-989.17 576.24,-991.39 585.73,-996.11 586.6,-989.17"/>
</g>
<!-- expert_2_1 -->
<g id="node45" class="node">
<title>expert_2_1</title>
<polygon fill="lightblue" stroke="black" points="1066.19,-992.74 692.06,-992.74 595.81,-886.74 969.94,-886.74 1066.19,-992.74"/>
<text text-anchor="middle" x="831" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="831" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 33</text>
<text text-anchor="middle" x="831" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_1 -->
<g id="edge76" class="edge">
<title>split_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3775.07,-1062.23C3397.05,-1053.02 2511.59,-1031.27 1768,-1011.74 1460.43,-1003.66 1381.52,-1029.05 1076,-992.74 1075.78,-992.71 1075.55,-992.69 1075.33,-992.66"/>
<polygon fill="black" stroke="black" points="1075.6,-989.17 1065.24,-991.39 1074.73,-996.11 1075.6,-989.17"/>
</g>
<!-- expert_2_2 -->
<g id="node46" class="node">
<title>expert_2_2</title>
<polygon fill="lightblue" stroke="black" points="1555.19,-992.74 1181.06,-992.74 1084.81,-886.74 1458.94,-886.74 1555.19,-992.74"/>
<text text-anchor="middle" x="1320" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="1320" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 34</text>
<text text-anchor="middle" x="1320" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_2 -->
<g id="edge78" class="edge">
<title>split_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3779.14,-1065.32C3296.84,-1060.88 1992.9,-1044.34 1565,-992.74 1564.66,-992.7 1564.31,-992.66 1563.97,-992.61"/>
<polygon fill="black" stroke="black" points="1564.28,-989.13 1553.92,-991.33 1563.39,-996.07 1564.28,-989.13"/>
</g>
<!-- expert_2_3 -->
<g id="node47" class="node">
<title>expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="2044.19,-992.74 1670.06,-992.74 1573.81,-886.74 1947.94,-886.74 2044.19,-992.74"/>
<text text-anchor="middle" x="1809" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="1809" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 35</text>
<text text-anchor="middle" x="1809" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_3 -->
<g id="edge80" class="edge">
<title>split_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3776.68,-1063.59C3365.46,-1055.91 2383.4,-1033.78 2054,-992.74 2053.66,-992.7 2053.31,-992.65 2052.97,-992.61"/>
<polygon fill="black" stroke="black" points="2053.29,-989.12 2042.92,-991.29 2052.38,-996.06 2053.29,-989.12"/>
</g>
<!-- expert_2_4 -->
<g id="node48" class="node">
<title>expert_2_4</title>
<polygon fill="lightblue" stroke="black" points="2533.19,-992.74 2159.06,-992.74 2062.81,-886.74 2436.94,-886.74 2533.19,-992.74"/>
<text text-anchor="middle" x="2298" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="2298" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 36</text>
<text text-anchor="middle" x="2298" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_4 -->
<g id="edge82" class="edge">
<title>split_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3780.26,-1066.37C3509.97,-1063.76 2984.93,-1050.8 2543,-992.74 2542.66,-992.69 2542.31,-992.65 2541.97,-992.6"/>
<polygon fill="black" stroke="black" points="2542.32,-989.12 2531.93,-991.22 2541.36,-996.05 2542.32,-989.12"/>
</g>
<!-- expert_2_5 -->
<g id="node49" class="node">
<title>expert_2_5</title>
<polygon fill="lightblue" stroke="black" points="3022.19,-992.74 2648.06,-992.74 2551.81,-886.74 2925.94,-886.74 3022.19,-992.74"/>
<text text-anchor="middle" x="2787" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="2787" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 37</text>
<text text-anchor="middle" x="2787" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_5 -->
<g id="edge84" class="edge">
<title>split_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3771.15,-1058.83C3582.83,-1049.29 3286.38,-1029.71 3032,-992.74 3031.66,-992.69 3031.31,-992.64 3030.97,-992.59"/>
<polygon fill="black" stroke="black" points="3031.36,-989.11 3020.95,-991.08 3030.32,-996.03 3031.36,-989.11"/>
</g>
<!-- expert_2_6 -->
<g id="node50" class="node">
<title>expert_2_6</title>
<polygon fill="lightblue" stroke="black" points="3511.19,-992.74 3137.06,-992.74 3040.81,-886.74 3414.94,-886.74 3511.19,-992.74"/>
<text text-anchor="middle" x="3276" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="3276" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 38</text>
<text text-anchor="middle" x="3276" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_6 -->
<g id="edge86" class="edge">
<title>split_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3737.4,-1031.02C3667.94,-1019.42 3591.2,-1006.09 3521,-992.74 3520.52,-992.65 3520.04,-992.56 3519.56,-992.47"/>
<polygon fill="black" stroke="black" points="3519.86,-988.96 3509.38,-990.51 3518.54,-995.83 3519.86,-988.96"/>
</g>
<!-- expert_2_7 -->
<g id="node51" class="node">
<title>expert_2_7</title>
<polygon fill="lightblue" stroke="black" points="4000.19,-992.74 3626.06,-992.74 3529.81,-886.74 3903.94,-886.74 4000.19,-992.74"/>
<text text-anchor="middle" x="3765" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="3765" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 39</text>
<text text-anchor="middle" x="3765" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_7 -->
<g id="edge88" class="edge">
<title>split_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3903.25,-1029.62C3887.96,-1019.79 3871.09,-1008.94 3854.55,-998.31"/>
<polygon fill="black" stroke="black" points="3856.24,-995.23 3845.93,-992.77 3852.45,-1001.12 3856.24,-995.23"/>
</g>
<!-- expert_2_8 -->
<g id="node52" class="node">
<title>expert_2_8</title>
<polygon fill="lightblue" stroke="black" points="4489.19,-992.74 4115.06,-992.74 4018.81,-886.74 4392.94,-886.74 4489.19,-992.74"/>
<text text-anchor="middle" x="4254" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="4254" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 40</text>
<text text-anchor="middle" x="4254" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_8 -->
<g id="edge90" class="edge">
<title>split_2&#45;&gt;expert_2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4047.32,-1029.62C4071.23,-1019.34 4097.72,-1007.95 4123.54,-996.84"/>
<polygon fill="black" stroke="black" points="4125.21,-999.93 4133.02,-992.77 4122.45,-993.5 4125.21,-999.93"/>
</g>
<!-- expert_2_9 -->
<g id="node53" class="node">
<title>expert_2_9</title>
<polygon fill="lightblue" stroke="black" points="4978.19,-992.74 4604.06,-992.74 4507.81,-886.74 4881.94,-886.74 4978.19,-992.74"/>
<text text-anchor="middle" x="4743" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="4743" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 41</text>
<text text-anchor="middle" x="4743" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_9 -->
<g id="edge92" class="edge">
<title>split_2&#45;&gt;expert_2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4116.56,-1048.32C4224.02,-1034.86 4370.07,-1015.1 4498,-992.74 4524.04,-988.19 4551.52,-982.87 4578.3,-977.4"/>
<polygon fill="black" stroke="black" points="4579.04,-980.82 4588.13,-975.38 4577.63,-973.96 4579.04,-980.82"/>
</g>
<!-- expert_2_10 -->
<g id="node54" class="node">
<title>expert_2_10</title>
<polygon fill="lightblue" stroke="black" points="5467.19,-992.74 5093.06,-992.74 4996.81,-886.74 5370.94,-886.74 5467.19,-992.74"/>
<text text-anchor="middle" x="5232" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="5232" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 42</text>
<text text-anchor="middle" x="5232" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_10 -->
<g id="edge94" class="edge">
<title>split_2&#45;&gt;expert_2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4132.86,-1061.54C4337.27,-1053.7 4688.38,-1035 4987,-992.74 5013.46,-989 5041.33,-984.05 5068.42,-978.7"/>
<polygon fill="black" stroke="black" points="5069.24,-982.11 5078.35,-976.71 5067.86,-975.24 5069.24,-982.11"/>
</g>
<!-- expert_2_11 -->
<g id="node55" class="node">
<title>expert_2_11</title>
<polygon fill="lightblue" stroke="black" points="5956.19,-992.74 5582.06,-992.74 5485.81,-886.74 5859.94,-886.74 5956.19,-992.74"/>
<text text-anchor="middle" x="5721" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="5721" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 43</text>
<text text-anchor="middle" x="5721" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_11 -->
<g id="edge96" class="edge">
<title>split_2&#45;&gt;expert_2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4139.37,-1067.26C4423.45,-1066.02 4995.65,-1055.04 5476,-992.74 5502.6,-989.29 5530.6,-984.49 5557.78,-979.18"/>
<polygon fill="black" stroke="black" points="5558.63,-982.58 5567.76,-977.2 5557.27,-975.71 5558.63,-982.58"/>
</g>
<!-- expert_2_12 -->
<g id="node56" class="node">
<title>expert_2_12</title>
<polygon fill="lightblue" stroke="black" points="6445.19,-992.74 6071.06,-992.74 5974.81,-886.74 6348.94,-886.74 6445.19,-992.74"/>
<text text-anchor="middle" x="6210" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="6210" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 44</text>
<text text-anchor="middle" x="6210" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_12 -->
<g id="edge98" class="edge">
<title>split_2&#45;&gt;expert_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4135.69,-1064.15C4555.77,-1057.3 5613.65,-1036.18 5965,-992.74 5991.71,-989.44 6019.83,-984.69 6047.11,-979.39"/>
<polygon fill="black" stroke="black" points="6047.99,-982.79 6057.12,-977.42 6046.63,-975.92 6047.99,-982.79"/>
</g>
<!-- expert_2_13 -->
<g id="node57" class="node">
<title>expert_2_13</title>
<polygon fill="lightblue" stroke="black" points="6934.19,-992.74 6560.06,-992.74 6463.81,-886.74 6837.94,-886.74 6934.19,-992.74"/>
<text text-anchor="middle" x="6699" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="6699" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 45</text>
<text text-anchor="middle" x="6699" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_13 -->
<g id="edge100" class="edge">
<title>split_2&#45;&gt;expert_2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4137.69,-1065.62C4629.05,-1061.84 6005,-1046.61 6454,-992.74 6480.72,-989.53 6508.85,-984.84 6536.13,-979.56"/>
<polygon fill="black" stroke="black" points="6537.01,-982.96 6546.14,-977.59 6535.65,-976.09 6537.01,-982.96"/>
</g>
<!-- expert_2_14 -->
<g id="node58" class="node">
<title>expert_2_14</title>
<polygon fill="lightblue" stroke="black" points="7423.19,-992.74 7049.06,-992.74 6952.81,-886.74 7326.94,-886.74 7423.19,-992.74"/>
<text text-anchor="middle" x="7188" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="7188" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 46</text>
<text text-anchor="middle" x="7188" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_14 -->
<g id="edge102" class="edge">
<title>split_2&#45;&gt;expert_2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4134.03,-1062.81C4516.5,-1054.06 5462.74,-1032.18 6255,-1011.74 6560.79,-1003.85 6639.25,-1028.87 6943,-992.74 6969.73,-989.56 6997.85,-984.88 7025.14,-979.61"/>
<polygon fill="black" stroke="black" points="7026.01,-983 7035.15,-977.64 7024.66,-976.13 7026.01,-983"/>
</g>
<!-- expert_2_15 -->
<g id="node59" class="node">
<title>expert_2_15</title>
<polygon fill="lightblue" stroke="black" points="7912.19,-992.74 7538.06,-992.74 7441.81,-886.74 7815.94,-886.74 7912.19,-992.74"/>
<text text-anchor="middle" x="7677" y="-951.04" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="7677" y="-936.04" font-family="Times,serif" font-size="14.00">GPU 47</text>
<text text-anchor="middle" x="7677" y="-921.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_2&#45;&gt;expert_2_15 -->
<g id="edge104" class="edge">
<title>split_2&#45;&gt;expert_2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4139.51,-1067.36C4754.76,-1068.81 6784.7,-1067.66 7432,-992.74 7458.74,-989.65 7486.87,-985.01 7514.15,-979.75"/>
<polygon fill="black" stroke="black" points="7515.03,-983.15 7524.17,-977.79 7513.68,-976.28 7515.03,-983.15"/>
</g>
<!-- gather_2 -->
<g id="node60" class="node">
<title>gather_2</title>
<polygon fill="lightyellow" stroke="black" points="4133.88,-849.74 3833.42,-849.74 3756.12,-773.74 4056.58,-773.74 4133.88,-849.74"/>
<text text-anchor="middle" x="3945" y="-815.54" font-family="Times,serif" font-size="14.00">Gather Results Layer 3</text>
<text text-anchor="middle" x="3945" y="-800.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- expert_2_0&#45;&gt;gather_2 -->
<g id="edge75" class="edge">
<title>expert_2_0&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M494.85,-901.83C525.22,-895.77 556.99,-890.3 587,-886.74 894.73,-850.2 974.2,-875.16 1284,-867.74 2234.87,-844.95 3377,-823.25 3788.07,-815.62"/>
<polygon fill="black" stroke="black" points="3788.3,-819.12 3798.24,-815.43 3788.17,-812.12 3788.3,-819.12"/>
</g>
<!-- expert_2_1&#45;&gt;gather_2 -->
<g id="edge77" class="edge">
<title>expert_2_1&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M983.85,-901.84C1014.22,-895.77 1045.99,-890.31 1076,-886.74 1380.64,-850.52 1459.32,-875.83 1766,-867.74 2524.5,-847.72 3431.57,-825.32 3789.16,-816.55"/>
<polygon fill="black" stroke="black" points="3789.41,-820.05 3799.32,-816.3 3789.24,-813.05 3789.41,-820.05"/>
</g>
<!-- expert_2_2&#45;&gt;gather_2 -->
<g id="edge79" class="edge">
<title>expert_2_2&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M1472.86,-901.92C1503.23,-895.85 1535,-890.36 1565,-886.74 1996.85,-834.62 3327.05,-818.18 3786.77,-813.98"/>
<polygon fill="black" stroke="black" points="3786.83,-817.48 3796.8,-813.89 3786.77,-810.48 3786.83,-817.48"/>
</g>
<!-- expert_2_3&#45;&gt;gather_2 -->
<g id="edge81" class="edge">
<title>expert_2_3&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M1962.21,-902.05C1992.48,-895.98 2024.12,-890.47 2054,-886.74 2387.66,-845.11 3396.65,-822.74 3787.74,-815.45"/>
<polygon fill="black" stroke="black" points="3788.06,-818.94 3798,-815.26 3787.93,-811.95 3788.06,-818.94"/>
</g>
<!-- expert_2_4&#45;&gt;gather_2 -->
<g id="edge83" class="edge">
<title>expert_2_4&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M2451.26,-902.37C2481.52,-896.28 2513.15,-890.67 2543,-886.74 2990.73,-827.78 3524.73,-815.4 3785.62,-813.06"/>
<polygon fill="black" stroke="black" points="3785.96,-816.56 3795.93,-812.97 3785.9,-809.56 3785.96,-816.56"/>
</g>
<!-- expert_2_5&#45;&gt;gather_2 -->
<g id="edge85" class="edge">
<title>expert_2_5&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M2941,-902.91C2971.06,-896.81 3002.42,-891.06 3032,-886.74 3297.44,-847.98 3609.48,-828.17 3791.46,-819.17"/>
<polygon fill="black" stroke="black" points="3791.82,-822.65 3801.64,-818.67 3791.48,-815.66 3791.82,-822.65"/>
</g>
<!-- expert_2_6&#45;&gt;gather_2 -->
<g id="edge87" class="edge">
<title>expert_2_6&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M3431.68,-904.81C3461.3,-898.61 3492.08,-892.33 3521,-886.74 3616.17,-868.34 3723.77,-849.59 3806.76,-835.56"/>
<polygon fill="black" stroke="black" points="3807.48,-838.99 3816.75,-833.88 3806.31,-832.09 3807.48,-838.99"/>
</g>
<!-- expert_2_7&#45;&gt;gather_2 -->
<g id="edge89" class="edge">
<title>expert_2_7&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M3839.51,-886.58C3854.23,-876.28 3869.51,-865.58 3883.73,-855.63"/>
<polygon fill="black" stroke="black" points="3885.78,-858.47 3891.96,-849.87 3881.76,-852.73 3885.78,-858.47"/>
</g>
<!-- expert_2_8&#45;&gt;gather_2 -->
<g id="edge91" class="edge">
<title>expert_2_8&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M4126.09,-886.58C4099.17,-875.61 4071.15,-864.18 4045.42,-853.69"/>
<polygon fill="black" stroke="black" points="4046.63,-850.4 4036.05,-849.87 4043.99,-856.88 4046.63,-850.4"/>
</g>
<!-- expert_2_9&#45;&gt;gather_2 -->
<g id="edge93" class="edge">
<title>expert_2_9&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M4509.66,-888.79C4505.74,-888.09 4501.86,-887.41 4498,-886.74 4374.43,-865.39 4234.42,-846.71 4126.2,-833.46"/>
<polygon fill="black" stroke="black" points="4126.51,-829.97 4116.16,-832.23 4125.66,-836.92 4126.51,-829.97"/>
</g>
<!-- expert_2_10&#45;&gt;gather_2 -->
<g id="edge95" class="edge">
<title>expert_2_10&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M4998.05,-888.35C4994.35,-887.79 4990.66,-887.26 4987,-886.74 4679.56,-843.41 4317.32,-824.94 4111.07,-817.46"/>
<polygon fill="black" stroke="black" points="4111.18,-813.96 4101.06,-817.1 4110.93,-820.95 4111.18,-813.96"/>
</g>
<!-- expert_2_11&#45;&gt;gather_2 -->
<g id="edge97" class="edge">
<title>expert_2_11&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M5487.07,-888.24C5483.36,-887.71 5479.67,-887.21 5476,-886.74 4979.39,-822.46 4385.64,-812.7 4105.88,-812.03"/>
<polygon fill="black" stroke="black" points="4105.66,-808.53 4095.65,-812.01 4105.65,-815.53 4105.66,-808.53"/>
</g>
<!-- expert_2_12&#45;&gt;gather_2 -->
<g id="edge99" class="edge">
<title>expert_2_12&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M5976.08,-888.18C5972.36,-887.67 5968.67,-887.19 5965,-886.74 5607.41,-842.58 4523.81,-821.65 4108.97,-815.1"/>
<polygon fill="black" stroke="black" points="4108.75,-811.59 4098.7,-814.94 4108.64,-818.59 4108.75,-811.59"/>
</g>
<!-- expert_2_13&#45;&gt;gather_2 -->
<g id="edge101" class="edge">
<title>expert_2_13&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M6465.08,-888.14C6461.37,-887.65 6457.67,-887.18 6454,-886.74 5997.4,-832 4588.3,-817.22 4107.61,-813.72"/>
<polygon fill="black" stroke="black" points="4107.5,-810.22 4097.47,-813.65 4107.45,-817.22 4107.5,-810.22"/>
</g>
<!-- expert_2_14&#45;&gt;gather_2 -->
<g id="edge103" class="edge">
<title>expert_2_14&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M6953.76,-888.09C6950.15,-887.61 6946.56,-887.16 6943,-886.74 6638.8,-850.57 6560.24,-875.61 6254,-867.74 5450.36,-847.09 4489.31,-825.05 4110.28,-816.46"/>
<polygon fill="black" stroke="black" points="4110.14,-812.96 4100.06,-816.23 4109.98,-819.96 4110.14,-812.96"/>
</g>
<!-- expert_2_15&#45;&gt;gather_2 -->
<g id="edge105" class="edge">
<title>expert_2_15&#45;&gt;gather_2</title>
<path fill="none" stroke="black" d="M7442.76,-888.06C7439.15,-887.59 7435.56,-887.15 7432,-886.74 6775.15,-810.75 4701.13,-810.56 4106.06,-812.14"/>
<polygon fill="black" stroke="black" points="4105.68,-808.64 4095.69,-812.17 4105.7,-815.64 4105.68,-808.64"/>
</g>
<!-- residual_2 -->
<g id="node61" class="node">
<title>residual_2</title>
<polygon fill="orange" stroke="black" points="4029.5,-736.74 3860.5,-736.74 3860.5,-698.74 4029.5,-698.74 4029.5,-736.74"/>
<text text-anchor="middle" x="3945" y="-721.54" font-family="Times,serif" font-size="14.00">Residual Add Layer 3</text>
<text text-anchor="middle" x="3945" y="-706.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- gather_2&#45;&gt;residual_2 -->
<g id="edge106" class="edge">
<title>gather_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M3945,-773.59C3945,-764.68 3945,-755.31 3945,-746.89"/>
<polygon fill="black" stroke="black" points="3948.5,-746.83 3945,-736.83 3941.5,-746.83 3948.5,-746.83"/>
</g>
<!-- route_3 -->
<g id="node62" class="node">
<title>route_3</title>
<polygon fill="lightyellow" stroke="black" points="4097.31,-640.74 3855.02,-640.74 3792.69,-534.74 4034.98,-534.74 4097.31,-640.74"/>
<text text-anchor="middle" x="3945" y="-599.04" font-family="Times,serif" font-size="14.00">Routing Layer 4</text>
<text text-anchor="middle" x="3945" y="-584.04" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3945" y="-569.04" font-family="Times,serif" font-size="14.00">Gate Computation</text>
</g>
<!-- residual_2&#45;&gt;route_3 -->
<g id="edge107" class="edge">
<title>residual_2&#45;&gt;route_3</title>
<path fill="none" stroke="black" d="M3945,-698.67C3945,-686.11 3945,-668.57 3945,-651.18"/>
<polygon fill="black" stroke="black" points="3948.5,-650.99 3945,-640.99 3941.5,-650.99 3948.5,-650.99"/>
</g>
<!-- split_3 -->
<g id="node63" class="node">
<title>split_3</title>
<polygon fill="lightyellow" stroke="black" points="4169.95,-497.74 3812.1,-497.74 3720.05,-421.74 4077.9,-421.74 4169.95,-497.74"/>
<text text-anchor="middle" x="3945" y="-463.54" font-family="Times,serif" font-size="14.00">Split Tokens Layer 4</text>
<text text-anchor="middle" x="3945" y="-448.54" font-family="Times,serif" font-size="14.00">[Variable tokens per expert]</text>
</g>
<!-- route_3&#45;&gt;split_3 -->
<g id="edge108" class="edge">
<title>route_3&#45;&gt;split_3</title>
<path fill="none" stroke="black" d="M3945,-534.4C3945,-525.65 3945,-516.62 3945,-508.01"/>
<polygon fill="black" stroke="black" points="3948.5,-507.76 3945,-497.76 3941.5,-507.76 3948.5,-507.76"/>
</g>
<!-- expert_3_0 -->
<g id="node64" class="node">
<title>expert_3_0</title>
<polygon fill="lightblue" stroke="black" points="486.19,-384.74 112.06,-384.74 15.81,-278.74 389.94,-278.74 486.19,-384.74"/>
<text text-anchor="middle" x="251" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="251" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 48</text>
<text text-anchor="middle" x="251" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_0 -->
<g id="edge109" class="edge">
<title>split_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3760.8,-455.51C3318.55,-447.65 2161.77,-426.51 1196,-403.74 884.86,-396.41 805.06,-421.42 496,-384.74 495.78,-384.71 495.55,-384.69 495.33,-384.66"/>
<polygon fill="black" stroke="black" points="495.6,-381.17 485.24,-383.39 494.73,-388.11 495.6,-381.17"/>
</g>
<!-- expert_3_1 -->
<g id="node65" class="node">
<title>expert_3_1</title>
<polygon fill="lightblue" stroke="black" points="975.19,-384.74 601.06,-384.74 504.81,-278.74 878.94,-278.74 975.19,-384.74"/>
<text text-anchor="middle" x="740" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="740" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 49</text>
<text text-anchor="middle" x="740" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_1 -->
<g id="edge111" class="edge">
<title>split_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3759.54,-454.41C3373.24,-445.36 2454.15,-423.61 1683,-403.74 1372.77,-395.75 1293.17,-421.33 985,-384.74 984.78,-384.71 984.55,-384.69 984.33,-384.66"/>
<polygon fill="black" stroke="black" points="984.6,-381.17 974.24,-383.39 983.73,-388.11 984.6,-381.17"/>
</g>
<!-- expert_3_2 -->
<g id="node66" class="node">
<title>expert_3_2</title>
<polygon fill="lightblue" stroke="black" points="1464.19,-384.74 1090.06,-384.74 993.81,-278.74 1367.94,-278.74 1464.19,-384.74"/>
<text text-anchor="middle" x="1229" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="1229" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 50</text>
<text text-anchor="middle" x="1229" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_2 -->
<g id="edge113" class="edge">
<title>split_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3763.26,-457.52C3270.62,-453.54 1917.03,-437.95 1474,-384.74 1473.66,-384.7 1473.31,-384.66 1472.97,-384.62"/>
<polygon fill="black" stroke="black" points="1473.28,-381.13 1462.92,-383.34 1472.4,-388.07 1473.28,-381.13"/>
</g>
<!-- expert_3_3 -->
<g id="node67" class="node">
<title>expert_3_3</title>
<polygon fill="lightblue" stroke="black" points="1953.19,-384.74 1579.06,-384.74 1482.81,-278.74 1856.94,-278.74 1953.19,-384.74"/>
<text text-anchor="middle" x="1718" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="1718" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 51</text>
<text text-anchor="middle" x="1718" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_3 -->
<g id="edge115" class="edge">
<title>split_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3761.36,-455.92C3338.8,-448.77 2307.5,-427.41 1963,-384.74 1962.66,-384.7 1962.31,-384.65 1961.97,-384.61"/>
<polygon fill="black" stroke="black" points="1962.29,-381.12 1951.92,-383.3 1961.38,-388.07 1962.29,-381.12"/>
</g>
<!-- expert_3_4 -->
<g id="node68" class="node">
<title>expert_3_4</title>
<polygon fill="lightblue" stroke="black" points="2442.19,-384.74 2068.06,-384.74 1971.81,-278.74 2345.94,-278.74 2442.19,-384.74"/>
<text text-anchor="middle" x="2207" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="2207" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 52</text>
<text text-anchor="middle" x="2207" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_4 -->
<g id="edge117" class="edge">
<title>split_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3765.21,-459.06C3483.9,-457.49 2923.12,-446.01 2452,-384.74 2451.66,-384.7 2451.31,-384.65 2450.97,-384.61"/>
<polygon fill="black" stroke="black" points="2451.31,-381.12 2440.93,-383.24 2450.37,-388.06 2451.31,-381.12"/>
</g>
<!-- expert_3_5 -->
<g id="node69" class="node">
<title>expert_3_5</title>
<polygon fill="lightblue" stroke="black" points="2931.19,-384.74 2557.06,-384.74 2460.81,-278.74 2834.94,-278.74 2931.19,-384.74"/>
<text text-anchor="middle" x="2696" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="2696" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 53</text>
<text text-anchor="middle" x="2696" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_5 -->
<g id="edge119" class="edge">
<title>split_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3757.29,-452.51C3554.98,-444.02 3223.91,-425 2941,-384.74 2940.66,-384.69 2940.31,-384.64 2939.97,-384.59"/>
<polygon fill="black" stroke="black" points="2940.35,-381.11 2929.95,-383.11 2939.33,-388.04 2940.35,-381.11"/>
</g>
<!-- expert_3_6 -->
<g id="node70" class="node">
<title>expert_3_6</title>
<polygon fill="lightblue" stroke="black" points="3420.19,-384.74 3046.06,-384.74 2949.81,-278.74 3323.94,-278.74 3420.19,-384.74"/>
<text text-anchor="middle" x="3185" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="3185" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 54</text>
<text text-anchor="middle" x="3185" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_6 -->
<g id="edge121" class="edge">
<title>split_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3731.51,-431.3C3638.65,-418.53 3528.72,-402.29 3430,-384.74 3429.52,-384.65 3429.04,-384.57 3428.55,-384.48"/>
<polygon fill="black" stroke="black" points="3428.82,-380.97 3418.35,-382.64 3427.57,-387.86 3428.82,-380.97"/>
</g>
<!-- expert_3_7 -->
<g id="node71" class="node">
<title>expert_3_7</title>
<polygon fill="lightblue" stroke="black" points="3909.19,-384.74 3535.06,-384.74 3438.81,-278.74 3812.94,-278.74 3909.19,-384.74"/>
<text text-anchor="middle" x="3674" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="3674" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 55</text>
<text text-anchor="middle" x="3674" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_7 -->
<g id="edge123" class="edge">
<title>split_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3865.16,-421.62C3843.14,-411.38 3818.76,-400.05 3794.98,-388.99"/>
<polygon fill="black" stroke="black" points="3796.44,-385.81 3785.9,-384.77 3793.49,-392.16 3796.44,-385.81"/>
</g>
<!-- expert_3_8 -->
<g id="node72" class="node">
<title>expert_3_8</title>
<polygon fill="lightblue" stroke="black" points="4398.19,-384.74 4024.06,-384.74 3927.81,-278.74 4301.94,-278.74 4398.19,-384.74"/>
<text text-anchor="middle" x="4163" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="4163" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 56</text>
<text text-anchor="middle" x="4163" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_8 -->
<g id="edge125" class="edge">
<title>split_3&#45;&gt;expert_3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4009.23,-421.62C4026.47,-411.65 4045.52,-400.64 4064.16,-389.87"/>
<polygon fill="black" stroke="black" points="4066.08,-392.8 4072.98,-384.77 4062.57,-386.74 4066.08,-392.8"/>
</g>
<!-- expert_3_9 -->
<g id="node73" class="node">
<title>expert_3_9</title>
<polygon fill="lightblue" stroke="black" points="4887.19,-384.74 4513.06,-384.74 4416.81,-278.74 4790.94,-278.74 4887.19,-384.74"/>
<text text-anchor="middle" x="4652" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="4652" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 57</text>
<text text-anchor="middle" x="4652" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_9 -->
<g id="edge127" class="edge">
<title>split_3&#45;&gt;expert_3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4095.92,-436.53C4186.34,-422.73 4303.48,-404 4407,-384.74 4432.89,-379.92 4460.24,-374.47 4486.91,-368.96"/>
<polygon fill="black" stroke="black" points="4487.63,-372.39 4496.71,-366.93 4486.2,-365.54 4487.63,-372.39"/>
</g>
<!-- expert_3_10 -->
<g id="node74" class="node">
<title>expert_3_10</title>
<polygon fill="lightblue" stroke="black" points="5376.19,-384.74 5002.06,-384.74 4905.81,-278.74 5279.94,-278.74 5376.19,-384.74"/>
<text text-anchor="middle" x="5141" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="5141" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 58</text>
<text text-anchor="middle" x="5141" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_10 -->
<g id="edge129" class="edge">
<title>split_3&#45;&gt;expert_3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4114.95,-452.26C4305.79,-443.42 4624.33,-423.97 4896,-384.74 4922.45,-380.92 4950.31,-375.94 4977.4,-370.57"/>
<polygon fill="black" stroke="black" points="4978.22,-373.98 4987.34,-368.58 4976.84,-367.11 4978.22,-373.98"/>
</g>
<!-- expert_3_11 -->
<g id="node75" class="node">
<title>expert_3_11</title>
<polygon fill="lightblue" stroke="black" points="5865.19,-384.74 5491.06,-384.74 5394.81,-278.74 5768.94,-278.74 5865.19,-384.74"/>
<text text-anchor="middle" x="5630" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="5630" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 59</text>
<text text-anchor="middle" x="5630" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_11 -->
<g id="edge131" class="edge">
<title>split_3&#45;&gt;expert_3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4122.6,-458.6C4395.28,-456.37 4932.95,-443.95 5385,-384.74 5411.59,-381.26 5439.59,-376.43 5466.77,-371.12"/>
<polygon fill="black" stroke="black" points="5467.62,-374.52 5476.75,-369.14 5466.26,-367.65 5467.62,-374.52"/>
</g>
<!-- expert_3_12 -->
<g id="node76" class="node">
<title>expert_3_12</title>
<polygon fill="lightblue" stroke="black" points="6354.19,-384.74 5980.06,-384.74 5883.81,-278.74 6257.94,-278.74 6354.19,-384.74"/>
<text text-anchor="middle" x="6119" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="6119" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 60</text>
<text text-anchor="middle" x="6119" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_12 -->
<g id="edge133" class="edge">
<title>split_3&#45;&gt;expert_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4119.55,-455.86C4528.14,-448.51 5537.57,-426.58 5874,-384.74 5900.61,-381.43 5928.62,-376.7 5955.81,-371.42"/>
<polygon fill="black" stroke="black" points="5956.66,-374.82 5965.79,-369.45 5955.3,-367.95 5956.66,-374.82"/>
</g>
<!-- expert_3_13 -->
<g id="node77" class="node">
<title>expert_3_13</title>
<polygon fill="lightblue" stroke="black" points="6843.19,-384.74 6469.06,-384.74 6372.81,-278.74 6746.94,-278.74 6843.19,-384.74"/>
<text text-anchor="middle" x="6608" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="6608" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 61</text>
<text text-anchor="middle" x="6608" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_13 -->
<g id="edge135" class="edge">
<title>split_3&#45;&gt;expert_3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4121.54,-457.43C4602.53,-453.2 5929.09,-437 6363,-384.74 6389.72,-381.52 6417.84,-376.82 6445.13,-371.54"/>
<polygon fill="black" stroke="black" points="6446,-374.93 6455.14,-369.57 6444.65,-368.07 6446,-374.93"/>
</g>
<!-- expert_3_14 -->
<g id="node78" class="node">
<title>expert_3_14</title>
<polygon fill="lightblue" stroke="black" points="7332.19,-384.74 6958.06,-384.74 6861.81,-278.74 7235.94,-278.74 7332.19,-384.74"/>
<text text-anchor="middle" x="7097" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="7097" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 62</text>
<text text-anchor="middle" x="7097" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_14 -->
<g id="edge137" class="edge">
<title>split_3&#45;&gt;expert_3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4117.88,-454.59C4490.63,-445.62 5397.79,-423.59 6158,-403.74 6466.45,-395.68 6545.59,-421.14 6852,-384.74 6878.73,-381.56 6906.85,-376.88 6934.14,-371.61"/>
<polygon fill="black" stroke="black" points="6935.01,-375.01 6944.15,-369.65 6933.66,-368.14 6935.01,-375.01"/>
</g>
<!-- expert_3_15 -->
<g id="node79" class="node">
<title>expert_3_15</title>
<polygon fill="lightblue" stroke="black" points="7821.19,-384.74 7447.06,-384.74 7350.81,-278.74 7724.94,-278.74 7821.19,-384.74"/>
<text text-anchor="middle" x="7586" y="-343.04" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="7586" y="-328.04" font-family="Times,serif" font-size="14.00">GPU 63</text>
<text text-anchor="middle" x="7586" y="-313.04" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- split_3&#45;&gt;expert_3_15 -->
<g id="edge139" class="edge">
<title>split_3&#45;&gt;expert_3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4123.59,-459.26C4730.22,-460.35 6709.07,-458.03 7341,-384.74 7367.74,-381.64 7395.87,-377 7423.15,-371.74"/>
<polygon fill="black" stroke="black" points="7424.02,-375.14 7433.16,-369.78 7422.68,-368.27 7424.02,-375.14"/>
</g>
<!-- gather_3 -->
<g id="node80" class="node">
<title>gather_3</title>
<polygon fill="lightyellow" stroke="black" points="4106.88,-241.74 3806.42,-241.74 3729.12,-165.74 4029.58,-165.74 4106.88,-241.74"/>
<text text-anchor="middle" x="3918" y="-207.54" font-family="Times,serif" font-size="14.00">Gather Results Layer 4</text>
<text text-anchor="middle" x="3918" y="-192.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- expert_3_0&#45;&gt;gather_3 -->
<g id="edge110" class="edge">
<title>expert_3_0&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M403.85,-293.83C434.22,-287.77 465.99,-282.3 496,-278.74 803.29,-242.24 882.64,-267.08 1192,-259.74 2169.26,-236.54 3343.75,-214.98 3761.33,-207.51"/>
<polygon fill="black" stroke="black" points="3761.41,-211.01 3771.35,-207.33 3761.29,-204.01 3761.41,-211.01"/>
</g>
<!-- expert_3_1&#45;&gt;gather_3 -->
<g id="edge112" class="edge">
<title>expert_3_1&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M892.85,-293.78C923.21,-287.72 954.99,-282.27 985,-278.74 1528.97,-214.7 3228.95,-206.03 3758.72,-204.9"/>
<polygon fill="black" stroke="black" points="3758.74,-208.4 3768.73,-204.88 3758.72,-201.4 3758.74,-208.4"/>
</g>
<!-- expert_3_2&#45;&gt;gather_3 -->
<g id="edge114" class="edge">
<title>expert_3_2&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M1381.86,-293.87C1412.22,-287.8 1443.99,-282.33 1474,-278.74 1611.52,-262.3 1958.56,-264.87 2097,-260.74 2714.11,-242.34 3448.83,-219.44 3763.04,-209.6"/>
<polygon fill="black" stroke="black" points="3763.24,-213.1 3773.13,-209.29 3763.02,-206.1 3763.24,-213.1"/>
</g>
<!-- expert_3_3&#45;&gt;gather_3 -->
<g id="edge116" class="edge">
<title>expert_3_3&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M1870.83,-293.62C1901.2,-287.57 1932.98,-282.17 1963,-278.74 2180.29,-253.92 2728.45,-269.04 2947,-260.74 3238.13,-249.69 3577.9,-228.09 3768.5,-215.19"/>
<polygon fill="black" stroke="black" points="3768.85,-218.68 3778.59,-214.51 3768.38,-211.69 3768.85,-218.68"/>
</g>
<!-- expert_3_4&#45;&gt;gather_3 -->
<g id="edge118" class="edge">
<title>expert_3_4&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M2359.83,-293.65C2390.2,-287.6 2421.98,-282.19 2452,-278.74 2656.03,-255.32 3171.01,-273.3 3376,-260.74 3511.97,-252.41 3666.47,-235.73 3775.63,-222.73"/>
<polygon fill="black" stroke="black" points="3776.21,-226.19 3785.72,-221.52 3775.38,-219.24 3776.21,-226.19"/>
</g>
<!-- expert_3_5&#45;&gt;gather_3 -->
<g id="edge120" class="edge">
<title>expert_3_5&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M2848.85,-293.84C2879.22,-287.77 2910.99,-282.31 2941,-278.74 3229.3,-244.46 3305.1,-289.54 3594,-260.74 3657.09,-254.45 3726.43,-243.08 3784.72,-232.21"/>
<polygon fill="black" stroke="black" points="3785.54,-235.62 3794.72,-230.34 3784.24,-228.74 3785.54,-235.62"/>
</g>
<!-- expert_3_6&#45;&gt;gather_3 -->
<g id="edge122" class="edge">
<title>expert_3_6&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M3338.62,-294.6C3368.78,-288.51 3400.28,-282.84 3430,-278.74 3551.77,-261.94 3584.68,-280.53 3706,-260.74 3734.65,-256.07 3765.05,-249.21 3793.6,-241.88"/>
<polygon fill="black" stroke="black" points="3794.82,-245.18 3803.62,-239.27 3793.06,-238.41 3794.82,-245.18"/>
</g>
<!-- expert_3_7&#45;&gt;gather_3 -->
<g id="edge124" class="edge">
<title>expert_3_7&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M3775.01,-278.58C3795.7,-267.9 3817.22,-256.78 3837.1,-246.52"/>
<polygon fill="black" stroke="black" points="3838.82,-249.57 3846.1,-241.87 3835.61,-243.35 3838.82,-249.57"/>
</g>
<!-- expert_3_8&#45;&gt;gather_3 -->
<g id="edge126" class="edge">
<title>expert_3_8&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M4061.58,-278.58C4040.8,-267.9 4019.19,-256.78 3999.24,-246.52"/>
<polygon fill="black" stroke="black" points="4000.69,-243.33 3990.19,-241.87 3997.48,-249.55 4000.69,-243.33"/>
</g>
<!-- expert_3_9&#45;&gt;gather_3 -->
<g id="edge128" class="edge">
<title>expert_3_9&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M4418.64,-280.88C4414.73,-280.15 4410.85,-279.44 4407,-278.74 4307.15,-260.6 4195.26,-243.44 4103.74,-230.22"/>
<polygon fill="black" stroke="black" points="4104.22,-226.75 4093.82,-228.79 4103.22,-233.68 4104.22,-226.75"/>
</g>
<!-- expert_3_10&#45;&gt;gather_3 -->
<g id="edge130" class="edge">
<title>expert_3_10&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M4907.05,-280.38C4903.34,-279.81 4899.66,-279.26 4896,-278.74 4612.9,-238.17 4280.31,-218.98 4085.02,-210.58"/>
<polygon fill="black" stroke="black" points="4085.1,-207.08 4074.96,-210.15 4084.8,-214.08 4085.1,-207.08"/>
</g>
<!-- expert_3_11&#45;&gt;gather_3 -->
<g id="edge132" class="edge">
<title>expert_3_11&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M5396.07,-280.25C5392.36,-279.72 5388.66,-279.22 5385,-278.74 4913.46,-217.2 4350.49,-206.05 4079.49,-204.53"/>
<polygon fill="black" stroke="black" points="4079.2,-201.03 4069.18,-204.48 4079.16,-208.03 4079.2,-201.03"/>
</g>
<!-- expert_3_12&#45;&gt;gather_3 -->
<g id="edge134" class="edge">
<title>expert_3_12&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M5885.08,-280.18C5881.36,-279.68 5877.67,-279.2 5874,-278.74 5529.21,-235.95 4487.33,-214.31 4081.91,-207.33"/>
<polygon fill="black" stroke="black" points="4081.92,-203.83 4071.86,-207.15 4081.8,-210.82 4081.92,-203.83"/>
</g>
<!-- expert_3_13&#45;&gt;gather_3 -->
<g id="edge136" class="edge">
<title>expert_3_13&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M6374.08,-280.15C6370.37,-279.65 6366.67,-279.18 6363,-278.74 5919.47,-225.4 4553.63,-209.75 4080.97,-205.87"/>
<polygon fill="black" stroke="black" points="4080.68,-202.37 4070.66,-205.79 4080.63,-209.37 4080.68,-202.37"/>
</g>
<!-- expert_3_14&#45;&gt;gather_3 -->
<g id="edge138" class="edge">
<title>expert_3_14&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M6862.76,-280.09C6859.15,-279.61 6855.56,-279.16 6852,-278.74 6544.71,-242.24 6465.34,-267.76 6156,-259.74 5380.62,-239.63 4454.08,-217.45 4083.27,-208.65"/>
<polygon fill="black" stroke="black" points="4083.08,-205.14 4073,-208.4 4082.91,-212.14 4083.08,-205.14"/>
</g>
<!-- expert_3_15&#45;&gt;gather_3 -->
<g id="edge140" class="edge">
<title>expert_3_15&#45;&gt;gather_3</title>
<path fill="none" stroke="black" d="M7351.76,-280.06C7348.15,-279.59 7344.56,-279.15 7341,-278.74 6697.32,-204.14 4667.2,-202.93 4079.11,-204.22"/>
<polygon fill="black" stroke="black" points="4078.85,-200.72 4068.86,-204.24 4078.87,-207.72 4078.85,-200.72"/>
</g>
<!-- residual_3 -->
<g id="node81" class="node">
<title>residual_3</title>
<polygon fill="orange" stroke="black" points="4002.5,-128.74 3833.5,-128.74 3833.5,-90.74 4002.5,-90.74 4002.5,-128.74"/>
<text text-anchor="middle" x="3918" y="-113.54" font-family="Times,serif" font-size="14.00">Residual Add Layer 4</text>
<text text-anchor="middle" x="3918" y="-98.54" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
</g>
<!-- gather_3&#45;&gt;residual_3 -->
<g id="edge141" class="edge">
<title>gather_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M3918,-165.59C3918,-156.68 3918,-147.31 3918,-138.89"/>
<polygon fill="black" stroke="black" points="3921.5,-138.83 3918,-128.83 3914.5,-138.83 3921.5,-138.83"/>
</g>
<!-- output -->
<g id="node82" class="node">
<title>output</title>
<ellipse fill="lightcoral" stroke="black" cx="3918" cy="-26.87" rx="146.24" ry="26.74"/>
<text text-anchor="middle" x="3918" y="-30.67" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="3918" y="-15.67" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_size]</text>
</g>
<!-- residual_3&#45;&gt;output -->
<g id="edge142" class="edge">
<title>residual_3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M3918,-90.39C3918,-82.53 3918,-73.07 3918,-63.92"/>
<polygon fill="black" stroke="black" points="3921.5,-63.81 3918,-53.81 3914.5,-63.81 3921.5,-63.81"/>
</g>
</g>
</svg>
