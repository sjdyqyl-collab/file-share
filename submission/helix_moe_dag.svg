<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="10673pt" height="11967pt"
 viewBox="0.00 0.00 10673.00 11966.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 11962.53)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-11962.53 10669,-11962.53 10669,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M5713,-11558.58C5713,-11558.58 5863,-11558.58 5863,-11558.58 5869,-11558.58 5875,-11564.58 5875,-11570.58 5875,-11570.58 5875,-11938.53 5875,-11938.53 5875,-11944.53 5869,-11950.53 5863,-11950.53 5863,-11950.53 5713,-11950.53 5713,-11950.53 5707,-11950.53 5701,-11944.53 5701,-11938.53 5701,-11938.53 5701,-11570.58 5701,-11570.58 5701,-11564.58 5707,-11558.58 5713,-11558.58"/>
<text text-anchor="middle" x="5788" y="-11935.33" font-family="Times,serif" font-size="14.00">Input Processing</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M151,-8780.67C151,-8780.67 9158,-8780.67 9158,-8780.67 9164,-8780.67 9170,-8786.67 9170,-8792.67 9170,-8792.67 9170,-11499.58 9170,-11499.58 9170,-11505.58 9164,-11511.58 9158,-11511.58 9158,-11511.58 151,-11511.58 151,-11511.58 145,-11511.58 139,-11505.58 139,-11499.58 139,-11499.58 139,-8792.67 139,-8792.67 139,-8786.67 145,-8780.67 151,-8780.67"/>
<text text-anchor="middle" x="4654.5" y="-11496.38" font-family="Times,serif" font-size="14.00">Layer 1 (MoE)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M1561,-6002.77C1561,-6002.77 10568,-6002.77 10568,-6002.77 10574,-6002.77 10580,-6008.77 10580,-6014.77 10580,-6014.77 10580,-8721.67 10580,-8721.67 10580,-8727.67 10574,-8733.67 10568,-8733.67 10568,-8733.67 1561,-8733.67 1561,-8733.67 1555,-8733.67 1549,-8727.67 1549,-8721.67 1549,-8721.67 1549,-6014.77 1549,-6014.77 1549,-6008.77 1555,-6002.77 1561,-6002.77"/>
<text text-anchor="middle" x="6064.5" y="-8718.47" font-family="Times,serif" font-size="14.00">Layer 2 (MoE)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M20,-3224.86C20,-3224.86 9027,-3224.86 9027,-3224.86 9033,-3224.86 9039,-3230.86 9039,-3236.86 9039,-3236.86 9039,-5943.77 9039,-5943.77 9039,-5949.77 9033,-5955.77 9027,-5955.77 9027,-5955.77 20,-5955.77 20,-5955.77 14,-5955.77 8,-5949.77 8,-5943.77 8,-5943.77 8,-3236.86 8,-3236.86 8,-3230.86 14,-3224.86 20,-3224.86"/>
<text text-anchor="middle" x="4523.5" y="-5940.57" font-family="Times,serif" font-size="14.00">Layer 3 (MoE)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer4</title>
<path fill="none" stroke="black" d="M1638,-446.95C1638,-446.95 10645,-446.95 10645,-446.95 10651,-446.95 10657,-452.95 10657,-458.95 10657,-458.95 10657,-3165.86 10657,-3165.86 10657,-3171.86 10651,-3177.86 10645,-3177.86 10645,-3177.86 1638,-3177.86 1638,-3177.86 1632,-3177.86 1626,-3171.86 1626,-3165.86 1626,-3165.86 1626,-458.95 1626,-458.95 1626,-452.95 1632,-446.95 1638,-446.95"/>
<text text-anchor="middle" x="6141.5" y="-3162.66" font-family="Times,serif" font-size="14.00">Layer 4 (MoE)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M9460,-8C9460,-8 9628,-8 9628,-8 9634,-8 9640,-14 9640,-20 9640,-20 9640,-387.95 9640,-387.95 9640,-393.95 9634,-399.95 9628,-399.95 9628,-399.95 9460,-399.95 9460,-399.95 9454,-399.95 9448,-393.95 9448,-387.95 9448,-387.95 9448,-20 9448,-20 9448,-14 9454,-8 9460,-8"/>
<text text-anchor="middle" x="9544" y="-384.75" font-family="Times,serif" font-size="14.00">Output Processing</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="5788" cy="-11882.06" rx="77.15" ry="37.45"/>
<text text-anchor="middle" x="5788" y="-11893.36" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="5788" y="-11878.36" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5788" y="-11863.36" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightblue" stroke="black" points="5859.5,-11758.58 5716.5,-11758.58 5716.5,-11705.58 5859.5,-11705.58 5859.5,-11758.58"/>
<text text-anchor="middle" x="5788" y="-11743.38" font-family="Times,serif" font-size="14.00">Embedding Layer</text>
<text text-anchor="middle" x="5788" y="-11728.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5788" y="-11713.38" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M5788,-11844.21C5788,-11844.21 5788,-11769.03 5788,-11769.03"/>
<polygon fill="black" stroke="black" points="5791.5,-11769.03 5788,-11759.03 5784.5,-11769.03 5791.5,-11769.03"/>
</g>
<!-- pos_enc -->
<g id="node3" class="node">
<title>pos_enc</title>
<polygon fill="lightblue" stroke="black" points="5867,-11619.58 5709,-11619.58 5709,-11566.58 5867,-11566.58 5867,-11619.58"/>
<text text-anchor="middle" x="5788" y="-11604.38" font-family="Times,serif" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="5788" y="-11589.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5788" y="-11574.38" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- embed&#45;&gt;pos_enc -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;pos_enc</title>
<path fill="none" stroke="black" d="M5788,-11705.28C5788,-11705.28 5788,-11629.8 5788,-11629.8"/>
<polygon fill="black" stroke="black" points="5791.5,-11629.8 5788,-11619.8 5784.5,-11629.8 5791.5,-11629.8"/>
</g>
<!-- ln1_0 -->
<g id="node4" class="node">
<title>ln1_0</title>
<polygon fill="lightblue" stroke="black" points="8011,-11480.58 7913,-11480.58 7913,-11427.58 8011,-11427.58 8011,-11480.58"/>
<text text-anchor="middle" x="7962" y="-11465.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7962" y="-11450.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7962" y="-11435.38" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- pos_enc&#45;&gt;ln1_0 -->
<g id="edge3" class="edge">
<title>pos_enc&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M5852,-11566.51C5852,-11531.97 5852,-11476 5852,-11476 5852,-11476 7902.95,-11476 7902.95,-11476"/>
<polygon fill="black" stroke="black" points="7902.95,-11479.5 7912.95,-11476 7902.95,-11472.5 7902.95,-11479.5"/>
</g>
<!-- ln1_1 -->
<g id="node5" class="node">
<title>ln1_1</title>
<polygon fill="lightblue" stroke="black" points="5837,-11480.58 5739,-11480.58 5739,-11427.58 5837,-11427.58 5837,-11480.58"/>
<text text-anchor="middle" x="5788" y="-11465.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5788" y="-11450.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5788" y="-11435.38" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- pos_enc&#45;&gt;ln1_1 -->
<g id="edge33" class="edge">
<title>pos_enc&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M5788,-11566.28C5788,-11566.28 5788,-11490.8 5788,-11490.8"/>
<polygon fill="black" stroke="black" points="5791.5,-11490.8 5788,-11480.8 5784.5,-11490.8 5791.5,-11490.8"/>
</g>
<!-- ln1_2 -->
<g id="node6" class="node">
<title>ln1_2</title>
<polygon fill="lightblue" stroke="black" points="3664,-11480.58 3566,-11480.58 3566,-11427.58 3664,-11427.58 3664,-11480.58"/>
<text text-anchor="middle" x="3615" y="-11465.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3615" y="-11450.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="3615" y="-11435.38" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- pos_enc&#45;&gt;ln1_2 -->
<g id="edge63" class="edge">
<title>pos_enc&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M5724,-11566.51C5724,-11531.97 5724,-11476 5724,-11476 5724,-11476 3674.03,-11476 3674.03,-11476"/>
<polygon fill="black" stroke="black" points="3674.03,-11472.5 3664.03,-11476 3674.03,-11479.5 3674.03,-11472.5"/>
</g>
<!-- ln1_3 -->
<g id="node7" class="node">
<title>ln1_3</title>
<polygon fill="lightblue" stroke="black" points="1396,-11480.58 1298,-11480.58 1298,-11427.58 1396,-11427.58 1396,-11480.58"/>
<text text-anchor="middle" x="1347" y="-11465.38" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1347" y="-11450.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="1347" y="-11435.38" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- pos_enc&#45;&gt;ln1_3 -->
<g id="edge93" class="edge">
<title>pos_enc&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M5708.56,-11593C5111.21,-11593 1347,-11593 1347,-11593 1347,-11593 1347,-11490.87 1347,-11490.87"/>
<polygon fill="black" stroke="black" points="1350.5,-11490.87 1347,-11480.87 1343.5,-11490.87 1350.5,-11490.87"/>
</g>
<!-- residual1 -->
<g id="node78" class="node">
<title>residual1</title>
<ellipse fill="yellow" stroke="black" cx="8374" cy="-10503.1" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8374" y="-10514.4" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8374" y="-10499.4" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8374" y="-10484.4" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- pos_enc&#45;&gt;residual1 -->
<g id="edge125" class="edge">
<title>pos_enc&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M5867.03,-11593C6306.4,-11593 8428.64,-11593 8428.64,-11593 8428.64,-11593 8428.64,-10540.04 8428.64,-10540.04"/>
<polygon fill="black" stroke="black" points="8432.14,-10540.04 8428.64,-10530.04 8425.14,-10540.04 8432.14,-10540.04"/>
</g>
<!-- q_proj_0_0 -->
<g id="node8" class="node">
<title>q_proj_0_0</title>
<polygon fill="lightcoral" stroke="black" points="7082.5,-11341.58 6951.5,-11341.58 6951.5,-11288.58 7082.5,-11288.58 7082.5,-11341.58"/>
<text text-anchor="middle" x="7017" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7017" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7017" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_0 -->
<g id="edge4" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_0</title>
<path fill="none" stroke="black" d="M7912.85,-11467C7718.88,-11467 7017,-11467 7017,-11467 7017,-11467 7017,-11351.89 7017,-11351.89"/>
<polygon fill="black" stroke="black" points="7020.5,-11351.89 7017,-11341.89 7013.5,-11351.89 7020.5,-11351.89"/>
</g>
<!-- k_proj_0_0 -->
<g id="node9" class="node">
<title>k_proj_0_0</title>
<polygon fill="lightcoral" stroke="black" points="7271.5,-11341.58 7140.5,-11341.58 7140.5,-11288.58 7271.5,-11288.58 7271.5,-11341.58"/>
<text text-anchor="middle" x="7206" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7206" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7206" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_0 -->
<g id="edge5" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_0</title>
<path fill="none" stroke="black" d="M7912.98,-11458C7745.45,-11458 7206,-11458 7206,-11458 7206,-11458 7206,-11351.63 7206,-11351.63"/>
<polygon fill="black" stroke="black" points="7209.5,-11351.63 7206,-11341.63 7202.5,-11351.63 7209.5,-11351.63"/>
</g>
<!-- v_proj_0_0 -->
<g id="node10" class="node">
<title>v_proj_0_0</title>
<polygon fill="lightcoral" stroke="black" points="7460.5,-11341.58 7329.5,-11341.58 7329.5,-11288.58 7460.5,-11288.58 7460.5,-11341.58"/>
<text text-anchor="middle" x="7395" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7395" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7395" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_0 -->
<g id="edge6" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_0</title>
<path fill="none" stroke="black" d="M7912.67,-11449C7774.73,-11449 7395,-11449 7395,-11449 7395,-11449 7395,-11351.86 7395,-11351.86"/>
<polygon fill="black" stroke="black" points="7398.5,-11351.86 7395,-11341.86 7391.5,-11351.86 7398.5,-11351.86"/>
</g>
<!-- q_proj_0_1 -->
<g id="node12" class="node">
<title>q_proj_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7649.5,-11341.58 7518.5,-11341.58 7518.5,-11288.58 7649.5,-11288.58 7649.5,-11341.58"/>
<text text-anchor="middle" x="7584" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7584" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7584" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_1 -->
<g id="edge11" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_1</title>
<path fill="none" stroke="black" d="M7912.97,-11440C7810.69,-11440 7584,-11440 7584,-11440 7584,-11440 7584,-11351.88 7584,-11351.88"/>
<polygon fill="black" stroke="black" points="7587.5,-11351.88 7584,-11341.88 7580.5,-11351.88 7587.5,-11351.88"/>
</g>
<!-- k_proj_0_1 -->
<g id="node13" class="node">
<title>k_proj_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7838.5,-11341.58 7707.5,-11341.58 7707.5,-11288.58 7838.5,-11288.58 7838.5,-11341.58"/>
<text text-anchor="middle" x="7773" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7773" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7773" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_1 -->
<g id="edge12" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_1</title>
<path fill="none" stroke="black" d="M7912.84,-11431C7856.84,-11431 7773,-11431 7773,-11431 7773,-11431 7773,-11351.67 7773,-11351.67"/>
<polygon fill="black" stroke="black" points="7776.5,-11351.67 7773,-11341.67 7769.5,-11351.67 7776.5,-11351.67"/>
</g>
<!-- v_proj_0_1 -->
<g id="node14" class="node">
<title>v_proj_0_1</title>
<polygon fill="lightcoral" stroke="black" points="8027.5,-11341.58 7896.5,-11341.58 7896.5,-11288.58 8027.5,-11288.58 8027.5,-11341.58"/>
<text text-anchor="middle" x="7962" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7962" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7962" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_1 -->
<g id="edge13" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_1</title>
<path fill="none" stroke="black" d="M7962,-11427.28C7962,-11427.28 7962,-11351.8 7962,-11351.8"/>
<polygon fill="black" stroke="black" points="7965.5,-11351.8 7962,-11341.8 7958.5,-11351.8 7965.5,-11351.8"/>
</g>
<!-- q_proj_0_2 -->
<g id="node16" class="node">
<title>q_proj_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8216.5,-11341.58 8085.5,-11341.58 8085.5,-11288.58 8216.5,-11288.58 8216.5,-11341.58"/>
<text text-anchor="middle" x="8151" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8151" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8151" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_2 -->
<g id="edge18" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_2</title>
<path fill="none" stroke="black" d="M8011.16,-11435C8067.16,-11435 8151,-11435 8151,-11435 8151,-11435 8151,-11351.69 8151,-11351.69"/>
<polygon fill="black" stroke="black" points="8154.5,-11351.69 8151,-11341.69 8147.5,-11351.69 8154.5,-11351.69"/>
</g>
<!-- k_proj_0_2 -->
<g id="node17" class="node">
<title>k_proj_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8405.5,-11341.58 8274.5,-11341.58 8274.5,-11288.58 8405.5,-11288.58 8405.5,-11341.58"/>
<text text-anchor="middle" x="8340" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8340" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8340" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_2 -->
<g id="edge19" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_2</title>
<path fill="none" stroke="black" d="M8011.03,-11442C8113.31,-11442 8340,-11442 8340,-11442 8340,-11442 8340,-11351.69 8340,-11351.69"/>
<polygon fill="black" stroke="black" points="8343.5,-11351.69 8340,-11341.69 8336.5,-11351.69 8343.5,-11351.69"/>
</g>
<!-- v_proj_0_2 -->
<g id="node18" class="node">
<title>v_proj_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8594.5,-11341.58 8463.5,-11341.58 8463.5,-11288.58 8594.5,-11288.58 8594.5,-11341.58"/>
<text text-anchor="middle" x="8529" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8529" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8529" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_2 -->
<g id="edge20" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_2</title>
<path fill="none" stroke="black" d="M8011.33,-11450C8149.27,-11450 8529,-11450 8529,-11450 8529,-11450 8529,-11351.74 8529,-11351.74"/>
<polygon fill="black" stroke="black" points="8532.5,-11351.74 8529,-11341.74 8525.5,-11351.74 8532.5,-11351.74"/>
</g>
<!-- q_proj_0_3 -->
<g id="node20" class="node">
<title>q_proj_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8783.5,-11341.58 8652.5,-11341.58 8652.5,-11288.58 8783.5,-11288.58 8783.5,-11341.58"/>
<text text-anchor="middle" x="8718" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8718" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8718" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_0&#45;&gt;q_proj_0_3 -->
<g id="edge25" class="edge">
<title>ln1_0&#45;&gt;q_proj_0_3</title>
<path fill="none" stroke="black" d="M8011.02,-11457C8178.55,-11457 8718,-11457 8718,-11457 8718,-11457 8718,-11351.77 8718,-11351.77"/>
<polygon fill="black" stroke="black" points="8721.5,-11351.77 8718,-11341.77 8714.5,-11351.77 8721.5,-11351.77"/>
</g>
<!-- k_proj_0_3 -->
<g id="node21" class="node">
<title>k_proj_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8972.5,-11341.58 8841.5,-11341.58 8841.5,-11288.58 8972.5,-11288.58 8972.5,-11341.58"/>
<text text-anchor="middle" x="8907" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8907" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8907" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_0&#45;&gt;k_proj_0_3 -->
<g id="edge26" class="edge">
<title>ln1_0&#45;&gt;k_proj_0_3</title>
<path fill="none" stroke="black" d="M8011.15,-11465C8205.12,-11465 8907,-11465 8907,-11465 8907,-11465 8907,-11351.88 8907,-11351.88"/>
<polygon fill="black" stroke="black" points="8910.5,-11351.88 8907,-11341.88 8903.5,-11351.88 8910.5,-11351.88"/>
</g>
<!-- v_proj_0_3 -->
<g id="node22" class="node">
<title>v_proj_0_3</title>
<polygon fill="lightcoral" stroke="black" points="9161.5,-11341.58 9030.5,-11341.58 9030.5,-11288.58 9161.5,-11288.58 9161.5,-11341.58"/>
<text text-anchor="middle" x="9096" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9096" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9096" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_0&#45;&gt;v_proj_0_3 -->
<g id="edge27" class="edge">
<title>ln1_0&#45;&gt;v_proj_0_3</title>
<path fill="none" stroke="black" d="M8011.09,-11473C8228.75,-11473 9096,-11473 9096,-11473 9096,-11473 9096,-11351.87 9096,-11351.87"/>
<polygon fill="black" stroke="black" points="9099.5,-11351.87 9096,-11341.87 9092.5,-11351.87 9099.5,-11351.87"/>
</g>
<!-- q_proj_1_0 -->
<g id="node24" class="node">
<title>q_proj_1_0</title>
<polygon fill="lightcoral" stroke="black" points="4814.5,-11341.58 4683.5,-11341.58 4683.5,-11288.58 4814.5,-11288.58 4814.5,-11341.58"/>
<text text-anchor="middle" x="4749" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4749" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4749" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_0 -->
<g id="edge34" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_0</title>
<path fill="none" stroke="black" d="M5738.93,-11471C5532.98,-11471 4749,-11471 4749,-11471 4749,-11471 4749,-11351.88 4749,-11351.88"/>
<polygon fill="black" stroke="black" points="4752.5,-11351.88 4749,-11341.88 4745.5,-11351.88 4752.5,-11351.88"/>
</g>
<!-- k_proj_1_0 -->
<g id="node25" class="node">
<title>k_proj_1_0</title>
<polygon fill="lightcoral" stroke="black" points="5003.5,-11341.58 4872.5,-11341.58 4872.5,-11288.58 5003.5,-11288.58 5003.5,-11341.58"/>
<text text-anchor="middle" x="4938" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4938" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4938" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_0 -->
<g id="edge35" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_0</title>
<path fill="none" stroke="black" d="M5738.94,-11462C5557.92,-11462 4938,-11462 4938,-11462 4938,-11462 4938,-11351.69 4938,-11351.69"/>
<polygon fill="black" stroke="black" points="4941.5,-11351.69 4938,-11341.69 4934.5,-11351.69 4941.5,-11351.69"/>
</g>
<!-- v_proj_1_0 -->
<g id="node26" class="node">
<title>v_proj_1_0</title>
<polygon fill="lightcoral" stroke="black" points="5192.5,-11341.58 5061.5,-11341.58 5061.5,-11288.58 5192.5,-11288.58 5192.5,-11341.58"/>
<text text-anchor="middle" x="5127" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5127" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5127" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_0 -->
<g id="edge36" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_0</title>
<path fill="none" stroke="black" d="M5738.86,-11454C5585.67,-11454 5127,-11454 5127,-11454 5127,-11454 5127,-11351.87 5127,-11351.87"/>
<polygon fill="black" stroke="black" points="5130.5,-11351.87 5127,-11341.87 5123.5,-11351.87 5130.5,-11351.87"/>
</g>
<!-- q_proj_1_1 -->
<g id="node28" class="node">
<title>q_proj_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5381.5,-11341.58 5250.5,-11341.58 5250.5,-11288.58 5381.5,-11288.58 5381.5,-11341.58"/>
<text text-anchor="middle" x="5316" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5316" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5316" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_1 -->
<g id="edge41" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_1</title>
<path fill="none" stroke="black" d="M5738.82,-11445C5617.93,-11445 5316,-11445 5316,-11445 5316,-11445 5316,-11351.68 5316,-11351.68"/>
<polygon fill="black" stroke="black" points="5319.5,-11351.68 5316,-11341.68 5312.5,-11351.68 5319.5,-11351.68"/>
</g>
<!-- k_proj_1_1 -->
<g id="node29" class="node">
<title>k_proj_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5570.5,-11341.58 5439.5,-11341.58 5439.5,-11288.58 5570.5,-11288.58 5570.5,-11341.58"/>
<text text-anchor="middle" x="5505" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5505" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5505" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_1 -->
<g id="edge42" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_1</title>
<path fill="none" stroke="black" d="M5738.71,-11436C5657.62,-11436 5505,-11436 5505,-11436 5505,-11436 5505,-11351.62 5505,-11351.62"/>
<polygon fill="black" stroke="black" points="5508.5,-11351.62 5505,-11341.62 5501.5,-11351.62 5508.5,-11351.62"/>
</g>
<!-- v_proj_1_1 -->
<g id="node30" class="node">
<title>v_proj_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5759.5,-11341.58 5628.5,-11341.58 5628.5,-11288.58 5759.5,-11288.58 5759.5,-11341.58"/>
<text text-anchor="middle" x="5694" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5694" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5694" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_1 -->
<g id="edge43" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_1</title>
<path fill="none" stroke="black" d="M5749.25,-11427.28C5749.25,-11427.28 5749.25,-11351.8 5749.25,-11351.8"/>
<polygon fill="black" stroke="black" points="5752.75,-11351.8 5749.25,-11341.8 5745.75,-11351.8 5752.75,-11351.8"/>
</g>
<!-- q_proj_1_2 -->
<g id="node32" class="node">
<title>q_proj_1_2</title>
<polygon fill="lightcoral" stroke="black" points="5948.5,-11341.58 5817.5,-11341.58 5817.5,-11288.58 5948.5,-11288.58 5948.5,-11341.58"/>
<text text-anchor="middle" x="5883" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5883" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5883" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_2 -->
<g id="edge48" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_2</title>
<path fill="none" stroke="black" d="M5827.25,-11427.28C5827.25,-11427.28 5827.25,-11351.8 5827.25,-11351.8"/>
<polygon fill="black" stroke="black" points="5830.75,-11351.8 5827.25,-11341.8 5823.75,-11351.8 5830.75,-11351.8"/>
</g>
<!-- k_proj_1_2 -->
<g id="node33" class="node">
<title>k_proj_1_2</title>
<polygon fill="lightcoral" stroke="black" points="6137.5,-11341.58 6006.5,-11341.58 6006.5,-11288.58 6137.5,-11288.58 6137.5,-11341.58"/>
<text text-anchor="middle" x="6072" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6072" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6072" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_2 -->
<g id="edge49" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_2</title>
<path fill="none" stroke="black" d="M5837.14,-11436C5918.43,-11436 6072,-11436 6072,-11436 6072,-11436 6072,-11351.62 6072,-11351.62"/>
<polygon fill="black" stroke="black" points="6075.5,-11351.62 6072,-11341.62 6068.5,-11351.62 6075.5,-11351.62"/>
</g>
<!-- v_proj_1_2 -->
<g id="node34" class="node">
<title>v_proj_1_2</title>
<polygon fill="lightcoral" stroke="black" points="6326.5,-11341.58 6195.5,-11341.58 6195.5,-11288.58 6326.5,-11288.58 6326.5,-11341.58"/>
<text text-anchor="middle" x="6261" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6261" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6261" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_2 -->
<g id="edge50" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_2</title>
<path fill="none" stroke="black" d="M5837.28,-11445C5958.43,-11445 6261,-11445 6261,-11445 6261,-11445 6261,-11351.68 6261,-11351.68"/>
<polygon fill="black" stroke="black" points="6264.5,-11351.68 6261,-11341.68 6257.5,-11351.68 6264.5,-11351.68"/>
</g>
<!-- q_proj_1_3 -->
<g id="node36" class="node">
<title>q_proj_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6515.5,-11341.58 6384.5,-11341.58 6384.5,-11288.58 6515.5,-11288.58 6515.5,-11341.58"/>
<text text-anchor="middle" x="6450" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6450" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6450" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_1&#45;&gt;q_proj_1_3 -->
<g id="edge55" class="edge">
<title>ln1_1&#45;&gt;q_proj_1_3</title>
<path fill="none" stroke="black" d="M5837.22,-11454C5990.64,-11454 6450,-11454 6450,-11454 6450,-11454 6450,-11351.87 6450,-11351.87"/>
<polygon fill="black" stroke="black" points="6453.5,-11351.87 6450,-11341.87 6446.5,-11351.87 6453.5,-11351.87"/>
</g>
<!-- k_proj_1_3 -->
<g id="node37" class="node">
<title>k_proj_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6704.5,-11341.58 6573.5,-11341.58 6573.5,-11288.58 6704.5,-11288.58 6704.5,-11341.58"/>
<text text-anchor="middle" x="6639" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6639" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6639" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_1&#45;&gt;k_proj_1_3 -->
<g id="edge56" class="edge">
<title>ln1_1&#45;&gt;k_proj_1_3</title>
<path fill="none" stroke="black" d="M5837.12,-11462C6018.35,-11462 6639,-11462 6639,-11462 6639,-11462 6639,-11351.69 6639,-11351.69"/>
<polygon fill="black" stroke="black" points="6642.5,-11351.69 6639,-11341.69 6635.5,-11351.69 6642.5,-11351.69"/>
</g>
<!-- v_proj_1_3 -->
<g id="node38" class="node">
<title>v_proj_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6893.5,-11341.58 6762.5,-11341.58 6762.5,-11288.58 6893.5,-11288.58 6893.5,-11341.58"/>
<text text-anchor="middle" x="6828" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6828" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6828" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_1&#45;&gt;v_proj_1_3 -->
<g id="edge57" class="edge">
<title>ln1_1&#45;&gt;v_proj_1_3</title>
<path fill="none" stroke="black" d="M5837.11,-11471C6043.26,-11471 6828,-11471 6828,-11471 6828,-11471 6828,-11351.88 6828,-11351.88"/>
<polygon fill="black" stroke="black" points="6831.5,-11351.88 6828,-11341.88 6824.5,-11351.88 6831.5,-11351.88"/>
</g>
<!-- q_proj_2_0 -->
<g id="node40" class="node">
<title>q_proj_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2546.5,-11341.58 2415.5,-11341.58 2415.5,-11288.58 2546.5,-11288.58 2546.5,-11341.58"/>
<text text-anchor="middle" x="2481" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2481" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2481" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_0 -->
<g id="edge64" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_0</title>
<path fill="none" stroke="black" d="M3565.91,-11476C3348.25,-11476 2481,-11476 2481,-11476 2481,-11476 2481,-11351.65 2481,-11351.65"/>
<polygon fill="black" stroke="black" points="2484.5,-11351.65 2481,-11341.65 2477.5,-11351.65 2484.5,-11351.65"/>
</g>
<!-- k_proj_2_0 -->
<g id="node41" class="node">
<title>k_proj_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2735.5,-11341.58 2604.5,-11341.58 2604.5,-11288.58 2735.5,-11288.58 2735.5,-11341.58"/>
<text text-anchor="middle" x="2670" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2670" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2670" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_0 -->
<g id="edge65" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_0</title>
<path fill="none" stroke="black" d="M3565.85,-11467C3371.88,-11467 2670,-11467 2670,-11467 2670,-11467 2670,-11351.89 2670,-11351.89"/>
<polygon fill="black" stroke="black" points="2673.5,-11351.89 2670,-11341.89 2666.5,-11351.89 2673.5,-11351.89"/>
</g>
<!-- v_proj_2_0 -->
<g id="node42" class="node">
<title>v_proj_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2924.5,-11341.58 2793.5,-11341.58 2793.5,-11288.58 2924.5,-11288.58 2924.5,-11341.58"/>
<text text-anchor="middle" x="2859" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2859" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2859" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_0 -->
<g id="edge66" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_0</title>
<path fill="none" stroke="black" d="M3565.98,-11458C3398.45,-11458 2859,-11458 2859,-11458 2859,-11458 2859,-11351.63 2859,-11351.63"/>
<polygon fill="black" stroke="black" points="2862.5,-11351.63 2859,-11341.63 2855.5,-11351.63 2862.5,-11351.63"/>
</g>
<!-- q_proj_2_1 -->
<g id="node44" class="node">
<title>q_proj_2_1</title>
<polygon fill="lightcoral" stroke="black" points="3113.5,-11341.58 2982.5,-11341.58 2982.5,-11288.58 3113.5,-11288.58 3113.5,-11341.58"/>
<text text-anchor="middle" x="3048" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3048" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3048" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_1 -->
<g id="edge71" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_1</title>
<path fill="none" stroke="black" d="M3565.67,-11449C3427.73,-11449 3048,-11449 3048,-11449 3048,-11449 3048,-11351.86 3048,-11351.86"/>
<polygon fill="black" stroke="black" points="3051.5,-11351.86 3048,-11341.86 3044.5,-11351.86 3051.5,-11351.86"/>
</g>
<!-- k_proj_2_1 -->
<g id="node45" class="node">
<title>k_proj_2_1</title>
<polygon fill="lightcoral" stroke="black" points="3302.5,-11341.58 3171.5,-11341.58 3171.5,-11288.58 3302.5,-11288.58 3302.5,-11341.58"/>
<text text-anchor="middle" x="3237" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3237" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3237" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_1 -->
<g id="edge72" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_1</title>
<path fill="none" stroke="black" d="M3565.97,-11440C3463.69,-11440 3237,-11440 3237,-11440 3237,-11440 3237,-11351.88 3237,-11351.88"/>
<polygon fill="black" stroke="black" points="3240.5,-11351.88 3237,-11341.88 3233.5,-11351.88 3240.5,-11351.88"/>
</g>
<!-- v_proj_2_1 -->
<g id="node46" class="node">
<title>v_proj_2_1</title>
<polygon fill="lightcoral" stroke="black" points="3491.5,-11341.58 3360.5,-11341.58 3360.5,-11288.58 3491.5,-11288.58 3491.5,-11341.58"/>
<text text-anchor="middle" x="3426" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3426" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3426" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_1 -->
<g id="edge73" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_1</title>
<path fill="none" stroke="black" d="M3565.84,-11431C3509.84,-11431 3426,-11431 3426,-11431 3426,-11431 3426,-11351.67 3426,-11351.67"/>
<polygon fill="black" stroke="black" points="3429.5,-11351.67 3426,-11341.67 3422.5,-11351.67 3429.5,-11351.67"/>
</g>
<!-- q_proj_2_2 -->
<g id="node48" class="node">
<title>q_proj_2_2</title>
<polygon fill="lightcoral" stroke="black" points="3680.5,-11341.58 3549.5,-11341.58 3549.5,-11288.58 3680.5,-11288.58 3680.5,-11341.58"/>
<text text-anchor="middle" x="3615" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3615" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3615" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_2 -->
<g id="edge78" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_2</title>
<path fill="none" stroke="black" d="M3615,-11427.28C3615,-11427.28 3615,-11351.8 3615,-11351.8"/>
<polygon fill="black" stroke="black" points="3618.5,-11351.8 3615,-11341.8 3611.5,-11351.8 3618.5,-11351.8"/>
</g>
<!-- k_proj_2_2 -->
<g id="node49" class="node">
<title>k_proj_2_2</title>
<polygon fill="lightcoral" stroke="black" points="3869.5,-11341.58 3738.5,-11341.58 3738.5,-11288.58 3869.5,-11288.58 3869.5,-11341.58"/>
<text text-anchor="middle" x="3804" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3804" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3804" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_2 -->
<g id="edge79" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_2</title>
<path fill="none" stroke="black" d="M3664.16,-11431C3720.16,-11431 3804,-11431 3804,-11431 3804,-11431 3804,-11351.67 3804,-11351.67"/>
<polygon fill="black" stroke="black" points="3807.5,-11351.67 3804,-11341.67 3800.5,-11351.67 3807.5,-11351.67"/>
</g>
<!-- v_proj_2_2 -->
<g id="node50" class="node">
<title>v_proj_2_2</title>
<polygon fill="lightcoral" stroke="black" points="4058.5,-11341.58 3927.5,-11341.58 3927.5,-11288.58 4058.5,-11288.58 4058.5,-11341.58"/>
<text text-anchor="middle" x="3993" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3993" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3993" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_2 -->
<g id="edge80" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_2</title>
<path fill="none" stroke="black" d="M3664.03,-11440C3766.31,-11440 3993,-11440 3993,-11440 3993,-11440 3993,-11351.88 3993,-11351.88"/>
<polygon fill="black" stroke="black" points="3996.5,-11351.88 3993,-11341.88 3989.5,-11351.88 3996.5,-11351.88"/>
</g>
<!-- q_proj_2_3 -->
<g id="node52" class="node">
<title>q_proj_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4247.5,-11341.58 4116.5,-11341.58 4116.5,-11288.58 4247.5,-11288.58 4247.5,-11341.58"/>
<text text-anchor="middle" x="4182" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4182" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4182" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_2&#45;&gt;q_proj_2_3 -->
<g id="edge85" class="edge">
<title>ln1_2&#45;&gt;q_proj_2_3</title>
<path fill="none" stroke="black" d="M3664.33,-11449C3802.27,-11449 4182,-11449 4182,-11449 4182,-11449 4182,-11351.86 4182,-11351.86"/>
<polygon fill="black" stroke="black" points="4185.5,-11351.86 4182,-11341.86 4178.5,-11351.86 4185.5,-11351.86"/>
</g>
<!-- k_proj_2_3 -->
<g id="node53" class="node">
<title>k_proj_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4436.5,-11341.58 4305.5,-11341.58 4305.5,-11288.58 4436.5,-11288.58 4436.5,-11341.58"/>
<text text-anchor="middle" x="4371" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4371" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4371" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_2&#45;&gt;k_proj_2_3 -->
<g id="edge86" class="edge">
<title>ln1_2&#45;&gt;k_proj_2_3</title>
<path fill="none" stroke="black" d="M3664.02,-11458C3831.55,-11458 4371,-11458 4371,-11458 4371,-11458 4371,-11351.63 4371,-11351.63"/>
<polygon fill="black" stroke="black" points="4374.5,-11351.63 4371,-11341.63 4367.5,-11351.63 4374.5,-11351.63"/>
</g>
<!-- v_proj_2_3 -->
<g id="node54" class="node">
<title>v_proj_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4625.5,-11341.58 4494.5,-11341.58 4494.5,-11288.58 4625.5,-11288.58 4625.5,-11341.58"/>
<text text-anchor="middle" x="4560" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4560" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4560" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_2&#45;&gt;v_proj_2_3 -->
<g id="edge87" class="edge">
<title>ln1_2&#45;&gt;v_proj_2_3</title>
<path fill="none" stroke="black" d="M3664.15,-11467C3858.12,-11467 4560,-11467 4560,-11467 4560,-11467 4560,-11351.89 4560,-11351.89"/>
<polygon fill="black" stroke="black" points="4563.5,-11351.89 4560,-11341.89 4556.5,-11351.89 4563.5,-11351.89"/>
</g>
<!-- q_proj_3_0 -->
<g id="node56" class="node">
<title>q_proj_3_0</title>
<polygon fill="lightcoral" stroke="black" points="278.5,-11341.58 147.5,-11341.58 147.5,-11288.58 278.5,-11288.58 278.5,-11341.58"/>
<text text-anchor="middle" x="213" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="213" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="213" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_0 -->
<g id="edge94" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_0</title>
<path fill="none" stroke="black" d="M1297.91,-11473C1080.25,-11473 213,-11473 213,-11473 213,-11473 213,-11351.87 213,-11351.87"/>
<polygon fill="black" stroke="black" points="216.5,-11351.87 213,-11341.87 209.5,-11351.87 216.5,-11351.87"/>
</g>
<!-- k_proj_3_0 -->
<g id="node57" class="node">
<title>k_proj_3_0</title>
<polygon fill="lightcoral" stroke="black" points="467.5,-11341.58 336.5,-11341.58 336.5,-11288.58 467.5,-11288.58 467.5,-11341.58"/>
<text text-anchor="middle" x="402" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="402" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="402" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_0 -->
<g id="edge95" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_0</title>
<path fill="none" stroke="black" d="M1297.85,-11465C1103.88,-11465 402,-11465 402,-11465 402,-11465 402,-11351.88 402,-11351.88"/>
<polygon fill="black" stroke="black" points="405.5,-11351.88 402,-11341.88 398.5,-11351.88 405.5,-11351.88"/>
</g>
<!-- v_proj_3_0 -->
<g id="node58" class="node">
<title>v_proj_3_0</title>
<polygon fill="lightcoral" stroke="black" points="656.5,-11341.58 525.5,-11341.58 525.5,-11288.58 656.5,-11288.58 656.5,-11341.58"/>
<text text-anchor="middle" x="591" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="591" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="591" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_0 -->
<g id="edge96" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_0</title>
<path fill="none" stroke="black" d="M1297.98,-11457C1130.45,-11457 591,-11457 591,-11457 591,-11457 591,-11351.77 591,-11351.77"/>
<polygon fill="black" stroke="black" points="594.5,-11351.77 591,-11341.77 587.5,-11351.77 594.5,-11351.77"/>
</g>
<!-- q_proj_3_1 -->
<g id="node60" class="node">
<title>q_proj_3_1</title>
<polygon fill="lightcoral" stroke="black" points="845.5,-11341.58 714.5,-11341.58 714.5,-11288.58 845.5,-11288.58 845.5,-11341.58"/>
<text text-anchor="middle" x="780" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="780" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="780" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_1 -->
<g id="edge101" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_1</title>
<path fill="none" stroke="black" d="M1297.67,-11450C1159.73,-11450 780,-11450 780,-11450 780,-11450 780,-11351.74 780,-11351.74"/>
<polygon fill="black" stroke="black" points="783.5,-11351.74 780,-11341.74 776.5,-11351.74 783.5,-11351.74"/>
</g>
<!-- k_proj_3_1 -->
<g id="node61" class="node">
<title>k_proj_3_1</title>
<polygon fill="lightcoral" stroke="black" points="1034.5,-11341.58 903.5,-11341.58 903.5,-11288.58 1034.5,-11288.58 1034.5,-11341.58"/>
<text text-anchor="middle" x="969" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="969" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="969" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_1 -->
<g id="edge102" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_1</title>
<path fill="none" stroke="black" d="M1297.97,-11442C1195.69,-11442 969,-11442 969,-11442 969,-11442 969,-11351.69 969,-11351.69"/>
<polygon fill="black" stroke="black" points="972.5,-11351.69 969,-11341.69 965.5,-11351.69 972.5,-11351.69"/>
</g>
<!-- v_proj_3_1 -->
<g id="node62" class="node">
<title>v_proj_3_1</title>
<polygon fill="lightcoral" stroke="black" points="1223.5,-11341.58 1092.5,-11341.58 1092.5,-11288.58 1223.5,-11288.58 1223.5,-11341.58"/>
<text text-anchor="middle" x="1158" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1158" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1158" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_1 -->
<g id="edge103" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_1</title>
<path fill="none" stroke="black" d="M1297.84,-11435C1241.84,-11435 1158,-11435 1158,-11435 1158,-11435 1158,-11351.69 1158,-11351.69"/>
<polygon fill="black" stroke="black" points="1161.5,-11351.69 1158,-11341.69 1154.5,-11351.69 1161.5,-11351.69"/>
</g>
<!-- q_proj_3_2 -->
<g id="node64" class="node">
<title>q_proj_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1412.5,-11341.58 1281.5,-11341.58 1281.5,-11288.58 1412.5,-11288.58 1412.5,-11341.58"/>
<text text-anchor="middle" x="1347" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1347" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1347" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_2 -->
<g id="edge108" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_2</title>
<path fill="none" stroke="black" d="M1347,-11427.28C1347,-11427.28 1347,-11351.8 1347,-11351.8"/>
<polygon fill="black" stroke="black" points="1350.5,-11351.8 1347,-11341.8 1343.5,-11351.8 1350.5,-11351.8"/>
</g>
<!-- k_proj_3_2 -->
<g id="node65" class="node">
<title>k_proj_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1601.5,-11341.58 1470.5,-11341.58 1470.5,-11288.58 1601.5,-11288.58 1601.5,-11341.58"/>
<text text-anchor="middle" x="1536" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1536" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1536" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_2 -->
<g id="edge109" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_2</title>
<path fill="none" stroke="black" d="M1396.16,-11436C1452.16,-11436 1536,-11436 1536,-11436 1536,-11436 1536,-11351.62 1536,-11351.62"/>
<polygon fill="black" stroke="black" points="1539.5,-11351.62 1536,-11341.62 1532.5,-11351.62 1539.5,-11351.62"/>
</g>
<!-- v_proj_3_2 -->
<g id="node66" class="node">
<title>v_proj_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1790.5,-11341.58 1659.5,-11341.58 1659.5,-11288.58 1790.5,-11288.58 1790.5,-11341.58"/>
<text text-anchor="middle" x="1725" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1725" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1725" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_2 -->
<g id="edge110" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_2</title>
<path fill="none" stroke="black" d="M1396.03,-11445C1498.31,-11445 1725,-11445 1725,-11445 1725,-11445 1725,-11351.68 1725,-11351.68"/>
<polygon fill="black" stroke="black" points="1728.5,-11351.68 1725,-11341.68 1721.5,-11351.68 1728.5,-11351.68"/>
</g>
<!-- q_proj_3_3 -->
<g id="node68" class="node">
<title>q_proj_3_3</title>
<polygon fill="lightcoral" stroke="black" points="1979.5,-11341.58 1848.5,-11341.58 1848.5,-11288.58 1979.5,-11288.58 1979.5,-11341.58"/>
<text text-anchor="middle" x="1914" y="-11326.38" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1914" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1914" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_3&#45;&gt;q_proj_3_3 -->
<g id="edge115" class="edge">
<title>ln1_3&#45;&gt;q_proj_3_3</title>
<path fill="none" stroke="black" d="M1396.33,-11454C1534.27,-11454 1914,-11454 1914,-11454 1914,-11454 1914,-11351.87 1914,-11351.87"/>
<polygon fill="black" stroke="black" points="1917.5,-11351.87 1914,-11341.87 1910.5,-11351.87 1917.5,-11351.87"/>
</g>
<!-- k_proj_3_3 -->
<g id="node69" class="node">
<title>k_proj_3_3</title>
<polygon fill="lightcoral" stroke="black" points="2168.5,-11341.58 2037.5,-11341.58 2037.5,-11288.58 2168.5,-11288.58 2168.5,-11341.58"/>
<text text-anchor="middle" x="2103" y="-11326.38" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2103" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2103" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_3&#45;&gt;k_proj_3_3 -->
<g id="edge116" class="edge">
<title>ln1_3&#45;&gt;k_proj_3_3</title>
<path fill="none" stroke="black" d="M1396.02,-11462C1563.55,-11462 2103,-11462 2103,-11462 2103,-11462 2103,-11351.69 2103,-11351.69"/>
<polygon fill="black" stroke="black" points="2106.5,-11351.69 2103,-11341.69 2099.5,-11351.69 2106.5,-11351.69"/>
</g>
<!-- v_proj_3_3 -->
<g id="node70" class="node">
<title>v_proj_3_3</title>
<polygon fill="lightcoral" stroke="black" points="2357.5,-11341.58 2226.5,-11341.58 2226.5,-11288.58 2357.5,-11288.58 2357.5,-11341.58"/>
<text text-anchor="middle" x="2292" y="-11326.38" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2292" y="-11311.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2292" y="-11296.38" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_3&#45;&gt;v_proj_3_3 -->
<g id="edge117" class="edge">
<title>ln1_3&#45;&gt;v_proj_3_3</title>
<path fill="none" stroke="black" d="M1396.15,-11471C1590.12,-11471 2292,-11471 2292,-11471 2292,-11471 2292,-11351.88 2292,-11351.88"/>
<polygon fill="black" stroke="black" points="2295.5,-11351.88 2292,-11341.88 2288.5,-11351.88 2295.5,-11351.88"/>
</g>
<!-- attn_0_0 -->
<g id="node11" class="node">
<title>attn_0_0</title>
<polygon fill="orange" stroke="black" points="7414,-11202.58 7188,-11202.58 7188,-11149.58 7414,-11149.58 7414,-11202.58"/>
<text text-anchor="middle" x="7301" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7301" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7301" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge7" class="edge">
<title>q_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M7017,-11288.26C7017,-11245.59 7017,-11167 7017,-11167 7017,-11167 7177.94,-11167 7177.94,-11167"/>
<polygon fill="black" stroke="black" points="7177.94,-11170.5 7187.94,-11167 7177.94,-11163.5 7177.94,-11170.5"/>
</g>
<!-- k_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge8" class="edge">
<title>k_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M7229.75,-11288.28C7229.75,-11288.28 7229.75,-11212.8 7229.75,-11212.8"/>
<polygon fill="black" stroke="black" points="7233.25,-11212.8 7229.75,-11202.8 7226.25,-11212.8 7233.25,-11212.8"/>
</g>
<!-- v_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge9" class="edge">
<title>v_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M7371.75,-11288.28C7371.75,-11288.28 7371.75,-11212.8 7371.75,-11212.8"/>
<polygon fill="black" stroke="black" points="7375.25,-11212.8 7371.75,-11202.8 7368.25,-11212.8 7375.25,-11212.8"/>
</g>
<!-- concat_dim_0 -->
<g id="node72" class="node">
<title>concat_dim_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7980.2,-11063.58 7650.59,-11063.58 7565.8,-10957.58 7895.41,-10957.58 7980.2,-11063.58"/>
<text text-anchor="middle" x="7773" y="-11021.88" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="7773" y="-11006.88" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="7773" y="-10991.88" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- attn_0_0&#45;&gt;concat_dim_0 -->
<g id="edge10" class="edge">
<title>attn_0_0&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M7414.29,-11176C7501.62,-11176 7607.57,-11176 7607.57,-11176 7607.57,-11176 7607.57,-11020.7 7607.57,-11020.7"/>
<polygon fill="black" stroke="black" points="7611.07,-11020.7 7607.57,-11010.7 7604.07,-11020.7 7611.07,-11020.7"/>
</g>
<!-- attn_0_1 -->
<g id="node15" class="node">
<title>attn_0_1</title>
<polygon fill="orange" stroke="black" points="7886,-11202.58 7660,-11202.58 7660,-11149.58 7886,-11149.58 7886,-11202.58"/>
<text text-anchor="middle" x="7773" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7773" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7773" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge14" class="edge">
<title>q_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M7649.7,-11315C7668.38,-11315 7683.75,-11315 7683.75,-11315 7683.75,-11315 7683.75,-11212.87 7683.75,-11212.87"/>
<polygon fill="black" stroke="black" points="7687.25,-11212.87 7683.75,-11202.87 7680.25,-11212.87 7687.25,-11212.87"/>
</g>
<!-- k_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge15" class="edge">
<title>k_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M7773,-11288.28C7773,-11288.28 7773,-11212.8 7773,-11212.8"/>
<polygon fill="black" stroke="black" points="7776.5,-11212.8 7773,-11202.8 7769.5,-11212.8 7776.5,-11212.8"/>
</g>
<!-- v_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge16" class="edge">
<title>v_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M7896.3,-11315C7877.62,-11315 7862.25,-11315 7862.25,-11315 7862.25,-11315 7862.25,-11212.87 7862.25,-11212.87"/>
<polygon fill="black" stroke="black" points="7865.75,-11212.87 7862.25,-11202.87 7858.75,-11212.87 7865.75,-11212.87"/>
</g>
<!-- attn_0_1&#45;&gt;concat_dim_0 -->
<g id="edge17" class="edge">
<title>attn_0_1&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M7773,-11149.49C7773,-11149.49 7773,-11073.85 7773,-11073.85"/>
<polygon fill="black" stroke="black" points="7776.5,-11073.85 7773,-11063.85 7769.5,-11073.85 7776.5,-11073.85"/>
</g>
<!-- attn_0_2 -->
<g id="node19" class="node">
<title>attn_0_2</title>
<polygon fill="orange" stroke="black" points="8359,-11202.58 8133,-11202.58 8133,-11149.58 8359,-11149.58 8359,-11202.58"/>
<text text-anchor="middle" x="8246" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8246" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8246" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge21" class="edge">
<title>q_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M8174.75,-11288.28C8174.75,-11288.28 8174.75,-11212.8 8174.75,-11212.8"/>
<polygon fill="black" stroke="black" points="8178.25,-11212.8 8174.75,-11202.8 8171.25,-11212.8 8178.25,-11212.8"/>
</g>
<!-- k_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge22" class="edge">
<title>k_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M8316.75,-11288.28C8316.75,-11288.28 8316.75,-11212.8 8316.75,-11212.8"/>
<polygon fill="black" stroke="black" points="8320.25,-11212.8 8316.75,-11202.8 8313.25,-11212.8 8320.25,-11212.8"/>
</g>
<!-- v_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge23" class="edge">
<title>v_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M8529,-11288.26C8529,-11247.85 8529,-11176 8529,-11176 8529,-11176 8369.07,-11176 8369.07,-11176"/>
<polygon fill="black" stroke="black" points="8369.07,-11172.5 8359.07,-11176 8369.07,-11179.5 8369.07,-11172.5"/>
</g>
<!-- attn_0_2&#45;&gt;concat_dim_0 -->
<g id="edge24" class="edge">
<title>attn_0_2&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M8132.78,-11176C8045.08,-11176 7938.43,-11176 7938.43,-11176 7938.43,-11176 7938.43,-11073.83 7938.43,-11073.83"/>
<polygon fill="black" stroke="black" points="7941.93,-11073.83 7938.43,-11063.83 7934.93,-11073.83 7941.93,-11073.83"/>
</g>
<!-- attn_0_3 -->
<g id="node23" class="node">
<title>attn_0_3</title>
<polygon fill="orange" stroke="black" points="8925,-11202.58 8699,-11202.58 8699,-11149.58 8925,-11149.58 8925,-11202.58"/>
<text text-anchor="middle" x="8812" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8812" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8812" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge28" class="edge">
<title>q_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M8741.25,-11288.28C8741.25,-11288.28 8741.25,-11212.8 8741.25,-11212.8"/>
<polygon fill="black" stroke="black" points="8744.75,-11212.8 8741.25,-11202.8 8737.75,-11212.8 8744.75,-11212.8"/>
</g>
<!-- k_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge29" class="edge">
<title>k_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M8883.25,-11288.28C8883.25,-11288.28 8883.25,-11212.8 8883.25,-11212.8"/>
<polygon fill="black" stroke="black" points="8886.75,-11212.8 8883.25,-11202.8 8879.75,-11212.8 8886.75,-11212.8"/>
</g>
<!-- v_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge30" class="edge">
<title>v_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M9049.83,-11288.26C9049.83,-11247.85 9049.83,-11176 9049.83,-11176 9049.83,-11176 8935.34,-11176 8935.34,-11176"/>
<polygon fill="black" stroke="black" points="8935.34,-11172.5 8925.34,-11176 8935.34,-11179.5 8935.34,-11172.5"/>
</g>
<!-- attn_0_3&#45;&gt;concat_dim_0 -->
<g id="edge31" class="edge">
<title>attn_0_3&#45;&gt;concat_dim_0</title>
<path fill="none" stroke="black" d="M8719.25,-11149.4C8719.25,-11102.45 8719.25,-11010 8719.25,-11010 8719.25,-11010 7947.55,-11010 7947.55,-11010"/>
<polygon fill="black" stroke="black" points="7947.55,-11006.5 7937.55,-11010 7947.55,-11013.5 7947.55,-11006.5"/>
</g>
<!-- attn_1_0 -->
<g id="node27" class="node">
<title>attn_1_0</title>
<polygon fill="orange" stroke="black" points="5145,-11202.58 4919,-11202.58 4919,-11149.58 5145,-11149.58 5145,-11202.58"/>
<text text-anchor="middle" x="5032" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5032" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5032" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge37" class="edge">
<title>q_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4749,-11288.26C4749,-11245.59 4749,-11167 4749,-11167 4749,-11167 4908.93,-11167 4908.93,-11167"/>
<polygon fill="black" stroke="black" points="4908.93,-11170.5 4918.93,-11167 4908.93,-11163.5 4908.93,-11170.5"/>
</g>
<!-- k_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge38" class="edge">
<title>k_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4961.25,-11288.28C4961.25,-11288.28 4961.25,-11212.8 4961.25,-11212.8"/>
<polygon fill="black" stroke="black" points="4964.75,-11212.8 4961.25,-11202.8 4957.75,-11212.8 4964.75,-11212.8"/>
</g>
<!-- v_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge39" class="edge">
<title>v_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M5103.25,-11288.28C5103.25,-11288.28 5103.25,-11212.8 5103.25,-11212.8"/>
<polygon fill="black" stroke="black" points="5106.75,-11212.8 5103.25,-11202.8 5099.75,-11212.8 5106.75,-11212.8"/>
</g>
<!-- concat_dim_1 -->
<g id="node73" class="node">
<title>concat_dim_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5902.2,-11063.58 5572.59,-11063.58 5487.8,-10957.58 5817.41,-10957.58 5902.2,-11063.58"/>
<text text-anchor="middle" x="5695" y="-11021.88" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="5695" y="-11006.88" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="5695" y="-10991.88" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- attn_1_0&#45;&gt;concat_dim_1 -->
<g id="edge40" class="edge">
<title>attn_1_0&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5131.75,-11149.26C5131.75,-11106.59 5131.75,-11028 5131.75,-11028 5131.75,-11028 5534.06,-11028 5534.06,-11028"/>
<polygon fill="black" stroke="black" points="5534.06,-11031.5 5544.06,-11028 5534.06,-11024.5 5534.06,-11031.5"/>
</g>
<!-- attn_1_1 -->
<g id="node31" class="node">
<title>attn_1_1</title>
<polygon fill="orange" stroke="black" points="5712,-11202.58 5486,-11202.58 5486,-11149.58 5712,-11149.58 5712,-11202.58"/>
<text text-anchor="middle" x="5599" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5599" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5599" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge44" class="edge">
<title>q_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M5375.5,-11288.26C5375.5,-11247.85 5375.5,-11176 5375.5,-11176 5375.5,-11176 5475.94,-11176 5475.94,-11176"/>
<polygon fill="black" stroke="black" points="5475.94,-11179.5 5485.94,-11176 5475.94,-11172.5 5475.94,-11179.5"/>
</g>
<!-- k_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge45" class="edge">
<title>k_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M5528.25,-11288.28C5528.25,-11288.28 5528.25,-11212.8 5528.25,-11212.8"/>
<polygon fill="black" stroke="black" points="5531.75,-11212.8 5528.25,-11202.8 5524.75,-11212.8 5531.75,-11212.8"/>
</g>
<!-- v_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge46" class="edge">
<title>v_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M5670.25,-11288.28C5670.25,-11288.28 5670.25,-11212.8 5670.25,-11212.8"/>
<polygon fill="black" stroke="black" points="5673.75,-11212.8 5670.25,-11202.8 5666.75,-11212.8 5673.75,-11212.8"/>
</g>
<!-- attn_1_1&#45;&gt;concat_dim_1 -->
<g id="edge47" class="edge">
<title>attn_1_1&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5599.82,-11149.49C5599.82,-11149.49 5599.82,-11073.85 5599.82,-11073.85"/>
<polygon fill="black" stroke="black" points="5603.32,-11073.85 5599.82,-11063.85 5596.32,-11073.85 5603.32,-11073.85"/>
</g>
<!-- attn_1_2 -->
<g id="node35" class="node">
<title>attn_1_2</title>
<polygon fill="orange" stroke="black" points="6091,-11202.58 5865,-11202.58 5865,-11149.58 6091,-11149.58 6091,-11202.58"/>
<text text-anchor="middle" x="5978" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5978" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5978" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge51" class="edge">
<title>q_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5906.75,-11288.28C5906.75,-11288.28 5906.75,-11212.8 5906.75,-11212.8"/>
<polygon fill="black" stroke="black" points="5910.25,-11212.8 5906.75,-11202.8 5903.25,-11212.8 5910.25,-11212.8"/>
</g>
<!-- k_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge52" class="edge">
<title>k_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M6048.75,-11288.28C6048.75,-11288.28 6048.75,-11212.8 6048.75,-11212.8"/>
<polygon fill="black" stroke="black" points="6052.25,-11212.8 6048.75,-11202.8 6045.25,-11212.8 6052.25,-11212.8"/>
</g>
<!-- v_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge53" class="edge">
<title>v_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M6261,-11288.26C6261,-11247.85 6261,-11176 6261,-11176 6261,-11176 6101.07,-11176 6101.07,-11176"/>
<polygon fill="black" stroke="black" points="6101.07,-11172.5 6091.07,-11176 6101.07,-11179.5 6101.07,-11172.5"/>
</g>
<!-- attn_1_2&#45;&gt;concat_dim_1 -->
<g id="edge54" class="edge">
<title>attn_1_2&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M5883.68,-11149.49C5883.68,-11149.49 5883.68,-11073.85 5883.68,-11073.85"/>
<polygon fill="black" stroke="black" points="5887.18,-11073.85 5883.68,-11063.85 5880.18,-11073.85 5887.18,-11073.85"/>
</g>
<!-- attn_1_3 -->
<g id="node39" class="node">
<title>attn_1_3</title>
<polygon fill="orange" stroke="black" points="6657,-11202.58 6431,-11202.58 6431,-11149.58 6657,-11149.58 6657,-11202.58"/>
<text text-anchor="middle" x="6544" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6544" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6544" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge58" class="edge">
<title>q_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6473.25,-11288.28C6473.25,-11288.28 6473.25,-11212.8 6473.25,-11212.8"/>
<polygon fill="black" stroke="black" points="6476.75,-11212.8 6473.25,-11202.8 6469.75,-11212.8 6476.75,-11212.8"/>
</g>
<!-- k_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge59" class="edge">
<title>k_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6615.25,-11288.28C6615.25,-11288.28 6615.25,-11212.8 6615.25,-11212.8"/>
<polygon fill="black" stroke="black" points="6618.75,-11212.8 6615.25,-11202.8 6611.75,-11212.8 6618.75,-11212.8"/>
</g>
<!-- v_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge60" class="edge">
<title>v_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M6828,-11288.55C6828,-11250.25 6828,-11184 6828,-11184 6828,-11184 6667.06,-11184 6667.06,-11184"/>
<polygon fill="black" stroke="black" points="6667.06,-11180.5 6657.06,-11184 6667.06,-11187.5 6667.06,-11180.5"/>
</g>
<!-- attn_1_3&#45;&gt;concat_dim_1 -->
<g id="edge61" class="edge">
<title>attn_1_3&#45;&gt;concat_dim_1</title>
<path fill="none" stroke="black" d="M6528,-11149.26C6528,-11106.59 6528,-11028 6528,-11028 6528,-11028 5883.96,-11028 5883.96,-11028"/>
<polygon fill="black" stroke="black" points="5883.96,-11024.5 5873.96,-11028 5883.96,-11031.5 5883.96,-11024.5"/>
</g>
<!-- attn_2_0 -->
<g id="node43" class="node">
<title>attn_2_0</title>
<polygon fill="orange" stroke="black" points="2877,-11202.58 2651,-11202.58 2651,-11149.58 2877,-11149.58 2877,-11202.58"/>
<text text-anchor="middle" x="2764" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2764" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2764" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge67" class="edge">
<title>q_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M2524.5,-11288.26C2524.5,-11245.59 2524.5,-11167 2524.5,-11167 2524.5,-11167 2640.91,-11167 2640.91,-11167"/>
<polygon fill="black" stroke="black" points="2640.91,-11170.5 2650.91,-11167 2640.91,-11163.5 2640.91,-11170.5"/>
</g>
<!-- k_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge68" class="edge">
<title>k_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M2693.25,-11288.28C2693.25,-11288.28 2693.25,-11212.8 2693.25,-11212.8"/>
<polygon fill="black" stroke="black" points="2696.75,-11212.8 2693.25,-11202.8 2689.75,-11212.8 2696.75,-11212.8"/>
</g>
<!-- v_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge69" class="edge">
<title>v_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M2835.25,-11288.28C2835.25,-11288.28 2835.25,-11212.8 2835.25,-11212.8"/>
<polygon fill="black" stroke="black" points="2838.75,-11212.8 2835.25,-11202.8 2831.75,-11212.8 2838.75,-11212.8"/>
</g>
<!-- concat_dim_2 -->
<g id="node74" class="node">
<title>concat_dim_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="4011.2,-11063.58 3681.59,-11063.58 3596.8,-10957.58 3926.41,-10957.58 4011.2,-11063.58"/>
<text text-anchor="middle" x="3804" y="-11021.88" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="3804" y="-11006.88" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="3804" y="-10991.88" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- attn_2_0&#45;&gt;concat_dim_2 -->
<g id="edge70" class="edge">
<title>attn_2_0&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M2847.67,-11149.4C2847.67,-11102.45 2847.67,-11010 2847.67,-11010 2847.67,-11010 3628.51,-11010 3628.51,-11010"/>
<polygon fill="black" stroke="black" points="3628.51,-11013.5 3638.51,-11010 3628.51,-11006.5 3628.51,-11013.5"/>
</g>
<!-- attn_2_1 -->
<g id="node47" class="node">
<title>attn_2_1</title>
<polygon fill="orange" stroke="black" points="3444,-11202.58 3218,-11202.58 3218,-11149.58 3444,-11149.58 3444,-11202.58"/>
<text text-anchor="middle" x="3331" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3331" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3331" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge74" class="edge">
<title>q_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3098.83,-11288.26C3098.83,-11247.85 3098.83,-11176 3098.83,-11176 3098.83,-11176 3207.98,-11176 3207.98,-11176"/>
<polygon fill="black" stroke="black" points="3207.98,-11179.5 3217.98,-11176 3207.98,-11172.5 3207.98,-11179.5"/>
</g>
<!-- k_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge75" class="edge">
<title>k_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3260.25,-11288.28C3260.25,-11288.28 3260.25,-11212.8 3260.25,-11212.8"/>
<polygon fill="black" stroke="black" points="3263.75,-11212.8 3260.25,-11202.8 3256.75,-11212.8 3263.75,-11212.8"/>
</g>
<!-- v_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge76" class="edge">
<title>v_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3402.25,-11288.28C3402.25,-11288.28 3402.25,-11212.8 3402.25,-11212.8"/>
<polygon fill="black" stroke="black" points="3405.75,-11212.8 3402.25,-11202.8 3398.75,-11212.8 3405.75,-11212.8"/>
</g>
<!-- attn_2_1&#45;&gt;concat_dim_2 -->
<g id="edge77" class="edge">
<title>attn_2_1&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M3444.22,-11176C3531.92,-11176 3638.57,-11176 3638.57,-11176 3638.57,-11176 3638.57,-11020.7 3638.57,-11020.7"/>
<polygon fill="black" stroke="black" points="3642.07,-11020.7 3638.57,-11010.7 3635.07,-11020.7 3642.07,-11020.7"/>
</g>
<!-- attn_2_2 -->
<g id="node51" class="node">
<title>attn_2_2</title>
<polygon fill="orange" stroke="black" points="3917,-11202.58 3691,-11202.58 3691,-11149.58 3917,-11149.58 3917,-11202.58"/>
<text text-anchor="middle" x="3804" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3804" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3804" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge81" class="edge">
<title>q_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3680.7,-11315C3699.38,-11315 3714.75,-11315 3714.75,-11315 3714.75,-11315 3714.75,-11212.87 3714.75,-11212.87"/>
<polygon fill="black" stroke="black" points="3718.25,-11212.87 3714.75,-11202.87 3711.25,-11212.87 3718.25,-11212.87"/>
</g>
<!-- k_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge82" class="edge">
<title>k_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3804,-11288.28C3804,-11288.28 3804,-11212.8 3804,-11212.8"/>
<polygon fill="black" stroke="black" points="3807.5,-11212.8 3804,-11202.8 3800.5,-11212.8 3807.5,-11212.8"/>
</g>
<!-- v_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge83" class="edge">
<title>v_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3927.3,-11315C3908.62,-11315 3893.25,-11315 3893.25,-11315 3893.25,-11315 3893.25,-11212.87 3893.25,-11212.87"/>
<polygon fill="black" stroke="black" points="3896.75,-11212.87 3893.25,-11202.87 3889.75,-11212.87 3896.75,-11212.87"/>
</g>
<!-- attn_2_2&#45;&gt;concat_dim_2 -->
<g id="edge84" class="edge">
<title>attn_2_2&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M3804,-11149.49C3804,-11149.49 3804,-11073.85 3804,-11073.85"/>
<polygon fill="black" stroke="black" points="3807.5,-11073.85 3804,-11063.85 3800.5,-11073.85 3807.5,-11073.85"/>
</g>
<!-- attn_2_3 -->
<g id="node55" class="node">
<title>attn_2_3</title>
<polygon fill="orange" stroke="black" points="4389,-11202.58 4163,-11202.58 4163,-11149.58 4389,-11149.58 4389,-11202.58"/>
<text text-anchor="middle" x="4276" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4276" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4276" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge88" class="edge">
<title>q_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M4205.25,-11288.28C4205.25,-11288.28 4205.25,-11212.8 4205.25,-11212.8"/>
<polygon fill="black" stroke="black" points="4208.75,-11212.8 4205.25,-11202.8 4201.75,-11212.8 4208.75,-11212.8"/>
</g>
<!-- k_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge89" class="edge">
<title>k_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M4347.25,-11288.28C4347.25,-11288.28 4347.25,-11212.8 4347.25,-11212.8"/>
<polygon fill="black" stroke="black" points="4350.75,-11212.8 4347.25,-11202.8 4343.75,-11212.8 4350.75,-11212.8"/>
</g>
<!-- v_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge90" class="edge">
<title>v_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M4513.83,-11288.55C4513.83,-11250.25 4513.83,-11184 4513.83,-11184 4513.83,-11184 4399.34,-11184 4399.34,-11184"/>
<polygon fill="black" stroke="black" points="4399.34,-11180.5 4389.34,-11184 4399.34,-11187.5 4399.34,-11180.5"/>
</g>
<!-- attn_2_3&#45;&gt;concat_dim_2 -->
<g id="edge91" class="edge">
<title>attn_2_3&#45;&gt;concat_dim_2</title>
<path fill="none" stroke="black" d="M4162.71,-11176C4075.38,-11176 3969.43,-11176 3969.43,-11176 3969.43,-11176 3969.43,-11073.83 3969.43,-11073.83"/>
<polygon fill="black" stroke="black" points="3972.93,-11073.83 3969.43,-11063.83 3965.93,-11073.83 3972.93,-11073.83"/>
</g>
<!-- attn_3_0 -->
<g id="node59" class="node">
<title>attn_3_0</title>
<polygon fill="orange" stroke="black" points="609,-11202.58 383,-11202.58 383,-11149.58 609,-11149.58 609,-11202.58"/>
<text text-anchor="middle" x="496" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="496" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="496" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge97" class="edge">
<title>q_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M242,-11288.26C242,-11247.85 242,-11176 242,-11176 242,-11176 372.74,-11176 372.74,-11176"/>
<polygon fill="black" stroke="black" points="372.74,-11179.5 382.74,-11176 372.74,-11172.5 372.74,-11179.5"/>
</g>
<!-- k_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge98" class="edge">
<title>k_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M425.25,-11288.28C425.25,-11288.28 425.25,-11212.8 425.25,-11212.8"/>
<polygon fill="black" stroke="black" points="428.75,-11212.8 425.25,-11202.8 421.75,-11212.8 428.75,-11212.8"/>
</g>
<!-- v_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge99" class="edge">
<title>v_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M567.25,-11288.28C567.25,-11288.28 567.25,-11212.8 567.25,-11212.8"/>
<polygon fill="black" stroke="black" points="570.75,-11212.8 567.25,-11202.8 563.75,-11212.8 570.75,-11212.8"/>
</g>
<!-- concat_dim_3 -->
<g id="node75" class="node">
<title>concat_dim_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1743.2,-11063.58 1413.59,-11063.58 1328.8,-10957.58 1658.41,-10957.58 1743.2,-11063.58"/>
<text text-anchor="middle" x="1536" y="-11021.88" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="1536" y="-11006.88" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="1536" y="-10991.88" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- attn_3_0&#45;&gt;concat_dim_3 -->
<g id="edge100" class="edge">
<title>attn_3_0&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M596.25,-11149.31C596.25,-11098.26 596.25,-10992 596.25,-10992 596.25,-10992 1346.2,-10992 1346.2,-10992"/>
<polygon fill="black" stroke="black" points="1346.2,-10995.5 1356.2,-10992 1346.2,-10988.5 1346.2,-10995.5"/>
</g>
<!-- attn_3_1 -->
<g id="node63" class="node">
<title>attn_3_1</title>
<polygon fill="orange" stroke="black" points="1176,-11202.58 950,-11202.58 950,-11149.58 1176,-11149.58 1176,-11202.58"/>
<text text-anchor="middle" x="1063" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1063" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1063" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge104" class="edge">
<title>q_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M809,-11288.26C809,-11247.85 809,-11176 809,-11176 809,-11176 939.74,-11176 939.74,-11176"/>
<polygon fill="black" stroke="black" points="939.74,-11179.5 949.74,-11176 939.74,-11172.5 939.74,-11179.5"/>
</g>
<!-- k_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge105" class="edge">
<title>k_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M992.25,-11288.28C992.25,-11288.28 992.25,-11212.8 992.25,-11212.8"/>
<polygon fill="black" stroke="black" points="995.75,-11212.8 992.25,-11202.8 988.75,-11212.8 995.75,-11212.8"/>
</g>
<!-- v_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge106" class="edge">
<title>v_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M1134.25,-11288.28C1134.25,-11288.28 1134.25,-11212.8 1134.25,-11212.8"/>
<polygon fill="black" stroke="black" points="1137.75,-11212.8 1134.25,-11202.8 1130.75,-11212.8 1137.75,-11212.8"/>
</g>
<!-- attn_3_1&#45;&gt;concat_dim_3 -->
<g id="edge107" class="edge">
<title>attn_3_1&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M1171.5,-11149.26C1171.5,-11106.59 1171.5,-11028 1171.5,-11028 1171.5,-11028 1375.11,-11028 1375.11,-11028"/>
<polygon fill="black" stroke="black" points="1375.11,-11031.5 1385.11,-11028 1375.11,-11024.5 1375.11,-11031.5"/>
</g>
<!-- attn_3_2 -->
<g id="node67" class="node">
<title>attn_3_2</title>
<polygon fill="orange" stroke="black" points="1649,-11202.58 1423,-11202.58 1423,-11149.58 1649,-11149.58 1649,-11202.58"/>
<text text-anchor="middle" x="1536" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1536" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1536" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge111" class="edge">
<title>q_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M1412.7,-11315C1431.38,-11315 1446.75,-11315 1446.75,-11315 1446.75,-11315 1446.75,-11212.87 1446.75,-11212.87"/>
<polygon fill="black" stroke="black" points="1450.25,-11212.87 1446.75,-11202.87 1443.25,-11212.87 1450.25,-11212.87"/>
</g>
<!-- k_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge112" class="edge">
<title>k_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M1536,-11288.28C1536,-11288.28 1536,-11212.8 1536,-11212.8"/>
<polygon fill="black" stroke="black" points="1539.5,-11212.8 1536,-11202.8 1532.5,-11212.8 1539.5,-11212.8"/>
</g>
<!-- v_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge113" class="edge">
<title>v_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M1659.3,-11315C1640.62,-11315 1625.25,-11315 1625.25,-11315 1625.25,-11315 1625.25,-11212.87 1625.25,-11212.87"/>
<polygon fill="black" stroke="black" points="1628.75,-11212.87 1625.25,-11202.87 1621.75,-11212.87 1628.75,-11212.87"/>
</g>
<!-- attn_3_2&#45;&gt;concat_dim_3 -->
<g id="edge114" class="edge">
<title>attn_3_2&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M1536,-11149.49C1536,-11149.49 1536,-11073.85 1536,-11073.85"/>
<polygon fill="black" stroke="black" points="1539.5,-11073.85 1536,-11063.85 1532.5,-11073.85 1539.5,-11073.85"/>
</g>
<!-- attn_3_3 -->
<g id="node71" class="node">
<title>attn_3_3</title>
<polygon fill="orange" stroke="black" points="2121,-11202.58 1895,-11202.58 1895,-11149.58 2121,-11149.58 2121,-11202.58"/>
<text text-anchor="middle" x="2008" y="-11187.38" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2008" y="-11172.38" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2008" y="-11157.38" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge118" class="edge">
<title>q_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M1937.25,-11288.28C1937.25,-11288.28 1937.25,-11212.8 1937.25,-11212.8"/>
<polygon fill="black" stroke="black" points="1940.75,-11212.8 1937.25,-11202.8 1933.75,-11212.8 1940.75,-11212.8"/>
</g>
<!-- k_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge119" class="edge">
<title>k_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M2079.25,-11288.28C2079.25,-11288.28 2079.25,-11212.8 2079.25,-11212.8"/>
<polygon fill="black" stroke="black" points="2082.75,-11212.8 2079.25,-11202.8 2075.75,-11212.8 2082.75,-11212.8"/>
</g>
<!-- v_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge120" class="edge">
<title>v_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M2245.83,-11288.55C2245.83,-11250.25 2245.83,-11184 2245.83,-11184 2245.83,-11184 2131.34,-11184 2131.34,-11184"/>
<polygon fill="black" stroke="black" points="2131.34,-11180.5 2121.34,-11184 2131.34,-11187.5 2131.34,-11180.5"/>
</g>
<!-- attn_3_3&#45;&gt;concat_dim_3 -->
<g id="edge121" class="edge">
<title>attn_3_3&#45;&gt;concat_dim_3</title>
<path fill="none" stroke="black" d="M1894.71,-11176C1807.38,-11176 1701.43,-11176 1701.43,-11176 1701.43,-11176 1701.43,-11073.83 1701.43,-11073.83"/>
<polygon fill="black" stroke="black" points="1704.93,-11073.83 1701.43,-11063.83 1697.93,-11073.83 1704.93,-11073.83"/>
</g>
<!-- concat_heads -->
<g id="node76" class="node">
<title>concat_heads</title>
<polygon fill="lightgreen" stroke="black" points="5912.94,-10871.58 5566.25,-10871.58 5477.06,-10765.58 5823.75,-10765.58 5912.94,-10871.58"/>
<text text-anchor="middle" x="5695" y="-10829.88" font-family="Times,serif" font-size="14.00">Head Group Concatenation</text>
<text text-anchor="middle" x="5695" y="-10814.88" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5695" y="-10799.88" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_0&#45;&gt;concat_heads -->
<g id="edge32" class="edge">
<title>concat_dim_0&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M7593.28,-10992C7125.75,-10992 5907.53,-10992 5907.53,-10992 5907.53,-10992 5907.53,-10828.71 5907.53,-10828.71"/>
<polygon fill="black" stroke="black" points="5911.03,-10828.71 5907.53,-10818.71 5904.03,-10828.71 5911.03,-10828.71"/>
</g>
<!-- concat_dim_1&#45;&gt;concat_heads -->
<g id="edge62" class="edge">
<title>concat_dim_1&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M5695,-10957.35C5695,-10957.35 5695,-10881.91 5695,-10881.91"/>
<polygon fill="black" stroke="black" points="5698.5,-10881.91 5695,-10871.91 5691.5,-10881.91 5698.5,-10881.91"/>
</g>
<!-- concat_dim_2&#45;&gt;concat_heads -->
<g id="edge92" class="edge">
<title>concat_dim_2&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M3953.99,-10992C4365.47,-10992 5481.64,-10992 5481.64,-10992 5481.64,-10992 5481.64,-10828.71 5481.64,-10828.71"/>
<polygon fill="black" stroke="black" points="5485.14,-10828.71 5481.64,-10818.71 5478.14,-10828.71 5485.14,-10828.71"/>
</g>
<!-- concat_dim_3&#45;&gt;concat_heads -->
<g id="edge122" class="edge">
<title>concat_dim_3&#45;&gt;concat_heads</title>
<path fill="none" stroke="black" d="M1726.12,-11010.44C1726.12,-11004.61 1726.12,-10818 1726.12,-10818 1726.12,-10818 5510.95,-10818 5510.95,-10818"/>
<polygon fill="black" stroke="black" points="5510.95,-10821.5 5520.95,-10818 5510.95,-10814.5 5510.95,-10821.5"/>
</g>
<!-- out_proj -->
<g id="node77" class="node">
<title>out_proj</title>
<polygon fill="lightcoral" stroke="black" points="7295,-10679.58 7151,-10679.58 7151,-10626.58 7295,-10626.58 7295,-10679.58"/>
<text text-anchor="middle" x="7223" y="-10664.38" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7223" y="-10649.38" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7223" y="-10634.38" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads&#45;&gt;out_proj -->
<g id="edge123" class="edge">
<title>concat_heads&#45;&gt;out_proj</title>
<path fill="none" stroke="black" d="M5892.11,-10818.46C5892.11,-10813.45 5892.11,-10653 5892.11,-10653 5892.11,-10653 7140.97,-10653 7140.97,-10653"/>
<polygon fill="black" stroke="black" points="7140.97,-10656.5 7150.97,-10653 7140.97,-10649.5 7140.97,-10656.5"/>
</g>
<!-- out_proj&#45;&gt;residual1 -->
<g id="edge124" class="edge">
<title>out_proj&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M7295.05,-10653C7540.31,-10653 8327.61,-10653 8327.61,-10653 8327.61,-10653 8327.61,-10543.44 8327.61,-10543.44"/>
<polygon fill="black" stroke="black" points="8331.11,-10543.44 8327.61,-10533.44 8324.11,-10543.44 8331.11,-10543.44"/>
</g>
<!-- ln2 -->
<g id="node79" class="node">
<title>ln2</title>
<polygon fill="lightblue" stroke="black" points="8024,-10379.63 7926,-10379.63 7926,-10326.63 8024,-10326.63 8024,-10379.63"/>
<text text-anchor="middle" x="7975" y="-10364.43" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7975" y="-10349.43" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7975" y="-10334.43" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;ln2 -->
<g id="edge126" class="edge">
<title>residual1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M8300.09,-10515C8191.66,-10515 8002.18,-10515 8002.18,-10515 8002.18,-10515 8002.18,-10389.86 8002.18,-10389.86"/>
<polygon fill="black" stroke="black" points="8005.68,-10389.86 8002.18,-10379.86 7998.68,-10389.86 8005.68,-10389.86"/>
</g>
<!-- residual2 -->
<g id="node140" class="node">
<title>residual2</title>
<ellipse fill="yellow" stroke="black" cx="7199" cy="-8826.15" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7199" y="-8837.45" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7199" y="-8822.45" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7199" y="-8807.45" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual1&#45;&gt;residual2 -->
<g id="edge203" class="edge">
<title>residual1&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M8300.95,-10490C8245.18,-10490 8177.83,-10490 8177.83,-10490 8177.83,-10490 8177.83,-8838 8177.83,-8838 8177.83,-8838 7282.97,-8838 7282.97,-8838"/>
<polygon fill="black" stroke="black" points="7282.97,-8834.5 7272.97,-8838 7282.97,-8841.5 7282.97,-8834.5"/>
</g>
<!-- gate -->
<g id="node80" class="node">
<title>gate</title>
<polygon fill="purple" stroke="black" points="7744.98,-10240.63 7476.17,-10240.63 7407.02,-10134.63 7675.83,-10134.63 7744.98,-10240.63"/>
<text text-anchor="middle" x="7576" y="-10198.93" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="7576" y="-10183.93" font-family="Times,serif" font-size="14.00">(B×L×num_experts)</text>
<text text-anchor="middle" x="7576" y="-10168.93" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln2&#45;&gt;gate -->
<g id="edge127" class="edge">
<title>ln2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M7931.75,-10326.44C7931.75,-10279.48 7931.75,-10187 7931.75,-10187 7931.75,-10187 7720.24,-10187 7720.24,-10187"/>
<polygon fill="black" stroke="black" points="7720.24,-10183.5 7710.24,-10187 7720.24,-10190.5 7720.24,-10183.5"/>
</g>
<!-- expert_select -->
<g id="node81" class="node">
<title>expert_select</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6920,-10048.63 6695.7,-10048.63 6638,-9942.63 6862.3,-9942.63 6920,-10048.63"/>
<text text-anchor="middle" x="6779" y="-10006.93" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="6779" y="-9991.93" font-family="Times,serif" font-size="14.00">(B×L×top_k)</text>
<text text-anchor="middle" x="6779" y="-9976.93" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- gate&#45;&gt;expert_select -->
<g id="edge128" class="edge">
<title>gate&#45;&gt;expert_select</title>
<path fill="none" stroke="black" d="M7440.97,-10187C7245.47,-10187 6906.75,-10187 6906.75,-10187 6906.75,-10187 6906.75,-10058.68 6906.75,-10058.68"/>
<polygon fill="black" stroke="black" points="6910.25,-10058.68 6906.75,-10048.68 6903.25,-10058.68 6910.25,-10058.68"/>
</g>
<!-- expert0_linear1_0 -->
<g id="node82" class="node">
<title>expert0_linear1_0</title>
<polygon fill="lightcoral" stroke="black" points="4867.5,-9856.63 4674.5,-9856.63 4674.5,-9803.63 4867.5,-9803.63 4867.5,-9856.63"/>
<text text-anchor="middle" x="4771" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="4771" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4771" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_select&#45;&gt;expert0_linear1_0 -->
<g id="edge129" class="edge">
<title>expert_select&#45;&gt;expert0_linear1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6688.13,-10035C6304.98,-10035 4841,-10035 4841,-10035 4841,-10035 4841,-9866.91 4841,-9866.91"/>
<polygon fill="black" stroke="black" points="4844.5,-9866.91 4841,-9856.91 4837.5,-9866.91 4844.5,-9866.91"/>
</g>
<!-- expert0_linear1_1 -->
<g id="node85" class="node">
<title>expert0_linear1_1</title>
<polygon fill="lightcoral" stroke="black" points="5118.5,-9856.63 4925.5,-9856.63 4925.5,-9803.63 5118.5,-9803.63 5118.5,-9856.63"/>
<text text-anchor="middle" x="5022" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="5022" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5022" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_select&#45;&gt;expert0_linear1_1 -->
<g id="edge133" class="edge">
<title>expert_select&#45;&gt;expert0_linear1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6681.09,-10022C6311.49,-10022 5022,-10022 5022,-10022 5022,-10022 5022,-9866.81 5022,-9866.81"/>
<polygon fill="black" stroke="black" points="5025.5,-9866.81 5022,-9856.81 5018.5,-9866.81 5025.5,-9866.81"/>
</g>
<!-- expert1_linear1_2 -->
<g id="node89" class="node">
<title>expert1_linear1_2</title>
<polygon fill="lightcoral" stroke="black" points="5369.5,-9856.63 5176.5,-9856.63 5176.5,-9803.63 5369.5,-9803.63 5369.5,-9856.63"/>
<text text-anchor="middle" x="5273" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="5273" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5273" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_select&#45;&gt;expert1_linear1_2 -->
<g id="edge138" class="edge">
<title>expert_select&#45;&gt;expert1_linear1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6673.35,-10008C6336.52,-10008 5310,-10008 5310,-10008 5310,-10008 5310,-9866.76 5310,-9866.76"/>
<polygon fill="black" stroke="black" points="5313.5,-9866.76 5310,-9856.76 5306.5,-9866.76 5313.5,-9866.76"/>
</g>
<!-- expert1_linear1_3 -->
<g id="node92" class="node">
<title>expert1_linear1_3</title>
<polygon fill="lightcoral" stroke="black" points="5620.5,-9856.63 5427.5,-9856.63 5427.5,-9803.63 5620.5,-9803.63 5620.5,-9856.63"/>
<text text-anchor="middle" x="5524" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="5524" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5524" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_select&#45;&gt;expert1_linear1_3 -->
<g id="edge142" class="edge">
<title>expert_select&#45;&gt;expert1_linear1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6666.3,-9995C6362.42,-9995 5548.89,-9995 5548.89,-9995 5548.89,-9995 5548.89,-9866.98 5548.89,-9866.98"/>
<polygon fill="black" stroke="black" points="5552.39,-9866.98 5548.89,-9856.98 5545.39,-9866.98 5552.39,-9866.98"/>
</g>
<!-- expert2_linear1_4 -->
<g id="node96" class="node">
<title>expert2_linear1_4</title>
<polygon fill="lightcoral" stroke="black" points="5871.5,-9856.63 5678.5,-9856.63 5678.5,-9803.63 5871.5,-9803.63 5871.5,-9856.63"/>
<text text-anchor="middle" x="5775" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="5775" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5775" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_select&#45;&gt;expert2_linear1_4 -->
<g id="edge147" class="edge">
<title>expert_select&#45;&gt;expert2_linear1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6659.39,-9982C6393.17,-9982 5775,-9982 5775,-9982 5775,-9982 5775,-9866.93 5775,-9866.93"/>
<polygon fill="black" stroke="black" points="5778.5,-9866.93 5775,-9856.93 5771.5,-9866.93 5778.5,-9866.93"/>
</g>
<!-- expert2_linear1_5 -->
<g id="node99" class="node">
<title>expert2_linear1_5</title>
<polygon fill="lightcoral" stroke="black" points="6122.5,-9856.63 5929.5,-9856.63 5929.5,-9803.63 6122.5,-9803.63 6122.5,-9856.63"/>
<text text-anchor="middle" x="6026" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="6026" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6026" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_select&#45;&gt;expert2_linear1_5 -->
<g id="edge151" class="edge">
<title>expert_select&#45;&gt;expert2_linear1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6652.16,-9969C6457.35,-9969 6106.75,-9969 6106.75,-9969 6106.75,-9969 6106.75,-9866.9 6106.75,-9866.9"/>
<polygon fill="black" stroke="black" points="6110.25,-9866.9 6106.75,-9856.9 6103.25,-9866.9 6110.25,-9866.9"/>
</g>
<!-- expert3_linear1_6 -->
<g id="node103" class="node">
<title>expert3_linear1_6</title>
<polygon fill="lightcoral" stroke="black" points="6373.5,-9856.63 6180.5,-9856.63 6180.5,-9803.63 6373.5,-9803.63 6373.5,-9856.63"/>
<text text-anchor="middle" x="6277" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="6277" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6277" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_select&#45;&gt;expert3_linear1_6 -->
<g id="edge156" class="edge">
<title>expert_select&#45;&gt;expert3_linear1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6644.73,-9955C6518.89,-9955 6350,-9955 6350,-9955 6350,-9955 6350,-9866.92 6350,-9866.92"/>
<polygon fill="black" stroke="black" points="6353.5,-9866.92 6350,-9856.92 6346.5,-9866.92 6353.5,-9866.92"/>
</g>
<!-- expert3_linear1_7 -->
<g id="node106" class="node">
<title>expert3_linear1_7</title>
<polygon fill="lightcoral" stroke="black" points="6624.5,-9856.63 6431.5,-9856.63 6431.5,-9803.63 6624.5,-9803.63 6624.5,-9856.63"/>
<text text-anchor="middle" x="6528" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="6528" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6528" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_select&#45;&gt;expert3_linear1_7 -->
<g id="edge160" class="edge">
<title>expert_select&#45;&gt;expert3_linear1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6663.6,-9942.31C6663.6,-9893.89 6663.6,-9830 6663.6,-9830 6663.6,-9830 6634.74,-9830 6634.74,-9830"/>
<polygon fill="black" stroke="black" points="6634.74,-9826.5 6624.74,-9830 6634.74,-9833.5 6634.74,-9826.5"/>
</g>
<!-- expert4_linear1_8 -->
<g id="node110" class="node">
<title>expert4_linear1_8</title>
<polygon fill="lightcoral" stroke="black" points="6875.5,-9856.63 6682.5,-9856.63 6682.5,-9803.63 6875.5,-9803.63 6875.5,-9856.63"/>
<text text-anchor="middle" x="6779" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="6779" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6779" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_select&#45;&gt;expert4_linear1_8 -->
<g id="edge165" class="edge">
<title>expert_select&#45;&gt;expert4_linear1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6779,-9942.35C6779,-9942.35 6779,-9866.88 6779,-9866.88"/>
<polygon fill="black" stroke="black" points="6782.5,-9866.87 6779,-9856.88 6775.5,-9866.88 6782.5,-9866.87"/>
</g>
<!-- expert4_linear1_9 -->
<g id="node113" class="node">
<title>expert4_linear1_9</title>
<polygon fill="lightcoral" stroke="black" points="7126.5,-9856.63 6933.5,-9856.63 6933.5,-9803.63 7126.5,-9803.63 7126.5,-9856.63"/>
<text text-anchor="middle" x="7030" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="7030" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7030" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_select&#45;&gt;expert4_linear1_9 -->
<g id="edge169" class="edge">
<title>expert_select&#45;&gt;expert4_linear1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6897.75,-9995.51C6897.75,-9990.49 6897.75,-9830 6897.75,-9830 6897.75,-9830 6923.19,-9830 6923.19,-9830"/>
<polygon fill="black" stroke="black" points="6923.19,-9833.5 6933.19,-9830 6923.19,-9826.5 6923.19,-9833.5"/>
</g>
<!-- expert5_linear1_10 -->
<g id="node117" class="node">
<title>expert5_linear1_10</title>
<polygon fill="lightcoral" stroke="black" points="7377.5,-9856.63 7184.5,-9856.63 7184.5,-9803.63 7377.5,-9803.63 7377.5,-9856.63"/>
<text text-anchor="middle" x="7281" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="7281" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7281" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_select&#45;&gt;expert5_linear1_10 -->
<g id="edge174" class="edge">
<title>expert_select&#45;&gt;expert5_linear1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6870.3,-9957C7004.63,-9957 7239.75,-9957 7239.75,-9957 7239.75,-9957 7239.75,-9866.72 7239.75,-9866.72"/>
<polygon fill="black" stroke="black" points="7243.25,-9866.72 7239.75,-9856.72 7236.25,-9866.72 7243.25,-9866.72"/>
</g>
<!-- expert5_linear1_11 -->
<g id="node120" class="node">
<title>expert5_linear1_11</title>
<polygon fill="lightcoral" stroke="black" points="7628.5,-9856.63 7435.5,-9856.63 7435.5,-9803.63 7628.5,-9803.63 7628.5,-9856.63"/>
<text text-anchor="middle" x="7532" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="7532" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7532" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_select&#45;&gt;expert5_linear1_11 -->
<g id="edge178" class="edge">
<title>expert_select&#45;&gt;expert5_linear1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6878.6,-9972C7083.26,-9972 7532,-9972 7532,-9972 7532,-9972 7532,-9866.81 7532,-9866.81"/>
<polygon fill="black" stroke="black" points="7535.5,-9866.81 7532,-9856.81 7528.5,-9866.81 7535.5,-9866.81"/>
</g>
<!-- expert6_linear1_12 -->
<g id="node124" class="node">
<title>expert6_linear1_12</title>
<polygon fill="lightcoral" stroke="black" points="7879.5,-9856.63 7686.5,-9856.63 7686.5,-9803.63 7879.5,-9803.63 7879.5,-9856.63"/>
<text text-anchor="middle" x="7783" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="7783" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7783" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_select&#45;&gt;expert6_linear1_12 -->
<g id="edge183" class="edge">
<title>expert_select&#45;&gt;expert6_linear1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6887.37,-9988C7133.95,-9988 7715.75,-9988 7715.75,-9988 7715.75,-9988 7715.75,-9866.91 7715.75,-9866.91"/>
<polygon fill="black" stroke="black" points="7719.25,-9866.91 7715.75,-9856.91 7712.25,-9866.91 7719.25,-9866.91"/>
</g>
<!-- expert6_linear1_13 -->
<g id="node127" class="node">
<title>expert6_linear1_13</title>
<polygon fill="lightcoral" stroke="black" points="8130.5,-9856.63 7937.5,-9856.63 7937.5,-9803.63 8130.5,-9803.63 8130.5,-9856.63"/>
<text text-anchor="middle" x="8034" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="8034" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8034" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_select&#45;&gt;expert6_linear1_13 -->
<g id="edge187" class="edge">
<title>expert_select&#45;&gt;expert6_linear1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6895.32,-10003C7196.91,-10003 7980.75,-10003 7980.75,-10003 7980.75,-10003 7980.75,-9866.76 7980.75,-9866.76"/>
<polygon fill="black" stroke="black" points="7984.25,-9866.76 7980.75,-9856.76 7977.25,-9866.76 7984.25,-9866.76"/>
</g>
<!-- expert7_linear1_14 -->
<g id="node131" class="node">
<title>expert7_linear1_14</title>
<polygon fill="lightcoral" stroke="black" points="8381.5,-9856.63 8188.5,-9856.63 8188.5,-9803.63 8381.5,-9803.63 8381.5,-9856.63"/>
<text text-anchor="middle" x="8285" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="8285" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8285" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_select&#45;&gt;expert7_linear1_14 -->
<g id="edge192" class="edge">
<title>expert_select&#45;&gt;expert7_linear1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6903.45,-10018C7257.06,-10018 8242.36,-10018 8242.36,-10018 8242.36,-10018 8242.36,-9866.65 8242.36,-9866.65"/>
<polygon fill="black" stroke="black" points="8245.86,-9866.65 8242.36,-9856.65 8238.86,-9866.65 8245.86,-9866.65"/>
</g>
<!-- expert7_linear1_15 -->
<g id="node134" class="node">
<title>expert7_linear1_15</title>
<polygon fill="lightcoral" stroke="black" points="8632.5,-9856.63 8439.5,-9856.63 8439.5,-9803.63 8632.5,-9803.63 8632.5,-9856.63"/>
<text text-anchor="middle" x="8536" y="-9841.43" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="8536" y="-9826.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8536" y="-9811.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_select&#45;&gt;expert7_linear1_15 -->
<g id="edge196" class="edge">
<title>expert_select&#45;&gt;expert7_linear1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6911.52,-10033C7306.04,-10033 8445.64,-10033 8445.64,-10033 8445.64,-10033 8445.64,-9866.65 8445.64,-9866.65"/>
<polygon fill="black" stroke="black" points="8449.14,-9866.65 8445.64,-9856.65 8442.14,-9866.65 8449.14,-9866.65"/>
</g>
<!-- expert0_gelu_0 -->
<g id="node83" class="node">
<title>expert0_gelu_0</title>
<polygon fill="lightblue" stroke="black" points="4867.5,-9717.63 4674.5,-9717.63 4674.5,-9664.63 4867.5,-9664.63 4867.5,-9717.63"/>
<text text-anchor="middle" x="4771" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="4771" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4771" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert0_linear1_0&#45;&gt;expert0_gelu_0 -->
<g id="edge130" class="edge">
<title>expert0_linear1_0&#45;&gt;expert0_gelu_0</title>
<path fill="none" stroke="black" d="M4771,-9803.33C4771,-9803.33 4771,-9727.84 4771,-9727.84"/>
<polygon fill="black" stroke="black" points="4774.5,-9727.84 4771,-9717.84 4767.5,-9727.84 4774.5,-9727.84"/>
</g>
<!-- expert0_linear2_0 -->
<g id="node84" class="node">
<title>expert0_linear2_0</title>
<polygon fill="lightcoral" stroke="black" points="4840,-9578.63 4702,-9578.63 4702,-9525.63 4840,-9525.63 4840,-9578.63"/>
<text text-anchor="middle" x="4771" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="4771" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4771" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert0_gelu_0&#45;&gt;expert0_linear2_0 -->
<g id="edge131" class="edge">
<title>expert0_gelu_0&#45;&gt;expert0_linear2_0</title>
<path fill="none" stroke="black" d="M4771,-9664.33C4771,-9664.33 4771,-9588.84 4771,-9588.84"/>
<polygon fill="black" stroke="black" points="4774.5,-9588.84 4771,-9578.84 4767.5,-9588.84 4774.5,-9588.84"/>
</g>
<!-- expert0_agg -->
<g id="node88" class="node">
<title>expert0_agg</title>
<polygon fill="lightgreen" stroke="black" points="5005.11,-9439.63 4632.69,-9439.63 4536.89,-9333.63 4909.31,-9333.63 5005.11,-9439.63"/>
<text text-anchor="middle" x="4771" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 0 Output Aggregation</text>
<text text-anchor="middle" x="4771" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="4771" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 0,1</text>
</g>
<!-- expert0_linear2_0&#45;&gt;expert0_agg -->
<g id="edge132" class="edge">
<title>expert0_linear2_0&#45;&gt;expert0_agg</title>
<path fill="none" stroke="black" d="M4771,-9525.54C4771,-9525.54 4771,-9449.9 4771,-9449.9"/>
<polygon fill="black" stroke="black" points="4774.5,-9449.9 4771,-9439.9 4767.5,-9449.9 4774.5,-9449.9"/>
</g>
<!-- expert0_gelu_1 -->
<g id="node86" class="node">
<title>expert0_gelu_1</title>
<polygon fill="lightblue" stroke="black" points="5118.5,-9717.63 4925.5,-9717.63 4925.5,-9664.63 5118.5,-9664.63 5118.5,-9717.63"/>
<text text-anchor="middle" x="5022" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="5022" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5022" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert0_linear1_1&#45;&gt;expert0_gelu_1 -->
<g id="edge134" class="edge">
<title>expert0_linear1_1&#45;&gt;expert0_gelu_1</title>
<path fill="none" stroke="black" d="M5022,-9803.33C5022,-9803.33 5022,-9727.84 5022,-9727.84"/>
<polygon fill="black" stroke="black" points="5025.5,-9727.84 5022,-9717.84 5018.5,-9727.84 5025.5,-9727.84"/>
</g>
<!-- expert0_linear2_1 -->
<g id="node87" class="node">
<title>expert0_linear2_1</title>
<polygon fill="lightcoral" stroke="black" points="5064,-9578.63 4926,-9578.63 4926,-9525.63 5064,-9525.63 5064,-9578.63"/>
<text text-anchor="middle" x="4995" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="4995" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4995" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert0_gelu_1&#45;&gt;expert0_linear2_1 -->
<g id="edge135" class="edge">
<title>expert0_gelu_1&#45;&gt;expert0_linear2_1</title>
<path fill="none" stroke="black" d="M4995,-9664.33C4995,-9664.33 4995,-9588.84 4995,-9588.84"/>
<polygon fill="black" stroke="black" points="4998.5,-9588.84 4995,-9578.84 4991.5,-9588.84 4998.5,-9588.84"/>
</g>
<!-- expert0_linear2_1&#45;&gt;expert0_agg -->
<g id="edge136" class="edge">
<title>expert0_linear2_1&#45;&gt;expert0_agg</title>
<path fill="none" stroke="black" d="M4965.65,-9525.54C4965.65,-9525.54 4965.65,-9449.9 4965.65,-9449.9"/>
<polygon fill="black" stroke="black" points="4969.15,-9449.9 4965.65,-9439.9 4962.15,-9449.9 4969.15,-9449.9"/>
</g>
<!-- expert_outputs -->
<g id="node138" class="node">
<title>expert_outputs</title>
<polygon fill="lightgreen" stroke="black" points="7107.17,-9247.63 6744.2,-9247.63 6650.83,-9141.63 7013.8,-9141.63 7107.17,-9247.63"/>
<text text-anchor="middle" x="6879" y="-9205.93" font-family="Times,serif" font-size="14.00">Expert Outputs Aggregation</text>
<text text-anchor="middle" x="6879" y="-9190.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6879" y="-9175.93" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert0_agg&#45;&gt;expert_outputs -->
<g id="edge137" class="edge">
<title>expert0_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M4990.65,-9386.46C4990.65,-9379.66 4990.65,-9162 4990.65,-9162 4990.65,-9162 6658.33,-9162 6658.33,-9162"/>
<polygon fill="black" stroke="black" points="6658.33,-9165.5 6668.33,-9162 6658.33,-9158.5 6658.33,-9165.5"/>
</g>
<!-- expert1_gelu_2 -->
<g id="node90" class="node">
<title>expert1_gelu_2</title>
<polygon fill="lightblue" stroke="black" points="5369.5,-9717.63 5176.5,-9717.63 5176.5,-9664.63 5369.5,-9664.63 5369.5,-9717.63"/>
<text text-anchor="middle" x="5273" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5273" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5273" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert1_linear1_2&#45;&gt;expert1_gelu_2 -->
<g id="edge139" class="edge">
<title>expert1_linear1_2&#45;&gt;expert1_gelu_2</title>
<path fill="none" stroke="black" d="M5273,-9803.33C5273,-9803.33 5273,-9727.84 5273,-9727.84"/>
<polygon fill="black" stroke="black" points="5276.5,-9727.84 5273,-9717.84 5269.5,-9727.84 5276.5,-9727.84"/>
</g>
<!-- expert1_linear2_2 -->
<g id="node91" class="node">
<title>expert1_linear2_2</title>
<polygon fill="lightcoral" stroke="black" points="5354,-9578.63 5216,-9578.63 5216,-9525.63 5354,-9525.63 5354,-9578.63"/>
<text text-anchor="middle" x="5285" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="5285" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5285" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert1_gelu_2&#45;&gt;expert1_linear2_2 -->
<g id="edge140" class="edge">
<title>expert1_gelu_2&#45;&gt;expert1_linear2_2</title>
<path fill="none" stroke="black" d="M5285,-9664.33C5285,-9664.33 5285,-9588.84 5285,-9588.84"/>
<polygon fill="black" stroke="black" points="5288.5,-9588.84 5285,-9578.84 5281.5,-9588.84 5288.5,-9588.84"/>
</g>
<!-- expert1_agg -->
<g id="node95" class="node">
<title>expert1_agg</title>
<polygon fill="lightgreen" stroke="black" points="5532.11,-9439.63 5159.69,-9439.63 5063.89,-9333.63 5436.31,-9333.63 5532.11,-9439.63"/>
<text text-anchor="middle" x="5298" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 1 Output Aggregation</text>
<text text-anchor="middle" x="5298" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5298" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 2,3</text>
</g>
<!-- expert1_linear2_2&#45;&gt;expert1_agg -->
<g id="edge141" class="edge">
<title>expert1_linear2_2&#45;&gt;expert1_agg</title>
<path fill="none" stroke="black" d="M5285,-9525.54C5285,-9525.54 5285,-9449.9 5285,-9449.9"/>
<polygon fill="black" stroke="black" points="5288.5,-9449.9 5285,-9439.9 5281.5,-9449.9 5288.5,-9449.9"/>
</g>
<!-- expert1_gelu_3 -->
<g id="node93" class="node">
<title>expert1_gelu_3</title>
<polygon fill="lightblue" stroke="black" points="5620.5,-9717.63 5427.5,-9717.63 5427.5,-9664.63 5620.5,-9664.63 5620.5,-9717.63"/>
<text text-anchor="middle" x="5524" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5524" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5524" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert1_linear1_3&#45;&gt;expert1_gelu_3 -->
<g id="edge143" class="edge">
<title>expert1_linear1_3&#45;&gt;expert1_gelu_3</title>
<path fill="none" stroke="black" d="M5524,-9803.33C5524,-9803.33 5524,-9727.84 5524,-9727.84"/>
<polygon fill="black" stroke="black" points="5527.5,-9727.84 5524,-9717.84 5520.5,-9727.84 5527.5,-9727.84"/>
</g>
<!-- expert1_linear2_3 -->
<g id="node94" class="node">
<title>expert1_linear2_3</title>
<polygon fill="lightcoral" stroke="black" points="5577,-9578.63 5439,-9578.63 5439,-9525.63 5577,-9525.63 5577,-9578.63"/>
<text text-anchor="middle" x="5508" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="5508" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5508" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert1_gelu_3&#45;&gt;expert1_linear2_3 -->
<g id="edge144" class="edge">
<title>expert1_gelu_3&#45;&gt;expert1_linear2_3</title>
<path fill="none" stroke="black" d="M5508,-9664.33C5508,-9664.33 5508,-9588.84 5508,-9588.84"/>
<polygon fill="black" stroke="black" points="5511.5,-9588.84 5508,-9578.84 5504.5,-9588.84 5511.5,-9588.84"/>
</g>
<!-- expert1_linear2_3&#45;&gt;expert1_agg -->
<g id="edge145" class="edge">
<title>expert1_linear2_3&#45;&gt;expert1_agg</title>
<path fill="none" stroke="black" d="M5485.65,-9525.54C5485.65,-9525.54 5485.65,-9449.9 5485.65,-9449.9"/>
<polygon fill="black" stroke="black" points="5489.15,-9449.9 5485.65,-9439.9 5482.15,-9449.9 5489.15,-9449.9"/>
</g>
<!-- expert1_agg&#45;&gt;expert_outputs -->
<g id="edge146" class="edge">
<title>expert1_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M5497.5,-9386.48C5497.5,-9380.34 5497.5,-9184 5497.5,-9184 5497.5,-9184 6678,-9184 6678,-9184"/>
<polygon fill="black" stroke="black" points="6678,-9187.5 6688,-9184 6678,-9180.5 6678,-9187.5"/>
</g>
<!-- expert2_gelu_4 -->
<g id="node97" class="node">
<title>expert2_gelu_4</title>
<polygon fill="lightblue" stroke="black" points="5871.5,-9717.63 5678.5,-9717.63 5678.5,-9664.63 5871.5,-9664.63 5871.5,-9717.63"/>
<text text-anchor="middle" x="5775" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="5775" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5775" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert2_linear1_4&#45;&gt;expert2_gelu_4 -->
<g id="edge148" class="edge">
<title>expert2_linear1_4&#45;&gt;expert2_gelu_4</title>
<path fill="none" stroke="black" d="M5775,-9803.33C5775,-9803.33 5775,-9727.84 5775,-9727.84"/>
<polygon fill="black" stroke="black" points="5778.5,-9727.84 5775,-9717.84 5771.5,-9727.84 5778.5,-9727.84"/>
</g>
<!-- expert2_linear2_4 -->
<g id="node98" class="node">
<title>expert2_linear2_4</title>
<polygon fill="lightcoral" stroke="black" points="5858,-9578.63 5720,-9578.63 5720,-9525.63 5858,-9525.63 5858,-9578.63"/>
<text text-anchor="middle" x="5789" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="5789" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5789" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert2_gelu_4&#45;&gt;expert2_linear2_4 -->
<g id="edge149" class="edge">
<title>expert2_gelu_4&#45;&gt;expert2_linear2_4</title>
<path fill="none" stroke="black" d="M5789,-9664.33C5789,-9664.33 5789,-9588.84 5789,-9588.84"/>
<polygon fill="black" stroke="black" points="5792.5,-9588.84 5789,-9578.84 5785.5,-9588.84 5792.5,-9588.84"/>
</g>
<!-- expert2_agg -->
<g id="node102" class="node">
<title>expert2_agg</title>
<polygon fill="lightgreen" stroke="black" points="6059.11,-9439.63 5686.69,-9439.63 5590.89,-9333.63 5963.31,-9333.63 6059.11,-9439.63"/>
<text text-anchor="middle" x="5825" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 2 Output Aggregation</text>
<text text-anchor="middle" x="5825" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5825" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 4,5</text>
</g>
<!-- expert2_linear2_4&#45;&gt;expert2_agg -->
<g id="edge150" class="edge">
<title>expert2_linear2_4&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M5789,-9525.54C5789,-9525.54 5789,-9449.9 5789,-9449.9"/>
<polygon fill="black" stroke="black" points="5792.5,-9449.9 5789,-9439.9 5785.5,-9449.9 5792.5,-9449.9"/>
</g>
<!-- expert2_gelu_5 -->
<g id="node100" class="node">
<title>expert2_gelu_5</title>
<polygon fill="lightblue" stroke="black" points="6122.5,-9717.63 5929.5,-9717.63 5929.5,-9664.63 6122.5,-9664.63 6122.5,-9717.63"/>
<text text-anchor="middle" x="6026" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="6026" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6026" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert2_linear1_5&#45;&gt;expert2_gelu_5 -->
<g id="edge152" class="edge">
<title>expert2_linear1_5&#45;&gt;expert2_gelu_5</title>
<path fill="none" stroke="black" d="M6026,-9803.33C6026,-9803.33 6026,-9727.84 6026,-9727.84"/>
<polygon fill="black" stroke="black" points="6029.5,-9727.84 6026,-9717.84 6022.5,-9727.84 6029.5,-9727.84"/>
</g>
<!-- expert2_linear2_5 -->
<g id="node101" class="node">
<title>expert2_linear2_5</title>
<polygon fill="lightcoral" stroke="black" points="6081,-9578.63 5943,-9578.63 5943,-9525.63 6081,-9525.63 6081,-9578.63"/>
<text text-anchor="middle" x="6012" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="6012" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6012" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert2_gelu_5&#45;&gt;expert2_linear2_5 -->
<g id="edge153" class="edge">
<title>expert2_gelu_5&#45;&gt;expert2_linear2_5</title>
<path fill="none" stroke="black" d="M6012,-9664.33C6012,-9664.33 6012,-9588.84 6012,-9588.84"/>
<polygon fill="black" stroke="black" points="6015.5,-9588.84 6012,-9578.84 6008.5,-9588.84 6015.5,-9588.84"/>
</g>
<!-- expert2_linear2_5&#45;&gt;expert2_agg -->
<g id="edge154" class="edge">
<title>expert2_linear2_5&#45;&gt;expert2_agg</title>
<path fill="none" stroke="black" d="M6001.15,-9525.54C6001.15,-9525.54 6001.15,-9449.9 6001.15,-9449.9"/>
<polygon fill="black" stroke="black" points="6004.65,-9449.9 6001.15,-9439.9 5997.65,-9449.9 6004.65,-9449.9"/>
</g>
<!-- expert2_agg&#45;&gt;expert_outputs -->
<g id="edge155" class="edge">
<title>expert2_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M6047.4,-9386.49C6047.4,-9381 6047.4,-9205 6047.4,-9205 6047.4,-9205 6696.44,-9205 6696.44,-9205"/>
<polygon fill="black" stroke="black" points="6696.44,-9208.5 6706.44,-9205 6696.44,-9201.5 6696.44,-9208.5"/>
</g>
<!-- expert3_gelu_6 -->
<g id="node104" class="node">
<title>expert3_gelu_6</title>
<polygon fill="lightblue" stroke="black" points="6373.5,-9717.63 6180.5,-9717.63 6180.5,-9664.63 6373.5,-9664.63 6373.5,-9717.63"/>
<text text-anchor="middle" x="6277" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6277" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6277" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert3_linear1_6&#45;&gt;expert3_gelu_6 -->
<g id="edge157" class="edge">
<title>expert3_linear1_6&#45;&gt;expert3_gelu_6</title>
<path fill="none" stroke="black" d="M6277,-9803.33C6277,-9803.33 6277,-9727.84 6277,-9727.84"/>
<polygon fill="black" stroke="black" points="6280.5,-9727.84 6277,-9717.84 6273.5,-9727.84 6280.5,-9727.84"/>
</g>
<!-- expert3_linear2_6 -->
<g id="node105" class="node">
<title>expert3_linear2_6</title>
<polygon fill="lightcoral" stroke="black" points="6360,-9578.63 6222,-9578.63 6222,-9525.63 6360,-9525.63 6360,-9578.63"/>
<text text-anchor="middle" x="6291" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="6291" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6291" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert3_gelu_6&#45;&gt;expert3_linear2_6 -->
<g id="edge158" class="edge">
<title>expert3_gelu_6&#45;&gt;expert3_linear2_6</title>
<path fill="none" stroke="black" d="M6291,-9664.33C6291,-9664.33 6291,-9588.84 6291,-9588.84"/>
<polygon fill="black" stroke="black" points="6294.5,-9588.84 6291,-9578.84 6287.5,-9588.84 6294.5,-9588.84"/>
</g>
<!-- expert3_agg -->
<g id="node109" class="node">
<title>expert3_agg</title>
<polygon fill="lightgreen" stroke="black" points="6586.11,-9439.63 6213.69,-9439.63 6117.89,-9333.63 6490.31,-9333.63 6586.11,-9439.63"/>
<text text-anchor="middle" x="6352" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 3 Output Aggregation</text>
<text text-anchor="middle" x="6352" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6352" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 6,7</text>
</g>
<!-- expert3_linear2_6&#45;&gt;expert3_agg -->
<g id="edge159" class="edge">
<title>expert3_linear2_6&#45;&gt;expert3_agg</title>
<path fill="none" stroke="black" d="M6291,-9525.54C6291,-9525.54 6291,-9449.9 6291,-9449.9"/>
<polygon fill="black" stroke="black" points="6294.5,-9449.9 6291,-9439.9 6287.5,-9449.9 6294.5,-9449.9"/>
</g>
<!-- expert3_gelu_7 -->
<g id="node107" class="node">
<title>expert3_gelu_7</title>
<polygon fill="lightblue" stroke="black" points="6624.5,-9717.63 6431.5,-9717.63 6431.5,-9664.63 6624.5,-9664.63 6624.5,-9717.63"/>
<text text-anchor="middle" x="6528" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6528" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6528" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert3_linear1_7&#45;&gt;expert3_gelu_7 -->
<g id="edge161" class="edge">
<title>expert3_linear1_7&#45;&gt;expert3_gelu_7</title>
<path fill="none" stroke="black" d="M6528,-9803.33C6528,-9803.33 6528,-9727.84 6528,-9727.84"/>
<polygon fill="black" stroke="black" points="6531.5,-9727.84 6528,-9717.84 6524.5,-9727.84 6531.5,-9727.84"/>
</g>
<!-- expert3_linear2_7 -->
<g id="node108" class="node">
<title>expert3_linear2_7</title>
<polygon fill="lightcoral" stroke="black" points="6583,-9578.63 6445,-9578.63 6445,-9525.63 6583,-9525.63 6583,-9578.63"/>
<text text-anchor="middle" x="6514" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="6514" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6514" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert3_gelu_7&#45;&gt;expert3_linear2_7 -->
<g id="edge162" class="edge">
<title>expert3_gelu_7&#45;&gt;expert3_linear2_7</title>
<path fill="none" stroke="black" d="M6514,-9664.33C6514,-9664.33 6514,-9588.84 6514,-9588.84"/>
<polygon fill="black" stroke="black" points="6517.5,-9588.84 6514,-9578.84 6510.5,-9588.84 6517.5,-9588.84"/>
</g>
<!-- expert3_linear2_7&#45;&gt;expert3_agg -->
<g id="edge163" class="edge">
<title>expert3_linear2_7&#45;&gt;expert3_agg</title>
<path fill="none" stroke="black" d="M6514,-9525.54C6514,-9525.54 6514,-9449.9 6514,-9449.9"/>
<polygon fill="black" stroke="black" points="6517.5,-9449.9 6514,-9439.9 6510.5,-9449.9 6517.5,-9449.9"/>
</g>
<!-- expert3_agg&#45;&gt;expert_outputs -->
<g id="edge164" class="edge">
<title>expert3_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M6528.9,-9376.09C6528.9,-9340.35 6528.9,-9226 6528.9,-9226 6528.9,-9226 6714.93,-9226 6714.93,-9226"/>
<polygon fill="black" stroke="black" points="6714.93,-9229.5 6724.93,-9226 6714.93,-9222.5 6714.93,-9229.5"/>
</g>
<!-- expert4_gelu_8 -->
<g id="node111" class="node">
<title>expert4_gelu_8</title>
<polygon fill="lightblue" stroke="black" points="6875.5,-9717.63 6682.5,-9717.63 6682.5,-9664.63 6875.5,-9664.63 6875.5,-9717.63"/>
<text text-anchor="middle" x="6779" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="6779" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6779" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert4_linear1_8&#45;&gt;expert4_gelu_8 -->
<g id="edge166" class="edge">
<title>expert4_linear1_8&#45;&gt;expert4_gelu_8</title>
<path fill="none" stroke="black" d="M6779,-9803.33C6779,-9803.33 6779,-9727.84 6779,-9727.84"/>
<polygon fill="black" stroke="black" points="6782.5,-9727.84 6779,-9717.84 6775.5,-9727.84 6782.5,-9727.84"/>
</g>
<!-- expert4_linear2_8 -->
<g id="node112" class="node">
<title>expert4_linear2_8</title>
<polygon fill="lightcoral" stroke="black" points="6862,-9578.63 6724,-9578.63 6724,-9525.63 6862,-9525.63 6862,-9578.63"/>
<text text-anchor="middle" x="6793" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="6793" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6793" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert4_gelu_8&#45;&gt;expert4_linear2_8 -->
<g id="edge167" class="edge">
<title>expert4_gelu_8&#45;&gt;expert4_linear2_8</title>
<path fill="none" stroke="black" d="M6793,-9664.33C6793,-9664.33 6793,-9588.84 6793,-9588.84"/>
<polygon fill="black" stroke="black" points="6796.5,-9588.84 6793,-9578.84 6789.5,-9588.84 6796.5,-9588.84"/>
</g>
<!-- expert4_agg -->
<g id="node116" class="node">
<title>expert4_agg</title>
<polygon fill="lightgreen" stroke="black" points="7113.11,-9439.63 6740.69,-9439.63 6644.89,-9333.63 7017.31,-9333.63 7113.11,-9439.63"/>
<text text-anchor="middle" x="6879" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 4 Output Aggregation</text>
<text text-anchor="middle" x="6879" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6879" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 8,9</text>
</g>
<!-- expert4_linear2_8&#45;&gt;expert4_agg -->
<g id="edge168" class="edge">
<title>expert4_linear2_8&#45;&gt;expert4_agg</title>
<path fill="none" stroke="black" d="M6793,-9525.54C6793,-9525.54 6793,-9449.9 6793,-9449.9"/>
<polygon fill="black" stroke="black" points="6796.5,-9449.9 6793,-9439.9 6789.5,-9449.9 6796.5,-9449.9"/>
</g>
<!-- expert4_gelu_9 -->
<g id="node114" class="node">
<title>expert4_gelu_9</title>
<polygon fill="lightblue" stroke="black" points="7126.5,-9717.63 6933.5,-9717.63 6933.5,-9664.63 7126.5,-9664.63 7126.5,-9717.63"/>
<text text-anchor="middle" x="7030" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="7030" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7030" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert4_linear1_9&#45;&gt;expert4_gelu_9 -->
<g id="edge170" class="edge">
<title>expert4_linear1_9&#45;&gt;expert4_gelu_9</title>
<path fill="none" stroke="black" d="M7030,-9803.33C7030,-9803.33 7030,-9727.84 7030,-9727.84"/>
<polygon fill="black" stroke="black" points="7033.5,-9727.84 7030,-9717.84 7026.5,-9727.84 7033.5,-9727.84"/>
</g>
<!-- expert4_linear2_9 -->
<g id="node115" class="node">
<title>expert4_linear2_9</title>
<polygon fill="lightcoral" stroke="black" points="7085,-9578.63 6947,-9578.63 6947,-9525.63 7085,-9525.63 7085,-9578.63"/>
<text text-anchor="middle" x="7016" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="7016" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7016" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert4_gelu_9&#45;&gt;expert4_linear2_9 -->
<g id="edge171" class="edge">
<title>expert4_gelu_9&#45;&gt;expert4_linear2_9</title>
<path fill="none" stroke="black" d="M7016,-9664.33C7016,-9664.33 7016,-9588.84 7016,-9588.84"/>
<polygon fill="black" stroke="black" points="7019.5,-9588.84 7016,-9578.84 7012.5,-9588.84 7019.5,-9588.84"/>
</g>
<!-- expert4_linear2_9&#45;&gt;expert4_agg -->
<g id="edge172" class="edge">
<title>expert4_linear2_9&#45;&gt;expert4_agg</title>
<path fill="none" stroke="black" d="M7016,-9525.54C7016,-9525.54 7016,-9449.9 7016,-9449.9"/>
<polygon fill="black" stroke="black" points="7019.5,-9449.9 7016,-9439.9 7012.5,-9449.9 7019.5,-9449.9"/>
</g>
<!-- expert4_agg&#45;&gt;expert_outputs -->
<g id="edge173" class="edge">
<title>expert4_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M6879,-9333.4C6879,-9333.4 6879,-9257.96 6879,-9257.96"/>
<polygon fill="black" stroke="black" points="6882.5,-9257.96 6879,-9247.96 6875.5,-9257.96 6882.5,-9257.96"/>
</g>
<!-- expert5_gelu_10 -->
<g id="node118" class="node">
<title>expert5_gelu_10</title>
<polygon fill="lightblue" stroke="black" points="7377.5,-9717.63 7184.5,-9717.63 7184.5,-9664.63 7377.5,-9664.63 7377.5,-9717.63"/>
<text text-anchor="middle" x="7281" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="7281" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7281" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert5_linear1_10&#45;&gt;expert5_gelu_10 -->
<g id="edge175" class="edge">
<title>expert5_linear1_10&#45;&gt;expert5_gelu_10</title>
<path fill="none" stroke="black" d="M7281,-9803.33C7281,-9803.33 7281,-9727.84 7281,-9727.84"/>
<polygon fill="black" stroke="black" points="7284.5,-9727.84 7281,-9717.84 7277.5,-9727.84 7284.5,-9727.84"/>
</g>
<!-- expert5_linear2_10 -->
<g id="node119" class="node">
<title>expert5_linear2_10</title>
<polygon fill="lightcoral" stroke="black" points="7364,-9578.63 7226,-9578.63 7226,-9525.63 7364,-9525.63 7364,-9578.63"/>
<text text-anchor="middle" x="7295" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="7295" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7295" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert5_gelu_10&#45;&gt;expert5_linear2_10 -->
<g id="edge176" class="edge">
<title>expert5_gelu_10&#45;&gt;expert5_linear2_10</title>
<path fill="none" stroke="black" d="M7295,-9664.33C7295,-9664.33 7295,-9588.84 7295,-9588.84"/>
<polygon fill="black" stroke="black" points="7298.5,-9588.84 7295,-9578.84 7291.5,-9588.84 7298.5,-9588.84"/>
</g>
<!-- expert5_agg -->
<g id="node123" class="node">
<title>expert5_agg</title>
<polygon fill="lightgreen" stroke="black" points="7640.11,-9439.63 7267.69,-9439.63 7171.89,-9333.63 7544.31,-9333.63 7640.11,-9439.63"/>
<text text-anchor="middle" x="7406" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 5 Output Aggregation</text>
<text text-anchor="middle" x="7406" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7406" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 10,11</text>
</g>
<!-- expert5_linear2_10&#45;&gt;expert5_agg -->
<g id="edge177" class="edge">
<title>expert5_linear2_10&#45;&gt;expert5_agg</title>
<path fill="none" stroke="black" d="M7295,-9525.54C7295,-9525.54 7295,-9449.9 7295,-9449.9"/>
<polygon fill="black" stroke="black" points="7298.5,-9449.9 7295,-9439.9 7291.5,-9449.9 7298.5,-9449.9"/>
</g>
<!-- expert5_gelu_11 -->
<g id="node121" class="node">
<title>expert5_gelu_11</title>
<polygon fill="lightblue" stroke="black" points="7628.5,-9717.63 7435.5,-9717.63 7435.5,-9664.63 7628.5,-9664.63 7628.5,-9717.63"/>
<text text-anchor="middle" x="7532" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="7532" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7532" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert5_linear1_11&#45;&gt;expert5_gelu_11 -->
<g id="edge179" class="edge">
<title>expert5_linear1_11&#45;&gt;expert5_gelu_11</title>
<path fill="none" stroke="black" d="M7532,-9803.33C7532,-9803.33 7532,-9727.84 7532,-9727.84"/>
<polygon fill="black" stroke="black" points="7535.5,-9727.84 7532,-9717.84 7528.5,-9727.84 7535.5,-9727.84"/>
</g>
<!-- expert5_linear2_11 -->
<g id="node122" class="node">
<title>expert5_linear2_11</title>
<polygon fill="lightcoral" stroke="black" points="7587,-9578.63 7449,-9578.63 7449,-9525.63 7587,-9525.63 7587,-9578.63"/>
<text text-anchor="middle" x="7518" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="7518" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7518" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert5_gelu_11&#45;&gt;expert5_linear2_11 -->
<g id="edge180" class="edge">
<title>expert5_gelu_11&#45;&gt;expert5_linear2_11</title>
<path fill="none" stroke="black" d="M7518,-9664.33C7518,-9664.33 7518,-9588.84 7518,-9588.84"/>
<polygon fill="black" stroke="black" points="7521.5,-9588.84 7518,-9578.84 7514.5,-9588.84 7521.5,-9588.84"/>
</g>
<!-- expert5_linear2_11&#45;&gt;expert5_agg -->
<g id="edge181" class="edge">
<title>expert5_linear2_11&#45;&gt;expert5_agg</title>
<path fill="none" stroke="black" d="M7518,-9525.54C7518,-9525.54 7518,-9449.9 7518,-9449.9"/>
<polygon fill="black" stroke="black" points="7521.5,-9449.9 7518,-9439.9 7514.5,-9449.9 7521.5,-9449.9"/>
</g>
<!-- expert5_agg&#45;&gt;expert_outputs -->
<g id="edge182" class="edge">
<title>expert5_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M7182.57,-9386.51C7182.57,-9381.49 7182.57,-9221 7182.57,-9221 7182.57,-9221 7094.01,-9221 7094.01,-9221"/>
<polygon fill="black" stroke="black" points="7094.01,-9217.5 7084.01,-9221 7094.01,-9224.5 7094.01,-9217.5"/>
</g>
<!-- expert6_gelu_12 -->
<g id="node125" class="node">
<title>expert6_gelu_12</title>
<polygon fill="lightblue" stroke="black" points="7879.5,-9717.63 7686.5,-9717.63 7686.5,-9664.63 7879.5,-9664.63 7879.5,-9717.63"/>
<text text-anchor="middle" x="7783" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="7783" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7783" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert6_linear1_12&#45;&gt;expert6_gelu_12 -->
<g id="edge184" class="edge">
<title>expert6_linear1_12&#45;&gt;expert6_gelu_12</title>
<path fill="none" stroke="black" d="M7783,-9803.33C7783,-9803.33 7783,-9727.84 7783,-9727.84"/>
<polygon fill="black" stroke="black" points="7786.5,-9727.84 7783,-9717.84 7779.5,-9727.84 7786.5,-9727.84"/>
</g>
<!-- expert6_linear2_12 -->
<g id="node126" class="node">
<title>expert6_linear2_12</title>
<polygon fill="lightcoral" stroke="black" points="7866,-9578.63 7728,-9578.63 7728,-9525.63 7866,-9525.63 7866,-9578.63"/>
<text text-anchor="middle" x="7797" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="7797" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7797" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert6_gelu_12&#45;&gt;expert6_linear2_12 -->
<g id="edge185" class="edge">
<title>expert6_gelu_12&#45;&gt;expert6_linear2_12</title>
<path fill="none" stroke="black" d="M7797,-9664.33C7797,-9664.33 7797,-9588.84 7797,-9588.84"/>
<polygon fill="black" stroke="black" points="7800.5,-9588.84 7797,-9578.84 7793.5,-9588.84 7800.5,-9588.84"/>
</g>
<!-- expert6_agg -->
<g id="node130" class="node">
<title>expert6_agg</title>
<polygon fill="lightgreen" stroke="black" points="8167.11,-9439.63 7794.69,-9439.63 7698.89,-9333.63 8071.31,-9333.63 8167.11,-9439.63"/>
<text text-anchor="middle" x="7933" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 6 Output Aggregation</text>
<text text-anchor="middle" x="7933" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7933" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 12,13</text>
</g>
<!-- expert6_linear2_12&#45;&gt;expert6_agg -->
<g id="edge186" class="edge">
<title>expert6_linear2_12&#45;&gt;expert6_agg</title>
<path fill="none" stroke="black" d="M7797,-9525.54C7797,-9525.54 7797,-9449.9 7797,-9449.9"/>
<polygon fill="black" stroke="black" points="7800.5,-9449.9 7797,-9439.9 7793.5,-9449.9 7800.5,-9449.9"/>
</g>
<!-- expert6_gelu_13 -->
<g id="node128" class="node">
<title>expert6_gelu_13</title>
<polygon fill="lightblue" stroke="black" points="8130.5,-9717.63 7937.5,-9717.63 7937.5,-9664.63 8130.5,-9664.63 8130.5,-9717.63"/>
<text text-anchor="middle" x="8034" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="8034" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8034" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert6_linear1_13&#45;&gt;expert6_gelu_13 -->
<g id="edge188" class="edge">
<title>expert6_linear1_13&#45;&gt;expert6_gelu_13</title>
<path fill="none" stroke="black" d="M8034,-9803.33C8034,-9803.33 8034,-9727.84 8034,-9727.84"/>
<polygon fill="black" stroke="black" points="8037.5,-9727.84 8034,-9717.84 8030.5,-9727.84 8037.5,-9727.84"/>
</g>
<!-- expert6_linear2_13 -->
<g id="node129" class="node">
<title>expert6_linear2_13</title>
<polygon fill="lightcoral" stroke="black" points="8089,-9578.63 7951,-9578.63 7951,-9525.63 8089,-9525.63 8089,-9578.63"/>
<text text-anchor="middle" x="8020" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="8020" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8020" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert6_gelu_13&#45;&gt;expert6_linear2_13 -->
<g id="edge189" class="edge">
<title>expert6_gelu_13&#45;&gt;expert6_linear2_13</title>
<path fill="none" stroke="black" d="M8020,-9664.33C8020,-9664.33 8020,-9588.84 8020,-9588.84"/>
<polygon fill="black" stroke="black" points="8023.5,-9588.84 8020,-9578.84 8016.5,-9588.84 8023.5,-9588.84"/>
</g>
<!-- expert6_linear2_13&#45;&gt;expert6_agg -->
<g id="edge190" class="edge">
<title>expert6_linear2_13&#45;&gt;expert6_agg</title>
<path fill="none" stroke="black" d="M8020,-9525.54C8020,-9525.54 8020,-9449.9 8020,-9449.9"/>
<polygon fill="black" stroke="black" points="8023.5,-9449.9 8020,-9439.9 8016.5,-9449.9 8023.5,-9449.9"/>
</g>
<!-- expert6_agg&#45;&gt;expert_outputs -->
<g id="edge191" class="edge">
<title>expert6_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M7717.6,-9386.49C7717.6,-9380.65 7717.6,-9194 7717.6,-9194 7717.6,-9194 7070.19,-9194 7070.19,-9194"/>
<polygon fill="black" stroke="black" points="7070.19,-9190.5 7060.19,-9194 7070.19,-9197.5 7070.19,-9190.5"/>
</g>
<!-- expert7_gelu_14 -->
<g id="node132" class="node">
<title>expert7_gelu_14</title>
<polygon fill="lightblue" stroke="black" points="8381.5,-9717.63 8188.5,-9717.63 8188.5,-9664.63 8381.5,-9664.63 8381.5,-9717.63"/>
<text text-anchor="middle" x="8285" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="8285" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8285" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert7_linear1_14&#45;&gt;expert7_gelu_14 -->
<g id="edge193" class="edge">
<title>expert7_linear1_14&#45;&gt;expert7_gelu_14</title>
<path fill="none" stroke="black" d="M8285,-9803.33C8285,-9803.33 8285,-9727.84 8285,-9727.84"/>
<polygon fill="black" stroke="black" points="8288.5,-9727.84 8285,-9717.84 8281.5,-9727.84 8288.5,-9727.84"/>
</g>
<!-- expert7_linear2_14 -->
<g id="node133" class="node">
<title>expert7_linear2_14</title>
<polygon fill="lightcoral" stroke="black" points="8368,-9578.63 8230,-9578.63 8230,-9525.63 8368,-9525.63 8368,-9578.63"/>
<text text-anchor="middle" x="8299" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="8299" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8299" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert7_gelu_14&#45;&gt;expert7_linear2_14 -->
<g id="edge194" class="edge">
<title>expert7_gelu_14&#45;&gt;expert7_linear2_14</title>
<path fill="none" stroke="black" d="M8299,-9664.33C8299,-9664.33 8299,-9588.84 8299,-9588.84"/>
<polygon fill="black" stroke="black" points="8302.5,-9588.84 8299,-9578.84 8295.5,-9588.84 8302.5,-9588.84"/>
</g>
<!-- expert7_agg -->
<g id="node137" class="node">
<title>expert7_agg</title>
<polygon fill="lightgreen" stroke="black" points="8694.11,-9439.63 8321.69,-9439.63 8225.89,-9333.63 8598.31,-9333.63 8694.11,-9439.63"/>
<text text-anchor="middle" x="8460" y="-9397.93" font-family="Times,serif" font-size="14.00">Expert 7 Output Aggregation</text>
<text text-anchor="middle" x="8460" y="-9382.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8460" y="-9367.93" font-family="Times,serif" font-size="14.00">GPUs 14,15</text>
</g>
<!-- expert7_linear2_14&#45;&gt;expert7_agg -->
<g id="edge195" class="edge">
<title>expert7_linear2_14&#45;&gt;expert7_agg</title>
<path fill="none" stroke="black" d="M8299,-9525.54C8299,-9525.54 8299,-9424.53 8299,-9424.53"/>
<polygon fill="black" stroke="black" points="8302.5,-9424.53 8299,-9414.53 8295.5,-9424.53 8302.5,-9424.53"/>
</g>
<!-- expert7_gelu_15 -->
<g id="node135" class="node">
<title>expert7_gelu_15</title>
<polygon fill="lightblue" stroke="black" points="8632.5,-9717.63 8439.5,-9717.63 8439.5,-9664.63 8632.5,-9664.63 8632.5,-9717.63"/>
<text text-anchor="middle" x="8536" y="-9702.43" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="8536" y="-9687.43" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8536" y="-9672.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert7_linear1_15&#45;&gt;expert7_gelu_15 -->
<g id="edge197" class="edge">
<title>expert7_linear1_15&#45;&gt;expert7_gelu_15</title>
<path fill="none" stroke="black" d="M8536,-9803.33C8536,-9803.33 8536,-9727.84 8536,-9727.84"/>
<polygon fill="black" stroke="black" points="8539.5,-9727.84 8536,-9717.84 8532.5,-9727.84 8539.5,-9727.84"/>
</g>
<!-- expert7_linear2_15 -->
<g id="node136" class="node">
<title>expert7_linear2_15</title>
<polygon fill="lightcoral" stroke="black" points="8578,-9578.63 8440,-9578.63 8440,-9525.63 8578,-9525.63 8578,-9578.63"/>
<text text-anchor="middle" x="8509" y="-9563.43" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="8509" y="-9548.43" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8509" y="-9533.43" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert7_gelu_15&#45;&gt;expert7_linear2_15 -->
<g id="edge198" class="edge">
<title>expert7_gelu_15&#45;&gt;expert7_linear2_15</title>
<path fill="none" stroke="black" d="M8509,-9664.33C8509,-9664.33 8509,-9588.84 8509,-9588.84"/>
<polygon fill="black" stroke="black" points="8512.5,-9588.84 8509,-9578.84 8505.5,-9588.84 8512.5,-9588.84"/>
</g>
<!-- expert7_linear2_15&#45;&gt;expert7_agg -->
<g id="edge199" class="edge">
<title>expert7_linear2_15&#45;&gt;expert7_agg</title>
<path fill="none" stroke="black" d="M8509,-9525.54C8509,-9525.54 8509,-9449.9 8509,-9449.9"/>
<polygon fill="black" stroke="black" points="8512.5,-9449.9 8509,-9439.9 8505.5,-9449.9 8512.5,-9449.9"/>
</g>
<!-- expert7_agg&#45;&gt;expert_outputs -->
<g id="edge200" class="edge">
<title>expert7_agg&#45;&gt;expert_outputs</title>
<path fill="none" stroke="black" d="M8264.6,-9333.42C8264.6,-9268.71 8264.6,-9168 8264.6,-9168 8264.6,-9168 7047.27,-9168 7047.27,-9168"/>
<polygon fill="black" stroke="black" points="7047.27,-9164.5 7037.27,-9168 7047.27,-9171.5 7047.27,-9164.5"/>
</g>
<!-- weighted_sum -->
<g id="node139" class="node">
<title>weighted_sum</title>
<polygon fill="lightgreen" stroke="black" points="7193.39,-9055.63 6993.92,-9055.63 6942.61,-8949.63 7142.08,-8949.63 7193.39,-9055.63"/>
<text text-anchor="middle" x="7068" y="-9013.93" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="7068" y="-8998.93" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7068" y="-8983.93" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_outputs&#45;&gt;weighted_sum -->
<g id="edge201" class="edge">
<title>expert_outputs&#45;&gt;weighted_sum</title>
<path fill="none" stroke="black" d="M7024.82,-9153.91C7024.82,-9153.91 7024.82,-9065.7 7024.82,-9065.7"/>
<polygon fill="black" stroke="black" points="7028.32,-9065.7 7024.82,-9055.7 7021.32,-9065.7 7028.32,-9065.7"/>
</g>
<!-- weighted_sum&#45;&gt;residual2 -->
<g id="edge202" class="edge">
<title>weighted_sum&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M7157.33,-8980.99C7157.33,-8980.99 7157.33,-8867.81 7157.33,-8867.81"/>
<polygon fill="black" stroke="black" points="7160.83,-8867.81 7157.33,-8857.81 7153.83,-8867.82 7160.83,-8867.81"/>
</g>
<!-- ln2_0 -->
<g id="node141" class="node">
<title>ln2_0</title>
<polygon fill="lightblue" stroke="black" points="9421,-8702.67 9323,-8702.67 9323,-8649.67 9421,-8649.67 9421,-8702.67"/>
<text text-anchor="middle" x="9372" y="-8687.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9372" y="-8672.47" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9372" y="-8657.47" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- residual2&#45;&gt;ln2_0 -->
<g id="edge204" class="edge">
<title>residual2&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M7262.39,-8804.41C7262.39,-8767.85 7262.39,-8698 7262.39,-8698 7262.39,-8698 9312.96,-8698 9312.96,-8698"/>
<polygon fill="black" stroke="black" points="9312.96,-8701.5 9322.96,-8698 9312.96,-8694.5 9312.96,-8701.5"/>
</g>
<!-- ln2_1 -->
<g id="node142" class="node">
<title>ln2_1</title>
<polygon fill="lightblue" stroke="black" points="7248,-8702.67 7150,-8702.67 7150,-8649.67 7248,-8649.67 7248,-8702.67"/>
<text text-anchor="middle" x="7199" y="-8687.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7199" y="-8672.47" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7199" y="-8657.47" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- residual2&#45;&gt;ln2_1 -->
<g id="edge234" class="edge">
<title>residual2&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M7199,-8788.3C7199,-8788.3 7199,-8713.13 7199,-8713.13"/>
<polygon fill="black" stroke="black" points="7202.5,-8713.13 7199,-8703.13 7195.5,-8713.13 7202.5,-8713.13"/>
</g>
<!-- ln2_2 -->
<g id="node143" class="node">
<title>ln2_2</title>
<polygon fill="lightblue" stroke="black" points="5074,-8702.67 4976,-8702.67 4976,-8649.67 5074,-8649.67 5074,-8702.67"/>
<text text-anchor="middle" x="5025" y="-8687.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5025" y="-8672.47" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5025" y="-8657.47" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- residual2&#45;&gt;ln2_2 -->
<g id="edge264" class="edge">
<title>residual2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M7135.61,-8804.41C7135.61,-8767.85 7135.61,-8698 7135.61,-8698 7135.61,-8698 5084.06,-8698 5084.06,-8698"/>
<polygon fill="black" stroke="black" points="5084.06,-8694.5 5074.06,-8698 5084.06,-8701.5 5084.06,-8694.5"/>
</g>
<!-- ln2_3 -->
<g id="node144" class="node">
<title>ln2_3</title>
<polygon fill="lightblue" stroke="black" points="2806,-8702.67 2708,-8702.67 2708,-8649.67 2806,-8649.67 2806,-8702.67"/>
<text text-anchor="middle" x="2757" y="-8687.47" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2757" y="-8672.47" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="2757" y="-8657.47" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- residual2&#45;&gt;ln2_3 -->
<g id="edge294" class="edge">
<title>residual2&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M7120.96,-8826C6528.05,-8826 2757,-8826 2757,-8826 2757,-8826 2757,-8712.96 2757,-8712.96"/>
<polygon fill="black" stroke="black" points="2760.5,-8712.96 2757,-8702.96 2753.5,-8712.96 2760.5,-8712.96"/>
</g>
<!-- residual2_1 -->
<g id="node215" class="node">
<title>residual2_1</title>
<ellipse fill="yellow" stroke="black" cx="7191" cy="-7725.2" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7191" y="-7736.5" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7191" y="-7721.5" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7191" y="-7706.5" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2&#45;&gt;residual2_1 -->
<g id="edge326" class="edge">
<title>residual2&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M7272.02,-8813C7378.02,-8813 7562,-8813 7562,-8813 7562,-8813 7562,-7725 7562,-7725 7562,-7725 7279.23,-7725 7279.23,-7725"/>
<polygon fill="black" stroke="black" points="7279.23,-7721.5 7269.23,-7725 7279.23,-7728.5 7279.23,-7721.5"/>
</g>
<!-- q_proj_2_0_0 -->
<g id="node145" class="node">
<title>q_proj_2_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8492.5,-8563.67 8361.5,-8563.67 8361.5,-8510.67 8492.5,-8510.67 8492.5,-8563.67"/>
<text text-anchor="middle" x="8427" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8427" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8427" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_0&#45;&gt;q_proj_2_0_0 -->
<g id="edge205" class="edge">
<title>ln2_0&#45;&gt;q_proj_2_0_0</title>
<path fill="none" stroke="black" d="M9322.85,-8689C9128.88,-8689 8427,-8689 8427,-8689 8427,-8689 8427,-8573.97 8427,-8573.97"/>
<polygon fill="black" stroke="black" points="8430.5,-8573.97 8427,-8563.97 8423.5,-8573.97 8430.5,-8573.97"/>
</g>
<!-- k_proj_2_0_0 -->
<g id="node146" class="node">
<title>k_proj_2_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8681.5,-8563.67 8550.5,-8563.67 8550.5,-8510.67 8681.5,-8510.67 8681.5,-8563.67"/>
<text text-anchor="middle" x="8616" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8616" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8616" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_0&#45;&gt;k_proj_2_0_0 -->
<g id="edge206" class="edge">
<title>ln2_0&#45;&gt;k_proj_2_0_0</title>
<path fill="none" stroke="black" d="M9322.98,-8680C9155.45,-8680 8616,-8680 8616,-8680 8616,-8680 8616,-8573.7 8616,-8573.7"/>
<polygon fill="black" stroke="black" points="8619.5,-8573.7 8616,-8563.7 8612.5,-8573.7 8619.5,-8573.7"/>
</g>
<!-- v_proj_2_0_0 -->
<g id="node147" class="node">
<title>v_proj_2_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8870.5,-8563.67 8739.5,-8563.67 8739.5,-8510.67 8870.5,-8510.67 8870.5,-8563.67"/>
<text text-anchor="middle" x="8805" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8805" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8805" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_0&#45;&gt;v_proj_2_0_0 -->
<g id="edge207" class="edge">
<title>ln2_0&#45;&gt;v_proj_2_0_0</title>
<path fill="none" stroke="black" d="M9322.67,-8671C9184.73,-8671 8805,-8671 8805,-8671 8805,-8671 8805,-8573.93 8805,-8573.93"/>
<polygon fill="black" stroke="black" points="8808.5,-8573.93 8805,-8563.93 8801.5,-8573.93 8808.5,-8573.93"/>
</g>
<!-- q_proj_2_0_1 -->
<g id="node149" class="node">
<title>q_proj_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9059.5,-8563.67 8928.5,-8563.67 8928.5,-8510.67 9059.5,-8510.67 9059.5,-8563.67"/>
<text text-anchor="middle" x="8994" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8994" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8994" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_0&#45;&gt;q_proj_2_0_1 -->
<g id="edge212" class="edge">
<title>ln2_0&#45;&gt;q_proj_2_0_1</title>
<path fill="none" stroke="black" d="M9322.68,-8662C9230.24,-8662 9040.17,-8662 9040.17,-8662 9040.17,-8662 9040.17,-8573.95 9040.17,-8573.95"/>
<polygon fill="black" stroke="black" points="9043.67,-8573.95 9040.17,-8563.95 9036.67,-8573.95 9043.67,-8573.95"/>
</g>
<!-- k_proj_2_0_1 -->
<g id="node150" class="node">
<title>k_proj_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9248.5,-8563.67 9117.5,-8563.67 9117.5,-8510.67 9248.5,-8510.67 9248.5,-8563.67"/>
<text text-anchor="middle" x="9183" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9183" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9183" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_0&#45;&gt;k_proj_2_0_1 -->
<g id="edge213" class="edge">
<title>ln2_0&#45;&gt;k_proj_2_0_1</title>
<path fill="none" stroke="black" d="M9322.8,-8654C9273.54,-8654 9205,-8654 9205,-8654 9205,-8654 9205,-8573.68 9205,-8573.68"/>
<polygon fill="black" stroke="black" points="9208.5,-8573.68 9205,-8563.68 9201.5,-8573.68 9208.5,-8573.68"/>
</g>
<!-- v_proj_2_0_1 -->
<g id="node151" class="node">
<title>v_proj_2_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9437.5,-8563.67 9306.5,-8563.67 9306.5,-8510.67 9437.5,-8510.67 9437.5,-8563.67"/>
<text text-anchor="middle" x="9372" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9372" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9372" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_0&#45;&gt;v_proj_2_0_1 -->
<g id="edge214" class="edge">
<title>ln2_0&#45;&gt;v_proj_2_0_1</title>
<path fill="none" stroke="black" d="M9372,-8649.37C9372,-8649.37 9372,-8573.89 9372,-8573.89"/>
<polygon fill="black" stroke="black" points="9375.5,-8573.89 9372,-8563.89 9368.5,-8573.89 9375.5,-8573.89"/>
</g>
<!-- q_proj_2_0_2 -->
<g id="node153" class="node">
<title>q_proj_2_0_2</title>
<polygon fill="lightcoral" stroke="black" points="9626.5,-8563.67 9495.5,-8563.67 9495.5,-8510.67 9626.5,-8510.67 9626.5,-8563.67"/>
<text text-anchor="middle" x="9561" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9561" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9561" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_0&#45;&gt;q_proj_2_0_2 -->
<g id="edge219" class="edge">
<title>ln2_0&#45;&gt;q_proj_2_0_2</title>
<path fill="none" stroke="black" d="M9421.16,-8657C9477.16,-8657 9561,-8657 9561,-8657 9561,-8657 9561,-8573.77 9561,-8573.77"/>
<polygon fill="black" stroke="black" points="9564.5,-8573.77 9561,-8563.77 9557.5,-8573.77 9564.5,-8573.77"/>
</g>
<!-- k_proj_2_0_2 -->
<g id="node154" class="node">
<title>k_proj_2_0_2</title>
<polygon fill="lightcoral" stroke="black" points="9815.5,-8563.67 9684.5,-8563.67 9684.5,-8510.67 9815.5,-8510.67 9815.5,-8563.67"/>
<text text-anchor="middle" x="9750" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9750" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9750" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_0&#45;&gt;k_proj_2_0_2 -->
<g id="edge220" class="edge">
<title>ln2_0&#45;&gt;k_proj_2_0_2</title>
<path fill="none" stroke="black" d="M9421.03,-8664C9523.31,-8664 9750,-8664 9750,-8664 9750,-8664 9750,-8573.76 9750,-8573.76"/>
<polygon fill="black" stroke="black" points="9753.5,-8573.76 9750,-8563.76 9746.5,-8573.76 9753.5,-8573.76"/>
</g>
<!-- v_proj_2_0_2 -->
<g id="node155" class="node">
<title>v_proj_2_0_2</title>
<polygon fill="lightcoral" stroke="black" points="10004.5,-8563.67 9873.5,-8563.67 9873.5,-8510.67 10004.5,-8510.67 10004.5,-8563.67"/>
<text text-anchor="middle" x="9939" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9939" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9939" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_0&#45;&gt;v_proj_2_0_2 -->
<g id="edge221" class="edge">
<title>ln2_0&#45;&gt;v_proj_2_0_2</title>
<path fill="none" stroke="black" d="M9421.33,-8672C9559.27,-8672 9939,-8672 9939,-8672 9939,-8672 9939,-8573.81 9939,-8573.81"/>
<polygon fill="black" stroke="black" points="9942.5,-8573.81 9939,-8563.81 9935.5,-8573.81 9942.5,-8573.81"/>
</g>
<!-- q_proj_2_0_3 -->
<g id="node157" class="node">
<title>q_proj_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10193.5,-8563.67 10062.5,-8563.67 10062.5,-8510.67 10193.5,-8510.67 10193.5,-8563.67"/>
<text text-anchor="middle" x="10128" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10128" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10128" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_0&#45;&gt;q_proj_2_0_3 -->
<g id="edge226" class="edge">
<title>ln2_0&#45;&gt;q_proj_2_0_3</title>
<path fill="none" stroke="black" d="M9421.02,-8679C9588.55,-8679 10128,-8679 10128,-8679 10128,-8679 10128,-8573.85 10128,-8573.85"/>
<polygon fill="black" stroke="black" points="10131.5,-8573.85 10128,-8563.85 10124.5,-8573.85 10131.5,-8573.85"/>
</g>
<!-- k_proj_2_0_3 -->
<g id="node158" class="node">
<title>k_proj_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10382.5,-8563.67 10251.5,-8563.67 10251.5,-8510.67 10382.5,-8510.67 10382.5,-8563.67"/>
<text text-anchor="middle" x="10317" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10317" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10317" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_0&#45;&gt;k_proj_2_0_3 -->
<g id="edge227" class="edge">
<title>ln2_0&#45;&gt;k_proj_2_0_3</title>
<path fill="none" stroke="black" d="M9421.15,-8687C9615.12,-8687 10317,-8687 10317,-8687 10317,-8687 10317,-8573.96 10317,-8573.96"/>
<polygon fill="black" stroke="black" points="10320.5,-8573.96 10317,-8563.96 10313.5,-8573.96 10320.5,-8573.96"/>
</g>
<!-- v_proj_2_0_3 -->
<g id="node159" class="node">
<title>v_proj_2_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10571.5,-8563.67 10440.5,-8563.67 10440.5,-8510.67 10571.5,-8510.67 10571.5,-8563.67"/>
<text text-anchor="middle" x="10506" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10506" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10506" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_0&#45;&gt;v_proj_2_0_3 -->
<g id="edge228" class="edge">
<title>ln2_0&#45;&gt;v_proj_2_0_3</title>
<path fill="none" stroke="black" d="M9421.09,-8695C9638.75,-8695 10506,-8695 10506,-8695 10506,-8695 10506,-8573.95 10506,-8573.95"/>
<polygon fill="black" stroke="black" points="10509.5,-8573.95 10506,-8563.95 10502.5,-8573.95 10509.5,-8573.95"/>
</g>
<!-- q_proj_2_1_0 -->
<g id="node161" class="node">
<title>q_proj_2_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6224.5,-8563.67 6093.5,-8563.67 6093.5,-8510.67 6224.5,-8510.67 6224.5,-8563.67"/>
<text text-anchor="middle" x="6159" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6159" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6159" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_0 -->
<g id="edge235" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_0</title>
<path fill="none" stroke="black" d="M7149.77,-8693C6944.97,-8693 6171.1,-8693 6171.1,-8693 6171.1,-8693 6171.1,-8573.96 6171.1,-8573.96"/>
<polygon fill="black" stroke="black" points="6174.6,-8573.96 6171.1,-8563.96 6167.6,-8573.96 6174.6,-8573.96"/>
</g>
<!-- k_proj_2_1_0 -->
<g id="node162" class="node">
<title>k_proj_2_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6413.5,-8563.67 6282.5,-8563.67 6282.5,-8510.67 6413.5,-8510.67 6413.5,-8563.67"/>
<text text-anchor="middle" x="6348" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6348" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6348" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_0 -->
<g id="edge236" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_0</title>
<path fill="none" stroke="black" d="M7149.88,-8685C6968.65,-8685 6348,-8685 6348,-8685 6348,-8685 6348,-8573.94 6348,-8573.94"/>
<polygon fill="black" stroke="black" points="6351.5,-8573.94 6348,-8563.94 6344.5,-8573.94 6351.5,-8573.94"/>
</g>
<!-- v_proj_2_1_0 -->
<g id="node163" class="node">
<title>v_proj_2_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6602.5,-8563.67 6471.5,-8563.67 6471.5,-8510.67 6602.5,-8510.67 6602.5,-8563.67"/>
<text text-anchor="middle" x="6537" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6537" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6537" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_0 -->
<g id="edge237" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_0</title>
<path fill="none" stroke="black" d="M7149.78,-8676C7005.61,-8676 6594.4,-8676 6594.4,-8676 6594.4,-8676 6594.4,-8573.94 6594.4,-8573.94"/>
<polygon fill="black" stroke="black" points="6597.9,-8573.94 6594.4,-8563.94 6590.9,-8573.94 6597.9,-8573.94"/>
</g>
<!-- q_proj_2_1_1 -->
<g id="node165" class="node">
<title>q_proj_2_1_1</title>
<polygon fill="lightcoral" stroke="black" points="6791.5,-8563.67 6660.5,-8563.67 6660.5,-8510.67 6791.5,-8510.67 6791.5,-8563.67"/>
<text text-anchor="middle" x="6726" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6726" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6726" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_1 -->
<g id="edge242" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_1</title>
<path fill="none" stroke="black" d="M7149.72,-8667C7028.57,-8667 6726,-8667 6726,-8667 6726,-8667 6726,-8573.76 6726,-8573.76"/>
<polygon fill="black" stroke="black" points="6729.5,-8573.76 6726,-8563.76 6722.5,-8573.76 6729.5,-8573.76"/>
</g>
<!-- k_proj_2_1_1 -->
<g id="node166" class="node">
<title>k_proj_2_1_1</title>
<polygon fill="lightcoral" stroke="black" points="6980.5,-8563.67 6849.5,-8563.67 6849.5,-8510.67 6980.5,-8510.67 6980.5,-8563.67"/>
<text text-anchor="middle" x="6915" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6915" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6915" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_1 -->
<g id="edge243" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_1</title>
<path fill="none" stroke="black" d="M7149.8,-8658C7080.24,-8658 6961.53,-8658 6961.53,-8658 6961.53,-8658 6961.53,-8573.69 6961.53,-8573.69"/>
<polygon fill="black" stroke="black" points="6965.03,-8573.69 6961.53,-8563.69 6958.03,-8573.69 6965.03,-8573.69"/>
</g>
<!-- v_proj_2_1_1 -->
<g id="node167" class="node">
<title>v_proj_2_1_1</title>
<polygon fill="lightcoral" stroke="black" points="7169.5,-8563.67 7038.5,-8563.67 7038.5,-8510.67 7169.5,-8510.67 7169.5,-8563.67"/>
<text text-anchor="middle" x="7104" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7104" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7104" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_1 -->
<g id="edge244" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_1</title>
<path fill="none" stroke="black" d="M7159.75,-8649.37C7159.75,-8649.37 7159.75,-8573.89 7159.75,-8573.89"/>
<polygon fill="black" stroke="black" points="7163.25,-8573.89 7159.75,-8563.89 7156.25,-8573.89 7163.25,-8573.89"/>
</g>
<!-- q_proj_2_1_2 -->
<g id="node169" class="node">
<title>q_proj_2_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7358.5,-8563.67 7227.5,-8563.67 7227.5,-8510.67 7358.5,-8510.67 7358.5,-8563.67"/>
<text text-anchor="middle" x="7293" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7293" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7293" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_2 -->
<g id="edge249" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_2</title>
<path fill="none" stroke="black" d="M7237.75,-8649.37C7237.75,-8649.37 7237.75,-8573.89 7237.75,-8573.89"/>
<polygon fill="black" stroke="black" points="7241.25,-8573.89 7237.75,-8563.89 7234.25,-8573.89 7241.25,-8573.89"/>
</g>
<!-- k_proj_2_1_2 -->
<g id="node170" class="node">
<title>k_proj_2_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7547.5,-8563.67 7416.5,-8563.67 7416.5,-8510.67 7547.5,-8510.67 7547.5,-8563.67"/>
<text text-anchor="middle" x="7482" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7482" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7482" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_2 -->
<g id="edge250" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_2</title>
<path fill="none" stroke="black" d="M7248.29,-8658C7329.38,-8658 7482,-8658 7482,-8658 7482,-8658 7482,-8573.69 7482,-8573.69"/>
<polygon fill="black" stroke="black" points="7485.5,-8573.69 7482,-8563.69 7478.5,-8573.69 7485.5,-8573.69"/>
</g>
<!-- v_proj_2_1_2 -->
<g id="node171" class="node">
<title>v_proj_2_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7736.5,-8563.67 7605.5,-8563.67 7605.5,-8510.67 7736.5,-8510.67 7736.5,-8563.67"/>
<text text-anchor="middle" x="7671" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7671" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7671" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_2 -->
<g id="edge251" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_2</title>
<path fill="none" stroke="black" d="M7248.04,-8667C7359.63,-8667 7622.9,-8667 7622.9,-8667 7622.9,-8667 7622.9,-8573.76 7622.9,-8573.76"/>
<polygon fill="black" stroke="black" points="7626.4,-8573.76 7622.9,-8563.76 7619.4,-8573.76 7626.4,-8573.76"/>
</g>
<!-- q_proj_2_1_3 -->
<g id="node173" class="node">
<title>q_proj_2_1_3</title>
<polygon fill="lightcoral" stroke="black" points="7925.5,-8563.67 7794.5,-8563.67 7794.5,-8510.67 7925.5,-8510.67 7925.5,-8563.67"/>
<text text-anchor="middle" x="7860" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7860" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7860" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_3 -->
<g id="edge256" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_3</title>
<path fill="none" stroke="black" d="M7248.14,-8676C7401.33,-8676 7860,-8676 7860,-8676 7860,-8676 7860,-8573.94 7860,-8573.94"/>
<polygon fill="black" stroke="black" points="7863.5,-8573.94 7860,-8563.94 7856.5,-8573.94 7863.5,-8573.94"/>
</g>
<!-- k_proj_2_1_3 -->
<g id="node174" class="node">
<title>k_proj_2_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8114.5,-8563.67 7983.5,-8563.67 7983.5,-8510.67 8114.5,-8510.67 8114.5,-8563.67"/>
<text text-anchor="middle" x="8049" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8049" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8049" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_3 -->
<g id="edge257" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_3</title>
<path fill="none" stroke="black" d="M7248.06,-8685C7429.08,-8685 8049,-8685 8049,-8685 8049,-8685 8049,-8573.94 8049,-8573.94"/>
<polygon fill="black" stroke="black" points="8052.5,-8573.94 8049,-8563.94 8045.5,-8573.94 8052.5,-8573.94"/>
</g>
<!-- v_proj_2_1_3 -->
<g id="node175" class="node">
<title>v_proj_2_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8303.5,-8563.67 8172.5,-8563.67 8172.5,-8510.67 8303.5,-8510.67 8303.5,-8563.67"/>
<text text-anchor="middle" x="8238" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8238" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8238" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_3 -->
<g id="edge258" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_3</title>
<path fill="none" stroke="black" d="M7248.14,-8693C7447.22,-8693 8183.17,-8693 8183.17,-8693 8183.17,-8693 8183.17,-8573.96 8183.17,-8573.96"/>
<polygon fill="black" stroke="black" points="8186.67,-8573.96 8183.17,-8563.96 8179.67,-8573.96 8186.67,-8573.96"/>
</g>
<!-- q_proj_2_2_0 -->
<g id="node177" class="node">
<title>q_proj_2_2_0</title>
<polygon fill="lightcoral" stroke="black" points="3956.5,-8563.67 3825.5,-8563.67 3825.5,-8510.67 3956.5,-8510.67 3956.5,-8563.67"/>
<text text-anchor="middle" x="3891" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3891" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3891" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_2&#45;&gt;q_proj_2_2_0 -->
<g id="edge265" class="edge">
<title>ln2_2&#45;&gt;q_proj_2_2_0</title>
<path fill="none" stroke="black" d="M4975.91,-8698C4758.25,-8698 3891,-8698 3891,-8698 3891,-8698 3891,-8573.73 3891,-8573.73"/>
<polygon fill="black" stroke="black" points="3894.5,-8573.73 3891,-8563.73 3887.5,-8573.73 3894.5,-8573.73"/>
</g>
<!-- k_proj_2_2_0 -->
<g id="node178" class="node">
<title>k_proj_2_2_0</title>
<polygon fill="lightcoral" stroke="black" points="4145.5,-8563.67 4014.5,-8563.67 4014.5,-8510.67 4145.5,-8510.67 4145.5,-8563.67"/>
<text text-anchor="middle" x="4080" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4080" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4080" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_2&#45;&gt;k_proj_2_2_0 -->
<g id="edge266" class="edge">
<title>ln2_2&#45;&gt;k_proj_2_2_0</title>
<path fill="none" stroke="black" d="M4975.98,-8689C4788.99,-8689 4131,-8689 4131,-8689 4131,-8689 4131,-8573.97 4131,-8573.97"/>
<polygon fill="black" stroke="black" points="4134.5,-8573.97 4131,-8563.97 4127.5,-8573.97 4134.5,-8573.97"/>
</g>
<!-- v_proj_2_2_0 -->
<g id="node179" class="node">
<title>v_proj_2_2_0</title>
<polygon fill="lightcoral" stroke="black" points="4334.5,-8563.67 4203.5,-8563.67 4203.5,-8510.67 4334.5,-8510.67 4334.5,-8563.67"/>
<text text-anchor="middle" x="4269" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4269" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4269" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_2&#45;&gt;v_proj_2_2_0 -->
<g id="edge267" class="edge">
<title>ln2_2&#45;&gt;v_proj_2_2_0</title>
<path fill="none" stroke="black" d="M4975.98,-8680C4808.45,-8680 4269,-8680 4269,-8680 4269,-8680 4269,-8573.7 4269,-8573.7"/>
<polygon fill="black" stroke="black" points="4272.5,-8573.7 4269,-8563.7 4265.5,-8573.7 4272.5,-8573.7"/>
</g>
<!-- q_proj_2_2_1 -->
<g id="node181" class="node">
<title>q_proj_2_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4523.5,-8563.67 4392.5,-8563.67 4392.5,-8510.67 4523.5,-8510.67 4523.5,-8563.67"/>
<text text-anchor="middle" x="4458" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4458" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4458" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_2&#45;&gt;q_proj_2_2_1 -->
<g id="edge272" class="edge">
<title>ln2_2&#45;&gt;q_proj_2_2_1</title>
<path fill="none" stroke="black" d="M4975.53,-8671C4845.52,-8671 4504.17,-8671 4504.17,-8671 4504.17,-8671 4504.17,-8573.93 4504.17,-8573.93"/>
<polygon fill="black" stroke="black" points="4507.67,-8573.93 4504.17,-8563.93 4500.67,-8573.93 4507.67,-8573.93"/>
</g>
<!-- k_proj_2_2_1 -->
<g id="node182" class="node">
<title>k_proj_2_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4712.5,-8563.67 4581.5,-8563.67 4581.5,-8510.67 4712.5,-8510.67 4712.5,-8563.67"/>
<text text-anchor="middle" x="4647" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4647" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4647" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_2&#45;&gt;k_proj_2_2_1 -->
<g id="edge273" class="edge">
<title>ln2_2&#45;&gt;k_proj_2_2_1</title>
<path fill="none" stroke="black" d="M4975.97,-8662C4873.69,-8662 4647,-8662 4647,-8662 4647,-8662 4647,-8573.95 4647,-8573.95"/>
<polygon fill="black" stroke="black" points="4650.5,-8573.95 4647,-8563.95 4643.5,-8573.95 4650.5,-8573.95"/>
</g>
<!-- v_proj_2_2_1 -->
<g id="node183" class="node">
<title>v_proj_2_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4901.5,-8563.67 4770.5,-8563.67 4770.5,-8510.67 4901.5,-8510.67 4901.5,-8563.67"/>
<text text-anchor="middle" x="4836" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4836" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4836" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_2&#45;&gt;v_proj_2_2_1 -->
<g id="edge274" class="edge">
<title>ln2_2&#45;&gt;v_proj_2_2_1</title>
<path fill="none" stroke="black" d="M4975.84,-8654C4919.84,-8654 4836,-8654 4836,-8654 4836,-8654 4836,-8573.68 4836,-8573.68"/>
<polygon fill="black" stroke="black" points="4839.5,-8573.68 4836,-8563.68 4832.5,-8573.68 4839.5,-8573.68"/>
</g>
<!-- q_proj_2_2_2 -->
<g id="node185" class="node">
<title>q_proj_2_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5090.5,-8563.67 4959.5,-8563.67 4959.5,-8510.67 5090.5,-8510.67 5090.5,-8563.67"/>
<text text-anchor="middle" x="5025" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5025" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5025" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_2&#45;&gt;q_proj_2_2_2 -->
<g id="edge279" class="edge">
<title>ln2_2&#45;&gt;q_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5025,-8649.37C5025,-8649.37 5025,-8573.89 5025,-8573.89"/>
<polygon fill="black" stroke="black" points="5028.5,-8573.89 5025,-8563.89 5021.5,-8573.89 5028.5,-8573.89"/>
</g>
<!-- k_proj_2_2_2 -->
<g id="node186" class="node">
<title>k_proj_2_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5279.5,-8563.67 5148.5,-8563.67 5148.5,-8510.67 5279.5,-8510.67 5279.5,-8563.67"/>
<text text-anchor="middle" x="5214" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5214" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5214" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_2&#45;&gt;k_proj_2_2_2 -->
<g id="edge280" class="edge">
<title>ln2_2&#45;&gt;k_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5074.16,-8654C5130.16,-8654 5214,-8654 5214,-8654 5214,-8654 5214,-8573.68 5214,-8573.68"/>
<polygon fill="black" stroke="black" points="5217.5,-8573.68 5214,-8563.68 5210.5,-8573.68 5217.5,-8573.68"/>
</g>
<!-- v_proj_2_2_2 -->
<g id="node187" class="node">
<title>v_proj_2_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5468.5,-8563.67 5337.5,-8563.67 5337.5,-8510.67 5468.5,-8510.67 5468.5,-8563.67"/>
<text text-anchor="middle" x="5403" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5403" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5403" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_2&#45;&gt;v_proj_2_2_2 -->
<g id="edge281" class="edge">
<title>ln2_2&#45;&gt;v_proj_2_2_2</title>
<path fill="none" stroke="black" d="M5074.03,-8662C5176.31,-8662 5403,-8662 5403,-8662 5403,-8662 5403,-8573.95 5403,-8573.95"/>
<polygon fill="black" stroke="black" points="5406.5,-8573.95 5403,-8563.95 5399.5,-8573.95 5406.5,-8573.95"/>
</g>
<!-- q_proj_2_2_3 -->
<g id="node189" class="node">
<title>q_proj_2_2_3</title>
<polygon fill="lightcoral" stroke="black" points="5657.5,-8563.67 5526.5,-8563.67 5526.5,-8510.67 5657.5,-8510.67 5657.5,-8563.67"/>
<text text-anchor="middle" x="5592" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5592" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5592" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_2&#45;&gt;q_proj_2_2_3 -->
<g id="edge286" class="edge">
<title>ln2_2&#45;&gt;q_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5074.35,-8671C5205.84,-8671 5554.65,-8671 5554.65,-8671 5554.65,-8671 5554.65,-8573.93 5554.65,-8573.93"/>
<polygon fill="black" stroke="black" points="5558.15,-8573.93 5554.65,-8563.93 5551.15,-8573.93 5558.15,-8573.93"/>
</g>
<!-- k_proj_2_2_3 -->
<g id="node190" class="node">
<title>k_proj_2_2_3</title>
<polygon fill="lightcoral" stroke="black" points="5846.5,-8563.67 5715.5,-8563.67 5715.5,-8510.67 5846.5,-8510.67 5846.5,-8563.67"/>
<text text-anchor="middle" x="5781" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5781" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5781" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_2&#45;&gt;k_proj_2_2_3 -->
<g id="edge287" class="edge">
<title>ln2_2&#45;&gt;k_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5074.02,-8680C5241.55,-8680 5781,-8680 5781,-8680 5781,-8680 5781,-8573.7 5781,-8573.7"/>
<polygon fill="black" stroke="black" points="5784.5,-8573.7 5781,-8563.7 5777.5,-8573.7 5784.5,-8573.7"/>
</g>
<!-- v_proj_2_2_3 -->
<g id="node191" class="node">
<title>v_proj_2_2_3</title>
<polygon fill="lightcoral" stroke="black" points="6035.5,-8563.67 5904.5,-8563.67 5904.5,-8510.67 6035.5,-8510.67 6035.5,-8563.67"/>
<text text-anchor="middle" x="5970" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5970" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5970" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_2&#45;&gt;v_proj_2_2_3 -->
<g id="edge288" class="edge">
<title>ln2_2&#45;&gt;v_proj_2_2_3</title>
<path fill="none" stroke="black" d="M5074.15,-8689C5268.12,-8689 5970,-8689 5970,-8689 5970,-8689 5970,-8573.97 5970,-8573.97"/>
<polygon fill="black" stroke="black" points="5973.5,-8573.97 5970,-8563.97 5966.5,-8573.97 5973.5,-8573.97"/>
</g>
<!-- q_proj_2_3_0 -->
<g id="node193" class="node">
<title>q_proj_2_3_0</title>
<polygon fill="lightcoral" stroke="black" points="1688.5,-8563.67 1557.5,-8563.67 1557.5,-8510.67 1688.5,-8510.67 1688.5,-8563.67"/>
<text text-anchor="middle" x="1623" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1623" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1623" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_3&#45;&gt;q_proj_2_3_0 -->
<g id="edge295" class="edge">
<title>ln2_3&#45;&gt;q_proj_2_3_0</title>
<path fill="none" stroke="black" d="M2707.91,-8695C2490.25,-8695 1623,-8695 1623,-8695 1623,-8695 1623,-8573.95 1623,-8573.95"/>
<polygon fill="black" stroke="black" points="1626.5,-8573.95 1623,-8563.95 1619.5,-8573.95 1626.5,-8573.95"/>
</g>
<!-- k_proj_2_3_0 -->
<g id="node194" class="node">
<title>k_proj_2_3_0</title>
<polygon fill="lightcoral" stroke="black" points="1877.5,-8563.67 1746.5,-8563.67 1746.5,-8510.67 1877.5,-8510.67 1877.5,-8563.67"/>
<text text-anchor="middle" x="1812" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1812" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1812" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_3&#45;&gt;k_proj_2_3_0 -->
<g id="edge296" class="edge">
<title>ln2_3&#45;&gt;k_proj_2_3_0</title>
<path fill="none" stroke="black" d="M2707.98,-8687C2520.99,-8687 1863,-8687 1863,-8687 1863,-8687 1863,-8573.96 1863,-8573.96"/>
<polygon fill="black" stroke="black" points="1866.5,-8573.96 1863,-8563.96 1859.5,-8573.96 1866.5,-8573.96"/>
</g>
<!-- v_proj_2_3_0 -->
<g id="node195" class="node">
<title>v_proj_2_3_0</title>
<polygon fill="lightcoral" stroke="black" points="2066.5,-8563.67 1935.5,-8563.67 1935.5,-8510.67 2066.5,-8510.67 2066.5,-8563.67"/>
<text text-anchor="middle" x="2001" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2001" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2001" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_3&#45;&gt;v_proj_2_3_0 -->
<g id="edge297" class="edge">
<title>ln2_3&#45;&gt;v_proj_2_3_0</title>
<path fill="none" stroke="black" d="M2707.98,-8679C2540.45,-8679 2001,-8679 2001,-8679 2001,-8679 2001,-8573.85 2001,-8573.85"/>
<polygon fill="black" stroke="black" points="2004.5,-8573.85 2001,-8563.85 1997.5,-8573.85 2004.5,-8573.85"/>
</g>
<!-- q_proj_2_3_1 -->
<g id="node197" class="node">
<title>q_proj_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2255.5,-8563.67 2124.5,-8563.67 2124.5,-8510.67 2255.5,-8510.67 2255.5,-8563.67"/>
<text text-anchor="middle" x="2190" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2190" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2190" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_3&#45;&gt;q_proj_2_3_1 -->
<g id="edge302" class="edge">
<title>ln2_3&#45;&gt;q_proj_2_3_1</title>
<path fill="none" stroke="black" d="M2707.53,-8672C2577.52,-8672 2236.17,-8672 2236.17,-8672 2236.17,-8672 2236.17,-8573.81 2236.17,-8573.81"/>
<polygon fill="black" stroke="black" points="2239.67,-8573.81 2236.17,-8563.81 2232.67,-8573.81 2239.67,-8573.81"/>
</g>
<!-- k_proj_2_3_1 -->
<g id="node198" class="node">
<title>k_proj_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2444.5,-8563.67 2313.5,-8563.67 2313.5,-8510.67 2444.5,-8510.67 2444.5,-8563.67"/>
<text text-anchor="middle" x="2379" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2379" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2379" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_3&#45;&gt;k_proj_2_3_1 -->
<g id="edge303" class="edge">
<title>ln2_3&#45;&gt;k_proj_2_3_1</title>
<path fill="none" stroke="black" d="M2707.69,-8664C2616.34,-8664 2430,-8664 2430,-8664 2430,-8664 2430,-8573.76 2430,-8573.76"/>
<polygon fill="black" stroke="black" points="2433.5,-8573.76 2430,-8563.76 2426.5,-8573.76 2433.5,-8573.76"/>
</g>
<!-- v_proj_2_3_1 -->
<g id="node199" class="node">
<title>v_proj_2_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2633.5,-8563.67 2502.5,-8563.67 2502.5,-8510.67 2633.5,-8510.67 2633.5,-8563.67"/>
<text text-anchor="middle" x="2568" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2568" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2568" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_3&#45;&gt;v_proj_2_3_1 -->
<g id="edge304" class="edge">
<title>ln2_3&#45;&gt;v_proj_2_3_1</title>
<path fill="none" stroke="black" d="M2707.96,-8657C2668.29,-8657 2619,-8657 2619,-8657 2619,-8657 2619,-8573.77 2619,-8573.77"/>
<polygon fill="black" stroke="black" points="2622.5,-8573.77 2619,-8563.77 2615.5,-8573.77 2622.5,-8573.77"/>
</g>
<!-- q_proj_2_3_2 -->
<g id="node201" class="node">
<title>q_proj_2_3_2</title>
<polygon fill="lightcoral" stroke="black" points="2822.5,-8563.67 2691.5,-8563.67 2691.5,-8510.67 2822.5,-8510.67 2822.5,-8563.67"/>
<text text-anchor="middle" x="2757" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2757" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2757" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_3&#45;&gt;q_proj_2_3_2 -->
<g id="edge309" class="edge">
<title>ln2_3&#45;&gt;q_proj_2_3_2</title>
<path fill="none" stroke="black" d="M2757,-8649.37C2757,-8649.37 2757,-8573.89 2757,-8573.89"/>
<polygon fill="black" stroke="black" points="2760.5,-8573.89 2757,-8563.89 2753.5,-8573.89 2760.5,-8573.89"/>
</g>
<!-- k_proj_2_3_2 -->
<g id="node202" class="node">
<title>k_proj_2_3_2</title>
<polygon fill="lightcoral" stroke="black" points="3011.5,-8563.67 2880.5,-8563.67 2880.5,-8510.67 3011.5,-8510.67 3011.5,-8563.67"/>
<text text-anchor="middle" x="2946" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2946" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2946" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_3&#45;&gt;k_proj_2_3_2 -->
<g id="edge310" class="edge">
<title>ln2_3&#45;&gt;k_proj_2_3_2</title>
<path fill="none" stroke="black" d="M2806.26,-8658C2848.47,-8658 2902.5,-8658 2902.5,-8658 2902.5,-8658 2902.5,-8573.69 2902.5,-8573.69"/>
<polygon fill="black" stroke="black" points="2906,-8573.69 2902.5,-8563.69 2899,-8573.69 2906,-8573.69"/>
</g>
<!-- v_proj_2_3_2 -->
<g id="node203" class="node">
<title>v_proj_2_3_2</title>
<polygon fill="lightcoral" stroke="black" points="3200.5,-8563.67 3069.5,-8563.67 3069.5,-8510.67 3200.5,-8510.67 3200.5,-8563.67"/>
<text text-anchor="middle" x="3135" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3135" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3135" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_3&#45;&gt;v_proj_2_3_2 -->
<g id="edge311" class="edge">
<title>ln2_3&#45;&gt;v_proj_2_3_2</title>
<path fill="none" stroke="black" d="M2806.33,-8667C2897.73,-8667 3084.17,-8667 3084.17,-8667 3084.17,-8667 3084.17,-8573.76 3084.17,-8573.76"/>
<polygon fill="black" stroke="black" points="3087.67,-8573.76 3084.17,-8563.76 3080.67,-8573.76 3087.67,-8573.76"/>
</g>
<!-- q_proj_2_3_3 -->
<g id="node205" class="node">
<title>q_proj_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3389.5,-8563.67 3258.5,-8563.67 3258.5,-8510.67 3389.5,-8510.67 3389.5,-8563.67"/>
<text text-anchor="middle" x="3324" y="-8548.47" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3324" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3324" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_3&#45;&gt;q_proj_2_3_3 -->
<g id="edge316" class="edge">
<title>ln2_3&#45;&gt;q_proj_2_3_3</title>
<path fill="none" stroke="black" d="M2806.33,-8676C2944.27,-8676 3324,-8676 3324,-8676 3324,-8676 3324,-8573.94 3324,-8573.94"/>
<polygon fill="black" stroke="black" points="3327.5,-8573.94 3324,-8563.94 3320.5,-8573.94 3327.5,-8573.94"/>
</g>
<!-- k_proj_2_3_3 -->
<g id="node206" class="node">
<title>k_proj_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3578.5,-8563.67 3447.5,-8563.67 3447.5,-8510.67 3578.5,-8510.67 3578.5,-8563.67"/>
<text text-anchor="middle" x="3513" y="-8548.47" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3513" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3513" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_3&#45;&gt;k_proj_2_3_3 -->
<g id="edge317" class="edge">
<title>ln2_3&#45;&gt;k_proj_2_3_3</title>
<path fill="none" stroke="black" d="M2806.25,-8685C2967.53,-8685 3469.5,-8685 3469.5,-8685 3469.5,-8685 3469.5,-8573.94 3469.5,-8573.94"/>
<polygon fill="black" stroke="black" points="3473,-8573.94 3469.5,-8563.94 3466,-8573.94 3473,-8573.94"/>
</g>
<!-- v_proj_2_3_3 -->
<g id="node207" class="node">
<title>v_proj_2_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3767.5,-8563.67 3636.5,-8563.67 3636.5,-8510.67 3767.5,-8510.67 3767.5,-8563.67"/>
<text text-anchor="middle" x="3702" y="-8548.47" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3702" y="-8533.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3702" y="-8518.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_3&#45;&gt;v_proj_2_3_3 -->
<g id="edge318" class="edge">
<title>ln2_3&#45;&gt;v_proj_2_3_3</title>
<path fill="none" stroke="black" d="M2806.15,-8693C3000.12,-8693 3702,-8693 3702,-8693 3702,-8693 3702,-8573.96 3702,-8573.96"/>
<polygon fill="black" stroke="black" points="3705.5,-8573.96 3702,-8563.96 3698.5,-8573.96 3705.5,-8573.96"/>
</g>
<!-- attn_2_0_0 -->
<g id="node148" class="node">
<title>attn_2_0_0</title>
<polygon fill="orange" stroke="black" points="8824,-8424.67 8598,-8424.67 8598,-8371.67 8824,-8371.67 8824,-8424.67"/>
<text text-anchor="middle" x="8711" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8711" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8711" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge208" class="edge">
<title>q_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M8478,-8510.34C8478,-8467.64 8478,-8389 8478,-8389 8478,-8389 8587.91,-8389 8587.91,-8389"/>
<polygon fill="black" stroke="black" points="8587.91,-8392.5 8597.91,-8389 8587.91,-8385.5 8587.91,-8392.5"/>
</g>
<!-- k_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge209" class="edge">
<title>k_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M8639.75,-8510.37C8639.75,-8510.37 8639.75,-8434.89 8639.75,-8434.89"/>
<polygon fill="black" stroke="black" points="8643.25,-8434.89 8639.75,-8424.89 8636.25,-8434.89 8643.25,-8434.89"/>
</g>
<!-- v_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge210" class="edge">
<title>v_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M8781.75,-8510.37C8781.75,-8510.37 8781.75,-8434.89 8781.75,-8434.89"/>
<polygon fill="black" stroke="black" points="8785.25,-8434.89 8781.75,-8424.89 8778.25,-8434.89 8785.25,-8434.89"/>
</g>
<!-- concat_dim_2_0 -->
<g id="node209" class="node">
<title>concat_dim_2_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9390.2,-8285.67 9060.59,-8285.67 8975.8,-8179.67 9305.41,-8179.67 9390.2,-8285.67"/>
<text text-anchor="middle" x="9183" y="-8243.97" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="9183" y="-8228.97" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="9183" y="-8213.97" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- attn_2_0_0&#45;&gt;concat_dim_2_0 -->
<g id="edge211" class="edge">
<title>attn_2_0_0&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M8824.29,-8398C8911.62,-8398 9017.57,-8398 9017.57,-8398 9017.57,-8398 9017.57,-8242.79 9017.57,-8242.79"/>
<polygon fill="black" stroke="black" points="9021.07,-8242.79 9017.57,-8232.79 9014.07,-8242.79 9021.07,-8242.79"/>
</g>
<!-- attn_2_0_1 -->
<g id="node152" class="node">
<title>attn_2_0_1</title>
<polygon fill="orange" stroke="black" points="9296,-8424.67 9070,-8424.67 9070,-8371.67 9296,-8371.67 9296,-8424.67"/>
<text text-anchor="middle" x="9183" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9183" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9183" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge215" class="edge">
<title>q_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M9059.7,-8537C9078.38,-8537 9093.75,-8537 9093.75,-8537 9093.75,-8537 9093.75,-8434.94 9093.75,-8434.94"/>
<polygon fill="black" stroke="black" points="9097.25,-8434.94 9093.75,-8424.94 9090.25,-8434.94 9097.25,-8434.94"/>
</g>
<!-- k_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge216" class="edge">
<title>k_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M9183,-8510.37C9183,-8510.37 9183,-8434.89 9183,-8434.89"/>
<polygon fill="black" stroke="black" points="9186.5,-8434.89 9183,-8424.89 9179.5,-8434.89 9186.5,-8434.89"/>
</g>
<!-- v_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge217" class="edge">
<title>v_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M9306.3,-8537C9287.62,-8537 9272.25,-8537 9272.25,-8537 9272.25,-8537 9272.25,-8434.94 9272.25,-8434.94"/>
<polygon fill="black" stroke="black" points="9275.75,-8434.94 9272.25,-8424.94 9268.75,-8434.94 9275.75,-8434.94"/>
</g>
<!-- attn_2_0_1&#45;&gt;concat_dim_2_0 -->
<g id="edge218" class="edge">
<title>attn_2_0_1&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M9183,-8371.58C9183,-8371.58 9183,-8295.94 9183,-8295.94"/>
<polygon fill="black" stroke="black" points="9186.5,-8295.94 9183,-8285.94 9179.5,-8295.94 9186.5,-8295.94"/>
</g>
<!-- attn_2_0_2 -->
<g id="node156" class="node">
<title>attn_2_0_2</title>
<polygon fill="orange" stroke="black" points="9769,-8424.67 9543,-8424.67 9543,-8371.67 9769,-8371.67 9769,-8424.67"/>
<text text-anchor="middle" x="9656" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9656" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9656" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge222" class="edge">
<title>q_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M9584.75,-8510.37C9584.75,-8510.37 9584.75,-8434.89 9584.75,-8434.89"/>
<polygon fill="black" stroke="black" points="9588.25,-8434.89 9584.75,-8424.89 9581.25,-8434.89 9588.25,-8434.89"/>
</g>
<!-- k_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge223" class="edge">
<title>k_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M9726.75,-8510.37C9726.75,-8510.37 9726.75,-8434.89 9726.75,-8434.89"/>
<polygon fill="black" stroke="black" points="9730.25,-8434.89 9726.75,-8424.89 9723.25,-8434.89 9730.25,-8434.89"/>
</g>
<!-- v_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge224" class="edge">
<title>v_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M9883,-8510.67C9883,-8470.29 9883,-8398 9883,-8398 9883,-8398 9779.17,-8398 9779.17,-8398"/>
<polygon fill="black" stroke="black" points="9779.17,-8394.5 9769.17,-8398 9779.17,-8401.5 9779.17,-8394.5"/>
</g>
<!-- attn_2_0_2&#45;&gt;concat_dim_2_0 -->
<g id="edge225" class="edge">
<title>attn_2_0_2&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M9557.75,-8371.34C9557.75,-8328.64 9557.75,-8250 9557.75,-8250 9557.75,-8250 9371.87,-8250 9371.87,-8250"/>
<polygon fill="black" stroke="black" points="9371.87,-8246.5 9361.87,-8250 9371.87,-8253.5 9371.87,-8246.5"/>
</g>
<!-- attn_2_0_3 -->
<g id="node160" class="node">
<title>attn_2_0_3</title>
<polygon fill="orange" stroke="black" points="10335,-8424.67 10109,-8424.67 10109,-8371.67 10335,-8371.67 10335,-8424.67"/>
<text text-anchor="middle" x="10222" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10222" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10222" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge229" class="edge">
<title>q_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M10151.25,-8510.37C10151.25,-8510.37 10151.25,-8434.89 10151.25,-8434.89"/>
<polygon fill="black" stroke="black" points="10154.75,-8434.89 10151.25,-8424.89 10147.75,-8434.89 10154.75,-8434.89"/>
</g>
<!-- k_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge230" class="edge">
<title>k_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M10293.25,-8510.37C10293.25,-8510.37 10293.25,-8434.89 10293.25,-8434.89"/>
<polygon fill="black" stroke="black" points="10296.75,-8434.89 10293.25,-8424.89 10289.75,-8434.89 10296.75,-8434.89"/>
</g>
<!-- v_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge231" class="edge">
<title>v_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M10450,-8510.67C10450,-8470.29 10450,-8398 10450,-8398 10450,-8398 10345.33,-8398 10345.33,-8398"/>
<polygon fill="black" stroke="black" points="10345.33,-8394.5 10335.33,-8398 10345.33,-8401.5 10345.33,-8394.5"/>
</g>
<!-- attn_2_0_3&#45;&gt;concat_dim_2_0 -->
<g id="edge232" class="edge">
<title>attn_2_0_3&#45;&gt;concat_dim_2_0</title>
<path fill="none" stroke="black" d="M10124.25,-8371.54C10124.25,-8320.74 10124.25,-8215 10124.25,-8215 10124.25,-8215 9343.71,-8215 9343.71,-8215"/>
<polygon fill="black" stroke="black" points="9343.71,-8211.5 9333.71,-8215 9343.71,-8218.5 9343.71,-8211.5"/>
</g>
<!-- attn_2_1_0 -->
<g id="node164" class="node">
<title>attn_2_1_0</title>
<polygon fill="orange" stroke="black" points="6555,-8424.67 6329,-8424.67 6329,-8371.67 6555,-8371.67 6555,-8424.67"/>
<text text-anchor="middle" x="6442" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6442" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6442" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge238" class="edge">
<title>q_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M6183.75,-8510.34C6183.75,-8467.64 6183.75,-8389 6183.75,-8389 6183.75,-8389 6318.73,-8389 6318.73,-8389"/>
<polygon fill="black" stroke="black" points="6318.73,-8392.5 6328.73,-8389 6318.73,-8385.5 6318.73,-8392.5"/>
</g>
<!-- k_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge239" class="edge">
<title>k_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M6371.25,-8510.37C6371.25,-8510.37 6371.25,-8434.89 6371.25,-8434.89"/>
<polygon fill="black" stroke="black" points="6374.75,-8434.89 6371.25,-8424.89 6367.75,-8434.89 6374.75,-8434.89"/>
</g>
<!-- v_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge240" class="edge">
<title>v_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M6513.25,-8510.37C6513.25,-8510.37 6513.25,-8434.89 6513.25,-8434.89"/>
<polygon fill="black" stroke="black" points="6516.75,-8434.89 6513.25,-8424.89 6509.75,-8434.89 6516.75,-8434.89"/>
</g>
<!-- concat_dim_2_1 -->
<g id="node210" class="node">
<title>concat_dim_2_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7312.2,-8285.67 6982.59,-8285.67 6897.8,-8179.67 7227.41,-8179.67 7312.2,-8285.67"/>
<text text-anchor="middle" x="7105" y="-8243.97" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="7105" y="-8228.97" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="7105" y="-8213.97" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- attn_2_1_0&#45;&gt;concat_dim_2_1 -->
<g id="edge241" class="edge">
<title>attn_2_1_0&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M6509.17,-8371.47C6509.17,-8324.5 6509.17,-8232 6509.17,-8232 6509.17,-8232 6929.42,-8232 6929.42,-8232"/>
<polygon fill="black" stroke="black" points="6929.42,-8235.5 6939.42,-8232 6929.42,-8228.5 6929.42,-8235.5"/>
</g>
<!-- attn_2_1_1 -->
<g id="node168" class="node">
<title>attn_2_1_1</title>
<polygon fill="orange" stroke="black" points="7122,-8424.67 6896,-8424.67 6896,-8371.67 7122,-8371.67 7122,-8424.67"/>
<text text-anchor="middle" x="7009" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7009" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7009" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge245" class="edge">
<title>q_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M6750.5,-8510.67C6750.5,-8470.29 6750.5,-8398 6750.5,-8398 6750.5,-8398 6885.99,-8398 6885.99,-8398"/>
<polygon fill="black" stroke="black" points="6885.99,-8401.5 6895.99,-8398 6885.99,-8394.5 6885.99,-8401.5"/>
</g>
<!-- k_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge246" class="edge">
<title>k_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M6938.25,-8510.37C6938.25,-8510.37 6938.25,-8434.89 6938.25,-8434.89"/>
<polygon fill="black" stroke="black" points="6941.75,-8434.89 6938.25,-8424.89 6934.75,-8434.89 6941.75,-8434.89"/>
</g>
<!-- v_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge247" class="edge">
<title>v_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M7080.25,-8510.37C7080.25,-8510.37 7080.25,-8434.89 7080.25,-8434.89"/>
<polygon fill="black" stroke="black" points="7083.75,-8434.89 7080.25,-8424.89 7076.75,-8434.89 7083.75,-8434.89"/>
</g>
<!-- attn_2_1_1&#45;&gt;concat_dim_2_1 -->
<g id="edge248" class="edge">
<title>attn_2_1_1&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M7009.82,-8371.58C7009.82,-8371.58 7009.82,-8295.94 7009.82,-8295.94"/>
<polygon fill="black" stroke="black" points="7013.32,-8295.94 7009.82,-8285.94 7006.32,-8295.94 7013.32,-8295.94"/>
</g>
<!-- attn_2_1_2 -->
<g id="node172" class="node">
<title>attn_2_1_2</title>
<polygon fill="orange" stroke="black" points="7501,-8424.67 7275,-8424.67 7275,-8371.67 7501,-8371.67 7501,-8424.67"/>
<text text-anchor="middle" x="7388" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7388" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7388" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge252" class="edge">
<title>q_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M7316.75,-8510.37C7316.75,-8510.37 7316.75,-8434.89 7316.75,-8434.89"/>
<polygon fill="black" stroke="black" points="7320.25,-8434.89 7316.75,-8424.89 7313.25,-8434.89 7320.25,-8434.89"/>
</g>
<!-- k_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge253" class="edge">
<title>k_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M7458.75,-8510.37C7458.75,-8510.37 7458.75,-8434.89 7458.75,-8434.89"/>
<polygon fill="black" stroke="black" points="7462.25,-8434.89 7458.75,-8424.89 7455.25,-8434.89 7462.25,-8434.89"/>
</g>
<!-- v_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge254" class="edge">
<title>v_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M7639.5,-8510.67C7639.5,-8470.29 7639.5,-8398 7639.5,-8398 7639.5,-8398 7511.24,-8398 7511.24,-8398"/>
<polygon fill="black" stroke="black" points="7511.24,-8394.5 7501.24,-8398 7511.24,-8401.5 7511.24,-8394.5"/>
</g>
<!-- attn_2_1_2&#45;&gt;concat_dim_2_1 -->
<g id="edge255" class="edge">
<title>attn_2_1_2&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M7293.68,-8371.58C7293.68,-8371.58 7293.68,-8295.94 7293.68,-8295.94"/>
<polygon fill="black" stroke="black" points="7297.18,-8295.94 7293.68,-8285.94 7290.18,-8295.94 7297.18,-8295.94"/>
</g>
<!-- attn_2_1_3 -->
<g id="node176" class="node">
<title>attn_2_1_3</title>
<polygon fill="orange" stroke="black" points="8067,-8424.67 7841,-8424.67 7841,-8371.67 8067,-8371.67 8067,-8424.67"/>
<text text-anchor="middle" x="7954" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7954" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7954" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge259" class="edge">
<title>q_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M7883.25,-8510.37C7883.25,-8510.37 7883.25,-8434.89 7883.25,-8434.89"/>
<polygon fill="black" stroke="black" points="7886.75,-8434.89 7883.25,-8424.89 7879.75,-8434.89 7886.75,-8434.89"/>
</g>
<!-- k_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge260" class="edge">
<title>k_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M8025.25,-8510.37C8025.25,-8510.37 8025.25,-8434.89 8025.25,-8434.89"/>
<polygon fill="black" stroke="black" points="8028.75,-8434.89 8025.25,-8424.89 8021.75,-8434.89 8028.75,-8434.89"/>
</g>
<!-- v_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge261" class="edge">
<title>v_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M8223.5,-8510.52C8223.5,-8472.43 8223.5,-8407 8223.5,-8407 8223.5,-8407 8077.12,-8407 8077.12,-8407"/>
<polygon fill="black" stroke="black" points="8077.12,-8403.5 8067.12,-8407 8077.12,-8410.5 8077.12,-8403.5"/>
</g>
<!-- attn_2_1_3&#45;&gt;concat_dim_2_1 -->
<g id="edge262" class="edge">
<title>attn_2_1_3&#45;&gt;concat_dim_2_1</title>
<path fill="none" stroke="black" d="M7860.5,-8371.34C7860.5,-8328.64 7860.5,-8250 7860.5,-8250 7860.5,-8250 7294.04,-8250 7294.04,-8250"/>
<polygon fill="black" stroke="black" points="7294.04,-8246.5 7284.04,-8250 7294.04,-8253.5 7294.04,-8246.5"/>
</g>
<!-- attn_2_2_0 -->
<g id="node180" class="node">
<title>attn_2_2_0</title>
<polygon fill="orange" stroke="black" points="4287,-8424.67 4061,-8424.67 4061,-8371.67 4287,-8371.67 4287,-8424.67"/>
<text text-anchor="middle" x="4174" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4174" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4174" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge268" class="edge">
<title>q_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M3932,-8510.34C3932,-8467.64 3932,-8389 3932,-8389 3932,-8389 4050.79,-8389 4050.79,-8389"/>
<polygon fill="black" stroke="black" points="4050.79,-8392.5 4060.79,-8389 4050.79,-8385.5 4050.79,-8392.5"/>
</g>
<!-- k_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge269" class="edge">
<title>k_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M4103.25,-8510.37C4103.25,-8510.37 4103.25,-8434.89 4103.25,-8434.89"/>
<polygon fill="black" stroke="black" points="4106.75,-8434.89 4103.25,-8424.89 4099.75,-8434.89 4106.75,-8434.89"/>
</g>
<!-- v_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge270" class="edge">
<title>v_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M4245.25,-8510.37C4245.25,-8510.37 4245.25,-8434.89 4245.25,-8434.89"/>
<polygon fill="black" stroke="black" points="4248.75,-8434.89 4245.25,-8424.89 4241.75,-8434.89 4248.75,-8434.89"/>
</g>
<!-- concat_dim_2_2 -->
<g id="node211" class="node">
<title>concat_dim_2_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5421.2,-8285.67 5091.59,-8285.67 5006.8,-8179.67 5336.41,-8179.67 5421.2,-8285.67"/>
<text text-anchor="middle" x="5214" y="-8243.97" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="5214" y="-8228.97" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="5214" y="-8213.97" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- attn_2_2_0&#45;&gt;concat_dim_2_2 -->
<g id="edge271" class="edge">
<title>attn_2_2_0&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M4222.75,-8371.47C4222.75,-8324.5 4222.75,-8232 4222.75,-8232 4222.75,-8232 5038.65,-8232 5038.65,-8232"/>
<polygon fill="black" stroke="black" points="5038.65,-8235.5 5048.65,-8232 5038.65,-8228.5 5038.65,-8235.5"/>
</g>
<!-- attn_2_2_1 -->
<g id="node184" class="node">
<title>attn_2_2_1</title>
<polygon fill="orange" stroke="black" points="4854,-8424.67 4628,-8424.67 4628,-8371.67 4854,-8371.67 4854,-8424.67"/>
<text text-anchor="middle" x="4741" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4741" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4741" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge275" class="edge">
<title>q_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M4466.5,-8510.67C4466.5,-8470.29 4466.5,-8398 4466.5,-8398 4466.5,-8398 4617.77,-8398 4617.77,-8398"/>
<polygon fill="black" stroke="black" points="4617.77,-8401.5 4627.77,-8398 4617.77,-8394.5 4617.77,-8401.5"/>
</g>
<!-- k_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge276" class="edge">
<title>k_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M4670.25,-8510.37C4670.25,-8510.37 4670.25,-8434.89 4670.25,-8434.89"/>
<polygon fill="black" stroke="black" points="4673.75,-8434.89 4670.25,-8424.89 4666.75,-8434.89 4673.75,-8434.89"/>
</g>
<!-- v_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge277" class="edge">
<title>v_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M4812.25,-8510.37C4812.25,-8510.37 4812.25,-8434.89 4812.25,-8434.89"/>
<polygon fill="black" stroke="black" points="4815.75,-8434.89 4812.25,-8424.89 4808.75,-8434.89 4815.75,-8434.89"/>
</g>
<!-- attn_2_2_1&#45;&gt;concat_dim_2_2 -->
<g id="edge278" class="edge">
<title>attn_2_2_1&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M4854.22,-8398C4941.92,-8398 5048.57,-8398 5048.57,-8398 5048.57,-8398 5048.57,-8242.79 5048.57,-8242.79"/>
<polygon fill="black" stroke="black" points="5052.07,-8242.79 5048.57,-8232.79 5045.07,-8242.79 5052.07,-8242.79"/>
</g>
<!-- attn_2_2_2 -->
<g id="node188" class="node">
<title>attn_2_2_2</title>
<polygon fill="orange" stroke="black" points="5327,-8424.67 5101,-8424.67 5101,-8371.67 5327,-8371.67 5327,-8424.67"/>
<text text-anchor="middle" x="5214" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5214" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5214" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge282" class="edge">
<title>q_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M5090.7,-8537C5109.38,-8537 5124.75,-8537 5124.75,-8537 5124.75,-8537 5124.75,-8434.94 5124.75,-8434.94"/>
<polygon fill="black" stroke="black" points="5128.25,-8434.94 5124.75,-8424.94 5121.25,-8434.94 5128.25,-8434.94"/>
</g>
<!-- k_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge283" class="edge">
<title>k_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M5214,-8510.37C5214,-8510.37 5214,-8434.89 5214,-8434.89"/>
<polygon fill="black" stroke="black" points="5217.5,-8434.89 5214,-8424.89 5210.5,-8434.89 5217.5,-8434.89"/>
</g>
<!-- v_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge284" class="edge">
<title>v_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M5337.3,-8537C5318.62,-8537 5303.25,-8537 5303.25,-8537 5303.25,-8537 5303.25,-8434.94 5303.25,-8434.94"/>
<polygon fill="black" stroke="black" points="5306.75,-8434.94 5303.25,-8424.94 5299.75,-8434.94 5306.75,-8434.94"/>
</g>
<!-- attn_2_2_2&#45;&gt;concat_dim_2_2 -->
<g id="edge285" class="edge">
<title>attn_2_2_2&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5214,-8371.58C5214,-8371.58 5214,-8295.94 5214,-8295.94"/>
<polygon fill="black" stroke="black" points="5217.5,-8295.94 5214,-8285.94 5210.5,-8295.94 5217.5,-8295.94"/>
</g>
<!-- attn_2_2_3 -->
<g id="node192" class="node">
<title>attn_2_2_3</title>
<polygon fill="orange" stroke="black" points="5799,-8424.67 5573,-8424.67 5573,-8371.67 5799,-8371.67 5799,-8424.67"/>
<text text-anchor="middle" x="5686" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5686" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5686" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge289" class="edge">
<title>q_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M5615.25,-8510.37C5615.25,-8510.37 5615.25,-8434.89 5615.25,-8434.89"/>
<polygon fill="black" stroke="black" points="5618.75,-8434.89 5615.25,-8424.89 5611.75,-8434.89 5618.75,-8434.89"/>
</g>
<!-- k_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge290" class="edge">
<title>k_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M5757.25,-8510.37C5757.25,-8510.37 5757.25,-8434.89 5757.25,-8434.89"/>
<polygon fill="black" stroke="black" points="5760.75,-8434.89 5757.25,-8424.89 5753.75,-8434.89 5760.75,-8434.89"/>
</g>
<!-- v_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge291" class="edge">
<title>v_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M5910,-8510.52C5910,-8472.43 5910,-8407 5910,-8407 5910,-8407 5809.31,-8407 5809.31,-8407"/>
<polygon fill="black" stroke="black" points="5809.31,-8403.5 5799.31,-8407 5809.31,-8410.5 5809.31,-8403.5"/>
</g>
<!-- attn_2_2_3&#45;&gt;concat_dim_2_2 -->
<g id="edge292" class="edge">
<title>attn_2_2_3&#45;&gt;concat_dim_2_2</title>
<path fill="none" stroke="black" d="M5572.71,-8398C5485.38,-8398 5379.43,-8398 5379.43,-8398 5379.43,-8398 5379.43,-8295.89 5379.43,-8295.89"/>
<polygon fill="black" stroke="black" points="5382.93,-8295.89 5379.43,-8285.89 5375.93,-8295.89 5382.93,-8295.89"/>
</g>
<!-- attn_2_3_0 -->
<g id="node196" class="node">
<title>attn_2_3_0</title>
<polygon fill="orange" stroke="black" points="2020,-8424.67 1794,-8424.67 1794,-8371.67 2020,-8371.67 2020,-8424.67"/>
<text text-anchor="middle" x="1907" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1907" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1907" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge298" class="edge">
<title>q_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M1674,-8510.67C1674,-8470.29 1674,-8398 1674,-8398 1674,-8398 1783.91,-8398 1783.91,-8398"/>
<polygon fill="black" stroke="black" points="1783.91,-8401.5 1793.91,-8398 1783.91,-8394.5 1783.91,-8401.5"/>
</g>
<!-- k_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge299" class="edge">
<title>k_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M1835.75,-8510.37C1835.75,-8510.37 1835.75,-8434.89 1835.75,-8434.89"/>
<polygon fill="black" stroke="black" points="1839.25,-8434.89 1835.75,-8424.89 1832.25,-8434.89 1839.25,-8434.89"/>
</g>
<!-- v_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge300" class="edge">
<title>v_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M1977.75,-8510.37C1977.75,-8510.37 1977.75,-8434.89 1977.75,-8434.89"/>
<polygon fill="black" stroke="black" points="1981.25,-8434.89 1977.75,-8424.89 1974.25,-8434.89 1981.25,-8434.89"/>
</g>
<!-- concat_dim_2_3 -->
<g id="node212" class="node">
<title>concat_dim_2_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3153.2,-8285.67 2823.59,-8285.67 2738.8,-8179.67 3068.41,-8179.67 3153.2,-8285.67"/>
<text text-anchor="middle" x="2946" y="-8243.97" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="2946" y="-8228.97" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="2946" y="-8213.97" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- attn_2_3_0&#45;&gt;concat_dim_2_3 -->
<g id="edge301" class="edge">
<title>attn_2_3_0&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M1944.33,-8371.47C1944.33,-8324.5 1944.33,-8232 1944.33,-8232 1944.33,-8232 2770.6,-8232 2770.6,-8232"/>
<polygon fill="black" stroke="black" points="2770.6,-8235.5 2780.6,-8232 2770.6,-8228.5 2770.6,-8235.5"/>
</g>
<!-- attn_2_3_1 -->
<g id="node200" class="node">
<title>attn_2_3_1</title>
<polygon fill="orange" stroke="black" points="2587,-8424.67 2361,-8424.67 2361,-8371.67 2587,-8371.67 2587,-8424.67"/>
<text text-anchor="middle" x="2474" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2474" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2474" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge305" class="edge">
<title>q_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M2241,-8510.67C2241,-8470.29 2241,-8398 2241,-8398 2241,-8398 2350.91,-8398 2350.91,-8398"/>
<polygon fill="black" stroke="black" points="2350.91,-8401.5 2360.91,-8398 2350.91,-8394.5 2350.91,-8401.5"/>
</g>
<!-- k_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge306" class="edge">
<title>k_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M2402.75,-8510.37C2402.75,-8510.37 2402.75,-8434.89 2402.75,-8434.89"/>
<polygon fill="black" stroke="black" points="2406.25,-8434.89 2402.75,-8424.89 2399.25,-8434.89 2406.25,-8434.89"/>
</g>
<!-- v_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge307" class="edge">
<title>v_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M2544.75,-8510.37C2544.75,-8510.37 2544.75,-8434.89 2544.75,-8434.89"/>
<polygon fill="black" stroke="black" points="2548.25,-8434.89 2544.75,-8424.89 2541.25,-8434.89 2548.25,-8434.89"/>
</g>
<!-- attn_2_3_1&#45;&gt;concat_dim_2_3 -->
<g id="edge308" class="edge">
<title>attn_2_3_1&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M2587.29,-8398C2674.62,-8398 2780.57,-8398 2780.57,-8398 2780.57,-8398 2780.57,-8242.79 2780.57,-8242.79"/>
<polygon fill="black" stroke="black" points="2784.07,-8242.79 2780.57,-8232.79 2777.07,-8242.79 2784.07,-8242.79"/>
</g>
<!-- attn_2_3_2 -->
<g id="node204" class="node">
<title>attn_2_3_2</title>
<polygon fill="orange" stroke="black" points="3059,-8424.67 2833,-8424.67 2833,-8371.67 3059,-8371.67 3059,-8424.67"/>
<text text-anchor="middle" x="2946" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2946" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2946" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge312" class="edge">
<title>q_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M2822.51,-8537C2843.93,-8537 2862.33,-8537 2862.33,-8537 2862.33,-8537 2862.33,-8434.94 2862.33,-8434.94"/>
<polygon fill="black" stroke="black" points="2865.83,-8434.94 2862.33,-8424.94 2858.83,-8434.94 2865.83,-8434.94"/>
</g>
<!-- k_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge313" class="edge">
<title>k_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M2946,-8510.37C2946,-8510.37 2946,-8434.89 2946,-8434.89"/>
<polygon fill="black" stroke="black" points="2949.5,-8434.89 2946,-8424.89 2942.5,-8434.89 2949.5,-8434.89"/>
</g>
<!-- v_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge314" class="edge">
<title>v_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M3069.3,-8537C3050.62,-8537 3035.25,-8537 3035.25,-8537 3035.25,-8537 3035.25,-8434.94 3035.25,-8434.94"/>
<polygon fill="black" stroke="black" points="3038.75,-8434.94 3035.25,-8424.94 3031.75,-8434.94 3038.75,-8434.94"/>
</g>
<!-- attn_2_3_2&#45;&gt;concat_dim_2_3 -->
<g id="edge315" class="edge">
<title>attn_2_3_2&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M2946,-8371.58C2946,-8371.58 2946,-8295.94 2946,-8295.94"/>
<polygon fill="black" stroke="black" points="2949.5,-8295.94 2946,-8285.94 2942.5,-8295.94 2949.5,-8295.94"/>
</g>
<!-- attn_2_3_3 -->
<g id="node208" class="node">
<title>attn_2_3_3</title>
<polygon fill="orange" stroke="black" points="3532,-8424.67 3306,-8424.67 3306,-8371.67 3532,-8371.67 3532,-8424.67"/>
<text text-anchor="middle" x="3419" y="-8409.47" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3419" y="-8394.47" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3419" y="-8379.47" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge319" class="edge">
<title>q_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M3347.75,-8510.37C3347.75,-8510.37 3347.75,-8434.89 3347.75,-8434.89"/>
<polygon fill="black" stroke="black" points="3351.25,-8434.89 3347.75,-8424.89 3344.25,-8434.89 3351.25,-8434.89"/>
</g>
<!-- k_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge320" class="edge">
<title>k_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M3489.75,-8510.37C3489.75,-8510.37 3489.75,-8434.89 3489.75,-8434.89"/>
<polygon fill="black" stroke="black" points="3493.25,-8434.89 3489.75,-8424.89 3486.25,-8434.89 3493.25,-8434.89"/>
</g>
<!-- v_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge321" class="edge">
<title>v_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M3646.5,-8510.52C3646.5,-8472.43 3646.5,-8407 3646.5,-8407 3646.5,-8407 3542.08,-8407 3542.08,-8407"/>
<polygon fill="black" stroke="black" points="3542.08,-8403.5 3532.08,-8407 3542.08,-8410.5 3542.08,-8403.5"/>
</g>
<!-- attn_2_3_3&#45;&gt;concat_dim_2_3 -->
<g id="edge322" class="edge">
<title>attn_2_3_3&#45;&gt;concat_dim_2_3</title>
<path fill="none" stroke="black" d="M3305.78,-8398C3218.08,-8398 3111.43,-8398 3111.43,-8398 3111.43,-8398 3111.43,-8295.89 3111.43,-8295.89"/>
<polygon fill="black" stroke="black" points="3114.93,-8295.89 3111.43,-8285.89 3107.93,-8295.89 3114.93,-8295.89"/>
</g>
<!-- concat_heads_2 -->
<g id="node213" class="node">
<title>concat_heads_2</title>
<polygon fill="lightgreen" stroke="black" points="7322.94,-8093.67 6976.25,-8093.67 6887.06,-7987.67 7233.75,-7987.67 7322.94,-8093.67"/>
<text text-anchor="middle" x="7105" y="-8051.97" font-family="Times,serif" font-size="14.00">Head Group Concatenation</text>
<text text-anchor="middle" x="7105" y="-8036.97" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7105" y="-8021.97" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_2_0&#45;&gt;concat_heads_2 -->
<g id="edge233" class="edge">
<title>concat_dim_2_0&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M9003.71,-8215C8536.48,-8215 7317.53,-8215 7317.53,-8215 7317.53,-8215 7317.53,-8050.8 7317.53,-8050.8"/>
<polygon fill="black" stroke="black" points="7321.03,-8050.8 7317.53,-8040.8 7314.03,-8050.8 7321.03,-8050.8"/>
</g>
<!-- concat_dim_2_1&#45;&gt;concat_heads_2 -->
<g id="edge263" class="edge">
<title>concat_dim_2_1&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M7105,-8179.45C7105,-8179.45 7105,-8104 7105,-8104"/>
<polygon fill="black" stroke="black" points="7108.5,-8104 7105,-8094 7101.5,-8104 7108.5,-8104"/>
</g>
<!-- concat_dim_2_2&#45;&gt;concat_heads_2 -->
<g id="edge293" class="edge">
<title>concat_dim_2_2&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M5417.43,-8232.55C5417.43,-8227.26 5417.43,-8058 5417.43,-8058 5417.43,-8058 6935.86,-8058 6935.86,-8058"/>
<polygon fill="black" stroke="black" points="6935.86,-8061.5 6945.86,-8058 6935.86,-8054.5 6935.86,-8061.5"/>
</g>
<!-- concat_dim_2_3&#45;&gt;concat_heads_2 -->
<g id="edge323" class="edge">
<title>concat_dim_2_3&#45;&gt;concat_heads_2</title>
<path fill="none" stroke="black" d="M3085.02,-8200.37C3085.02,-8141.56 3085.02,-8023 3085.02,-8023 3085.02,-8023 6906.5,-8023 6906.5,-8023"/>
<polygon fill="black" stroke="black" points="6906.5,-8026.5 6916.5,-8023 6906.5,-8019.5 6906.5,-8026.5"/>
</g>
<!-- out_proj_2 -->
<g id="node214" class="node">
<title>out_proj_2</title>
<polygon fill="lightcoral" stroke="black" points="7179,-7901.67 7035,-7901.67 7035,-7848.67 7179,-7848.67 7179,-7901.67"/>
<text text-anchor="middle" x="7107" y="-7886.47" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7107" y="-7871.47" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7107" y="-7856.47" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads_2&#45;&gt;out_proj_2 -->
<g id="edge324" class="edge">
<title>concat_heads_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M7107,-7987.4C7107,-7987.4 7107,-7911.92 7107,-7911.92"/>
<polygon fill="black" stroke="black" points="7110.5,-7911.92 7107,-7901.92 7103.5,-7911.92 7110.5,-7911.92"/>
</g>
<!-- out_proj_2&#45;&gt;residual2_1 -->
<g id="edge325" class="edge">
<title>out_proj_2&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M7146.11,-7848.36C7146.11,-7848.36 7146.11,-7765.91 7146.11,-7765.91"/>
<polygon fill="black" stroke="black" points="7149.61,-7765.91 7146.11,-7755.91 7142.61,-7765.91 7149.61,-7765.91"/>
</g>
<!-- ln2_mlp -->
<g id="node216" class="node">
<title>ln2_mlp</title>
<polygon fill="lightblue" stroke="black" points="6241,-7601.72 6143,-7601.72 6143,-7548.72 6241,-7548.72 6241,-7601.72"/>
<text text-anchor="middle" x="6192" y="-7586.52" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="6192" y="-7571.52" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6192" y="-7556.52" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;ln2_mlp -->
<g id="edge327" class="edge">
<title>residual2_1&#45;&gt;ln2_mlp</title>
<path fill="none" stroke="black" d="M7112.99,-7725C6884.5,-7725 6232.75,-7725 6232.75,-7725 6232.75,-7725 6232.75,-7612 6232.75,-7612"/>
<polygon fill="black" stroke="black" points="6236.25,-7612 6232.75,-7602 6229.25,-7612 6236.25,-7612"/>
</g>
<!-- residual2_2 -->
<g id="node277" class="node">
<title>residual2_2</title>
<ellipse fill="yellow" stroke="black" cx="5743" cy="-6048.24" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="5743" y="-6059.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="5743" y="-6044.54" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5743" y="-6029.54" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_1&#45;&gt;residual2_2 -->
<g id="edge404" class="edge">
<title>residual2_1&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M7186.4,-7687.69C7186.4,-7440.9 7186.4,-6060 7186.4,-6060 7186.4,-6060 5827.06,-6060 5827.06,-6060"/>
<polygon fill="black" stroke="black" points="5827.06,-6056.5 5817.06,-6060 5827.06,-6063.5 5827.06,-6056.5"/>
</g>
<!-- gate2 -->
<g id="node217" class="node">
<title>gate2</title>
<polygon fill="purple" stroke="black" points="5893.98,-7462.72 5625.17,-7462.72 5556.02,-7356.72 5824.83,-7356.72 5893.98,-7462.72"/>
<text text-anchor="middle" x="5725" y="-7421.02" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="5725" y="-7406.02" font-family="Times,serif" font-size="14.00">(B×L×num_experts)</text>
<text text-anchor="middle" x="5725" y="-7391.02" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln2_mlp&#45;&gt;gate2 -->
<g id="edge328" class="edge">
<title>ln2_mlp&#45;&gt;gate2</title>
<path fill="none" stroke="black" d="M6142.78,-7575C6052.65,-7575 5870.25,-7575 5870.25,-7575 5870.25,-7575 5870.25,-7472.93 5870.25,-7472.93"/>
<polygon fill="black" stroke="black" points="5873.75,-7472.93 5870.25,-7462.93 5866.75,-7472.93 5873.75,-7472.93"/>
</g>
<!-- expert_select2 -->
<g id="node218" class="node">
<title>expert_select2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5400,-7270.72 5175.7,-7270.72 5118,-7164.72 5342.3,-7164.72 5400,-7270.72"/>
<text text-anchor="middle" x="5259" y="-7229.02" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="5259" y="-7214.02" font-family="Times,serif" font-size="14.00">(B×L×top_k)</text>
<text text-anchor="middle" x="5259" y="-7199.02" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- gate2&#45;&gt;expert_select2 -->
<g id="edge329" class="edge">
<title>gate2&#45;&gt;expert_select2</title>
<path fill="none" stroke="black" d="M5581.25,-7356.31C5581.25,-7312.27 5581.25,-7257 5581.25,-7257 5581.25,-7257 5402.87,-7257 5402.87,-7257"/>
<polygon fill="black" stroke="black" points="5402.87,-7253.5 5392.87,-7257 5402.87,-7260.5 5402.87,-7253.5"/>
</g>
<!-- expert2_0_linear1_0 -->
<g id="node219" class="node">
<title>expert2_0_linear1_0</title>
<polygon fill="lightcoral" stroke="black" points="3347.5,-7078.72 3154.5,-7078.72 3154.5,-7025.72 3347.5,-7025.72 3347.5,-7078.72"/>
<text text-anchor="middle" x="3251" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="3251" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3251" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_select2&#45;&gt;expert2_0_linear1_0 -->
<g id="edge330" class="edge">
<title>expert_select2&#45;&gt;expert2_0_linear1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5168.07,-7257C4785.56,-7257 3326.75,-7257 3326.75,-7257 3326.75,-7257 3326.75,-7088.99 3326.75,-7088.99"/>
<polygon fill="black" stroke="black" points="3330.25,-7088.99 3326.75,-7078.99 3323.25,-7088.99 3330.25,-7088.99"/>
</g>
<!-- expert2_0_linear1_1 -->
<g id="node222" class="node">
<title>expert2_0_linear1_1</title>
<polygon fill="lightcoral" stroke="black" points="3598.5,-7078.72 3405.5,-7078.72 3405.5,-7025.72 3598.5,-7025.72 3598.5,-7078.72"/>
<text text-anchor="middle" x="3502" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="3502" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3502" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_select2&#45;&gt;expert2_0_linear1_1 -->
<g id="edge334" class="edge">
<title>expert_select2&#45;&gt;expert2_0_linear1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5160.99,-7244C4803.1,-7244 3587.57,-7244 3587.57,-7244 3587.57,-7244 3587.57,-7088.89 3587.57,-7088.89"/>
<polygon fill="black" stroke="black" points="3591.07,-7088.89 3587.57,-7078.89 3584.07,-7088.89 3591.07,-7088.89"/>
</g>
<!-- expert2_1_linear1_2 -->
<g id="node226" class="node">
<title>expert2_1_linear1_2</title>
<polygon fill="lightcoral" stroke="black" points="3849.5,-7078.72 3656.5,-7078.72 3656.5,-7025.72 3849.5,-7025.72 3849.5,-7078.72"/>
<text text-anchor="middle" x="3753" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="3753" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3753" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_select2&#45;&gt;expert2_1_linear1_2 -->
<g id="edge339" class="edge">
<title>expert_select2&#45;&gt;expert2_1_linear1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5153.32,-7230C4823.88,-7230 3837.5,-7230 3837.5,-7230 3837.5,-7230 3837.5,-7088.84 3837.5,-7088.84"/>
<polygon fill="black" stroke="black" points="3841,-7088.84 3837.5,-7078.84 3834,-7088.84 3841,-7088.84"/>
</g>
<!-- expert2_1_linear1_3 -->
<g id="node229" class="node">
<title>expert2_1_linear1_3</title>
<polygon fill="lightcoral" stroke="black" points="4100.5,-7078.72 3907.5,-7078.72 3907.5,-7025.72 4100.5,-7025.72 4100.5,-7078.72"/>
<text text-anchor="middle" x="4004" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="4004" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4004" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_select2&#45;&gt;expert2_1_linear1_3 -->
<g id="edge343" class="edge">
<title>expert_select2&#45;&gt;expert2_1_linear1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5146.29,-7217C4851.58,-7217 4080.75,-7217 4080.75,-7217 4080.75,-7217 4080.75,-7089.06 4080.75,-7089.06"/>
<polygon fill="black" stroke="black" points="4084.25,-7089.06 4080.75,-7079.06 4077.25,-7089.06 4084.25,-7089.06"/>
</g>
<!-- expert2_2_linear1_4 -->
<g id="node233" class="node">
<title>expert2_2_linear1_4</title>
<polygon fill="lightcoral" stroke="black" points="4351.5,-7078.72 4158.5,-7078.72 4158.5,-7025.72 4351.5,-7025.72 4351.5,-7078.72"/>
<text text-anchor="middle" x="4255" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="4255" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4255" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_select2&#45;&gt;expert2_2_linear1_4 -->
<g id="edge348" class="edge">
<title>expert_select2&#45;&gt;expert2_2_linear1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5139.25,-7204C4890.96,-7204 4343,-7204 4343,-7204 4343,-7204 4343,-7089.01 4343,-7089.01"/>
<polygon fill="black" stroke="black" points="4346.5,-7089.01 4343,-7079.01 4339.5,-7089.01 4346.5,-7089.01"/>
</g>
<!-- expert2_2_linear1_5 -->
<g id="node236" class="node">
<title>expert2_2_linear1_5</title>
<polygon fill="lightcoral" stroke="black" points="4602.5,-7078.72 4409.5,-7078.72 4409.5,-7025.72 4602.5,-7025.72 4602.5,-7078.72"/>
<text text-anchor="middle" x="4506" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="4506" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4506" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_select2&#45;&gt;expert2_2_linear1_5 -->
<g id="edge352" class="edge">
<title>expert_select2&#45;&gt;expert2_2_linear1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5131.97,-7191C4938.45,-7191 4592,-7191 4592,-7191 4592,-7191 4592,-7088.98 4592,-7088.98"/>
<polygon fill="black" stroke="black" points="4595.5,-7088.98 4592,-7078.98 4588.5,-7088.98 4595.5,-7088.98"/>
</g>
<!-- expert2_3_linear1_6 -->
<g id="node240" class="node">
<title>expert2_3_linear1_6</title>
<polygon fill="lightcoral" stroke="black" points="4853.5,-7078.72 4660.5,-7078.72 4660.5,-7025.72 4853.5,-7025.72 4853.5,-7078.72"/>
<text text-anchor="middle" x="4757" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="4757" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4757" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_select2&#45;&gt;expert2_3_linear1_6 -->
<g id="edge357" class="edge">
<title>expert_select2&#45;&gt;expert2_3_linear1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5124.47,-7177C4975.77,-7177 4757,-7177 4757,-7177 4757,-7177 4757,-7088.99 4757,-7088.99"/>
<polygon fill="black" stroke="black" points="4760.5,-7088.99 4757,-7078.99 4753.5,-7088.99 4760.5,-7088.99"/>
</g>
<!-- expert2_3_linear1_7 -->
<g id="node243" class="node">
<title>expert2_3_linear1_7</title>
<polygon fill="lightcoral" stroke="black" points="5104.5,-7078.72 4911.5,-7078.72 4911.5,-7025.72 5104.5,-7025.72 5104.5,-7078.72"/>
<text text-anchor="middle" x="5008" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="5008" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5008" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_select2&#45;&gt;expert2_3_linear1_7 -->
<g id="edge361" class="edge">
<title>expert_select2&#45;&gt;expert2_3_linear1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5143.6,-7164.37C5143.6,-7115.93 5143.6,-7052 5143.6,-7052 5143.6,-7052 5114.74,-7052 5114.74,-7052"/>
<polygon fill="black" stroke="black" points="5114.74,-7048.5 5104.74,-7052 5114.74,-7055.5 5114.74,-7048.5"/>
</g>
<!-- expert2_4_linear1_8 -->
<g id="node247" class="node">
<title>expert2_4_linear1_8</title>
<polygon fill="lightcoral" stroke="black" points="5355.5,-7078.72 5162.5,-7078.72 5162.5,-7025.72 5355.5,-7025.72 5355.5,-7078.72"/>
<text text-anchor="middle" x="5259" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="5259" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5259" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_select2&#45;&gt;expert2_4_linear1_8 -->
<g id="edge366" class="edge">
<title>expert_select2&#45;&gt;expert2_4_linear1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5259,-7164.44C5259,-7164.44 5259,-7088.97 5259,-7088.97"/>
<polygon fill="black" stroke="black" points="5262.5,-7088.97 5259,-7078.97 5255.5,-7088.97 5262.5,-7088.97"/>
</g>
<!-- expert2_4_linear1_9 -->
<g id="node250" class="node">
<title>expert2_4_linear1_9</title>
<polygon fill="lightcoral" stroke="black" points="5606.5,-7078.72 5413.5,-7078.72 5413.5,-7025.72 5606.5,-7025.72 5606.5,-7078.72"/>
<text text-anchor="middle" x="5510" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="5510" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5510" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_select2&#45;&gt;expert2_4_linear1_9 -->
<g id="edge370" class="edge">
<title>expert_select2&#45;&gt;expert2_4_linear1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5377.75,-7217.6C5377.75,-7212.58 5377.75,-7052 5377.75,-7052 5377.75,-7052 5403.19,-7052 5403.19,-7052"/>
<polygon fill="black" stroke="black" points="5403.19,-7055.5 5413.19,-7052 5403.19,-7048.5 5403.19,-7055.5"/>
</g>
<!-- expert2_5_linear1_10 -->
<g id="node254" class="node">
<title>expert2_5_linear1_10</title>
<polygon fill="lightcoral" stroke="black" points="5857.5,-7078.72 5664.5,-7078.72 5664.5,-7025.72 5857.5,-7025.72 5857.5,-7078.72"/>
<text text-anchor="middle" x="5761" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="5761" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5761" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_select2&#45;&gt;expert2_5_linear1_10 -->
<g id="edge375" class="edge">
<title>expert_select2&#45;&gt;expert2_5_linear1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5349.04,-7177C5493.5,-7177 5761,-7177 5761,-7177 5761,-7177 5761,-7088.99 5761,-7088.99"/>
<polygon fill="black" stroke="black" points="5764.5,-7088.99 5761,-7078.99 5757.5,-7088.99 5764.5,-7088.99"/>
</g>
<!-- expert2_5_linear1_11 -->
<g id="node257" class="node">
<title>expert2_5_linear1_11</title>
<polygon fill="lightcoral" stroke="black" points="6108.5,-7078.72 5915.5,-7078.72 5915.5,-7025.72 6108.5,-7025.72 6108.5,-7078.72"/>
<text text-anchor="middle" x="6012" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="6012" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6012" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_select2&#45;&gt;expert2_5_linear1_11 -->
<g id="edge379" class="edge">
<title>expert_select2&#45;&gt;expert2_5_linear1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5356.75,-7191C5552.82,-7191 5975.5,-7191 5975.5,-7191 5975.5,-7191 5975.5,-7088.98 5975.5,-7088.98"/>
<polygon fill="black" stroke="black" points="5979,-7088.98 5975.5,-7078.98 5972,-7088.98 5979,-7088.98"/>
</g>
<!-- expert2_6_linear1_12 -->
<g id="node261" class="node">
<title>expert2_6_linear1_12</title>
<polygon fill="lightcoral" stroke="black" points="6359.5,-7078.72 6166.5,-7078.72 6166.5,-7025.72 6359.5,-7025.72 6359.5,-7078.72"/>
<text text-anchor="middle" x="6263" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="6263" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6263" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_select2&#45;&gt;expert2_6_linear1_12 -->
<g id="edge384" class="edge">
<title>expert_select2&#45;&gt;expert2_6_linear1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5363.71,-7204C5609.69,-7204 6203.75,-7204 6203.75,-7204 6203.75,-7204 6203.75,-7089.01 6203.75,-7089.01"/>
<polygon fill="black" stroke="black" points="6207.25,-7089.01 6203.75,-7079.01 6200.25,-7089.01 6207.25,-7089.01"/>
</g>
<!-- expert2_6_linear1_13 -->
<g id="node264" class="node">
<title>expert2_6_linear1_13</title>
<polygon fill="lightcoral" stroke="black" points="6610.5,-7078.72 6417.5,-7078.72 6417.5,-7025.72 6610.5,-7025.72 6610.5,-7078.72"/>
<text text-anchor="middle" x="6514" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="6514" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6514" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_select2&#45;&gt;expert2_6_linear1_13 -->
<g id="edge388" class="edge">
<title>expert_select2&#45;&gt;expert2_6_linear1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5370.95,-7217C5669.72,-7217 6463.33,-7217 6463.33,-7217 6463.33,-7217 6463.33,-7089.06 6463.33,-7089.06"/>
<polygon fill="black" stroke="black" points="6466.83,-7089.06 6463.33,-7079.06 6459.83,-7089.06 6466.83,-7089.06"/>
</g>
<!-- expert2_7_linear1_14 -->
<g id="node268" class="node">
<title>expert2_7_linear1_14</title>
<polygon fill="lightcoral" stroke="black" points="6861.5,-7078.72 6668.5,-7078.72 6668.5,-7025.72 6861.5,-7025.72 6861.5,-7078.72"/>
<text text-anchor="middle" x="6765" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="6765" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6765" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_select2&#45;&gt;expert2_7_linear1_14 -->
<g id="edge393" class="edge">
<title>expert_select2&#45;&gt;expert2_7_linear1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5378.01,-7230C5724.71,-7230 6709.5,-7230 6709.5,-7230 6709.5,-7230 6709.5,-7088.84 6709.5,-7088.84"/>
<polygon fill="black" stroke="black" points="6713,-7088.84 6709.5,-7078.84 6706,-7088.84 6713,-7088.84"/>
</g>
<!-- expert2_7_linear1_15 -->
<g id="node271" class="node">
<title>expert2_7_linear1_15</title>
<polygon fill="lightcoral" stroke="black" points="7112.5,-7078.72 6919.5,-7078.72 6919.5,-7025.72 7112.5,-7025.72 7112.5,-7078.72"/>
<text text-anchor="middle" x="7016" y="-7063.52" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="7016" y="-7048.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7016" y="-7033.52" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_select2&#45;&gt;expert2_7_linear1_15 -->
<g id="edge397" class="edge">
<title>expert_select2&#45;&gt;expert2_7_linear1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5385.7,-7244C5782.86,-7244 6977.25,-7244 6977.25,-7244 6977.25,-7244 6977.25,-7088.89 6977.25,-7088.89"/>
<polygon fill="black" stroke="black" points="6980.75,-7088.89 6977.25,-7078.89 6973.75,-7088.89 6980.75,-7088.89"/>
</g>
<!-- expert2_0_gelu_0 -->
<g id="node220" class="node">
<title>expert2_0_gelu_0</title>
<polygon fill="lightblue" stroke="black" points="3347.5,-6939.72 3154.5,-6939.72 3154.5,-6886.72 3347.5,-6886.72 3347.5,-6939.72"/>
<text text-anchor="middle" x="3251" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="3251" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3251" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert2_0_linear1_0&#45;&gt;expert2_0_gelu_0 -->
<g id="edge331" class="edge">
<title>expert2_0_linear1_0&#45;&gt;expert2_0_gelu_0</title>
<path fill="none" stroke="black" d="M3251,-7025.42C3251,-7025.42 3251,-6949.94 3251,-6949.94"/>
<polygon fill="black" stroke="black" points="3254.5,-6949.94 3251,-6939.94 3247.5,-6949.94 3254.5,-6949.94"/>
</g>
<!-- expert2_0_linear2_0 -->
<g id="node221" class="node">
<title>expert2_0_linear2_0</title>
<polygon fill="lightcoral" stroke="black" points="3320,-6800.72 3182,-6800.72 3182,-6747.72 3320,-6747.72 3320,-6800.72"/>
<text text-anchor="middle" x="3251" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="3251" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="3251" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert2_0_gelu_0&#45;&gt;expert2_0_linear2_0 -->
<g id="edge332" class="edge">
<title>expert2_0_gelu_0&#45;&gt;expert2_0_linear2_0</title>
<path fill="none" stroke="black" d="M3251,-6886.42C3251,-6886.42 3251,-6810.94 3251,-6810.94"/>
<polygon fill="black" stroke="black" points="3254.5,-6810.94 3251,-6800.94 3247.5,-6810.94 3254.5,-6810.94"/>
</g>
<!-- expert2_0_agg -->
<g id="node225" class="node">
<title>expert2_0_agg</title>
<polygon fill="lightgreen" stroke="black" points="3485.11,-6661.72 3112.69,-6661.72 3016.89,-6555.72 3389.31,-6555.72 3485.11,-6661.72"/>
<text text-anchor="middle" x="3251" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 0 Output Aggregation</text>
<text text-anchor="middle" x="3251" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="3251" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 0,1</text>
</g>
<!-- expert2_0_linear2_0&#45;&gt;expert2_0_agg -->
<g id="edge333" class="edge">
<title>expert2_0_linear2_0&#45;&gt;expert2_0_agg</title>
<path fill="none" stroke="black" d="M3251,-6747.63C3251,-6747.63 3251,-6671.99 3251,-6671.99"/>
<polygon fill="black" stroke="black" points="3254.5,-6671.99 3251,-6661.99 3247.5,-6671.99 3254.5,-6671.99"/>
</g>
<!-- expert2_0_gelu_1 -->
<g id="node223" class="node">
<title>expert2_0_gelu_1</title>
<polygon fill="lightblue" stroke="black" points="3598.5,-6939.72 3405.5,-6939.72 3405.5,-6886.72 3598.5,-6886.72 3598.5,-6939.72"/>
<text text-anchor="middle" x="3502" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="3502" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3502" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert2_0_linear1_1&#45;&gt;expert2_0_gelu_1 -->
<g id="edge335" class="edge">
<title>expert2_0_linear1_1&#45;&gt;expert2_0_gelu_1</title>
<path fill="none" stroke="black" d="M3502,-7025.42C3502,-7025.42 3502,-6949.94 3502,-6949.94"/>
<polygon fill="black" stroke="black" points="3505.5,-6949.94 3502,-6939.94 3498.5,-6949.94 3505.5,-6949.94"/>
</g>
<!-- expert2_0_linear2_1 -->
<g id="node224" class="node">
<title>expert2_0_linear2_1</title>
<polygon fill="lightcoral" stroke="black" points="3544,-6800.72 3406,-6800.72 3406,-6747.72 3544,-6747.72 3544,-6800.72"/>
<text text-anchor="middle" x="3475" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="3475" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="3475" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert2_0_gelu_1&#45;&gt;expert2_0_linear2_1 -->
<g id="edge336" class="edge">
<title>expert2_0_gelu_1&#45;&gt;expert2_0_linear2_1</title>
<path fill="none" stroke="black" d="M3475,-6886.42C3475,-6886.42 3475,-6810.94 3475,-6810.94"/>
<polygon fill="black" stroke="black" points="3478.5,-6810.94 3475,-6800.94 3471.5,-6810.94 3478.5,-6810.94"/>
</g>
<!-- expert2_0_linear2_1&#45;&gt;expert2_0_agg -->
<g id="edge337" class="edge">
<title>expert2_0_linear2_1&#45;&gt;expert2_0_agg</title>
<path fill="none" stroke="black" d="M3445.65,-6747.63C3445.65,-6747.63 3445.65,-6671.99 3445.65,-6671.99"/>
<polygon fill="black" stroke="black" points="3449.15,-6671.99 3445.65,-6661.99 3442.15,-6671.99 3449.15,-6671.99"/>
</g>
<!-- expert_outputs2 -->
<g id="node275" class="node">
<title>expert_outputs2</title>
<polygon fill="lightgreen" stroke="black" points="5587.17,-6469.72 5224.2,-6469.72 5130.83,-6363.72 5493.8,-6363.72 5587.17,-6469.72"/>
<text text-anchor="middle" x="5359" y="-6428.02" font-family="Times,serif" font-size="14.00">Expert Outputs Aggregation</text>
<text text-anchor="middle" x="5359" y="-6413.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5359" y="-6398.02" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert2_0_agg&#45;&gt;expert_outputs2 -->
<g id="edge338" class="edge">
<title>expert2_0_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M3460.15,-6608.56C3460.15,-6601.75 3460.15,-6384 3460.15,-6384 3460.15,-6384 5138.54,-6384 5138.54,-6384"/>
<polygon fill="black" stroke="black" points="5138.54,-6387.5 5148.54,-6384 5138.54,-6380.5 5138.54,-6387.5"/>
</g>
<!-- expert2_1_gelu_2 -->
<g id="node227" class="node">
<title>expert2_1_gelu_2</title>
<polygon fill="lightblue" stroke="black" points="3849.5,-6939.72 3656.5,-6939.72 3656.5,-6886.72 3849.5,-6886.72 3849.5,-6939.72"/>
<text text-anchor="middle" x="3753" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3753" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="3753" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert2_1_linear1_2&#45;&gt;expert2_1_gelu_2 -->
<g id="edge340" class="edge">
<title>expert2_1_linear1_2&#45;&gt;expert2_1_gelu_2</title>
<path fill="none" stroke="black" d="M3753,-7025.42C3753,-7025.42 3753,-6949.94 3753,-6949.94"/>
<polygon fill="black" stroke="black" points="3756.5,-6949.94 3753,-6939.94 3749.5,-6949.94 3756.5,-6949.94"/>
</g>
<!-- expert2_1_linear2_2 -->
<g id="node228" class="node">
<title>expert2_1_linear2_2</title>
<polygon fill="lightcoral" stroke="black" points="3834,-6800.72 3696,-6800.72 3696,-6747.72 3834,-6747.72 3834,-6800.72"/>
<text text-anchor="middle" x="3765" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="3765" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="3765" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert2_1_gelu_2&#45;&gt;expert2_1_linear2_2 -->
<g id="edge341" class="edge">
<title>expert2_1_gelu_2&#45;&gt;expert2_1_linear2_2</title>
<path fill="none" stroke="black" d="M3765,-6886.42C3765,-6886.42 3765,-6810.94 3765,-6810.94"/>
<polygon fill="black" stroke="black" points="3768.5,-6810.94 3765,-6800.94 3761.5,-6810.94 3768.5,-6810.94"/>
</g>
<!-- expert2_1_agg -->
<g id="node232" class="node">
<title>expert2_1_agg</title>
<polygon fill="lightgreen" stroke="black" points="4012.11,-6661.72 3639.69,-6661.72 3543.89,-6555.72 3916.31,-6555.72 4012.11,-6661.72"/>
<text text-anchor="middle" x="3778" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 1 Output Aggregation</text>
<text text-anchor="middle" x="3778" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="3778" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 2,3</text>
</g>
<!-- expert2_1_linear2_2&#45;&gt;expert2_1_agg -->
<g id="edge342" class="edge">
<title>expert2_1_linear2_2&#45;&gt;expert2_1_agg</title>
<path fill="none" stroke="black" d="M3765,-6747.63C3765,-6747.63 3765,-6671.99 3765,-6671.99"/>
<polygon fill="black" stroke="black" points="3768.5,-6671.99 3765,-6661.99 3761.5,-6671.99 3768.5,-6671.99"/>
</g>
<!-- expert2_1_gelu_3 -->
<g id="node230" class="node">
<title>expert2_1_gelu_3</title>
<polygon fill="lightblue" stroke="black" points="4100.5,-6939.72 3907.5,-6939.72 3907.5,-6886.72 4100.5,-6886.72 4100.5,-6939.72"/>
<text text-anchor="middle" x="4004" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="4004" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4004" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert2_1_linear1_3&#45;&gt;expert2_1_gelu_3 -->
<g id="edge344" class="edge">
<title>expert2_1_linear1_3&#45;&gt;expert2_1_gelu_3</title>
<path fill="none" stroke="black" d="M4004,-7025.42C4004,-7025.42 4004,-6949.94 4004,-6949.94"/>
<polygon fill="black" stroke="black" points="4007.5,-6949.94 4004,-6939.94 4000.5,-6949.94 4007.5,-6949.94"/>
</g>
<!-- expert2_1_linear2_3 -->
<g id="node231" class="node">
<title>expert2_1_linear2_3</title>
<polygon fill="lightcoral" stroke="black" points="4057,-6800.72 3919,-6800.72 3919,-6747.72 4057,-6747.72 4057,-6800.72"/>
<text text-anchor="middle" x="3988" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="3988" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="3988" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert2_1_gelu_3&#45;&gt;expert2_1_linear2_3 -->
<g id="edge345" class="edge">
<title>expert2_1_gelu_3&#45;&gt;expert2_1_linear2_3</title>
<path fill="none" stroke="black" d="M3988,-6886.42C3988,-6886.42 3988,-6810.94 3988,-6810.94"/>
<polygon fill="black" stroke="black" points="3991.5,-6810.94 3988,-6800.94 3984.5,-6810.94 3991.5,-6810.94"/>
</g>
<!-- expert2_1_linear2_3&#45;&gt;expert2_1_agg -->
<g id="edge346" class="edge">
<title>expert2_1_linear2_3&#45;&gt;expert2_1_agg</title>
<path fill="none" stroke="black" d="M3965.65,-6747.63C3965.65,-6747.63 3965.65,-6671.99 3965.65,-6671.99"/>
<polygon fill="black" stroke="black" points="3969.15,-6671.99 3965.65,-6661.99 3962.15,-6671.99 3969.15,-6671.99"/>
</g>
<!-- expert2_1_agg&#45;&gt;expert_outputs2 -->
<g id="edge347" class="edge">
<title>expert2_1_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M3994.44,-6608.57C3994.44,-6602.43 3994.44,-6406 3994.44,-6406 3994.44,-6406 5157.83,-6406 5157.83,-6406"/>
<polygon fill="black" stroke="black" points="5157.83,-6409.5 5167.83,-6406 5157.83,-6402.5 5157.83,-6409.5"/>
</g>
<!-- expert2_2_gelu_4 -->
<g id="node234" class="node">
<title>expert2_2_gelu_4</title>
<polygon fill="lightblue" stroke="black" points="4351.5,-6939.72 4158.5,-6939.72 4158.5,-6886.72 4351.5,-6886.72 4351.5,-6939.72"/>
<text text-anchor="middle" x="4255" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4255" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4255" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert2_2_linear1_4&#45;&gt;expert2_2_gelu_4 -->
<g id="edge349" class="edge">
<title>expert2_2_linear1_4&#45;&gt;expert2_2_gelu_4</title>
<path fill="none" stroke="black" d="M4255,-7025.42C4255,-7025.42 4255,-6949.94 4255,-6949.94"/>
<polygon fill="black" stroke="black" points="4258.5,-6949.94 4255,-6939.94 4251.5,-6949.94 4258.5,-6949.94"/>
</g>
<!-- expert2_2_linear2_4 -->
<g id="node235" class="node">
<title>expert2_2_linear2_4</title>
<polygon fill="lightcoral" stroke="black" points="4338,-6800.72 4200,-6800.72 4200,-6747.72 4338,-6747.72 4338,-6800.72"/>
<text text-anchor="middle" x="4269" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="4269" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4269" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert2_2_gelu_4&#45;&gt;expert2_2_linear2_4 -->
<g id="edge350" class="edge">
<title>expert2_2_gelu_4&#45;&gt;expert2_2_linear2_4</title>
<path fill="none" stroke="black" d="M4269,-6886.42C4269,-6886.42 4269,-6810.94 4269,-6810.94"/>
<polygon fill="black" stroke="black" points="4272.5,-6810.94 4269,-6800.94 4265.5,-6810.94 4272.5,-6810.94"/>
</g>
<!-- expert2_2_agg -->
<g id="node239" class="node">
<title>expert2_2_agg</title>
<polygon fill="lightgreen" stroke="black" points="4539.11,-6661.72 4166.69,-6661.72 4070.89,-6555.72 4443.31,-6555.72 4539.11,-6661.72"/>
<text text-anchor="middle" x="4305" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 2 Output Aggregation</text>
<text text-anchor="middle" x="4305" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="4305" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 4,5</text>
</g>
<!-- expert2_2_linear2_4&#45;&gt;expert2_2_agg -->
<g id="edge351" class="edge">
<title>expert2_2_linear2_4&#45;&gt;expert2_2_agg</title>
<path fill="none" stroke="black" d="M4269,-6747.63C4269,-6747.63 4269,-6671.99 4269,-6671.99"/>
<polygon fill="black" stroke="black" points="4272.5,-6671.99 4269,-6661.99 4265.5,-6671.99 4272.5,-6671.99"/>
</g>
<!-- expert2_2_gelu_5 -->
<g id="node237" class="node">
<title>expert2_2_gelu_5</title>
<polygon fill="lightblue" stroke="black" points="4602.5,-6939.72 4409.5,-6939.72 4409.5,-6886.72 4602.5,-6886.72 4602.5,-6939.72"/>
<text text-anchor="middle" x="4506" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4506" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4506" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert2_2_linear1_5&#45;&gt;expert2_2_gelu_5 -->
<g id="edge353" class="edge">
<title>expert2_2_linear1_5&#45;&gt;expert2_2_gelu_5</title>
<path fill="none" stroke="black" d="M4506,-7025.42C4506,-7025.42 4506,-6949.94 4506,-6949.94"/>
<polygon fill="black" stroke="black" points="4509.5,-6949.94 4506,-6939.94 4502.5,-6949.94 4509.5,-6949.94"/>
</g>
<!-- expert2_2_linear2_5 -->
<g id="node238" class="node">
<title>expert2_2_linear2_5</title>
<polygon fill="lightcoral" stroke="black" points="4561,-6800.72 4423,-6800.72 4423,-6747.72 4561,-6747.72 4561,-6800.72"/>
<text text-anchor="middle" x="4492" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="4492" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4492" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert2_2_gelu_5&#45;&gt;expert2_2_linear2_5 -->
<g id="edge354" class="edge">
<title>expert2_2_gelu_5&#45;&gt;expert2_2_linear2_5</title>
<path fill="none" stroke="black" d="M4492,-6886.42C4492,-6886.42 4492,-6810.94 4492,-6810.94"/>
<polygon fill="black" stroke="black" points="4495.5,-6810.94 4492,-6800.94 4488.5,-6810.94 4495.5,-6810.94"/>
</g>
<!-- expert2_2_linear2_5&#45;&gt;expert2_2_agg -->
<g id="edge355" class="edge">
<title>expert2_2_linear2_5&#45;&gt;expert2_2_agg</title>
<path fill="none" stroke="black" d="M4481.15,-6747.63C4481.15,-6747.63 4481.15,-6671.99 4481.15,-6671.99"/>
<polygon fill="black" stroke="black" points="4484.65,-6671.99 4481.15,-6661.99 4477.65,-6671.99 4484.65,-6671.99"/>
</g>
<!-- expert2_2_agg&#45;&gt;expert_outputs2 -->
<g id="edge356" class="edge">
<title>expert2_2_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M4516.9,-6608.59C4516.9,-6603.09 4516.9,-6427 4516.9,-6427 4516.9,-6427 5176.56,-6427 5176.56,-6427"/>
<polygon fill="black" stroke="black" points="5176.56,-6430.5 5186.56,-6427 5176.56,-6423.5 5176.56,-6430.5"/>
</g>
<!-- expert2_3_gelu_6 -->
<g id="node241" class="node">
<title>expert2_3_gelu_6</title>
<polygon fill="lightblue" stroke="black" points="4853.5,-6939.72 4660.5,-6939.72 4660.5,-6886.72 4853.5,-6886.72 4853.5,-6939.72"/>
<text text-anchor="middle" x="4757" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="4757" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4757" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert2_3_linear1_6&#45;&gt;expert2_3_gelu_6 -->
<g id="edge358" class="edge">
<title>expert2_3_linear1_6&#45;&gt;expert2_3_gelu_6</title>
<path fill="none" stroke="black" d="M4757,-7025.42C4757,-7025.42 4757,-6949.94 4757,-6949.94"/>
<polygon fill="black" stroke="black" points="4760.5,-6949.94 4757,-6939.94 4753.5,-6949.94 4760.5,-6949.94"/>
</g>
<!-- expert2_3_linear2_6 -->
<g id="node242" class="node">
<title>expert2_3_linear2_6</title>
<polygon fill="lightcoral" stroke="black" points="4840,-6800.72 4702,-6800.72 4702,-6747.72 4840,-6747.72 4840,-6800.72"/>
<text text-anchor="middle" x="4771" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="4771" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4771" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert2_3_gelu_6&#45;&gt;expert2_3_linear2_6 -->
<g id="edge359" class="edge">
<title>expert2_3_gelu_6&#45;&gt;expert2_3_linear2_6</title>
<path fill="none" stroke="black" d="M4771,-6886.42C4771,-6886.42 4771,-6810.94 4771,-6810.94"/>
<polygon fill="black" stroke="black" points="4774.5,-6810.94 4771,-6800.94 4767.5,-6810.94 4774.5,-6810.94"/>
</g>
<!-- expert2_3_agg -->
<g id="node246" class="node">
<title>expert2_3_agg</title>
<polygon fill="lightgreen" stroke="black" points="5066.11,-6661.72 4693.69,-6661.72 4597.89,-6555.72 4970.31,-6555.72 5066.11,-6661.72"/>
<text text-anchor="middle" x="4832" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 3 Output Aggregation</text>
<text text-anchor="middle" x="4832" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="4832" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 6,7</text>
</g>
<!-- expert2_3_linear2_6&#45;&gt;expert2_3_agg -->
<g id="edge360" class="edge">
<title>expert2_3_linear2_6&#45;&gt;expert2_3_agg</title>
<path fill="none" stroke="black" d="M4771,-6747.63C4771,-6747.63 4771,-6671.99 4771,-6671.99"/>
<polygon fill="black" stroke="black" points="4774.5,-6671.99 4771,-6661.99 4767.5,-6671.99 4774.5,-6671.99"/>
</g>
<!-- expert2_3_gelu_7 -->
<g id="node244" class="node">
<title>expert2_3_gelu_7</title>
<polygon fill="lightblue" stroke="black" points="5104.5,-6939.72 4911.5,-6939.72 4911.5,-6886.72 5104.5,-6886.72 5104.5,-6939.72"/>
<text text-anchor="middle" x="5008" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="5008" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5008" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert2_3_linear1_7&#45;&gt;expert2_3_gelu_7 -->
<g id="edge362" class="edge">
<title>expert2_3_linear1_7&#45;&gt;expert2_3_gelu_7</title>
<path fill="none" stroke="black" d="M5008,-7025.42C5008,-7025.42 5008,-6949.94 5008,-6949.94"/>
<polygon fill="black" stroke="black" points="5011.5,-6949.94 5008,-6939.94 5004.5,-6949.94 5011.5,-6949.94"/>
</g>
<!-- expert2_3_linear2_7 -->
<g id="node245" class="node">
<title>expert2_3_linear2_7</title>
<polygon fill="lightcoral" stroke="black" points="5063,-6800.72 4925,-6800.72 4925,-6747.72 5063,-6747.72 5063,-6800.72"/>
<text text-anchor="middle" x="4994" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="4994" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4994" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert2_3_gelu_7&#45;&gt;expert2_3_linear2_7 -->
<g id="edge363" class="edge">
<title>expert2_3_gelu_7&#45;&gt;expert2_3_linear2_7</title>
<path fill="none" stroke="black" d="M4994,-6886.42C4994,-6886.42 4994,-6810.94 4994,-6810.94"/>
<polygon fill="black" stroke="black" points="4997.5,-6810.94 4994,-6800.94 4990.5,-6810.94 4997.5,-6810.94"/>
</g>
<!-- expert2_3_linear2_7&#45;&gt;expert2_3_agg -->
<g id="edge364" class="edge">
<title>expert2_3_linear2_7&#45;&gt;expert2_3_agg</title>
<path fill="none" stroke="black" d="M4994,-6747.63C4994,-6747.63 4994,-6671.99 4994,-6671.99"/>
<polygon fill="black" stroke="black" points="4997.5,-6671.99 4994,-6661.99 4990.5,-6671.99 4997.5,-6671.99"/>
</g>
<!-- expert2_3_agg&#45;&gt;expert_outputs2 -->
<g id="edge365" class="edge">
<title>expert2_3_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M5017.83,-6608.26C5017.83,-6598.83 5017.83,-6448 5017.83,-6448 5017.83,-6448 5194.89,-6448 5194.89,-6448"/>
<polygon fill="black" stroke="black" points="5194.89,-6451.5 5204.89,-6448 5194.89,-6444.5 5194.89,-6451.5"/>
</g>
<!-- expert2_4_gelu_8 -->
<g id="node248" class="node">
<title>expert2_4_gelu_8</title>
<polygon fill="lightblue" stroke="black" points="5355.5,-6939.72 5162.5,-6939.72 5162.5,-6886.72 5355.5,-6886.72 5355.5,-6939.72"/>
<text text-anchor="middle" x="5259" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="5259" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5259" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert2_4_linear1_8&#45;&gt;expert2_4_gelu_8 -->
<g id="edge367" class="edge">
<title>expert2_4_linear1_8&#45;&gt;expert2_4_gelu_8</title>
<path fill="none" stroke="black" d="M5259,-7025.42C5259,-7025.42 5259,-6949.94 5259,-6949.94"/>
<polygon fill="black" stroke="black" points="5262.5,-6949.94 5259,-6939.94 5255.5,-6949.94 5262.5,-6949.94"/>
</g>
<!-- expert2_4_linear2_8 -->
<g id="node249" class="node">
<title>expert2_4_linear2_8</title>
<polygon fill="lightcoral" stroke="black" points="5342,-6800.72 5204,-6800.72 5204,-6747.72 5342,-6747.72 5342,-6800.72"/>
<text text-anchor="middle" x="5273" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="5273" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5273" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert2_4_gelu_8&#45;&gt;expert2_4_linear2_8 -->
<g id="edge368" class="edge">
<title>expert2_4_gelu_8&#45;&gt;expert2_4_linear2_8</title>
<path fill="none" stroke="black" d="M5273,-6886.42C5273,-6886.42 5273,-6810.94 5273,-6810.94"/>
<polygon fill="black" stroke="black" points="5276.5,-6810.94 5273,-6800.94 5269.5,-6810.94 5276.5,-6810.94"/>
</g>
<!-- expert2_4_agg -->
<g id="node253" class="node">
<title>expert2_4_agg</title>
<polygon fill="lightgreen" stroke="black" points="5593.11,-6661.72 5220.69,-6661.72 5124.89,-6555.72 5497.31,-6555.72 5593.11,-6661.72"/>
<text text-anchor="middle" x="5359" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 4 Output Aggregation</text>
<text text-anchor="middle" x="5359" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5359" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 8,9</text>
</g>
<!-- expert2_4_linear2_8&#45;&gt;expert2_4_agg -->
<g id="edge369" class="edge">
<title>expert2_4_linear2_8&#45;&gt;expert2_4_agg</title>
<path fill="none" stroke="black" d="M5273,-6747.63C5273,-6747.63 5273,-6671.99 5273,-6671.99"/>
<polygon fill="black" stroke="black" points="5276.5,-6671.99 5273,-6661.99 5269.5,-6671.99 5276.5,-6671.99"/>
</g>
<!-- expert2_4_gelu_9 -->
<g id="node251" class="node">
<title>expert2_4_gelu_9</title>
<polygon fill="lightblue" stroke="black" points="5606.5,-6939.72 5413.5,-6939.72 5413.5,-6886.72 5606.5,-6886.72 5606.5,-6939.72"/>
<text text-anchor="middle" x="5510" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="5510" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5510" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert2_4_linear1_9&#45;&gt;expert2_4_gelu_9 -->
<g id="edge371" class="edge">
<title>expert2_4_linear1_9&#45;&gt;expert2_4_gelu_9</title>
<path fill="none" stroke="black" d="M5510,-7025.42C5510,-7025.42 5510,-6949.94 5510,-6949.94"/>
<polygon fill="black" stroke="black" points="5513.5,-6949.94 5510,-6939.94 5506.5,-6949.94 5513.5,-6949.94"/>
</g>
<!-- expert2_4_linear2_9 -->
<g id="node252" class="node">
<title>expert2_4_linear2_9</title>
<polygon fill="lightcoral" stroke="black" points="5565,-6800.72 5427,-6800.72 5427,-6747.72 5565,-6747.72 5565,-6800.72"/>
<text text-anchor="middle" x="5496" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="5496" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5496" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert2_4_gelu_9&#45;&gt;expert2_4_linear2_9 -->
<g id="edge372" class="edge">
<title>expert2_4_gelu_9&#45;&gt;expert2_4_linear2_9</title>
<path fill="none" stroke="black" d="M5496,-6886.42C5496,-6886.42 5496,-6810.94 5496,-6810.94"/>
<polygon fill="black" stroke="black" points="5499.5,-6810.94 5496,-6800.94 5492.5,-6810.94 5499.5,-6810.94"/>
</g>
<!-- expert2_4_linear2_9&#45;&gt;expert2_4_agg -->
<g id="edge373" class="edge">
<title>expert2_4_linear2_9&#45;&gt;expert2_4_agg</title>
<path fill="none" stroke="black" d="M5496,-6747.63C5496,-6747.63 5496,-6671.99 5496,-6671.99"/>
<polygon fill="black" stroke="black" points="5499.5,-6671.99 5496,-6661.99 5492.5,-6671.99 5499.5,-6671.99"/>
</g>
<!-- expert2_4_agg&#45;&gt;expert_outputs2 -->
<g id="edge374" class="edge">
<title>expert2_4_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M5359,-6555.49C5359,-6555.49 5359,-6480.05 5359,-6480.05"/>
<polygon fill="black" stroke="black" points="5362.5,-6480.05 5359,-6470.05 5355.5,-6480.05 5362.5,-6480.05"/>
</g>
<!-- expert2_5_gelu_10 -->
<g id="node255" class="node">
<title>expert2_5_gelu_10</title>
<polygon fill="lightblue" stroke="black" points="5857.5,-6939.72 5664.5,-6939.72 5664.5,-6886.72 5857.5,-6886.72 5857.5,-6939.72"/>
<text text-anchor="middle" x="5761" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="5761" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5761" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert2_5_linear1_10&#45;&gt;expert2_5_gelu_10 -->
<g id="edge376" class="edge">
<title>expert2_5_linear1_10&#45;&gt;expert2_5_gelu_10</title>
<path fill="none" stroke="black" d="M5761,-7025.42C5761,-7025.42 5761,-6949.94 5761,-6949.94"/>
<polygon fill="black" stroke="black" points="5764.5,-6949.94 5761,-6939.94 5757.5,-6949.94 5764.5,-6949.94"/>
</g>
<!-- expert2_5_linear2_10 -->
<g id="node256" class="node">
<title>expert2_5_linear2_10</title>
<polygon fill="lightcoral" stroke="black" points="5844,-6800.72 5706,-6800.72 5706,-6747.72 5844,-6747.72 5844,-6800.72"/>
<text text-anchor="middle" x="5775" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="5775" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5775" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert2_5_gelu_10&#45;&gt;expert2_5_linear2_10 -->
<g id="edge377" class="edge">
<title>expert2_5_gelu_10&#45;&gt;expert2_5_linear2_10</title>
<path fill="none" stroke="black" d="M5775,-6886.42C5775,-6886.42 5775,-6810.94 5775,-6810.94"/>
<polygon fill="black" stroke="black" points="5778.5,-6810.94 5775,-6800.94 5771.5,-6810.94 5778.5,-6810.94"/>
</g>
<!-- expert2_5_agg -->
<g id="node260" class="node">
<title>expert2_5_agg</title>
<polygon fill="lightgreen" stroke="black" points="6120.11,-6661.72 5747.69,-6661.72 5651.89,-6555.72 6024.31,-6555.72 6120.11,-6661.72"/>
<text text-anchor="middle" x="5886" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 5 Output Aggregation</text>
<text text-anchor="middle" x="5886" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5886" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 10,11</text>
</g>
<!-- expert2_5_linear2_10&#45;&gt;expert2_5_agg -->
<g id="edge378" class="edge">
<title>expert2_5_linear2_10&#45;&gt;expert2_5_agg</title>
<path fill="none" stroke="black" d="M5775,-6747.63C5775,-6747.63 5775,-6671.99 5775,-6671.99"/>
<polygon fill="black" stroke="black" points="5778.5,-6671.99 5775,-6661.99 5771.5,-6671.99 5778.5,-6671.99"/>
</g>
<!-- expert2_5_gelu_11 -->
<g id="node258" class="node">
<title>expert2_5_gelu_11</title>
<polygon fill="lightblue" stroke="black" points="6108.5,-6939.72 5915.5,-6939.72 5915.5,-6886.72 6108.5,-6886.72 6108.5,-6939.72"/>
<text text-anchor="middle" x="6012" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="6012" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6012" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert2_5_linear1_11&#45;&gt;expert2_5_gelu_11 -->
<g id="edge380" class="edge">
<title>expert2_5_linear1_11&#45;&gt;expert2_5_gelu_11</title>
<path fill="none" stroke="black" d="M6012,-7025.42C6012,-7025.42 6012,-6949.94 6012,-6949.94"/>
<polygon fill="black" stroke="black" points="6015.5,-6949.94 6012,-6939.94 6008.5,-6949.94 6015.5,-6949.94"/>
</g>
<!-- expert2_5_linear2_11 -->
<g id="node259" class="node">
<title>expert2_5_linear2_11</title>
<polygon fill="lightcoral" stroke="black" points="6067,-6800.72 5929,-6800.72 5929,-6747.72 6067,-6747.72 6067,-6800.72"/>
<text text-anchor="middle" x="5998" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="5998" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5998" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert2_5_gelu_11&#45;&gt;expert2_5_linear2_11 -->
<g id="edge381" class="edge">
<title>expert2_5_gelu_11&#45;&gt;expert2_5_linear2_11</title>
<path fill="none" stroke="black" d="M5998,-6886.42C5998,-6886.42 5998,-6810.94 5998,-6810.94"/>
<polygon fill="black" stroke="black" points="6001.5,-6810.94 5998,-6800.94 5994.5,-6810.94 6001.5,-6810.94"/>
</g>
<!-- expert2_5_linear2_11&#45;&gt;expert2_5_agg -->
<g id="edge382" class="edge">
<title>expert2_5_linear2_11&#45;&gt;expert2_5_agg</title>
<path fill="none" stroke="black" d="M5998,-6747.63C5998,-6747.63 5998,-6671.99 5998,-6671.99"/>
<polygon fill="black" stroke="black" points="6001.5,-6671.99 5998,-6661.99 5994.5,-6671.99 6001.5,-6671.99"/>
</g>
<!-- expert2_5_agg&#45;&gt;expert_outputs2 -->
<g id="edge383" class="edge">
<title>expert2_5_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M5758.07,-6555.65C5758.07,-6508.83 5758.07,-6448 5758.07,-6448 5758.07,-6448 5578.18,-6448 5578.18,-6448"/>
<polygon fill="black" stroke="black" points="5578.18,-6444.5 5568.18,-6448 5578.18,-6451.5 5578.18,-6444.5"/>
</g>
<!-- expert2_6_gelu_12 -->
<g id="node262" class="node">
<title>expert2_6_gelu_12</title>
<polygon fill="lightblue" stroke="black" points="6359.5,-6939.72 6166.5,-6939.72 6166.5,-6886.72 6359.5,-6886.72 6359.5,-6939.72"/>
<text text-anchor="middle" x="6263" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="6263" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6263" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert2_6_linear1_12&#45;&gt;expert2_6_gelu_12 -->
<g id="edge385" class="edge">
<title>expert2_6_linear1_12&#45;&gt;expert2_6_gelu_12</title>
<path fill="none" stroke="black" d="M6263,-7025.42C6263,-7025.42 6263,-6949.94 6263,-6949.94"/>
<polygon fill="black" stroke="black" points="6266.5,-6949.94 6263,-6939.94 6259.5,-6949.94 6266.5,-6949.94"/>
</g>
<!-- expert2_6_linear2_12 -->
<g id="node263" class="node">
<title>expert2_6_linear2_12</title>
<polygon fill="lightcoral" stroke="black" points="6346,-6800.72 6208,-6800.72 6208,-6747.72 6346,-6747.72 6346,-6800.72"/>
<text text-anchor="middle" x="6277" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="6277" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6277" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert2_6_gelu_12&#45;&gt;expert2_6_linear2_12 -->
<g id="edge386" class="edge">
<title>expert2_6_gelu_12&#45;&gt;expert2_6_linear2_12</title>
<path fill="none" stroke="black" d="M6277,-6886.42C6277,-6886.42 6277,-6810.94 6277,-6810.94"/>
<polygon fill="black" stroke="black" points="6280.5,-6810.94 6277,-6800.94 6273.5,-6810.94 6280.5,-6810.94"/>
</g>
<!-- expert2_6_agg -->
<g id="node267" class="node">
<title>expert2_6_agg</title>
<polygon fill="lightgreen" stroke="black" points="6647.11,-6661.72 6274.69,-6661.72 6178.89,-6555.72 6551.31,-6555.72 6647.11,-6661.72"/>
<text text-anchor="middle" x="6413" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 6 Output Aggregation</text>
<text text-anchor="middle" x="6413" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6413" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 12,13</text>
</g>
<!-- expert2_6_linear2_12&#45;&gt;expert2_6_agg -->
<g id="edge387" class="edge">
<title>expert2_6_linear2_12&#45;&gt;expert2_6_agg</title>
<path fill="none" stroke="black" d="M6277,-6747.63C6277,-6747.63 6277,-6671.99 6277,-6671.99"/>
<polygon fill="black" stroke="black" points="6280.5,-6671.99 6277,-6661.99 6273.5,-6671.99 6280.5,-6671.99"/>
</g>
<!-- expert2_6_gelu_13 -->
<g id="node265" class="node">
<title>expert2_6_gelu_13</title>
<polygon fill="lightblue" stroke="black" points="6610.5,-6939.72 6417.5,-6939.72 6417.5,-6886.72 6610.5,-6886.72 6610.5,-6939.72"/>
<text text-anchor="middle" x="6514" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="6514" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6514" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert2_6_linear1_13&#45;&gt;expert2_6_gelu_13 -->
<g id="edge389" class="edge">
<title>expert2_6_linear1_13&#45;&gt;expert2_6_gelu_13</title>
<path fill="none" stroke="black" d="M6514,-7025.42C6514,-7025.42 6514,-6949.94 6514,-6949.94"/>
<polygon fill="black" stroke="black" points="6517.5,-6949.94 6514,-6939.94 6510.5,-6949.94 6517.5,-6949.94"/>
</g>
<!-- expert2_6_linear2_13 -->
<g id="node266" class="node">
<title>expert2_6_linear2_13</title>
<polygon fill="lightcoral" stroke="black" points="6556,-6800.72 6418,-6800.72 6418,-6747.72 6556,-6747.72 6556,-6800.72"/>
<text text-anchor="middle" x="6487" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="6487" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6487" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert2_6_gelu_13&#45;&gt;expert2_6_linear2_13 -->
<g id="edge390" class="edge">
<title>expert2_6_gelu_13&#45;&gt;expert2_6_linear2_13</title>
<path fill="none" stroke="black" d="M6487,-6886.42C6487,-6886.42 6487,-6810.94 6487,-6810.94"/>
<polygon fill="black" stroke="black" points="6490.5,-6810.94 6487,-6800.94 6483.5,-6810.94 6490.5,-6810.94"/>
</g>
<!-- expert2_6_linear2_13&#45;&gt;expert2_6_agg -->
<g id="edge391" class="edge">
<title>expert2_6_linear2_13&#45;&gt;expert2_6_agg</title>
<path fill="none" stroke="black" d="M6487,-6747.63C6487,-6747.63 6487,-6671.99 6487,-6671.99"/>
<polygon fill="black" stroke="black" points="6490.5,-6671.99 6487,-6661.99 6483.5,-6671.99 6490.5,-6671.99"/>
</g>
<!-- expert2_6_agg&#45;&gt;expert_outputs2 -->
<g id="edge392" class="edge">
<title>expert2_6_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M6187.1,-6608.59C6187.1,-6603.09 6187.1,-6427 6187.1,-6427 6187.1,-6427 5559.76,-6427 5559.76,-6427"/>
<polygon fill="black" stroke="black" points="5559.76,-6423.5 5549.76,-6427 5559.76,-6430.5 5559.76,-6423.5"/>
</g>
<!-- expert2_7_gelu_14 -->
<g id="node269" class="node">
<title>expert2_7_gelu_14</title>
<polygon fill="lightblue" stroke="black" points="6861.5,-6939.72 6668.5,-6939.72 6668.5,-6886.72 6861.5,-6886.72 6861.5,-6939.72"/>
<text text-anchor="middle" x="6765" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="6765" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6765" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert2_7_linear1_14&#45;&gt;expert2_7_gelu_14 -->
<g id="edge394" class="edge">
<title>expert2_7_linear1_14&#45;&gt;expert2_7_gelu_14</title>
<path fill="none" stroke="black" d="M6765,-7025.42C6765,-7025.42 6765,-6949.94 6765,-6949.94"/>
<polygon fill="black" stroke="black" points="6768.5,-6949.94 6765,-6939.94 6761.5,-6949.94 6768.5,-6949.94"/>
</g>
<!-- expert2_7_linear2_14 -->
<g id="node270" class="node">
<title>expert2_7_linear2_14</title>
<polygon fill="lightcoral" stroke="black" points="6848,-6800.72 6710,-6800.72 6710,-6747.72 6848,-6747.72 6848,-6800.72"/>
<text text-anchor="middle" x="6779" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="6779" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6779" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert2_7_gelu_14&#45;&gt;expert2_7_linear2_14 -->
<g id="edge395" class="edge">
<title>expert2_7_gelu_14&#45;&gt;expert2_7_linear2_14</title>
<path fill="none" stroke="black" d="M6779,-6886.42C6779,-6886.42 6779,-6810.94 6779,-6810.94"/>
<polygon fill="black" stroke="black" points="6782.5,-6810.94 6779,-6800.94 6775.5,-6810.94 6782.5,-6810.94"/>
</g>
<!-- expert2_7_agg -->
<g id="node274" class="node">
<title>expert2_7_agg</title>
<polygon fill="lightgreen" stroke="black" points="7174.11,-6661.72 6801.69,-6661.72 6705.89,-6555.72 7078.31,-6555.72 7174.11,-6661.72"/>
<text text-anchor="middle" x="6940" y="-6620.02" font-family="Times,serif" font-size="14.00">Expert 7 Output Aggregation</text>
<text text-anchor="middle" x="6940" y="-6605.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6940" y="-6590.02" font-family="Times,serif" font-size="14.00">GPUs 14,15</text>
</g>
<!-- expert2_7_linear2_14&#45;&gt;expert2_7_agg -->
<g id="edge396" class="edge">
<title>expert2_7_linear2_14&#45;&gt;expert2_7_agg</title>
<path fill="none" stroke="black" d="M6779,-6747.63C6779,-6747.63 6779,-6646.63 6779,-6646.63"/>
<polygon fill="black" stroke="black" points="6782.5,-6646.63 6779,-6636.63 6775.5,-6646.63 6782.5,-6646.63"/>
</g>
<!-- expert2_7_gelu_15 -->
<g id="node272" class="node">
<title>expert2_7_gelu_15</title>
<polygon fill="lightblue" stroke="black" points="7112.5,-6939.72 6919.5,-6939.72 6919.5,-6886.72 7112.5,-6886.72 7112.5,-6939.72"/>
<text text-anchor="middle" x="7016" y="-6924.52" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="7016" y="-6909.52" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7016" y="-6894.52" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert2_7_linear1_15&#45;&gt;expert2_7_gelu_15 -->
<g id="edge398" class="edge">
<title>expert2_7_linear1_15&#45;&gt;expert2_7_gelu_15</title>
<path fill="none" stroke="black" d="M7016,-7025.42C7016,-7025.42 7016,-6949.94 7016,-6949.94"/>
<polygon fill="black" stroke="black" points="7019.5,-6949.94 7016,-6939.94 7012.5,-6949.94 7019.5,-6949.94"/>
</g>
<!-- expert2_7_linear2_15 -->
<g id="node273" class="node">
<title>expert2_7_linear2_15</title>
<polygon fill="lightcoral" stroke="black" points="7058,-6800.72 6920,-6800.72 6920,-6747.72 7058,-6747.72 7058,-6800.72"/>
<text text-anchor="middle" x="6989" y="-6785.52" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="6989" y="-6770.52" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6989" y="-6755.52" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert2_7_gelu_15&#45;&gt;expert2_7_linear2_15 -->
<g id="edge399" class="edge">
<title>expert2_7_gelu_15&#45;&gt;expert2_7_linear2_15</title>
<path fill="none" stroke="black" d="M6989,-6886.42C6989,-6886.42 6989,-6810.94 6989,-6810.94"/>
<polygon fill="black" stroke="black" points="6992.5,-6810.94 6989,-6800.94 6985.5,-6810.94 6992.5,-6810.94"/>
</g>
<!-- expert2_7_linear2_15&#45;&gt;expert2_7_agg -->
<g id="edge400" class="edge">
<title>expert2_7_linear2_15&#45;&gt;expert2_7_agg</title>
<path fill="none" stroke="black" d="M6989,-6747.63C6989,-6747.63 6989,-6671.99 6989,-6671.99"/>
<polygon fill="black" stroke="black" points="6992.5,-6671.99 6989,-6661.99 6985.5,-6671.99 6992.5,-6671.99"/>
</g>
<!-- expert2_7_agg&#45;&gt;expert_outputs2 -->
<g id="edge401" class="edge">
<title>expert2_7_agg&#45;&gt;expert_outputs2</title>
<path fill="none" stroke="black" d="M6734.1,-6555.46C6734.1,-6495.4 6734.1,-6406 6734.1,-6406 6734.1,-6406 5541.07,-6406 5541.07,-6406"/>
<polygon fill="black" stroke="black" points="5541.07,-6402.5 5531.07,-6406 5541.07,-6409.5 5541.07,-6402.5"/>
</g>
<!-- weighted_sum2 -->
<g id="node276" class="node">
<title>weighted_sum2</title>
<polygon fill="lightgreen" stroke="black" points="5864.39,-6277.72 5664.92,-6277.72 5613.61,-6171.72 5813.08,-6171.72 5864.39,-6277.72"/>
<text text-anchor="middle" x="5739" y="-6236.02" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="5739" y="-6221.02" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5739" y="-6206.02" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_outputs2&#45;&gt;weighted_sum2 -->
<g id="edge402" class="edge">
<title>expert_outputs2&#45;&gt;weighted_sum2</title>
<path fill="none" stroke="black" d="M5511.81,-6384C5574.49,-6384 5632.62,-6384 5632.62,-6384 5632.62,-6384 5632.62,-6234.84 5632.62,-6234.84"/>
<polygon fill="black" stroke="black" points="5636.12,-6234.84 5632.62,-6224.84 5629.12,-6234.84 5636.12,-6234.84"/>
</g>
<!-- weighted_sum2&#45;&gt;residual2_2 -->
<g id="edge403" class="edge">
<title>weighted_sum2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M5743,-6171.29C5743,-6171.29 5743,-6095.82 5743,-6095.82"/>
<polygon fill="black" stroke="black" points="5746.5,-6095.82 5743,-6085.82 5739.5,-6095.82 5746.5,-6095.82"/>
</g>
<!-- ln3_0 -->
<g id="node278" class="node">
<title>ln3_0</title>
<polygon fill="lightblue" stroke="black" points="7880,-5924.77 7782,-5924.77 7782,-5871.77 7880,-5871.77 7880,-5924.77"/>
<text text-anchor="middle" x="7831" y="-5909.57" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7831" y="-5894.57" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7831" y="-5879.57" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- residual2_2&#45;&gt;ln3_0 -->
<g id="edge405" class="edge">
<title>residual2_2&#45;&gt;ln3_0</title>
<path fill="none" stroke="black" d="M5804.75,-6025.32C5804.75,-5988.43 5804.75,-5920 5804.75,-5920 5804.75,-5920 7771.92,-5920 7771.92,-5920"/>
<polygon fill="black" stroke="black" points="7771.92,-5923.5 7781.92,-5920 7771.92,-5916.5 7771.92,-5923.5"/>
</g>
<!-- ln3_1 -->
<g id="node279" class="node">
<title>ln3_1</title>
<polygon fill="lightblue" stroke="black" points="5792,-5924.77 5694,-5924.77 5694,-5871.77 5792,-5871.77 5792,-5924.77"/>
<text text-anchor="middle" x="5743" y="-5909.57" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5743" y="-5894.57" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5743" y="-5879.57" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- residual2_2&#45;&gt;ln3_1 -->
<g id="edge435" class="edge">
<title>residual2_2&#45;&gt;ln3_1</title>
<path fill="none" stroke="black" d="M5743,-6010.4C5743,-6010.4 5743,-5935.22 5743,-5935.22"/>
<polygon fill="black" stroke="black" points="5746.5,-5935.22 5743,-5925.22 5739.5,-5935.22 5746.5,-5935.22"/>
</g>
<!-- ln3_2 -->
<g id="node280" class="node">
<title>ln3_2</title>
<polygon fill="lightblue" stroke="black" points="3533,-5924.77 3435,-5924.77 3435,-5871.77 3533,-5871.77 3533,-5924.77"/>
<text text-anchor="middle" x="3484" y="-5909.57" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="3484" y="-5894.57" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="3484" y="-5879.57" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- residual2_2&#45;&gt;ln3_2 -->
<g id="edge465" class="edge">
<title>residual2_2&#45;&gt;ln3_2</title>
<path fill="none" stroke="black" d="M5675.86,-6029.32C5675.86,-5993.65 5675.86,-5920 5675.86,-5920 5675.86,-5920 3543.11,-5920 3543.11,-5920"/>
<polygon fill="black" stroke="black" points="3543.11,-5916.5 3533.11,-5920 3543.11,-5923.5 3543.11,-5916.5"/>
</g>
<!-- ln3_3 -->
<g id="node281" class="node">
<title>ln3_3</title>
<polygon fill="lightblue" stroke="black" points="1265,-5924.77 1167,-5924.77 1167,-5871.77 1265,-5871.77 1265,-5924.77"/>
<text text-anchor="middle" x="1216" y="-5909.57" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="1216" y="-5894.57" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="1216" y="-5879.57" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- residual2_2&#45;&gt;ln3_3 -->
<g id="edge495" class="edge">
<title>residual2_2&#45;&gt;ln3_3</title>
<path fill="none" stroke="black" d="M5664.92,-6048C5067.53,-6048 1244.25,-6048 1244.25,-6048 1244.25,-6048 1244.25,-5935.04 1244.25,-5935.04"/>
<polygon fill="black" stroke="black" points="1247.75,-5935.04 1244.25,-5925.04 1240.75,-5935.04 1247.75,-5935.04"/>
</g>
<!-- residual3_1 -->
<g id="node352" class="node">
<title>residual3_1</title>
<ellipse fill="yellow" stroke="black" cx="8906" cy="-4947.29" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="8906" y="-4958.59" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="8906" y="-4943.59" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8906" y="-4928.59" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual2_2&#45;&gt;residual3_1 -->
<g id="edge527" class="edge">
<title>residual2_2&#45;&gt;residual3_1</title>
<path fill="none" stroke="black" d="M5816.12,-6035C6285.53,-6035 8856,-6035 8856,-6035 8856,-6035 8856,-4986.1 8856,-4986.1"/>
<polygon fill="black" stroke="black" points="8859.5,-4986.1 8856,-4976.1 8852.5,-4986.1 8859.5,-4986.1"/>
</g>
<!-- q_proj_3_0_0 -->
<g id="node282" class="node">
<title>q_proj_3_0_0</title>
<polygon fill="lightcoral" stroke="black" points="6951.5,-5785.77 6820.5,-5785.77 6820.5,-5732.77 6951.5,-5732.77 6951.5,-5785.77"/>
<text text-anchor="middle" x="6886" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6886" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6886" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln3_0&#45;&gt;q_proj_3_0_0 -->
<g id="edge406" class="edge">
<title>ln3_0&#45;&gt;q_proj_3_0_0</title>
<path fill="none" stroke="black" d="M7781.85,-5911C7587.88,-5911 6886,-5911 6886,-5911 6886,-5911 6886,-5796.04 6886,-5796.04"/>
<polygon fill="black" stroke="black" points="6889.5,-5796.04 6886,-5786.04 6882.5,-5796.04 6889.5,-5796.04"/>
</g>
<!-- k_proj_3_0_0 -->
<g id="node283" class="node">
<title>k_proj_3_0_0</title>
<polygon fill="lightcoral" stroke="black" points="7140.5,-5785.77 7009.5,-5785.77 7009.5,-5732.77 7140.5,-5732.77 7140.5,-5785.77"/>
<text text-anchor="middle" x="7075" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7075" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7075" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln3_0&#45;&gt;k_proj_3_0_0 -->
<g id="edge407" class="edge">
<title>ln3_0&#45;&gt;k_proj_3_0_0</title>
<path fill="none" stroke="black" d="M7781.98,-5902C7614.45,-5902 7075,-5902 7075,-5902 7075,-5902 7075,-5795.78 7075,-5795.78"/>
<polygon fill="black" stroke="black" points="7078.5,-5795.78 7075,-5785.78 7071.5,-5795.78 7078.5,-5795.78"/>
</g>
<!-- v_proj_3_0_0 -->
<g id="node284" class="node">
<title>v_proj_3_0_0</title>
<polygon fill="lightcoral" stroke="black" points="7329.5,-5785.77 7198.5,-5785.77 7198.5,-5732.77 7329.5,-5732.77 7329.5,-5785.77"/>
<text text-anchor="middle" x="7264" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7264" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7264" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln3_0&#45;&gt;v_proj_3_0_0 -->
<g id="edge408" class="edge">
<title>ln3_0&#45;&gt;v_proj_3_0_0</title>
<path fill="none" stroke="black" d="M7781.6,-5893C7649.1,-5893 7295.75,-5893 7295.75,-5893 7295.75,-5893 7295.75,-5796.01 7295.75,-5796.01"/>
<polygon fill="black" stroke="black" points="7299.25,-5796.01 7295.75,-5786.01 7292.25,-5796.01 7299.25,-5796.01"/>
</g>
<!-- q_proj_3_0_1 -->
<g id="node286" class="node">
<title>q_proj_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7518.5,-5785.77 7387.5,-5785.77 7387.5,-5732.77 7518.5,-5732.77 7518.5,-5785.77"/>
<text text-anchor="middle" x="7453" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7453" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7453" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln3_0&#45;&gt;q_proj_3_0_1 -->
<g id="edge413" class="edge">
<title>ln3_0&#45;&gt;q_proj_3_0_1</title>
<path fill="none" stroke="black" d="M7781.86,-5885C7691.87,-5885 7509.75,-5885 7509.75,-5885 7509.75,-5885 7509.75,-5795.93 7509.75,-5795.93"/>
<polygon fill="black" stroke="black" points="7513.25,-5795.93 7509.75,-5785.93 7506.25,-5795.93 7513.25,-5795.93"/>
</g>
<!-- k_proj_3_0_1 -->
<g id="node287" class="node">
<title>k_proj_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7707.5,-5785.77 7576.5,-5785.77 7576.5,-5732.77 7707.5,-5732.77 7707.5,-5785.77"/>
<text text-anchor="middle" x="7642" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7642" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7642" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln3_0&#45;&gt;k_proj_3_0_1 -->
<g id="edge414" class="edge">
<title>ln3_0&#45;&gt;k_proj_3_0_1</title>
<path fill="none" stroke="black" d="M7781.6,-5876C7735.41,-5876 7673.5,-5876 7673.5,-5876 7673.5,-5876 7673.5,-5796.05 7673.5,-5796.05"/>
<polygon fill="black" stroke="black" points="7677,-5796.05 7673.5,-5786.05 7670,-5796.05 7677,-5796.05"/>
</g>
<!-- v_proj_3_0_1 -->
<g id="node288" class="node">
<title>v_proj_3_0_1</title>
<polygon fill="lightcoral" stroke="black" points="7896.5,-5785.77 7765.5,-5785.77 7765.5,-5732.77 7896.5,-5732.77 7896.5,-5785.77"/>
<text text-anchor="middle" x="7831" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7831" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7831" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln3_0&#45;&gt;v_proj_3_0_1 -->
<g id="edge415" class="edge">
<title>ln3_0&#45;&gt;v_proj_3_0_1</title>
<path fill="none" stroke="black" d="M7831,-5871.47C7831,-5871.47 7831,-5795.98 7831,-5795.98"/>
<polygon fill="black" stroke="black" points="7834.5,-5795.98 7831,-5785.98 7827.5,-5795.98 7834.5,-5795.98"/>
</g>
<!-- q_proj_3_0_2 -->
<g id="node290" class="node">
<title>q_proj_3_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8085.5,-5785.77 7954.5,-5785.77 7954.5,-5732.77 8085.5,-5732.77 8085.5,-5785.77"/>
<text text-anchor="middle" x="8020" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8020" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8020" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln3_0&#45;&gt;q_proj_3_0_2 -->
<g id="edge420" class="edge">
<title>ln3_0&#45;&gt;q_proj_3_0_2</title>
<path fill="none" stroke="black" d="M7880.12,-5879C7933.34,-5879 8010.75,-5879 8010.75,-5879 8010.75,-5879 8010.75,-5795.84 8010.75,-5795.84"/>
<polygon fill="black" stroke="black" points="8014.25,-5795.84 8010.75,-5785.84 8007.25,-5795.84 8014.25,-5795.84"/>
</g>
<!-- k_proj_3_0_2 -->
<g id="node291" class="node">
<title>k_proj_3_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8274.5,-5785.77 8143.5,-5785.77 8143.5,-5732.77 8274.5,-5732.77 8274.5,-5785.77"/>
<text text-anchor="middle" x="8209" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8209" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8209" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln3_0&#45;&gt;k_proj_3_0_2 -->
<g id="edge421" class="edge">
<title>ln3_0&#45;&gt;k_proj_3_0_2</title>
<path fill="none" stroke="black" d="M7880.27,-5886C7971.02,-5886 8155.4,-5886 8155.4,-5886 8155.4,-5886 8155.4,-5795.83 8155.4,-5795.83"/>
<polygon fill="black" stroke="black" points="8158.9,-5795.83 8155.4,-5785.83 8151.9,-5795.83 8158.9,-5795.83"/>
</g>
<!-- v_proj_3_0_2 -->
<g id="node292" class="node">
<title>v_proj_3_0_2</title>
<polygon fill="lightcoral" stroke="black" points="8463.5,-5785.77 8332.5,-5785.77 8332.5,-5732.77 8463.5,-5732.77 8463.5,-5785.77"/>
<text text-anchor="middle" x="8398" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8398" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8398" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln3_0&#45;&gt;v_proj_3_0_2 -->
<g id="edge422" class="edge">
<title>ln3_0&#45;&gt;v_proj_3_0_2</title>
<path fill="none" stroke="black" d="M7880.01,-5894C8008.81,-5894 8347,-5894 8347,-5894 8347,-5894 8347,-5795.89 8347,-5795.89"/>
<polygon fill="black" stroke="black" points="8350.5,-5795.89 8347,-5785.89 8343.5,-5795.89 8350.5,-5795.89"/>
</g>
<!-- q_proj_3_0_3 -->
<g id="node294" class="node">
<title>q_proj_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8652.5,-5785.77 8521.5,-5785.77 8521.5,-5732.77 8652.5,-5732.77 8652.5,-5785.77"/>
<text text-anchor="middle" x="8587" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8587" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8587" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln3_0&#45;&gt;q_proj_3_0_3 -->
<g id="edge427" class="edge">
<title>ln3_0&#45;&gt;q_proj_3_0_3</title>
<path fill="none" stroke="black" d="M7880.01,-5902C8039.89,-5902 8536,-5902 8536,-5902 8536,-5902 8536,-5795.78 8536,-5795.78"/>
<polygon fill="black" stroke="black" points="8539.5,-5795.78 8536,-5785.78 8532.5,-5795.78 8539.5,-5795.78"/>
</g>
<!-- k_proj_3_0_3 -->
<g id="node295" class="node">
<title>k_proj_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="8841.5,-5785.77 8710.5,-5785.77 8710.5,-5732.77 8841.5,-5732.77 8841.5,-5785.77"/>
<text text-anchor="middle" x="8776" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8776" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8776" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln3_0&#45;&gt;k_proj_3_0_3 -->
<g id="edge428" class="edge">
<title>ln3_0&#45;&gt;k_proj_3_0_3</title>
<path fill="none" stroke="black" d="M7880.02,-5909C8072.66,-5909 8767.25,-5909 8767.25,-5909 8767.25,-5909 8767.25,-5796.04 8767.25,-5796.04"/>
<polygon fill="black" stroke="black" points="8770.75,-5796.04 8767.25,-5786.04 8763.75,-5796.04 8770.75,-5796.04"/>
</g>
<!-- v_proj_3_0_3 -->
<g id="node296" class="node">
<title>v_proj_3_0_3</title>
<polygon fill="lightcoral" stroke="black" points="9030.5,-5785.77 8899.5,-5785.77 8899.5,-5732.77 9030.5,-5732.77 9030.5,-5785.77"/>
<text text-anchor="middle" x="8965" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8965" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8965" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln3_0&#45;&gt;v_proj_3_0_3 -->
<g id="edge429" class="edge">
<title>ln3_0&#45;&gt;v_proj_3_0_3</title>
<path fill="none" stroke="black" d="M7880.27,-5917C8091.79,-5917 8912.25,-5917 8912.25,-5917 8912.25,-5917 8912.25,-5796.02 8912.25,-5796.02"/>
<polygon fill="black" stroke="black" points="8915.75,-5796.02 8912.25,-5786.02 8908.75,-5796.02 8915.75,-5796.02"/>
</g>
<!-- q_proj_3_1_0 -->
<g id="node298" class="node">
<title>q_proj_3_1_0</title>
<polygon fill="lightcoral" stroke="black" points="4683.5,-5785.77 4552.5,-5785.77 4552.5,-5732.77 4683.5,-5732.77 4683.5,-5785.77"/>
<text text-anchor="middle" x="4618" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4618" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4618" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_0 -->
<g id="edge436" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_0</title>
<path fill="none" stroke="black" d="M5693.85,-5916C5479.92,-5916 4640.6,-5916 4640.6,-5916 4640.6,-5916 4640.6,-5795.85 4640.6,-5795.85"/>
<polygon fill="black" stroke="black" points="4644.1,-5795.85 4640.6,-5785.85 4637.1,-5795.85 4644.1,-5795.85"/>
</g>
<!-- k_proj_3_1_0 -->
<g id="node299" class="node">
<title>k_proj_3_1_0</title>
<polygon fill="lightcoral" stroke="black" points="4872.5,-5785.77 4741.5,-5785.77 4741.5,-5732.77 4872.5,-5732.77 4872.5,-5785.77"/>
<text text-anchor="middle" x="4807" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4807" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4807" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_0 -->
<g id="edge437" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_0</title>
<path fill="none" stroke="black" d="M5693.99,-5908C5501.41,-5908 4807,-5908 4807,-5908 4807,-5908 4807,-5795.86 4807,-5795.86"/>
<polygon fill="black" stroke="black" points="4810.5,-5795.86 4807,-5785.86 4803.5,-5795.86 4810.5,-5795.86"/>
</g>
<!-- v_proj_3_1_0 -->
<g id="node300" class="node">
<title>v_proj_3_1_0</title>
<polygon fill="lightcoral" stroke="black" points="5061.5,-5785.77 4930.5,-5785.77 4930.5,-5732.77 5061.5,-5732.77 5061.5,-5785.77"/>
<text text-anchor="middle" x="4996" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4996" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4996" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_0 -->
<g id="edge438" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_0</title>
<path fill="none" stroke="black" d="M5693.74,-5900C5524.05,-5900 4974.17,-5900 4974.17,-5900 4974.17,-5900 4974.17,-5796.07 4974.17,-5796.07"/>
<polygon fill="black" stroke="black" points="4977.67,-5796.07 4974.17,-5786.07 4970.67,-5796.07 4977.67,-5796.07"/>
</g>
<!-- q_proj_3_1_1 -->
<g id="node302" class="node">
<title>q_proj_3_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5250.5,-5785.77 5119.5,-5785.77 5119.5,-5732.77 5250.5,-5732.77 5250.5,-5785.77"/>
<text text-anchor="middle" x="5185" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5185" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5185" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_1 -->
<g id="edge443" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_1</title>
<path fill="none" stroke="black" d="M5693.99,-5892C5558.82,-5892 5190.71,-5892 5190.71,-5892 5190.71,-5892 5190.71,-5795.81 5190.71,-5795.81"/>
<polygon fill="black" stroke="black" points="5194.21,-5795.81 5190.71,-5785.81 5187.21,-5795.81 5194.21,-5795.81"/>
</g>
<!-- k_proj_3_1_1 -->
<g id="node303" class="node">
<title>k_proj_3_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5439.5,-5785.77 5308.5,-5785.77 5308.5,-5732.77 5439.5,-5732.77 5439.5,-5785.77"/>
<text text-anchor="middle" x="5374" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5374" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5374" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_1 -->
<g id="edge444" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_1</title>
<path fill="none" stroke="black" d="M5694,-5883C5593.62,-5883 5374,-5883 5374,-5883 5374,-5883 5374,-5795.81 5374,-5795.81"/>
<polygon fill="black" stroke="black" points="5377.5,-5795.81 5374,-5785.81 5370.5,-5795.81 5377.5,-5795.81"/>
</g>
<!-- v_proj_3_1_1 -->
<g id="node304" class="node">
<title>v_proj_3_1_1</title>
<polygon fill="lightcoral" stroke="black" points="5628.5,-5785.77 5497.5,-5785.77 5497.5,-5732.77 5628.5,-5732.77 5628.5,-5785.77"/>
<text text-anchor="middle" x="5563" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5563" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5563" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_1 -->
<g id="edge445" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_1</title>
<path fill="none" stroke="black" d="M5693.74,-5875C5659.89,-5875 5621.03,-5875 5621.03,-5875 5621.03,-5875 5621.03,-5795.82 5621.03,-5795.82"/>
<polygon fill="black" stroke="black" points="5624.53,-5795.82 5621.03,-5785.82 5617.53,-5795.82 5624.53,-5795.82"/>
</g>
<!-- q_proj_3_1_2 -->
<g id="node306" class="node">
<title>q_proj_3_1_2</title>
<polygon fill="lightcoral" stroke="black" points="5817.5,-5785.77 5686.5,-5785.77 5686.5,-5732.77 5817.5,-5732.77 5817.5,-5785.77"/>
<text text-anchor="middle" x="5752" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5752" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5752" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_2 -->
<g id="edge450" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_2</title>
<path fill="none" stroke="black" d="M5743,-5871.47C5743,-5871.47 5743,-5795.98 5743,-5795.98"/>
<polygon fill="black" stroke="black" points="5746.5,-5795.98 5743,-5785.98 5739.5,-5795.98 5746.5,-5795.98"/>
</g>
<!-- k_proj_3_1_2 -->
<g id="node307" class="node">
<title>k_proj_3_1_2</title>
<polygon fill="lightcoral" stroke="black" points="6006.5,-5785.77 5875.5,-5785.77 5875.5,-5732.77 6006.5,-5732.77 6006.5,-5785.77"/>
<text text-anchor="middle" x="5941" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5941" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5941" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_2 -->
<g id="edge451" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_2</title>
<path fill="none" stroke="black" d="M5792.2,-5880C5850.84,-5880 5941,-5880 5941,-5880 5941,-5880 5941,-5796.06 5941,-5796.06"/>
<polygon fill="black" stroke="black" points="5944.5,-5796.06 5941,-5786.06 5937.5,-5796.06 5944.5,-5796.06"/>
</g>
<!-- v_proj_3_1_2 -->
<g id="node308" class="node">
<title>v_proj_3_1_2</title>
<polygon fill="lightcoral" stroke="black" points="6195.5,-5785.77 6064.5,-5785.77 6064.5,-5732.77 6195.5,-5732.77 6195.5,-5785.77"/>
<text text-anchor="middle" x="6130" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6130" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6130" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_2 -->
<g id="edge452" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_2</title>
<path fill="none" stroke="black" d="M5792.32,-5889C5888.63,-5889 6092.4,-5889 6092.4,-5889 6092.4,-5889 6092.4,-5795.83 6092.4,-5795.83"/>
<polygon fill="black" stroke="black" points="6095.9,-5795.83 6092.4,-5785.83 6088.9,-5795.83 6095.9,-5795.83"/>
</g>
<!-- q_proj_3_1_3 -->
<g id="node310" class="node">
<title>q_proj_3_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6384.5,-5785.77 6253.5,-5785.77 6253.5,-5732.77 6384.5,-5732.77 6384.5,-5785.77"/>
<text text-anchor="middle" x="6319" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6319" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6319" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_3 -->
<g id="edge457" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_3</title>
<path fill="none" stroke="black" d="M5792.11,-5898C5931.4,-5898 6319,-5898 6319,-5898 6319,-5898 6319,-5796.02 6319,-5796.02"/>
<polygon fill="black" stroke="black" points="6322.5,-5796.02 6319,-5786.02 6315.5,-5796.02 6322.5,-5796.02"/>
</g>
<!-- k_proj_3_1_3 -->
<g id="node311" class="node">
<title>k_proj_3_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6573.5,-5785.77 6442.5,-5785.77 6442.5,-5732.77 6573.5,-5732.77 6573.5,-5785.77"/>
<text text-anchor="middle" x="6508" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6508" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6508" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_3 -->
<g id="edge458" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_3</title>
<path fill="none" stroke="black" d="M5792.02,-5907C5960.86,-5907 6508,-5907 6508,-5907 6508,-5907 6508,-5796.02 6508,-5796.02"/>
<polygon fill="black" stroke="black" points="6511.5,-5796.02 6508,-5786.02 6504.5,-5796.02 6511.5,-5796.02"/>
</g>
<!-- v_proj_3_1_3 -->
<g id="node312" class="node">
<title>v_proj_3_1_3</title>
<polygon fill="lightcoral" stroke="black" points="6762.5,-5785.77 6631.5,-5785.77 6631.5,-5732.77 6762.5,-5732.77 6762.5,-5785.77"/>
<text text-anchor="middle" x="6697" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6697" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6697" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_3 -->
<g id="edge459" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_3</title>
<path fill="none" stroke="black" d="M5792.15,-5915C5979.64,-5915 6639.4,-5915 6639.4,-5915 6639.4,-5915 6639.4,-5796.04 6639.4,-5796.04"/>
<polygon fill="black" stroke="black" points="6642.9,-5796.04 6639.4,-5786.04 6635.9,-5796.04 6642.9,-5796.04"/>
</g>
<!-- q_proj_3_2_0 -->
<g id="node314" class="node">
<title>q_proj_3_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2415.5,-5785.77 2284.5,-5785.77 2284.5,-5732.77 2415.5,-5732.77 2415.5,-5785.77"/>
<text text-anchor="middle" x="2350" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2350" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2350" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln3_2&#45;&gt;q_proj_3_2_0 -->
<g id="edge466" class="edge">
<title>ln3_2&#45;&gt;q_proj_3_2_0</title>
<path fill="none" stroke="black" d="M3434.79,-5920C3221.58,-5920 2388.25,-5920 2388.25,-5920 2388.25,-5920 2388.25,-5795.81 2388.25,-5795.81"/>
<polygon fill="black" stroke="black" points="2391.75,-5795.81 2388.25,-5785.81 2384.75,-5795.81 2391.75,-5795.81"/>
</g>
<!-- k_proj_3_2_0 -->
<g id="node315" class="node">
<title>k_proj_3_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2604.5,-5785.77 2473.5,-5785.77 2473.5,-5732.77 2604.5,-5732.77 2604.5,-5785.77"/>
<text text-anchor="middle" x="2539" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2539" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2539" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln3_2&#45;&gt;k_proj_3_2_0 -->
<g id="edge467" class="edge">
<title>ln3_2&#45;&gt;k_proj_3_2_0</title>
<path fill="none" stroke="black" d="M3434.98,-5911C3248.77,-5911 2595.75,-5911 2595.75,-5911 2595.75,-5911 2595.75,-5796.04 2595.75,-5796.04"/>
<polygon fill="black" stroke="black" points="2599.25,-5796.04 2595.75,-5786.04 2592.25,-5796.04 2599.25,-5796.04"/>
</g>
<!-- v_proj_3_2_0 -->
<g id="node316" class="node">
<title>v_proj_3_2_0</title>
<polygon fill="lightcoral" stroke="black" points="2793.5,-5785.77 2662.5,-5785.77 2662.5,-5732.77 2793.5,-5732.77 2793.5,-5785.77"/>
<text text-anchor="middle" x="2728" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2728" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2728" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln3_2&#45;&gt;v_proj_3_2_0 -->
<g id="edge468" class="edge">
<title>ln3_2&#45;&gt;v_proj_3_2_0</title>
<path fill="none" stroke="black" d="M3434.94,-5902C3273.04,-5902 2766.07,-5902 2766.07,-5902 2766.07,-5902 2766.07,-5795.78 2766.07,-5795.78"/>
<polygon fill="black" stroke="black" points="2769.57,-5795.78 2766.07,-5785.78 2762.57,-5795.78 2769.57,-5795.78"/>
</g>
<!-- q_proj_3_2_1 -->
<g id="node318" class="node">
<title>q_proj_3_2_1</title>
<polygon fill="lightcoral" stroke="black" points="2982.5,-5785.77 2851.5,-5785.77 2851.5,-5732.77 2982.5,-5732.77 2982.5,-5785.77"/>
<text text-anchor="middle" x="2917" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2917" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2917" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln3_2&#45;&gt;q_proj_3_2_1 -->
<g id="edge473" class="edge">
<title>ln3_2&#45;&gt;q_proj_3_2_1</title>
<path fill="none" stroke="black" d="M3434.67,-5893C3296.73,-5893 2917,-5893 2917,-5893 2917,-5893 2917,-5796.01 2917,-5796.01"/>
<polygon fill="black" stroke="black" points="2920.5,-5796.01 2917,-5786.01 2913.5,-5796.01 2920.5,-5796.01"/>
</g>
<!-- k_proj_3_2_1 -->
<g id="node319" class="node">
<title>k_proj_3_2_1</title>
<polygon fill="lightcoral" stroke="black" points="3171.5,-5785.77 3040.5,-5785.77 3040.5,-5732.77 3171.5,-5732.77 3171.5,-5785.77"/>
<text text-anchor="middle" x="3106" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3106" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3106" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln3_2&#45;&gt;k_proj_3_2_1 -->
<g id="edge474" class="edge">
<title>ln3_2&#45;&gt;k_proj_3_2_1</title>
<path fill="none" stroke="black" d="M3434.97,-5885C3332.69,-5885 3106,-5885 3106,-5885 3106,-5885 3106,-5795.93 3106,-5795.93"/>
<polygon fill="black" stroke="black" points="3109.5,-5795.93 3106,-5785.93 3102.5,-5795.93 3109.5,-5795.93"/>
</g>
<!-- v_proj_3_2_1 -->
<g id="node320" class="node">
<title>v_proj_3_2_1</title>
<polygon fill="lightcoral" stroke="black" points="3360.5,-5785.77 3229.5,-5785.77 3229.5,-5732.77 3360.5,-5732.77 3360.5,-5785.77"/>
<text text-anchor="middle" x="3295" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3295" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3295" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln3_2&#45;&gt;v_proj_3_2_1 -->
<g id="edge475" class="edge">
<title>ln3_2&#45;&gt;v_proj_3_2_1</title>
<path fill="none" stroke="black" d="M3434.84,-5876C3378.84,-5876 3295,-5876 3295,-5876 3295,-5876 3295,-5796.05 3295,-5796.05"/>
<polygon fill="black" stroke="black" points="3298.5,-5796.05 3295,-5786.05 3291.5,-5796.05 3298.5,-5796.05"/>
</g>
<!-- q_proj_3_2_2 -->
<g id="node322" class="node">
<title>q_proj_3_2_2</title>
<polygon fill="lightcoral" stroke="black" points="3549.5,-5785.77 3418.5,-5785.77 3418.5,-5732.77 3549.5,-5732.77 3549.5,-5785.77"/>
<text text-anchor="middle" x="3484" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3484" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3484" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln3_2&#45;&gt;q_proj_3_2_2 -->
<g id="edge480" class="edge">
<title>ln3_2&#45;&gt;q_proj_3_2_2</title>
<path fill="none" stroke="black" d="M3484,-5871.47C3484,-5871.47 3484,-5795.98 3484,-5795.98"/>
<polygon fill="black" stroke="black" points="3487.5,-5795.98 3484,-5785.98 3480.5,-5795.98 3487.5,-5795.98"/>
</g>
<!-- k_proj_3_2_2 -->
<g id="node323" class="node">
<title>k_proj_3_2_2</title>
<polygon fill="lightcoral" stroke="black" points="3738.5,-5785.77 3607.5,-5785.77 3607.5,-5732.77 3738.5,-5732.77 3738.5,-5785.77"/>
<text text-anchor="middle" x="3673" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3673" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3673" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln3_2&#45;&gt;k_proj_3_2_2 -->
<g id="edge481" class="edge">
<title>ln3_2&#45;&gt;k_proj_3_2_2</title>
<path fill="none" stroke="black" d="M3533.16,-5879C3589.16,-5879 3673,-5879 3673,-5879 3673,-5879 3673,-5795.84 3673,-5795.84"/>
<polygon fill="black" stroke="black" points="3676.5,-5795.84 3673,-5785.84 3669.5,-5795.84 3676.5,-5795.84"/>
</g>
<!-- v_proj_3_2_2 -->
<g id="node324" class="node">
<title>v_proj_3_2_2</title>
<polygon fill="lightcoral" stroke="black" points="3927.5,-5785.77 3796.5,-5785.77 3796.5,-5732.77 3927.5,-5732.77 3927.5,-5785.77"/>
<text text-anchor="middle" x="3862" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3862" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3862" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln3_2&#45;&gt;v_proj_3_2_2 -->
<g id="edge482" class="edge">
<title>ln3_2&#45;&gt;v_proj_3_2_2</title>
<path fill="none" stroke="black" d="M3533.03,-5888C3635.31,-5888 3862,-5888 3862,-5888 3862,-5888 3862,-5795.94 3862,-5795.94"/>
<polygon fill="black" stroke="black" points="3865.5,-5795.94 3862,-5785.94 3858.5,-5795.94 3865.5,-5795.94"/>
</g>
<!-- q_proj_3_2_3 -->
<g id="node326" class="node">
<title>q_proj_3_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4116.5,-5785.77 3985.5,-5785.77 3985.5,-5732.77 4116.5,-5732.77 4116.5,-5785.77"/>
<text text-anchor="middle" x="4051" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4051" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4051" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln3_2&#45;&gt;q_proj_3_2_3 -->
<g id="edge487" class="edge">
<title>ln3_2&#45;&gt;q_proj_3_2_3</title>
<path fill="none" stroke="black" d="M3533.33,-5896C3662.97,-5896 4003.37,-5896 4003.37,-5896 4003.37,-5896 4003.37,-5795.95 4003.37,-5795.95"/>
<polygon fill="black" stroke="black" points="4006.87,-5795.95 4003.37,-5785.95 3999.87,-5795.95 4006.87,-5795.95"/>
</g>
<!-- k_proj_3_2_3 -->
<g id="node327" class="node">
<title>k_proj_3_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4305.5,-5785.77 4174.5,-5785.77 4174.5,-5732.77 4305.5,-5732.77 4305.5,-5785.77"/>
<text text-anchor="middle" x="4240" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4240" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4240" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln3_2&#45;&gt;k_proj_3_2_3 -->
<g id="edge488" class="edge">
<title>ln3_2&#45;&gt;k_proj_3_2_3</title>
<path fill="none" stroke="black" d="M3533.02,-5904C3700.55,-5904 4240,-5904 4240,-5904 4240,-5904 4240,-5795.81 4240,-5795.81"/>
<polygon fill="black" stroke="black" points="4243.5,-5795.81 4240,-5785.81 4236.5,-5795.81 4243.5,-5795.81"/>
</g>
<!-- v_proj_3_2_3 -->
<g id="node328" class="node">
<title>v_proj_3_2_3</title>
<polygon fill="lightcoral" stroke="black" points="4494.5,-5785.77 4363.5,-5785.77 4363.5,-5732.77 4494.5,-5732.77 4494.5,-5785.77"/>
<text text-anchor="middle" x="4429" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4429" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4429" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln3_2&#45;&gt;v_proj_3_2_3 -->
<g id="edge489" class="edge">
<title>ln3_2&#45;&gt;v_proj_3_2_3</title>
<path fill="none" stroke="black" d="M3533.15,-5912C3727.12,-5912 4429,-5912 4429,-5912 4429,-5912 4429,-5795.87 4429,-5795.87"/>
<polygon fill="black" stroke="black" points="4432.5,-5795.87 4429,-5785.87 4425.5,-5795.87 4432.5,-5795.87"/>
</g>
<!-- q_proj_3_3_0 -->
<g id="node330" class="node">
<title>q_proj_3_3_0</title>
<polygon fill="lightcoral" stroke="black" points="147.5,-5785.77 16.5,-5785.77 16.5,-5732.77 147.5,-5732.77 147.5,-5785.77"/>
<text text-anchor="middle" x="82" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="82" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="82" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln3_3&#45;&gt;q_proj_3_3_0 -->
<g id="edge496" class="edge">
<title>ln3_3&#45;&gt;q_proj_3_3_0</title>
<path fill="none" stroke="black" d="M1166.91,-5917C949.25,-5917 82,-5917 82,-5917 82,-5917 82,-5796.02 82,-5796.02"/>
<polygon fill="black" stroke="black" points="85.5,-5796.02 82,-5786.02 78.5,-5796.02 85.5,-5796.02"/>
</g>
<!-- k_proj_3_3_0 -->
<g id="node331" class="node">
<title>k_proj_3_3_0</title>
<polygon fill="lightcoral" stroke="black" points="336.5,-5785.77 205.5,-5785.77 205.5,-5732.77 336.5,-5732.77 336.5,-5785.77"/>
<text text-anchor="middle" x="271" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="271" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="271" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln3_3&#45;&gt;k_proj_3_3_0 -->
<g id="edge497" class="edge">
<title>ln3_3&#45;&gt;k_proj_3_3_0</title>
<path fill="none" stroke="black" d="M1166.83,-5909C977.69,-5909 307.5,-5909 307.5,-5909 307.5,-5909 307.5,-5796.04 307.5,-5796.04"/>
<polygon fill="black" stroke="black" points="311,-5796.04 307.5,-5786.04 304,-5796.04 311,-5796.04"/>
</g>
<!-- v_proj_3_3_0 -->
<g id="node332" class="node">
<title>v_proj_3_3_0</title>
<polygon fill="lightcoral" stroke="black" points="525.5,-5785.77 394.5,-5785.77 394.5,-5732.77 525.5,-5732.77 525.5,-5785.77"/>
<text text-anchor="middle" x="460" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="460" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="460" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln3_3&#45;&gt;v_proj_3_3_0 -->
<g id="edge498" class="edge">
<title>ln3_3&#45;&gt;v_proj_3_3_0</title>
<path fill="none" stroke="black" d="M1166.98,-5902C999.45,-5902 460,-5902 460,-5902 460,-5902 460,-5795.78 460,-5795.78"/>
<polygon fill="black" stroke="black" points="463.5,-5795.78 460,-5785.78 456.5,-5795.78 463.5,-5795.78"/>
</g>
<!-- q_proj_3_3_1 -->
<g id="node334" class="node">
<title>q_proj_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="714.5,-5785.77 583.5,-5785.77 583.5,-5732.77 714.5,-5732.77 714.5,-5785.77"/>
<text text-anchor="middle" x="649" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="649" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="649" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln3_3&#45;&gt;q_proj_3_3_1 -->
<g id="edge503" class="edge">
<title>ln3_3&#45;&gt;q_proj_3_3_1</title>
<path fill="none" stroke="black" d="M1166.57,-5894C1034.87,-5894 685.5,-5894 685.5,-5894 685.5,-5894 685.5,-5795.89 685.5,-5795.89"/>
<polygon fill="black" stroke="black" points="689,-5795.89 685.5,-5785.89 682,-5795.89 689,-5795.89"/>
</g>
<!-- k_proj_3_3_1 -->
<g id="node335" class="node">
<title>k_proj_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="903.5,-5785.77 772.5,-5785.77 772.5,-5732.77 903.5,-5732.77 903.5,-5785.77"/>
<text text-anchor="middle" x="838" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="838" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="838" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln3_3&#45;&gt;k_proj_3_3_1 -->
<g id="edge504" class="edge">
<title>ln3_3&#45;&gt;k_proj_3_3_1</title>
<path fill="none" stroke="black" d="M1166.71,-5886C1072.14,-5886 874.5,-5886 874.5,-5886 874.5,-5886 874.5,-5795.83 874.5,-5795.83"/>
<polygon fill="black" stroke="black" points="878,-5795.83 874.5,-5785.83 871,-5795.83 878,-5795.83"/>
</g>
<!-- v_proj_3_3_1 -->
<g id="node336" class="node">
<title>v_proj_3_3_1</title>
<polygon fill="lightcoral" stroke="black" points="1092.5,-5785.77 961.5,-5785.77 961.5,-5732.77 1092.5,-5732.77 1092.5,-5785.77"/>
<text text-anchor="middle" x="1027" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1027" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1027" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln3_3&#45;&gt;v_proj_3_3_1 -->
<g id="edge505" class="edge">
<title>ln3_3&#45;&gt;v_proj_3_3_1</title>
<path fill="none" stroke="black" d="M1166.84,-5879C1110.84,-5879 1027,-5879 1027,-5879 1027,-5879 1027,-5795.84 1027,-5795.84"/>
<polygon fill="black" stroke="black" points="1030.5,-5795.84 1027,-5785.84 1023.5,-5795.84 1030.5,-5795.84"/>
</g>
<!-- q_proj_3_3_2 -->
<g id="node338" class="node">
<title>q_proj_3_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1281.5,-5785.77 1150.5,-5785.77 1150.5,-5732.77 1281.5,-5732.77 1281.5,-5785.77"/>
<text text-anchor="middle" x="1216" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1216" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1216" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln3_3&#45;&gt;q_proj_3_3_2 -->
<g id="edge510" class="edge">
<title>ln3_3&#45;&gt;q_proj_3_3_2</title>
<path fill="none" stroke="black" d="M1216,-5871.47C1216,-5871.47 1216,-5795.98 1216,-5795.98"/>
<polygon fill="black" stroke="black" points="1219.5,-5795.98 1216,-5785.98 1212.5,-5795.98 1219.5,-5795.98"/>
</g>
<!-- k_proj_3_3_2 -->
<g id="node339" class="node">
<title>k_proj_3_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1470.5,-5785.77 1339.5,-5785.77 1339.5,-5732.77 1470.5,-5732.77 1470.5,-5785.77"/>
<text text-anchor="middle" x="1405" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1405" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1405" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln3_3&#45;&gt;k_proj_3_3_2 -->
<g id="edge511" class="edge">
<title>ln3_3&#45;&gt;k_proj_3_3_2</title>
<path fill="none" stroke="black" d="M1265.16,-5880C1321.16,-5880 1405,-5880 1405,-5880 1405,-5880 1405,-5796.06 1405,-5796.06"/>
<polygon fill="black" stroke="black" points="1408.5,-5796.06 1405,-5786.06 1401.5,-5796.06 1408.5,-5796.06"/>
</g>
<!-- v_proj_3_3_2 -->
<g id="node340" class="node">
<title>v_proj_3_3_2</title>
<polygon fill="lightcoral" stroke="black" points="1659.5,-5785.77 1528.5,-5785.77 1528.5,-5732.77 1659.5,-5732.77 1659.5,-5785.77"/>
<text text-anchor="middle" x="1594" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1594" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1594" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln3_3&#45;&gt;v_proj_3_3_2 -->
<g id="edge512" class="edge">
<title>ln3_3&#45;&gt;v_proj_3_3_2</title>
<path fill="none" stroke="black" d="M1265.31,-5889C1356.66,-5889 1543,-5889 1543,-5889 1543,-5889 1543,-5795.83 1543,-5795.83"/>
<polygon fill="black" stroke="black" points="1546.5,-5795.83 1543,-5785.83 1539.5,-5795.83 1546.5,-5795.83"/>
</g>
<!-- q_proj_3_3_3 -->
<g id="node342" class="node">
<title>q_proj_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="1848.5,-5785.77 1717.5,-5785.77 1717.5,-5732.77 1848.5,-5732.77 1848.5,-5785.77"/>
<text text-anchor="middle" x="1783" y="-5770.57" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1783" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1783" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln3_3&#45;&gt;q_proj_3_3_3 -->
<g id="edge517" class="edge">
<title>ln3_3&#45;&gt;q_proj_3_3_3</title>
<path fill="none" stroke="black" d="M1265.27,-5898C1394.75,-5898 1734.73,-5898 1734.73,-5898 1734.73,-5898 1734.73,-5796.02 1734.73,-5796.02"/>
<polygon fill="black" stroke="black" points="1738.23,-5796.02 1734.73,-5786.02 1731.23,-5796.02 1738.23,-5796.02"/>
</g>
<!-- k_proj_3_3_3 -->
<g id="node343" class="node">
<title>k_proj_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="2037.5,-5785.77 1906.5,-5785.77 1906.5,-5732.77 2037.5,-5732.77 2037.5,-5785.77"/>
<text text-anchor="middle" x="1972" y="-5770.57" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1972" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1972" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln3_3&#45;&gt;k_proj_3_3_3 -->
<g id="edge518" class="edge">
<title>ln3_3&#45;&gt;k_proj_3_3_3</title>
<path fill="none" stroke="black" d="M1265.09,-5907C1434.19,-5907 1982.17,-5907 1982.17,-5907 1982.17,-5907 1982.17,-5796.02 1982.17,-5796.02"/>
<polygon fill="black" stroke="black" points="1985.67,-5796.02 1982.17,-5786.02 1978.67,-5796.02 1985.67,-5796.02"/>
</g>
<!-- v_proj_3_3_3 -->
<g id="node344" class="node">
<title>v_proj_3_3_3</title>
<polygon fill="lightcoral" stroke="black" points="2226.5,-5785.77 2095.5,-5785.77 2095.5,-5732.77 2226.5,-5732.77 2226.5,-5785.77"/>
<text text-anchor="middle" x="2161" y="-5770.57" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2161" y="-5755.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2161" y="-5740.57" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln3_3&#45;&gt;v_proj_3_3_3 -->
<g id="edge519" class="edge">
<title>ln3_3&#45;&gt;v_proj_3_3_3</title>
<path fill="none" stroke="black" d="M1265.24,-5915C1452.29,-5915 2108.25,-5915 2108.25,-5915 2108.25,-5915 2108.25,-5796.04 2108.25,-5796.04"/>
<polygon fill="black" stroke="black" points="2111.75,-5796.04 2108.25,-5786.04 2104.75,-5796.04 2111.75,-5796.04"/>
</g>
<!-- attn_3_0_0 -->
<g id="node285" class="node">
<title>attn_3_0_0</title>
<polygon fill="orange" stroke="black" points="7282,-5646.77 7056,-5646.77 7056,-5593.77 7282,-5593.77 7282,-5646.77"/>
<text text-anchor="middle" x="7169" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7169" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7169" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge409" class="edge">
<title>q_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M6888.75,-5732.76C6888.75,-5690.11 6888.75,-5611 6888.75,-5611 6888.75,-5611 7045.82,-5611 7045.82,-5611"/>
<polygon fill="black" stroke="black" points="7045.82,-5614.5 7055.82,-5611 7045.82,-5607.5 7045.82,-5614.5"/>
</g>
<!-- k_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge410" class="edge">
<title>k_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M7098.25,-5732.47C7098.25,-5732.47 7098.25,-5656.98 7098.25,-5656.98"/>
<polygon fill="black" stroke="black" points="7101.75,-5656.98 7098.25,-5646.98 7094.75,-5656.98 7101.75,-5656.98"/>
</g>
<!-- v_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge411" class="edge">
<title>v_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M7240.25,-5732.47C7240.25,-5732.47 7240.25,-5656.98 7240.25,-5656.98"/>
<polygon fill="black" stroke="black" points="7243.75,-5656.98 7240.25,-5646.98 7236.75,-5656.98 7243.75,-5656.98"/>
</g>
<!-- concat_dim_3_0 -->
<g id="node346" class="node">
<title>concat_dim_3_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7849.2,-5507.77 7519.59,-5507.77 7434.8,-5401.77 7764.41,-5401.77 7849.2,-5507.77"/>
<text text-anchor="middle" x="7642" y="-5466.07" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="7642" y="-5451.07" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="7642" y="-5436.07" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- attn_3_0_0&#45;&gt;concat_dim_3_0 -->
<g id="edge412" class="edge">
<title>attn_3_0_0&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M7282.22,-5620C7369.92,-5620 7476.57,-5620 7476.57,-5620 7476.57,-5620 7476.57,-5464.89 7476.57,-5464.89"/>
<polygon fill="black" stroke="black" points="7480.07,-5464.89 7476.57,-5454.89 7473.07,-5464.89 7480.07,-5464.89"/>
</g>
<!-- attn_3_0_1 -->
<g id="node289" class="node">
<title>attn_3_0_1</title>
<polygon fill="orange" stroke="black" points="7755,-5646.77 7529,-5646.77 7529,-5593.77 7755,-5593.77 7755,-5646.77"/>
<text text-anchor="middle" x="7642" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7642" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7642" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge416" class="edge">
<title>q_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M7518.91,-5759C7530.13,-5759 7538.25,-5759 7538.25,-5759 7538.25,-5759 7538.25,-5657.02 7538.25,-5657.02"/>
<polygon fill="black" stroke="black" points="7541.75,-5657.02 7538.25,-5647.02 7534.75,-5657.02 7541.75,-5657.02"/>
</g>
<!-- k_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge417" class="edge">
<title>k_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M7642,-5732.47C7642,-5732.47 7642,-5656.98 7642,-5656.98"/>
<polygon fill="black" stroke="black" points="7645.5,-5656.98 7642,-5646.98 7638.5,-5656.98 7645.5,-5656.98"/>
</g>
<!-- v_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge418" class="edge">
<title>v_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M7765.09,-5759C7753.87,-5759 7745.75,-5759 7745.75,-5759 7745.75,-5759 7745.75,-5657.02 7745.75,-5657.02"/>
<polygon fill="black" stroke="black" points="7749.25,-5657.02 7745.75,-5647.02 7742.25,-5657.02 7749.25,-5657.02"/>
</g>
<!-- attn_3_0_1&#45;&gt;concat_dim_3_0 -->
<g id="edge419" class="edge">
<title>attn_3_0_1&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M7642,-5593.68C7642,-5593.68 7642,-5518.04 7642,-5518.04"/>
<polygon fill="black" stroke="black" points="7645.5,-5518.04 7642,-5508.04 7638.5,-5518.04 7645.5,-5518.04"/>
</g>
<!-- attn_3_0_2 -->
<g id="node293" class="node">
<title>attn_3_0_2</title>
<polygon fill="orange" stroke="black" points="8227,-5646.77 8001,-5646.77 8001,-5593.77 8227,-5593.77 8227,-5646.77"/>
<text text-anchor="middle" x="8114" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8114" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8114" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge423" class="edge">
<title>q_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M8043.25,-5732.47C8043.25,-5732.47 8043.25,-5656.98 8043.25,-5656.98"/>
<polygon fill="black" stroke="black" points="8046.75,-5656.98 8043.25,-5646.98 8039.75,-5656.98 8046.75,-5656.98"/>
</g>
<!-- k_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge424" class="edge">
<title>k_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M8185.25,-5732.47C8185.25,-5732.47 8185.25,-5656.98 8185.25,-5656.98"/>
<polygon fill="black" stroke="black" points="8188.75,-5656.98 8185.25,-5646.98 8181.75,-5656.98 8188.75,-5656.98"/>
</g>
<!-- v_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge425" class="edge">
<title>v_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M8343.9,-5732.74C8343.9,-5692.34 8343.9,-5620 8343.9,-5620 8343.9,-5620 8237.27,-5620 8237.27,-5620"/>
<polygon fill="black" stroke="black" points="8237.27,-5616.5 8227.27,-5620 8237.27,-5623.5 8237.27,-5616.5"/>
</g>
<!-- attn_3_0_2&#45;&gt;concat_dim_3_0 -->
<g id="edge426" class="edge">
<title>attn_3_0_2&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M8006.33,-5593.76C8006.33,-5551.11 8006.33,-5472 8006.33,-5472 8006.33,-5472 7830.69,-5472 7830.69,-5472"/>
<polygon fill="black" stroke="black" points="7830.69,-5468.5 7820.69,-5472 7830.69,-5475.5 7830.69,-5468.5"/>
</g>
<!-- attn_3_0_3 -->
<g id="node297" class="node">
<title>attn_3_0_3</title>
<polygon fill="orange" stroke="black" points="8795,-5646.77 8569,-5646.77 8569,-5593.77 8795,-5593.77 8795,-5646.77"/>
<text text-anchor="middle" x="8682" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8682" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8682" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge430" class="edge">
<title>q_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M8610.75,-5732.47C8610.75,-5732.47 8610.75,-5656.98 8610.75,-5656.98"/>
<polygon fill="black" stroke="black" points="8614.25,-5656.98 8610.75,-5646.98 8607.25,-5656.98 8614.25,-5656.98"/>
</g>
<!-- k_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge431" class="edge">
<title>k_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M8752.75,-5732.47C8752.75,-5732.47 8752.75,-5656.98 8752.75,-5656.98"/>
<polygon fill="black" stroke="black" points="8756.25,-5656.98 8752.75,-5646.98 8749.25,-5656.98 8756.25,-5656.98"/>
</g>
<!-- v_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge432" class="edge">
<title>v_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M8941.64,-5732.74C8941.64,-5692.34 8941.64,-5620 8941.64,-5620 8941.64,-5620 8805.13,-5620 8805.13,-5620"/>
<polygon fill="black" stroke="black" points="8805.13,-5616.5 8795.13,-5620 8805.13,-5623.5 8805.13,-5616.5"/>
</g>
<!-- attn_3_0_3&#45;&gt;concat_dim_3_0 -->
<g id="edge433" class="edge">
<title>attn_3_0_3&#45;&gt;concat_dim_3_0</title>
<path fill="none" stroke="black" d="M8598.5,-5593.62C8598.5,-5542.79 8598.5,-5437 8598.5,-5437 8598.5,-5437 7802.77,-5437 7802.77,-5437"/>
<polygon fill="black" stroke="black" points="7802.77,-5433.5 7792.77,-5437 7802.77,-5440.5 7802.77,-5433.5"/>
</g>
<!-- attn_3_1_0 -->
<g id="node301" class="node">
<title>attn_3_1_0</title>
<polygon fill="orange" stroke="black" points="5014,-5646.77 4788,-5646.77 4788,-5593.77 5014,-5593.77 5014,-5646.77"/>
<text text-anchor="middle" x="4901" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4901" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4901" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge439" class="edge">
<title>q_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M4671,-5732.76C4671,-5690.11 4671,-5611 4671,-5611 4671,-5611 4777.68,-5611 4777.68,-5611"/>
<polygon fill="black" stroke="black" points="4777.68,-5614.5 4787.68,-5611 4777.68,-5607.5 4777.68,-5614.5"/>
</g>
<!-- k_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge440" class="edge">
<title>k_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M4830.25,-5732.47C4830.25,-5732.47 4830.25,-5656.98 4830.25,-5656.98"/>
<polygon fill="black" stroke="black" points="4833.75,-5656.98 4830.25,-5646.98 4826.75,-5656.98 4833.75,-5656.98"/>
</g>
<!-- v_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge441" class="edge">
<title>v_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M4972.25,-5732.47C4972.25,-5732.47 4972.25,-5656.98 4972.25,-5656.98"/>
<polygon fill="black" stroke="black" points="4975.75,-5656.98 4972.25,-5646.98 4968.75,-5656.98 4975.75,-5656.98"/>
</g>
<!-- concat_dim_3_1 -->
<g id="node347" class="node">
<title>concat_dim_3_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5771.2,-5507.77 5441.59,-5507.77 5356.8,-5401.77 5686.41,-5401.77 5771.2,-5507.77"/>
<text text-anchor="middle" x="5564" y="-5466.07" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="5564" y="-5451.07" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="5564" y="-5436.07" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- attn_3_1_0&#45;&gt;concat_dim_3_1 -->
<g id="edge442" class="edge">
<title>attn_3_1_0&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M4938.25,-5593.76C4938.25,-5551.11 4938.25,-5472 4938.25,-5472 4938.25,-5472 5402.92,-5472 5402.92,-5472"/>
<polygon fill="black" stroke="black" points="5402.92,-5475.5 5412.92,-5472 5402.92,-5468.5 5402.92,-5475.5"/>
</g>
<!-- attn_3_1_1 -->
<g id="node305" class="node">
<title>attn_3_1_1</title>
<polygon fill="orange" stroke="black" points="5581,-5646.77 5355,-5646.77 5355,-5593.77 5581,-5593.77 5581,-5646.77"/>
<text text-anchor="middle" x="5468" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5468" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5468" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge446" class="edge">
<title>q_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M5185,-5732.74C5185,-5692.34 5185,-5620 5185,-5620 5185,-5620 5344.93,-5620 5344.93,-5620"/>
<polygon fill="black" stroke="black" points="5344.93,-5623.5 5354.93,-5620 5344.93,-5616.5 5344.93,-5623.5"/>
</g>
<!-- k_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge447" class="edge">
<title>k_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M5397.25,-5732.47C5397.25,-5732.47 5397.25,-5656.98 5397.25,-5656.98"/>
<polygon fill="black" stroke="black" points="5400.75,-5656.98 5397.25,-5646.98 5393.75,-5656.98 5400.75,-5656.98"/>
</g>
<!-- v_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge448" class="edge">
<title>v_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M5539.25,-5732.47C5539.25,-5732.47 5539.25,-5656.98 5539.25,-5656.98"/>
<polygon fill="black" stroke="black" points="5542.75,-5656.98 5539.25,-5646.98 5535.75,-5656.98 5542.75,-5656.98"/>
</g>
<!-- attn_3_1_1&#45;&gt;concat_dim_3_1 -->
<g id="edge449" class="edge">
<title>attn_3_1_1&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M5468.82,-5593.68C5468.82,-5593.68 5468.82,-5518.04 5468.82,-5518.04"/>
<polygon fill="black" stroke="black" points="5472.32,-5518.04 5468.82,-5508.04 5465.32,-5518.04 5472.32,-5518.04"/>
</g>
<!-- attn_3_1_2 -->
<g id="node309" class="node">
<title>attn_3_1_2</title>
<polygon fill="orange" stroke="black" points="5960,-5646.77 5734,-5646.77 5734,-5593.77 5960,-5593.77 5960,-5646.77"/>
<text text-anchor="middle" x="5847" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5847" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5847" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge453" class="edge">
<title>q_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M5775.75,-5732.47C5775.75,-5732.47 5775.75,-5656.98 5775.75,-5656.98"/>
<polygon fill="black" stroke="black" points="5779.25,-5656.98 5775.75,-5646.98 5772.25,-5656.98 5779.25,-5656.98"/>
</g>
<!-- k_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge454" class="edge">
<title>k_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M5917.75,-5732.47C5917.75,-5732.47 5917.75,-5656.98 5917.75,-5656.98"/>
<polygon fill="black" stroke="black" points="5921.25,-5656.98 5917.75,-5646.98 5914.25,-5656.98 5921.25,-5656.98"/>
</g>
<!-- v_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge455" class="edge">
<title>v_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M6091,-5732.74C6091,-5692.34 6091,-5620 6091,-5620 6091,-5620 5970.07,-5620 5970.07,-5620"/>
<polygon fill="black" stroke="black" points="5970.07,-5616.5 5960.07,-5620 5970.07,-5623.5 5970.07,-5616.5"/>
</g>
<!-- attn_3_1_2&#45;&gt;concat_dim_3_1 -->
<g id="edge456" class="edge">
<title>attn_3_1_2&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M5752.68,-5593.68C5752.68,-5593.68 5752.68,-5518.04 5752.68,-5518.04"/>
<polygon fill="black" stroke="black" points="5756.18,-5518.04 5752.68,-5508.04 5749.18,-5518.04 5756.18,-5518.04"/>
</g>
<!-- attn_3_1_3 -->
<g id="node313" class="node">
<title>attn_3_1_3</title>
<polygon fill="orange" stroke="black" points="6526,-5646.77 6300,-5646.77 6300,-5593.77 6526,-5593.77 6526,-5646.77"/>
<text text-anchor="middle" x="6413" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6413" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6413" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge460" class="edge">
<title>q_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M6342.25,-5732.47C6342.25,-5732.47 6342.25,-5656.98 6342.25,-5656.98"/>
<polygon fill="black" stroke="black" points="6345.75,-5656.98 6342.25,-5646.98 6338.75,-5656.98 6345.75,-5656.98"/>
</g>
<!-- k_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge461" class="edge">
<title>k_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M6484.25,-5732.47C6484.25,-5732.47 6484.25,-5656.98 6484.25,-5656.98"/>
<polygon fill="black" stroke="black" points="6487.75,-5656.98 6484.25,-5646.98 6480.75,-5656.98 6487.75,-5656.98"/>
</g>
<!-- v_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge462" class="edge">
<title>v_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M6697,-5732.59C6697,-5694.48 6697,-5629 6697,-5629 6697,-5629 6536.06,-5629 6536.06,-5629"/>
<polygon fill="black" stroke="black" points="6536.06,-5625.5 6526.06,-5629 6536.06,-5632.5 6536.06,-5625.5"/>
</g>
<!-- attn_3_1_3&#45;&gt;concat_dim_3_1 -->
<g id="edge463" class="edge">
<title>attn_3_1_3&#45;&gt;concat_dim_3_1</title>
<path fill="none" stroke="black" d="M6303.5,-5593.76C6303.5,-5551.11 6303.5,-5472 6303.5,-5472 6303.5,-5472 5753.01,-5472 5753.01,-5472"/>
<polygon fill="black" stroke="black" points="5753.01,-5468.5 5743.01,-5472 5753.01,-5475.5 5753.01,-5468.5"/>
</g>
<!-- attn_3_2_0 -->
<g id="node317" class="node">
<title>attn_3_2_0</title>
<polygon fill="orange" stroke="black" points="2746,-5646.77 2520,-5646.77 2520,-5593.77 2746,-5593.77 2746,-5646.77"/>
<text text-anchor="middle" x="2633" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2633" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2633" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge469" class="edge">
<title>q_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M2403,-5732.76C2403,-5690.11 2403,-5611 2403,-5611 2403,-5611 2509.68,-5611 2509.68,-5611"/>
<polygon fill="black" stroke="black" points="2509.68,-5614.5 2519.68,-5611 2509.68,-5607.5 2509.68,-5614.5"/>
</g>
<!-- k_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge470" class="edge">
<title>k_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M2562.25,-5732.47C2562.25,-5732.47 2562.25,-5656.98 2562.25,-5656.98"/>
<polygon fill="black" stroke="black" points="2565.75,-5656.98 2562.25,-5646.98 2558.75,-5656.98 2565.75,-5656.98"/>
</g>
<!-- v_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge471" class="edge">
<title>v_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M2704.25,-5732.47C2704.25,-5732.47 2704.25,-5656.98 2704.25,-5656.98"/>
<polygon fill="black" stroke="black" points="2707.75,-5656.98 2704.25,-5646.98 2700.75,-5656.98 2707.75,-5656.98"/>
</g>
<!-- concat_dim_3_2 -->
<g id="node348" class="node">
<title>concat_dim_3_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3880.2,-5507.77 3550.59,-5507.77 3465.8,-5401.77 3795.41,-5401.77 3880.2,-5507.77"/>
<text text-anchor="middle" x="3673" y="-5466.07" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="3673" y="-5451.07" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="3673" y="-5436.07" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- attn_3_2_0&#45;&gt;concat_dim_3_2 -->
<g id="edge472" class="edge">
<title>attn_3_2_0&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M2728.25,-5593.55C2728.25,-5546.55 2728.25,-5454 2728.25,-5454 2728.25,-5454 3497.36,-5454 3497.36,-5454"/>
<polygon fill="black" stroke="black" points="3497.36,-5457.5 3507.36,-5454 3497.36,-5450.5 3497.36,-5457.5"/>
</g>
<!-- attn_3_2_1 -->
<g id="node321" class="node">
<title>attn_3_2_1</title>
<polygon fill="orange" stroke="black" points="3313,-5646.77 3087,-5646.77 3087,-5593.77 3313,-5593.77 3313,-5646.77"/>
<text text-anchor="middle" x="3200" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3200" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3200" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge476" class="edge">
<title>q_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M2965.83,-5732.74C2965.83,-5692.34 2965.83,-5620 2965.83,-5620 2965.83,-5620 3076.69,-5620 3076.69,-5620"/>
<polygon fill="black" stroke="black" points="3076.69,-5623.5 3086.69,-5620 3076.69,-5616.5 3076.69,-5623.5"/>
</g>
<!-- k_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge477" class="edge">
<title>k_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M3129.25,-5732.47C3129.25,-5732.47 3129.25,-5656.98 3129.25,-5656.98"/>
<polygon fill="black" stroke="black" points="3132.75,-5656.98 3129.25,-5646.98 3125.75,-5656.98 3132.75,-5656.98"/>
</g>
<!-- v_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge478" class="edge">
<title>v_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M3271.25,-5732.47C3271.25,-5732.47 3271.25,-5656.98 3271.25,-5656.98"/>
<polygon fill="black" stroke="black" points="3274.75,-5656.98 3271.25,-5646.98 3267.75,-5656.98 3274.75,-5656.98"/>
</g>
<!-- attn_3_2_1&#45;&gt;concat_dim_3_2 -->
<g id="edge479" class="edge">
<title>attn_3_2_1&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M3313.22,-5620C3400.92,-5620 3507.57,-5620 3507.57,-5620 3507.57,-5620 3507.57,-5464.89 3507.57,-5464.89"/>
<polygon fill="black" stroke="black" points="3511.07,-5464.89 3507.57,-5454.89 3504.07,-5464.89 3511.07,-5464.89"/>
</g>
<!-- attn_3_2_2 -->
<g id="node325" class="node">
<title>attn_3_2_2</title>
<polygon fill="orange" stroke="black" points="3786,-5646.77 3560,-5646.77 3560,-5593.77 3786,-5593.77 3786,-5646.77"/>
<text text-anchor="middle" x="3673" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3673" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3673" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge483" class="edge">
<title>q_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M3549.7,-5759C3568.38,-5759 3583.75,-5759 3583.75,-5759 3583.75,-5759 3583.75,-5657.02 3583.75,-5657.02"/>
<polygon fill="black" stroke="black" points="3587.25,-5657.02 3583.75,-5647.02 3580.25,-5657.02 3587.25,-5657.02"/>
</g>
<!-- k_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge484" class="edge">
<title>k_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M3673,-5732.47C3673,-5732.47 3673,-5656.98 3673,-5656.98"/>
<polygon fill="black" stroke="black" points="3676.5,-5656.98 3673,-5646.98 3669.5,-5656.98 3676.5,-5656.98"/>
</g>
<!-- v_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge485" class="edge">
<title>v_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M3796.3,-5759C3777.62,-5759 3762.25,-5759 3762.25,-5759 3762.25,-5759 3762.25,-5657.02 3762.25,-5657.02"/>
<polygon fill="black" stroke="black" points="3765.75,-5657.02 3762.25,-5647.02 3758.75,-5657.02 3765.75,-5657.02"/>
</g>
<!-- attn_3_2_2&#45;&gt;concat_dim_3_2 -->
<g id="edge486" class="edge">
<title>attn_3_2_2&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M3673,-5593.68C3673,-5593.68 3673,-5518.04 3673,-5518.04"/>
<polygon fill="black" stroke="black" points="3676.5,-5518.04 3673,-5508.04 3669.5,-5518.04 3676.5,-5518.04"/>
</g>
<!-- attn_3_2_3 -->
<g id="node329" class="node">
<title>attn_3_2_3</title>
<polygon fill="orange" stroke="black" points="4258,-5646.77 4032,-5646.77 4032,-5593.77 4258,-5593.77 4258,-5646.77"/>
<text text-anchor="middle" x="4145" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4145" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4145" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge490" class="edge">
<title>q_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M4074.25,-5732.47C4074.25,-5732.47 4074.25,-5656.98 4074.25,-5656.98"/>
<polygon fill="black" stroke="black" points="4077.75,-5656.98 4074.25,-5646.98 4070.75,-5656.98 4077.75,-5656.98"/>
</g>
<!-- k_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge491" class="edge">
<title>k_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M4216.25,-5732.47C4216.25,-5732.47 4216.25,-5656.98 4216.25,-5656.98"/>
<polygon fill="black" stroke="black" points="4219.75,-5656.98 4216.25,-5646.98 4212.75,-5656.98 4219.75,-5656.98"/>
</g>
<!-- v_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge492" class="edge">
<title>v_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M4395.5,-5732.59C4395.5,-5694.48 4395.5,-5629 4395.5,-5629 4395.5,-5629 4268.16,-5629 4268.16,-5629"/>
<polygon fill="black" stroke="black" points="4268.16,-5625.5 4258.16,-5629 4268.16,-5632.5 4268.16,-5625.5"/>
</g>
<!-- attn_3_2_3&#45;&gt;concat_dim_3_2 -->
<g id="edge493" class="edge">
<title>attn_3_2_3&#45;&gt;concat_dim_3_2</title>
<path fill="none" stroke="black" d="M4031.71,-5620C3944.38,-5620 3838.43,-5620 3838.43,-5620 3838.43,-5620 3838.43,-5517.96 3838.43,-5517.96"/>
<polygon fill="black" stroke="black" points="3841.93,-5517.96 3838.43,-5507.96 3834.93,-5517.96 3841.93,-5517.96"/>
</g>
<!-- attn_3_3_0 -->
<g id="node333" class="node">
<title>attn_3_3_0</title>
<polygon fill="orange" stroke="black" points="478,-5646.77 252,-5646.77 252,-5593.77 478,-5593.77 478,-5646.77"/>
<text text-anchor="middle" x="365" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="365" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="365" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge499" class="edge">
<title>q_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M82,-5732.74C82,-5692.34 82,-5620 82,-5620 82,-5620 241.93,-5620 241.93,-5620"/>
<polygon fill="black" stroke="black" points="241.93,-5623.5 251.93,-5620 241.93,-5616.5 241.93,-5623.5"/>
</g>
<!-- k_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge500" class="edge">
<title>k_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M294.25,-5732.47C294.25,-5732.47 294.25,-5656.98 294.25,-5656.98"/>
<polygon fill="black" stroke="black" points="297.75,-5656.98 294.25,-5646.98 290.75,-5656.98 297.75,-5656.98"/>
</g>
<!-- v_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge501" class="edge">
<title>v_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M436.25,-5732.47C436.25,-5732.47 436.25,-5656.98 436.25,-5656.98"/>
<polygon fill="black" stroke="black" points="439.75,-5656.98 436.25,-5646.98 432.75,-5656.98 439.75,-5656.98"/>
</g>
<!-- concat_dim_3_3 -->
<g id="node349" class="node">
<title>concat_dim_3_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1612.2,-5507.77 1282.59,-5507.77 1197.8,-5401.77 1527.41,-5401.77 1612.2,-5507.77"/>
<text text-anchor="middle" x="1405" y="-5466.07" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="1405" y="-5451.07" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="1405" y="-5436.07" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- attn_3_3_0&#45;&gt;concat_dim_3_3 -->
<g id="edge502" class="edge">
<title>attn_3_3_0&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M365,-5593.55C365,-5546.55 365,-5454 365,-5454 365,-5454 1229.35,-5454 1229.35,-5454"/>
<polygon fill="black" stroke="black" points="1229.35,-5457.5 1239.35,-5454 1229.35,-5450.5 1229.35,-5457.5"/>
</g>
<!-- attn_3_3_1 -->
<g id="node337" class="node">
<title>attn_3_3_1</title>
<polygon fill="orange" stroke="black" points="1045,-5646.77 819,-5646.77 819,-5593.77 1045,-5593.77 1045,-5646.77"/>
<text text-anchor="middle" x="932" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="932" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="932" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge506" class="edge">
<title>q_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M649,-5732.74C649,-5692.34 649,-5620 649,-5620 649,-5620 808.93,-5620 808.93,-5620"/>
<polygon fill="black" stroke="black" points="808.93,-5623.5 818.93,-5620 808.93,-5616.5 808.93,-5623.5"/>
</g>
<!-- k_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge507" class="edge">
<title>k_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M861.25,-5732.47C861.25,-5732.47 861.25,-5656.98 861.25,-5656.98"/>
<polygon fill="black" stroke="black" points="864.75,-5656.98 861.25,-5646.98 857.75,-5656.98 864.75,-5656.98"/>
</g>
<!-- v_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge508" class="edge">
<title>v_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M1003.25,-5732.47C1003.25,-5732.47 1003.25,-5656.98 1003.25,-5656.98"/>
<polygon fill="black" stroke="black" points="1006.75,-5656.98 1003.25,-5646.98 999.75,-5656.98 1006.75,-5656.98"/>
</g>
<!-- attn_3_3_1&#45;&gt;concat_dim_3_3 -->
<g id="edge509" class="edge">
<title>attn_3_3_1&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M1045.22,-5620C1132.92,-5620 1239.57,-5620 1239.57,-5620 1239.57,-5620 1239.57,-5464.89 1239.57,-5464.89"/>
<polygon fill="black" stroke="black" points="1243.07,-5464.89 1239.57,-5454.89 1236.07,-5464.89 1243.07,-5464.89"/>
</g>
<!-- attn_3_3_2 -->
<g id="node341" class="node">
<title>attn_3_3_2</title>
<polygon fill="orange" stroke="black" points="1518,-5646.77 1292,-5646.77 1292,-5593.77 1518,-5593.77 1518,-5646.77"/>
<text text-anchor="middle" x="1405" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1405" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1405" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge513" class="edge">
<title>q_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M1281.51,-5759C1297.61,-5759 1310.32,-5759 1310.32,-5759 1310.32,-5759 1310.32,-5657.02 1310.32,-5657.02"/>
<polygon fill="black" stroke="black" points="1313.82,-5657.02 1310.32,-5647.02 1306.82,-5657.02 1313.82,-5657.02"/>
</g>
<!-- k_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge514" class="edge">
<title>k_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M1405,-5732.47C1405,-5732.47 1405,-5656.98 1405,-5656.98"/>
<polygon fill="black" stroke="black" points="1408.5,-5656.98 1405,-5646.98 1401.5,-5656.98 1408.5,-5656.98"/>
</g>
<!-- v_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge515" class="edge">
<title>v_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M1528.3,-5759C1509.62,-5759 1494.25,-5759 1494.25,-5759 1494.25,-5759 1494.25,-5657.02 1494.25,-5657.02"/>
<polygon fill="black" stroke="black" points="1497.75,-5657.02 1494.25,-5647.02 1490.75,-5657.02 1497.75,-5657.02"/>
</g>
<!-- attn_3_3_2&#45;&gt;concat_dim_3_3 -->
<g id="edge516" class="edge">
<title>attn_3_3_2&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M1405,-5593.68C1405,-5593.68 1405,-5518.04 1405,-5518.04"/>
<polygon fill="black" stroke="black" points="1408.5,-5518.04 1405,-5508.04 1401.5,-5518.04 1408.5,-5518.04"/>
</g>
<!-- attn_3_3_3 -->
<g id="node345" class="node">
<title>attn_3_3_3</title>
<polygon fill="orange" stroke="black" points="1990,-5646.77 1764,-5646.77 1764,-5593.77 1990,-5593.77 1990,-5646.77"/>
<text text-anchor="middle" x="1877" y="-5631.57" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1877" y="-5616.57" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1877" y="-5601.57" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge520" class="edge">
<title>q_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M1806.25,-5732.47C1806.25,-5732.47 1806.25,-5656.98 1806.25,-5656.98"/>
<polygon fill="black" stroke="black" points="1809.75,-5656.98 1806.25,-5646.98 1802.75,-5656.98 1809.75,-5656.98"/>
</g>
<!-- k_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge521" class="edge">
<title>k_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M1948.25,-5732.47C1948.25,-5732.47 1948.25,-5656.98 1948.25,-5656.98"/>
<polygon fill="black" stroke="black" points="1951.75,-5656.98 1948.25,-5646.98 1944.75,-5656.98 1951.75,-5656.98"/>
</g>
<!-- v_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge522" class="edge">
<title>v_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M2127.5,-5732.59C2127.5,-5694.48 2127.5,-5629 2127.5,-5629 2127.5,-5629 2000.16,-5629 2000.16,-5629"/>
<polygon fill="black" stroke="black" points="2000.16,-5625.5 1990.16,-5629 2000.16,-5632.5 2000.16,-5625.5"/>
</g>
<!-- attn_3_3_3&#45;&gt;concat_dim_3_3 -->
<g id="edge523" class="edge">
<title>attn_3_3_3&#45;&gt;concat_dim_3_3</title>
<path fill="none" stroke="black" d="M1763.71,-5620C1676.38,-5620 1570.43,-5620 1570.43,-5620 1570.43,-5620 1570.43,-5517.96 1570.43,-5517.96"/>
<polygon fill="black" stroke="black" points="1573.93,-5517.96 1570.43,-5507.96 1566.93,-5517.96 1573.93,-5517.96"/>
</g>
<!-- concat_heads_3 -->
<g id="node350" class="node">
<title>concat_heads_3</title>
<polygon fill="lightgreen" stroke="black" points="5781.94,-5315.77 5435.25,-5315.77 5346.06,-5209.77 5692.75,-5209.77 5781.94,-5315.77"/>
<text text-anchor="middle" x="5564" y="-5274.07" font-family="Times,serif" font-size="14.00">Head Group Concatenation</text>
<text text-anchor="middle" x="5564" y="-5259.07" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5564" y="-5244.07" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_3_0&#45;&gt;concat_heads_3 -->
<g id="edge434" class="edge">
<title>concat_dim_3_0&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M7462.71,-5437C6995.48,-5437 5776.53,-5437 5776.53,-5437 5776.53,-5437 5776.53,-5272.89 5776.53,-5272.89"/>
<polygon fill="black" stroke="black" points="5780.03,-5272.89 5776.53,-5262.89 5773.03,-5272.89 5780.03,-5272.89"/>
</g>
<!-- concat_dim_3_1&#45;&gt;concat_heads_3 -->
<g id="edge464" class="edge">
<title>concat_dim_3_1&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M5564,-5401.54C5564,-5401.54 5564,-5326.1 5564,-5326.1"/>
<polygon fill="black" stroke="black" points="5567.5,-5326.1 5564,-5316.1 5560.5,-5326.1 5567.5,-5326.1"/>
</g>
<!-- concat_dim_3_2&#45;&gt;concat_heads_3 -->
<g id="edge494" class="edge">
<title>concat_dim_3_2&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M3823.73,-5437C4235.8,-5437 5350.64,-5437 5350.64,-5437 5350.64,-5437 5350.64,-5272.89 5350.64,-5272.89"/>
<polygon fill="black" stroke="black" points="5354.14,-5272.89 5350.64,-5262.89 5347.14,-5272.89 5354.14,-5272.89"/>
</g>
<!-- concat_dim_3_3&#45;&gt;concat_heads_3 -->
<g id="edge524" class="edge">
<title>concat_dim_3_3&#45;&gt;concat_heads_3</title>
<path fill="none" stroke="black" d="M1405,-5401.58C1405,-5344.52 1405,-5262 1405,-5262 1405,-5262 5379.93,-5262 5379.93,-5262"/>
<polygon fill="black" stroke="black" points="5379.93,-5265.5 5389.93,-5262 5379.93,-5258.5 5379.93,-5265.5"/>
</g>
<!-- out_proj_3 -->
<g id="node351" class="node">
<title>out_proj_3</title>
<polygon fill="lightcoral" stroke="black" points="7496,-5123.77 7352,-5123.77 7352,-5070.77 7496,-5070.77 7496,-5123.77"/>
<text text-anchor="middle" x="7424" y="-5108.57" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="7424" y="-5093.57" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7424" y="-5078.57" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads_3&#45;&gt;out_proj_3 -->
<g id="edge525" class="edge">
<title>concat_heads_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M5736.73,-5262C6188.39,-5262 7369.75,-5262 7369.75,-5262 7369.75,-5262 7369.75,-5134.1 7369.75,-5134.1"/>
<polygon fill="black" stroke="black" points="7373.25,-5134.1 7369.75,-5124.1 7366.25,-5134.1 7373.25,-5134.1"/>
</g>
<!-- out_proj_3&#45;&gt;residual3_1 -->
<g id="edge526" class="edge">
<title>out_proj_3&#45;&gt;residual3_1</title>
<path fill="none" stroke="black" d="M7496.39,-5097C7784.6,-5097 8834.86,-5097 8834.86,-5097 8834.86,-5097 8834.86,-4972.47 8834.86,-4972.47"/>
<polygon fill="black" stroke="black" points="8838.36,-4972.47 8834.86,-4962.47 8831.36,-4972.47 8838.36,-4972.47"/>
</g>
<!-- ln3_mlp -->
<g id="node353" class="node">
<title>ln3_mlp</title>
<polygon fill="lightblue" stroke="black" points="8822,-4823.81 8724,-4823.81 8724,-4770.81 8822,-4770.81 8822,-4823.81"/>
<text text-anchor="middle" x="8773" y="-4808.61" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8773" y="-4793.61" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8773" y="-4778.61" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual3_1&#45;&gt;ln3_mlp -->
<g id="edge528" class="edge">
<title>residual3_1&#45;&gt;ln3_mlp</title>
<path fill="none" stroke="black" d="M8833.1,-4934C8819,-4934 8808.5,-4934 8808.5,-4934 8808.5,-4934 8808.5,-4833.99 8808.5,-4833.99"/>
<polygon fill="black" stroke="black" points="8812,-4833.99 8808.5,-4823.99 8805,-4833.99 8812,-4833.99"/>
</g>
<!-- residual3_2 -->
<g id="node414" class="node">
<title>residual3_2</title>
<ellipse fill="yellow" stroke="black" cx="7275" cy="-3270.34" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="7275" y="-3281.64" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="7275" y="-3266.64" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7275" y="-3251.64" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual3_1&#45;&gt;residual3_2 -->
<g id="edge605" class="edge">
<title>residual3_1&#45;&gt;residual3_2</title>
<path fill="none" stroke="black" d="M8832.08,-4959C8521.82,-4959 7340.75,-4959 7340.75,-4959 7340.75,-4959 7340.75,-3300.48 7340.75,-3300.48"/>
<polygon fill="black" stroke="black" points="7344.25,-3300.48 7340.75,-3290.48 7337.25,-3300.48 7344.25,-3300.48"/>
</g>
<!-- gate3 -->
<g id="node354" class="node">
<title>gate3</title>
<polygon fill="purple" stroke="black" points="8008.98,-4684.81 7740.17,-4684.81 7671.02,-4578.81 7939.83,-4578.81 8008.98,-4684.81"/>
<text text-anchor="middle" x="7840" y="-4643.11" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="7840" y="-4628.11" font-family="Times,serif" font-size="14.00">(B×L×num_experts)</text>
<text text-anchor="middle" x="7840" y="-4613.11" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln3_mlp&#45;&gt;gate3 -->
<g id="edge529" class="edge">
<title>ln3_mlp&#45;&gt;gate3</title>
<path fill="none" stroke="black" d="M8724,-4797C8554.54,-4797 8003.66,-4797 8003.66,-4797 8003.66,-4797 8003.66,-4641.93 8003.66,-4641.93"/>
<polygon fill="black" stroke="black" points="8007.16,-4641.93 8003.66,-4631.93 8000.16,-4641.93 8007.16,-4641.93"/>
</g>
<!-- expert_select3 -->
<g id="node355" class="node">
<title>expert_select3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7108,-4492.81 6883.7,-4492.81 6826,-4386.81 7050.3,-4386.81 7108,-4492.81"/>
<text text-anchor="middle" x="6967" y="-4451.11" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="6967" y="-4436.11" font-family="Times,serif" font-size="14.00">(B×L×top_k)</text>
<text text-anchor="middle" x="6967" y="-4421.11" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- gate3&#45;&gt;expert_select3 -->
<g id="edge530" class="edge">
<title>gate3&#45;&gt;expert_select3</title>
<path fill="none" stroke="black" d="M7704.92,-4631C7487,-4631 7082,-4631 7082,-4631 7082,-4631 7082,-4502.82 7082,-4502.82"/>
<polygon fill="black" stroke="black" points="7085.5,-4502.82 7082,-4492.82 7078.5,-4502.82 7085.5,-4502.82"/>
</g>
<!-- expert3_0_linear1_0 -->
<g id="node356" class="node">
<title>expert3_0_linear1_0</title>
<polygon fill="lightcoral" stroke="black" points="5055.5,-4300.81 4862.5,-4300.81 4862.5,-4247.81 5055.5,-4247.81 5055.5,-4300.81"/>
<text text-anchor="middle" x="4959" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="4959" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4959" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_select3&#45;&gt;expert3_0_linear1_0 -->
<g id="edge531" class="edge">
<title>expert_select3&#45;&gt;expert3_0_linear1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6876.07,-4479C6493.56,-4479 5034.75,-4479 5034.75,-4479 5034.75,-4479 5034.75,-4311.07 5034.75,-4311.07"/>
<polygon fill="black" stroke="black" points="5038.25,-4311.07 5034.75,-4301.07 5031.25,-4311.07 5038.25,-4311.07"/>
</g>
<!-- expert3_0_linear1_1 -->
<g id="node359" class="node">
<title>expert3_0_linear1_1</title>
<polygon fill="lightcoral" stroke="black" points="5306.5,-4300.81 5113.5,-4300.81 5113.5,-4247.81 5306.5,-4247.81 5306.5,-4300.81"/>
<text text-anchor="middle" x="5210" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="5210" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5210" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_select3&#45;&gt;expert3_0_linear1_1 -->
<g id="edge535" class="edge">
<title>expert_select3&#45;&gt;expert3_0_linear1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6868.92,-4466C6508.55,-4466 5278.5,-4466 5278.5,-4466 5278.5,-4466 5278.5,-4310.97 5278.5,-4310.97"/>
<polygon fill="black" stroke="black" points="5282,-4310.97 5278.5,-4300.97 5275,-4310.97 5282,-4310.97"/>
</g>
<!-- expert3_1_linear1_2 -->
<g id="node363" class="node">
<title>expert3_1_linear1_2</title>
<polygon fill="lightcoral" stroke="black" points="5557.5,-4300.81 5364.5,-4300.81 5364.5,-4247.81 5557.5,-4247.81 5557.5,-4300.81"/>
<text text-anchor="middle" x="5461" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="5461" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5461" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_select3&#45;&gt;expert3_1_linear1_2 -->
<g id="edge540" class="edge">
<title>expert_select3&#45;&gt;expert3_1_linear1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6862,-4453C6520.15,-4453 5461,-4453 5461,-4453 5461,-4453 5461,-4311.06 5461,-4311.06"/>
<polygon fill="black" stroke="black" points="5464.5,-4311.06 5461,-4301.06 5457.5,-4311.06 5464.5,-4311.06"/>
</g>
<!-- expert3_1_linear1_3 -->
<g id="node366" class="node">
<title>expert3_1_linear1_3</title>
<polygon fill="lightcoral" stroke="black" points="5808.5,-4300.81 5615.5,-4300.81 5615.5,-4247.81 5808.5,-4247.81 5808.5,-4300.81"/>
<text text-anchor="middle" x="5712" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="5712" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5712" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_select3&#45;&gt;expert3_1_linear1_3 -->
<g id="edge544" class="edge">
<title>expert_select3&#45;&gt;expert3_1_linear1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6854.37,-4439C6560.86,-4439 5795.11,-4439 5795.11,-4439 5795.11,-4439 5795.11,-4311.14 5795.11,-4311.14"/>
<polygon fill="black" stroke="black" points="5798.61,-4311.14 5795.11,-4301.14 5791.61,-4311.14 5798.61,-4311.14"/>
</g>
<!-- expert3_2_linear1_4 -->
<g id="node370" class="node">
<title>expert3_2_linear1_4</title>
<polygon fill="lightcoral" stroke="black" points="6059.5,-4300.81 5866.5,-4300.81 5866.5,-4247.81 6059.5,-4247.81 6059.5,-4300.81"/>
<text text-anchor="middle" x="5963" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="5963" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5963" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_select3&#45;&gt;expert3_2_linear1_4 -->
<g id="edge549" class="edge">
<title>expert_select3&#45;&gt;expert3_2_linear1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6847.28,-4426C6595.26,-4426 6033,-4426 6033,-4426 6033,-4426 6033,-4311.08 6033,-4311.08"/>
<polygon fill="black" stroke="black" points="6036.5,-4311.08 6033,-4301.08 6029.5,-4311.08 6036.5,-4311.08"/>
</g>
<!-- expert3_2_linear1_5 -->
<g id="node373" class="node">
<title>expert3_2_linear1_5</title>
<polygon fill="lightcoral" stroke="black" points="6310.5,-4300.81 6117.5,-4300.81 6117.5,-4247.81 6310.5,-4247.81 6310.5,-4300.81"/>
<text text-anchor="middle" x="6214" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="6214" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6214" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_select3&#45;&gt;expert3_2_linear1_5 -->
<g id="edge553" class="edge">
<title>expert_select3&#45;&gt;expert3_2_linear1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6840.14,-4413C6648.42,-4413 6307,-4413 6307,-4413 6307,-4413 6307,-4311.05 6307,-4311.05"/>
<polygon fill="black" stroke="black" points="6310.5,-4311.05 6307,-4301.05 6303.5,-4311.05 6310.5,-4311.05"/>
</g>
<!-- expert3_3_linear1_6 -->
<g id="node377" class="node">
<title>expert3_3_linear1_6</title>
<polygon fill="lightcoral" stroke="black" points="6561.5,-4300.81 6368.5,-4300.81 6368.5,-4247.81 6561.5,-4247.81 6561.5,-4300.81"/>
<text text-anchor="middle" x="6465" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="6465" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6465" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_select3&#45;&gt;expert3_3_linear1_6 -->
<g id="edge558" class="edge">
<title>expert_select3&#45;&gt;expert3_3_linear1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6833.08,-4400C6709.08,-4400 6543.75,-4400 6543.75,-4400 6543.75,-4400 6543.75,-4310.97 6543.75,-4310.97"/>
<polygon fill="black" stroke="black" points="6547.25,-4310.97 6543.75,-4300.97 6540.25,-4310.97 6547.25,-4310.97"/>
</g>
<!-- expert3_3_linear1_7 -->
<g id="node380" class="node">
<title>expert3_3_linear1_7</title>
<polygon fill="lightcoral" stroke="black" points="6812.5,-4300.81 6619.5,-4300.81 6619.5,-4247.81 6812.5,-4247.81 6812.5,-4300.81"/>
<text text-anchor="middle" x="6716" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="6716" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6716" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_select3&#45;&gt;expert3_3_linear1_7 -->
<g id="edge562" class="edge">
<title>expert_select3&#45;&gt;expert3_3_linear1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6851.6,-4386.44C6851.6,-4337.96 6851.6,-4274 6851.6,-4274 6851.6,-4274 6822.74,-4274 6822.74,-4274"/>
<polygon fill="black" stroke="black" points="6822.74,-4270.5 6812.74,-4274 6822.74,-4277.5 6822.74,-4270.5"/>
</g>
<!-- expert3_4_linear1_8 -->
<g id="node384" class="node">
<title>expert3_4_linear1_8</title>
<polygon fill="lightcoral" stroke="black" points="7063.5,-4300.81 6870.5,-4300.81 6870.5,-4247.81 7063.5,-4247.81 7063.5,-4300.81"/>
<text text-anchor="middle" x="6967" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="6967" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6967" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_select3&#45;&gt;expert3_4_linear1_8 -->
<g id="edge567" class="edge">
<title>expert_select3&#45;&gt;expert3_4_linear1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6967,-4386.54C6967,-4386.54 6967,-4311.06 6967,-4311.06"/>
<polygon fill="black" stroke="black" points="6970.5,-4311.06 6967,-4301.06 6963.5,-4311.06 6970.5,-4311.06"/>
</g>
<!-- expert3_4_linear1_9 -->
<g id="node387" class="node">
<title>expert3_4_linear1_9</title>
<polygon fill="lightcoral" stroke="black" points="7314.5,-4300.81 7121.5,-4300.81 7121.5,-4247.81 7314.5,-4247.81 7314.5,-4300.81"/>
<text text-anchor="middle" x="7218" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="7218" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7218" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_select3&#45;&gt;expert3_4_linear1_9 -->
<g id="edge571" class="edge">
<title>expert_select3&#45;&gt;expert3_4_linear1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7085.75,-4439.69C7085.75,-4434.67 7085.75,-4274 7085.75,-4274 7085.75,-4274 7111.19,-4274 7111.19,-4274"/>
<polygon fill="black" stroke="black" points="7111.19,-4277.5 7121.19,-4274 7111.19,-4270.5 7111.19,-4277.5"/>
</g>
<!-- expert3_5_linear1_10 -->
<g id="node391" class="node">
<title>expert3_5_linear1_10</title>
<polygon fill="lightcoral" stroke="black" points="7565.5,-4300.81 7372.5,-4300.81 7372.5,-4247.81 7565.5,-4247.81 7565.5,-4300.81"/>
<text text-anchor="middle" x="7469" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="7469" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7469" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_select3&#45;&gt;expert3_5_linear1_10 -->
<g id="edge576" class="edge">
<title>expert_select3&#45;&gt;expert3_5_linear1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7058.2,-4401C7194.18,-4401 7434.25,-4401 7434.25,-4401 7434.25,-4401 7434.25,-4310.87 7434.25,-4310.87"/>
<polygon fill="black" stroke="black" points="7437.75,-4310.87 7434.25,-4300.87 7430.75,-4310.87 7437.75,-4310.87"/>
</g>
<!-- expert3_5_linear1_11 -->
<g id="node394" class="node">
<title>expert3_5_linear1_11</title>
<polygon fill="lightcoral" stroke="black" points="7816.5,-4300.81 7623.5,-4300.81 7623.5,-4247.81 7816.5,-4247.81 7816.5,-4300.81"/>
<text text-anchor="middle" x="7720" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="7720" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7720" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_select3&#45;&gt;expert3_5_linear1_11 -->
<g id="edge580" class="edge">
<title>expert_select3&#45;&gt;expert3_5_linear1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7067.01,-4417C7256.09,-4417 7647.25,-4417 7647.25,-4417 7647.25,-4417 7647.25,-4310.82 7647.25,-4310.82"/>
<polygon fill="black" stroke="black" points="7650.75,-4310.82 7647.25,-4300.82 7643.75,-4310.82 7650.75,-4310.82"/>
</g>
<!-- expert3_6_linear1_12 -->
<g id="node398" class="node">
<title>expert3_6_linear1_12</title>
<polygon fill="lightcoral" stroke="black" points="8067.5,-4300.81 7874.5,-4300.81 7874.5,-4247.81 8067.5,-4247.81 8067.5,-4300.81"/>
<text text-anchor="middle" x="7971" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="7971" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7971" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_select3&#45;&gt;expert3_6_linear1_12 -->
<g id="edge585" class="edge">
<title>expert_select3&#45;&gt;expert3_6_linear1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7075.04,-4432C7328.83,-4432 7941.75,-4432 7941.75,-4432 7941.75,-4432 7941.75,-4311.06 7941.75,-4311.06"/>
<polygon fill="black" stroke="black" points="7945.25,-4311.06 7941.75,-4301.06 7938.25,-4311.06 7945.25,-4311.06"/>
</g>
<!-- expert3_6_linear1_13 -->
<g id="node401" class="node">
<title>expert3_6_linear1_13</title>
<polygon fill="lightcoral" stroke="black" points="8318.5,-4300.81 8125.5,-4300.81 8125.5,-4247.81 8318.5,-4247.81 8318.5,-4300.81"/>
<text text-anchor="middle" x="8222" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="8222" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8222" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_select3&#45;&gt;expert3_6_linear1_13 -->
<g id="edge589" class="edge">
<title>expert_select3&#45;&gt;expert3_6_linear1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7083.22,-4447C7386.09,-4447 8176.25,-4447 8176.25,-4447 8176.25,-4447 8176.25,-4310.92 8176.25,-4310.92"/>
<polygon fill="black" stroke="black" points="8179.75,-4310.92 8176.25,-4300.92 8172.75,-4310.92 8179.75,-4310.92"/>
</g>
<!-- expert3_7_linear1_14 -->
<g id="node405" class="node">
<title>expert3_7_linear1_14</title>
<polygon fill="lightcoral" stroke="black" points="8569.5,-4300.81 8376.5,-4300.81 8376.5,-4247.81 8569.5,-4247.81 8569.5,-4300.81"/>
<text text-anchor="middle" x="8473" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="8473" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8473" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_select3&#45;&gt;expert3_7_linear1_14 -->
<g id="edge594" class="edge">
<title>expert_select3&#45;&gt;expert3_7_linear1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7091.51,-4462C7443.42,-4462 8420,-4462 8420,-4462 8420,-4462 8420,-4311.2 8420,-4311.2"/>
<polygon fill="black" stroke="black" points="8423.5,-4311.2 8420,-4301.2 8416.5,-4311.2 8423.5,-4311.2"/>
</g>
<!-- expert3_7_linear1_15 -->
<g id="node408" class="node">
<title>expert3_7_linear1_15</title>
<polygon fill="lightcoral" stroke="black" points="8820.5,-4300.81 8627.5,-4300.81 8627.5,-4247.81 8820.5,-4247.81 8820.5,-4300.81"/>
<text text-anchor="middle" x="8724" y="-4285.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="8724" y="-4270.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8724" y="-4255.61" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_select3&#45;&gt;expert3_7_linear1_15 -->
<g id="edge598" class="edge">
<title>expert_select3&#45;&gt;expert3_7_linear1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7099.66,-4477C7501.14,-4477 8675.75,-4477 8675.75,-4477 8675.75,-4477 8675.75,-4311.23 8675.75,-4311.23"/>
<polygon fill="black" stroke="black" points="8679.25,-4311.23 8675.75,-4301.23 8672.25,-4311.23 8679.25,-4311.23"/>
</g>
<!-- expert3_0_gelu_0 -->
<g id="node357" class="node">
<title>expert3_0_gelu_0</title>
<polygon fill="lightblue" stroke="black" points="5055.5,-4161.81 4862.5,-4161.81 4862.5,-4108.81 5055.5,-4108.81 5055.5,-4161.81"/>
<text text-anchor="middle" x="4959" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="4959" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="4959" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert3_0_linear1_0&#45;&gt;expert3_0_gelu_0 -->
<g id="edge532" class="edge">
<title>expert3_0_linear1_0&#45;&gt;expert3_0_gelu_0</title>
<path fill="none" stroke="black" d="M4959,-4247.51C4959,-4247.51 4959,-4172.03 4959,-4172.03"/>
<polygon fill="black" stroke="black" points="4962.5,-4172.03 4959,-4162.03 4955.5,-4172.03 4962.5,-4172.03"/>
</g>
<!-- expert3_0_linear2_0 -->
<g id="node358" class="node">
<title>expert3_0_linear2_0</title>
<polygon fill="lightcoral" stroke="black" points="5028,-4022.81 4890,-4022.81 4890,-3969.81 5028,-3969.81 5028,-4022.81"/>
<text text-anchor="middle" x="4959" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="4959" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="4959" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert3_0_gelu_0&#45;&gt;expert3_0_linear2_0 -->
<g id="edge533" class="edge">
<title>expert3_0_gelu_0&#45;&gt;expert3_0_linear2_0</title>
<path fill="none" stroke="black" d="M4959,-4108.51C4959,-4108.51 4959,-4033.03 4959,-4033.03"/>
<polygon fill="black" stroke="black" points="4962.5,-4033.03 4959,-4023.03 4955.5,-4033.03 4962.5,-4033.03"/>
</g>
<!-- expert3_0_agg -->
<g id="node362" class="node">
<title>expert3_0_agg</title>
<polygon fill="lightgreen" stroke="black" points="5193.11,-3883.81 4820.69,-3883.81 4724.89,-3777.81 5097.31,-3777.81 5193.11,-3883.81"/>
<text text-anchor="middle" x="4959" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 0 Output Aggregation</text>
<text text-anchor="middle" x="4959" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="4959" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 0,1</text>
</g>
<!-- expert3_0_linear2_0&#45;&gt;expert3_0_agg -->
<g id="edge534" class="edge">
<title>expert3_0_linear2_0&#45;&gt;expert3_0_agg</title>
<path fill="none" stroke="black" d="M4959,-3969.72C4959,-3969.72 4959,-3894.08 4959,-3894.08"/>
<polygon fill="black" stroke="black" points="4962.5,-3894.08 4959,-3884.08 4955.5,-3894.08 4962.5,-3894.08"/>
</g>
<!-- expert3_0_gelu_1 -->
<g id="node360" class="node">
<title>expert3_0_gelu_1</title>
<polygon fill="lightblue" stroke="black" points="5306.5,-4161.81 5113.5,-4161.81 5113.5,-4108.81 5306.5,-4108.81 5306.5,-4161.81"/>
<text text-anchor="middle" x="5210" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="5210" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5210" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert3_0_linear1_1&#45;&gt;expert3_0_gelu_1 -->
<g id="edge536" class="edge">
<title>expert3_0_linear1_1&#45;&gt;expert3_0_gelu_1</title>
<path fill="none" stroke="black" d="M5210,-4247.51C5210,-4247.51 5210,-4172.03 5210,-4172.03"/>
<polygon fill="black" stroke="black" points="5213.5,-4172.03 5210,-4162.03 5206.5,-4172.03 5213.5,-4172.03"/>
</g>
<!-- expert3_0_linear2_1 -->
<g id="node361" class="node">
<title>expert3_0_linear2_1</title>
<polygon fill="lightcoral" stroke="black" points="5252,-4022.81 5114,-4022.81 5114,-3969.81 5252,-3969.81 5252,-4022.81"/>
<text text-anchor="middle" x="5183" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="5183" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5183" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert3_0_gelu_1&#45;&gt;expert3_0_linear2_1 -->
<g id="edge537" class="edge">
<title>expert3_0_gelu_1&#45;&gt;expert3_0_linear2_1</title>
<path fill="none" stroke="black" d="M5183,-4108.51C5183,-4108.51 5183,-4033.03 5183,-4033.03"/>
<polygon fill="black" stroke="black" points="5186.5,-4033.03 5183,-4023.03 5179.5,-4033.03 5186.5,-4033.03"/>
</g>
<!-- expert3_0_linear2_1&#45;&gt;expert3_0_agg -->
<g id="edge538" class="edge">
<title>expert3_0_linear2_1&#45;&gt;expert3_0_agg</title>
<path fill="none" stroke="black" d="M5153.65,-3969.72C5153.65,-3969.72 5153.65,-3894.08 5153.65,-3894.08"/>
<polygon fill="black" stroke="black" points="5157.15,-3894.08 5153.65,-3884.08 5150.15,-3894.08 5157.15,-3894.08"/>
</g>
<!-- expert_outputs3 -->
<g id="node412" class="node">
<title>expert_outputs3</title>
<polygon fill="lightgreen" stroke="black" points="7295.17,-3691.81 6932.2,-3691.81 6838.83,-3585.81 7201.8,-3585.81 7295.17,-3691.81"/>
<text text-anchor="middle" x="7067" y="-3650.11" font-family="Times,serif" font-size="14.00">Expert Outputs Aggregation</text>
<text text-anchor="middle" x="7067" y="-3635.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7067" y="-3620.11" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert3_0_agg&#45;&gt;expert_outputs3 -->
<g id="edge539" class="edge">
<title>expert3_0_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M5183.1,-3830.65C5183.1,-3823.87 5183.1,-3607 5183.1,-3607 5183.1,-3607 6847.29,-3607 6847.29,-3607"/>
<polygon fill="black" stroke="black" points="6847.29,-3610.5 6857.29,-3607 6847.29,-3603.5 6847.29,-3610.5"/>
</g>
<!-- expert3_1_gelu_2 -->
<g id="node364" class="node">
<title>expert3_1_gelu_2</title>
<polygon fill="lightblue" stroke="black" points="5557.5,-4161.81 5364.5,-4161.81 5364.5,-4108.81 5557.5,-4108.81 5557.5,-4161.81"/>
<text text-anchor="middle" x="5461" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5461" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5461" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert3_1_linear1_2&#45;&gt;expert3_1_gelu_2 -->
<g id="edge541" class="edge">
<title>expert3_1_linear1_2&#45;&gt;expert3_1_gelu_2</title>
<path fill="none" stroke="black" d="M5461,-4247.51C5461,-4247.51 5461,-4172.03 5461,-4172.03"/>
<polygon fill="black" stroke="black" points="5464.5,-4172.03 5461,-4162.03 5457.5,-4172.03 5464.5,-4172.03"/>
</g>
<!-- expert3_1_linear2_2 -->
<g id="node365" class="node">
<title>expert3_1_linear2_2</title>
<polygon fill="lightcoral" stroke="black" points="5542,-4022.81 5404,-4022.81 5404,-3969.81 5542,-3969.81 5542,-4022.81"/>
<text text-anchor="middle" x="5473" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="5473" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5473" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert3_1_gelu_2&#45;&gt;expert3_1_linear2_2 -->
<g id="edge542" class="edge">
<title>expert3_1_gelu_2&#45;&gt;expert3_1_linear2_2</title>
<path fill="none" stroke="black" d="M5473,-4108.51C5473,-4108.51 5473,-4033.03 5473,-4033.03"/>
<polygon fill="black" stroke="black" points="5476.5,-4033.03 5473,-4023.03 5469.5,-4033.03 5476.5,-4033.03"/>
</g>
<!-- expert3_1_agg -->
<g id="node369" class="node">
<title>expert3_1_agg</title>
<polygon fill="lightgreen" stroke="black" points="5720.11,-3883.81 5347.69,-3883.81 5251.89,-3777.81 5624.31,-3777.81 5720.11,-3883.81"/>
<text text-anchor="middle" x="5486" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 1 Output Aggregation</text>
<text text-anchor="middle" x="5486" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5486" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 2,3</text>
</g>
<!-- expert3_1_linear2_2&#45;&gt;expert3_1_agg -->
<g id="edge543" class="edge">
<title>expert3_1_linear2_2&#45;&gt;expert3_1_agg</title>
<path fill="none" stroke="black" d="M5473,-3969.72C5473,-3969.72 5473,-3894.08 5473,-3894.08"/>
<polygon fill="black" stroke="black" points="5476.5,-3894.08 5473,-3884.08 5469.5,-3894.08 5476.5,-3894.08"/>
</g>
<!-- expert3_1_gelu_3 -->
<g id="node367" class="node">
<title>expert3_1_gelu_3</title>
<polygon fill="lightblue" stroke="black" points="5808.5,-4161.81 5615.5,-4161.81 5615.5,-4108.81 5808.5,-4108.81 5808.5,-4161.81"/>
<text text-anchor="middle" x="5712" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="5712" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5712" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert3_1_linear1_3&#45;&gt;expert3_1_gelu_3 -->
<g id="edge545" class="edge">
<title>expert3_1_linear1_3&#45;&gt;expert3_1_gelu_3</title>
<path fill="none" stroke="black" d="M5712,-4247.51C5712,-4247.51 5712,-4172.03 5712,-4172.03"/>
<polygon fill="black" stroke="black" points="5715.5,-4172.03 5712,-4162.03 5708.5,-4172.03 5715.5,-4172.03"/>
</g>
<!-- expert3_1_linear2_3 -->
<g id="node368" class="node">
<title>expert3_1_linear2_3</title>
<polygon fill="lightcoral" stroke="black" points="5765,-4022.81 5627,-4022.81 5627,-3969.81 5765,-3969.81 5765,-4022.81"/>
<text text-anchor="middle" x="5696" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="5696" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5696" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert3_1_gelu_3&#45;&gt;expert3_1_linear2_3 -->
<g id="edge546" class="edge">
<title>expert3_1_gelu_3&#45;&gt;expert3_1_linear2_3</title>
<path fill="none" stroke="black" d="M5696,-4108.51C5696,-4108.51 5696,-4033.03 5696,-4033.03"/>
<polygon fill="black" stroke="black" points="5699.5,-4033.03 5696,-4023.03 5692.5,-4033.03 5699.5,-4033.03"/>
</g>
<!-- expert3_1_linear2_3&#45;&gt;expert3_1_agg -->
<g id="edge547" class="edge">
<title>expert3_1_linear2_3&#45;&gt;expert3_1_agg</title>
<path fill="none" stroke="black" d="M5673.65,-3969.72C5673.65,-3969.72 5673.65,-3894.08 5673.65,-3894.08"/>
<polygon fill="black" stroke="black" points="5677.15,-3894.08 5673.65,-3884.08 5670.15,-3894.08 5677.15,-3894.08"/>
</g>
<!-- expert3_1_agg&#45;&gt;expert_outputs3 -->
<g id="edge548" class="edge">
<title>expert3_1_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M5642.44,-3797.78C5642.44,-3740.31 5642.44,-3628 5642.44,-3628 5642.44,-3628 6865.99,-3628 6865.99,-3628"/>
<polygon fill="black" stroke="black" points="6865.99,-3631.5 6875.99,-3628 6865.99,-3624.5 6865.99,-3631.5"/>
</g>
<!-- expert3_2_gelu_4 -->
<g id="node371" class="node">
<title>expert3_2_gelu_4</title>
<polygon fill="lightblue" stroke="black" points="6059.5,-4161.81 5866.5,-4161.81 5866.5,-4108.81 6059.5,-4108.81 6059.5,-4161.81"/>
<text text-anchor="middle" x="5963" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="5963" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="5963" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert3_2_linear1_4&#45;&gt;expert3_2_gelu_4 -->
<g id="edge550" class="edge">
<title>expert3_2_linear1_4&#45;&gt;expert3_2_gelu_4</title>
<path fill="none" stroke="black" d="M5963,-4247.51C5963,-4247.51 5963,-4172.03 5963,-4172.03"/>
<polygon fill="black" stroke="black" points="5966.5,-4172.03 5963,-4162.03 5959.5,-4172.03 5966.5,-4172.03"/>
</g>
<!-- expert3_2_linear2_4 -->
<g id="node372" class="node">
<title>expert3_2_linear2_4</title>
<polygon fill="lightcoral" stroke="black" points="6046,-4022.81 5908,-4022.81 5908,-3969.81 6046,-3969.81 6046,-4022.81"/>
<text text-anchor="middle" x="5977" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="5977" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="5977" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert3_2_gelu_4&#45;&gt;expert3_2_linear2_4 -->
<g id="edge551" class="edge">
<title>expert3_2_gelu_4&#45;&gt;expert3_2_linear2_4</title>
<path fill="none" stroke="black" d="M5977,-4108.51C5977,-4108.51 5977,-4033.03 5977,-4033.03"/>
<polygon fill="black" stroke="black" points="5980.5,-4033.03 5977,-4023.03 5973.5,-4033.03 5980.5,-4033.03"/>
</g>
<!-- expert3_2_agg -->
<g id="node376" class="node">
<title>expert3_2_agg</title>
<polygon fill="lightgreen" stroke="black" points="6247.11,-3883.81 5874.69,-3883.81 5778.89,-3777.81 6151.31,-3777.81 6247.11,-3883.81"/>
<text text-anchor="middle" x="6013" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 2 Output Aggregation</text>
<text text-anchor="middle" x="6013" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6013" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 4,5</text>
</g>
<!-- expert3_2_linear2_4&#45;&gt;expert3_2_agg -->
<g id="edge552" class="edge">
<title>expert3_2_linear2_4&#45;&gt;expert3_2_agg</title>
<path fill="none" stroke="black" d="M5977,-3969.72C5977,-3969.72 5977,-3894.08 5977,-3894.08"/>
<polygon fill="black" stroke="black" points="5980.5,-3894.08 5977,-3884.08 5973.5,-3894.08 5980.5,-3894.08"/>
</g>
<!-- expert3_2_gelu_5 -->
<g id="node374" class="node">
<title>expert3_2_gelu_5</title>
<polygon fill="lightblue" stroke="black" points="6310.5,-4161.81 6117.5,-4161.81 6117.5,-4108.81 6310.5,-4108.81 6310.5,-4161.81"/>
<text text-anchor="middle" x="6214" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="6214" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6214" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert3_2_linear1_5&#45;&gt;expert3_2_gelu_5 -->
<g id="edge554" class="edge">
<title>expert3_2_linear1_5&#45;&gt;expert3_2_gelu_5</title>
<path fill="none" stroke="black" d="M6214,-4247.51C6214,-4247.51 6214,-4172.03 6214,-4172.03"/>
<polygon fill="black" stroke="black" points="6217.5,-4172.03 6214,-4162.03 6210.5,-4172.03 6217.5,-4172.03"/>
</g>
<!-- expert3_2_linear2_5 -->
<g id="node375" class="node">
<title>expert3_2_linear2_5</title>
<polygon fill="lightcoral" stroke="black" points="6269,-4022.81 6131,-4022.81 6131,-3969.81 6269,-3969.81 6269,-4022.81"/>
<text text-anchor="middle" x="6200" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="6200" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6200" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert3_2_gelu_5&#45;&gt;expert3_2_linear2_5 -->
<g id="edge555" class="edge">
<title>expert3_2_gelu_5&#45;&gt;expert3_2_linear2_5</title>
<path fill="none" stroke="black" d="M6200,-4108.51C6200,-4108.51 6200,-4033.03 6200,-4033.03"/>
<polygon fill="black" stroke="black" points="6203.5,-4033.03 6200,-4023.03 6196.5,-4033.03 6203.5,-4033.03"/>
</g>
<!-- expert3_2_linear2_5&#45;&gt;expert3_2_agg -->
<g id="edge556" class="edge">
<title>expert3_2_linear2_5&#45;&gt;expert3_2_agg</title>
<path fill="none" stroke="black" d="M6189.15,-3969.72C6189.15,-3969.72 6189.15,-3894.08 6189.15,-3894.08"/>
<polygon fill="black" stroke="black" points="6192.65,-3894.08 6189.15,-3884.08 6185.65,-3894.08 6192.65,-3894.08"/>
</g>
<!-- expert3_2_agg&#45;&gt;expert_outputs3 -->
<g id="edge557" class="edge">
<title>expert3_2_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M6208.9,-3830.68C6208.9,-3825.18 6208.9,-3649 6208.9,-3649 6208.9,-3649 6884.38,-3649 6884.38,-3649"/>
<polygon fill="black" stroke="black" points="6884.38,-3652.5 6894.38,-3649 6884.38,-3645.5 6884.38,-3652.5"/>
</g>
<!-- expert3_3_gelu_6 -->
<g id="node378" class="node">
<title>expert3_3_gelu_6</title>
<polygon fill="lightblue" stroke="black" points="6561.5,-4161.81 6368.5,-4161.81 6368.5,-4108.81 6561.5,-4108.81 6561.5,-4161.81"/>
<text text-anchor="middle" x="6465" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6465" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6465" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert3_3_linear1_6&#45;&gt;expert3_3_gelu_6 -->
<g id="edge559" class="edge">
<title>expert3_3_linear1_6&#45;&gt;expert3_3_gelu_6</title>
<path fill="none" stroke="black" d="M6465,-4247.51C6465,-4247.51 6465,-4172.03 6465,-4172.03"/>
<polygon fill="black" stroke="black" points="6468.5,-4172.03 6465,-4162.03 6461.5,-4172.03 6468.5,-4172.03"/>
</g>
<!-- expert3_3_linear2_6 -->
<g id="node379" class="node">
<title>expert3_3_linear2_6</title>
<polygon fill="lightcoral" stroke="black" points="6548,-4022.81 6410,-4022.81 6410,-3969.81 6548,-3969.81 6548,-4022.81"/>
<text text-anchor="middle" x="6479" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="6479" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6479" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert3_3_gelu_6&#45;&gt;expert3_3_linear2_6 -->
<g id="edge560" class="edge">
<title>expert3_3_gelu_6&#45;&gt;expert3_3_linear2_6</title>
<path fill="none" stroke="black" d="M6479,-4108.51C6479,-4108.51 6479,-4033.03 6479,-4033.03"/>
<polygon fill="black" stroke="black" points="6482.5,-4033.03 6479,-4023.03 6475.5,-4033.03 6482.5,-4033.03"/>
</g>
<!-- expert3_3_agg -->
<g id="node383" class="node">
<title>expert3_3_agg</title>
<polygon fill="lightgreen" stroke="black" points="6774.11,-3883.81 6401.69,-3883.81 6305.89,-3777.81 6678.31,-3777.81 6774.11,-3883.81"/>
<text text-anchor="middle" x="6540" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 3 Output Aggregation</text>
<text text-anchor="middle" x="6540" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6540" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 6,7</text>
</g>
<!-- expert3_3_linear2_6&#45;&gt;expert3_3_agg -->
<g id="edge561" class="edge">
<title>expert3_3_linear2_6&#45;&gt;expert3_3_agg</title>
<path fill="none" stroke="black" d="M6479,-3969.72C6479,-3969.72 6479,-3894.08 6479,-3894.08"/>
<polygon fill="black" stroke="black" points="6482.5,-3894.08 6479,-3884.08 6475.5,-3894.08 6482.5,-3894.08"/>
</g>
<!-- expert3_3_gelu_7 -->
<g id="node381" class="node">
<title>expert3_3_gelu_7</title>
<polygon fill="lightblue" stroke="black" points="6812.5,-4161.81 6619.5,-4161.81 6619.5,-4108.81 6812.5,-4108.81 6812.5,-4161.81"/>
<text text-anchor="middle" x="6716" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="6716" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6716" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert3_3_linear1_7&#45;&gt;expert3_3_gelu_7 -->
<g id="edge563" class="edge">
<title>expert3_3_linear1_7&#45;&gt;expert3_3_gelu_7</title>
<path fill="none" stroke="black" d="M6716,-4247.51C6716,-4247.51 6716,-4172.03 6716,-4172.03"/>
<polygon fill="black" stroke="black" points="6719.5,-4172.03 6716,-4162.03 6712.5,-4172.03 6719.5,-4172.03"/>
</g>
<!-- expert3_3_linear2_7 -->
<g id="node382" class="node">
<title>expert3_3_linear2_7</title>
<polygon fill="lightcoral" stroke="black" points="6771,-4022.81 6633,-4022.81 6633,-3969.81 6771,-3969.81 6771,-4022.81"/>
<text text-anchor="middle" x="6702" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="6702" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6702" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert3_3_gelu_7&#45;&gt;expert3_3_linear2_7 -->
<g id="edge564" class="edge">
<title>expert3_3_gelu_7&#45;&gt;expert3_3_linear2_7</title>
<path fill="none" stroke="black" d="M6702,-4108.51C6702,-4108.51 6702,-4033.03 6702,-4033.03"/>
<polygon fill="black" stroke="black" points="6705.5,-4033.03 6702,-4023.03 6698.5,-4033.03 6705.5,-4033.03"/>
</g>
<!-- expert3_3_linear2_7&#45;&gt;expert3_3_agg -->
<g id="edge565" class="edge">
<title>expert3_3_linear2_7&#45;&gt;expert3_3_agg</title>
<path fill="none" stroke="black" d="M6702,-3969.72C6702,-3969.72 6702,-3894.08 6702,-3894.08"/>
<polygon fill="black" stroke="black" points="6705.5,-3894.08 6702,-3884.08 6698.5,-3894.08 6705.5,-3894.08"/>
</g>
<!-- expert3_3_agg&#45;&gt;expert_outputs3 -->
<g id="edge566" class="edge">
<title>expert3_3_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M6755.9,-3830.7C6755.9,-3825.83 6755.9,-3670 6755.9,-3670 6755.9,-3670 6902.82,-3670 6902.82,-3670"/>
<polygon fill="black" stroke="black" points="6902.82,-3673.5 6912.82,-3670 6902.82,-3666.5 6902.82,-3673.5"/>
</g>
<!-- expert3_4_gelu_8 -->
<g id="node385" class="node">
<title>expert3_4_gelu_8</title>
<polygon fill="lightblue" stroke="black" points="7063.5,-4161.81 6870.5,-4161.81 6870.5,-4108.81 7063.5,-4108.81 7063.5,-4161.81"/>
<text text-anchor="middle" x="6967" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="6967" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6967" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert3_4_linear1_8&#45;&gt;expert3_4_gelu_8 -->
<g id="edge568" class="edge">
<title>expert3_4_linear1_8&#45;&gt;expert3_4_gelu_8</title>
<path fill="none" stroke="black" d="M6967,-4247.51C6967,-4247.51 6967,-4172.03 6967,-4172.03"/>
<polygon fill="black" stroke="black" points="6970.5,-4172.03 6967,-4162.03 6963.5,-4172.03 6970.5,-4172.03"/>
</g>
<!-- expert3_4_linear2_8 -->
<g id="node386" class="node">
<title>expert3_4_linear2_8</title>
<polygon fill="lightcoral" stroke="black" points="7050,-4022.81 6912,-4022.81 6912,-3969.81 7050,-3969.81 7050,-4022.81"/>
<text text-anchor="middle" x="6981" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="6981" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6981" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert3_4_gelu_8&#45;&gt;expert3_4_linear2_8 -->
<g id="edge569" class="edge">
<title>expert3_4_gelu_8&#45;&gt;expert3_4_linear2_8</title>
<path fill="none" stroke="black" d="M6981,-4108.51C6981,-4108.51 6981,-4033.03 6981,-4033.03"/>
<polygon fill="black" stroke="black" points="6984.5,-4033.03 6981,-4023.03 6977.5,-4033.03 6984.5,-4033.03"/>
</g>
<!-- expert3_4_agg -->
<g id="node390" class="node">
<title>expert3_4_agg</title>
<polygon fill="lightgreen" stroke="black" points="7301.11,-3883.81 6928.69,-3883.81 6832.89,-3777.81 7205.31,-3777.81 7301.11,-3883.81"/>
<text text-anchor="middle" x="7067" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 4 Output Aggregation</text>
<text text-anchor="middle" x="7067" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7067" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 8,9</text>
</g>
<!-- expert3_4_linear2_8&#45;&gt;expert3_4_agg -->
<g id="edge570" class="edge">
<title>expert3_4_linear2_8&#45;&gt;expert3_4_agg</title>
<path fill="none" stroke="black" d="M6981,-3969.72C6981,-3969.72 6981,-3894.08 6981,-3894.08"/>
<polygon fill="black" stroke="black" points="6984.5,-3894.08 6981,-3884.08 6977.5,-3894.08 6984.5,-3894.08"/>
</g>
<!-- expert3_4_gelu_9 -->
<g id="node388" class="node">
<title>expert3_4_gelu_9</title>
<polygon fill="lightblue" stroke="black" points="7314.5,-4161.81 7121.5,-4161.81 7121.5,-4108.81 7314.5,-4108.81 7314.5,-4161.81"/>
<text text-anchor="middle" x="7218" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="7218" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7218" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert3_4_linear1_9&#45;&gt;expert3_4_gelu_9 -->
<g id="edge572" class="edge">
<title>expert3_4_linear1_9&#45;&gt;expert3_4_gelu_9</title>
<path fill="none" stroke="black" d="M7218,-4247.51C7218,-4247.51 7218,-4172.03 7218,-4172.03"/>
<polygon fill="black" stroke="black" points="7221.5,-4172.03 7218,-4162.03 7214.5,-4172.03 7221.5,-4172.03"/>
</g>
<!-- expert3_4_linear2_9 -->
<g id="node389" class="node">
<title>expert3_4_linear2_9</title>
<polygon fill="lightcoral" stroke="black" points="7273,-4022.81 7135,-4022.81 7135,-3969.81 7273,-3969.81 7273,-4022.81"/>
<text text-anchor="middle" x="7204" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="7204" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7204" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert3_4_gelu_9&#45;&gt;expert3_4_linear2_9 -->
<g id="edge573" class="edge">
<title>expert3_4_gelu_9&#45;&gt;expert3_4_linear2_9</title>
<path fill="none" stroke="black" d="M7204,-4108.51C7204,-4108.51 7204,-4033.03 7204,-4033.03"/>
<polygon fill="black" stroke="black" points="7207.5,-4033.03 7204,-4023.03 7200.5,-4033.03 7207.5,-4033.03"/>
</g>
<!-- expert3_4_linear2_9&#45;&gt;expert3_4_agg -->
<g id="edge574" class="edge">
<title>expert3_4_linear2_9&#45;&gt;expert3_4_agg</title>
<path fill="none" stroke="black" d="M7204,-3969.72C7204,-3969.72 7204,-3894.08 7204,-3894.08"/>
<polygon fill="black" stroke="black" points="7207.5,-3894.08 7204,-3884.08 7200.5,-3894.08 7207.5,-3894.08"/>
</g>
<!-- expert3_4_agg&#45;&gt;expert_outputs3 -->
<g id="edge575" class="edge">
<title>expert3_4_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M7067,-3777.59C7067,-3777.59 7067,-3702.14 7067,-3702.14"/>
<polygon fill="black" stroke="black" points="7070.5,-3702.14 7067,-3692.14 7063.5,-3702.14 7070.5,-3702.14"/>
</g>
<!-- expert3_5_gelu_10 -->
<g id="node392" class="node">
<title>expert3_5_gelu_10</title>
<polygon fill="lightblue" stroke="black" points="7565.5,-4161.81 7372.5,-4161.81 7372.5,-4108.81 7565.5,-4108.81 7565.5,-4161.81"/>
<text text-anchor="middle" x="7469" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="7469" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7469" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert3_5_linear1_10&#45;&gt;expert3_5_gelu_10 -->
<g id="edge577" class="edge">
<title>expert3_5_linear1_10&#45;&gt;expert3_5_gelu_10</title>
<path fill="none" stroke="black" d="M7469,-4247.51C7469,-4247.51 7469,-4172.03 7469,-4172.03"/>
<polygon fill="black" stroke="black" points="7472.5,-4172.03 7469,-4162.03 7465.5,-4172.03 7472.5,-4172.03"/>
</g>
<!-- expert3_5_linear2_10 -->
<g id="node393" class="node">
<title>expert3_5_linear2_10</title>
<polygon fill="lightcoral" stroke="black" points="7552,-4022.81 7414,-4022.81 7414,-3969.81 7552,-3969.81 7552,-4022.81"/>
<text text-anchor="middle" x="7483" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="7483" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7483" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert3_5_gelu_10&#45;&gt;expert3_5_linear2_10 -->
<g id="edge578" class="edge">
<title>expert3_5_gelu_10&#45;&gt;expert3_5_linear2_10</title>
<path fill="none" stroke="black" d="M7483,-4108.51C7483,-4108.51 7483,-4033.03 7483,-4033.03"/>
<polygon fill="black" stroke="black" points="7486.5,-4033.03 7483,-4023.03 7479.5,-4033.03 7486.5,-4033.03"/>
</g>
<!-- expert3_5_agg -->
<g id="node397" class="node">
<title>expert3_5_agg</title>
<polygon fill="lightgreen" stroke="black" points="7828.11,-3883.81 7455.69,-3883.81 7359.89,-3777.81 7732.31,-3777.81 7828.11,-3883.81"/>
<text text-anchor="middle" x="7594" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 5 Output Aggregation</text>
<text text-anchor="middle" x="7594" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7594" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 10,11</text>
</g>
<!-- expert3_5_linear2_10&#45;&gt;expert3_5_agg -->
<g id="edge579" class="edge">
<title>expert3_5_linear2_10&#45;&gt;expert3_5_agg</title>
<path fill="none" stroke="black" d="M7483,-3969.72C7483,-3969.72 7483,-3894.08 7483,-3894.08"/>
<polygon fill="black" stroke="black" points="7486.5,-3894.08 7483,-3884.08 7479.5,-3894.08 7486.5,-3894.08"/>
</g>
<!-- expert3_5_gelu_11 -->
<g id="node395" class="node">
<title>expert3_5_gelu_11</title>
<polygon fill="lightblue" stroke="black" points="7816.5,-4161.81 7623.5,-4161.81 7623.5,-4108.81 7816.5,-4108.81 7816.5,-4161.81"/>
<text text-anchor="middle" x="7720" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="7720" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7720" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert3_5_linear1_11&#45;&gt;expert3_5_gelu_11 -->
<g id="edge581" class="edge">
<title>expert3_5_linear1_11&#45;&gt;expert3_5_gelu_11</title>
<path fill="none" stroke="black" d="M7720,-4247.51C7720,-4247.51 7720,-4172.03 7720,-4172.03"/>
<polygon fill="black" stroke="black" points="7723.5,-4172.03 7720,-4162.03 7716.5,-4172.03 7723.5,-4172.03"/>
</g>
<!-- expert3_5_linear2_11 -->
<g id="node396" class="node">
<title>expert3_5_linear2_11</title>
<polygon fill="lightcoral" stroke="black" points="7762,-4022.81 7624,-4022.81 7624,-3969.81 7762,-3969.81 7762,-4022.81"/>
<text text-anchor="middle" x="7693" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="7693" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7693" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert3_5_gelu_11&#45;&gt;expert3_5_linear2_11 -->
<g id="edge582" class="edge">
<title>expert3_5_gelu_11&#45;&gt;expert3_5_linear2_11</title>
<path fill="none" stroke="black" d="M7693,-4108.51C7693,-4108.51 7693,-4033.03 7693,-4033.03"/>
<polygon fill="black" stroke="black" points="7696.5,-4033.03 7693,-4023.03 7689.5,-4033.03 7696.5,-4033.03"/>
</g>
<!-- expert3_5_linear2_11&#45;&gt;expert3_5_agg -->
<g id="edge583" class="edge">
<title>expert3_5_linear2_11&#45;&gt;expert3_5_agg</title>
<path fill="none" stroke="black" d="M7693,-3969.72C7693,-3969.72 7693,-3894.08 7693,-3894.08"/>
<polygon fill="black" stroke="black" points="7696.5,-3894.08 7693,-3884.08 7689.5,-3894.08 7696.5,-3894.08"/>
</g>
<!-- expert3_5_agg&#45;&gt;expert_outputs3 -->
<g id="edge584" class="edge">
<title>expert3_5_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M7397.6,-3777.44C7397.6,-3728.96 7397.6,-3665 7397.6,-3665 7397.6,-3665 7281.67,-3665 7281.67,-3665"/>
<polygon fill="black" stroke="black" points="7281.67,-3661.5 7271.67,-3665 7281.67,-3668.5 7281.67,-3661.5"/>
</g>
<!-- expert3_6_gelu_12 -->
<g id="node399" class="node">
<title>expert3_6_gelu_12</title>
<polygon fill="lightblue" stroke="black" points="8067.5,-4161.81 7874.5,-4161.81 7874.5,-4108.81 8067.5,-4108.81 8067.5,-4161.81"/>
<text text-anchor="middle" x="7971" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="7971" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7971" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert3_6_linear1_12&#45;&gt;expert3_6_gelu_12 -->
<g id="edge586" class="edge">
<title>expert3_6_linear1_12&#45;&gt;expert3_6_gelu_12</title>
<path fill="none" stroke="black" d="M7971,-4247.51C7971,-4247.51 7971,-4172.03 7971,-4172.03"/>
<polygon fill="black" stroke="black" points="7974.5,-4172.03 7971,-4162.03 7967.5,-4172.03 7974.5,-4172.03"/>
</g>
<!-- expert3_6_linear2_12 -->
<g id="node400" class="node">
<title>expert3_6_linear2_12</title>
<polygon fill="lightcoral" stroke="black" points="8054,-4022.81 7916,-4022.81 7916,-3969.81 8054,-3969.81 8054,-4022.81"/>
<text text-anchor="middle" x="7985" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="7985" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7985" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert3_6_gelu_12&#45;&gt;expert3_6_linear2_12 -->
<g id="edge587" class="edge">
<title>expert3_6_gelu_12&#45;&gt;expert3_6_linear2_12</title>
<path fill="none" stroke="black" d="M7985,-4108.51C7985,-4108.51 7985,-4033.03 7985,-4033.03"/>
<polygon fill="black" stroke="black" points="7988.5,-4033.03 7985,-4023.03 7981.5,-4033.03 7988.5,-4033.03"/>
</g>
<!-- expert3_6_agg -->
<g id="node404" class="node">
<title>expert3_6_agg</title>
<polygon fill="lightgreen" stroke="black" points="8355.11,-3883.81 7982.69,-3883.81 7886.89,-3777.81 8259.31,-3777.81 8355.11,-3883.81"/>
<text text-anchor="middle" x="8121" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 6 Output Aggregation</text>
<text text-anchor="middle" x="8121" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8121" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 12,13</text>
</g>
<!-- expert3_6_linear2_12&#45;&gt;expert3_6_agg -->
<g id="edge588" class="edge">
<title>expert3_6_linear2_12&#45;&gt;expert3_6_agg</title>
<path fill="none" stroke="black" d="M7985,-3969.72C7985,-3969.72 7985,-3894.08 7985,-3894.08"/>
<polygon fill="black" stroke="black" points="7988.5,-3894.08 7985,-3884.08 7981.5,-3894.08 7988.5,-3894.08"/>
</g>
<!-- expert3_6_gelu_13 -->
<g id="node402" class="node">
<title>expert3_6_gelu_13</title>
<polygon fill="lightblue" stroke="black" points="8318.5,-4161.81 8125.5,-4161.81 8125.5,-4108.81 8318.5,-4108.81 8318.5,-4161.81"/>
<text text-anchor="middle" x="8222" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="8222" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8222" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert3_6_linear1_13&#45;&gt;expert3_6_gelu_13 -->
<g id="edge590" class="edge">
<title>expert3_6_linear1_13&#45;&gt;expert3_6_gelu_13</title>
<path fill="none" stroke="black" d="M8222,-4247.51C8222,-4247.51 8222,-4172.03 8222,-4172.03"/>
<polygon fill="black" stroke="black" points="8225.5,-4172.03 8222,-4162.03 8218.5,-4172.03 8225.5,-4172.03"/>
</g>
<!-- expert3_6_linear2_13 -->
<g id="node403" class="node">
<title>expert3_6_linear2_13</title>
<polygon fill="lightcoral" stroke="black" points="8264,-4022.81 8126,-4022.81 8126,-3969.81 8264,-3969.81 8264,-4022.81"/>
<text text-anchor="middle" x="8195" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="8195" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8195" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert3_6_gelu_13&#45;&gt;expert3_6_linear2_13 -->
<g id="edge591" class="edge">
<title>expert3_6_gelu_13&#45;&gt;expert3_6_linear2_13</title>
<path fill="none" stroke="black" d="M8195,-4108.51C8195,-4108.51 8195,-4033.03 8195,-4033.03"/>
<polygon fill="black" stroke="black" points="8198.5,-4033.03 8195,-4023.03 8191.5,-4033.03 8198.5,-4033.03"/>
</g>
<!-- expert3_6_linear2_13&#45;&gt;expert3_6_agg -->
<g id="edge592" class="edge">
<title>expert3_6_linear2_13&#45;&gt;expert3_6_agg</title>
<path fill="none" stroke="black" d="M8195,-3969.72C8195,-3969.72 8195,-3894.08 8195,-3894.08"/>
<polygon fill="black" stroke="black" points="8198.5,-3894.08 8195,-3884.08 8191.5,-3894.08 8198.5,-3894.08"/>
</g>
<!-- expert3_6_agg&#45;&gt;expert_outputs3 -->
<g id="edge593" class="edge">
<title>expert3_6_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M7944.6,-3777.62C7944.6,-3720.54 7944.6,-3638 7944.6,-3638 7944.6,-3638 7257.77,-3638 7257.77,-3638"/>
<polygon fill="black" stroke="black" points="7257.77,-3634.5 7247.77,-3638 7257.77,-3641.5 7257.77,-3634.5"/>
</g>
<!-- expert3_7_gelu_14 -->
<g id="node406" class="node">
<title>expert3_7_gelu_14</title>
<polygon fill="lightblue" stroke="black" points="8569.5,-4161.81 8376.5,-4161.81 8376.5,-4108.81 8569.5,-4108.81 8569.5,-4161.81"/>
<text text-anchor="middle" x="8473" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="8473" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8473" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert3_7_linear1_14&#45;&gt;expert3_7_gelu_14 -->
<g id="edge595" class="edge">
<title>expert3_7_linear1_14&#45;&gt;expert3_7_gelu_14</title>
<path fill="none" stroke="black" d="M8473,-4247.51C8473,-4247.51 8473,-4172.03 8473,-4172.03"/>
<polygon fill="black" stroke="black" points="8476.5,-4172.03 8473,-4162.03 8469.5,-4172.03 8476.5,-4172.03"/>
</g>
<!-- expert3_7_linear2_14 -->
<g id="node407" class="node">
<title>expert3_7_linear2_14</title>
<polygon fill="lightcoral" stroke="black" points="8556,-4022.81 8418,-4022.81 8418,-3969.81 8556,-3969.81 8556,-4022.81"/>
<text text-anchor="middle" x="8487" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="8487" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8487" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert3_7_gelu_14&#45;&gt;expert3_7_linear2_14 -->
<g id="edge596" class="edge">
<title>expert3_7_gelu_14&#45;&gt;expert3_7_linear2_14</title>
<path fill="none" stroke="black" d="M8487,-4108.51C8487,-4108.51 8487,-4033.03 8487,-4033.03"/>
<polygon fill="black" stroke="black" points="8490.5,-4033.03 8487,-4023.03 8483.5,-4033.03 8490.5,-4033.03"/>
</g>
<!-- expert3_7_agg -->
<g id="node411" class="node">
<title>expert3_7_agg</title>
<polygon fill="lightgreen" stroke="black" points="8882.11,-3883.81 8509.69,-3883.81 8413.89,-3777.81 8786.31,-3777.81 8882.11,-3883.81"/>
<text text-anchor="middle" x="8648" y="-3842.11" font-family="Times,serif" font-size="14.00">Expert 7 Output Aggregation</text>
<text text-anchor="middle" x="8648" y="-3827.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8648" y="-3812.11" font-family="Times,serif" font-size="14.00">GPUs 14,15</text>
</g>
<!-- expert3_7_linear2_14&#45;&gt;expert3_7_agg -->
<g id="edge597" class="edge">
<title>expert3_7_linear2_14&#45;&gt;expert3_7_agg</title>
<path fill="none" stroke="black" d="M8487,-3969.72C8487,-3969.72 8487,-3868.72 8487,-3868.72"/>
<polygon fill="black" stroke="black" points="8490.5,-3868.72 8487,-3858.72 8483.5,-3868.72 8490.5,-3868.72"/>
</g>
<!-- expert3_7_gelu_15 -->
<g id="node409" class="node">
<title>expert3_7_gelu_15</title>
<polygon fill="lightblue" stroke="black" points="8820.5,-4161.81 8627.5,-4161.81 8627.5,-4108.81 8820.5,-4108.81 8820.5,-4161.81"/>
<text text-anchor="middle" x="8724" y="-4146.61" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="8724" y="-4131.61" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8724" y="-4116.61" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert3_7_linear1_15&#45;&gt;expert3_7_gelu_15 -->
<g id="edge599" class="edge">
<title>expert3_7_linear1_15&#45;&gt;expert3_7_gelu_15</title>
<path fill="none" stroke="black" d="M8724,-4247.51C8724,-4247.51 8724,-4172.03 8724,-4172.03"/>
<polygon fill="black" stroke="black" points="8727.5,-4172.03 8724,-4162.03 8720.5,-4172.03 8727.5,-4172.03"/>
</g>
<!-- expert3_7_linear2_15 -->
<g id="node410" class="node">
<title>expert3_7_linear2_15</title>
<polygon fill="lightcoral" stroke="black" points="8779,-4022.81 8641,-4022.81 8641,-3969.81 8779,-3969.81 8779,-4022.81"/>
<text text-anchor="middle" x="8710" y="-4007.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="8710" y="-3992.61" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8710" y="-3977.61" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert3_7_gelu_15&#45;&gt;expert3_7_linear2_15 -->
<g id="edge600" class="edge">
<title>expert3_7_gelu_15&#45;&gt;expert3_7_linear2_15</title>
<path fill="none" stroke="black" d="M8710,-4108.51C8710,-4108.51 8710,-4033.03 8710,-4033.03"/>
<polygon fill="black" stroke="black" points="8713.5,-4033.03 8710,-4023.03 8706.5,-4033.03 8713.5,-4033.03"/>
</g>
<!-- expert3_7_linear2_15&#45;&gt;expert3_7_agg -->
<g id="edge601" class="edge">
<title>expert3_7_linear2_15&#45;&gt;expert3_7_agg</title>
<path fill="none" stroke="black" d="M8710,-3969.72C8710,-3969.72 8710,-3894.08 8710,-3894.08"/>
<polygon fill="black" stroke="black" points="8713.5,-3894.08 8710,-3884.08 8706.5,-3894.08 8713.5,-3894.08"/>
</g>
<!-- expert3_7_agg&#45;&gt;expert_outputs3 -->
<g id="edge602" class="edge">
<title>expert3_7_agg&#45;&gt;expert_outputs3</title>
<path fill="none" stroke="black" d="M8426.1,-3830.65C8426.1,-3824.03 8426.1,-3612 8426.1,-3612 8426.1,-3612 7234.9,-3612 7234.9,-3612"/>
<polygon fill="black" stroke="black" points="7234.9,-3608.5 7224.9,-3612 7234.9,-3615.5 7234.9,-3608.5"/>
</g>
<!-- weighted_sum3 -->
<g id="node413" class="node">
<title>weighted_sum3</title>
<polygon fill="lightgreen" stroke="black" points="7261.39,-3499.81 7061.92,-3499.81 7010.61,-3393.81 7210.08,-3393.81 7261.39,-3499.81"/>
<text text-anchor="middle" x="7136" y="-3458.11" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="7136" y="-3443.11" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7136" y="-3428.11" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_outputs3&#45;&gt;weighted_sum3 -->
<g id="edge603" class="edge">
<title>expert_outputs3&#45;&gt;weighted_sum3</title>
<path fill="none" stroke="black" d="M7136,-3585.59C7136,-3585.59 7136,-3510.14 7136,-3510.14"/>
<polygon fill="black" stroke="black" points="7139.5,-3510.14 7136,-3500.14 7132.5,-3510.14 7139.5,-3510.14"/>
</g>
<!-- weighted_sum3&#45;&gt;residual3_2 -->
<g id="edge604" class="edge">
<title>weighted_sum3&#45;&gt;residual3_2</title>
<path fill="none" stroke="black" d="M7229.33,-3433.55C7229.33,-3433.55 7229.33,-3310.92 7229.33,-3310.92"/>
<polygon fill="black" stroke="black" points="7232.83,-3310.92 7229.33,-3300.92 7225.83,-3310.92 7232.83,-3310.92"/>
</g>
<!-- ln4_0 -->
<g id="node415" class="node">
<title>ln4_0</title>
<polygon fill="lightblue" stroke="black" points="9498,-3146.86 9400,-3146.86 9400,-3093.86 9498,-3093.86 9498,-3146.86"/>
<text text-anchor="middle" x="9449" y="-3131.66" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="9449" y="-3116.66" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9449" y="-3101.66" font-family="Times,serif" font-size="14.00">GPU 0&#45;3</text>
</g>
<!-- residual3_2&#45;&gt;ln4_0 -->
<g id="edge606" class="edge">
<title>residual3_2&#45;&gt;ln4_0</title>
<path fill="none" stroke="black" d="M7338.39,-3248.57C7338.39,-3211.95 7338.39,-3142 7338.39,-3142 7338.39,-3142 9389.94,-3142 9389.94,-3142"/>
<polygon fill="black" stroke="black" points="9389.94,-3145.5 9399.94,-3142 9389.94,-3138.5 9389.94,-3145.5"/>
</g>
<!-- ln4_1 -->
<g id="node416" class="node">
<title>ln4_1</title>
<polygon fill="lightblue" stroke="black" points="7324,-3146.86 7226,-3146.86 7226,-3093.86 7324,-3093.86 7324,-3146.86"/>
<text text-anchor="middle" x="7275" y="-3131.66" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="7275" y="-3116.66" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7275" y="-3101.66" font-family="Times,serif" font-size="14.00">GPU 4&#45;7</text>
</g>
<!-- residual3_2&#45;&gt;ln4_1 -->
<g id="edge636" class="edge">
<title>residual3_2&#45;&gt;ln4_1</title>
<path fill="none" stroke="black" d="M7275,-3232.49C7275,-3232.49 7275,-3157.31 7275,-3157.31"/>
<polygon fill="black" stroke="black" points="7278.5,-3157.31 7275,-3147.31 7271.5,-3157.31 7278.5,-3157.31"/>
</g>
<!-- ln4_2 -->
<g id="node417" class="node">
<title>ln4_2</title>
<polygon fill="lightblue" stroke="black" points="5151,-3146.86 5053,-3146.86 5053,-3093.86 5151,-3093.86 5151,-3146.86"/>
<text text-anchor="middle" x="5102" y="-3131.66" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="5102" y="-3116.66" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="5102" y="-3101.66" font-family="Times,serif" font-size="14.00">GPU 8&#45;11</text>
</g>
<!-- residual3_2&#45;&gt;ln4_2 -->
<g id="edge666" class="edge">
<title>residual3_2&#45;&gt;ln4_2</title>
<path fill="none" stroke="black" d="M7211.61,-3248.57C7211.61,-3211.95 7211.61,-3142 7211.61,-3142 7211.61,-3142 5161.04,-3142 5161.04,-3142"/>
<polygon fill="black" stroke="black" points="5161.04,-3138.5 5151.04,-3142 5161.04,-3145.5 5161.04,-3138.5"/>
</g>
<!-- ln4_3 -->
<g id="node418" class="node">
<title>ln4_3</title>
<polygon fill="lightblue" stroke="black" points="2883,-3146.86 2785,-3146.86 2785,-3093.86 2883,-3093.86 2883,-3146.86"/>
<text text-anchor="middle" x="2834" y="-3131.66" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="2834" y="-3116.66" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="2834" y="-3101.66" font-family="Times,serif" font-size="14.00">GPU 12&#45;15</text>
</g>
<!-- residual3_2&#45;&gt;ln4_3 -->
<g id="edge696" class="edge">
<title>residual3_2&#45;&gt;ln4_3</title>
<path fill="none" stroke="black" d="M7197.09,-3270C6607.24,-3270 2867.25,-3270 2867.25,-3270 2867.25,-3270 2867.25,-3157.11 2867.25,-3157.11"/>
<polygon fill="black" stroke="black" points="2870.75,-3157.11 2867.25,-3147.11 2863.75,-3157.11 2870.75,-3157.11"/>
</g>
<!-- residual4_1 -->
<g id="node489" class="node">
<title>residual4_1</title>
<ellipse fill="yellow" stroke="black" cx="9959" cy="-2169.38" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="9959" y="-2180.68" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9959" y="-2165.68" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9959" y="-2150.68" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual3_2&#45;&gt;residual4_1 -->
<g id="edge728" class="edge">
<title>residual3_2&#45;&gt;residual4_1</title>
<path fill="none" stroke="black" d="M7353.13,-3270C7791.07,-3270 9921.5,-3270 9921.5,-3270 9921.5,-3270 9921.5,-2212.32 9921.5,-2212.32"/>
<polygon fill="black" stroke="black" points="9925,-2212.32 9921.5,-2202.32 9918,-2212.32 9925,-2212.32"/>
</g>
<!-- q_proj_4_0_0 -->
<g id="node419" class="node">
<title>q_proj_4_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8569.5,-3007.86 8438.5,-3007.86 8438.5,-2954.86 8569.5,-2954.86 8569.5,-3007.86"/>
<text text-anchor="middle" x="8504" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="8504" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8504" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln4_0&#45;&gt;q_proj_4_0_0 -->
<g id="edge607" class="edge">
<title>ln4_0&#45;&gt;q_proj_4_0_0</title>
<path fill="none" stroke="black" d="M9399.85,-3133C9205.88,-3133 8504,-3133 8504,-3133 8504,-3133 8504,-3018.12 8504,-3018.12"/>
<polygon fill="black" stroke="black" points="8507.5,-3018.12 8504,-3008.12 8500.5,-3018.12 8507.5,-3018.12"/>
</g>
<!-- k_proj_4_0_0 -->
<g id="node420" class="node">
<title>k_proj_4_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8758.5,-3007.86 8627.5,-3007.86 8627.5,-2954.86 8758.5,-2954.86 8758.5,-3007.86"/>
<text text-anchor="middle" x="8693" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8693" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8693" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln4_0&#45;&gt;k_proj_4_0_0 -->
<g id="edge608" class="edge">
<title>ln4_0&#45;&gt;k_proj_4_0_0</title>
<path fill="none" stroke="black" d="M9399.98,-3124C9232.45,-3124 8693,-3124 8693,-3124 8693,-3124 8693,-3018.19 8693,-3018.19"/>
<polygon fill="black" stroke="black" points="8696.5,-3018.19 8693,-3008.19 8689.5,-3018.19 8696.5,-3018.19"/>
</g>
<!-- v_proj_4_0_0 -->
<g id="node421" class="node">
<title>v_proj_4_0_0</title>
<polygon fill="lightcoral" stroke="black" points="8947.5,-3007.86 8816.5,-3007.86 8816.5,-2954.86 8947.5,-2954.86 8947.5,-3007.86"/>
<text text-anchor="middle" x="8882" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8882" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8882" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln4_0&#45;&gt;v_proj_4_0_0 -->
<g id="edge609" class="edge">
<title>ln4_0&#45;&gt;v_proj_4_0_0</title>
<path fill="none" stroke="black" d="M9399.71,-3115C9267.49,-3115 8914.9,-3115 8914.9,-3115 8914.9,-3115 8914.9,-3018.08 8914.9,-3018.08"/>
<polygon fill="black" stroke="black" points="8918.4,-3018.08 8914.9,-3008.08 8911.4,-3018.08 8918.4,-3018.08"/>
</g>
<!-- q_proj_4_0_1 -->
<g id="node423" class="node">
<title>q_proj_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9136.5,-3007.86 9005.5,-3007.86 9005.5,-2954.86 9136.5,-2954.86 9136.5,-3007.86"/>
<text text-anchor="middle" x="9071" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9071" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9071" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln4_0&#45;&gt;q_proj_4_0_1 -->
<g id="edge614" class="edge">
<title>ln4_0&#45;&gt;q_proj_4_0_1</title>
<path fill="none" stroke="black" d="M9399.71,-3107C9299.94,-3107 9083.5,-3107 9083.5,-3107 9083.5,-3107 9083.5,-3018 9083.5,-3018"/>
<polygon fill="black" stroke="black" points="9087,-3018 9083.5,-3008 9080,-3018.01 9087,-3018"/>
</g>
<!-- k_proj_4_0_1 -->
<g id="node424" class="node">
<title>k_proj_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9325.5,-3007.86 9194.5,-3007.86 9194.5,-2954.86 9325.5,-2954.86 9325.5,-3007.86"/>
<text text-anchor="middle" x="9260" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9260" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9260" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln4_0&#45;&gt;k_proj_4_0_1 -->
<g id="edge615" class="edge">
<title>ln4_0&#45;&gt;k_proj_4_0_1</title>
<path fill="none" stroke="black" d="M9399.84,-3098C9343.84,-3098 9260,-3098 9260,-3098 9260,-3098 9260,-3018.12 9260,-3018.12"/>
<polygon fill="black" stroke="black" points="9263.5,-3018.12 9260,-3008.12 9256.5,-3018.12 9263.5,-3018.12"/>
</g>
<!-- v_proj_4_0_1 -->
<g id="node425" class="node">
<title>v_proj_4_0_1</title>
<polygon fill="lightcoral" stroke="black" points="9514.5,-3007.86 9383.5,-3007.86 9383.5,-2954.86 9514.5,-2954.86 9514.5,-3007.86"/>
<text text-anchor="middle" x="9449" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="9449" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9449" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln4_0&#45;&gt;v_proj_4_0_1 -->
<g id="edge616" class="edge">
<title>ln4_0&#45;&gt;v_proj_4_0_1</title>
<path fill="none" stroke="black" d="M9449,-3093.56C9449,-3093.56 9449,-3018.08 9449,-3018.08"/>
<polygon fill="black" stroke="black" points="9452.5,-3018.08 9449,-3008.08 9445.5,-3018.08 9452.5,-3018.08"/>
</g>
<!-- q_proj_4_0_2 -->
<g id="node427" class="node">
<title>q_proj_4_0_2</title>
<polygon fill="lightcoral" stroke="black" points="9703.5,-3007.86 9572.5,-3007.86 9572.5,-2954.86 9703.5,-2954.86 9703.5,-3007.86"/>
<text text-anchor="middle" x="9638" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="9638" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9638" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln4_0&#45;&gt;q_proj_4_0_2 -->
<g id="edge621" class="edge">
<title>ln4_0&#45;&gt;q_proj_4_0_2</title>
<path fill="none" stroke="black" d="M9498.16,-3101C9554.16,-3101 9638,-3101 9638,-3101 9638,-3101 9638,-3017.91 9638,-3017.91"/>
<polygon fill="black" stroke="black" points="9641.5,-3017.91 9638,-3007.91 9634.5,-3017.91 9641.5,-3017.91"/>
</g>
<!-- k_proj_4_0_2 -->
<g id="node428" class="node">
<title>k_proj_4_0_2</title>
<polygon fill="lightcoral" stroke="black" points="9892.5,-3007.86 9761.5,-3007.86 9761.5,-2954.86 9892.5,-2954.86 9892.5,-3007.86"/>
<text text-anchor="middle" x="9827" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="9827" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9827" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln4_0&#45;&gt;k_proj_4_0_2 -->
<g id="edge622" class="edge">
<title>ln4_0&#45;&gt;k_proj_4_0_2</title>
<path fill="none" stroke="black" d="M9498.07,-3109C9586.9,-3109 9765.25,-3109 9765.25,-3109 9765.25,-3109 9765.25,-3018.12 9765.25,-3018.12"/>
<polygon fill="black" stroke="black" points="9768.75,-3018.12 9765.25,-3008.12 9761.75,-3018.12 9768.75,-3018.12"/>
</g>
<!-- v_proj_4_0_2 -->
<g id="node429" class="node">
<title>v_proj_4_0_2</title>
<polygon fill="lightcoral" stroke="black" points="10081.5,-3007.86 9950.5,-3007.86 9950.5,-2954.86 10081.5,-2954.86 10081.5,-3007.86"/>
<text text-anchor="middle" x="10016" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10016" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10016" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln4_0&#45;&gt;v_proj_4_0_2 -->
<g id="edge623" class="edge">
<title>ln4_0&#45;&gt;v_proj_4_0_2</title>
<path fill="none" stroke="black" d="M9498.25,-3116C9629.45,-3116 9977.5,-3116 9977.5,-3116 9977.5,-3116 9977.5,-3017.96 9977.5,-3017.96"/>
<polygon fill="black" stroke="black" points="9981,-3017.96 9977.5,-3007.96 9974,-3017.96 9981,-3017.96"/>
</g>
<!-- q_proj_4_0_3 -->
<g id="node431" class="node">
<title>q_proj_4_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10270.5,-3007.86 10139.5,-3007.86 10139.5,-2954.86 10270.5,-2954.86 10270.5,-3007.86"/>
<text text-anchor="middle" x="10205" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="10205" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10205" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln4_0&#45;&gt;q_proj_4_0_3 -->
<g id="edge628" class="edge">
<title>ln4_0&#45;&gt;q_proj_4_0_3</title>
<path fill="none" stroke="black" d="M9498.02,-3124C9665.55,-3124 10205,-3124 10205,-3124 10205,-3124 10205,-3018.19 10205,-3018.19"/>
<polygon fill="black" stroke="black" points="10208.5,-3018.19 10205,-3008.19 10201.5,-3018.19 10208.5,-3018.19"/>
</g>
<!-- k_proj_4_0_3 -->
<g id="node432" class="node">
<title>k_proj_4_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10459.5,-3007.86 10328.5,-3007.86 10328.5,-2954.86 10459.5,-2954.86 10459.5,-3007.86"/>
<text text-anchor="middle" x="10394" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="10394" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10394" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln4_0&#45;&gt;k_proj_4_0_3 -->
<g id="edge629" class="edge">
<title>ln4_0&#45;&gt;k_proj_4_0_3</title>
<path fill="none" stroke="black" d="M9498.23,-3131C9687.64,-3131 10358.75,-3131 10358.75,-3131 10358.75,-3131 10358.75,-3018.11 10358.75,-3018.11"/>
<polygon fill="black" stroke="black" points="10362.25,-3018.11 10358.75,-3008.11 10355.25,-3018.11 10362.25,-3018.11"/>
</g>
<!-- v_proj_4_0_3 -->
<g id="node433" class="node">
<title>v_proj_4_0_3</title>
<polygon fill="lightcoral" stroke="black" points="10648.5,-3007.86 10517.5,-3007.86 10517.5,-2954.86 10648.5,-2954.86 10648.5,-3007.86"/>
<text text-anchor="middle" x="10583" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="10583" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10583" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln4_0&#45;&gt;v_proj_4_0_3 -->
<g id="edge630" class="edge">
<title>ln4_0&#45;&gt;v_proj_4_0_3</title>
<path fill="none" stroke="black" d="M9498.2,-3139C9711.36,-3139 10544.5,-3139 10544.5,-3139 10544.5,-3139 10544.5,-3018.1 10544.5,-3018.1"/>
<polygon fill="black" stroke="black" points="10548,-3018.1 10544.5,-3008.1 10541,-3018.1 10548,-3018.1"/>
</g>
<!-- q_proj_4_1_0 -->
<g id="node435" class="node">
<title>q_proj_4_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6301.5,-3007.86 6170.5,-3007.86 6170.5,-2954.86 6301.5,-2954.86 6301.5,-3007.86"/>
<text text-anchor="middle" x="6236" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6236" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6236" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_0 -->
<g id="edge637" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_0</title>
<path fill="none" stroke="black" d="M7225.92,-3138C7026.21,-3138 6285.25,-3138 6285.25,-3138 6285.25,-3138 6285.25,-3017.93 6285.25,-3017.93"/>
<polygon fill="black" stroke="black" points="6288.75,-3017.93 6285.25,-3007.93 6281.75,-3017.93 6288.75,-3017.93"/>
</g>
<!-- k_proj_4_1_0 -->
<g id="node436" class="node">
<title>k_proj_4_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6490.5,-3007.86 6359.5,-3007.86 6359.5,-2954.86 6490.5,-2954.86 6490.5,-3007.86"/>
<text text-anchor="middle" x="6425" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6425" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6425" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_0 -->
<g id="edge638" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_0</title>
<path fill="none" stroke="black" d="M7225.94,-3129C7044.92,-3129 6425,-3129 6425,-3129 6425,-3129 6425,-3018.1 6425,-3018.1"/>
<polygon fill="black" stroke="black" points="6428.5,-3018.1 6425,-3008.1 6421.5,-3018.1 6428.5,-3018.1"/>
</g>
<!-- v_proj_4_1_0 -->
<g id="node437" class="node">
<title>v_proj_4_1_0</title>
<polygon fill="lightcoral" stroke="black" points="6679.5,-3007.86 6548.5,-3007.86 6548.5,-2954.86 6679.5,-2954.86 6679.5,-3007.86"/>
<text text-anchor="middle" x="6614" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6614" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6614" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_0 -->
<g id="edge639" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_0</title>
<path fill="none" stroke="black" d="M7225.86,-3120C7072.67,-3120 6614,-3120 6614,-3120 6614,-3120 6614,-3018.09 6614,-3018.09"/>
<polygon fill="black" stroke="black" points="6617.5,-3018.09 6614,-3008.09 6610.5,-3018.09 6617.5,-3018.09"/>
</g>
<!-- q_proj_4_1_1 -->
<g id="node439" class="node">
<title>q_proj_4_1_1</title>
<polygon fill="lightcoral" stroke="black" points="6868.5,-3007.86 6737.5,-3007.86 6737.5,-2954.86 6868.5,-2954.86 6868.5,-3007.86"/>
<text text-anchor="middle" x="6803" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="6803" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6803" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_1 -->
<g id="edge644" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_1</title>
<path fill="none" stroke="black" d="M7225.85,-3111C7114.72,-3111 6853.71,-3111 6853.71,-3111 6853.71,-3111 6853.71,-3017.91 6853.71,-3017.91"/>
<polygon fill="black" stroke="black" points="6857.21,-3017.91 6853.71,-3007.91 6850.21,-3017.91 6857.21,-3017.91"/>
</g>
<!-- k_proj_4_1_1 -->
<g id="node440" class="node">
<title>k_proj_4_1_1</title>
<polygon fill="lightcoral" stroke="black" points="7057.5,-3007.86 6926.5,-3007.86 6926.5,-2954.86 7057.5,-2954.86 7057.5,-3007.86"/>
<text text-anchor="middle" x="6992" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="6992" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6992" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_1 -->
<g id="edge645" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_1</title>
<path fill="none" stroke="black" d="M7225.94,-3102C7155.49,-3102 7034.03,-3102 7034.03,-3102 7034.03,-3102 7034.03,-3018.13 7034.03,-3018.13"/>
<polygon fill="black" stroke="black" points="7037.53,-3018.13 7034.03,-3008.13 7030.53,-3018.13 7037.53,-3018.13"/>
</g>
<!-- v_proj_4_1_1 -->
<g id="node441" class="node">
<title>v_proj_4_1_1</title>
<polygon fill="lightcoral" stroke="black" points="7246.5,-3007.86 7115.5,-3007.86 7115.5,-2954.86 7246.5,-2954.86 7246.5,-3007.86"/>
<text text-anchor="middle" x="7181" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7181" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7181" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_1 -->
<g id="edge646" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_1</title>
<path fill="none" stroke="black" d="M7236.25,-3093.56C7236.25,-3093.56 7236.25,-3018.08 7236.25,-3018.08"/>
<polygon fill="black" stroke="black" points="7239.75,-3018.08 7236.25,-3008.08 7232.75,-3018.08 7239.75,-3018.08"/>
</g>
<!-- q_proj_4_1_2 -->
<g id="node443" class="node">
<title>q_proj_4_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7435.5,-3007.86 7304.5,-3007.86 7304.5,-2954.86 7435.5,-2954.86 7435.5,-3007.86"/>
<text text-anchor="middle" x="7370" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7370" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7370" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_2 -->
<g id="edge651" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_2</title>
<path fill="none" stroke="black" d="M7314.25,-3093.56C7314.25,-3093.56 7314.25,-3018.08 7314.25,-3018.08"/>
<polygon fill="black" stroke="black" points="7317.75,-3018.08 7314.25,-3008.08 7310.75,-3018.08 7317.75,-3018.08"/>
</g>
<!-- k_proj_4_1_2 -->
<g id="node444" class="node">
<title>k_proj_4_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7624.5,-3007.86 7493.5,-3007.86 7493.5,-2954.86 7624.5,-2954.86 7624.5,-3007.86"/>
<text text-anchor="middle" x="7559" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="7559" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7559" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_2 -->
<g id="edge652" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_2</title>
<path fill="none" stroke="black" d="M7324.14,-3102C7405.43,-3102 7559,-3102 7559,-3102 7559,-3102 7559,-3018.13 7559,-3018.13"/>
<polygon fill="black" stroke="black" points="7562.5,-3018.13 7559,-3008.13 7555.5,-3018.13 7562.5,-3018.13"/>
</g>
<!-- v_proj_4_1_2 -->
<g id="node445" class="node">
<title>v_proj_4_1_2</title>
<polygon fill="lightcoral" stroke="black" points="7813.5,-3007.86 7682.5,-3007.86 7682.5,-2954.86 7813.5,-2954.86 7813.5,-3007.86"/>
<text text-anchor="middle" x="7748" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="7748" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7748" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_2 -->
<g id="edge653" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_2</title>
<path fill="none" stroke="black" d="M7324.28,-3111C7445.43,-3111 7748,-3111 7748,-3111 7748,-3111 7748,-3017.91 7748,-3017.91"/>
<polygon fill="black" stroke="black" points="7751.5,-3017.91 7748,-3007.91 7744.5,-3017.91 7751.5,-3017.91"/>
</g>
<!-- q_proj_4_1_3 -->
<g id="node447" class="node">
<title>q_proj_4_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8002.5,-3007.86 7871.5,-3007.86 7871.5,-2954.86 8002.5,-2954.86 8002.5,-3007.86"/>
<text text-anchor="middle" x="7937" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="7937" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7937" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_3 -->
<g id="edge658" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_3</title>
<path fill="none" stroke="black" d="M7324.05,-3120C7468.22,-3120 7880.6,-3120 7880.6,-3120 7880.6,-3120 7880.6,-3018.09 7880.6,-3018.09"/>
<polygon fill="black" stroke="black" points="7884.1,-3018.09 7880.6,-3008.09 7877.1,-3018.09 7884.1,-3018.09"/>
</g>
<!-- k_proj_4_1_3 -->
<g id="node448" class="node">
<title>k_proj_4_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8191.5,-3007.86 8060.5,-3007.86 8060.5,-2954.86 8191.5,-2954.86 8191.5,-3007.86"/>
<text text-anchor="middle" x="8126" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="8126" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8126" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_3 -->
<g id="edge659" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_3</title>
<path fill="none" stroke="black" d="M7324.12,-3129C7505.35,-3129 8126,-3129 8126,-3129 8126,-3129 8126,-3018.1 8126,-3018.1"/>
<polygon fill="black" stroke="black" points="8129.5,-3018.1 8126,-3008.1 8122.5,-3018.1 8129.5,-3018.1"/>
</g>
<!-- v_proj_4_1_3 -->
<g id="node449" class="node">
<title>v_proj_4_1_3</title>
<polygon fill="lightcoral" stroke="black" points="8380.5,-3007.86 8249.5,-3007.86 8249.5,-2954.86 8380.5,-2954.86 8380.5,-3007.86"/>
<text text-anchor="middle" x="8315" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="8315" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8315" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_3 -->
<g id="edge660" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_3</title>
<path fill="none" stroke="black" d="M7324.21,-3138C7528.91,-3138 8302.4,-3138 8302.4,-3138 8302.4,-3138 8302.4,-3017.93 8302.4,-3017.93"/>
<polygon fill="black" stroke="black" points="8305.9,-3017.93 8302.4,-3007.93 8298.9,-3017.93 8305.9,-3017.93"/>
</g>
<!-- q_proj_4_2_0 -->
<g id="node451" class="node">
<title>q_proj_4_2_0</title>
<polygon fill="lightcoral" stroke="black" points="4033.5,-3007.86 3902.5,-3007.86 3902.5,-2954.86 4033.5,-2954.86 4033.5,-3007.86"/>
<text text-anchor="middle" x="3968" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3968" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3968" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln4_2&#45;&gt;q_proj_4_2_0 -->
<g id="edge667" class="edge">
<title>ln4_2&#45;&gt;q_proj_4_2_0</title>
<path fill="none" stroke="black" d="M5052.9,-3142C4840.17,-3142 4008.75,-3142 4008.75,-3142 4008.75,-3142 4008.75,-3017.89 4008.75,-3017.89"/>
<polygon fill="black" stroke="black" points="4012.25,-3017.89 4008.75,-3007.89 4005.25,-3017.89 4012.25,-3017.89"/>
</g>
<!-- k_proj_4_2_0 -->
<g id="node452" class="node">
<title>k_proj_4_2_0</title>
<polygon fill="lightcoral" stroke="black" points="4222.5,-3007.86 4091.5,-3007.86 4091.5,-2954.86 4222.5,-2954.86 4222.5,-3007.86"/>
<text text-anchor="middle" x="4157" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4157" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4157" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln4_2&#45;&gt;k_proj_4_2_0 -->
<g id="edge668" class="edge">
<title>ln4_2&#45;&gt;k_proj_4_2_0</title>
<path fill="none" stroke="black" d="M5052.85,-3133C4858.88,-3133 4157,-3133 4157,-3133 4157,-3133 4157,-3018.12 4157,-3018.12"/>
<polygon fill="black" stroke="black" points="4160.5,-3018.12 4157,-3008.12 4153.5,-3018.12 4160.5,-3018.12"/>
</g>
<!-- v_proj_4_2_0 -->
<g id="node453" class="node">
<title>v_proj_4_2_0</title>
<polygon fill="lightcoral" stroke="black" points="4411.5,-3007.86 4280.5,-3007.86 4280.5,-2954.86 4411.5,-2954.86 4411.5,-3007.86"/>
<text text-anchor="middle" x="4346" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4346" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4346" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln4_2&#45;&gt;v_proj_4_2_0 -->
<g id="edge669" class="edge">
<title>ln4_2&#45;&gt;v_proj_4_2_0</title>
<path fill="none" stroke="black" d="M5052.91,-3124C4890.29,-3124 4379.5,-3124 4379.5,-3124 4379.5,-3124 4379.5,-3018.19 4379.5,-3018.19"/>
<polygon fill="black" stroke="black" points="4383,-3018.19 4379.5,-3008.19 4376,-3018.19 4383,-3018.19"/>
</g>
<!-- q_proj_4_2_1 -->
<g id="node455" class="node">
<title>q_proj_4_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4600.5,-3007.86 4469.5,-3007.86 4469.5,-2954.86 4600.5,-2954.86 4600.5,-3007.86"/>
<text text-anchor="middle" x="4535" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="4535" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4535" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln4_2&#45;&gt;q_proj_4_2_1 -->
<g id="edge674" class="edge">
<title>ln4_2&#45;&gt;q_proj_4_2_1</title>
<path fill="none" stroke="black" d="M5052.56,-3115C4921.75,-3115 4576.5,-3115 4576.5,-3115 4576.5,-3115 4576.5,-3018.08 4576.5,-3018.08"/>
<polygon fill="black" stroke="black" points="4580,-3018.08 4576.5,-3008.08 4573,-3018.08 4580,-3018.08"/>
</g>
<!-- k_proj_4_2_1 -->
<g id="node456" class="node">
<title>k_proj_4_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4789.5,-3007.86 4658.5,-3007.86 4658.5,-2954.86 4789.5,-2954.86 4789.5,-3007.86"/>
<text text-anchor="middle" x="4724" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="4724" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4724" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln4_2&#45;&gt;k_proj_4_2_1 -->
<g id="edge675" class="edge">
<title>ln4_2&#45;&gt;k_proj_4_2_1</title>
<path fill="none" stroke="black" d="M5052.95,-3107C4957.73,-3107 4757.1,-3107 4757.1,-3107 4757.1,-3107 4757.1,-3018 4757.1,-3018"/>
<polygon fill="black" stroke="black" points="4760.6,-3018 4757.1,-3008 4753.6,-3018.01 4760.6,-3018"/>
</g>
<!-- v_proj_4_2_1 -->
<g id="node457" class="node">
<title>v_proj_4_2_1</title>
<polygon fill="lightcoral" stroke="black" points="4978.5,-3007.86 4847.5,-3007.86 4847.5,-2954.86 4978.5,-2954.86 4978.5,-3007.86"/>
<text text-anchor="middle" x="4913" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="4913" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4913" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln4_2&#45;&gt;v_proj_4_2_1 -->
<g id="edge676" class="edge">
<title>ln4_2&#45;&gt;v_proj_4_2_1</title>
<path fill="none" stroke="black" d="M5052.84,-3098C4996.84,-3098 4913,-3098 4913,-3098 4913,-3098 4913,-3018.12 4913,-3018.12"/>
<polygon fill="black" stroke="black" points="4916.5,-3018.12 4913,-3008.12 4909.5,-3018.12 4916.5,-3018.12"/>
</g>
<!-- q_proj_4_2_2 -->
<g id="node459" class="node">
<title>q_proj_4_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5167.5,-3007.86 5036.5,-3007.86 5036.5,-2954.86 5167.5,-2954.86 5167.5,-3007.86"/>
<text text-anchor="middle" x="5102" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5102" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5102" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln4_2&#45;&gt;q_proj_4_2_2 -->
<g id="edge681" class="edge">
<title>ln4_2&#45;&gt;q_proj_4_2_2</title>
<path fill="none" stroke="black" d="M5102,-3093.56C5102,-3093.56 5102,-3018.08 5102,-3018.08"/>
<polygon fill="black" stroke="black" points="5105.5,-3018.08 5102,-3008.08 5098.5,-3018.08 5105.5,-3018.08"/>
</g>
<!-- k_proj_4_2_2 -->
<g id="node460" class="node">
<title>k_proj_4_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5356.5,-3007.86 5225.5,-3007.86 5225.5,-2954.86 5356.5,-2954.86 5356.5,-3007.86"/>
<text text-anchor="middle" x="5291" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5291" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5291" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln4_2&#45;&gt;k_proj_4_2_2 -->
<g id="edge682" class="edge">
<title>ln4_2&#45;&gt;k_proj_4_2_2</title>
<path fill="none" stroke="black" d="M5151.31,-3098C5190.44,-3098 5238.6,-3098 5238.6,-3098 5238.6,-3098 5238.6,-3018.12 5238.6,-3018.12"/>
<polygon fill="black" stroke="black" points="5242.1,-3018.12 5238.6,-3008.12 5235.1,-3018.12 5242.1,-3018.12"/>
</g>
<!-- v_proj_4_2_2 -->
<g id="node461" class="node">
<title>v_proj_4_2_2</title>
<polygon fill="lightcoral" stroke="black" points="5545.5,-3007.86 5414.5,-3007.86 5414.5,-2954.86 5545.5,-2954.86 5545.5,-3007.86"/>
<text text-anchor="middle" x="5480" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="5480" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5480" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln4_2&#45;&gt;v_proj_4_2_2 -->
<g id="edge683" class="edge">
<title>ln4_2&#45;&gt;v_proj_4_2_2</title>
<path fill="none" stroke="black" d="M5151.03,-3107C5253.31,-3107 5480,-3107 5480,-3107 5480,-3107 5480,-3018 5480,-3018"/>
<polygon fill="black" stroke="black" points="5483.5,-3018 5480,-3008 5476.5,-3018.01 5483.5,-3018"/>
</g>
<!-- q_proj_4_2_3 -->
<g id="node463" class="node">
<title>q_proj_4_2_3</title>
<polygon fill="lightcoral" stroke="black" points="5734.5,-3007.86 5603.5,-3007.86 5603.5,-2954.86 5734.5,-2954.86 5734.5,-3007.86"/>
<text text-anchor="middle" x="5669" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="5669" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5669" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln4_2&#45;&gt;q_proj_4_2_3 -->
<g id="edge688" class="edge">
<title>ln4_2&#45;&gt;q_proj_4_2_3</title>
<path fill="none" stroke="black" d="M5151.4,-3115C5291.5,-3115 5681.37,-3115 5681.37,-3115 5681.37,-3115 5681.37,-3018.08 5681.37,-3018.08"/>
<polygon fill="black" stroke="black" points="5684.87,-3018.08 5681.37,-3008.08 5677.87,-3018.08 5684.87,-3018.08"/>
</g>
<!-- k_proj_4_2_3 -->
<g id="node464" class="node">
<title>k_proj_4_2_3</title>
<polygon fill="lightcoral" stroke="black" points="5923.5,-3007.86 5792.5,-3007.86 5792.5,-2954.86 5923.5,-2954.86 5923.5,-3007.86"/>
<text text-anchor="middle" x="5858" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="5858" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5858" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln4_2&#45;&gt;k_proj_4_2_3 -->
<g id="edge689" class="edge">
<title>ln4_2&#45;&gt;k_proj_4_2_3</title>
<path fill="none" stroke="black" d="M5151.02,-3124C5318.55,-3124 5858,-3124 5858,-3124 5858,-3124 5858,-3018.19 5858,-3018.19"/>
<polygon fill="black" stroke="black" points="5861.5,-3018.19 5858,-3008.19 5854.5,-3018.19 5861.5,-3018.19"/>
</g>
<!-- v_proj_4_2_3 -->
<g id="node465" class="node">
<title>v_proj_4_2_3</title>
<polygon fill="lightcoral" stroke="black" points="6112.5,-3007.86 5981.5,-3007.86 5981.5,-2954.86 6112.5,-2954.86 6112.5,-3007.86"/>
<text text-anchor="middle" x="6047" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="6047" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6047" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln4_2&#45;&gt;v_proj_4_2_3 -->
<g id="edge690" class="edge">
<title>ln4_2&#45;&gt;v_proj_4_2_3</title>
<path fill="none" stroke="black" d="M5151.15,-3133C5345.12,-3133 6047,-3133 6047,-3133 6047,-3133 6047,-3018.12 6047,-3018.12"/>
<polygon fill="black" stroke="black" points="6050.5,-3018.12 6047,-3008.12 6043.5,-3018.12 6050.5,-3018.12"/>
</g>
<!-- q_proj_4_3_0 -->
<g id="node467" class="node">
<title>q_proj_4_3_0</title>
<polygon fill="lightcoral" stroke="black" points="1765.5,-3007.86 1634.5,-3007.86 1634.5,-2954.86 1765.5,-2954.86 1765.5,-3007.86"/>
<text text-anchor="middle" x="1700" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1700" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1700" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln4_3&#45;&gt;q_proj_4_3_0 -->
<g id="edge697" class="edge">
<title>ln4_3&#45;&gt;q_proj_4_3_0</title>
<path fill="none" stroke="black" d="M2784.9,-3139C2572.17,-3139 1740.75,-3139 1740.75,-3139 1740.75,-3139 1740.75,-3018.1 1740.75,-3018.1"/>
<polygon fill="black" stroke="black" points="1744.25,-3018.1 1740.75,-3008.1 1737.25,-3018.1 1744.25,-3018.1"/>
</g>
<!-- k_proj_4_3_0 -->
<g id="node468" class="node">
<title>k_proj_4_3_0</title>
<polygon fill="lightcoral" stroke="black" points="1954.5,-3007.86 1823.5,-3007.86 1823.5,-2954.86 1954.5,-2954.86 1954.5,-3007.86"/>
<text text-anchor="middle" x="1889" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1889" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1889" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln4_3&#45;&gt;k_proj_4_3_0 -->
<g id="edge698" class="edge">
<title>ln4_3&#45;&gt;k_proj_4_3_0</title>
<path fill="none" stroke="black" d="M2784.85,-3131C2590.88,-3131 1889,-3131 1889,-3131 1889,-3131 1889,-3018.11 1889,-3018.11"/>
<polygon fill="black" stroke="black" points="1892.5,-3018.11 1889,-3008.11 1885.5,-3018.11 1892.5,-3018.11"/>
</g>
<!-- v_proj_4_3_0 -->
<g id="node469" class="node">
<title>v_proj_4_3_0</title>
<polygon fill="lightcoral" stroke="black" points="2143.5,-3007.86 2012.5,-3007.86 2012.5,-2954.86 2143.5,-2954.86 2143.5,-3007.86"/>
<text text-anchor="middle" x="2078" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2078" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2078" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln4_3&#45;&gt;v_proj_4_3_0 -->
<g id="edge699" class="edge">
<title>ln4_3&#45;&gt;v_proj_4_3_0</title>
<path fill="none" stroke="black" d="M2784.91,-3124C2622.29,-3124 2111.5,-3124 2111.5,-3124 2111.5,-3124 2111.5,-3018.19 2111.5,-3018.19"/>
<polygon fill="black" stroke="black" points="2115,-3018.19 2111.5,-3008.19 2108,-3018.19 2115,-3018.19"/>
</g>
<!-- q_proj_4_3_1 -->
<g id="node471" class="node">
<title>q_proj_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2332.5,-3007.86 2201.5,-3007.86 2201.5,-2954.86 2332.5,-2954.86 2332.5,-3007.86"/>
<text text-anchor="middle" x="2267" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2267" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2267" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln4_3&#45;&gt;q_proj_4_3_1 -->
<g id="edge704" class="edge">
<title>ln4_3&#45;&gt;q_proj_4_3_1</title>
<path fill="none" stroke="black" d="M2784.56,-3116C2653.75,-3116 2308.5,-3116 2308.5,-3116 2308.5,-3116 2308.5,-3017.96 2308.5,-3017.96"/>
<polygon fill="black" stroke="black" points="2312,-3017.96 2308.5,-3007.96 2305,-3017.96 2312,-3017.96"/>
</g>
<!-- k_proj_4_3_1 -->
<g id="node472" class="node">
<title>k_proj_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2521.5,-3007.86 2390.5,-3007.86 2390.5,-2954.86 2521.5,-2954.86 2521.5,-3007.86"/>
<text text-anchor="middle" x="2456" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="2456" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2456" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln4_3&#45;&gt;k_proj_4_3_1 -->
<g id="edge705" class="edge">
<title>ln4_3&#45;&gt;k_proj_4_3_1</title>
<path fill="none" stroke="black" d="M2784.96,-3109C2691.43,-3109 2496.75,-3109 2496.75,-3109 2496.75,-3109 2496.75,-3018.12 2496.75,-3018.12"/>
<polygon fill="black" stroke="black" points="2500.25,-3018.12 2496.75,-3008.12 2493.25,-3018.12 2500.25,-3018.12"/>
</g>
<!-- v_proj_4_3_1 -->
<g id="node473" class="node">
<title>v_proj_4_3_1</title>
<polygon fill="lightcoral" stroke="black" points="2710.5,-3007.86 2579.5,-3007.86 2579.5,-2954.86 2710.5,-2954.86 2710.5,-3007.86"/>
<text text-anchor="middle" x="2645" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="2645" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2645" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln4_3&#45;&gt;v_proj_4_3_1 -->
<g id="edge706" class="edge">
<title>ln4_3&#45;&gt;v_proj_4_3_1</title>
<path fill="none" stroke="black" d="M2784.84,-3101C2728.84,-3101 2645,-3101 2645,-3101 2645,-3101 2645,-3017.91 2645,-3017.91"/>
<polygon fill="black" stroke="black" points="2648.5,-3017.91 2645,-3007.91 2641.5,-3017.91 2648.5,-3017.91"/>
</g>
<!-- q_proj_4_3_2 -->
<g id="node475" class="node">
<title>q_proj_4_3_2</title>
<polygon fill="lightcoral" stroke="black" points="2899.5,-3007.86 2768.5,-3007.86 2768.5,-2954.86 2899.5,-2954.86 2899.5,-3007.86"/>
<text text-anchor="middle" x="2834" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="2834" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2834" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln4_3&#45;&gt;q_proj_4_3_2 -->
<g id="edge711" class="edge">
<title>ln4_3&#45;&gt;q_proj_4_3_2</title>
<path fill="none" stroke="black" d="M2834,-3093.56C2834,-3093.56 2834,-3018.08 2834,-3018.08"/>
<polygon fill="black" stroke="black" points="2837.5,-3018.08 2834,-3008.08 2830.5,-3018.08 2837.5,-3018.08"/>
</g>
<!-- k_proj_4_3_2 -->
<g id="node476" class="node">
<title>k_proj_4_3_2</title>
<polygon fill="lightcoral" stroke="black" points="3088.5,-3007.86 2957.5,-3007.86 2957.5,-2954.86 3088.5,-2954.86 3088.5,-3007.86"/>
<text text-anchor="middle" x="3023" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3023" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3023" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln4_3&#45;&gt;k_proj_4_3_2 -->
<g id="edge712" class="edge">
<title>ln4_3&#45;&gt;k_proj_4_3_2</title>
<path fill="none" stroke="black" d="M2883.02,-3102C2923.44,-3102 2974.17,-3102 2974.17,-3102 2974.17,-3102 2974.17,-3018.13 2974.17,-3018.13"/>
<polygon fill="black" stroke="black" points="2977.67,-3018.13 2974.17,-3008.13 2970.67,-3018.13 2977.67,-3018.13"/>
</g>
<!-- v_proj_4_3_2 -->
<g id="node477" class="node">
<title>v_proj_4_3_2</title>
<polygon fill="lightcoral" stroke="black" points="3277.5,-3007.86 3146.5,-3007.86 3146.5,-2954.86 3277.5,-2954.86 3277.5,-3007.86"/>
<text text-anchor="middle" x="3212" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3212" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3212" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln4_3&#45;&gt;v_proj_4_3_2 -->
<g id="edge713" class="edge">
<title>ln4_3&#45;&gt;v_proj_4_3_2</title>
<path fill="none" stroke="black" d="M2883.03,-3111C2985.31,-3111 3212,-3111 3212,-3111 3212,-3111 3212,-3017.91 3212,-3017.91"/>
<polygon fill="black" stroke="black" points="3215.5,-3017.91 3212,-3007.91 3208.5,-3017.91 3215.5,-3017.91"/>
</g>
<!-- q_proj_4_3_3 -->
<g id="node479" class="node">
<title>q_proj_4_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3466.5,-3007.86 3335.5,-3007.86 3335.5,-2954.86 3466.5,-2954.86 3466.5,-3007.86"/>
<text text-anchor="middle" x="3401" y="-2992.66" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="3401" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3401" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln4_3&#45;&gt;q_proj_4_3_3 -->
<g id="edge718" class="edge">
<title>ln4_3&#45;&gt;q_proj_4_3_3</title>
<path fill="none" stroke="black" d="M2883.28,-3120C3011.93,-3120 3348,-3120 3348,-3120 3348,-3120 3348,-3018.09 3348,-3018.09"/>
<polygon fill="black" stroke="black" points="3351.5,-3018.09 3348,-3008.09 3344.5,-3018.09 3351.5,-3018.09"/>
</g>
<!-- k_proj_4_3_3 -->
<g id="node480" class="node">
<title>k_proj_4_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3655.5,-3007.86 3524.5,-3007.86 3524.5,-2954.86 3655.5,-2954.86 3655.5,-3007.86"/>
<text text-anchor="middle" x="3590" y="-2992.66" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="3590" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3590" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln4_3&#45;&gt;k_proj_4_3_3 -->
<g id="edge719" class="edge">
<title>ln4_3&#45;&gt;k_proj_4_3_3</title>
<path fill="none" stroke="black" d="M2883.02,-3129C3050.55,-3129 3590,-3129 3590,-3129 3590,-3129 3590,-3018.1 3590,-3018.1"/>
<polygon fill="black" stroke="black" points="3593.5,-3018.1 3590,-3008.1 3586.5,-3018.1 3593.5,-3018.1"/>
</g>
<!-- v_proj_4_3_3 -->
<g id="node481" class="node">
<title>v_proj_4_3_3</title>
<polygon fill="lightcoral" stroke="black" points="3844.5,-3007.86 3713.5,-3007.86 3713.5,-2954.86 3844.5,-2954.86 3844.5,-3007.86"/>
<text text-anchor="middle" x="3779" y="-2992.66" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="3779" y="-2977.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3779" y="-2962.66" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln4_3&#45;&gt;v_proj_4_3_3 -->
<g id="edge720" class="edge">
<title>ln4_3&#45;&gt;v_proj_4_3_3</title>
<path fill="none" stroke="black" d="M2883.15,-3138C3077.12,-3138 3779,-3138 3779,-3138 3779,-3138 3779,-3017.93 3779,-3017.93"/>
<polygon fill="black" stroke="black" points="3782.5,-3017.93 3779,-3007.93 3775.5,-3017.93 3782.5,-3017.93"/>
</g>
<!-- attn_4_0_0 -->
<g id="node422" class="node">
<title>attn_4_0_0</title>
<polygon fill="orange" stroke="black" points="8900,-2868.86 8674,-2868.86 8674,-2815.86 8900,-2815.86 8900,-2868.86"/>
<text text-anchor="middle" x="8787" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8787" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8787" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- q_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge610" class="edge">
<title>q_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M8504,-2954.84C8504,-2912.16 8504,-2833 8504,-2833 8504,-2833 8663.93,-2833 8663.93,-2833"/>
<polygon fill="black" stroke="black" points="8663.93,-2836.5 8673.93,-2833 8663.93,-2829.5 8663.93,-2836.5"/>
</g>
<!-- k_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge611" class="edge">
<title>k_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M8716.25,-2954.56C8716.25,-2954.56 8716.25,-2879.08 8716.25,-2879.08"/>
<polygon fill="black" stroke="black" points="8719.75,-2879.08 8716.25,-2869.08 8712.75,-2879.08 8719.75,-2879.08"/>
</g>
<!-- v_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge612" class="edge">
<title>v_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M8858.25,-2954.56C8858.25,-2954.56 8858.25,-2879.08 8858.25,-2879.08"/>
<polygon fill="black" stroke="black" points="8861.75,-2879.08 8858.25,-2869.08 8854.75,-2879.08 8861.75,-2879.08"/>
</g>
<!-- concat_dim_4_0 -->
<g id="node483" class="node">
<title>concat_dim_4_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="9467.2,-2729.86 9137.59,-2729.86 9052.8,-2623.86 9382.41,-2623.86 9467.2,-2729.86"/>
<text text-anchor="middle" x="9260" y="-2688.16" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="9260" y="-2673.16" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="9260" y="-2658.16" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<!-- attn_4_0_0&#45;&gt;concat_dim_4_0 -->
<g id="edge613" class="edge">
<title>attn_4_0_0&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M8894.25,-2815.63C8894.25,-2768.61 8894.25,-2676 8894.25,-2676 8894.25,-2676 9084.25,-2676 9084.25,-2676"/>
<polygon fill="black" stroke="black" points="9084.25,-2679.5 9094.25,-2676 9084.25,-2672.5 9084.25,-2679.5"/>
</g>
<!-- attn_4_0_1 -->
<g id="node426" class="node">
<title>attn_4_0_1</title>
<polygon fill="orange" stroke="black" points="9373,-2868.86 9147,-2868.86 9147,-2815.86 9373,-2815.86 9373,-2868.86"/>
<text text-anchor="middle" x="9260" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9260" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9260" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- q_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge617" class="edge">
<title>q_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M9136.7,-2981C9155.38,-2981 9170.75,-2981 9170.75,-2981 9170.75,-2981 9170.75,-2879.09 9170.75,-2879.09"/>
<polygon fill="black" stroke="black" points="9174.25,-2879.09 9170.75,-2869.09 9167.25,-2879.09 9174.25,-2879.09"/>
</g>
<!-- k_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge618" class="edge">
<title>k_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M9260,-2954.56C9260,-2954.56 9260,-2879.08 9260,-2879.08"/>
<polygon fill="black" stroke="black" points="9263.5,-2879.08 9260,-2869.08 9256.5,-2879.08 9263.5,-2879.08"/>
</g>
<!-- v_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge619" class="edge">
<title>v_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M9383.3,-2981C9364.62,-2981 9349.25,-2981 9349.25,-2981 9349.25,-2981 9349.25,-2879.09 9349.25,-2879.09"/>
<polygon fill="black" stroke="black" points="9352.75,-2879.09 9349.25,-2869.09 9345.75,-2879.09 9352.75,-2879.09"/>
</g>
<!-- attn_4_0_1&#45;&gt;concat_dim_4_0 -->
<g id="edge620" class="edge">
<title>attn_4_0_1&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9260,-2815.77C9260,-2815.77 9260,-2740.13 9260,-2740.13"/>
<polygon fill="black" stroke="black" points="9263.5,-2740.13 9260,-2730.13 9256.5,-2740.13 9263.5,-2740.13"/>
</g>
<!-- attn_4_0_2 -->
<g id="node430" class="node">
<title>attn_4_0_2</title>
<polygon fill="orange" stroke="black" points="9845,-2868.86 9619,-2868.86 9619,-2815.86 9845,-2815.86 9845,-2868.86"/>
<text text-anchor="middle" x="9732" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9732" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="9732" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- q_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge624" class="edge">
<title>q_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M9661.25,-2954.56C9661.25,-2954.56 9661.25,-2879.08 9661.25,-2879.08"/>
<polygon fill="black" stroke="black" points="9664.75,-2879.08 9661.25,-2869.08 9657.75,-2879.08 9664.75,-2879.08"/>
</g>
<!-- k_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge625" class="edge">
<title>k_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M9803.25,-2954.56C9803.25,-2954.56 9803.25,-2879.08 9803.25,-2879.08"/>
<polygon fill="black" stroke="black" points="9806.75,-2879.08 9803.25,-2869.08 9799.75,-2879.08 9806.75,-2879.08"/>
</g>
<!-- v_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge626" class="edge">
<title>v_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M9993.64,-2954.82C9993.64,-2914.39 9993.64,-2842 9993.64,-2842 9993.64,-2842 9855.24,-2842 9855.24,-2842"/>
<polygon fill="black" stroke="black" points="9855.24,-2838.5 9845.24,-2842 9855.24,-2845.5 9855.24,-2838.5"/>
</g>
<!-- attn_4_0_2&#45;&gt;concat_dim_4_0 -->
<g id="edge627" class="edge">
<title>attn_4_0_2&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M9630.25,-2815.84C9630.25,-2773.16 9630.25,-2694 9630.25,-2694 9630.25,-2694 9448.62,-2694 9448.62,-2694"/>
<polygon fill="black" stroke="black" points="9448.62,-2690.5 9438.62,-2694 9448.62,-2697.5 9448.62,-2690.5"/>
</g>
<!-- attn_4_0_3 -->
<g id="node434" class="node">
<title>attn_4_0_3</title>
<polygon fill="orange" stroke="black" points="10412,-2868.86 10186,-2868.86 10186,-2815.86 10412,-2815.86 10412,-2868.86"/>
<text text-anchor="middle" x="10299" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="10299" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="10299" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- q_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge631" class="edge">
<title>q_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M10228.25,-2954.56C10228.25,-2954.56 10228.25,-2879.08 10228.25,-2879.08"/>
<polygon fill="black" stroke="black" points="10231.75,-2879.08 10228.25,-2869.08 10224.75,-2879.08 10231.75,-2879.08"/>
</g>
<!-- k_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge632" class="edge">
<title>k_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M10370.25,-2954.56C10370.25,-2954.56 10370.25,-2879.08 10370.25,-2879.08"/>
<polygon fill="black" stroke="black" points="10373.75,-2879.08 10370.25,-2869.08 10366.75,-2879.08 10373.75,-2879.08"/>
</g>
<!-- v_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge633" class="edge">
<title>v_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M10583,-2954.82C10583,-2914.39 10583,-2842 10583,-2842 10583,-2842 10422.06,-2842 10422.06,-2842"/>
<polygon fill="black" stroke="black" points="10422.06,-2838.5 10412.06,-2842 10422.06,-2845.5 10422.06,-2838.5"/>
</g>
<!-- attn_4_0_3&#45;&gt;concat_dim_4_0 -->
<g id="edge634" class="edge">
<title>attn_4_0_3&#45;&gt;concat_dim_4_0</title>
<path fill="none" stroke="black" d="M10299,-2815.7C10299,-2764.84 10299,-2659 10299,-2659 10299,-2659 9420.52,-2659 9420.52,-2659"/>
<polygon fill="black" stroke="black" points="9420.52,-2655.5 9410.52,-2659 9420.52,-2662.5 9420.52,-2655.5"/>
</g>
<!-- attn_4_1_0 -->
<g id="node438" class="node">
<title>attn_4_1_0</title>
<polygon fill="orange" stroke="black" points="6632,-2868.86 6406,-2868.86 6406,-2815.86 6632,-2815.86 6632,-2868.86"/>
<text text-anchor="middle" x="6519" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6519" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="6519" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- q_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge640" class="edge">
<title>q_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M6243.5,-2954.84C6243.5,-2912.16 6243.5,-2833 6243.5,-2833 6243.5,-2833 6395.75,-2833 6395.75,-2833"/>
<polygon fill="black" stroke="black" points="6395.75,-2836.5 6405.75,-2833 6395.75,-2829.5 6395.75,-2836.5"/>
</g>
<!-- k_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge641" class="edge">
<title>k_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M6448.25,-2954.56C6448.25,-2954.56 6448.25,-2879.08 6448.25,-2879.08"/>
<polygon fill="black" stroke="black" points="6451.75,-2879.08 6448.25,-2869.08 6444.75,-2879.08 6451.75,-2879.08"/>
</g>
<!-- v_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge642" class="edge">
<title>v_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M6590.25,-2954.56C6590.25,-2954.56 6590.25,-2879.08 6590.25,-2879.08"/>
<polygon fill="black" stroke="black" points="6593.75,-2879.08 6590.25,-2869.08 6586.75,-2879.08 6593.75,-2879.08"/>
</g>
<!-- concat_dim_4_1 -->
<g id="node484" class="node">
<title>concat_dim_4_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7482.2,-2729.86 7152.59,-2729.86 7067.8,-2623.86 7397.41,-2623.86 7482.2,-2729.86"/>
<text text-anchor="middle" x="7275" y="-2688.16" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="7275" y="-2673.16" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="7275" y="-2658.16" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<!-- attn_4_1_0&#45;&gt;concat_dim_4_1 -->
<g id="edge643" class="edge">
<title>attn_4_1_0&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M6565.17,-2815.84C6565.17,-2773.16 6565.17,-2694 6565.17,-2694 6565.17,-2694 7113.59,-2694 7113.59,-2694"/>
<polygon fill="black" stroke="black" points="7113.59,-2697.5 7123.59,-2694 7113.59,-2690.5 7113.59,-2697.5"/>
</g>
<!-- attn_4_1_1 -->
<g id="node442" class="node">
<title>attn_4_1_1</title>
<polygon fill="orange" stroke="black" points="7199,-2868.86 6973,-2868.86 6973,-2815.86 7199,-2815.86 7199,-2868.86"/>
<text text-anchor="middle" x="7086" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7086" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7086" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- q_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge647" class="edge">
<title>q_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M6803,-2954.82C6803,-2914.39 6803,-2842 6803,-2842 6803,-2842 6962.93,-2842 6962.93,-2842"/>
<polygon fill="black" stroke="black" points="6962.93,-2845.5 6972.93,-2842 6962.93,-2838.5 6962.93,-2845.5"/>
</g>
<!-- k_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge648" class="edge">
<title>k_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M7015.25,-2954.56C7015.25,-2954.56 7015.25,-2879.08 7015.25,-2879.08"/>
<polygon fill="black" stroke="black" points="7018.75,-2879.08 7015.25,-2869.08 7011.75,-2879.08 7018.75,-2879.08"/>
</g>
<!-- v_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge649" class="edge">
<title>v_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M7157.25,-2954.56C7157.25,-2954.56 7157.25,-2879.08 7157.25,-2879.08"/>
<polygon fill="black" stroke="black" points="7160.75,-2879.08 7157.25,-2869.08 7153.75,-2879.08 7160.75,-2879.08"/>
</g>
<!-- attn_4_1_1&#45;&gt;concat_dim_4_1 -->
<g id="edge650" class="edge">
<title>attn_4_1_1&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M7133.32,-2815.77C7133.32,-2815.77 7133.32,-2715.89 7133.32,-2715.89"/>
<polygon fill="black" stroke="black" points="7136.82,-2715.89 7133.32,-2705.89 7129.82,-2715.89 7136.82,-2715.89"/>
</g>
<!-- attn_4_1_2 -->
<g id="node446" class="node">
<title>attn_4_1_2</title>
<polygon fill="orange" stroke="black" points="7577,-2868.86 7351,-2868.86 7351,-2815.86 7577,-2815.86 7577,-2868.86"/>
<text text-anchor="middle" x="7464" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7464" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="7464" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- q_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge654" class="edge">
<title>q_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M7393.25,-2954.56C7393.25,-2954.56 7393.25,-2879.08 7393.25,-2879.08"/>
<polygon fill="black" stroke="black" points="7396.75,-2879.08 7393.25,-2869.08 7389.75,-2879.08 7396.75,-2879.08"/>
</g>
<!-- k_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge655" class="edge">
<title>k_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M7535.25,-2954.56C7535.25,-2954.56 7535.25,-2879.08 7535.25,-2879.08"/>
<polygon fill="black" stroke="black" points="7538.75,-2879.08 7535.25,-2869.08 7531.75,-2879.08 7538.75,-2879.08"/>
</g>
<!-- v_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge656" class="edge">
<title>v_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M7687,-2954.82C7687,-2914.39 7687,-2842 7687,-2842 7687,-2842 7587.13,-2842 7587.13,-2842"/>
<polygon fill="black" stroke="black" points="7587.13,-2838.5 7577.13,-2842 7587.13,-2845.5 7587.13,-2838.5"/>
</g>
<!-- attn_4_1_2&#45;&gt;concat_dim_4_1 -->
<g id="edge657" class="edge">
<title>attn_4_1_2&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M7416.68,-2815.77C7416.68,-2815.77 7416.68,-2740.13 7416.68,-2740.13"/>
<polygon fill="black" stroke="black" points="7420.18,-2740.13 7416.68,-2730.13 7413.18,-2740.13 7420.18,-2740.13"/>
</g>
<!-- attn_4_1_3 -->
<g id="node450" class="node">
<title>attn_4_1_3</title>
<polygon fill="orange" stroke="black" points="8144,-2868.86 7918,-2868.86 7918,-2815.86 8144,-2815.86 8144,-2868.86"/>
<text text-anchor="middle" x="8031" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8031" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="8031" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- q_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge661" class="edge">
<title>q_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M7960.25,-2954.56C7960.25,-2954.56 7960.25,-2879.08 7960.25,-2879.08"/>
<polygon fill="black" stroke="black" points="7963.75,-2879.08 7960.25,-2869.08 7956.75,-2879.08 7963.75,-2879.08"/>
</g>
<!-- k_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge662" class="edge">
<title>k_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M8102.25,-2954.56C8102.25,-2954.56 8102.25,-2879.08 8102.25,-2879.08"/>
<polygon fill="black" stroke="black" points="8105.75,-2879.08 8102.25,-2869.08 8098.75,-2879.08 8105.75,-2879.08"/>
</g>
<!-- v_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge663" class="edge">
<title>v_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M8292.75,-2954.67C8292.75,-2916.53 8292.75,-2851 8292.75,-2851 8292.75,-2851 8154.29,-2851 8154.29,-2851"/>
<polygon fill="black" stroke="black" points="8154.29,-2847.5 8144.29,-2851 8154.29,-2854.5 8154.29,-2847.5"/>
</g>
<!-- attn_4_1_3&#45;&gt;concat_dim_4_1 -->
<g id="edge664" class="edge">
<title>attn_4_1_3&#45;&gt;concat_dim_4_1</title>
<path fill="none" stroke="black" d="M8008,-2815.82C8008,-2775.39 8008,-2703 8008,-2703 8008,-2703 7470.91,-2703 7470.91,-2703"/>
<polygon fill="black" stroke="black" points="7470.91,-2699.5 7460.91,-2703 7470.91,-2706.5 7470.91,-2699.5"/>
</g>
<!-- attn_4_2_0 -->
<g id="node454" class="node">
<title>attn_4_2_0</title>
<polygon fill="orange" stroke="black" points="4364,-2868.86 4138,-2868.86 4138,-2815.86 4364,-2815.86 4364,-2868.86"/>
<text text-anchor="middle" x="4251" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4251" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4251" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- q_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge670" class="edge">
<title>q_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M3968,-2954.84C3968,-2912.16 3968,-2833 3968,-2833 3968,-2833 4127.93,-2833 4127.93,-2833"/>
<polygon fill="black" stroke="black" points="4127.93,-2836.5 4137.93,-2833 4127.93,-2829.5 4127.93,-2836.5"/>
</g>
<!-- k_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge671" class="edge">
<title>k_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M4180.25,-2954.56C4180.25,-2954.56 4180.25,-2879.08 4180.25,-2879.08"/>
<polygon fill="black" stroke="black" points="4183.75,-2879.08 4180.25,-2869.08 4176.75,-2879.08 4183.75,-2879.08"/>
</g>
<!-- v_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge672" class="edge">
<title>v_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M4322.25,-2954.56C4322.25,-2954.56 4322.25,-2879.08 4322.25,-2879.08"/>
<polygon fill="black" stroke="black" points="4325.75,-2879.08 4322.25,-2869.08 4318.75,-2879.08 4325.75,-2879.08"/>
</g>
<!-- concat_dim_4_2 -->
<g id="node485" class="node">
<title>concat_dim_4_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5498.2,-2729.86 5168.59,-2729.86 5083.8,-2623.86 5413.41,-2623.86 5498.2,-2729.86"/>
<text text-anchor="middle" x="5291" y="-2688.16" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="5291" y="-2673.16" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="5291" y="-2658.16" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<!-- attn_4_2_0&#45;&gt;concat_dim_4_2 -->
<g id="edge673" class="edge">
<title>attn_4_2_0&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M4251,-2815.63C4251,-2768.61 4251,-2676 4251,-2676 4251,-2676 5115.35,-2676 5115.35,-2676"/>
<polygon fill="black" stroke="black" points="5115.35,-2679.5 5125.35,-2676 5115.35,-2672.5 5115.35,-2679.5"/>
</g>
<!-- attn_4_2_1 -->
<g id="node458" class="node">
<title>attn_4_2_1</title>
<polygon fill="orange" stroke="black" points="4931,-2868.86 4705,-2868.86 4705,-2815.86 4931,-2815.86 4931,-2868.86"/>
<text text-anchor="middle" x="4818" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4818" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="4818" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- q_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge677" class="edge">
<title>q_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M4535,-2954.82C4535,-2914.39 4535,-2842 4535,-2842 4535,-2842 4694.93,-2842 4694.93,-2842"/>
<polygon fill="black" stroke="black" points="4694.93,-2845.5 4704.93,-2842 4694.93,-2838.5 4694.93,-2845.5"/>
</g>
<!-- k_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge678" class="edge">
<title>k_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M4747.25,-2954.56C4747.25,-2954.56 4747.25,-2879.08 4747.25,-2879.08"/>
<polygon fill="black" stroke="black" points="4750.75,-2879.08 4747.25,-2869.08 4743.75,-2879.08 4750.75,-2879.08"/>
</g>
<!-- v_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge679" class="edge">
<title>v_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M4889.25,-2954.56C4889.25,-2954.56 4889.25,-2879.08 4889.25,-2879.08"/>
<polygon fill="black" stroke="black" points="4892.75,-2879.08 4889.25,-2869.08 4885.75,-2879.08 4892.75,-2879.08"/>
</g>
<!-- attn_4_2_1&#45;&gt;concat_dim_4_2 -->
<g id="edge680" class="edge">
<title>attn_4_2_1&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M4931.22,-2842C5018.92,-2842 5125.57,-2842 5125.57,-2842 5125.57,-2842 5125.57,-2686.98 5125.57,-2686.98"/>
<polygon fill="black" stroke="black" points="5129.07,-2686.98 5125.57,-2676.98 5122.07,-2686.98 5129.07,-2686.98"/>
</g>
<!-- attn_4_2_2 -->
<g id="node462" class="node">
<title>attn_4_2_2</title>
<polygon fill="orange" stroke="black" points="5404,-2868.86 5178,-2868.86 5178,-2815.86 5404,-2815.86 5404,-2868.86"/>
<text text-anchor="middle" x="5291" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5291" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5291" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- q_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge684" class="edge">
<title>q_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M5167.77,-2981C5179.57,-2981 5188.2,-2981 5188.2,-2981 5188.2,-2981 5188.2,-2879.09 5188.2,-2879.09"/>
<polygon fill="black" stroke="black" points="5191.7,-2879.09 5188.2,-2869.09 5184.7,-2879.09 5191.7,-2879.09"/>
</g>
<!-- k_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge685" class="edge">
<title>k_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M5291,-2954.56C5291,-2954.56 5291,-2879.08 5291,-2879.08"/>
<polygon fill="black" stroke="black" points="5294.5,-2879.08 5291,-2869.08 5287.5,-2879.08 5294.5,-2879.08"/>
</g>
<!-- v_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge686" class="edge">
<title>v_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M5414.3,-2981C5395.62,-2981 5380.25,-2981 5380.25,-2981 5380.25,-2981 5380.25,-2879.09 5380.25,-2879.09"/>
<polygon fill="black" stroke="black" points="5383.75,-2879.09 5380.25,-2869.09 5376.75,-2879.09 5383.75,-2879.09"/>
</g>
<!-- attn_4_2_2&#45;&gt;concat_dim_4_2 -->
<g id="edge687" class="edge">
<title>attn_4_2_2&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M5291,-2815.77C5291,-2815.77 5291,-2740.13 5291,-2740.13"/>
<polygon fill="black" stroke="black" points="5294.5,-2740.13 5291,-2730.13 5287.5,-2740.13 5294.5,-2740.13"/>
</g>
<!-- attn_4_2_3 -->
<g id="node466" class="node">
<title>attn_4_2_3</title>
<polygon fill="orange" stroke="black" points="5876,-2868.86 5650,-2868.86 5650,-2815.86 5876,-2815.86 5876,-2868.86"/>
<text text-anchor="middle" x="5763" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5763" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="5763" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- q_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge691" class="edge">
<title>q_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M5692.25,-2954.56C5692.25,-2954.56 5692.25,-2879.08 5692.25,-2879.08"/>
<polygon fill="black" stroke="black" points="5695.75,-2879.08 5692.25,-2869.08 5688.75,-2879.08 5695.75,-2879.08"/>
</g>
<!-- k_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge692" class="edge">
<title>k_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M5834.25,-2954.56C5834.25,-2954.56 5834.25,-2879.08 5834.25,-2879.08"/>
<polygon fill="black" stroke="black" points="5837.75,-2879.08 5834.25,-2869.08 5830.75,-2879.08 5837.75,-2879.08"/>
</g>
<!-- v_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge693" class="edge">
<title>v_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M6047,-2954.67C6047,-2916.53 6047,-2851 6047,-2851 6047,-2851 5886.06,-2851 5886.06,-2851"/>
<polygon fill="black" stroke="black" points="5886.06,-2847.5 5876.06,-2851 5886.06,-2854.5 5886.06,-2847.5"/>
</g>
<!-- attn_4_2_3&#45;&gt;concat_dim_4_2 -->
<g id="edge694" class="edge">
<title>attn_4_2_3&#45;&gt;concat_dim_4_2</title>
<path fill="none" stroke="black" d="M5649.71,-2842C5562.38,-2842 5456.43,-2842 5456.43,-2842 5456.43,-2842 5456.43,-2740.02 5456.43,-2740.02"/>
<polygon fill="black" stroke="black" points="5459.93,-2740.02 5456.43,-2730.02 5452.93,-2740.02 5459.93,-2740.02"/>
</g>
<!-- attn_4_3_0 -->
<g id="node470" class="node">
<title>attn_4_3_0</title>
<polygon fill="orange" stroke="black" points="2096,-2868.86 1870,-2868.86 1870,-2815.86 2096,-2815.86 2096,-2868.86"/>
<text text-anchor="middle" x="1983" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1983" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="1983" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- q_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge700" class="edge">
<title>q_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M1700,-2954.82C1700,-2914.39 1700,-2842 1700,-2842 1700,-2842 1859.93,-2842 1859.93,-2842"/>
<polygon fill="black" stroke="black" points="1859.93,-2845.5 1869.93,-2842 1859.93,-2838.5 1859.93,-2845.5"/>
</g>
<!-- k_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge701" class="edge">
<title>k_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M1912.25,-2954.56C1912.25,-2954.56 1912.25,-2879.08 1912.25,-2879.08"/>
<polygon fill="black" stroke="black" points="1915.75,-2879.08 1912.25,-2869.08 1908.75,-2879.08 1915.75,-2879.08"/>
</g>
<!-- v_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge702" class="edge">
<title>v_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M2054.25,-2954.56C2054.25,-2954.56 2054.25,-2879.08 2054.25,-2879.08"/>
<polygon fill="black" stroke="black" points="2057.75,-2879.08 2054.25,-2869.08 2050.75,-2879.08 2057.75,-2879.08"/>
</g>
<!-- concat_dim_4_3 -->
<g id="node486" class="node">
<title>concat_dim_4_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3230.2,-2729.86 2900.59,-2729.86 2815.8,-2623.86 3145.41,-2623.86 3230.2,-2729.86"/>
<text text-anchor="middle" x="3023" y="-2688.16" font-family="Times,serif" font-size="14.00">Dimension Concatenation</text>
<text text-anchor="middle" x="3023" y="-2673.16" font-family="Times,serif" font-size="14.00">(B×L×d×h_g)</text>
<text text-anchor="middle" x="3023" y="-2658.16" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<!-- attn_4_3_0&#45;&gt;concat_dim_4_3 -->
<g id="edge703" class="edge">
<title>attn_4_3_0&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M1983,-2815.63C1983,-2768.61 1983,-2676 1983,-2676 1983,-2676 2847.35,-2676 2847.35,-2676"/>
<polygon fill="black" stroke="black" points="2847.35,-2679.5 2857.35,-2676 2847.35,-2672.5 2847.35,-2679.5"/>
</g>
<!-- attn_4_3_1 -->
<g id="node474" class="node">
<title>attn_4_3_1</title>
<polygon fill="orange" stroke="black" points="2663,-2868.86 2437,-2868.86 2437,-2815.86 2663,-2815.86 2663,-2868.86"/>
<text text-anchor="middle" x="2550" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2550" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="2550" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- q_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge707" class="edge">
<title>q_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M2267,-2954.82C2267,-2914.39 2267,-2842 2267,-2842 2267,-2842 2426.93,-2842 2426.93,-2842"/>
<polygon fill="black" stroke="black" points="2426.93,-2845.5 2436.93,-2842 2426.93,-2838.5 2426.93,-2845.5"/>
</g>
<!-- k_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge708" class="edge">
<title>k_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M2479.25,-2954.56C2479.25,-2954.56 2479.25,-2879.08 2479.25,-2879.08"/>
<polygon fill="black" stroke="black" points="2482.75,-2879.08 2479.25,-2869.08 2475.75,-2879.08 2482.75,-2879.08"/>
</g>
<!-- v_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge709" class="edge">
<title>v_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M2621.25,-2954.56C2621.25,-2954.56 2621.25,-2879.08 2621.25,-2879.08"/>
<polygon fill="black" stroke="black" points="2624.75,-2879.08 2621.25,-2869.08 2617.75,-2879.08 2624.75,-2879.08"/>
</g>
<!-- attn_4_3_1&#45;&gt;concat_dim_4_3 -->
<g id="edge710" class="edge">
<title>attn_4_3_1&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M2663.22,-2842C2750.92,-2842 2857.57,-2842 2857.57,-2842 2857.57,-2842 2857.57,-2686.98 2857.57,-2686.98"/>
<polygon fill="black" stroke="black" points="2861.07,-2686.98 2857.57,-2676.98 2854.07,-2686.98 2861.07,-2686.98"/>
</g>
<!-- attn_4_3_2 -->
<g id="node478" class="node">
<title>attn_4_3_2</title>
<polygon fill="orange" stroke="black" points="3136,-2868.86 2910,-2868.86 2910,-2815.86 3136,-2815.86 3136,-2868.86"/>
<text text-anchor="middle" x="3023" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3023" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3023" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- q_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge714" class="edge">
<title>q_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M2899.7,-2981C2918.38,-2981 2933.75,-2981 2933.75,-2981 2933.75,-2981 2933.75,-2879.09 2933.75,-2879.09"/>
<polygon fill="black" stroke="black" points="2937.25,-2879.09 2933.75,-2869.09 2930.25,-2879.09 2937.25,-2879.09"/>
</g>
<!-- k_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge715" class="edge">
<title>k_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M3023,-2954.56C3023,-2954.56 3023,-2879.08 3023,-2879.08"/>
<polygon fill="black" stroke="black" points="3026.5,-2879.08 3023,-2869.08 3019.5,-2879.08 3026.5,-2879.08"/>
</g>
<!-- v_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge716" class="edge">
<title>v_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M3146.3,-2981C3127.62,-2981 3112.25,-2981 3112.25,-2981 3112.25,-2981 3112.25,-2879.09 3112.25,-2879.09"/>
<polygon fill="black" stroke="black" points="3115.75,-2879.09 3112.25,-2869.09 3108.75,-2879.09 3115.75,-2879.09"/>
</g>
<!-- attn_4_3_2&#45;&gt;concat_dim_4_3 -->
<g id="edge717" class="edge">
<title>attn_4_3_2&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M3023,-2815.77C3023,-2815.77 3023,-2740.13 3023,-2740.13"/>
<polygon fill="black" stroke="black" points="3026.5,-2740.13 3023,-2730.13 3019.5,-2740.13 3026.5,-2740.13"/>
</g>
<!-- attn_4_3_3 -->
<g id="node482" class="node">
<title>attn_4_3_3</title>
<polygon fill="orange" stroke="black" points="3608,-2868.86 3382,-2868.86 3382,-2815.86 3608,-2815.86 3608,-2868.86"/>
<text text-anchor="middle" x="3495" y="-2853.66" font-family="Times,serif" font-size="14.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3495" y="-2838.66" font-family="Times,serif" font-size="14.00">(B×L×d_s×h_g)</text>
<text text-anchor="middle" x="3495" y="-2823.66" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- q_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge721" class="edge">
<title>q_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M3424.25,-2954.56C3424.25,-2954.56 3424.25,-2879.08 3424.25,-2879.08"/>
<polygon fill="black" stroke="black" points="3427.75,-2879.08 3424.25,-2869.08 3420.75,-2879.08 3427.75,-2879.08"/>
</g>
<!-- k_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge722" class="edge">
<title>k_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M3566.25,-2954.56C3566.25,-2954.56 3566.25,-2879.08 3566.25,-2879.08"/>
<polygon fill="black" stroke="black" points="3569.75,-2879.08 3566.25,-2869.08 3562.75,-2879.08 3569.75,-2879.08"/>
</g>
<!-- v_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge723" class="edge">
<title>v_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M3779,-2954.67C3779,-2916.53 3779,-2851 3779,-2851 3779,-2851 3618.06,-2851 3618.06,-2851"/>
<polygon fill="black" stroke="black" points="3618.06,-2847.5 3608.06,-2851 3618.06,-2854.5 3618.06,-2847.5"/>
</g>
<!-- attn_4_3_3&#45;&gt;concat_dim_4_3 -->
<g id="edge724" class="edge">
<title>attn_4_3_3&#45;&gt;concat_dim_4_3</title>
<path fill="none" stroke="black" d="M3381.71,-2842C3294.38,-2842 3188.43,-2842 3188.43,-2842 3188.43,-2842 3188.43,-2740.02 3188.43,-2740.02"/>
<polygon fill="black" stroke="black" points="3191.93,-2740.02 3188.43,-2730.02 3184.93,-2740.02 3191.93,-2740.02"/>
</g>
<!-- concat_heads_4 -->
<g id="node487" class="node">
<title>concat_heads_4</title>
<polygon fill="lightgreen" stroke="black" points="7492.94,-2537.86 7146.25,-2537.86 7057.06,-2431.86 7403.75,-2431.86 7492.94,-2537.86"/>
<text text-anchor="middle" x="7275" y="-2496.16" font-family="Times,serif" font-size="14.00">Head Group Concatenation</text>
<text text-anchor="middle" x="7275" y="-2481.16" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7275" y="-2466.16" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_dim_4_0&#45;&gt;concat_heads_4 -->
<g id="edge635" class="edge">
<title>concat_dim_4_0&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M9073.67,-2650C8618.59,-2650 7487.53,-2650 7487.53,-2650 7487.53,-2650 7487.53,-2494.98 7487.53,-2494.98"/>
<polygon fill="black" stroke="black" points="7491.03,-2494.98 7487.53,-2484.98 7484.03,-2494.98 7491.03,-2494.98"/>
</g>
<!-- concat_dim_4_1&#45;&gt;concat_heads_4 -->
<g id="edge665" class="edge">
<title>concat_dim_4_1&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M7275,-2623.63C7275,-2623.63 7275,-2548.19 7275,-2548.19"/>
<polygon fill="black" stroke="black" points="7278.5,-2548.19 7275,-2538.19 7271.5,-2548.19 7278.5,-2548.19"/>
</g>
<!-- concat_dim_4_2&#45;&gt;concat_heads_4 -->
<g id="edge695" class="edge">
<title>concat_dim_4_2&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M5441.65,-2659C5869.71,-2659 7062.47,-2659 7062.47,-2659 7062.47,-2659 7062.47,-2494.99 7062.47,-2494.99"/>
<polygon fill="black" stroke="black" points="7065.97,-2494.99 7062.47,-2484.99 7058.97,-2494.99 7065.97,-2494.99"/>
</g>
<!-- concat_dim_4_3&#45;&gt;concat_heads_4 -->
<g id="edge725" class="edge">
<title>concat_dim_4_3&#45;&gt;concat_heads_4</title>
<path fill="none" stroke="black" d="M3023,-2623.65C3023,-2566.56 3023,-2484 3023,-2484 3023,-2484 7090.72,-2484 7090.72,-2484"/>
<polygon fill="black" stroke="black" points="7090.72,-2487.5 7100.72,-2484 7090.72,-2480.5 7090.72,-2487.5"/>
</g>
<!-- out_proj_4 -->
<g id="node488" class="node">
<title>out_proj_4</title>
<polygon fill="lightcoral" stroke="black" points="8242,-2345.86 8098,-2345.86 8098,-2292.86 8242,-2292.86 8242,-2345.86"/>
<text text-anchor="middle" x="8170" y="-2330.66" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="8170" y="-2315.66" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8170" y="-2300.66" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- concat_heads_4&#45;&gt;out_proj_4 -->
<g id="edge726" class="edge">
<title>concat_heads_4&#45;&gt;out_proj_4</title>
<path fill="none" stroke="black" d="M7466.61,-2484.74C7466.61,-2479.72 7466.61,-2319 7466.61,-2319 7466.61,-2319 8087.7,-2319 8087.7,-2319"/>
<polygon fill="black" stroke="black" points="8087.7,-2322.5 8097.7,-2319 8087.7,-2315.5 8087.7,-2322.5"/>
</g>
<!-- out_proj_4&#45;&gt;residual4_1 -->
<g id="edge727" class="edge">
<title>out_proj_4&#45;&gt;residual4_1</title>
<path fill="none" stroke="black" d="M8242.13,-2319C8567.98,-2319 9886.86,-2319 9886.86,-2319 9886.86,-2319 9886.86,-2193.46 9886.86,-2193.46"/>
<polygon fill="black" stroke="black" points="9890.36,-2193.46 9886.86,-2183.46 9883.36,-2193.46 9890.36,-2193.46"/>
</g>
<!-- ln4_mlp -->
<g id="node490" class="node">
<title>ln4_mlp</title>
<polygon fill="lightblue" stroke="black" points="9021,-2045.91 8923,-2045.91 8923,-1992.91 9021,-1992.91 9021,-2045.91"/>
<text text-anchor="middle" x="8972" y="-2030.71" font-family="Times,serif" font-size="14.00">LayerNorm</text>
<text text-anchor="middle" x="8972" y="-2015.71" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8972" y="-2000.71" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual4_1&#45;&gt;ln4_mlp -->
<g id="edge729" class="edge">
<title>residual4_1&#45;&gt;ln4_mlp</title>
<path fill="none" stroke="black" d="M9886.86,-2155.24C9886.86,-2117.8 9886.86,-2019 9886.86,-2019 9886.86,-2019 9031.19,-2019 9031.19,-2019"/>
<polygon fill="black" stroke="black" points="9031.19,-2015.5 9021.19,-2019 9031.19,-2022.5 9031.19,-2015.5"/>
</g>
<!-- residual4_2 -->
<g id="node551" class="node">
<title>residual4_2</title>
<ellipse fill="yellow" stroke="black" cx="9544" cy="-492.43" rx="77.56" ry="37.45"/>
<text text-anchor="middle" x="9544" y="-503.73" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="9544" y="-488.73" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9544" y="-473.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual4_1&#45;&gt;residual4_2 -->
<g id="edge806" class="edge">
<title>residual4_1&#45;&gt;residual4_2</title>
<path fill="none" stroke="black" d="M9995.54,-2136.25C9995.54,-1900.97 9995.54,-492 9995.54,-492 9995.54,-492 9631.88,-492 9631.88,-492"/>
<polygon fill="black" stroke="black" points="9631.88,-488.5 9621.88,-492 9631.88,-495.5 9631.88,-488.5"/>
</g>
<!-- gate4 -->
<g id="node491" class="node">
<title>gate4</title>
<polygon fill="purple" stroke="black" points="8673.98,-1906.91 8405.17,-1906.91 8336.02,-1800.91 8604.83,-1800.91 8673.98,-1906.91"/>
<text text-anchor="middle" x="8505" y="-1865.21" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="8505" y="-1850.21" font-family="Times,serif" font-size="14.00">(B×L×num_experts)</text>
<text text-anchor="middle" x="8505" y="-1835.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- ln4_mlp&#45;&gt;gate4 -->
<g id="edge730" class="edge">
<title>ln4_mlp&#45;&gt;gate4</title>
<path fill="none" stroke="black" d="M8922.86,-2019C8832.87,-2019 8650.75,-2019 8650.75,-2019 8650.75,-2019 8650.75,-1917.05 8650.75,-1917.05"/>
<polygon fill="black" stroke="black" points="8654.25,-1917.05 8650.75,-1907.05 8647.25,-1917.05 8654.25,-1917.05"/>
</g>
<!-- expert_select4 -->
<g id="node492" class="node">
<title>expert_select4</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8180,-1714.91 7955.7,-1714.91 7898,-1608.91 8122.3,-1608.91 8180,-1714.91"/>
<text text-anchor="middle" x="8039" y="-1673.21" font-family="Times,serif" font-size="14.00">Expert Selection</text>
<text text-anchor="middle" x="8039" y="-1658.21" font-family="Times,serif" font-size="14.00">(B×L×top_k)</text>
<text text-anchor="middle" x="8039" y="-1643.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- gate4&#45;&gt;expert_select4 -->
<g id="edge731" class="edge">
<title>gate4&#45;&gt;expert_select4</title>
<path fill="none" stroke="black" d="M8361.25,-1800.86C8361.25,-1756.69 8361.25,-1701 8361.25,-1701 8361.25,-1701 8182.87,-1701 8182.87,-1701"/>
<polygon fill="black" stroke="black" points="8182.87,-1697.5 8172.87,-1701 8182.87,-1704.5 8182.87,-1697.5"/>
</g>
<!-- expert4_0_linear1_0 -->
<g id="node493" class="node">
<title>expert4_0_linear1_0</title>
<polygon fill="lightcoral" stroke="black" points="6127.5,-1522.91 5934.5,-1522.91 5934.5,-1469.91 6127.5,-1469.91 6127.5,-1522.91"/>
<text text-anchor="middle" x="6031" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="6031" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6031" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_select4&#45;&gt;expert4_0_linear1_0 -->
<g id="edge732" class="edge">
<title>expert_select4&#45;&gt;expert4_0_linear1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7948.06,-1701C7567.18,-1701 6120,-1701 6120,-1701 6120,-1701 6120,-1533.15 6120,-1533.15"/>
<polygon fill="black" stroke="black" points="6123.5,-1533.15 6120,-1523.15 6116.5,-1533.15 6123.5,-1533.15"/>
</g>
<!-- expert4_0_linear1_1 -->
<g id="node496" class="node">
<title>expert4_0_linear1_1</title>
<polygon fill="lightcoral" stroke="black" points="6378.5,-1522.91 6185.5,-1522.91 6185.5,-1469.91 6378.5,-1469.91 6378.5,-1522.91"/>
<text text-anchor="middle" x="6282" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear1</text>
<text text-anchor="middle" x="6282" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6282" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_select4&#45;&gt;expert4_0_linear1_1 -->
<g id="edge736" class="edge">
<title>expert_select4&#45;&gt;expert4_0_linear1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7940.77,-1688C7582.79,-1688 6369,-1688 6369,-1688 6369,-1688 6369,-1533.05 6369,-1533.05"/>
<polygon fill="black" stroke="black" points="6372.5,-1533.05 6369,-1523.05 6365.5,-1533.05 6372.5,-1533.05"/>
</g>
<!-- expert4_1_linear1_2 -->
<g id="node500" class="node">
<title>expert4_1_linear1_2</title>
<polygon fill="lightcoral" stroke="black" points="6629.5,-1522.91 6436.5,-1522.91 6436.5,-1469.91 6629.5,-1469.91 6629.5,-1522.91"/>
<text text-anchor="middle" x="6533" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="6533" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6533" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_select4&#45;&gt;expert4_1_linear1_2 -->
<g id="edge741" class="edge">
<title>expert_select4&#45;&gt;expert4_1_linear1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7933.88,-1675C7587.02,-1675 6500.83,-1675 6500.83,-1675 6500.83,-1675 6500.83,-1533.14 6500.83,-1533.14"/>
<polygon fill="black" stroke="black" points="6504.33,-1533.14 6500.83,-1523.14 6497.33,-1533.14 6504.33,-1533.14"/>
</g>
<!-- expert4_1_linear1_3 -->
<g id="node503" class="node">
<title>expert4_1_linear1_3</title>
<polygon fill="lightcoral" stroke="black" points="6880.5,-1522.91 6687.5,-1522.91 6687.5,-1469.91 6880.5,-1469.91 6880.5,-1522.91"/>
<text text-anchor="middle" x="6784" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear1</text>
<text text-anchor="middle" x="6784" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6784" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_select4&#45;&gt;expert4_1_linear1_3 -->
<g id="edge745" class="edge">
<title>expert_select4&#45;&gt;expert4_1_linear1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7926.28,-1661C7634.04,-1661 6874.5,-1661 6874.5,-1661 6874.5,-1661 6874.5,-1533.22 6874.5,-1533.22"/>
<polygon fill="black" stroke="black" points="6878,-1533.22 6874.5,-1523.22 6871,-1533.22 6878,-1533.22"/>
</g>
<!-- expert4_2_linear1_4 -->
<g id="node507" class="node">
<title>expert4_2_linear1_4</title>
<polygon fill="lightcoral" stroke="black" points="7131.5,-1522.91 6938.5,-1522.91 6938.5,-1469.91 7131.5,-1469.91 7131.5,-1522.91"/>
<text text-anchor="middle" x="7035" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="7035" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7035" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_select4&#45;&gt;expert4_2_linear1_4 -->
<g id="edge750" class="edge">
<title>expert_select4&#45;&gt;expert4_2_linear1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7918.89,-1648C7664.47,-1648 7094.39,-1648 7094.39,-1648 7094.39,-1648 7094.39,-1533.16 7094.39,-1533.16"/>
<polygon fill="black" stroke="black" points="7097.89,-1533.16 7094.39,-1523.16 7090.89,-1533.16 7097.89,-1533.16"/>
</g>
<!-- expert4_2_linear1_5 -->
<g id="node510" class="node">
<title>expert4_2_linear1_5</title>
<polygon fill="lightcoral" stroke="black" points="7382.5,-1522.91 7189.5,-1522.91 7189.5,-1469.91 7382.5,-1469.91 7382.5,-1522.91"/>
<text text-anchor="middle" x="7286" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear1</text>
<text text-anchor="middle" x="7286" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7286" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_select4&#45;&gt;expert4_2_linear1_5 -->
<g id="edge754" class="edge">
<title>expert_select4&#45;&gt;expert4_2_linear1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7912.12,-1635C7697.52,-1635 7286,-1635 7286,-1635 7286,-1635 7286,-1533.13 7286,-1533.13"/>
<polygon fill="black" stroke="black" points="7289.5,-1533.13 7286,-1523.13 7282.5,-1533.13 7289.5,-1533.13"/>
</g>
<!-- expert4_3_linear1_6 -->
<g id="node514" class="node">
<title>expert4_3_linear1_6</title>
<polygon fill="lightcoral" stroke="black" points="7633.5,-1522.91 7440.5,-1522.91 7440.5,-1469.91 7633.5,-1469.91 7633.5,-1522.91"/>
<text text-anchor="middle" x="7537" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="7537" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7537" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_select4&#45;&gt;expert4_3_linear1_6 -->
<g id="edge759" class="edge">
<title>expert_select4&#45;&gt;expert4_3_linear1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7905.03,-1622C7785.42,-1622 7629,-1622 7629,-1622 7629,-1622 7629,-1533.04 7629,-1533.04"/>
<polygon fill="black" stroke="black" points="7632.5,-1533.04 7629,-1523.04 7625.5,-1533.04 7632.5,-1533.04"/>
</g>
<!-- expert4_3_linear1_7 -->
<g id="node517" class="node">
<title>expert4_3_linear1_7</title>
<polygon fill="lightcoral" stroke="black" points="7884.5,-1522.91 7691.5,-1522.91 7691.5,-1469.91 7884.5,-1469.91 7884.5,-1522.91"/>
<text text-anchor="middle" x="7788" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear1</text>
<text text-anchor="middle" x="7788" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7788" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_select4&#45;&gt;expert4_3_linear1_7 -->
<g id="edge763" class="edge">
<title>expert_select4&#45;&gt;expert4_3_linear1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7923.6,-1608.5C7923.6,-1560 7923.6,-1496 7923.6,-1496 7923.6,-1496 7894.74,-1496 7894.74,-1496"/>
<polygon fill="black" stroke="black" points="7894.74,-1492.5 7884.74,-1496 7894.74,-1499.5 7894.74,-1492.5"/>
</g>
<!-- expert4_4_linear1_8 -->
<g id="node521" class="node">
<title>expert4_4_linear1_8</title>
<polygon fill="lightcoral" stroke="black" points="8135.5,-1522.91 7942.5,-1522.91 7942.5,-1469.91 8135.5,-1469.91 8135.5,-1522.91"/>
<text text-anchor="middle" x="8039" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="8039" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8039" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_select4&#45;&gt;expert4_4_linear1_8 -->
<g id="edge768" class="edge">
<title>expert_select4&#45;&gt;expert4_4_linear1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8039,-1608.63C8039,-1608.63 8039,-1533.16 8039,-1533.16"/>
<polygon fill="black" stroke="black" points="8042.5,-1533.16 8039,-1523.16 8035.5,-1533.16 8042.5,-1533.16"/>
</g>
<!-- expert4_4_linear1_9 -->
<g id="node524" class="node">
<title>expert4_4_linear1_9</title>
<polygon fill="lightcoral" stroke="black" points="8386.5,-1522.91 8193.5,-1522.91 8193.5,-1469.91 8386.5,-1469.91 8386.5,-1522.91"/>
<text text-anchor="middle" x="8290" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear1</text>
<text text-anchor="middle" x="8290" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8290" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_select4&#45;&gt;expert4_4_linear1_9 -->
<g id="edge772" class="edge">
<title>expert_select4&#45;&gt;expert4_4_linear1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8157.75,-1661.79C8157.75,-1656.76 8157.75,-1496 8157.75,-1496 8157.75,-1496 8183.19,-1496 8183.19,-1496"/>
<polygon fill="black" stroke="black" points="8183.19,-1499.5 8193.19,-1496 8183.19,-1492.5 8183.19,-1499.5"/>
</g>
<!-- expert4_5_linear1_10 -->
<g id="node528" class="node">
<title>expert4_5_linear1_10</title>
<polygon fill="lightcoral" stroke="black" points="8637.5,-1522.91 8444.5,-1522.91 8444.5,-1469.91 8637.5,-1469.91 8637.5,-1522.91"/>
<text text-anchor="middle" x="8541" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="8541" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8541" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_select4&#45;&gt;expert4_5_linear1_10 -->
<g id="edge777" class="edge">
<title>expert_select4&#45;&gt;expert4_5_linear1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8129.62,-1622C8274.21,-1622 8541,-1622 8541,-1622 8541,-1622 8541,-1533.04 8541,-1533.04"/>
<polygon fill="black" stroke="black" points="8544.5,-1533.04 8541,-1523.04 8537.5,-1533.04 8544.5,-1533.04"/>
</g>
<!-- expert4_5_linear1_11 -->
<g id="node531" class="node">
<title>expert4_5_linear1_11</title>
<polygon fill="lightcoral" stroke="black" points="8888.5,-1522.91 8695.5,-1522.91 8695.5,-1469.91 8888.5,-1469.91 8888.5,-1522.91"/>
<text text-anchor="middle" x="8792" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear1</text>
<text text-anchor="middle" x="8792" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8792" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_select4&#45;&gt;expert4_5_linear1_11 -->
<g id="edge781" class="edge">
<title>expert_select4&#45;&gt;expert4_5_linear1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8136.67,-1635C8340.41,-1635 8792,-1635 8792,-1635 8792,-1635 8792,-1533.13 8792,-1533.13"/>
<polygon fill="black" stroke="black" points="8795.5,-1533.13 8792,-1523.13 8788.5,-1533.13 8795.5,-1533.13"/>
</g>
<!-- expert4_6_linear1_12 -->
<g id="node535" class="node">
<title>expert4_6_linear1_12</title>
<polygon fill="lightcoral" stroke="black" points="9139.5,-1522.91 8946.5,-1522.91 8946.5,-1469.91 9139.5,-1469.91 9139.5,-1522.91"/>
<text text-anchor="middle" x="9043" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="9043" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9043" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_select4&#45;&gt;expert4_6_linear1_12 -->
<g id="edge786" class="edge">
<title>expert_select4&#45;&gt;expert4_6_linear1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8143.71,-1648C8389.69,-1648 8983.75,-1648 8983.75,-1648 8983.75,-1648 8983.75,-1533.16 8983.75,-1533.16"/>
<polygon fill="black" stroke="black" points="8987.25,-1533.16 8983.75,-1523.16 8980.25,-1533.16 8987.25,-1533.16"/>
</g>
<!-- expert4_6_linear1_13 -->
<g id="node538" class="node">
<title>expert4_6_linear1_13</title>
<polygon fill="lightcoral" stroke="black" points="9390.5,-1522.91 9197.5,-1522.91 9197.5,-1469.91 9390.5,-1469.91 9390.5,-1522.91"/>
<text text-anchor="middle" x="9294" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear1</text>
<text text-anchor="middle" x="9294" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9294" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_select4&#45;&gt;expert4_6_linear1_13 -->
<g id="edge790" class="edge">
<title>expert_select4&#45;&gt;expert4_6_linear1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8150.92,-1661C8458.52,-1661 9294,-1661 9294,-1661 9294,-1661 9294,-1533.22 9294,-1533.22"/>
<polygon fill="black" stroke="black" points="9297.5,-1533.22 9294,-1523.22 9290.5,-1533.22 9297.5,-1533.22"/>
</g>
<!-- expert4_7_linear1_14 -->
<g id="node542" class="node">
<title>expert4_7_linear1_14</title>
<polygon fill="lightcoral" stroke="black" points="9641.5,-1522.91 9448.5,-1522.91 9448.5,-1469.91 9641.5,-1469.91 9641.5,-1522.91"/>
<text text-anchor="middle" x="9545" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="9545" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9545" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_select4&#45;&gt;expert4_7_linear1_14 -->
<g id="edge795" class="edge">
<title>expert_select4&#45;&gt;expert4_7_linear1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8158.45,-1675C8500.27,-1675 9457.93,-1675 9457.93,-1675 9457.93,-1675 9457.93,-1533.14 9457.93,-1533.14"/>
<polygon fill="black" stroke="black" points="9461.43,-1533.14 9457.93,-1523.14 9454.43,-1533.14 9461.43,-1533.14"/>
</g>
<!-- expert4_7_linear1_15 -->
<g id="node545" class="node">
<title>expert4_7_linear1_15</title>
<polygon fill="lightcoral" stroke="black" points="9892.5,-1522.91 9699.5,-1522.91 9699.5,-1469.91 9892.5,-1469.91 9892.5,-1522.91"/>
<text text-anchor="middle" x="9796" y="-1507.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear1</text>
<text text-anchor="middle" x="9796" y="-1492.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9796" y="-1477.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_select4&#45;&gt;expert4_7_linear1_15 -->
<g id="edge799" class="edge">
<title>expert_select4&#45;&gt;expert4_7_linear1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8165.4,-1688C8564.6,-1688 9772.25,-1688 9772.25,-1688 9772.25,-1688 9772.25,-1533.05 9772.25,-1533.05"/>
<polygon fill="black" stroke="black" points="9775.75,-1533.05 9772.25,-1523.05 9768.75,-1533.05 9775.75,-1533.05"/>
</g>
<!-- expert4_0_gelu_0 -->
<g id="node494" class="node">
<title>expert4_0_gelu_0</title>
<polygon fill="lightblue" stroke="black" points="6127.5,-1383.91 5934.5,-1383.91 5934.5,-1330.91 6127.5,-1330.91 6127.5,-1383.91"/>
<text text-anchor="middle" x="6031" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="6031" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6031" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert4_0_linear1_0&#45;&gt;expert4_0_gelu_0 -->
<g id="edge733" class="edge">
<title>expert4_0_linear1_0&#45;&gt;expert4_0_gelu_0</title>
<path fill="none" stroke="black" d="M6031,-1469.61C6031,-1469.61 6031,-1394.12 6031,-1394.12"/>
<polygon fill="black" stroke="black" points="6034.5,-1394.12 6031,-1384.12 6027.5,-1394.12 6034.5,-1394.12"/>
</g>
<!-- expert4_0_linear2_0 -->
<g id="node495" class="node">
<title>expert4_0_linear2_0</title>
<polygon fill="lightcoral" stroke="black" points="6100,-1244.91 5962,-1244.91 5962,-1191.91 6100,-1191.91 6100,-1244.91"/>
<text text-anchor="middle" x="6031" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="6031" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6031" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert4_0_gelu_0&#45;&gt;expert4_0_linear2_0 -->
<g id="edge734" class="edge">
<title>expert4_0_gelu_0&#45;&gt;expert4_0_linear2_0</title>
<path fill="none" stroke="black" d="M6031,-1330.61C6031,-1330.61 6031,-1255.12 6031,-1255.12"/>
<polygon fill="black" stroke="black" points="6034.5,-1255.12 6031,-1245.12 6027.5,-1255.12 6034.5,-1255.12"/>
</g>
<!-- expert4_0_agg -->
<g id="node499" class="node">
<title>expert4_0_agg</title>
<polygon fill="lightgreen" stroke="black" points="6265.11,-1105.91 5892.69,-1105.91 5796.89,-999.91 6169.31,-999.91 6265.11,-1105.91"/>
<text text-anchor="middle" x="6031" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 0 Output Aggregation</text>
<text text-anchor="middle" x="6031" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6031" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 0,1</text>
</g>
<!-- expert4_0_linear2_0&#45;&gt;expert4_0_agg -->
<g id="edge735" class="edge">
<title>expert4_0_linear2_0&#45;&gt;expert4_0_agg</title>
<path fill="none" stroke="black" d="M6031,-1191.82C6031,-1191.82 6031,-1116.18 6031,-1116.18"/>
<polygon fill="black" stroke="black" points="6034.5,-1116.18 6031,-1106.18 6027.5,-1116.18 6034.5,-1116.18"/>
</g>
<!-- expert4_0_gelu_1 -->
<g id="node497" class="node">
<title>expert4_0_gelu_1</title>
<polygon fill="lightblue" stroke="black" points="6378.5,-1383.91 6185.5,-1383.91 6185.5,-1330.91 6378.5,-1330.91 6378.5,-1383.91"/>
<text text-anchor="middle" x="6282" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="6282" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6282" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert4_0_linear1_1&#45;&gt;expert4_0_gelu_1 -->
<g id="edge737" class="edge">
<title>expert4_0_linear1_1&#45;&gt;expert4_0_gelu_1</title>
<path fill="none" stroke="black" d="M6282,-1469.61C6282,-1469.61 6282,-1394.12 6282,-1394.12"/>
<polygon fill="black" stroke="black" points="6285.5,-1394.12 6282,-1384.12 6278.5,-1394.12 6285.5,-1394.12"/>
</g>
<!-- expert4_0_linear2_1 -->
<g id="node498" class="node">
<title>expert4_0_linear2_1</title>
<polygon fill="lightcoral" stroke="black" points="6324,-1244.91 6186,-1244.91 6186,-1191.91 6324,-1191.91 6324,-1244.91"/>
<text text-anchor="middle" x="6255" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear2</text>
<text text-anchor="middle" x="6255" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6255" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert4_0_gelu_1&#45;&gt;expert4_0_linear2_1 -->
<g id="edge738" class="edge">
<title>expert4_0_gelu_1&#45;&gt;expert4_0_linear2_1</title>
<path fill="none" stroke="black" d="M6255,-1330.61C6255,-1330.61 6255,-1255.12 6255,-1255.12"/>
<polygon fill="black" stroke="black" points="6258.5,-1255.12 6255,-1245.12 6251.5,-1255.12 6258.5,-1255.12"/>
</g>
<!-- expert4_0_linear2_1&#45;&gt;expert4_0_agg -->
<g id="edge739" class="edge">
<title>expert4_0_linear2_1&#45;&gt;expert4_0_agg</title>
<path fill="none" stroke="black" d="M6225.65,-1191.82C6225.65,-1191.82 6225.65,-1116.18 6225.65,-1116.18"/>
<polygon fill="black" stroke="black" points="6229.15,-1116.18 6225.65,-1106.18 6222.15,-1116.18 6229.15,-1116.18"/>
</g>
<!-- expert_outputs4 -->
<g id="node549" class="node">
<title>expert_outputs4</title>
<polygon fill="lightgreen" stroke="black" points="8367.17,-913.91 8004.2,-913.91 7910.83,-807.91 8273.8,-807.91 8367.17,-913.91"/>
<text text-anchor="middle" x="8139" y="-872.21" font-family="Times,serif" font-size="14.00">Expert Outputs Aggregation</text>
<text text-anchor="middle" x="8139" y="-857.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8139" y="-842.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert4_0_agg&#45;&gt;expert_outputs4 -->
<g id="edge740" class="edge">
<title>expert4_0_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M6031,-999.84C6031,-933.63 6031,-829 6031,-829 6031,-829 7919.17,-829 7919.17,-829"/>
<polygon fill="black" stroke="black" points="7919.17,-832.5 7929.17,-829 7919.17,-825.5 7919.17,-832.5"/>
</g>
<!-- expert4_1_gelu_2 -->
<g id="node501" class="node">
<title>expert4_1_gelu_2</title>
<polygon fill="lightblue" stroke="black" points="6629.5,-1383.91 6436.5,-1383.91 6436.5,-1330.91 6629.5,-1330.91 6629.5,-1383.91"/>
<text text-anchor="middle" x="6533" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="6533" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6533" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert4_1_linear1_2&#45;&gt;expert4_1_gelu_2 -->
<g id="edge742" class="edge">
<title>expert4_1_linear1_2&#45;&gt;expert4_1_gelu_2</title>
<path fill="none" stroke="black" d="M6533,-1469.61C6533,-1469.61 6533,-1394.12 6533,-1394.12"/>
<polygon fill="black" stroke="black" points="6536.5,-1394.12 6533,-1384.12 6529.5,-1394.12 6536.5,-1394.12"/>
</g>
<!-- expert4_1_linear2_2 -->
<g id="node502" class="node">
<title>expert4_1_linear2_2</title>
<polygon fill="lightcoral" stroke="black" points="6614,-1244.91 6476,-1244.91 6476,-1191.91 6614,-1191.91 6614,-1244.91"/>
<text text-anchor="middle" x="6545" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="6545" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6545" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert4_1_gelu_2&#45;&gt;expert4_1_linear2_2 -->
<g id="edge743" class="edge">
<title>expert4_1_gelu_2&#45;&gt;expert4_1_linear2_2</title>
<path fill="none" stroke="black" d="M6545,-1330.61C6545,-1330.61 6545,-1255.12 6545,-1255.12"/>
<polygon fill="black" stroke="black" points="6548.5,-1255.12 6545,-1245.12 6541.5,-1255.12 6548.5,-1255.12"/>
</g>
<!-- expert4_1_agg -->
<g id="node506" class="node">
<title>expert4_1_agg</title>
<polygon fill="lightgreen" stroke="black" points="6792.11,-1105.91 6419.69,-1105.91 6323.89,-999.91 6696.31,-999.91 6792.11,-1105.91"/>
<text text-anchor="middle" x="6558" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 1 Output Aggregation</text>
<text text-anchor="middle" x="6558" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="6558" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 2,3</text>
</g>
<!-- expert4_1_linear2_2&#45;&gt;expert4_1_agg -->
<g id="edge744" class="edge">
<title>expert4_1_linear2_2&#45;&gt;expert4_1_agg</title>
<path fill="none" stroke="black" d="M6545,-1191.82C6545,-1191.82 6545,-1116.18 6545,-1116.18"/>
<polygon fill="black" stroke="black" points="6548.5,-1116.18 6545,-1106.18 6541.5,-1116.18 6548.5,-1116.18"/>
</g>
<!-- expert4_1_gelu_3 -->
<g id="node504" class="node">
<title>expert4_1_gelu_3</title>
<polygon fill="lightblue" stroke="black" points="6880.5,-1383.91 6687.5,-1383.91 6687.5,-1330.91 6880.5,-1330.91 6880.5,-1383.91"/>
<text text-anchor="middle" x="6784" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="6784" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="6784" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert4_1_linear1_3&#45;&gt;expert4_1_gelu_3 -->
<g id="edge746" class="edge">
<title>expert4_1_linear1_3&#45;&gt;expert4_1_gelu_3</title>
<path fill="none" stroke="black" d="M6784,-1469.61C6784,-1469.61 6784,-1394.12 6784,-1394.12"/>
<polygon fill="black" stroke="black" points="6787.5,-1394.12 6784,-1384.12 6780.5,-1394.12 6787.5,-1394.12"/>
</g>
<!-- expert4_1_linear2_3 -->
<g id="node505" class="node">
<title>expert4_1_linear2_3</title>
<polygon fill="lightcoral" stroke="black" points="6837,-1244.91 6699,-1244.91 6699,-1191.91 6837,-1191.91 6837,-1244.91"/>
<text text-anchor="middle" x="6768" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear2</text>
<text text-anchor="middle" x="6768" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="6768" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert4_1_gelu_3&#45;&gt;expert4_1_linear2_3 -->
<g id="edge747" class="edge">
<title>expert4_1_gelu_3&#45;&gt;expert4_1_linear2_3</title>
<path fill="none" stroke="black" d="M6768,-1330.61C6768,-1330.61 6768,-1255.12 6768,-1255.12"/>
<polygon fill="black" stroke="black" points="6771.5,-1255.12 6768,-1245.12 6764.5,-1255.12 6771.5,-1255.12"/>
</g>
<!-- expert4_1_linear2_3&#45;&gt;expert4_1_agg -->
<g id="edge748" class="edge">
<title>expert4_1_linear2_3&#45;&gt;expert4_1_agg</title>
<path fill="none" stroke="black" d="M6745.65,-1191.82C6745.65,-1191.82 6745.65,-1116.18 6745.65,-1116.18"/>
<polygon fill="black" stroke="black" points="6749.15,-1116.18 6745.65,-1106.18 6742.15,-1116.18 6749.15,-1116.18"/>
</g>
<!-- expert4_1_agg&#45;&gt;expert_outputs4 -->
<g id="edge749" class="edge">
<title>expert4_1_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M6558,-999.86C6558,-939.74 6558,-850 6558,-850 6558,-850 7937.9,-850 7937.9,-850"/>
<polygon fill="black" stroke="black" points="7937.9,-853.5 7947.9,-850 7937.9,-846.5 7937.9,-853.5"/>
</g>
<!-- expert4_2_gelu_4 -->
<g id="node508" class="node">
<title>expert4_2_gelu_4</title>
<polygon fill="lightblue" stroke="black" points="7131.5,-1383.91 6938.5,-1383.91 6938.5,-1330.91 7131.5,-1330.91 7131.5,-1383.91"/>
<text text-anchor="middle" x="7035" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="7035" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7035" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert4_2_linear1_4&#45;&gt;expert4_2_gelu_4 -->
<g id="edge751" class="edge">
<title>expert4_2_linear1_4&#45;&gt;expert4_2_gelu_4</title>
<path fill="none" stroke="black" d="M7035,-1469.61C7035,-1469.61 7035,-1394.12 7035,-1394.12"/>
<polygon fill="black" stroke="black" points="7038.5,-1394.12 7035,-1384.12 7031.5,-1394.12 7038.5,-1394.12"/>
</g>
<!-- expert4_2_linear2_4 -->
<g id="node509" class="node">
<title>expert4_2_linear2_4</title>
<polygon fill="lightcoral" stroke="black" points="7118,-1244.91 6980,-1244.91 6980,-1191.91 7118,-1191.91 7118,-1244.91"/>
<text text-anchor="middle" x="7049" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="7049" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7049" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert4_2_gelu_4&#45;&gt;expert4_2_linear2_4 -->
<g id="edge752" class="edge">
<title>expert4_2_gelu_4&#45;&gt;expert4_2_linear2_4</title>
<path fill="none" stroke="black" d="M7049,-1330.61C7049,-1330.61 7049,-1255.12 7049,-1255.12"/>
<polygon fill="black" stroke="black" points="7052.5,-1255.12 7049,-1245.12 7045.5,-1255.12 7052.5,-1255.12"/>
</g>
<!-- expert4_2_agg -->
<g id="node513" class="node">
<title>expert4_2_agg</title>
<polygon fill="lightgreen" stroke="black" points="7319.11,-1105.91 6946.69,-1105.91 6850.89,-999.91 7223.31,-999.91 7319.11,-1105.91"/>
<text text-anchor="middle" x="7085" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 2 Output Aggregation</text>
<text text-anchor="middle" x="7085" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7085" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 4,5</text>
</g>
<!-- expert4_2_linear2_4&#45;&gt;expert4_2_agg -->
<g id="edge753" class="edge">
<title>expert4_2_linear2_4&#45;&gt;expert4_2_agg</title>
<path fill="none" stroke="black" d="M7049,-1191.82C7049,-1191.82 7049,-1116.18 7049,-1116.18"/>
<polygon fill="black" stroke="black" points="7052.5,-1116.18 7049,-1106.18 7045.5,-1116.18 7052.5,-1116.18"/>
</g>
<!-- expert4_2_gelu_5 -->
<g id="node511" class="node">
<title>expert4_2_gelu_5</title>
<polygon fill="lightblue" stroke="black" points="7382.5,-1383.91 7189.5,-1383.91 7189.5,-1330.91 7382.5,-1330.91 7382.5,-1383.91"/>
<text text-anchor="middle" x="7286" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="7286" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7286" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert4_2_linear1_5&#45;&gt;expert4_2_gelu_5 -->
<g id="edge755" class="edge">
<title>expert4_2_linear1_5&#45;&gt;expert4_2_gelu_5</title>
<path fill="none" stroke="black" d="M7286,-1469.61C7286,-1469.61 7286,-1394.12 7286,-1394.12"/>
<polygon fill="black" stroke="black" points="7289.5,-1394.12 7286,-1384.12 7282.5,-1394.12 7289.5,-1394.12"/>
</g>
<!-- expert4_2_linear2_5 -->
<g id="node512" class="node">
<title>expert4_2_linear2_5</title>
<polygon fill="lightcoral" stroke="black" points="7341,-1244.91 7203,-1244.91 7203,-1191.91 7341,-1191.91 7341,-1244.91"/>
<text text-anchor="middle" x="7272" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear2</text>
<text text-anchor="middle" x="7272" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7272" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert4_2_gelu_5&#45;&gt;expert4_2_linear2_5 -->
<g id="edge756" class="edge">
<title>expert4_2_gelu_5&#45;&gt;expert4_2_linear2_5</title>
<path fill="none" stroke="black" d="M7272,-1330.61C7272,-1330.61 7272,-1255.12 7272,-1255.12"/>
<polygon fill="black" stroke="black" points="7275.5,-1255.12 7272,-1245.12 7268.5,-1255.12 7275.5,-1255.12"/>
</g>
<!-- expert4_2_linear2_5&#45;&gt;expert4_2_agg -->
<g id="edge757" class="edge">
<title>expert4_2_linear2_5&#45;&gt;expert4_2_agg</title>
<path fill="none" stroke="black" d="M7261.15,-1191.82C7261.15,-1191.82 7261.15,-1116.18 7261.15,-1116.18"/>
<polygon fill="black" stroke="black" points="7264.65,-1116.18 7261.15,-1106.18 7257.65,-1116.18 7264.65,-1116.18"/>
</g>
<!-- expert4_2_agg&#45;&gt;expert_outputs4 -->
<g id="edge758" class="edge">
<title>expert4_2_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M7085,-999.8C7085,-946.11 7085,-871 7085,-871 7085,-871 7956.13,-871 7956.13,-871"/>
<polygon fill="black" stroke="black" points="7956.13,-874.5 7966.13,-871 7956.13,-867.5 7956.13,-874.5"/>
</g>
<!-- expert4_3_gelu_6 -->
<g id="node515" class="node">
<title>expert4_3_gelu_6</title>
<polygon fill="lightblue" stroke="black" points="7633.5,-1383.91 7440.5,-1383.91 7440.5,-1330.91 7633.5,-1330.91 7633.5,-1383.91"/>
<text text-anchor="middle" x="7537" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="7537" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7537" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert4_3_linear1_6&#45;&gt;expert4_3_gelu_6 -->
<g id="edge760" class="edge">
<title>expert4_3_linear1_6&#45;&gt;expert4_3_gelu_6</title>
<path fill="none" stroke="black" d="M7537,-1469.61C7537,-1469.61 7537,-1394.12 7537,-1394.12"/>
<polygon fill="black" stroke="black" points="7540.5,-1394.12 7537,-1384.12 7533.5,-1394.12 7540.5,-1394.12"/>
</g>
<!-- expert4_3_linear2_6 -->
<g id="node516" class="node">
<title>expert4_3_linear2_6</title>
<polygon fill="lightcoral" stroke="black" points="7620,-1244.91 7482,-1244.91 7482,-1191.91 7620,-1191.91 7620,-1244.91"/>
<text text-anchor="middle" x="7551" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="7551" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7551" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert4_3_gelu_6&#45;&gt;expert4_3_linear2_6 -->
<g id="edge761" class="edge">
<title>expert4_3_gelu_6&#45;&gt;expert4_3_linear2_6</title>
<path fill="none" stroke="black" d="M7551,-1330.61C7551,-1330.61 7551,-1255.12 7551,-1255.12"/>
<polygon fill="black" stroke="black" points="7554.5,-1255.12 7551,-1245.12 7547.5,-1255.12 7554.5,-1255.12"/>
</g>
<!-- expert4_3_agg -->
<g id="node520" class="node">
<title>expert4_3_agg</title>
<polygon fill="lightgreen" stroke="black" points="7846.11,-1105.91 7473.69,-1105.91 7377.89,-999.91 7750.31,-999.91 7846.11,-1105.91"/>
<text text-anchor="middle" x="7612" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 3 Output Aggregation</text>
<text text-anchor="middle" x="7612" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="7612" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 6,7</text>
</g>
<!-- expert4_3_linear2_6&#45;&gt;expert4_3_agg -->
<g id="edge762" class="edge">
<title>expert4_3_linear2_6&#45;&gt;expert4_3_agg</title>
<path fill="none" stroke="black" d="M7551,-1191.82C7551,-1191.82 7551,-1116.18 7551,-1116.18"/>
<polygon fill="black" stroke="black" points="7554.5,-1116.18 7551,-1106.18 7547.5,-1116.18 7554.5,-1116.18"/>
</g>
<!-- expert4_3_gelu_7 -->
<g id="node518" class="node">
<title>expert4_3_gelu_7</title>
<polygon fill="lightblue" stroke="black" points="7884.5,-1383.91 7691.5,-1383.91 7691.5,-1330.91 7884.5,-1330.91 7884.5,-1383.91"/>
<text text-anchor="middle" x="7788" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="7788" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="7788" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert4_3_linear1_7&#45;&gt;expert4_3_gelu_7 -->
<g id="edge764" class="edge">
<title>expert4_3_linear1_7&#45;&gt;expert4_3_gelu_7</title>
<path fill="none" stroke="black" d="M7788,-1469.61C7788,-1469.61 7788,-1394.12 7788,-1394.12"/>
<polygon fill="black" stroke="black" points="7791.5,-1394.12 7788,-1384.12 7784.5,-1394.12 7791.5,-1394.12"/>
</g>
<!-- expert4_3_linear2_7 -->
<g id="node519" class="node">
<title>expert4_3_linear2_7</title>
<polygon fill="lightcoral" stroke="black" points="7843,-1244.91 7705,-1244.91 7705,-1191.91 7843,-1191.91 7843,-1244.91"/>
<text text-anchor="middle" x="7774" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear2</text>
<text text-anchor="middle" x="7774" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="7774" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert4_3_gelu_7&#45;&gt;expert4_3_linear2_7 -->
<g id="edge765" class="edge">
<title>expert4_3_gelu_7&#45;&gt;expert4_3_linear2_7</title>
<path fill="none" stroke="black" d="M7774,-1330.61C7774,-1330.61 7774,-1255.12 7774,-1255.12"/>
<polygon fill="black" stroke="black" points="7777.5,-1255.12 7774,-1245.12 7770.5,-1255.12 7777.5,-1255.12"/>
</g>
<!-- expert4_3_linear2_7&#45;&gt;expert4_3_agg -->
<g id="edge766" class="edge">
<title>expert4_3_linear2_7&#45;&gt;expert4_3_agg</title>
<path fill="none" stroke="black" d="M7774,-1191.82C7774,-1191.82 7774,-1116.18 7774,-1116.18"/>
<polygon fill="black" stroke="black" points="7777.5,-1116.18 7774,-1106.18 7770.5,-1116.18 7777.5,-1116.18"/>
</g>
<!-- expert4_3_agg&#45;&gt;expert_outputs4 -->
<g id="edge767" class="edge">
<title>expert4_3_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M7612,-999.77C7612,-952.91 7612,-892 7612,-892 7612,-892 7974.8,-892 7974.8,-892"/>
<polygon fill="black" stroke="black" points="7974.8,-895.5 7984.8,-892 7974.8,-888.5 7974.8,-895.5"/>
</g>
<!-- expert4_4_gelu_8 -->
<g id="node522" class="node">
<title>expert4_4_gelu_8</title>
<polygon fill="lightblue" stroke="black" points="8135.5,-1383.91 7942.5,-1383.91 7942.5,-1330.91 8135.5,-1330.91 8135.5,-1383.91"/>
<text text-anchor="middle" x="8039" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="8039" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8039" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert4_4_linear1_8&#45;&gt;expert4_4_gelu_8 -->
<g id="edge769" class="edge">
<title>expert4_4_linear1_8&#45;&gt;expert4_4_gelu_8</title>
<path fill="none" stroke="black" d="M8039,-1469.61C8039,-1469.61 8039,-1394.12 8039,-1394.12"/>
<polygon fill="black" stroke="black" points="8042.5,-1394.12 8039,-1384.12 8035.5,-1394.12 8042.5,-1394.12"/>
</g>
<!-- expert4_4_linear2_8 -->
<g id="node523" class="node">
<title>expert4_4_linear2_8</title>
<polygon fill="lightcoral" stroke="black" points="8122,-1244.91 7984,-1244.91 7984,-1191.91 8122,-1191.91 8122,-1244.91"/>
<text text-anchor="middle" x="8053" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="8053" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8053" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert4_4_gelu_8&#45;&gt;expert4_4_linear2_8 -->
<g id="edge770" class="edge">
<title>expert4_4_gelu_8&#45;&gt;expert4_4_linear2_8</title>
<path fill="none" stroke="black" d="M8053,-1330.61C8053,-1330.61 8053,-1255.12 8053,-1255.12"/>
<polygon fill="black" stroke="black" points="8056.5,-1255.12 8053,-1245.12 8049.5,-1255.12 8056.5,-1255.12"/>
</g>
<!-- expert4_4_agg -->
<g id="node527" class="node">
<title>expert4_4_agg</title>
<polygon fill="lightgreen" stroke="black" points="8373.11,-1105.91 8000.69,-1105.91 7904.89,-999.91 8277.31,-999.91 8373.11,-1105.91"/>
<text text-anchor="middle" x="8139" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 4 Output Aggregation</text>
<text text-anchor="middle" x="8139" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8139" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 8,9</text>
</g>
<!-- expert4_4_linear2_8&#45;&gt;expert4_4_agg -->
<g id="edge771" class="edge">
<title>expert4_4_linear2_8&#45;&gt;expert4_4_agg</title>
<path fill="none" stroke="black" d="M8053,-1191.82C8053,-1191.82 8053,-1116.18 8053,-1116.18"/>
<polygon fill="black" stroke="black" points="8056.5,-1116.18 8053,-1106.18 8049.5,-1116.18 8056.5,-1116.18"/>
</g>
<!-- expert4_4_gelu_9 -->
<g id="node525" class="node">
<title>expert4_4_gelu_9</title>
<polygon fill="lightblue" stroke="black" points="8386.5,-1383.91 8193.5,-1383.91 8193.5,-1330.91 8386.5,-1330.91 8386.5,-1383.91"/>
<text text-anchor="middle" x="8290" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="8290" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8290" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert4_4_linear1_9&#45;&gt;expert4_4_gelu_9 -->
<g id="edge773" class="edge">
<title>expert4_4_linear1_9&#45;&gt;expert4_4_gelu_9</title>
<path fill="none" stroke="black" d="M8290,-1469.61C8290,-1469.61 8290,-1394.12 8290,-1394.12"/>
<polygon fill="black" stroke="black" points="8293.5,-1394.12 8290,-1384.12 8286.5,-1394.12 8293.5,-1394.12"/>
</g>
<!-- expert4_4_linear2_9 -->
<g id="node526" class="node">
<title>expert4_4_linear2_9</title>
<polygon fill="lightcoral" stroke="black" points="8345,-1244.91 8207,-1244.91 8207,-1191.91 8345,-1191.91 8345,-1244.91"/>
<text text-anchor="middle" x="8276" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear2</text>
<text text-anchor="middle" x="8276" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8276" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert4_4_gelu_9&#45;&gt;expert4_4_linear2_9 -->
<g id="edge774" class="edge">
<title>expert4_4_gelu_9&#45;&gt;expert4_4_linear2_9</title>
<path fill="none" stroke="black" d="M8276,-1330.61C8276,-1330.61 8276,-1255.12 8276,-1255.12"/>
<polygon fill="black" stroke="black" points="8279.5,-1255.12 8276,-1245.12 8272.5,-1255.12 8279.5,-1255.12"/>
</g>
<!-- expert4_4_linear2_9&#45;&gt;expert4_4_agg -->
<g id="edge775" class="edge">
<title>expert4_4_linear2_9&#45;&gt;expert4_4_agg</title>
<path fill="none" stroke="black" d="M8276,-1191.82C8276,-1191.82 8276,-1116.18 8276,-1116.18"/>
<polygon fill="black" stroke="black" points="8279.5,-1116.18 8276,-1106.18 8272.5,-1116.18 8279.5,-1116.18"/>
</g>
<!-- expert4_4_agg&#45;&gt;expert_outputs4 -->
<g id="edge776" class="edge">
<title>expert4_4_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M8139,-999.68C8139,-999.68 8139,-924.24 8139,-924.24"/>
<polygon fill="black" stroke="black" points="8142.5,-924.24 8139,-914.24 8135.5,-924.24 8142.5,-924.24"/>
</g>
<!-- expert4_5_gelu_10 -->
<g id="node529" class="node">
<title>expert4_5_gelu_10</title>
<polygon fill="lightblue" stroke="black" points="8637.5,-1383.91 8444.5,-1383.91 8444.5,-1330.91 8637.5,-1330.91 8637.5,-1383.91"/>
<text text-anchor="middle" x="8541" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="8541" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8541" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert4_5_linear1_10&#45;&gt;expert4_5_gelu_10 -->
<g id="edge778" class="edge">
<title>expert4_5_linear1_10&#45;&gt;expert4_5_gelu_10</title>
<path fill="none" stroke="black" d="M8541,-1469.61C8541,-1469.61 8541,-1394.12 8541,-1394.12"/>
<polygon fill="black" stroke="black" points="8544.5,-1394.12 8541,-1384.12 8537.5,-1394.12 8544.5,-1394.12"/>
</g>
<!-- expert4_5_linear2_10 -->
<g id="node530" class="node">
<title>expert4_5_linear2_10</title>
<polygon fill="lightcoral" stroke="black" points="8624,-1244.91 8486,-1244.91 8486,-1191.91 8624,-1191.91 8624,-1244.91"/>
<text text-anchor="middle" x="8555" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="8555" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8555" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert4_5_gelu_10&#45;&gt;expert4_5_linear2_10 -->
<g id="edge779" class="edge">
<title>expert4_5_gelu_10&#45;&gt;expert4_5_linear2_10</title>
<path fill="none" stroke="black" d="M8555,-1330.61C8555,-1330.61 8555,-1255.12 8555,-1255.12"/>
<polygon fill="black" stroke="black" points="8558.5,-1255.12 8555,-1245.12 8551.5,-1255.12 8558.5,-1255.12"/>
</g>
<!-- expert4_5_agg -->
<g id="node534" class="node">
<title>expert4_5_agg</title>
<polygon fill="lightgreen" stroke="black" points="8900.11,-1105.91 8527.69,-1105.91 8431.89,-999.91 8804.31,-999.91 8900.11,-1105.91"/>
<text text-anchor="middle" x="8666" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 5 Output Aggregation</text>
<text text-anchor="middle" x="8666" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8666" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 10,11</text>
</g>
<!-- expert4_5_linear2_10&#45;&gt;expert4_5_agg -->
<g id="edge780" class="edge">
<title>expert4_5_linear2_10&#45;&gt;expert4_5_agg</title>
<path fill="none" stroke="black" d="M8555,-1191.82C8555,-1191.82 8555,-1116.18 8555,-1116.18"/>
<polygon fill="black" stroke="black" points="8558.5,-1116.18 8555,-1106.18 8551.5,-1116.18 8558.5,-1116.18"/>
</g>
<!-- expert4_5_gelu_11 -->
<g id="node532" class="node">
<title>expert4_5_gelu_11</title>
<polygon fill="lightblue" stroke="black" points="8888.5,-1383.91 8695.5,-1383.91 8695.5,-1330.91 8888.5,-1330.91 8888.5,-1383.91"/>
<text text-anchor="middle" x="8792" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="8792" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="8792" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert4_5_linear1_11&#45;&gt;expert4_5_gelu_11 -->
<g id="edge782" class="edge">
<title>expert4_5_linear1_11&#45;&gt;expert4_5_gelu_11</title>
<path fill="none" stroke="black" d="M8792,-1469.61C8792,-1469.61 8792,-1394.12 8792,-1394.12"/>
<polygon fill="black" stroke="black" points="8795.5,-1394.12 8792,-1384.12 8788.5,-1394.12 8795.5,-1394.12"/>
</g>
<!-- expert4_5_linear2_11 -->
<g id="node533" class="node">
<title>expert4_5_linear2_11</title>
<polygon fill="lightcoral" stroke="black" points="8847,-1244.91 8709,-1244.91 8709,-1191.91 8847,-1191.91 8847,-1244.91"/>
<text text-anchor="middle" x="8778" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear2</text>
<text text-anchor="middle" x="8778" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="8778" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert4_5_gelu_11&#45;&gt;expert4_5_linear2_11 -->
<g id="edge783" class="edge">
<title>expert4_5_gelu_11&#45;&gt;expert4_5_linear2_11</title>
<path fill="none" stroke="black" d="M8778,-1330.61C8778,-1330.61 8778,-1255.12 8778,-1255.12"/>
<polygon fill="black" stroke="black" points="8781.5,-1255.12 8778,-1245.12 8774.5,-1255.12 8781.5,-1255.12"/>
</g>
<!-- expert4_5_linear2_11&#45;&gt;expert4_5_agg -->
<g id="edge784" class="edge">
<title>expert4_5_linear2_11&#45;&gt;expert4_5_agg</title>
<path fill="none" stroke="black" d="M8778,-1191.82C8778,-1191.82 8778,-1116.18 8778,-1116.18"/>
<polygon fill="black" stroke="black" points="8781.5,-1116.18 8778,-1106.18 8774.5,-1116.18 8781.5,-1116.18"/>
</g>
<!-- expert4_5_agg&#45;&gt;expert_outputs4 -->
<g id="edge785" class="edge">
<title>expert4_5_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M8456.62,-1052.79C8456.62,-1047.92 8456.62,-892 8456.62,-892 8456.62,-892 8358.2,-892 8358.2,-892"/>
<polygon fill="black" stroke="black" points="8358.2,-888.5 8348.2,-892 8358.2,-895.5 8358.2,-888.5"/>
</g>
<!-- expert4_6_gelu_12 -->
<g id="node536" class="node">
<title>expert4_6_gelu_12</title>
<polygon fill="lightblue" stroke="black" points="9139.5,-1383.91 8946.5,-1383.91 8946.5,-1330.91 9139.5,-1330.91 9139.5,-1383.91"/>
<text text-anchor="middle" x="9043" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="9043" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9043" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert4_6_linear1_12&#45;&gt;expert4_6_gelu_12 -->
<g id="edge787" class="edge">
<title>expert4_6_linear1_12&#45;&gt;expert4_6_gelu_12</title>
<path fill="none" stroke="black" d="M9043,-1469.61C9043,-1469.61 9043,-1394.12 9043,-1394.12"/>
<polygon fill="black" stroke="black" points="9046.5,-1394.12 9043,-1384.12 9039.5,-1394.12 9046.5,-1394.12"/>
</g>
<!-- expert4_6_linear2_12 -->
<g id="node537" class="node">
<title>expert4_6_linear2_12</title>
<polygon fill="lightcoral" stroke="black" points="9126,-1244.91 8988,-1244.91 8988,-1191.91 9126,-1191.91 9126,-1244.91"/>
<text text-anchor="middle" x="9057" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="9057" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="9057" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert4_6_gelu_12&#45;&gt;expert4_6_linear2_12 -->
<g id="edge788" class="edge">
<title>expert4_6_gelu_12&#45;&gt;expert4_6_linear2_12</title>
<path fill="none" stroke="black" d="M9057,-1330.61C9057,-1330.61 9057,-1255.12 9057,-1255.12"/>
<polygon fill="black" stroke="black" points="9060.5,-1255.12 9057,-1245.12 9053.5,-1255.12 9060.5,-1255.12"/>
</g>
<!-- expert4_6_agg -->
<g id="node541" class="node">
<title>expert4_6_agg</title>
<polygon fill="lightgreen" stroke="black" points="9427.11,-1105.91 9054.69,-1105.91 8958.89,-999.91 9331.31,-999.91 9427.11,-1105.91"/>
<text text-anchor="middle" x="9193" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 6 Output Aggregation</text>
<text text-anchor="middle" x="9193" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9193" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 12,13</text>
</g>
<!-- expert4_6_linear2_12&#45;&gt;expert4_6_agg -->
<g id="edge789" class="edge">
<title>expert4_6_linear2_12&#45;&gt;expert4_6_agg</title>
<path fill="none" stroke="black" d="M9057,-1191.82C9057,-1191.82 9057,-1116.18 9057,-1116.18"/>
<polygon fill="black" stroke="black" points="9060.5,-1116.18 9057,-1106.18 9053.5,-1116.18 9060.5,-1116.18"/>
</g>
<!-- expert4_6_gelu_13 -->
<g id="node539" class="node">
<title>expert4_6_gelu_13</title>
<polygon fill="lightblue" stroke="black" points="9390.5,-1383.91 9197.5,-1383.91 9197.5,-1330.91 9390.5,-1330.91 9390.5,-1383.91"/>
<text text-anchor="middle" x="9294" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="9294" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9294" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert4_6_linear1_13&#45;&gt;expert4_6_gelu_13 -->
<g id="edge791" class="edge">
<title>expert4_6_linear1_13&#45;&gt;expert4_6_gelu_13</title>
<path fill="none" stroke="black" d="M9294,-1469.61C9294,-1469.61 9294,-1394.12 9294,-1394.12"/>
<polygon fill="black" stroke="black" points="9297.5,-1394.12 9294,-1384.12 9290.5,-1394.12 9297.5,-1394.12"/>
</g>
<!-- expert4_6_linear2_13 -->
<g id="node540" class="node">
<title>expert4_6_linear2_13</title>
<polygon fill="lightcoral" stroke="black" points="9349,-1244.91 9211,-1244.91 9211,-1191.91 9349,-1191.91 9349,-1244.91"/>
<text text-anchor="middle" x="9280" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear2</text>
<text text-anchor="middle" x="9280" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="9280" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert4_6_gelu_13&#45;&gt;expert4_6_linear2_13 -->
<g id="edge792" class="edge">
<title>expert4_6_gelu_13&#45;&gt;expert4_6_linear2_13</title>
<path fill="none" stroke="black" d="M9280,-1330.61C9280,-1330.61 9280,-1255.12 9280,-1255.12"/>
<polygon fill="black" stroke="black" points="9283.5,-1255.12 9280,-1245.12 9276.5,-1255.12 9283.5,-1255.12"/>
</g>
<!-- expert4_6_linear2_13&#45;&gt;expert4_6_agg -->
<g id="edge793" class="edge">
<title>expert4_6_linear2_13&#45;&gt;expert4_6_agg</title>
<path fill="none" stroke="black" d="M9280,-1191.82C9280,-1191.82 9280,-1116.18 9280,-1116.18"/>
<polygon fill="black" stroke="black" points="9283.5,-1116.18 9280,-1106.18 9276.5,-1116.18 9283.5,-1116.18"/>
</g>
<!-- expert4_6_agg&#45;&gt;expert_outputs4 -->
<g id="edge794" class="edge">
<title>expert4_6_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M9193,-999.8C9193,-946.11 9193,-871 9193,-871 9193,-871 8339.57,-871 8339.57,-871"/>
<polygon fill="black" stroke="black" points="8339.57,-867.5 8329.57,-871 8339.57,-874.5 8339.57,-867.5"/>
</g>
<!-- expert4_7_gelu_14 -->
<g id="node543" class="node">
<title>expert4_7_gelu_14</title>
<polygon fill="lightblue" stroke="black" points="9641.5,-1383.91 9448.5,-1383.91 9448.5,-1330.91 9641.5,-1330.91 9641.5,-1383.91"/>
<text text-anchor="middle" x="9545" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="9545" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9545" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert4_7_linear1_14&#45;&gt;expert4_7_gelu_14 -->
<g id="edge796" class="edge">
<title>expert4_7_linear1_14&#45;&gt;expert4_7_gelu_14</title>
<path fill="none" stroke="black" d="M9545,-1469.61C9545,-1469.61 9545,-1394.12 9545,-1394.12"/>
<polygon fill="black" stroke="black" points="9548.5,-1394.12 9545,-1384.12 9541.5,-1394.12 9548.5,-1394.12"/>
</g>
<!-- expert4_7_linear2_14 -->
<g id="node544" class="node">
<title>expert4_7_linear2_14</title>
<polygon fill="lightcoral" stroke="black" points="9628,-1244.91 9490,-1244.91 9490,-1191.91 9628,-1191.91 9628,-1244.91"/>
<text text-anchor="middle" x="9559" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="9559" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="9559" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert4_7_gelu_14&#45;&gt;expert4_7_linear2_14 -->
<g id="edge797" class="edge">
<title>expert4_7_gelu_14&#45;&gt;expert4_7_linear2_14</title>
<path fill="none" stroke="black" d="M9559,-1330.61C9559,-1330.61 9559,-1255.12 9559,-1255.12"/>
<polygon fill="black" stroke="black" points="9562.5,-1255.12 9559,-1245.12 9555.5,-1255.12 9562.5,-1255.12"/>
</g>
<!-- expert4_7_agg -->
<g id="node548" class="node">
<title>expert4_7_agg</title>
<polygon fill="lightgreen" stroke="black" points="9954.11,-1105.91 9581.69,-1105.91 9485.89,-999.91 9858.31,-999.91 9954.11,-1105.91"/>
<text text-anchor="middle" x="9720" y="-1064.21" font-family="Times,serif" font-size="14.00">Expert 7 Output Aggregation</text>
<text text-anchor="middle" x="9720" y="-1049.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9720" y="-1034.21" font-family="Times,serif" font-size="14.00">GPUs 14,15</text>
</g>
<!-- expert4_7_linear2_14&#45;&gt;expert4_7_agg -->
<g id="edge798" class="edge">
<title>expert4_7_linear2_14&#45;&gt;expert4_7_agg</title>
<path fill="none" stroke="black" d="M9559,-1191.82C9559,-1191.82 9559,-1090.81 9559,-1090.81"/>
<polygon fill="black" stroke="black" points="9562.5,-1090.81 9559,-1080.81 9555.5,-1090.81 9562.5,-1090.81"/>
</g>
<!-- expert4_7_gelu_15 -->
<g id="node546" class="node">
<title>expert4_7_gelu_15</title>
<polygon fill="lightblue" stroke="black" points="9892.5,-1383.91 9699.5,-1383.91 9699.5,-1330.91 9892.5,-1330.91 9892.5,-1383.91"/>
<text text-anchor="middle" x="9796" y="-1368.71" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="9796" y="-1353.71" font-family="Times,serif" font-size="14.00">(B×L×ffn_hidden_size/2)</text>
<text text-anchor="middle" x="9796" y="-1338.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert4_7_linear1_15&#45;&gt;expert4_7_gelu_15 -->
<g id="edge800" class="edge">
<title>expert4_7_linear1_15&#45;&gt;expert4_7_gelu_15</title>
<path fill="none" stroke="black" d="M9796,-1469.61C9796,-1469.61 9796,-1394.12 9796,-1394.12"/>
<polygon fill="black" stroke="black" points="9799.5,-1394.12 9796,-1384.12 9792.5,-1394.12 9799.5,-1394.12"/>
</g>
<!-- expert4_7_linear2_15 -->
<g id="node547" class="node">
<title>expert4_7_linear2_15</title>
<polygon fill="lightcoral" stroke="black" points="9851,-1244.91 9713,-1244.91 9713,-1191.91 9851,-1191.91 9851,-1244.91"/>
<text text-anchor="middle" x="9782" y="-1229.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear2</text>
<text text-anchor="middle" x="9782" y="-1214.71" font-family="Times,serif" font-size="14.00">(B×L×D/2)</text>
<text text-anchor="middle" x="9782" y="-1199.71" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert4_7_gelu_15&#45;&gt;expert4_7_linear2_15 -->
<g id="edge801" class="edge">
<title>expert4_7_gelu_15&#45;&gt;expert4_7_linear2_15</title>
<path fill="none" stroke="black" d="M9782,-1330.61C9782,-1330.61 9782,-1255.12 9782,-1255.12"/>
<polygon fill="black" stroke="black" points="9785.5,-1255.12 9782,-1245.12 9778.5,-1255.12 9785.5,-1255.12"/>
</g>
<!-- expert4_7_linear2_15&#45;&gt;expert4_7_agg -->
<g id="edge802" class="edge">
<title>expert4_7_linear2_15&#45;&gt;expert4_7_agg</title>
<path fill="none" stroke="black" d="M9782,-1191.82C9782,-1191.82 9782,-1116.18 9782,-1116.18"/>
<polygon fill="black" stroke="black" points="9785.5,-1116.18 9782,-1106.18 9778.5,-1116.18 9785.5,-1116.18"/>
</g>
<!-- expert4_7_agg&#45;&gt;expert_outputs4 -->
<g id="edge803" class="edge">
<title>expert4_7_agg&#45;&gt;expert_outputs4</title>
<path fill="none" stroke="black" d="M9553.74,-999.86C9553.74,-939.74 9553.74,-850 9553.74,-850 9553.74,-850 8321.06,-850 8321.06,-850"/>
<polygon fill="black" stroke="black" points="8321.06,-846.5 8311.06,-850 8321.06,-853.5 8321.06,-846.5"/>
</g>
<!-- weighted_sum4 -->
<g id="node550" class="node">
<title>weighted_sum4</title>
<polygon fill="lightgreen" stroke="black" points="8732.39,-721.91 8532.92,-721.91 8481.61,-615.91 8681.08,-615.91 8732.39,-721.91"/>
<text text-anchor="middle" x="8607" y="-680.21" font-family="Times,serif" font-size="14.00">Weighted Sum</text>
<text text-anchor="middle" x="8607" y="-665.21" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="8607" y="-650.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- expert_outputs4&#45;&gt;weighted_sum4 -->
<g id="edge804" class="edge">
<title>expert_outputs4&#45;&gt;weighted_sum4</title>
<path fill="none" stroke="black" d="M8292.56,-829C8429.01,-829 8607,-829 8607,-829 8607,-829 8607,-732.22 8607,-732.22"/>
<polygon fill="black" stroke="black" points="8610.5,-732.22 8607,-722.22 8603.5,-732.22 8610.5,-732.22"/>
</g>
<!-- weighted_sum4&#45;&gt;residual4_2 -->
<g id="edge805" class="edge">
<title>weighted_sum4&#45;&gt;residual4_2</title>
<path fill="none" stroke="black" d="M8706.68,-668C8934.93,-668 9475.96,-668 9475.96,-668 9475.96,-668 9475.96,-520.89 9475.96,-520.89"/>
<polygon fill="black" stroke="black" points="9479.46,-520.89 9475.96,-510.89 9472.46,-520.89 9479.46,-520.89"/>
</g>
<!-- final_ln -->
<g id="node552" class="node">
<title>final_ln</title>
<polygon fill="lightblue" stroke="black" points="9613,-368.95 9475,-368.95 9475,-315.95 9613,-315.95 9613,-368.95"/>
<text text-anchor="middle" x="9544" y="-353.75" font-family="Times,serif" font-size="14.00">Final LayerNorm</text>
<text text-anchor="middle" x="9544" y="-338.75" font-family="Times,serif" font-size="14.00">(B×L×D)</text>
<text text-anchor="middle" x="9544" y="-323.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- residual4_2&#45;&gt;final_ln -->
<g id="edge807" class="edge">
<title>residual4_2&#45;&gt;final_ln</title>
<path fill="none" stroke="black" d="M9544,-454.58C9544,-454.58 9544,-379.41 9544,-379.41"/>
<polygon fill="black" stroke="black" points="9547.5,-379.41 9544,-369.41 9540.5,-379.41 9547.5,-379.41"/>
</g>
<!-- lm_head -->
<g id="node553" class="node">
<title>lm_head</title>
<polygon fill="lightcoral" stroke="black" points="9632.5,-229.95 9455.5,-229.95 9455.5,-176.95 9632.5,-176.95 9632.5,-229.95"/>
<text text-anchor="middle" x="9544" y="-214.75" font-family="Times,serif" font-size="14.00">Language Model Head</text>
<text text-anchor="middle" x="9544" y="-199.75" font-family="Times,serif" font-size="14.00">(B×L×Vocab)</text>
<text text-anchor="middle" x="9544" y="-184.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- final_ln&#45;&gt;lm_head -->
<g id="edge808" class="edge">
<title>final_ln&#45;&gt;lm_head</title>
<path fill="none" stroke="black" d="M9544,-315.65C9544,-315.65 9544,-240.17 9544,-240.17"/>
<polygon fill="black" stroke="black" points="9547.5,-240.17 9544,-230.17 9540.5,-240.17 9547.5,-240.17"/>
</g>
<!-- output -->
<g id="node554" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="9544" cy="-53.48" rx="85.62" ry="37.45"/>
<text text-anchor="middle" x="9544" y="-64.78" font-family="Times,serif" font-size="14.00">Output Tokens</text>
<text text-anchor="middle" x="9544" y="-49.78" font-family="Times,serif" font-size="14.00">(B×L)</text>
<text text-anchor="middle" x="9544" y="-34.78" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- lm_head&#45;&gt;output -->
<g id="edge809" class="edge">
<title>lm_head&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9544,-176.64C9544,-176.64 9544,-101.04 9544,-101.04"/>
<polygon fill="black" stroke="black" points="9547.5,-101.04 9544,-91.04 9540.5,-101.04 9547.5,-101.04"/>
</g>
</g>
</svg>
