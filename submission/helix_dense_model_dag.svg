<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_Dense_Model_DAG Pages: 1 -->
<svg width="2160pt" height="52pt"
 viewBox="0.00 0.00 2160.00 52.30" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.04 0.04) rotate(0) translate(4 1338.39)">
<title>Helix_Dense_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1338.39 55442,-1338.39 55442,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M20,-8C20,-8 9402,-8 9402,-8 9408,-8 9414,-14 9414,-20 9414,-20 9414,-1245.97 9414,-1245.97 9414,-1251.97 9408,-1257.97 9402,-1257.97 9402,-1257.97 20,-1257.97 20,-1257.97 14,-1257.97 8,-1251.97 8,-1245.97 8,-1245.97 8,-20 8,-20 8,-14 14,-8 20,-8"/>
<text text-anchor="middle" x="4711" y="-1242.77" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M39956,-1140.97C39956,-1140.97 55418,-1140.97 55418,-1140.97 55424,-1140.97 55430,-1146.97 55430,-1152.97 55430,-1152.97 55430,-1271.97 55430,-1271.97 55430,-1277.97 55424,-1283.97 55418,-1283.97 55418,-1283.97 39956,-1283.97 39956,-1283.97 39950,-1283.97 39944,-1277.97 39944,-1271.97 39944,-1271.97 39944,-1152.97 39944,-1152.97 39944,-1146.97 39950,-1140.97 39956,-1140.97"/>
<text text-anchor="middle" x="47687" y="-1268.77" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M24711,-989.97C24711,-989.97 40173,-989.97 40173,-989.97 40179,-989.97 40185,-995.97 40185,-1001.97 40185,-1001.97 40185,-1120.97 40185,-1120.97 40185,-1126.97 40179,-1132.97 40173,-1132.97 40173,-1132.97 24711,-1132.97 24711,-1132.97 24705,-1132.97 24699,-1126.97 24699,-1120.97 24699,-1120.97 24699,-1001.97 24699,-1001.97 24699,-995.97 24705,-989.97 24711,-989.97"/>
<text text-anchor="middle" x="32442" y="-1117.77" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer4</title>
<path fill="none" stroke="black" d="M9466,-838.97C9466,-838.97 24928,-838.97 24928,-838.97 24934,-838.97 24940,-844.97 24940,-850.97 24940,-850.97 24940,-969.97 24940,-969.97 24940,-975.97 24934,-981.97 24928,-981.97 24928,-981.97 9466,-981.97 9466,-981.97 9460,-981.97 9454,-975.97 9454,-969.97 9454,-969.97 9454,-850.97 9454,-850.97 9454,-844.97 9460,-838.97 9466,-838.97"/>
<text text-anchor="middle" x="17197" y="-966.77" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="9376" cy="-1313.18" rx="85.62" ry="21.43"/>
<text text-anchor="middle" x="9376" y="-1316.18" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="9376" y="-1305.18" font-family="Arial" font-size="10.00">X: [B=1024, L, D=8192]</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightgreen" stroke="black" points="9272.5,-1226.97 9165.5,-1226.97 9165.5,-1174.97 9272.5,-1174.97 9272.5,-1226.97"/>
<text text-anchor="middle" x="9219" y="-1214.97" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="9219" y="-1203.97" font-family="Arial" font-size="10.00">X: [B=1024, L, 8192]</text>
<text text-anchor="middle" x="9219" y="-1192.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 8192]</text>
<text text-anchor="middle" x="9219" y="-1181.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge69" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M9348.65,-1292.98C9325.09,-1276.44 9290.62,-1252.25 9263.15,-1232.96"/>
<polygon fill="black" stroke="black" points="9265.07,-1230.03 9254.87,-1227.15 9261.05,-1235.76 9265.07,-1230.03"/>
</g>
<!-- res1 -->
<g id="node73" class="node">
<title>res1</title>
<ellipse fill="lightgreen" stroke="black" cx="8648" cy="-446.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="8648" y="-455.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8648" y="-444.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8648" y="-433.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge75" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M9383.7,-1291.86C9399.48,-1248.37 9434,-1142.71 9434,-1050.97 9434,-1050.97 9434,-1050.97 9434,-628.97 9434,-497.87 9013.49,-461.72 8787.63,-451.76"/>
<polygon fill="black" stroke="black" points="8787.49,-448.25 8777.35,-451.32 8787.19,-455.24 8787.49,-448.25"/>
</g>
<!-- q_proj_0_0 -->
<g id="node3" class="node">
<title>q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="9014,-1070.47 8836,-1070.47 8836,-1029.47 9014,-1029.47 9014,-1070.47"/>
<text text-anchor="middle" x="8925" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8925" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8925" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_0 -->
<g id="edge70" class="edge">
<title>ln1&#45;&gt;q_proj_0_0</title>
<path fill="none" stroke="black" d="M9165.19,-1187.31C9124.49,-1176.41 9068.12,-1158.38 9023,-1132.97 8996.45,-1118.01 8970.17,-1095.49 8951.52,-1077.83"/>
<polygon fill="black" stroke="black" points="8953.65,-1075.02 8944.02,-1070.6 8948.79,-1080.06 8953.65,-1075.02"/>
</g>
<!-- k_proj_0_0 -->
<g id="node4" class="node">
<title>k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="9210,-1070.47 9032,-1070.47 9032,-1029.47 9210,-1029.47 9210,-1070.47"/>
<text text-anchor="middle" x="9121" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9121" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9121" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_0 -->
<g id="edge71" class="edge">
<title>ln1&#45;&gt;k_proj_0_0</title>
<path fill="none" stroke="black" d="M9202.38,-1174.69C9184.93,-1148.17 9157.58,-1106.58 9139.47,-1079.05"/>
<polygon fill="black" stroke="black" points="9142.36,-1077.08 9133.94,-1070.64 9136.51,-1080.92 9142.36,-1077.08"/>
</g>
<!-- v_proj_0_0 -->
<g id="node5" class="node">
<title>v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="9406,-1070.47 9228,-1070.47 9228,-1029.47 9406,-1029.47 9406,-1070.47"/>
<text text-anchor="middle" x="9317" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9317" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9317" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_0 -->
<g id="edge72" class="edge">
<title>ln1&#45;&gt;v_proj_0_0</title>
<path fill="none" stroke="black" d="M9235.62,-1174.69C9253.07,-1148.17 9280.42,-1106.58 9298.53,-1079.05"/>
<polygon fill="black" stroke="black" points="9301.49,-1080.92 9304.06,-1070.64 9295.64,-1077.08 9301.49,-1080.92"/>
</g>
<!-- attn_0_0 -->
<g id="node6" class="node">
<title>attn_0_0</title>
<polygon fill="lightgreen" stroke="black" points="9094.5,-924.97 8951.5,-924.97 8951.5,-872.97 9094.5,-872.97 9094.5,-924.97"/>
<text text-anchor="middle" x="9023" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="9023" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="9023" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="9023" y="-879.97" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge1" class="edge">
<title>q_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M8938.01,-1029.18C8954.01,-1004.86 8981.41,-963.2 9000.77,-933.77"/>
<polygon fill="black" stroke="black" points="9003.92,-935.34 9006.49,-925.06 8998.07,-931.49 9003.92,-935.34"/>
</g>
<!-- k_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge2" class="edge">
<title>k_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M9107.99,-1029.18C9091.99,-1004.86 9064.59,-963.2 9045.23,-933.77"/>
<polygon fill="black" stroke="black" points="9047.93,-931.49 9039.51,-925.06 9042.08,-935.34 9047.93,-931.49"/>
</g>
<!-- v_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge3" class="edge">
<title>v_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M9286.17,-1029.2C9267.12,-1017.29 9242,-1002.12 9219,-989.97 9177.5,-968.03 9129.63,-945.99 9091.6,-929.22"/>
<polygon fill="black" stroke="black" points="9092.71,-925.88 9082.15,-925.07 9089.9,-932.29 9092.71,-925.88"/>
</g>
<!-- agg_dim_0 -->
<g id="node67" class="node">
<title>agg_dim_0</title>
<polygon fill="lightcoral" stroke="black" points="8077.91,-810.97 7866.48,-810.97 7812.09,-706.97 8023.52,-706.97 8077.91,-810.97"/>
<text text-anchor="middle" x="7945" y="-772.97" font-family="Arial" font-size="10.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="7945" y="-761.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="7945" y="-750.97" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="7945" y="-739.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_0_0&#45;&gt;agg_dim_0 -->
<g id="edge49" class="edge">
<title>attn_0_0&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M8951.43,-888.8C8771.07,-865.71 8296.15,-804.92 8069.2,-775.86"/>
<polygon fill="black" stroke="black" points="8069.61,-772.39 8059.24,-774.59 8068.72,-779.33 8069.61,-772.39"/>
</g>
<!-- q_proj_0_1 -->
<g id="node7" class="node">
<title>q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8818,-1070.47 8640,-1070.47 8640,-1029.47 8818,-1029.47 8818,-1070.47"/>
<text text-anchor="middle" x="8729" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8729" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8729" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- attn_0_1 -->
<g id="node10" class="node">
<title>attn_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8506.5,-924.97 8363.5,-924.97 8363.5,-872.97 8506.5,-872.97 8506.5,-924.97"/>
<text text-anchor="middle" x="8435" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="8435" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="8435" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="8435" y="-879.97" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge4" class="edge">
<title>q_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M8698.17,-1029.2C8679.12,-1017.29 8654,-1002.12 8631,-989.97 8589.5,-968.03 8541.63,-945.99 8503.6,-929.22"/>
<polygon fill="black" stroke="black" points="8504.71,-925.88 8494.15,-925.07 8501.9,-932.29 8504.71,-925.88"/>
</g>
<!-- k_proj_0_1 -->
<g id="node8" class="node">
<title>k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8622,-1070.47 8444,-1070.47 8444,-1029.47 8622,-1029.47 8622,-1070.47"/>
<text text-anchor="middle" x="8533" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="8533" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8533" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- k_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge5" class="edge">
<title>k_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M8519.99,-1029.18C8503.99,-1004.86 8476.59,-963.2 8457.23,-933.77"/>
<polygon fill="black" stroke="black" points="8459.93,-931.49 8451.51,-925.06 8454.08,-935.34 8459.93,-931.49"/>
</g>
<!-- v_proj_0_1 -->
<g id="node9" class="node">
<title>v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="8426,-1070.47 8248,-1070.47 8248,-1029.47 8426,-1029.47 8426,-1070.47"/>
<text text-anchor="middle" x="8337" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="8337" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8337" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- v_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge6" class="edge">
<title>v_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M8350.01,-1029.18C8366.01,-1004.86 8393.41,-963.2 8412.77,-933.77"/>
<polygon fill="black" stroke="black" points="8415.92,-935.34 8418.49,-925.06 8410.07,-931.49 8415.92,-935.34"/>
</g>
<!-- attn_0_1&#45;&gt;agg_dim_0 -->
<g id="edge50" class="edge">
<title>attn_0_1&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M8363.49,-877.83C8289.22,-856.91 8171.26,-823.69 8079.48,-797.84"/>
<polygon fill="black" stroke="black" points="8080.41,-794.47 8069.84,-795.12 8078.52,-801.2 8080.41,-794.47"/>
</g>
<!-- q_proj_0_2 -->
<g id="node11" class="node">
<title>q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8230,-1070.47 8052,-1070.47 8052,-1029.47 8230,-1029.47 8230,-1070.47"/>
<text text-anchor="middle" x="8141" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8141" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8141" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- attn_0_2 -->
<g id="node14" class="node">
<title>attn_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8016.5,-924.97 7873.5,-924.97 7873.5,-872.97 8016.5,-872.97 8016.5,-924.97"/>
<text text-anchor="middle" x="7945" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7945" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="7945" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="7945" y="-879.97" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge7" class="edge">
<title>q_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M8114.97,-1029.18C8082.02,-1004.13 8024.86,-960.67 7986.01,-931.14"/>
<polygon fill="black" stroke="black" points="7988.09,-928.33 7978.01,-925.06 7983.86,-933.9 7988.09,-928.33"/>
</g>
<!-- k_proj_0_2 -->
<g id="node12" class="node">
<title>k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="8034,-1070.47 7856,-1070.47 7856,-1029.47 8034,-1029.47 8034,-1070.47"/>
<text text-anchor="middle" x="7945" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7945" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7945" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- k_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge8" class="edge">
<title>k_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M7945,-1029.18C7945,-1005.28 7945,-964.63 7945,-935.3"/>
<polygon fill="black" stroke="black" points="7948.5,-935.06 7945,-925.06 7941.5,-935.06 7948.5,-935.06"/>
</g>
<!-- v_proj_0_2 -->
<g id="node13" class="node">
<title>v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="7838,-1070.47 7660,-1070.47 7660,-1029.47 7838,-1029.47 7838,-1070.47"/>
<text text-anchor="middle" x="7749" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="7749" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7749" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- v_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge9" class="edge">
<title>v_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M7775.03,-1029.18C7807.98,-1004.13 7865.14,-960.67 7903.99,-931.14"/>
<polygon fill="black" stroke="black" points="7906.14,-933.9 7911.99,-925.06 7901.91,-928.33 7906.14,-933.9"/>
</g>
<!-- attn_0_2&#45;&gt;agg_dim_0 -->
<g id="edge51" class="edge">
<title>attn_0_2&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M7945,-872.65C7945,-858.21 7945,-839.43 7945,-821.36"/>
<polygon fill="black" stroke="black" points="7948.5,-821.13 7945,-811.13 7941.5,-821.13 7948.5,-821.13"/>
</g>
<!-- q_proj_0_3 -->
<g id="node15" class="node">
<title>q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7642,-1070.47 7464,-1070.47 7464,-1029.47 7642,-1029.47 7642,-1070.47"/>
<text text-anchor="middle" x="7553" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="7553" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7553" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- attn_0_3 -->
<g id="node18" class="node">
<title>attn_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7526.5,-924.97 7383.5,-924.97 7383.5,-872.97 7526.5,-872.97 7526.5,-924.97"/>
<text text-anchor="middle" x="7455" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="7455" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="7455" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="7455" y="-879.97" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge10" class="edge">
<title>q_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M7539.99,-1029.18C7523.99,-1004.86 7496.59,-963.2 7477.23,-933.77"/>
<polygon fill="black" stroke="black" points="7479.93,-931.49 7471.51,-925.06 7474.08,-935.34 7479.93,-931.49"/>
</g>
<!-- k_proj_0_3 -->
<g id="node16" class="node">
<title>k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7446,-1070.47 7268,-1070.47 7268,-1029.47 7446,-1029.47 7446,-1070.47"/>
<text text-anchor="middle" x="7357" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7357" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7357" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- k_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge11" class="edge">
<title>k_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M7370.01,-1029.18C7386.01,-1004.86 7413.41,-963.2 7432.77,-933.77"/>
<polygon fill="black" stroke="black" points="7435.92,-935.34 7438.49,-925.06 7430.07,-931.49 7435.92,-935.34"/>
</g>
<!-- v_proj_0_3 -->
<g id="node17" class="node">
<title>v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="7250,-1070.47 7072,-1070.47 7072,-1029.47 7250,-1029.47 7250,-1070.47"/>
<text text-anchor="middle" x="7161" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="7161" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7161" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- v_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge12" class="edge">
<title>v_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M7191.83,-1029.2C7210.88,-1017.29 7236,-1002.12 7259,-989.97 7300.5,-968.03 7348.37,-945.99 7386.4,-929.22"/>
<polygon fill="black" stroke="black" points="7388.1,-932.29 7395.85,-925.07 7385.29,-925.88 7388.1,-932.29"/>
</g>
<!-- attn_0_3&#45;&gt;agg_dim_0 -->
<g id="edge52" class="edge">
<title>attn_0_3&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M7526.51,-877.83C7610.02,-854.31 7748.75,-815.24 7843.41,-788.58"/>
<polygon fill="black" stroke="black" points="7844.61,-791.87 7853.29,-785.79 7842.71,-785.14 7844.61,-791.87"/>
</g>
<!-- q_proj_1_0 -->
<g id="node19" class="node">
<title>q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="7054,-1070.47 6876,-1070.47 6876,-1029.47 7054,-1029.47 7054,-1070.47"/>
<text text-anchor="middle" x="6965" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6965" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6965" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- attn_1_0 -->
<g id="node22" class="node">
<title>attn_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6742.5,-924.97 6599.5,-924.97 6599.5,-872.97 6742.5,-872.97 6742.5,-924.97"/>
<text text-anchor="middle" x="6671" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6671" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="6671" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="6671" y="-879.97" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge13" class="edge">
<title>q_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M6934.17,-1029.2C6915.12,-1017.29 6890,-1002.12 6867,-989.97 6825.5,-968.03 6777.63,-945.99 6739.6,-929.22"/>
<polygon fill="black" stroke="black" points="6740.71,-925.88 6730.15,-925.07 6737.9,-932.29 6740.71,-925.88"/>
</g>
<!-- k_proj_1_0 -->
<g id="node20" class="node">
<title>k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6858,-1070.47 6680,-1070.47 6680,-1029.47 6858,-1029.47 6858,-1070.47"/>
<text text-anchor="middle" x="6769" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6769" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6769" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- k_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge14" class="edge">
<title>k_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M6755.99,-1029.18C6739.99,-1004.86 6712.59,-963.2 6693.23,-933.77"/>
<polygon fill="black" stroke="black" points="6695.93,-931.49 6687.51,-925.06 6690.08,-935.34 6695.93,-931.49"/>
</g>
<!-- v_proj_1_0 -->
<g id="node21" class="node">
<title>v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="6662,-1070.47 6484,-1070.47 6484,-1029.47 6662,-1029.47 6662,-1070.47"/>
<text text-anchor="middle" x="6573" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="6573" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6573" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- v_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge15" class="edge">
<title>v_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M6586.01,-1029.18C6602.01,-1004.86 6629.41,-963.2 6648.77,-933.77"/>
<polygon fill="black" stroke="black" points="6651.92,-935.34 6654.49,-925.06 6646.07,-931.49 6651.92,-935.34"/>
</g>
<!-- agg_dim_1 -->
<g id="node68" class="node">
<title>agg_dim_1</title>
<polygon fill="lightcoral" stroke="black" points="6019.91,-810.97 5808.48,-810.97 5754.09,-706.97 5965.52,-706.97 6019.91,-810.97"/>
<text text-anchor="middle" x="5887" y="-772.97" font-family="Arial" font-size="10.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="5887" y="-761.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="5887" y="-750.97" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="5887" y="-739.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_1_0&#45;&gt;agg_dim_1 -->
<g id="edge53" class="edge">
<title>attn_1_0&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M6599.35,-885.35C6466.61,-861.99 6180.88,-811.69 6014.44,-782.4"/>
<polygon fill="black" stroke="black" points="6014.61,-778.87 6004.15,-780.59 6013.39,-785.77 6014.61,-778.87"/>
</g>
<!-- q_proj_1_1 -->
<g id="node23" class="node">
<title>q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6466,-1070.47 6288,-1070.47 6288,-1029.47 6466,-1029.47 6466,-1070.47"/>
<text text-anchor="middle" x="6377" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6377" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6377" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- attn_1_1 -->
<g id="node26" class="node">
<title>attn_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6154.5,-924.97 6011.5,-924.97 6011.5,-872.97 6154.5,-872.97 6154.5,-924.97"/>
<text text-anchor="middle" x="6083" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="6083" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="6083" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="6083" y="-879.97" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge16" class="edge">
<title>q_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M6346.17,-1029.2C6327.12,-1017.29 6302,-1002.12 6279,-989.97 6237.5,-968.03 6189.63,-945.99 6151.6,-929.22"/>
<polygon fill="black" stroke="black" points="6152.71,-925.88 6142.15,-925.07 6149.9,-932.29 6152.71,-925.88"/>
</g>
<!-- k_proj_1_1 -->
<g id="node24" class="node">
<title>k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6270,-1070.47 6092,-1070.47 6092,-1029.47 6270,-1029.47 6270,-1070.47"/>
<text text-anchor="middle" x="6181" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6181" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6181" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- k_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge17" class="edge">
<title>k_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M6167.99,-1029.18C6151.99,-1004.86 6124.59,-963.2 6105.23,-933.77"/>
<polygon fill="black" stroke="black" points="6107.93,-931.49 6099.51,-925.06 6102.08,-935.34 6107.93,-931.49"/>
</g>
<!-- v_proj_1_1 -->
<g id="node25" class="node">
<title>v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="6074,-1070.47 5896,-1070.47 5896,-1029.47 6074,-1029.47 6074,-1070.47"/>
<text text-anchor="middle" x="5985" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="5985" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5985" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- v_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge18" class="edge">
<title>v_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M5998.01,-1029.18C6014.01,-1004.86 6041.41,-963.2 6060.77,-933.77"/>
<polygon fill="black" stroke="black" points="6063.92,-935.34 6066.49,-925.06 6058.07,-931.49 6063.92,-935.34"/>
</g>
<!-- attn_1_1&#45;&gt;agg_dim_1 -->
<g id="edge54" class="edge">
<title>attn_1_1&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M6047.05,-872.65C6024.92,-857.07 5995.61,-836.43 5968.13,-817.08"/>
<polygon fill="black" stroke="black" points="5969.86,-814.02 5959.67,-811.13 5965.83,-819.75 5969.86,-814.02"/>
</g>
<!-- q_proj_1_2 -->
<g id="node27" class="node">
<title>q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="5878,-1070.47 5700,-1070.47 5700,-1029.47 5878,-1029.47 5878,-1070.47"/>
<text text-anchor="middle" x="5789" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5789" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5789" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- attn_1_2 -->
<g id="node30" class="node">
<title>attn_1_2</title>
<polygon fill="lightgreen" stroke="black" points="5762.5,-924.97 5619.5,-924.97 5619.5,-872.97 5762.5,-872.97 5762.5,-924.97"/>
<text text-anchor="middle" x="5691" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5691" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="5691" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="5691" y="-879.97" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge19" class="edge">
<title>q_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5775.99,-1029.18C5759.99,-1004.86 5732.59,-963.2 5713.23,-933.77"/>
<polygon fill="black" stroke="black" points="5715.93,-931.49 5707.51,-925.06 5710.08,-935.34 5715.93,-931.49"/>
</g>
<!-- k_proj_1_2 -->
<g id="node28" class="node">
<title>k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="5682,-1070.47 5504,-1070.47 5504,-1029.47 5682,-1029.47 5682,-1070.47"/>
<text text-anchor="middle" x="5593" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5593" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5593" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- k_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge20" class="edge">
<title>k_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5606.01,-1029.18C5622.01,-1004.86 5649.41,-963.2 5668.77,-933.77"/>
<polygon fill="black" stroke="black" points="5671.92,-935.34 5674.49,-925.06 5666.07,-931.49 5671.92,-935.34"/>
</g>
<!-- v_proj_1_2 -->
<g id="node29" class="node">
<title>v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="5486,-1070.47 5308,-1070.47 5308,-1029.47 5486,-1029.47 5486,-1070.47"/>
<text text-anchor="middle" x="5397" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="5397" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5397" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- v_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge21" class="edge">
<title>v_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M5427.83,-1029.2C5446.88,-1017.29 5472,-1002.12 5495,-989.97 5536.5,-968.03 5584.37,-945.99 5622.4,-929.22"/>
<polygon fill="black" stroke="black" points="5624.1,-932.29 5631.85,-925.07 5621.29,-925.88 5624.1,-932.29"/>
</g>
<!-- attn_1_2&#45;&gt;agg_dim_1 -->
<g id="edge55" class="edge">
<title>attn_1_2&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M5726.95,-872.65C5749.08,-857.07 5778.39,-836.43 5805.87,-817.08"/>
<polygon fill="black" stroke="black" points="5808.17,-819.75 5814.33,-811.13 5804.14,-814.02 5808.17,-819.75"/>
</g>
<!-- q_proj_1_3 -->
<g id="node31" class="node">
<title>q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="5290,-1070.47 5112,-1070.47 5112,-1029.47 5290,-1029.47 5290,-1070.47"/>
<text text-anchor="middle" x="5201" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5201" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5201" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- attn_1_3 -->
<g id="node34" class="node">
<title>attn_1_3</title>
<polygon fill="lightgreen" stroke="black" points="5174.5,-924.97 5031.5,-924.97 5031.5,-872.97 5174.5,-872.97 5174.5,-924.97"/>
<text text-anchor="middle" x="5103" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="5103" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="5103" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="5103" y="-879.97" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge22" class="edge">
<title>q_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M5187.99,-1029.18C5171.99,-1004.86 5144.59,-963.2 5125.23,-933.77"/>
<polygon fill="black" stroke="black" points="5127.93,-931.49 5119.51,-925.06 5122.08,-935.34 5127.93,-931.49"/>
</g>
<!-- k_proj_1_3 -->
<g id="node32" class="node">
<title>k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="5094,-1070.47 4916,-1070.47 4916,-1029.47 5094,-1029.47 5094,-1070.47"/>
<text text-anchor="middle" x="5005" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5005" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5005" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- k_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge23" class="edge">
<title>k_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M5018.01,-1029.18C5034.01,-1004.86 5061.41,-963.2 5080.77,-933.77"/>
<polygon fill="black" stroke="black" points="5083.92,-935.34 5086.49,-925.06 5078.07,-931.49 5083.92,-935.34"/>
</g>
<!-- v_proj_1_3 -->
<g id="node33" class="node">
<title>v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="4898,-1070.47 4720,-1070.47 4720,-1029.47 4898,-1029.47 4898,-1070.47"/>
<text text-anchor="middle" x="4809" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4809" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4809" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- v_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge24" class="edge">
<title>v_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M4839.83,-1029.2C4858.88,-1017.29 4884,-1002.12 4907,-989.97 4948.5,-968.03 4996.37,-945.99 5034.4,-929.22"/>
<polygon fill="black" stroke="black" points="5036.1,-932.29 5043.85,-925.07 5033.29,-925.88 5036.1,-932.29"/>
</g>
<!-- attn_1_3&#45;&gt;agg_dim_1 -->
<g id="edge56" class="edge">
<title>attn_1_3&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M5174.65,-885.35C5313.13,-860.98 5618.12,-807.29 5780.45,-778.72"/>
<polygon fill="black" stroke="black" points="5781.22,-782.14 5790.46,-776.96 5780,-775.25 5781.22,-782.14"/>
</g>
<!-- q_proj_2_0 -->
<g id="node35" class="node">
<title>q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4702,-1070.47 4524,-1070.47 4524,-1029.47 4702,-1029.47 4702,-1070.47"/>
<text text-anchor="middle" x="4613" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="4613" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4613" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- attn_2_0 -->
<g id="node38" class="node">
<title>attn_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4390.5,-924.97 4247.5,-924.97 4247.5,-872.97 4390.5,-872.97 4390.5,-924.97"/>
<text text-anchor="middle" x="4319" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="4319" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="4319" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="4319" y="-879.97" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge25" class="edge">
<title>q_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M4582.17,-1029.2C4563.12,-1017.29 4538,-1002.12 4515,-989.97 4473.5,-968.03 4425.63,-945.99 4387.6,-929.22"/>
<polygon fill="black" stroke="black" points="4388.71,-925.88 4378.15,-925.07 4385.9,-932.29 4388.71,-925.88"/>
</g>
<!-- k_proj_2_0 -->
<g id="node36" class="node">
<title>k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4506,-1070.47 4328,-1070.47 4328,-1029.47 4506,-1029.47 4506,-1070.47"/>
<text text-anchor="middle" x="4417" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="4417" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4417" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- k_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge26" class="edge">
<title>k_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M4403.99,-1029.18C4387.99,-1004.86 4360.59,-963.2 4341.23,-933.77"/>
<polygon fill="black" stroke="black" points="4343.93,-931.49 4335.51,-925.06 4338.08,-935.34 4343.93,-931.49"/>
</g>
<!-- v_proj_2_0 -->
<g id="node37" class="node">
<title>v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4310,-1070.47 4132,-1070.47 4132,-1029.47 4310,-1029.47 4310,-1070.47"/>
<text text-anchor="middle" x="4221" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4221" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4221" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- v_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge27" class="edge">
<title>v_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M4234.01,-1029.18C4250.01,-1004.86 4277.41,-963.2 4296.77,-933.77"/>
<polygon fill="black" stroke="black" points="4299.92,-935.34 4302.49,-925.06 4294.07,-931.49 4299.92,-935.34"/>
</g>
<!-- agg_dim_2 -->
<g id="node69" class="node">
<title>agg_dim_2</title>
<polygon fill="lightcoral" stroke="black" points="3961.91,-810.97 3750.48,-810.97 3696.09,-706.97 3907.52,-706.97 3961.91,-810.97"/>
<text text-anchor="middle" x="3829" y="-772.97" font-family="Arial" font-size="10.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="3829" y="-761.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="3829" y="-750.97" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="3829" y="-739.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_0&#45;&gt;agg_dim_2 -->
<g id="edge57" class="edge">
<title>attn_2_0&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M4247.49,-877.83C4173.22,-856.91 4055.26,-823.69 3963.48,-797.84"/>
<polygon fill="black" stroke="black" points="3964.41,-794.47 3953.84,-795.12 3962.52,-801.2 3964.41,-794.47"/>
</g>
<!-- q_proj_2_1 -->
<g id="node39" class="node">
<title>q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="4114,-1070.47 3936,-1070.47 3936,-1029.47 4114,-1029.47 4114,-1070.47"/>
<text text-anchor="middle" x="4025" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="4025" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4025" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- attn_2_1 -->
<g id="node42" class="node">
<title>attn_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3900.5,-924.97 3757.5,-924.97 3757.5,-872.97 3900.5,-872.97 3900.5,-924.97"/>
<text text-anchor="middle" x="3829" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3829" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="3829" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="3829" y="-879.97" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge28" class="edge">
<title>q_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3998.97,-1029.18C3966.02,-1004.13 3908.86,-960.67 3870.01,-931.14"/>
<polygon fill="black" stroke="black" points="3872.09,-928.33 3862.01,-925.06 3867.86,-933.9 3872.09,-928.33"/>
</g>
<!-- k_proj_2_1 -->
<g id="node40" class="node">
<title>k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3918,-1070.47 3740,-1070.47 3740,-1029.47 3918,-1029.47 3918,-1070.47"/>
<text text-anchor="middle" x="3829" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3829" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3829" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- k_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge29" class="edge">
<title>k_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3829,-1029.18C3829,-1005.28 3829,-964.63 3829,-935.3"/>
<polygon fill="black" stroke="black" points="3832.5,-935.06 3829,-925.06 3825.5,-935.06 3832.5,-935.06"/>
</g>
<!-- v_proj_2_1 -->
<g id="node41" class="node">
<title>v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3722,-1070.47 3544,-1070.47 3544,-1029.47 3722,-1029.47 3722,-1070.47"/>
<text text-anchor="middle" x="3633" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3633" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3633" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- v_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge30" class="edge">
<title>v_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M3659.03,-1029.18C3691.98,-1004.13 3749.14,-960.67 3787.99,-931.14"/>
<polygon fill="black" stroke="black" points="3790.14,-933.9 3795.99,-925.06 3785.91,-928.33 3790.14,-933.9"/>
</g>
<!-- attn_2_1&#45;&gt;agg_dim_2 -->
<g id="edge58" class="edge">
<title>attn_2_1&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M3829,-872.65C3829,-858.21 3829,-839.43 3829,-821.36"/>
<polygon fill="black" stroke="black" points="3832.5,-821.13 3829,-811.13 3825.5,-821.13 3832.5,-821.13"/>
</g>
<!-- q_proj_2_2 -->
<g id="node43" class="node">
<title>q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3526,-1070.47 3348,-1070.47 3348,-1029.47 3526,-1029.47 3526,-1070.47"/>
<text text-anchor="middle" x="3437" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3437" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3437" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- attn_2_2 -->
<g id="node46" class="node">
<title>attn_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3410.5,-924.97 3267.5,-924.97 3267.5,-872.97 3410.5,-872.97 3410.5,-924.97"/>
<text text-anchor="middle" x="3339" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="3339" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="3339" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="3339" y="-879.97" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge31" class="edge">
<title>q_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3423.99,-1029.18C3407.99,-1004.86 3380.59,-963.2 3361.23,-933.77"/>
<polygon fill="black" stroke="black" points="3363.93,-931.49 3355.51,-925.06 3358.08,-935.34 3363.93,-931.49"/>
</g>
<!-- k_proj_2_2 -->
<g id="node44" class="node">
<title>k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3330,-1070.47 3152,-1070.47 3152,-1029.47 3330,-1029.47 3330,-1070.47"/>
<text text-anchor="middle" x="3241" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3241" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3241" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- k_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge32" class="edge">
<title>k_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3254.01,-1029.18C3270.01,-1004.86 3297.41,-963.2 3316.77,-933.77"/>
<polygon fill="black" stroke="black" points="3319.92,-935.34 3322.49,-925.06 3314.07,-931.49 3319.92,-935.34"/>
</g>
<!-- v_proj_2_2 -->
<g id="node45" class="node">
<title>v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3134,-1070.47 2956,-1070.47 2956,-1029.47 3134,-1029.47 3134,-1070.47"/>
<text text-anchor="middle" x="3045" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3045" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3045" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- v_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge33" class="edge">
<title>v_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M3075.83,-1029.2C3094.88,-1017.29 3120,-1002.12 3143,-989.97 3184.5,-968.03 3232.37,-945.99 3270.4,-929.22"/>
<polygon fill="black" stroke="black" points="3272.1,-932.29 3279.85,-925.07 3269.29,-925.88 3272.1,-932.29"/>
</g>
<!-- attn_2_2&#45;&gt;agg_dim_2 -->
<g id="edge59" class="edge">
<title>attn_2_2&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M3410.51,-877.83C3494.02,-854.31 3632.75,-815.24 3727.41,-788.58"/>
<polygon fill="black" stroke="black" points="3728.61,-791.87 3737.29,-785.79 3726.71,-785.14 3728.61,-791.87"/>
</g>
<!-- q_proj_2_3 -->
<g id="node47" class="node">
<title>q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="2938,-1070.47 2760,-1070.47 2760,-1029.47 2938,-1029.47 2938,-1070.47"/>
<text text-anchor="middle" x="2849" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2849" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2849" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- attn_2_3 -->
<g id="node50" class="node">
<title>attn_2_3</title>
<polygon fill="lightgreen" stroke="black" points="2822.5,-924.97 2679.5,-924.97 2679.5,-872.97 2822.5,-872.97 2822.5,-924.97"/>
<text text-anchor="middle" x="2751" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="2751" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="2751" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="2751" y="-879.97" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge34" class="edge">
<title>q_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M2835.99,-1029.18C2819.99,-1004.86 2792.59,-963.2 2773.23,-933.77"/>
<polygon fill="black" stroke="black" points="2775.93,-931.49 2767.51,-925.06 2770.08,-935.34 2775.93,-931.49"/>
</g>
<!-- k_proj_2_3 -->
<g id="node48" class="node">
<title>k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="2742,-1070.47 2564,-1070.47 2564,-1029.47 2742,-1029.47 2742,-1070.47"/>
<text text-anchor="middle" x="2653" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2653" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2653" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- k_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge35" class="edge">
<title>k_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M2666.01,-1029.18C2682.01,-1004.86 2709.41,-963.2 2728.77,-933.77"/>
<polygon fill="black" stroke="black" points="2731.92,-935.34 2734.49,-925.06 2726.07,-931.49 2731.92,-935.34"/>
</g>
<!-- v_proj_2_3 -->
<g id="node49" class="node">
<title>v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="2546,-1070.47 2368,-1070.47 2368,-1029.47 2546,-1029.47 2546,-1070.47"/>
<text text-anchor="middle" x="2457" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="2457" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2457" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- v_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge36" class="edge">
<title>v_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M2487.83,-1029.2C2506.88,-1017.29 2532,-1002.12 2555,-989.97 2596.5,-968.03 2644.37,-945.99 2682.4,-929.22"/>
<polygon fill="black" stroke="black" points="2684.1,-932.29 2691.85,-925.07 2681.29,-925.88 2684.1,-932.29"/>
</g>
<!-- attn_2_3&#45;&gt;agg_dim_2 -->
<g id="edge60" class="edge">
<title>attn_2_3&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M2822.57,-888.8C3007.12,-865.18 3500.1,-802.07 3720.23,-773.89"/>
<polygon fill="black" stroke="black" points="3720.71,-777.36 3730.18,-772.62 3719.82,-770.41 3720.71,-777.36"/>
</g>
<!-- q_proj_3_0 -->
<g id="node51" class="node">
<title>q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2350,-1070.47 2172,-1070.47 2172,-1029.47 2350,-1029.47 2350,-1070.47"/>
<text text-anchor="middle" x="2261" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2261" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2261" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- attn_3_0 -->
<g id="node54" class="node">
<title>attn_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2038.5,-924.97 1895.5,-924.97 1895.5,-872.97 2038.5,-872.97 2038.5,-924.97"/>
<text text-anchor="middle" x="1967" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1967" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="1967" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="1967" y="-879.97" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge37" class="edge">
<title>q_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M2230.17,-1029.2C2211.12,-1017.29 2186,-1002.12 2163,-989.97 2121.5,-968.03 2073.63,-945.99 2035.6,-929.22"/>
<polygon fill="black" stroke="black" points="2036.71,-925.88 2026.15,-925.07 2033.9,-932.29 2036.71,-925.88"/>
</g>
<!-- k_proj_3_0 -->
<g id="node52" class="node">
<title>k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="2154,-1070.47 1976,-1070.47 1976,-1029.47 2154,-1029.47 2154,-1070.47"/>
<text text-anchor="middle" x="2065" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2065" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2065" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- k_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge38" class="edge">
<title>k_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M2051.99,-1029.18C2035.99,-1004.86 2008.59,-963.2 1989.23,-933.77"/>
<polygon fill="black" stroke="black" points="1991.93,-931.49 1983.51,-925.06 1986.08,-935.34 1991.93,-931.49"/>
</g>
<!-- v_proj_3_0 -->
<g id="node53" class="node">
<title>v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="1958,-1070.47 1780,-1070.47 1780,-1029.47 1958,-1029.47 1958,-1070.47"/>
<text text-anchor="middle" x="1869" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1869" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1869" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- v_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge39" class="edge">
<title>v_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M1882.01,-1029.18C1898.01,-1004.86 1925.41,-963.2 1944.77,-933.77"/>
<polygon fill="black" stroke="black" points="1947.92,-935.34 1950.49,-925.06 1942.07,-931.49 1947.92,-935.34"/>
</g>
<!-- agg_dim_3 -->
<g id="node70" class="node">
<title>agg_dim_3</title>
<polygon fill="lightcoral" stroke="black" points="1609.91,-810.97 1398.48,-810.97 1344.09,-706.97 1555.52,-706.97 1609.91,-810.97"/>
<text text-anchor="middle" x="1477" y="-772.97" font-family="Arial" font-size="10.00">Concat Dimension Slices</text>
<text text-anchor="middle" x="1477" y="-761.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="1477" y="-750.97" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="1477" y="-739.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_0&#45;&gt;agg_dim_3 -->
<g id="edge61" class="edge">
<title>attn_3_0&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M1895.49,-877.83C1821.22,-856.91 1703.26,-823.69 1611.48,-797.84"/>
<polygon fill="black" stroke="black" points="1612.41,-794.47 1601.84,-795.12 1610.52,-801.2 1612.41,-794.47"/>
</g>
<!-- q_proj_3_1 -->
<g id="node55" class="node">
<title>q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1762,-1070.47 1584,-1070.47 1584,-1029.47 1762,-1029.47 1762,-1070.47"/>
<text text-anchor="middle" x="1673" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1673" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1673" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- attn_3_1 -->
<g id="node58" class="node">
<title>attn_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1548.5,-924.97 1405.5,-924.97 1405.5,-872.97 1548.5,-872.97 1548.5,-924.97"/>
<text text-anchor="middle" x="1477" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="1477" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="1477" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="1477" y="-879.97" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge40" class="edge">
<title>q_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M1646.97,-1029.18C1614.02,-1004.13 1556.86,-960.67 1518.01,-931.14"/>
<polygon fill="black" stroke="black" points="1520.09,-928.33 1510.01,-925.06 1515.86,-933.9 1520.09,-928.33"/>
</g>
<!-- k_proj_3_1 -->
<g id="node56" class="node">
<title>k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1566,-1070.47 1388,-1070.47 1388,-1029.47 1566,-1029.47 1566,-1070.47"/>
<text text-anchor="middle" x="1477" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="1477" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1477" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- k_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge41" class="edge">
<title>k_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M1477,-1029.18C1477,-1005.28 1477,-964.63 1477,-935.3"/>
<polygon fill="black" stroke="black" points="1480.5,-935.06 1477,-925.06 1473.5,-935.06 1480.5,-935.06"/>
</g>
<!-- v_proj_3_1 -->
<g id="node57" class="node">
<title>v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="1370,-1070.47 1192,-1070.47 1192,-1029.47 1370,-1029.47 1370,-1070.47"/>
<text text-anchor="middle" x="1281" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1281" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1281" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- v_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge42" class="edge">
<title>v_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M1307.03,-1029.18C1339.98,-1004.13 1397.14,-960.67 1435.99,-931.14"/>
<polygon fill="black" stroke="black" points="1438.14,-933.9 1443.99,-925.06 1433.91,-928.33 1438.14,-933.9"/>
</g>
<!-- attn_3_1&#45;&gt;agg_dim_3 -->
<g id="edge62" class="edge">
<title>attn_3_1&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M1477,-872.65C1477,-858.21 1477,-839.43 1477,-821.36"/>
<polygon fill="black" stroke="black" points="1480.5,-821.13 1477,-811.13 1473.5,-821.13 1480.5,-821.13"/>
</g>
<!-- q_proj_3_2 -->
<g id="node59" class="node">
<title>q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="1174,-1070.47 996,-1070.47 996,-1029.47 1174,-1029.47 1174,-1070.47"/>
<text text-anchor="middle" x="1085" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1085" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1085" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- attn_3_2 -->
<g id="node62" class="node">
<title>attn_3_2</title>
<polygon fill="lightgreen" stroke="black" points="1058.5,-924.97 915.5,-924.97 915.5,-872.97 1058.5,-872.97 1058.5,-924.97"/>
<text text-anchor="middle" x="987" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="987" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="987" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="987" y="-879.97" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge43" class="edge">
<title>q_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M1071.99,-1029.18C1055.99,-1004.86 1028.59,-963.2 1009.23,-933.77"/>
<polygon fill="black" stroke="black" points="1011.93,-931.49 1003.51,-925.06 1006.08,-935.34 1011.93,-931.49"/>
</g>
<!-- k_proj_3_2 -->
<g id="node60" class="node">
<title>k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="978,-1070.47 800,-1070.47 800,-1029.47 978,-1029.47 978,-1070.47"/>
<text text-anchor="middle" x="889" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="889" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="889" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- k_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge44" class="edge">
<title>k_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M902.01,-1029.18C918.01,-1004.86 945.41,-963.2 964.77,-933.77"/>
<polygon fill="black" stroke="black" points="967.92,-935.34 970.49,-925.06 962.07,-931.49 967.92,-935.34"/>
</g>
<!-- v_proj_3_2 -->
<g id="node61" class="node">
<title>v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="782,-1070.47 604,-1070.47 604,-1029.47 782,-1029.47 782,-1070.47"/>
<text text-anchor="middle" x="693" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="693" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="693" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- v_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge45" class="edge">
<title>v_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M723.83,-1029.2C742.88,-1017.29 768,-1002.12 791,-989.97 832.5,-968.03 880.37,-945.99 918.4,-929.22"/>
<polygon fill="black" stroke="black" points="920.1,-932.29 927.85,-925.07 917.29,-925.88 920.1,-932.29"/>
</g>
<!-- attn_3_2&#45;&gt;agg_dim_3 -->
<g id="edge63" class="edge">
<title>attn_3_2&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M1058.51,-877.83C1142.02,-854.31 1280.75,-815.24 1375.41,-788.58"/>
<polygon fill="black" stroke="black" points="1376.61,-791.87 1385.29,-785.79 1374.71,-785.14 1376.61,-791.87"/>
</g>
<!-- q_proj_3_3 -->
<g id="node63" class="node">
<title>q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="586,-1070.47 408,-1070.47 408,-1029.47 586,-1029.47 586,-1070.47"/>
<text text-anchor="middle" x="497" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="497" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="497" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- attn_3_3 -->
<g id="node66" class="node">
<title>attn_3_3</title>
<polygon fill="lightgreen" stroke="black" points="470.5,-924.97 327.5,-924.97 327.5,-872.97 470.5,-872.97 470.5,-924.97"/>
<text text-anchor="middle" x="399" y="-912.97" font-family="Arial" font-size="10.00">Scaled Dot&#45;Product Attention</text>
<text text-anchor="middle" x="399" y="-901.97" font-family="Arial" font-size="10.00">Q,K,V: [B=1024, L, 512]</text>
<text text-anchor="middle" x="399" y="-890.97" font-family="Arial" font-size="10.00">→ [B=1024, L, 512]</text>
<text text-anchor="middle" x="399" y="-879.97" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- q_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge46" class="edge">
<title>q_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M483.99,-1029.18C467.99,-1004.86 440.59,-963.2 421.23,-933.77"/>
<polygon fill="black" stroke="black" points="423.93,-931.49 415.51,-925.06 418.08,-935.34 423.93,-931.49"/>
</g>
<!-- k_proj_3_3 -->
<g id="node64" class="node">
<title>k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="390,-1070.47 212,-1070.47 212,-1029.47 390,-1029.47 390,-1070.47"/>
<text text-anchor="middle" x="301" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="301" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="301" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- k_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge47" class="edge">
<title>k_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M314.01,-1029.18C330.01,-1004.86 357.41,-963.2 376.77,-933.77"/>
<polygon fill="black" stroke="black" points="379.92,-935.34 382.49,-925.06 374.07,-931.49 379.92,-935.34"/>
</g>
<!-- v_proj_3_3 -->
<g id="node65" class="node">
<title>v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="194,-1070.47 16,-1070.47 16,-1029.47 194,-1029.47 194,-1070.47"/>
<text text-anchor="middle" x="105" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="105" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="105" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- v_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge48" class="edge">
<title>v_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M135.83,-1029.2C154.88,-1017.29 180,-1002.12 203,-989.97 244.5,-968.03 292.37,-945.99 330.4,-929.22"/>
<polygon fill="black" stroke="black" points="332.1,-932.29 339.85,-925.07 329.29,-925.88 332.1,-932.29"/>
</g>
<!-- attn_3_3&#45;&gt;agg_dim_3 -->
<g id="edge64" class="edge">
<title>attn_3_3&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M470.57,-888.8C655.12,-865.18 1148.1,-802.07 1368.23,-773.89"/>
<polygon fill="black" stroke="black" points="1368.71,-777.36 1378.18,-772.62 1367.82,-770.41 1368.71,-777.36"/>
</g>
<!-- agg_heads -->
<g id="node71" class="node">
<title>agg_heads</title>
<polygon fill="lightcoral" stroke="black" points="6000.01,-670.97 5820.24,-670.97 5773.99,-588.97 5953.76,-588.97 6000.01,-670.97"/>
<text text-anchor="middle" x="5887" y="-638.47" font-family="Arial" font-size="10.00">Concat Head Groups</text>
<text text-anchor="middle" x="5887" y="-627.47" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="5887" y="-616.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_0&#45;&gt;agg_heads -->
<g id="edge65" class="edge">
<title>agg_dim_0&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M7835.08,-751.18C7476.08,-729.03 6341.04,-658.98 5990.89,-637.38"/>
<polygon fill="black" stroke="black" points="5990.96,-633.87 5980.76,-636.75 5990.53,-640.86 5990.96,-633.87"/>
</g>
<!-- agg_dim_1&#45;&gt;agg_heads -->
<g id="edge66" class="edge">
<title>agg_dim_1&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M5887,-706.68C5887,-698.26 5887,-689.54 5887,-681.15"/>
<polygon fill="black" stroke="black" points="5890.5,-681.12 5887,-671.12 5883.5,-681.12 5890.5,-681.12"/>
</g>
<!-- agg_dim_2&#45;&gt;agg_heads -->
<g id="edge67" class="edge">
<title>agg_dim_2&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M3931.06,-751.67C4283.45,-729.92 5446.27,-658.16 5790.3,-636.93"/>
<polygon fill="black" stroke="black" points="5790.72,-640.41 5800.49,-636.3 5790.29,-633.43 5790.72,-640.41"/>
</g>
<!-- agg_dim_3&#45;&gt;agg_heads -->
<g id="edge68" class="edge">
<title>agg_dim_3&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M1580.86,-754.97C2181.42,-737.68 5203.07,-650.66 5788.64,-633.8"/>
<polygon fill="black" stroke="black" points="5788.84,-637.29 5798.74,-633.51 5788.64,-630.3 5788.84,-637.29"/>
</g>
<!-- out_proj1 -->
<g id="node72" class="node">
<title>out_proj1</title>
<polygon fill="lightgreen" stroke="black" points="6901,-552.97 6713,-552.97 6713,-511.97 6901,-511.97 6901,-552.97"/>
<text text-anchor="middle" x="6807" y="-540.97" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="6807" y="-529.97" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="6807" y="-518.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads&#45;&gt;out_proj1 -->
<g id="edge73" class="edge">
<title>agg_heads&#45;&gt;out_proj1</title>
<path fill="none" stroke="black" d="M5971.49,-620.19C6140.29,-602.67 6518.78,-563.38 6702.7,-544.29"/>
<polygon fill="black" stroke="black" points="6703.07,-547.77 6712.66,-543.26 6702.35,-540.81 6703.07,-547.77"/>
</g>
<!-- out_proj1&#45;&gt;res1 -->
<g id="edge74" class="edge">
<title>out_proj1&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M6901.15,-527.2C7203.88,-513.47 8153.37,-470.41 8510.42,-454.21"/>
<polygon fill="black" stroke="black" points="8510.72,-457.7 8520.55,-453.75 8510.41,-450.71 8510.72,-457.7"/>
</g>
<!-- ln2 -->
<g id="node74" class="node">
<title>ln2</title>
<polygon fill="lightgreen" stroke="black" points="8685,-381.98 8497,-381.98 8497,-340.98 8685,-340.98 8685,-381.98"/>
<text text-anchor="middle" x="8591" y="-369.98" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8591" y="-358.98" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8591" y="-347.98" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;ln2 -->
<g id="edge76" class="edge">
<title>res1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M8629.02,-418.17C8622.95,-409.28 8616.22,-399.43 8610.14,-390.52"/>
<polygon fill="black" stroke="black" points="8612.85,-388.28 8604.32,-381.99 8607.07,-392.22 8612.85,-388.28"/>
</g>
<!-- res2 -->
<g id="node78" class="node">
<title>res2</title>
<ellipse fill="lightgreen" stroke="black" cx="8648" cy="-44.99" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="8648" y="-53.49" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8648" y="-42.49" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8648" y="-31.49" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge81" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M8672.31,-418.44C8680.49,-407.74 8688.84,-394.95 8694,-381.98 8710,-341.77 8707,-328.76 8707,-285.48 8707,-285.48 8707,-285.48 8707,-206.48 8707,-163.26 8710.97,-150.14 8695,-109.98 8691.1,-100.18 8685.33,-90.52 8679.16,-81.79"/>
<polygon fill="black" stroke="black" points="8681.94,-79.67 8673.17,-73.73 8676.33,-83.85 8681.94,-79.67"/>
</g>
<!-- mlp_fc1 -->
<g id="node75" class="node">
<title>mlp_fc1</title>
<polygon fill="lightgreen" stroke="black" points="8686,-304.98 8492,-304.98 8492,-263.98 8686,-263.98 8686,-304.98"/>
<text text-anchor="middle" x="8589" y="-292.98" font-family="Arial" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="8589" y="-281.98" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="8589" y="-270.98" font-family="Arial" font-size="10.00">Column Parallel</text>
</g>
<!-- ln2&#45;&gt;mlp_fc1 -->
<g id="edge77" class="edge">
<title>ln2&#45;&gt;mlp_fc1</title>
<path fill="none" stroke="black" d="M8590.47,-340.78C8590.27,-332.94 8590.02,-323.75 8589.79,-315.14"/>
<polygon fill="black" stroke="black" points="8593.29,-314.96 8589.52,-305.06 8586.29,-315.15 8593.29,-314.96"/>
</g>
<!-- mlp_gelu -->
<g id="node76" class="node">
<title>mlp_gelu</title>
<polygon fill="lightgreen" stroke="black" points="8687.5,-227.98 8488.5,-227.98 8488.5,-186.98 8687.5,-186.98 8687.5,-227.98"/>
<text text-anchor="middle" x="8588" y="-215.98" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="8588" y="-204.98" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="8588" y="-193.98" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc1&#45;&gt;mlp_gelu -->
<g id="edge78" class="edge">
<title>mlp_fc1&#45;&gt;mlp_gelu</title>
<path fill="none" stroke="black" d="M8588.74,-263.78C8588.63,-255.94 8588.51,-246.75 8588.4,-238.14"/>
<polygon fill="black" stroke="black" points="8591.89,-238.01 8588.26,-228.06 8584.89,-238.1 8591.89,-238.01"/>
</g>
<!-- mlp_fc2 -->
<g id="node77" class="node">
<title>mlp_fc2</title>
<polygon fill="lightgreen" stroke="black" points="8686,-150.98 8492,-150.98 8492,-109.98 8686,-109.98 8686,-150.98"/>
<text text-anchor="middle" x="8589" y="-138.98" font-family="Arial" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="8589" y="-127.98" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8589" y="-116.98" font-family="Arial" font-size="10.00">Row Parallel</text>
</g>
<!-- mlp_gelu&#45;&gt;mlp_fc2 -->
<g id="edge79" class="edge">
<title>mlp_gelu&#45;&gt;mlp_fc2</title>
<path fill="none" stroke="black" d="M8588.26,-186.78C8588.37,-178.94 8588.49,-169.75 8588.6,-161.14"/>
<polygon fill="black" stroke="black" points="8592.11,-161.1 8588.74,-151.06 8585.11,-161.01 8592.11,-161.1"/>
</g>
<!-- mlp_fc2&#45;&gt;res2 -->
<g id="edge80" class="edge">
<title>mlp_fc2&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M8602.98,-109.7C8608.83,-101.42 8615.82,-91.53 8622.53,-82.04"/>
<polygon fill="black" stroke="black" points="8625.4,-84.04 8628.31,-73.85 8619.68,-80 8625.4,-84.04"/>
</g>
<!-- ln2_1 -->
<g id="node79" class="node">
<title>ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="55422,-1221.47 55234,-1221.47 55234,-1180.47 55422,-1180.47 55422,-1221.47"/>
<text text-anchor="middle" x="55328" y="-1209.47" font-family="Arial" font-size="10.00">LayerNorm 2.1</text>
<text text-anchor="middle" x="55328" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="55328" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- q_proj_2_0_0 -->
<g id="node80" class="node">
<title>q_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="55216,-1221.47 55038,-1221.47 55038,-1180.47 55216,-1180.47 55216,-1221.47"/>
<text text-anchor="middle" x="55127" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="55127" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="55127" y="-1187.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- k_proj_2_0_0 -->
<g id="node81" class="node">
<title>k_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="55020,-1221.47 54842,-1221.47 54842,-1180.47 55020,-1180.47 55020,-1221.47"/>
<text text-anchor="middle" x="54931" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="54931" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="54931" y="-1187.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- v_proj_2_0_0 -->
<g id="node82" class="node">
<title>v_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="54824,-1221.47 54646,-1221.47 54646,-1180.47 54824,-1180.47 54824,-1221.47"/>
<text text-anchor="middle" x="54735" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="54735" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="54735" y="-1187.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- attn_2_0_0 -->
<g id="node83" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="54628,-1221.47 54450,-1221.47 54450,-1180.47 54628,-1180.47 54628,-1221.47"/>
<text text-anchor="middle" x="54539" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="54539" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="54539" y="-1187.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_2_0_1 -->
<g id="node84" class="node">
<title>q_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="54432,-1221.47 54254,-1221.47 54254,-1180.47 54432,-1180.47 54432,-1221.47"/>
<text text-anchor="middle" x="54343" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="54343" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="54343" y="-1187.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- k_proj_2_0_1 -->
<g id="node85" class="node">
<title>k_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="54236,-1221.47 54058,-1221.47 54058,-1180.47 54236,-1180.47 54236,-1221.47"/>
<text text-anchor="middle" x="54147" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="54147" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="54147" y="-1187.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- v_proj_2_0_1 -->
<g id="node86" class="node">
<title>v_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="54040,-1221.47 53862,-1221.47 53862,-1180.47 54040,-1180.47 54040,-1221.47"/>
<text text-anchor="middle" x="53951" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="53951" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="53951" y="-1187.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- attn_2_0_1 -->
<g id="node87" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="53844,-1221.47 53666,-1221.47 53666,-1180.47 53844,-1180.47 53844,-1221.47"/>
<text text-anchor="middle" x="53755" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="53755" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="53755" y="-1187.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_2_0_2 -->
<g id="node88" class="node">
<title>q_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="53648,-1221.47 53470,-1221.47 53470,-1180.47 53648,-1180.47 53648,-1221.47"/>
<text text-anchor="middle" x="53559" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="53559" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="53559" y="-1187.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- k_proj_2_0_2 -->
<g id="node89" class="node">
<title>k_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="53452,-1221.47 53274,-1221.47 53274,-1180.47 53452,-1180.47 53452,-1221.47"/>
<text text-anchor="middle" x="53363" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="53363" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="53363" y="-1187.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- v_proj_2_0_2 -->
<g id="node90" class="node">
<title>v_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="53256,-1221.47 53078,-1221.47 53078,-1180.47 53256,-1180.47 53256,-1221.47"/>
<text text-anchor="middle" x="53167" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="53167" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="53167" y="-1187.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- attn_2_0_2 -->
<g id="node91" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="53060,-1221.47 52882,-1221.47 52882,-1180.47 53060,-1180.47 53060,-1221.47"/>
<text text-anchor="middle" x="52971" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="52971" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="52971" y="-1187.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_2_0_3 -->
<g id="node92" class="node">
<title>q_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="52864,-1221.47 52686,-1221.47 52686,-1180.47 52864,-1180.47 52864,-1221.47"/>
<text text-anchor="middle" x="52775" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="52775" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="52775" y="-1187.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- k_proj_2_0_3 -->
<g id="node93" class="node">
<title>k_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="52668,-1221.47 52490,-1221.47 52490,-1180.47 52668,-1180.47 52668,-1221.47"/>
<text text-anchor="middle" x="52579" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="52579" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="52579" y="-1187.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- v_proj_2_0_3 -->
<g id="node94" class="node">
<title>v_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="52472,-1221.47 52294,-1221.47 52294,-1180.47 52472,-1180.47 52472,-1221.47"/>
<text text-anchor="middle" x="52383" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="52383" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="52383" y="-1187.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- attn_2_0_3 -->
<g id="node95" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="52276,-1221.47 52098,-1221.47 52098,-1180.47 52276,-1180.47 52276,-1221.47"/>
<text text-anchor="middle" x="52187" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="52187" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="52187" y="-1187.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_2_1_0 -->
<g id="node96" class="node">
<title>q_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="52080,-1221.47 51902,-1221.47 51902,-1180.47 52080,-1180.47 52080,-1221.47"/>
<text text-anchor="middle" x="51991" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="51991" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51991" y="-1187.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- k_proj_2_1_0 -->
<g id="node97" class="node">
<title>k_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="51884,-1221.47 51706,-1221.47 51706,-1180.47 51884,-1180.47 51884,-1221.47"/>
<text text-anchor="middle" x="51795" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="51795" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51795" y="-1187.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- v_proj_2_1_0 -->
<g id="node98" class="node">
<title>v_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="51688,-1221.47 51510,-1221.47 51510,-1180.47 51688,-1180.47 51688,-1221.47"/>
<text text-anchor="middle" x="51599" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="51599" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51599" y="-1187.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- attn_2_1_0 -->
<g id="node99" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="51492,-1221.47 51314,-1221.47 51314,-1180.47 51492,-1180.47 51492,-1221.47"/>
<text text-anchor="middle" x="51403" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="51403" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51403" y="-1187.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_2_1_1 -->
<g id="node100" class="node">
<title>q_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="51296,-1221.47 51118,-1221.47 51118,-1180.47 51296,-1180.47 51296,-1221.47"/>
<text text-anchor="middle" x="51207" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="51207" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51207" y="-1187.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- k_proj_2_1_1 -->
<g id="node101" class="node">
<title>k_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="51100,-1221.47 50922,-1221.47 50922,-1180.47 51100,-1180.47 51100,-1221.47"/>
<text text-anchor="middle" x="51011" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="51011" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="51011" y="-1187.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- v_proj_2_1_1 -->
<g id="node102" class="node">
<title>v_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="50904,-1221.47 50726,-1221.47 50726,-1180.47 50904,-1180.47 50904,-1221.47"/>
<text text-anchor="middle" x="50815" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="50815" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="50815" y="-1187.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- attn_2_1_1 -->
<g id="node103" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="50708,-1221.47 50530,-1221.47 50530,-1180.47 50708,-1180.47 50708,-1221.47"/>
<text text-anchor="middle" x="50619" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="50619" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="50619" y="-1187.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_2_1_2 -->
<g id="node104" class="node">
<title>q_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="50512,-1221.47 50334,-1221.47 50334,-1180.47 50512,-1180.47 50512,-1221.47"/>
<text text-anchor="middle" x="50423" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="50423" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="50423" y="-1187.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- k_proj_2_1_2 -->
<g id="node105" class="node">
<title>k_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="50316,-1221.47 50138,-1221.47 50138,-1180.47 50316,-1180.47 50316,-1221.47"/>
<text text-anchor="middle" x="50227" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="50227" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="50227" y="-1187.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- v_proj_2_1_2 -->
<g id="node106" class="node">
<title>v_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="50120,-1221.47 49942,-1221.47 49942,-1180.47 50120,-1180.47 50120,-1221.47"/>
<text text-anchor="middle" x="50031" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="50031" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="50031" y="-1187.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- attn_2_1_2 -->
<g id="node107" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="49924,-1221.47 49746,-1221.47 49746,-1180.47 49924,-1180.47 49924,-1221.47"/>
<text text-anchor="middle" x="49835" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="49835" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="49835" y="-1187.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_2_1_3 -->
<g id="node108" class="node">
<title>q_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="49728,-1221.47 49550,-1221.47 49550,-1180.47 49728,-1180.47 49728,-1221.47"/>
<text text-anchor="middle" x="49639" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="49639" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="49639" y="-1187.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- k_proj_2_1_3 -->
<g id="node109" class="node">
<title>k_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="49532,-1221.47 49354,-1221.47 49354,-1180.47 49532,-1180.47 49532,-1221.47"/>
<text text-anchor="middle" x="49443" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="49443" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="49443" y="-1187.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- v_proj_2_1_3 -->
<g id="node110" class="node">
<title>v_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="49336,-1221.47 49158,-1221.47 49158,-1180.47 49336,-1180.47 49336,-1221.47"/>
<text text-anchor="middle" x="49247" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="49247" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="49247" y="-1187.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- attn_2_1_3 -->
<g id="node111" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="49140,-1221.47 48962,-1221.47 48962,-1180.47 49140,-1180.47 49140,-1221.47"/>
<text text-anchor="middle" x="49051" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="49051" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="49051" y="-1187.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_2_2_0 -->
<g id="node112" class="node">
<title>q_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="48944,-1221.47 48766,-1221.47 48766,-1180.47 48944,-1180.47 48944,-1221.47"/>
<text text-anchor="middle" x="48855" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="48855" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="48855" y="-1187.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- k_proj_2_2_0 -->
<g id="node113" class="node">
<title>k_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="48748,-1221.47 48570,-1221.47 48570,-1180.47 48748,-1180.47 48748,-1221.47"/>
<text text-anchor="middle" x="48659" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="48659" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="48659" y="-1187.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- v_proj_2_2_0 -->
<g id="node114" class="node">
<title>v_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="48552,-1221.47 48374,-1221.47 48374,-1180.47 48552,-1180.47 48552,-1221.47"/>
<text text-anchor="middle" x="48463" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="48463" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="48463" y="-1187.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- attn_2_2_0 -->
<g id="node115" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="48356,-1221.47 48178,-1221.47 48178,-1180.47 48356,-1180.47 48356,-1221.47"/>
<text text-anchor="middle" x="48267" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="48267" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="48267" y="-1187.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_2_2_1 -->
<g id="node116" class="node">
<title>q_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="48160,-1221.47 47982,-1221.47 47982,-1180.47 48160,-1180.47 48160,-1221.47"/>
<text text-anchor="middle" x="48071" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="48071" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="48071" y="-1187.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- k_proj_2_2_1 -->
<g id="node117" class="node">
<title>k_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="47964,-1221.47 47786,-1221.47 47786,-1180.47 47964,-1180.47 47964,-1221.47"/>
<text text-anchor="middle" x="47875" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="47875" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="47875" y="-1187.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- v_proj_2_2_1 -->
<g id="node118" class="node">
<title>v_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="47768,-1221.47 47590,-1221.47 47590,-1180.47 47768,-1180.47 47768,-1221.47"/>
<text text-anchor="middle" x="47679" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="47679" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="47679" y="-1187.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- attn_2_2_1 -->
<g id="node119" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="47572,-1221.47 47394,-1221.47 47394,-1180.47 47572,-1180.47 47572,-1221.47"/>
<text text-anchor="middle" x="47483" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="47483" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="47483" y="-1187.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_2_2_2 -->
<g id="node120" class="node">
<title>q_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="47376,-1221.47 47198,-1221.47 47198,-1180.47 47376,-1180.47 47376,-1221.47"/>
<text text-anchor="middle" x="47287" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="47287" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="47287" y="-1187.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- k_proj_2_2_2 -->
<g id="node121" class="node">
<title>k_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="47180,-1221.47 47002,-1221.47 47002,-1180.47 47180,-1180.47 47180,-1221.47"/>
<text text-anchor="middle" x="47091" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="47091" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="47091" y="-1187.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- v_proj_2_2_2 -->
<g id="node122" class="node">
<title>v_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="46984,-1221.47 46806,-1221.47 46806,-1180.47 46984,-1180.47 46984,-1221.47"/>
<text text-anchor="middle" x="46895" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="46895" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="46895" y="-1187.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- attn_2_2_2 -->
<g id="node123" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="46788,-1221.47 46610,-1221.47 46610,-1180.47 46788,-1180.47 46788,-1221.47"/>
<text text-anchor="middle" x="46699" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="46699" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="46699" y="-1187.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_2_2_3 -->
<g id="node124" class="node">
<title>q_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="46592,-1221.47 46414,-1221.47 46414,-1180.47 46592,-1180.47 46592,-1221.47"/>
<text text-anchor="middle" x="46503" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="46503" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="46503" y="-1187.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- k_proj_2_2_3 -->
<g id="node125" class="node">
<title>k_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="46396,-1221.47 46218,-1221.47 46218,-1180.47 46396,-1180.47 46396,-1221.47"/>
<text text-anchor="middle" x="46307" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="46307" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="46307" y="-1187.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- v_proj_2_2_3 -->
<g id="node126" class="node">
<title>v_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="46200,-1221.47 46022,-1221.47 46022,-1180.47 46200,-1180.47 46200,-1221.47"/>
<text text-anchor="middle" x="46111" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="46111" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="46111" y="-1187.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- attn_2_2_3 -->
<g id="node127" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="46004,-1221.47 45826,-1221.47 45826,-1180.47 46004,-1180.47 46004,-1221.47"/>
<text text-anchor="middle" x="45915" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="45915" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="45915" y="-1187.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_2_3_0 -->
<g id="node128" class="node">
<title>q_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="45808,-1221.47 45630,-1221.47 45630,-1180.47 45808,-1180.47 45808,-1221.47"/>
<text text-anchor="middle" x="45719" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="45719" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="45719" y="-1187.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- k_proj_2_3_0 -->
<g id="node129" class="node">
<title>k_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="45612,-1221.47 45434,-1221.47 45434,-1180.47 45612,-1180.47 45612,-1221.47"/>
<text text-anchor="middle" x="45523" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="45523" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="45523" y="-1187.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- v_proj_2_3_0 -->
<g id="node130" class="node">
<title>v_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="45416,-1221.47 45238,-1221.47 45238,-1180.47 45416,-1180.47 45416,-1221.47"/>
<text text-anchor="middle" x="45327" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="45327" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="45327" y="-1187.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- attn_2_3_0 -->
<g id="node131" class="node">
<title>attn_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="45220,-1221.47 45042,-1221.47 45042,-1180.47 45220,-1180.47 45220,-1221.47"/>
<text text-anchor="middle" x="45131" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="45131" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="45131" y="-1187.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_2_3_1 -->
<g id="node132" class="node">
<title>q_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="45024,-1221.47 44846,-1221.47 44846,-1180.47 45024,-1180.47 45024,-1221.47"/>
<text text-anchor="middle" x="44935" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="44935" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="44935" y="-1187.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- k_proj_2_3_1 -->
<g id="node133" class="node">
<title>k_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="44828,-1221.47 44650,-1221.47 44650,-1180.47 44828,-1180.47 44828,-1221.47"/>
<text text-anchor="middle" x="44739" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="44739" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="44739" y="-1187.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- v_proj_2_3_1 -->
<g id="node134" class="node">
<title>v_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="44632,-1221.47 44454,-1221.47 44454,-1180.47 44632,-1180.47 44632,-1221.47"/>
<text text-anchor="middle" x="44543" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="44543" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="44543" y="-1187.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- attn_2_3_1 -->
<g id="node135" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="44436,-1221.47 44258,-1221.47 44258,-1180.47 44436,-1180.47 44436,-1221.47"/>
<text text-anchor="middle" x="44347" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="44347" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="44347" y="-1187.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_2_3_2 -->
<g id="node136" class="node">
<title>q_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="44240,-1221.47 44062,-1221.47 44062,-1180.47 44240,-1180.47 44240,-1221.47"/>
<text text-anchor="middle" x="44151" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="44151" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="44151" y="-1187.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- k_proj_2_3_2 -->
<g id="node137" class="node">
<title>k_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="44044,-1221.47 43866,-1221.47 43866,-1180.47 44044,-1180.47 44044,-1221.47"/>
<text text-anchor="middle" x="43955" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="43955" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="43955" y="-1187.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- v_proj_2_3_2 -->
<g id="node138" class="node">
<title>v_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="43848,-1221.47 43670,-1221.47 43670,-1180.47 43848,-1180.47 43848,-1221.47"/>
<text text-anchor="middle" x="43759" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="43759" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="43759" y="-1187.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- attn_2_3_2 -->
<g id="node139" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="43652,-1221.47 43474,-1221.47 43474,-1180.47 43652,-1180.47 43652,-1221.47"/>
<text text-anchor="middle" x="43563" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="43563" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="43563" y="-1187.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_2_3_3 -->
<g id="node140" class="node">
<title>q_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="43456,-1221.47 43278,-1221.47 43278,-1180.47 43456,-1180.47 43456,-1221.47"/>
<text text-anchor="middle" x="43367" y="-1209.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="43367" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="43367" y="-1187.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- k_proj_2_3_3 -->
<g id="node141" class="node">
<title>k_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="43260,-1221.47 43082,-1221.47 43082,-1180.47 43260,-1180.47 43260,-1221.47"/>
<text text-anchor="middle" x="43171" y="-1209.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="43171" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="43171" y="-1187.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- v_proj_2_3_3 -->
<g id="node142" class="node">
<title>v_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="43064,-1221.47 42886,-1221.47 42886,-1180.47 43064,-1180.47 43064,-1221.47"/>
<text text-anchor="middle" x="42975" y="-1209.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="42975" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="42975" y="-1187.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- attn_2_3_3 -->
<g id="node143" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="42868,-1221.47 42690,-1221.47 42690,-1180.47 42868,-1180.47 42868,-1221.47"/>
<text text-anchor="middle" x="42779" y="-1209.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="42779" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="42779" y="-1187.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_dim_2_0 -->
<g id="node144" class="node">
<title>agg_dim_2_0</title>
<polygon fill="lightcoral" stroke="black" points="42671.57,-1252.97 42502.04,-1252.97 42458.43,-1148.97 42627.96,-1148.97 42671.57,-1252.97"/>
<text text-anchor="middle" x="42565" y="-1214.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="42565" y="-1203.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="42565" y="-1192.97" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="42565" y="-1181.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_2_1 -->
<g id="node145" class="node">
<title>agg_dim_2_1</title>
<polygon fill="lightcoral" stroke="black" points="42439.57,-1252.97 42270.04,-1252.97 42226.43,-1148.97 42395.96,-1148.97 42439.57,-1252.97"/>
<text text-anchor="middle" x="42333" y="-1214.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="42333" y="-1203.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="42333" y="-1192.97" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="42333" y="-1181.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_2_2 -->
<g id="node146" class="node">
<title>agg_dim_2_2</title>
<polygon fill="lightcoral" stroke="black" points="42207.57,-1252.97 42038.04,-1252.97 41994.43,-1148.97 42163.96,-1148.97 42207.57,-1252.97"/>
<text text-anchor="middle" x="42101" y="-1214.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="42101" y="-1203.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="42101" y="-1192.97" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="42101" y="-1181.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_2_3 -->
<g id="node147" class="node">
<title>agg_dim_2_3</title>
<polygon fill="lightcoral" stroke="black" points="41975.57,-1252.97 41806.04,-1252.97 41762.43,-1148.97 41931.96,-1148.97 41975.57,-1252.97"/>
<text text-anchor="middle" x="41869" y="-1214.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="41869" y="-1203.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="41869" y="-1192.97" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="41869" y="-1181.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_2 -->
<g id="node148" class="node">
<title>agg_heads_2</title>
<polygon fill="lightcoral" stroke="black" points="41744.32,-1241.97 41602.23,-1241.97 41565.68,-1159.97 41707.77,-1159.97 41744.32,-1241.97"/>
<text text-anchor="middle" x="41655" y="-1209.47" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="41655" y="-1198.47" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="41655" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- out_proj2 -->
<g id="node149" class="node">
<title>out_proj2</title>
<polygon fill="lightgreen" stroke="black" points="41548,-1221.47 41360,-1221.47 41360,-1180.47 41548,-1180.47 41548,-1221.47"/>
<text text-anchor="middle" x="41454" y="-1209.47" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="41454" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="41454" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_1 -->
<g id="node150" class="node">
<title>res2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="41211" cy="-1200.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="41211" y="-1209.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="41211" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="41211" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln2_2 -->
<g id="node151" class="node">
<title>ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="41062,-1221.47 40874,-1221.47 40874,-1180.47 41062,-1180.47 41062,-1221.47"/>
<text text-anchor="middle" x="40968" y="-1209.47" font-family="Arial" font-size="10.00">LayerNorm 2.2</text>
<text text-anchor="middle" x="40968" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="40968" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc1_2 -->
<g id="node152" class="node">
<title>mlp_fc1_2</title>
<polygon fill="lightgreen" stroke="black" points="40856,-1221.47 40662,-1221.47 40662,-1180.47 40856,-1180.47 40856,-1221.47"/>
<text text-anchor="middle" x="40759" y="-1209.47" font-family="Arial" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="40759" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="40759" y="-1187.47" font-family="Arial" font-size="10.00">Column Parallel</text>
</g>
<!-- mlp_gelu_2 -->
<g id="node153" class="node">
<title>mlp_gelu_2</title>
<polygon fill="lightgreen" stroke="black" points="40643.5,-1221.47 40444.5,-1221.47 40444.5,-1180.47 40643.5,-1180.47 40643.5,-1221.47"/>
<text text-anchor="middle" x="40544" y="-1209.47" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="40544" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="40544" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc2_2 -->
<g id="node154" class="node">
<title>mlp_fc2_2</title>
<polygon fill="lightgreen" stroke="black" points="40426,-1221.47 40232,-1221.47 40232,-1180.47 40426,-1180.47 40426,-1221.47"/>
<text text-anchor="middle" x="40329" y="-1209.47" font-family="Arial" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="40329" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="40329" y="-1187.47" font-family="Arial" font-size="10.00">Row Parallel</text>
</g>
<!-- res2_2 -->
<g id="node155" class="node">
<title>res2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="40083" cy="-1200.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="40083" y="-1209.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="40083" y="-1198.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="40083" y="-1187.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln3_1 -->
<g id="node156" class="node">
<title>ln3_1</title>
<polygon fill="lightgreen" stroke="black" points="40177,-1070.47 39989,-1070.47 39989,-1029.47 40177,-1029.47 40177,-1070.47"/>
<text text-anchor="middle" x="40083" y="-1058.47" font-family="Arial" font-size="10.00">LayerNorm 3.1</text>
<text text-anchor="middle" x="40083" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="40083" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_2&#45;&gt;ln3_1 -->
<g id="edge83" class="edge">
<title>res2_2&#45;&gt;ln3_1</title>
<path fill="none" stroke="black" d="M40083,-1171.94C40083,-1146.01 40083,-1107.57 40083,-1081.01"/>
<polygon fill="black" stroke="black" points="40086.5,-1080.77 40083,-1070.77 40079.5,-1080.77 40086.5,-1080.77"/>
</g>
<!-- q_proj_3_0_0 -->
<g id="node157" class="node">
<title>q_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="39971,-1070.47 39793,-1070.47 39793,-1029.47 39971,-1029.47 39971,-1070.47"/>
<text text-anchor="middle" x="39882" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="39882" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="39882" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- k_proj_3_0_0 -->
<g id="node158" class="node">
<title>k_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="39775,-1070.47 39597,-1070.47 39597,-1029.47 39775,-1029.47 39775,-1070.47"/>
<text text-anchor="middle" x="39686" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="39686" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="39686" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- v_proj_3_0_0 -->
<g id="node159" class="node">
<title>v_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="39579,-1070.47 39401,-1070.47 39401,-1029.47 39579,-1029.47 39579,-1070.47"/>
<text text-anchor="middle" x="39490" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="39490" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="39490" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- attn_3_0_0 -->
<g id="node160" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="39383,-1070.47 39205,-1070.47 39205,-1029.47 39383,-1029.47 39383,-1070.47"/>
<text text-anchor="middle" x="39294" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="39294" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="39294" y="-1036.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_3_0_1 -->
<g id="node161" class="node">
<title>q_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="39187,-1070.47 39009,-1070.47 39009,-1029.47 39187,-1029.47 39187,-1070.47"/>
<text text-anchor="middle" x="39098" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="39098" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="39098" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- k_proj_3_0_1 -->
<g id="node162" class="node">
<title>k_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="38991,-1070.47 38813,-1070.47 38813,-1029.47 38991,-1029.47 38991,-1070.47"/>
<text text-anchor="middle" x="38902" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="38902" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="38902" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- v_proj_3_0_1 -->
<g id="node163" class="node">
<title>v_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="38795,-1070.47 38617,-1070.47 38617,-1029.47 38795,-1029.47 38795,-1070.47"/>
<text text-anchor="middle" x="38706" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="38706" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="38706" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- attn_3_0_1 -->
<g id="node164" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="38599,-1070.47 38421,-1070.47 38421,-1029.47 38599,-1029.47 38599,-1070.47"/>
<text text-anchor="middle" x="38510" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="38510" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="38510" y="-1036.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_3_0_2 -->
<g id="node165" class="node">
<title>q_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="38403,-1070.47 38225,-1070.47 38225,-1029.47 38403,-1029.47 38403,-1070.47"/>
<text text-anchor="middle" x="38314" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="38314" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="38314" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- k_proj_3_0_2 -->
<g id="node166" class="node">
<title>k_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="38207,-1070.47 38029,-1070.47 38029,-1029.47 38207,-1029.47 38207,-1070.47"/>
<text text-anchor="middle" x="38118" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="38118" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="38118" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- v_proj_3_0_2 -->
<g id="node167" class="node">
<title>v_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="38011,-1070.47 37833,-1070.47 37833,-1029.47 38011,-1029.47 38011,-1070.47"/>
<text text-anchor="middle" x="37922" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="37922" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="37922" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- attn_3_0_2 -->
<g id="node168" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="37815,-1070.47 37637,-1070.47 37637,-1029.47 37815,-1029.47 37815,-1070.47"/>
<text text-anchor="middle" x="37726" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="37726" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="37726" y="-1036.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_3_0_3 -->
<g id="node169" class="node">
<title>q_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="37619,-1070.47 37441,-1070.47 37441,-1029.47 37619,-1029.47 37619,-1070.47"/>
<text text-anchor="middle" x="37530" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="37530" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="37530" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- k_proj_3_0_3 -->
<g id="node170" class="node">
<title>k_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="37423,-1070.47 37245,-1070.47 37245,-1029.47 37423,-1029.47 37423,-1070.47"/>
<text text-anchor="middle" x="37334" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="37334" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="37334" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- v_proj_3_0_3 -->
<g id="node171" class="node">
<title>v_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="37227,-1070.47 37049,-1070.47 37049,-1029.47 37227,-1029.47 37227,-1070.47"/>
<text text-anchor="middle" x="37138" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="37138" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="37138" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- attn_3_0_3 -->
<g id="node172" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="37031,-1070.47 36853,-1070.47 36853,-1029.47 37031,-1029.47 37031,-1070.47"/>
<text text-anchor="middle" x="36942" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="36942" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="36942" y="-1036.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_3_1_0 -->
<g id="node173" class="node">
<title>q_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="36835,-1070.47 36657,-1070.47 36657,-1029.47 36835,-1029.47 36835,-1070.47"/>
<text text-anchor="middle" x="36746" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="36746" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="36746" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- k_proj_3_1_0 -->
<g id="node174" class="node">
<title>k_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="36639,-1070.47 36461,-1070.47 36461,-1029.47 36639,-1029.47 36639,-1070.47"/>
<text text-anchor="middle" x="36550" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="36550" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="36550" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- v_proj_3_1_0 -->
<g id="node175" class="node">
<title>v_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="36443,-1070.47 36265,-1070.47 36265,-1029.47 36443,-1029.47 36443,-1070.47"/>
<text text-anchor="middle" x="36354" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="36354" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="36354" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- attn_3_1_0 -->
<g id="node176" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="36247,-1070.47 36069,-1070.47 36069,-1029.47 36247,-1029.47 36247,-1070.47"/>
<text text-anchor="middle" x="36158" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="36158" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="36158" y="-1036.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_3_1_1 -->
<g id="node177" class="node">
<title>q_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="36051,-1070.47 35873,-1070.47 35873,-1029.47 36051,-1029.47 36051,-1070.47"/>
<text text-anchor="middle" x="35962" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="35962" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="35962" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- k_proj_3_1_1 -->
<g id="node178" class="node">
<title>k_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="35855,-1070.47 35677,-1070.47 35677,-1029.47 35855,-1029.47 35855,-1070.47"/>
<text text-anchor="middle" x="35766" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="35766" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="35766" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- v_proj_3_1_1 -->
<g id="node179" class="node">
<title>v_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="35659,-1070.47 35481,-1070.47 35481,-1029.47 35659,-1029.47 35659,-1070.47"/>
<text text-anchor="middle" x="35570" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="35570" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="35570" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- attn_3_1_1 -->
<g id="node180" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="35463,-1070.47 35285,-1070.47 35285,-1029.47 35463,-1029.47 35463,-1070.47"/>
<text text-anchor="middle" x="35374" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="35374" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="35374" y="-1036.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_3_1_2 -->
<g id="node181" class="node">
<title>q_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="35267,-1070.47 35089,-1070.47 35089,-1029.47 35267,-1029.47 35267,-1070.47"/>
<text text-anchor="middle" x="35178" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="35178" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="35178" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- k_proj_3_1_2 -->
<g id="node182" class="node">
<title>k_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="35071,-1070.47 34893,-1070.47 34893,-1029.47 35071,-1029.47 35071,-1070.47"/>
<text text-anchor="middle" x="34982" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="34982" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34982" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- v_proj_3_1_2 -->
<g id="node183" class="node">
<title>v_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="34875,-1070.47 34697,-1070.47 34697,-1029.47 34875,-1029.47 34875,-1070.47"/>
<text text-anchor="middle" x="34786" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="34786" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34786" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- attn_3_1_2 -->
<g id="node184" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="34679,-1070.47 34501,-1070.47 34501,-1029.47 34679,-1029.47 34679,-1070.47"/>
<text text-anchor="middle" x="34590" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="34590" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34590" y="-1036.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_3_1_3 -->
<g id="node185" class="node">
<title>q_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="34483,-1070.47 34305,-1070.47 34305,-1029.47 34483,-1029.47 34483,-1070.47"/>
<text text-anchor="middle" x="34394" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="34394" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34394" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- k_proj_3_1_3 -->
<g id="node186" class="node">
<title>k_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="34287,-1070.47 34109,-1070.47 34109,-1029.47 34287,-1029.47 34287,-1070.47"/>
<text text-anchor="middle" x="34198" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="34198" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34198" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- v_proj_3_1_3 -->
<g id="node187" class="node">
<title>v_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="34091,-1070.47 33913,-1070.47 33913,-1029.47 34091,-1029.47 34091,-1070.47"/>
<text text-anchor="middle" x="34002" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="34002" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="34002" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- attn_3_1_3 -->
<g id="node188" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="33895,-1070.47 33717,-1070.47 33717,-1029.47 33895,-1029.47 33895,-1070.47"/>
<text text-anchor="middle" x="33806" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="33806" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="33806" y="-1036.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_3_2_0 -->
<g id="node189" class="node">
<title>q_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="33699,-1070.47 33521,-1070.47 33521,-1029.47 33699,-1029.47 33699,-1070.47"/>
<text text-anchor="middle" x="33610" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="33610" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="33610" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- k_proj_3_2_0 -->
<g id="node190" class="node">
<title>k_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="33503,-1070.47 33325,-1070.47 33325,-1029.47 33503,-1029.47 33503,-1070.47"/>
<text text-anchor="middle" x="33414" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="33414" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="33414" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- v_proj_3_2_0 -->
<g id="node191" class="node">
<title>v_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="33307,-1070.47 33129,-1070.47 33129,-1029.47 33307,-1029.47 33307,-1070.47"/>
<text text-anchor="middle" x="33218" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="33218" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="33218" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- attn_3_2_0 -->
<g id="node192" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="33111,-1070.47 32933,-1070.47 32933,-1029.47 33111,-1029.47 33111,-1070.47"/>
<text text-anchor="middle" x="33022" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="33022" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="33022" y="-1036.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_3_2_1 -->
<g id="node193" class="node">
<title>q_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="32915,-1070.47 32737,-1070.47 32737,-1029.47 32915,-1029.47 32915,-1070.47"/>
<text text-anchor="middle" x="32826" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="32826" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="32826" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- k_proj_3_2_1 -->
<g id="node194" class="node">
<title>k_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="32719,-1070.47 32541,-1070.47 32541,-1029.47 32719,-1029.47 32719,-1070.47"/>
<text text-anchor="middle" x="32630" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="32630" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="32630" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- v_proj_3_2_1 -->
<g id="node195" class="node">
<title>v_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="32523,-1070.47 32345,-1070.47 32345,-1029.47 32523,-1029.47 32523,-1070.47"/>
<text text-anchor="middle" x="32434" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="32434" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="32434" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- attn_3_2_1 -->
<g id="node196" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="32327,-1070.47 32149,-1070.47 32149,-1029.47 32327,-1029.47 32327,-1070.47"/>
<text text-anchor="middle" x="32238" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="32238" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="32238" y="-1036.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_3_2_2 -->
<g id="node197" class="node">
<title>q_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="32131,-1070.47 31953,-1070.47 31953,-1029.47 32131,-1029.47 32131,-1070.47"/>
<text text-anchor="middle" x="32042" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="32042" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="32042" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- k_proj_3_2_2 -->
<g id="node198" class="node">
<title>k_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="31935,-1070.47 31757,-1070.47 31757,-1029.47 31935,-1029.47 31935,-1070.47"/>
<text text-anchor="middle" x="31846" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="31846" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="31846" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- v_proj_3_2_2 -->
<g id="node199" class="node">
<title>v_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="31739,-1070.47 31561,-1070.47 31561,-1029.47 31739,-1029.47 31739,-1070.47"/>
<text text-anchor="middle" x="31650" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="31650" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="31650" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- attn_3_2_2 -->
<g id="node200" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="31543,-1070.47 31365,-1070.47 31365,-1029.47 31543,-1029.47 31543,-1070.47"/>
<text text-anchor="middle" x="31454" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="31454" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="31454" y="-1036.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_3_2_3 -->
<g id="node201" class="node">
<title>q_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="31347,-1070.47 31169,-1070.47 31169,-1029.47 31347,-1029.47 31347,-1070.47"/>
<text text-anchor="middle" x="31258" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="31258" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="31258" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- k_proj_3_2_3 -->
<g id="node202" class="node">
<title>k_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="31151,-1070.47 30973,-1070.47 30973,-1029.47 31151,-1029.47 31151,-1070.47"/>
<text text-anchor="middle" x="31062" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="31062" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="31062" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- v_proj_3_2_3 -->
<g id="node203" class="node">
<title>v_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="30955,-1070.47 30777,-1070.47 30777,-1029.47 30955,-1029.47 30955,-1070.47"/>
<text text-anchor="middle" x="30866" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="30866" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="30866" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- attn_3_2_3 -->
<g id="node204" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="30759,-1070.47 30581,-1070.47 30581,-1029.47 30759,-1029.47 30759,-1070.47"/>
<text text-anchor="middle" x="30670" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="30670" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="30670" y="-1036.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_3_3_0 -->
<g id="node205" class="node">
<title>q_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="30563,-1070.47 30385,-1070.47 30385,-1029.47 30563,-1029.47 30563,-1070.47"/>
<text text-anchor="middle" x="30474" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="30474" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="30474" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- k_proj_3_3_0 -->
<g id="node206" class="node">
<title>k_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="30367,-1070.47 30189,-1070.47 30189,-1029.47 30367,-1029.47 30367,-1070.47"/>
<text text-anchor="middle" x="30278" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="30278" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="30278" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- v_proj_3_3_0 -->
<g id="node207" class="node">
<title>v_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="30171,-1070.47 29993,-1070.47 29993,-1029.47 30171,-1029.47 30171,-1070.47"/>
<text text-anchor="middle" x="30082" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="30082" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="30082" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- attn_3_3_0 -->
<g id="node208" class="node">
<title>attn_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="29975,-1070.47 29797,-1070.47 29797,-1029.47 29975,-1029.47 29975,-1070.47"/>
<text text-anchor="middle" x="29886" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="29886" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="29886" y="-1036.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_3_3_1 -->
<g id="node209" class="node">
<title>q_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="29779,-1070.47 29601,-1070.47 29601,-1029.47 29779,-1029.47 29779,-1070.47"/>
<text text-anchor="middle" x="29690" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="29690" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="29690" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- k_proj_3_3_1 -->
<g id="node210" class="node">
<title>k_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="29583,-1070.47 29405,-1070.47 29405,-1029.47 29583,-1029.47 29583,-1070.47"/>
<text text-anchor="middle" x="29494" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="29494" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="29494" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- v_proj_3_3_1 -->
<g id="node211" class="node">
<title>v_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="29387,-1070.47 29209,-1070.47 29209,-1029.47 29387,-1029.47 29387,-1070.47"/>
<text text-anchor="middle" x="29298" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="29298" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="29298" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- attn_3_3_1 -->
<g id="node212" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="29191,-1070.47 29013,-1070.47 29013,-1029.47 29191,-1029.47 29191,-1070.47"/>
<text text-anchor="middle" x="29102" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="29102" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="29102" y="-1036.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_3_3_2 -->
<g id="node213" class="node">
<title>q_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="28995,-1070.47 28817,-1070.47 28817,-1029.47 28995,-1029.47 28995,-1070.47"/>
<text text-anchor="middle" x="28906" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="28906" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="28906" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- k_proj_3_3_2 -->
<g id="node214" class="node">
<title>k_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="28799,-1070.47 28621,-1070.47 28621,-1029.47 28799,-1029.47 28799,-1070.47"/>
<text text-anchor="middle" x="28710" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="28710" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="28710" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- v_proj_3_3_2 -->
<g id="node215" class="node">
<title>v_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="28603,-1070.47 28425,-1070.47 28425,-1029.47 28603,-1029.47 28603,-1070.47"/>
<text text-anchor="middle" x="28514" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="28514" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="28514" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- attn_3_3_2 -->
<g id="node216" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="28407,-1070.47 28229,-1070.47 28229,-1029.47 28407,-1029.47 28407,-1070.47"/>
<text text-anchor="middle" x="28318" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="28318" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="28318" y="-1036.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_3_3_3 -->
<g id="node217" class="node">
<title>q_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="28211,-1070.47 28033,-1070.47 28033,-1029.47 28211,-1029.47 28211,-1070.47"/>
<text text-anchor="middle" x="28122" y="-1058.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="28122" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="28122" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- k_proj_3_3_3 -->
<g id="node218" class="node">
<title>k_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="28015,-1070.47 27837,-1070.47 27837,-1029.47 28015,-1029.47 28015,-1070.47"/>
<text text-anchor="middle" x="27926" y="-1058.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="27926" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="27926" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- v_proj_3_3_3 -->
<g id="node219" class="node">
<title>v_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="27819,-1070.47 27641,-1070.47 27641,-1029.47 27819,-1029.47 27819,-1070.47"/>
<text text-anchor="middle" x="27730" y="-1058.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="27730" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="27730" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- attn_3_3_3 -->
<g id="node220" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="27623,-1070.47 27445,-1070.47 27445,-1029.47 27623,-1029.47 27623,-1070.47"/>
<text text-anchor="middle" x="27534" y="-1058.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="27534" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="27534" y="-1036.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_dim_3_0 -->
<g id="node221" class="node">
<title>agg_dim_3_0</title>
<polygon fill="lightcoral" stroke="black" points="27426.57,-1101.97 27257.04,-1101.97 27213.43,-997.97 27382.96,-997.97 27426.57,-1101.97"/>
<text text-anchor="middle" x="27320" y="-1063.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="27320" y="-1052.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="27320" y="-1041.97" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="27320" y="-1030.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_3_1 -->
<g id="node222" class="node">
<title>agg_dim_3_1</title>
<polygon fill="lightcoral" stroke="black" points="27194.57,-1101.97 27025.04,-1101.97 26981.43,-997.97 27150.96,-997.97 27194.57,-1101.97"/>
<text text-anchor="middle" x="27088" y="-1063.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="27088" y="-1052.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="27088" y="-1041.97" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="27088" y="-1030.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_3_2 -->
<g id="node223" class="node">
<title>agg_dim_3_2</title>
<polygon fill="lightcoral" stroke="black" points="26962.57,-1101.97 26793.04,-1101.97 26749.43,-997.97 26918.96,-997.97 26962.57,-1101.97"/>
<text text-anchor="middle" x="26856" y="-1063.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="26856" y="-1052.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="26856" y="-1041.97" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="26856" y="-1030.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_3_3 -->
<g id="node224" class="node">
<title>agg_dim_3_3</title>
<polygon fill="lightcoral" stroke="black" points="26730.57,-1101.97 26561.04,-1101.97 26517.43,-997.97 26686.96,-997.97 26730.57,-1101.97"/>
<text text-anchor="middle" x="26624" y="-1063.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="26624" y="-1052.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="26624" y="-1041.97" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="26624" y="-1030.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_3 -->
<g id="node225" class="node">
<title>agg_heads_3</title>
<polygon fill="lightcoral" stroke="black" points="26499.32,-1090.97 26357.23,-1090.97 26320.68,-1008.97 26462.77,-1008.97 26499.32,-1090.97"/>
<text text-anchor="middle" x="26410" y="-1058.47" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="26410" y="-1047.47" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="26410" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- out_proj3 -->
<g id="node226" class="node">
<title>out_proj3</title>
<polygon fill="lightgreen" stroke="black" points="26303,-1070.47 26115,-1070.47 26115,-1029.47 26303,-1029.47 26303,-1070.47"/>
<text text-anchor="middle" x="26209" y="-1058.47" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="26209" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="26209" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_1 -->
<g id="node227" class="node">
<title>res3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="25966" cy="-1049.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="25966" y="-1058.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="25966" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="25966" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln3_2 -->
<g id="node228" class="node">
<title>ln3_2</title>
<polygon fill="lightgreen" stroke="black" points="25817,-1070.47 25629,-1070.47 25629,-1029.47 25817,-1029.47 25817,-1070.47"/>
<text text-anchor="middle" x="25723" y="-1058.47" font-family="Arial" font-size="10.00">LayerNorm 3.2</text>
<text text-anchor="middle" x="25723" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="25723" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc1_3 -->
<g id="node229" class="node">
<title>mlp_fc1_3</title>
<polygon fill="lightgreen" stroke="black" points="25611,-1070.47 25417,-1070.47 25417,-1029.47 25611,-1029.47 25611,-1070.47"/>
<text text-anchor="middle" x="25514" y="-1058.47" font-family="Arial" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="25514" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="25514" y="-1036.47" font-family="Arial" font-size="10.00">Column Parallel</text>
</g>
<!-- mlp_gelu_3 -->
<g id="node230" class="node">
<title>mlp_gelu_3</title>
<polygon fill="lightgreen" stroke="black" points="25398.5,-1070.47 25199.5,-1070.47 25199.5,-1029.47 25398.5,-1029.47 25398.5,-1070.47"/>
<text text-anchor="middle" x="25299" y="-1058.47" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="25299" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="25299" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc2_3 -->
<g id="node231" class="node">
<title>mlp_fc2_3</title>
<polygon fill="lightgreen" stroke="black" points="25181,-1070.47 24987,-1070.47 24987,-1029.47 25181,-1029.47 25181,-1070.47"/>
<text text-anchor="middle" x="25084" y="-1058.47" font-family="Arial" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="25084" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="25084" y="-1036.47" font-family="Arial" font-size="10.00">Row Parallel</text>
</g>
<!-- res3_2 -->
<g id="node232" class="node">
<title>res3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="24838" cy="-1049.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="24838" y="-1058.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="24838" y="-1047.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="24838" y="-1036.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln4_1 -->
<g id="node233" class="node">
<title>ln4_1</title>
<polygon fill="lightgreen" stroke="black" points="24932,-919.47 24744,-919.47 24744,-878.47 24932,-878.47 24932,-919.47"/>
<text text-anchor="middle" x="24838" y="-907.47" font-family="Arial" font-size="10.00">LayerNorm 4.1</text>
<text text-anchor="middle" x="24838" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="24838" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_2&#45;&gt;ln4_1 -->
<g id="edge84" class="edge">
<title>res3_2&#45;&gt;ln4_1</title>
<path fill="none" stroke="black" d="M24838,-1020.94C24838,-995.01 24838,-956.57 24838,-930.01"/>
<polygon fill="black" stroke="black" points="24841.5,-929.77 24838,-919.77 24834.5,-929.77 24841.5,-929.77"/>
</g>
<!-- q_proj_4_0_0 -->
<g id="node234" class="node">
<title>q_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="24726,-919.47 24548,-919.47 24548,-878.47 24726,-878.47 24726,-919.47"/>
<text text-anchor="middle" x="24637" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="24637" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="24637" y="-885.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- k_proj_4_0_0 -->
<g id="node235" class="node">
<title>k_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="24530,-919.47 24352,-919.47 24352,-878.47 24530,-878.47 24530,-919.47"/>
<text text-anchor="middle" x="24441" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="24441" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="24441" y="-885.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- v_proj_4_0_0 -->
<g id="node236" class="node">
<title>v_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="24334,-919.47 24156,-919.47 24156,-878.47 24334,-878.47 24334,-919.47"/>
<text text-anchor="middle" x="24245" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="24245" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="24245" y="-885.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- attn_4_0_0 -->
<g id="node237" class="node">
<title>attn_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="24138,-919.47 23960,-919.47 23960,-878.47 24138,-878.47 24138,-919.47"/>
<text text-anchor="middle" x="24049" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="24049" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="24049" y="-885.47" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_4_0_1 -->
<g id="node238" class="node">
<title>q_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="23942,-919.47 23764,-919.47 23764,-878.47 23942,-878.47 23942,-919.47"/>
<text text-anchor="middle" x="23853" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="23853" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="23853" y="-885.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- k_proj_4_0_1 -->
<g id="node239" class="node">
<title>k_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="23746,-919.47 23568,-919.47 23568,-878.47 23746,-878.47 23746,-919.47"/>
<text text-anchor="middle" x="23657" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="23657" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="23657" y="-885.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- v_proj_4_0_1 -->
<g id="node240" class="node">
<title>v_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="23550,-919.47 23372,-919.47 23372,-878.47 23550,-878.47 23550,-919.47"/>
<text text-anchor="middle" x="23461" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="23461" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="23461" y="-885.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- attn_4_0_1 -->
<g id="node241" class="node">
<title>attn_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="23354,-919.47 23176,-919.47 23176,-878.47 23354,-878.47 23354,-919.47"/>
<text text-anchor="middle" x="23265" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="23265" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="23265" y="-885.47" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_4_0_2 -->
<g id="node242" class="node">
<title>q_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="23158,-919.47 22980,-919.47 22980,-878.47 23158,-878.47 23158,-919.47"/>
<text text-anchor="middle" x="23069" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="23069" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="23069" y="-885.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- k_proj_4_0_2 -->
<g id="node243" class="node">
<title>k_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="22962,-919.47 22784,-919.47 22784,-878.47 22962,-878.47 22962,-919.47"/>
<text text-anchor="middle" x="22873" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="22873" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="22873" y="-885.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- v_proj_4_0_2 -->
<g id="node244" class="node">
<title>v_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="22766,-919.47 22588,-919.47 22588,-878.47 22766,-878.47 22766,-919.47"/>
<text text-anchor="middle" x="22677" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="22677" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="22677" y="-885.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- attn_4_0_2 -->
<g id="node245" class="node">
<title>attn_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="22570,-919.47 22392,-919.47 22392,-878.47 22570,-878.47 22570,-919.47"/>
<text text-anchor="middle" x="22481" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="22481" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="22481" y="-885.47" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_4_0_3 -->
<g id="node246" class="node">
<title>q_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="22374,-919.47 22196,-919.47 22196,-878.47 22374,-878.47 22374,-919.47"/>
<text text-anchor="middle" x="22285" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="22285" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="22285" y="-885.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- k_proj_4_0_3 -->
<g id="node247" class="node">
<title>k_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="22178,-919.47 22000,-919.47 22000,-878.47 22178,-878.47 22178,-919.47"/>
<text text-anchor="middle" x="22089" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="22089" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="22089" y="-885.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- v_proj_4_0_3 -->
<g id="node248" class="node">
<title>v_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="21982,-919.47 21804,-919.47 21804,-878.47 21982,-878.47 21982,-919.47"/>
<text text-anchor="middle" x="21893" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="21893" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="21893" y="-885.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- attn_4_0_3 -->
<g id="node249" class="node">
<title>attn_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="21786,-919.47 21608,-919.47 21608,-878.47 21786,-878.47 21786,-919.47"/>
<text text-anchor="middle" x="21697" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="21697" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="21697" y="-885.47" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_4_1_0 -->
<g id="node250" class="node">
<title>q_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="21590,-919.47 21412,-919.47 21412,-878.47 21590,-878.47 21590,-919.47"/>
<text text-anchor="middle" x="21501" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="21501" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="21501" y="-885.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- k_proj_4_1_0 -->
<g id="node251" class="node">
<title>k_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="21394,-919.47 21216,-919.47 21216,-878.47 21394,-878.47 21394,-919.47"/>
<text text-anchor="middle" x="21305" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="21305" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="21305" y="-885.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- v_proj_4_1_0 -->
<g id="node252" class="node">
<title>v_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="21198,-919.47 21020,-919.47 21020,-878.47 21198,-878.47 21198,-919.47"/>
<text text-anchor="middle" x="21109" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="21109" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="21109" y="-885.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- attn_4_1_0 -->
<g id="node253" class="node">
<title>attn_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="21002,-919.47 20824,-919.47 20824,-878.47 21002,-878.47 21002,-919.47"/>
<text text-anchor="middle" x="20913" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="20913" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="20913" y="-885.47" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_4_1_1 -->
<g id="node254" class="node">
<title>q_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="20806,-919.47 20628,-919.47 20628,-878.47 20806,-878.47 20806,-919.47"/>
<text text-anchor="middle" x="20717" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="20717" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="20717" y="-885.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- k_proj_4_1_1 -->
<g id="node255" class="node">
<title>k_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="20610,-919.47 20432,-919.47 20432,-878.47 20610,-878.47 20610,-919.47"/>
<text text-anchor="middle" x="20521" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="20521" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="20521" y="-885.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- v_proj_4_1_1 -->
<g id="node256" class="node">
<title>v_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="20414,-919.47 20236,-919.47 20236,-878.47 20414,-878.47 20414,-919.47"/>
<text text-anchor="middle" x="20325" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="20325" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="20325" y="-885.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- attn_4_1_1 -->
<g id="node257" class="node">
<title>attn_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="20218,-919.47 20040,-919.47 20040,-878.47 20218,-878.47 20218,-919.47"/>
<text text-anchor="middle" x="20129" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="20129" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="20129" y="-885.47" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_4_1_2 -->
<g id="node258" class="node">
<title>q_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="20022,-919.47 19844,-919.47 19844,-878.47 20022,-878.47 20022,-919.47"/>
<text text-anchor="middle" x="19933" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="19933" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="19933" y="-885.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- k_proj_4_1_2 -->
<g id="node259" class="node">
<title>k_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="19826,-919.47 19648,-919.47 19648,-878.47 19826,-878.47 19826,-919.47"/>
<text text-anchor="middle" x="19737" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="19737" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="19737" y="-885.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- v_proj_4_1_2 -->
<g id="node260" class="node">
<title>v_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="19630,-919.47 19452,-919.47 19452,-878.47 19630,-878.47 19630,-919.47"/>
<text text-anchor="middle" x="19541" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="19541" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="19541" y="-885.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- attn_4_1_2 -->
<g id="node261" class="node">
<title>attn_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="19434,-919.47 19256,-919.47 19256,-878.47 19434,-878.47 19434,-919.47"/>
<text text-anchor="middle" x="19345" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="19345" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="19345" y="-885.47" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_4_1_3 -->
<g id="node262" class="node">
<title>q_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="19238,-919.47 19060,-919.47 19060,-878.47 19238,-878.47 19238,-919.47"/>
<text text-anchor="middle" x="19149" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="19149" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="19149" y="-885.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- k_proj_4_1_3 -->
<g id="node263" class="node">
<title>k_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="19042,-919.47 18864,-919.47 18864,-878.47 19042,-878.47 19042,-919.47"/>
<text text-anchor="middle" x="18953" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="18953" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18953" y="-885.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- v_proj_4_1_3 -->
<g id="node264" class="node">
<title>v_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="18846,-919.47 18668,-919.47 18668,-878.47 18846,-878.47 18846,-919.47"/>
<text text-anchor="middle" x="18757" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="18757" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18757" y="-885.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- attn_4_1_3 -->
<g id="node265" class="node">
<title>attn_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="18650,-919.47 18472,-919.47 18472,-878.47 18650,-878.47 18650,-919.47"/>
<text text-anchor="middle" x="18561" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="18561" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18561" y="-885.47" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_4_2_0 -->
<g id="node266" class="node">
<title>q_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="18454,-919.47 18276,-919.47 18276,-878.47 18454,-878.47 18454,-919.47"/>
<text text-anchor="middle" x="18365" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="18365" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18365" y="-885.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- k_proj_4_2_0 -->
<g id="node267" class="node">
<title>k_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="18258,-919.47 18080,-919.47 18080,-878.47 18258,-878.47 18258,-919.47"/>
<text text-anchor="middle" x="18169" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="18169" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18169" y="-885.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- v_proj_4_2_0 -->
<g id="node268" class="node">
<title>v_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="18062,-919.47 17884,-919.47 17884,-878.47 18062,-878.47 18062,-919.47"/>
<text text-anchor="middle" x="17973" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17973" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17973" y="-885.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- attn_4_2_0 -->
<g id="node269" class="node">
<title>attn_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="17866,-919.47 17688,-919.47 17688,-878.47 17866,-878.47 17866,-919.47"/>
<text text-anchor="middle" x="17777" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17777" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17777" y="-885.47" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_4_2_1 -->
<g id="node270" class="node">
<title>q_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="17670,-919.47 17492,-919.47 17492,-878.47 17670,-878.47 17670,-919.47"/>
<text text-anchor="middle" x="17581" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17581" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17581" y="-885.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- k_proj_4_2_1 -->
<g id="node271" class="node">
<title>k_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="17474,-919.47 17296,-919.47 17296,-878.47 17474,-878.47 17474,-919.47"/>
<text text-anchor="middle" x="17385" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17385" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17385" y="-885.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- v_proj_4_2_1 -->
<g id="node272" class="node">
<title>v_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="17278,-919.47 17100,-919.47 17100,-878.47 17278,-878.47 17278,-919.47"/>
<text text-anchor="middle" x="17189" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17189" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17189" y="-885.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- attn_4_2_1 -->
<g id="node273" class="node">
<title>attn_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="17082,-919.47 16904,-919.47 16904,-878.47 17082,-878.47 17082,-919.47"/>
<text text-anchor="middle" x="16993" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16993" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16993" y="-885.47" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_4_2_2 -->
<g id="node274" class="node">
<title>q_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16886,-919.47 16708,-919.47 16708,-878.47 16886,-878.47 16886,-919.47"/>
<text text-anchor="middle" x="16797" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16797" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16797" y="-885.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- k_proj_4_2_2 -->
<g id="node275" class="node">
<title>k_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16690,-919.47 16512,-919.47 16512,-878.47 16690,-878.47 16690,-919.47"/>
<text text-anchor="middle" x="16601" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16601" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16601" y="-885.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- v_proj_4_2_2 -->
<g id="node276" class="node">
<title>v_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16494,-919.47 16316,-919.47 16316,-878.47 16494,-878.47 16494,-919.47"/>
<text text-anchor="middle" x="16405" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16405" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16405" y="-885.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- attn_4_2_2 -->
<g id="node277" class="node">
<title>attn_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16298,-919.47 16120,-919.47 16120,-878.47 16298,-878.47 16298,-919.47"/>
<text text-anchor="middle" x="16209" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16209" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16209" y="-885.47" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_4_2_3 -->
<g id="node278" class="node">
<title>q_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="16102,-919.47 15924,-919.47 15924,-878.47 16102,-878.47 16102,-919.47"/>
<text text-anchor="middle" x="16013" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16013" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16013" y="-885.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- k_proj_4_2_3 -->
<g id="node279" class="node">
<title>k_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15906,-919.47 15728,-919.47 15728,-878.47 15906,-878.47 15906,-919.47"/>
<text text-anchor="middle" x="15817" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15817" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15817" y="-885.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- v_proj_4_2_3 -->
<g id="node280" class="node">
<title>v_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15710,-919.47 15532,-919.47 15532,-878.47 15710,-878.47 15710,-919.47"/>
<text text-anchor="middle" x="15621" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15621" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15621" y="-885.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- attn_4_2_3 -->
<g id="node281" class="node">
<title>attn_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15514,-919.47 15336,-919.47 15336,-878.47 15514,-878.47 15514,-919.47"/>
<text text-anchor="middle" x="15425" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15425" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15425" y="-885.47" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_4_3_0 -->
<g id="node282" class="node">
<title>q_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="15318,-919.47 15140,-919.47 15140,-878.47 15318,-878.47 15318,-919.47"/>
<text text-anchor="middle" x="15229" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15229" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15229" y="-885.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- k_proj_4_3_0 -->
<g id="node283" class="node">
<title>k_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="15122,-919.47 14944,-919.47 14944,-878.47 15122,-878.47 15122,-919.47"/>
<text text-anchor="middle" x="15033" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15033" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15033" y="-885.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- v_proj_4_3_0 -->
<g id="node284" class="node">
<title>v_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="14926,-919.47 14748,-919.47 14748,-878.47 14926,-878.47 14926,-919.47"/>
<text text-anchor="middle" x="14837" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14837" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14837" y="-885.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- attn_4_3_0 -->
<g id="node285" class="node">
<title>attn_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="14730,-919.47 14552,-919.47 14552,-878.47 14730,-878.47 14730,-919.47"/>
<text text-anchor="middle" x="14641" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14641" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14641" y="-885.47" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_4_3_1 -->
<g id="node286" class="node">
<title>q_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="14534,-919.47 14356,-919.47 14356,-878.47 14534,-878.47 14534,-919.47"/>
<text text-anchor="middle" x="14445" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14445" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14445" y="-885.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- k_proj_4_3_1 -->
<g id="node287" class="node">
<title>k_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="14338,-919.47 14160,-919.47 14160,-878.47 14338,-878.47 14338,-919.47"/>
<text text-anchor="middle" x="14249" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14249" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14249" y="-885.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- v_proj_4_3_1 -->
<g id="node288" class="node">
<title>v_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="14142,-919.47 13964,-919.47 13964,-878.47 14142,-878.47 14142,-919.47"/>
<text text-anchor="middle" x="14053" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14053" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14053" y="-885.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- attn_4_3_1 -->
<g id="node289" class="node">
<title>attn_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13946,-919.47 13768,-919.47 13768,-878.47 13946,-878.47 13946,-919.47"/>
<text text-anchor="middle" x="13857" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13857" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13857" y="-885.47" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_4_3_2 -->
<g id="node290" class="node">
<title>q_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13750,-919.47 13572,-919.47 13572,-878.47 13750,-878.47 13750,-919.47"/>
<text text-anchor="middle" x="13661" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="13661" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13661" y="-885.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- k_proj_4_3_2 -->
<g id="node291" class="node">
<title>k_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13554,-919.47 13376,-919.47 13376,-878.47 13554,-878.47 13554,-919.47"/>
<text text-anchor="middle" x="13465" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13465" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13465" y="-885.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- v_proj_4_3_2 -->
<g id="node292" class="node">
<title>v_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13358,-919.47 13180,-919.47 13180,-878.47 13358,-878.47 13358,-919.47"/>
<text text-anchor="middle" x="13269" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13269" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13269" y="-885.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- attn_4_3_2 -->
<g id="node293" class="node">
<title>attn_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="13162,-919.47 12984,-919.47 12984,-878.47 13162,-878.47 13162,-919.47"/>
<text text-anchor="middle" x="13073" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13073" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13073" y="-885.47" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_4_3_3 -->
<g id="node294" class="node">
<title>q_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12966,-919.47 12788,-919.47 12788,-878.47 12966,-878.47 12966,-919.47"/>
<text text-anchor="middle" x="12877" y="-907.47" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12877" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12877" y="-885.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- k_proj_4_3_3 -->
<g id="node295" class="node">
<title>k_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12770,-919.47 12592,-919.47 12592,-878.47 12770,-878.47 12770,-919.47"/>
<text text-anchor="middle" x="12681" y="-907.47" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="12681" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12681" y="-885.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- v_proj_4_3_3 -->
<g id="node296" class="node">
<title>v_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12574,-919.47 12396,-919.47 12396,-878.47 12574,-878.47 12574,-919.47"/>
<text text-anchor="middle" x="12485" y="-907.47" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12485" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12485" y="-885.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- attn_4_3_3 -->
<g id="node297" class="node">
<title>attn_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12378,-919.47 12200,-919.47 12200,-878.47 12378,-878.47 12378,-919.47"/>
<text text-anchor="middle" x="12289" y="-907.47" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12289" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12289" y="-885.47" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_dim_4_0 -->
<g id="node298" class="node">
<title>agg_dim_4_0</title>
<polygon fill="lightcoral" stroke="black" points="12181.57,-950.97 12012.04,-950.97 11968.43,-846.97 12137.96,-846.97 12181.57,-950.97"/>
<text text-anchor="middle" x="12075" y="-912.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="12075" y="-901.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="12075" y="-890.97" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="12075" y="-879.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_4_1 -->
<g id="node299" class="node">
<title>agg_dim_4_1</title>
<polygon fill="lightcoral" stroke="black" points="11949.57,-950.97 11780.04,-950.97 11736.43,-846.97 11905.96,-846.97 11949.57,-950.97"/>
<text text-anchor="middle" x="11843" y="-912.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="11843" y="-901.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="11843" y="-890.97" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="11843" y="-879.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_4_2 -->
<g id="node300" class="node">
<title>agg_dim_4_2</title>
<polygon fill="lightcoral" stroke="black" points="11717.57,-950.97 11548.04,-950.97 11504.43,-846.97 11673.96,-846.97 11717.57,-950.97"/>
<text text-anchor="middle" x="11611" y="-912.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="11611" y="-901.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="11611" y="-890.97" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="11611" y="-879.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_4_3 -->
<g id="node301" class="node">
<title>agg_dim_4_3</title>
<polygon fill="lightcoral" stroke="black" points="11485.57,-950.97 11316.04,-950.97 11272.43,-846.97 11441.96,-846.97 11485.57,-950.97"/>
<text text-anchor="middle" x="11379" y="-912.97" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="11379" y="-901.97" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="11379" y="-890.97" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="11379" y="-879.97" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_4 -->
<g id="node302" class="node">
<title>agg_heads_4</title>
<polygon fill="lightcoral" stroke="black" points="11254.32,-939.97 11112.23,-939.97 11075.68,-857.97 11217.77,-857.97 11254.32,-939.97"/>
<text text-anchor="middle" x="11165" y="-907.47" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="11165" y="-896.47" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="11165" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- out_proj4 -->
<g id="node303" class="node">
<title>out_proj4</title>
<polygon fill="lightgreen" stroke="black" points="11058,-919.47 10870,-919.47 10870,-878.47 11058,-878.47 11058,-919.47"/>
<text text-anchor="middle" x="10964" y="-907.47" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="10964" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="10964" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res4_1 -->
<g id="node304" class="node">
<title>res4_1</title>
<ellipse fill="lightgreen" stroke="black" cx="10721" cy="-898.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="10721" y="-907.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10721" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="10721" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln4_2 -->
<g id="node305" class="node">
<title>ln4_2</title>
<polygon fill="lightgreen" stroke="black" points="10572,-919.47 10384,-919.47 10384,-878.47 10572,-878.47 10572,-919.47"/>
<text text-anchor="middle" x="10478" y="-907.47" font-family="Arial" font-size="10.00">LayerNorm 4.2</text>
<text text-anchor="middle" x="10478" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="10478" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc1_4 -->
<g id="node306" class="node">
<title>mlp_fc1_4</title>
<polygon fill="lightgreen" stroke="black" points="10366,-919.47 10172,-919.47 10172,-878.47 10366,-878.47 10366,-919.47"/>
<text text-anchor="middle" x="10269" y="-907.47" font-family="Arial" font-size="10.00">MLP FC1</text>
<text text-anchor="middle" x="10269" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="10269" y="-885.47" font-family="Arial" font-size="10.00">Column Parallel</text>
</g>
<!-- mlp_gelu_4 -->
<g id="node307" class="node">
<title>mlp_gelu_4</title>
<polygon fill="lightgreen" stroke="black" points="10153.5,-919.47 9954.5,-919.47 9954.5,-878.47 10153.5,-878.47 10153.5,-919.47"/>
<text text-anchor="middle" x="10054" y="-907.47" font-family="Arial" font-size="10.00">GELU</text>
<text text-anchor="middle" x="10054" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 32768]</text>
<text text-anchor="middle" x="10054" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- mlp_fc2_4 -->
<g id="node308" class="node">
<title>mlp_fc2_4</title>
<polygon fill="lightgreen" stroke="black" points="9936,-919.47 9742,-919.47 9742,-878.47 9936,-878.47 9936,-919.47"/>
<text text-anchor="middle" x="9839" y="-907.47" font-family="Arial" font-size="10.00">MLP FC2</text>
<text text-anchor="middle" x="9839" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 32768] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="9839" y="-885.47" font-family="Arial" font-size="10.00">Row Parallel</text>
</g>
<!-- res4_2 -->
<g id="node309" class="node">
<title>res4_2</title>
<ellipse fill="lightgreen" stroke="black" cx="9593" cy="-898.97" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="9593" y="-907.47" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9593" y="-896.47" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="9593" y="-885.47" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- output -->
<g id="node311" class="node">
<title>output</title>
<ellipse fill="lightpink" stroke="black" cx="9593" cy="-758.97" rx="67.35" ry="21.43"/>
<text text-anchor="middle" x="9593" y="-761.97" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="9593" y="-750.97" font-family="Arial" font-size="10.00">[B=1024, L, 8192]</text>
</g>
<!-- res4_2&#45;&gt;output -->
<g id="edge85" class="edge">
<title>res4_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M9593,-869.71C9593,-846.73 9593,-814.36 9593,-790.74"/>
<polygon fill="black" stroke="black" points="9596.5,-790.56 9593,-780.56 9589.5,-790.56 9596.5,-790.56"/>
</g>
<!-- res1_2 -->
<g id="node310" class="node">
<title>res1_2</title>
<ellipse fill="none" stroke="black" cx="55328" cy="-1313.18" rx="27.16" ry="18"/>
<text text-anchor="middle" x="55328" y="-1310.68" font-family="Arial" font-size="10.00">res1_2</text>
</g>
<!-- res1_2&#45;&gt;ln2_1 -->
<g id="edge82" class="edge">
<title>res1_2&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M55328,-1294.96C55328,-1278.13 55328,-1252.15 55328,-1231.93"/>
<polygon fill="black" stroke="black" points="55331.5,-1231.67 55328,-1221.67 55324.5,-1231.67 55331.5,-1231.67"/>
</g>
</g>
</svg>
