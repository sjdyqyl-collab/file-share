<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: moe_model_16_gpu Pages: 1 -->
<svg width="1800pt" height="2333pt"
 viewBox="0.00 0.00 1800.00 2332.83" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.14 0.14) rotate(0) translate(4 17051.85)">
<title>moe_model_16_gpu</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-17051.85 13156.22,-17051.85 13156.22,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="12504.11" cy="-17026.64" rx="130.22" ry="21.43"/>
<text text-anchor="middle" x="12504.11" y="-17029.64" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="12504.11" y="-17018.64" font-family="Arial" font-size="10.00">[Batch: 1024, Seq: 512, Hidden: 8192]</text>
</g>
<!-- mha_q_1 -->
<g id="node2" class="node">
<title>mha_q_1</title>
<polygon fill="lightgreen" stroke="black" points="12627.11,-16968.43 12535.11,-16968.43 12535.11,-16927.43 12627.11,-16927.43 12627.11,-16968.43"/>
<text text-anchor="middle" x="12581.11" y="-16956.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="12581.11" y="-16945.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12581.11" y="-16934.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_q_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M12524.34,-17005.48C12533.43,-16996.43 12544.29,-16985.61 12554.06,-16975.87"/>
<polygon fill="black" stroke="black" points="12556.66,-16978.22 12561.28,-16968.68 12551.72,-16973.26 12556.66,-16978.22"/>
</g>
<!-- mha_k_1 -->
<g id="node3" class="node">
<title>mha_k_1</title>
<polygon fill="lightgreen" stroke="black" points="12737.11,-16968.43 12645.11,-16968.43 12645.11,-16927.43 12737.11,-16927.43 12737.11,-16968.43"/>
<text text-anchor="middle" x="12691.11" y="-16956.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="12691.11" y="-16945.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12691.11" y="-16934.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_k_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M12550.33,-17006.68C12576.16,-16996.08 12608.53,-16982.8 12635.71,-16971.65"/>
<polygon fill="black" stroke="black" points="12637.17,-16974.84 12645.09,-16967.8 12634.51,-16968.36 12637.17,-16974.84"/>
</g>
<!-- mha_v_1 -->
<g id="node4" class="node">
<title>mha_v_1</title>
<polygon fill="lightgreen" stroke="black" points="12517.11,-16968.43 12425.11,-16968.43 12425.11,-16927.43 12517.11,-16927.43 12517.11,-16968.43"/>
<text text-anchor="middle" x="12471.11" y="-16956.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="12471.11" y="-16945.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12471.11" y="-16934.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_v_1 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M12495.26,-17005.08C12491.67,-16996.74 12487.46,-16986.95 12483.57,-16977.9"/>
<polygon fill="black" stroke="black" points="12486.69,-16976.29 12479.52,-16968.48 12480.26,-16979.05 12486.69,-16976.29"/>
</g>
<!-- residual1_1 -->
<g id="node7" class="node">
<title>residual1_1</title>
<polygon fill="lightpink" stroke="black" points="12455.11,-16734.43 12363.11,-16734.43 12363.11,-16693.43 12455.11,-16693.43 12455.11,-16734.43"/>
<text text-anchor="middle" x="12409.11" y="-16722.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="12409.11" y="-16711.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12409.11" y="-16700.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M12446.85,-17007.51C12421.41,-16995.54 12397.11,-16976.81 12397.11,-16948.93 12397.11,-16948.93 12397.11,-16948.93 12397.11,-16790.93 12397.11,-16775.49 12399.55,-16758.51 12402.23,-16744.52"/>
<polygon fill="black" stroke="black" points="12405.71,-16744.98 12404.3,-16734.48 12398.86,-16743.57 12405.71,-16744.98"/>
</g>
<!-- mha_attn_1 -->
<g id="node5" class="node">
<title>mha_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="12538.11,-16890.43 12434.11,-16890.43 12434.11,-16849.43 12538.11,-16849.43 12538.11,-16890.43"/>
<text text-anchor="middle" x="12486.11" y="-16878.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="12486.11" y="-16867.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="12486.11" y="-16856.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge4" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M12556.64,-16927.35C12545.01,-16918.05 12530.94,-16906.79 12518.44,-16896.79"/>
<polygon fill="black" stroke="black" points="12520.48,-16893.95 12510.49,-16890.43 12516.11,-16899.41 12520.48,-16893.95"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M12645.1,-16929.87C12616.43,-16919.24 12579.18,-16905.43 12547.95,-16893.85"/>
<polygon fill="black" stroke="black" points="12549.06,-16890.53 12538.46,-16890.34 12546.62,-16897.09 12549.06,-16890.53"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M12474.97,-16927.35C12476.6,-16919.11 12478.53,-16909.34 12480.32,-16900.26"/>
<polygon fill="black" stroke="black" points="12483.76,-16900.92 12482.26,-16890.43 12476.89,-16899.56 12483.76,-16900.92"/>
</g>
<!-- mha_out_1 -->
<g id="node6" class="node">
<title>mha_out_1</title>
<polygon fill="lightgreen" stroke="black" points="12520.11,-16812.43 12428.11,-16812.43 12428.11,-16771.43 12520.11,-16771.43 12520.11,-16812.43"/>
<text text-anchor="middle" x="12474.11" y="-16800.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="12474.11" y="-16789.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12474.11" y="-16778.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge7" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M12483.02,-16849.35C12481.73,-16841.2 12480.21,-16831.55 12478.79,-16822.56"/>
<polygon fill="black" stroke="black" points="12482.2,-16821.76 12477.19,-16812.43 12475.29,-16822.86 12482.2,-16821.76"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M12457.37,-16771.35C12449.79,-16762.49 12440.69,-16751.86 12432.46,-16742.23"/>
<polygon fill="black" stroke="black" points="12434.95,-16739.76 12425.79,-16734.43 12429.63,-16744.31 12434.95,-16739.76"/>
</g>
<!-- ln1_1 -->
<g id="node8" class="node">
<title>ln1_1</title>
<polygon fill="lightpink" stroke="black" points="12455.11,-16656.43 12363.11,-16656.43 12363.11,-16615.43 12455.11,-16615.43 12455.11,-16656.43"/>
<text text-anchor="middle" x="12409.11" y="-16644.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="12409.11" y="-16633.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12409.11" y="-16622.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;ln1_1 -->
<g id="edge10" class="edge">
<title>residual1_1&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M12409.11,-16693.35C12409.11,-16685.2 12409.11,-16675.55 12409.11,-16666.56"/>
<polygon fill="black" stroke="black" points="12412.61,-16666.43 12409.11,-16656.43 12405.61,-16666.43 12412.61,-16666.43"/>
</g>
<!-- gate_1 -->
<g id="node9" class="node">
<title>gate_1</title>
<polygon fill="gold" stroke="black" points="12409.11,-16578.43 12332.11,-16537.43 12409.11,-16496.43 12486.11,-16537.43 12409.11,-16578.43"/>
<text text-anchor="middle" x="12409.11" y="-16545.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="12409.11" y="-16534.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="12409.11" y="-16523.93" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;gate_1 -->
<g id="edge11" class="edge">
<title>ln1_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M12409.11,-16615.4C12409.11,-16607.63 12409.11,-16598.31 12409.11,-16588.87"/>
<polygon fill="black" stroke="black" points="12412.61,-16588.65 12409.11,-16578.65 12405.61,-16588.65 12412.61,-16588.65"/>
</g>
<!-- expert_1_0 -->
<g id="node10" class="node">
<title>expert_1_0</title>
<polygon fill="lightcoral" stroke="black" points="13108.61,-16445.43 12949.61,-16445.43 12949.61,-16404.43 13108.61,-16404.43 13108.61,-16445.43"/>
<text text-anchor="middle" x="13029.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="13029.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="13029.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_0 -->
<g id="edge14" class="edge">
<title>ln1_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M12455.13,-16632.57C12522.94,-16627.96 12652.95,-16614.8 12757.11,-16578.43 12847.7,-16546.79 12943.24,-16485.86 12993.44,-16451.36"/>
<polygon fill="black" stroke="black" points="12995.46,-16454.22 13001.69,-16445.65 12991.48,-16448.47 12995.46,-16454.22"/>
</g>
<!-- expert_1_1 -->
<g id="node11" class="node">
<title>expert_1_1</title>
<polygon fill="lightcoral" stroke="black" points="12046.61,-16445.43 11887.61,-16445.43 11887.61,-16404.43 12046.61,-16404.43 12046.61,-16445.43"/>
<text text-anchor="middle" x="11967.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="11967.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11967.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_1 -->
<g id="edge17" class="edge">
<title>ln1_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M12362.83,-16629.24C12311.38,-16621.84 12226.52,-16606.44 12158.11,-16578.43 12080.15,-16546.51 12055.57,-16539.07 11997.11,-16478.43 11990.49,-16471.56 11984.79,-16462.96 11980.19,-16454.72"/>
<polygon fill="black" stroke="black" points="11983.21,-16452.93 11975.48,-16445.68 11977,-16456.16 11983.21,-16452.93"/>
</g>
<!-- expert_1_2 -->
<g id="node12" class="node">
<title>expert_1_2</title>
<polygon fill="lightcoral" stroke="black" points="12223.61,-16445.43 12064.61,-16445.43 12064.61,-16404.43 12223.61,-16404.43 12223.61,-16445.43"/>
<text text-anchor="middle" x="12144.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="12144.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12144.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_2 -->
<g id="edge20" class="edge">
<title>ln1_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M12363.1,-16621.78C12333.34,-16612.17 12294.45,-16597.51 12263.11,-16578.43 12205.82,-16543.55 12181.08,-16537.91 12150.11,-16478.43 12146.52,-16471.55 12144.65,-16463.48 12143.76,-16455.77"/>
<polygon fill="black" stroke="black" points="12147.24,-16455.35 12143.06,-16445.61 12140.25,-16455.82 12147.24,-16455.35"/>
</g>
<!-- expert_1_3 -->
<g id="node13" class="node">
<title>expert_1_3</title>
<polygon fill="lightcoral" stroke="black" points="11869.61,-16445.43 11710.61,-16445.43 11710.61,-16404.43 11869.61,-16404.43 11869.61,-16445.43"/>
<text text-anchor="middle" x="11790.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="11790.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11790.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_3 -->
<g id="edge23" class="edge">
<title>ln1_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M12363.05,-16635.11C12287.25,-16633.95 12132.6,-16625.39 12012.11,-16578.43 11935.12,-16548.42 11858.63,-16487.17 11818.64,-16452.11"/>
<polygon fill="black" stroke="black" points="11820.95,-16449.48 11811.14,-16445.47 11816.31,-16454.72 11820.95,-16449.48"/>
</g>
<!-- expert_1_4 -->
<g id="node14" class="node">
<title>expert_1_4</title>
<polygon fill="lightcoral" stroke="black" points="12400.61,-16445.43 12241.61,-16445.43 12241.61,-16404.43 12400.61,-16404.43 12400.61,-16445.43"/>
<text text-anchor="middle" x="12321.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="12321.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12321.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_4 -->
<g id="edge26" class="edge">
<title>ln1_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M12371.77,-16615.27C12355.6,-16605.59 12337.19,-16592.89 12323.11,-16578.43 12286.62,-16540.97 12275.43,-16528.72 12261.11,-16478.43 12259.28,-16472.01 12257.88,-16469.26 12261.11,-16463.43 12263.38,-16459.33 12266.31,-16455.62 12269.64,-16452.27"/>
<polygon fill="black" stroke="black" points="12272.2,-16454.69 12277.51,-16445.52 12267.64,-16449.38 12272.2,-16454.69"/>
</g>
<!-- expert_1_5 -->
<g id="node15" class="node">
<title>expert_1_5</title>
<polygon fill="lightcoral" stroke="black" points="12931.61,-16445.43 12772.61,-16445.43 12772.61,-16404.43 12931.61,-16404.43 12931.61,-16445.43"/>
<text text-anchor="middle" x="12852.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="12852.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12852.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_5 -->
<g id="edge29" class="edge">
<title>ln1_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M12455.15,-16629.39C12507.8,-16622.03 12595.89,-16606.56 12667.11,-16578.43 12747.92,-16546.5 12780.91,-16546.34 12835.11,-16478.43 12840.4,-16471.79 12844.07,-16463.46 12846.6,-16455.4"/>
<polygon fill="black" stroke="black" points="12850.05,-16456.06 12849.23,-16445.49 12843.28,-16454.26 12850.05,-16456.06"/>
</g>
<!-- expert_1_6 -->
<g id="node16" class="node">
<title>expert_1_6</title>
<polygon fill="lightcoral" stroke="black" points="12577.61,-16445.43 12418.61,-16445.43 12418.61,-16404.43 12577.61,-16404.43 12577.61,-16445.43"/>
<text text-anchor="middle" x="12498.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="12498.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12498.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_6 -->
<g id="edge32" class="edge">
<title>ln1_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M12452.47,-16615.29C12500.03,-16590.97 12573.42,-16544.51 12602.11,-16478.43 12604.76,-16472.31 12605.94,-16468.88 12602.11,-16463.43 12597.82,-16457.33 12592.44,-16452.21 12586.4,-16447.93"/>
<polygon fill="black" stroke="black" points="12588.13,-16444.88 12577.79,-16442.59 12584.44,-16450.83 12588.13,-16444.88"/>
</g>
<!-- expert_1_7 -->
<g id="node17" class="node">
<title>expert_1_7</title>
<polygon fill="lightcoral" stroke="black" points="12754.61,-16445.43 12595.61,-16445.43 12595.61,-16404.43 12754.61,-16404.43 12754.61,-16445.43"/>
<text text-anchor="middle" x="12675.11" y="-16433.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="12675.11" y="-16422.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12675.11" y="-16411.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_1_7 -->
<g id="edge35" class="edge">
<title>ln1_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M12455.34,-16627.74C12527.04,-16613.73 12662.1,-16575.18 12713.11,-16478.43 12717.67,-16469.77 12714.75,-16460.93 12708.89,-16453.04"/>
<polygon fill="black" stroke="black" points="12711.48,-16450.67 12702.23,-16445.5 12706.23,-16455.31 12711.48,-16450.67"/>
</g>
<!-- expert_agg_1 -->
<g id="node18" class="node">
<title>expert_agg_1</title>
<polygon fill="lightyellow" stroke="black" points="12511.88,-16367.43 12348.39,-16367.43 12306.33,-16285.43 12469.83,-16285.43 12511.88,-16367.43"/>
<text text-anchor="middle" x="12409.11" y="-16334.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="12409.11" y="-16323.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="12409.11" y="-16312.93" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;expert_agg_1 -->
<g id="edge12" class="edge">
<title>ln1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12455.32,-16635.12C12640.45,-16634.46 13309.36,-16617.57 13118.11,-16404.43 13077.76,-16359.46 12686.78,-16338.3 12503.3,-16330.78"/>
<polygon fill="black" stroke="black" points="12503.25,-16327.28 12493.12,-16330.37 12502.97,-16334.27 12503.25,-16327.28"/>
</g>
<!-- residual2_1 -->
<g id="node19" class="node">
<title>residual2_1</title>
<polygon fill="lightpink" stroke="black" points="11741.11,-16248.43 11649.11,-16248.43 11649.11,-16207.43 11741.11,-16207.43 11741.11,-16248.43"/>
<text text-anchor="middle" x="11695.11" y="-16236.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11695.11" y="-16225.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11695.11" y="-16214.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;residual2_1 -->
<g id="edge38" class="edge">
<title>ln1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M12362.87,-16633.67C12202.95,-16628.71 11683.11,-16607.29 11683.11,-16538.43 11683.11,-16538.43 11683.11,-16538.43 11683.11,-16325.43 11683.11,-16302.78 11686.4,-16277.37 11689.54,-16258.31"/>
<polygon fill="black" stroke="black" points="11692.99,-16258.88 11691.24,-16248.43 11686.09,-16257.69 11692.99,-16258.88"/>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge13" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12467.53,-16527.39C12563.82,-16512.28 12762.09,-16480.29 12939.48,-16445.71"/>
<polygon fill="black" stroke="black" points="12940.38,-16449.1 12949.52,-16443.74 12939.03,-16442.23 12940.38,-16449.1"/>
<text text-anchor="middle" x="12870.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge16" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12357.08,-16524.12C12308.42,-16512.56 12233.76,-16494.64 12169.11,-16478.43 12130.24,-16468.68 12087.25,-16457.55 12050.95,-16448.06"/>
<polygon fill="black" stroke="black" points="12051.47,-16444.58 12040.91,-16445.43 12049.69,-16451.35 12051.47,-16444.58"/>
<text text-anchor="middle" x="12200.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge19" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12367.22,-16518.58C12332.22,-16503.71 12280.97,-16482.04 12236.11,-16463.43 12225.03,-16458.83 12213.18,-16453.97 12201.8,-16449.32"/>
<polygon fill="black" stroke="black" points="12202.96,-16446.01 12192.38,-16445.47 12200.32,-16452.49 12202.96,-16446.01"/>
<text text-anchor="middle" x="12301.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge22" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12350.38,-16527.64C12278.69,-16516.78 12153.8,-16497.38 12047.11,-16478.43 11974.85,-16465.59 11954.66,-16461.38 11879.65,-16445.73"/>
<polygon fill="black" stroke="black" points="11880.22,-16442.28 11869.71,-16443.66 11878.79,-16449.13 11880.22,-16442.28"/>
<text text-anchor="middle" x="12078.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_1&#45;&gt;expert_1_4 -->
<g id="edge25" class="edge">
<title>gate_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12386.67,-16508.26C12373.4,-16491.59 12356.66,-16470.57 12343.41,-16453.93"/>
<polygon fill="black" stroke="black" points="12345.81,-16451.32 12336.84,-16445.68 12340.33,-16455.69 12345.81,-16451.32"/>
<text text-anchor="middle" x="12394.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_1&#45;&gt;expert_1_5 -->
<g id="edge28" class="edge">
<title>gate_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12459.17,-16523.08C12532.59,-16503.51 12663.17,-16468.79 12685.11,-16463.43 12693.32,-16461.42 12727.23,-16453.79 12762.37,-16445.93"/>
<polygon fill="black" stroke="black" points="12763.3,-16449.3 12772.3,-16443.71 12761.77,-16442.47 12763.3,-16449.3"/>
<text text-anchor="middle" x="12716.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_1&#45;&gt;expert_1_6 -->
<g id="edge31" class="edge">
<title>gate_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12425.17,-16504.69C12432.72,-16491.27 12442.41,-16475.89 12453.11,-16463.43 12456.42,-16459.57 12460.15,-16455.79 12464.01,-16452.2"/>
<polygon fill="black" stroke="black" points="12466.34,-16454.82 12471.53,-16445.58 12461.71,-16449.57 12466.34,-16454.82"/>
<text text-anchor="middle" x="12484.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_1&#45;&gt;expert_1_7 -->
<g id="edge34" class="edge">
<title>gate_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12447.74,-16516.72C12478.77,-16501.26 12523.69,-16479.71 12564.11,-16463.43 12576.71,-16458.35 12590.29,-16453.37 12603.48,-16448.78"/>
<polygon fill="black" stroke="black" points="12604.68,-16452.07 12613,-16445.51 12602.41,-16445.45 12604.68,-16452.07"/>
<text text-anchor="middle" x="12595.61" y="-16467.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_1_0&#45;&gt;expert_agg_1 -->
<g id="edge15" class="edge">
<title>expert_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12949.54,-16406.02C12946.69,-16405.47 12943.88,-16404.93 12941.11,-16404.43 12790.37,-16376.86 12614.13,-16352.97 12507.12,-16339.39"/>
<polygon fill="black" stroke="black" points="12507.34,-16335.89 12496.98,-16338.11 12506.46,-16342.84 12507.34,-16335.89"/>
</g>
<!-- expert_1_1&#45;&gt;expert_agg_1 -->
<g id="edge18" class="edge">
<title>expert_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12046.73,-16406.27C12049.56,-16405.65 12052.36,-16405.03 12055.11,-16404.43 12147.81,-16384.07 12254.23,-16360.96 12325.98,-16345.41"/>
<polygon fill="black" stroke="black" points="12326.84,-16348.81 12335.87,-16343.27 12325.35,-16341.97 12326.84,-16348.81"/>
</g>
<!-- expert_1_2&#45;&gt;expert_agg_1 -->
<g id="edge21" class="edge">
<title>expert_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12197.73,-16404.4C12235.98,-16390.47 12288.01,-16371.53 12330.87,-16355.92"/>
<polygon fill="black" stroke="black" points="12332.23,-16359.14 12340.43,-16352.43 12329.84,-16352.57 12332.23,-16359.14"/>
</g>
<!-- expert_1_3&#45;&gt;expert_agg_1 -->
<g id="edge24" class="edge">
<title>expert_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M11869.68,-16406.02C11872.52,-16405.47 11875.34,-16404.93 11878.11,-16404.43 12033.89,-16375.91 12216.96,-16351.31 12322.36,-16338"/>
<polygon fill="black" stroke="black" points="12322.83,-16341.47 12332.31,-16336.75 12321.96,-16334.52 12322.83,-16341.47"/>
</g>
<!-- expert_1_4&#45;&gt;expert_agg_1 -->
<g id="edge27" class="edge">
<title>expert_1_4&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12338.92,-16404.4C12346.68,-16395.89 12356.14,-16385.51 12365.58,-16375.16"/>
<polygon fill="black" stroke="black" points="12368.27,-16377.4 12372.42,-16367.65 12363.1,-16372.68 12368.27,-16377.4"/>
</g>
<!-- expert_1_5&#45;&gt;expert_agg_1 -->
<g id="edge30" class="edge">
<title>expert_1_5&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12772.49,-16406.27C12769.66,-16405.64 12766.86,-16405.03 12764.11,-16404.43 12679.09,-16385.79 12582.57,-16364.87 12511.65,-16349.54"/>
<polygon fill="black" stroke="black" points="12512.33,-16346.11 12501.82,-16347.42 12510.85,-16352.95 12512.33,-16346.11"/>
</g>
<!-- expert_1_6&#45;&gt;expert_agg_1 -->
<g id="edge33" class="edge">
<title>expert_1_6&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12480.1,-16404.4C12472.25,-16395.89 12462.67,-16385.51 12453.13,-16375.16"/>
<polygon fill="black" stroke="black" points="12455.56,-16372.63 12446.21,-16367.65 12450.41,-16377.38 12455.56,-16372.63"/>
</g>
<!-- expert_1_7&#45;&gt;expert_agg_1 -->
<g id="edge36" class="edge">
<title>expert_1_7&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M12621.28,-16404.4C12592.14,-16393.83 12555.03,-16380.36 12520.02,-16367.66"/>
<polygon fill="black" stroke="black" points="12520.8,-16364.22 12510.2,-16364.1 12518.41,-16370.8 12520.8,-16364.22"/>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge37" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M12320.48,-16313.45C12171.55,-16293.32 11875.23,-16253.27 11751.47,-16236.54"/>
<polygon fill="black" stroke="black" points="11751.83,-16233.06 11741.45,-16235.19 11750.89,-16240 11751.83,-16233.06"/>
</g>
<!-- ln2_1 -->
<g id="node20" class="node">
<title>ln2_1</title>
<polygon fill="lightpink" stroke="black" points="11741.11,-16170.43 11649.11,-16170.43 11649.11,-16129.43 11741.11,-16129.43 11741.11,-16170.43"/>
<text text-anchor="middle" x="11695.11" y="-16158.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="11695.11" y="-16147.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11695.11" y="-16136.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- residual2_1&#45;&gt;ln2_1 -->
<g id="edge39" class="edge">
<title>residual2_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M11695.11,-16207.35C11695.11,-16199.2 11695.11,-16189.55 11695.11,-16180.56"/>
<polygon fill="black" stroke="black" points="11698.61,-16180.43 11695.11,-16170.43 11691.61,-16180.43 11698.61,-16180.43"/>
</g>
<!-- split_1 -->
<g id="node21" class="node">
<title>split_1</title>
<polygon fill="lightyellow" stroke="black" points="11839.17,-16092.43 11737.26,-16092.43 11711.05,-16032.43 11812.95,-16032.43 11839.17,-16092.43"/>
<text text-anchor="middle" x="11775.11" y="-16065.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="11775.11" y="-16054.43" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- ln2_1&#45;&gt;split_1 -->
<g id="edge40" class="edge">
<title>ln2_1&#45;&gt;split_1</title>
<path fill="none" stroke="black" d="M11713.66,-16129.1C11721.75,-16120.45 11731.51,-16110.02 11740.84,-16100.05"/>
<polygon fill="black" stroke="black" points="11743.58,-16102.25 11747.86,-16092.55 11738.47,-16097.46 11743.58,-16102.25"/>
</g>
<!-- agg_2 -->
<g id="node22" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="11759.17,-15995.43 11657.26,-15995.43 11631.05,-15935.43 11732.95,-15935.43 11759.17,-15995.43"/>
<text text-anchor="middle" x="11695.11" y="-15968.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="11695.11" y="-15957.43" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- ln2_1&#45;&gt;agg_2 -->
<g id="edge46" class="edge">
<title>ln2_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M11695.11,-16129.4C11695.11,-16100.06 11695.11,-16044.02 11695.11,-16005.93"/>
<polygon fill="black" stroke="black" points="11698.61,-16005.7 11695.11,-15995.7 11691.61,-16005.7 11698.61,-16005.7"/>
</g>
<!-- split_1&#45;&gt;agg_2 -->
<g id="edge41" class="edge">
<title>split_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M11750.67,-16032.41C11742.99,-16023.28 11734.4,-16013.08 11726.31,-16003.48"/>
<polygon fill="black" stroke="black" points="11728.79,-16000.99 11719.67,-15995.6 11723.44,-16005.5 11728.79,-16000.99"/>
</g>
<!-- mha_q_2 -->
<g id="node23" class="node">
<title>mha_q_2</title>
<polygon fill="lightgreen" stroke="black" points="11818.11,-15898.43 11726.11,-15898.43 11726.11,-15857.43 11818.11,-15857.43 11818.11,-15898.43"/>
<text text-anchor="middle" x="11772.11" y="-15886.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="11772.11" y="-15875.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11772.11" y="-15864.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_q_2 -->
<g id="edge47" class="edge">
<title>agg_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M11721.61,-15935C11730.1,-15925.57 11739.47,-15915.17 11747.8,-15905.92"/>
<polygon fill="black" stroke="black" points="11750.42,-15908.24 11754.51,-15898.46 11745.22,-15903.55 11750.42,-15908.24"/>
</g>
<!-- mha_k_2 -->
<g id="node24" class="node">
<title>mha_k_2</title>
<polygon fill="lightgreen" stroke="black" points="11928.11,-15898.43 11836.11,-15898.43 11836.11,-15857.43 11928.11,-15857.43 11928.11,-15898.43"/>
<text text-anchor="middle" x="11882.11" y="-15886.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="11882.11" y="-15875.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11882.11" y="-15864.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_k_2 -->
<g id="edge48" class="edge">
<title>agg_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M11737.54,-15945.03C11764.96,-15932.49 11800.83,-15916.09 11829.99,-15902.76"/>
<polygon fill="black" stroke="black" points="11831.56,-15905.89 11839.2,-15898.55 11828.65,-15899.52 11831.56,-15905.89"/>
</g>
<!-- mha_v_2 -->
<g id="node25" class="node">
<title>mha_v_2</title>
<polygon fill="lightgreen" stroke="black" points="11708.11,-15898.43 11616.11,-15898.43 11616.11,-15857.43 11708.11,-15857.43 11708.11,-15898.43"/>
<text text-anchor="middle" x="11662.11" y="-15886.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="11662.11" y="-15875.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11662.11" y="-15864.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_v_2 -->
<g id="edge49" class="edge">
<title>agg_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M11683.75,-15935C11680.36,-15926.23 11676.66,-15916.62 11673.28,-15907.88"/>
<polygon fill="black" stroke="black" points="11676.51,-15906.53 11669.65,-15898.46 11669.98,-15909.05 11676.51,-15906.53"/>
</g>
<!-- residual1_2 -->
<g id="node28" class="node">
<title>residual1_2</title>
<polygon fill="lightpink" stroke="black" points="11646.11,-15664.43 11554.11,-15664.43 11554.11,-15623.43 11646.11,-15623.43 11646.11,-15664.43"/>
<text text-anchor="middle" x="11600.11" y="-15652.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="11600.11" y="-15641.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11600.11" y="-15630.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;residual1_2 -->
<g id="edge50" class="edge">
<title>agg_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M11632.87,-15939.71C11609.33,-15925.95 11588.11,-15906.03 11588.11,-15878.93 11588.11,-15878.93 11588.11,-15878.93 11588.11,-15720.93 11588.11,-15705.49 11590.55,-15688.51 11593.23,-15674.52"/>
<polygon fill="black" stroke="black" points="11596.71,-15674.98 11595.3,-15664.48 11589.86,-15673.57 11596.71,-15674.98"/>
</g>
<!-- mha_attn_2 -->
<g id="node26" class="node">
<title>mha_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="11729.11,-15820.43 11625.11,-15820.43 11625.11,-15779.43 11729.11,-15779.43 11729.11,-15820.43"/>
<text text-anchor="middle" x="11677.11" y="-15808.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="11677.11" y="-15797.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="11677.11" y="-15786.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge42" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M11747.64,-15857.35C11736.01,-15848.05 11721.94,-15836.79 11709.44,-15826.79"/>
<polygon fill="black" stroke="black" points="11711.48,-15823.95 11701.49,-15820.43 11707.11,-15829.41 11711.48,-15823.95"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge43" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M11836.1,-15859.87C11807.43,-15849.24 11770.18,-15835.43 11738.95,-15823.85"/>
<polygon fill="black" stroke="black" points="11740.06,-15820.53 11729.46,-15820.34 11737.62,-15827.09 11740.06,-15820.53"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge44" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M11665.97,-15857.35C11667.6,-15849.11 11669.53,-15839.34 11671.32,-15830.26"/>
<polygon fill="black" stroke="black" points="11674.76,-15830.92 11673.26,-15820.43 11667.89,-15829.56 11674.76,-15830.92"/>
</g>
<!-- mha_out_2 -->
<g id="node27" class="node">
<title>mha_out_2</title>
<polygon fill="lightgreen" stroke="black" points="11711.11,-15742.43 11619.11,-15742.43 11619.11,-15701.43 11711.11,-15701.43 11711.11,-15742.43"/>
<text text-anchor="middle" x="11665.11" y="-15730.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="11665.11" y="-15719.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11665.11" y="-15708.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge45" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M11674.02,-15779.35C11672.73,-15771.2 11671.21,-15761.55 11669.79,-15752.56"/>
<polygon fill="black" stroke="black" points="11673.2,-15751.76 11668.19,-15742.43 11666.29,-15752.86 11673.2,-15751.76"/>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge51" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M11648.37,-15701.35C11640.79,-15692.49 11631.69,-15681.86 11623.46,-15672.23"/>
<polygon fill="black" stroke="black" points="11625.95,-15669.76 11616.79,-15664.43 11620.63,-15674.31 11625.95,-15669.76"/>
</g>
<!-- ln1_2 -->
<g id="node29" class="node">
<title>ln1_2</title>
<polygon fill="lightpink" stroke="black" points="11646.11,-15586.43 11554.11,-15586.43 11554.11,-15545.43 11646.11,-15545.43 11646.11,-15586.43"/>
<text text-anchor="middle" x="11600.11" y="-15574.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="11600.11" y="-15563.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11600.11" y="-15552.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- residual1_2&#45;&gt;ln1_2 -->
<g id="edge52" class="edge">
<title>residual1_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M11600.11,-15623.35C11600.11,-15615.2 11600.11,-15605.55 11600.11,-15596.56"/>
<polygon fill="black" stroke="black" points="11603.61,-15596.43 11600.11,-15586.43 11596.61,-15596.43 11603.61,-15596.43"/>
</g>
<!-- gate_2 -->
<g id="node30" class="node">
<title>gate_2</title>
<polygon fill="gold" stroke="black" points="11600.11,-15508.43 11523.11,-15467.43 11600.11,-15426.43 11677.11,-15467.43 11600.11,-15508.43"/>
<text text-anchor="middle" x="11600.11" y="-15475.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="11600.11" y="-15464.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="11600.11" y="-15453.93" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;gate_2 -->
<g id="edge53" class="edge">
<title>ln1_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M11600.11,-15545.4C11600.11,-15537.63 11600.11,-15528.31 11600.11,-15518.87"/>
<polygon fill="black" stroke="black" points="11603.61,-15518.65 11600.11,-15508.65 11596.61,-15518.65 11603.61,-15518.65"/>
</g>
<!-- expert_2_0 -->
<g id="node31" class="node">
<title>expert_2_0</title>
<polygon fill="lightcoral" stroke="black" points="12337.61,-15375.43 12178.61,-15375.43 12178.61,-15334.43 12337.61,-15334.43 12337.61,-15375.43"/>
<text text-anchor="middle" x="12258.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="12258.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12258.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_0 -->
<g id="edge56" class="edge">
<title>ln1_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M11646.16,-15561.71C11713.42,-15556.05 11841.86,-15541.62 11946.11,-15508.43 12048.35,-15475.87 12159.23,-15414.87 12217.32,-15380.72"/>
<polygon fill="black" stroke="black" points="12219.36,-15383.58 12226.18,-15375.47 12215.79,-15377.55 12219.36,-15383.58"/>
</g>
<!-- expert_2_1 -->
<g id="node32" class="node">
<title>expert_2_1</title>
<polygon fill="lightcoral" stroke="black" points="11275.61,-15375.43 11116.61,-15375.43 11116.61,-15334.43 11275.61,-15334.43 11275.61,-15375.43"/>
<text text-anchor="middle" x="11196.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="11196.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11196.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_1 -->
<g id="edge59" class="edge">
<title>ln1_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M11553.76,-15560.87C11501.41,-15554.89 11414.73,-15540.7 11347.11,-15508.43 11282.59,-15477.63 11265.63,-15464.37 11221.11,-15408.43 11215.51,-15401.39 11210.77,-15392.88 11206.99,-15384.79"/>
<polygon fill="black" stroke="black" points="11210.18,-15383.36 11202.98,-15375.59 11203.76,-15386.16 11210.18,-15383.36"/>
</g>
<!-- expert_2_2 -->
<g id="node33" class="node">
<title>expert_2_2</title>
<polygon fill="lightcoral" stroke="black" points="11452.61,-15375.43 11293.61,-15375.43 11293.61,-15334.43 11452.61,-15334.43 11452.61,-15375.43"/>
<text text-anchor="middle" x="11373.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="11373.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11373.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_2 -->
<g id="edge62" class="edge">
<title>ln1_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M11554.1,-15551.78C11524.34,-15542.17 11485.45,-15527.51 11454.11,-15508.43 11396.82,-15473.55 11368.65,-15469.57 11341.11,-15408.43 11337.45,-15400.31 11339.57,-15391.91 11344.09,-15384.28"/>
<polygon fill="black" stroke="black" points="11347.26,-15385.88 11350.3,-15375.73 11341.59,-15381.76 11347.26,-15385.88"/>
</g>
<!-- expert_2_3 -->
<g id="node34" class="node">
<title>expert_2_3</title>
<polygon fill="lightcoral" stroke="black" points="11098.61,-15375.43 10939.61,-15375.43 10939.61,-15334.43 11098.61,-15334.43 11098.61,-15375.43"/>
<text text-anchor="middle" x="11019.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="11019.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11019.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_3 -->
<g id="edge65" class="edge">
<title>ln1_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M11553.97,-15564.59C11482.59,-15562.6 11342.25,-15552.78 11233.11,-15508.43 11158.93,-15478.28 11085.87,-15417.79 11047.27,-15382.73"/>
<polygon fill="black" stroke="black" points="11049.3,-15379.84 11039.56,-15375.66 11044.56,-15385 11049.3,-15379.84"/>
</g>
<!-- expert_2_4 -->
<g id="node35" class="node">
<title>expert_2_4</title>
<polygon fill="lightcoral" stroke="black" points="11629.61,-15375.43 11470.61,-15375.43 11470.61,-15334.43 11629.61,-15334.43 11629.61,-15375.43"/>
<text text-anchor="middle" x="11550.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="11550.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11550.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_4 -->
<g id="edge68" class="edge">
<title>ln1_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M11562.77,-15545.27C11546.6,-15535.59 11528.19,-15522.89 11514.11,-15508.43 11477.62,-15470.97 11466.43,-15458.72 11452.11,-15408.43 11448.71,-15396.51 11453.18,-15387.27 11461.79,-15380.11"/>
<polygon fill="black" stroke="black" points="11464,-15382.84 11470.32,-15374.34 11460.08,-15377.04 11464,-15382.84"/>
</g>
<!-- expert_2_5 -->
<g id="node36" class="node">
<title>expert_2_5</title>
<polygon fill="lightcoral" stroke="black" points="12160.61,-15375.43 12001.61,-15375.43 12001.61,-15334.43 12160.61,-15334.43 12160.61,-15375.43"/>
<text text-anchor="middle" x="12081.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="12081.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="12081.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_5 -->
<g id="edge71" class="edge">
<title>ln1_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M11646.2,-15558.61C11731.75,-15544.86 11917.33,-15505.32 12038.11,-15408.43 12046.88,-15401.39 12055.09,-15392.29 12061.94,-15383.66"/>
<polygon fill="black" stroke="black" points="12064.8,-15385.68 12068.06,-15375.61 12059.22,-15381.45 12064.8,-15385.68"/>
</g>
<!-- expert_2_6 -->
<g id="node37" class="node">
<title>expert_2_6</title>
<polygon fill="lightcoral" stroke="black" points="11806.61,-15375.43 11647.61,-15375.43 11647.61,-15334.43 11806.61,-15334.43 11806.61,-15375.43"/>
<text text-anchor="middle" x="11727.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="11727.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11727.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_6 -->
<g id="edge74" class="edge">
<title>ln1_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M11643.47,-15545.29C11691.03,-15520.97 11764.42,-15474.51 11793.11,-15408.43 11797.66,-15397.94 11793.29,-15388.96 11785.02,-15381.55"/>
<polygon fill="black" stroke="black" points="11786.97,-15378.64 11776.87,-15375.44 11782.77,-15384.24 11786.97,-15378.64"/>
</g>
<!-- expert_2_7 -->
<g id="node38" class="node">
<title>expert_2_7</title>
<polygon fill="lightcoral" stroke="black" points="11983.61,-15375.43 11824.61,-15375.43 11824.61,-15334.43 11983.61,-15334.43 11983.61,-15375.43"/>
<text text-anchor="middle" x="11904.11" y="-15363.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="11904.11" y="-15352.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11904.11" y="-15341.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_2_7 -->
<g id="edge77" class="edge">
<title>ln1_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M11646.32,-15552.03C11678.78,-15542.13 11722.72,-15527.03 11759.11,-15508.43 11828.81,-15472.79 11867.71,-15477.74 11904.11,-15408.43 11907.69,-15401.6 11908.91,-15393.56 11908.93,-15385.84"/>
<polygon fill="black" stroke="black" points="11912.41,-15385.45 11908.33,-15375.68 11905.42,-15385.87 11912.41,-15385.45"/>
</g>
<!-- expert_agg_2 -->
<g id="node39" class="node">
<title>expert_agg_2</title>
<polygon fill="lightyellow" stroke="black" points="11722.88,-15297.43 11559.39,-15297.43 11517.33,-15215.43 11680.83,-15215.43 11722.88,-15297.43"/>
<text text-anchor="middle" x="11620.11" y="-15264.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="11620.11" y="-15253.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11620.11" y="-15242.93" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;expert_agg_2 -->
<g id="edge54" class="edge">
<title>ln1_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11646.42,-15565.65C11837.77,-15567.2 12547.48,-15558.28 12346.11,-15334.43 12304.57,-15288.25 11900.99,-15267.64 11714.16,-15260.52"/>
<polygon fill="black" stroke="black" points="11714.19,-15257.02 11704.07,-15260.14 11713.93,-15264.02 11714.19,-15257.02"/>
</g>
<!-- residual2_2 -->
<g id="node40" class="node">
<title>residual2_2</title>
<polygon fill="lightpink" stroke="black" points="10970.11,-15178.43 10878.11,-15178.43 10878.11,-15137.43 10970.11,-15137.43 10970.11,-15178.43"/>
<text text-anchor="middle" x="10924.11" y="-15166.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10924.11" y="-15155.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10924.11" y="-15144.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;residual2_2 -->
<g id="edge80" class="edge">
<title>ln1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M11553.9,-15563.32C11399.64,-15557.37 10912.11,-15533.41 10912.11,-15468.43 10912.11,-15468.43 10912.11,-15468.43 10912.11,-15255.43 10912.11,-15232.78 10915.4,-15207.37 10918.54,-15188.31"/>
<polygon fill="black" stroke="black" points="10921.99,-15188.88 10920.24,-15178.43 10915.09,-15187.69 10921.99,-15188.88"/>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge55" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11659.69,-15458.04C11761.71,-15443.43 11976.56,-15411.58 12168.58,-15375.47"/>
<polygon fill="black" stroke="black" points="12169.4,-15378.88 12178.58,-15373.59 12168.1,-15372 12169.4,-15378.88"/>
<text text-anchor="middle" x="12092.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge58" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11549.93,-15452.9C11506.55,-15441.19 11442.17,-15423.77 11386.11,-15408.43 11350.06,-15398.56 11310.18,-15387.56 11276.31,-15378.18"/>
<polygon fill="black" stroke="black" points="11277.04,-15374.75 11266.47,-15375.46 11275.17,-15381.5 11277.04,-15374.75"/>
<text text-anchor="middle" x="11417.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge61" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11560.83,-15447.3C11522.49,-15428.64 11464.02,-15400.18 11422.54,-15379.99"/>
<polygon fill="black" stroke="black" points="11423.96,-15376.79 11413.43,-15375.56 11420.89,-15383.08 11423.96,-15376.79"/>
<text text-anchor="middle" x="11511.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge64" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11542.56,-15456.96C11476.09,-15445.9 11363.53,-15426.76 11267.11,-15408.43 11198.84,-15395.44 11179.73,-15391 11108.62,-15375.74"/>
<polygon fill="black" stroke="black" points="11109.23,-15372.3 11098.72,-15373.62 11107.77,-15379.14 11109.23,-15372.3"/>
<text text-anchor="middle" x="11298.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_2&#45;&gt;expert_2_4 -->
<g id="edge67" class="edge">
<title>gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11576.04,-15438.84C11569.23,-15429.7 11562.49,-15419.12 11558.11,-15408.43 11555.17,-15401.27 11553.31,-15393.17 11552.12,-15385.51"/>
<polygon fill="black" stroke="black" points="11555.58,-15384.96 11550.88,-15375.47 11548.63,-15385.82 11555.58,-15384.96"/>
<text text-anchor="middle" x="11589.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_2&#45;&gt;expert_2_5 -->
<g id="edge70" class="edge">
<title>gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11650.33,-15453.09C11694.52,-15441.35 11760.59,-15423.78 11818.11,-15408.43 11843,-15401.78 11848.89,-15398.71 11874.11,-15393.43 11923.09,-15383.16 11938.25,-15384.86 11991.55,-15375.44"/>
<polygon fill="black" stroke="black" points="11992.37,-15378.85 12001.58,-15373.62 11991.12,-15371.96 11992.37,-15378.85"/>
<text text-anchor="middle" x="11905.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_2&#45;&gt;expert_2_6 -->
<g id="edge73" class="edge">
<title>gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11614.26,-15433.94C11621.57,-15420.06 11631.61,-15404.53 11644.11,-15393.43 11649.55,-15388.59 11655.73,-15384.28 11662.19,-15380.46"/>
<polygon fill="black" stroke="black" points="11664.05,-15383.43 11671.14,-15375.56 11660.69,-15377.29 11664.05,-15383.43"/>
<text text-anchor="middle" x="11675.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_2&#45;&gt;expert_2_7 -->
<g id="edge76" class="edge">
<title>gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11637.77,-15446.16C11668.63,-15430.18 11713.79,-15408.2 11755.11,-15393.43 11766.86,-15389.22 11789.93,-15383.08 11814.47,-15376.98"/>
<polygon fill="black" stroke="black" points="11815.43,-15380.35 11824.3,-15374.56 11813.75,-15373.56 11815.43,-15380.35"/>
<text text-anchor="middle" x="11786.61" y="-15397.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge57" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M12178.59,-15336.19C12175.39,-15335.58 12172.22,-15334.99 12169.11,-15334.43 12012.02,-15306.24 11828.09,-15282.26 11718,-15268.87"/>
<polygon fill="black" stroke="black" points="11718.26,-15265.37 11707.91,-15267.64 11717.42,-15272.32 11718.26,-15265.37"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge60" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11275.86,-15335.78C11350.47,-15318.79 11461.48,-15293.53 11537.12,-15276.31"/>
<polygon fill="black" stroke="black" points="11538.11,-15279.68 11547.09,-15274.05 11536.56,-15272.85 11538.11,-15279.68"/>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge63" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11423.09,-15334.4C11457.4,-15320.99 11503.61,-15302.94 11542.65,-15287.69"/>
<polygon fill="black" stroke="black" points="11544.37,-15290.77 11552.41,-15283.88 11541.82,-15284.25 11544.37,-15290.77"/>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge66" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11098.68,-15336.03C11101.52,-15335.48 11104.34,-15334.94 11107.11,-15334.43 11256.43,-15306.71 11431.63,-15282.1 11533.82,-15268.53"/>
<polygon fill="black" stroke="black" points="11534.33,-15271.99 11543.78,-15267.21 11533.41,-15265.05 11534.33,-15271.99"/>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge69" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11564.27,-15334.4C11570.33,-15326.05 11577.68,-15315.91 11585.05,-15305.76"/>
<polygon fill="black" stroke="black" points="11587.89,-15307.8 11590.93,-15297.65 11582.22,-15303.69 11587.89,-15307.8"/>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge72" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M12001.54,-15336.45C11998.36,-15335.76 11995.2,-15335.09 11992.11,-15334.43 11900.9,-15315 11796.95,-15293.54 11722.17,-15278.22"/>
<polygon fill="black" stroke="black" points="11722.78,-15274.77 11712.28,-15276.2 11721.37,-15281.63 11722.78,-15274.77"/>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge75" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11705.45,-15334.4C11695.84,-15325.72 11684.06,-15315.1 11672.36,-15304.55"/>
<polygon fill="black" stroke="black" points="11674.48,-15301.75 11664.71,-15297.65 11669.79,-15306.95 11674.48,-15301.75"/>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge78" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M11846.64,-15334.4C11812.95,-15322.95 11769.28,-15308.11 11729.29,-15294.53"/>
<polygon fill="black" stroke="black" points="11730.35,-15291.19 11719.75,-15291.28 11728.09,-15297.82 11730.35,-15291.19"/>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge79" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M11531.25,-15243.11C11385.79,-15222.94 11100.96,-15183.45 10980.28,-15166.71"/>
<polygon fill="black" stroke="black" points="10980.54,-15163.22 10970.16,-15165.31 10979.58,-15170.15 10980.54,-15163.22"/>
</g>
<!-- ln2_2 -->
<g id="node41" class="node">
<title>ln2_2</title>
<polygon fill="lightpink" stroke="black" points="10970.11,-15100.43 10878.11,-15100.43 10878.11,-15059.43 10970.11,-15059.43 10970.11,-15100.43"/>
<text text-anchor="middle" x="10924.11" y="-15088.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10924.11" y="-15077.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10924.11" y="-15066.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- residual2_2&#45;&gt;ln2_2 -->
<g id="edge81" class="edge">
<title>residual2_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M10924.11,-15137.35C10924.11,-15129.2 10924.11,-15119.55 10924.11,-15110.56"/>
<polygon fill="black" stroke="black" points="10927.61,-15110.43 10924.11,-15100.43 10920.61,-15110.43 10927.61,-15110.43"/>
</g>
<!-- split_2 -->
<g id="node42" class="node">
<title>split_2</title>
<polygon fill="lightyellow" stroke="black" points="11068.17,-15022.43 10966.26,-15022.43 10940.05,-14962.43 11041.95,-14962.43 11068.17,-15022.43"/>
<text text-anchor="middle" x="11004.11" y="-14995.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="11004.11" y="-14984.43" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- ln2_2&#45;&gt;split_2 -->
<g id="edge82" class="edge">
<title>ln2_2&#45;&gt;split_2</title>
<path fill="none" stroke="black" d="M10942.66,-15059.1C10950.75,-15050.45 10960.51,-15040.02 10969.84,-15030.05"/>
<polygon fill="black" stroke="black" points="10972.58,-15032.25 10976.86,-15022.55 10967.47,-15027.46 10972.58,-15032.25"/>
</g>
<!-- agg_3 -->
<g id="node43" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="10988.17,-14925.43 10886.26,-14925.43 10860.05,-14865.43 10961.95,-14865.43 10988.17,-14925.43"/>
<text text-anchor="middle" x="10924.11" y="-14898.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="10924.11" y="-14887.43" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- ln2_2&#45;&gt;agg_3 -->
<g id="edge88" class="edge">
<title>ln2_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M10924.11,-15059.4C10924.11,-15030.06 10924.11,-14974.02 10924.11,-14935.93"/>
<polygon fill="black" stroke="black" points="10927.61,-14935.7 10924.11,-14925.7 10920.61,-14935.7 10927.61,-14935.7"/>
</g>
<!-- split_2&#45;&gt;agg_3 -->
<g id="edge83" class="edge">
<title>split_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M10979.67,-14962.41C10971.99,-14953.28 10963.4,-14943.08 10955.31,-14933.48"/>
<polygon fill="black" stroke="black" points="10957.79,-14930.99 10948.67,-14925.6 10952.44,-14935.5 10957.79,-14930.99"/>
</g>
<!-- mha_q_3 -->
<g id="node44" class="node">
<title>mha_q_3</title>
<polygon fill="lightgreen" stroke="black" points="11047.11,-14828.43 10955.11,-14828.43 10955.11,-14787.43 11047.11,-14787.43 11047.11,-14828.43"/>
<text text-anchor="middle" x="11001.11" y="-14816.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="11001.11" y="-14805.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11001.11" y="-14794.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_q_3 -->
<g id="edge89" class="edge">
<title>agg_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M10950.61,-14865C10959.1,-14855.57 10968.47,-14845.17 10976.8,-14835.92"/>
<polygon fill="black" stroke="black" points="10979.42,-14838.24 10983.51,-14828.46 10974.22,-14833.55 10979.42,-14838.24"/>
</g>
<!-- mha_k_3 -->
<g id="node45" class="node">
<title>mha_k_3</title>
<polygon fill="lightgreen" stroke="black" points="11157.11,-14828.43 11065.11,-14828.43 11065.11,-14787.43 11157.11,-14787.43 11157.11,-14828.43"/>
<text text-anchor="middle" x="11111.11" y="-14816.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="11111.11" y="-14805.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="11111.11" y="-14794.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_k_3 -->
<g id="edge90" class="edge">
<title>agg_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M10966.54,-14875.03C10993.96,-14862.49 11029.83,-14846.09 11058.99,-14832.76"/>
<polygon fill="black" stroke="black" points="11060.56,-14835.89 11068.2,-14828.55 11057.65,-14829.52 11060.56,-14835.89"/>
</g>
<!-- mha_v_3 -->
<g id="node46" class="node">
<title>mha_v_3</title>
<polygon fill="lightgreen" stroke="black" points="10937.11,-14828.43 10845.11,-14828.43 10845.11,-14787.43 10937.11,-14787.43 10937.11,-14828.43"/>
<text text-anchor="middle" x="10891.11" y="-14816.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="10891.11" y="-14805.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10891.11" y="-14794.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_v_3 -->
<g id="edge91" class="edge">
<title>agg_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M10912.75,-14865C10909.36,-14856.23 10905.66,-14846.62 10902.28,-14837.88"/>
<polygon fill="black" stroke="black" points="10905.51,-14836.53 10898.65,-14828.46 10898.98,-14839.05 10905.51,-14836.53"/>
</g>
<!-- residual1_3 -->
<g id="node49" class="node">
<title>residual1_3</title>
<polygon fill="lightpink" stroke="black" points="10875.11,-14594.43 10783.11,-14594.43 10783.11,-14553.43 10875.11,-14553.43 10875.11,-14594.43"/>
<text text-anchor="middle" x="10829.11" y="-14582.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10829.11" y="-14571.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10829.11" y="-14560.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;residual1_3 -->
<g id="edge92" class="edge">
<title>agg_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M10861.87,-14869.71C10838.33,-14855.95 10817.11,-14836.03 10817.11,-14808.93 10817.11,-14808.93 10817.11,-14808.93 10817.11,-14650.93 10817.11,-14635.49 10819.55,-14618.51 10822.23,-14604.52"/>
<polygon fill="black" stroke="black" points="10825.71,-14604.98 10824.3,-14594.48 10818.86,-14603.57 10825.71,-14604.98"/>
</g>
<!-- mha_attn_3 -->
<g id="node47" class="node">
<title>mha_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="10958.11,-14750.43 10854.11,-14750.43 10854.11,-14709.43 10958.11,-14709.43 10958.11,-14750.43"/>
<text text-anchor="middle" x="10906.11" y="-14738.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="10906.11" y="-14727.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="10906.11" y="-14716.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge84" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M10976.64,-14787.35C10965.01,-14778.05 10950.94,-14766.79 10938.44,-14756.79"/>
<polygon fill="black" stroke="black" points="10940.48,-14753.95 10930.49,-14750.43 10936.11,-14759.41 10940.48,-14753.95"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge85" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M11065.1,-14789.87C11036.43,-14779.24 10999.18,-14765.43 10967.95,-14753.85"/>
<polygon fill="black" stroke="black" points="10969.06,-14750.53 10958.46,-14750.34 10966.62,-14757.09 10969.06,-14750.53"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge86" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M10894.97,-14787.35C10896.6,-14779.11 10898.53,-14769.34 10900.32,-14760.26"/>
<polygon fill="black" stroke="black" points="10903.76,-14760.92 10902.26,-14750.43 10896.89,-14759.56 10903.76,-14760.92"/>
</g>
<!-- mha_out_3 -->
<g id="node48" class="node">
<title>mha_out_3</title>
<polygon fill="lightgreen" stroke="black" points="10940.11,-14672.43 10848.11,-14672.43 10848.11,-14631.43 10940.11,-14631.43 10940.11,-14672.43"/>
<text text-anchor="middle" x="10894.11" y="-14660.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="10894.11" y="-14649.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10894.11" y="-14638.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge87" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M10903.02,-14709.35C10901.73,-14701.2 10900.21,-14691.55 10898.79,-14682.56"/>
<polygon fill="black" stroke="black" points="10902.2,-14681.76 10897.19,-14672.43 10895.29,-14682.86 10902.2,-14681.76"/>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge93" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M10877.37,-14631.35C10869.79,-14622.49 10860.69,-14611.86 10852.46,-14602.23"/>
<polygon fill="black" stroke="black" points="10854.95,-14599.76 10845.79,-14594.43 10849.63,-14604.31 10854.95,-14599.76"/>
</g>
<!-- ln1_3 -->
<g id="node50" class="node">
<title>ln1_3</title>
<polygon fill="lightpink" stroke="black" points="10875.11,-14516.43 10783.11,-14516.43 10783.11,-14475.43 10875.11,-14475.43 10875.11,-14516.43"/>
<text text-anchor="middle" x="10829.11" y="-14504.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10829.11" y="-14493.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10829.11" y="-14482.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- residual1_3&#45;&gt;ln1_3 -->
<g id="edge94" class="edge">
<title>residual1_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M10829.11,-14553.35C10829.11,-14545.2 10829.11,-14535.55 10829.11,-14526.56"/>
<polygon fill="black" stroke="black" points="10832.61,-14526.43 10829.11,-14516.43 10825.61,-14526.43 10832.61,-14526.43"/>
</g>
<!-- gate_3 -->
<g id="node51" class="node">
<title>gate_3</title>
<polygon fill="gold" stroke="black" points="10829.11,-14438.43 10752.11,-14397.43 10829.11,-14356.43 10906.11,-14397.43 10829.11,-14438.43"/>
<text text-anchor="middle" x="10829.11" y="-14405.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="10829.11" y="-14394.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="10829.11" y="-14383.93" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;gate_3 -->
<g id="edge95" class="edge">
<title>ln1_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M10829.11,-14475.4C10829.11,-14467.63 10829.11,-14458.31 10829.11,-14448.87"/>
<polygon fill="black" stroke="black" points="10832.61,-14448.65 10829.11,-14438.65 10825.61,-14448.65 10832.61,-14448.65"/>
</g>
<!-- expert_3_0 -->
<g id="node52" class="node">
<title>expert_3_0</title>
<polygon fill="lightcoral" stroke="black" points="11566.61,-14305.43 11407.61,-14305.43 11407.61,-14264.43 11566.61,-14264.43 11566.61,-14305.43"/>
<text text-anchor="middle" x="11487.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="11487.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11487.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_0 -->
<g id="edge98" class="edge">
<title>ln1_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M10875.16,-14491.71C10942.42,-14486.05 11070.86,-14471.62 11175.11,-14438.43 11277.35,-14405.87 11388.23,-14344.87 11446.32,-14310.72"/>
<polygon fill="black" stroke="black" points="11448.36,-14313.58 11455.18,-14305.47 11444.79,-14307.55 11448.36,-14313.58"/>
</g>
<!-- expert_3_1 -->
<g id="node53" class="node">
<title>expert_3_1</title>
<polygon fill="lightcoral" stroke="black" points="10504.61,-14305.43 10345.61,-14305.43 10345.61,-14264.43 10504.61,-14264.43 10504.61,-14305.43"/>
<text text-anchor="middle" x="10425.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="10425.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10425.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_1 -->
<g id="edge101" class="edge">
<title>ln1_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M10782.93,-14490.5C10730.75,-14484.19 10644.21,-14469.69 10576.11,-14438.43 10508.57,-14407.42 10485.37,-14398.85 10442.11,-14338.43 10437.21,-14331.58 10433.67,-14323.25 10431.13,-14315.25"/>
<polygon fill="black" stroke="black" points="10434.46,-14314.16 10428.43,-14305.45 10427.71,-14316.02 10434.46,-14314.16"/>
</g>
<!-- expert_3_2 -->
<g id="node54" class="node">
<title>expert_3_2</title>
<polygon fill="lightcoral" stroke="black" points="10681.61,-14305.43 10522.61,-14305.43 10522.61,-14264.43 10681.61,-14264.43 10681.61,-14305.43"/>
<text text-anchor="middle" x="10602.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="10602.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10602.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_2 -->
<g id="edge104" class="edge">
<title>ln1_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M10783.1,-14481.78C10753.34,-14472.17 10714.45,-14457.51 10683.11,-14438.43 10625.82,-14403.55 10597.65,-14399.57 10570.11,-14338.43 10566.45,-14330.31 10568.57,-14321.91 10573.09,-14314.28"/>
<polygon fill="black" stroke="black" points="10576.26,-14315.88 10579.3,-14305.73 10570.59,-14311.76 10576.26,-14315.88"/>
</g>
<!-- expert_3_3 -->
<g id="node55" class="node">
<title>expert_3_3</title>
<polygon fill="lightcoral" stroke="black" points="10327.61,-14305.43 10168.61,-14305.43 10168.61,-14264.43 10327.61,-14264.43 10327.61,-14305.43"/>
<text text-anchor="middle" x="10248.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="10248.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10248.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_3 -->
<g id="edge107" class="edge">
<title>ln1_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M10783.09,-14495.16C10710.08,-14494 10564.49,-14485.33 10452.11,-14438.43 10380.29,-14408.46 10310.81,-14347.63 10274.39,-14312.53"/>
<polygon fill="black" stroke="black" points="10276.74,-14309.92 10267.13,-14305.45 10271.85,-14314.93 10276.74,-14309.92"/>
</g>
<!-- expert_3_4 -->
<g id="node56" class="node">
<title>expert_3_4</title>
<polygon fill="lightcoral" stroke="black" points="10858.61,-14305.43 10699.61,-14305.43 10699.61,-14264.43 10858.61,-14264.43 10858.61,-14305.43"/>
<text text-anchor="middle" x="10779.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="10779.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10779.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_4 -->
<g id="edge110" class="edge">
<title>ln1_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M10791.77,-14475.27C10775.6,-14465.59 10757.19,-14452.89 10743.11,-14438.43 10706.62,-14400.97 10695.43,-14388.72 10681.11,-14338.43 10677.71,-14326.51 10682.18,-14317.27 10690.79,-14310.11"/>
<polygon fill="black" stroke="black" points="10693,-14312.84 10699.32,-14304.34 10689.08,-14307.04 10693,-14312.84"/>
</g>
<!-- expert_3_5 -->
<g id="node57" class="node">
<title>expert_3_5</title>
<polygon fill="lightcoral" stroke="black" points="11389.61,-14305.43 11230.61,-14305.43 11230.61,-14264.43 11389.61,-14264.43 11389.61,-14305.43"/>
<text text-anchor="middle" x="11310.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="11310.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11310.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_5 -->
<g id="edge113" class="edge">
<title>ln1_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M10875.2,-14488.61C10960.75,-14474.86 11146.33,-14435.32 11267.11,-14338.43 11275.88,-14331.39 11284.09,-14322.29 11290.94,-14313.66"/>
<polygon fill="black" stroke="black" points="11293.8,-14315.68 11297.06,-14305.61 11288.22,-14311.45 11293.8,-14315.68"/>
</g>
<!-- expert_3_6 -->
<g id="node58" class="node">
<title>expert_3_6</title>
<polygon fill="lightcoral" stroke="black" points="11035.61,-14305.43 10876.61,-14305.43 10876.61,-14264.43 11035.61,-14264.43 11035.61,-14305.43"/>
<text text-anchor="middle" x="10956.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="10956.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10956.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_6 -->
<g id="edge116" class="edge">
<title>ln1_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M10872.47,-14475.29C10920.03,-14450.97 10993.42,-14404.51 11022.11,-14338.43 11026.66,-14327.94 11022.29,-14318.96 11014.02,-14311.55"/>
<polygon fill="black" stroke="black" points="11015.97,-14308.64 11005.87,-14305.44 11011.77,-14314.24 11015.97,-14308.64"/>
</g>
<!-- expert_3_7 -->
<g id="node59" class="node">
<title>expert_3_7</title>
<polygon fill="lightcoral" stroke="black" points="11212.61,-14305.43 11053.61,-14305.43 11053.61,-14264.43 11212.61,-14264.43 11212.61,-14305.43"/>
<text text-anchor="middle" x="11133.11" y="-14293.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="11133.11" y="-14282.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="11133.11" y="-14271.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_3_7 -->
<g id="edge119" class="edge">
<title>ln1_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M10875.32,-14482.03C10907.78,-14472.13 10951.72,-14457.03 10988.11,-14438.43 11057.81,-14402.79 11096.71,-14407.74 11133.11,-14338.43 11136.69,-14331.6 11137.91,-14323.56 11137.93,-14315.84"/>
<polygon fill="black" stroke="black" points="11141.41,-14315.45 11137.33,-14305.68 11134.42,-14315.87 11141.41,-14315.45"/>
</g>
<!-- expert_agg_3 -->
<g id="node60" class="node">
<title>expert_agg_3</title>
<polygon fill="lightyellow" stroke="black" points="10951.88,-14227.43 10788.39,-14227.43 10746.33,-14145.43 10909.83,-14145.43 10951.88,-14227.43"/>
<text text-anchor="middle" x="10849.11" y="-14194.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="10849.11" y="-14183.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10849.11" y="-14172.93" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;expert_agg_3 -->
<g id="edge96" class="edge">
<title>ln1_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10875.42,-14495.65C11066.77,-14497.2 11776.48,-14488.28 11575.11,-14264.43 11533.57,-14218.25 11129.99,-14197.64 10943.16,-14190.52"/>
<polygon fill="black" stroke="black" points="10943.19,-14187.02 10933.07,-14190.14 10942.93,-14194.02 10943.19,-14187.02"/>
</g>
<!-- residual2_3 -->
<g id="node61" class="node">
<title>residual2_3</title>
<polygon fill="lightpink" stroke="black" points="10199.11,-14108.43 10107.11,-14108.43 10107.11,-14067.43 10199.11,-14067.43 10199.11,-14108.43"/>
<text text-anchor="middle" x="10153.11" y="-14096.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10153.11" y="-14085.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10153.11" y="-14074.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;residual2_3 -->
<g id="edge122" class="edge">
<title>ln1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M10782.9,-14493.32C10628.64,-14487.37 10141.11,-14463.41 10141.11,-14398.43 10141.11,-14398.43 10141.11,-14398.43 10141.11,-14185.43 10141.11,-14162.78 10144.4,-14137.37 10147.54,-14118.31"/>
<polygon fill="black" stroke="black" points="10150.99,-14118.88 10149.24,-14108.43 10144.09,-14117.69 10150.99,-14118.88"/>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge97" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10888.69,-14388.04C10990.71,-14373.43 11205.56,-14341.58 11397.58,-14305.47"/>
<polygon fill="black" stroke="black" points="11398.4,-14308.88 11407.58,-14303.59 11397.1,-14302 11398.4,-14308.88"/>
<text text-anchor="middle" x="11321.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge100" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10778.93,-14382.9C10735.55,-14371.19 10671.17,-14353.77 10615.11,-14338.43 10579.06,-14328.56 10539.18,-14317.56 10505.31,-14308.18"/>
<polygon fill="black" stroke="black" points="10506.04,-14304.75 10495.47,-14305.46 10504.17,-14311.5 10506.04,-14304.75"/>
<text text-anchor="middle" x="10646.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge103" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10789.83,-14377.3C10751.49,-14358.64 10693.02,-14330.18 10651.54,-14309.99"/>
<polygon fill="black" stroke="black" points="10652.96,-14306.79 10642.43,-14305.56 10649.89,-14313.08 10652.96,-14306.79"/>
<text text-anchor="middle" x="10740.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge106" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10771.56,-14386.96C10705.09,-14375.9 10592.53,-14356.76 10496.11,-14338.43 10427.84,-14325.44 10408.73,-14321 10337.62,-14305.74"/>
<polygon fill="black" stroke="black" points="10338.23,-14302.3 10327.72,-14303.62 10336.77,-14309.14 10338.23,-14302.3"/>
<text text-anchor="middle" x="10527.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_3&#45;&gt;expert_3_4 -->
<g id="edge109" class="edge">
<title>gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10805.04,-14368.84C10798.23,-14359.7 10791.49,-14349.12 10787.11,-14338.43 10784.17,-14331.27 10782.31,-14323.17 10781.12,-14315.51"/>
<polygon fill="black" stroke="black" points="10784.58,-14314.96 10779.88,-14305.47 10777.63,-14315.82 10784.58,-14314.96"/>
<text text-anchor="middle" x="10818.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_3&#45;&gt;expert_3_5 -->
<g id="edge112" class="edge">
<title>gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10879.33,-14383.09C10923.52,-14371.35 10989.59,-14353.78 11047.11,-14338.43 11072,-14331.78 11077.89,-14328.71 11103.11,-14323.43 11152.09,-14313.16 11167.25,-14314.86 11220.55,-14305.44"/>
<polygon fill="black" stroke="black" points="11221.37,-14308.85 11230.58,-14303.62 11220.12,-14301.96 11221.37,-14308.85"/>
<text text-anchor="middle" x="11134.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_3&#45;&gt;expert_3_6 -->
<g id="edge115" class="edge">
<title>gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10843.26,-14363.94C10850.57,-14350.06 10860.61,-14334.53 10873.11,-14323.43 10878.55,-14318.59 10884.73,-14314.28 10891.19,-14310.46"/>
<polygon fill="black" stroke="black" points="10893.05,-14313.43 10900.14,-14305.56 10889.69,-14307.29 10893.05,-14313.43"/>
<text text-anchor="middle" x="10904.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_3&#45;&gt;expert_3_7 -->
<g id="edge118" class="edge">
<title>gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10866.77,-14376.16C10897.63,-14360.18 10942.79,-14338.2 10984.11,-14323.43 10995.86,-14319.22 11018.93,-14313.08 11043.47,-14306.98"/>
<polygon fill="black" stroke="black" points="11044.43,-14310.35 11053.3,-14304.56 11042.75,-14303.56 11044.43,-14310.35"/>
<text text-anchor="middle" x="11015.61" y="-14327.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge99" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11407.59,-14266.19C11404.39,-14265.58 11401.22,-14264.99 11398.11,-14264.43 11241.02,-14236.24 11057.09,-14212.26 10947,-14198.87"/>
<polygon fill="black" stroke="black" points="10947.26,-14195.37 10936.91,-14197.64 10946.42,-14202.32 10947.26,-14195.37"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge102" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10504.86,-14265.78C10579.47,-14248.79 10690.48,-14223.53 10766.12,-14206.31"/>
<polygon fill="black" stroke="black" points="10767.11,-14209.68 10776.09,-14204.05 10765.56,-14202.85 10767.11,-14209.68"/>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge105" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10652.09,-14264.4C10686.4,-14250.99 10732.61,-14232.94 10771.65,-14217.69"/>
<polygon fill="black" stroke="black" points="10773.37,-14220.77 10781.41,-14213.88 10770.82,-14214.25 10773.37,-14220.77"/>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge108" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10327.68,-14266.03C10330.52,-14265.48 10333.34,-14264.94 10336.11,-14264.43 10485.43,-14236.71 10660.63,-14212.1 10762.82,-14198.53"/>
<polygon fill="black" stroke="black" points="10763.33,-14201.99 10772.78,-14197.21 10762.41,-14195.05 10763.33,-14201.99"/>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge111" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10793.27,-14264.4C10799.33,-14256.05 10806.68,-14245.91 10814.05,-14235.76"/>
<polygon fill="black" stroke="black" points="10816.89,-14237.8 10819.93,-14227.65 10811.22,-14233.69 10816.89,-14237.8"/>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge114" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11230.54,-14266.45C11227.36,-14265.76 11224.2,-14265.09 11221.11,-14264.43 11129.9,-14245 11025.95,-14223.54 10951.17,-14208.22"/>
<polygon fill="black" stroke="black" points="10951.78,-14204.77 10941.28,-14206.2 10950.37,-14211.63 10951.78,-14204.77"/>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge117" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M10934.45,-14264.4C10924.84,-14255.72 10913.06,-14245.1 10901.36,-14234.55"/>
<polygon fill="black" stroke="black" points="10903.48,-14231.75 10893.71,-14227.65 10898.79,-14236.95 10903.48,-14231.75"/>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge120" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M11075.64,-14264.4C11041.95,-14252.95 10998.28,-14238.11 10958.29,-14224.53"/>
<polygon fill="black" stroke="black" points="10959.35,-14221.19 10948.75,-14221.28 10957.09,-14227.82 10959.35,-14221.19"/>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge121" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M10760.25,-14173.11C10614.79,-14152.94 10329.96,-14113.45 10209.28,-14096.71"/>
<polygon fill="black" stroke="black" points="10209.54,-14093.22 10199.16,-14095.31 10208.58,-14100.15 10209.54,-14093.22"/>
</g>
<!-- ln2_3 -->
<g id="node62" class="node">
<title>ln2_3</title>
<polygon fill="lightpink" stroke="black" points="10199.11,-14030.43 10107.11,-14030.43 10107.11,-13989.43 10199.11,-13989.43 10199.11,-14030.43"/>
<text text-anchor="middle" x="10153.11" y="-14018.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10153.11" y="-14007.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10153.11" y="-13996.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- residual2_3&#45;&gt;ln2_3 -->
<g id="edge123" class="edge">
<title>residual2_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M10153.11,-14067.35C10153.11,-14059.2 10153.11,-14049.55 10153.11,-14040.56"/>
<polygon fill="black" stroke="black" points="10156.61,-14040.43 10153.11,-14030.43 10149.61,-14040.43 10156.61,-14040.43"/>
</g>
<!-- split_3 -->
<g id="node63" class="node">
<title>split_3</title>
<polygon fill="lightyellow" stroke="black" points="10297.17,-13952.43 10195.26,-13952.43 10169.05,-13892.43 10270.95,-13892.43 10297.17,-13952.43"/>
<text text-anchor="middle" x="10233.11" y="-13925.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="10233.11" y="-13914.43" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- ln2_3&#45;&gt;split_3 -->
<g id="edge124" class="edge">
<title>ln2_3&#45;&gt;split_3</title>
<path fill="none" stroke="black" d="M10171.66,-13989.1C10179.75,-13980.45 10189.51,-13970.02 10198.84,-13960.05"/>
<polygon fill="black" stroke="black" points="10201.58,-13962.25 10205.86,-13952.55 10196.47,-13957.46 10201.58,-13962.25"/>
</g>
<!-- agg_4 -->
<g id="node64" class="node">
<title>agg_4</title>
<polygon fill="lightyellow" stroke="black" points="10217.17,-13855.43 10115.26,-13855.43 10089.05,-13795.43 10190.95,-13795.43 10217.17,-13855.43"/>
<text text-anchor="middle" x="10153.11" y="-13828.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="10153.11" y="-13817.43" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- ln2_3&#45;&gt;agg_4 -->
<g id="edge130" class="edge">
<title>ln2_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M10153.11,-13989.4C10153.11,-13960.06 10153.11,-13904.02 10153.11,-13865.93"/>
<polygon fill="black" stroke="black" points="10156.61,-13865.7 10153.11,-13855.7 10149.61,-13865.7 10156.61,-13865.7"/>
</g>
<!-- split_3&#45;&gt;agg_4 -->
<g id="edge125" class="edge">
<title>split_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M10208.67,-13892.41C10200.99,-13883.28 10192.4,-13873.08 10184.31,-13863.48"/>
<polygon fill="black" stroke="black" points="10186.79,-13860.99 10177.67,-13855.6 10181.44,-13865.5 10186.79,-13860.99"/>
</g>
<!-- mha_q_4 -->
<g id="node65" class="node">
<title>mha_q_4</title>
<polygon fill="lightgreen" stroke="black" points="10276.11,-13758.43 10184.11,-13758.43 10184.11,-13717.43 10276.11,-13717.43 10276.11,-13758.43"/>
<text text-anchor="middle" x="10230.11" y="-13746.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="10230.11" y="-13735.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10230.11" y="-13724.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_q_4 -->
<g id="edge131" class="edge">
<title>agg_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M10179.61,-13795C10188.1,-13785.57 10197.47,-13775.17 10205.8,-13765.92"/>
<polygon fill="black" stroke="black" points="10208.42,-13768.24 10212.51,-13758.46 10203.22,-13763.55 10208.42,-13768.24"/>
</g>
<!-- mha_k_4 -->
<g id="node66" class="node">
<title>mha_k_4</title>
<polygon fill="lightgreen" stroke="black" points="10386.11,-13758.43 10294.11,-13758.43 10294.11,-13717.43 10386.11,-13717.43 10386.11,-13758.43"/>
<text text-anchor="middle" x="10340.11" y="-13746.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="10340.11" y="-13735.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10340.11" y="-13724.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_k_4 -->
<g id="edge132" class="edge">
<title>agg_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M10195.54,-13805.03C10222.96,-13792.49 10258.83,-13776.09 10287.99,-13762.76"/>
<polygon fill="black" stroke="black" points="10289.56,-13765.89 10297.2,-13758.55 10286.65,-13759.52 10289.56,-13765.89"/>
</g>
<!-- mha_v_4 -->
<g id="node67" class="node">
<title>mha_v_4</title>
<polygon fill="lightgreen" stroke="black" points="10166.11,-13758.43 10074.11,-13758.43 10074.11,-13717.43 10166.11,-13717.43 10166.11,-13758.43"/>
<text text-anchor="middle" x="10120.11" y="-13746.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="10120.11" y="-13735.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10120.11" y="-13724.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_v_4 -->
<g id="edge133" class="edge">
<title>agg_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M10141.75,-13795C10138.36,-13786.23 10134.66,-13776.62 10131.28,-13767.88"/>
<polygon fill="black" stroke="black" points="10134.51,-13766.53 10127.65,-13758.46 10127.98,-13769.05 10134.51,-13766.53"/>
</g>
<!-- residual1_4 -->
<g id="node70" class="node">
<title>residual1_4</title>
<polygon fill="lightpink" stroke="black" points="10104.11,-13524.43 10012.11,-13524.43 10012.11,-13483.43 10104.11,-13483.43 10104.11,-13524.43"/>
<text text-anchor="middle" x="10058.11" y="-13512.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="10058.11" y="-13501.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10058.11" y="-13490.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;residual1_4 -->
<g id="edge134" class="edge">
<title>agg_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M10090.87,-13799.71C10067.33,-13785.95 10046.11,-13766.03 10046.11,-13738.93 10046.11,-13738.93 10046.11,-13738.93 10046.11,-13580.93 10046.11,-13565.49 10048.55,-13548.51 10051.23,-13534.52"/>
<polygon fill="black" stroke="black" points="10054.71,-13534.98 10053.3,-13524.48 10047.86,-13533.57 10054.71,-13534.98"/>
</g>
<!-- mha_attn_4 -->
<g id="node68" class="node">
<title>mha_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="10187.11,-13680.43 10083.11,-13680.43 10083.11,-13639.43 10187.11,-13639.43 10187.11,-13680.43"/>
<text text-anchor="middle" x="10135.11" y="-13668.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="10135.11" y="-13657.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="10135.11" y="-13646.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge126" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M10205.64,-13717.35C10194.01,-13708.05 10179.94,-13696.79 10167.44,-13686.79"/>
<polygon fill="black" stroke="black" points="10169.48,-13683.95 10159.49,-13680.43 10165.11,-13689.41 10169.48,-13683.95"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge127" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M10294.1,-13719.87C10265.43,-13709.24 10228.18,-13695.43 10196.95,-13683.85"/>
<polygon fill="black" stroke="black" points="10198.06,-13680.53 10187.46,-13680.34 10195.62,-13687.09 10198.06,-13680.53"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge128" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M10123.97,-13717.35C10125.6,-13709.11 10127.53,-13699.34 10129.32,-13690.26"/>
<polygon fill="black" stroke="black" points="10132.76,-13690.92 10131.26,-13680.43 10125.89,-13689.56 10132.76,-13690.92"/>
</g>
<!-- mha_out_4 -->
<g id="node69" class="node">
<title>mha_out_4</title>
<polygon fill="lightgreen" stroke="black" points="10169.11,-13602.43 10077.11,-13602.43 10077.11,-13561.43 10169.11,-13561.43 10169.11,-13602.43"/>
<text text-anchor="middle" x="10123.11" y="-13590.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="10123.11" y="-13579.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10123.11" y="-13568.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge129" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M10132.02,-13639.35C10130.73,-13631.2 10129.21,-13621.55 10127.79,-13612.56"/>
<polygon fill="black" stroke="black" points="10131.2,-13611.76 10126.19,-13602.43 10124.29,-13612.86 10131.2,-13611.76"/>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge135" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M10106.37,-13561.35C10098.79,-13552.49 10089.69,-13541.86 10081.46,-13532.23"/>
<polygon fill="black" stroke="black" points="10083.95,-13529.76 10074.79,-13524.43 10078.63,-13534.31 10083.95,-13529.76"/>
</g>
<!-- ln1_4 -->
<g id="node71" class="node">
<title>ln1_4</title>
<polygon fill="lightpink" stroke="black" points="10104.11,-13446.43 10012.11,-13446.43 10012.11,-13405.43 10104.11,-13405.43 10104.11,-13446.43"/>
<text text-anchor="middle" x="10058.11" y="-13434.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="10058.11" y="-13423.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10058.11" y="-13412.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- residual1_4&#45;&gt;ln1_4 -->
<g id="edge136" class="edge">
<title>residual1_4&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M10058.11,-13483.35C10058.11,-13475.2 10058.11,-13465.55 10058.11,-13456.56"/>
<polygon fill="black" stroke="black" points="10061.61,-13456.43 10058.11,-13446.43 10054.61,-13456.43 10061.61,-13456.43"/>
</g>
<!-- gate_4 -->
<g id="node72" class="node">
<title>gate_4</title>
<polygon fill="gold" stroke="black" points="10058.11,-13368.43 9981.11,-13327.43 10058.11,-13286.43 10135.11,-13327.43 10058.11,-13368.43"/>
<text text-anchor="middle" x="10058.11" y="-13335.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="10058.11" y="-13324.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="10058.11" y="-13313.93" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;gate_4 -->
<g id="edge137" class="edge">
<title>ln1_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M10058.11,-13405.4C10058.11,-13397.63 10058.11,-13388.31 10058.11,-13378.87"/>
<polygon fill="black" stroke="black" points="10061.61,-13378.65 10058.11,-13368.65 10054.61,-13378.65 10061.61,-13378.65"/>
</g>
<!-- expert_4_0 -->
<g id="node73" class="node">
<title>expert_4_0</title>
<polygon fill="lightcoral" stroke="black" points="10795.61,-13235.43 10636.61,-13235.43 10636.61,-13194.43 10795.61,-13194.43 10795.61,-13235.43"/>
<text text-anchor="middle" x="10716.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="10716.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10716.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_0 -->
<g id="edge140" class="edge">
<title>ln1_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M10104.16,-13421.71C10171.42,-13416.05 10299.86,-13401.62 10404.11,-13368.43 10506.35,-13335.87 10617.23,-13274.87 10675.32,-13240.72"/>
<polygon fill="black" stroke="black" points="10677.36,-13243.58 10684.18,-13235.47 10673.79,-13237.55 10677.36,-13243.58"/>
</g>
<!-- expert_4_1 -->
<g id="node74" class="node">
<title>expert_4_1</title>
<polygon fill="lightcoral" stroke="black" points="9733.61,-13235.43 9574.61,-13235.43 9574.61,-13194.43 9733.61,-13194.43 9733.61,-13235.43"/>
<text text-anchor="middle" x="9654.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="9654.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9654.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_1 -->
<g id="edge143" class="edge">
<title>ln1_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M10011.93,-13420.5C9959.75,-13414.19 9873.21,-13399.69 9805.11,-13368.43 9737.57,-13337.42 9714.37,-13328.85 9671.11,-13268.43 9666.21,-13261.58 9662.67,-13253.25 9660.13,-13245.25"/>
<polygon fill="black" stroke="black" points="9663.46,-13244.16 9657.43,-13235.45 9656.71,-13246.02 9663.46,-13244.16"/>
</g>
<!-- expert_4_2 -->
<g id="node75" class="node">
<title>expert_4_2</title>
<polygon fill="lightcoral" stroke="black" points="9910.61,-13235.43 9751.61,-13235.43 9751.61,-13194.43 9910.61,-13194.43 9910.61,-13235.43"/>
<text text-anchor="middle" x="9831.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="9831.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9831.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_2 -->
<g id="edge146" class="edge">
<title>ln1_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M10012.1,-13411.78C9982.34,-13402.17 9943.45,-13387.51 9912.11,-13368.43 9854.82,-13333.55 9826.65,-13329.57 9799.11,-13268.43 9795.45,-13260.31 9797.57,-13251.91 9802.09,-13244.28"/>
<polygon fill="black" stroke="black" points="9805.26,-13245.88 9808.3,-13235.73 9799.59,-13241.76 9805.26,-13245.88"/>
</g>
<!-- expert_4_3 -->
<g id="node76" class="node">
<title>expert_4_3</title>
<polygon fill="lightcoral" stroke="black" points="9556.61,-13235.43 9397.61,-13235.43 9397.61,-13194.43 9556.61,-13194.43 9556.61,-13235.43"/>
<text text-anchor="middle" x="9477.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="9477.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9477.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_3 -->
<g id="edge149" class="edge">
<title>ln1_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M10012.09,-13425.16C9939.08,-13424 9793.49,-13415.33 9681.11,-13368.43 9609.29,-13338.46 9539.81,-13277.63 9503.39,-13242.53"/>
<polygon fill="black" stroke="black" points="9505.74,-13239.92 9496.13,-13235.45 9500.85,-13244.93 9505.74,-13239.92"/>
</g>
<!-- expert_4_4 -->
<g id="node77" class="node">
<title>expert_4_4</title>
<polygon fill="lightcoral" stroke="black" points="10087.61,-13235.43 9928.61,-13235.43 9928.61,-13194.43 10087.61,-13194.43 10087.61,-13235.43"/>
<text text-anchor="middle" x="10008.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="10008.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10008.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_4 -->
<g id="edge152" class="edge">
<title>ln1_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M10020.77,-13405.27C10004.6,-13395.59 9986.19,-13382.89 9972.11,-13368.43 9935.62,-13330.97 9924.43,-13318.72 9910.11,-13268.43 9906.71,-13256.51 9911.18,-13247.27 9919.79,-13240.11"/>
<polygon fill="black" stroke="black" points="9922,-13242.84 9928.32,-13234.34 9918.08,-13237.04 9922,-13242.84"/>
</g>
<!-- expert_4_5 -->
<g id="node78" class="node">
<title>expert_4_5</title>
<polygon fill="lightcoral" stroke="black" points="10618.61,-13235.43 10459.61,-13235.43 10459.61,-13194.43 10618.61,-13194.43 10618.61,-13235.43"/>
<text text-anchor="middle" x="10539.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="10539.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10539.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_5 -->
<g id="edge155" class="edge">
<title>ln1_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M10104.2,-13418.61C10189.75,-13404.86 10375.33,-13365.32 10496.11,-13268.43 10504.88,-13261.39 10513.09,-13252.29 10519.94,-13243.66"/>
<polygon fill="black" stroke="black" points="10522.8,-13245.68 10526.06,-13235.61 10517.22,-13241.45 10522.8,-13245.68"/>
</g>
<!-- expert_4_6 -->
<g id="node79" class="node">
<title>expert_4_6</title>
<polygon fill="lightcoral" stroke="black" points="10264.61,-13235.43 10105.61,-13235.43 10105.61,-13194.43 10264.61,-13194.43 10264.61,-13235.43"/>
<text text-anchor="middle" x="10185.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="10185.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10185.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_6 -->
<g id="edge158" class="edge">
<title>ln1_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M10101.47,-13405.29C10149.03,-13380.97 10222.42,-13334.51 10251.11,-13268.43 10255.66,-13257.94 10251.29,-13248.96 10243.02,-13241.55"/>
<polygon fill="black" stroke="black" points="10244.97,-13238.64 10234.87,-13235.44 10240.77,-13244.24 10244.97,-13238.64"/>
</g>
<!-- expert_4_7 -->
<g id="node80" class="node">
<title>expert_4_7</title>
<polygon fill="lightcoral" stroke="black" points="10441.61,-13235.43 10282.61,-13235.43 10282.61,-13194.43 10441.61,-13194.43 10441.61,-13235.43"/>
<text text-anchor="middle" x="10362.11" y="-13223.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="10362.11" y="-13212.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="10362.11" y="-13201.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_4_7 -->
<g id="edge161" class="edge">
<title>ln1_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M10104.32,-13412.03C10136.78,-13402.13 10180.72,-13387.03 10217.11,-13368.43 10286.81,-13332.79 10325.71,-13337.74 10362.11,-13268.43 10365.69,-13261.6 10366.91,-13253.56 10366.93,-13245.84"/>
<polygon fill="black" stroke="black" points="10370.41,-13245.45 10366.33,-13235.68 10363.42,-13245.87 10370.41,-13245.45"/>
</g>
<!-- expert_agg_4 -->
<g id="node81" class="node">
<title>expert_agg_4</title>
<polygon fill="lightyellow" stroke="black" points="10180.88,-13157.43 10017.39,-13157.43 9975.33,-13075.43 10138.83,-13075.43 10180.88,-13157.43"/>
<text text-anchor="middle" x="10078.11" y="-13124.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="10078.11" y="-13113.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="10078.11" y="-13102.93" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;expert_agg_4 -->
<g id="edge138" class="edge">
<title>ln1_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10104.42,-13425.65C10295.77,-13427.2 11005.48,-13418.28 10804.11,-13194.43 10762.57,-13148.25 10358.99,-13127.64 10172.16,-13120.52"/>
<polygon fill="black" stroke="black" points="10172.19,-13117.02 10162.07,-13120.14 10171.93,-13124.02 10172.19,-13117.02"/>
</g>
<!-- residual2_4 -->
<g id="node82" class="node">
<title>residual2_4</title>
<polygon fill="lightpink" stroke="black" points="9428.11,-13038.43 9336.11,-13038.43 9336.11,-12997.43 9428.11,-12997.43 9428.11,-13038.43"/>
<text text-anchor="middle" x="9382.11" y="-13026.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9382.11" y="-13015.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9382.11" y="-13004.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;residual2_4 -->
<g id="edge164" class="edge">
<title>ln1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M10011.9,-13423.32C9857.64,-13417.37 9370.11,-13393.41 9370.11,-13328.43 9370.11,-13328.43 9370.11,-13328.43 9370.11,-13115.43 9370.11,-13092.78 9373.4,-13067.37 9376.54,-13048.31"/>
<polygon fill="black" stroke="black" points="9379.99,-13048.88 9378.24,-13038.43 9373.09,-13047.69 9379.99,-13048.88"/>
</g>
<!-- gate_4&#45;&gt;expert_4_0 -->
<g id="edge139" class="edge">
<title>gate_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10117.69,-13318.04C10219.71,-13303.43 10434.56,-13271.58 10626.58,-13235.47"/>
<polygon fill="black" stroke="black" points="10627.4,-13238.88 10636.58,-13233.59 10626.1,-13232 10627.4,-13238.88"/>
<text text-anchor="middle" x="10550.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_4&#45;&gt;expert_4_1 -->
<g id="edge142" class="edge">
<title>gate_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10007.93,-13312.9C9964.55,-13301.19 9900.17,-13283.77 9844.11,-13268.43 9808.06,-13258.56 9768.18,-13247.56 9734.31,-13238.18"/>
<polygon fill="black" stroke="black" points="9735.04,-13234.75 9724.47,-13235.46 9733.17,-13241.5 9735.04,-13234.75"/>
<text text-anchor="middle" x="9875.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_4&#45;&gt;expert_4_2 -->
<g id="edge145" class="edge">
<title>gate_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10018.83,-13307.3C9980.49,-13288.64 9922.02,-13260.18 9880.54,-13239.99"/>
<polygon fill="black" stroke="black" points="9881.96,-13236.79 9871.43,-13235.56 9878.89,-13243.08 9881.96,-13236.79"/>
<text text-anchor="middle" x="9969.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_4&#45;&gt;expert_4_3 -->
<g id="edge148" class="edge">
<title>gate_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10000.56,-13316.96C9934.09,-13305.9 9821.53,-13286.76 9725.11,-13268.43 9656.84,-13255.44 9637.73,-13251 9566.62,-13235.74"/>
<polygon fill="black" stroke="black" points="9567.23,-13232.3 9556.72,-13233.62 9565.77,-13239.14 9567.23,-13232.3"/>
<text text-anchor="middle" x="9756.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_4&#45;&gt;expert_4_4 -->
<g id="edge151" class="edge">
<title>gate_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10034.04,-13298.84C10027.23,-13289.7 10020.49,-13279.12 10016.11,-13268.43 10013.17,-13261.27 10011.31,-13253.17 10010.12,-13245.51"/>
<polygon fill="black" stroke="black" points="10013.58,-13244.96 10008.88,-13235.47 10006.63,-13245.82 10013.58,-13244.96"/>
<text text-anchor="middle" x="10047.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_4&#45;&gt;expert_4_5 -->
<g id="edge154" class="edge">
<title>gate_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10108.33,-13313.09C10152.52,-13301.35 10218.59,-13283.78 10276.11,-13268.43 10301,-13261.78 10306.89,-13258.71 10332.11,-13253.43 10381.09,-13243.16 10396.25,-13244.86 10449.55,-13235.44"/>
<polygon fill="black" stroke="black" points="10450.37,-13238.85 10459.58,-13233.62 10449.12,-13231.96 10450.37,-13238.85"/>
<text text-anchor="middle" x="10363.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_4&#45;&gt;expert_4_6 -->
<g id="edge157" class="edge">
<title>gate_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10072.26,-13293.94C10079.57,-13280.06 10089.61,-13264.53 10102.11,-13253.43 10107.55,-13248.59 10113.73,-13244.28 10120.19,-13240.46"/>
<polygon fill="black" stroke="black" points="10122.05,-13243.43 10129.14,-13235.56 10118.69,-13237.29 10122.05,-13243.43"/>
<text text-anchor="middle" x="10133.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_4&#45;&gt;expert_4_7 -->
<g id="edge160" class="edge">
<title>gate_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10095.77,-13306.16C10126.63,-13290.18 10171.79,-13268.2 10213.11,-13253.43 10224.86,-13249.22 10247.93,-13243.08 10272.47,-13236.98"/>
<polygon fill="black" stroke="black" points="10273.43,-13240.35 10282.3,-13234.56 10271.75,-13233.56 10273.43,-13240.35"/>
<text text-anchor="middle" x="10244.61" y="-13257.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_4_0&#45;&gt;expert_agg_4 -->
<g id="edge141" class="edge">
<title>expert_4_0&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10636.59,-13196.19C10633.39,-13195.58 10630.22,-13194.99 10627.11,-13194.43 10470.02,-13166.24 10286.09,-13142.26 10176,-13128.87"/>
<polygon fill="black" stroke="black" points="10176.26,-13125.37 10165.91,-13127.64 10175.42,-13132.32 10176.26,-13125.37"/>
</g>
<!-- expert_4_1&#45;&gt;expert_agg_4 -->
<g id="edge144" class="edge">
<title>expert_4_1&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M9733.86,-13195.78C9808.47,-13178.79 9919.48,-13153.53 9995.12,-13136.31"/>
<polygon fill="black" stroke="black" points="9996.11,-13139.68 10005.09,-13134.05 9994.56,-13132.85 9996.11,-13139.68"/>
</g>
<!-- expert_4_2&#45;&gt;expert_agg_4 -->
<g id="edge147" class="edge">
<title>expert_4_2&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M9881.09,-13194.4C9915.4,-13180.99 9961.61,-13162.94 10000.65,-13147.69"/>
<polygon fill="black" stroke="black" points="10002.37,-13150.77 10010.41,-13143.88 9999.82,-13144.25 10002.37,-13150.77"/>
</g>
<!-- expert_4_3&#45;&gt;expert_agg_4 -->
<g id="edge150" class="edge">
<title>expert_4_3&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M9556.68,-13196.03C9559.52,-13195.48 9562.34,-13194.94 9565.11,-13194.43 9714.43,-13166.71 9889.63,-13142.1 9991.82,-13128.53"/>
<polygon fill="black" stroke="black" points="9992.33,-13131.99 10001.78,-13127.21 9991.41,-13125.05 9992.33,-13131.99"/>
</g>
<!-- expert_4_4&#45;&gt;expert_agg_4 -->
<g id="edge153" class="edge">
<title>expert_4_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10022.27,-13194.4C10028.33,-13186.05 10035.68,-13175.91 10043.05,-13165.76"/>
<polygon fill="black" stroke="black" points="10045.89,-13167.8 10048.93,-13157.65 10040.22,-13163.69 10045.89,-13167.8"/>
</g>
<!-- expert_4_5&#45;&gt;expert_agg_4 -->
<g id="edge156" class="edge">
<title>expert_4_5&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10459.54,-13196.45C10456.36,-13195.76 10453.2,-13195.09 10450.11,-13194.43 10358.9,-13175 10254.95,-13153.54 10180.17,-13138.22"/>
<polygon fill="black" stroke="black" points="10180.78,-13134.77 10170.28,-13136.2 10179.37,-13141.63 10180.78,-13134.77"/>
</g>
<!-- expert_4_6&#45;&gt;expert_agg_4 -->
<g id="edge159" class="edge">
<title>expert_4_6&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10163.45,-13194.4C10153.84,-13185.72 10142.06,-13175.1 10130.36,-13164.55"/>
<polygon fill="black" stroke="black" points="10132.48,-13161.75 10122.71,-13157.65 10127.79,-13166.95 10132.48,-13161.75"/>
</g>
<!-- expert_4_7&#45;&gt;expert_agg_4 -->
<g id="edge162" class="edge">
<title>expert_4_7&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M10304.64,-13194.4C10270.95,-13182.95 10227.28,-13168.11 10187.29,-13154.53"/>
<polygon fill="black" stroke="black" points="10188.35,-13151.19 10177.75,-13151.28 10186.09,-13157.82 10188.35,-13151.19"/>
</g>
<!-- expert_agg_4&#45;&gt;residual2_4 -->
<g id="edge163" class="edge">
<title>expert_agg_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M9989.25,-13103.11C9843.79,-13082.94 9558.96,-13043.45 9438.28,-13026.71"/>
<polygon fill="black" stroke="black" points="9438.54,-13023.22 9428.16,-13025.31 9437.58,-13030.15 9438.54,-13023.22"/>
</g>
<!-- ln2_4 -->
<g id="node83" class="node">
<title>ln2_4</title>
<polygon fill="lightpink" stroke="black" points="9428.11,-12960.43 9336.11,-12960.43 9336.11,-12919.43 9428.11,-12919.43 9428.11,-12960.43"/>
<text text-anchor="middle" x="9382.11" y="-12948.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="9382.11" y="-12937.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9382.11" y="-12926.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- residual2_4&#45;&gt;ln2_4 -->
<g id="edge165" class="edge">
<title>residual2_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M9382.11,-12997.35C9382.11,-12989.2 9382.11,-12979.55 9382.11,-12970.56"/>
<polygon fill="black" stroke="black" points="9385.61,-12970.43 9382.11,-12960.43 9378.61,-12970.43 9385.61,-12970.43"/>
</g>
<!-- split_4 -->
<g id="node84" class="node">
<title>split_4</title>
<polygon fill="lightyellow" stroke="black" points="9526.17,-12882.43 9424.26,-12882.43 9398.05,-12822.43 9499.95,-12822.43 9526.17,-12882.43"/>
<text text-anchor="middle" x="9462.11" y="-12855.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="9462.11" y="-12844.43" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- ln2_4&#45;&gt;split_4 -->
<g id="edge166" class="edge">
<title>ln2_4&#45;&gt;split_4</title>
<path fill="none" stroke="black" d="M9400.66,-12919.1C9408.75,-12910.45 9418.51,-12900.02 9427.84,-12890.05"/>
<polygon fill="black" stroke="black" points="9430.58,-12892.25 9434.86,-12882.55 9425.47,-12887.46 9430.58,-12892.25"/>
</g>
<!-- agg_5 -->
<g id="node85" class="node">
<title>agg_5</title>
<polygon fill="lightyellow" stroke="black" points="9446.17,-12785.43 9344.26,-12785.43 9318.05,-12725.43 9419.95,-12725.43 9446.17,-12785.43"/>
<text text-anchor="middle" x="9382.11" y="-12758.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="9382.11" y="-12747.43" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- ln2_4&#45;&gt;agg_5 -->
<g id="edge172" class="edge">
<title>ln2_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M9382.11,-12919.4C9382.11,-12890.06 9382.11,-12834.02 9382.11,-12795.93"/>
<polygon fill="black" stroke="black" points="9385.61,-12795.7 9382.11,-12785.7 9378.61,-12795.7 9385.61,-12795.7"/>
</g>
<!-- split_4&#45;&gt;agg_5 -->
<g id="edge167" class="edge">
<title>split_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M9437.67,-12822.41C9429.99,-12813.28 9421.4,-12803.08 9413.31,-12793.48"/>
<polygon fill="black" stroke="black" points="9415.79,-12790.99 9406.67,-12785.6 9410.44,-12795.5 9415.79,-12790.99"/>
</g>
<!-- mha_q_5 -->
<g id="node86" class="node">
<title>mha_q_5</title>
<polygon fill="lightgreen" stroke="black" points="9505.11,-12688.43 9413.11,-12688.43 9413.11,-12647.43 9505.11,-12647.43 9505.11,-12688.43"/>
<text text-anchor="middle" x="9459.11" y="-12676.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="9459.11" y="-12665.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9459.11" y="-12654.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_q_5 -->
<g id="edge173" class="edge">
<title>agg_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M9408.61,-12725C9417.1,-12715.57 9426.47,-12705.17 9434.8,-12695.92"/>
<polygon fill="black" stroke="black" points="9437.42,-12698.24 9441.51,-12688.46 9432.22,-12693.55 9437.42,-12698.24"/>
</g>
<!-- mha_k_5 -->
<g id="node87" class="node">
<title>mha_k_5</title>
<polygon fill="lightgreen" stroke="black" points="9615.11,-12688.43 9523.11,-12688.43 9523.11,-12647.43 9615.11,-12647.43 9615.11,-12688.43"/>
<text text-anchor="middle" x="9569.11" y="-12676.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="9569.11" y="-12665.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9569.11" y="-12654.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_k_5 -->
<g id="edge174" class="edge">
<title>agg_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M9424.54,-12735.03C9451.96,-12722.49 9487.83,-12706.09 9516.99,-12692.76"/>
<polygon fill="black" stroke="black" points="9518.56,-12695.89 9526.2,-12688.55 9515.65,-12689.52 9518.56,-12695.89"/>
</g>
<!-- mha_v_5 -->
<g id="node88" class="node">
<title>mha_v_5</title>
<polygon fill="lightgreen" stroke="black" points="9395.11,-12688.43 9303.11,-12688.43 9303.11,-12647.43 9395.11,-12647.43 9395.11,-12688.43"/>
<text text-anchor="middle" x="9349.11" y="-12676.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="9349.11" y="-12665.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9349.11" y="-12654.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_v_5 -->
<g id="edge175" class="edge">
<title>agg_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M9370.75,-12725C9367.36,-12716.23 9363.66,-12706.62 9360.28,-12697.88"/>
<polygon fill="black" stroke="black" points="9363.51,-12696.53 9356.65,-12688.46 9356.98,-12699.05 9363.51,-12696.53"/>
</g>
<!-- residual1_5 -->
<g id="node91" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="9333.11,-12454.43 9241.11,-12454.43 9241.11,-12413.43 9333.11,-12413.43 9333.11,-12454.43"/>
<text text-anchor="middle" x="9287.11" y="-12442.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="9287.11" y="-12431.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9287.11" y="-12420.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;residual1_5 -->
<g id="edge176" class="edge">
<title>agg_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M9319.87,-12729.71C9296.33,-12715.95 9275.11,-12696.03 9275.11,-12668.93 9275.11,-12668.93 9275.11,-12668.93 9275.11,-12510.93 9275.11,-12495.49 9277.55,-12478.51 9280.23,-12464.52"/>
<polygon fill="black" stroke="black" points="9283.71,-12464.98 9282.3,-12454.48 9276.86,-12463.57 9283.71,-12464.98"/>
</g>
<!-- mha_attn_5 -->
<g id="node89" class="node">
<title>mha_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="9416.11,-12610.43 9312.11,-12610.43 9312.11,-12569.43 9416.11,-12569.43 9416.11,-12610.43"/>
<text text-anchor="middle" x="9364.11" y="-12598.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="9364.11" y="-12587.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="9364.11" y="-12576.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge168" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M9434.64,-12647.35C9423.01,-12638.05 9408.94,-12626.79 9396.44,-12616.79"/>
<polygon fill="black" stroke="black" points="9398.48,-12613.95 9388.49,-12610.43 9394.11,-12619.41 9398.48,-12613.95"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge169" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M9523.1,-12649.87C9494.43,-12639.24 9457.18,-12625.43 9425.95,-12613.85"/>
<polygon fill="black" stroke="black" points="9427.06,-12610.53 9416.46,-12610.34 9424.62,-12617.09 9427.06,-12610.53"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge170" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M9352.97,-12647.35C9354.6,-12639.11 9356.53,-12629.34 9358.32,-12620.26"/>
<polygon fill="black" stroke="black" points="9361.76,-12620.92 9360.26,-12610.43 9354.89,-12619.56 9361.76,-12620.92"/>
</g>
<!-- mha_out_5 -->
<g id="node90" class="node">
<title>mha_out_5</title>
<polygon fill="lightgreen" stroke="black" points="9398.11,-12532.43 9306.11,-12532.43 9306.11,-12491.43 9398.11,-12491.43 9398.11,-12532.43"/>
<text text-anchor="middle" x="9352.11" y="-12520.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="9352.11" y="-12509.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9352.11" y="-12498.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge171" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M9361.02,-12569.35C9359.73,-12561.2 9358.21,-12551.55 9356.79,-12542.56"/>
<polygon fill="black" stroke="black" points="9360.2,-12541.76 9355.19,-12532.43 9353.29,-12542.86 9360.2,-12541.76"/>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge177" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M9335.37,-12491.35C9327.79,-12482.49 9318.69,-12471.86 9310.46,-12462.23"/>
<polygon fill="black" stroke="black" points="9312.95,-12459.76 9303.79,-12454.43 9307.63,-12464.31 9312.95,-12459.76"/>
</g>
<!-- ln1_5 -->
<g id="node92" class="node">
<title>ln1_5</title>
<polygon fill="lightpink" stroke="black" points="9333.11,-12376.43 9241.11,-12376.43 9241.11,-12335.43 9333.11,-12335.43 9333.11,-12376.43"/>
<text text-anchor="middle" x="9287.11" y="-12364.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="9287.11" y="-12353.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9287.11" y="-12342.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- residual1_5&#45;&gt;ln1_5 -->
<g id="edge178" class="edge">
<title>residual1_5&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M9287.11,-12413.35C9287.11,-12405.2 9287.11,-12395.55 9287.11,-12386.56"/>
<polygon fill="black" stroke="black" points="9290.61,-12386.43 9287.11,-12376.43 9283.61,-12386.43 9290.61,-12386.43"/>
</g>
<!-- gate_5 -->
<g id="node93" class="node">
<title>gate_5</title>
<polygon fill="gold" stroke="black" points="9287.11,-12298.43 9210.11,-12257.43 9287.11,-12216.43 9364.11,-12257.43 9287.11,-12298.43"/>
<text text-anchor="middle" x="9287.11" y="-12265.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="9287.11" y="-12254.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="9287.11" y="-12243.93" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;gate_5 -->
<g id="edge179" class="edge">
<title>ln1_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M9287.11,-12335.4C9287.11,-12327.63 9287.11,-12318.31 9287.11,-12308.87"/>
<polygon fill="black" stroke="black" points="9290.61,-12308.65 9287.11,-12298.65 9283.61,-12308.65 9290.61,-12308.65"/>
</g>
<!-- expert_5_0 -->
<g id="node94" class="node">
<title>expert_5_0</title>
<polygon fill="lightcoral" stroke="black" points="10024.61,-12165.43 9865.61,-12165.43 9865.61,-12124.43 10024.61,-12124.43 10024.61,-12165.43"/>
<text text-anchor="middle" x="9945.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="9945.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9945.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_0 -->
<g id="edge182" class="edge">
<title>ln1_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" d="M9333.16,-12351.71C9400.42,-12346.05 9528.86,-12331.62 9633.11,-12298.43 9735.35,-12265.87 9846.23,-12204.87 9904.32,-12170.72"/>
<polygon fill="black" stroke="black" points="9906.36,-12173.58 9913.18,-12165.47 9902.79,-12167.55 9906.36,-12173.58"/>
</g>
<!-- expert_5_1 -->
<g id="node95" class="node">
<title>expert_5_1</title>
<polygon fill="lightcoral" stroke="black" points="8962.61,-12165.43 8803.61,-12165.43 8803.61,-12124.43 8962.61,-12124.43 8962.61,-12165.43"/>
<text text-anchor="middle" x="8883.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="8883.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8883.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_1 -->
<g id="edge185" class="edge">
<title>ln1_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" d="M9240.93,-12350.5C9188.75,-12344.19 9102.21,-12329.69 9034.11,-12298.43 8966.57,-12267.42 8943.37,-12258.85 8900.11,-12198.43 8895.21,-12191.58 8891.67,-12183.25 8889.13,-12175.25"/>
<polygon fill="black" stroke="black" points="8892.46,-12174.16 8886.43,-12165.45 8885.71,-12176.02 8892.46,-12174.16"/>
</g>
<!-- expert_5_2 -->
<g id="node96" class="node">
<title>expert_5_2</title>
<polygon fill="lightcoral" stroke="black" points="9139.61,-12165.43 8980.61,-12165.43 8980.61,-12124.43 9139.61,-12124.43 9139.61,-12165.43"/>
<text text-anchor="middle" x="9060.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="9060.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9060.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_2 -->
<g id="edge188" class="edge">
<title>ln1_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" d="M9241.1,-12341.78C9211.34,-12332.17 9172.45,-12317.51 9141.11,-12298.43 9083.82,-12263.55 9055.65,-12259.57 9028.11,-12198.43 9024.45,-12190.31 9026.57,-12181.91 9031.09,-12174.28"/>
<polygon fill="black" stroke="black" points="9034.26,-12175.88 9037.3,-12165.73 9028.59,-12171.76 9034.26,-12175.88"/>
</g>
<!-- expert_5_3 -->
<g id="node97" class="node">
<title>expert_5_3</title>
<polygon fill="lightcoral" stroke="black" points="8785.61,-12165.43 8626.61,-12165.43 8626.61,-12124.43 8785.61,-12124.43 8785.61,-12165.43"/>
<text text-anchor="middle" x="8706.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="8706.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8706.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_3 -->
<g id="edge191" class="edge">
<title>ln1_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" d="M9241.09,-12355.16C9168.08,-12354 9022.49,-12345.33 8910.11,-12298.43 8838.29,-12268.46 8768.81,-12207.63 8732.39,-12172.53"/>
<polygon fill="black" stroke="black" points="8734.74,-12169.92 8725.13,-12165.45 8729.85,-12174.93 8734.74,-12169.92"/>
</g>
<!-- expert_5_4 -->
<g id="node98" class="node">
<title>expert_5_4</title>
<polygon fill="lightcoral" stroke="black" points="9316.61,-12165.43 9157.61,-12165.43 9157.61,-12124.43 9316.61,-12124.43 9316.61,-12165.43"/>
<text text-anchor="middle" x="9237.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="9237.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9237.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_4 -->
<g id="edge194" class="edge">
<title>ln1_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" d="M9249.77,-12335.27C9233.6,-12325.59 9215.19,-12312.89 9201.11,-12298.43 9164.62,-12260.97 9153.43,-12248.72 9139.11,-12198.43 9135.71,-12186.51 9140.18,-12177.27 9148.79,-12170.11"/>
<polygon fill="black" stroke="black" points="9151,-12172.84 9157.32,-12164.34 9147.08,-12167.04 9151,-12172.84"/>
</g>
<!-- expert_5_5 -->
<g id="node99" class="node">
<title>expert_5_5</title>
<polygon fill="lightcoral" stroke="black" points="9847.61,-12165.43 9688.61,-12165.43 9688.61,-12124.43 9847.61,-12124.43 9847.61,-12165.43"/>
<text text-anchor="middle" x="9768.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="9768.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9768.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_5 -->
<g id="edge197" class="edge">
<title>ln1_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" d="M9333.2,-12348.61C9418.75,-12334.86 9604.33,-12295.32 9725.11,-12198.43 9733.88,-12191.39 9742.09,-12182.29 9748.94,-12173.66"/>
<polygon fill="black" stroke="black" points="9751.8,-12175.68 9755.06,-12165.61 9746.22,-12171.45 9751.8,-12175.68"/>
</g>
<!-- expert_5_6 -->
<g id="node100" class="node">
<title>expert_5_6</title>
<polygon fill="lightcoral" stroke="black" points="9493.61,-12165.43 9334.61,-12165.43 9334.61,-12124.43 9493.61,-12124.43 9493.61,-12165.43"/>
<text text-anchor="middle" x="9414.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="9414.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9414.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_6 -->
<g id="edge200" class="edge">
<title>ln1_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" d="M9330.47,-12335.29C9378.03,-12310.97 9451.42,-12264.51 9480.11,-12198.43 9484.66,-12187.94 9480.29,-12178.96 9472.02,-12171.55"/>
<polygon fill="black" stroke="black" points="9473.97,-12168.64 9463.87,-12165.44 9469.77,-12174.24 9473.97,-12168.64"/>
</g>
<!-- expert_5_7 -->
<g id="node101" class="node">
<title>expert_5_7</title>
<polygon fill="lightcoral" stroke="black" points="9670.61,-12165.43 9511.61,-12165.43 9511.61,-12124.43 9670.61,-12124.43 9670.61,-12165.43"/>
<text text-anchor="middle" x="9591.11" y="-12153.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="9591.11" y="-12142.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9591.11" y="-12131.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_5_7 -->
<g id="edge203" class="edge">
<title>ln1_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" d="M9333.32,-12342.03C9365.78,-12332.13 9409.72,-12317.03 9446.11,-12298.43 9515.81,-12262.79 9554.71,-12267.74 9591.11,-12198.43 9594.69,-12191.6 9595.91,-12183.56 9595.93,-12175.84"/>
<polygon fill="black" stroke="black" points="9599.41,-12175.45 9595.33,-12165.68 9592.42,-12175.87 9599.41,-12175.45"/>
</g>
<!-- expert_agg_5 -->
<g id="node102" class="node">
<title>expert_agg_5</title>
<polygon fill="lightyellow" stroke="black" points="9409.88,-12087.43 9246.39,-12087.43 9204.33,-12005.43 9367.83,-12005.43 9409.88,-12087.43"/>
<text text-anchor="middle" x="9307.11" y="-12054.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="9307.11" y="-12043.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="9307.11" y="-12032.93" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;expert_agg_5 -->
<g id="edge180" class="edge">
<title>ln1_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9333.42,-12355.65C9524.77,-12357.2 10234.48,-12348.28 10033.11,-12124.43 9991.57,-12078.25 9587.99,-12057.64 9401.16,-12050.52"/>
<polygon fill="black" stroke="black" points="9401.19,-12047.02 9391.07,-12050.14 9400.93,-12054.02 9401.19,-12047.02"/>
</g>
<!-- residual2_5 -->
<g id="node103" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="8657.11,-11968.43 8565.11,-11968.43 8565.11,-11927.43 8657.11,-11927.43 8657.11,-11968.43"/>
<text text-anchor="middle" x="8611.11" y="-11956.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8611.11" y="-11945.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8611.11" y="-11934.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;residual2_5 -->
<g id="edge206" class="edge">
<title>ln1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M9240.9,-12353.32C9086.64,-12347.37 8599.11,-12323.41 8599.11,-12258.43 8599.11,-12258.43 8599.11,-12258.43 8599.11,-12045.43 8599.11,-12022.78 8602.4,-11997.37 8605.54,-11978.31"/>
<polygon fill="black" stroke="black" points="8608.99,-11978.88 8607.24,-11968.43 8602.09,-11977.69 8608.99,-11978.88"/>
</g>
<!-- gate_5&#45;&gt;expert_5_0 -->
<g id="edge181" class="edge">
<title>gate_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9346.69,-12248.04C9448.71,-12233.43 9663.56,-12201.58 9855.58,-12165.47"/>
<polygon fill="black" stroke="black" points="9856.4,-12168.88 9865.58,-12163.59 9855.1,-12162 9856.4,-12168.88"/>
<text text-anchor="middle" x="9779.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_5&#45;&gt;expert_5_1 -->
<g id="edge184" class="edge">
<title>gate_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9236.93,-12242.9C9193.55,-12231.19 9129.17,-12213.77 9073.11,-12198.43 9037.06,-12188.56 8997.18,-12177.56 8963.31,-12168.18"/>
<polygon fill="black" stroke="black" points="8964.04,-12164.75 8953.47,-12165.46 8962.17,-12171.5 8964.04,-12164.75"/>
<text text-anchor="middle" x="9104.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_5&#45;&gt;expert_5_2 -->
<g id="edge187" class="edge">
<title>gate_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9247.83,-12237.3C9209.49,-12218.64 9151.02,-12190.18 9109.54,-12169.99"/>
<polygon fill="black" stroke="black" points="9110.96,-12166.79 9100.43,-12165.56 9107.89,-12173.08 9110.96,-12166.79"/>
<text text-anchor="middle" x="9198.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_5&#45;&gt;expert_5_3 -->
<g id="edge190" class="edge">
<title>gate_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9229.56,-12246.96C9163.09,-12235.9 9050.53,-12216.76 8954.11,-12198.43 8885.84,-12185.44 8866.73,-12181 8795.62,-12165.74"/>
<polygon fill="black" stroke="black" points="8796.23,-12162.3 8785.72,-12163.62 8794.77,-12169.14 8796.23,-12162.3"/>
<text text-anchor="middle" x="8985.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_5&#45;&gt;expert_5_4 -->
<g id="edge193" class="edge">
<title>gate_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9263.04,-12228.84C9256.23,-12219.7 9249.49,-12209.12 9245.11,-12198.43 9242.17,-12191.27 9240.31,-12183.17 9239.12,-12175.51"/>
<polygon fill="black" stroke="black" points="9242.58,-12174.96 9237.88,-12165.47 9235.63,-12175.82 9242.58,-12174.96"/>
<text text-anchor="middle" x="9276.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_5&#45;&gt;expert_5_5 -->
<g id="edge196" class="edge">
<title>gate_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9337.33,-12243.09C9381.52,-12231.35 9447.59,-12213.78 9505.11,-12198.43 9530,-12191.78 9535.89,-12188.71 9561.11,-12183.43 9610.09,-12173.16 9625.25,-12174.86 9678.55,-12165.44"/>
<polygon fill="black" stroke="black" points="9679.37,-12168.85 9688.58,-12163.62 9678.12,-12161.96 9679.37,-12168.85"/>
<text text-anchor="middle" x="9592.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_5&#45;&gt;expert_5_6 -->
<g id="edge199" class="edge">
<title>gate_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9301.26,-12223.94C9308.57,-12210.06 9318.61,-12194.53 9331.11,-12183.43 9336.55,-12178.59 9342.73,-12174.28 9349.19,-12170.46"/>
<polygon fill="black" stroke="black" points="9351.05,-12173.43 9358.14,-12165.56 9347.69,-12167.29 9351.05,-12173.43"/>
<text text-anchor="middle" x="9362.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_5&#45;&gt;expert_5_7 -->
<g id="edge202" class="edge">
<title>gate_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9324.77,-12236.16C9355.63,-12220.18 9400.79,-12198.2 9442.11,-12183.43 9453.86,-12179.22 9476.93,-12173.08 9501.47,-12166.98"/>
<polygon fill="black" stroke="black" points="9502.43,-12170.35 9511.3,-12164.56 9500.75,-12163.56 9502.43,-12170.35"/>
<text text-anchor="middle" x="9473.61" y="-12187.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_5_0&#45;&gt;expert_agg_5 -->
<g id="edge183" class="edge">
<title>expert_5_0&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9865.59,-12126.19C9862.39,-12125.58 9859.22,-12124.99 9856.11,-12124.43 9699.02,-12096.24 9515.09,-12072.26 9405,-12058.87"/>
<polygon fill="black" stroke="black" points="9405.26,-12055.37 9394.91,-12057.64 9404.42,-12062.32 9405.26,-12055.37"/>
</g>
<!-- expert_5_1&#45;&gt;expert_agg_5 -->
<g id="edge186" class="edge">
<title>expert_5_1&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M8962.86,-12125.78C9037.47,-12108.79 9148.48,-12083.53 9224.12,-12066.31"/>
<polygon fill="black" stroke="black" points="9225.11,-12069.68 9234.09,-12064.05 9223.56,-12062.85 9225.11,-12069.68"/>
</g>
<!-- expert_5_2&#45;&gt;expert_agg_5 -->
<g id="edge189" class="edge">
<title>expert_5_2&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9110.09,-12124.4C9144.4,-12110.99 9190.61,-12092.94 9229.65,-12077.69"/>
<polygon fill="black" stroke="black" points="9231.37,-12080.77 9239.41,-12073.88 9228.82,-12074.25 9231.37,-12080.77"/>
</g>
<!-- expert_5_3&#45;&gt;expert_agg_5 -->
<g id="edge192" class="edge">
<title>expert_5_3&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M8785.68,-12126.03C8788.52,-12125.48 8791.34,-12124.94 8794.11,-12124.43 8943.43,-12096.71 9118.63,-12072.1 9220.82,-12058.53"/>
<polygon fill="black" stroke="black" points="9221.33,-12061.99 9230.78,-12057.21 9220.41,-12055.05 9221.33,-12061.99"/>
</g>
<!-- expert_5_4&#45;&gt;expert_agg_5 -->
<g id="edge195" class="edge">
<title>expert_5_4&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9251.27,-12124.4C9257.33,-12116.05 9264.68,-12105.91 9272.05,-12095.76"/>
<polygon fill="black" stroke="black" points="9274.89,-12097.8 9277.93,-12087.65 9269.22,-12093.69 9274.89,-12097.8"/>
</g>
<!-- expert_5_5&#45;&gt;expert_agg_5 -->
<g id="edge198" class="edge">
<title>expert_5_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9688.54,-12126.45C9685.36,-12125.76 9682.2,-12125.09 9679.11,-12124.43 9587.9,-12105 9483.95,-12083.54 9409.17,-12068.22"/>
<polygon fill="black" stroke="black" points="9409.78,-12064.77 9399.28,-12066.2 9408.37,-12071.63 9409.78,-12064.77"/>
</g>
<!-- expert_5_6&#45;&gt;expert_agg_5 -->
<g id="edge201" class="edge">
<title>expert_5_6&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9392.45,-12124.4C9382.84,-12115.72 9371.06,-12105.1 9359.36,-12094.55"/>
<polygon fill="black" stroke="black" points="9361.48,-12091.75 9351.71,-12087.65 9356.79,-12096.95 9361.48,-12091.75"/>
</g>
<!-- expert_5_7&#45;&gt;expert_agg_5 -->
<g id="edge204" class="edge">
<title>expert_5_7&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M9533.64,-12124.4C9499.95,-12112.95 9456.28,-12098.11 9416.29,-12084.53"/>
<polygon fill="black" stroke="black" points="9417.35,-12081.19 9406.75,-12081.28 9415.09,-12087.82 9417.35,-12081.19"/>
</g>
<!-- expert_agg_5&#45;&gt;residual2_5 -->
<g id="edge205" class="edge">
<title>expert_agg_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M9218.25,-12033.11C9072.79,-12012.94 8787.96,-11973.45 8667.28,-11956.71"/>
<polygon fill="black" stroke="black" points="8667.54,-11953.22 8657.16,-11955.31 8666.58,-11960.15 8667.54,-11953.22"/>
</g>
<!-- ln2_5 -->
<g id="node104" class="node">
<title>ln2_5</title>
<polygon fill="lightpink" stroke="black" points="8657.11,-11890.43 8565.11,-11890.43 8565.11,-11849.43 8657.11,-11849.43 8657.11,-11890.43"/>
<text text-anchor="middle" x="8611.11" y="-11878.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8611.11" y="-11867.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8611.11" y="-11856.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- residual2_5&#45;&gt;ln2_5 -->
<g id="edge207" class="edge">
<title>residual2_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M8611.11,-11927.35C8611.11,-11919.2 8611.11,-11909.55 8611.11,-11900.56"/>
<polygon fill="black" stroke="black" points="8614.61,-11900.43 8611.11,-11890.43 8607.61,-11900.43 8614.61,-11900.43"/>
</g>
<!-- split_5 -->
<g id="node105" class="node">
<title>split_5</title>
<polygon fill="lightyellow" stroke="black" points="8755.17,-11812.43 8653.26,-11812.43 8627.05,-11752.43 8728.95,-11752.43 8755.17,-11812.43"/>
<text text-anchor="middle" x="8691.11" y="-11785.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="8691.11" y="-11774.43" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- ln2_5&#45;&gt;split_5 -->
<g id="edge208" class="edge">
<title>ln2_5&#45;&gt;split_5</title>
<path fill="none" stroke="black" d="M8629.66,-11849.1C8637.75,-11840.45 8647.51,-11830.02 8656.84,-11820.05"/>
<polygon fill="black" stroke="black" points="8659.58,-11822.25 8663.86,-11812.55 8654.47,-11817.46 8659.58,-11822.25"/>
</g>
<!-- agg_6 -->
<g id="node106" class="node">
<title>agg_6</title>
<polygon fill="lightyellow" stroke="black" points="8675.17,-11715.43 8573.26,-11715.43 8547.05,-11655.43 8648.95,-11655.43 8675.17,-11715.43"/>
<text text-anchor="middle" x="8611.11" y="-11688.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="8611.11" y="-11677.43" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- ln2_5&#45;&gt;agg_6 -->
<g id="edge214" class="edge">
<title>ln2_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8611.11,-11849.4C8611.11,-11820.06 8611.11,-11764.02 8611.11,-11725.93"/>
<polygon fill="black" stroke="black" points="8614.61,-11725.7 8611.11,-11715.7 8607.61,-11725.7 8614.61,-11725.7"/>
</g>
<!-- split_5&#45;&gt;agg_6 -->
<g id="edge209" class="edge">
<title>split_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M8666.67,-11752.41C8658.99,-11743.28 8650.4,-11733.08 8642.31,-11723.48"/>
<polygon fill="black" stroke="black" points="8644.79,-11720.99 8635.67,-11715.6 8639.44,-11725.5 8644.79,-11720.99"/>
</g>
<!-- mha_q_6 -->
<g id="node107" class="node">
<title>mha_q_6</title>
<polygon fill="lightgreen" stroke="black" points="8734.11,-11618.43 8642.11,-11618.43 8642.11,-11577.43 8734.11,-11577.43 8734.11,-11618.43"/>
<text text-anchor="middle" x="8688.11" y="-11606.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="8688.11" y="-11595.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8688.11" y="-11584.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_q_6 -->
<g id="edge215" class="edge">
<title>agg_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M8637.61,-11655C8646.1,-11645.57 8655.47,-11635.17 8663.8,-11625.92"/>
<polygon fill="black" stroke="black" points="8666.42,-11628.24 8670.51,-11618.46 8661.22,-11623.55 8666.42,-11628.24"/>
</g>
<!-- mha_k_6 -->
<g id="node108" class="node">
<title>mha_k_6</title>
<polygon fill="lightgreen" stroke="black" points="8844.11,-11618.43 8752.11,-11618.43 8752.11,-11577.43 8844.11,-11577.43 8844.11,-11618.43"/>
<text text-anchor="middle" x="8798.11" y="-11606.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="8798.11" y="-11595.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8798.11" y="-11584.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_k_6 -->
<g id="edge216" class="edge">
<title>agg_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M8653.54,-11665.03C8680.96,-11652.49 8716.83,-11636.09 8745.99,-11622.76"/>
<polygon fill="black" stroke="black" points="8747.56,-11625.89 8755.2,-11618.55 8744.65,-11619.52 8747.56,-11625.89"/>
</g>
<!-- mha_v_6 -->
<g id="node109" class="node">
<title>mha_v_6</title>
<polygon fill="lightgreen" stroke="black" points="8624.11,-11618.43 8532.11,-11618.43 8532.11,-11577.43 8624.11,-11577.43 8624.11,-11618.43"/>
<text text-anchor="middle" x="8578.11" y="-11606.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="8578.11" y="-11595.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8578.11" y="-11584.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_v_6 -->
<g id="edge217" class="edge">
<title>agg_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M8599.75,-11655C8596.36,-11646.23 8592.66,-11636.62 8589.28,-11627.88"/>
<polygon fill="black" stroke="black" points="8592.51,-11626.53 8585.65,-11618.46 8585.98,-11629.05 8592.51,-11626.53"/>
</g>
<!-- residual1_6 -->
<g id="node112" class="node">
<title>residual1_6</title>
<polygon fill="lightpink" stroke="black" points="8562.11,-11384.43 8470.11,-11384.43 8470.11,-11343.43 8562.11,-11343.43 8562.11,-11384.43"/>
<text text-anchor="middle" x="8516.11" y="-11372.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8516.11" y="-11361.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8516.11" y="-11350.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;residual1_6 -->
<g id="edge218" class="edge">
<title>agg_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M8548.87,-11659.71C8525.33,-11645.95 8504.11,-11626.03 8504.11,-11598.93 8504.11,-11598.93 8504.11,-11598.93 8504.11,-11440.93 8504.11,-11425.49 8506.55,-11408.51 8509.23,-11394.52"/>
<polygon fill="black" stroke="black" points="8512.71,-11394.98 8511.3,-11384.48 8505.86,-11393.57 8512.71,-11394.98"/>
</g>
<!-- mha_attn_6 -->
<g id="node110" class="node">
<title>mha_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="8691.11,-11540.43 8587.11,-11540.43 8587.11,-11499.43 8691.11,-11499.43 8691.11,-11540.43"/>
<text text-anchor="middle" x="8639.11" y="-11528.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="8639.11" y="-11517.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="8639.11" y="-11506.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge210" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M8675.49,-11577.35C8669.94,-11568.76 8663.33,-11558.5 8657.27,-11549.1"/>
<polygon fill="black" stroke="black" points="8660.04,-11546.94 8651.68,-11540.43 8654.16,-11550.73 8660.04,-11546.94"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge211" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M8757.16,-11577.35C8736.39,-11567.43 8710.98,-11555.28 8689.07,-11544.81"/>
<polygon fill="black" stroke="black" points="8690.45,-11541.59 8679.92,-11540.43 8687.43,-11547.9 8690.45,-11541.59"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge212" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M8593.82,-11577.35C8600.86,-11568.58 8609.29,-11558.07 8616.96,-11548.52"/>
<polygon fill="black" stroke="black" points="8619.92,-11550.42 8623.45,-11540.43 8614.46,-11546.04 8619.92,-11550.42"/>
</g>
<!-- mha_out_6 -->
<g id="node111" class="node">
<title>mha_out_6</title>
<polygon fill="lightgreen" stroke="black" points="8636.11,-11462.43 8544.11,-11462.43 8544.11,-11421.43 8636.11,-11421.43 8636.11,-11462.43"/>
<text text-anchor="middle" x="8590.11" y="-11450.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="8590.11" y="-11439.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8590.11" y="-11428.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge213" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M8626.49,-11499.35C8620.94,-11490.76 8614.33,-11480.5 8608.27,-11471.1"/>
<polygon fill="black" stroke="black" points="8611.04,-11468.94 8602.68,-11462.43 8605.16,-11472.73 8611.04,-11468.94"/>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge219" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M8571.05,-11421.35C8562.25,-11412.31 8551.65,-11401.43 8542.13,-11391.65"/>
<polygon fill="black" stroke="black" points="8544.58,-11389.16 8535.1,-11384.43 8539.57,-11394.04 8544.58,-11389.16"/>
</g>
<!-- ln1_6 -->
<g id="node113" class="node">
<title>ln1_6</title>
<polygon fill="lightpink" stroke="black" points="8562.11,-11306.43 8470.11,-11306.43 8470.11,-11265.43 8562.11,-11265.43 8562.11,-11306.43"/>
<text text-anchor="middle" x="8516.11" y="-11294.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="8516.11" y="-11283.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8516.11" y="-11272.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- residual1_6&#45;&gt;ln1_6 -->
<g id="edge220" class="edge">
<title>residual1_6&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M8516.11,-11343.35C8516.11,-11335.2 8516.11,-11325.55 8516.11,-11316.56"/>
<polygon fill="black" stroke="black" points="8519.61,-11316.43 8516.11,-11306.43 8512.61,-11316.43 8519.61,-11316.43"/>
</g>
<!-- gate_6 -->
<g id="node114" class="node">
<title>gate_6</title>
<polygon fill="gold" stroke="black" points="8516.11,-11228.43 8439.11,-11187.43 8516.11,-11146.43 8593.11,-11187.43 8516.11,-11228.43"/>
<text text-anchor="middle" x="8516.11" y="-11195.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="8516.11" y="-11184.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="8516.11" y="-11173.93" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;gate_6 -->
<g id="edge221" class="edge">
<title>ln1_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M8516.11,-11265.4C8516.11,-11257.63 8516.11,-11248.31 8516.11,-11238.87"/>
<polygon fill="black" stroke="black" points="8519.61,-11238.65 8516.11,-11228.65 8512.61,-11238.65 8519.61,-11238.65"/>
</g>
<!-- expert_6_0 -->
<g id="node115" class="node">
<title>expert_6_0</title>
<polygon fill="lightcoral" stroke="black" points="9253.61,-11095.43 9094.61,-11095.43 9094.61,-11054.43 9253.61,-11054.43 9253.61,-11095.43"/>
<text text-anchor="middle" x="9174.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="9174.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="9174.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_0 -->
<g id="edge224" class="edge">
<title>ln1_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" d="M8562.16,-11281.71C8629.42,-11276.05 8757.86,-11261.62 8862.11,-11228.43 8964.35,-11195.87 9075.23,-11134.87 9133.32,-11100.72"/>
<polygon fill="black" stroke="black" points="9135.36,-11103.58 9142.18,-11095.47 9131.79,-11097.55 9135.36,-11103.58"/>
</g>
<!-- expert_6_1 -->
<g id="node116" class="node">
<title>expert_6_1</title>
<polygon fill="lightcoral" stroke="black" points="8191.61,-11095.43 8032.61,-11095.43 8032.61,-11054.43 8191.61,-11054.43 8191.61,-11095.43"/>
<text text-anchor="middle" x="8112.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="8112.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8112.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_1 -->
<g id="edge227" class="edge">
<title>ln1_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" d="M8469.93,-11280.5C8417.75,-11274.19 8331.21,-11259.69 8263.11,-11228.43 8195.57,-11197.42 8172.37,-11188.85 8129.11,-11128.43 8124.21,-11121.58 8120.67,-11113.25 8118.13,-11105.25"/>
<polygon fill="black" stroke="black" points="8121.46,-11104.16 8115.43,-11095.45 8114.71,-11106.02 8121.46,-11104.16"/>
</g>
<!-- expert_6_2 -->
<g id="node117" class="node">
<title>expert_6_2</title>
<polygon fill="lightcoral" stroke="black" points="8368.61,-11095.43 8209.61,-11095.43 8209.61,-11054.43 8368.61,-11054.43 8368.61,-11095.43"/>
<text text-anchor="middle" x="8289.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="8289.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8289.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_2 -->
<g id="edge230" class="edge">
<title>ln1_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" d="M8470.1,-11271.78C8440.34,-11262.17 8401.45,-11247.51 8370.11,-11228.43 8312.82,-11193.55 8284.65,-11189.57 8257.11,-11128.43 8253.45,-11120.31 8255.57,-11111.91 8260.09,-11104.28"/>
<polygon fill="black" stroke="black" points="8263.26,-11105.88 8266.3,-11095.73 8257.59,-11101.76 8263.26,-11105.88"/>
</g>
<!-- expert_6_3 -->
<g id="node118" class="node">
<title>expert_6_3</title>
<polygon fill="lightcoral" stroke="black" points="8014.61,-11095.43 7855.61,-11095.43 7855.61,-11054.43 8014.61,-11054.43 8014.61,-11095.43"/>
<text text-anchor="middle" x="7935.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="7935.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7935.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_3 -->
<g id="edge233" class="edge">
<title>ln1_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" d="M8470.09,-11285.16C8397.08,-11284 8251.49,-11275.33 8139.11,-11228.43 8067.29,-11198.46 7997.81,-11137.63 7961.39,-11102.53"/>
<polygon fill="black" stroke="black" points="7963.74,-11099.92 7954.13,-11095.45 7958.85,-11104.93 7963.74,-11099.92"/>
</g>
<!-- expert_6_4 -->
<g id="node119" class="node">
<title>expert_6_4</title>
<polygon fill="lightcoral" stroke="black" points="8545.61,-11095.43 8386.61,-11095.43 8386.61,-11054.43 8545.61,-11054.43 8545.61,-11095.43"/>
<text text-anchor="middle" x="8466.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="8466.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8466.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_4 -->
<g id="edge236" class="edge">
<title>ln1_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" d="M8478.77,-11265.27C8462.6,-11255.59 8444.19,-11242.89 8430.11,-11228.43 8393.62,-11190.97 8382.43,-11178.72 8368.11,-11128.43 8364.71,-11116.51 8369.18,-11107.27 8377.79,-11100.11"/>
<polygon fill="black" stroke="black" points="8380,-11102.84 8386.32,-11094.34 8376.08,-11097.04 8380,-11102.84"/>
</g>
<!-- expert_6_5 -->
<g id="node120" class="node">
<title>expert_6_5</title>
<polygon fill="lightcoral" stroke="black" points="9076.61,-11095.43 8917.61,-11095.43 8917.61,-11054.43 9076.61,-11054.43 9076.61,-11095.43"/>
<text text-anchor="middle" x="8997.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="8997.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8997.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_5 -->
<g id="edge239" class="edge">
<title>ln1_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" d="M8562.2,-11278.61C8647.75,-11264.86 8833.33,-11225.32 8954.11,-11128.43 8962.88,-11121.39 8971.09,-11112.29 8977.94,-11103.66"/>
<polygon fill="black" stroke="black" points="8980.8,-11105.68 8984.06,-11095.61 8975.22,-11101.45 8980.8,-11105.68"/>
</g>
<!-- expert_6_6 -->
<g id="node121" class="node">
<title>expert_6_6</title>
<polygon fill="lightcoral" stroke="black" points="8722.61,-11095.43 8563.61,-11095.43 8563.61,-11054.43 8722.61,-11054.43 8722.61,-11095.43"/>
<text text-anchor="middle" x="8643.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="8643.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8643.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_6 -->
<g id="edge242" class="edge">
<title>ln1_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" d="M8559.47,-11265.29C8607.03,-11240.97 8680.42,-11194.51 8709.11,-11128.43 8713.66,-11117.94 8709.29,-11108.96 8701.02,-11101.55"/>
<polygon fill="black" stroke="black" points="8702.97,-11098.64 8692.87,-11095.44 8698.77,-11104.24 8702.97,-11098.64"/>
</g>
<!-- expert_6_7 -->
<g id="node122" class="node">
<title>expert_6_7</title>
<polygon fill="lightcoral" stroke="black" points="8899.61,-11095.43 8740.61,-11095.43 8740.61,-11054.43 8899.61,-11054.43 8899.61,-11095.43"/>
<text text-anchor="middle" x="8820.11" y="-11083.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="8820.11" y="-11072.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8820.11" y="-11061.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_6_7 -->
<g id="edge245" class="edge">
<title>ln1_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" d="M8562.32,-11272.03C8594.78,-11262.13 8638.72,-11247.03 8675.11,-11228.43 8744.81,-11192.79 8783.71,-11197.74 8820.11,-11128.43 8823.69,-11121.6 8824.91,-11113.56 8824.93,-11105.84"/>
<polygon fill="black" stroke="black" points="8828.41,-11105.45 8824.33,-11095.68 8821.42,-11105.87 8828.41,-11105.45"/>
</g>
<!-- expert_agg_6 -->
<g id="node123" class="node">
<title>expert_agg_6</title>
<polygon fill="lightyellow" stroke="black" points="8638.88,-11017.43 8475.39,-11017.43 8433.33,-10935.43 8596.83,-10935.43 8638.88,-11017.43"/>
<text text-anchor="middle" x="8536.11" y="-10984.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="8536.11" y="-10973.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8536.11" y="-10962.93" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;expert_agg_6 -->
<g id="edge222" class="edge">
<title>ln1_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8562.42,-11285.65C8753.77,-11287.2 9463.48,-11278.28 9262.11,-11054.43 9220.57,-11008.25 8816.99,-10987.64 8630.16,-10980.52"/>
<polygon fill="black" stroke="black" points="8630.19,-10977.02 8620.07,-10980.14 8629.93,-10984.02 8630.19,-10977.02"/>
</g>
<!-- residual2_6 -->
<g id="node124" class="node">
<title>residual2_6</title>
<polygon fill="lightpink" stroke="black" points="7886.11,-10898.43 7794.11,-10898.43 7794.11,-10857.43 7886.11,-10857.43 7886.11,-10898.43"/>
<text text-anchor="middle" x="7840.11" y="-10886.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7840.11" y="-10875.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7840.11" y="-10864.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;residual2_6 -->
<g id="edge248" class="edge">
<title>ln1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M8469.9,-11283.32C8315.64,-11277.37 7828.11,-11253.41 7828.11,-11188.43 7828.11,-11188.43 7828.11,-11188.43 7828.11,-10975.43 7828.11,-10952.78 7831.4,-10927.37 7834.54,-10908.31"/>
<polygon fill="black" stroke="black" points="7837.99,-10908.88 7836.24,-10898.43 7831.09,-10907.69 7837.99,-10908.88"/>
</g>
<!-- gate_6&#45;&gt;expert_6_0 -->
<g id="edge223" class="edge">
<title>gate_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8575.69,-11178.04C8677.71,-11163.43 8892.56,-11131.58 9084.58,-11095.47"/>
<polygon fill="black" stroke="black" points="9085.4,-11098.88 9094.58,-11093.59 9084.1,-11092 9085.4,-11098.88"/>
<text text-anchor="middle" x="9008.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_6&#45;&gt;expert_6_1 -->
<g id="edge226" class="edge">
<title>gate_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8465.93,-11172.9C8422.55,-11161.19 8358.17,-11143.77 8302.11,-11128.43 8266.06,-11118.56 8226.18,-11107.56 8192.31,-11098.18"/>
<polygon fill="black" stroke="black" points="8193.04,-11094.75 8182.47,-11095.46 8191.17,-11101.5 8193.04,-11094.75"/>
<text text-anchor="middle" x="8333.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_6&#45;&gt;expert_6_2 -->
<g id="edge229" class="edge">
<title>gate_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8476.83,-11167.3C8438.49,-11148.64 8380.02,-11120.18 8338.54,-11099.99"/>
<polygon fill="black" stroke="black" points="8339.96,-11096.79 8329.43,-11095.56 8336.89,-11103.08 8339.96,-11096.79"/>
<text text-anchor="middle" x="8427.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_6&#45;&gt;expert_6_3 -->
<g id="edge232" class="edge">
<title>gate_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8458.56,-11176.96C8392.09,-11165.9 8279.53,-11146.76 8183.11,-11128.43 8114.84,-11115.44 8095.73,-11111 8024.62,-11095.74"/>
<polygon fill="black" stroke="black" points="8025.23,-11092.3 8014.72,-11093.62 8023.77,-11099.14 8025.23,-11092.3"/>
<text text-anchor="middle" x="8214.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_6&#45;&gt;expert_6_4 -->
<g id="edge235" class="edge">
<title>gate_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8492.04,-11158.84C8485.23,-11149.7 8478.49,-11139.12 8474.11,-11128.43 8471.17,-11121.27 8469.31,-11113.17 8468.12,-11105.51"/>
<polygon fill="black" stroke="black" points="8471.58,-11104.96 8466.88,-11095.47 8464.63,-11105.82 8471.58,-11104.96"/>
<text text-anchor="middle" x="8505.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_6&#45;&gt;expert_6_5 -->
<g id="edge238" class="edge">
<title>gate_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8566.33,-11173.09C8610.52,-11161.35 8676.59,-11143.78 8734.11,-11128.43 8759,-11121.78 8764.89,-11118.71 8790.11,-11113.43 8839.09,-11103.16 8854.25,-11104.86 8907.55,-11095.44"/>
<polygon fill="black" stroke="black" points="8908.37,-11098.85 8917.58,-11093.62 8907.12,-11091.96 8908.37,-11098.85"/>
<text text-anchor="middle" x="8821.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_6&#45;&gt;expert_6_6 -->
<g id="edge241" class="edge">
<title>gate_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8530.26,-11153.94C8537.57,-11140.06 8547.61,-11124.53 8560.11,-11113.43 8565.55,-11108.59 8571.73,-11104.28 8578.19,-11100.46"/>
<polygon fill="black" stroke="black" points="8580.05,-11103.43 8587.14,-11095.56 8576.69,-11097.29 8580.05,-11103.43"/>
<text text-anchor="middle" x="8591.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_6&#45;&gt;expert_6_7 -->
<g id="edge244" class="edge">
<title>gate_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8553.77,-11166.16C8584.63,-11150.18 8629.79,-11128.2 8671.11,-11113.43 8682.86,-11109.22 8705.93,-11103.08 8730.47,-11096.98"/>
<polygon fill="black" stroke="black" points="8731.43,-11100.35 8740.3,-11094.56 8729.75,-11093.56 8731.43,-11100.35"/>
<text text-anchor="middle" x="8702.61" y="-11117.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_6_0&#45;&gt;expert_agg_6 -->
<g id="edge225" class="edge">
<title>expert_6_0&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M9094.59,-11056.19C9091.39,-11055.58 9088.22,-11054.99 9085.11,-11054.43 8928.02,-11026.24 8744.09,-11002.26 8634,-10988.87"/>
<polygon fill="black" stroke="black" points="8634.26,-10985.37 8623.91,-10987.64 8633.42,-10992.32 8634.26,-10985.37"/>
</g>
<!-- expert_6_1&#45;&gt;expert_agg_6 -->
<g id="edge228" class="edge">
<title>expert_6_1&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8191.86,-11055.78C8266.47,-11038.79 8377.48,-11013.53 8453.12,-10996.31"/>
<polygon fill="black" stroke="black" points="8454.11,-10999.68 8463.09,-10994.05 8452.56,-10992.85 8454.11,-10999.68"/>
</g>
<!-- expert_6_2&#45;&gt;expert_agg_6 -->
<g id="edge231" class="edge">
<title>expert_6_2&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8339.09,-11054.4C8373.4,-11040.99 8419.61,-11022.94 8458.65,-11007.69"/>
<polygon fill="black" stroke="black" points="8460.37,-11010.77 8468.41,-11003.88 8457.82,-11004.25 8460.37,-11010.77"/>
</g>
<!-- expert_6_3&#45;&gt;expert_agg_6 -->
<g id="edge234" class="edge">
<title>expert_6_3&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8014.68,-11056.03C8017.52,-11055.48 8020.34,-11054.94 8023.11,-11054.43 8172.43,-11026.71 8347.63,-11002.1 8449.82,-10988.53"/>
<polygon fill="black" stroke="black" points="8450.33,-10991.99 8459.78,-10987.21 8449.41,-10985.05 8450.33,-10991.99"/>
</g>
<!-- expert_6_4&#45;&gt;expert_agg_6 -->
<g id="edge237" class="edge">
<title>expert_6_4&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8480.27,-11054.4C8486.33,-11046.05 8493.68,-11035.91 8501.05,-11025.76"/>
<polygon fill="black" stroke="black" points="8503.89,-11027.8 8506.93,-11017.65 8498.22,-11023.69 8503.89,-11027.8"/>
</g>
<!-- expert_6_5&#45;&gt;expert_agg_6 -->
<g id="edge240" class="edge">
<title>expert_6_5&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8917.54,-11056.45C8914.36,-11055.76 8911.2,-11055.09 8908.11,-11054.43 8816.9,-11035 8712.95,-11013.54 8638.17,-10998.22"/>
<polygon fill="black" stroke="black" points="8638.78,-10994.77 8628.28,-10996.2 8637.37,-11001.63 8638.78,-10994.77"/>
</g>
<!-- expert_6_6&#45;&gt;expert_agg_6 -->
<g id="edge243" class="edge">
<title>expert_6_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8621.45,-11054.4C8611.84,-11045.72 8600.06,-11035.1 8588.36,-11024.55"/>
<polygon fill="black" stroke="black" points="8590.48,-11021.75 8580.71,-11017.65 8585.79,-11026.95 8590.48,-11021.75"/>
</g>
<!-- expert_6_7&#45;&gt;expert_agg_6 -->
<g id="edge246" class="edge">
<title>expert_6_7&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M8762.64,-11054.4C8728.95,-11042.95 8685.28,-11028.11 8645.29,-11014.53"/>
<polygon fill="black" stroke="black" points="8646.35,-11011.19 8635.75,-11011.28 8644.09,-11017.82 8646.35,-11011.19"/>
</g>
<!-- expert_agg_6&#45;&gt;residual2_6 -->
<g id="edge247" class="edge">
<title>expert_agg_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M8447.25,-10963.11C8301.79,-10942.94 8016.96,-10903.45 7896.28,-10886.71"/>
<polygon fill="black" stroke="black" points="7896.54,-10883.22 7886.16,-10885.31 7895.58,-10890.15 7896.54,-10883.22"/>
</g>
<!-- ln2_6 -->
<g id="node125" class="node">
<title>ln2_6</title>
<polygon fill="lightpink" stroke="black" points="7886.11,-10820.43 7794.11,-10820.43 7794.11,-10779.43 7886.11,-10779.43 7886.11,-10820.43"/>
<text text-anchor="middle" x="7840.11" y="-10808.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7840.11" y="-10797.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7840.11" y="-10786.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- residual2_6&#45;&gt;ln2_6 -->
<g id="edge249" class="edge">
<title>residual2_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M7840.11,-10857.35C7840.11,-10849.2 7840.11,-10839.55 7840.11,-10830.56"/>
<polygon fill="black" stroke="black" points="7843.61,-10830.43 7840.11,-10820.43 7836.61,-10830.43 7843.61,-10830.43"/>
</g>
<!-- split_6 -->
<g id="node126" class="node">
<title>split_6</title>
<polygon fill="lightyellow" stroke="black" points="7984.17,-10742.43 7882.26,-10742.43 7856.05,-10682.43 7957.95,-10682.43 7984.17,-10742.43"/>
<text text-anchor="middle" x="7920.11" y="-10715.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="7920.11" y="-10704.43" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- ln2_6&#45;&gt;split_6 -->
<g id="edge250" class="edge">
<title>ln2_6&#45;&gt;split_6</title>
<path fill="none" stroke="black" d="M7858.66,-10779.1C7866.75,-10770.45 7876.51,-10760.02 7885.84,-10750.05"/>
<polygon fill="black" stroke="black" points="7888.58,-10752.25 7892.86,-10742.55 7883.47,-10747.46 7888.58,-10752.25"/>
</g>
<!-- agg_7 -->
<g id="node127" class="node">
<title>agg_7</title>
<polygon fill="lightyellow" stroke="black" points="7904.17,-10645.43 7802.26,-10645.43 7776.05,-10585.43 7877.95,-10585.43 7904.17,-10645.43"/>
<text text-anchor="middle" x="7840.11" y="-10618.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="7840.11" y="-10607.43" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- ln2_6&#45;&gt;agg_7 -->
<g id="edge256" class="edge">
<title>ln2_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M7840.11,-10779.4C7840.11,-10750.06 7840.11,-10694.02 7840.11,-10655.93"/>
<polygon fill="black" stroke="black" points="7843.61,-10655.7 7840.11,-10645.7 7836.61,-10655.7 7843.61,-10655.7"/>
</g>
<!-- split_6&#45;&gt;agg_7 -->
<g id="edge251" class="edge">
<title>split_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M7895.67,-10682.41C7887.99,-10673.28 7879.4,-10663.08 7871.31,-10653.48"/>
<polygon fill="black" stroke="black" points="7873.79,-10650.99 7864.67,-10645.6 7868.44,-10655.5 7873.79,-10650.99"/>
</g>
<!-- mha_q_7 -->
<g id="node128" class="node">
<title>mha_q_7</title>
<polygon fill="lightgreen" stroke="black" points="7963.11,-10548.43 7871.11,-10548.43 7871.11,-10507.43 7963.11,-10507.43 7963.11,-10548.43"/>
<text text-anchor="middle" x="7917.11" y="-10536.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="7917.11" y="-10525.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7917.11" y="-10514.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_q_7 -->
<g id="edge257" class="edge">
<title>agg_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M7866.61,-10585C7875.1,-10575.57 7884.47,-10565.17 7892.8,-10555.92"/>
<polygon fill="black" stroke="black" points="7895.42,-10558.24 7899.51,-10548.46 7890.22,-10553.55 7895.42,-10558.24"/>
</g>
<!-- mha_k_7 -->
<g id="node129" class="node">
<title>mha_k_7</title>
<polygon fill="lightgreen" stroke="black" points="8073.11,-10548.43 7981.11,-10548.43 7981.11,-10507.43 8073.11,-10507.43 8073.11,-10548.43"/>
<text text-anchor="middle" x="8027.11" y="-10536.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="8027.11" y="-10525.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="8027.11" y="-10514.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_k_7 -->
<g id="edge258" class="edge">
<title>agg_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M7882.54,-10595.03C7909.96,-10582.49 7945.83,-10566.09 7974.99,-10552.76"/>
<polygon fill="black" stroke="black" points="7976.56,-10555.89 7984.2,-10548.55 7973.65,-10549.52 7976.56,-10555.89"/>
</g>
<!-- mha_v_7 -->
<g id="node130" class="node">
<title>mha_v_7</title>
<polygon fill="lightgreen" stroke="black" points="7853.11,-10548.43 7761.11,-10548.43 7761.11,-10507.43 7853.11,-10507.43 7853.11,-10548.43"/>
<text text-anchor="middle" x="7807.11" y="-10536.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="7807.11" y="-10525.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7807.11" y="-10514.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_v_7 -->
<g id="edge259" class="edge">
<title>agg_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M7828.75,-10585C7825.36,-10576.23 7821.66,-10566.62 7818.28,-10557.88"/>
<polygon fill="black" stroke="black" points="7821.51,-10556.53 7814.65,-10548.46 7814.98,-10559.05 7821.51,-10556.53"/>
</g>
<!-- residual1_7 -->
<g id="node133" class="node">
<title>residual1_7</title>
<polygon fill="lightpink" stroke="black" points="7791.11,-10314.43 7699.11,-10314.43 7699.11,-10273.43 7791.11,-10273.43 7791.11,-10314.43"/>
<text text-anchor="middle" x="7745.11" y="-10302.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7745.11" y="-10291.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7745.11" y="-10280.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;residual1_7 -->
<g id="edge260" class="edge">
<title>agg_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M7777.87,-10589.71C7754.33,-10575.95 7733.11,-10556.03 7733.11,-10528.93 7733.11,-10528.93 7733.11,-10528.93 7733.11,-10370.93 7733.11,-10355.49 7735.55,-10338.51 7738.23,-10324.52"/>
<polygon fill="black" stroke="black" points="7741.71,-10324.98 7740.3,-10314.48 7734.86,-10323.57 7741.71,-10324.98"/>
</g>
<!-- mha_attn_7 -->
<g id="node131" class="node">
<title>mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="7920.11,-10470.43 7816.11,-10470.43 7816.11,-10429.43 7920.11,-10429.43 7920.11,-10470.43"/>
<text text-anchor="middle" x="7868.11" y="-10458.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="7868.11" y="-10447.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="7868.11" y="-10436.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge252" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M7904.49,-10507.35C7898.94,-10498.76 7892.33,-10488.5 7886.27,-10479.1"/>
<polygon fill="black" stroke="black" points="7889.04,-10476.94 7880.68,-10470.43 7883.16,-10480.73 7889.04,-10476.94"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge253" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M7986.16,-10507.35C7965.39,-10497.43 7939.98,-10485.28 7918.07,-10474.81"/>
<polygon fill="black" stroke="black" points="7919.45,-10471.59 7908.92,-10470.43 7916.43,-10477.9 7919.45,-10471.59"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge254" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M7822.82,-10507.35C7829.86,-10498.58 7838.29,-10488.07 7845.96,-10478.52"/>
<polygon fill="black" stroke="black" points="7848.92,-10480.42 7852.45,-10470.43 7843.46,-10476.04 7848.92,-10480.42"/>
</g>
<!-- mha_out_7 -->
<g id="node132" class="node">
<title>mha_out_7</title>
<polygon fill="lightgreen" stroke="black" points="7865.11,-10392.43 7773.11,-10392.43 7773.11,-10351.43 7865.11,-10351.43 7865.11,-10392.43"/>
<text text-anchor="middle" x="7819.11" y="-10380.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="7819.11" y="-10369.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7819.11" y="-10358.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge255" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M7855.49,-10429.35C7849.94,-10420.76 7843.33,-10410.5 7837.27,-10401.1"/>
<polygon fill="black" stroke="black" points="7840.04,-10398.94 7831.68,-10392.43 7834.16,-10402.73 7840.04,-10398.94"/>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge261" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M7800.05,-10351.35C7791.25,-10342.31 7780.65,-10331.43 7771.13,-10321.65"/>
<polygon fill="black" stroke="black" points="7773.58,-10319.16 7764.1,-10314.43 7768.57,-10324.04 7773.58,-10319.16"/>
</g>
<!-- ln1_7 -->
<g id="node134" class="node">
<title>ln1_7</title>
<polygon fill="lightpink" stroke="black" points="7791.11,-10236.43 7699.11,-10236.43 7699.11,-10195.43 7791.11,-10195.43 7791.11,-10236.43"/>
<text text-anchor="middle" x="7745.11" y="-10224.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7745.11" y="-10213.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7745.11" y="-10202.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- residual1_7&#45;&gt;ln1_7 -->
<g id="edge262" class="edge">
<title>residual1_7&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M7745.11,-10273.35C7745.11,-10265.2 7745.11,-10255.55 7745.11,-10246.56"/>
<polygon fill="black" stroke="black" points="7748.61,-10246.43 7745.11,-10236.43 7741.61,-10246.43 7748.61,-10246.43"/>
</g>
<!-- gate_7 -->
<g id="node135" class="node">
<title>gate_7</title>
<polygon fill="gold" stroke="black" points="7745.11,-10158.43 7668.11,-10117.43 7745.11,-10076.43 7822.11,-10117.43 7745.11,-10158.43"/>
<text text-anchor="middle" x="7745.11" y="-10125.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="7745.11" y="-10114.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="7745.11" y="-10103.93" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;gate_7 -->
<g id="edge263" class="edge">
<title>ln1_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M7745.11,-10195.4C7745.11,-10187.63 7745.11,-10178.31 7745.11,-10168.87"/>
<polygon fill="black" stroke="black" points="7748.61,-10168.65 7745.11,-10158.65 7741.61,-10168.65 7748.61,-10168.65"/>
</g>
<!-- expert_7_0 -->
<g id="node136" class="node">
<title>expert_7_0</title>
<polygon fill="lightcoral" stroke="black" points="8482.61,-10025.43 8323.61,-10025.43 8323.61,-9984.43 8482.61,-9984.43 8482.61,-10025.43"/>
<text text-anchor="middle" x="8403.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="8403.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8403.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_0 -->
<g id="edge266" class="edge">
<title>ln1_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" d="M7791.16,-10211.71C7858.42,-10206.05 7986.86,-10191.62 8091.11,-10158.43 8193.35,-10125.87 8304.23,-10064.87 8362.32,-10030.72"/>
<polygon fill="black" stroke="black" points="8364.36,-10033.58 8371.18,-10025.47 8360.79,-10027.55 8364.36,-10033.58"/>
</g>
<!-- expert_7_1 -->
<g id="node137" class="node">
<title>expert_7_1</title>
<polygon fill="lightcoral" stroke="black" points="7420.61,-10025.43 7261.61,-10025.43 7261.61,-9984.43 7420.61,-9984.43 7420.61,-10025.43"/>
<text text-anchor="middle" x="7341.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="7341.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7341.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_1 -->
<g id="edge269" class="edge">
<title>ln1_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" d="M7698.93,-10210.5C7646.75,-10204.19 7560.21,-10189.69 7492.11,-10158.43 7424.57,-10127.42 7401.37,-10118.85 7358.11,-10058.43 7353.21,-10051.58 7349.67,-10043.25 7347.13,-10035.25"/>
<polygon fill="black" stroke="black" points="7350.46,-10034.16 7344.43,-10025.45 7343.71,-10036.02 7350.46,-10034.16"/>
</g>
<!-- expert_7_2 -->
<g id="node138" class="node">
<title>expert_7_2</title>
<polygon fill="lightcoral" stroke="black" points="7597.61,-10025.43 7438.61,-10025.43 7438.61,-9984.43 7597.61,-9984.43 7597.61,-10025.43"/>
<text text-anchor="middle" x="7518.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="7518.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7518.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_2 -->
<g id="edge272" class="edge">
<title>ln1_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" d="M7699.1,-10201.78C7669.34,-10192.17 7630.45,-10177.51 7599.11,-10158.43 7541.82,-10123.55 7513.65,-10119.57 7486.11,-10058.43 7482.45,-10050.31 7484.57,-10041.91 7489.09,-10034.28"/>
<polygon fill="black" stroke="black" points="7492.26,-10035.88 7495.3,-10025.73 7486.59,-10031.76 7492.26,-10035.88"/>
</g>
<!-- expert_7_3 -->
<g id="node139" class="node">
<title>expert_7_3</title>
<polygon fill="lightcoral" stroke="black" points="7243.61,-10025.43 7084.61,-10025.43 7084.61,-9984.43 7243.61,-9984.43 7243.61,-10025.43"/>
<text text-anchor="middle" x="7164.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="7164.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7164.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_3 -->
<g id="edge275" class="edge">
<title>ln1_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" d="M7699.09,-10215.16C7626.08,-10214 7480.49,-10205.33 7368.11,-10158.43 7296.29,-10128.46 7226.81,-10067.63 7190.39,-10032.53"/>
<polygon fill="black" stroke="black" points="7192.74,-10029.92 7183.13,-10025.45 7187.85,-10034.93 7192.74,-10029.92"/>
</g>
<!-- expert_7_4 -->
<g id="node140" class="node">
<title>expert_7_4</title>
<polygon fill="lightcoral" stroke="black" points="7774.61,-10025.43 7615.61,-10025.43 7615.61,-9984.43 7774.61,-9984.43 7774.61,-10025.43"/>
<text text-anchor="middle" x="7695.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="7695.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7695.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_4 -->
<g id="edge278" class="edge">
<title>ln1_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" d="M7707.77,-10195.27C7691.6,-10185.59 7673.19,-10172.89 7659.11,-10158.43 7622.62,-10120.97 7611.43,-10108.72 7597.11,-10058.43 7593.71,-10046.51 7598.18,-10037.27 7606.79,-10030.11"/>
<polygon fill="black" stroke="black" points="7609,-10032.84 7615.32,-10024.34 7605.08,-10027.04 7609,-10032.84"/>
</g>
<!-- expert_7_5 -->
<g id="node141" class="node">
<title>expert_7_5</title>
<polygon fill="lightcoral" stroke="black" points="8305.61,-10025.43 8146.61,-10025.43 8146.61,-9984.43 8305.61,-9984.43 8305.61,-10025.43"/>
<text text-anchor="middle" x="8226.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="8226.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8226.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_5 -->
<g id="edge281" class="edge">
<title>ln1_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" d="M7791.2,-10208.61C7876.75,-10194.86 8062.33,-10155.32 8183.11,-10058.43 8191.88,-10051.39 8200.09,-10042.29 8206.94,-10033.66"/>
<polygon fill="black" stroke="black" points="8209.8,-10035.68 8213.06,-10025.61 8204.22,-10031.45 8209.8,-10035.68"/>
</g>
<!-- expert_7_6 -->
<g id="node142" class="node">
<title>expert_7_6</title>
<polygon fill="lightcoral" stroke="black" points="7951.61,-10025.43 7792.61,-10025.43 7792.61,-9984.43 7951.61,-9984.43 7951.61,-10025.43"/>
<text text-anchor="middle" x="7872.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="7872.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7872.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_6 -->
<g id="edge284" class="edge">
<title>ln1_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" d="M7788.47,-10195.29C7836.03,-10170.97 7909.42,-10124.51 7938.11,-10058.43 7942.66,-10047.94 7938.29,-10038.96 7930.02,-10031.55"/>
<polygon fill="black" stroke="black" points="7931.97,-10028.64 7921.87,-10025.44 7927.77,-10034.24 7931.97,-10028.64"/>
</g>
<!-- expert_7_7 -->
<g id="node143" class="node">
<title>expert_7_7</title>
<polygon fill="lightcoral" stroke="black" points="8128.61,-10025.43 7969.61,-10025.43 7969.61,-9984.43 8128.61,-9984.43 8128.61,-10025.43"/>
<text text-anchor="middle" x="8049.11" y="-10013.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="8049.11" y="-10002.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="8049.11" y="-9991.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_7_7 -->
<g id="edge287" class="edge">
<title>ln1_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" d="M7791.32,-10202.03C7823.78,-10192.13 7867.72,-10177.03 7904.11,-10158.43 7973.81,-10122.79 8012.71,-10127.74 8049.11,-10058.43 8052.69,-10051.6 8053.91,-10043.56 8053.93,-10035.84"/>
<polygon fill="black" stroke="black" points="8057.41,-10035.45 8053.33,-10025.68 8050.42,-10035.87 8057.41,-10035.45"/>
</g>
<!-- expert_agg_7 -->
<g id="node144" class="node">
<title>expert_agg_7</title>
<polygon fill="lightyellow" stroke="black" points="7886.88,-9947.43 7723.39,-9947.43 7681.33,-9865.43 7844.83,-9865.43 7886.88,-9947.43"/>
<text text-anchor="middle" x="7784.11" y="-9914.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7784.11" y="-9903.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7784.11" y="-9892.93" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;expert_agg_7 -->
<g id="edge264" class="edge">
<title>ln1_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7791.4,-10215.66C7982.68,-10217.28 8692.16,-10208.57 8491.11,-9984.43 8450.9,-9939.61 8061.49,-9918.38 7878.38,-9910.82"/>
<polygon fill="black" stroke="black" points="7878.36,-9907.32 7868.22,-9910.4 7878.07,-9914.31 7878.36,-9907.32"/>
</g>
<!-- residual2_7 -->
<g id="node145" class="node">
<title>residual2_7</title>
<polygon fill="lightpink" stroke="black" points="7115.11,-9828.43 7023.11,-9828.43 7023.11,-9787.43 7115.11,-9787.43 7115.11,-9828.43"/>
<text text-anchor="middle" x="7069.11" y="-9816.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="7069.11" y="-9805.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7069.11" y="-9794.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;residual2_7 -->
<g id="edge290" class="edge">
<title>ln1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M7698.9,-10213.32C7544.64,-10207.37 7057.11,-10183.41 7057.11,-10118.43 7057.11,-10118.43 7057.11,-10118.43 7057.11,-9905.43 7057.11,-9882.78 7060.4,-9857.37 7063.54,-9838.31"/>
<polygon fill="black" stroke="black" points="7066.99,-9838.88 7065.24,-9828.43 7060.09,-9837.69 7066.99,-9838.88"/>
</g>
<!-- gate_7&#45;&gt;expert_7_0 -->
<g id="edge265" class="edge">
<title>gate_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7804.69,-10108.04C7906.71,-10093.43 8121.56,-10061.58 8313.58,-10025.47"/>
<polygon fill="black" stroke="black" points="8314.4,-10028.88 8323.58,-10023.59 8313.1,-10022 8314.4,-10028.88"/>
<text text-anchor="middle" x="8237.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_7&#45;&gt;expert_7_1 -->
<g id="edge268" class="edge">
<title>gate_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7694.93,-10102.9C7651.55,-10091.19 7587.17,-10073.77 7531.11,-10058.43 7495.06,-10048.56 7455.18,-10037.56 7421.31,-10028.18"/>
<polygon fill="black" stroke="black" points="7422.04,-10024.75 7411.47,-10025.46 7420.17,-10031.5 7422.04,-10024.75"/>
<text text-anchor="middle" x="7562.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_7&#45;&gt;expert_7_2 -->
<g id="edge271" class="edge">
<title>gate_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7705.83,-10097.3C7667.49,-10078.64 7609.02,-10050.18 7567.54,-10029.99"/>
<polygon fill="black" stroke="black" points="7568.96,-10026.79 7558.43,-10025.56 7565.89,-10033.08 7568.96,-10026.79"/>
<text text-anchor="middle" x="7656.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_7&#45;&gt;expert_7_3 -->
<g id="edge274" class="edge">
<title>gate_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7687.56,-10106.96C7621.09,-10095.9 7508.53,-10076.76 7412.11,-10058.43 7343.84,-10045.44 7324.73,-10041 7253.62,-10025.74"/>
<polygon fill="black" stroke="black" points="7254.23,-10022.3 7243.72,-10023.62 7252.77,-10029.14 7254.23,-10022.3"/>
<text text-anchor="middle" x="7443.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_7&#45;&gt;expert_7_4 -->
<g id="edge277" class="edge">
<title>gate_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7721.04,-10088.84C7714.23,-10079.7 7707.49,-10069.12 7703.11,-10058.43 7700.17,-10051.27 7698.31,-10043.17 7697.12,-10035.51"/>
<polygon fill="black" stroke="black" points="7700.58,-10034.96 7695.88,-10025.47 7693.63,-10035.82 7700.58,-10034.96"/>
<text text-anchor="middle" x="7734.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_7&#45;&gt;expert_7_5 -->
<g id="edge280" class="edge">
<title>gate_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7795.33,-10103.09C7839.52,-10091.35 7905.59,-10073.78 7963.11,-10058.43 7988,-10051.78 7993.89,-10048.71 8019.11,-10043.43 8068.09,-10033.16 8083.25,-10034.86 8136.55,-10025.44"/>
<polygon fill="black" stroke="black" points="8137.37,-10028.85 8146.58,-10023.62 8136.12,-10021.96 8137.37,-10028.85"/>
<text text-anchor="middle" x="8050.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_7&#45;&gt;expert_7_6 -->
<g id="edge283" class="edge">
<title>gate_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7759.26,-10083.94C7766.57,-10070.06 7776.61,-10054.53 7789.11,-10043.43 7794.55,-10038.59 7800.73,-10034.28 7807.19,-10030.46"/>
<polygon fill="black" stroke="black" points="7809.05,-10033.43 7816.14,-10025.56 7805.69,-10027.29 7809.05,-10033.43"/>
<text text-anchor="middle" x="7820.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_7&#45;&gt;expert_7_7 -->
<g id="edge286" class="edge">
<title>gate_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7782.77,-10096.16C7813.63,-10080.18 7858.79,-10058.2 7900.11,-10043.43 7911.86,-10039.22 7934.93,-10033.08 7959.47,-10026.98"/>
<polygon fill="black" stroke="black" points="7960.43,-10030.35 7969.3,-10024.56 7958.75,-10023.56 7960.43,-10030.35"/>
<text text-anchor="middle" x="7931.61" y="-10047.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_7_0&#45;&gt;expert_agg_7 -->
<g id="edge267" class="edge">
<title>expert_7_0&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M8323.59,-9986.21C8320.39,-9985.59 8317.22,-9984.99 8314.11,-9984.43 8164.12,-9957.14 7988.85,-9933.22 7882.21,-9919.55"/>
<polygon fill="black" stroke="black" points="7882.47,-9916.05 7872.11,-9918.26 7881.58,-9922.99 7882.47,-9916.05"/>
</g>
<!-- expert_7_1&#45;&gt;expert_agg_7 -->
<g id="edge270" class="edge">
<title>expert_7_1&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7420.73,-9986.27C7423.56,-9985.64 7426.36,-9985.03 7429.11,-9984.43 7522.07,-9964.05 7628.78,-9940.94 7700.74,-9925.4"/>
<polygon fill="black" stroke="black" points="7701.62,-9928.79 7710.66,-9923.26 7700.14,-9921.95 7701.62,-9928.79"/>
</g>
<!-- expert_7_2&#45;&gt;expert_agg_7 -->
<g id="edge273" class="edge">
<title>expert_7_2&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7571.94,-9984.4C7610.33,-9970.47 7662.55,-9951.53 7705.58,-9935.92"/>
<polygon fill="black" stroke="black" points="7706.97,-9939.14 7715.17,-9932.43 7704.58,-9932.55 7706.97,-9939.14"/>
</g>
<!-- expert_7_3&#45;&gt;expert_agg_7 -->
<g id="edge276" class="edge">
<title>expert_7_3&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7243.68,-9986.02C7246.52,-9985.47 7249.34,-9984.93 7252.11,-9984.43 7408.41,-9955.84 7592.12,-9931.22 7697.65,-9917.93"/>
<polygon fill="black" stroke="black" points="7698.13,-9921.4 7707.61,-9916.68 7697.25,-9914.45 7698.13,-9921.4"/>
</g>
<!-- expert_7_4&#45;&gt;expert_agg_7 -->
<g id="edge279" class="edge">
<title>expert_7_4&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7713.12,-9984.4C7720.97,-9975.89 7730.54,-9965.51 7740.09,-9955.16"/>
<polygon fill="black" stroke="black" points="7742.8,-9957.38 7747.01,-9947.65 7737.66,-9952.63 7742.8,-9957.38"/>
</g>
<!-- expert_7_5&#45;&gt;expert_agg_7 -->
<g id="edge282" class="edge">
<title>expert_7_5&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M8146.53,-9986.49C8143.35,-9985.79 8140.2,-9985.1 8137.11,-9984.43 8053,-9966.04 7957.62,-9945.24 7887.22,-9929.89"/>
<polygon fill="black" stroke="black" points="7887.53,-9926.38 7877.02,-9927.67 7886.04,-9933.22 7887.53,-9926.38"/>
</g>
<!-- expert_7_6&#45;&gt;expert_agg_7 -->
<g id="edge285" class="edge">
<title>expert_7_6&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7854.3,-9984.4C7846.54,-9975.89 7837.07,-9965.51 7827.63,-9955.16"/>
<polygon fill="black" stroke="black" points="7830.11,-9952.68 7820.79,-9947.65 7824.94,-9957.4 7830.11,-9952.68"/>
</g>
<!-- expert_7_7&#45;&gt;expert_agg_7 -->
<g id="edge288" class="edge">
<title>expert_7_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M7995.48,-9984.4C7966.59,-9973.88 7929.83,-9960.49 7895.1,-9947.84"/>
<polygon fill="black" stroke="black" points="7895.96,-9944.43 7885.36,-9944.3 7893.56,-9951.01 7895.96,-9944.43"/>
</g>
<!-- expert_agg_7&#45;&gt;residual2_7 -->
<g id="edge289" class="edge">
<title>expert_agg_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M7695.72,-9893.5C7546.54,-9873.36 7248.96,-9833.2 7125.16,-9816.49"/>
<polygon fill="black" stroke="black" points="7125.52,-9813.01 7115.14,-9815.14 7124.58,-9819.95 7125.52,-9813.01"/>
</g>
<!-- ln2_7 -->
<g id="node146" class="node">
<title>ln2_7</title>
<polygon fill="lightpink" stroke="black" points="7115.11,-9750.43 7023.11,-9750.43 7023.11,-9709.43 7115.11,-9709.43 7115.11,-9750.43"/>
<text text-anchor="middle" x="7069.11" y="-9738.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7069.11" y="-9727.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7069.11" y="-9716.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- residual2_7&#45;&gt;ln2_7 -->
<g id="edge291" class="edge">
<title>residual2_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M7069.11,-9787.35C7069.11,-9779.2 7069.11,-9769.55 7069.11,-9760.56"/>
<polygon fill="black" stroke="black" points="7072.61,-9760.43 7069.11,-9750.43 7065.61,-9760.43 7072.61,-9760.43"/>
</g>
<!-- split_7 -->
<g id="node147" class="node">
<title>split_7</title>
<polygon fill="lightyellow" stroke="black" points="7213.17,-9672.43 7111.26,-9672.43 7085.05,-9612.43 7186.95,-9612.43 7213.17,-9672.43"/>
<text text-anchor="middle" x="7149.11" y="-9645.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="7149.11" y="-9634.43" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- ln2_7&#45;&gt;split_7 -->
<g id="edge292" class="edge">
<title>ln2_7&#45;&gt;split_7</title>
<path fill="none" stroke="black" d="M7087.66,-9709.1C7095.75,-9700.45 7105.51,-9690.02 7114.84,-9680.05"/>
<polygon fill="black" stroke="black" points="7117.58,-9682.25 7121.86,-9672.55 7112.47,-9677.46 7117.58,-9682.25"/>
</g>
<!-- agg_8 -->
<g id="node148" class="node">
<title>agg_8</title>
<polygon fill="lightyellow" stroke="black" points="7133.17,-9575.43 7031.26,-9575.43 7005.05,-9515.43 7106.95,-9515.43 7133.17,-9575.43"/>
<text text-anchor="middle" x="7069.11" y="-9548.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="7069.11" y="-9537.43" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- ln2_7&#45;&gt;agg_8 -->
<g id="edge298" class="edge">
<title>ln2_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M7069.11,-9709.4C7069.11,-9680.06 7069.11,-9624.02 7069.11,-9585.93"/>
<polygon fill="black" stroke="black" points="7072.61,-9585.7 7069.11,-9575.7 7065.61,-9585.7 7072.61,-9585.7"/>
</g>
<!-- split_7&#45;&gt;agg_8 -->
<g id="edge293" class="edge">
<title>split_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M7124.67,-9612.41C7116.99,-9603.28 7108.4,-9593.08 7100.31,-9583.48"/>
<polygon fill="black" stroke="black" points="7102.79,-9580.99 7093.67,-9575.6 7097.44,-9585.5 7102.79,-9580.99"/>
</g>
<!-- mha_q_8 -->
<g id="node149" class="node">
<title>mha_q_8</title>
<polygon fill="lightgreen" stroke="black" points="7192.11,-9478.43 7100.11,-9478.43 7100.11,-9437.43 7192.11,-9437.43 7192.11,-9478.43"/>
<text text-anchor="middle" x="7146.11" y="-9466.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="7146.11" y="-9455.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7146.11" y="-9444.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_q_8 -->
<g id="edge299" class="edge">
<title>agg_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M7095.61,-9515C7104.1,-9505.57 7113.47,-9495.17 7121.8,-9485.92"/>
<polygon fill="black" stroke="black" points="7124.42,-9488.24 7128.51,-9478.46 7119.22,-9483.55 7124.42,-9488.24"/>
</g>
<!-- mha_k_8 -->
<g id="node150" class="node">
<title>mha_k_8</title>
<polygon fill="lightgreen" stroke="black" points="7302.11,-9478.43 7210.11,-9478.43 7210.11,-9437.43 7302.11,-9437.43 7302.11,-9478.43"/>
<text text-anchor="middle" x="7256.11" y="-9466.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="7256.11" y="-9455.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7256.11" y="-9444.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_k_8 -->
<g id="edge300" class="edge">
<title>agg_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M7111.54,-9525.03C7138.96,-9512.49 7174.83,-9496.09 7203.99,-9482.76"/>
<polygon fill="black" stroke="black" points="7205.56,-9485.89 7213.2,-9478.55 7202.65,-9479.52 7205.56,-9485.89"/>
</g>
<!-- mha_v_8 -->
<g id="node151" class="node">
<title>mha_v_8</title>
<polygon fill="lightgreen" stroke="black" points="7082.11,-9478.43 6990.11,-9478.43 6990.11,-9437.43 7082.11,-9437.43 7082.11,-9478.43"/>
<text text-anchor="middle" x="7036.11" y="-9466.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="7036.11" y="-9455.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7036.11" y="-9444.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_v_8 -->
<g id="edge301" class="edge">
<title>agg_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M7057.75,-9515C7054.36,-9506.23 7050.66,-9496.62 7047.28,-9487.88"/>
<polygon fill="black" stroke="black" points="7050.51,-9486.53 7043.65,-9478.46 7043.98,-9489.05 7050.51,-9486.53"/>
</g>
<!-- residual1_8 -->
<g id="node154" class="node">
<title>residual1_8</title>
<polygon fill="lightpink" stroke="black" points="7020.11,-9244.43 6928.11,-9244.43 6928.11,-9203.43 7020.11,-9203.43 7020.11,-9244.43"/>
<text text-anchor="middle" x="6974.11" y="-9232.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6974.11" y="-9221.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6974.11" y="-9210.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;residual1_8 -->
<g id="edge302" class="edge">
<title>agg_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7006.87,-9519.71C6983.33,-9505.95 6962.11,-9486.03 6962.11,-9458.93 6962.11,-9458.93 6962.11,-9458.93 6962.11,-9300.93 6962.11,-9285.49 6964.55,-9268.51 6967.23,-9254.52"/>
<polygon fill="black" stroke="black" points="6970.71,-9254.98 6969.3,-9244.48 6963.86,-9253.57 6970.71,-9254.98"/>
</g>
<!-- mha_attn_8 -->
<g id="node152" class="node">
<title>mha_attn_8</title>
<polygon fill="lightgreen" stroke="black" points="7103.11,-9400.43 6999.11,-9400.43 6999.11,-9359.43 7103.11,-9359.43 7103.11,-9400.43"/>
<text text-anchor="middle" x="7051.11" y="-9388.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="7051.11" y="-9377.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="7051.11" y="-9366.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge294" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M7121.64,-9437.35C7110.01,-9428.05 7095.94,-9416.79 7083.44,-9406.79"/>
<polygon fill="black" stroke="black" points="7085.48,-9403.95 7075.49,-9400.43 7081.11,-9409.41 7085.48,-9403.95"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge295" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M7210.1,-9439.87C7181.43,-9429.24 7144.18,-9415.43 7112.95,-9403.85"/>
<polygon fill="black" stroke="black" points="7114.06,-9400.53 7103.46,-9400.34 7111.62,-9407.09 7114.06,-9400.53"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge296" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M7039.97,-9437.35C7041.6,-9429.11 7043.53,-9419.34 7045.32,-9410.26"/>
<polygon fill="black" stroke="black" points="7048.76,-9410.92 7047.26,-9400.43 7041.89,-9409.56 7048.76,-9410.92"/>
</g>
<!-- mha_out_8 -->
<g id="node153" class="node">
<title>mha_out_8</title>
<polygon fill="lightgreen" stroke="black" points="7085.11,-9322.43 6993.11,-9322.43 6993.11,-9281.43 7085.11,-9281.43 7085.11,-9322.43"/>
<text text-anchor="middle" x="7039.11" y="-9310.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="7039.11" y="-9299.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7039.11" y="-9288.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge297" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M7048.02,-9359.35C7046.73,-9351.2 7045.21,-9341.55 7043.79,-9332.56"/>
<polygon fill="black" stroke="black" points="7047.2,-9331.76 7042.19,-9322.43 7040.29,-9332.86 7047.2,-9331.76"/>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge303" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7022.37,-9281.35C7014.79,-9272.49 7005.69,-9261.86 6997.46,-9252.23"/>
<polygon fill="black" stroke="black" points="6999.95,-9249.76 6990.79,-9244.43 6994.63,-9254.31 6999.95,-9249.76"/>
</g>
<!-- ln1_8 -->
<g id="node155" class="node">
<title>ln1_8</title>
<polygon fill="lightpink" stroke="black" points="7020.11,-9166.43 6928.11,-9166.43 6928.11,-9125.43 7020.11,-9125.43 7020.11,-9166.43"/>
<text text-anchor="middle" x="6974.11" y="-9154.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6974.11" y="-9143.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6974.11" y="-9132.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- residual1_8&#45;&gt;ln1_8 -->
<g id="edge304" class="edge">
<title>residual1_8&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M6974.11,-9203.35C6974.11,-9195.2 6974.11,-9185.55 6974.11,-9176.56"/>
<polygon fill="black" stroke="black" points="6977.61,-9176.43 6974.11,-9166.43 6970.61,-9176.43 6977.61,-9176.43"/>
</g>
<!-- gate_8 -->
<g id="node156" class="node">
<title>gate_8</title>
<polygon fill="gold" stroke="black" points="6974.11,-9088.43 6897.11,-9047.43 6974.11,-9006.43 7051.11,-9047.43 6974.11,-9088.43"/>
<text text-anchor="middle" x="6974.11" y="-9055.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="6974.11" y="-9044.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="6974.11" y="-9033.93" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;gate_8 -->
<g id="edge305" class="edge">
<title>ln1_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M6974.11,-9125.4C6974.11,-9117.63 6974.11,-9108.31 6974.11,-9098.87"/>
<polygon fill="black" stroke="black" points="6977.61,-9098.65 6974.11,-9088.65 6970.61,-9098.65 6977.61,-9098.65"/>
</g>
<!-- expert_8_0 -->
<g id="node157" class="node">
<title>expert_8_0</title>
<polygon fill="lightcoral" stroke="black" points="7711.61,-8955.43 7552.61,-8955.43 7552.61,-8914.43 7711.61,-8914.43 7711.61,-8955.43"/>
<text text-anchor="middle" x="7632.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="7632.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7632.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_0 -->
<g id="edge308" class="edge">
<title>ln1_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" d="M7020.16,-9141.71C7087.42,-9136.05 7215.86,-9121.62 7320.11,-9088.43 7422.35,-9055.87 7533.23,-8994.87 7591.32,-8960.72"/>
<polygon fill="black" stroke="black" points="7593.36,-8963.58 7600.18,-8955.47 7589.79,-8957.55 7593.36,-8963.58"/>
</g>
<!-- expert_8_1 -->
<g id="node158" class="node">
<title>expert_8_1</title>
<polygon fill="lightcoral" stroke="black" points="6649.61,-8955.43 6490.61,-8955.43 6490.61,-8914.43 6649.61,-8914.43 6649.61,-8955.43"/>
<text text-anchor="middle" x="6570.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="6570.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6570.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_1 -->
<g id="edge311" class="edge">
<title>ln1_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" d="M6927.76,-9140.87C6875.41,-9134.89 6788.73,-9120.7 6721.11,-9088.43 6656.59,-9057.63 6639.63,-9044.37 6595.11,-8988.43 6589.51,-8981.39 6584.77,-8972.88 6580.99,-8964.79"/>
<polygon fill="black" stroke="black" points="6584.18,-8963.36 6576.98,-8955.59 6577.76,-8966.16 6584.18,-8963.36"/>
</g>
<!-- expert_8_2 -->
<g id="node159" class="node">
<title>expert_8_2</title>
<polygon fill="lightcoral" stroke="black" points="6826.61,-8955.43 6667.61,-8955.43 6667.61,-8914.43 6826.61,-8914.43 6826.61,-8955.43"/>
<text text-anchor="middle" x="6747.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="6747.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6747.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_2 -->
<g id="edge314" class="edge">
<title>ln1_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" d="M6928.1,-9131.78C6898.34,-9122.17 6859.45,-9107.51 6828.11,-9088.43 6770.82,-9053.55 6742.65,-9049.57 6715.11,-8988.43 6711.45,-8980.31 6713.57,-8971.91 6718.09,-8964.28"/>
<polygon fill="black" stroke="black" points="6721.26,-8965.88 6724.3,-8955.73 6715.59,-8961.76 6721.26,-8965.88"/>
</g>
<!-- expert_8_3 -->
<g id="node160" class="node">
<title>expert_8_3</title>
<polygon fill="lightcoral" stroke="black" points="6472.61,-8955.43 6313.61,-8955.43 6313.61,-8914.43 6472.61,-8914.43 6472.61,-8955.43"/>
<text text-anchor="middle" x="6393.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="6393.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6393.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_3 -->
<g id="edge317" class="edge">
<title>ln1_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" d="M6927.97,-9144.59C6856.59,-9142.6 6716.25,-9132.78 6607.11,-9088.43 6532.93,-9058.28 6459.87,-8997.79 6421.27,-8962.73"/>
<polygon fill="black" stroke="black" points="6423.3,-8959.84 6413.56,-8955.66 6418.56,-8965 6423.3,-8959.84"/>
</g>
<!-- expert_8_4 -->
<g id="node161" class="node">
<title>expert_8_4</title>
<polygon fill="lightcoral" stroke="black" points="7003.61,-8955.43 6844.61,-8955.43 6844.61,-8914.43 7003.61,-8914.43 7003.61,-8955.43"/>
<text text-anchor="middle" x="6924.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="6924.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6924.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_4 -->
<g id="edge320" class="edge">
<title>ln1_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" d="M6936.77,-9125.27C6920.6,-9115.59 6902.19,-9102.89 6888.11,-9088.43 6851.62,-9050.97 6840.43,-9038.72 6826.11,-8988.43 6822.71,-8976.51 6827.18,-8967.27 6835.79,-8960.11"/>
<polygon fill="black" stroke="black" points="6838,-8962.84 6844.32,-8954.34 6834.08,-8957.04 6838,-8962.84"/>
</g>
<!-- expert_8_5 -->
<g id="node162" class="node">
<title>expert_8_5</title>
<polygon fill="lightcoral" stroke="black" points="7534.61,-8955.43 7375.61,-8955.43 7375.61,-8914.43 7534.61,-8914.43 7534.61,-8955.43"/>
<text text-anchor="middle" x="7455.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="7455.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7455.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_5 -->
<g id="edge323" class="edge">
<title>ln1_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" d="M7020.2,-9138.61C7105.75,-9124.86 7291.33,-9085.32 7412.11,-8988.43 7420.88,-8981.39 7429.09,-8972.29 7435.94,-8963.66"/>
<polygon fill="black" stroke="black" points="7438.8,-8965.68 7442.06,-8955.61 7433.22,-8961.45 7438.8,-8965.68"/>
</g>
<!-- expert_8_6 -->
<g id="node163" class="node">
<title>expert_8_6</title>
<polygon fill="lightcoral" stroke="black" points="7180.61,-8955.43 7021.61,-8955.43 7021.61,-8914.43 7180.61,-8914.43 7180.61,-8955.43"/>
<text text-anchor="middle" x="7101.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="7101.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7101.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_6 -->
<g id="edge326" class="edge">
<title>ln1_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" d="M7017.47,-9125.29C7065.03,-9100.97 7138.42,-9054.51 7167.11,-8988.43 7171.66,-8977.94 7167.29,-8968.96 7159.02,-8961.55"/>
<polygon fill="black" stroke="black" points="7160.97,-8958.64 7150.87,-8955.44 7156.77,-8964.24 7160.97,-8958.64"/>
</g>
<!-- expert_8_7 -->
<g id="node164" class="node">
<title>expert_8_7</title>
<polygon fill="lightcoral" stroke="black" points="7357.61,-8955.43 7198.61,-8955.43 7198.61,-8914.43 7357.61,-8914.43 7357.61,-8955.43"/>
<text text-anchor="middle" x="7278.11" y="-8943.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="7278.11" y="-8932.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="7278.11" y="-8921.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_8_7 -->
<g id="edge329" class="edge">
<title>ln1_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" d="M7020.32,-9132.03C7052.78,-9122.13 7096.72,-9107.03 7133.11,-9088.43 7202.81,-9052.79 7241.71,-9057.74 7278.11,-8988.43 7281.69,-8981.6 7282.91,-8973.56 7282.93,-8965.84"/>
<polygon fill="black" stroke="black" points="7286.41,-8965.45 7282.33,-8955.68 7279.42,-8965.87 7286.41,-8965.45"/>
</g>
<!-- expert_agg_8 -->
<g id="node165" class="node">
<title>expert_agg_8</title>
<polygon fill="lightyellow" stroke="black" points="7114.88,-8877.43 6951.39,-8877.43 6909.33,-8795.43 7072.83,-8795.43 7114.88,-8877.43"/>
<text text-anchor="middle" x="7012.11" y="-8844.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="7012.11" y="-8833.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="7012.11" y="-8822.93" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;expert_agg_8 -->
<g id="edge306" class="edge">
<title>ln1_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7020.4,-9145.66C7211.69,-9147.28 7921.18,-9138.55 7720.11,-8914.43 7679.82,-8869.52 7289.39,-8848.33 7106.17,-8840.79"/>
<polygon fill="black" stroke="black" points="7106.14,-8837.29 7096,-8840.38 7105.85,-8844.29 7106.14,-8837.29"/>
</g>
<!-- residual2_8 -->
<g id="node166" class="node">
<title>residual2_8</title>
<polygon fill="lightpink" stroke="black" points="6344.11,-8758.43 6252.11,-8758.43 6252.11,-8717.43 6344.11,-8717.43 6344.11,-8758.43"/>
<text text-anchor="middle" x="6298.11" y="-8746.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6298.11" y="-8735.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6298.11" y="-8724.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;residual2_8 -->
<g id="edge332" class="edge">
<title>ln1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M6927.9,-9143.32C6773.64,-9137.37 6286.11,-9113.41 6286.11,-9048.43 6286.11,-9048.43 6286.11,-9048.43 6286.11,-8835.43 6286.11,-8812.78 6289.4,-8787.37 6292.54,-8768.31"/>
<polygon fill="black" stroke="black" points="6295.99,-8768.88 6294.24,-8758.43 6289.09,-8767.69 6295.99,-8768.88"/>
</g>
<!-- gate_8&#45;&gt;expert_8_0 -->
<g id="edge307" class="edge">
<title>gate_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7033.69,-9038.04C7135.71,-9023.43 7350.56,-8991.58 7542.58,-8955.47"/>
<polygon fill="black" stroke="black" points="7543.4,-8958.88 7552.58,-8953.59 7542.1,-8952 7543.4,-8958.88"/>
<text text-anchor="middle" x="7466.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_8&#45;&gt;expert_8_1 -->
<g id="edge310" class="edge">
<title>gate_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6923.93,-9032.9C6880.55,-9021.19 6816.17,-9003.77 6760.11,-8988.43 6724.06,-8978.56 6684.18,-8967.56 6650.31,-8958.18"/>
<polygon fill="black" stroke="black" points="6651.04,-8954.75 6640.47,-8955.46 6649.17,-8961.5 6651.04,-8954.75"/>
<text text-anchor="middle" x="6791.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_8&#45;&gt;expert_8_2 -->
<g id="edge313" class="edge">
<title>gate_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6934.83,-9027.3C6896.49,-9008.64 6838.02,-8980.18 6796.54,-8959.99"/>
<polygon fill="black" stroke="black" points="6797.96,-8956.79 6787.43,-8955.56 6794.89,-8963.08 6797.96,-8956.79"/>
<text text-anchor="middle" x="6885.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_8&#45;&gt;expert_8_3 -->
<g id="edge316" class="edge">
<title>gate_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6916.56,-9036.96C6850.09,-9025.9 6737.53,-9006.76 6641.11,-8988.43 6572.84,-8975.44 6553.73,-8971 6482.62,-8955.74"/>
<polygon fill="black" stroke="black" points="6483.23,-8952.3 6472.72,-8953.62 6481.77,-8959.14 6483.23,-8952.3"/>
<text text-anchor="middle" x="6672.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_8&#45;&gt;expert_8_4 -->
<g id="edge319" class="edge">
<title>gate_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6950.04,-9018.84C6943.23,-9009.7 6936.49,-8999.12 6932.11,-8988.43 6929.17,-8981.27 6927.31,-8973.17 6926.12,-8965.51"/>
<polygon fill="black" stroke="black" points="6929.58,-8964.96 6924.88,-8955.47 6922.63,-8965.82 6929.58,-8964.96"/>
<text text-anchor="middle" x="6963.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_8&#45;&gt;expert_8_5 -->
<g id="edge322" class="edge">
<title>gate_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7024.33,-9033.09C7068.52,-9021.35 7134.59,-9003.78 7192.11,-8988.43 7217,-8981.78 7222.89,-8978.71 7248.11,-8973.43 7297.09,-8963.16 7312.25,-8964.86 7365.55,-8955.44"/>
<polygon fill="black" stroke="black" points="7366.37,-8958.85 7375.58,-8953.62 7365.12,-8951.96 7366.37,-8958.85"/>
<text text-anchor="middle" x="7279.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_8&#45;&gt;expert_8_6 -->
<g id="edge325" class="edge">
<title>gate_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6988.26,-9013.94C6995.57,-9000.06 7005.61,-8984.53 7018.11,-8973.43 7023.55,-8968.59 7029.73,-8964.28 7036.19,-8960.46"/>
<polygon fill="black" stroke="black" points="7038.05,-8963.43 7045.14,-8955.56 7034.69,-8957.29 7038.05,-8963.43"/>
<text text-anchor="middle" x="7049.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_8&#45;&gt;expert_8_7 -->
<g id="edge328" class="edge">
<title>gate_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7011.77,-9026.16C7042.63,-9010.18 7087.79,-8988.2 7129.11,-8973.43 7140.86,-8969.22 7163.93,-8963.08 7188.47,-8956.98"/>
<polygon fill="black" stroke="black" points="7189.43,-8960.35 7198.3,-8954.56 7187.75,-8953.56 7189.43,-8960.35"/>
<text text-anchor="middle" x="7160.61" y="-8977.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_8_0&#45;&gt;expert_agg_8 -->
<g id="edge309" class="edge">
<title>expert_8_0&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7552.59,-8916.21C7549.39,-8915.59 7546.22,-8914.99 7543.11,-8914.43 7392.84,-8887.11 7217.24,-8863.2 7110.39,-8849.53"/>
<polygon fill="black" stroke="black" points="7110.63,-8846.04 7100.27,-8848.24 7109.75,-8852.98 7110.63,-8846.04"/>
</g>
<!-- expert_8_1&#45;&gt;expert_agg_8 -->
<g id="edge312" class="edge">
<title>expert_8_1&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M6649.73,-8916.27C6652.56,-8915.65 6655.36,-8915.03 6658.11,-8914.43 6750.81,-8894.07 6857.23,-8870.96 6928.98,-8855.41"/>
<polygon fill="black" stroke="black" points="6929.84,-8858.81 6938.87,-8853.27 6928.35,-8851.97 6929.84,-8858.81"/>
</g>
<!-- expert_8_2&#45;&gt;expert_agg_8 -->
<g id="edge315" class="edge">
<title>expert_8_2&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M6800.73,-8914.4C6838.98,-8900.47 6891.01,-8881.53 6933.87,-8865.92"/>
<polygon fill="black" stroke="black" points="6935.23,-8869.14 6943.43,-8862.43 6932.84,-8862.57 6935.23,-8869.14"/>
</g>
<!-- expert_8_3&#45;&gt;expert_agg_8 -->
<g id="edge318" class="edge">
<title>expert_8_3&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M6472.68,-8916.02C6475.52,-8915.47 6478.34,-8914.93 6481.11,-8914.43 6636.89,-8885.91 6819.96,-8861.31 6925.36,-8848"/>
<polygon fill="black" stroke="black" points="6925.83,-8851.47 6935.31,-8846.75 6924.96,-8844.52 6925.83,-8851.47"/>
</g>
<!-- expert_8_4&#45;&gt;expert_agg_8 -->
<g id="edge321" class="edge">
<title>expert_8_4&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M6941.92,-8914.4C6949.68,-8905.89 6959.14,-8895.51 6968.58,-8885.16"/>
<polygon fill="black" stroke="black" points="6971.27,-8887.4 6975.42,-8877.65 6966.1,-8882.68 6971.27,-8887.4"/>
</g>
<!-- expert_8_5&#45;&gt;expert_agg_8 -->
<g id="edge324" class="edge">
<title>expert_8_5&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7375.53,-8916.49C7372.35,-8915.79 7369.2,-8915.1 7366.11,-8914.43 7281.45,-8895.95 7185.39,-8875.05 7114.71,-8859.7"/>
<polygon fill="black" stroke="black" points="7115.43,-8856.27 7104.91,-8857.57 7113.94,-8863.12 7115.43,-8856.27"/>
</g>
<!-- expert_8_6&#45;&gt;expert_agg_8 -->
<g id="edge327" class="edge">
<title>expert_8_6&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7083.1,-8914.4C7075.25,-8905.89 7065.67,-8895.51 7056.13,-8885.16"/>
<polygon fill="black" stroke="black" points="7058.56,-8882.63 7049.21,-8877.65 7053.41,-8887.38 7058.56,-8882.63"/>
</g>
<!-- expert_8_7&#45;&gt;expert_agg_8 -->
<g id="edge330" class="edge">
<title>expert_8_7&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M7224.28,-8914.4C7195.14,-8903.83 7158.03,-8890.36 7123.02,-8877.66"/>
<polygon fill="black" stroke="black" points="7123.8,-8874.22 7113.2,-8874.1 7121.41,-8880.8 7123.8,-8874.22"/>
</g>
<!-- expert_agg_8&#45;&gt;residual2_8 -->
<g id="edge331" class="edge">
<title>expert_agg_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M6923.48,-8823.45C6774.55,-8803.32 6478.23,-8763.27 6354.47,-8746.54"/>
<polygon fill="black" stroke="black" points="6354.83,-8743.06 6344.45,-8745.19 6353.89,-8750 6354.83,-8743.06"/>
</g>
<!-- ln2_8 -->
<g id="node167" class="node">
<title>ln2_8</title>
<polygon fill="lightpink" stroke="black" points="6344.11,-8680.43 6252.11,-8680.43 6252.11,-8639.43 6344.11,-8639.43 6344.11,-8680.43"/>
<text text-anchor="middle" x="6298.11" y="-8668.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6298.11" y="-8657.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6298.11" y="-8646.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- residual2_8&#45;&gt;ln2_8 -->
<g id="edge333" class="edge">
<title>residual2_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M6298.11,-8717.35C6298.11,-8709.2 6298.11,-8699.55 6298.11,-8690.56"/>
<polygon fill="black" stroke="black" points="6301.61,-8690.43 6298.11,-8680.43 6294.61,-8690.43 6301.61,-8690.43"/>
</g>
<!-- split_8 -->
<g id="node168" class="node">
<title>split_8</title>
<polygon fill="lightyellow" stroke="black" points="6442.17,-8602.43 6340.26,-8602.43 6314.05,-8542.43 6415.95,-8542.43 6442.17,-8602.43"/>
<text text-anchor="middle" x="6378.11" y="-8575.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="6378.11" y="-8564.43" font-family="Arial" font-size="10.00">GPU 7→8</text>
</g>
<!-- ln2_8&#45;&gt;split_8 -->
<g id="edge334" class="edge">
<title>ln2_8&#45;&gt;split_8</title>
<path fill="none" stroke="black" d="M6316.66,-8639.1C6324.75,-8630.45 6334.51,-8620.02 6343.84,-8610.05"/>
<polygon fill="black" stroke="black" points="6346.58,-8612.25 6350.86,-8602.55 6341.47,-8607.46 6346.58,-8612.25"/>
</g>
<!-- agg_9 -->
<g id="node169" class="node">
<title>agg_9</title>
<polygon fill="lightyellow" stroke="black" points="6362.17,-8505.43 6260.26,-8505.43 6234.05,-8445.43 6335.95,-8445.43 6362.17,-8505.43"/>
<text text-anchor="middle" x="6298.11" y="-8478.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="6298.11" y="-8467.43" font-family="Arial" font-size="10.00">GPU 7→8</text>
</g>
<!-- ln2_8&#45;&gt;agg_9 -->
<g id="edge340" class="edge">
<title>ln2_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M6298.11,-8639.4C6298.11,-8610.06 6298.11,-8554.02 6298.11,-8515.93"/>
<polygon fill="black" stroke="black" points="6301.61,-8515.7 6298.11,-8505.7 6294.61,-8515.7 6301.61,-8515.7"/>
</g>
<!-- split_8&#45;&gt;agg_9 -->
<g id="edge335" class="edge">
<title>split_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M6353.67,-8542.41C6345.99,-8533.28 6337.4,-8523.08 6329.31,-8513.48"/>
<polygon fill="black" stroke="black" points="6331.79,-8510.99 6322.67,-8505.6 6326.44,-8515.5 6331.79,-8510.99"/>
</g>
<!-- mha_q_9 -->
<g id="node170" class="node">
<title>mha_q_9</title>
<polygon fill="lightgreen" stroke="black" points="6421.11,-8408.43 6329.11,-8408.43 6329.11,-8367.43 6421.11,-8367.43 6421.11,-8408.43"/>
<text text-anchor="middle" x="6375.11" y="-8396.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="6375.11" y="-8385.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6375.11" y="-8374.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_q_9 -->
<g id="edge341" class="edge">
<title>agg_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M6324.61,-8445C6333.1,-8435.57 6342.47,-8425.17 6350.8,-8415.92"/>
<polygon fill="black" stroke="black" points="6353.42,-8418.24 6357.51,-8408.46 6348.22,-8413.55 6353.42,-8418.24"/>
</g>
<!-- mha_k_9 -->
<g id="node171" class="node">
<title>mha_k_9</title>
<polygon fill="lightgreen" stroke="black" points="6531.11,-8408.43 6439.11,-8408.43 6439.11,-8367.43 6531.11,-8367.43 6531.11,-8408.43"/>
<text text-anchor="middle" x="6485.11" y="-8396.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="6485.11" y="-8385.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6485.11" y="-8374.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_k_9 -->
<g id="edge342" class="edge">
<title>agg_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M6340.54,-8455.03C6367.96,-8442.49 6403.83,-8426.09 6432.99,-8412.76"/>
<polygon fill="black" stroke="black" points="6434.56,-8415.89 6442.2,-8408.55 6431.65,-8409.52 6434.56,-8415.89"/>
</g>
<!-- mha_v_9 -->
<g id="node172" class="node">
<title>mha_v_9</title>
<polygon fill="lightgreen" stroke="black" points="6311.11,-8408.43 6219.11,-8408.43 6219.11,-8367.43 6311.11,-8367.43 6311.11,-8408.43"/>
<text text-anchor="middle" x="6265.11" y="-8396.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="6265.11" y="-8385.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6265.11" y="-8374.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_v_9 -->
<g id="edge343" class="edge">
<title>agg_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M6286.75,-8445C6283.36,-8436.23 6279.66,-8426.62 6276.28,-8417.88"/>
<polygon fill="black" stroke="black" points="6279.51,-8416.53 6272.65,-8408.46 6272.98,-8419.05 6279.51,-8416.53"/>
</g>
<!-- residual1_9 -->
<g id="node175" class="node">
<title>residual1_9</title>
<polygon fill="lightpink" stroke="black" points="6249.11,-8174.43 6157.11,-8174.43 6157.11,-8133.43 6249.11,-8133.43 6249.11,-8174.43"/>
<text text-anchor="middle" x="6203.11" y="-8162.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="6203.11" y="-8151.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6203.11" y="-8140.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;residual1_9 -->
<g id="edge344" class="edge">
<title>agg_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M6235.87,-8449.71C6212.33,-8435.95 6191.11,-8416.03 6191.11,-8388.93 6191.11,-8388.93 6191.11,-8388.93 6191.11,-8230.93 6191.11,-8215.49 6193.55,-8198.51 6196.23,-8184.52"/>
<polygon fill="black" stroke="black" points="6199.71,-8184.98 6198.3,-8174.48 6192.86,-8183.57 6199.71,-8184.98"/>
</g>
<!-- mha_attn_9 -->
<g id="node173" class="node">
<title>mha_attn_9</title>
<polygon fill="lightgreen" stroke="black" points="6378.11,-8330.43 6274.11,-8330.43 6274.11,-8289.43 6378.11,-8289.43 6378.11,-8330.43"/>
<text text-anchor="middle" x="6326.11" y="-8318.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="6326.11" y="-8307.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="6326.11" y="-8296.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge336" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M6362.49,-8367.35C6356.94,-8358.76 6350.33,-8348.5 6344.27,-8339.1"/>
<polygon fill="black" stroke="black" points="6347.04,-8336.94 6338.68,-8330.43 6341.16,-8340.73 6347.04,-8336.94"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge337" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M6444.16,-8367.35C6423.39,-8357.43 6397.98,-8345.28 6376.07,-8334.81"/>
<polygon fill="black" stroke="black" points="6377.45,-8331.59 6366.92,-8330.43 6374.43,-8337.9 6377.45,-8331.59"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge338" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M6280.82,-8367.35C6287.86,-8358.58 6296.29,-8348.07 6303.96,-8338.52"/>
<polygon fill="black" stroke="black" points="6306.92,-8340.42 6310.45,-8330.43 6301.46,-8336.04 6306.92,-8340.42"/>
</g>
<!-- mha_out_9 -->
<g id="node174" class="node">
<title>mha_out_9</title>
<polygon fill="lightgreen" stroke="black" points="6323.11,-8252.43 6231.11,-8252.43 6231.11,-8211.43 6323.11,-8211.43 6323.11,-8252.43"/>
<text text-anchor="middle" x="6277.11" y="-8240.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="6277.11" y="-8229.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6277.11" y="-8218.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge339" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M6313.49,-8289.35C6307.94,-8280.76 6301.33,-8270.5 6295.27,-8261.1"/>
<polygon fill="black" stroke="black" points="6298.04,-8258.94 6289.68,-8252.43 6292.16,-8262.73 6298.04,-8258.94"/>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge345" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M6258.05,-8211.35C6249.25,-8202.31 6238.65,-8191.43 6229.13,-8181.65"/>
<polygon fill="black" stroke="black" points="6231.58,-8179.16 6222.1,-8174.43 6226.57,-8184.04 6231.58,-8179.16"/>
</g>
<!-- ln1_9 -->
<g id="node176" class="node">
<title>ln1_9</title>
<polygon fill="lightpink" stroke="black" points="6249.11,-8096.43 6157.11,-8096.43 6157.11,-8055.43 6249.11,-8055.43 6249.11,-8096.43"/>
<text text-anchor="middle" x="6203.11" y="-8084.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="6203.11" y="-8073.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6203.11" y="-8062.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- residual1_9&#45;&gt;ln1_9 -->
<g id="edge346" class="edge">
<title>residual1_9&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M6203.11,-8133.35C6203.11,-8125.2 6203.11,-8115.55 6203.11,-8106.56"/>
<polygon fill="black" stroke="black" points="6206.61,-8106.43 6203.11,-8096.43 6199.61,-8106.43 6206.61,-8106.43"/>
</g>
<!-- gate_9 -->
<g id="node177" class="node">
<title>gate_9</title>
<polygon fill="gold" stroke="black" points="6203.11,-8018.43 6126.11,-7977.43 6203.11,-7936.43 6280.11,-7977.43 6203.11,-8018.43"/>
<text text-anchor="middle" x="6203.11" y="-7985.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="6203.11" y="-7974.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="6203.11" y="-7963.93" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;gate_9 -->
<g id="edge347" class="edge">
<title>ln1_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M6203.11,-8055.4C6203.11,-8047.63 6203.11,-8038.31 6203.11,-8028.87"/>
<polygon fill="black" stroke="black" points="6206.61,-8028.65 6203.11,-8018.65 6199.61,-8028.65 6206.61,-8028.65"/>
</g>
<!-- expert_9_0 -->
<g id="node178" class="node">
<title>expert_9_0</title>
<polygon fill="lightcoral" stroke="black" points="6940.61,-7885.43 6781.61,-7885.43 6781.61,-7844.43 6940.61,-7844.43 6940.61,-7885.43"/>
<text text-anchor="middle" x="6861.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="6861.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6861.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_0 -->
<g id="edge350" class="edge">
<title>ln1_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" d="M6249.38,-8072.87C6320.75,-8068.6 6461.23,-8055.8 6574.11,-8018.43 6669.5,-7986.84 6771.06,-7925.4 6824.04,-7890.93"/>
<polygon fill="black" stroke="black" points="6825.99,-7893.84 6832.43,-7885.43 6822.15,-7887.99 6825.99,-7893.84"/>
</g>
<!-- expert_9_1 -->
<g id="node179" class="node">
<title>expert_9_1</title>
<polygon fill="lightcoral" stroke="black" points="5878.61,-7885.43 5719.61,-7885.43 5719.61,-7844.43 5878.61,-7844.43 5878.61,-7885.43"/>
<text text-anchor="middle" x="5799.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="5799.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5799.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_1 -->
<g id="edge353" class="edge">
<title>ln1_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" d="M6156.76,-8070.87C6104.41,-8064.89 6017.73,-8050.7 5950.11,-8018.43 5885.59,-7987.63 5868.63,-7974.37 5824.11,-7918.43 5818.51,-7911.39 5813.77,-7902.88 5809.99,-7894.79"/>
<polygon fill="black" stroke="black" points="5813.18,-7893.36 5805.98,-7885.59 5806.76,-7896.16 5813.18,-7893.36"/>
</g>
<!-- expert_9_2 -->
<g id="node180" class="node">
<title>expert_9_2</title>
<polygon fill="lightcoral" stroke="black" points="6055.61,-7885.43 5896.61,-7885.43 5896.61,-7844.43 6055.61,-7844.43 6055.61,-7885.43"/>
<text text-anchor="middle" x="5976.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="5976.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5976.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_2 -->
<g id="edge356" class="edge">
<title>ln1_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" d="M6157.1,-8061.78C6127.34,-8052.17 6088.45,-8037.51 6057.11,-8018.43 5999.82,-7983.55 5971.65,-7979.57 5944.11,-7918.43 5940.45,-7910.31 5942.57,-7901.91 5947.09,-7894.28"/>
<polygon fill="black" stroke="black" points="5950.26,-7895.88 5953.3,-7885.73 5944.59,-7891.76 5950.26,-7895.88"/>
</g>
<!-- expert_9_3 -->
<g id="node181" class="node">
<title>expert_9_3</title>
<polygon fill="lightcoral" stroke="black" points="5701.61,-7885.43 5542.61,-7885.43 5542.61,-7844.43 5701.61,-7844.43 5701.61,-7885.43"/>
<text text-anchor="middle" x="5622.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="5622.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5622.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_3 -->
<g id="edge359" class="edge">
<title>ln1_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" d="M6156.97,-8074.59C6085.59,-8072.6 5945.25,-8062.78 5836.11,-8018.43 5761.93,-7988.28 5688.87,-7927.79 5650.27,-7892.73"/>
<polygon fill="black" stroke="black" points="5652.3,-7889.84 5642.56,-7885.66 5647.56,-7895 5652.3,-7889.84"/>
</g>
<!-- expert_9_4 -->
<g id="node182" class="node">
<title>expert_9_4</title>
<polygon fill="lightcoral" stroke="black" points="6232.61,-7885.43 6073.61,-7885.43 6073.61,-7844.43 6232.61,-7844.43 6232.61,-7885.43"/>
<text text-anchor="middle" x="6153.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="6153.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6153.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_4 -->
<g id="edge362" class="edge">
<title>ln1_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" d="M6165.77,-8055.27C6149.6,-8045.59 6131.19,-8032.89 6117.11,-8018.43 6080.62,-7980.97 6069.43,-7968.72 6055.11,-7918.43 6051.71,-7906.51 6056.18,-7897.27 6064.79,-7890.11"/>
<polygon fill="black" stroke="black" points="6067,-7892.84 6073.32,-7884.34 6063.08,-7887.04 6067,-7892.84"/>
</g>
<!-- expert_9_5 -->
<g id="node183" class="node">
<title>expert_9_5</title>
<polygon fill="lightcoral" stroke="black" points="6763.61,-7885.43 6604.61,-7885.43 6604.61,-7844.43 6763.61,-7844.43 6763.61,-7885.43"/>
<text text-anchor="middle" x="6684.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="6684.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6684.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_5 -->
<g id="edge365" class="edge">
<title>ln1_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" d="M6249.13,-8071.23C6338.62,-8061.69 6537.61,-8028.65 6655.11,-7918.43 6662.12,-7911.85 6667.84,-7903.2 6672.29,-7894.81"/>
<polygon fill="black" stroke="black" points="6675.55,-7896.12 6676.78,-7885.59 6669.26,-7893.05 6675.55,-7896.12"/>
</g>
<!-- expert_9_6 -->
<g id="node184" class="node">
<title>expert_9_6</title>
<polygon fill="lightcoral" stroke="black" points="6409.61,-7885.43 6250.61,-7885.43 6250.61,-7844.43 6409.61,-7844.43 6409.61,-7885.43"/>
<text text-anchor="middle" x="6330.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="6330.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6330.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_6 -->
<g id="edge368" class="edge">
<title>ln1_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" d="M6246.47,-8055.29C6294.03,-8030.97 6367.42,-7984.51 6396.11,-7918.43 6400.66,-7907.94 6396.29,-7898.96 6388.02,-7891.55"/>
<polygon fill="black" stroke="black" points="6389.97,-7888.64 6379.87,-7885.44 6385.77,-7894.24 6389.97,-7888.64"/>
</g>
<!-- expert_9_7 -->
<g id="node185" class="node">
<title>expert_9_7</title>
<polygon fill="lightcoral" stroke="black" points="6586.61,-7885.43 6427.61,-7885.43 6427.61,-7844.43 6586.61,-7844.43 6586.61,-7885.43"/>
<text text-anchor="middle" x="6507.11" y="-7873.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="6507.11" y="-7862.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6507.11" y="-7851.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_9_7 -->
<g id="edge371" class="edge">
<title>ln1_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" d="M6249.32,-8062.03C6281.78,-8052.13 6325.72,-8037.03 6362.11,-8018.43 6431.81,-7982.79 6470.71,-7987.74 6507.11,-7918.43 6510.69,-7911.6 6511.91,-7903.56 6511.93,-7895.84"/>
<polygon fill="black" stroke="black" points="6515.41,-7895.45 6511.33,-7885.68 6508.42,-7895.87 6515.41,-7895.45"/>
</g>
<!-- expert_agg_9 -->
<g id="node186" class="node">
<title>expert_agg_9</title>
<polygon fill="lightyellow" stroke="black" points="6325.88,-7807.43 6162.39,-7807.43 6120.33,-7725.43 6283.83,-7725.43 6325.88,-7807.43"/>
<text text-anchor="middle" x="6223.11" y="-7774.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="6223.11" y="-7763.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="6223.11" y="-7752.93" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;expert_agg_9 -->
<g id="edge348" class="edge">
<title>ln1_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6249.42,-8075.65C6440.77,-8077.2 7150.48,-8068.28 6949.11,-7844.43 6907.57,-7798.25 6503.99,-7777.64 6317.16,-7770.52"/>
<polygon fill="black" stroke="black" points="6317.19,-7767.02 6307.07,-7770.14 6316.93,-7774.02 6317.19,-7767.02"/>
</g>
<!-- residual2_9 -->
<g id="node187" class="node">
<title>residual2_9</title>
<polygon fill="lightpink" stroke="black" points="5573.11,-7688.43 5481.11,-7688.43 5481.11,-7647.43 5573.11,-7647.43 5573.11,-7688.43"/>
<text text-anchor="middle" x="5527.11" y="-7676.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5527.11" y="-7665.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5527.11" y="-7654.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;residual2_9 -->
<g id="edge374" class="edge">
<title>ln1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M6156.9,-8073.32C6002.64,-8067.37 5515.11,-8043.41 5515.11,-7978.43 5515.11,-7978.43 5515.11,-7978.43 5515.11,-7765.43 5515.11,-7742.78 5518.4,-7717.37 5521.54,-7698.31"/>
<polygon fill="black" stroke="black" points="5524.99,-7698.88 5523.24,-7688.43 5518.09,-7697.69 5524.99,-7698.88"/>
</g>
<!-- gate_9&#45;&gt;expert_9_0 -->
<g id="edge349" class="edge">
<title>gate_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6262.69,-7968.04C6364.71,-7953.43 6579.56,-7921.58 6771.58,-7885.47"/>
<polygon fill="black" stroke="black" points="6772.4,-7888.88 6781.58,-7883.59 6771.1,-7882 6772.4,-7888.88"/>
<text text-anchor="middle" x="6695.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_9&#45;&gt;expert_9_1 -->
<g id="edge352" class="edge">
<title>gate_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6152.93,-7962.9C6109.55,-7951.19 6045.17,-7933.77 5989.11,-7918.43 5953.06,-7908.56 5913.18,-7897.56 5879.31,-7888.18"/>
<polygon fill="black" stroke="black" points="5880.04,-7884.75 5869.47,-7885.46 5878.17,-7891.5 5880.04,-7884.75"/>
<text text-anchor="middle" x="6020.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_9&#45;&gt;expert_9_2 -->
<g id="edge355" class="edge">
<title>gate_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6163.83,-7957.3C6125.49,-7938.64 6067.02,-7910.18 6025.54,-7889.99"/>
<polygon fill="black" stroke="black" points="6026.96,-7886.79 6016.43,-7885.56 6023.89,-7893.08 6026.96,-7886.79"/>
<text text-anchor="middle" x="6114.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_9&#45;&gt;expert_9_3 -->
<g id="edge358" class="edge">
<title>gate_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6145.56,-7966.96C6079.09,-7955.9 5966.53,-7936.76 5870.11,-7918.43 5801.84,-7905.44 5782.73,-7901 5711.62,-7885.74"/>
<polygon fill="black" stroke="black" points="5712.23,-7882.3 5701.72,-7883.62 5710.77,-7889.14 5712.23,-7882.3"/>
<text text-anchor="middle" x="5901.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_9&#45;&gt;expert_9_4 -->
<g id="edge361" class="edge">
<title>gate_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6179.04,-7948.84C6172.23,-7939.7 6165.49,-7929.12 6161.11,-7918.43 6158.17,-7911.27 6156.31,-7903.17 6155.12,-7895.51"/>
<polygon fill="black" stroke="black" points="6158.58,-7894.96 6153.88,-7885.47 6151.63,-7895.82 6158.58,-7894.96"/>
<text text-anchor="middle" x="6192.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_9&#45;&gt;expert_9_5 -->
<g id="edge364" class="edge">
<title>gate_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6253.27,-7963.05C6311.8,-7947.67 6411.6,-7922.14 6498.11,-7903.43 6538.12,-7894.77 6550.51,-7894.17 6594.64,-7885.47"/>
<polygon fill="black" stroke="black" points="6595.44,-7888.88 6604.56,-7883.49 6594.07,-7882.02 6595.44,-7888.88"/>
<text text-anchor="middle" x="6529.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_9&#45;&gt;expert_9_6 -->
<g id="edge367" class="edge">
<title>gate_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6217.26,-7943.94C6224.57,-7930.06 6234.61,-7914.53 6247.11,-7903.43 6252.55,-7898.59 6258.73,-7894.28 6265.19,-7890.46"/>
<polygon fill="black" stroke="black" points="6267.05,-7893.43 6274.14,-7885.56 6263.69,-7887.29 6267.05,-7893.43"/>
<text text-anchor="middle" x="6278.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_9&#45;&gt;expert_9_7 -->
<g id="edge370" class="edge">
<title>gate_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6240.77,-7956.16C6271.63,-7940.18 6316.79,-7918.2 6358.11,-7903.43 6369.86,-7899.22 6392.93,-7893.08 6417.47,-7886.98"/>
<polygon fill="black" stroke="black" points="6418.43,-7890.35 6427.3,-7884.56 6416.75,-7883.56 6418.43,-7890.35"/>
<text text-anchor="middle" x="6389.61" y="-7907.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_9_0&#45;&gt;expert_agg_9 -->
<g id="edge351" class="edge">
<title>expert_9_0&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6781.59,-7846.19C6778.39,-7845.58 6775.22,-7844.99 6772.11,-7844.43 6615.02,-7816.24 6431.09,-7792.26 6321,-7778.87"/>
<polygon fill="black" stroke="black" points="6321.26,-7775.37 6310.91,-7777.64 6320.42,-7782.32 6321.26,-7775.37"/>
</g>
<!-- expert_9_1&#45;&gt;expert_agg_9 -->
<g id="edge354" class="edge">
<title>expert_9_1&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M5878.86,-7845.78C5953.47,-7828.79 6064.48,-7803.53 6140.12,-7786.31"/>
<polygon fill="black" stroke="black" points="6141.11,-7789.68 6150.09,-7784.05 6139.56,-7782.85 6141.11,-7789.68"/>
</g>
<!-- expert_9_2&#45;&gt;expert_agg_9 -->
<g id="edge357" class="edge">
<title>expert_9_2&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6026.09,-7844.4C6060.4,-7830.99 6106.61,-7812.94 6145.65,-7797.69"/>
<polygon fill="black" stroke="black" points="6147.37,-7800.77 6155.41,-7793.88 6144.82,-7794.25 6147.37,-7800.77"/>
</g>
<!-- expert_9_3&#45;&gt;expert_agg_9 -->
<g id="edge360" class="edge">
<title>expert_9_3&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M5701.68,-7846.03C5704.52,-7845.48 5707.34,-7844.94 5710.11,-7844.43 5859.43,-7816.71 6034.63,-7792.1 6136.82,-7778.53"/>
<polygon fill="black" stroke="black" points="6137.33,-7781.99 6146.78,-7777.21 6136.41,-7775.05 6137.33,-7781.99"/>
</g>
<!-- expert_9_4&#45;&gt;expert_agg_9 -->
<g id="edge363" class="edge">
<title>expert_9_4&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6167.27,-7844.4C6173.33,-7836.05 6180.68,-7825.91 6188.05,-7815.76"/>
<polygon fill="black" stroke="black" points="6190.89,-7817.8 6193.93,-7807.65 6185.22,-7813.69 6190.89,-7817.8"/>
</g>
<!-- expert_9_5&#45;&gt;expert_agg_9 -->
<g id="edge366" class="edge">
<title>expert_9_5&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6604.54,-7846.45C6601.36,-7845.76 6598.2,-7845.09 6595.11,-7844.43 6503.9,-7825 6399.95,-7803.54 6325.17,-7788.22"/>
<polygon fill="black" stroke="black" points="6325.78,-7784.77 6315.28,-7786.2 6324.37,-7791.63 6325.78,-7784.77"/>
</g>
<!-- expert_9_6&#45;&gt;expert_agg_9 -->
<g id="edge369" class="edge">
<title>expert_9_6&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6308.45,-7844.4C6298.84,-7835.72 6287.06,-7825.1 6275.36,-7814.55"/>
<polygon fill="black" stroke="black" points="6277.48,-7811.75 6267.71,-7807.65 6272.79,-7816.95 6277.48,-7811.75"/>
</g>
<!-- expert_9_7&#45;&gt;expert_agg_9 -->
<g id="edge372" class="edge">
<title>expert_9_7&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M6449.64,-7844.4C6415.95,-7832.95 6372.28,-7818.11 6332.29,-7804.53"/>
<polygon fill="black" stroke="black" points="6333.35,-7801.19 6322.75,-7801.28 6331.09,-7807.82 6333.35,-7801.19"/>
</g>
<!-- expert_agg_9&#45;&gt;residual2_9 -->
<g id="edge373" class="edge">
<title>expert_agg_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M6134.25,-7753.11C5988.79,-7732.94 5703.96,-7693.45 5583.28,-7676.71"/>
<polygon fill="black" stroke="black" points="5583.54,-7673.22 5573.16,-7675.31 5582.58,-7680.15 5583.54,-7673.22"/>
</g>
<!-- ln2_9 -->
<g id="node188" class="node">
<title>ln2_9</title>
<polygon fill="lightpink" stroke="black" points="5573.11,-7610.43 5481.11,-7610.43 5481.11,-7569.43 5573.11,-7569.43 5573.11,-7610.43"/>
<text text-anchor="middle" x="5527.11" y="-7598.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5527.11" y="-7587.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5527.11" y="-7576.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- residual2_9&#45;&gt;ln2_9 -->
<g id="edge375" class="edge">
<title>residual2_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M5527.11,-7647.35C5527.11,-7639.2 5527.11,-7629.55 5527.11,-7620.56"/>
<polygon fill="black" stroke="black" points="5530.61,-7620.43 5527.11,-7610.43 5523.61,-7620.43 5530.61,-7620.43"/>
</g>
<!-- split_9 -->
<g id="node189" class="node">
<title>split_9</title>
<polygon fill="lightyellow" stroke="black" points="5671.17,-7532.43 5569.26,-7532.43 5543.05,-7472.43 5644.95,-7472.43 5671.17,-7532.43"/>
<text text-anchor="middle" x="5607.11" y="-7505.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="5607.11" y="-7494.43" font-family="Arial" font-size="10.00">GPU 8→9</text>
</g>
<!-- ln2_9&#45;&gt;split_9 -->
<g id="edge376" class="edge">
<title>ln2_9&#45;&gt;split_9</title>
<path fill="none" stroke="black" d="M5545.66,-7569.1C5553.75,-7560.45 5563.51,-7550.02 5572.84,-7540.05"/>
<polygon fill="black" stroke="black" points="5575.58,-7542.25 5579.86,-7532.55 5570.47,-7537.46 5575.58,-7542.25"/>
</g>
<!-- agg_10 -->
<g id="node190" class="node">
<title>agg_10</title>
<polygon fill="lightyellow" stroke="black" points="5591.17,-7435.43 5489.26,-7435.43 5463.05,-7375.43 5564.95,-7375.43 5591.17,-7435.43"/>
<text text-anchor="middle" x="5527.11" y="-7408.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="5527.11" y="-7397.43" font-family="Arial" font-size="10.00">GPU 8→9</text>
</g>
<!-- ln2_9&#45;&gt;agg_10 -->
<g id="edge382" class="edge">
<title>ln2_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M5527.11,-7569.4C5527.11,-7540.06 5527.11,-7484.02 5527.11,-7445.93"/>
<polygon fill="black" stroke="black" points="5530.61,-7445.7 5527.11,-7435.7 5523.61,-7445.7 5530.61,-7445.7"/>
</g>
<!-- split_9&#45;&gt;agg_10 -->
<g id="edge377" class="edge">
<title>split_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M5582.67,-7472.41C5574.99,-7463.28 5566.4,-7453.08 5558.31,-7443.48"/>
<polygon fill="black" stroke="black" points="5560.79,-7440.99 5551.67,-7435.6 5555.44,-7445.5 5560.79,-7440.99"/>
</g>
<!-- mha_q_10 -->
<g id="node191" class="node">
<title>mha_q_10</title>
<polygon fill="lightgreen" stroke="black" points="5650.11,-7338.43 5558.11,-7338.43 5558.11,-7297.43 5650.11,-7297.43 5650.11,-7338.43"/>
<text text-anchor="middle" x="5604.11" y="-7326.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="5604.11" y="-7315.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5604.11" y="-7304.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_q_10 -->
<g id="edge383" class="edge">
<title>agg_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M5553.61,-7375C5562.1,-7365.57 5571.47,-7355.17 5579.8,-7345.92"/>
<polygon fill="black" stroke="black" points="5582.42,-7348.24 5586.51,-7338.46 5577.22,-7343.55 5582.42,-7348.24"/>
</g>
<!-- mha_k_10 -->
<g id="node192" class="node">
<title>mha_k_10</title>
<polygon fill="lightgreen" stroke="black" points="5760.11,-7338.43 5668.11,-7338.43 5668.11,-7297.43 5760.11,-7297.43 5760.11,-7338.43"/>
<text text-anchor="middle" x="5714.11" y="-7326.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="5714.11" y="-7315.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5714.11" y="-7304.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_k_10 -->
<g id="edge384" class="edge">
<title>agg_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M5569.54,-7385.03C5596.96,-7372.49 5632.83,-7356.09 5661.99,-7342.76"/>
<polygon fill="black" stroke="black" points="5663.56,-7345.89 5671.2,-7338.55 5660.65,-7339.52 5663.56,-7345.89"/>
</g>
<!-- mha_v_10 -->
<g id="node193" class="node">
<title>mha_v_10</title>
<polygon fill="lightgreen" stroke="black" points="5540.11,-7338.43 5448.11,-7338.43 5448.11,-7297.43 5540.11,-7297.43 5540.11,-7338.43"/>
<text text-anchor="middle" x="5494.11" y="-7326.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="5494.11" y="-7315.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5494.11" y="-7304.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_v_10 -->
<g id="edge385" class="edge">
<title>agg_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M5515.75,-7375C5512.36,-7366.23 5508.66,-7356.62 5505.28,-7347.88"/>
<polygon fill="black" stroke="black" points="5508.51,-7346.53 5501.65,-7338.46 5501.98,-7349.05 5508.51,-7346.53"/>
</g>
<!-- residual1_10 -->
<g id="node196" class="node">
<title>residual1_10</title>
<polygon fill="lightpink" stroke="black" points="5478.11,-7104.43 5386.11,-7104.43 5386.11,-7063.43 5478.11,-7063.43 5478.11,-7104.43"/>
<text text-anchor="middle" x="5432.11" y="-7092.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="5432.11" y="-7081.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5432.11" y="-7070.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;residual1_10 -->
<g id="edge386" class="edge">
<title>agg_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M5464.87,-7379.71C5441.33,-7365.95 5420.11,-7346.03 5420.11,-7318.93 5420.11,-7318.93 5420.11,-7318.93 5420.11,-7160.93 5420.11,-7145.49 5422.55,-7128.51 5425.23,-7114.52"/>
<polygon fill="black" stroke="black" points="5428.71,-7114.98 5427.3,-7104.48 5421.86,-7113.57 5428.71,-7114.98"/>
</g>
<!-- mha_attn_10 -->
<g id="node194" class="node">
<title>mha_attn_10</title>
<polygon fill="lightgreen" stroke="black" points="5561.11,-7260.43 5457.11,-7260.43 5457.11,-7219.43 5561.11,-7219.43 5561.11,-7260.43"/>
<text text-anchor="middle" x="5509.11" y="-7248.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="5509.11" y="-7237.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="5509.11" y="-7226.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge378" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M5579.64,-7297.35C5568.01,-7288.05 5553.94,-7276.79 5541.44,-7266.79"/>
<polygon fill="black" stroke="black" points="5543.48,-7263.95 5533.49,-7260.43 5539.11,-7269.41 5543.48,-7263.95"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge379" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M5668.1,-7299.87C5639.43,-7289.24 5602.18,-7275.43 5570.95,-7263.85"/>
<polygon fill="black" stroke="black" points="5572.06,-7260.53 5561.46,-7260.34 5569.62,-7267.09 5572.06,-7260.53"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge380" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M5497.97,-7297.35C5499.6,-7289.11 5501.53,-7279.34 5503.32,-7270.26"/>
<polygon fill="black" stroke="black" points="5506.76,-7270.92 5505.26,-7260.43 5499.89,-7269.56 5506.76,-7270.92"/>
</g>
<!-- mha_out_10 -->
<g id="node195" class="node">
<title>mha_out_10</title>
<polygon fill="lightgreen" stroke="black" points="5543.11,-7182.43 5451.11,-7182.43 5451.11,-7141.43 5543.11,-7141.43 5543.11,-7182.43"/>
<text text-anchor="middle" x="5497.11" y="-7170.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="5497.11" y="-7159.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5497.11" y="-7148.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge381" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M5506.02,-7219.35C5504.73,-7211.2 5503.21,-7201.55 5501.79,-7192.56"/>
<polygon fill="black" stroke="black" points="5505.2,-7191.76 5500.19,-7182.43 5498.29,-7192.86 5505.2,-7191.76"/>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge387" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M5480.37,-7141.35C5472.79,-7132.49 5463.69,-7121.86 5455.46,-7112.23"/>
<polygon fill="black" stroke="black" points="5457.95,-7109.76 5448.79,-7104.43 5452.63,-7114.31 5457.95,-7109.76"/>
</g>
<!-- ln1_10 -->
<g id="node197" class="node">
<title>ln1_10</title>
<polygon fill="lightpink" stroke="black" points="5478.11,-7026.43 5386.11,-7026.43 5386.11,-6985.43 5478.11,-6985.43 5478.11,-7026.43"/>
<text text-anchor="middle" x="5432.11" y="-7014.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="5432.11" y="-7003.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5432.11" y="-6992.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- residual1_10&#45;&gt;ln1_10 -->
<g id="edge388" class="edge">
<title>residual1_10&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M5432.11,-7063.35C5432.11,-7055.2 5432.11,-7045.55 5432.11,-7036.56"/>
<polygon fill="black" stroke="black" points="5435.61,-7036.43 5432.11,-7026.43 5428.61,-7036.43 5435.61,-7036.43"/>
</g>
<!-- gate_10 -->
<g id="node198" class="node">
<title>gate_10</title>
<polygon fill="gold" stroke="black" points="5432.11,-6948.43 5355.11,-6907.43 5432.11,-6866.43 5509.11,-6907.43 5432.11,-6948.43"/>
<text text-anchor="middle" x="5432.11" y="-6915.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="5432.11" y="-6904.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="5432.11" y="-6893.93" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;gate_10 -->
<g id="edge389" class="edge">
<title>ln1_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M5432.11,-6985.4C5432.11,-6977.63 5432.11,-6968.31 5432.11,-6958.87"/>
<polygon fill="black" stroke="black" points="5435.61,-6958.65 5432.11,-6948.65 5428.61,-6958.65 5435.61,-6958.65"/>
</g>
<!-- expert_10_0 -->
<g id="node199" class="node">
<title>expert_10_0</title>
<polygon fill="lightcoral" stroke="black" points="6169.61,-6815.43 6010.61,-6815.43 6010.61,-6774.43 6169.61,-6774.43 6169.61,-6815.43"/>
<text text-anchor="middle" x="6090.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="6090.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="6090.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_0 -->
<g id="edge392" class="edge">
<title>ln1_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" d="M5478.16,-7001.71C5545.42,-6996.05 5673.86,-6981.62 5778.11,-6948.43 5880.35,-6915.87 5991.23,-6854.87 6049.32,-6820.72"/>
<polygon fill="black" stroke="black" points="6051.36,-6823.58 6058.18,-6815.47 6047.79,-6817.55 6051.36,-6823.58"/>
</g>
<!-- expert_10_1 -->
<g id="node200" class="node">
<title>expert_10_1</title>
<polygon fill="lightcoral" stroke="black" points="5107.61,-6815.43 4948.61,-6815.43 4948.61,-6774.43 5107.61,-6774.43 5107.61,-6815.43"/>
<text text-anchor="middle" x="5028.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="5028.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5028.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_1 -->
<g id="edge395" class="edge">
<title>ln1_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" d="M5385.93,-7000.5C5333.75,-6994.19 5247.21,-6979.69 5179.11,-6948.43 5111.57,-6917.42 5088.37,-6908.85 5045.11,-6848.43 5040.21,-6841.58 5036.67,-6833.25 5034.13,-6825.25"/>
<polygon fill="black" stroke="black" points="5037.46,-6824.16 5031.43,-6815.45 5030.71,-6826.02 5037.46,-6824.16"/>
</g>
<!-- expert_10_2 -->
<g id="node201" class="node">
<title>expert_10_2</title>
<polygon fill="lightcoral" stroke="black" points="5284.61,-6815.43 5125.61,-6815.43 5125.61,-6774.43 5284.61,-6774.43 5284.61,-6815.43"/>
<text text-anchor="middle" x="5205.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="5205.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5205.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_2 -->
<g id="edge398" class="edge">
<title>ln1_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" d="M5386.1,-6991.78C5356.34,-6982.17 5317.45,-6967.51 5286.11,-6948.43 5228.82,-6913.55 5200.65,-6909.57 5173.11,-6848.43 5169.45,-6840.31 5171.57,-6831.91 5176.09,-6824.28"/>
<polygon fill="black" stroke="black" points="5179.26,-6825.88 5182.3,-6815.73 5173.59,-6821.76 5179.26,-6825.88"/>
</g>
<!-- expert_10_3 -->
<g id="node202" class="node">
<title>expert_10_3</title>
<polygon fill="lightcoral" stroke="black" points="4930.61,-6815.43 4771.61,-6815.43 4771.61,-6774.43 4930.61,-6774.43 4930.61,-6815.43"/>
<text text-anchor="middle" x="4851.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4851.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4851.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_3 -->
<g id="edge401" class="edge">
<title>ln1_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" d="M5386.09,-7005.16C5313.08,-7004 5167.49,-6995.33 5055.11,-6948.43 4983.29,-6918.46 4913.81,-6857.63 4877.39,-6822.53"/>
<polygon fill="black" stroke="black" points="4879.74,-6819.92 4870.13,-6815.45 4874.85,-6824.93 4879.74,-6819.92"/>
</g>
<!-- expert_10_4 -->
<g id="node203" class="node">
<title>expert_10_4</title>
<polygon fill="lightcoral" stroke="black" points="5461.61,-6815.43 5302.61,-6815.43 5302.61,-6774.43 5461.61,-6774.43 5461.61,-6815.43"/>
<text text-anchor="middle" x="5382.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="5382.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5382.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_4 -->
<g id="edge404" class="edge">
<title>ln1_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" d="M5394.77,-6985.27C5378.6,-6975.59 5360.19,-6962.89 5346.11,-6948.43 5309.62,-6910.97 5298.43,-6898.72 5284.11,-6848.43 5280.71,-6836.51 5285.18,-6827.27 5293.79,-6820.11"/>
<polygon fill="black" stroke="black" points="5296,-6822.84 5302.32,-6814.34 5292.08,-6817.04 5296,-6822.84"/>
</g>
<!-- expert_10_5 -->
<g id="node204" class="node">
<title>expert_10_5</title>
<polygon fill="lightcoral" stroke="black" points="5992.61,-6815.43 5833.61,-6815.43 5833.61,-6774.43 5992.61,-6774.43 5992.61,-6815.43"/>
<text text-anchor="middle" x="5913.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="5913.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5913.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_5 -->
<g id="edge407" class="edge">
<title>ln1_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" d="M5478.2,-6998.61C5563.75,-6984.86 5749.33,-6945.32 5870.11,-6848.43 5878.88,-6841.39 5887.09,-6832.29 5893.94,-6823.66"/>
<polygon fill="black" stroke="black" points="5896.8,-6825.68 5900.06,-6815.61 5891.22,-6821.45 5896.8,-6825.68"/>
</g>
<!-- expert_10_6 -->
<g id="node205" class="node">
<title>expert_10_6</title>
<polygon fill="lightcoral" stroke="black" points="5638.61,-6815.43 5479.61,-6815.43 5479.61,-6774.43 5638.61,-6774.43 5638.61,-6815.43"/>
<text text-anchor="middle" x="5559.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="5559.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5559.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_6 -->
<g id="edge410" class="edge">
<title>ln1_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" d="M5475.47,-6985.29C5523.03,-6960.97 5596.42,-6914.51 5625.11,-6848.43 5629.66,-6837.94 5625.29,-6828.96 5617.02,-6821.55"/>
<polygon fill="black" stroke="black" points="5618.97,-6818.64 5608.87,-6815.44 5614.77,-6824.24 5618.97,-6818.64"/>
</g>
<!-- expert_10_7 -->
<g id="node206" class="node">
<title>expert_10_7</title>
<polygon fill="lightcoral" stroke="black" points="5815.61,-6815.43 5656.61,-6815.43 5656.61,-6774.43 5815.61,-6774.43 5815.61,-6815.43"/>
<text text-anchor="middle" x="5736.11" y="-6803.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="5736.11" y="-6792.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5736.11" y="-6781.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_10_7 -->
<g id="edge413" class="edge">
<title>ln1_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" d="M5478.32,-6992.03C5510.78,-6982.13 5554.72,-6967.03 5591.11,-6948.43 5660.81,-6912.79 5699.71,-6917.74 5736.11,-6848.43 5739.69,-6841.6 5740.91,-6833.56 5740.93,-6825.84"/>
<polygon fill="black" stroke="black" points="5744.41,-6825.45 5740.33,-6815.68 5737.42,-6825.87 5744.41,-6825.45"/>
</g>
<!-- expert_agg_10 -->
<g id="node207" class="node">
<title>expert_agg_10</title>
<polygon fill="lightyellow" stroke="black" points="5573.88,-6737.43 5410.39,-6737.43 5368.33,-6655.43 5531.83,-6655.43 5573.88,-6737.43"/>
<text text-anchor="middle" x="5471.11" y="-6704.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="5471.11" y="-6693.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="5471.11" y="-6682.93" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;expert_agg_10 -->
<g id="edge390" class="edge">
<title>ln1_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5478.4,-7005.66C5669.68,-7007.28 6379.16,-6998.57 6178.11,-6774.43 6137.9,-6729.61 5748.49,-6708.38 5565.38,-6700.82"/>
<polygon fill="black" stroke="black" points="5565.36,-6697.32 5555.22,-6700.4 5565.07,-6704.31 5565.36,-6697.32"/>
</g>
<!-- residual2_10 -->
<g id="node208" class="node">
<title>residual2_10</title>
<polygon fill="lightpink" stroke="black" points="4802.11,-6618.43 4710.11,-6618.43 4710.11,-6577.43 4802.11,-6577.43 4802.11,-6618.43"/>
<text text-anchor="middle" x="4756.11" y="-6606.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4756.11" y="-6595.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4756.11" y="-6584.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;residual2_10 -->
<g id="edge416" class="edge">
<title>ln1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M5385.9,-7003.32C5231.64,-6997.37 4744.11,-6973.41 4744.11,-6908.43 4744.11,-6908.43 4744.11,-6908.43 4744.11,-6695.43 4744.11,-6672.78 4747.4,-6647.37 4750.54,-6628.31"/>
<polygon fill="black" stroke="black" points="4753.99,-6628.88 4752.24,-6618.43 4747.09,-6627.69 4753.99,-6628.88"/>
</g>
<!-- gate_10&#45;&gt;expert_10_0 -->
<g id="edge391" class="edge">
<title>gate_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5491.69,-6898.04C5593.71,-6883.43 5808.56,-6851.58 6000.58,-6815.47"/>
<polygon fill="black" stroke="black" points="6001.4,-6818.88 6010.58,-6813.59 6000.1,-6812 6001.4,-6818.88"/>
<text text-anchor="middle" x="5924.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_10&#45;&gt;expert_10_1 -->
<g id="edge394" class="edge">
<title>gate_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5381.93,-6892.9C5338.55,-6881.19 5274.17,-6863.77 5218.11,-6848.43 5182.06,-6838.56 5142.18,-6827.56 5108.31,-6818.18"/>
<polygon fill="black" stroke="black" points="5109.04,-6814.75 5098.47,-6815.46 5107.17,-6821.5 5109.04,-6814.75"/>
<text text-anchor="middle" x="5249.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_10&#45;&gt;expert_10_2 -->
<g id="edge397" class="edge">
<title>gate_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5392.83,-6887.3C5354.49,-6868.64 5296.02,-6840.18 5254.54,-6819.99"/>
<polygon fill="black" stroke="black" points="5255.96,-6816.79 5245.43,-6815.56 5252.89,-6823.08 5255.96,-6816.79"/>
<text text-anchor="middle" x="5343.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_10&#45;&gt;expert_10_3 -->
<g id="edge400" class="edge">
<title>gate_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5374.56,-6896.96C5308.09,-6885.9 5195.53,-6866.76 5099.11,-6848.43 5030.84,-6835.44 5011.73,-6831 4940.62,-6815.74"/>
<polygon fill="black" stroke="black" points="4941.23,-6812.3 4930.72,-6813.62 4939.77,-6819.14 4941.23,-6812.3"/>
<text text-anchor="middle" x="5130.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_10&#45;&gt;expert_10_4 -->
<g id="edge403" class="edge">
<title>gate_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5408.04,-6878.84C5401.23,-6869.7 5394.49,-6859.12 5390.11,-6848.43 5387.17,-6841.27 5385.31,-6833.17 5384.12,-6825.51"/>
<polygon fill="black" stroke="black" points="5387.58,-6824.96 5382.88,-6815.47 5380.63,-6825.82 5387.58,-6824.96"/>
<text text-anchor="middle" x="5421.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_10&#45;&gt;expert_10_5 -->
<g id="edge406" class="edge">
<title>gate_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5482.33,-6893.09C5526.52,-6881.35 5592.59,-6863.78 5650.11,-6848.43 5675,-6841.78 5680.89,-6838.71 5706.11,-6833.43 5755.09,-6823.16 5770.25,-6824.86 5823.55,-6815.44"/>
<polygon fill="black" stroke="black" points="5824.37,-6818.85 5833.58,-6813.62 5823.12,-6811.96 5824.37,-6818.85"/>
<text text-anchor="middle" x="5737.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_10&#45;&gt;expert_10_6 -->
<g id="edge409" class="edge">
<title>gate_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5446.26,-6873.94C5453.57,-6860.06 5463.61,-6844.53 5476.11,-6833.43 5481.55,-6828.59 5487.73,-6824.28 5494.19,-6820.46"/>
<polygon fill="black" stroke="black" points="5496.05,-6823.43 5503.14,-6815.56 5492.69,-6817.29 5496.05,-6823.43"/>
<text text-anchor="middle" x="5507.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_10&#45;&gt;expert_10_7 -->
<g id="edge412" class="edge">
<title>gate_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5469.77,-6886.16C5500.63,-6870.18 5545.79,-6848.2 5587.11,-6833.43 5598.86,-6829.22 5621.93,-6823.08 5646.47,-6816.98"/>
<polygon fill="black" stroke="black" points="5647.43,-6820.35 5656.3,-6814.56 5645.75,-6813.56 5647.43,-6820.35"/>
<text text-anchor="middle" x="5618.61" y="-6837.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_10_0&#45;&gt;expert_agg_10 -->
<g id="edge393" class="edge">
<title>expert_10_0&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M6010.59,-6776.21C6007.39,-6775.59 6004.22,-6774.99 6001.11,-6774.43 5851.12,-6747.14 5675.85,-6723.22 5569.21,-6709.55"/>
<polygon fill="black" stroke="black" points="5569.47,-6706.05 5559.11,-6708.26 5568.58,-6712.99 5569.47,-6706.05"/>
</g>
<!-- expert_10_1&#45;&gt;expert_agg_10 -->
<g id="edge396" class="edge">
<title>expert_10_1&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5107.73,-6776.27C5110.56,-6775.64 5113.36,-6775.03 5116.11,-6774.43 5209.07,-6754.05 5315.78,-6730.94 5387.74,-6715.4"/>
<polygon fill="black" stroke="black" points="5388.62,-6718.79 5397.66,-6713.26 5387.14,-6711.95 5388.62,-6718.79"/>
</g>
<!-- expert_10_2&#45;&gt;expert_agg_10 -->
<g id="edge399" class="edge">
<title>expert_10_2&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5258.94,-6774.4C5297.33,-6760.47 5349.55,-6741.53 5392.58,-6725.92"/>
<polygon fill="black" stroke="black" points="5393.97,-6729.14 5402.17,-6722.43 5391.58,-6722.55 5393.97,-6729.14"/>
</g>
<!-- expert_10_3&#45;&gt;expert_agg_10 -->
<g id="edge402" class="edge">
<title>expert_10_3&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M4930.68,-6776.02C4933.52,-6775.47 4936.34,-6774.93 4939.11,-6774.43 5095.41,-6745.84 5279.12,-6721.22 5384.65,-6707.93"/>
<polygon fill="black" stroke="black" points="5385.13,-6711.4 5394.61,-6706.68 5384.25,-6704.45 5385.13,-6711.4"/>
</g>
<!-- expert_10_4&#45;&gt;expert_agg_10 -->
<g id="edge405" class="edge">
<title>expert_10_4&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5400.12,-6774.4C5407.97,-6765.89 5417.54,-6755.51 5427.09,-6745.16"/>
<polygon fill="black" stroke="black" points="5429.8,-6747.38 5434.01,-6737.65 5424.66,-6742.63 5429.8,-6747.38"/>
</g>
<!-- expert_10_5&#45;&gt;expert_agg_10 -->
<g id="edge408" class="edge">
<title>expert_10_5&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5833.53,-6776.49C5830.35,-6775.79 5827.2,-6775.1 5824.11,-6774.43 5740,-6756.04 5644.62,-6735.24 5574.22,-6719.89"/>
<polygon fill="black" stroke="black" points="5574.53,-6716.38 5564.02,-6717.67 5573.04,-6723.22 5574.53,-6716.38"/>
</g>
<!-- expert_10_6&#45;&gt;expert_agg_10 -->
<g id="edge411" class="edge">
<title>expert_10_6&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5541.3,-6774.4C5533.54,-6765.89 5524.07,-6755.51 5514.63,-6745.16"/>
<polygon fill="black" stroke="black" points="5517.11,-6742.68 5507.79,-6737.65 5511.94,-6747.4 5517.11,-6742.68"/>
</g>
<!-- expert_10_7&#45;&gt;expert_agg_10 -->
<g id="edge414" class="edge">
<title>expert_10_7&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M5682.48,-6774.4C5653.59,-6763.88 5616.83,-6750.49 5582.1,-6737.84"/>
<polygon fill="black" stroke="black" points="5582.96,-6734.43 5572.36,-6734.3 5580.56,-6741.01 5582.96,-6734.43"/>
</g>
<!-- expert_agg_10&#45;&gt;residual2_10 -->
<g id="edge415" class="edge">
<title>expert_agg_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M5382.72,-6683.5C5233.54,-6663.36 4935.96,-6623.2 4812.16,-6606.49"/>
<polygon fill="black" stroke="black" points="4812.52,-6603.01 4802.14,-6605.14 4811.58,-6609.95 4812.52,-6603.01"/>
</g>
<!-- ln2_10 -->
<g id="node209" class="node">
<title>ln2_10</title>
<polygon fill="lightpink" stroke="black" points="4802.11,-6540.43 4710.11,-6540.43 4710.11,-6499.43 4802.11,-6499.43 4802.11,-6540.43"/>
<text text-anchor="middle" x="4756.11" y="-6528.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4756.11" y="-6517.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4756.11" y="-6506.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- residual2_10&#45;&gt;ln2_10 -->
<g id="edge417" class="edge">
<title>residual2_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M4756.11,-6577.35C4756.11,-6569.2 4756.11,-6559.55 4756.11,-6550.56"/>
<polygon fill="black" stroke="black" points="4759.61,-6550.43 4756.11,-6540.43 4752.61,-6550.43 4759.61,-6550.43"/>
</g>
<!-- split_10 -->
<g id="node210" class="node">
<title>split_10</title>
<polygon fill="lightyellow" stroke="black" points="4910.53,-6462.43 4800.09,-6462.43 4771.68,-6402.43 4882.12,-6402.43 4910.53,-6462.43"/>
<text text-anchor="middle" x="4841.11" y="-6435.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="4841.11" y="-6424.43" font-family="Arial" font-size="10.00">GPU 9→10</text>
</g>
<!-- ln2_10&#45;&gt;split_10 -->
<g id="edge418" class="edge">
<title>ln2_10&#45;&gt;split_10</title>
<path fill="none" stroke="black" d="M4775.82,-6499.1C4784.5,-6490.36 4794.99,-6479.82 4804.99,-6469.76"/>
<polygon fill="black" stroke="black" points="4807.58,-6472.11 4812.15,-6462.55 4802.62,-6467.18 4807.58,-6472.11"/>
</g>
<!-- agg_11 -->
<g id="node211" class="node">
<title>agg_11</title>
<polygon fill="lightyellow" stroke="black" points="4825.53,-6365.43 4715.09,-6365.43 4686.68,-6305.43 4797.12,-6305.43 4825.53,-6365.43"/>
<text text-anchor="middle" x="4756.11" y="-6338.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="4756.11" y="-6327.43" font-family="Arial" font-size="10.00">GPU 9→10</text>
</g>
<!-- ln2_10&#45;&gt;agg_11 -->
<g id="edge424" class="edge">
<title>ln2_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M4756.11,-6499.4C4756.11,-6470.06 4756.11,-6414.02 4756.11,-6375.93"/>
<polygon fill="black" stroke="black" points="4759.61,-6375.7 4756.11,-6365.7 4752.61,-6375.7 4759.61,-6375.7"/>
</g>
<!-- split_10&#45;&gt;agg_11 -->
<g id="edge419" class="edge">
<title>split_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M4815.14,-6402.41C4806.9,-6393.19 4797.67,-6382.88 4789.01,-6373.19"/>
<polygon fill="black" stroke="black" points="4791.48,-6370.71 4782.21,-6365.6 4786.27,-6375.38 4791.48,-6370.71"/>
</g>
<!-- mha_q_11 -->
<g id="node212" class="node">
<title>mha_q_11</title>
<polygon fill="lightgreen" stroke="black" points="4879.11,-6268.43 4787.11,-6268.43 4787.11,-6227.43 4879.11,-6227.43 4879.11,-6268.43"/>
<text text-anchor="middle" x="4833.11" y="-6256.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="4833.11" y="-6245.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4833.11" y="-6234.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_q_11 -->
<g id="edge425" class="edge">
<title>agg_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M4782.61,-6305C4791.1,-6295.57 4800.47,-6285.17 4808.8,-6275.92"/>
<polygon fill="black" stroke="black" points="4811.42,-6278.24 4815.51,-6268.46 4806.22,-6273.55 4811.42,-6278.24"/>
</g>
<!-- mha_k_11 -->
<g id="node213" class="node">
<title>mha_k_11</title>
<polygon fill="lightgreen" stroke="black" points="4989.11,-6268.43 4897.11,-6268.43 4897.11,-6227.43 4989.11,-6227.43 4989.11,-6268.43"/>
<text text-anchor="middle" x="4943.11" y="-6256.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="4943.11" y="-6245.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4943.11" y="-6234.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_k_11 -->
<g id="edge426" class="edge">
<title>agg_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M4801.38,-6313.73C4828.37,-6301.39 4862.76,-6285.66 4890.9,-6272.8"/>
<polygon fill="black" stroke="black" points="4892.54,-6275.89 4900.18,-6268.55 4889.63,-6269.53 4892.54,-6275.89"/>
</g>
<!-- mha_v_11 -->
<g id="node214" class="node">
<title>mha_v_11</title>
<polygon fill="lightgreen" stroke="black" points="4769.11,-6268.43 4677.11,-6268.43 4677.11,-6227.43 4769.11,-6227.43 4769.11,-6268.43"/>
<text text-anchor="middle" x="4723.11" y="-6256.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="4723.11" y="-6245.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4723.11" y="-6234.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_v_11 -->
<g id="edge427" class="edge">
<title>agg_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M4744.75,-6305C4741.36,-6296.23 4737.66,-6286.62 4734.28,-6277.88"/>
<polygon fill="black" stroke="black" points="4737.51,-6276.53 4730.65,-6268.46 4730.98,-6279.05 4737.51,-6276.53"/>
</g>
<!-- residual1_11 -->
<g id="node217" class="node">
<title>residual1_11</title>
<polygon fill="lightpink" stroke="black" points="4707.11,-6034.43 4615.11,-6034.43 4615.11,-5993.43 4707.11,-5993.43 4707.11,-6034.43"/>
<text text-anchor="middle" x="4661.11" y="-6022.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="4661.11" y="-6011.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4661.11" y="-6000.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;residual1_11 -->
<g id="edge428" class="edge">
<title>agg_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M4686.83,-6305.36C4666.26,-6291.86 4649.11,-6273.3 4649.11,-6248.93 4649.11,-6248.93 4649.11,-6248.93 4649.11,-6090.93 4649.11,-6075.49 4651.55,-6058.51 4654.23,-6044.52"/>
<polygon fill="black" stroke="black" points="4657.71,-6044.98 4656.3,-6034.48 4650.86,-6043.57 4657.71,-6044.98"/>
</g>
<!-- mha_attn_11 -->
<g id="node215" class="node">
<title>mha_attn_11</title>
<polygon fill="lightgreen" stroke="black" points="4790.11,-6190.43 4686.11,-6190.43 4686.11,-6149.43 4790.11,-6149.43 4790.11,-6190.43"/>
<text text-anchor="middle" x="4738.11" y="-6178.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="4738.11" y="-6167.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="4738.11" y="-6156.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge420" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M4808.64,-6227.35C4797.01,-6218.05 4782.94,-6206.79 4770.44,-6196.79"/>
<polygon fill="black" stroke="black" points="4772.48,-6193.95 4762.49,-6190.43 4768.11,-6199.41 4772.48,-6193.95"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge421" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M4897.1,-6229.87C4868.43,-6219.24 4831.18,-6205.43 4799.95,-6193.85"/>
<polygon fill="black" stroke="black" points="4801.06,-6190.53 4790.46,-6190.34 4798.62,-6197.09 4801.06,-6190.53"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge422" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M4726.97,-6227.35C4728.6,-6219.11 4730.53,-6209.34 4732.32,-6200.26"/>
<polygon fill="black" stroke="black" points="4735.76,-6200.92 4734.26,-6190.43 4728.89,-6199.56 4735.76,-6200.92"/>
</g>
<!-- mha_out_11 -->
<g id="node216" class="node">
<title>mha_out_11</title>
<polygon fill="lightgreen" stroke="black" points="4772.11,-6112.43 4680.11,-6112.43 4680.11,-6071.43 4772.11,-6071.43 4772.11,-6112.43"/>
<text text-anchor="middle" x="4726.11" y="-6100.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="4726.11" y="-6089.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4726.11" y="-6078.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge423" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M4735.02,-6149.35C4733.73,-6141.2 4732.21,-6131.55 4730.79,-6122.56"/>
<polygon fill="black" stroke="black" points="4734.2,-6121.76 4729.19,-6112.43 4727.29,-6122.86 4734.2,-6121.76"/>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge429" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M4709.37,-6071.35C4701.79,-6062.49 4692.69,-6051.86 4684.46,-6042.23"/>
<polygon fill="black" stroke="black" points="4686.95,-6039.76 4677.79,-6034.43 4681.63,-6044.31 4686.95,-6039.76"/>
</g>
<!-- ln1_11 -->
<g id="node218" class="node">
<title>ln1_11</title>
<polygon fill="lightpink" stroke="black" points="4707.11,-5956.43 4615.11,-5956.43 4615.11,-5915.43 4707.11,-5915.43 4707.11,-5956.43"/>
<text text-anchor="middle" x="4661.11" y="-5944.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4661.11" y="-5933.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4661.11" y="-5922.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- residual1_11&#45;&gt;ln1_11 -->
<g id="edge430" class="edge">
<title>residual1_11&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M4661.11,-5993.35C4661.11,-5985.2 4661.11,-5975.55 4661.11,-5966.56"/>
<polygon fill="black" stroke="black" points="4664.61,-5966.43 4661.11,-5956.43 4657.61,-5966.43 4664.61,-5966.43"/>
</g>
<!-- gate_11 -->
<g id="node219" class="node">
<title>gate_11</title>
<polygon fill="gold" stroke="black" points="4661.11,-5878.43 4584.11,-5837.43 4661.11,-5796.43 4738.11,-5837.43 4661.11,-5878.43"/>
<text text-anchor="middle" x="4661.11" y="-5845.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="4661.11" y="-5834.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="4661.11" y="-5823.93" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;gate_11 -->
<g id="edge431" class="edge">
<title>ln1_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M4661.11,-5915.4C4661.11,-5907.63 4661.11,-5898.31 4661.11,-5888.87"/>
<polygon fill="black" stroke="black" points="4664.61,-5888.65 4661.11,-5878.65 4657.61,-5888.65 4664.61,-5888.65"/>
</g>
<!-- expert_11_0 -->
<g id="node220" class="node">
<title>expert_11_0</title>
<polygon fill="lightcoral" stroke="black" points="5398.61,-5745.43 5239.61,-5745.43 5239.61,-5704.43 5398.61,-5704.43 5398.61,-5745.43"/>
<text text-anchor="middle" x="5319.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="5319.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5319.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_0 -->
<g id="edge434" class="edge">
<title>ln1_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" d="M4707.16,-5931.71C4774.42,-5926.05 4902.86,-5911.62 5007.11,-5878.43 5109.35,-5845.87 5220.23,-5784.87 5278.32,-5750.72"/>
<polygon fill="black" stroke="black" points="5280.36,-5753.58 5287.18,-5745.47 5276.79,-5747.55 5280.36,-5753.58"/>
</g>
<!-- expert_11_1 -->
<g id="node221" class="node">
<title>expert_11_1</title>
<polygon fill="lightcoral" stroke="black" points="4336.61,-5745.43 4177.61,-5745.43 4177.61,-5704.43 4336.61,-5704.43 4336.61,-5745.43"/>
<text text-anchor="middle" x="4257.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="4257.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4257.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_1 -->
<g id="edge437" class="edge">
<title>ln1_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" d="M4614.76,-5930.87C4562.41,-5924.89 4475.73,-5910.7 4408.11,-5878.43 4343.59,-5847.63 4326.63,-5834.37 4282.11,-5778.43 4276.51,-5771.39 4271.77,-5762.88 4267.99,-5754.79"/>
<polygon fill="black" stroke="black" points="4271.18,-5753.36 4263.98,-5745.59 4264.76,-5756.16 4271.18,-5753.36"/>
</g>
<!-- expert_11_2 -->
<g id="node222" class="node">
<title>expert_11_2</title>
<polygon fill="lightcoral" stroke="black" points="4513.61,-5745.43 4354.61,-5745.43 4354.61,-5704.43 4513.61,-5704.43 4513.61,-5745.43"/>
<text text-anchor="middle" x="4434.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="4434.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4434.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_2 -->
<g id="edge440" class="edge">
<title>ln1_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" d="M4615.1,-5921.78C4585.34,-5912.17 4546.45,-5897.51 4515.11,-5878.43 4457.82,-5843.55 4429.65,-5839.57 4402.11,-5778.43 4398.45,-5770.31 4400.57,-5761.91 4405.09,-5754.28"/>
<polygon fill="black" stroke="black" points="4408.26,-5755.88 4411.3,-5745.73 4402.59,-5751.76 4408.26,-5755.88"/>
</g>
<!-- expert_11_3 -->
<g id="node223" class="node">
<title>expert_11_3</title>
<polygon fill="lightcoral" stroke="black" points="4159.61,-5745.43 4000.61,-5745.43 4000.61,-5704.43 4159.61,-5704.43 4159.61,-5745.43"/>
<text text-anchor="middle" x="4080.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="4080.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4080.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_3 -->
<g id="edge443" class="edge">
<title>ln1_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" d="M4614.97,-5934.59C4543.59,-5932.6 4403.25,-5922.78 4294.11,-5878.43 4219.93,-5848.28 4146.87,-5787.79 4108.27,-5752.73"/>
<polygon fill="black" stroke="black" points="4110.3,-5749.84 4100.56,-5745.66 4105.56,-5755 4110.3,-5749.84"/>
</g>
<!-- expert_11_4 -->
<g id="node224" class="node">
<title>expert_11_4</title>
<polygon fill="lightcoral" stroke="black" points="4690.61,-5745.43 4531.61,-5745.43 4531.61,-5704.43 4690.61,-5704.43 4690.61,-5745.43"/>
<text text-anchor="middle" x="4611.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="4611.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4611.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_4 -->
<g id="edge446" class="edge">
<title>ln1_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" d="M4623.77,-5915.27C4607.6,-5905.59 4589.19,-5892.89 4575.11,-5878.43 4538.62,-5840.97 4527.43,-5828.72 4513.11,-5778.43 4509.71,-5766.51 4514.18,-5757.27 4522.79,-5750.11"/>
<polygon fill="black" stroke="black" points="4525,-5752.84 4531.32,-5744.34 4521.08,-5747.04 4525,-5752.84"/>
</g>
<!-- expert_11_5 -->
<g id="node225" class="node">
<title>expert_11_5</title>
<polygon fill="lightcoral" stroke="black" points="5221.61,-5745.43 5062.61,-5745.43 5062.61,-5704.43 5221.61,-5704.43 5221.61,-5745.43"/>
<text text-anchor="middle" x="5142.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="5142.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="5142.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_5 -->
<g id="edge449" class="edge">
<title>ln1_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" d="M4707.2,-5928.61C4792.75,-5914.86 4978.33,-5875.32 5099.11,-5778.43 5107.88,-5771.39 5116.09,-5762.29 5122.94,-5753.66"/>
<polygon fill="black" stroke="black" points="5125.8,-5755.68 5129.06,-5745.61 5120.22,-5751.45 5125.8,-5755.68"/>
</g>
<!-- expert_11_6 -->
<g id="node226" class="node">
<title>expert_11_6</title>
<polygon fill="lightcoral" stroke="black" points="4867.61,-5745.43 4708.61,-5745.43 4708.61,-5704.43 4867.61,-5704.43 4867.61,-5745.43"/>
<text text-anchor="middle" x="4788.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="4788.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4788.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_6 -->
<g id="edge452" class="edge">
<title>ln1_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" d="M4704.47,-5915.29C4752.03,-5890.97 4825.42,-5844.51 4854.11,-5778.43 4858.66,-5767.94 4854.29,-5758.96 4846.02,-5751.55"/>
<polygon fill="black" stroke="black" points="4847.97,-5748.64 4837.87,-5745.44 4843.77,-5754.24 4847.97,-5748.64"/>
</g>
<!-- expert_11_7 -->
<g id="node227" class="node">
<title>expert_11_7</title>
<polygon fill="lightcoral" stroke="black" points="5044.61,-5745.43 4885.61,-5745.43 4885.61,-5704.43 5044.61,-5704.43 5044.61,-5745.43"/>
<text text-anchor="middle" x="4965.11" y="-5733.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="4965.11" y="-5722.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4965.11" y="-5711.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_11_7 -->
<g id="edge455" class="edge">
<title>ln1_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" d="M4707.32,-5922.03C4739.78,-5912.13 4783.72,-5897.03 4820.11,-5878.43 4889.81,-5842.79 4928.71,-5847.74 4965.11,-5778.43 4968.69,-5771.6 4969.91,-5763.56 4969.93,-5755.84"/>
<polygon fill="black" stroke="black" points="4973.41,-5755.45 4969.33,-5745.68 4966.42,-5755.87 4973.41,-5755.45"/>
</g>
<!-- expert_agg_11 -->
<g id="node228" class="node">
<title>expert_agg_11</title>
<polygon fill="lightyellow" stroke="black" points="4802.88,-5667.43 4639.39,-5667.43 4597.33,-5585.43 4760.83,-5585.43 4802.88,-5667.43"/>
<text text-anchor="middle" x="4700.11" y="-5634.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="4700.11" y="-5623.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4700.11" y="-5612.93" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;expert_agg_11 -->
<g id="edge432" class="edge">
<title>ln1_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4707.4,-5935.66C4898.68,-5937.28 5608.16,-5928.57 5407.11,-5704.43 5366.9,-5659.61 4977.49,-5638.38 4794.38,-5630.82"/>
<polygon fill="black" stroke="black" points="4794.36,-5627.32 4784.22,-5630.4 4794.07,-5634.31 4794.36,-5627.32"/>
</g>
<!-- residual2_11 -->
<g id="node229" class="node">
<title>residual2_11</title>
<polygon fill="lightpink" stroke="black" points="4031.11,-5548.43 3939.11,-5548.43 3939.11,-5507.43 4031.11,-5507.43 4031.11,-5548.43"/>
<text text-anchor="middle" x="3985.11" y="-5536.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3985.11" y="-5525.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3985.11" y="-5514.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;residual2_11 -->
<g id="edge458" class="edge">
<title>ln1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M4614.9,-5933.32C4460.64,-5927.37 3973.11,-5903.41 3973.11,-5838.43 3973.11,-5838.43 3973.11,-5838.43 3973.11,-5625.43 3973.11,-5602.78 3976.4,-5577.37 3979.54,-5558.31"/>
<polygon fill="black" stroke="black" points="3982.99,-5558.88 3981.24,-5548.43 3976.09,-5557.69 3982.99,-5558.88"/>
</g>
<!-- gate_11&#45;&gt;expert_11_0 -->
<g id="edge433" class="edge">
<title>gate_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4720.69,-5828.04C4822.71,-5813.43 5037.56,-5781.58 5229.58,-5745.47"/>
<polygon fill="black" stroke="black" points="5230.4,-5748.88 5239.58,-5743.59 5229.1,-5742 5230.4,-5748.88"/>
<text text-anchor="middle" x="5153.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_11&#45;&gt;expert_11_1 -->
<g id="edge436" class="edge">
<title>gate_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4610.93,-5822.9C4567.55,-5811.19 4503.17,-5793.77 4447.11,-5778.43 4411.06,-5768.56 4371.18,-5757.56 4337.31,-5748.18"/>
<polygon fill="black" stroke="black" points="4338.04,-5744.75 4327.47,-5745.46 4336.17,-5751.5 4338.04,-5744.75"/>
<text text-anchor="middle" x="4478.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_11&#45;&gt;expert_11_2 -->
<g id="edge439" class="edge">
<title>gate_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4621.83,-5817.3C4583.49,-5798.64 4525.02,-5770.18 4483.54,-5749.99"/>
<polygon fill="black" stroke="black" points="4484.96,-5746.79 4474.43,-5745.56 4481.89,-5753.08 4484.96,-5746.79"/>
<text text-anchor="middle" x="4572.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_11&#45;&gt;expert_11_3 -->
<g id="edge442" class="edge">
<title>gate_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4603.56,-5826.96C4537.09,-5815.9 4424.53,-5796.76 4328.11,-5778.43 4259.84,-5765.44 4240.73,-5761 4169.62,-5745.74"/>
<polygon fill="black" stroke="black" points="4170.23,-5742.3 4159.72,-5743.62 4168.77,-5749.14 4170.23,-5742.3"/>
<text text-anchor="middle" x="4359.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_11&#45;&gt;expert_11_4 -->
<g id="edge445" class="edge">
<title>gate_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4637.04,-5808.84C4630.23,-5799.7 4623.49,-5789.12 4619.11,-5778.43 4616.17,-5771.27 4614.31,-5763.17 4613.12,-5755.51"/>
<polygon fill="black" stroke="black" points="4616.58,-5754.96 4611.88,-5745.47 4609.63,-5755.82 4616.58,-5754.96"/>
<text text-anchor="middle" x="4650.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_11&#45;&gt;expert_11_5 -->
<g id="edge448" class="edge">
<title>gate_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4711.33,-5823.09C4755.52,-5811.35 4821.59,-5793.78 4879.11,-5778.43 4904,-5771.78 4909.89,-5768.71 4935.11,-5763.43 4984.09,-5753.16 4999.25,-5754.86 5052.55,-5745.44"/>
<polygon fill="black" stroke="black" points="5053.37,-5748.85 5062.58,-5743.62 5052.12,-5741.96 5053.37,-5748.85"/>
<text text-anchor="middle" x="4966.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_11&#45;&gt;expert_11_6 -->
<g id="edge451" class="edge">
<title>gate_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4675.26,-5803.94C4682.57,-5790.06 4692.61,-5774.53 4705.11,-5763.43 4710.55,-5758.59 4716.73,-5754.28 4723.19,-5750.46"/>
<polygon fill="black" stroke="black" points="4725.05,-5753.43 4732.14,-5745.56 4721.69,-5747.29 4725.05,-5753.43"/>
<text text-anchor="middle" x="4736.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_11&#45;&gt;expert_11_7 -->
<g id="edge454" class="edge">
<title>gate_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4698.77,-5816.16C4729.63,-5800.18 4774.79,-5778.2 4816.11,-5763.43 4827.86,-5759.22 4850.93,-5753.08 4875.47,-5746.98"/>
<polygon fill="black" stroke="black" points="4876.43,-5750.35 4885.3,-5744.56 4874.75,-5743.56 4876.43,-5750.35"/>
<text text-anchor="middle" x="4847.61" y="-5767.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_11_0&#45;&gt;expert_agg_11 -->
<g id="edge435" class="edge">
<title>expert_11_0&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M5239.59,-5706.21C5236.39,-5705.59 5233.22,-5704.99 5230.11,-5704.43 5080.12,-5677.14 4904.85,-5653.22 4798.21,-5639.55"/>
<polygon fill="black" stroke="black" points="4798.47,-5636.05 4788.11,-5638.26 4797.58,-5642.99 4798.47,-5636.05"/>
</g>
<!-- expert_11_1&#45;&gt;expert_agg_11 -->
<g id="edge438" class="edge">
<title>expert_11_1&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4336.73,-5706.27C4339.56,-5705.64 4342.36,-5705.03 4345.11,-5704.43 4438.07,-5684.05 4544.78,-5660.94 4616.74,-5645.4"/>
<polygon fill="black" stroke="black" points="4617.62,-5648.79 4626.66,-5643.26 4616.14,-5641.95 4617.62,-5648.79"/>
</g>
<!-- expert_11_2&#45;&gt;expert_agg_11 -->
<g id="edge441" class="edge">
<title>expert_11_2&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4487.94,-5704.4C4526.33,-5690.47 4578.55,-5671.53 4621.58,-5655.92"/>
<polygon fill="black" stroke="black" points="4622.97,-5659.14 4631.17,-5652.43 4620.58,-5652.55 4622.97,-5659.14"/>
</g>
<!-- expert_11_3&#45;&gt;expert_agg_11 -->
<g id="edge444" class="edge">
<title>expert_11_3&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4159.68,-5706.02C4162.52,-5705.47 4165.34,-5704.93 4168.11,-5704.43 4324.41,-5675.84 4508.12,-5651.22 4613.65,-5637.93"/>
<polygon fill="black" stroke="black" points="4614.13,-5641.4 4623.61,-5636.68 4613.25,-5634.45 4614.13,-5641.4"/>
</g>
<!-- expert_11_4&#45;&gt;expert_agg_11 -->
<g id="edge447" class="edge">
<title>expert_11_4&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4629.12,-5704.4C4636.97,-5695.89 4646.54,-5685.51 4656.09,-5675.16"/>
<polygon fill="black" stroke="black" points="4658.8,-5677.38 4663.01,-5667.65 4653.66,-5672.63 4658.8,-5677.38"/>
</g>
<!-- expert_11_5&#45;&gt;expert_agg_11 -->
<g id="edge450" class="edge">
<title>expert_11_5&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M5062.53,-5706.49C5059.35,-5705.79 5056.2,-5705.1 5053.11,-5704.43 4969,-5686.04 4873.62,-5665.24 4803.22,-5649.89"/>
<polygon fill="black" stroke="black" points="4803.53,-5646.38 4793.02,-5647.67 4802.04,-5653.22 4803.53,-5646.38"/>
</g>
<!-- expert_11_6&#45;&gt;expert_agg_11 -->
<g id="edge453" class="edge">
<title>expert_11_6&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4770.3,-5704.4C4762.54,-5695.89 4753.07,-5685.51 4743.63,-5675.16"/>
<polygon fill="black" stroke="black" points="4746.11,-5672.68 4736.79,-5667.65 4740.94,-5677.4 4746.11,-5672.68"/>
</g>
<!-- expert_11_7&#45;&gt;expert_agg_11 -->
<g id="edge456" class="edge">
<title>expert_11_7&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4911.48,-5704.4C4882.59,-5693.88 4845.83,-5680.49 4811.1,-5667.84"/>
<polygon fill="black" stroke="black" points="4811.96,-5664.43 4801.36,-5664.3 4809.56,-5671.01 4811.96,-5664.43"/>
</g>
<!-- expert_agg_11&#45;&gt;residual2_11 -->
<g id="edge457" class="edge">
<title>expert_agg_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M4611.72,-5613.5C4462.54,-5593.36 4164.96,-5553.2 4041.16,-5536.49"/>
<polygon fill="black" stroke="black" points="4041.52,-5533.01 4031.14,-5535.14 4040.58,-5539.95 4041.52,-5533.01"/>
</g>
<!-- ln2_11 -->
<g id="node230" class="node">
<title>ln2_11</title>
<polygon fill="lightpink" stroke="black" points="4031.11,-5470.43 3939.11,-5470.43 3939.11,-5429.43 4031.11,-5429.43 4031.11,-5470.43"/>
<text text-anchor="middle" x="3985.11" y="-5458.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3985.11" y="-5447.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3985.11" y="-5436.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- residual2_11&#45;&gt;ln2_11 -->
<g id="edge459" class="edge">
<title>residual2_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M3985.11,-5507.35C3985.11,-5499.2 3985.11,-5489.55 3985.11,-5480.56"/>
<polygon fill="black" stroke="black" points="3988.61,-5480.43 3985.11,-5470.43 3981.61,-5480.43 3988.61,-5480.43"/>
</g>
<!-- split_11 -->
<g id="node231" class="node">
<title>split_11</title>
<polygon fill="lightyellow" stroke="black" points="4150.9,-5392.43 4031.92,-5392.43 4001.31,-5332.43 4120.29,-5332.43 4150.9,-5392.43"/>
<text text-anchor="middle" x="4076.11" y="-5365.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="4076.11" y="-5354.43" font-family="Arial" font-size="10.00">GPU 10→11</text>
</g>
<!-- ln2_11&#45;&gt;split_11 -->
<g id="edge460" class="edge">
<title>ln2_11&#45;&gt;split_11</title>
<path fill="none" stroke="black" d="M4006.21,-5429.1C4015.6,-5420.28 4026.95,-5409.61 4037.75,-5399.47"/>
<polygon fill="black" stroke="black" points="4040.22,-5401.95 4045.11,-5392.55 4035.42,-5396.85 4040.22,-5401.95"/>
</g>
<!-- agg_12 -->
<g id="node232" class="node">
<title>agg_12</title>
<polygon fill="lightyellow" stroke="black" points="4059.9,-5295.43 3940.92,-5295.43 3910.31,-5235.43 4029.29,-5235.43 4059.9,-5295.43"/>
<text text-anchor="middle" x="3985.11" y="-5268.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="3985.11" y="-5257.43" font-family="Arial" font-size="10.00">GPU 10→11</text>
</g>
<!-- ln2_11&#45;&gt;agg_12 -->
<g id="edge466" class="edge">
<title>ln2_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M3985.11,-5429.4C3985.11,-5400.06 3985.11,-5344.02 3985.11,-5305.93"/>
<polygon fill="black" stroke="black" points="3988.61,-5305.7 3985.11,-5295.7 3981.61,-5305.7 3988.61,-5305.7"/>
</g>
<!-- split_11&#45;&gt;agg_12 -->
<g id="edge461" class="edge">
<title>split_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M4048.31,-5332.41C4039.4,-5323.1 4029.41,-5312.68 4020.05,-5302.91"/>
<polygon fill="black" stroke="black" points="4022.49,-5300.4 4013.05,-5295.6 4017.44,-5305.24 4022.49,-5300.4"/>
</g>
<!-- mha_q_12 -->
<g id="node233" class="node">
<title>mha_q_12</title>
<polygon fill="lightgreen" stroke="black" points="4108.11,-5198.43 4016.11,-5198.43 4016.11,-5157.43 4108.11,-5157.43 4108.11,-5198.43"/>
<text text-anchor="middle" x="4062.11" y="-5186.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="4062.11" y="-5175.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4062.11" y="-5164.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_q_12 -->
<g id="edge467" class="edge">
<title>agg_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M4011.61,-5235C4020.1,-5225.57 4029.47,-5215.17 4037.8,-5205.92"/>
<polygon fill="black" stroke="black" points="4040.42,-5208.24 4044.51,-5198.46 4035.22,-5203.55 4040.42,-5208.24"/>
</g>
<!-- mha_k_12 -->
<g id="node234" class="node">
<title>mha_k_12</title>
<polygon fill="lightgreen" stroke="black" points="4218.11,-5198.43 4126.11,-5198.43 4126.11,-5157.43 4218.11,-5157.43 4218.11,-5198.43"/>
<text text-anchor="middle" x="4172.11" y="-5186.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="4172.11" y="-5175.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="4172.11" y="-5164.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_k_12 -->
<g id="edge468" class="edge">
<title>agg_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M4033.26,-5242.41C4059.79,-5230.28 4092.74,-5215.22 4119.88,-5202.81"/>
<polygon fill="black" stroke="black" points="4121.58,-5205.88 4129.22,-5198.54 4118.67,-5199.51 4121.58,-5205.88"/>
</g>
<!-- mha_v_12 -->
<g id="node235" class="node">
<title>mha_v_12</title>
<polygon fill="lightgreen" stroke="black" points="3998.11,-5198.43 3906.11,-5198.43 3906.11,-5157.43 3998.11,-5157.43 3998.11,-5198.43"/>
<text text-anchor="middle" x="3952.11" y="-5186.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="3952.11" y="-5175.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3952.11" y="-5164.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_v_12 -->
<g id="edge469" class="edge">
<title>agg_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M3973.75,-5235C3970.36,-5226.23 3966.66,-5216.62 3963.28,-5207.88"/>
<polygon fill="black" stroke="black" points="3966.51,-5206.53 3959.65,-5198.46 3959.98,-5209.05 3966.51,-5206.53"/>
</g>
<!-- residual1_12 -->
<g id="node238" class="node">
<title>residual1_12</title>
<polygon fill="lightpink" stroke="black" points="3936.11,-4964.43 3844.11,-4964.43 3844.11,-4923.43 3936.11,-4923.43 3936.11,-4964.43"/>
<text text-anchor="middle" x="3890.11" y="-4952.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3890.11" y="-4941.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3890.11" y="-4930.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;residual1_12 -->
<g id="edge470" class="edge">
<title>agg_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M3915.83,-5235.36C3895.26,-5221.86 3878.11,-5203.3 3878.11,-5178.93 3878.11,-5178.93 3878.11,-5178.93 3878.11,-5020.93 3878.11,-5005.49 3880.55,-4988.51 3883.23,-4974.52"/>
<polygon fill="black" stroke="black" points="3886.71,-4974.98 3885.3,-4964.48 3879.86,-4973.57 3886.71,-4974.98"/>
</g>
<!-- mha_attn_12 -->
<g id="node236" class="node">
<title>mha_attn_12</title>
<polygon fill="lightgreen" stroke="black" points="4019.11,-5120.43 3915.11,-5120.43 3915.11,-5079.43 4019.11,-5079.43 4019.11,-5120.43"/>
<text text-anchor="middle" x="3967.11" y="-5108.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="3967.11" y="-5097.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="3967.11" y="-5086.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge462" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M4037.64,-5157.35C4026.01,-5148.05 4011.94,-5136.79 3999.44,-5126.79"/>
<polygon fill="black" stroke="black" points="4001.48,-5123.95 3991.49,-5120.43 3997.11,-5129.41 4001.48,-5123.95"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge463" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M4126.1,-5159.87C4097.43,-5149.24 4060.18,-5135.43 4028.95,-5123.85"/>
<polygon fill="black" stroke="black" points="4030.06,-5120.53 4019.46,-5120.34 4027.62,-5127.09 4030.06,-5120.53"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge464" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M3955.97,-5157.35C3957.6,-5149.11 3959.53,-5139.34 3961.32,-5130.26"/>
<polygon fill="black" stroke="black" points="3964.76,-5130.92 3963.26,-5120.43 3957.89,-5129.56 3964.76,-5130.92"/>
</g>
<!-- mha_out_12 -->
<g id="node237" class="node">
<title>mha_out_12</title>
<polygon fill="lightgreen" stroke="black" points="4001.11,-5042.43 3909.11,-5042.43 3909.11,-5001.43 4001.11,-5001.43 4001.11,-5042.43"/>
<text text-anchor="middle" x="3955.11" y="-5030.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="3955.11" y="-5019.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3955.11" y="-5008.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge465" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M3964.02,-5079.35C3962.73,-5071.2 3961.21,-5061.55 3959.79,-5052.56"/>
<polygon fill="black" stroke="black" points="3963.2,-5051.76 3958.19,-5042.43 3956.29,-5052.86 3963.2,-5051.76"/>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge471" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M3938.37,-5001.35C3930.79,-4992.49 3921.69,-4981.86 3913.46,-4972.23"/>
<polygon fill="black" stroke="black" points="3915.95,-4969.76 3906.79,-4964.43 3910.63,-4974.31 3915.95,-4969.76"/>
</g>
<!-- ln1_12 -->
<g id="node239" class="node">
<title>ln1_12</title>
<polygon fill="lightpink" stroke="black" points="3936.11,-4886.43 3844.11,-4886.43 3844.11,-4845.43 3936.11,-4845.43 3936.11,-4886.43"/>
<text text-anchor="middle" x="3890.11" y="-4874.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3890.11" y="-4863.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3890.11" y="-4852.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- residual1_12&#45;&gt;ln1_12 -->
<g id="edge472" class="edge">
<title>residual1_12&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M3890.11,-4923.35C3890.11,-4915.2 3890.11,-4905.55 3890.11,-4896.56"/>
<polygon fill="black" stroke="black" points="3893.61,-4896.43 3890.11,-4886.43 3886.61,-4896.43 3893.61,-4896.43"/>
</g>
<!-- gate_12 -->
<g id="node240" class="node">
<title>gate_12</title>
<polygon fill="gold" stroke="black" points="3890.11,-4808.43 3813.11,-4767.43 3890.11,-4726.43 3967.11,-4767.43 3890.11,-4808.43"/>
<text text-anchor="middle" x="3890.11" y="-4775.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="3890.11" y="-4764.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="3890.11" y="-4753.93" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;gate_12 -->
<g id="edge473" class="edge">
<title>ln1_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M3890.11,-4845.4C3890.11,-4837.63 3890.11,-4828.31 3890.11,-4818.87"/>
<polygon fill="black" stroke="black" points="3893.61,-4818.65 3890.11,-4808.65 3886.61,-4818.65 3893.61,-4818.65"/>
</g>
<!-- expert_12_0 -->
<g id="node241" class="node">
<title>expert_12_0</title>
<polygon fill="lightcoral" stroke="black" points="4627.61,-4675.43 4468.61,-4675.43 4468.61,-4634.43 4627.61,-4634.43 4627.61,-4675.43"/>
<text text-anchor="middle" x="4548.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="4548.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4548.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_0 -->
<g id="edge476" class="edge">
<title>ln1_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" d="M3936.16,-4861.71C4003.42,-4856.05 4131.86,-4841.62 4236.11,-4808.43 4338.35,-4775.87 4449.23,-4714.87 4507.32,-4680.72"/>
<polygon fill="black" stroke="black" points="4509.36,-4683.58 4516.18,-4675.47 4505.79,-4677.55 4509.36,-4683.58"/>
</g>
<!-- expert_12_1 -->
<g id="node242" class="node">
<title>expert_12_1</title>
<polygon fill="lightcoral" stroke="black" points="3565.61,-4675.43 3406.61,-4675.43 3406.61,-4634.43 3565.61,-4634.43 3565.61,-4675.43"/>
<text text-anchor="middle" x="3486.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="3486.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3486.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_1 -->
<g id="edge479" class="edge">
<title>ln1_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" d="M3843.76,-4860.87C3791.41,-4854.89 3704.73,-4840.7 3637.11,-4808.43 3572.59,-4777.63 3555.63,-4764.37 3511.11,-4708.43 3505.51,-4701.39 3500.77,-4692.88 3496.99,-4684.79"/>
<polygon fill="black" stroke="black" points="3500.18,-4683.36 3492.98,-4675.59 3493.76,-4686.16 3500.18,-4683.36"/>
</g>
<!-- expert_12_2 -->
<g id="node243" class="node">
<title>expert_12_2</title>
<polygon fill="lightcoral" stroke="black" points="3742.61,-4675.43 3583.61,-4675.43 3583.61,-4634.43 3742.61,-4634.43 3742.61,-4675.43"/>
<text text-anchor="middle" x="3663.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="3663.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3663.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_2 -->
<g id="edge482" class="edge">
<title>ln1_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" d="M3844.1,-4851.78C3814.34,-4842.17 3775.45,-4827.51 3744.11,-4808.43 3686.82,-4773.55 3658.65,-4769.57 3631.11,-4708.43 3627.45,-4700.31 3629.57,-4691.91 3634.09,-4684.28"/>
<polygon fill="black" stroke="black" points="3637.26,-4685.88 3640.3,-4675.73 3631.59,-4681.76 3637.26,-4685.88"/>
</g>
<!-- expert_12_3 -->
<g id="node244" class="node">
<title>expert_12_3</title>
<polygon fill="lightcoral" stroke="black" points="3388.61,-4675.43 3229.61,-4675.43 3229.61,-4634.43 3388.61,-4634.43 3388.61,-4675.43"/>
<text text-anchor="middle" x="3309.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="3309.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3309.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_3 -->
<g id="edge485" class="edge">
<title>ln1_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" d="M3843.97,-4864.59C3772.59,-4862.6 3632.25,-4852.78 3523.11,-4808.43 3448.93,-4778.28 3375.87,-4717.79 3337.27,-4682.73"/>
<polygon fill="black" stroke="black" points="3339.3,-4679.84 3329.56,-4675.66 3334.56,-4685 3339.3,-4679.84"/>
</g>
<!-- expert_12_4 -->
<g id="node245" class="node">
<title>expert_12_4</title>
<polygon fill="lightcoral" stroke="black" points="3919.61,-4675.43 3760.61,-4675.43 3760.61,-4634.43 3919.61,-4634.43 3919.61,-4675.43"/>
<text text-anchor="middle" x="3840.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="3840.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3840.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_4 -->
<g id="edge488" class="edge">
<title>ln1_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" d="M3852.77,-4845.27C3836.6,-4835.59 3818.19,-4822.89 3804.11,-4808.43 3767.62,-4770.97 3756.43,-4758.72 3742.11,-4708.43 3738.71,-4696.51 3743.18,-4687.27 3751.79,-4680.11"/>
<polygon fill="black" stroke="black" points="3754,-4682.84 3760.32,-4674.34 3750.08,-4677.04 3754,-4682.84"/>
</g>
<!-- expert_12_5 -->
<g id="node246" class="node">
<title>expert_12_5</title>
<polygon fill="lightcoral" stroke="black" points="4450.61,-4675.43 4291.61,-4675.43 4291.61,-4634.43 4450.61,-4634.43 4450.61,-4675.43"/>
<text text-anchor="middle" x="4371.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="4371.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4371.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_5 -->
<g id="edge491" class="edge">
<title>ln1_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" d="M3936.2,-4858.61C4021.75,-4844.86 4207.33,-4805.32 4328.11,-4708.43 4336.88,-4701.39 4345.09,-4692.29 4351.94,-4683.66"/>
<polygon fill="black" stroke="black" points="4354.8,-4685.68 4358.06,-4675.61 4349.22,-4681.45 4354.8,-4685.68"/>
</g>
<!-- expert_12_6 -->
<g id="node247" class="node">
<title>expert_12_6</title>
<polygon fill="lightcoral" stroke="black" points="4096.61,-4675.43 3937.61,-4675.43 3937.61,-4634.43 4096.61,-4634.43 4096.61,-4675.43"/>
<text text-anchor="middle" x="4017.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="4017.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4017.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_6 -->
<g id="edge494" class="edge">
<title>ln1_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" d="M3933.47,-4845.29C3981.03,-4820.97 4054.42,-4774.51 4083.11,-4708.43 4087.66,-4697.94 4083.29,-4688.96 4075.02,-4681.55"/>
<polygon fill="black" stroke="black" points="4076.97,-4678.64 4066.87,-4675.44 4072.77,-4684.24 4076.97,-4678.64"/>
</g>
<!-- expert_12_7 -->
<g id="node248" class="node">
<title>expert_12_7</title>
<polygon fill="lightcoral" stroke="black" points="4273.61,-4675.43 4114.61,-4675.43 4114.61,-4634.43 4273.61,-4634.43 4273.61,-4675.43"/>
<text text-anchor="middle" x="4194.11" y="-4663.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="4194.11" y="-4652.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="4194.11" y="-4641.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_12_7 -->
<g id="edge497" class="edge">
<title>ln1_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" d="M3936.32,-4852.03C3968.78,-4842.13 4012.72,-4827.03 4049.11,-4808.43 4118.81,-4772.79 4157.71,-4777.74 4194.11,-4708.43 4197.69,-4701.6 4198.91,-4693.56 4198.93,-4685.84"/>
<polygon fill="black" stroke="black" points="4202.41,-4685.45 4198.33,-4675.68 4195.42,-4685.87 4202.41,-4685.45"/>
</g>
<!-- expert_agg_12 -->
<g id="node249" class="node">
<title>expert_agg_12</title>
<polygon fill="lightyellow" stroke="black" points="4031.88,-4597.43 3868.39,-4597.43 3826.33,-4515.43 3989.83,-4515.43 4031.88,-4597.43"/>
<text text-anchor="middle" x="3929.11" y="-4564.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3929.11" y="-4553.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3929.11" y="-4542.93" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;expert_agg_12 -->
<g id="edge474" class="edge">
<title>ln1_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3936.4,-4865.66C4127.68,-4867.28 4837.16,-4858.57 4636.11,-4634.43 4595.9,-4589.61 4206.49,-4568.38 4023.38,-4560.82"/>
<polygon fill="black" stroke="black" points="4023.36,-4557.32 4013.22,-4560.4 4023.07,-4564.31 4023.36,-4557.32"/>
</g>
<!-- residual2_12 -->
<g id="node250" class="node">
<title>residual2_12</title>
<polygon fill="lightpink" stroke="black" points="3260.11,-4478.43 3168.11,-4478.43 3168.11,-4437.43 3260.11,-4437.43 3260.11,-4478.43"/>
<text text-anchor="middle" x="3214.11" y="-4466.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3214.11" y="-4455.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3214.11" y="-4444.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;residual2_12 -->
<g id="edge500" class="edge">
<title>ln1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M3843.9,-4863.32C3689.64,-4857.37 3202.11,-4833.41 3202.11,-4768.43 3202.11,-4768.43 3202.11,-4768.43 3202.11,-4555.43 3202.11,-4532.78 3205.4,-4507.37 3208.54,-4488.31"/>
<polygon fill="black" stroke="black" points="3211.99,-4488.88 3210.24,-4478.43 3205.09,-4487.69 3211.99,-4488.88"/>
</g>
<!-- gate_12&#45;&gt;expert_12_0 -->
<g id="edge475" class="edge">
<title>gate_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3949.69,-4758.04C4051.71,-4743.43 4266.56,-4711.58 4458.58,-4675.47"/>
<polygon fill="black" stroke="black" points="4459.4,-4678.88 4468.58,-4673.59 4458.1,-4672 4459.4,-4678.88"/>
<text text-anchor="middle" x="4382.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_12&#45;&gt;expert_12_1 -->
<g id="edge478" class="edge">
<title>gate_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3839.93,-4752.9C3796.55,-4741.19 3732.17,-4723.77 3676.11,-4708.43 3640.06,-4698.56 3600.18,-4687.56 3566.31,-4678.18"/>
<polygon fill="black" stroke="black" points="3567.04,-4674.75 3556.47,-4675.46 3565.17,-4681.5 3567.04,-4674.75"/>
<text text-anchor="middle" x="3707.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_12&#45;&gt;expert_12_2 -->
<g id="edge481" class="edge">
<title>gate_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3850.83,-4747.3C3812.49,-4728.64 3754.02,-4700.18 3712.54,-4679.99"/>
<polygon fill="black" stroke="black" points="3713.96,-4676.79 3703.43,-4675.56 3710.89,-4683.08 3713.96,-4676.79"/>
<text text-anchor="middle" x="3801.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_12&#45;&gt;expert_12_3 -->
<g id="edge484" class="edge">
<title>gate_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3832.56,-4756.96C3766.09,-4745.9 3653.53,-4726.76 3557.11,-4708.43 3488.84,-4695.44 3469.73,-4691 3398.62,-4675.74"/>
<polygon fill="black" stroke="black" points="3399.23,-4672.3 3388.72,-4673.62 3397.77,-4679.14 3399.23,-4672.3"/>
<text text-anchor="middle" x="3588.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_12&#45;&gt;expert_12_4 -->
<g id="edge487" class="edge">
<title>gate_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3866.04,-4738.84C3859.23,-4729.7 3852.49,-4719.12 3848.11,-4708.43 3845.17,-4701.27 3843.31,-4693.17 3842.12,-4685.51"/>
<polygon fill="black" stroke="black" points="3845.58,-4684.96 3840.88,-4675.47 3838.63,-4685.82 3845.58,-4684.96"/>
<text text-anchor="middle" x="3879.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_12&#45;&gt;expert_12_5 -->
<g id="edge490" class="edge">
<title>gate_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3940.33,-4753.09C3984.52,-4741.35 4050.59,-4723.78 4108.11,-4708.43 4133,-4701.78 4138.89,-4698.71 4164.11,-4693.43 4213.09,-4683.16 4228.25,-4684.86 4281.55,-4675.44"/>
<polygon fill="black" stroke="black" points="4282.37,-4678.85 4291.58,-4673.62 4281.12,-4671.96 4282.37,-4678.85"/>
<text text-anchor="middle" x="4195.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_12&#45;&gt;expert_12_6 -->
<g id="edge493" class="edge">
<title>gate_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3904.26,-4733.94C3911.57,-4720.06 3921.61,-4704.53 3934.11,-4693.43 3939.55,-4688.59 3945.73,-4684.28 3952.19,-4680.46"/>
<polygon fill="black" stroke="black" points="3954.05,-4683.43 3961.14,-4675.56 3950.69,-4677.29 3954.05,-4683.43"/>
<text text-anchor="middle" x="3965.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_12&#45;&gt;expert_12_7 -->
<g id="edge496" class="edge">
<title>gate_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3927.77,-4746.16C3958.63,-4730.18 4003.79,-4708.2 4045.11,-4693.43 4056.86,-4689.22 4079.93,-4683.08 4104.47,-4676.98"/>
<polygon fill="black" stroke="black" points="4105.43,-4680.35 4114.3,-4674.56 4103.75,-4673.56 4105.43,-4680.35"/>
<text text-anchor="middle" x="4076.61" y="-4697.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_12_0&#45;&gt;expert_agg_12 -->
<g id="edge477" class="edge">
<title>expert_12_0&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4468.59,-4636.21C4465.39,-4635.59 4462.22,-4634.99 4459.11,-4634.43 4309.12,-4607.14 4133.85,-4583.22 4027.21,-4569.55"/>
<polygon fill="black" stroke="black" points="4027.47,-4566.05 4017.11,-4568.26 4026.58,-4572.99 4027.47,-4566.05"/>
</g>
<!-- expert_12_1&#45;&gt;expert_agg_12 -->
<g id="edge480" class="edge">
<title>expert_12_1&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3565.73,-4636.27C3568.56,-4635.64 3571.36,-4635.03 3574.11,-4634.43 3667.07,-4614.05 3773.78,-4590.94 3845.74,-4575.4"/>
<polygon fill="black" stroke="black" points="3846.62,-4578.79 3855.66,-4573.26 3845.14,-4571.95 3846.62,-4578.79"/>
</g>
<!-- expert_12_2&#45;&gt;expert_agg_12 -->
<g id="edge483" class="edge">
<title>expert_12_2&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3716.94,-4634.4C3755.33,-4620.47 3807.55,-4601.53 3850.58,-4585.92"/>
<polygon fill="black" stroke="black" points="3851.97,-4589.14 3860.17,-4582.43 3849.58,-4582.55 3851.97,-4589.14"/>
</g>
<!-- expert_12_3&#45;&gt;expert_agg_12 -->
<g id="edge486" class="edge">
<title>expert_12_3&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3388.68,-4636.02C3391.52,-4635.47 3394.34,-4634.93 3397.11,-4634.43 3553.41,-4605.84 3737.12,-4581.22 3842.65,-4567.93"/>
<polygon fill="black" stroke="black" points="3843.13,-4571.4 3852.61,-4566.68 3842.25,-4564.45 3843.13,-4571.4"/>
</g>
<!-- expert_12_4&#45;&gt;expert_agg_12 -->
<g id="edge489" class="edge">
<title>expert_12_4&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3858.12,-4634.4C3865.97,-4625.89 3875.54,-4615.51 3885.09,-4605.16"/>
<polygon fill="black" stroke="black" points="3887.8,-4607.38 3892.01,-4597.65 3882.66,-4602.63 3887.8,-4607.38"/>
</g>
<!-- expert_12_5&#45;&gt;expert_agg_12 -->
<g id="edge492" class="edge">
<title>expert_12_5&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4291.53,-4636.49C4288.35,-4635.79 4285.2,-4635.1 4282.11,-4634.43 4198,-4616.04 4102.62,-4595.24 4032.22,-4579.89"/>
<polygon fill="black" stroke="black" points="4032.53,-4576.38 4022.02,-4577.67 4031.04,-4583.22 4032.53,-4576.38"/>
</g>
<!-- expert_12_6&#45;&gt;expert_agg_12 -->
<g id="edge495" class="edge">
<title>expert_12_6&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3999.3,-4634.4C3991.54,-4625.89 3982.07,-4615.51 3972.63,-4605.16"/>
<polygon fill="black" stroke="black" points="3975.11,-4602.68 3965.79,-4597.65 3969.94,-4607.4 3975.11,-4602.68"/>
</g>
<!-- expert_12_7&#45;&gt;expert_agg_12 -->
<g id="edge498" class="edge">
<title>expert_12_7&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4140.48,-4634.4C4111.59,-4623.88 4074.83,-4610.49 4040.1,-4597.84"/>
<polygon fill="black" stroke="black" points="4040.96,-4594.43 4030.36,-4594.3 4038.56,-4601.01 4040.96,-4594.43"/>
</g>
<!-- expert_agg_12&#45;&gt;residual2_12 -->
<g id="edge499" class="edge">
<title>expert_agg_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M3840.72,-4543.5C3691.54,-4523.36 3393.96,-4483.2 3270.16,-4466.49"/>
<polygon fill="black" stroke="black" points="3270.52,-4463.01 3260.14,-4465.14 3269.58,-4469.95 3270.52,-4463.01"/>
</g>
<!-- ln2_12 -->
<g id="node251" class="node">
<title>ln2_12</title>
<polygon fill="lightpink" stroke="black" points="3260.11,-4400.43 3168.11,-4400.43 3168.11,-4359.43 3260.11,-4359.43 3260.11,-4400.43"/>
<text text-anchor="middle" x="3214.11" y="-4388.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3214.11" y="-4377.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3214.11" y="-4366.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- residual2_12&#45;&gt;ln2_12 -->
<g id="edge501" class="edge">
<title>residual2_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M3214.11,-4437.35C3214.11,-4429.2 3214.11,-4419.55 3214.11,-4410.56"/>
<polygon fill="black" stroke="black" points="3217.61,-4410.43 3214.11,-4400.43 3210.61,-4410.43 3217.61,-4410.43"/>
</g>
<!-- split_12 -->
<g id="node252" class="node">
<title>split_12</title>
<polygon fill="lightyellow" stroke="black" points="3379.9,-4322.43 3260.92,-4322.43 3230.31,-4262.43 3349.29,-4262.43 3379.9,-4322.43"/>
<text text-anchor="middle" x="3305.11" y="-4295.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="3305.11" y="-4284.43" font-family="Arial" font-size="10.00">GPU 11→12</text>
</g>
<!-- ln2_12&#45;&gt;split_12 -->
<g id="edge502" class="edge">
<title>ln2_12&#45;&gt;split_12</title>
<path fill="none" stroke="black" d="M3235.21,-4359.1C3244.6,-4350.28 3255.95,-4339.61 3266.75,-4329.47"/>
<polygon fill="black" stroke="black" points="3269.22,-4331.95 3274.11,-4322.55 3264.42,-4326.85 3269.22,-4331.95"/>
</g>
<!-- agg_13 -->
<g id="node253" class="node">
<title>agg_13</title>
<polygon fill="lightyellow" stroke="black" points="3288.9,-4225.43 3169.92,-4225.43 3139.31,-4165.43 3258.29,-4165.43 3288.9,-4225.43"/>
<text text-anchor="middle" x="3214.11" y="-4198.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="3214.11" y="-4187.43" font-family="Arial" font-size="10.00">GPU 11→12</text>
</g>
<!-- ln2_12&#45;&gt;agg_13 -->
<g id="edge508" class="edge">
<title>ln2_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3214.11,-4359.4C3214.11,-4330.06 3214.11,-4274.02 3214.11,-4235.93"/>
<polygon fill="black" stroke="black" points="3217.61,-4235.7 3214.11,-4225.7 3210.61,-4235.7 3217.61,-4235.7"/>
</g>
<!-- split_12&#45;&gt;agg_13 -->
<g id="edge503" class="edge">
<title>split_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M3277.31,-4262.41C3268.4,-4253.1 3258.41,-4242.68 3249.05,-4232.91"/>
<polygon fill="black" stroke="black" points="3251.49,-4230.4 3242.05,-4225.6 3246.44,-4235.24 3251.49,-4230.4"/>
</g>
<!-- mha_q_13 -->
<g id="node254" class="node">
<title>mha_q_13</title>
<polygon fill="lightgreen" stroke="black" points="3337.11,-4128.43 3245.11,-4128.43 3245.11,-4087.43 3337.11,-4087.43 3337.11,-4128.43"/>
<text text-anchor="middle" x="3291.11" y="-4116.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="3291.11" y="-4105.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3291.11" y="-4094.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_q_13 -->
<g id="edge509" class="edge">
<title>agg_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M3240.61,-4165C3249.1,-4155.57 3258.47,-4145.17 3266.8,-4135.92"/>
<polygon fill="black" stroke="black" points="3269.42,-4138.24 3273.51,-4128.46 3264.22,-4133.55 3269.42,-4138.24"/>
</g>
<!-- mha_k_13 -->
<g id="node255" class="node">
<title>mha_k_13</title>
<polygon fill="lightgreen" stroke="black" points="3447.11,-4128.43 3355.11,-4128.43 3355.11,-4087.43 3447.11,-4087.43 3447.11,-4128.43"/>
<text text-anchor="middle" x="3401.11" y="-4116.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="3401.11" y="-4105.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3401.11" y="-4094.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_k_13 -->
<g id="edge510" class="edge">
<title>agg_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M3262.26,-4172.41C3288.79,-4160.28 3321.74,-4145.22 3348.88,-4132.81"/>
<polygon fill="black" stroke="black" points="3350.58,-4135.88 3358.22,-4128.54 3347.67,-4129.51 3350.58,-4135.88"/>
</g>
<!-- mha_v_13 -->
<g id="node256" class="node">
<title>mha_v_13</title>
<polygon fill="lightgreen" stroke="black" points="3227.11,-4128.43 3135.11,-4128.43 3135.11,-4087.43 3227.11,-4087.43 3227.11,-4128.43"/>
<text text-anchor="middle" x="3181.11" y="-4116.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="3181.11" y="-4105.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3181.11" y="-4094.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_v_13 -->
<g id="edge511" class="edge">
<title>agg_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M3202.75,-4165C3199.36,-4156.23 3195.66,-4146.62 3192.28,-4137.88"/>
<polygon fill="black" stroke="black" points="3195.51,-4136.53 3188.65,-4128.46 3188.98,-4139.05 3195.51,-4136.53"/>
</g>
<!-- residual1_13 -->
<g id="node259" class="node">
<title>residual1_13</title>
<polygon fill="lightpink" stroke="black" points="3165.11,-3894.43 3073.11,-3894.43 3073.11,-3853.43 3165.11,-3853.43 3165.11,-3894.43"/>
<text text-anchor="middle" x="3119.11" y="-3882.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="3119.11" y="-3871.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3119.11" y="-3860.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;residual1_13 -->
<g id="edge512" class="edge">
<title>agg_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M3144.83,-4165.36C3124.26,-4151.86 3107.11,-4133.3 3107.11,-4108.93 3107.11,-4108.93 3107.11,-4108.93 3107.11,-3950.93 3107.11,-3935.49 3109.55,-3918.51 3112.23,-3904.52"/>
<polygon fill="black" stroke="black" points="3115.71,-3904.98 3114.3,-3894.48 3108.86,-3903.57 3115.71,-3904.98"/>
</g>
<!-- mha_attn_13 -->
<g id="node257" class="node">
<title>mha_attn_13</title>
<polygon fill="lightgreen" stroke="black" points="3248.11,-4050.43 3144.11,-4050.43 3144.11,-4009.43 3248.11,-4009.43 3248.11,-4050.43"/>
<text text-anchor="middle" x="3196.11" y="-4038.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="3196.11" y="-4027.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="3196.11" y="-4016.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge504" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M3266.64,-4087.35C3255.01,-4078.05 3240.94,-4066.79 3228.44,-4056.79"/>
<polygon fill="black" stroke="black" points="3230.48,-4053.95 3220.49,-4050.43 3226.11,-4059.41 3230.48,-4053.95"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge505" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M3355.1,-4089.87C3326.43,-4079.24 3289.18,-4065.43 3257.95,-4053.85"/>
<polygon fill="black" stroke="black" points="3259.06,-4050.53 3248.46,-4050.34 3256.62,-4057.09 3259.06,-4050.53"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge506" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M3184.97,-4087.35C3186.6,-4079.11 3188.53,-4069.34 3190.32,-4060.26"/>
<polygon fill="black" stroke="black" points="3193.76,-4060.92 3192.26,-4050.43 3186.89,-4059.56 3193.76,-4060.92"/>
</g>
<!-- mha_out_13 -->
<g id="node258" class="node">
<title>mha_out_13</title>
<polygon fill="lightgreen" stroke="black" points="3230.11,-3972.43 3138.11,-3972.43 3138.11,-3931.43 3230.11,-3931.43 3230.11,-3972.43"/>
<text text-anchor="middle" x="3184.11" y="-3960.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="3184.11" y="-3949.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3184.11" y="-3938.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge507" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M3193.02,-4009.35C3191.73,-4001.2 3190.21,-3991.55 3188.79,-3982.56"/>
<polygon fill="black" stroke="black" points="3192.2,-3981.76 3187.19,-3972.43 3185.29,-3982.86 3192.2,-3981.76"/>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge513" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M3167.37,-3931.35C3159.79,-3922.49 3150.69,-3911.86 3142.46,-3902.23"/>
<polygon fill="black" stroke="black" points="3144.95,-3899.76 3135.79,-3894.43 3139.63,-3904.31 3144.95,-3899.76"/>
</g>
<!-- ln1_13 -->
<g id="node260" class="node">
<title>ln1_13</title>
<polygon fill="lightpink" stroke="black" points="3165.11,-3816.43 3073.11,-3816.43 3073.11,-3775.43 3165.11,-3775.43 3165.11,-3816.43"/>
<text text-anchor="middle" x="3119.11" y="-3804.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="3119.11" y="-3793.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3119.11" y="-3782.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- residual1_13&#45;&gt;ln1_13 -->
<g id="edge514" class="edge">
<title>residual1_13&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M3119.11,-3853.35C3119.11,-3845.2 3119.11,-3835.55 3119.11,-3826.56"/>
<polygon fill="black" stroke="black" points="3122.61,-3826.43 3119.11,-3816.43 3115.61,-3826.43 3122.61,-3826.43"/>
</g>
<!-- gate_13 -->
<g id="node261" class="node">
<title>gate_13</title>
<polygon fill="gold" stroke="black" points="3119.11,-3738.43 3042.11,-3697.43 3119.11,-3656.43 3196.11,-3697.43 3119.11,-3738.43"/>
<text text-anchor="middle" x="3119.11" y="-3705.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="3119.11" y="-3694.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="3119.11" y="-3683.93" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;gate_13 -->
<g id="edge515" class="edge">
<title>ln1_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M3119.11,-3775.4C3119.11,-3767.63 3119.11,-3758.31 3119.11,-3748.87"/>
<polygon fill="black" stroke="black" points="3122.61,-3748.65 3119.11,-3738.65 3115.61,-3748.65 3122.61,-3748.65"/>
</g>
<!-- expert_13_0 -->
<g id="node262" class="node">
<title>expert_13_0</title>
<polygon fill="lightcoral" stroke="black" points="3856.61,-3605.43 3697.61,-3605.43 3697.61,-3564.43 3856.61,-3564.43 3856.61,-3605.43"/>
<text text-anchor="middle" x="3777.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3777.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3777.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_0 -->
<g id="edge518" class="edge">
<title>ln1_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" d="M3165.13,-3792.09C3233.69,-3786.87 3366.03,-3772.92 3473.11,-3738.43 3573.14,-3706.21 3681.02,-3645.08 3737.48,-3610.81"/>
<polygon fill="black" stroke="black" points="3739.38,-3613.75 3746.09,-3605.55 3735.73,-3607.77 3739.38,-3613.75"/>
</g>
<!-- expert_13_1 -->
<g id="node263" class="node">
<title>expert_13_1</title>
<polygon fill="lightcoral" stroke="black" points="2794.61,-3605.43 2635.61,-3605.43 2635.61,-3564.43 2794.61,-3564.43 2794.61,-3605.43"/>
<text text-anchor="middle" x="2715.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="2715.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2715.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_1 -->
<g id="edge521" class="edge">
<title>ln1_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" d="M3072.76,-3790.87C3020.41,-3784.89 2933.73,-3770.7 2866.11,-3738.43 2801.59,-3707.63 2784.63,-3694.37 2740.11,-3638.43 2734.51,-3631.39 2729.77,-3622.88 2725.99,-3614.79"/>
<polygon fill="black" stroke="black" points="2729.18,-3613.36 2721.98,-3605.59 2722.76,-3616.16 2729.18,-3613.36"/>
</g>
<!-- expert_13_2 -->
<g id="node264" class="node">
<title>expert_13_2</title>
<polygon fill="lightcoral" stroke="black" points="2971.61,-3605.43 2812.61,-3605.43 2812.61,-3564.43 2971.61,-3564.43 2971.61,-3605.43"/>
<text text-anchor="middle" x="2892.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2892.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2892.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_2 -->
<g id="edge524" class="edge">
<title>ln1_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" d="M3073.1,-3781.78C3043.34,-3772.17 3004.45,-3757.51 2973.11,-3738.43 2915.82,-3703.55 2887.65,-3699.57 2860.11,-3638.43 2856.45,-3630.31 2858.57,-3621.91 2863.09,-3614.28"/>
<polygon fill="black" stroke="black" points="2866.26,-3615.88 2869.3,-3605.73 2860.59,-3611.76 2866.26,-3615.88"/>
</g>
<!-- expert_13_3 -->
<g id="node265" class="node">
<title>expert_13_3</title>
<polygon fill="lightcoral" stroke="black" points="2617.61,-3605.43 2458.61,-3605.43 2458.61,-3564.43 2617.61,-3564.43 2617.61,-3605.43"/>
<text text-anchor="middle" x="2538.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="2538.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2538.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_3 -->
<g id="edge527" class="edge">
<title>ln1_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" d="M3072.97,-3794.59C3001.59,-3792.6 2861.25,-3782.78 2752.11,-3738.43 2677.93,-3708.28 2604.87,-3647.79 2566.27,-3612.73"/>
<polygon fill="black" stroke="black" points="2568.3,-3609.84 2558.56,-3605.66 2563.56,-3615 2568.3,-3609.84"/>
</g>
<!-- expert_13_4 -->
<g id="node266" class="node">
<title>expert_13_4</title>
<polygon fill="lightcoral" stroke="black" points="3148.61,-3605.43 2989.61,-3605.43 2989.61,-3564.43 3148.61,-3564.43 3148.61,-3605.43"/>
<text text-anchor="middle" x="3069.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="3069.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3069.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_4 -->
<g id="edge530" class="edge">
<title>ln1_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" d="M3081.77,-3775.27C3065.6,-3765.59 3047.19,-3752.89 3033.11,-3738.43 2996.62,-3700.97 2985.43,-3688.72 2971.11,-3638.43 2967.71,-3626.51 2972.18,-3617.27 2980.79,-3610.11"/>
<polygon fill="black" stroke="black" points="2983,-3612.84 2989.32,-3604.34 2979.08,-3607.04 2983,-3612.84"/>
</g>
<!-- expert_13_5 -->
<g id="node267" class="node">
<title>expert_13_5</title>
<polygon fill="lightcoral" stroke="black" points="3679.61,-3605.43 3520.61,-3605.43 3520.61,-3564.43 3679.61,-3564.43 3679.61,-3605.43"/>
<text text-anchor="middle" x="3600.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="3600.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3600.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_5 -->
<g id="edge533" class="edge">
<title>ln1_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" d="M3165.43,-3786.84C3214.33,-3777.65 3293.3,-3760.95 3359.11,-3738.43 3460.34,-3703.78 3503.65,-3715.27 3578.11,-3638.43 3584.39,-3631.95 3588.98,-3623.41 3592.3,-3615.12"/>
<polygon fill="black" stroke="black" points="3595.62,-3616.21 3595.63,-3605.62 3589.02,-3613.9 3595.62,-3616.21"/>
</g>
<!-- expert_13_6 -->
<g id="node268" class="node">
<title>expert_13_6</title>
<polygon fill="lightcoral" stroke="black" points="3325.61,-3605.43 3166.61,-3605.43 3166.61,-3564.43 3325.61,-3564.43 3325.61,-3605.43"/>
<text text-anchor="middle" x="3246.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="3246.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3246.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_6 -->
<g id="edge536" class="edge">
<title>ln1_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" d="M3162.47,-3775.29C3210.03,-3750.97 3283.42,-3704.51 3312.11,-3638.43 3316.66,-3627.94 3312.29,-3618.96 3304.02,-3611.55"/>
<polygon fill="black" stroke="black" points="3305.97,-3608.64 3295.87,-3605.44 3301.77,-3614.24 3305.97,-3608.64"/>
</g>
<!-- expert_13_7 -->
<g id="node269" class="node">
<title>expert_13_7</title>
<polygon fill="lightcoral" stroke="black" points="3502.61,-3605.43 3343.61,-3605.43 3343.61,-3564.43 3502.61,-3564.43 3502.61,-3605.43"/>
<text text-anchor="middle" x="3423.11" y="-3593.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="3423.11" y="-3582.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3423.11" y="-3571.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_13_7 -->
<g id="edge539" class="edge">
<title>ln1_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" d="M3165.32,-3782.03C3197.78,-3772.13 3241.72,-3757.03 3278.11,-3738.43 3347.81,-3702.79 3386.71,-3707.74 3423.11,-3638.43 3426.69,-3631.6 3427.91,-3623.56 3427.93,-3615.84"/>
<polygon fill="black" stroke="black" points="3431.41,-3615.45 3427.33,-3605.68 3424.42,-3615.87 3431.41,-3615.45"/>
</g>
<!-- expert_agg_13 -->
<g id="node270" class="node">
<title>expert_agg_13</title>
<polygon fill="lightyellow" stroke="black" points="3260.88,-3527.43 3097.39,-3527.43 3055.33,-3445.43 3218.83,-3445.43 3260.88,-3527.43"/>
<text text-anchor="middle" x="3158.11" y="-3494.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3158.11" y="-3483.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="3158.11" y="-3472.93" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;expert_agg_13 -->
<g id="edge516" class="edge">
<title>ln1_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3165.4,-3795.66C3356.68,-3797.28 4066.16,-3788.57 3865.11,-3564.43 3824.9,-3519.61 3435.49,-3498.38 3252.38,-3490.82"/>
<polygon fill="black" stroke="black" points="3252.36,-3487.32 3242.22,-3490.4 3252.07,-3494.31 3252.36,-3487.32"/>
</g>
<!-- residual2_13 -->
<g id="node271" class="node">
<title>residual2_13</title>
<polygon fill="lightpink" stroke="black" points="2489.11,-3408.43 2397.11,-3408.43 2397.11,-3367.43 2489.11,-3367.43 2489.11,-3408.43"/>
<text text-anchor="middle" x="2443.11" y="-3396.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2443.11" y="-3385.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2443.11" y="-3374.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;residual2_13 -->
<g id="edge542" class="edge">
<title>ln1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M3072.9,-3793.32C2918.64,-3787.37 2431.11,-3763.41 2431.11,-3698.43 2431.11,-3698.43 2431.11,-3698.43 2431.11,-3485.43 2431.11,-3462.78 2434.4,-3437.37 2437.54,-3418.31"/>
<polygon fill="black" stroke="black" points="2440.99,-3418.88 2439.24,-3408.43 2434.09,-3417.69 2440.99,-3418.88"/>
</g>
<!-- gate_13&#45;&gt;expert_13_0 -->
<g id="edge517" class="edge">
<title>gate_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3178.69,-3688.04C3280.71,-3673.43 3495.56,-3641.58 3687.58,-3605.47"/>
<polygon fill="black" stroke="black" points="3688.4,-3608.88 3697.58,-3603.59 3687.1,-3602 3688.4,-3608.88"/>
<text text-anchor="middle" x="3611.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_13&#45;&gt;expert_13_1 -->
<g id="edge520" class="edge">
<title>gate_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3068.93,-3682.9C3025.55,-3671.19 2961.17,-3653.77 2905.11,-3638.43 2869.06,-3628.56 2829.18,-3617.56 2795.31,-3608.18"/>
<polygon fill="black" stroke="black" points="2796.04,-3604.75 2785.47,-3605.46 2794.17,-3611.5 2796.04,-3604.75"/>
<text text-anchor="middle" x="2936.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_13&#45;&gt;expert_13_2 -->
<g id="edge523" class="edge">
<title>gate_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3079.83,-3677.3C3041.49,-3658.64 2983.02,-3630.18 2941.54,-3609.99"/>
<polygon fill="black" stroke="black" points="2942.96,-3606.79 2932.43,-3605.56 2939.89,-3613.08 2942.96,-3606.79"/>
<text text-anchor="middle" x="3030.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_13&#45;&gt;expert_13_3 -->
<g id="edge526" class="edge">
<title>gate_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3061.56,-3686.96C2995.09,-3675.9 2882.53,-3656.76 2786.11,-3638.43 2717.84,-3625.44 2698.73,-3621 2627.62,-3605.74"/>
<polygon fill="black" stroke="black" points="2628.23,-3602.3 2617.72,-3603.62 2626.77,-3609.14 2628.23,-3602.3"/>
<text text-anchor="middle" x="2817.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_13&#45;&gt;expert_13_4 -->
<g id="edge529" class="edge">
<title>gate_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3095.04,-3668.84C3088.23,-3659.7 3081.49,-3649.12 3077.11,-3638.43 3074.17,-3631.27 3072.31,-3623.17 3071.12,-3615.51"/>
<polygon fill="black" stroke="black" points="3074.58,-3614.96 3069.88,-3605.47 3067.63,-3615.82 3074.58,-3614.96"/>
<text text-anchor="middle" x="3108.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_13&#45;&gt;expert_13_5 -->
<g id="edge532" class="edge">
<title>gate_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3169.27,-3683.05C3227.8,-3667.67 3327.6,-3642.14 3414.11,-3623.43 3454.12,-3614.77 3466.51,-3614.17 3510.64,-3605.47"/>
<polygon fill="black" stroke="black" points="3511.44,-3608.88 3520.56,-3603.49 3510.07,-3602.02 3511.44,-3608.88"/>
<text text-anchor="middle" x="3445.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_13&#45;&gt;expert_13_6 -->
<g id="edge535" class="edge">
<title>gate_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3133.26,-3663.94C3140.57,-3650.06 3150.61,-3634.53 3163.11,-3623.43 3168.55,-3618.59 3174.73,-3614.28 3181.19,-3610.46"/>
<polygon fill="black" stroke="black" points="3183.05,-3613.43 3190.14,-3605.56 3179.69,-3607.29 3183.05,-3613.43"/>
<text text-anchor="middle" x="3194.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_13&#45;&gt;expert_13_7 -->
<g id="edge538" class="edge">
<title>gate_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3156.77,-3676.16C3187.63,-3660.18 3232.79,-3638.2 3274.11,-3623.43 3285.86,-3619.22 3308.93,-3613.08 3333.47,-3606.98"/>
<polygon fill="black" stroke="black" points="3334.43,-3610.35 3343.3,-3604.56 3332.75,-3603.56 3334.43,-3610.35"/>
<text text-anchor="middle" x="3305.61" y="-3627.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_13_0&#45;&gt;expert_agg_13 -->
<g id="edge519" class="edge">
<title>expert_13_0&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3697.59,-3566.21C3694.39,-3565.59 3691.22,-3564.99 3688.11,-3564.43 3538.12,-3537.14 3362.85,-3513.22 3256.21,-3499.55"/>
<polygon fill="black" stroke="black" points="3256.47,-3496.05 3246.11,-3498.26 3255.58,-3502.99 3256.47,-3496.05"/>
</g>
<!-- expert_13_1&#45;&gt;expert_agg_13 -->
<g id="edge522" class="edge">
<title>expert_13_1&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2794.73,-3566.27C2797.56,-3565.64 2800.36,-3565.03 2803.11,-3564.43 2896.07,-3544.05 3002.78,-3520.94 3074.74,-3505.4"/>
<polygon fill="black" stroke="black" points="3075.62,-3508.79 3084.66,-3503.26 3074.14,-3501.95 3075.62,-3508.79"/>
</g>
<!-- expert_13_2&#45;&gt;expert_agg_13 -->
<g id="edge525" class="edge">
<title>expert_13_2&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2945.94,-3564.4C2984.33,-3550.47 3036.55,-3531.53 3079.58,-3515.92"/>
<polygon fill="black" stroke="black" points="3080.97,-3519.14 3089.17,-3512.43 3078.58,-3512.55 3080.97,-3519.14"/>
</g>
<!-- expert_13_3&#45;&gt;expert_agg_13 -->
<g id="edge528" class="edge">
<title>expert_13_3&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2617.68,-3566.02C2620.52,-3565.47 2623.34,-3564.93 2626.11,-3564.43 2782.41,-3535.84 2966.12,-3511.22 3071.65,-3497.93"/>
<polygon fill="black" stroke="black" points="3072.13,-3501.4 3081.61,-3496.68 3071.25,-3494.45 3072.13,-3501.4"/>
</g>
<!-- expert_13_4&#45;&gt;expert_agg_13 -->
<g id="edge531" class="edge">
<title>expert_13_4&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3087.12,-3564.4C3094.97,-3555.89 3104.54,-3545.51 3114.09,-3535.16"/>
<polygon fill="black" stroke="black" points="3116.8,-3537.38 3121.01,-3527.65 3111.66,-3532.63 3116.8,-3537.38"/>
</g>
<!-- expert_13_5&#45;&gt;expert_agg_13 -->
<g id="edge534" class="edge">
<title>expert_13_5&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3520.53,-3566.49C3517.35,-3565.79 3514.2,-3565.1 3511.11,-3564.43 3427,-3546.04 3331.62,-3525.24 3261.22,-3509.89"/>
<polygon fill="black" stroke="black" points="3261.53,-3506.38 3251.02,-3507.67 3260.04,-3513.22 3261.53,-3506.38"/>
</g>
<!-- expert_13_6&#45;&gt;expert_agg_13 -->
<g id="edge537" class="edge">
<title>expert_13_6&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3228.3,-3564.4C3220.54,-3555.89 3211.07,-3545.51 3201.63,-3535.16"/>
<polygon fill="black" stroke="black" points="3204.11,-3532.68 3194.79,-3527.65 3198.94,-3537.4 3204.11,-3532.68"/>
</g>
<!-- expert_13_7&#45;&gt;expert_agg_13 -->
<g id="edge540" class="edge">
<title>expert_13_7&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3369.48,-3564.4C3340.59,-3553.88 3303.83,-3540.49 3269.1,-3527.84"/>
<polygon fill="black" stroke="black" points="3269.96,-3524.43 3259.36,-3524.3 3267.56,-3531.01 3269.96,-3524.43"/>
</g>
<!-- expert_agg_13&#45;&gt;residual2_13 -->
<g id="edge541" class="edge">
<title>expert_agg_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M3069.72,-3473.5C2920.54,-3453.36 2622.96,-3413.2 2499.16,-3396.49"/>
<polygon fill="black" stroke="black" points="2499.52,-3393.01 2489.14,-3395.14 2498.58,-3399.95 2499.52,-3393.01"/>
</g>
<!-- ln2_13 -->
<g id="node272" class="node">
<title>ln2_13</title>
<polygon fill="lightpink" stroke="black" points="2489.11,-3330.43 2397.11,-3330.43 2397.11,-3289.43 2489.11,-3289.43 2489.11,-3330.43"/>
<text text-anchor="middle" x="2443.11" y="-3318.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2443.11" y="-3307.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2443.11" y="-3296.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- residual2_13&#45;&gt;ln2_13 -->
<g id="edge543" class="edge">
<title>residual2_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M2443.11,-3367.35C2443.11,-3359.2 2443.11,-3349.55 2443.11,-3340.56"/>
<polygon fill="black" stroke="black" points="2446.61,-3340.43 2443.11,-3330.43 2439.61,-3340.43 2446.61,-3340.43"/>
</g>
<!-- split_13 -->
<g id="node273" class="node">
<title>split_13</title>
<polygon fill="lightyellow" stroke="black" points="2608.9,-3252.43 2489.92,-3252.43 2459.31,-3192.43 2578.29,-3192.43 2608.9,-3252.43"/>
<text text-anchor="middle" x="2534.11" y="-3225.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="2534.11" y="-3214.43" font-family="Arial" font-size="10.00">GPU 12→13</text>
</g>
<!-- ln2_13&#45;&gt;split_13 -->
<g id="edge544" class="edge">
<title>ln2_13&#45;&gt;split_13</title>
<path fill="none" stroke="black" d="M2464.21,-3289.1C2473.6,-3280.28 2484.95,-3269.61 2495.75,-3259.47"/>
<polygon fill="black" stroke="black" points="2498.22,-3261.95 2503.11,-3252.55 2493.42,-3256.85 2498.22,-3261.95"/>
</g>
<!-- agg_14 -->
<g id="node274" class="node">
<title>agg_14</title>
<polygon fill="lightyellow" stroke="black" points="2517.9,-3155.43 2398.92,-3155.43 2368.31,-3095.43 2487.29,-3095.43 2517.9,-3155.43"/>
<text text-anchor="middle" x="2443.11" y="-3128.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="2443.11" y="-3117.43" font-family="Arial" font-size="10.00">GPU 12→13</text>
</g>
<!-- ln2_13&#45;&gt;agg_14 -->
<g id="edge550" class="edge">
<title>ln2_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2443.11,-3289.4C2443.11,-3260.06 2443.11,-3204.02 2443.11,-3165.93"/>
<polygon fill="black" stroke="black" points="2446.61,-3165.7 2443.11,-3155.7 2439.61,-3165.7 2446.61,-3165.7"/>
</g>
<!-- split_13&#45;&gt;agg_14 -->
<g id="edge545" class="edge">
<title>split_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M2506.31,-3192.41C2497.4,-3183.1 2487.41,-3172.68 2478.05,-3162.91"/>
<polygon fill="black" stroke="black" points="2480.49,-3160.4 2471.05,-3155.6 2475.44,-3165.24 2480.49,-3160.4"/>
</g>
<!-- mha_q_14 -->
<g id="node275" class="node">
<title>mha_q_14</title>
<polygon fill="lightgreen" stroke="black" points="2566.11,-3058.43 2474.11,-3058.43 2474.11,-3017.43 2566.11,-3017.43 2566.11,-3058.43"/>
<text text-anchor="middle" x="2520.11" y="-3046.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="2520.11" y="-3035.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2520.11" y="-3024.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_q_14 -->
<g id="edge551" class="edge">
<title>agg_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M2469.61,-3095C2478.1,-3085.57 2487.47,-3075.17 2495.8,-3065.92"/>
<polygon fill="black" stroke="black" points="2498.42,-3068.24 2502.51,-3058.46 2493.22,-3063.55 2498.42,-3068.24"/>
</g>
<!-- mha_k_14 -->
<g id="node276" class="node">
<title>mha_k_14</title>
<polygon fill="lightgreen" stroke="black" points="2676.11,-3058.43 2584.11,-3058.43 2584.11,-3017.43 2676.11,-3017.43 2676.11,-3058.43"/>
<text text-anchor="middle" x="2630.11" y="-3046.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="2630.11" y="-3035.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2630.11" y="-3024.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_k_14 -->
<g id="edge552" class="edge">
<title>agg_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M2491.26,-3102.41C2517.79,-3090.28 2550.74,-3075.22 2577.88,-3062.81"/>
<polygon fill="black" stroke="black" points="2579.58,-3065.88 2587.22,-3058.54 2576.67,-3059.51 2579.58,-3065.88"/>
</g>
<!-- mha_v_14 -->
<g id="node277" class="node">
<title>mha_v_14</title>
<polygon fill="lightgreen" stroke="black" points="2456.11,-3058.43 2364.11,-3058.43 2364.11,-3017.43 2456.11,-3017.43 2456.11,-3058.43"/>
<text text-anchor="middle" x="2410.11" y="-3046.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="2410.11" y="-3035.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2410.11" y="-3024.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_v_14 -->
<g id="edge553" class="edge">
<title>agg_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M2431.75,-3095C2428.36,-3086.23 2424.66,-3076.62 2421.28,-3067.88"/>
<polygon fill="black" stroke="black" points="2424.51,-3066.53 2417.65,-3058.46 2417.98,-3069.05 2424.51,-3066.53"/>
</g>
<!-- residual1_14 -->
<g id="node280" class="node">
<title>residual1_14</title>
<polygon fill="lightpink" stroke="black" points="2394.11,-2824.43 2302.11,-2824.43 2302.11,-2783.43 2394.11,-2783.43 2394.11,-2824.43"/>
<text text-anchor="middle" x="2348.11" y="-2812.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2348.11" y="-2801.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2348.11" y="-2790.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;residual1_14 -->
<g id="edge554" class="edge">
<title>agg_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M2373.83,-3095.36C2353.26,-3081.86 2336.11,-3063.3 2336.11,-3038.93 2336.11,-3038.93 2336.11,-3038.93 2336.11,-2880.93 2336.11,-2865.49 2338.55,-2848.51 2341.23,-2834.52"/>
<polygon fill="black" stroke="black" points="2344.71,-2834.98 2343.3,-2824.48 2337.86,-2833.57 2344.71,-2834.98"/>
</g>
<!-- mha_attn_14 -->
<g id="node278" class="node">
<title>mha_attn_14</title>
<polygon fill="lightgreen" stroke="black" points="2477.11,-2980.43 2373.11,-2980.43 2373.11,-2939.43 2477.11,-2939.43 2477.11,-2980.43"/>
<text text-anchor="middle" x="2425.11" y="-2968.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="2425.11" y="-2957.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="2425.11" y="-2946.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge546" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M2495.64,-3017.35C2484.01,-3008.05 2469.94,-2996.79 2457.44,-2986.79"/>
<polygon fill="black" stroke="black" points="2459.48,-2983.95 2449.49,-2980.43 2455.11,-2989.41 2459.48,-2983.95"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge547" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M2584.1,-3019.87C2555.43,-3009.24 2518.18,-2995.43 2486.95,-2983.85"/>
<polygon fill="black" stroke="black" points="2488.06,-2980.53 2477.46,-2980.34 2485.62,-2987.09 2488.06,-2980.53"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge548" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M2413.97,-3017.35C2415.6,-3009.11 2417.53,-2999.34 2419.32,-2990.26"/>
<polygon fill="black" stroke="black" points="2422.76,-2990.92 2421.26,-2980.43 2415.89,-2989.56 2422.76,-2990.92"/>
</g>
<!-- mha_out_14 -->
<g id="node279" class="node">
<title>mha_out_14</title>
<polygon fill="lightgreen" stroke="black" points="2459.11,-2902.43 2367.11,-2902.43 2367.11,-2861.43 2459.11,-2861.43 2459.11,-2902.43"/>
<text text-anchor="middle" x="2413.11" y="-2890.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="2413.11" y="-2879.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2413.11" y="-2868.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge549" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M2422.02,-2939.35C2420.73,-2931.2 2419.21,-2921.55 2417.79,-2912.56"/>
<polygon fill="black" stroke="black" points="2421.2,-2911.76 2416.19,-2902.43 2414.29,-2912.86 2421.2,-2911.76"/>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge555" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M2396.37,-2861.35C2388.79,-2852.49 2379.69,-2841.86 2371.46,-2832.23"/>
<polygon fill="black" stroke="black" points="2373.95,-2829.76 2364.79,-2824.43 2368.63,-2834.31 2373.95,-2829.76"/>
</g>
<!-- ln1_14 -->
<g id="node281" class="node">
<title>ln1_14</title>
<polygon fill="lightpink" stroke="black" points="2394.11,-2746.43 2302.11,-2746.43 2302.11,-2705.43 2394.11,-2705.43 2394.11,-2746.43"/>
<text text-anchor="middle" x="2348.11" y="-2734.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="2348.11" y="-2723.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2348.11" y="-2712.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- residual1_14&#45;&gt;ln1_14 -->
<g id="edge556" class="edge">
<title>residual1_14&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M2348.11,-2783.35C2348.11,-2775.2 2348.11,-2765.55 2348.11,-2756.56"/>
<polygon fill="black" stroke="black" points="2351.61,-2756.43 2348.11,-2746.43 2344.61,-2756.43 2351.61,-2756.43"/>
</g>
<!-- gate_14 -->
<g id="node282" class="node">
<title>gate_14</title>
<polygon fill="gold" stroke="black" points="2348.11,-2668.43 2271.11,-2627.43 2348.11,-2586.43 2425.11,-2627.43 2348.11,-2668.43"/>
<text text-anchor="middle" x="2348.11" y="-2635.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="2348.11" y="-2624.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="2348.11" y="-2613.93" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;gate_14 -->
<g id="edge557" class="edge">
<title>ln1_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M2348.11,-2705.4C2348.11,-2697.63 2348.11,-2688.31 2348.11,-2678.87"/>
<polygon fill="black" stroke="black" points="2351.61,-2678.65 2348.11,-2668.65 2344.61,-2678.65 2351.61,-2678.65"/>
</g>
<!-- expert_14_0 -->
<g id="node283" class="node">
<title>expert_14_0</title>
<polygon fill="lightcoral" stroke="black" points="3085.61,-2535.43 2926.61,-2535.43 2926.61,-2494.43 3085.61,-2494.43 3085.61,-2535.43"/>
<text text-anchor="middle" x="3006.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="3006.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="3006.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_0 -->
<g id="edge560" class="edge">
<title>ln1_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" d="M2394.13,-2722.09C2462.69,-2716.87 2595.03,-2702.92 2702.11,-2668.43 2802.14,-2636.21 2910.02,-2575.08 2966.48,-2540.81"/>
<polygon fill="black" stroke="black" points="2968.38,-2543.75 2975.09,-2535.55 2964.73,-2537.77 2968.38,-2543.75"/>
</g>
<!-- expert_14_1 -->
<g id="node284" class="node">
<title>expert_14_1</title>
<polygon fill="lightcoral" stroke="black" points="2023.61,-2535.43 1864.61,-2535.43 1864.61,-2494.43 2023.61,-2494.43 2023.61,-2535.43"/>
<text text-anchor="middle" x="1944.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1944.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1944.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_1 -->
<g id="edge563" class="edge">
<title>ln1_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" d="M2301.76,-2720.87C2249.41,-2714.89 2162.73,-2700.7 2095.11,-2668.43 2030.59,-2637.63 2013.63,-2624.37 1969.11,-2568.43 1963.51,-2561.39 1958.77,-2552.88 1954.99,-2544.79"/>
<polygon fill="black" stroke="black" points="1958.18,-2543.36 1950.98,-2535.59 1951.76,-2546.16 1958.18,-2543.36"/>
</g>
<!-- expert_14_2 -->
<g id="node285" class="node">
<title>expert_14_2</title>
<polygon fill="lightcoral" stroke="black" points="2200.61,-2535.43 2041.61,-2535.43 2041.61,-2494.43 2200.61,-2494.43 2200.61,-2535.43"/>
<text text-anchor="middle" x="2121.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="2121.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2121.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_2 -->
<g id="edge566" class="edge">
<title>ln1_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" d="M2302.1,-2711.78C2272.34,-2702.17 2233.45,-2687.51 2202.11,-2668.43 2144.82,-2633.55 2116.65,-2629.57 2089.11,-2568.43 2085.45,-2560.31 2087.57,-2551.91 2092.09,-2544.28"/>
<polygon fill="black" stroke="black" points="2095.26,-2545.88 2098.3,-2535.73 2089.59,-2541.76 2095.26,-2545.88"/>
</g>
<!-- expert_14_3 -->
<g id="node286" class="node">
<title>expert_14_3</title>
<polygon fill="lightcoral" stroke="black" points="1846.61,-2535.43 1687.61,-2535.43 1687.61,-2494.43 1846.61,-2494.43 1846.61,-2535.43"/>
<text text-anchor="middle" x="1767.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="1767.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1767.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_3 -->
<g id="edge569" class="edge">
<title>ln1_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" d="M2301.97,-2724.59C2230.59,-2722.6 2090.25,-2712.78 1981.11,-2668.43 1906.93,-2638.28 1833.87,-2577.79 1795.27,-2542.73"/>
<polygon fill="black" stroke="black" points="1797.3,-2539.84 1787.56,-2535.66 1792.56,-2545 1797.3,-2539.84"/>
</g>
<!-- expert_14_4 -->
<g id="node287" class="node">
<title>expert_14_4</title>
<polygon fill="lightcoral" stroke="black" points="2377.61,-2535.43 2218.61,-2535.43 2218.61,-2494.43 2377.61,-2494.43 2377.61,-2535.43"/>
<text text-anchor="middle" x="2298.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="2298.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2298.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_4 -->
<g id="edge572" class="edge">
<title>ln1_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" d="M2310.77,-2705.27C2294.6,-2695.59 2276.19,-2682.89 2262.11,-2668.43 2225.62,-2630.97 2214.43,-2618.72 2200.11,-2568.43 2196.71,-2556.51 2201.18,-2547.27 2209.79,-2540.11"/>
<polygon fill="black" stroke="black" points="2212,-2542.84 2218.32,-2534.34 2208.08,-2537.04 2212,-2542.84"/>
</g>
<!-- expert_14_5 -->
<g id="node288" class="node">
<title>expert_14_5</title>
<polygon fill="lightcoral" stroke="black" points="2908.61,-2535.43 2749.61,-2535.43 2749.61,-2494.43 2908.61,-2494.43 2908.61,-2535.43"/>
<text text-anchor="middle" x="2829.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="2829.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2829.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_5 -->
<g id="edge575" class="edge">
<title>ln1_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" d="M2394.43,-2716.84C2443.33,-2707.65 2522.3,-2690.95 2588.11,-2668.43 2689.34,-2633.78 2732.65,-2645.27 2807.11,-2568.43 2813.39,-2561.95 2817.98,-2553.41 2821.3,-2545.12"/>
<polygon fill="black" stroke="black" points="2824.62,-2546.21 2824.63,-2535.62 2818.02,-2543.9 2824.62,-2546.21"/>
</g>
<!-- expert_14_6 -->
<g id="node289" class="node">
<title>expert_14_6</title>
<polygon fill="lightcoral" stroke="black" points="2554.61,-2535.43 2395.61,-2535.43 2395.61,-2494.43 2554.61,-2494.43 2554.61,-2535.43"/>
<text text-anchor="middle" x="2475.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="2475.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2475.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_6 -->
<g id="edge578" class="edge">
<title>ln1_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" d="M2391.47,-2705.29C2439.03,-2680.97 2512.42,-2634.51 2541.11,-2568.43 2545.66,-2557.94 2541.29,-2548.96 2533.02,-2541.55"/>
<polygon fill="black" stroke="black" points="2534.97,-2538.64 2524.87,-2535.44 2530.77,-2544.24 2534.97,-2538.64"/>
</g>
<!-- expert_14_7 -->
<g id="node290" class="node">
<title>expert_14_7</title>
<polygon fill="lightcoral" stroke="black" points="2731.61,-2535.43 2572.61,-2535.43 2572.61,-2494.43 2731.61,-2494.43 2731.61,-2535.43"/>
<text text-anchor="middle" x="2652.11" y="-2523.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="2652.11" y="-2512.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2652.11" y="-2501.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_14_7 -->
<g id="edge581" class="edge">
<title>ln1_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" d="M2394.32,-2712.03C2426.78,-2702.13 2470.72,-2687.03 2507.11,-2668.43 2576.81,-2632.79 2615.71,-2637.74 2652.11,-2568.43 2655.69,-2561.6 2656.91,-2553.56 2656.93,-2545.84"/>
<polygon fill="black" stroke="black" points="2660.41,-2545.45 2656.33,-2535.68 2653.42,-2545.87 2660.41,-2545.45"/>
</g>
<!-- expert_agg_14 -->
<g id="node291" class="node">
<title>expert_agg_14</title>
<polygon fill="lightyellow" stroke="black" points="2489.88,-2457.43 2326.39,-2457.43 2284.33,-2375.43 2447.83,-2375.43 2489.88,-2457.43"/>
<text text-anchor="middle" x="2387.11" y="-2424.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2387.11" y="-2413.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="2387.11" y="-2402.93" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;expert_agg_14 -->
<g id="edge558" class="edge">
<title>ln1_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2394.4,-2725.66C2585.68,-2727.28 3295.16,-2718.57 3094.11,-2494.43 3053.9,-2449.61 2664.49,-2428.38 2481.38,-2420.82"/>
<polygon fill="black" stroke="black" points="2481.36,-2417.32 2471.22,-2420.4 2481.07,-2424.31 2481.36,-2417.32"/>
</g>
<!-- residual2_14 -->
<g id="node292" class="node">
<title>residual2_14</title>
<polygon fill="lightpink" stroke="black" points="1718.11,-2338.43 1626.11,-2338.43 1626.11,-2297.43 1718.11,-2297.43 1718.11,-2338.43"/>
<text text-anchor="middle" x="1672.11" y="-2326.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1672.11" y="-2315.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1672.11" y="-2304.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;residual2_14 -->
<g id="edge584" class="edge">
<title>ln1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M2301.9,-2723.32C2147.64,-2717.37 1660.11,-2693.41 1660.11,-2628.43 1660.11,-2628.43 1660.11,-2628.43 1660.11,-2415.43 1660.11,-2392.78 1663.4,-2367.37 1666.54,-2348.31"/>
<polygon fill="black" stroke="black" points="1669.99,-2348.88 1668.24,-2338.43 1663.09,-2347.69 1669.99,-2348.88"/>
</g>
<!-- gate_14&#45;&gt;expert_14_0 -->
<g id="edge559" class="edge">
<title>gate_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2407.69,-2618.04C2509.71,-2603.43 2724.56,-2571.58 2916.58,-2535.47"/>
<polygon fill="black" stroke="black" points="2917.4,-2538.88 2926.58,-2533.59 2916.1,-2532 2917.4,-2538.88"/>
<text text-anchor="middle" x="2840.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_14&#45;&gt;expert_14_1 -->
<g id="edge562" class="edge">
<title>gate_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2297.93,-2612.9C2254.55,-2601.19 2190.17,-2583.77 2134.11,-2568.43 2098.06,-2558.56 2058.18,-2547.56 2024.31,-2538.18"/>
<polygon fill="black" stroke="black" points="2025.04,-2534.75 2014.47,-2535.46 2023.17,-2541.5 2025.04,-2534.75"/>
<text text-anchor="middle" x="2165.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_14&#45;&gt;expert_14_2 -->
<g id="edge565" class="edge">
<title>gate_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2308.83,-2607.3C2270.49,-2588.64 2212.02,-2560.18 2170.54,-2539.99"/>
<polygon fill="black" stroke="black" points="2171.96,-2536.79 2161.43,-2535.56 2168.89,-2543.08 2171.96,-2536.79"/>
<text text-anchor="middle" x="2259.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_14&#45;&gt;expert_14_3 -->
<g id="edge568" class="edge">
<title>gate_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2290.56,-2616.96C2224.09,-2605.9 2111.53,-2586.76 2015.11,-2568.43 1946.84,-2555.44 1927.73,-2551 1856.62,-2535.74"/>
<polygon fill="black" stroke="black" points="1857.23,-2532.3 1846.72,-2533.62 1855.77,-2539.14 1857.23,-2532.3"/>
<text text-anchor="middle" x="2046.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_14&#45;&gt;expert_14_4 -->
<g id="edge571" class="edge">
<title>gate_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2324.04,-2598.84C2317.23,-2589.7 2310.49,-2579.12 2306.11,-2568.43 2303.17,-2561.27 2301.31,-2553.17 2300.12,-2545.51"/>
<polygon fill="black" stroke="black" points="2303.58,-2544.96 2298.88,-2535.47 2296.63,-2545.82 2303.58,-2544.96"/>
<text text-anchor="middle" x="2337.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_14&#45;&gt;expert_14_5 -->
<g id="edge574" class="edge">
<title>gate_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2398.27,-2613.05C2456.8,-2597.67 2556.6,-2572.14 2643.11,-2553.43 2683.12,-2544.77 2695.51,-2544.17 2739.64,-2535.47"/>
<polygon fill="black" stroke="black" points="2740.44,-2538.88 2749.56,-2533.49 2739.07,-2532.02 2740.44,-2538.88"/>
<text text-anchor="middle" x="2674.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_14&#45;&gt;expert_14_6 -->
<g id="edge577" class="edge">
<title>gate_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2362.26,-2593.94C2369.57,-2580.06 2379.61,-2564.53 2392.11,-2553.43 2397.55,-2548.59 2403.73,-2544.28 2410.19,-2540.46"/>
<polygon fill="black" stroke="black" points="2412.05,-2543.43 2419.14,-2535.56 2408.69,-2537.29 2412.05,-2543.43"/>
<text text-anchor="middle" x="2423.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_14&#45;&gt;expert_14_7 -->
<g id="edge580" class="edge">
<title>gate_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2385.77,-2606.16C2416.63,-2590.18 2461.79,-2568.2 2503.11,-2553.43 2514.86,-2549.22 2537.93,-2543.08 2562.47,-2536.98"/>
<polygon fill="black" stroke="black" points="2563.43,-2540.35 2572.3,-2534.56 2561.75,-2533.56 2563.43,-2540.35"/>
<text text-anchor="middle" x="2534.61" y="-2557.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_14_0&#45;&gt;expert_agg_14 -->
<g id="edge561" class="edge">
<title>expert_14_0&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2926.59,-2496.21C2923.39,-2495.59 2920.22,-2494.99 2917.11,-2494.43 2767.12,-2467.14 2591.85,-2443.22 2485.21,-2429.55"/>
<polygon fill="black" stroke="black" points="2485.47,-2426.05 2475.11,-2428.26 2484.58,-2432.99 2485.47,-2426.05"/>
</g>
<!-- expert_14_1&#45;&gt;expert_agg_14 -->
<g id="edge564" class="edge">
<title>expert_14_1&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2023.73,-2496.27C2026.56,-2495.64 2029.36,-2495.03 2032.11,-2494.43 2125.07,-2474.05 2231.78,-2450.94 2303.74,-2435.4"/>
<polygon fill="black" stroke="black" points="2304.62,-2438.79 2313.66,-2433.26 2303.14,-2431.95 2304.62,-2438.79"/>
</g>
<!-- expert_14_2&#45;&gt;expert_agg_14 -->
<g id="edge567" class="edge">
<title>expert_14_2&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2174.94,-2494.4C2213.33,-2480.47 2265.55,-2461.53 2308.58,-2445.92"/>
<polygon fill="black" stroke="black" points="2309.97,-2449.14 2318.17,-2442.43 2307.58,-2442.55 2309.97,-2449.14"/>
</g>
<!-- expert_14_3&#45;&gt;expert_agg_14 -->
<g id="edge570" class="edge">
<title>expert_14_3&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M1846.68,-2496.02C1849.52,-2495.47 1852.34,-2494.93 1855.11,-2494.43 2011.41,-2465.84 2195.12,-2441.22 2300.65,-2427.93"/>
<polygon fill="black" stroke="black" points="2301.13,-2431.4 2310.61,-2426.68 2300.25,-2424.45 2301.13,-2431.4"/>
</g>
<!-- expert_14_4&#45;&gt;expert_agg_14 -->
<g id="edge573" class="edge">
<title>expert_14_4&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2316.12,-2494.4C2323.97,-2485.89 2333.54,-2475.51 2343.09,-2465.16"/>
<polygon fill="black" stroke="black" points="2345.8,-2467.38 2350.01,-2457.65 2340.66,-2462.63 2345.8,-2467.38"/>
</g>
<!-- expert_14_5&#45;&gt;expert_agg_14 -->
<g id="edge576" class="edge">
<title>expert_14_5&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2749.53,-2496.49C2746.35,-2495.79 2743.2,-2495.1 2740.11,-2494.43 2656,-2476.04 2560.62,-2455.24 2490.22,-2439.89"/>
<polygon fill="black" stroke="black" points="2490.53,-2436.38 2480.02,-2437.67 2489.04,-2443.22 2490.53,-2436.38"/>
</g>
<!-- expert_14_6&#45;&gt;expert_agg_14 -->
<g id="edge579" class="edge">
<title>expert_14_6&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2457.3,-2494.4C2449.54,-2485.89 2440.07,-2475.51 2430.63,-2465.16"/>
<polygon fill="black" stroke="black" points="2433.11,-2462.68 2423.79,-2457.65 2427.94,-2467.4 2433.11,-2462.68"/>
</g>
<!-- expert_14_7&#45;&gt;expert_agg_14 -->
<g id="edge582" class="edge">
<title>expert_14_7&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2598.48,-2494.4C2569.59,-2483.88 2532.83,-2470.49 2498.1,-2457.84"/>
<polygon fill="black" stroke="black" points="2498.96,-2454.43 2488.36,-2454.3 2496.56,-2461.01 2498.96,-2454.43"/>
</g>
<!-- expert_agg_14&#45;&gt;residual2_14 -->
<g id="edge583" class="edge">
<title>expert_agg_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M2298.72,-2403.5C2149.54,-2383.36 1851.96,-2343.2 1728.16,-2326.49"/>
<polygon fill="black" stroke="black" points="1728.52,-2323.01 1718.14,-2325.14 1727.58,-2329.95 1728.52,-2323.01"/>
</g>
<!-- ln2_14 -->
<g id="node293" class="node">
<title>ln2_14</title>
<polygon fill="lightpink" stroke="black" points="1718.11,-2260.43 1626.11,-2260.43 1626.11,-2219.43 1718.11,-2219.43 1718.11,-2260.43"/>
<text text-anchor="middle" x="1672.11" y="-2248.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1672.11" y="-2237.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1672.11" y="-2226.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- residual2_14&#45;&gt;ln2_14 -->
<g id="edge585" class="edge">
<title>residual2_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M1672.11,-2297.35C1672.11,-2289.2 1672.11,-2279.55 1672.11,-2270.56"/>
<polygon fill="black" stroke="black" points="1675.61,-2270.43 1672.11,-2260.43 1668.61,-2270.43 1675.61,-2270.43"/>
</g>
<!-- split_14 -->
<g id="node294" class="node">
<title>split_14</title>
<polygon fill="lightyellow" stroke="black" points="1837.9,-2182.43 1718.92,-2182.43 1688.31,-2122.43 1807.29,-2122.43 1837.9,-2182.43"/>
<text text-anchor="middle" x="1763.11" y="-2155.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1763.11" y="-2144.43" font-family="Arial" font-size="10.00">GPU 13→14</text>
</g>
<!-- ln2_14&#45;&gt;split_14 -->
<g id="edge586" class="edge">
<title>ln2_14&#45;&gt;split_14</title>
<path fill="none" stroke="black" d="M1693.21,-2219.1C1702.6,-2210.28 1713.95,-2199.61 1724.75,-2189.47"/>
<polygon fill="black" stroke="black" points="1727.22,-2191.95 1732.11,-2182.55 1722.42,-2186.85 1727.22,-2191.95"/>
</g>
<!-- agg_15 -->
<g id="node295" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="1746.9,-2085.43 1627.92,-2085.43 1597.31,-2025.43 1716.29,-2025.43 1746.9,-2085.43"/>
<text text-anchor="middle" x="1672.11" y="-2058.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1672.11" y="-2047.43" font-family="Arial" font-size="10.00">GPU 13→14</text>
</g>
<!-- ln2_14&#45;&gt;agg_15 -->
<g id="edge592" class="edge">
<title>ln2_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1672.11,-2219.4C1672.11,-2190.06 1672.11,-2134.02 1672.11,-2095.93"/>
<polygon fill="black" stroke="black" points="1675.61,-2095.7 1672.11,-2085.7 1668.61,-2095.7 1675.61,-2095.7"/>
</g>
<!-- split_14&#45;&gt;agg_15 -->
<g id="edge587" class="edge">
<title>split_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1735.31,-2122.41C1726.4,-2113.1 1716.41,-2102.68 1707.05,-2092.91"/>
<polygon fill="black" stroke="black" points="1709.49,-2090.4 1700.05,-2085.6 1704.44,-2095.24 1709.49,-2090.4"/>
</g>
<!-- mha_q_15 -->
<g id="node296" class="node">
<title>mha_q_15</title>
<polygon fill="lightgreen" stroke="black" points="1795.11,-1988.43 1703.11,-1988.43 1703.11,-1947.43 1795.11,-1947.43 1795.11,-1988.43"/>
<text text-anchor="middle" x="1749.11" y="-1976.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1749.11" y="-1965.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1749.11" y="-1954.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_q_15 -->
<g id="edge593" class="edge">
<title>agg_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M1698.61,-2025C1707.1,-2015.57 1716.47,-2005.17 1724.8,-1995.92"/>
<polygon fill="black" stroke="black" points="1727.42,-1998.24 1731.51,-1988.46 1722.22,-1993.55 1727.42,-1998.24"/>
</g>
<!-- mha_k_15 -->
<g id="node297" class="node">
<title>mha_k_15</title>
<polygon fill="lightgreen" stroke="black" points="1905.11,-1988.43 1813.11,-1988.43 1813.11,-1947.43 1905.11,-1947.43 1905.11,-1988.43"/>
<text text-anchor="middle" x="1859.11" y="-1976.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1859.11" y="-1965.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1859.11" y="-1954.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_k_15 -->
<g id="edge594" class="edge">
<title>agg_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M1720.26,-2032.41C1746.79,-2020.28 1779.74,-2005.22 1806.88,-1992.81"/>
<polygon fill="black" stroke="black" points="1808.58,-1995.88 1816.22,-1988.54 1805.67,-1989.51 1808.58,-1995.88"/>
</g>
<!-- mha_v_15 -->
<g id="node298" class="node">
<title>mha_v_15</title>
<polygon fill="lightgreen" stroke="black" points="1685.11,-1988.43 1593.11,-1988.43 1593.11,-1947.43 1685.11,-1947.43 1685.11,-1988.43"/>
<text text-anchor="middle" x="1639.11" y="-1976.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1639.11" y="-1965.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1639.11" y="-1954.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_v_15 -->
<g id="edge595" class="edge">
<title>agg_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M1660.75,-2025C1657.36,-2016.23 1653.66,-2006.62 1650.28,-1997.88"/>
<polygon fill="black" stroke="black" points="1653.51,-1996.53 1646.65,-1988.46 1646.98,-1999.05 1653.51,-1996.53"/>
</g>
<!-- residual1_15 -->
<g id="node301" class="node">
<title>residual1_15</title>
<polygon fill="lightpink" stroke="black" points="1623.11,-1754.43 1531.11,-1754.43 1531.11,-1713.43 1623.11,-1713.43 1623.11,-1754.43"/>
<text text-anchor="middle" x="1577.11" y="-1742.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1577.11" y="-1731.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1577.11" y="-1720.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;residual1_15 -->
<g id="edge596" class="edge">
<title>agg_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1602.83,-2025.36C1582.26,-2011.86 1565.11,-1993.3 1565.11,-1968.93 1565.11,-1968.93 1565.11,-1968.93 1565.11,-1810.93 1565.11,-1795.49 1567.55,-1778.51 1570.23,-1764.52"/>
<polygon fill="black" stroke="black" points="1573.71,-1764.98 1572.3,-1754.48 1566.86,-1763.57 1573.71,-1764.98"/>
</g>
<!-- mha_attn_15 -->
<g id="node299" class="node">
<title>mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="1752.11,-1910.43 1648.11,-1910.43 1648.11,-1869.43 1752.11,-1869.43 1752.11,-1910.43"/>
<text text-anchor="middle" x="1700.11" y="-1898.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1700.11" y="-1887.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1700.11" y="-1876.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge588" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1736.49,-1947.35C1730.94,-1938.76 1724.33,-1928.5 1718.27,-1919.1"/>
<polygon fill="black" stroke="black" points="1721.04,-1916.94 1712.68,-1910.43 1715.16,-1920.73 1721.04,-1916.94"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge589" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1818.16,-1947.35C1797.39,-1937.43 1771.98,-1925.28 1750.07,-1914.81"/>
<polygon fill="black" stroke="black" points="1751.45,-1911.59 1740.92,-1910.43 1748.43,-1917.9 1751.45,-1911.59"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge590" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1654.82,-1947.35C1661.86,-1938.58 1670.29,-1928.07 1677.96,-1918.52"/>
<polygon fill="black" stroke="black" points="1680.92,-1920.42 1684.45,-1910.43 1675.46,-1916.04 1680.92,-1920.42"/>
</g>
<!-- mha_out_15 -->
<g id="node300" class="node">
<title>mha_out_15</title>
<polygon fill="lightgreen" stroke="black" points="1697.11,-1832.43 1605.11,-1832.43 1605.11,-1791.43 1697.11,-1791.43 1697.11,-1832.43"/>
<text text-anchor="middle" x="1651.11" y="-1820.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1651.11" y="-1809.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1651.11" y="-1798.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge591" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M1687.49,-1869.35C1681.94,-1860.76 1675.33,-1850.5 1669.27,-1841.1"/>
<polygon fill="black" stroke="black" points="1672.04,-1838.94 1663.68,-1832.43 1666.16,-1842.73 1672.04,-1838.94"/>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge597" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1632.05,-1791.35C1623.25,-1782.31 1612.65,-1771.43 1603.13,-1761.65"/>
<polygon fill="black" stroke="black" points="1605.58,-1759.16 1596.1,-1754.43 1600.57,-1764.04 1605.58,-1759.16"/>
</g>
<!-- ln1_15 -->
<g id="node302" class="node">
<title>ln1_15</title>
<polygon fill="lightpink" stroke="black" points="1623.11,-1676.43 1531.11,-1676.43 1531.11,-1635.43 1623.11,-1635.43 1623.11,-1676.43"/>
<text text-anchor="middle" x="1577.11" y="-1664.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1577.11" y="-1653.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1577.11" y="-1642.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- residual1_15&#45;&gt;ln1_15 -->
<g id="edge598" class="edge">
<title>residual1_15&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M1577.11,-1713.35C1577.11,-1705.2 1577.11,-1695.55 1577.11,-1686.56"/>
<polygon fill="black" stroke="black" points="1580.61,-1686.43 1577.11,-1676.43 1573.61,-1686.43 1580.61,-1686.43"/>
</g>
<!-- gate_15 -->
<g id="node303" class="node">
<title>gate_15</title>
<polygon fill="gold" stroke="black" points="1577.11,-1598.43 1500.11,-1557.43 1577.11,-1516.43 1654.11,-1557.43 1577.11,-1598.43"/>
<text text-anchor="middle" x="1577.11" y="-1565.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="1577.11" y="-1554.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="1577.11" y="-1543.93" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;gate_15 -->
<g id="edge599" class="edge">
<title>ln1_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M1577.11,-1635.4C1577.11,-1627.63 1577.11,-1618.31 1577.11,-1608.87"/>
<polygon fill="black" stroke="black" points="1580.61,-1608.65 1577.11,-1598.65 1573.61,-1608.65 1580.61,-1608.65"/>
</g>
<!-- expert_15_0 -->
<g id="node304" class="node">
<title>expert_15_0</title>
<polygon fill="lightcoral" stroke="black" points="2314.61,-1465.43 2155.61,-1465.43 2155.61,-1424.43 2314.61,-1424.43 2314.61,-1465.43"/>
<text text-anchor="middle" x="2235.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="2235.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2235.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_0 -->
<g id="edge602" class="edge">
<title>ln1_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" d="M1623.16,-1651.71C1690.42,-1646.05 1818.86,-1631.62 1923.11,-1598.43 2025.35,-1565.87 2136.23,-1504.87 2194.32,-1470.72"/>
<polygon fill="black" stroke="black" points="2196.36,-1473.58 2203.18,-1465.47 2192.79,-1467.55 2196.36,-1473.58"/>
</g>
<!-- expert_15_1 -->
<g id="node305" class="node">
<title>expert_15_1</title>
<polygon fill="lightcoral" stroke="black" points="1252.61,-1465.43 1093.61,-1465.43 1093.61,-1424.43 1252.61,-1424.43 1252.61,-1465.43"/>
<text text-anchor="middle" x="1173.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="1173.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1173.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_1 -->
<g id="edge605" class="edge">
<title>ln1_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" d="M1530.93,-1650.5C1478.75,-1644.19 1392.21,-1629.69 1324.11,-1598.43 1256.57,-1567.42 1233.37,-1558.85 1190.11,-1498.43 1185.21,-1491.58 1181.67,-1483.25 1179.13,-1475.25"/>
<polygon fill="black" stroke="black" points="1182.46,-1474.16 1176.43,-1465.45 1175.71,-1476.02 1182.46,-1474.16"/>
</g>
<!-- expert_15_2 -->
<g id="node306" class="node">
<title>expert_15_2</title>
<polygon fill="lightcoral" stroke="black" points="1429.61,-1465.43 1270.61,-1465.43 1270.61,-1424.43 1429.61,-1424.43 1429.61,-1465.43"/>
<text text-anchor="middle" x="1350.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="1350.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1350.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_2 -->
<g id="edge608" class="edge">
<title>ln1_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" d="M1531.1,-1641.78C1501.34,-1632.17 1462.45,-1617.51 1431.11,-1598.43 1373.82,-1563.55 1345.65,-1559.57 1318.11,-1498.43 1314.45,-1490.31 1316.57,-1481.91 1321.09,-1474.28"/>
<polygon fill="black" stroke="black" points="1324.26,-1475.88 1327.3,-1465.73 1318.59,-1471.76 1324.26,-1475.88"/>
</g>
<!-- expert_15_3 -->
<g id="node307" class="node">
<title>expert_15_3</title>
<polygon fill="lightcoral" stroke="black" points="1075.61,-1465.43 916.61,-1465.43 916.61,-1424.43 1075.61,-1424.43 1075.61,-1465.43"/>
<text text-anchor="middle" x="996.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="996.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="996.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_3 -->
<g id="edge611" class="edge">
<title>ln1_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" d="M1531.09,-1655.16C1458.08,-1654 1312.49,-1645.33 1200.11,-1598.43 1128.29,-1568.46 1058.81,-1507.63 1022.39,-1472.53"/>
<polygon fill="black" stroke="black" points="1024.74,-1469.92 1015.13,-1465.45 1019.85,-1474.93 1024.74,-1469.92"/>
</g>
<!-- expert_15_4 -->
<g id="node308" class="node">
<title>expert_15_4</title>
<polygon fill="lightcoral" stroke="black" points="1606.61,-1465.43 1447.61,-1465.43 1447.61,-1424.43 1606.61,-1424.43 1606.61,-1465.43"/>
<text text-anchor="middle" x="1527.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1527.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1527.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_4 -->
<g id="edge614" class="edge">
<title>ln1_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" d="M1539.77,-1635.27C1523.6,-1625.59 1505.19,-1612.89 1491.11,-1598.43 1454.62,-1560.97 1443.43,-1548.72 1429.11,-1498.43 1425.71,-1486.51 1430.18,-1477.27 1438.79,-1470.11"/>
<polygon fill="black" stroke="black" points="1441,-1472.84 1447.32,-1464.34 1437.08,-1467.04 1441,-1472.84"/>
</g>
<!-- expert_15_5 -->
<g id="node309" class="node">
<title>expert_15_5</title>
<polygon fill="lightcoral" stroke="black" points="2137.61,-1465.43 1978.61,-1465.43 1978.61,-1424.43 2137.61,-1424.43 2137.61,-1465.43"/>
<text text-anchor="middle" x="2058.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="2058.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="2058.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_5 -->
<g id="edge617" class="edge">
<title>ln1_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" d="M1623.2,-1648.61C1708.75,-1634.86 1894.33,-1595.32 2015.11,-1498.43 2023.88,-1491.39 2032.09,-1482.29 2038.94,-1473.66"/>
<polygon fill="black" stroke="black" points="2041.8,-1475.68 2045.06,-1465.61 2036.22,-1471.45 2041.8,-1475.68"/>
</g>
<!-- expert_15_6 -->
<g id="node310" class="node">
<title>expert_15_6</title>
<polygon fill="lightcoral" stroke="black" points="1783.61,-1465.43 1624.61,-1465.43 1624.61,-1424.43 1783.61,-1424.43 1783.61,-1465.43"/>
<text text-anchor="middle" x="1704.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1704.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1704.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_6 -->
<g id="edge620" class="edge">
<title>ln1_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" d="M1620.47,-1635.29C1668.03,-1610.97 1741.42,-1564.51 1770.11,-1498.43 1774.66,-1487.94 1770.29,-1478.96 1762.02,-1471.55"/>
<polygon fill="black" stroke="black" points="1763.97,-1468.64 1753.87,-1465.44 1759.77,-1474.24 1763.97,-1468.64"/>
</g>
<!-- expert_15_7 -->
<g id="node311" class="node">
<title>expert_15_7</title>
<polygon fill="lightcoral" stroke="black" points="1960.61,-1465.43 1801.61,-1465.43 1801.61,-1424.43 1960.61,-1424.43 1960.61,-1465.43"/>
<text text-anchor="middle" x="1881.11" y="-1453.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1881.11" y="-1442.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1881.11" y="-1431.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_15_7 -->
<g id="edge623" class="edge">
<title>ln1_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" d="M1623.32,-1642.03C1655.78,-1632.13 1699.72,-1617.03 1736.11,-1598.43 1805.81,-1562.79 1844.71,-1567.74 1881.11,-1498.43 1884.69,-1491.6 1885.91,-1483.56 1885.93,-1475.84"/>
<polygon fill="black" stroke="black" points="1889.41,-1475.45 1885.33,-1465.68 1882.42,-1475.87 1889.41,-1475.45"/>
</g>
<!-- expert_agg_15 -->
<g id="node312" class="node">
<title>expert_agg_15</title>
<polygon fill="lightyellow" stroke="black" points="1718.88,-1387.43 1555.39,-1387.43 1513.33,-1305.43 1676.83,-1305.43 1718.88,-1387.43"/>
<text text-anchor="middle" x="1616.11" y="-1354.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1616.11" y="-1343.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1616.11" y="-1332.93" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;expert_agg_15 -->
<g id="edge600" class="edge">
<title>ln1_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1623.4,-1655.66C1814.68,-1657.28 2524.16,-1648.57 2323.11,-1424.43 2282.9,-1379.61 1893.49,-1358.38 1710.38,-1350.82"/>
<polygon fill="black" stroke="black" points="1710.36,-1347.32 1700.22,-1350.4 1710.07,-1354.31 1710.36,-1347.32"/>
</g>
<!-- residual2_15 -->
<g id="node313" class="node">
<title>residual2_15</title>
<polygon fill="lightpink" stroke="black" points="947.11,-1268.43 855.11,-1268.43 855.11,-1227.43 947.11,-1227.43 947.11,-1268.43"/>
<text text-anchor="middle" x="901.11" y="-1256.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="901.11" y="-1245.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="901.11" y="-1234.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;residual2_15 -->
<g id="edge626" class="edge">
<title>ln1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1530.9,-1653.32C1376.64,-1647.37 889.11,-1623.41 889.11,-1558.43 889.11,-1558.43 889.11,-1558.43 889.11,-1345.43 889.11,-1322.78 892.4,-1297.37 895.54,-1278.31"/>
<polygon fill="black" stroke="black" points="898.99,-1278.88 897.24,-1268.43 892.09,-1277.69 898.99,-1278.88"/>
</g>
<!-- gate_15&#45;&gt;expert_15_0 -->
<g id="edge601" class="edge">
<title>gate_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1636.69,-1548.04C1738.71,-1533.43 1953.56,-1501.58 2145.58,-1465.47"/>
<polygon fill="black" stroke="black" points="2146.4,-1468.88 2155.58,-1463.59 2145.1,-1462 2146.4,-1468.88"/>
<text text-anchor="middle" x="2069.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_15&#45;&gt;expert_15_1 -->
<g id="edge604" class="edge">
<title>gate_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1526.93,-1542.9C1483.55,-1531.19 1419.17,-1513.77 1363.11,-1498.43 1327.06,-1488.56 1287.18,-1477.56 1253.31,-1468.18"/>
<polygon fill="black" stroke="black" points="1254.04,-1464.75 1243.47,-1465.46 1252.17,-1471.5 1254.04,-1464.75"/>
<text text-anchor="middle" x="1394.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_15&#45;&gt;expert_15_2 -->
<g id="edge607" class="edge">
<title>gate_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1537.83,-1537.3C1499.49,-1518.64 1441.02,-1490.18 1399.54,-1469.99"/>
<polygon fill="black" stroke="black" points="1400.96,-1466.79 1390.43,-1465.56 1397.89,-1473.08 1400.96,-1466.79"/>
<text text-anchor="middle" x="1488.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_15&#45;&gt;expert_15_3 -->
<g id="edge610" class="edge">
<title>gate_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1519.56,-1546.96C1453.09,-1535.9 1340.53,-1516.76 1244.11,-1498.43 1175.84,-1485.44 1156.73,-1481 1085.62,-1465.74"/>
<polygon fill="black" stroke="black" points="1086.23,-1462.3 1075.72,-1463.62 1084.77,-1469.14 1086.23,-1462.3"/>
<text text-anchor="middle" x="1275.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_15&#45;&gt;expert_15_4 -->
<g id="edge613" class="edge">
<title>gate_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1553.04,-1528.84C1546.23,-1519.7 1539.49,-1509.12 1535.11,-1498.43 1532.17,-1491.27 1530.31,-1483.17 1529.12,-1475.51"/>
<polygon fill="black" stroke="black" points="1532.58,-1474.96 1527.88,-1465.47 1525.63,-1475.82 1532.58,-1474.96"/>
<text text-anchor="middle" x="1566.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_15&#45;&gt;expert_15_5 -->
<g id="edge616" class="edge">
<title>gate_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1627.33,-1543.09C1671.52,-1531.35 1737.59,-1513.78 1795.11,-1498.43 1820,-1491.78 1825.89,-1488.71 1851.11,-1483.43 1900.09,-1473.16 1915.25,-1474.86 1968.55,-1465.44"/>
<polygon fill="black" stroke="black" points="1969.37,-1468.85 1978.58,-1463.62 1968.12,-1461.96 1969.37,-1468.85"/>
<text text-anchor="middle" x="1882.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_15&#45;&gt;expert_15_6 -->
<g id="edge619" class="edge">
<title>gate_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1591.26,-1523.94C1598.57,-1510.06 1608.61,-1494.53 1621.11,-1483.43 1626.55,-1478.59 1632.73,-1474.28 1639.19,-1470.46"/>
<polygon fill="black" stroke="black" points="1641.05,-1473.43 1648.14,-1465.56 1637.69,-1467.29 1641.05,-1473.43"/>
<text text-anchor="middle" x="1652.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_15&#45;&gt;expert_15_7 -->
<g id="edge622" class="edge">
<title>gate_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1614.77,-1536.16C1645.63,-1520.18 1690.79,-1498.2 1732.11,-1483.43 1743.86,-1479.22 1766.93,-1473.08 1791.47,-1466.98"/>
<polygon fill="black" stroke="black" points="1792.43,-1470.35 1801.3,-1464.56 1790.75,-1463.56 1792.43,-1470.35"/>
<text text-anchor="middle" x="1763.61" y="-1487.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_15_0&#45;&gt;expert_agg_15 -->
<g id="edge603" class="edge">
<title>expert_15_0&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2155.59,-1426.21C2152.39,-1425.59 2149.22,-1424.99 2146.11,-1424.43 1996.12,-1397.14 1820.85,-1373.22 1714.21,-1359.55"/>
<polygon fill="black" stroke="black" points="1714.47,-1356.05 1704.11,-1358.26 1713.58,-1362.99 1714.47,-1356.05"/>
</g>
<!-- expert_15_1&#45;&gt;expert_agg_15 -->
<g id="edge606" class="edge">
<title>expert_15_1&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1252.73,-1426.27C1255.56,-1425.64 1258.36,-1425.03 1261.11,-1424.43 1354.07,-1404.05 1460.78,-1380.94 1532.74,-1365.4"/>
<polygon fill="black" stroke="black" points="1533.62,-1368.79 1542.66,-1363.26 1532.14,-1361.95 1533.62,-1368.79"/>
</g>
<!-- expert_15_2&#45;&gt;expert_agg_15 -->
<g id="edge609" class="edge">
<title>expert_15_2&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1403.94,-1424.4C1442.33,-1410.47 1494.55,-1391.53 1537.58,-1375.92"/>
<polygon fill="black" stroke="black" points="1538.97,-1379.14 1547.17,-1372.43 1536.58,-1372.55 1538.97,-1379.14"/>
</g>
<!-- expert_15_3&#45;&gt;expert_agg_15 -->
<g id="edge612" class="edge">
<title>expert_15_3&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1075.68,-1426.02C1078.52,-1425.47 1081.34,-1424.93 1084.11,-1424.43 1240.41,-1395.84 1424.12,-1371.22 1529.65,-1357.93"/>
<polygon fill="black" stroke="black" points="1530.13,-1361.4 1539.61,-1356.68 1529.25,-1354.45 1530.13,-1361.4"/>
</g>
<!-- expert_15_4&#45;&gt;expert_agg_15 -->
<g id="edge615" class="edge">
<title>expert_15_4&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1545.12,-1424.4C1552.97,-1415.89 1562.54,-1405.51 1572.09,-1395.16"/>
<polygon fill="black" stroke="black" points="1574.8,-1397.38 1579.01,-1387.65 1569.66,-1392.63 1574.8,-1397.38"/>
</g>
<!-- expert_15_5&#45;&gt;expert_agg_15 -->
<g id="edge618" class="edge">
<title>expert_15_5&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1978.53,-1426.49C1975.35,-1425.79 1972.2,-1425.1 1969.11,-1424.43 1885,-1406.04 1789.62,-1385.24 1719.22,-1369.89"/>
<polygon fill="black" stroke="black" points="1719.53,-1366.38 1709.02,-1367.67 1718.04,-1373.22 1719.53,-1366.38"/>
</g>
<!-- expert_15_6&#45;&gt;expert_agg_15 -->
<g id="edge621" class="edge">
<title>expert_15_6&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1686.3,-1424.4C1678.54,-1415.89 1669.07,-1405.51 1659.63,-1395.16"/>
<polygon fill="black" stroke="black" points="1662.11,-1392.68 1652.79,-1387.65 1656.94,-1397.4 1662.11,-1392.68"/>
</g>
<!-- expert_15_7&#45;&gt;expert_agg_15 -->
<g id="edge624" class="edge">
<title>expert_15_7&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M1827.48,-1424.4C1798.59,-1413.88 1761.83,-1400.49 1727.1,-1387.84"/>
<polygon fill="black" stroke="black" points="1727.96,-1384.43 1717.36,-1384.3 1725.56,-1391.01 1727.96,-1384.43"/>
</g>
<!-- expert_agg_15&#45;&gt;residual2_15 -->
<g id="edge625" class="edge">
<title>expert_agg_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1527.72,-1333.5C1378.54,-1313.36 1080.96,-1273.2 957.16,-1256.49"/>
<polygon fill="black" stroke="black" points="957.52,-1253.01 947.14,-1255.14 956.58,-1259.95 957.52,-1253.01"/>
</g>
<!-- ln2_15 -->
<g id="node314" class="node">
<title>ln2_15</title>
<polygon fill="lightpink" stroke="black" points="947.11,-1190.43 855.11,-1190.43 855.11,-1149.43 947.11,-1149.43 947.11,-1190.43"/>
<text text-anchor="middle" x="901.11" y="-1178.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="901.11" y="-1167.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="901.11" y="-1156.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- residual2_15&#45;&gt;ln2_15 -->
<g id="edge627" class="edge">
<title>residual2_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M901.11,-1227.35C901.11,-1219.2 901.11,-1209.55 901.11,-1200.56"/>
<polygon fill="black" stroke="black" points="904.61,-1200.43 901.11,-1190.43 897.61,-1200.43 904.61,-1200.43"/>
</g>
<!-- split_15 -->
<g id="node315" class="node">
<title>split_15</title>
<polygon fill="lightyellow" stroke="black" points="1066.9,-1112.43 947.92,-1112.43 917.31,-1052.43 1036.29,-1052.43 1066.9,-1112.43"/>
<text text-anchor="middle" x="992.11" y="-1085.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="992.11" y="-1074.43" font-family="Arial" font-size="10.00">GPU 14→15</text>
</g>
<!-- ln2_15&#45;&gt;split_15 -->
<g id="edge628" class="edge">
<title>ln2_15&#45;&gt;split_15</title>
<path fill="none" stroke="black" d="M922.21,-1149.1C931.6,-1140.28 942.95,-1129.61 953.75,-1119.47"/>
<polygon fill="black" stroke="black" points="956.22,-1121.95 961.11,-1112.55 951.42,-1116.85 956.22,-1121.95"/>
</g>
<!-- agg_16 -->
<g id="node316" class="node">
<title>agg_16</title>
<polygon fill="lightyellow" stroke="black" points="975.9,-1015.43 856.92,-1015.43 826.31,-955.43 945.29,-955.43 975.9,-1015.43"/>
<text text-anchor="middle" x="901.11" y="-988.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="901.11" y="-977.43" font-family="Arial" font-size="10.00">GPU 14→15</text>
</g>
<!-- ln2_15&#45;&gt;agg_16 -->
<g id="edge634" class="edge">
<title>ln2_15&#45;&gt;agg_16</title>
<path fill="none" stroke="black" d="M901.11,-1149.4C901.11,-1120.06 901.11,-1064.02 901.11,-1025.93"/>
<polygon fill="black" stroke="black" points="904.61,-1025.7 901.11,-1015.7 897.61,-1025.7 904.61,-1025.7"/>
</g>
<!-- split_15&#45;&gt;agg_16 -->
<g id="edge629" class="edge">
<title>split_15&#45;&gt;agg_16</title>
<path fill="none" stroke="black" d="M964.31,-1052.41C955.4,-1043.1 945.41,-1032.68 936.05,-1022.91"/>
<polygon fill="black" stroke="black" points="938.49,-1020.4 929.05,-1015.6 933.44,-1025.24 938.49,-1020.4"/>
</g>
<!-- mha_q_16 -->
<g id="node317" class="node">
<title>mha_q_16</title>
<polygon fill="lightgreen" stroke="black" points="1024.11,-918.43 932.11,-918.43 932.11,-877.43 1024.11,-877.43 1024.11,-918.43"/>
<text text-anchor="middle" x="978.11" y="-906.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="978.11" y="-895.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="978.11" y="-884.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_q_16 -->
<g id="edge635" class="edge">
<title>agg_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M927.61,-955C936.1,-945.57 945.47,-935.17 953.8,-925.92"/>
<polygon fill="black" stroke="black" points="956.42,-928.24 960.51,-918.46 951.22,-923.55 956.42,-928.24"/>
</g>
<!-- mha_k_16 -->
<g id="node318" class="node">
<title>mha_k_16</title>
<polygon fill="lightgreen" stroke="black" points="1134.11,-918.43 1042.11,-918.43 1042.11,-877.43 1134.11,-877.43 1134.11,-918.43"/>
<text text-anchor="middle" x="1088.11" y="-906.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1088.11" y="-895.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1088.11" y="-884.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_k_16 -->
<g id="edge636" class="edge">
<title>agg_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M949.26,-962.41C975.79,-950.28 1008.74,-935.22 1035.88,-922.81"/>
<polygon fill="black" stroke="black" points="1037.58,-925.88 1045.22,-918.54 1034.67,-919.51 1037.58,-925.88"/>
</g>
<!-- mha_v_16 -->
<g id="node319" class="node">
<title>mha_v_16</title>
<polygon fill="lightgreen" stroke="black" points="914.11,-918.43 822.11,-918.43 822.11,-877.43 914.11,-877.43 914.11,-918.43"/>
<text text-anchor="middle" x="868.11" y="-906.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="868.11" y="-895.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="868.11" y="-884.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_v_16 -->
<g id="edge637" class="edge">
<title>agg_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M889.75,-955C886.36,-946.23 882.66,-936.62 879.28,-927.88"/>
<polygon fill="black" stroke="black" points="882.51,-926.53 875.65,-918.46 875.98,-929.05 882.51,-926.53"/>
</g>
<!-- residual1_16 -->
<g id="node322" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="852.11,-684.43 760.11,-684.43 760.11,-643.43 852.11,-643.43 852.11,-684.43"/>
<text text-anchor="middle" x="806.11" y="-672.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="806.11" y="-661.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="806.11" y="-650.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;residual1_16 -->
<g id="edge638" class="edge">
<title>agg_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M831.83,-955.36C811.26,-941.86 794.11,-923.3 794.11,-898.93 794.11,-898.93 794.11,-898.93 794.11,-740.93 794.11,-725.49 796.55,-708.51 799.23,-694.52"/>
<polygon fill="black" stroke="black" points="802.71,-694.98 801.3,-684.48 795.86,-693.57 802.71,-694.98"/>
</g>
<!-- mha_attn_16 -->
<g id="node320" class="node">
<title>mha_attn_16</title>
<polygon fill="lightgreen" stroke="black" points="935.11,-840.43 831.11,-840.43 831.11,-799.43 935.11,-799.43 935.11,-840.43"/>
<text text-anchor="middle" x="883.11" y="-828.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="883.11" y="-817.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="883.11" y="-806.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge630" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M953.64,-877.35C942.01,-868.05 927.94,-856.79 915.44,-846.79"/>
<polygon fill="black" stroke="black" points="917.48,-843.95 907.49,-840.43 913.11,-849.41 917.48,-843.95"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge631" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1042.1,-879.87C1013.43,-869.24 976.18,-855.43 944.95,-843.85"/>
<polygon fill="black" stroke="black" points="946.06,-840.53 935.46,-840.34 943.62,-847.09 946.06,-840.53"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge632" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M871.97,-877.35C873.6,-869.11 875.53,-859.34 877.32,-850.26"/>
<polygon fill="black" stroke="black" points="880.76,-850.92 879.26,-840.43 873.89,-849.56 880.76,-850.92"/>
</g>
<!-- mha_out_16 -->
<g id="node321" class="node">
<title>mha_out_16</title>
<polygon fill="lightgreen" stroke="black" points="917.11,-762.43 825.11,-762.43 825.11,-721.43 917.11,-721.43 917.11,-762.43"/>
<text text-anchor="middle" x="871.11" y="-750.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="871.11" y="-739.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="871.11" y="-728.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge633" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M880.02,-799.35C878.73,-791.2 877.21,-781.55 875.79,-772.56"/>
<polygon fill="black" stroke="black" points="879.2,-771.76 874.19,-762.43 872.29,-772.86 879.2,-771.76"/>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge639" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M854.37,-721.35C846.79,-712.49 837.69,-701.86 829.46,-692.23"/>
<polygon fill="black" stroke="black" points="831.95,-689.76 822.79,-684.43 826.63,-694.31 831.95,-689.76"/>
</g>
<!-- ln1_16 -->
<g id="node323" class="node">
<title>ln1_16</title>
<polygon fill="lightpink" stroke="black" points="852.11,-606.43 760.11,-606.43 760.11,-565.43 852.11,-565.43 852.11,-606.43"/>
<text text-anchor="middle" x="806.11" y="-594.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="806.11" y="-583.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="806.11" y="-572.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- residual1_16&#45;&gt;ln1_16 -->
<g id="edge640" class="edge">
<title>residual1_16&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M806.11,-643.35C806.11,-635.2 806.11,-625.55 806.11,-616.56"/>
<polygon fill="black" stroke="black" points="809.61,-616.43 806.11,-606.43 802.61,-616.43 809.61,-616.43"/>
</g>
<!-- gate_16 -->
<g id="node324" class="node">
<title>gate_16</title>
<polygon fill="gold" stroke="black" points="806.11,-528.43 729.11,-487.43 806.11,-446.43 883.11,-487.43 806.11,-528.43"/>
<text text-anchor="middle" x="806.11" y="-495.93" font-family="Arial" font-size="10.00">MoE Gate</text>
<text text-anchor="middle" x="806.11" y="-484.93" font-family="Arial" font-size="10.00">[1024×512×8]</text>
<text text-anchor="middle" x="806.11" y="-473.93" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;gate_16 -->
<g id="edge641" class="edge">
<title>ln1_16&#45;&gt;gate_16</title>
<path fill="none" stroke="black" d="M806.11,-565.4C806.11,-557.63 806.11,-548.31 806.11,-538.87"/>
<polygon fill="black" stroke="black" points="809.61,-538.65 806.11,-528.65 802.61,-538.65 809.61,-538.65"/>
</g>
<!-- expert_16_0 -->
<g id="node325" class="node">
<title>expert_16_0</title>
<polygon fill="lightcoral" stroke="black" points="1543.61,-395.43 1384.61,-395.43 1384.61,-354.43 1543.61,-354.43 1543.61,-395.43"/>
<text text-anchor="middle" x="1464.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="1464.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1464.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_0 -->
<g id="edge644" class="edge">
<title>ln1_16&#45;&gt;expert_16_0</title>
<path fill="none" stroke="black" d="M852.16,-581.71C919.42,-576.05 1047.86,-561.62 1152.11,-528.43 1254.35,-495.87 1365.23,-434.87 1423.32,-400.72"/>
<polygon fill="black" stroke="black" points="1425.36,-403.58 1432.18,-395.47 1421.79,-397.55 1425.36,-403.58"/>
</g>
<!-- expert_16_1 -->
<g id="node326" class="node">
<title>expert_16_1</title>
<polygon fill="lightcoral" stroke="black" points="481.61,-395.43 322.61,-395.43 322.61,-354.43 481.61,-354.43 481.61,-395.43"/>
<text text-anchor="middle" x="402.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="402.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="402.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_1 -->
<g id="edge647" class="edge">
<title>ln1_16&#45;&gt;expert_16_1</title>
<path fill="none" stroke="black" d="M759.93,-580.5C707.75,-574.19 621.21,-559.69 553.11,-528.43 485.57,-497.42 462.37,-488.85 419.11,-428.43 414.21,-421.58 410.67,-413.25 408.13,-405.25"/>
<polygon fill="black" stroke="black" points="411.46,-404.16 405.43,-395.45 404.71,-406.02 411.46,-404.16"/>
</g>
<!-- expert_16_2 -->
<g id="node327" class="node">
<title>expert_16_2</title>
<polygon fill="lightcoral" stroke="black" points="658.61,-395.43 499.61,-395.43 499.61,-354.43 658.61,-354.43 658.61,-395.43"/>
<text text-anchor="middle" x="579.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="579.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="579.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_2 -->
<g id="edge650" class="edge">
<title>ln1_16&#45;&gt;expert_16_2</title>
<path fill="none" stroke="black" d="M760.1,-571.78C730.34,-562.17 691.45,-547.51 660.11,-528.43 602.82,-493.55 574.65,-489.57 547.11,-428.43 543.45,-420.31 545.57,-411.91 550.09,-404.28"/>
<polygon fill="black" stroke="black" points="553.26,-405.88 556.3,-395.73 547.59,-401.76 553.26,-405.88"/>
</g>
<!-- expert_16_3 -->
<g id="node328" class="node">
<title>expert_16_3</title>
<polygon fill="lightcoral" stroke="black" points="304.61,-395.43 145.61,-395.43 145.61,-354.43 304.61,-354.43 304.61,-395.43"/>
<text text-anchor="middle" x="225.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="225.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="225.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_3 -->
<g id="edge653" class="edge">
<title>ln1_16&#45;&gt;expert_16_3</title>
<path fill="none" stroke="black" d="M760.09,-585.16C687.08,-584 541.49,-575.33 429.11,-528.43 357.29,-498.46 287.81,-437.63 251.39,-402.53"/>
<polygon fill="black" stroke="black" points="253.74,-399.92 244.13,-395.45 248.85,-404.93 253.74,-399.92"/>
</g>
<!-- expert_16_4 -->
<g id="node329" class="node">
<title>expert_16_4</title>
<polygon fill="lightcoral" stroke="black" points="835.61,-395.43 676.61,-395.43 676.61,-354.43 835.61,-354.43 835.61,-395.43"/>
<text text-anchor="middle" x="756.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="756.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="756.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_4 -->
<g id="edge656" class="edge">
<title>ln1_16&#45;&gt;expert_16_4</title>
<path fill="none" stroke="black" d="M768.77,-565.27C752.6,-555.59 734.19,-542.89 720.11,-528.43 683.62,-490.97 672.43,-478.72 658.11,-428.43 654.71,-416.51 659.18,-407.27 667.79,-400.11"/>
<polygon fill="black" stroke="black" points="670,-402.84 676.32,-394.34 666.08,-397.04 670,-402.84"/>
</g>
<!-- expert_16_5 -->
<g id="node330" class="node">
<title>expert_16_5</title>
<polygon fill="lightcoral" stroke="black" points="1366.61,-395.43 1207.61,-395.43 1207.61,-354.43 1366.61,-354.43 1366.61,-395.43"/>
<text text-anchor="middle" x="1287.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1287.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1287.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_5 -->
<g id="edge659" class="edge">
<title>ln1_16&#45;&gt;expert_16_5</title>
<path fill="none" stroke="black" d="M852.2,-578.61C937.75,-564.86 1123.33,-525.32 1244.11,-428.43 1252.88,-421.39 1261.09,-412.29 1267.94,-403.66"/>
<polygon fill="black" stroke="black" points="1270.8,-405.68 1274.06,-395.61 1265.22,-401.45 1270.8,-405.68"/>
</g>
<!-- expert_16_6 -->
<g id="node331" class="node">
<title>expert_16_6</title>
<polygon fill="lightcoral" stroke="black" points="1012.61,-395.43 853.61,-395.43 853.61,-354.43 1012.61,-354.43 1012.61,-395.43"/>
<text text-anchor="middle" x="933.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="933.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="933.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_6 -->
<g id="edge662" class="edge">
<title>ln1_16&#45;&gt;expert_16_6</title>
<path fill="none" stroke="black" d="M849.47,-565.29C897.03,-540.97 970.42,-494.51 999.11,-428.43 1003.66,-417.94 999.29,-408.96 991.02,-401.55"/>
<polygon fill="black" stroke="black" points="992.97,-398.64 982.87,-395.44 988.77,-404.24 992.97,-398.64"/>
</g>
<!-- expert_16_7 -->
<g id="node332" class="node">
<title>expert_16_7</title>
<polygon fill="lightcoral" stroke="black" points="1189.61,-395.43 1030.61,-395.43 1030.61,-354.43 1189.61,-354.43 1189.61,-395.43"/>
<text text-anchor="middle" x="1110.11" y="-383.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1110.11" y="-372.43" font-family="Arial" font-size="10.00">[1024×512×8192→32768→8192]</text>
<text text-anchor="middle" x="1110.11" y="-361.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_16_7 -->
<g id="edge665" class="edge">
<title>ln1_16&#45;&gt;expert_16_7</title>
<path fill="none" stroke="black" d="M852.32,-572.03C884.78,-562.13 928.72,-547.03 965.11,-528.43 1034.81,-492.79 1073.71,-497.74 1110.11,-428.43 1113.69,-421.6 1114.91,-413.56 1114.93,-405.84"/>
<polygon fill="black" stroke="black" points="1118.41,-405.45 1114.33,-395.68 1111.42,-405.87 1118.41,-405.45"/>
</g>
<!-- expert_agg_16 -->
<g id="node333" class="node">
<title>expert_agg_16</title>
<polygon fill="lightyellow" stroke="black" points="947.88,-317.43 784.39,-317.43 742.33,-235.43 905.83,-235.43 947.88,-317.43"/>
<text text-anchor="middle" x="845.11" y="-284.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="845.11" y="-273.93" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="845.11" y="-262.93" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;expert_agg_16 -->
<g id="edge642" class="edge">
<title>ln1_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M852.4,-585.66C1043.68,-587.28 1753.16,-578.57 1552.11,-354.43 1511.9,-309.61 1122.49,-288.38 939.38,-280.82"/>
<polygon fill="black" stroke="black" points="939.36,-277.32 929.22,-280.4 939.07,-284.31 939.36,-277.32"/>
</g>
<!-- residual2_16 -->
<g id="node334" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="176.11,-198.43 84.11,-198.43 84.11,-157.43 176.11,-157.43 176.11,-198.43"/>
<text text-anchor="middle" x="130.11" y="-186.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="130.11" y="-175.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="130.11" y="-164.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;residual2_16 -->
<g id="edge668" class="edge">
<title>ln1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M759.9,-583.32C605.64,-577.37 118.11,-553.41 118.11,-488.43 118.11,-488.43 118.11,-488.43 118.11,-275.43 118.11,-252.78 121.4,-227.37 124.54,-208.31"/>
<polygon fill="black" stroke="black" points="127.99,-208.88 126.24,-198.43 121.09,-207.69 127.99,-208.88"/>
</g>
<!-- gate_16&#45;&gt;expert_16_0 -->
<g id="edge643" class="edge">
<title>gate_16&#45;&gt;expert_16_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M865.69,-478.04C967.71,-463.43 1182.56,-431.58 1374.58,-395.47"/>
<polygon fill="black" stroke="black" points="1375.4,-398.88 1384.58,-393.59 1374.1,-392 1375.4,-398.88"/>
<text text-anchor="middle" x="1298.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_0</text>
</g>
<!-- gate_16&#45;&gt;expert_16_1 -->
<g id="edge646" class="edge">
<title>gate_16&#45;&gt;expert_16_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M755.93,-472.9C712.55,-461.19 648.17,-443.77 592.11,-428.43 556.06,-418.56 516.18,-407.56 482.31,-398.18"/>
<polygon fill="black" stroke="black" points="483.04,-394.75 472.47,-395.46 481.17,-401.5 483.04,-394.75"/>
<text text-anchor="middle" x="623.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_1</text>
</g>
<!-- gate_16&#45;&gt;expert_16_2 -->
<g id="edge649" class="edge">
<title>gate_16&#45;&gt;expert_16_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M766.83,-467.3C728.49,-448.64 670.02,-420.18 628.54,-399.99"/>
<polygon fill="black" stroke="black" points="629.96,-396.79 619.43,-395.56 626.89,-403.08 629.96,-396.79"/>
<text text-anchor="middle" x="717.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_2</text>
</g>
<!-- gate_16&#45;&gt;expert_16_3 -->
<g id="edge652" class="edge">
<title>gate_16&#45;&gt;expert_16_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M748.56,-476.96C682.09,-465.9 569.53,-446.76 473.11,-428.43 404.84,-415.44 385.73,-411 314.62,-395.74"/>
<polygon fill="black" stroke="black" points="315.23,-392.3 304.72,-393.62 313.77,-399.14 315.23,-392.3"/>
<text text-anchor="middle" x="504.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_3</text>
</g>
<!-- gate_16&#45;&gt;expert_16_4 -->
<g id="edge655" class="edge">
<title>gate_16&#45;&gt;expert_16_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M782.04,-458.84C775.23,-449.7 768.49,-439.12 764.11,-428.43 761.17,-421.27 759.31,-413.17 758.12,-405.51"/>
<polygon fill="black" stroke="black" points="761.58,-404.96 756.88,-395.47 754.63,-405.82 761.58,-404.96"/>
<text text-anchor="middle" x="795.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_4</text>
</g>
<!-- gate_16&#45;&gt;expert_16_5 -->
<g id="edge658" class="edge">
<title>gate_16&#45;&gt;expert_16_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M856.33,-473.09C900.52,-461.35 966.59,-443.78 1024.11,-428.43 1049,-421.78 1054.89,-418.71 1080.11,-413.43 1129.09,-403.16 1144.25,-404.86 1197.55,-395.44"/>
<polygon fill="black" stroke="black" points="1198.37,-398.85 1207.58,-393.62 1197.12,-391.96 1198.37,-398.85"/>
<text text-anchor="middle" x="1111.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_5</text>
</g>
<!-- gate_16&#45;&gt;expert_16_6 -->
<g id="edge661" class="edge">
<title>gate_16&#45;&gt;expert_16_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M820.26,-453.94C827.57,-440.06 837.61,-424.53 850.11,-413.43 855.55,-408.59 861.73,-404.28 868.19,-400.46"/>
<polygon fill="black" stroke="black" points="870.05,-403.43 877.14,-395.56 866.69,-397.29 870.05,-403.43"/>
<text text-anchor="middle" x="881.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_6</text>
</g>
<!-- gate_16&#45;&gt;expert_16_7 -->
<g id="edge664" class="edge">
<title>gate_16&#45;&gt;expert_16_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M843.77,-466.16C874.63,-450.18 919.79,-428.2 961.11,-413.43 972.86,-409.22 995.93,-403.08 1020.47,-396.98"/>
<polygon fill="black" stroke="black" points="1021.43,-400.35 1030.3,-394.56 1019.75,-393.56 1021.43,-400.35"/>
<text text-anchor="middle" x="992.61" y="-417.23" font-family="Times,serif" font-size="14.00">expert_7</text>
</g>
<!-- expert_16_0&#45;&gt;expert_agg_16 -->
<g id="edge645" class="edge">
<title>expert_16_0&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M1384.59,-356.21C1381.39,-355.59 1378.22,-354.99 1375.11,-354.43 1225.12,-327.14 1049.85,-303.22 943.21,-289.55"/>
<polygon fill="black" stroke="black" points="943.47,-286.05 933.11,-288.26 942.58,-292.99 943.47,-286.05"/>
</g>
<!-- expert_16_1&#45;&gt;expert_agg_16 -->
<g id="edge648" class="edge">
<title>expert_16_1&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M481.73,-356.27C484.56,-355.64 487.36,-355.03 490.11,-354.43 583.07,-334.05 689.78,-310.94 761.74,-295.4"/>
<polygon fill="black" stroke="black" points="762.62,-298.79 771.66,-293.26 761.14,-291.95 762.62,-298.79"/>
</g>
<!-- expert_16_2&#45;&gt;expert_agg_16 -->
<g id="edge651" class="edge">
<title>expert_16_2&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M632.94,-354.4C671.33,-340.47 723.55,-321.53 766.58,-305.92"/>
<polygon fill="black" stroke="black" points="767.97,-309.14 776.17,-302.43 765.58,-302.55 767.97,-309.14"/>
</g>
<!-- expert_16_3&#45;&gt;expert_agg_16 -->
<g id="edge654" class="edge">
<title>expert_16_3&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M304.68,-356.02C307.52,-355.47 310.34,-354.93 313.11,-354.43 469.41,-325.84 653.12,-301.22 758.65,-287.93"/>
<polygon fill="black" stroke="black" points="759.13,-291.4 768.61,-286.68 758.25,-284.45 759.13,-291.4"/>
</g>
<!-- expert_16_4&#45;&gt;expert_agg_16 -->
<g id="edge657" class="edge">
<title>expert_16_4&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M774.12,-354.4C781.97,-345.89 791.54,-335.51 801.09,-325.16"/>
<polygon fill="black" stroke="black" points="803.8,-327.38 808.01,-317.65 798.66,-322.63 803.8,-327.38"/>
</g>
<!-- expert_16_5&#45;&gt;expert_agg_16 -->
<g id="edge660" class="edge">
<title>expert_16_5&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M1207.53,-356.49C1204.35,-355.79 1201.2,-355.1 1198.11,-354.43 1114,-336.04 1018.62,-315.24 948.22,-299.89"/>
<polygon fill="black" stroke="black" points="948.53,-296.38 938.02,-297.67 947.04,-303.22 948.53,-296.38"/>
</g>
<!-- expert_16_6&#45;&gt;expert_agg_16 -->
<g id="edge663" class="edge">
<title>expert_16_6&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M915.3,-354.4C907.54,-345.89 898.07,-335.51 888.63,-325.16"/>
<polygon fill="black" stroke="black" points="891.11,-322.68 881.79,-317.65 885.94,-327.4 891.11,-322.68"/>
</g>
<!-- expert_16_7&#45;&gt;expert_agg_16 -->
<g id="edge666" class="edge">
<title>expert_16_7&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M1056.48,-354.4C1027.59,-343.88 990.83,-330.49 956.1,-317.84"/>
<polygon fill="black" stroke="black" points="956.96,-314.43 946.36,-314.3 954.56,-321.01 956.96,-314.43"/>
</g>
<!-- expert_agg_16&#45;&gt;residual2_16 -->
<g id="edge667" class="edge">
<title>expert_agg_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M756.72,-263.5C607.54,-243.36 309.96,-203.2 186.16,-186.49"/>
<polygon fill="black" stroke="black" points="186.52,-183.01 176.14,-185.14 185.58,-189.95 186.52,-183.01"/>
</g>
<!-- ln2_16 -->
<g id="node335" class="node">
<title>ln2_16</title>
<polygon fill="lightpink" stroke="black" points="176.11,-120.43 84.11,-120.43 84.11,-79.43 176.11,-79.43 176.11,-120.43"/>
<text text-anchor="middle" x="130.11" y="-108.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="130.11" y="-97.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="130.11" y="-86.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- residual2_16&#45;&gt;ln2_16 -->
<g id="edge669" class="edge">
<title>residual2_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M130.11,-157.35C130.11,-149.2 130.11,-139.55 130.11,-130.56"/>
<polygon fill="black" stroke="black" points="133.61,-130.43 130.11,-120.43 126.61,-130.43 133.61,-130.43"/>
</g>
<!-- output -->
<g id="node336" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="130.11" cy="-21.21" rx="130.22" ry="21.43"/>
<text text-anchor="middle" x="130.11" y="-24.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="130.11" y="-13.21" font-family="Arial" font-size="10.00">[Batch: 1024, Seq: 512, Hidden: 8192]</text>
</g>
<!-- ln2_16&#45;&gt;output -->
<g id="edge670" class="edge">
<title>ln2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M130.11,-79.17C130.11,-71.07 130.11,-61.5 130.11,-52.54"/>
<polygon fill="black" stroke="black" points="133.61,-52.44 130.11,-42.44 126.61,-52.44 133.61,-52.44"/>
</g>
</g>
</svg>
