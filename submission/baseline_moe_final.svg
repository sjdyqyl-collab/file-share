<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_final Pages: 1 -->
<svg width="2520pt" height="528pt"
 viewBox="0.00 0.00 2520.00 527.53" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.27 0.27) rotate(0) translate(4 1943.81)">
<title>baseline_moe_final</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1943.81 9300.75,-1943.81 9300.75,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="1710.87" cy="-1886.81" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="1710.87" y="-1898.11" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1710.87" y="-1883.11" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1710.87" y="-1868.11" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l1_attn -->
<g id="node2" class="node">
<title>l1_attn</title>
<ellipse fill="none" stroke="black" cx="1710.87" cy="-1724.34" rx="107.46" ry="37.45"/>
<text text-anchor="middle" x="1710.87" y="-1735.64" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1710.87" y="-1720.64" font-family="Times,serif" font-size="14.00">[1024, hidden]</text>
<text text-anchor="middle" x="1710.87" y="-1705.64" font-family="Times,serif" font-size="14.00">TP8 GPUs 0&#45;7,8&#45;15</text>
</g>
<!-- input&#45;&gt;l1_attn -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l1_attn</title>
<path fill="none" stroke="black" d="M1710.87,-1849C1710.87,-1826.16 1710.87,-1796.62 1710.87,-1772.13"/>
<polygon fill="black" stroke="black" points="1714.37,-1771.98 1710.87,-1761.98 1707.37,-1771.98 1714.37,-1771.98"/>
</g>
<!-- l1_gate -->
<g id="node3" class="node">
<title>l1_gate</title>
<polygon fill="none" stroke="black" points="1830.33,-1614.86 1640.3,-1614.86 1591.42,-1508.86 1781.44,-1508.86 1830.33,-1614.86"/>
<text text-anchor="middle" x="1710.87" y="-1573.16" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1710.87" y="-1558.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1710.87" y="-1543.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l1_attn&#45;&gt;l1_gate -->
<g id="edge2" class="edge">
<title>l1_attn&#45;&gt;l1_gate</title>
<path fill="none" stroke="black" d="M1710.87,-1686.52C1710.87,-1668.31 1710.87,-1645.83 1710.87,-1625.05"/>
<polygon fill="black" stroke="black" points="1714.37,-1625.01 1710.87,-1615.01 1707.37,-1625.01 1714.37,-1625.01"/>
</g>
<!-- l1_gpu0_exp0 -->
<g id="node4" class="node">
<title>l1_gpu0_exp0</title>
<ellipse fill="none" stroke="black" cx="96.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="96.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="96.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="96.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu0_exp0 -->
<g id="edge3" class="edge">
<title>l1_gate&#45;&gt;l1_gpu0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1613.44,-1557.14C1324.96,-1545.44 478.71,-1506.02 211.87,-1436.86 195.12,-1432.52 177.75,-1425.9 161.75,-1418.83"/>
<polygon fill="black" stroke="black" points="163.05,-1415.58 152.5,-1414.63 160.16,-1421.95 163.05,-1415.58"/>
</g>
<!-- l1_gpu0_exp1 -->
<g id="node5" class="node">
<title>l1_gpu0_exp1</title>
<ellipse fill="none" stroke="black" cx="326.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="326.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="326.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="326.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu0_exp1 -->
<g id="edge4" class="edge">
<title>l1_gate&#45;&gt;l1_gpu0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1612.59,-1555.41C1354.64,-1540.46 662.95,-1495.92 441.87,-1436.86 425.24,-1432.42 407.98,-1425.8 392.05,-1418.77"/>
<polygon fill="black" stroke="black" points="393.39,-1415.53 382.84,-1414.59 390.5,-1421.91 393.39,-1415.53"/>
</g>
<!-- l1_gpu0_exp2 -->
<g id="node6" class="node">
<title>l1_gpu0_exp2</title>
<ellipse fill="none" stroke="black" cx="556.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="556.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="556.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="556.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu0_exp2 -->
<g id="edge5" class="edge">
<title>l1_gate&#45;&gt;l1_gpu0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1614.44,-1559.12C1428.65,-1553.65 1009.62,-1530.96 671.87,-1436.86 655.38,-1432.26 638.23,-1425.63 622.38,-1418.62"/>
<polygon fill="black" stroke="black" points="623.76,-1415.41 613.2,-1414.47 620.87,-1421.78 623.76,-1415.41"/>
</g>
<!-- l1_gpu0_exp3 -->
<g id="node7" class="node">
<title>l1_gpu0_exp3</title>
<ellipse fill="none" stroke="black" cx="786.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="786.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="786.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="786.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu0_exp3 -->
<g id="edge6" class="edge">
<title>l1_gate&#45;&gt;l1_gpu0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1612.17,-1554.43C1457.87,-1542.44 1151.33,-1510.86 901.87,-1436.86 885.78,-1432.09 869.02,-1425.51 853.44,-1418.65"/>
<polygon fill="black" stroke="black" points="854.46,-1415.27 843.9,-1414.35 851.58,-1421.65 854.46,-1415.27"/>
</g>
<!-- l1_gpu1_exp0 -->
<g id="node8" class="node">
<title>l1_gpu1_exp0</title>
<ellipse fill="none" stroke="black" cx="1016.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1016.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1016.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1016.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu1_exp0 -->
<g id="edge7" class="edge">
<title>l1_gate&#45;&gt;l1_gpu1_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1608.2,-1545.69C1491.07,-1526.82 1294.71,-1490.43 1131.87,-1436.86 1116.19,-1431.7 1099.77,-1425.07 1084.41,-1418.29"/>
<polygon fill="black" stroke="black" points="1085.56,-1414.96 1075.01,-1414.05 1082.69,-1421.35 1085.56,-1414.96"/>
</g>
<!-- l1_gpu1_exp1 -->
<g id="node9" class="node">
<title>l1_gpu1_exp1</title>
<ellipse fill="none" stroke="black" cx="1246.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1246.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1246.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1246.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu1_exp1 -->
<g id="edge8" class="edge">
<title>l1_gate&#45;&gt;l1_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1598,-1523.42C1529.22,-1499.95 1439.86,-1468.28 1361.87,-1436.86 1347.06,-1430.89 1331.37,-1424.11 1316.49,-1417.46"/>
<polygon fill="black" stroke="black" points="1317.9,-1414.25 1307.34,-1413.34 1315.02,-1420.64 1317.9,-1414.25"/>
</g>
<!-- l1_gpu1_exp2 -->
<g id="node10" class="node">
<title>l1_gpu1_exp2</title>
<ellipse fill="none" stroke="black" cx="1476.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1476.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1476.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1476.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu1_exp2 -->
<g id="edge9" class="edge">
<title>l1_gate&#45;&gt;l1_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1641.62,-1508.77C1605.34,-1481.48 1561.67,-1448.64 1528.41,-1423.62"/>
<polygon fill="black" stroke="black" points="1530.28,-1420.65 1520.19,-1417.44 1526.08,-1426.25 1530.28,-1420.65"/>
</g>
<!-- l1_gpu1_exp3 -->
<g id="node11" class="node">
<title>l1_gpu1_exp3</title>
<ellipse fill="none" stroke="black" cx="1706.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1706.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1706.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1706.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu1_exp3 -->
<g id="edge10" class="edge">
<title>l1_gate&#45;&gt;l1_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1709.68,-1508.53C1709.13,-1484.08 1708.47,-1455.21 1707.93,-1431.51"/>
<polygon fill="black" stroke="black" points="1711.43,-1431.28 1707.7,-1421.36 1704.43,-1431.44 1711.43,-1431.28"/>
</g>
<!-- l1_gpu2_exp0 -->
<g id="node12" class="node">
<title>l1_gpu2_exp0</title>
<ellipse fill="none" stroke="black" cx="1936.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1936.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1936.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1936.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu2_exp0 -->
<g id="edge11" class="edge">
<title>l1_gate&#45;&gt;l1_gpu2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1777.76,-1508.77C1812.68,-1481.58 1854.69,-1448.86 1886.77,-1423.88"/>
<polygon fill="black" stroke="black" points="1888.96,-1426.61 1894.7,-1417.7 1884.66,-1421.08 1888.96,-1426.61"/>
</g>
<!-- l1_gpu2_exp1 -->
<g id="node13" class="node">
<title>l1_gpu2_exp1</title>
<ellipse fill="none" stroke="black" cx="2166.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2166.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2166.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2166.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu2_exp1 -->
<g id="edge12" class="edge">
<title>l1_gate&#45;&gt;l1_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1792.84,-1533.02C1862.33,-1508.94 1964.36,-1472.5 2051.87,-1436.86 2066.66,-1430.84 2082.35,-1424.03 2097.23,-1417.37"/>
<polygon fill="black" stroke="black" points="2098.69,-1420.55 2106.37,-1413.26 2095.82,-1414.17 2098.69,-1420.55"/>
</g>
<!-- l1_gpu2_exp2 -->
<g id="node14" class="node">
<title>l1_gpu2_exp2</title>
<ellipse fill="none" stroke="black" cx="2396.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2396.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2396.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2396.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu2_exp2 -->
<g id="edge13" class="edge">
<title>l1_gate&#45;&gt;l1_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1799.47,-1547.58C1913.06,-1529.2 2115.25,-1491.94 2281.87,-1436.86 2297.55,-1431.68 2313.96,-1425.04 2329.32,-1418.25"/>
<polygon fill="black" stroke="black" points="2331.05,-1421.31 2338.73,-1414.02 2328.17,-1414.93 2331.05,-1421.31"/>
</g>
<!-- l1_gpu2_exp3 -->
<g id="node15" class="node">
<title>l1_gpu2_exp3</title>
<ellipse fill="none" stroke="black" cx="2626.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2626.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="2626.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2626.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu2_exp3 -->
<g id="edge14" class="edge">
<title>l1_gate&#45;&gt;l1_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1802.73,-1554.76C1953.5,-1542.96 2261.67,-1511.28 2511.87,-1436.86 2527.96,-1432.07 2544.72,-1425.5 2560.3,-1418.63"/>
<polygon fill="black" stroke="black" points="2562.16,-1421.63 2569.84,-1414.33 2559.28,-1415.25 2562.16,-1421.63"/>
</g>
<!-- l1_gpu3_exp0 -->
<g id="node16" class="node">
<title>l1_gpu3_exp0</title>
<ellipse fill="none" stroke="black" cx="2856.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2856.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="2856.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2856.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu3_exp0 -->
<g id="edge15" class="edge">
<title>l1_gate&#45;&gt;l1_gpu3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1804.79,-1559.08C1988.24,-1553.52 2405.65,-1530.7 2741.87,-1436.86 2758.37,-1432.26 2775.51,-1425.62 2791.37,-1418.61"/>
<polygon fill="black" stroke="black" points="2792.88,-1421.77 2800.54,-1414.46 2789.99,-1415.4 2792.88,-1421.77"/>
</g>
<!-- l1_gpu3_exp1 -->
<g id="node17" class="node">
<title>l1_gpu3_exp1</title>
<ellipse fill="none" stroke="black" cx="3086.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3086.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="3086.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3086.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu3_exp1 -->
<g id="edge16" class="edge">
<title>l1_gate&#45;&gt;l1_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1803.48,-1555.68C2055.7,-1540.94 2750.73,-1496.01 2971.87,-1436.86 2988.51,-1432.41 3005.76,-1425.79 3021.69,-1418.76"/>
<polygon fill="black" stroke="black" points="3023.24,-1421.9 3030.91,-1414.58 3020.35,-1415.52 3023.24,-1421.9"/>
</g>
<!-- l1_gpu3_exp2 -->
<g id="node18" class="node">
<title>l1_gpu3_exp2</title>
<ellipse fill="none" stroke="black" cx="3316.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3316.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="3316.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3316.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu3_exp2 -->
<g id="edge17" class="edge">
<title>l1_gate&#45;&gt;l1_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1804.25,-1557.26C2087.75,-1545.66 2935.36,-1506 3201.87,-1436.86 3218.63,-1432.51 3235.99,-1425.9 3252,-1418.83"/>
<polygon fill="black" stroke="black" points="3253.59,-1421.95 3261.25,-1414.63 3250.69,-1415.58 3253.59,-1421.95"/>
</g>
<!-- l1_gpu3_exp3 -->
<g id="node19" class="node">
<title>l1_gpu3_exp3</title>
<ellipse fill="none" stroke="black" cx="3546.87" cy="-1383.86" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3546.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3546.87" y="-1380.16" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3546.87" y="-1365.16" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l1_gate&#45;&gt;l1_gpu3_exp3 -->
<g id="edge18" class="edge">
<title>l1_gate&#45;&gt;l1_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1804.33,-1558.45C2116.25,-1549.73 3119.45,-1516.07 3431.87,-1436.86 3448.65,-1432.61 3466.03,-1426.03 3482.03,-1418.96"/>
<polygon fill="black" stroke="black" points="3483.62,-1422.08 3491.28,-1414.76 3480.73,-1415.71 3483.62,-1422.08"/>
</g>
<!-- l1_agg -->
<g id="node20" class="node">
<title>l1_agg</title>
<polygon fill="none" stroke="black" points="1941.33,-1258.86 1751.3,-1258.86 1702.42,-1152.86 1892.44,-1152.86 1941.33,-1258.86"/>
<text text-anchor="middle" x="1821.87" y="-1217.16" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="1821.87" y="-1202.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1821.87" y="-1187.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l1_gpu0_exp0&#45;&gt;l1_agg -->
<g id="edge19" class="edge">
<title>l1_gpu0_exp0&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M152.48,-1353.02C170.89,-1344.43 191.81,-1336 211.87,-1330.86 498.86,-1257.35 1409.34,-1220.7 1718.22,-1210.15"/>
<polygon fill="black" stroke="black" points="1718.63,-1213.64 1728.51,-1209.8 1718.39,-1206.64 1718.63,-1213.64"/>
</g>
<!-- l1_gpu0_exp1&#45;&gt;l1_agg -->
<g id="edge20" class="edge">
<title>l1_gpu0_exp1&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M382.52,-1353.17C400.94,-1344.59 421.85,-1336.13 441.87,-1330.86 683.45,-1267.34 1441.31,-1225.27 1718.77,-1211.66"/>
<polygon fill="black" stroke="black" points="1719.02,-1215.15 1728.84,-1211.16 1718.68,-1208.16 1719.02,-1215.15"/>
</g>
<!-- l1_gpu0_exp2&#45;&gt;l1_agg -->
<g id="edge21" class="edge">
<title>l1_gpu0_exp2&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M612.87,-1353.25C631.22,-1344.72 652,-1336.28 671.87,-1330.86 1046.98,-1228.65 1512.46,-1210.11 1717.08,-1207.15"/>
<polygon fill="black" stroke="black" points="1717.27,-1210.65 1727.22,-1207.01 1717.17,-1203.65 1717.27,-1210.65"/>
</g>
<!-- l1_gpu0_exp3&#45;&gt;l1_agg -->
<g id="edge22" class="edge">
<title>l1_gpu0_exp3&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M843.55,-1353.29C861.75,-1344.88 882.29,-1336.48 901.87,-1330.86 1190.66,-1248.03 1546.69,-1220.08 1718.91,-1211.01"/>
<polygon fill="black" stroke="black" points="1719.17,-1214.5 1728.98,-1210.48 1718.81,-1207.51 1719.17,-1214.5"/>
</g>
<!-- l1_gpu1_exp0&#45;&gt;l1_agg -->
<g id="edge23" class="edge">
<title>l1_gpu1_exp0&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M1074.29,-1353.54C1092.36,-1345.24 1112.62,-1336.84 1131.87,-1330.86 1336.26,-1267.36 1585.43,-1232.59 1721.42,-1217.04"/>
<polygon fill="black" stroke="black" points="1721.87,-1220.51 1731.42,-1215.91 1721.09,-1213.56 1721.87,-1220.51"/>
</g>
<!-- l1_gpu1_exp1&#45;&gt;l1_agg -->
<g id="edge24" class="edge">
<title>l1_gpu1_exp1&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M1305.81,-1354.01C1323.58,-1345.91 1343.31,-1337.51 1361.87,-1330.86 1485.21,-1286.68 1632.02,-1249.7 1726.04,-1227.92"/>
<polygon fill="black" stroke="black" points="1726.87,-1231.33 1735.82,-1225.67 1725.29,-1224.5 1726.87,-1231.33"/>
</g>
<!-- l1_gpu1_exp2&#45;&gt;l1_agg -->
<g id="edge25" class="edge">
<title>l1_gpu1_exp2&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M1534.23,-1353.6C1589.29,-1325.51 1673.16,-1282.73 1736.15,-1250.59"/>
<polygon fill="black" stroke="black" points="1737.97,-1253.59 1745.29,-1245.93 1734.79,-1247.36 1737.97,-1253.59"/>
</g>
<!-- l1_gpu1_exp3&#45;&gt;l1_agg -->
<g id="edge26" class="edge">
<title>l1_gpu1_exp3&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M1730.15,-1347.24C1745.07,-1324.4 1764.83,-1294.16 1782.19,-1267.6"/>
<polygon fill="black" stroke="black" points="1785.19,-1269.4 1787.73,-1259.11 1779.33,-1265.57 1785.19,-1269.4"/>
</g>
<!-- l1_gpu2_exp0&#45;&gt;l1_agg -->
<g id="edge27" class="edge">
<title>l1_gpu2_exp0&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M1913.6,-1347.24C1898.68,-1324.4 1878.92,-1294.16 1861.56,-1267.6"/>
<polygon fill="black" stroke="black" points="1864.42,-1265.57 1856.02,-1259.11 1858.56,-1269.4 1864.42,-1265.57"/>
</g>
<!-- l1_gpu2_exp1&#45;&gt;l1_agg -->
<g id="edge28" class="edge">
<title>l1_gpu2_exp1&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M2109.52,-1353.6C2061.58,-1329.15 1991.82,-1293.56 1933.01,-1263.56"/>
<polygon fill="black" stroke="black" points="1934.54,-1260.41 1924.04,-1258.98 1931.36,-1266.64 1934.54,-1260.41"/>
</g>
<!-- l1_gpu2_exp2&#45;&gt;l1_agg -->
<g id="edge29" class="edge">
<title>l1_gpu2_exp2&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M2337.94,-1354.01C2320.16,-1345.91 2300.44,-1337.51 2281.87,-1330.86 2167.19,-1289.78 2032.2,-1254.92 1938.23,-1232.73"/>
<polygon fill="black" stroke="black" points="1938.95,-1229.3 1928.42,-1230.42 1937.35,-1236.11 1938.95,-1229.3"/>
</g>
<!-- l1_gpu2_exp3&#45;&gt;l1_agg -->
<g id="edge30" class="edge">
<title>l1_gpu2_exp3&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M2569.46,-1353.54C2551.39,-1345.24 2531.12,-1336.84 2511.87,-1330.86 2312.44,-1268.9 2070.38,-1234.29 1932.43,-1218.21"/>
<polygon fill="black" stroke="black" points="1932.6,-1214.7 1922.27,-1217.03 1931.8,-1221.66 1932.6,-1214.7"/>
</g>
<!-- l1_gpu3_exp0&#45;&gt;l1_agg -->
<g id="edge31" class="edge">
<title>l1_gpu3_exp0&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M2800.2,-1353.29C2781.99,-1344.88 2761.46,-1336.48 2741.87,-1330.86 2455.74,-1248.79 2103.61,-1220.6 1929.64,-1211.26"/>
<polygon fill="black" stroke="black" points="1929.63,-1207.76 1919.46,-1210.72 1929.26,-1214.75 1929.63,-1207.76"/>
</g>
<!-- l1_gpu3_exp1&#45;&gt;l1_agg -->
<g id="edge32" class="edge">
<title>l1_gpu3_exp1&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M3030.88,-1353.25C3012.53,-1344.72 2991.75,-1336.28 2971.87,-1330.86 2597.48,-1228.84 2133.06,-1210.18 1927.84,-1207.17"/>
<polygon fill="black" stroke="black" points="1927.71,-1203.67 1917.67,-1207.03 1927.62,-1210.67 1927.71,-1203.67"/>
</g>
<!-- l1_gpu3_exp2&#45;&gt;l1_agg -->
<g id="edge33" class="edge">
<title>l1_gpu3_exp2&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M3261.23,-1353.17C3242.81,-1344.59 3221.9,-1336.13 3201.87,-1330.86 2961.73,-1267.71 2211.43,-1225.77 1929.97,-1211.9"/>
<polygon fill="black" stroke="black" points="1929.92,-1208.39 1919.76,-1211.4 1929.57,-1215.39 1929.92,-1208.39"/>
</g>
<!-- l1_gpu3_exp3&#45;&gt;l1_agg -->
<g id="edge34" class="edge">
<title>l1_gpu3_exp3&#45;&gt;l1_agg</title>
<path fill="none" stroke="black" d="M3491.26,-1353.02C3472.85,-1344.43 3451.93,-1336 3431.87,-1330.86 3146.06,-1257.65 2241.85,-1221 1929.35,-1210.28"/>
<polygon fill="black" stroke="black" points="1929.05,-1206.77 1918.94,-1209.93 1928.81,-1213.77 1929.05,-1206.77"/>
</g>
<!-- l1_res -->
<g id="node21" class="node">
<title>l1_res</title>
<polygon fill="none" stroke="black" points="1821.87,-1080.86 1706.87,-1027.86 1821.87,-974.86 1936.87,-1027.86 1821.87,-1080.86"/>
<text text-anchor="middle" x="1821.87" y="-1039.16" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="1821.87" y="-1024.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1821.87" y="-1009.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l1_agg&#45;&gt;l1_res -->
<g id="edge35" class="edge">
<title>l1_agg&#45;&gt;l1_res</title>
<path fill="none" stroke="black" d="M1821.87,-1152.53C1821.87,-1133.2 1821.87,-1111.11 1821.87,-1090.99"/>
<polygon fill="black" stroke="black" points="1825.37,-1090.99 1821.87,-1080.99 1818.37,-1090.99 1825.37,-1090.99"/>
</g>
<!-- l2_attn -->
<g id="node22" class="node">
<title>l2_attn</title>
<ellipse fill="none" stroke="black" cx="1821.87" cy="-865.38" rx="107.46" ry="37.45"/>
<text text-anchor="middle" x="1821.87" y="-876.68" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1821.87" y="-861.68" font-family="Times,serif" font-size="14.00">[1024, hidden]</text>
<text text-anchor="middle" x="1821.87" y="-846.68" font-family="Times,serif" font-size="14.00">TP8 GPUs 0&#45;7,8&#45;15</text>
</g>
<!-- l1_res&#45;&gt;l2_attn -->
<g id="edge36" class="edge">
<title>l1_res&#45;&gt;l2_attn</title>
<path fill="none" stroke="black" d="M1821.87,-974.76C1821.87,-954.9 1821.87,-932.41 1821.87,-913.08"/>
<polygon fill="black" stroke="black" points="1825.37,-913 1821.87,-903 1818.37,-913 1825.37,-913"/>
</g>
<!-- l2_gate -->
<g id="node23" class="node">
<title>l2_gate</title>
<polygon fill="none" stroke="black" points="1941.33,-755.91 1751.3,-755.91 1702.42,-649.91 1892.44,-649.91 1941.33,-755.91"/>
<text text-anchor="middle" x="1821.87" y="-714.21" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1821.87" y="-699.21" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1821.87" y="-684.21" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l2_attn&#45;&gt;l2_gate -->
<g id="edge37" class="edge">
<title>l2_attn&#45;&gt;l2_gate</title>
<path fill="none" stroke="black" d="M1821.87,-827.57C1821.87,-809.36 1821.87,-786.88 1821.87,-766.1"/>
<polygon fill="black" stroke="black" points="1825.37,-766.06 1821.87,-756.06 1818.37,-766.06 1825.37,-766.06"/>
</g>
<!-- l2_gpu0_exp0 -->
<g id="node24" class="node">
<title>l2_gpu0_exp0</title>
<ellipse fill="none" stroke="black" cx="96.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="96.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="96.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="96.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu0_exp0 -->
<g id="edge38" class="edge">
<title>l2_gate&#45;&gt;l2_gpu0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1726.49,-702.18C1475.83,-701.25 778.76,-688.11 211.87,-577.91 200.31,-575.66 188.27,-572.64 176.53,-569.29"/>
<polygon fill="black" stroke="black" points="177.34,-565.88 166.76,-566.41 175.36,-572.59 177.34,-565.88"/>
</g>
<!-- l2_gpu0_exp1 -->
<g id="node25" class="node">
<title>l2_gpu0_exp1</title>
<ellipse fill="none" stroke="black" cx="326.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="326.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="326.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="326.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu0_exp1 -->
<g id="edge40" class="edge">
<title>l2_gate&#45;&gt;l2_gpu0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1725.48,-700.43C1499.17,-695.4 917.07,-673.43 441.87,-577.91 430.4,-575.6 418.46,-572.56 406.8,-569.23"/>
<polygon fill="black" stroke="black" points="407.68,-565.83 397.09,-566.36 405.69,-572.55 407.68,-565.83"/>
</g>
<!-- l2_gpu0_exp2 -->
<g id="node26" class="node">
<title>l2_gpu0_exp2</title>
<ellipse fill="none" stroke="black" cx="556.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="556.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="556.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="556.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu0_exp2 -->
<g id="edge42" class="edge">
<title>l2_gate&#45;&gt;l2_gpu0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1724.3,-697.96C1524.73,-688.45 1056.3,-658.75 671.87,-577.91 660.5,-575.52 648.66,-572.45 637.09,-569.11"/>
<polygon fill="black" stroke="black" points="638.03,-565.74 627.44,-566.25 636.04,-572.45 638.03,-565.74"/>
</g>
<!-- l2_gpu0_exp3 -->
<g id="node27" class="node">
<title>l2_gpu0_exp3</title>
<ellipse fill="none" stroke="black" cx="786.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="786.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="786.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="786.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu0_exp3 -->
<g id="edge44" class="edge">
<title>l2_gate&#45;&gt;l2_gpu0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1722.85,-694.22C1553.2,-679.81 1196.74,-644.02 901.87,-577.91 890.73,-575.41 879.12,-572.32 867.74,-569"/>
<polygon fill="black" stroke="black" points="868.4,-565.55 857.82,-566.04 866.4,-572.26 868.4,-565.55"/>
</g>
<!-- l2_gpu1_exp0 -->
<g id="node28" class="node">
<title>l2_gpu1_exp0</title>
<ellipse fill="none" stroke="black" cx="1016.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1016.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1016.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1016.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu1_exp0 -->
<g id="edge46" class="edge">
<title>l2_gate&#45;&gt;l2_gpu1_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1719.87,-687.8C1584.45,-668.1 1338.34,-628.98 1131.87,-577.91 1120.94,-575.2 1109.53,-572.03 1098.33,-568.7"/>
<polygon fill="black" stroke="black" points="1099.13,-565.28 1088.55,-565.74 1097.11,-571.98 1099.13,-565.28"/>
</g>
<!-- l2_gpu1_exp1 -->
<g id="node29" class="node">
<title>l2_gpu1_exp1</title>
<ellipse fill="none" stroke="black" cx="1246.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1246.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1246.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1246.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu1_exp1 -->
<g id="edge48" class="edge">
<title>l2_gate&#45;&gt;l2_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1713.22,-674.05C1619.77,-649.75 1481.52,-612.99 1361.87,-577.91 1351.49,-574.86 1340.61,-571.56 1329.86,-568.23"/>
<polygon fill="black" stroke="black" points="1330.63,-564.8 1320.04,-565.17 1328.54,-571.48 1330.63,-564.8"/>
</g>
<!-- l2_gpu1_exp2 -->
<g id="node30" class="node">
<title>l2_gpu1_exp2</title>
<ellipse fill="none" stroke="black" cx="1476.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1476.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1476.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1476.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu1_exp2 -->
<g id="edge50" class="edge">
<title>l2_gate&#45;&gt;l2_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1709.86,-649.8C1656.19,-624.84 1593.56,-595.71 1546.76,-573.94"/>
<polygon fill="black" stroke="black" points="1548.17,-570.73 1537.62,-569.69 1545.21,-577.08 1548.17,-570.73"/>
</g>
<!-- l2_gpu1_exp3 -->
<g id="node31" class="node">
<title>l2_gpu1_exp3</title>
<ellipse fill="none" stroke="black" cx="1706.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1706.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1706.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1706.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu1_exp3 -->
<g id="edge52" class="edge">
<title>l2_gate&#45;&gt;l2_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1784.54,-649.8C1769.62,-628.98 1752.62,-605.27 1738.34,-585.34"/>
<polygon fill="black" stroke="black" points="1741.07,-583.14 1732.4,-577.05 1735.38,-587.22 1741.07,-583.14"/>
</g>
<!-- l2_gpu2_exp0 -->
<g id="node32" class="node">
<title>l2_gpu2_exp0</title>
<ellipse fill="none" stroke="black" cx="1936.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="1936.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="1936.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1936.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu2_exp0 -->
<g id="edge54" class="edge">
<title>l2_gate&#45;&gt;l2_gpu2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1859.21,-649.8C1874.13,-628.98 1891.13,-605.27 1905.41,-585.34"/>
<polygon fill="black" stroke="black" points="1908.36,-587.22 1911.34,-577.05 1902.67,-583.14 1908.36,-587.22"/>
</g>
<!-- l2_gpu2_exp1 -->
<g id="node33" class="node">
<title>l2_gpu2_exp1</title>
<ellipse fill="none" stroke="black" cx="2166.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2166.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2166.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2166.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu2_exp1 -->
<g id="edge56" class="edge">
<title>l2_gate&#45;&gt;l2_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1899.73,-665.69C1958.94,-638.15 2039.69,-600.59 2096.87,-573.99"/>
<polygon fill="black" stroke="black" points="2098.6,-577.05 2106.19,-569.66 2095.65,-570.7 2098.6,-577.05"/>
</g>
<!-- l2_gpu2_exp2 -->
<g id="node34" class="node">
<title>l2_gpu2_exp2</title>
<ellipse fill="none" stroke="black" cx="2396.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2396.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2396.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2396.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu2_exp2 -->
<g id="edge58" class="edge">
<title>l2_gate&#45;&gt;l2_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1906.54,-680.27C1999.07,-656.35 2151.51,-616.13 2281.87,-577.91 2292.26,-574.86 2303.14,-571.56 2313.89,-568.23"/>
<polygon fill="black" stroke="black" points="2315.21,-571.48 2323.71,-565.17 2313.12,-564.8 2315.21,-571.48"/>
</g>
<!-- l2_gpu2_exp3 -->
<g id="node35" class="node">
<title>l2_gpu2_exp3</title>
<ellipse fill="none" stroke="black" cx="2626.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2626.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="2626.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2626.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu2_exp3 -->
<g id="edge60" class="edge">
<title>l2_gate&#45;&gt;l2_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1910.87,-689.68C2043.06,-670.67 2298.61,-630.66 2511.87,-577.91 2522.8,-575.2 2534.21,-572.03 2545.42,-568.7"/>
<polygon fill="black" stroke="black" points="2546.64,-571.98 2555.2,-565.74 2544.61,-565.28 2546.64,-571.98"/>
</g>
<!-- l2_gpu3_exp0 -->
<g id="node36" class="node">
<title>l2_gpu3_exp0</title>
<ellipse fill="none" stroke="black" cx="2856.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2856.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="2856.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2856.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu3_exp0 -->
<g id="edge62" class="edge">
<title>l2_gate&#45;&gt;l2_gpu3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1913.23,-694.87C2079.6,-680.9 2442.49,-645.03 2741.87,-577.91 2753.02,-575.41 2764.63,-572.32 2776.01,-569"/>
<polygon fill="black" stroke="black" points="2777.35,-572.26 2785.93,-566.04 2775.35,-565.55 2777.35,-572.26"/>
</g>
<!-- l2_gpu3_exp1 -->
<g id="node37" class="node">
<title>l2_gpu3_exp1</title>
<ellipse fill="none" stroke="black" cx="3086.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3086.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="3086.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3086.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu3_exp1 -->
<g id="edge64" class="edge">
<title>l2_gate&#45;&gt;l2_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1914.9,-698.17C2111.83,-688.9 2584.5,-659.37 2971.87,-577.91 2983.24,-575.52 2995.08,-572.45 3006.66,-569.11"/>
<polygon fill="black" stroke="black" points="3007.71,-572.45 3016.3,-566.25 3005.72,-565.74 3007.71,-572.45"/>
</g>
<!-- l2_gpu3_exp2 -->
<g id="node38" class="node">
<title>l2_gpu3_exp2</title>
<ellipse fill="none" stroke="black" cx="3316.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3316.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="3316.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3316.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu3_exp2 -->
<g id="edge66" class="edge">
<title>l2_gate&#45;&gt;l2_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1916.17,-700.47C2140.96,-695.54 2725.2,-673.73 3201.87,-577.91 3213.34,-575.6 3225.28,-572.56 3236.94,-569.23"/>
<polygon fill="black" stroke="black" points="3238.05,-572.55 3246.65,-566.36 3236.07,-565.83 3238.05,-572.55"/>
</g>
<!-- l2_gpu3_exp3 -->
<g id="node39" class="node">
<title>l2_gpu3_exp3</title>
<ellipse fill="none" stroke="black" cx="3546.87" cy="-540.43" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3546.87" y="-551.73" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="3546.87" y="-536.73" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3546.87" y="-521.73" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l2_gate&#45;&gt;l2_gpu3_exp3 -->
<g id="edge68" class="edge">
<title>l2_gate&#45;&gt;l2_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1916.8,-702.18C2167.08,-701.26 2864.64,-688.18 3431.87,-577.91 3443.44,-575.66 3455.47,-572.64 3467.21,-569.29"/>
<polygon fill="black" stroke="black" points="3468.38,-572.59 3476.99,-566.41 3466.41,-565.88 3468.38,-572.59"/>
</g>
<!-- l2_agg -->
<g id="node40" class="node">
<title>l2_agg</title>
<polygon fill="none" stroke="black" points="1941.33,-430.95 1751.3,-430.95 1702.42,-324.95 1892.44,-324.95 1941.33,-430.95"/>
<text text-anchor="middle" x="1821.87" y="-389.25" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="1821.87" y="-374.25" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1821.87" y="-359.25" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l2_gpu0_exp0&#45;&gt;l2_agg -->
<g id="edge39" class="edge">
<title>l2_gpu0_exp0&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M166.76,-514.45C181.5,-509.98 197.07,-505.83 211.87,-502.95 771.63,-394.13 1458.3,-379.96 1716.82,-378.73"/>
<polygon fill="black" stroke="black" points="1716.96,-382.22 1726.95,-378.68 1716.93,-375.22 1716.96,-382.22"/>
</g>
<!-- l2_gpu0_exp1&#45;&gt;l2_agg -->
<g id="edge41" class="edge">
<title>l2_gpu0_exp1&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M397.09,-514.5C411.74,-510.05 427.19,-505.9 441.87,-502.95 911.56,-408.53 1485.69,-385.98 1717.47,-380.61"/>
<polygon fill="black" stroke="black" points="1717.66,-384.11 1727.58,-380.39 1717.5,-377.11 1717.66,-384.11"/>
</g>
<!-- l2_gpu0_exp2&#45;&gt;l2_agg -->
<g id="edge43" class="edge">
<title>l2_gpu0_exp2&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M627.44,-514.61C641.99,-510.18 657.32,-506.01 671.87,-502.95 1052.82,-422.84 1516.25,-392.95 1718.81,-383.16"/>
<polygon fill="black" stroke="black" points="1719.02,-386.66 1728.84,-382.69 1718.69,-379.67 1719.02,-386.66"/>
</g>
<!-- l2_gpu0_exp3&#45;&gt;l2_agg -->
<g id="edge45" class="edge">
<title>l2_gpu0_exp3&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M857.82,-514.82C872.27,-510.4 887.46,-506.18 901.87,-502.95 1195.41,-437.14 1549.99,-401.38 1720.55,-386.83"/>
<polygon fill="black" stroke="black" points="1720.85,-390.32 1730.52,-385.99 1720.26,-383.34 1720.85,-390.32"/>
</g>
<!-- l2_gpu1_exp0&#45;&gt;l2_agg -->
<g id="edge47" class="edge">
<title>l2_gpu1_exp0&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M1088.55,-515.12C1102.81,-510.73 1117.74,-506.45 1131.87,-502.95 1339.93,-451.49 1588.23,-412.16 1722.97,-392.61"/>
<polygon fill="black" stroke="black" points="1723.48,-396.08 1732.87,-391.18 1722.48,-389.15 1723.48,-396.08"/>
</g>
<!-- l2_gpu1_exp1&#45;&gt;l2_agg -->
<g id="edge49" class="edge">
<title>l2_gpu1_exp1&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M1320.04,-515.69C1333.9,-511.35 1348.31,-506.93 1361.87,-502.95 1487.78,-466.03 1634.28,-427.26 1727.51,-403.1"/>
<polygon fill="black" stroke="black" points="1728.4,-406.48 1737.2,-400.59 1726.64,-399.71 1728.4,-406.48"/>
</g>
<!-- l2_gpu1_exp2&#45;&gt;l2_agg -->
<g id="edge51" class="edge">
<title>l2_gpu1_exp2&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M1537.76,-511.11C1592.31,-485.73 1672.97,-448.22 1734.42,-419.63"/>
<polygon fill="black" stroke="black" points="1736.14,-422.69 1743.73,-415.3 1733.19,-416.35 1736.14,-422.69"/>
</g>
<!-- l2_gpu1_exp3&#45;&gt;l2_agg -->
<g id="edge53" class="edge">
<title>l2_gpu1_exp3&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M1732.11,-504.21C1745.71,-485.23 1762.88,-461.28 1778.54,-439.42"/>
<polygon fill="black" stroke="black" points="1781.48,-441.33 1784.46,-431.16 1775.79,-437.25 1781.48,-441.33"/>
</g>
<!-- l2_gpu2_exp0&#45;&gt;l2_agg -->
<g id="edge55" class="edge">
<title>l2_gpu2_exp0&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M1911.64,-504.21C1898.03,-485.23 1880.87,-461.28 1865.21,-439.42"/>
<polygon fill="black" stroke="black" points="1867.96,-437.25 1859.29,-431.16 1862.27,-441.33 1867.96,-437.25"/>
</g>
<!-- l2_gpu2_exp1&#45;&gt;l2_agg -->
<g id="edge57" class="edge">
<title>l2_gpu2_exp1&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M2105.99,-511.11C2060.91,-490.14 1998.01,-460.88 1942.85,-435.23"/>
<polygon fill="black" stroke="black" points="1944.26,-432.02 1933.72,-430.98 1941.31,-438.37 1944.26,-432.02"/>
</g>
<!-- l2_gpu2_exp2&#45;&gt;l2_agg -->
<g id="edge59" class="edge">
<title>l2_gpu2_exp2&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M2323.71,-515.69C2309.85,-511.35 2295.44,-506.93 2281.87,-502.95 2166.31,-469.07 2033.41,-433.62 1940.26,-409.34"/>
<polygon fill="black" stroke="black" points="1941.09,-405.94 1930.53,-406.81 1939.32,-412.71 1941.09,-405.94"/>
</g>
<!-- l2_gpu2_exp3&#45;&gt;l2_agg -->
<g id="edge61" class="edge">
<title>l2_gpu2_exp3&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M2555.2,-515.12C2540.94,-510.73 2526,-506.45 2511.87,-502.95 2310.45,-453.13 2071.29,-414.67 1933.99,-394.54"/>
<polygon fill="black" stroke="black" points="1934.28,-391.05 1923.88,-393.06 1933.27,-397.97 1934.28,-391.05"/>
</g>
<!-- l2_gpu3_exp0&#45;&gt;l2_agg -->
<g id="edge63" class="edge">
<title>l2_gpu3_exp0&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M2785.93,-514.82C2771.48,-510.4 2756.28,-506.18 2741.87,-502.95 2452.77,-438.13 2104.45,-402.46 1931.05,-387.51"/>
<polygon fill="black" stroke="black" points="1931.16,-384 1920.9,-386.64 1930.56,-390.98 1931.16,-384"/>
</g>
<!-- l2_gpu3_exp1&#45;&gt;l2_agg -->
<g id="edge65" class="edge">
<title>l2_gpu3_exp1&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M3016.3,-514.61C3001.75,-510.18 2986.43,-506.01 2971.87,-502.95 2593.83,-423.45 2134.55,-393.41 1929.61,-383.39"/>
<polygon fill="black" stroke="black" points="1929.61,-379.89 1919.45,-382.9 1929.27,-386.88 1929.61,-379.89"/>
</g>
<!-- l2_gpu3_exp2&#45;&gt;l2_agg -->
<g id="edge67" class="edge">
<title>l2_gpu3_exp2&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M3246.65,-514.5C3232.01,-510.05 3216.56,-505.9 3201.87,-502.95 2733.64,-408.83 2161.61,-386.12 1928.44,-380.66"/>
<polygon fill="black" stroke="black" points="1928.34,-377.16 1918.27,-380.43 1928.18,-384.16 1928.34,-377.16"/>
</g>
<!-- l2_gpu3_exp3&#45;&gt;l2_agg -->
<g id="edge69" class="edge">
<title>l2_gpu3_exp3&#45;&gt;l2_agg</title>
<path fill="none" stroke="black" d="M3476.99,-514.45C3462.25,-509.98 3446.68,-505.83 3431.87,-502.95 2872.46,-394.2 2186.28,-379.97 1927.4,-378.73"/>
<polygon fill="black" stroke="black" points="1927.27,-375.23 1917.26,-378.68 1927.24,-382.23 1927.27,-375.23"/>
</g>
<!-- l2_res -->
<g id="node41" class="node">
<title>l2_res</title>
<polygon fill="none" stroke="black" points="1821.87,-252.95 1706.87,-199.95 1821.87,-146.95 1936.87,-199.95 1821.87,-252.95"/>
<text text-anchor="middle" x="1821.87" y="-211.25" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="1821.87" y="-196.25" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="1821.87" y="-181.25" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l2_agg&#45;&gt;l2_res -->
<g id="edge70" class="edge">
<title>l2_agg&#45;&gt;l2_res</title>
<path fill="none" stroke="black" d="M1821.87,-324.62C1821.87,-305.29 1821.87,-283.2 1821.87,-263.08"/>
<polygon fill="black" stroke="black" points="1825.37,-263.08 1821.87,-253.08 1818.37,-263.08 1825.37,-263.08"/>
</g>
<!-- l3_attn -->
<g id="node42" class="node">
<title>l3_attn</title>
<ellipse fill="none" stroke="black" cx="1821.87" cy="-37.48" rx="107.46" ry="37.45"/>
<text text-anchor="middle" x="1821.87" y="-48.78" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="1821.87" y="-33.78" font-family="Times,serif" font-size="14.00">[1024, hidden]</text>
<text text-anchor="middle" x="1821.87" y="-18.78" font-family="Times,serif" font-size="14.00">TP8 GPUs 0&#45;7,8&#45;15</text>
</g>
<!-- l2_res&#45;&gt;l3_attn -->
<g id="edge71" class="edge">
<title>l2_res&#45;&gt;l3_attn</title>
<path fill="none" stroke="black" d="M1821.87,-146.85C1821.87,-126.99 1821.87,-104.5 1821.87,-85.17"/>
<polygon fill="black" stroke="black" points="1825.37,-85.09 1821.87,-75.09 1818.37,-85.09 1825.37,-85.09"/>
</g>
<!-- l3_gate -->
<g id="node43" class="node">
<title>l3_gate</title>
<polygon fill="none" stroke="black" points="3914.33,-1939.81 3724.3,-1939.81 3675.42,-1833.81 3865.44,-1833.81 3914.33,-1939.81"/>
<text text-anchor="middle" x="3794.87" y="-1898.11" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3794.87" y="-1883.11" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3794.87" y="-1868.11" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l3_gpu0_exp0 -->
<g id="node44" class="node">
<title>l3_gpu0_exp0</title>
<ellipse fill="none" stroke="black" cx="2069.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2069.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2069.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2069.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu0_exp0 -->
<g id="edge72" class="edge">
<title>l3_gate&#45;&gt;l3_gpu0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3699.49,-1886.08C3448.83,-1885.16 2751.76,-1872.02 2184.87,-1761.81 2173.31,-1759.56 2161.27,-1756.54 2149.53,-1753.2"/>
<polygon fill="black" stroke="black" points="2150.34,-1749.79 2139.76,-1750.32 2148.36,-1756.5 2150.34,-1749.79"/>
</g>
<!-- l3_gpu0_exp1 -->
<g id="node45" class="node">
<title>l3_gpu0_exp1</title>
<ellipse fill="none" stroke="black" cx="2299.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2299.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2299.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2299.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu0_exp1 -->
<g id="edge74" class="edge">
<title>l3_gate&#45;&gt;l3_gpu0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3698.48,-1884.33C3472.17,-1879.31 2890.07,-1857.34 2414.87,-1761.81 2403.4,-1759.51 2391.46,-1756.47 2379.8,-1753.13"/>
<polygon fill="black" stroke="black" points="2380.68,-1749.74 2370.09,-1750.27 2378.69,-1756.45 2380.68,-1749.74"/>
</g>
<!-- l3_gpu0_exp2 -->
<g id="node46" class="node">
<title>l3_gpu0_exp2</title>
<ellipse fill="none" stroke="black" cx="2529.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2529.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2529.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2529.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu0_exp2 -->
<g id="edge76" class="edge">
<title>l3_gate&#45;&gt;l3_gpu0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3697.3,-1881.87C3497.73,-1872.35 3029.3,-1842.66 2644.87,-1761.81 2633.5,-1759.42 2621.66,-1756.35 2610.09,-1753.02"/>
<polygon fill="black" stroke="black" points="2611.03,-1749.64 2600.44,-1750.16 2609.04,-1756.36 2611.03,-1749.64"/>
</g>
<!-- l3_gpu0_exp3 -->
<g id="node47" class="node">
<title>l3_gpu0_exp3</title>
<ellipse fill="none" stroke="black" cx="2759.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2759.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2759.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2759.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu0_exp3 -->
<g id="edge78" class="edge">
<title>l3_gate&#45;&gt;l3_gpu0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3695.85,-1878.13C3526.2,-1863.71 3169.74,-1827.93 2874.87,-1761.81 2863.73,-1759.31 2852.12,-1756.23 2840.74,-1752.91"/>
<polygon fill="black" stroke="black" points="2841.4,-1749.46 2830.82,-1749.95 2839.4,-1756.16 2841.4,-1749.46"/>
</g>
<!-- l3_gpu1_exp0 -->
<g id="node48" class="node">
<title>l3_gpu1_exp0</title>
<ellipse fill="none" stroke="black" cx="2989.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2989.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2989.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="2989.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu1_exp0 -->
<g id="edge80" class="edge">
<title>l3_gate&#45;&gt;l3_gpu1_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3692.87,-1871.7C3557.45,-1852.01 3311.34,-1812.88 3104.87,-1761.81 3093.94,-1759.11 3082.53,-1755.93 3071.33,-1752.6"/>
<polygon fill="black" stroke="black" points="3072.13,-1749.19 3061.55,-1749.64 3070.11,-1755.89 3072.13,-1749.19"/>
</g>
<!-- l3_gpu1_exp1 -->
<g id="node49" class="node">
<title>l3_gpu1_exp1</title>
<ellipse fill="none" stroke="black" cx="3219.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3219.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3219.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3219.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu1_exp1 -->
<g id="edge82" class="edge">
<title>l3_gate&#45;&gt;l3_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3686.22,-1857.96C3592.77,-1833.66 3454.52,-1796.9 3334.87,-1761.81 3324.49,-1758.77 3313.61,-1755.46 3302.86,-1752.13"/>
<polygon fill="black" stroke="black" points="3303.63,-1748.71 3293.04,-1749.07 3301.54,-1755.39 3303.63,-1748.71"/>
</g>
<!-- l3_gpu1_exp2 -->
<g id="node50" class="node">
<title>l3_gpu1_exp2</title>
<ellipse fill="none" stroke="black" cx="3449.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3449.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3449.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3449.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu1_exp2 -->
<g id="edge84" class="edge">
<title>l3_gate&#45;&gt;l3_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3682.86,-1833.71C3629.19,-1808.74 3566.56,-1779.61 3519.76,-1757.85"/>
<polygon fill="black" stroke="black" points="3521.17,-1754.64 3510.62,-1753.59 3518.21,-1760.99 3521.17,-1754.64"/>
</g>
<!-- l3_gpu1_exp3 -->
<g id="node51" class="node">
<title>l3_gpu1_exp3</title>
<ellipse fill="none" stroke="black" cx="3679.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3679.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3679.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="3679.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu1_exp3 -->
<g id="edge86" class="edge">
<title>l3_gate&#45;&gt;l3_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3757.54,-1833.71C3742.62,-1812.89 3725.62,-1789.18 3711.34,-1769.25"/>
<polygon fill="black" stroke="black" points="3714.07,-1767.05 3705.4,-1760.96 3708.38,-1771.13 3714.07,-1767.05"/>
</g>
<!-- l3_gpu2_exp0 -->
<g id="node52" class="node">
<title>l3_gpu2_exp0</title>
<ellipse fill="none" stroke="black" cx="3909.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="3909.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="3909.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="3909.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu2_exp0 -->
<g id="edge88" class="edge">
<title>l3_gate&#45;&gt;l3_gpu2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3832.21,-1833.71C3847.13,-1812.89 3864.13,-1789.18 3878.41,-1769.25"/>
<polygon fill="black" stroke="black" points="3881.36,-1771.13 3884.34,-1760.96 3875.67,-1767.05 3881.36,-1771.13"/>
</g>
<!-- l3_gpu2_exp1 -->
<g id="node53" class="node">
<title>l3_gpu2_exp1</title>
<ellipse fill="none" stroke="black" cx="4139.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4139.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4139.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4139.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu2_exp1 -->
<g id="edge90" class="edge">
<title>l3_gate&#45;&gt;l3_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3872.73,-1849.6C3931.94,-1822.06 4012.69,-1784.5 4069.87,-1757.9"/>
<polygon fill="black" stroke="black" points="4071.6,-1760.95 4079.19,-1753.56 4068.65,-1754.61 4071.6,-1760.95"/>
</g>
<!-- l3_gpu2_exp2 -->
<g id="node54" class="node">
<title>l3_gpu2_exp2</title>
<ellipse fill="none" stroke="black" cx="4369.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4369.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="4369.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4369.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu2_exp2 -->
<g id="edge92" class="edge">
<title>l3_gate&#45;&gt;l3_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3879.54,-1864.18C3972.07,-1840.26 4124.51,-1800.04 4254.87,-1761.81 4265.26,-1758.77 4276.14,-1755.46 4286.89,-1752.13"/>
<polygon fill="black" stroke="black" points="4288.21,-1755.39 4296.71,-1749.07 4286.12,-1748.71 4288.21,-1755.39"/>
</g>
<!-- l3_gpu2_exp3 -->
<g id="node55" class="node">
<title>l3_gpu2_exp3</title>
<ellipse fill="none" stroke="black" cx="4599.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4599.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4599.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="4599.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu2_exp3 -->
<g id="edge94" class="edge">
<title>l3_gate&#45;&gt;l3_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3883.87,-1873.58C4016.06,-1854.57 4271.61,-1814.56 4484.87,-1761.81 4495.8,-1759.11 4507.21,-1755.93 4518.42,-1752.6"/>
<polygon fill="black" stroke="black" points="4519.64,-1755.89 4528.2,-1749.64 4517.61,-1749.19 4519.64,-1755.89"/>
</g>
<!-- l3_gpu3_exp0 -->
<g id="node56" class="node">
<title>l3_gpu3_exp0</title>
<ellipse fill="none" stroke="black" cx="4829.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4829.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4829.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="4829.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu3_exp0 -->
<g id="edge96" class="edge">
<title>l3_gate&#45;&gt;l3_gpu3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3886.23,-1878.78C4052.6,-1864.8 4415.49,-1828.94 4714.87,-1761.81 4726.02,-1759.31 4737.63,-1756.23 4749.01,-1752.91"/>
<polygon fill="black" stroke="black" points="4750.35,-1756.16 4758.93,-1749.95 4748.35,-1749.46 4750.35,-1756.16"/>
</g>
<!-- l3_gpu3_exp1 -->
<g id="node57" class="node">
<title>l3_gpu3_exp1</title>
<ellipse fill="none" stroke="black" cx="5059.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5059.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5059.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5059.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu3_exp1 -->
<g id="edge98" class="edge">
<title>l3_gate&#45;&gt;l3_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3887.9,-1882.08C4084.83,-1872.81 4557.5,-1843.28 4944.87,-1761.81 4956.24,-1759.42 4968.08,-1756.35 4979.66,-1753.02"/>
<polygon fill="black" stroke="black" points="4980.71,-1756.36 4989.3,-1750.16 4978.72,-1749.64 4980.71,-1756.36"/>
</g>
<!-- l3_gpu3_exp2 -->
<g id="node58" class="node">
<title>l3_gpu3_exp2</title>
<ellipse fill="none" stroke="black" cx="5289.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5289.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5289.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5289.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu3_exp2 -->
<g id="edge100" class="edge">
<title>l3_gate&#45;&gt;l3_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3889.17,-1884.38C4113.96,-1879.45 4698.2,-1857.64 5174.87,-1761.81 5186.34,-1759.51 5198.28,-1756.47 5209.94,-1753.13"/>
<polygon fill="black" stroke="black" points="5211.05,-1756.45 5219.65,-1750.27 5209.07,-1749.74 5211.05,-1756.45"/>
</g>
<!-- l3_gpu3_exp3 -->
<g id="node59" class="node">
<title>l3_gpu3_exp3</title>
<ellipse fill="none" stroke="black" cx="5519.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5519.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="5519.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="5519.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l3_gate&#45;&gt;l3_gpu3_exp3 -->
<g id="edge102" class="edge">
<title>l3_gate&#45;&gt;l3_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3889.8,-1886.08C4140.08,-1885.17 4837.64,-1872.09 5404.87,-1761.81 5416.44,-1759.56 5428.47,-1756.54 5440.21,-1753.2"/>
<polygon fill="black" stroke="black" points="5441.38,-1756.5 5449.99,-1750.32 5439.41,-1749.79 5441.38,-1756.5"/>
</g>
<!-- l3_agg -->
<g id="node60" class="node">
<title>l3_agg</title>
<polygon fill="none" stroke="black" points="3914.33,-1614.86 3724.3,-1614.86 3675.42,-1508.86 3865.44,-1508.86 3914.33,-1614.86"/>
<text text-anchor="middle" x="3794.87" y="-1573.16" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="3794.87" y="-1558.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3794.87" y="-1543.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l3_gpu0_exp0&#45;&gt;l3_agg -->
<g id="edge73" class="edge">
<title>l3_gpu0_exp0&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M2139.76,-1698.35C2154.5,-1693.88 2170.07,-1689.74 2184.87,-1686.86 2744.63,-1578.04 3431.3,-1563.86 3689.82,-1562.63"/>
<polygon fill="black" stroke="black" points="3689.96,-1566.13 3699.95,-1562.59 3689.93,-1559.13 3689.96,-1566.13"/>
</g>
<!-- l3_gpu0_exp1&#45;&gt;l3_agg -->
<g id="edge75" class="edge">
<title>l3_gpu0_exp1&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M2370.09,-1698.41C2384.74,-1693.96 2400.19,-1689.81 2414.87,-1686.86 2884.56,-1592.44 3458.69,-1569.88 3690.47,-1564.52"/>
<polygon fill="black" stroke="black" points="3690.66,-1568.02 3700.58,-1564.29 3690.5,-1561.02 3690.66,-1568.02"/>
</g>
<!-- l3_gpu0_exp2&#45;&gt;l3_agg -->
<g id="edge77" class="edge">
<title>l3_gpu0_exp2&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M2600.44,-1698.52C2614.99,-1694.09 2630.32,-1689.92 2644.87,-1686.86 3025.82,-1606.75 3489.25,-1576.86 3691.81,-1567.07"/>
<polygon fill="black" stroke="black" points="3692.02,-1570.57 3701.84,-1566.59 3691.69,-1563.57 3692.02,-1570.57"/>
</g>
<!-- l3_gpu0_exp3&#45;&gt;l3_agg -->
<g id="edge79" class="edge">
<title>l3_gpu0_exp3&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M2830.82,-1698.72C2845.27,-1694.31 2860.46,-1690.09 2874.87,-1686.86 3168.41,-1621.05 3522.99,-1585.28 3693.55,-1570.74"/>
<polygon fill="black" stroke="black" points="3693.85,-1574.23 3703.52,-1569.89 3693.26,-1567.25 3693.85,-1574.23"/>
</g>
<!-- l3_gpu1_exp0&#45;&gt;l3_agg -->
<g id="edge81" class="edge">
<title>l3_gpu1_exp0&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M3061.55,-1699.03C3075.81,-1694.64 3090.74,-1690.36 3104.87,-1686.86 3312.93,-1635.4 3561.23,-1596.06 3695.97,-1576.52"/>
<polygon fill="black" stroke="black" points="3696.48,-1579.98 3705.87,-1575.09 3695.48,-1573.06 3696.48,-1579.98"/>
</g>
<!-- l3_gpu1_exp1&#45;&gt;l3_agg -->
<g id="edge83" class="edge">
<title>l3_gpu1_exp1&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M3293.04,-1699.6C3306.9,-1695.25 3321.31,-1690.84 3334.87,-1686.86 3460.78,-1649.94 3607.28,-1611.16 3700.51,-1587"/>
<polygon fill="black" stroke="black" points="3701.4,-1590.39 3710.2,-1584.5 3699.64,-1583.61 3701.4,-1590.39"/>
</g>
<!-- l3_gpu1_exp2&#45;&gt;l3_agg -->
<g id="edge85" class="edge">
<title>l3_gpu1_exp2&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M3510.76,-1695.02C3565.31,-1669.64 3645.97,-1632.12 3707.42,-1603.54"/>
<polygon fill="black" stroke="black" points="3709.14,-1606.6 3716.73,-1599.21 3706.19,-1600.25 3709.14,-1606.6"/>
</g>
<!-- l3_gpu1_exp3&#45;&gt;l3_agg -->
<g id="edge87" class="edge">
<title>l3_gpu1_exp3&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M3705.11,-1688.12C3718.71,-1669.14 3735.88,-1645.19 3751.54,-1623.33"/>
<polygon fill="black" stroke="black" points="3754.48,-1625.23 3757.46,-1615.07 3748.79,-1621.16 3754.48,-1625.23"/>
</g>
<!-- l3_gpu2_exp0&#45;&gt;l3_agg -->
<g id="edge89" class="edge">
<title>l3_gpu2_exp0&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M3884.64,-1688.12C3871.03,-1669.14 3853.87,-1645.19 3838.21,-1623.33"/>
<polygon fill="black" stroke="black" points="3840.96,-1621.16 3832.29,-1615.07 3835.27,-1625.23 3840.96,-1621.16"/>
</g>
<!-- l3_gpu2_exp1&#45;&gt;l3_agg -->
<g id="edge91" class="edge">
<title>l3_gpu2_exp1&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M4078.99,-1695.02C4033.91,-1674.05 3971.01,-1644.79 3915.85,-1619.13"/>
<polygon fill="black" stroke="black" points="3917.26,-1615.93 3906.72,-1614.88 3914.31,-1622.28 3917.26,-1615.93"/>
</g>
<!-- l3_gpu2_exp2&#45;&gt;l3_agg -->
<g id="edge93" class="edge">
<title>l3_gpu2_exp2&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M4296.71,-1699.6C4282.85,-1695.25 4268.44,-1690.84 4254.87,-1686.86 4139.31,-1652.97 4006.41,-1617.52 3913.26,-1593.25"/>
<polygon fill="black" stroke="black" points="3914.09,-1589.85 3903.53,-1590.71 3912.32,-1596.62 3914.09,-1589.85"/>
</g>
<!-- l3_gpu2_exp3&#45;&gt;l3_agg -->
<g id="edge95" class="edge">
<title>l3_gpu2_exp3&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M4528.2,-1699.03C4513.94,-1694.64 4499,-1690.36 4484.87,-1686.86 4283.45,-1637.04 4044.29,-1598.58 3906.99,-1578.45"/>
<polygon fill="black" stroke="black" points="3907.28,-1574.95 3896.88,-1576.97 3906.27,-1581.88 3907.28,-1574.95"/>
</g>
<!-- l3_gpu3_exp0&#45;&gt;l3_agg -->
<g id="edge97" class="edge">
<title>l3_gpu3_exp0&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M4758.93,-1698.72C4744.48,-1694.31 4729.28,-1690.09 4714.87,-1686.86 4425.77,-1622.04 4077.45,-1586.37 3904.05,-1571.41"/>
<polygon fill="black" stroke="black" points="3904.16,-1567.91 3893.9,-1570.54 3903.56,-1574.88 3904.16,-1567.91"/>
</g>
<!-- l3_gpu3_exp1&#45;&gt;l3_agg -->
<g id="edge99" class="edge">
<title>l3_gpu3_exp1&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M4989.3,-1698.52C4974.75,-1694.09 4959.43,-1689.92 4944.87,-1686.86 4566.83,-1607.36 4107.55,-1577.32 3902.61,-1567.3"/>
<polygon fill="black" stroke="black" points="3902.61,-1563.79 3892.45,-1566.81 3902.27,-1570.79 3902.61,-1563.79"/>
</g>
<!-- l3_gpu3_exp2&#45;&gt;l3_agg -->
<g id="edge101" class="edge">
<title>l3_gpu3_exp2&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M5219.65,-1698.41C5205.01,-1693.96 5189.56,-1689.81 5174.87,-1686.86 4706.64,-1592.73 4134.61,-1570.02 3901.44,-1564.57"/>
<polygon fill="black" stroke="black" points="3901.34,-1561.07 3891.27,-1564.34 3901.18,-1568.07 3901.34,-1561.07"/>
</g>
<!-- l3_gpu3_exp3&#45;&gt;l3_agg -->
<g id="edge103" class="edge">
<title>l3_gpu3_exp3&#45;&gt;l3_agg</title>
<path fill="none" stroke="black" d="M5449.99,-1698.35C5435.25,-1693.88 5419.68,-1689.74 5404.87,-1686.86 4845.46,-1578.11 4159.28,-1563.88 3900.4,-1562.63"/>
<polygon fill="black" stroke="black" points="3900.27,-1559.13 3890.26,-1562.59 3900.24,-1566.13 3900.27,-1559.13"/>
</g>
<!-- l3_res -->
<g id="node61" class="node">
<title>l3_res</title>
<polygon fill="none" stroke="black" points="3794.87,-1436.86 3679.87,-1383.86 3794.87,-1330.86 3909.87,-1383.86 3794.87,-1436.86"/>
<text text-anchor="middle" x="3794.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="3794.87" y="-1380.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="3794.87" y="-1365.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l3_agg&#45;&gt;l3_res -->
<g id="edge104" class="edge">
<title>l3_agg&#45;&gt;l3_res</title>
<path fill="none" stroke="black" d="M3794.87,-1508.53C3794.87,-1489.2 3794.87,-1467.11 3794.87,-1446.99"/>
<polygon fill="black" stroke="black" points="3798.37,-1446.99 3794.87,-1436.99 3791.37,-1446.99 3798.37,-1446.99"/>
</g>
<!-- l4_attn -->
<g id="node62" class="node">
<title>l4_attn</title>
<ellipse fill="none" stroke="black" cx="3794.87" cy="-1205.86" rx="107.46" ry="37.45"/>
<text text-anchor="middle" x="3794.87" y="-1217.16" font-family="Times,serif" font-size="14.00">MHA</text>
<text text-anchor="middle" x="3794.87" y="-1202.16" font-family="Times,serif" font-size="14.00">[1024, hidden]</text>
<text text-anchor="middle" x="3794.87" y="-1187.16" font-family="Times,serif" font-size="14.00">TP8 GPUs 0&#45;7,8&#45;15</text>
</g>
<!-- l3_res&#45;&gt;l4_attn -->
<g id="edge105" class="edge">
<title>l3_res&#45;&gt;l4_attn</title>
<path fill="none" stroke="black" d="M3794.87,-1330.53C3794.87,-1306.08 3794.87,-1277.21 3794.87,-1253.51"/>
<polygon fill="black" stroke="black" points="3798.37,-1253.36 3794.87,-1243.36 3791.37,-1253.36 3798.37,-1253.36"/>
</g>
<!-- l4_gate -->
<g id="node63" class="node">
<title>l4_gate</title>
<polygon fill="none" stroke="black" points="7594.33,-1939.81 7404.3,-1939.81 7355.42,-1833.81 7545.44,-1833.81 7594.33,-1939.81"/>
<text text-anchor="middle" x="7474.87" y="-1898.11" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7474.87" y="-1883.11" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="7474.87" y="-1868.11" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l4_gpu0_exp0 -->
<g id="node64" class="node">
<title>l4_gpu0_exp0</title>
<ellipse fill="none" stroke="black" cx="5749.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5749.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5749.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5749.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu0_exp0 -->
<g id="edge106" class="edge">
<title>l4_gate&#45;&gt;l4_gpu0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7379.49,-1886.08C7128.83,-1885.16 6431.76,-1872.02 5864.87,-1761.81 5853.31,-1759.56 5841.27,-1756.54 5829.53,-1753.2"/>
<polygon fill="black" stroke="black" points="5830.34,-1749.79 5819.76,-1750.32 5828.36,-1756.5 5830.34,-1749.79"/>
</g>
<!-- l4_gpu0_exp1 -->
<g id="node65" class="node">
<title>l4_gpu0_exp1</title>
<ellipse fill="none" stroke="black" cx="5979.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5979.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5979.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="5979.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu0_exp1 -->
<g id="edge108" class="edge">
<title>l4_gate&#45;&gt;l4_gpu0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7378.48,-1884.33C7152.17,-1879.31 6570.07,-1857.34 6094.87,-1761.81 6083.4,-1759.51 6071.46,-1756.47 6059.8,-1753.13"/>
<polygon fill="black" stroke="black" points="6060.68,-1749.74 6050.09,-1750.27 6058.69,-1756.45 6060.68,-1749.74"/>
</g>
<!-- l4_gpu0_exp2 -->
<g id="node66" class="node">
<title>l4_gpu0_exp2</title>
<ellipse fill="none" stroke="black" cx="6209.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="6209.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6209.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="6209.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu0_exp2 -->
<g id="edge110" class="edge">
<title>l4_gate&#45;&gt;l4_gpu0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7377.3,-1881.87C7177.73,-1872.35 6709.3,-1842.66 6324.87,-1761.81 6313.5,-1759.42 6301.66,-1756.35 6290.09,-1753.02"/>
<polygon fill="black" stroke="black" points="6291.03,-1749.64 6280.44,-1750.16 6289.04,-1756.36 6291.03,-1749.64"/>
</g>
<!-- l4_gpu0_exp3 -->
<g id="node67" class="node">
<title>l4_gpu0_exp3</title>
<ellipse fill="none" stroke="black" cx="6439.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="6439.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6439.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="6439.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu0_exp3 -->
<g id="edge112" class="edge">
<title>l4_gate&#45;&gt;l4_gpu0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7375.85,-1878.13C7206.2,-1863.71 6849.74,-1827.93 6554.87,-1761.81 6543.73,-1759.31 6532.12,-1756.23 6520.74,-1752.91"/>
<polygon fill="black" stroke="black" points="6521.4,-1749.46 6510.82,-1749.95 6519.4,-1756.16 6521.4,-1749.46"/>
</g>
<!-- l4_gpu1_exp0 -->
<g id="node68" class="node">
<title>l4_gpu1_exp0</title>
<ellipse fill="none" stroke="black" cx="6669.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="6669.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="6669.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6669.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu1_exp0 -->
<g id="edge114" class="edge">
<title>l4_gate&#45;&gt;l4_gpu1_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7372.87,-1871.7C7237.45,-1852.01 6991.34,-1812.88 6784.87,-1761.81 6773.94,-1759.11 6762.53,-1755.93 6751.33,-1752.6"/>
<polygon fill="black" stroke="black" points="6752.13,-1749.19 6741.55,-1749.64 6750.11,-1755.89 6752.13,-1749.19"/>
</g>
<!-- l4_gpu1_exp1 -->
<g id="node69" class="node">
<title>l4_gpu1_exp1</title>
<ellipse fill="none" stroke="black" cx="6899.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="6899.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="6899.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="6899.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu1_exp1 -->
<g id="edge116" class="edge">
<title>l4_gate&#45;&gt;l4_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7366.22,-1857.96C7272.77,-1833.66 7134.52,-1796.9 7014.87,-1761.81 7004.49,-1758.77 6993.61,-1755.46 6982.86,-1752.13"/>
<polygon fill="black" stroke="black" points="6983.63,-1748.71 6973.04,-1749.07 6981.54,-1755.39 6983.63,-1748.71"/>
</g>
<!-- l4_gpu1_exp2 -->
<g id="node70" class="node">
<title>l4_gpu1_exp2</title>
<ellipse fill="none" stroke="black" cx="7129.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="7129.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="7129.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7129.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu1_exp2 -->
<g id="edge118" class="edge">
<title>l4_gate&#45;&gt;l4_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7362.86,-1833.71C7309.19,-1808.74 7246.56,-1779.61 7199.76,-1757.85"/>
<polygon fill="black" stroke="black" points="7201.17,-1754.64 7190.62,-1753.59 7198.21,-1760.99 7201.17,-1754.64"/>
</g>
<!-- l4_gpu1_exp3 -->
<g id="node71" class="node">
<title>l4_gpu1_exp3</title>
<ellipse fill="none" stroke="black" cx="7359.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="7359.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="7359.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="7359.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu1_exp3 -->
<g id="edge120" class="edge">
<title>l4_gate&#45;&gt;l4_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7437.54,-1833.71C7422.62,-1812.89 7405.62,-1789.18 7391.34,-1769.25"/>
<polygon fill="black" stroke="black" points="7394.07,-1767.05 7385.4,-1760.96 7388.38,-1771.13 7394.07,-1767.05"/>
</g>
<!-- l4_gpu2_exp0 -->
<g id="node72" class="node">
<title>l4_gpu2_exp0</title>
<ellipse fill="none" stroke="black" cx="7589.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="7589.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7589.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7589.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu2_exp0 -->
<g id="edge122" class="edge">
<title>l4_gate&#45;&gt;l4_gpu2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7512.21,-1833.71C7527.13,-1812.89 7544.13,-1789.18 7558.41,-1769.25"/>
<polygon fill="black" stroke="black" points="7561.36,-1771.13 7564.34,-1760.96 7555.67,-1767.05 7561.36,-1771.13"/>
</g>
<!-- l4_gpu2_exp1 -->
<g id="node73" class="node">
<title>l4_gpu2_exp1</title>
<ellipse fill="none" stroke="black" cx="7819.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="7819.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="7819.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7819.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu2_exp1 -->
<g id="edge124" class="edge">
<title>l4_gate&#45;&gt;l4_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7552.73,-1849.6C7611.94,-1822.06 7692.69,-1784.5 7749.87,-1757.9"/>
<polygon fill="black" stroke="black" points="7751.6,-1760.95 7759.19,-1753.56 7748.65,-1754.61 7751.6,-1760.95"/>
</g>
<!-- l4_gpu2_exp2 -->
<g id="node74" class="node">
<title>l4_gpu2_exp2</title>
<ellipse fill="none" stroke="black" cx="8049.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="8049.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="8049.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8049.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu2_exp2 -->
<g id="edge126" class="edge">
<title>l4_gate&#45;&gt;l4_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7559.54,-1864.18C7652.07,-1840.26 7804.51,-1800.04 7934.87,-1761.81 7945.26,-1758.77 7956.14,-1755.46 7966.89,-1752.13"/>
<polygon fill="black" stroke="black" points="7968.21,-1755.39 7976.71,-1749.07 7966.12,-1748.71 7968.21,-1755.39"/>
</g>
<!-- l4_gpu2_exp3 -->
<g id="node75" class="node">
<title>l4_gpu2_exp3</title>
<ellipse fill="none" stroke="black" cx="8279.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="8279.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="8279.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="8279.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu2_exp3 -->
<g id="edge128" class="edge">
<title>l4_gate&#45;&gt;l4_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7563.87,-1873.58C7696.06,-1854.57 7951.61,-1814.56 8164.87,-1761.81 8175.8,-1759.11 8187.21,-1755.93 8198.42,-1752.6"/>
<polygon fill="black" stroke="black" points="8199.64,-1755.89 8208.2,-1749.64 8197.61,-1749.19 8199.64,-1755.89"/>
</g>
<!-- l4_gpu3_exp0 -->
<g id="node76" class="node">
<title>l4_gpu3_exp0</title>
<ellipse fill="none" stroke="black" cx="8509.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="8509.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="8509.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8509.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu3_exp0 -->
<g id="edge130" class="edge">
<title>l4_gate&#45;&gt;l4_gpu3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7566.23,-1878.78C7732.6,-1864.8 8095.49,-1828.94 8394.87,-1761.81 8406.02,-1759.31 8417.63,-1756.23 8429.01,-1752.91"/>
<polygon fill="black" stroke="black" points="8430.35,-1756.16 8438.93,-1749.95 8428.35,-1749.46 8430.35,-1756.16"/>
</g>
<!-- l4_gpu3_exp1 -->
<g id="node77" class="node">
<title>l4_gpu3_exp1</title>
<ellipse fill="none" stroke="black" cx="8739.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="8739.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="8739.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8739.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu3_exp1 -->
<g id="edge132" class="edge">
<title>l4_gate&#45;&gt;l4_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7567.9,-1882.08C7764.83,-1872.81 8237.5,-1843.28 8624.87,-1761.81 8636.24,-1759.42 8648.08,-1756.35 8659.66,-1753.02"/>
<polygon fill="black" stroke="black" points="8660.71,-1756.36 8669.3,-1750.16 8658.72,-1749.64 8660.71,-1756.36"/>
</g>
<!-- l4_gpu3_exp2 -->
<g id="node78" class="node">
<title>l4_gpu3_exp2</title>
<ellipse fill="none" stroke="black" cx="8969.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="8969.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="8969.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8969.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu3_exp2 -->
<g id="edge134" class="edge">
<title>l4_gate&#45;&gt;l4_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7569.17,-1884.38C7793.96,-1879.45 8378.2,-1857.64 8854.87,-1761.81 8866.34,-1759.51 8878.28,-1756.47 8889.94,-1753.13"/>
<polygon fill="black" stroke="black" points="8891.05,-1756.45 8899.65,-1750.27 8889.07,-1749.74 8891.05,-1756.45"/>
</g>
<!-- l4_gpu3_exp3 -->
<g id="node79" class="node">
<title>l4_gpu3_exp3</title>
<ellipse fill="none" stroke="black" cx="9199.87" cy="-1724.34" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="9199.87" y="-1735.64" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="9199.87" y="-1720.64" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9199.87" y="-1705.64" font-family="Times,serif" font-size="14.00">[Variable tokens]</text>
</g>
<!-- l4_gate&#45;&gt;l4_gpu3_exp3 -->
<g id="edge136" class="edge">
<title>l4_gate&#45;&gt;l4_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7569.8,-1886.08C7820.08,-1885.17 8517.64,-1872.09 9084.87,-1761.81 9096.44,-1759.56 9108.47,-1756.54 9120.21,-1753.2"/>
<polygon fill="black" stroke="black" points="9121.38,-1756.5 9129.99,-1750.32 9119.41,-1749.79 9121.38,-1756.5"/>
</g>
<!-- l4_agg -->
<g id="node80" class="node">
<title>l4_agg</title>
<polygon fill="none" stroke="black" points="7594.33,-1614.86 7404.3,-1614.86 7355.42,-1508.86 7545.44,-1508.86 7594.33,-1614.86"/>
<text text-anchor="middle" x="7474.87" y="-1573.16" font-family="Times,serif" font-size="14.00">Aggregate</text>
<text text-anchor="middle" x="7474.87" y="-1558.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="7474.87" y="-1543.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l4_gpu0_exp0&#45;&gt;l4_agg -->
<g id="edge107" class="edge">
<title>l4_gpu0_exp0&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M5819.76,-1698.35C5834.5,-1693.88 5850.07,-1689.74 5864.87,-1686.86 6424.63,-1578.04 7111.3,-1563.86 7369.82,-1562.63"/>
<polygon fill="black" stroke="black" points="7369.96,-1566.13 7379.95,-1562.59 7369.93,-1559.13 7369.96,-1566.13"/>
</g>
<!-- l4_gpu0_exp1&#45;&gt;l4_agg -->
<g id="edge109" class="edge">
<title>l4_gpu0_exp1&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M6050.09,-1698.41C6064.74,-1693.96 6080.19,-1689.81 6094.87,-1686.86 6564.56,-1592.44 7138.69,-1569.88 7370.47,-1564.52"/>
<polygon fill="black" stroke="black" points="7370.66,-1568.02 7380.58,-1564.29 7370.5,-1561.02 7370.66,-1568.02"/>
</g>
<!-- l4_gpu0_exp2&#45;&gt;l4_agg -->
<g id="edge111" class="edge">
<title>l4_gpu0_exp2&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M6280.44,-1698.52C6294.99,-1694.09 6310.32,-1689.92 6324.87,-1686.86 6705.82,-1606.75 7169.25,-1576.86 7371.81,-1567.07"/>
<polygon fill="black" stroke="black" points="7372.02,-1570.57 7381.84,-1566.59 7371.69,-1563.57 7372.02,-1570.57"/>
</g>
<!-- l4_gpu0_exp3&#45;&gt;l4_agg -->
<g id="edge113" class="edge">
<title>l4_gpu0_exp3&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M6510.82,-1698.72C6525.27,-1694.31 6540.46,-1690.09 6554.87,-1686.86 6848.41,-1621.05 7202.99,-1585.28 7373.55,-1570.74"/>
<polygon fill="black" stroke="black" points="7373.85,-1574.23 7383.52,-1569.89 7373.26,-1567.25 7373.85,-1574.23"/>
</g>
<!-- l4_gpu1_exp0&#45;&gt;l4_agg -->
<g id="edge115" class="edge">
<title>l4_gpu1_exp0&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M6741.55,-1699.03C6755.81,-1694.64 6770.74,-1690.36 6784.87,-1686.86 6992.93,-1635.4 7241.23,-1596.06 7375.97,-1576.52"/>
<polygon fill="black" stroke="black" points="7376.48,-1579.98 7385.87,-1575.09 7375.48,-1573.06 7376.48,-1579.98"/>
</g>
<!-- l4_gpu1_exp1&#45;&gt;l4_agg -->
<g id="edge117" class="edge">
<title>l4_gpu1_exp1&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M6973.04,-1699.6C6986.9,-1695.25 7001.31,-1690.84 7014.87,-1686.86 7140.78,-1649.94 7287.28,-1611.16 7380.51,-1587"/>
<polygon fill="black" stroke="black" points="7381.4,-1590.39 7390.2,-1584.5 7379.64,-1583.61 7381.4,-1590.39"/>
</g>
<!-- l4_gpu1_exp2&#45;&gt;l4_agg -->
<g id="edge119" class="edge">
<title>l4_gpu1_exp2&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M7190.76,-1695.02C7245.31,-1669.64 7325.97,-1632.12 7387.42,-1603.54"/>
<polygon fill="black" stroke="black" points="7389.14,-1606.6 7396.73,-1599.21 7386.19,-1600.25 7389.14,-1606.6"/>
</g>
<!-- l4_gpu1_exp3&#45;&gt;l4_agg -->
<g id="edge121" class="edge">
<title>l4_gpu1_exp3&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M7385.11,-1688.12C7398.71,-1669.14 7415.88,-1645.19 7431.54,-1623.33"/>
<polygon fill="black" stroke="black" points="7434.48,-1625.23 7437.46,-1615.07 7428.79,-1621.16 7434.48,-1625.23"/>
</g>
<!-- l4_gpu2_exp0&#45;&gt;l4_agg -->
<g id="edge123" class="edge">
<title>l4_gpu2_exp0&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M7564.64,-1688.12C7551.03,-1669.14 7533.87,-1645.19 7518.21,-1623.33"/>
<polygon fill="black" stroke="black" points="7520.96,-1621.16 7512.29,-1615.07 7515.27,-1625.23 7520.96,-1621.16"/>
</g>
<!-- l4_gpu2_exp1&#45;&gt;l4_agg -->
<g id="edge125" class="edge">
<title>l4_gpu2_exp1&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M7758.99,-1695.02C7713.91,-1674.05 7651.01,-1644.79 7595.85,-1619.13"/>
<polygon fill="black" stroke="black" points="7597.26,-1615.93 7586.72,-1614.88 7594.31,-1622.28 7597.26,-1615.93"/>
</g>
<!-- l4_gpu2_exp2&#45;&gt;l4_agg -->
<g id="edge127" class="edge">
<title>l4_gpu2_exp2&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M7976.71,-1699.6C7962.85,-1695.25 7948.44,-1690.84 7934.87,-1686.86 7819.31,-1652.97 7686.41,-1617.52 7593.26,-1593.25"/>
<polygon fill="black" stroke="black" points="7594.09,-1589.85 7583.53,-1590.71 7592.32,-1596.62 7594.09,-1589.85"/>
</g>
<!-- l4_gpu2_exp3&#45;&gt;l4_agg -->
<g id="edge129" class="edge">
<title>l4_gpu2_exp3&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M8208.2,-1699.03C8193.94,-1694.64 8179,-1690.36 8164.87,-1686.86 7963.45,-1637.04 7724.29,-1598.58 7586.99,-1578.45"/>
<polygon fill="black" stroke="black" points="7587.28,-1574.95 7576.88,-1576.97 7586.27,-1581.88 7587.28,-1574.95"/>
</g>
<!-- l4_gpu3_exp0&#45;&gt;l4_agg -->
<g id="edge131" class="edge">
<title>l4_gpu3_exp0&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M8438.93,-1698.72C8424.48,-1694.31 8409.28,-1690.09 8394.87,-1686.86 8105.77,-1622.04 7757.45,-1586.37 7584.05,-1571.41"/>
<polygon fill="black" stroke="black" points="7584.16,-1567.91 7573.9,-1570.54 7583.56,-1574.88 7584.16,-1567.91"/>
</g>
<!-- l4_gpu3_exp1&#45;&gt;l4_agg -->
<g id="edge133" class="edge">
<title>l4_gpu3_exp1&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M8669.3,-1698.52C8654.75,-1694.09 8639.43,-1689.92 8624.87,-1686.86 8246.83,-1607.36 7787.55,-1577.32 7582.61,-1567.3"/>
<polygon fill="black" stroke="black" points="7582.61,-1563.79 7572.45,-1566.81 7582.27,-1570.79 7582.61,-1563.79"/>
</g>
<!-- l4_gpu3_exp2&#45;&gt;l4_agg -->
<g id="edge135" class="edge">
<title>l4_gpu3_exp2&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M8899.65,-1698.41C8885.01,-1693.96 8869.56,-1689.81 8854.87,-1686.86 8386.64,-1592.73 7814.61,-1570.02 7581.44,-1564.57"/>
<polygon fill="black" stroke="black" points="7581.34,-1561.07 7571.27,-1564.34 7581.18,-1568.07 7581.34,-1561.07"/>
</g>
<!-- l4_gpu3_exp3&#45;&gt;l4_agg -->
<g id="edge137" class="edge">
<title>l4_gpu3_exp3&#45;&gt;l4_agg</title>
<path fill="none" stroke="black" d="M9129.99,-1698.35C9115.25,-1693.88 9099.68,-1689.74 9084.87,-1686.86 8525.46,-1578.11 7839.28,-1563.88 7580.4,-1562.63"/>
<polygon fill="black" stroke="black" points="7580.27,-1559.13 7570.26,-1562.59 7580.24,-1566.13 7580.27,-1559.13"/>
</g>
<!-- l4_res -->
<g id="node81" class="node">
<title>l4_res</title>
<polygon fill="none" stroke="black" points="7474.87,-1436.86 7359.87,-1383.86 7474.87,-1330.86 7589.87,-1383.86 7474.87,-1436.86"/>
<text text-anchor="middle" x="7474.87" y="-1395.16" font-family="Times,serif" font-size="14.00">Residual</text>
<text text-anchor="middle" x="7474.87" y="-1380.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="7474.87" y="-1365.16" font-family="Times,serif" font-size="14.00">All 16 GPUs</text>
</g>
<!-- l4_agg&#45;&gt;l4_res -->
<g id="edge138" class="edge">
<title>l4_agg&#45;&gt;l4_res</title>
<path fill="none" stroke="black" d="M7474.87,-1508.53C7474.87,-1489.2 7474.87,-1467.11 7474.87,-1446.99"/>
<polygon fill="black" stroke="black" points="7478.37,-1446.99 7474.87,-1436.99 7471.37,-1446.99 7478.37,-1446.99"/>
</g>
<!-- output -->
<g id="node82" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="7474.87" cy="-1205.86" rx="81.13" ry="37.45"/>
<text text-anchor="middle" x="7474.87" y="-1217.16" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="7474.87" y="-1202.16" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="7474.87" y="-1187.16" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l4_res&#45;&gt;output -->
<g id="edge139" class="edge">
<title>l4_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M7474.87,-1330.53C7474.87,-1306.08 7474.87,-1277.21 7474.87,-1253.51"/>
<polygon fill="black" stroke="black" points="7478.37,-1253.36 7474.87,-1243.36 7471.37,-1253.36 7478.37,-1253.36"/>
</g>
</g>
</svg>
