<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1208pt" height="1440pt"
 viewBox="0.00 0.00 1207.63 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.23 0.23) rotate(0) translate(4 6197.77)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-6197.77 5197,-6197.77 5197,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3608,-5893.81 3608,-6185.77 3814,-6185.77 3814,-5893.81 3608,-5893.81"/>
<text text-anchor="middle" x="3711" y="-6170.57" font-family="Times,serif" font-size="14.00">Input Processing</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="579,-4491.86 579,-5885.81 4804,-5885.81 4804,-4491.86 579,-4491.86"/>
<text text-anchor="middle" x="2691.5" y="-5870.61" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="960,-3089.91 960,-4483.86 5185,-4483.86 5185,-3089.91 960,-3089.91"/>
<text text-anchor="middle" x="3072.5" y="-4468.66" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="218,-1687.95 218,-3081.91 4443,-3081.91 4443,-1687.95 218,-1687.95"/>
<text text-anchor="middle" x="2330.5" y="-3066.71" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-286 8,-1679.95 4233,-1679.95 4233,-286 8,-286"/>
<text text-anchor="middle" x="2120.5" y="-1664.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="3022,-8 3022,-278 3258,-278 3258,-8 3022,-8"/>
<text text-anchor="middle" x="3140" y="-262.8" font-family="Times,serif" font-size="14.00">Output Processing</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<ellipse fill="lightblue" stroke="black" cx="3711" cy="-6117.29" rx="94.51" ry="37.45"/>
<text text-anchor="middle" x="3711" y="-6128.59" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="3711" y="-6113.59" font-family="Times,serif" font-size="14.00">Shape: (1024, 1)</text>
<text text-anchor="middle" x="3711" y="-6098.59" font-family="Times,serif" font-size="14.00">GPU: CPU</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightgreen" stroke="black" points="3800.5,-6043.81 3621.5,-6043.81 3621.5,-5990.81 3800.5,-5990.81 3800.5,-6043.81"/>
<text text-anchor="middle" x="3711" y="-6028.61" font-family="Times,serif" font-size="14.00">Embedding Layer</text>
<text text-anchor="middle" x="3711" y="-6013.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3711" y="-5998.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- input_tokens&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M3711,-6079.81C3711,-6071.39 3711,-6062.45 3711,-6054.06"/>
<polygon fill="black" stroke="black" points="3714.5,-6053.82 3711,-6043.82 3707.5,-6053.82 3714.5,-6053.82"/>
</g>
<!-- pos_embed -->
<g id="node3" class="node">
<title>pos_embed</title>
<polygon fill="lightgreen" stroke="black" points="3800.5,-5954.81 3621.5,-5954.81 3621.5,-5901.81 3800.5,-5901.81 3800.5,-5954.81"/>
<text text-anchor="middle" x="3711" y="-5939.61" font-family="Times,serif" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="3711" y="-5924.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3711" y="-5909.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- embed&#45;&gt;pos_embed -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;pos_embed</title>
<path fill="none" stroke="black" d="M3711,-5990.68C3711,-5982.7 3711,-5973.75 3711,-5965.2"/>
<polygon fill="black" stroke="black" points="3714.5,-5965.06 3711,-5955.06 3707.5,-5965.06 3714.5,-5965.06"/>
</g>
<!-- mha_qkv_0 -->
<g id="node4" class="node">
<title>mha_qkv_0</title>
<polygon fill="lightgreen" stroke="black" points="3741.5,-5854.81 3562.5,-5854.81 3562.5,-5801.81 3741.5,-5801.81 3741.5,-5854.81"/>
<text text-anchor="middle" x="3652" y="-5839.61" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3652" y="-5824.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3652" y="-5809.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- pos_embed&#45;&gt;mha_qkv_0 -->
<g id="edge3" class="edge">
<title>pos_embed&#45;&gt;mha_qkv_0</title>
<path fill="none" stroke="black" d="M3695.5,-5901.56C3688.52,-5889.97 3680.18,-5876.12 3672.68,-5863.66"/>
<polygon fill="black" stroke="black" points="3675.55,-5861.65 3667.4,-5854.89 3669.56,-5865.26 3675.55,-5861.65"/>
</g>
<!-- mha_residual_0 -->
<g id="node7" class="node">
<title>mha_residual_0</title>
<polygon fill="lightyellow" stroke="black" points="3896.66,-5587.81 3601.32,-5587.81 3525.34,-5481.81 3820.68,-5481.81 3896.66,-5587.81"/>
<text text-anchor="middle" x="3711" y="-5546.11" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="3711" y="-5531.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3711" y="-5516.11" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- pos_embed&#45;&gt;mha_residual_0 -->
<g id="edge7" class="edge">
<title>pos_embed&#45;&gt;mha_residual_0</title>
<path fill="none" stroke="black" d="M3741.49,-5901.38C3745.36,-5896.62 3748.75,-5891.38 3751,-5885.81 3794.57,-5777.83 3775.65,-5737.62 3751,-5623.81 3749.1,-5615.02 3746.23,-5606.05 3742.9,-5597.36"/>
<polygon fill="black" stroke="black" points="3746.13,-5596.02 3739.12,-5588.07 3739.65,-5598.65 3746.13,-5596.02"/>
</g>
<!-- mha_attn_0 -->
<g id="node5" class="node">
<title>mha_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="3741.5,-5765.81 3562.5,-5765.81 3562.5,-5712.81 3741.5,-5712.81 3741.5,-5765.81"/>
<text text-anchor="middle" x="3652" y="-5750.61" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3652" y="-5735.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3652" y="-5720.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_qkv_0&#45;&gt;mha_attn_0 -->
<g id="edge4" class="edge">
<title>mha_qkv_0&#45;&gt;mha_attn_0</title>
<path fill="none" stroke="black" d="M3652,-5801.68C3652,-5793.7 3652,-5784.75 3652,-5776.2"/>
<polygon fill="black" stroke="black" points="3655.5,-5776.06 3652,-5766.06 3648.5,-5776.06 3655.5,-5776.06"/>
</g>
<!-- mha_out_0 -->
<g id="node6" class="node">
<title>mha_out_0</title>
<polygon fill="lightgreen" stroke="black" points="3741.5,-5676.81 3562.5,-5676.81 3562.5,-5623.81 3741.5,-5623.81 3741.5,-5676.81"/>
<text text-anchor="middle" x="3652" y="-5661.61" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="3652" y="-5646.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3652" y="-5631.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_attn_0&#45;&gt;mha_out_0 -->
<g id="edge5" class="edge">
<title>mha_attn_0&#45;&gt;mha_out_0</title>
<path fill="none" stroke="black" d="M3652,-5712.68C3652,-5704.7 3652,-5695.75 3652,-5687.2"/>
<polygon fill="black" stroke="black" points="3655.5,-5687.06 3652,-5677.06 3648.5,-5687.06 3655.5,-5687.06"/>
</g>
<!-- mha_out_0&#45;&gt;mha_residual_0 -->
<g id="edge6" class="edge">
<title>mha_out_0&#45;&gt;mha_residual_0</title>
<path fill="none" stroke="black" d="M3665.39,-5623.56C3669.56,-5615.53 3674.36,-5606.31 3679.23,-5596.92"/>
<polygon fill="black" stroke="black" points="3682.41,-5598.4 3683.92,-5587.91 3676.2,-5595.17 3682.41,-5598.4"/>
</g>
<!-- ln1_0 -->
<g id="node8" class="node">
<title>ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="3800.5,-5445.81 3621.5,-5445.81 3621.5,-5392.81 3800.5,-5392.81 3800.5,-5445.81"/>
<text text-anchor="middle" x="3711" y="-5430.61" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="3711" y="-5415.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3711" y="-5400.61" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_residual_0&#45;&gt;ln1_0 -->
<g id="edge8" class="edge">
<title>mha_residual_0&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M3711,-5481.71C3711,-5473.04 3711,-5464.23 3711,-5456.08"/>
<polygon fill="black" stroke="black" points="3714.5,-5455.83 3711,-5445.83 3707.5,-5455.83 3714.5,-5455.83"/>
</g>
<!-- gate_0 -->
<g id="node9" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="2979.83,-5356.81 2714.44,-5356.81 2646.17,-5250.81 2911.56,-5250.81 2979.83,-5356.81"/>
<text text-anchor="middle" x="2813" y="-5315.11" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="2813" y="-5300.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="2813" y="-5285.11" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_0&#45;&gt;gate_0 -->
<g id="edge9" class="edge">
<title>ln1_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M3621.2,-5406.96C3468.57,-5387.67 3156.81,-5348.27 2968.24,-5324.43"/>
<polygon fill="black" stroke="black" points="2968.6,-5320.95 2958.24,-5323.17 2967.72,-5327.9 2968.6,-5320.95"/>
</g>
<!-- moe_residual_0 -->
<g id="node75" class="node">
<title>moe_residual_0</title>
<polygon fill="lightyellow" stroke="black" points="3364.66,-4694.86 3069.32,-4694.86 2993.34,-4588.86 3288.68,-4588.86 3364.66,-4694.86"/>
<text text-anchor="middle" x="3179" y="-4653.16" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="3179" y="-4638.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3179" y="-4623.16" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_0&#45;&gt;moe_residual_0 -->
<g id="edge90" class="edge">
<title>ln1_0&#45;&gt;moe_residual_0</title>
<path fill="none" stroke="black" d="M3800.63,-5417.51C4060.34,-5412.78 4795,-5381.45 4795,-5178.34 4795,-5178.34 4795,-5178.34 4795,-4898.36 4795,-4752.55 3755.26,-4676.26 3343.78,-4651.78"/>
<polygon fill="black" stroke="black" points="3343.77,-4648.28 3333.58,-4651.18 3343.36,-4655.27 3343.77,-4648.28"/>
</g>
<!-- route_to_expert_0_0 -->
<g id="node10" class="node">
<title>route_to_expert_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="709" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="709" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="709" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="709" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_0 -->
<g id="edge10" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2678.26,-5300.75C2293.75,-5294.22 1196.09,-5271.06 841,-5214.81 828.68,-5212.86 815.86,-5210.18 803.27,-5207.14"/>
<polygon fill="black" stroke="black" points="803.79,-5203.66 793.24,-5204.64 802.09,-5210.46 803.79,-5203.66"/>
</g>
<!-- route_to_expert_0_1 -->
<g id="node14" class="node">
<title>route_to_expert_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="972" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="972" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="972" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="972" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_1 -->
<g id="edge14" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2677.46,-5299.65C2328.61,-5290.9 1406.07,-5263.73 1104,-5214.81 1091.68,-5212.82 1078.87,-5210.11 1066.28,-5207.06"/>
<polygon fill="black" stroke="black" points="1066.8,-5203.58 1056.25,-5204.55 1065.1,-5210.38 1066.8,-5203.58"/>
</g>
<!-- route_to_expert_0_2 -->
<g id="node18" class="node">
<title>route_to_expert_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="1235" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1235" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="1235" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1235" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_2 -->
<g id="edge18" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2676.55,-5298.15C2366.48,-5286.96 1616.48,-5256.41 1367,-5214.81 1354.79,-5212.78 1342.08,-5210.06 1329.59,-5207.02"/>
<polygon fill="black" stroke="black" points="1330.18,-5203.56 1319.62,-5204.53 1328.47,-5210.35 1330.18,-5203.56"/>
</g>
<!-- route_to_expert_0_3 -->
<g id="node22" class="node">
<title>route_to_expert_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="1498" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1498" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="1498" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1498" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_3 -->
<g id="edge22" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2678.45,-5301.33C2457.85,-5297 2006.15,-5280.13 1630,-5214.81 1617.89,-5212.71 1605.29,-5209.97 1592.9,-5206.94"/>
<polygon fill="black" stroke="black" points="1593.56,-5203.49 1583.01,-5204.45 1591.85,-5210.28 1593.56,-5203.49"/>
</g>
<!-- route_to_expert_0_4 -->
<g id="node26" class="node">
<title>route_to_expert_0_4</title>
<ellipse fill="lightblue" stroke="black" cx="1761" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1761" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1761" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1761" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_4 -->
<g id="edge26" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2675.97,-5297.16C2495.31,-5288.02 2168.14,-5265.59 1893,-5214.81 1881.01,-5212.6 1868.52,-5209.81 1856.22,-5206.76"/>
<polygon fill="black" stroke="black" points="1856.97,-5203.34 1846.41,-5204.27 1855.24,-5210.12 1856.97,-5203.34"/>
</g>
<!-- route_to_expert_0_5 -->
<g id="node30" class="node">
<title>route_to_expert_0_5</title>
<ellipse fill="lightblue" stroke="black" cx="2024" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2024" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="2024" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2024" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_5 -->
<g id="edge30" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2670.77,-5289.42C2537.06,-5275.51 2331.76,-5250.69 2156,-5214.81 2144.35,-5212.44 2132.22,-5209.6 2120.23,-5206.56"/>
<polygon fill="black" stroke="black" points="2120.77,-5203.09 2110.22,-5203.98 2119.02,-5209.87 2120.77,-5203.09"/>
</g>
<!-- route_to_expert_0_6 -->
<g id="node34" class="node">
<title>route_to_expert_0_6</title>
<ellipse fill="lightblue" stroke="black" cx="2287" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2287" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="2287" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2287" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_6 -->
<g id="edge34" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2658.21,-5270.11C2585.41,-5254.25 2497.54,-5234.42 2419,-5214.81 2408.03,-5212.07 2396.58,-5209.09 2385.2,-5206.06"/>
<polygon fill="black" stroke="black" points="2385.8,-5202.59 2375.24,-5203.38 2383.99,-5209.35 2385.8,-5202.59"/>
</g>
<!-- route_to_expert_0_7 -->
<g id="node38" class="node">
<title>route_to_expert_0_7</title>
<ellipse fill="lightblue" stroke="black" cx="2550" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2550" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="2550" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2550" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_7 -->
<g id="edge38" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2702.99,-5250.75C2676.53,-5238.22 2648.87,-5225.13 2624.47,-5213.58"/>
<polygon fill="black" stroke="black" points="2625.82,-5210.35 2615.29,-5209.24 2622.83,-5216.68 2625.82,-5210.35"/>
</g>
<!-- route_to_expert_0_8 -->
<g id="node42" class="node">
<title>route_to_expert_0_8</title>
<ellipse fill="lightblue" stroke="black" cx="2813" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2813" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2813" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2813" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_8 -->
<g id="edge42" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2813,-5250.75C2813,-5242.31 2813,-5233.63 2813,-5225.32"/>
<polygon fill="black" stroke="black" points="2816.5,-5225.06 2813,-5215.06 2809.5,-5225.06 2816.5,-5225.06"/>
</g>
<!-- route_to_expert_0_9 -->
<g id="node46" class="node">
<title>route_to_expert_0_9</title>
<ellipse fill="lightblue" stroke="black" cx="3076" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3076" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="3076" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3076" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_9 -->
<g id="edge46" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2914.31,-5254.87C2943.43,-5241.08 2974.64,-5226.31 3001.8,-5213.46"/>
<polygon fill="black" stroke="black" points="3003.3,-5216.62 3010.84,-5209.18 3000.3,-5210.29 3003.3,-5216.62"/>
</g>
<!-- route_to_expert_0_10 -->
<g id="node50" class="node">
<title>route_to_expert_0_10</title>
<ellipse fill="lightblue" stroke="black" cx="3339" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3339" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="3339" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3339" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_10 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2929.73,-5278.34C3008.33,-5261.47 3114.18,-5237.99 3207,-5214.81 3217.97,-5212.07 3229.42,-5209.09 3240.8,-5206.06"/>
<polygon fill="black" stroke="black" points="3242.01,-5209.35 3250.76,-5203.38 3240.2,-5202.59 3242.01,-5209.35"/>
</g>
<!-- route_to_expert_0_11 -->
<g id="node54" class="node">
<title>route_to_expert_0_11</title>
<ellipse fill="lightblue" stroke="black" cx="3602" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3602" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3602" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3602" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_11 -->
<g id="edge54" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2937.66,-5291.23C3070.44,-5277.71 3286.35,-5252.3 3470,-5214.81 3481.65,-5212.44 3493.78,-5209.6 3505.77,-5206.56"/>
<polygon fill="black" stroke="black" points="3506.98,-5209.87 3515.78,-5203.98 3505.23,-5203.09 3506.98,-5209.87"/>
</g>
<!-- route_to_expert_0_12 -->
<g id="node58" class="node">
<title>route_to_expert_0_12</title>
<ellipse fill="lightblue" stroke="black" cx="3865" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3865" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3865" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3865" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_12 -->
<g id="edge58" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2941.97,-5297.57C3120.83,-5288.69 3453.72,-5266.35 3733,-5214.81 3744.99,-5212.6 3757.48,-5209.81 3769.78,-5206.76"/>
<polygon fill="black" stroke="black" points="3770.76,-5210.12 3779.59,-5204.27 3769.03,-5203.34 3770.76,-5210.12"/>
</g>
<!-- route_to_expert_0_13 -->
<g id="node62" class="node">
<title>route_to_expert_0_13</title>
<ellipse fill="lightblue" stroke="black" cx="4128" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4128" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="4128" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4128" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_13 -->
<g id="edge62" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2944.44,-5301.39C3163.88,-5297.15 3618.07,-5280.44 3996,-5214.81 4008.11,-5212.71 4020.71,-5209.97 4033.1,-5206.94"/>
<polygon fill="black" stroke="black" points="4034.15,-5210.28 4042.99,-5204.45 4032.44,-5203.49 4034.15,-5210.28"/>
</g>
<!-- route_to_expert_0_14 -->
<g id="node66" class="node">
<title>route_to_expert_0_14</title>
<ellipse fill="lightblue" stroke="black" cx="4391" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4391" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="4391" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4391" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_14 -->
<g id="edge66" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2942.3,-5298.41C3247.84,-5287.44 4007.58,-5256.73 4259,-5214.81 4271.21,-5212.78 4283.92,-5210.06 4296.41,-5207.02"/>
<polygon fill="black" stroke="black" points="4297.53,-5210.35 4306.38,-5204.53 4295.82,-5203.56 4297.53,-5210.35"/>
</g>
<!-- route_to_expert_0_15 -->
<g id="node70" class="node">
<title>route_to_expert_0_15</title>
<ellipse fill="lightblue" stroke="black" cx="4654" cy="-5177.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4654" y="-5188.64" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4654" y="-5173.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4654" y="-5158.64" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_15 -->
<g id="edge70" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2943.19,-5299.79C3287.85,-5291.18 4218.37,-5263.98 4522,-5214.81 4534.32,-5212.82 4547.13,-5210.11 4559.72,-5207.06"/>
<polygon fill="black" stroke="black" points="4560.9,-5210.38 4569.75,-5204.55 4559.2,-5203.58 4560.9,-5210.38"/>
</g>
<!-- expert_linear1_0_0 -->
<g id="node11" class="node">
<title>expert_linear1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="826,-5103.86 644,-5103.86 644,-5050.86 826,-5050.86 826,-5103.86"/>
<text text-anchor="middle" x="735" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="735" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="735" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_0_0&#45;&gt;expert_linear1_0_0 -->
<g id="edge11" class="edge">
<title>route_to_expert_0_0&#45;&gt;expert_linear1_0_0</title>
<path fill="none" stroke="black" d="M718.68,-5139.85C720.96,-5131.25 723.39,-5122.1 725.66,-5113.55"/>
<polygon fill="black" stroke="black" points="729.05,-5114.43 728.23,-5103.87 722.28,-5112.64 729.05,-5114.43"/>
</g>
<!-- expert_activation_0_0 -->
<g id="node12" class="node">
<title>expert_activation_0_0</title>
<polygon fill="lightgreen" stroke="black" points="846,-5014.86 664,-5014.86 664,-4961.86 846,-4961.86 846,-5014.86"/>
<text text-anchor="middle" x="755" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="755" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="755" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_0_0&#45;&gt;expert_activation_0_0 -->
<g id="edge12" class="edge">
<title>expert_linear1_0_0&#45;&gt;expert_activation_0_0</title>
<path fill="none" stroke="black" d="M740.89,-5050.73C742.75,-5042.66 744.83,-5033.6 746.82,-5024.96"/>
<polygon fill="black" stroke="black" points="750.25,-5025.64 749.08,-5015.11 743.43,-5024.07 750.25,-5025.64"/>
</g>
<!-- expert_linear2_0_0 -->
<g id="node13" class="node">
<title>expert_linear2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="955.5,-4925.86 782.5,-4925.86 782.5,-4872.86 955.5,-4872.86 955.5,-4925.86"/>
<text text-anchor="middle" x="869" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="869" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="869" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_0_0&#45;&gt;expert_linear2_0_0 -->
<g id="edge13" class="edge">
<title>expert_activation_0_0&#45;&gt;expert_linear2_0_0</title>
<path fill="none" stroke="black" d="M788.59,-4961.73C800.66,-4952.52 814.42,-4942.01 827.11,-4932.33"/>
<polygon fill="black" stroke="black" points="829.43,-4934.96 835.26,-4926.11 825.19,-4929.39 829.43,-4934.96"/>
</g>
<!-- aggregate_0 -->
<g id="node74" class="node">
<title>aggregate_0</title>
<polygon fill="lightyellow" stroke="black" points="3026.64,-4836.86 2686.79,-4836.86 2599.36,-4730.86 2939.21,-4730.86 3026.64,-4836.86"/>
<text text-anchor="middle" x="2813" y="-4795.16" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="2813" y="-4780.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="2813" y="-4765.16" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- expert_linear2_0_0&#45;&gt;aggregate_0 -->
<g id="edge74" class="edge">
<title>expert_linear2_0_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M955.6,-4881.41C975.07,-4878.11 995.69,-4875.01 1015,-4872.86 1605.53,-4807.09 2310.62,-4790.48 2634.4,-4786.28"/>
<polygon fill="black" stroke="black" points="2634.86,-4789.77 2644.82,-4786.15 2634.77,-4782.77 2634.86,-4789.77"/>
</g>
<!-- expert_linear1_0_1 -->
<g id="node15" class="node">
<title>expert_linear1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1104,-5103.86 922,-5103.86 922,-5050.86 1104,-5050.86 1104,-5103.86"/>
<text text-anchor="middle" x="1013" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="1013" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1013" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_0_1&#45;&gt;expert_linear1_0_1 -->
<g id="edge15" class="edge">
<title>route_to_expert_0_1&#45;&gt;expert_linear1_0_1</title>
<path fill="none" stroke="black" d="M987.15,-5140.13C990.8,-5131.42 994.69,-5122.13 998.31,-5113.46"/>
<polygon fill="black" stroke="black" points="1001.63,-5114.59 1002.26,-5104.02 995.17,-5111.89 1001.63,-5114.59"/>
</g>
<!-- expert_activation_0_1 -->
<g id="node16" class="node">
<title>expert_activation_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1140,-5014.86 958,-5014.86 958,-4961.86 1140,-4961.86 1140,-5014.86"/>
<text text-anchor="middle" x="1049" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="1049" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1049" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_0_1&#45;&gt;expert_activation_0_1 -->
<g id="edge16" class="edge">
<title>expert_linear1_0_1&#45;&gt;expert_activation_0_1</title>
<path fill="none" stroke="black" d="M1023.61,-5050.73C1027.02,-5042.48 1030.86,-5033.2 1034.5,-5024.4"/>
<polygon fill="black" stroke="black" points="1037.76,-5025.69 1038.34,-5015.11 1031.29,-5023.01 1037.76,-5025.69"/>
</g>
<!-- expert_linear2_0_1 -->
<g id="node17" class="node">
<title>expert_linear2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1197.5,-4925.86 1024.5,-4925.86 1024.5,-4872.86 1197.5,-4872.86 1197.5,-4925.86"/>
<text text-anchor="middle" x="1111" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="1111" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1111" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_0_1&#45;&gt;expert_linear2_0_1 -->
<g id="edge17" class="edge">
<title>expert_activation_0_1&#45;&gt;expert_linear2_0_1</title>
<path fill="none" stroke="black" d="M1067.27,-4961.73C1073.39,-4953.13 1080.32,-4943.41 1086.83,-4934.28"/>
<polygon fill="black" stroke="black" points="1089.7,-4936.28 1092.65,-4926.11 1084,-4932.22 1089.7,-4936.28"/>
</g>
<!-- expert_linear2_0_1&#45;&gt;aggregate_0 -->
<g id="edge75" class="edge">
<title>expert_linear2_0_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1197.85,-4882.79C1221.21,-4879.05 1246.51,-4875.41 1270,-4872.86 1763.64,-4819.34 2349.89,-4797.21 2636.91,-4789.06"/>
<polygon fill="black" stroke="black" points="2637.1,-4792.55 2646.99,-4788.77 2636.9,-4785.56 2637.1,-4792.55"/>
</g>
<!-- expert_linear1_0_2 -->
<g id="node19" class="node">
<title>expert_linear1_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1370,-5103.86 1188,-5103.86 1188,-5050.86 1370,-5050.86 1370,-5103.86"/>
<text text-anchor="middle" x="1279" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="1279" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1279" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_0_2&#45;&gt;expert_linear1_0_2 -->
<g id="edge19" class="edge">
<title>route_to_expert_0_2&#45;&gt;expert_linear1_0_2</title>
<path fill="none" stroke="black" d="M1251.26,-5140.13C1255.21,-5131.33 1259.44,-5121.93 1263.36,-5113.18"/>
<polygon fill="black" stroke="black" points="1266.57,-5114.57 1267.48,-5104.02 1260.19,-5111.7 1266.57,-5114.57"/>
</g>
<!-- expert_activation_0_2 -->
<g id="node20" class="node">
<title>expert_activation_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1387,-5014.86 1205,-5014.86 1205,-4961.86 1387,-4961.86 1387,-5014.86"/>
<text text-anchor="middle" x="1296" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1296" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1296" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_0_2&#45;&gt;expert_activation_0_2 -->
<g id="edge20" class="edge">
<title>expert_linear1_0_2&#45;&gt;expert_activation_0_2</title>
<path fill="none" stroke="black" d="M1284.01,-5050.73C1285.59,-5042.66 1287.36,-5033.6 1289.04,-5024.96"/>
<polygon fill="black" stroke="black" points="1292.49,-5025.6 1290.97,-5015.11 1285.62,-5024.25 1292.49,-5025.6"/>
</g>
<!-- expert_linear2_0_2 -->
<g id="node21" class="node">
<title>expert_linear2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1451.5,-4925.86 1278.5,-4925.86 1278.5,-4872.86 1451.5,-4872.86 1451.5,-4925.86"/>
<text text-anchor="middle" x="1365" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1365" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1365" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_0_2&#45;&gt;expert_linear2_0_2 -->
<g id="edge21" class="edge">
<title>expert_activation_0_2&#45;&gt;expert_linear2_0_2</title>
<path fill="none" stroke="black" d="M1316.33,-4961.73C1323.22,-4953.04 1331.02,-4943.21 1338.32,-4934"/>
<polygon fill="black" stroke="black" points="1341.11,-4936.12 1344.58,-4926.11 1335.62,-4931.77 1341.11,-4936.12"/>
</g>
<!-- expert_linear2_0_2&#45;&gt;aggregate_0 -->
<g id="edge76" class="edge">
<title>expert_linear2_0_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1451.71,-4883.18C1475.71,-4879.37 1501.82,-4875.6 1526,-4872.86 1922.74,-4827.97 2391.06,-4802.92 2638.86,-4791.85"/>
<polygon fill="black" stroke="black" points="2639.2,-4795.34 2649.03,-4791.4 2638.89,-4788.35 2639.2,-4795.34"/>
</g>
<!-- expert_linear1_0_3 -->
<g id="node23" class="node">
<title>expert_linear1_0_3</title>
<polygon fill="lightgreen" stroke="black" points="1594,-5103.86 1412,-5103.86 1412,-5050.86 1594,-5050.86 1594,-5103.86"/>
<text text-anchor="middle" x="1503" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1503" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1503" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_0_3&#45;&gt;expert_linear1_0_3 -->
<g id="edge23" class="edge">
<title>route_to_expert_0_3&#45;&gt;expert_linear1_0_3</title>
<path fill="none" stroke="black" d="M1499.86,-5139.85C1500.29,-5131.44 1500.75,-5122.49 1501.18,-5114.11"/>
<polygon fill="black" stroke="black" points="1504.68,-5114.04 1501.7,-5103.87 1497.69,-5113.68 1504.68,-5114.04"/>
</g>
<!-- expert_activation_0_3 -->
<g id="node24" class="node">
<title>expert_activation_0_3</title>
<polygon fill="lightgreen" stroke="black" points="1599,-5014.86 1417,-5014.86 1417,-4961.86 1599,-4961.86 1599,-5014.86"/>
<text text-anchor="middle" x="1508" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1508" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1508" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_0_3&#45;&gt;expert_activation_0_3 -->
<g id="edge24" class="edge">
<title>expert_linear1_0_3&#45;&gt;expert_activation_0_3</title>
<path fill="none" stroke="black" d="M1504.47,-5050.73C1504.93,-5042.75 1505.45,-5033.79 1505.94,-5025.24"/>
<polygon fill="black" stroke="black" points="1509.44,-5025.29 1506.52,-5015.11 1502.45,-5024.89 1509.44,-5025.29"/>
</g>
<!-- expert_linear2_0_3 -->
<g id="node25" class="node">
<title>expert_linear2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="1707.5,-4925.86 1534.5,-4925.86 1534.5,-4872.86 1707.5,-4872.86 1707.5,-4925.86"/>
<text text-anchor="middle" x="1621" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1621" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1621" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_0_3&#45;&gt;expert_linear2_0_3 -->
<g id="edge25" class="edge">
<title>expert_activation_0_3&#45;&gt;expert_linear2_0_3</title>
<path fill="none" stroke="black" d="M1541.29,-4961.73C1553.26,-4952.52 1566.9,-4942.01 1579.47,-4932.33"/>
<polygon fill="black" stroke="black" points="1581.77,-4934.98 1587.55,-4926.11 1577.5,-4929.44 1581.77,-4934.98"/>
</g>
<!-- expert_linear2_0_3&#45;&gt;aggregate_0 -->
<g id="edge77" class="edge">
<title>expert_linear2_0_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M1707.62,-4887.16C1745.2,-4882.46 1789.74,-4877.12 1830,-4872.86 2115.34,-4842.69 2448.01,-4814.33 2643.99,-4798.33"/>
<polygon fill="black" stroke="black" points="2644.4,-4801.81 2654.08,-4797.51 2643.83,-4794.83 2644.4,-4801.81"/>
</g>
<!-- expert_linear1_0_4 -->
<g id="node27" class="node">
<title>expert_linear1_0_4</title>
<polygon fill="lightgreen" stroke="black" points="1904,-5103.86 1722,-5103.86 1722,-5050.86 1904,-5050.86 1904,-5103.86"/>
<text text-anchor="middle" x="1813" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1813" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1813" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_0_4&#45;&gt;expert_linear1_0_4 -->
<g id="edge27" class="edge">
<title>route_to_expert_0_4&#45;&gt;expert_linear1_0_4</title>
<path fill="none" stroke="black" d="M1780.22,-5140.13C1784.94,-5131.23 1789.98,-5121.73 1794.67,-5112.91"/>
<polygon fill="black" stroke="black" points="1797.79,-5114.49 1799.38,-5104.02 1791.6,-5111.21 1797.79,-5114.49"/>
</g>
<!-- expert_activation_0_4 -->
<g id="node28" class="node">
<title>expert_activation_0_4</title>
<polygon fill="lightgreen" stroke="black" points="1956,-5014.86 1774,-5014.86 1774,-4961.86 1956,-4961.86 1956,-5014.86"/>
<text text-anchor="middle" x="1865" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1865" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1865" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_0_4&#45;&gt;expert_activation_0_4 -->
<g id="edge28" class="edge">
<title>expert_linear1_0_4&#45;&gt;expert_activation_0_4</title>
<path fill="none" stroke="black" d="M1828.32,-5050.73C1833.35,-5042.31 1839.03,-5032.81 1844.39,-5023.84"/>
<polygon fill="black" stroke="black" points="1847.48,-5025.49 1849.61,-5015.11 1841.47,-5021.9 1847.48,-5025.49"/>
</g>
<!-- expert_linear2_0_4 -->
<g id="node29" class="node">
<title>expert_linear2_0_4</title>
<polygon fill="lightgreen" stroke="black" points="2011.5,-4925.86 1838.5,-4925.86 1838.5,-4872.86 2011.5,-4872.86 2011.5,-4925.86"/>
<text text-anchor="middle" x="1925" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="1925" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1925" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_0_4&#45;&gt;expert_linear2_0_4 -->
<g id="edge29" class="edge">
<title>expert_activation_0_4&#45;&gt;expert_linear2_0_4</title>
<path fill="none" stroke="black" d="M1882.68,-4961.73C1888.55,-4953.22 1895.17,-4943.61 1901.41,-4934.56"/>
<polygon fill="black" stroke="black" points="1904.45,-4936.33 1907.24,-4926.11 1898.68,-4932.35 1904.45,-4936.33"/>
</g>
<!-- expert_linear2_0_4&#45;&gt;aggregate_0 -->
<g id="edge78" class="edge">
<title>expert_linear2_0_4&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2011.69,-4883.62C2034.53,-4879.92 2059.17,-4876.09 2082,-4872.86 2275.78,-4845.47 2499.25,-4819.37 2647.57,-4802.81"/>
<polygon fill="black" stroke="black" points="2648.13,-4806.27 2657.68,-4801.68 2647.35,-4799.31 2648.13,-4806.27"/>
</g>
<!-- expert_linear1_0_5 -->
<g id="node31" class="node">
<title>expert_linear1_0_5</title>
<polygon fill="lightgreen" stroke="black" points="2168,-5103.86 1986,-5103.86 1986,-5050.86 2168,-5050.86 2168,-5103.86"/>
<text text-anchor="middle" x="2077" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="2077" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2077" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_0_5&#45;&gt;expert_linear1_0_5 -->
<g id="edge31" class="edge">
<title>route_to_expert_0_5&#45;&gt;expert_linear1_0_5</title>
<path fill="none" stroke="black" d="M2043.58,-5140.13C2048.4,-5131.23 2053.54,-5121.73 2058.31,-5112.91"/>
<polygon fill="black" stroke="black" points="2061.44,-5114.48 2063.12,-5104.02 2055.28,-5111.15 2061.44,-5114.48"/>
</g>
<!-- expert_activation_0_5 -->
<g id="node32" class="node">
<title>expert_activation_0_5</title>
<polygon fill="lightgreen" stroke="black" points="2235,-5014.86 2053,-5014.86 2053,-4961.86 2235,-4961.86 2235,-5014.86"/>
<text text-anchor="middle" x="2144" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="2144" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2144" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_0_5&#45;&gt;expert_activation_0_5 -->
<g id="edge32" class="edge">
<title>expert_linear1_0_5&#45;&gt;expert_activation_0_5</title>
<path fill="none" stroke="black" d="M2096.74,-5050.73C2103.36,-5042.13 2110.85,-5032.41 2117.88,-5023.28"/>
<polygon fill="black" stroke="black" points="2120.84,-5025.17 2124.17,-5015.11 2115.3,-5020.9 2120.84,-5025.17"/>
</g>
<!-- expert_linear2_0_5 -->
<g id="node33" class="node">
<title>expert_linear2_0_5</title>
<polygon fill="lightgreen" stroke="black" points="2263.5,-4925.86 2090.5,-4925.86 2090.5,-4872.86 2263.5,-4872.86 2263.5,-4925.86"/>
<text text-anchor="middle" x="2177" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2177" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2177" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_0_5&#45;&gt;expert_linear2_0_5 -->
<g id="edge33" class="edge">
<title>expert_activation_0_5&#45;&gt;expert_linear2_0_5</title>
<path fill="none" stroke="black" d="M2153.72,-4961.73C2156.82,-4953.57 2160.3,-4944.4 2163.6,-4935.68"/>
<polygon fill="black" stroke="black" points="2166.96,-4936.7 2167.23,-4926.11 2160.41,-4934.22 2166.96,-4936.7"/>
</g>
<!-- expert_linear2_0_5&#45;&gt;aggregate_0 -->
<g id="edge79" class="edge">
<title>expert_linear2_0_5&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2263.66,-4881.09C2278.12,-4878.29 2292.98,-4875.45 2307,-4872.86 2423.14,-4851.37 2554.57,-4828.56 2654.37,-4811.55"/>
<polygon fill="black" stroke="black" points="2654.96,-4815 2664.23,-4809.87 2653.78,-4808.1 2654.96,-4815"/>
</g>
<!-- expert_linear1_0_6 -->
<g id="node35" class="node">
<title>expert_linear1_0_6</title>
<polygon fill="lightgreen" stroke="black" points="2422,-5103.86 2240,-5103.86 2240,-5050.86 2422,-5050.86 2422,-5103.86"/>
<text text-anchor="middle" x="2331" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="2331" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2331" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_0_6&#45;&gt;expert_linear1_0_6 -->
<g id="edge35" class="edge">
<title>route_to_expert_0_6&#45;&gt;expert_linear1_0_6</title>
<path fill="none" stroke="black" d="M2303.26,-5140.13C2307.21,-5131.33 2311.44,-5121.93 2315.36,-5113.18"/>
<polygon fill="black" stroke="black" points="2318.57,-5114.57 2319.48,-5104.02 2312.19,-5111.7 2318.57,-5114.57"/>
</g>
<!-- expert_activation_0_6 -->
<g id="node36" class="node">
<title>expert_activation_0_6</title>
<polygon fill="lightgreen" stroke="black" points="2474,-5014.86 2292,-5014.86 2292,-4961.86 2474,-4961.86 2474,-5014.86"/>
<text text-anchor="middle" x="2383" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2383" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2383" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_0_6&#45;&gt;expert_activation_0_6 -->
<g id="edge36" class="edge">
<title>expert_linear1_0_6&#45;&gt;expert_activation_0_6</title>
<path fill="none" stroke="black" d="M2346.32,-5050.73C2351.35,-5042.31 2357.03,-5032.81 2362.39,-5023.84"/>
<polygon fill="black" stroke="black" points="2365.48,-5025.49 2367.61,-5015.11 2359.47,-5021.9 2365.48,-5025.49"/>
</g>
<!-- expert_linear2_0_6 -->
<g id="node37" class="node">
<title>expert_linear2_0_6</title>
<polygon fill="lightgreen" stroke="black" points="2488.5,-4925.86 2315.5,-4925.86 2315.5,-4872.86 2488.5,-4872.86 2488.5,-4925.86"/>
<text text-anchor="middle" x="2402" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2402" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2402" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_0_6&#45;&gt;expert_linear2_0_6 -->
<g id="edge37" class="edge">
<title>expert_activation_0_6&#45;&gt;expert_linear2_0_6</title>
<path fill="none" stroke="black" d="M2388.6,-4961.73C2390.36,-4953.66 2392.34,-4944.6 2394.22,-4935.96"/>
<polygon fill="black" stroke="black" points="2397.66,-4936.63 2396.38,-4926.11 2390.82,-4935.13 2397.66,-4936.63"/>
</g>
<!-- expert_linear2_0_6&#45;&gt;aggregate_0 -->
<g id="edge80" class="edge">
<title>expert_linear2_0_6&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2488.66,-4874.43C2539.86,-4860.29 2606.06,-4842.01 2665.28,-4825.65"/>
<polygon fill="black" stroke="black" points="2666.4,-4828.98 2675.1,-4822.94 2664.53,-4822.23 2666.4,-4828.98"/>
</g>
<!-- expert_linear1_0_7 -->
<g id="node39" class="node">
<title>expert_linear1_0_7</title>
<polygon fill="lightgreen" stroke="black" points="2667,-5103.86 2485,-5103.86 2485,-5050.86 2667,-5050.86 2667,-5103.86"/>
<text text-anchor="middle" x="2576" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2576" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2576" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_0_7&#45;&gt;expert_linear1_0_7 -->
<g id="edge39" class="edge">
<title>route_to_expert_0_7&#45;&gt;expert_linear1_0_7</title>
<path fill="none" stroke="black" d="M2559.68,-5139.85C2561.96,-5131.25 2564.39,-5122.1 2566.66,-5113.55"/>
<polygon fill="black" stroke="black" points="2570.05,-5114.43 2569.23,-5103.87 2563.28,-5112.64 2570.05,-5114.43"/>
</g>
<!-- expert_activation_0_7 -->
<g id="node40" class="node">
<title>expert_activation_0_7</title>
<polygon fill="lightgreen" stroke="black" points="2694,-5014.86 2512,-5014.86 2512,-4961.86 2694,-4961.86 2694,-5014.86"/>
<text text-anchor="middle" x="2603" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2603" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2603" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_0_7&#45;&gt;expert_activation_0_7 -->
<g id="edge40" class="edge">
<title>expert_linear1_0_7&#45;&gt;expert_activation_0_7</title>
<path fill="none" stroke="black" d="M2583.95,-5050.73C2586.49,-5042.57 2589.33,-5033.4 2592.04,-5024.68"/>
<polygon fill="black" stroke="black" points="2595.39,-5025.7 2595.01,-5015.11 2588.7,-5023.62 2595.39,-5025.7"/>
</g>
<!-- expert_linear2_0_7 -->
<g id="node41" class="node">
<title>expert_linear2_0_7</title>
<polygon fill="lightgreen" stroke="black" points="2698.5,-4925.86 2525.5,-4925.86 2525.5,-4872.86 2698.5,-4872.86 2698.5,-4925.86"/>
<text text-anchor="middle" x="2612" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2612" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2612" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_0_7&#45;&gt;expert_linear2_0_7 -->
<g id="edge41" class="edge">
<title>expert_activation_0_7&#45;&gt;expert_linear2_0_7</title>
<path fill="none" stroke="black" d="M2605.65,-4961.73C2606.48,-4953.75 2607.4,-4944.79 2608.29,-4936.24"/>
<polygon fill="black" stroke="black" points="2611.79,-4936.42 2609.34,-4926.11 2604.83,-4935.7 2611.79,-4936.42"/>
</g>
<!-- expert_linear2_0_7&#45;&gt;aggregate_0 -->
<g id="edge81" class="edge">
<title>expert_linear2_0_7&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2657.36,-4872.75C2673.63,-4863.56 2692.68,-4852.8 2711.78,-4842.02"/>
<polygon fill="black" stroke="black" points="2713.55,-4845.03 2720.54,-4837.07 2710.11,-4838.94 2713.55,-4845.03"/>
</g>
<!-- expert_linear1_0_8 -->
<g id="node43" class="node">
<title>expert_linear1_0_8</title>
<polygon fill="lightgreen" stroke="black" points="2904,-5103.86 2722,-5103.86 2722,-5050.86 2904,-5050.86 2904,-5103.86"/>
<text text-anchor="middle" x="2813" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2813" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2813" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_0_8&#45;&gt;expert_linear1_0_8 -->
<g id="edge43" class="edge">
<title>route_to_expert_0_8&#45;&gt;expert_linear1_0_8</title>
<path fill="none" stroke="black" d="M2813,-5139.85C2813,-5131.44 2813,-5122.49 2813,-5114.11"/>
<polygon fill="black" stroke="black" points="2816.5,-5113.87 2813,-5103.87 2809.5,-5113.87 2816.5,-5113.87"/>
</g>
<!-- expert_activation_0_8 -->
<g id="node44" class="node">
<title>expert_activation_0_8</title>
<polygon fill="lightgreen" stroke="black" points="2904,-5014.86 2722,-5014.86 2722,-4961.86 2904,-4961.86 2904,-5014.86"/>
<text text-anchor="middle" x="2813" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2813" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2813" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_0_8&#45;&gt;expert_activation_0_8 -->
<g id="edge44" class="edge">
<title>expert_linear1_0_8&#45;&gt;expert_activation_0_8</title>
<path fill="none" stroke="black" d="M2813,-5050.73C2813,-5042.75 2813,-5033.79 2813,-5025.24"/>
<polygon fill="black" stroke="black" points="2816.5,-5025.11 2813,-5015.11 2809.5,-5025.11 2816.5,-5025.11"/>
</g>
<!-- expert_linear2_0_8 -->
<g id="node45" class="node">
<title>expert_linear2_0_8</title>
<polygon fill="lightgreen" stroke="black" points="2899.5,-4925.86 2726.5,-4925.86 2726.5,-4872.86 2899.5,-4872.86 2899.5,-4925.86"/>
<text text-anchor="middle" x="2813" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="2813" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2813" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_0_8&#45;&gt;expert_linear2_0_8 -->
<g id="edge45" class="edge">
<title>expert_activation_0_8&#45;&gt;expert_linear2_0_8</title>
<path fill="none" stroke="black" d="M2813,-4961.73C2813,-4953.75 2813,-4944.79 2813,-4936.24"/>
<polygon fill="black" stroke="black" points="2816.5,-4936.11 2813,-4926.11 2809.5,-4936.11 2816.5,-4936.11"/>
</g>
<!-- expert_linear2_0_8&#45;&gt;aggregate_0 -->
<g id="edge82" class="edge">
<title>expert_linear2_0_8&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2813,-4872.61C2813,-4864.91 2813,-4856.11 2813,-4847.13"/>
<polygon fill="black" stroke="black" points="2816.5,-4846.96 2813,-4836.96 2809.5,-4846.96 2816.5,-4846.96"/>
</g>
<!-- expert_linear1_0_9 -->
<g id="node47" class="node">
<title>expert_linear1_0_9</title>
<polygon fill="lightgreen" stroke="black" points="3151,-5103.86 2969,-5103.86 2969,-5050.86 3151,-5050.86 3151,-5103.86"/>
<text text-anchor="middle" x="3060" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="3060" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3060" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_0_9&#45;&gt;expert_linear1_0_9 -->
<g id="edge47" class="edge">
<title>route_to_expert_0_9&#45;&gt;expert_linear1_0_9</title>
<path fill="none" stroke="black" d="M3070.04,-5139.85C3068.65,-5131.34 3067.17,-5122.3 3065.79,-5113.83"/>
<polygon fill="black" stroke="black" points="3069.23,-5113.18 3064.17,-5103.87 3062.32,-5114.3 3069.23,-5113.18"/>
</g>
<!-- expert_activation_0_9 -->
<g id="node48" class="node">
<title>expert_activation_0_9</title>
<polygon fill="lightgreen" stroke="black" points="3135,-5014.86 2953,-5014.86 2953,-4961.86 3135,-4961.86 3135,-5014.86"/>
<text text-anchor="middle" x="3044" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="3044" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3044" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_0_9&#45;&gt;expert_activation_0_9 -->
<g id="edge48" class="edge">
<title>expert_linear1_0_9&#45;&gt;expert_activation_0_9</title>
<path fill="none" stroke="black" d="M3055.29,-5050.73C3053.8,-5042.66 3052.14,-5033.6 3050.55,-5024.96"/>
<polygon fill="black" stroke="black" points="3053.99,-5024.31 3048.74,-5015.11 3047.1,-5025.58 3053.99,-5024.31"/>
</g>
<!-- expert_linear2_0_9 -->
<g id="node49" class="node">
<title>expert_linear2_0_9</title>
<polygon fill="lightgreen" stroke="black" points="3110.5,-4925.86 2937.5,-4925.86 2937.5,-4872.86 3110.5,-4872.86 3110.5,-4925.86"/>
<text text-anchor="middle" x="3024" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="3024" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3024" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_0_9&#45;&gt;expert_linear2_0_9 -->
<g id="edge49" class="edge">
<title>expert_activation_0_9&#45;&gt;expert_linear2_0_9</title>
<path fill="none" stroke="black" d="M3038.11,-4961.73C3036.25,-4953.66 3034.17,-4944.6 3032.18,-4935.96"/>
<polygon fill="black" stroke="black" points="3035.57,-4935.07 3029.92,-4926.11 3028.75,-4936.64 3035.57,-4935.07"/>
</g>
<!-- expert_linear2_0_9&#45;&gt;aggregate_0 -->
<g id="edge83" class="edge">
<title>expert_linear2_0_9&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2976.38,-4872.75C2959.23,-4863.52 2939.12,-4852.7 2918.99,-4841.87"/>
<polygon fill="black" stroke="black" points="2920.52,-4838.73 2910.06,-4837.07 2917.21,-4844.89 2920.52,-4838.73"/>
</g>
<!-- expert_linear1_0_10 -->
<g id="node51" class="node">
<title>expert_linear1_0_10</title>
<polygon fill="lightgreen" stroke="black" points="3414,-5103.86 3232,-5103.86 3232,-5050.86 3414,-5050.86 3414,-5103.86"/>
<text text-anchor="middle" x="3323" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3323" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3323" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_0_10&#45;&gt;expert_linear1_0_10 -->
<g id="edge51" class="edge">
<title>route_to_expert_0_10&#45;&gt;expert_linear1_0_10</title>
<path fill="none" stroke="black" d="M3333.04,-5139.85C3331.65,-5131.34 3330.17,-5122.3 3328.79,-5113.83"/>
<polygon fill="black" stroke="black" points="3332.23,-5113.18 3327.17,-5103.87 3325.32,-5114.3 3332.23,-5113.18"/>
</g>
<!-- expert_activation_0_10 -->
<g id="node52" class="node">
<title>expert_activation_0_10</title>
<polygon fill="lightgreen" stroke="black" points="3366,-5014.86 3184,-5014.86 3184,-4961.86 3366,-4961.86 3366,-5014.86"/>
<text text-anchor="middle" x="3275" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="3275" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3275" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_0_10&#45;&gt;expert_activation_0_10 -->
<g id="edge52" class="edge">
<title>expert_linear1_0_10&#45;&gt;expert_activation_0_10</title>
<path fill="none" stroke="black" d="M3308.86,-5050.73C3304.26,-5042.39 3299.08,-5033 3294.18,-5024.12"/>
<polygon fill="black" stroke="black" points="3297.1,-5022.17 3289.21,-5015.11 3290.97,-5025.56 3297.1,-5022.17"/>
</g>
<!-- expert_linear2_0_10 -->
<g id="node53" class="node">
<title>expert_linear2_0_10</title>
<polygon fill="lightgreen" stroke="black" points="3331.5,-4925.86 3158.5,-4925.86 3158.5,-4872.86 3331.5,-4872.86 3331.5,-4925.86"/>
<text text-anchor="middle" x="3245" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3245" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3245" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_0_10&#45;&gt;expert_linear2_0_10 -->
<g id="edge53" class="edge">
<title>expert_activation_0_10&#45;&gt;expert_linear2_0_10</title>
<path fill="none" stroke="black" d="M3266.16,-4961.73C3263.35,-4953.57 3260.19,-4944.4 3257.18,-4935.68"/>
<polygon fill="black" stroke="black" points="3260.45,-4934.42 3253.88,-4926.11 3253.83,-4936.7 3260.45,-4934.42"/>
</g>
<!-- expert_linear2_0_10&#45;&gt;aggregate_0 -->
<g id="edge84" class="edge">
<title>expert_linear2_0_10&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3158.36,-4875.6C3118.52,-4865.13 3069.4,-4852.22 3020.83,-4839.46"/>
<polygon fill="black" stroke="black" points="3021.68,-4836.07 3011.12,-4836.91 3019.91,-4842.84 3021.68,-4836.07"/>
</g>
<!-- expert_linear1_0_11 -->
<g id="node55" class="node">
<title>expert_linear1_0_11</title>
<polygon fill="lightgreen" stroke="black" points="3677,-5103.86 3495,-5103.86 3495,-5050.86 3677,-5050.86 3677,-5103.86"/>
<text text-anchor="middle" x="3586" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3586" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3586" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_0_11&#45;&gt;expert_linear1_0_11 -->
<g id="edge55" class="edge">
<title>route_to_expert_0_11&#45;&gt;expert_linear1_0_11</title>
<path fill="none" stroke="black" d="M3596.04,-5139.85C3594.65,-5131.34 3593.17,-5122.3 3591.79,-5113.83"/>
<polygon fill="black" stroke="black" points="3595.23,-5113.18 3590.17,-5103.87 3588.32,-5114.3 3595.23,-5113.18"/>
</g>
<!-- expert_activation_0_11 -->
<g id="node56" class="node">
<title>expert_activation_0_11</title>
<polygon fill="lightgreen" stroke="black" points="3644,-5014.86 3462,-5014.86 3462,-4961.86 3644,-4961.86 3644,-5014.86"/>
<text text-anchor="middle" x="3553" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3553" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3553" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_0_11&#45;&gt;expert_activation_0_11 -->
<g id="edge56" class="edge">
<title>expert_linear1_0_11&#45;&gt;expert_activation_0_11</title>
<path fill="none" stroke="black" d="M3576.28,-5050.73C3573.18,-5042.57 3569.7,-5033.4 3566.4,-5024.68"/>
<polygon fill="black" stroke="black" points="3569.59,-5023.22 3562.77,-5015.11 3563.04,-5025.7 3569.59,-5023.22"/>
</g>
<!-- expert_linear2_0_11 -->
<g id="node57" class="node">
<title>expert_linear2_0_11</title>
<polygon fill="lightgreen" stroke="black" points="3589.5,-4925.86 3416.5,-4925.86 3416.5,-4872.86 3589.5,-4872.86 3589.5,-4925.86"/>
<text text-anchor="middle" x="3503" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3503" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3503" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_0_11&#45;&gt;expert_linear2_0_11 -->
<g id="edge57" class="edge">
<title>expert_activation_0_11&#45;&gt;expert_linear2_0_11</title>
<path fill="none" stroke="black" d="M3538.27,-4961.73C3533.43,-4953.31 3527.97,-4943.81 3522.82,-4934.84"/>
<polygon fill="black" stroke="black" points="3525.82,-4933.04 3517.8,-4926.11 3519.75,-4936.52 3525.82,-4933.04"/>
</g>
<!-- expert_linear2_0_11&#45;&gt;aggregate_0 -->
<g id="edge85" class="edge">
<title>expert_linear2_0_11&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3416.31,-4884.1C3317.61,-4867.87 3152.93,-4840.78 3020.53,-4819"/>
<polygon fill="black" stroke="black" points="3021.09,-4815.54 3010.65,-4817.37 3019.95,-4822.45 3021.09,-4815.54"/>
</g>
<!-- expert_linear1_0_12 -->
<g id="node59" class="node">
<title>expert_linear1_0_12</title>
<polygon fill="lightgreen" stroke="black" points="3893,-5103.86 3711,-5103.86 3711,-5050.86 3893,-5050.86 3893,-5103.86"/>
<text text-anchor="middle" x="3802" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3802" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3802" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_0_12&#45;&gt;expert_linear1_0_12 -->
<g id="edge59" class="edge">
<title>route_to_expert_0_12&#45;&gt;expert_linear1_0_12</title>
<path fill="none" stroke="black" d="M3841.9,-5140.41C3835.99,-5131.22 3829.66,-5121.37 3823.82,-5112.29"/>
<polygon fill="black" stroke="black" points="3826.75,-5110.38 3818.4,-5103.86 3820.86,-5114.16 3826.75,-5110.38"/>
</g>
<!-- expert_activation_0_12 -->
<g id="node60" class="node">
<title>expert_activation_0_12</title>
<polygon fill="lightgreen" stroke="black" points="3877,-5014.86 3695,-5014.86 3695,-4961.86 3877,-4961.86 3877,-5014.86"/>
<text text-anchor="middle" x="3786" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3786" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3786" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_0_12&#45;&gt;expert_activation_0_12 -->
<g id="edge60" class="edge">
<title>expert_linear1_0_12&#45;&gt;expert_activation_0_12</title>
<path fill="none" stroke="black" d="M3797.29,-5050.73C3795.8,-5042.66 3794.14,-5033.6 3792.55,-5024.96"/>
<polygon fill="black" stroke="black" points="3795.99,-5024.31 3790.74,-5015.11 3789.1,-5025.58 3795.99,-5024.31"/>
</g>
<!-- expert_linear2_0_12 -->
<g id="node61" class="node">
<title>expert_linear2_0_12</title>
<polygon fill="lightgreen" stroke="black" points="3818.5,-4925.86 3645.5,-4925.86 3645.5,-4872.86 3818.5,-4872.86 3818.5,-4925.86"/>
<text text-anchor="middle" x="3732" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="3732" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3732" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_0_12&#45;&gt;expert_linear2_0_12 -->
<g id="edge61" class="edge">
<title>expert_activation_0_12&#45;&gt;expert_linear2_0_12</title>
<path fill="none" stroke="black" d="M3770.09,-4961.73C3764.86,-4953.31 3758.97,-4943.81 3753.4,-4934.84"/>
<polygon fill="black" stroke="black" points="3756.23,-4932.76 3747.98,-4926.11 3750.28,-4936.45 3756.23,-4932.76"/>
</g>
<!-- expert_linear2_0_12&#45;&gt;aggregate_0 -->
<g id="edge86" class="edge">
<title>expert_linear2_0_12&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3645.24,-4880.72C3629.87,-4877.88 3613.99,-4875.13 3599,-4872.86 3398.41,-4842.45 3167.53,-4817.83 3008.15,-4802.44"/>
<polygon fill="black" stroke="black" points="3008.04,-4798.92 2997.76,-4801.44 3007.37,-4805.88 3008.04,-4798.92"/>
</g>
<!-- expert_linear1_0_13 -->
<g id="node63" class="node">
<title>expert_linear1_0_13</title>
<polygon fill="lightgreen" stroke="black" points="4156,-5103.86 3974,-5103.86 3974,-5050.86 4156,-5050.86 4156,-5103.86"/>
<text text-anchor="middle" x="4065" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="4065" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4065" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_0_13&#45;&gt;expert_linear1_0_13 -->
<g id="edge63" class="edge">
<title>route_to_expert_0_13&#45;&gt;expert_linear1_0_13</title>
<path fill="none" stroke="black" d="M4104.9,-5140.41C4098.99,-5131.22 4092.66,-5121.37 4086.82,-5112.29"/>
<polygon fill="black" stroke="black" points="4089.75,-5110.38 4081.4,-5103.86 4083.86,-5114.16 4089.75,-5110.38"/>
</g>
<!-- expert_activation_0_13 -->
<g id="node64" class="node">
<title>expert_activation_0_13</title>
<polygon fill="lightgreen" stroke="black" points="4125,-5014.86 3943,-5014.86 3943,-4961.86 4125,-4961.86 4125,-5014.86"/>
<text text-anchor="middle" x="4034" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="4034" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4034" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_0_13&#45;&gt;expert_activation_0_13 -->
<g id="edge64" class="edge">
<title>expert_linear1_0_13&#45;&gt;expert_activation_0_13</title>
<path fill="none" stroke="black" d="M4055.87,-5050.73C4052.96,-5042.57 4049.69,-5033.4 4046.59,-5024.68"/>
<polygon fill="black" stroke="black" points="4049.83,-5023.35 4043.18,-5015.11 4043.23,-5025.7 4049.83,-5023.35"/>
</g>
<!-- expert_linear2_0_13 -->
<g id="node65" class="node">
<title>expert_linear2_0_13</title>
<polygon fill="lightgreen" stroke="black" points="4057.5,-4925.86 3884.5,-4925.86 3884.5,-4872.86 4057.5,-4872.86 4057.5,-4925.86"/>
<text text-anchor="middle" x="3971" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="3971" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3971" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_0_13&#45;&gt;expert_linear2_0_13 -->
<g id="edge65" class="edge">
<title>expert_activation_0_13&#45;&gt;expert_linear2_0_13</title>
<path fill="none" stroke="black" d="M4015.44,-4961.73C4009.21,-4953.13 4002.17,-4943.41 3995.56,-4934.28"/>
<polygon fill="black" stroke="black" points="3998.35,-4932.16 3989.65,-4926.11 3992.68,-4936.26 3998.35,-4932.16"/>
</g>
<!-- expert_linear2_0_13&#45;&gt;aggregate_0 -->
<g id="edge87" class="edge">
<title>expert_linear2_0_13&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3884.23,-4881.6C3865.72,-4878.38 3846.25,-4875.27 3828,-4872.86 3541.54,-4834.98 3207.34,-4809.61 3002.99,-4796.21"/>
<polygon fill="black" stroke="black" points="3002.96,-4792.7 2992.75,-4795.54 3002.51,-4799.68 3002.96,-4792.7"/>
</g>
<!-- expert_linear1_0_14 -->
<g id="node67" class="node">
<title>expert_linear1_0_14</title>
<polygon fill="lightgreen" stroke="black" points="4419,-5103.86 4237,-5103.86 4237,-5050.86 4419,-5050.86 4419,-5103.86"/>
<text text-anchor="middle" x="4328" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="4328" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4328" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_0_14&#45;&gt;expert_linear1_0_14 -->
<g id="edge67" class="edge">
<title>route_to_expert_0_14&#45;&gt;expert_linear1_0_14</title>
<path fill="none" stroke="black" d="M4367.9,-5140.41C4361.99,-5131.22 4355.66,-5121.37 4349.82,-5112.29"/>
<polygon fill="black" stroke="black" points="4352.75,-5110.38 4344.4,-5103.86 4346.86,-5114.16 4352.75,-5110.38"/>
</g>
<!-- expert_activation_0_14 -->
<g id="node68" class="node">
<title>expert_activation_0_14</title>
<polygon fill="lightgreen" stroke="black" points="4388,-5014.86 4206,-5014.86 4206,-4961.86 4388,-4961.86 4388,-5014.86"/>
<text text-anchor="middle" x="4297" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="4297" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4297" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_0_14&#45;&gt;expert_activation_0_14 -->
<g id="edge68" class="edge">
<title>expert_linear1_0_14&#45;&gt;expert_activation_0_14</title>
<path fill="none" stroke="black" d="M4318.87,-5050.73C4315.96,-5042.57 4312.69,-5033.4 4309.59,-5024.68"/>
<polygon fill="black" stroke="black" points="4312.83,-5023.35 4306.18,-5015.11 4306.23,-5025.7 4312.83,-5023.35"/>
</g>
<!-- expert_linear2_0_14 -->
<g id="node69" class="node">
<title>expert_linear2_0_14</title>
<polygon fill="lightgreen" stroke="black" points="4316.5,-4925.86 4143.5,-4925.86 4143.5,-4872.86 4316.5,-4872.86 4316.5,-4925.86"/>
<text text-anchor="middle" x="4230" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="4230" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4230" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_0_14&#45;&gt;expert_linear2_0_14 -->
<g id="edge69" class="edge">
<title>expert_activation_0_14&#45;&gt;expert_linear2_0_14</title>
<path fill="none" stroke="black" d="M4277.26,-4961.73C4270.64,-4953.13 4263.15,-4943.41 4256.12,-4934.28"/>
<polygon fill="black" stroke="black" points="4258.7,-4931.9 4249.83,-4926.11 4253.16,-4936.17 4258.7,-4931.9"/>
</g>
<!-- expert_linear2_0_14&#45;&gt;aggregate_0 -->
<g id="edge88" class="edge">
<title>expert_linear2_0_14&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4143.48,-4883.42C4118.83,-4879.55 4091.9,-4875.68 4067,-4872.86 3689.61,-4830.18 3245.82,-4804.86 3000.31,-4793.02"/>
<polygon fill="black" stroke="black" points="3000.37,-4789.52 2990.21,-4792.54 3000.03,-4796.51 3000.37,-4789.52"/>
</g>
<!-- expert_linear1_0_15 -->
<g id="node71" class="node">
<title>expert_linear1_0_15</title>
<polygon fill="lightgreen" stroke="black" points="4682,-5103.86 4500,-5103.86 4500,-5050.86 4682,-5050.86 4682,-5103.86"/>
<text text-anchor="middle" x="4591" y="-5088.66" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4591" y="-5073.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4591" y="-5058.66" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_0_15&#45;&gt;expert_linear1_0_15 -->
<g id="edge71" class="edge">
<title>route_to_expert_0_15&#45;&gt;expert_linear1_0_15</title>
<path fill="none" stroke="black" d="M4630.9,-5140.41C4624.99,-5131.22 4618.66,-5121.37 4612.82,-5112.29"/>
<polygon fill="black" stroke="black" points="4615.75,-5110.38 4607.4,-5103.86 4609.86,-5114.16 4615.75,-5110.38"/>
</g>
<!-- expert_activation_0_15 -->
<g id="node72" class="node">
<title>expert_activation_0_15</title>
<polygon fill="lightgreen" stroke="black" points="4651,-5014.86 4469,-5014.86 4469,-4961.86 4651,-4961.86 4651,-5014.86"/>
<text text-anchor="middle" x="4560" y="-4999.66" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4560" y="-4984.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4560" y="-4969.66" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_0_15&#45;&gt;expert_activation_0_15 -->
<g id="edge72" class="edge">
<title>expert_linear1_0_15&#45;&gt;expert_activation_0_15</title>
<path fill="none" stroke="black" d="M4581.87,-5050.73C4578.96,-5042.57 4575.69,-5033.4 4572.59,-5024.68"/>
<polygon fill="black" stroke="black" points="4575.83,-5023.35 4569.18,-5015.11 4569.23,-5025.7 4575.83,-5023.35"/>
</g>
<!-- expert_linear2_0_15 -->
<g id="node73" class="node">
<title>expert_linear2_0_15</title>
<polygon fill="lightgreen" stroke="black" points="4576.5,-4925.86 4403.5,-4925.86 4403.5,-4872.86 4576.5,-4872.86 4576.5,-4925.86"/>
<text text-anchor="middle" x="4490" y="-4910.66" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4490" y="-4895.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4490" y="-4880.66" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_0_15&#45;&gt;expert_linear2_0_15 -->
<g id="edge73" class="edge">
<title>expert_activation_0_15&#45;&gt;expert_linear2_0_15</title>
<path fill="none" stroke="black" d="M4539.38,-4961.73C4532.39,-4953.04 4524.48,-4943.21 4517.07,-4934"/>
<polygon fill="black" stroke="black" points="4519.71,-4931.71 4510.72,-4926.11 4514.26,-4936.09 4519.71,-4931.71"/>
</g>
<!-- expert_linear2_0_15&#45;&gt;aggregate_0 -->
<g id="edge89" class="edge">
<title>expert_linear2_0_15&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4403.39,-4883.3C4378.47,-4879.4 4351.21,-4875.55 4326,-4872.86 3848.78,-4822 3283.51,-4798.94 2997.93,-4789.89"/>
<polygon fill="black" stroke="black" points="2998,-4786.39 2987.89,-4789.57 2997.78,-4793.38 2998,-4786.39"/>
</g>
<!-- aggregate_0&#45;&gt;moe_residual_0 -->
<g id="edge91" class="edge">
<title>aggregate_0&#45;&gt;moe_residual_0</title>
<path fill="none" stroke="black" d="M2941.78,-4733.6C2978.16,-4719.68 3017.69,-4704.56 3053.86,-4690.73"/>
<polygon fill="black" stroke="black" points="3055.38,-4693.9 3063.47,-4687.05 3052.87,-4687.36 3055.38,-4693.9"/>
</g>
<!-- ln2_0 -->
<g id="node76" class="node">
<title>ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="3268.5,-4552.86 3089.5,-4552.86 3089.5,-4499.86 3268.5,-4499.86 3268.5,-4552.86"/>
<text text-anchor="middle" x="3179" y="-4537.66" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="3179" y="-4522.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3179" y="-4507.66" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- moe_residual_0&#45;&gt;ln2_0 -->
<g id="edge92" class="edge">
<title>moe_residual_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M3179,-4588.76C3179,-4580.09 3179,-4571.27 3179,-4563.13"/>
<polygon fill="black" stroke="black" points="3182.5,-4562.87 3179,-4552.87 3175.5,-4562.87 3182.5,-4562.87"/>
</g>
<!-- mha_qkv_1 -->
<g id="node77" class="node">
<title>mha_qkv_1</title>
<polygon fill="lightgreen" stroke="black" points="3253.5,-4452.86 3074.5,-4452.86 3074.5,-4399.86 3253.5,-4399.86 3253.5,-4452.86"/>
<text text-anchor="middle" x="3164" y="-4437.66" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3164" y="-4422.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3164" y="-4407.66" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_0&#45;&gt;mha_qkv_1 -->
<g id="edge93" class="edge">
<title>ln2_0&#45;&gt;mha_qkv_1</title>
<path fill="none" stroke="black" d="M3175.06,-4499.61C3173.35,-4488.47 3171.33,-4475.24 3169.48,-4463.17"/>
<polygon fill="black" stroke="black" points="3172.89,-4462.29 3167.91,-4452.94 3165.97,-4463.35 3172.89,-4462.29"/>
</g>
<!-- mha_residual_1 -->
<g id="node80" class="node">
<title>mha_residual_1</title>
<polygon fill="lightyellow" stroke="black" points="3408.66,-4185.86 3113.32,-4185.86 3037.34,-4079.86 3332.68,-4079.86 3408.66,-4185.86"/>
<text text-anchor="middle" x="3223" y="-4144.16" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="3223" y="-4129.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3223" y="-4114.16" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_0&#45;&gt;mha_residual_1 -->
<g id="edge97" class="edge">
<title>ln2_0&#45;&gt;mha_residual_1</title>
<path fill="none" stroke="black" d="M3248.64,-4499.62C3254.26,-4495.15 3259.22,-4489.94 3263,-4483.86 3324.45,-4384.95 3287.65,-4335.67 3263,-4221.86 3261.1,-4213.07 3258.23,-4204.1 3254.9,-4195.41"/>
<polygon fill="black" stroke="black" points="3258.13,-4194.06 3251.12,-4186.12 3251.65,-4196.7 3258.13,-4194.06"/>
</g>
<!-- mha_attn_1 -->
<g id="node78" class="node">
<title>mha_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="3253.5,-4363.86 3074.5,-4363.86 3074.5,-4310.86 3253.5,-4310.86 3253.5,-4363.86"/>
<text text-anchor="middle" x="3164" y="-4348.66" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3164" y="-4333.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3164" y="-4318.66" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_qkv_1&#45;&gt;mha_attn_1 -->
<g id="edge94" class="edge">
<title>mha_qkv_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M3164,-4399.73C3164,-4391.75 3164,-4382.79 3164,-4374.24"/>
<polygon fill="black" stroke="black" points="3167.5,-4374.11 3164,-4364.11 3160.5,-4374.11 3167.5,-4374.11"/>
</g>
<!-- mha_out_1 -->
<g id="node79" class="node">
<title>mha_out_1</title>
<polygon fill="lightgreen" stroke="black" points="3253.5,-4274.86 3074.5,-4274.86 3074.5,-4221.86 3253.5,-4221.86 3253.5,-4274.86"/>
<text text-anchor="middle" x="3164" y="-4259.66" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="3164" y="-4244.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3164" y="-4229.66" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge95" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M3164,-4310.73C3164,-4302.75 3164,-4293.79 3164,-4285.24"/>
<polygon fill="black" stroke="black" points="3167.5,-4285.11 3164,-4275.11 3160.5,-4285.11 3167.5,-4285.11"/>
</g>
<!-- mha_out_1&#45;&gt;mha_residual_1 -->
<g id="edge96" class="edge">
<title>mha_out_1&#45;&gt;mha_residual_1</title>
<path fill="none" stroke="black" d="M3177.39,-4221.61C3181.56,-4213.58 3186.36,-4204.35 3191.23,-4194.97"/>
<polygon fill="black" stroke="black" points="3194.41,-4196.44 3195.92,-4185.96 3188.2,-4193.22 3194.41,-4196.44"/>
</g>
<!-- ln1_1 -->
<g id="node81" class="node">
<title>ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="3312.5,-4043.86 3133.5,-4043.86 3133.5,-3990.86 3312.5,-3990.86 3312.5,-4043.86"/>
<text text-anchor="middle" x="3223" y="-4028.66" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="3223" y="-4013.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3223" y="-3998.66" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_residual_1&#45;&gt;ln1_1 -->
<g id="edge98" class="edge">
<title>mha_residual_1&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M3223,-4079.76C3223,-4071.09 3223,-4062.27 3223,-4054.13"/>
<polygon fill="black" stroke="black" points="3226.5,-4053.87 3223,-4043.87 3219.5,-4053.87 3226.5,-4053.87"/>
</g>
<!-- gate_1 -->
<g id="node82" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="3360.83,-3954.86 3095.44,-3954.86 3027.17,-3848.86 3292.56,-3848.86 3360.83,-3954.86"/>
<text text-anchor="middle" x="3194" y="-3913.16" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="3194" y="-3898.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="3194" y="-3883.16" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_1&#45;&gt;gate_1 -->
<g id="edge99" class="edge">
<title>ln1_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M3216.42,-3990.61C3214.43,-3982.82 3212.16,-3973.92 3209.84,-3964.84"/>
<polygon fill="black" stroke="black" points="3213.18,-3963.78 3207.31,-3954.96 3206.4,-3965.51 3213.18,-3963.78"/>
</g>
<!-- moe_residual_1 -->
<g id="node148" class="node">
<title>moe_residual_1</title>
<polygon fill="lightyellow" stroke="black" points="4067.66,-3292.91 3772.32,-3292.91 3696.34,-3186.91 3991.68,-3186.91 4067.66,-3292.91"/>
<text text-anchor="middle" x="3882" y="-3251.21" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="3882" y="-3236.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3882" y="-3221.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_1&#45;&gt;moe_residual_1 -->
<g id="edge180" class="edge">
<title>ln1_1&#45;&gt;moe_residual_1</title>
<path fill="none" stroke="black" d="M3312.78,-4012.84C3675.86,-3997.82 5022.97,-3934.26 5166,-3812.86 5178.82,-3801.98 5176,-3793.19 5176,-3776.38 5176,-3776.38 5176,-3776.38 5176,-3496.41 5176,-3383.07 4402.14,-3292.23 4051.32,-3256.87"/>
<polygon fill="black" stroke="black" points="4051.62,-3253.38 4041.32,-3255.86 4050.92,-3260.35 4051.62,-3253.38"/>
</g>
<!-- route_to_expert_1_0 -->
<g id="node83" class="node">
<title>route_to_expert_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="1090" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1090" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="1090" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1090" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_0 -->
<g id="edge100" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3059.26,-3898.79C2674.75,-3892.27 1577.09,-3869.11 1222,-3812.86 1209.68,-3810.91 1196.86,-3808.22 1184.27,-3805.19"/>
<polygon fill="black" stroke="black" points="1184.79,-3801.71 1174.24,-3802.69 1183.09,-3808.5 1184.79,-3801.71"/>
</g>
<!-- route_to_expert_1_1 -->
<g id="node87" class="node">
<title>route_to_expert_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="1353" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1353" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="1353" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1353" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 17</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_1 -->
<g id="edge104" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3058.46,-3897.7C2709.61,-3888.95 1787.07,-3861.77 1485,-3812.86 1472.68,-3810.87 1459.87,-3808.16 1447.28,-3805.11"/>
<polygon fill="black" stroke="black" points="1447.8,-3801.63 1437.25,-3802.6 1446.1,-3808.42 1447.8,-3801.63"/>
</g>
<!-- route_to_expert_1_2 -->
<g id="node91" class="node">
<title>route_to_expert_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="1616" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1616" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="1616" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1616" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 18</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_2 -->
<g id="edge108" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3057.55,-3896.2C2747.48,-3885.01 1997.48,-3854.45 1748,-3812.86 1735.79,-3810.82 1723.08,-3808.11 1710.59,-3805.07"/>
<polygon fill="black" stroke="black" points="1711.18,-3801.61 1700.62,-3802.57 1709.47,-3808.4 1711.18,-3801.61"/>
</g>
<!-- route_to_expert_1_3 -->
<g id="node95" class="node">
<title>route_to_expert_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="1879" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1879" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="1879" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1879" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 19</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_3 -->
<g id="edge112" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3059.45,-3899.38C2838.85,-3895.04 2387.15,-3878.18 2011,-3812.86 1998.89,-3810.76 1986.29,-3808.02 1973.9,-3804.98"/>
<polygon fill="black" stroke="black" points="1974.56,-3801.54 1964.01,-3802.49 1972.85,-3808.33 1974.56,-3801.54"/>
</g>
<!-- route_to_expert_1_4 -->
<g id="node99" class="node">
<title>route_to_expert_1_4</title>
<ellipse fill="lightblue" stroke="black" cx="2142" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2142" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="2142" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2142" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 20</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_4 -->
<g id="edge116" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3056.97,-3895.21C2876.31,-3886.07 2549.14,-3863.63 2274,-3812.86 2262.01,-3810.65 2249.52,-3807.86 2237.22,-3804.81"/>
<polygon fill="black" stroke="black" points="2237.97,-3801.39 2227.41,-3802.32 2236.24,-3808.17 2237.97,-3801.39"/>
</g>
<!-- route_to_expert_1_5 -->
<g id="node103" class="node">
<title>route_to_expert_1_5</title>
<ellipse fill="lightblue" stroke="black" cx="2405" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2405" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="2405" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2405" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 21</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_5 -->
<g id="edge120" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3051.77,-3887.47C2918.06,-3873.55 2712.76,-3848.74 2537,-3812.86 2525.35,-3810.48 2513.22,-3807.64 2501.23,-3804.61"/>
<polygon fill="black" stroke="black" points="2501.77,-3801.13 2491.22,-3802.02 2500.02,-3807.91 2501.77,-3801.13"/>
</g>
<!-- route_to_expert_1_6 -->
<g id="node107" class="node">
<title>route_to_expert_1_6</title>
<ellipse fill="lightblue" stroke="black" cx="2668" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2668" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="2668" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2668" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 22</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_6 -->
<g id="edge124" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3039.21,-3868.16C2966.41,-3852.3 2878.54,-3832.47 2800,-3812.86 2789.03,-3810.12 2777.58,-3807.14 2766.2,-3804.1"/>
<polygon fill="black" stroke="black" points="2766.8,-3800.64 2756.24,-3801.42 2764.99,-3807.4 2766.8,-3800.64"/>
</g>
<!-- route_to_expert_1_7 -->
<g id="node111" class="node">
<title>route_to_expert_1_7</title>
<ellipse fill="lightblue" stroke="black" cx="2931" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2931" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="2931" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2931" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 23</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_7 -->
<g id="edge128" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3083.99,-3848.79C3057.53,-3836.27 3029.87,-3823.18 3005.47,-3811.63"/>
<polygon fill="black" stroke="black" points="3006.82,-3808.4 2996.29,-3807.28 3003.83,-3814.72 3006.82,-3808.4"/>
</g>
<!-- route_to_expert_1_8 -->
<g id="node115" class="node">
<title>route_to_expert_1_8</title>
<ellipse fill="lightblue" stroke="black" cx="3194" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3194" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="3194" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3194" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 24</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_8 -->
<g id="edge132" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3194,-3848.79C3194,-3840.36 3194,-3831.67 3194,-3823.37"/>
<polygon fill="black" stroke="black" points="3197.5,-3823.11 3194,-3813.11 3190.5,-3823.11 3197.5,-3823.11"/>
</g>
<!-- route_to_expert_1_9 -->
<g id="node119" class="node">
<title>route_to_expert_1_9</title>
<ellipse fill="lightblue" stroke="black" cx="3457" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3457" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="3457" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3457" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 25</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_9 -->
<g id="edge136" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3295.31,-3852.91C3324.43,-3839.13 3355.64,-3824.36 3382.8,-3811.5"/>
<polygon fill="black" stroke="black" points="3384.3,-3814.66 3391.84,-3807.22 3381.3,-3808.34 3384.3,-3814.66"/>
</g>
<!-- route_to_expert_1_10 -->
<g id="node123" class="node">
<title>route_to_expert_1_10</title>
<ellipse fill="lightblue" stroke="black" cx="3720" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3720" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="3720" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3720" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 26</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_10 -->
<g id="edge140" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3310.73,-3876.39C3389.33,-3859.52 3495.18,-3836.04 3588,-3812.86 3598.97,-3810.12 3610.42,-3807.14 3621.8,-3804.1"/>
<polygon fill="black" stroke="black" points="3623.01,-3807.4 3631.76,-3801.42 3621.2,-3800.64 3623.01,-3807.4"/>
</g>
<!-- route_to_expert_1_11 -->
<g id="node127" class="node">
<title>route_to_expert_1_11</title>
<ellipse fill="lightblue" stroke="black" cx="3983" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3983" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3983" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3983" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 27</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_11 -->
<g id="edge144" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3318.66,-3889.28C3451.44,-3875.76 3667.35,-3850.35 3851,-3812.86 3862.65,-3810.48 3874.78,-3807.64 3886.77,-3804.61"/>
<polygon fill="black" stroke="black" points="3887.98,-3807.91 3896.78,-3802.02 3886.23,-3801.13 3887.98,-3807.91"/>
</g>
<!-- route_to_expert_1_12 -->
<g id="node131" class="node">
<title>route_to_expert_1_12</title>
<ellipse fill="lightblue" stroke="black" cx="4246" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4246" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="4246" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4246" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 28</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_12 -->
<g id="edge148" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3322.97,-3895.62C3501.83,-3886.74 3834.72,-3864.4 4114,-3812.86 4125.99,-3810.65 4138.48,-3807.86 4150.78,-3804.81"/>
<polygon fill="black" stroke="black" points="4151.76,-3808.17 4160.59,-3802.32 4150.03,-3801.39 4151.76,-3808.17"/>
</g>
<!-- route_to_expert_1_13 -->
<g id="node135" class="node">
<title>route_to_expert_1_13</title>
<ellipse fill="lightblue" stroke="black" cx="4509" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4509" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="4509" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4509" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 29</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_13 -->
<g id="edge152" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3325.44,-3899.44C3544.88,-3895.2 3999.07,-3878.48 4377,-3812.86 4389.11,-3810.76 4401.71,-3808.02 4414.1,-3804.98"/>
<polygon fill="black" stroke="black" points="4415.15,-3808.33 4423.99,-3802.49 4413.44,-3801.54 4415.15,-3808.33"/>
</g>
<!-- route_to_expert_1_14 -->
<g id="node139" class="node">
<title>route_to_expert_1_14</title>
<ellipse fill="lightblue" stroke="black" cx="4772" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4772" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="4772" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4772" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 30</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_14 -->
<g id="edge156" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3323.3,-3896.45C3628.84,-3885.48 4388.58,-3854.77 4640,-3812.86 4652.21,-3810.82 4664.92,-3808.11 4677.41,-3805.07"/>
<polygon fill="black" stroke="black" points="4678.53,-3808.4 4687.38,-3802.57 4676.82,-3801.61 4678.53,-3808.4"/>
</g>
<!-- route_to_expert_1_15 -->
<g id="node143" class="node">
<title>route_to_expert_1_15</title>
<ellipse fill="lightblue" stroke="black" cx="5035" cy="-3775.38" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5035" y="-3786.68" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="5035" y="-3771.68" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5035" y="-3756.68" font-family="Times,serif" font-size="14.00">GPU: 31</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_15 -->
<g id="edge160" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3324.19,-3897.83C3668.85,-3889.23 4599.37,-3862.02 4903,-3812.86 4915.32,-3810.87 4928.13,-3808.16 4940.72,-3805.11"/>
<polygon fill="black" stroke="black" points="4941.9,-3808.42 4950.75,-3802.6 4940.2,-3801.63 4941.9,-3808.42"/>
</g>
<!-- expert_linear1_1_0 -->
<g id="node84" class="node">
<title>expert_linear1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1182,-3701.91 1000,-3701.91 1000,-3648.91 1182,-3648.91 1182,-3701.91"/>
<text text-anchor="middle" x="1091" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="1091" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1091" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- route_to_expert_1_0&#45;&gt;expert_linear1_1_0 -->
<g id="edge101" class="edge">
<title>route_to_expert_1_0&#45;&gt;expert_linear1_1_0</title>
<path fill="none" stroke="black" d="M1090.37,-3737.9C1090.46,-3729.48 1090.55,-3720.54 1090.64,-3712.16"/>
<polygon fill="black" stroke="black" points="1094.14,-3711.95 1090.74,-3701.92 1087.14,-3711.88 1094.14,-3711.95"/>
</g>
<!-- expert_activation_1_0 -->
<g id="node85" class="node">
<title>expert_activation_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1183,-3612.91 1001,-3612.91 1001,-3559.91 1183,-3559.91 1183,-3612.91"/>
<text text-anchor="middle" x="1092" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1092" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1092" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- expert_linear1_1_0&#45;&gt;expert_activation_1_0 -->
<g id="edge102" class="edge">
<title>expert_linear1_1_0&#45;&gt;expert_activation_1_0</title>
<path fill="none" stroke="black" d="M1091.29,-3648.77C1091.39,-3640.79 1091.49,-3631.84 1091.59,-3623.29"/>
<polygon fill="black" stroke="black" points="1095.09,-3623.2 1091.7,-3613.16 1088.09,-3623.12 1095.09,-3623.2"/>
</g>
<!-- expert_linear2_1_0 -->
<g id="node86" class="node">
<title>expert_linear2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1356.5,-3523.91 1183.5,-3523.91 1183.5,-3470.91 1356.5,-3470.91 1356.5,-3523.91"/>
<text text-anchor="middle" x="1270" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="1270" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1270" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 16</text>
</g>
<!-- expert_activation_1_0&#45;&gt;expert_linear2_1_0 -->
<g id="edge103" class="edge">
<title>expert_activation_1_0&#45;&gt;expert_linear2_1_0</title>
<path fill="none" stroke="black" d="M1144.44,-3559.77C1164.54,-3549.95 1187.65,-3538.66 1208.52,-3528.45"/>
<polygon fill="black" stroke="black" points="1210.18,-3531.54 1217.62,-3524.01 1207.1,-3525.25 1210.18,-3531.54"/>
</g>
<!-- aggregate_1 -->
<g id="node147" class="node">
<title>aggregate_1</title>
<polygon fill="lightyellow" stroke="black" points="3407.64,-3434.91 3067.79,-3434.91 2980.36,-3328.91 3320.21,-3328.91 3407.64,-3434.91"/>
<text text-anchor="middle" x="3194" y="-3393.21" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="3194" y="-3378.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3194" y="-3363.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- expert_linear2_1_0&#45;&gt;aggregate_1 -->
<g id="edge164" class="edge">
<title>expert_linear2_1_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1356.62,-3487.46C1410.49,-3482.12 1481.22,-3475.5 1544,-3470.91 2081.66,-3431.57 2719.11,-3402.56 3020.1,-3389.92"/>
<polygon fill="black" stroke="black" points="3020.38,-3393.41 3030.22,-3389.49 3020.08,-3386.42 3020.38,-3393.41"/>
</g>
<!-- expert_linear1_1_1 -->
<g id="node88" class="node">
<title>expert_linear1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1506,-3701.91 1324,-3701.91 1324,-3648.91 1506,-3648.91 1506,-3701.91"/>
<text text-anchor="middle" x="1415" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="1415" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1415" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 17</text>
</g>
<!-- route_to_expert_1_1&#45;&gt;expert_linear1_1_1 -->
<g id="edge105" class="edge">
<title>route_to_expert_1_1&#45;&gt;expert_linear1_1_1</title>
<path fill="none" stroke="black" d="M1375.73,-3738.46C1381.49,-3729.36 1387.65,-3719.62 1393.35,-3710.62"/>
<polygon fill="black" stroke="black" points="1396.47,-3712.23 1398.86,-3701.91 1390.56,-3708.49 1396.47,-3712.23"/>
</g>
<!-- expert_activation_1_1 -->
<g id="node89" class="node">
<title>expert_activation_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1635,-3612.91 1453,-3612.91 1453,-3559.91 1635,-3559.91 1635,-3612.91"/>
<text text-anchor="middle" x="1544" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="1544" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1544" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 17</text>
</g>
<!-- expert_linear1_1_1&#45;&gt;expert_activation_1_1 -->
<g id="edge106" class="edge">
<title>expert_linear1_1_1&#45;&gt;expert_activation_1_1</title>
<path fill="none" stroke="black" d="M1453.01,-3648.77C1466.92,-3639.39 1482.83,-3628.66 1497.41,-3618.83"/>
<polygon fill="black" stroke="black" points="1499.49,-3621.65 1505.82,-3613.16 1495.57,-3615.85 1499.49,-3621.65"/>
</g>
<!-- expert_linear2_1_1 -->
<g id="node90" class="node">
<title>expert_linear2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="1725.5,-3523.91 1552.5,-3523.91 1552.5,-3470.91 1725.5,-3470.91 1725.5,-3523.91"/>
<text text-anchor="middle" x="1639" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="1639" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1639" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 17</text>
</g>
<!-- expert_activation_1_1&#45;&gt;expert_linear2_1_1 -->
<g id="edge107" class="edge">
<title>expert_activation_1_1&#45;&gt;expert_linear2_1_1</title>
<path fill="none" stroke="black" d="M1571.99,-3559.77C1581.85,-3550.74 1593.08,-3540.46 1603.48,-3530.93"/>
<polygon fill="black" stroke="black" points="1605.87,-3533.49 1610.88,-3524.16 1601.14,-3528.33 1605.87,-3533.49"/>
</g>
<!-- expert_linear2_1_1&#45;&gt;aggregate_1 -->
<g id="edge165" class="edge">
<title>expert_linear2_1_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1725.56,-3484.12C1760.43,-3479.48 1801.08,-3474.47 1838,-3470.91 2261.92,-3430.03 2762.27,-3403.04 3020.45,-3390.68"/>
<polygon fill="black" stroke="black" points="3020.84,-3394.17 3030.67,-3390.2 3020.51,-3387.18 3020.84,-3394.17"/>
</g>
<!-- expert_linear1_1_2 -->
<g id="node92" class="node">
<title>expert_linear1_1_2</title>
<polygon fill="lightgreen" stroke="black" points="1769,-3701.91 1587,-3701.91 1587,-3648.91 1769,-3648.91 1769,-3701.91"/>
<text text-anchor="middle" x="1678" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="1678" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1678" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 18</text>
</g>
<!-- route_to_expert_1_2&#45;&gt;expert_linear1_1_2 -->
<g id="edge109" class="edge">
<title>route_to_expert_1_2&#45;&gt;expert_linear1_1_2</title>
<path fill="none" stroke="black" d="M1638.73,-3738.46C1644.49,-3729.36 1650.65,-3719.62 1656.35,-3710.62"/>
<polygon fill="black" stroke="black" points="1659.47,-3712.23 1661.86,-3701.91 1653.56,-3708.49 1659.47,-3712.23"/>
</g>
<!-- expert_activation_1_2 -->
<g id="node93" class="node">
<title>expert_activation_1_2</title>
<polygon fill="lightgreen" stroke="black" points="1961,-3612.91 1779,-3612.91 1779,-3559.91 1961,-3559.91 1961,-3612.91"/>
<text text-anchor="middle" x="1870" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1870" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1870" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 18</text>
</g>
<!-- expert_linear1_1_2&#45;&gt;expert_activation_1_2 -->
<g id="edge110" class="edge">
<title>expert_linear1_1_2&#45;&gt;expert_activation_1_2</title>
<path fill="none" stroke="black" d="M1734.31,-3648.89C1756.29,-3638.93 1781.64,-3627.45 1804.43,-3617.12"/>
<polygon fill="black" stroke="black" points="1806.03,-3620.24 1813.69,-3612.92 1803.14,-3613.86 1806.03,-3620.24"/>
</g>
<!-- expert_linear2_1_2 -->
<g id="node94" class="node">
<title>expert_linear2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="2019.5,-3523.91 1846.5,-3523.91 1846.5,-3470.91 2019.5,-3470.91 2019.5,-3523.91"/>
<text text-anchor="middle" x="1933" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1933" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1933" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 18</text>
</g>
<!-- expert_activation_1_2&#45;&gt;expert_linear2_1_2 -->
<g id="edge111" class="edge">
<title>expert_activation_1_2&#45;&gt;expert_linear2_1_2</title>
<path fill="none" stroke="black" d="M1888.56,-3559.77C1894.79,-3551.18 1901.83,-3541.46 1908.44,-3532.33"/>
<polygon fill="black" stroke="black" points="1911.32,-3534.31 1914.35,-3524.16 1905.65,-3530.2 1911.32,-3534.31"/>
</g>
<!-- expert_linear2_1_2&#45;&gt;aggregate_1 -->
<g id="edge166" class="edge">
<title>expert_linear2_1_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2019.75,-3478.2C2034.79,-3475.46 2050.31,-3472.89 2065,-3470.91 2401.51,-3425.44 2797.87,-3401.26 3020.14,-3390.35"/>
<polygon fill="black" stroke="black" points="3020.44,-3393.84 3030.26,-3389.86 3020.1,-3386.85 3020.44,-3393.84"/>
</g>
<!-- expert_linear1_1_3 -->
<g id="node96" class="node">
<title>expert_linear1_1_3</title>
<polygon fill="lightgreen" stroke="black" points="2032,-3701.91 1850,-3701.91 1850,-3648.91 2032,-3648.91 2032,-3701.91"/>
<text text-anchor="middle" x="1941" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1941" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1941" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 19</text>
</g>
<!-- route_to_expert_1_3&#45;&gt;expert_linear1_1_3 -->
<g id="edge113" class="edge">
<title>route_to_expert_1_3&#45;&gt;expert_linear1_1_3</title>
<path fill="none" stroke="black" d="M1901.73,-3738.46C1907.49,-3729.36 1913.65,-3719.62 1919.35,-3710.62"/>
<polygon fill="black" stroke="black" points="1922.47,-3712.23 1924.86,-3701.91 1916.56,-3708.49 1922.47,-3712.23"/>
</g>
<!-- expert_activation_1_3 -->
<g id="node97" class="node">
<title>expert_activation_1_3</title>
<polygon fill="lightgreen" stroke="black" points="2224,-3612.91 2042,-3612.91 2042,-3559.91 2224,-3559.91 2224,-3612.91"/>
<text text-anchor="middle" x="2133" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2133" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2133" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 19</text>
</g>
<!-- expert_linear1_1_3&#45;&gt;expert_activation_1_3 -->
<g id="edge114" class="edge">
<title>expert_linear1_1_3&#45;&gt;expert_activation_1_3</title>
<path fill="none" stroke="black" d="M1997.31,-3648.89C2019.29,-3638.93 2044.64,-3627.45 2067.43,-3617.12"/>
<polygon fill="black" stroke="black" points="2069.03,-3620.24 2076.69,-3612.92 2066.14,-3613.86 2069.03,-3620.24"/>
</g>
<!-- expert_linear2_1_3 -->
<g id="node98" class="node">
<title>expert_linear2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="2246.5,-3523.91 2073.5,-3523.91 2073.5,-3470.91 2246.5,-3470.91 2246.5,-3523.91"/>
<text text-anchor="middle" x="2160" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="2160" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2160" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 19</text>
</g>
<!-- expert_activation_1_3&#45;&gt;expert_linear2_1_3 -->
<g id="edge115" class="edge">
<title>expert_activation_1_3&#45;&gt;expert_linear2_1_3</title>
<path fill="none" stroke="black" d="M2140.95,-3559.77C2143.49,-3551.62 2146.33,-3542.44 2149.04,-3533.73"/>
<polygon fill="black" stroke="black" points="2152.39,-3534.74 2152.01,-3524.16 2145.7,-3532.67 2152.39,-3534.74"/>
</g>
<!-- expert_linear2_1_3&#45;&gt;aggregate_1 -->
<g id="edge167" class="edge">
<title>expert_linear2_1_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2246.51,-3477.39C2259.05,-3474.99 2271.83,-3472.74 2284,-3470.91 2540.22,-3432.29 2839.7,-3407.14 3023.09,-3393.98"/>
<polygon fill="black" stroke="black" points="3023.37,-3397.47 3033.09,-3393.27 3022.87,-3390.49 3023.37,-3397.47"/>
</g>
<!-- expert_linear1_1_4 -->
<g id="node100" class="node">
<title>expert_linear1_1_4</title>
<polygon fill="lightgreen" stroke="black" points="2295,-3701.91 2113,-3701.91 2113,-3648.91 2295,-3648.91 2295,-3701.91"/>
<text text-anchor="middle" x="2204" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="2204" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2204" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 20</text>
</g>
<!-- route_to_expert_1_4&#45;&gt;expert_linear1_1_4 -->
<g id="edge117" class="edge">
<title>route_to_expert_1_4&#45;&gt;expert_linear1_1_4</title>
<path fill="none" stroke="black" d="M2164.73,-3738.46C2170.49,-3729.36 2176.65,-3719.62 2182.35,-3710.62"/>
<polygon fill="black" stroke="black" points="2185.47,-3712.23 2187.86,-3701.91 2179.56,-3708.49 2185.47,-3712.23"/>
</g>
<!-- expert_activation_1_4 -->
<g id="node101" class="node">
<title>expert_activation_1_4</title>
<polygon fill="lightgreen" stroke="black" points="2455,-3612.91 2273,-3612.91 2273,-3559.91 2455,-3559.91 2455,-3612.91"/>
<text text-anchor="middle" x="2364" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="2364" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2364" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 20</text>
</g>
<!-- expert_linear1_1_4&#45;&gt;expert_activation_1_4 -->
<g id="edge118" class="edge">
<title>expert_linear1_1_4&#45;&gt;expert_activation_1_4</title>
<path fill="none" stroke="black" d="M2251.14,-3648.77C2268.96,-3639.08 2289.42,-3627.96 2307.98,-3617.87"/>
<polygon fill="black" stroke="black" points="2309.81,-3620.86 2316.92,-3613.01 2306.46,-3614.71 2309.81,-3620.86"/>
</g>
<!-- expert_linear2_1_4 -->
<g id="node102" class="node">
<title>expert_linear2_1_4</title>
<polygon fill="lightgreen" stroke="black" points="2465.5,-3523.91 2292.5,-3523.91 2292.5,-3470.91 2465.5,-3470.91 2465.5,-3523.91"/>
<text text-anchor="middle" x="2379" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="2379" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2379" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 20</text>
</g>
<!-- expert_activation_1_4&#45;&gt;expert_linear2_1_4 -->
<g id="edge119" class="edge">
<title>expert_activation_1_4&#45;&gt;expert_linear2_1_4</title>
<path fill="none" stroke="black" d="M2368.42,-3559.77C2369.8,-3551.79 2371.34,-3542.84 2372.81,-3534.29"/>
<polygon fill="black" stroke="black" points="2376.31,-3534.61 2374.56,-3524.16 2369.41,-3533.42 2376.31,-3534.61"/>
</g>
<!-- expert_linear2_1_4&#45;&gt;aggregate_1 -->
<g id="edge168" class="edge">
<title>expert_linear2_1_4&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2465.65,-3475.78C2474.19,-3474.02 2482.75,-3472.36 2491,-3470.91 2673.33,-3438.82 2884.27,-3414.04 3027.15,-3399.07"/>
<polygon fill="black" stroke="black" points="3027.74,-3402.53 3037.32,-3398.01 3027.01,-3395.57 3027.74,-3402.53"/>
</g>
<!-- expert_linear1_1_5 -->
<g id="node104" class="node">
<title>expert_linear1_1_5</title>
<polygon fill="lightgreen" stroke="black" points="2557,-3701.91 2375,-3701.91 2375,-3648.91 2557,-3648.91 2557,-3701.91"/>
<text text-anchor="middle" x="2466" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="2466" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2466" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 21</text>
</g>
<!-- route_to_expert_1_5&#45;&gt;expert_linear1_1_5 -->
<g id="edge121" class="edge">
<title>route_to_expert_1_5&#45;&gt;expert_linear1_1_5</title>
<path fill="none" stroke="black" d="M2427.37,-3738.46C2433.03,-3729.36 2439.09,-3719.62 2444.7,-3710.62"/>
<polygon fill="black" stroke="black" points="2447.81,-3712.25 2450.12,-3701.91 2441.87,-3708.55 2447.81,-3712.25"/>
</g>
<!-- expert_activation_1_5 -->
<g id="node105" class="node">
<title>expert_activation_1_5</title>
<polygon fill="lightgreen" stroke="black" points="2671,-3612.91 2489,-3612.91 2489,-3559.91 2671,-3559.91 2671,-3612.91"/>
<text text-anchor="middle" x="2580" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="2580" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2580" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 21</text>
</g>
<!-- expert_linear1_1_5&#45;&gt;expert_activation_1_5 -->
<g id="edge122" class="edge">
<title>expert_linear1_1_5&#45;&gt;expert_activation_1_5</title>
<path fill="none" stroke="black" d="M2499.59,-3648.77C2511.66,-3639.56 2525.42,-3629.06 2538.11,-3619.38"/>
<polygon fill="black" stroke="black" points="2540.43,-3622.01 2546.26,-3613.16 2536.19,-3616.44 2540.43,-3622.01"/>
</g>
<!-- expert_linear2_1_5 -->
<g id="node106" class="node">
<title>expert_linear2_1_5</title>
<polygon fill="lightgreen" stroke="black" points="2672.5,-3523.91 2499.5,-3523.91 2499.5,-3470.91 2672.5,-3470.91 2672.5,-3523.91"/>
<text text-anchor="middle" x="2586" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2586" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2586" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 21</text>
</g>
<!-- expert_activation_1_5&#45;&gt;expert_linear2_1_5 -->
<g id="edge123" class="edge">
<title>expert_activation_1_5&#45;&gt;expert_linear2_1_5</title>
<path fill="none" stroke="black" d="M2581.77,-3559.77C2582.32,-3551.79 2582.94,-3542.84 2583.53,-3534.29"/>
<polygon fill="black" stroke="black" points="2587.03,-3534.37 2584.22,-3524.16 2580.04,-3533.89 2587.03,-3534.37"/>
</g>
<!-- expert_linear2_1_5&#45;&gt;aggregate_1 -->
<g id="edge169" class="edge">
<title>expert_linear2_1_5&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2672.7,-3476.96C2682.57,-3474.86 2692.5,-3472.8 2702,-3470.91 2813.06,-3448.78 2938.75,-3426.34 3035.29,-3409.66"/>
<polygon fill="black" stroke="black" points="3036.17,-3413.06 3045.43,-3407.91 3034.98,-3406.16 3036.17,-3413.06"/>
</g>
<!-- expert_linear1_1_6 -->
<g id="node108" class="node">
<title>expert_linear1_1_6</title>
<polygon fill="lightgreen" stroke="black" points="2819,-3701.91 2637,-3701.91 2637,-3648.91 2819,-3648.91 2819,-3701.91"/>
<text text-anchor="middle" x="2728" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="2728" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2728" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 22</text>
</g>
<!-- route_to_expert_1_6&#45;&gt;expert_linear1_1_6 -->
<g id="edge125" class="edge">
<title>route_to_expert_1_6&#45;&gt;expert_linear1_1_6</title>
<path fill="none" stroke="black" d="M2690,-3738.46C2695.57,-3729.36 2701.54,-3719.62 2707.05,-3710.62"/>
<polygon fill="black" stroke="black" points="2710.15,-3712.26 2712.38,-3701.91 2704.18,-3708.61 2710.15,-3712.26"/>
</g>
<!-- expert_activation_1_6 -->
<g id="node109" class="node">
<title>expert_activation_1_6</title>
<polygon fill="lightgreen" stroke="black" points="2879,-3612.91 2697,-3612.91 2697,-3559.91 2879,-3559.91 2879,-3612.91"/>
<text text-anchor="middle" x="2788" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2788" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2788" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 22</text>
</g>
<!-- expert_linear1_1_6&#45;&gt;expert_activation_1_6 -->
<g id="edge126" class="edge">
<title>expert_linear1_1_6&#45;&gt;expert_activation_1_6</title>
<path fill="none" stroke="black" d="M2745.68,-3648.77C2751.55,-3640.27 2758.17,-3630.65 2764.41,-3621.61"/>
<polygon fill="black" stroke="black" points="2767.45,-3623.38 2770.24,-3613.16 2761.68,-3619.4 2767.45,-3623.38"/>
</g>
<!-- expert_linear2_1_6 -->
<g id="node110" class="node">
<title>expert_linear2_1_6</title>
<polygon fill="lightgreen" stroke="black" points="2883.5,-3523.91 2710.5,-3523.91 2710.5,-3470.91 2883.5,-3470.91 2883.5,-3523.91"/>
<text text-anchor="middle" x="2797" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2797" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2797" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 22</text>
</g>
<!-- expert_activation_1_6&#45;&gt;expert_linear2_1_6 -->
<g id="edge127" class="edge">
<title>expert_activation_1_6&#45;&gt;expert_linear2_1_6</title>
<path fill="none" stroke="black" d="M2790.65,-3559.77C2791.48,-3551.79 2792.4,-3542.84 2793.29,-3534.29"/>
<polygon fill="black" stroke="black" points="2796.79,-3534.46 2794.34,-3524.16 2789.83,-3533.74 2796.79,-3534.46"/>
</g>
<!-- expert_linear2_1_6&#45;&gt;aggregate_1 -->
<g id="edge170" class="edge">
<title>expert_linear2_1_6&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2883.63,-3471.64C2931.41,-3457.98 2992.03,-3440.65 3047,-3424.93"/>
<polygon fill="black" stroke="black" points="3048.18,-3428.24 3056.83,-3422.12 3046.25,-3421.51 3048.18,-3428.24"/>
</g>
<!-- expert_linear1_1_7 -->
<g id="node112" class="node">
<title>expert_linear1_1_7</title>
<polygon fill="lightgreen" stroke="black" points="3081,-3701.91 2899,-3701.91 2899,-3648.91 3081,-3648.91 3081,-3701.91"/>
<text text-anchor="middle" x="2990" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2990" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2990" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 23</text>
</g>
<!-- route_to_expert_1_7&#45;&gt;expert_linear1_1_7 -->
<g id="edge129" class="edge">
<title>route_to_expert_1_7&#45;&gt;expert_linear1_1_7</title>
<path fill="none" stroke="black" d="M2952.63,-3738.46C2958.11,-3729.36 2963.98,-3719.62 2969.4,-3710.62"/>
<polygon fill="black" stroke="black" points="2972.48,-3712.28 2974.64,-3701.91 2966.49,-3708.67 2972.48,-3712.28"/>
</g>
<!-- expert_activation_1_7 -->
<g id="node113" class="node">
<title>expert_activation_1_7</title>
<polygon fill="lightgreen" stroke="black" points="3083,-3612.91 2901,-3612.91 2901,-3559.91 3083,-3559.91 3083,-3612.91"/>
<text text-anchor="middle" x="2992" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2992" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2992" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 23</text>
</g>
<!-- expert_linear1_1_7&#45;&gt;expert_activation_1_7 -->
<g id="edge130" class="edge">
<title>expert_linear1_1_7&#45;&gt;expert_activation_1_7</title>
<path fill="none" stroke="black" d="M2990.59,-3648.77C2990.77,-3640.79 2990.98,-3631.84 2991.18,-3623.29"/>
<polygon fill="black" stroke="black" points="2994.68,-3623.23 2991.41,-3613.16 2987.68,-3623.07 2994.68,-3623.23"/>
</g>
<!-- expert_linear2_1_7 -->
<g id="node114" class="node">
<title>expert_linear2_1_7</title>
<polygon fill="lightgreen" stroke="black" points="3084.5,-3523.91 2911.5,-3523.91 2911.5,-3470.91 3084.5,-3470.91 3084.5,-3523.91"/>
<text text-anchor="middle" x="2998" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2998" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2998" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 23</text>
</g>
<!-- expert_activation_1_7&#45;&gt;expert_linear2_1_7 -->
<g id="edge131" class="edge">
<title>expert_activation_1_7&#45;&gt;expert_linear2_1_7</title>
<path fill="none" stroke="black" d="M2993.77,-3559.77C2994.32,-3551.79 2994.94,-3542.84 2995.53,-3534.29"/>
<polygon fill="black" stroke="black" points="2999.03,-3534.37 2996.22,-3524.16 2992.04,-3533.89 2999.03,-3534.37"/>
</g>
<!-- expert_linear2_1_7&#45;&gt;aggregate_1 -->
<g id="edge171" class="edge">
<title>expert_linear2_1_7&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3042.48,-3470.65C3058.27,-3461.5 3076.74,-3450.81 3095.25,-3440.09"/>
<polygon fill="black" stroke="black" points="3097.14,-3443.04 3104.04,-3435 3093.63,-3436.99 3097.14,-3443.04"/>
</g>
<!-- expert_linear1_1_8 -->
<g id="node116" class="node">
<title>expert_linear1_1_8</title>
<polygon fill="lightgreen" stroke="black" points="3285,-3701.91 3103,-3701.91 3103,-3648.91 3285,-3648.91 3285,-3701.91"/>
<text text-anchor="middle" x="3194" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="3194" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3194" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 24</text>
</g>
<!-- route_to_expert_1_8&#45;&gt;expert_linear1_1_8 -->
<g id="edge133" class="edge">
<title>route_to_expert_1_8&#45;&gt;expert_linear1_1_8</title>
<path fill="none" stroke="black" d="M3194,-3737.9C3194,-3729.48 3194,-3720.54 3194,-3712.16"/>
<polygon fill="black" stroke="black" points="3197.5,-3711.92 3194,-3701.92 3190.5,-3711.92 3197.5,-3711.92"/>
</g>
<!-- expert_activation_1_8 -->
<g id="node117" class="node">
<title>expert_activation_1_8</title>
<polygon fill="lightgreen" stroke="black" points="3285,-3612.91 3103,-3612.91 3103,-3559.91 3285,-3559.91 3285,-3612.91"/>
<text text-anchor="middle" x="3194" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="3194" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3194" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 24</text>
</g>
<!-- expert_linear1_1_8&#45;&gt;expert_activation_1_8 -->
<g id="edge134" class="edge">
<title>expert_linear1_1_8&#45;&gt;expert_activation_1_8</title>
<path fill="none" stroke="black" d="M3194,-3648.77C3194,-3640.79 3194,-3631.84 3194,-3623.29"/>
<polygon fill="black" stroke="black" points="3197.5,-3623.16 3194,-3613.16 3190.5,-3623.16 3197.5,-3623.16"/>
</g>
<!-- expert_linear2_1_8 -->
<g id="node118" class="node">
<title>expert_linear2_1_8</title>
<polygon fill="lightgreen" stroke="black" points="3280.5,-3523.91 3107.5,-3523.91 3107.5,-3470.91 3280.5,-3470.91 3280.5,-3523.91"/>
<text text-anchor="middle" x="3194" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="3194" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3194" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 24</text>
</g>
<!-- expert_activation_1_8&#45;&gt;expert_linear2_1_8 -->
<g id="edge135" class="edge">
<title>expert_activation_1_8&#45;&gt;expert_linear2_1_8</title>
<path fill="none" stroke="black" d="M3194,-3559.77C3194,-3551.79 3194,-3542.84 3194,-3534.29"/>
<polygon fill="black" stroke="black" points="3197.5,-3534.16 3194,-3524.16 3190.5,-3534.16 3197.5,-3534.16"/>
</g>
<!-- expert_linear2_1_8&#45;&gt;aggregate_1 -->
<g id="edge172" class="edge">
<title>expert_linear2_1_8&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3194,-3470.65C3194,-3462.95 3194,-3454.16 3194,-3445.18"/>
<polygon fill="black" stroke="black" points="3197.5,-3445 3194,-3435 3190.5,-3445 3197.5,-3445"/>
</g>
<!-- expert_linear1_1_9 -->
<g id="node120" class="node">
<title>expert_linear1_1_9</title>
<polygon fill="lightgreen" stroke="black" points="3516,-3701.91 3334,-3701.91 3334,-3648.91 3516,-3648.91 3516,-3701.91"/>
<text text-anchor="middle" x="3425" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="3425" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3425" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 25</text>
</g>
<!-- route_to_expert_1_9&#45;&gt;expert_linear1_1_9 -->
<g id="edge137" class="edge">
<title>route_to_expert_1_9&#45;&gt;expert_linear1_1_9</title>
<path fill="none" stroke="black" d="M3445.08,-3737.9C3442.27,-3729.3 3439.28,-3720.14 3436.49,-3711.6"/>
<polygon fill="black" stroke="black" points="3439.76,-3710.34 3433.33,-3701.92 3433.11,-3712.51 3439.76,-3710.34"/>
</g>
<!-- expert_activation_1_9 -->
<g id="node121" class="node">
<title>expert_activation_1_9</title>
<polygon fill="lightgreen" stroke="black" points="3506,-3612.91 3324,-3612.91 3324,-3559.91 3506,-3559.91 3506,-3612.91"/>
<text text-anchor="middle" x="3415" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="3415" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3415" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 25</text>
</g>
<!-- expert_linear1_1_9&#45;&gt;expert_activation_1_9 -->
<g id="edge138" class="edge">
<title>expert_linear1_1_9&#45;&gt;expert_activation_1_9</title>
<path fill="none" stroke="black" d="M3422.05,-3648.77C3421.14,-3640.79 3420.11,-3631.84 3419.12,-3623.29"/>
<polygon fill="black" stroke="black" points="3422.58,-3622.69 3417.96,-3613.16 3415.62,-3623.49 3422.58,-3622.69"/>
</g>
<!-- expert_linear2_1_9 -->
<g id="node122" class="node">
<title>expert_linear2_1_9</title>
<polygon fill="lightgreen" stroke="black" points="3491.5,-3523.91 3318.5,-3523.91 3318.5,-3470.91 3491.5,-3470.91 3491.5,-3523.91"/>
<text text-anchor="middle" x="3405" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="3405" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3405" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 25</text>
</g>
<!-- expert_activation_1_9&#45;&gt;expert_linear2_1_9 -->
<g id="edge139" class="edge">
<title>expert_activation_1_9&#45;&gt;expert_linear2_1_9</title>
<path fill="none" stroke="black" d="M3412.05,-3559.77C3411.14,-3551.79 3410.11,-3542.84 3409.12,-3534.29"/>
<polygon fill="black" stroke="black" points="3412.58,-3533.69 3407.96,-3524.16 3405.62,-3534.49 3412.58,-3533.69"/>
</g>
<!-- expert_linear2_1_9&#45;&gt;aggregate_1 -->
<g id="edge173" class="edge">
<title>expert_linear2_1_9&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3357.38,-3470.79C3340.23,-3461.57 3320.12,-3450.75 3299.99,-3439.92"/>
<polygon fill="black" stroke="black" points="3301.52,-3436.77 3291.06,-3435.12 3298.21,-3442.94 3301.52,-3436.77"/>
</g>
<!-- expert_linear1_1_10 -->
<g id="node124" class="node">
<title>expert_linear1_1_10</title>
<polygon fill="lightgreen" stroke="black" points="3763,-3701.91 3581,-3701.91 3581,-3648.91 3763,-3648.91 3763,-3701.91"/>
<text text-anchor="middle" x="3672" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3672" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3672" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 26</text>
</g>
<!-- route_to_expert_1_10&#45;&gt;expert_linear1_1_10 -->
<g id="edge141" class="edge">
<title>route_to_expert_1_10&#45;&gt;expert_linear1_1_10</title>
<path fill="none" stroke="black" d="M3702.26,-3738.18C3697.95,-3729.37 3693.34,-3719.97 3689.06,-3711.23"/>
<polygon fill="black" stroke="black" points="3692.11,-3709.5 3684.57,-3702.06 3685.83,-3712.58 3692.11,-3709.5"/>
</g>
<!-- expert_activation_1_10 -->
<g id="node125" class="node">
<title>expert_activation_1_10</title>
<polygon fill="lightgreen" stroke="black" points="3744,-3612.91 3562,-3612.91 3562,-3559.91 3744,-3559.91 3744,-3612.91"/>
<text text-anchor="middle" x="3653" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="3653" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3653" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 26</text>
</g>
<!-- expert_linear1_1_10&#45;&gt;expert_activation_1_10 -->
<g id="edge142" class="edge">
<title>expert_linear1_1_10&#45;&gt;expert_activation_1_10</title>
<path fill="none" stroke="black" d="M3666.4,-3648.77C3664.64,-3640.7 3662.66,-3631.64 3660.78,-3623.01"/>
<polygon fill="black" stroke="black" points="3664.18,-3622.18 3658.62,-3613.16 3657.34,-3623.67 3664.18,-3622.18"/>
</g>
<!-- expert_linear2_1_10 -->
<g id="node126" class="node">
<title>expert_linear2_1_10</title>
<polygon fill="lightgreen" stroke="black" points="3720.5,-3523.91 3547.5,-3523.91 3547.5,-3470.91 3720.5,-3470.91 3720.5,-3523.91"/>
<text text-anchor="middle" x="3634" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3634" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3634" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 26</text>
</g>
<!-- expert_activation_1_10&#45;&gt;expert_linear2_1_10 -->
<g id="edge143" class="edge">
<title>expert_activation_1_10&#45;&gt;expert_linear2_1_10</title>
<path fill="none" stroke="black" d="M3647.4,-3559.77C3645.64,-3551.7 3643.66,-3542.64 3641.78,-3534.01"/>
<polygon fill="black" stroke="black" points="3645.18,-3533.18 3639.62,-3524.16 3638.34,-3534.67 3645.18,-3533.18"/>
</g>
<!-- expert_linear2_1_10&#45;&gt;aggregate_1 -->
<g id="edge174" class="edge">
<title>expert_linear2_1_10&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3547.33,-3474.05C3506.41,-3463.49 3455.6,-3450.39 3405.39,-3437.44"/>
<polygon fill="black" stroke="black" points="3406.25,-3434.04 3395.69,-3434.93 3404.5,-3440.82 3406.25,-3434.04"/>
</g>
<!-- expert_linear1_1_11 -->
<g id="node128" class="node">
<title>expert_linear1_1_11</title>
<polygon fill="lightgreen" stroke="black" points="4019,-3701.91 3837,-3701.91 3837,-3648.91 4019,-3648.91 4019,-3701.91"/>
<text text-anchor="middle" x="3928" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3928" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3928" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 27</text>
</g>
<!-- route_to_expert_1_11&#45;&gt;expert_linear1_1_11 -->
<g id="edge145" class="edge">
<title>route_to_expert_1_11&#45;&gt;expert_linear1_1_11</title>
<path fill="none" stroke="black" d="M3962.68,-3738.18C3957.68,-3729.28 3952.34,-3719.77 3947.39,-3710.95"/>
<polygon fill="black" stroke="black" points="3950.35,-3709.07 3942.4,-3702.06 3944.25,-3712.5 3950.35,-3709.07"/>
</g>
<!-- expert_activation_1_11 -->
<g id="node129" class="node">
<title>expert_activation_1_11</title>
<polygon fill="lightgreen" stroke="black" points="3993,-3612.91 3811,-3612.91 3811,-3559.91 3993,-3559.91 3993,-3612.91"/>
<text text-anchor="middle" x="3902" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3902" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3902" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 27</text>
</g>
<!-- expert_linear1_1_11&#45;&gt;expert_activation_1_11 -->
<g id="edge146" class="edge">
<title>expert_linear1_1_11&#45;&gt;expert_activation_1_11</title>
<path fill="none" stroke="black" d="M3920.34,-3648.77C3917.93,-3640.7 3915.22,-3631.64 3912.64,-3623.01"/>
<polygon fill="black" stroke="black" points="3915.91,-3621.74 3909.7,-3613.16 3909.21,-3623.74 3915.91,-3621.74"/>
</g>
<!-- expert_linear2_1_11 -->
<g id="node130" class="node">
<title>expert_linear2_1_11</title>
<polygon fill="lightgreen" stroke="black" points="3937.5,-3523.91 3764.5,-3523.91 3764.5,-3470.91 3937.5,-3470.91 3937.5,-3523.91"/>
<text text-anchor="middle" x="3851" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3851" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3851" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 27</text>
</g>
<!-- expert_activation_1_11&#45;&gt;expert_linear2_1_11 -->
<g id="edge147" class="edge">
<title>expert_activation_1_11&#45;&gt;expert_linear2_1_11</title>
<path fill="none" stroke="black" d="M3886.97,-3559.77C3882.04,-3551.35 3876.47,-3541.85 3871.21,-3532.89"/>
<polygon fill="black" stroke="black" points="3874.17,-3531.01 3866.09,-3524.16 3868.13,-3534.55 3874.17,-3531.01"/>
</g>
<!-- expert_linear2_1_11&#45;&gt;aggregate_1 -->
<g id="edge175" class="edge">
<title>expert_linear2_1_11&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3764.18,-3477.62C3752.7,-3475.28 3741.08,-3472.98 3730,-3470.91 3621.12,-3450.51 3499.32,-3430.3 3399.36,-3414.41"/>
<polygon fill="black" stroke="black" points="3399.88,-3410.94 3389.45,-3412.83 3398.78,-3417.86 3399.88,-3410.94"/>
</g>
<!-- expert_linear1_1_12 -->
<g id="node132" class="node">
<title>expert_linear1_1_12</title>
<polygon fill="lightgreen" stroke="black" points="4278,-3701.91 4096,-3701.91 4096,-3648.91 4278,-3648.91 4278,-3701.91"/>
<text text-anchor="middle" x="4187" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="4187" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4187" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 28</text>
</g>
<!-- route_to_expert_1_12&#45;&gt;expert_linear1_1_12 -->
<g id="edge149" class="edge">
<title>route_to_expert_1_12&#45;&gt;expert_linear1_1_12</title>
<path fill="none" stroke="black" d="M4224.37,-3738.46C4218.89,-3729.36 4213.02,-3719.62 4207.6,-3710.62"/>
<polygon fill="black" stroke="black" points="4210.51,-3708.67 4202.36,-3701.91 4204.52,-3712.28 4210.51,-3708.67"/>
</g>
<!-- expert_activation_1_12 -->
<g id="node133" class="node">
<title>expert_activation_1_12</title>
<polygon fill="lightgreen" stroke="black" points="4249,-3612.91 4067,-3612.91 4067,-3559.91 4249,-3559.91 4249,-3612.91"/>
<text text-anchor="middle" x="4158" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="4158" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4158" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 28</text>
</g>
<!-- expert_linear1_1_12&#45;&gt;expert_activation_1_12 -->
<g id="edge150" class="edge">
<title>expert_linear1_1_12&#45;&gt;expert_activation_1_12</title>
<path fill="none" stroke="black" d="M4178.46,-3648.77C4175.74,-3640.62 4172.68,-3631.44 4169.77,-3622.73"/>
<polygon fill="black" stroke="black" points="4173.07,-3621.54 4166.58,-3613.16 4166.43,-3623.75 4173.07,-3621.54"/>
</g>
<!-- expert_linear2_1_12 -->
<g id="node134" class="node">
<title>expert_linear2_1_12</title>
<polygon fill="lightgreen" stroke="black" points="4185.5,-3523.91 4012.5,-3523.91 4012.5,-3470.91 4185.5,-3470.91 4185.5,-3523.91"/>
<text text-anchor="middle" x="4099" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="4099" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4099" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 28</text>
</g>
<!-- expert_activation_1_12&#45;&gt;expert_linear2_1_12 -->
<g id="edge151" class="edge">
<title>expert_activation_1_12&#45;&gt;expert_linear2_1_12</title>
<path fill="none" stroke="black" d="M4140.62,-3559.77C4134.85,-3551.27 4128.33,-3541.65 4122.19,-3532.61"/>
<polygon fill="black" stroke="black" points="4124.97,-3530.47 4116.46,-3524.16 4119.18,-3534.4 4124.97,-3530.47"/>
</g>
<!-- expert_linear2_1_12&#45;&gt;aggregate_1 -->
<g id="edge176" class="edge">
<title>expert_linear2_1_12&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4012.3,-3481.09C3990.98,-3477.54 3968.19,-3473.92 3947,-3470.91 3758.79,-3444.14 3543.27,-3419.56 3391.16,-3403.23"/>
<polygon fill="black" stroke="black" points="3391.09,-3399.7 3380.78,-3402.12 3390.35,-3406.66 3391.09,-3399.7"/>
</g>
<!-- expert_linear1_1_13 -->
<g id="node136" class="node">
<title>expert_linear1_1_13</title>
<polygon fill="lightgreen" stroke="black" points="4539,-3701.91 4357,-3701.91 4357,-3648.91 4539,-3648.91 4539,-3701.91"/>
<text text-anchor="middle" x="4448" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="4448" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4448" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 29</text>
</g>
<!-- route_to_expert_1_13&#45;&gt;expert_linear1_1_13 -->
<g id="edge153" class="edge">
<title>route_to_expert_1_13&#45;&gt;expert_linear1_1_13</title>
<path fill="none" stroke="black" d="M4486.63,-3738.46C4480.97,-3729.36 4474.91,-3719.62 4469.3,-3710.62"/>
<polygon fill="black" stroke="black" points="4472.13,-3708.55 4463.88,-3701.91 4466.19,-3712.25 4472.13,-3708.55"/>
</g>
<!-- expert_activation_1_13 -->
<g id="node137" class="node">
<title>expert_activation_1_13</title>
<polygon fill="lightgreen" stroke="black" points="4513,-3612.91 4331,-3612.91 4331,-3559.91 4513,-3559.91 4513,-3612.91"/>
<text text-anchor="middle" x="4422" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="4422" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4422" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 29</text>
</g>
<!-- expert_linear1_1_13&#45;&gt;expert_activation_1_13 -->
<g id="edge154" class="edge">
<title>expert_linear1_1_13&#45;&gt;expert_activation_1_13</title>
<path fill="none" stroke="black" d="M4440.34,-3648.77C4437.93,-3640.7 4435.22,-3631.64 4432.64,-3623.01"/>
<polygon fill="black" stroke="black" points="4435.91,-3621.74 4429.7,-3613.16 4429.21,-3623.74 4435.91,-3621.74"/>
</g>
<!-- expert_linear2_1_13 -->
<g id="node138" class="node">
<title>expert_linear2_1_13</title>
<polygon fill="lightgreen" stroke="black" points="4440.5,-3523.91 4267.5,-3523.91 4267.5,-3470.91 4440.5,-3470.91 4440.5,-3523.91"/>
<text text-anchor="middle" x="4354" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="4354" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4354" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 29</text>
</g>
<!-- expert_activation_1_13&#45;&gt;expert_linear2_1_13 -->
<g id="edge155" class="edge">
<title>expert_activation_1_13&#45;&gt;expert_linear2_1_13</title>
<path fill="none" stroke="black" d="M4401.97,-3559.77C4395.18,-3551.09 4387.49,-3541.26 4380.29,-3532.05"/>
<polygon fill="black" stroke="black" points="4383.04,-3529.88 4374.13,-3524.16 4377.53,-3534.19 4383.04,-3529.88"/>
</g>
<!-- expert_linear2_1_13&#45;&gt;aggregate_1 -->
<g id="edge177" class="edge">
<title>expert_linear2_1_13&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4267.1,-3481.32C4243.73,-3477.58 4218.44,-3473.81 4195,-3470.91 3913.87,-3436.05 3586.63,-3410.01 3384.9,-3395.62"/>
<polygon fill="black" stroke="black" points="3385.01,-3392.12 3374.79,-3394.9 3384.51,-3399.1 3385.01,-3392.12"/>
</g>
<!-- expert_linear1_1_14 -->
<g id="node140" class="node">
<title>expert_linear1_1_14</title>
<polygon fill="lightgreen" stroke="black" points="4801,-3701.91 4619,-3701.91 4619,-3648.91 4801,-3648.91 4801,-3701.91"/>
<text text-anchor="middle" x="4710" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="4710" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4710" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 30</text>
</g>
<!-- route_to_expert_1_14&#45;&gt;expert_linear1_1_14 -->
<g id="edge157" class="edge">
<title>route_to_expert_1_14&#45;&gt;expert_linear1_1_14</title>
<path fill="none" stroke="black" d="M4749.27,-3738.46C4743.51,-3729.36 4737.35,-3719.62 4731.65,-3710.62"/>
<polygon fill="black" stroke="black" points="4734.44,-3708.49 4726.14,-3701.91 4728.53,-3712.23 4734.44,-3708.49"/>
</g>
<!-- expert_activation_1_14 -->
<g id="node141" class="node">
<title>expert_activation_1_14</title>
<polygon fill="lightgreen" stroke="black" points="4744,-3612.91 4562,-3612.91 4562,-3559.91 4744,-3559.91 4744,-3612.91"/>
<text text-anchor="middle" x="4653" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="4653" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4653" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 30</text>
</g>
<!-- expert_linear1_1_14&#45;&gt;expert_activation_1_14 -->
<g id="edge158" class="edge">
<title>expert_linear1_1_14&#45;&gt;expert_activation_1_14</title>
<path fill="none" stroke="black" d="M4693.21,-3648.77C4687.63,-3640.27 4681.33,-3630.65 4675.41,-3621.61"/>
<polygon fill="black" stroke="black" points="4678.28,-3619.6 4669.87,-3613.16 4672.42,-3623.44 4678.28,-3619.6"/>
</g>
<!-- expert_linear2_1_14 -->
<g id="node142" class="node">
<title>expert_linear2_1_14</title>
<polygon fill="lightgreen" stroke="black" points="4683.5,-3523.91 4510.5,-3523.91 4510.5,-3470.91 4683.5,-3470.91 4683.5,-3523.91"/>
<text text-anchor="middle" x="4597" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="4597" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4597" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 30</text>
</g>
<!-- expert_activation_1_14&#45;&gt;expert_linear2_1_14 -->
<g id="edge159" class="edge">
<title>expert_activation_1_14&#45;&gt;expert_linear2_1_14</title>
<path fill="none" stroke="black" d="M4636.5,-3559.77C4631.02,-3551.27 4624.84,-3541.65 4619.01,-3532.61"/>
<polygon fill="black" stroke="black" points="4621.93,-3530.67 4613.57,-3524.16 4616.04,-3534.46 4621.93,-3530.67"/>
</g>
<!-- expert_linear2_1_14&#45;&gt;aggregate_1 -->
<g id="edge178" class="edge">
<title>expert_linear2_1_14&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4510.16,-3479.83C4490.44,-3476.49 4469.54,-3473.28 4450,-3470.91 4071.7,-3424.96 3626.17,-3400.78 3380.41,-3390.03"/>
<polygon fill="black" stroke="black" points="3380.45,-3386.53 3370.31,-3389.59 3380.15,-3393.52 3380.45,-3386.53"/>
</g>
<!-- expert_linear1_1_15 -->
<g id="node144" class="node">
<title>expert_linear1_1_15</title>
<polygon fill="lightgreen" stroke="black" points="5064,-3701.91 4882,-3701.91 4882,-3648.91 5064,-3648.91 5064,-3701.91"/>
<text text-anchor="middle" x="4973" y="-3686.71" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4973" y="-3671.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4973" y="-3656.71" font-family="Times,serif" font-size="14.00">GPU: 31</text>
</g>
<!-- route_to_expert_1_15&#45;&gt;expert_linear1_1_15 -->
<g id="edge161" class="edge">
<title>route_to_expert_1_15&#45;&gt;expert_linear1_1_15</title>
<path fill="none" stroke="black" d="M5012.27,-3738.46C5006.51,-3729.36 5000.35,-3719.62 4994.65,-3710.62"/>
<polygon fill="black" stroke="black" points="4997.44,-3708.49 4989.14,-3701.91 4991.53,-3712.23 4997.44,-3708.49"/>
</g>
<!-- expert_activation_1_15 -->
<g id="node145" class="node">
<title>expert_activation_1_15</title>
<polygon fill="lightgreen" stroke="black" points="5025,-3612.91 4843,-3612.91 4843,-3559.91 5025,-3559.91 5025,-3612.91"/>
<text text-anchor="middle" x="4934" y="-3597.71" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4934" y="-3582.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4934" y="-3567.71" font-family="Times,serif" font-size="14.00">GPU: 31</text>
</g>
<!-- expert_linear1_1_15&#45;&gt;expert_activation_1_15 -->
<g id="edge162" class="edge">
<title>expert_linear1_1_15&#45;&gt;expert_activation_1_15</title>
<path fill="none" stroke="black" d="M4961.51,-3648.77C4957.81,-3640.53 4953.65,-3631.25 4949.71,-3622.45"/>
<polygon fill="black" stroke="black" points="4952.83,-3620.85 4945.54,-3613.16 4946.44,-3623.71 4952.83,-3620.85"/>
</g>
<!-- expert_linear2_1_15 -->
<g id="node146" class="node">
<title>expert_linear2_1_15</title>
<polygon fill="lightgreen" stroke="black" points="4952.5,-3523.91 4779.5,-3523.91 4779.5,-3470.91 4952.5,-3470.91 4952.5,-3523.91"/>
<text text-anchor="middle" x="4866" y="-3508.71" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4866" y="-3493.71" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4866" y="-3478.71" font-family="Times,serif" font-size="14.00">GPU: 31</text>
</g>
<!-- expert_activation_1_15&#45;&gt;expert_linear2_1_15 -->
<g id="edge163" class="edge">
<title>expert_activation_1_15&#45;&gt;expert_linear2_1_15</title>
<path fill="none" stroke="black" d="M4913.97,-3559.77C4907.18,-3551.09 4899.49,-3541.26 4892.29,-3532.05"/>
<polygon fill="black" stroke="black" points="4895.04,-3529.88 4886.13,-3524.16 4889.53,-3534.19 4895.04,-3529.88"/>
</g>
<!-- expert_linear2_1_15&#45;&gt;aggregate_1 -->
<g id="edge179" class="edge">
<title>expert_linear2_1_15&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4779.06,-3482.07C4751.6,-3477.95 4721.09,-3473.8 4693,-3470.91 4221.35,-3422.4 3663.25,-3398.4 3379.61,-3388.57"/>
<polygon fill="black" stroke="black" points="3379.33,-3385.05 3369.22,-3388.21 3379.09,-3392.05 3379.33,-3385.05"/>
</g>
<!-- aggregate_1&#45;&gt;moe_residual_1 -->
<g id="edge181" class="edge">
<title>aggregate_1&#45;&gt;moe_residual_1</title>
<path fill="none" stroke="black" d="M3339.07,-3351.39C3458.3,-3327.12 3626.11,-3292.98 3743.51,-3269.09"/>
<polygon fill="black" stroke="black" points="3744.54,-3272.45 3753.64,-3267.03 3743.15,-3265.59 3744.54,-3272.45"/>
</g>
<!-- ln2_1 -->
<g id="node149" class="node">
<title>ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="3971.5,-3150.91 3792.5,-3150.91 3792.5,-3097.91 3971.5,-3097.91 3971.5,-3150.91"/>
<text text-anchor="middle" x="3882" y="-3135.71" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="3882" y="-3120.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3882" y="-3105.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- moe_residual_1&#45;&gt;ln2_1 -->
<g id="edge182" class="edge">
<title>moe_residual_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M3882,-3186.81C3882,-3178.14 3882,-3169.32 3882,-3161.17"/>
<polygon fill="black" stroke="black" points="3885.5,-3160.92 3882,-3150.92 3878.5,-3160.92 3885.5,-3160.92"/>
</g>
<!-- mha_qkv_2 -->
<g id="node150" class="node">
<title>mha_qkv_2</title>
<polygon fill="lightgreen" stroke="black" points="3912.5,-3050.91 3733.5,-3050.91 3733.5,-2997.91 3912.5,-2997.91 3912.5,-3050.91"/>
<text text-anchor="middle" x="3823" y="-3035.71" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3823" y="-3020.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3823" y="-3005.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_1&#45;&gt;mha_qkv_2 -->
<g id="edge183" class="edge">
<title>ln2_1&#45;&gt;mha_qkv_2</title>
<path fill="none" stroke="black" d="M3866.5,-3097.66C3859.52,-3086.07 3851.18,-3072.22 3843.68,-3059.76"/>
<polygon fill="black" stroke="black" points="3846.55,-3057.74 3838.4,-3050.98 3840.56,-3061.36 3846.55,-3057.74"/>
</g>
<!-- mha_residual_2 -->
<g id="node153" class="node">
<title>mha_residual_2</title>
<polygon fill="lightyellow" stroke="black" points="4067.66,-2783.91 3772.32,-2783.91 3696.34,-2677.91 3991.68,-2677.91 4067.66,-2783.91"/>
<text text-anchor="middle" x="3882" y="-2742.21" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="3882" y="-2727.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3882" y="-2712.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_1&#45;&gt;mha_residual_2 -->
<g id="edge187" class="edge">
<title>ln2_1&#45;&gt;mha_residual_2</title>
<path fill="none" stroke="black" d="M3912.49,-3097.47C3916.36,-3092.71 3919.75,-3087.47 3922,-3081.91 3965.57,-2973.92 3946.65,-2933.71 3922,-2819.91 3920.1,-2811.11 3917.23,-2802.14 3913.9,-2793.46"/>
<polygon fill="black" stroke="black" points="3917.13,-2792.11 3910.12,-2784.17 3910.65,-2794.75 3917.13,-2792.11"/>
</g>
<!-- mha_attn_2 -->
<g id="node151" class="node">
<title>mha_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="3912.5,-2961.91 3733.5,-2961.91 3733.5,-2908.91 3912.5,-2908.91 3912.5,-2961.91"/>
<text text-anchor="middle" x="3823" y="-2946.71" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3823" y="-2931.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3823" y="-2916.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_qkv_2&#45;&gt;mha_attn_2 -->
<g id="edge184" class="edge">
<title>mha_qkv_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M3823,-2997.77C3823,-2989.79 3823,-2980.84 3823,-2972.29"/>
<polygon fill="black" stroke="black" points="3826.5,-2972.16 3823,-2962.16 3819.5,-2972.16 3826.5,-2972.16"/>
</g>
<!-- mha_out_2 -->
<g id="node152" class="node">
<title>mha_out_2</title>
<polygon fill="lightgreen" stroke="black" points="3912.5,-2872.91 3733.5,-2872.91 3733.5,-2819.91 3912.5,-2819.91 3912.5,-2872.91"/>
<text text-anchor="middle" x="3823" y="-2857.71" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="3823" y="-2842.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3823" y="-2827.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge185" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M3823,-2908.77C3823,-2900.79 3823,-2891.84 3823,-2883.29"/>
<polygon fill="black" stroke="black" points="3826.5,-2883.16 3823,-2873.16 3819.5,-2883.16 3826.5,-2883.16"/>
</g>
<!-- mha_out_2&#45;&gt;mha_residual_2 -->
<g id="edge186" class="edge">
<title>mha_out_2&#45;&gt;mha_residual_2</title>
<path fill="none" stroke="black" d="M3836.39,-2819.65C3840.56,-2811.62 3845.36,-2802.4 3850.23,-2793.02"/>
<polygon fill="black" stroke="black" points="3853.41,-2794.49 3854.92,-2784 3847.2,-2791.26 3853.41,-2794.49"/>
</g>
<!-- ln1_2 -->
<g id="node154" class="node">
<title>ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="3971.5,-2641.91 3792.5,-2641.91 3792.5,-2588.91 3971.5,-2588.91 3971.5,-2641.91"/>
<text text-anchor="middle" x="3882" y="-2626.71" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="3882" y="-2611.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3882" y="-2596.71" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_residual_2&#45;&gt;ln1_2 -->
<g id="edge188" class="edge">
<title>mha_residual_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M3882,-2677.81C3882,-2669.14 3882,-2660.32 3882,-2652.17"/>
<polygon fill="black" stroke="black" points="3885.5,-2651.92 3882,-2641.92 3878.5,-2651.92 3885.5,-2651.92"/>
</g>
<!-- gate_2 -->
<g id="node155" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="2618.83,-2552.91 2353.44,-2552.91 2285.17,-2446.91 2550.56,-2446.91 2618.83,-2552.91"/>
<text text-anchor="middle" x="2452" y="-2511.21" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="2452" y="-2496.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="2452" y="-2481.21" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_2&#45;&gt;gate_2 -->
<g id="edge189" class="edge">
<title>ln1_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M3792.28,-2607.29C3553.37,-2588.32 2899.81,-2536.45 2602.64,-2512.86"/>
<polygon fill="black" stroke="black" points="2602.9,-2509.37 2592.66,-2512.07 2602.35,-2516.35 2602.9,-2509.37"/>
</g>
<!-- moe_residual_2 -->
<g id="node221" class="node">
<title>moe_residual_2</title>
<polygon fill="lightyellow" stroke="black" points="3460.66,-1890.95 3165.32,-1890.95 3089.34,-1784.95 3384.68,-1784.95 3460.66,-1890.95"/>
<text text-anchor="middle" x="3275" y="-1849.25" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="3275" y="-1834.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3275" y="-1819.25" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_2&#45;&gt;moe_residual_2 -->
<g id="edge270" class="edge">
<title>ln1_2&#45;&gt;moe_residual_2</title>
<path fill="none" stroke="black" d="M3971.61,-2614.42C4127.93,-2609.23 4434,-2573.63 4434,-2374.43 4434,-2374.43 4434,-2374.43 4434,-2094.45 4434,-1892.34 3753.35,-1849.95 3435.27,-1841.18"/>
<polygon fill="black" stroke="black" points="3435.12,-1837.67 3425.03,-1840.9 3434.94,-1844.67 3435.12,-1837.67"/>
</g>
<!-- route_to_expert_2_0 -->
<g id="node156" class="node">
<title>route_to_expert_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="348" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="348" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="348" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="348" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_0 -->
<g id="edge190" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2317.26,-2496.84C1932.75,-2490.31 835.09,-2467.16 480,-2410.91 467.68,-2408.95 454.86,-2406.27 442.27,-2403.24"/>
<polygon fill="black" stroke="black" points="442.79,-2399.76 432.24,-2400.73 441.09,-2406.55 442.79,-2399.76"/>
</g>
<!-- route_to_expert_2_1 -->
<g id="node160" class="node">
<title>route_to_expert_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="611" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="611" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="611" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="611" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 33</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_1 -->
<g id="edge194" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2316.46,-2495.74C1967.61,-2486.99 1045.07,-2459.82 743,-2410.91 730.68,-2408.91 717.87,-2406.2 705.28,-2403.16"/>
<polygon fill="black" stroke="black" points="705.8,-2399.68 695.25,-2400.65 704.1,-2406.47 705.8,-2399.68"/>
</g>
<!-- route_to_expert_2_2 -->
<g id="node164" class="node">
<title>route_to_expert_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="874" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="874" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="874" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="874" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 34</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_2 -->
<g id="edge198" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2315.55,-2494.24C2005.48,-2483.05 1255.48,-2452.5 1006,-2410.91 993.79,-2408.87 981.08,-2406.15 968.59,-2403.12"/>
<polygon fill="black" stroke="black" points="969.18,-2399.66 958.62,-2400.62 967.47,-2406.45 969.18,-2399.66"/>
</g>
<!-- route_to_expert_2_3 -->
<g id="node168" class="node">
<title>route_to_expert_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="1137" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1137" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="1137" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1137" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 35</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_3 -->
<g id="edge202" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2317.45,-2497.42C2096.85,-2493.09 1645.15,-2476.22 1269,-2410.91 1256.89,-2408.8 1244.29,-2406.06 1231.9,-2403.03"/>
<polygon fill="black" stroke="black" points="1232.56,-2399.59 1222.01,-2400.54 1230.85,-2406.38 1232.56,-2399.59"/>
</g>
<!-- route_to_expert_2_4 -->
<g id="node172" class="node">
<title>route_to_expert_2_4</title>
<ellipse fill="lightblue" stroke="black" cx="1400" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1400" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1400" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1400" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 36</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_4 -->
<g id="edge206" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2314.97,-2493.26C2134.31,-2484.11 1807.14,-2461.68 1532,-2410.91 1520.01,-2408.69 1507.52,-2405.9 1495.22,-2402.86"/>
<polygon fill="black" stroke="black" points="1495.97,-2399.43 1485.41,-2400.36 1494.24,-2406.22 1495.97,-2399.43"/>
</g>
<!-- route_to_expert_2_5 -->
<g id="node176" class="node">
<title>route_to_expert_2_5</title>
<ellipse fill="lightblue" stroke="black" cx="1663" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1663" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="1663" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1663" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 37</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_5 -->
<g id="edge210" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2309.77,-2485.52C2176.06,-2471.6 1970.76,-2446.79 1795,-2410.91 1783.35,-2408.53 1771.22,-2405.69 1759.23,-2402.66"/>
<polygon fill="black" stroke="black" points="1759.77,-2399.18 1749.22,-2400.07 1758.02,-2405.96 1759.77,-2399.18"/>
</g>
<!-- route_to_expert_2_6 -->
<g id="node180" class="node">
<title>route_to_expert_2_6</title>
<ellipse fill="lightblue" stroke="black" cx="1926" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1926" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="1926" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1926" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 38</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_6 -->
<g id="edge214" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2297.21,-2466.2C2224.41,-2450.34 2136.54,-2430.52 2058,-2410.91 2047.03,-2408.17 2035.58,-2405.19 2024.2,-2402.15"/>
<polygon fill="black" stroke="black" points="2024.8,-2398.69 2014.24,-2399.47 2022.99,-2405.45 2024.8,-2398.69"/>
</g>
<!-- route_to_expert_2_7 -->
<g id="node184" class="node">
<title>route_to_expert_2_7</title>
<ellipse fill="lightblue" stroke="black" cx="2189" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2189" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="2189" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2189" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 39</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_7 -->
<g id="edge218" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2341.99,-2446.84C2315.53,-2434.31 2287.87,-2421.23 2263.47,-2409.68"/>
<polygon fill="black" stroke="black" points="2264.82,-2406.44 2254.29,-2405.33 2261.83,-2412.77 2264.82,-2406.44"/>
</g>
<!-- route_to_expert_2_8 -->
<g id="node188" class="node">
<title>route_to_expert_2_8</title>
<ellipse fill="lightblue" stroke="black" cx="2452" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2452" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2452" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2452" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 40</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_8 -->
<g id="edge222" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2452,-2446.84C2452,-2438.41 2452,-2429.72 2452,-2421.42"/>
<polygon fill="black" stroke="black" points="2455.5,-2421.16 2452,-2411.16 2448.5,-2421.16 2455.5,-2421.16"/>
</g>
<!-- route_to_expert_2_9 -->
<g id="node192" class="node">
<title>route_to_expert_2_9</title>
<ellipse fill="lightblue" stroke="black" cx="2715" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2715" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="2715" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2715" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 41</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_9 -->
<g id="edge226" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2553.31,-2450.96C2582.43,-2437.18 2613.64,-2422.4 2640.8,-2409.55"/>
<polygon fill="black" stroke="black" points="2642.3,-2412.71 2649.84,-2405.27 2639.3,-2406.38 2642.3,-2412.71"/>
</g>
<!-- route_to_expert_2_10 -->
<g id="node196" class="node">
<title>route_to_expert_2_10</title>
<ellipse fill="lightblue" stroke="black" cx="2978" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2978" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="2978" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2978" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 42</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_10 -->
<g id="edge230" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2568.73,-2474.43C2647.33,-2457.56 2753.18,-2434.08 2846,-2410.91 2856.97,-2408.17 2868.42,-2405.19 2879.8,-2402.15"/>
<polygon fill="black" stroke="black" points="2881.01,-2405.45 2889.76,-2399.47 2879.2,-2398.69 2881.01,-2405.45"/>
</g>
<!-- route_to_expert_2_11 -->
<g id="node200" class="node">
<title>route_to_expert_2_11</title>
<ellipse fill="lightblue" stroke="black" cx="3241" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3241" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3241" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3241" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 43</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_11 -->
<g id="edge234" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2576.66,-2487.33C2709.44,-2473.8 2925.35,-2448.4 3109,-2410.91 3120.65,-2408.53 3132.78,-2405.69 3144.77,-2402.66"/>
<polygon fill="black" stroke="black" points="3145.98,-2405.96 3154.78,-2400.07 3144.23,-2399.18 3145.98,-2405.96"/>
</g>
<!-- route_to_expert_2_12 -->
<g id="node204" class="node">
<title>route_to_expert_2_12</title>
<ellipse fill="lightblue" stroke="black" cx="3504" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3504" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3504" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3504" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 44</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_12 -->
<g id="edge238" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2580.97,-2493.66C2759.83,-2484.78 3092.72,-2462.45 3372,-2410.91 3383.99,-2408.69 3396.48,-2405.9 3408.78,-2402.86"/>
<polygon fill="black" stroke="black" points="3409.76,-2406.22 3418.59,-2400.36 3408.03,-2399.43 3409.76,-2406.22"/>
</g>
<!-- route_to_expert_2_13 -->
<g id="node208" class="node">
<title>route_to_expert_2_13</title>
<ellipse fill="lightblue" stroke="black" cx="3767" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3767" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="3767" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3767" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 45</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_13 -->
<g id="edge242" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2583.44,-2497.48C2802.88,-2493.25 3257.07,-2476.53 3635,-2410.91 3647.11,-2408.8 3659.71,-2406.06 3672.1,-2403.03"/>
<polygon fill="black" stroke="black" points="3673.15,-2406.38 3681.99,-2400.54 3671.44,-2399.59 3673.15,-2406.38"/>
</g>
<!-- route_to_expert_2_14 -->
<g id="node212" class="node">
<title>route_to_expert_2_14</title>
<ellipse fill="lightblue" stroke="black" cx="4030" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4030" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="4030" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4030" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 46</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_14 -->
<g id="edge246" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2581.3,-2494.5C2886.84,-2483.53 3646.58,-2452.82 3898,-2410.91 3910.21,-2408.87 3922.92,-2406.15 3935.41,-2403.12"/>
<polygon fill="black" stroke="black" points="3936.53,-2406.45 3945.38,-2400.62 3934.82,-2399.66 3936.53,-2406.45"/>
</g>
<!-- route_to_expert_2_15 -->
<g id="node216" class="node">
<title>route_to_expert_2_15</title>
<ellipse fill="lightblue" stroke="black" cx="4293" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4293" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4293" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4293" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 47</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_15 -->
<g id="edge250" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2582.19,-2495.88C2926.85,-2487.27 3857.37,-2460.07 4161,-2410.91 4173.32,-2408.91 4186.13,-2406.2 4198.72,-2403.16"/>
<polygon fill="black" stroke="black" points="4199.9,-2406.47 4208.75,-2400.65 4198.2,-2399.68 4199.9,-2406.47"/>
</g>
<!-- expert_linear1_2_0 -->
<g id="node157" class="node">
<title>expert_linear1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="519,-2299.95 337,-2299.95 337,-2246.95 519,-2246.95 519,-2299.95"/>
<text text-anchor="middle" x="428" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="428" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="428" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- route_to_expert_2_0&#45;&gt;expert_linear1_2_0 -->
<g id="edge191" class="edge">
<title>route_to_expert_2_0&#45;&gt;expert_linear1_2_0</title>
<path fill="none" stroke="black" d="M377.11,-2336.78C384.78,-2327.39 393.03,-2317.28 400.61,-2308"/>
<polygon fill="black" stroke="black" points="403.45,-2310.06 407.06,-2300.1 398.02,-2305.63 403.45,-2310.06"/>
</g>
<!-- expert_activation_2_0 -->
<g id="node158" class="node">
<title>expert_activation_2_0</title>
<polygon fill="lightgreen" stroke="black" points="568,-2210.95 386,-2210.95 386,-2157.95 568,-2157.95 568,-2210.95"/>
<text text-anchor="middle" x="477" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="477" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="477" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- expert_linear1_2_0&#45;&gt;expert_activation_2_0 -->
<g id="edge192" class="edge">
<title>expert_linear1_2_0&#45;&gt;expert_activation_2_0</title>
<path fill="none" stroke="black" d="M442.44,-2246.82C447.18,-2238.4 452.53,-2228.9 457.58,-2219.93"/>
<polygon fill="black" stroke="black" points="460.64,-2221.63 462.5,-2211.2 454.54,-2218.2 460.64,-2221.63"/>
</g>
<!-- expert_linear2_2_0 -->
<g id="node159" class="node">
<title>expert_linear2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="662.5,-2121.95 489.5,-2121.95 489.5,-2068.95 662.5,-2068.95 662.5,-2121.95"/>
<text text-anchor="middle" x="576" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="576" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="576" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 32</text>
</g>
<!-- expert_activation_2_0&#45;&gt;expert_linear2_2_0 -->
<g id="edge193" class="edge">
<title>expert_activation_2_0&#45;&gt;expert_linear2_2_0</title>
<path fill="none" stroke="black" d="M506.17,-2157.82C516.45,-2148.79 528.15,-2138.51 538.99,-2128.98"/>
<polygon fill="black" stroke="black" points="541.5,-2131.43 546.7,-2122.2 536.88,-2126.18 541.5,-2131.43"/>
</g>
<!-- aggregate_2 -->
<g id="node220" class="node">
<title>aggregate_2</title>
<polygon fill="lightyellow" stroke="black" points="2665.64,-2032.95 2325.79,-2032.95 2238.36,-1926.95 2578.21,-1926.95 2665.64,-2032.95"/>
<text text-anchor="middle" x="2452" y="-1991.25" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="2452" y="-1976.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="2452" y="-1961.25" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- expert_linear2_2_0&#45;&gt;aggregate_2 -->
<g id="edge254" class="edge">
<title>expert_linear2_2_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M662.6,-2076.64C679.58,-2073.66 697.3,-2070.91 714,-2068.95 1280.98,-2002.51 1957.8,-1986.21 2273.45,-1982.23"/>
<polygon fill="black" stroke="black" points="2273.65,-1985.73 2283.61,-1982.1 2273.56,-1978.73 2273.65,-1985.73"/>
</g>
<!-- expert_linear1_2_1 -->
<g id="node161" class="node">
<title>expert_linear1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="750,-2299.95 568,-2299.95 568,-2246.95 750,-2246.95 750,-2299.95"/>
<text text-anchor="middle" x="659" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="659" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="659" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 33</text>
</g>
<!-- route_to_expert_2_1&#45;&gt;expert_linear1_2_1 -->
<g id="edge195" class="edge">
<title>route_to_expert_2_1&#45;&gt;expert_linear1_2_1</title>
<path fill="none" stroke="black" d="M628.74,-2336.23C633.05,-2327.42 637.66,-2318.02 641.94,-2309.28"/>
<polygon fill="black" stroke="black" points="645.17,-2310.63 646.43,-2300.11 638.89,-2307.55 645.17,-2310.63"/>
</g>
<!-- expert_activation_2_1 -->
<g id="node162" class="node">
<title>expert_activation_2_1</title>
<polygon fill="lightgreen" stroke="black" points="846,-2210.95 664,-2210.95 664,-2157.95 846,-2157.95 846,-2210.95"/>
<text text-anchor="middle" x="755" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="755" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="755" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 33</text>
</g>
<!-- expert_linear1_2_1&#45;&gt;expert_activation_2_1 -->
<g id="edge196" class="edge">
<title>expert_linear1_2_1&#45;&gt;expert_activation_2_1</title>
<path fill="none" stroke="black" d="M687.28,-2246.82C697.25,-2237.79 708.6,-2227.51 719.11,-2217.98"/>
<polygon fill="black" stroke="black" points="721.53,-2220.51 726.59,-2211.2 716.83,-2215.32 721.53,-2220.51"/>
</g>
<!-- expert_linear2_2_1 -->
<g id="node163" class="node">
<title>expert_linear2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="896.5,-2121.95 723.5,-2121.95 723.5,-2068.95 896.5,-2068.95 896.5,-2121.95"/>
<text text-anchor="middle" x="810" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="810" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="810" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 33</text>
</g>
<!-- expert_activation_2_1&#45;&gt;expert_linear2_2_1 -->
<g id="edge197" class="edge">
<title>expert_activation_2_1&#45;&gt;expert_linear2_2_1</title>
<path fill="none" stroke="black" d="M771.2,-2157.82C776.53,-2149.4 782.53,-2139.9 788.2,-2130.93"/>
<polygon fill="black" stroke="black" points="791.34,-2132.53 793.72,-2122.2 785.42,-2128.79 791.34,-2132.53"/>
</g>
<!-- expert_linear2_2_1&#45;&gt;aggregate_2 -->
<g id="edge255" class="edge">
<title>expert_linear2_2_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M896.81,-2078.14C917.76,-2074.66 940.13,-2071.32 961,-2068.95 1434.37,-2015.17 1996.26,-1993.26 2275.79,-1985.18"/>
<polygon fill="black" stroke="black" points="2276.12,-1988.67 2286.02,-1984.88 2275.92,-1981.67 2276.12,-1988.67"/>
</g>
<!-- expert_linear1_2_2 -->
<g id="node165" class="node">
<title>expert_linear1_2_2</title>
<polygon fill="lightgreen" stroke="black" points="1040,-2299.95 858,-2299.95 858,-2246.95 1040,-2246.95 1040,-2299.95"/>
<text text-anchor="middle" x="949" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="949" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="949" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 34</text>
</g>
<!-- route_to_expert_2_2&#45;&gt;expert_linear1_2_2 -->
<g id="edge199" class="edge">
<title>route_to_expert_2_2&#45;&gt;expert_linear1_2_2</title>
<path fill="none" stroke="black" d="M901.29,-2336.78C908.41,-2327.48 916.06,-2317.49 923.1,-2308.28"/>
<polygon fill="black" stroke="black" points="926.07,-2310.17 929.37,-2300.1 920.51,-2305.91 926.07,-2310.17"/>
</g>
<!-- expert_activation_2_2 -->
<g id="node166" class="node">
<title>expert_activation_2_2</title>
<polygon fill="lightgreen" stroke="black" points="1085,-2210.95 903,-2210.95 903,-2157.95 1085,-2157.95 1085,-2210.95"/>
<text text-anchor="middle" x="994" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="994" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="994" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 34</text>
</g>
<!-- expert_linear1_2_2&#45;&gt;expert_activation_2_2 -->
<g id="edge200" class="edge">
<title>expert_linear1_2_2&#45;&gt;expert_activation_2_2</title>
<path fill="none" stroke="black" d="M962.26,-2246.82C966.57,-2238.49 971.43,-2229.1 976.02,-2220.21"/>
<polygon fill="black" stroke="black" points="979.2,-2221.69 980.68,-2211.2 972.98,-2218.48 979.2,-2221.69"/>
</g>
<!-- expert_linear2_2_2 -->
<g id="node167" class="node">
<title>expert_linear2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="1143.5,-2121.95 970.5,-2121.95 970.5,-2068.95 1143.5,-2068.95 1143.5,-2121.95"/>
<text text-anchor="middle" x="1057" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1057" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1057" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 34</text>
</g>
<!-- expert_activation_2_2&#45;&gt;expert_linear2_2_2 -->
<g id="edge201" class="edge">
<title>expert_activation_2_2&#45;&gt;expert_linear2_2_2</title>
<path fill="none" stroke="black" d="M1012.56,-2157.82C1018.79,-2149.22 1025.83,-2139.5 1032.44,-2130.37"/>
<polygon fill="black" stroke="black" points="1035.32,-2132.36 1038.35,-2122.2 1029.65,-2128.25 1035.32,-2132.36"/>
</g>
<!-- expert_linear2_2_2&#45;&gt;aggregate_2 -->
<g id="edge256" class="edge">
<title>expert_linear2_2_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1143.63,-2077.81C1163.11,-2074.5 1183.72,-2071.31 1203,-2068.95 1584.83,-2022.28 2035.58,-1998.09 2277.52,-1987.59"/>
<polygon fill="black" stroke="black" points="2277.98,-1991.08 2287.82,-1987.15 2277.68,-1984.08 2277.98,-1991.08"/>
</g>
<!-- expert_linear1_2_3 -->
<g id="node169" class="node">
<title>expert_linear1_2_3</title>
<polygon fill="lightgreen" stroke="black" points="1260,-2299.95 1078,-2299.95 1078,-2246.95 1260,-2246.95 1260,-2299.95"/>
<text text-anchor="middle" x="1169" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1169" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1169" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 35</text>
</g>
<!-- route_to_expert_2_3&#45;&gt;expert_linear1_2_3 -->
<g id="edge203" class="edge">
<title>route_to_expert_2_3&#45;&gt;expert_linear1_2_3</title>
<path fill="none" stroke="black" d="M1148.92,-2335.95C1151.73,-2327.34 1154.72,-2318.19 1157.51,-2309.64"/>
<polygon fill="black" stroke="black" points="1160.89,-2310.56 1160.67,-2299.96 1154.24,-2308.38 1160.89,-2310.56"/>
</g>
<!-- expert_activation_2_3 -->
<g id="node170" class="node">
<title>expert_activation_2_3</title>
<polygon fill="lightgreen" stroke="black" points="1318,-2210.95 1136,-2210.95 1136,-2157.95 1318,-2157.95 1318,-2210.95"/>
<text text-anchor="middle" x="1227" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1227" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1227" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 35</text>
</g>
<!-- expert_linear1_2_3&#45;&gt;expert_activation_2_3 -->
<g id="edge204" class="edge">
<title>expert_linear1_2_3&#45;&gt;expert_activation_2_3</title>
<path fill="none" stroke="black" d="M1186.09,-2246.82C1191.76,-2238.31 1198.17,-2228.7 1204.2,-2219.65"/>
<polygon fill="black" stroke="black" points="1207.2,-2221.47 1209.83,-2211.2 1201.37,-2217.58 1207.2,-2221.47"/>
</g>
<!-- expert_linear2_2_3 -->
<g id="node171" class="node">
<title>expert_linear2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="1384.5,-2121.95 1211.5,-2121.95 1211.5,-2068.95 1384.5,-2068.95 1384.5,-2121.95"/>
<text text-anchor="middle" x="1298" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1298" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1298" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 35</text>
</g>
<!-- expert_activation_2_3&#45;&gt;expert_linear2_2_3 -->
<g id="edge205" class="edge">
<title>expert_activation_2_3&#45;&gt;expert_linear2_2_3</title>
<path fill="none" stroke="black" d="M1247.92,-2157.82C1255.01,-2149.14 1263.03,-2139.3 1270.55,-2130.09"/>
<polygon fill="black" stroke="black" points="1273.37,-2132.16 1276.99,-2122.2 1267.95,-2127.74 1273.37,-2132.16"/>
</g>
<!-- expert_linear2_2_3&#45;&gt;aggregate_2 -->
<g id="edge257" class="edge">
<title>expert_linear2_2_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1384.68,-2078.27C1404.77,-2074.87 1426.09,-2071.53 1446,-2068.95 1738.16,-2031.07 2080.22,-2005.01 2280.79,-1991.57"/>
<polygon fill="black" stroke="black" points="2281.08,-1995.05 2290.82,-1990.9 2280.61,-1988.07 2281.08,-1995.05"/>
</g>
<!-- expert_linear1_2_4 -->
<g id="node173" class="node">
<title>expert_linear1_2_4</title>
<polygon fill="lightgreen" stroke="black" points="1543,-2299.95 1361,-2299.95 1361,-2246.95 1543,-2246.95 1543,-2299.95"/>
<text text-anchor="middle" x="1452" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1452" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1452" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 36</text>
</g>
<!-- route_to_expert_2_4&#45;&gt;expert_linear1_2_4 -->
<g id="edge207" class="edge">
<title>route_to_expert_2_4&#45;&gt;expert_linear1_2_4</title>
<path fill="none" stroke="black" d="M1419.22,-2336.23C1423.94,-2327.32 1428.98,-2317.82 1433.67,-2309"/>
<polygon fill="black" stroke="black" points="1436.79,-2310.58 1438.38,-2300.11 1430.6,-2307.3 1436.79,-2310.58"/>
</g>
<!-- expert_activation_2_4 -->
<g id="node174" class="node">
<title>expert_activation_2_4</title>
<polygon fill="lightgreen" stroke="black" points="1612,-2210.95 1430,-2210.95 1430,-2157.95 1612,-2157.95 1612,-2210.95"/>
<text text-anchor="middle" x="1521" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1521" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1521" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 36</text>
</g>
<!-- expert_linear1_2_4&#45;&gt;expert_activation_2_4 -->
<g id="edge208" class="edge">
<title>expert_linear1_2_4&#45;&gt;expert_activation_2_4</title>
<path fill="none" stroke="black" d="M1472.33,-2246.82C1479.22,-2238.14 1487.02,-2228.3 1494.32,-2219.09"/>
<polygon fill="black" stroke="black" points="1497.11,-2221.21 1500.58,-2211.2 1491.62,-2216.86 1497.11,-2221.21"/>
</g>
<!-- expert_linear2_2_4 -->
<g id="node175" class="node">
<title>expert_linear2_2_4</title>
<polygon fill="lightgreen" stroke="black" points="1627.5,-2121.95 1454.5,-2121.95 1454.5,-2068.95 1627.5,-2068.95 1627.5,-2121.95"/>
<text text-anchor="middle" x="1541" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="1541" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1541" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 36</text>
</g>
<!-- expert_activation_2_4&#45;&gt;expert_linear2_2_4 -->
<g id="edge209" class="edge">
<title>expert_activation_2_4&#45;&gt;expert_linear2_2_4</title>
<path fill="none" stroke="black" d="M1526.89,-2157.82C1528.75,-2149.75 1530.83,-2140.69 1532.82,-2132.06"/>
<polygon fill="black" stroke="black" points="1536.25,-2132.73 1535.08,-2122.2 1529.43,-2131.16 1536.25,-2132.73"/>
</g>
<!-- expert_linear2_2_4&#45;&gt;aggregate_2 -->
<g id="edge258" class="edge">
<title>expert_linear2_2_4&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1627.77,-2080.82C1654.15,-2076.82 1683.24,-2072.56 1710,-2068.95 1907.78,-2042.31 2135.81,-2015.91 2286.31,-1999.08"/>
<polygon fill="black" stroke="black" points="2287.01,-2002.53 2296.56,-1997.94 2286.23,-1995.57 2287.01,-2002.53"/>
</g>
<!-- expert_linear1_2_5 -->
<g id="node177" class="node">
<title>expert_linear1_2_5</title>
<polygon fill="lightgreen" stroke="black" points="1795,-2299.95 1613,-2299.95 1613,-2246.95 1795,-2246.95 1795,-2299.95"/>
<text text-anchor="middle" x="1704" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="1704" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1704" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 37</text>
</g>
<!-- route_to_expert_2_5&#45;&gt;expert_linear1_2_5 -->
<g id="edge211" class="edge">
<title>route_to_expert_2_5&#45;&gt;expert_linear1_2_5</title>
<path fill="none" stroke="black" d="M1678.15,-2336.23C1681.8,-2327.51 1685.69,-2318.22 1689.31,-2309.56"/>
<polygon fill="black" stroke="black" points="1692.63,-2310.69 1693.26,-2300.11 1686.17,-2307.98 1692.63,-2310.69"/>
</g>
<!-- expert_activation_2_5 -->
<g id="node178" class="node">
<title>expert_activation_2_5</title>
<polygon fill="lightgreen" stroke="black" points="1859,-2210.95 1677,-2210.95 1677,-2157.95 1859,-2157.95 1859,-2210.95"/>
<text text-anchor="middle" x="1768" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1768" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1768" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 37</text>
</g>
<!-- expert_linear1_2_5&#45;&gt;expert_activation_2_5 -->
<g id="edge212" class="edge">
<title>expert_linear1_2_5&#45;&gt;expert_activation_2_5</title>
<path fill="none" stroke="black" d="M1722.86,-2246.82C1729.18,-2238.22 1736.33,-2228.5 1743.05,-2219.37"/>
<polygon fill="black" stroke="black" points="1745.95,-2221.33 1749.06,-2211.2 1740.31,-2217.18 1745.95,-2221.33"/>
</g>
<!-- expert_linear2_2_5 -->
<g id="node179" class="node">
<title>expert_linear2_2_5</title>
<polygon fill="lightgreen" stroke="black" points="1891.5,-2121.95 1718.5,-2121.95 1718.5,-2068.95 1891.5,-2068.95 1891.5,-2121.95"/>
<text text-anchor="middle" x="1805" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="1805" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1805" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 37</text>
</g>
<!-- expert_activation_2_5&#45;&gt;expert_linear2_2_5 -->
<g id="edge213" class="edge">
<title>expert_activation_2_5&#45;&gt;expert_linear2_2_5</title>
<path fill="none" stroke="black" d="M1778.9,-2157.82C1782.41,-2149.58 1786.36,-2140.29 1790.1,-2131.49"/>
<polygon fill="black" stroke="black" points="1793.36,-2132.78 1794.05,-2122.2 1786.91,-2130.04 1793.36,-2132.78"/>
</g>
<!-- expert_linear2_2_5&#45;&gt;aggregate_2 -->
<g id="edge259" class="edge">
<title>expert_linear2_2_5&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1891.57,-2077.45C1906.71,-2074.56 1922.3,-2071.63 1937,-2068.95 2056.18,-2047.26 2191.17,-2024.25 2293.04,-2007.2"/>
<polygon fill="black" stroke="black" points="2293.82,-2010.62 2303.11,-2005.52 2292.67,-2003.72 2293.82,-2010.62"/>
</g>
<!-- expert_linear1_2_6 -->
<g id="node181" class="node">
<title>expert_linear1_2_6</title>
<polygon fill="lightgreen" stroke="black" points="2036,-2299.95 1854,-2299.95 1854,-2246.95 2036,-2246.95 2036,-2299.95"/>
<text text-anchor="middle" x="1945" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="1945" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1945" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 38</text>
</g>
<!-- route_to_expert_2_6&#45;&gt;expert_linear1_2_6 -->
<g id="edge215" class="edge">
<title>route_to_expert_2_6&#45;&gt;expert_linear1_2_6</title>
<path fill="none" stroke="black" d="M1933.07,-2335.95C1934.73,-2327.44 1936.48,-2318.39 1938.12,-2309.92"/>
<polygon fill="black" stroke="black" points="1941.59,-2310.45 1940.05,-2299.96 1934.71,-2309.11 1941.59,-2310.45"/>
</g>
<!-- expert_activation_2_6 -->
<g id="node182" class="node">
<title>expert_activation_2_6</title>
<polygon fill="lightgreen" stroke="black" points="2083,-2210.95 1901,-2210.95 1901,-2157.95 2083,-2157.95 2083,-2210.95"/>
<text text-anchor="middle" x="1992" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1992" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1992" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 38</text>
</g>
<!-- expert_linear1_2_6&#45;&gt;expert_activation_2_6 -->
<g id="edge216" class="edge">
<title>expert_linear1_2_6&#45;&gt;expert_activation_2_6</title>
<path fill="none" stroke="black" d="M1958.85,-2246.82C1963.35,-2238.49 1968.42,-2229.1 1973.22,-2220.21"/>
<polygon fill="black" stroke="black" points="1976.42,-2221.66 1978.09,-2211.2 1970.26,-2218.34 1976.42,-2221.66"/>
</g>
<!-- expert_linear2_2_6 -->
<g id="node183" class="node">
<title>expert_linear2_2_6</title>
<polygon fill="lightgreen" stroke="black" points="2118.5,-2121.95 1945.5,-2121.95 1945.5,-2068.95 2118.5,-2068.95 2118.5,-2121.95"/>
<text text-anchor="middle" x="2032" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2032" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2032" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 38</text>
</g>
<!-- expert_activation_2_6&#45;&gt;expert_linear2_2_6 -->
<g id="edge217" class="edge">
<title>expert_activation_2_6&#45;&gt;expert_linear2_2_6</title>
<path fill="none" stroke="black" d="M2003.78,-2157.82C2007.58,-2149.58 2011.84,-2140.29 2015.89,-2131.49"/>
<polygon fill="black" stroke="black" points="2019.16,-2132.75 2020.16,-2122.2 2012.8,-2129.83 2019.16,-2132.75"/>
</g>
<!-- expert_linear2_2_6&#45;&gt;aggregate_2 -->
<g id="edge260" class="edge">
<title>expert_linear2_2_6&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2118.52,-2071.07C2171.85,-2056.66 2241.68,-2037.79 2303.64,-2021.05"/>
<polygon fill="black" stroke="black" points="2304.77,-2024.36 2313.51,-2018.38 2302.95,-2017.61 2304.77,-2024.36"/>
</g>
<!-- expert_linear1_2_7 -->
<g id="node185" class="node">
<title>expert_linear1_2_7</title>
<polygon fill="lightgreen" stroke="black" points="2296,-2299.95 2114,-2299.95 2114,-2246.95 2296,-2246.95 2296,-2299.95"/>
<text text-anchor="middle" x="2205" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2205" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2205" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 39</text>
</g>
<!-- route_to_expert_2_7&#45;&gt;expert_linear1_2_7 -->
<g id="edge219" class="edge">
<title>route_to_expert_2_7&#45;&gt;expert_linear1_2_7</title>
<path fill="none" stroke="black" d="M2194.96,-2335.95C2196.35,-2327.44 2197.83,-2318.39 2199.21,-2309.92"/>
<polygon fill="black" stroke="black" points="2202.68,-2310.4 2200.83,-2299.96 2195.77,-2309.27 2202.68,-2310.4"/>
</g>
<!-- expert_activation_2_7 -->
<g id="node186" class="node">
<title>expert_activation_2_7</title>
<polygon fill="lightgreen" stroke="black" points="2312,-2210.95 2130,-2210.95 2130,-2157.95 2312,-2157.95 2312,-2210.95"/>
<text text-anchor="middle" x="2221" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2221" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2221" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 39</text>
</g>
<!-- expert_linear1_2_7&#45;&gt;expert_activation_2_7 -->
<g id="edge220" class="edge">
<title>expert_linear1_2_7&#45;&gt;expert_activation_2_7</title>
<path fill="none" stroke="black" d="M2209.71,-2246.82C2211.2,-2238.75 2212.86,-2229.69 2214.45,-2221.06"/>
<polygon fill="black" stroke="black" points="2217.9,-2221.67 2216.26,-2211.2 2211.01,-2220.41 2217.9,-2221.67"/>
</g>
<!-- expert_linear2_2_7 -->
<g id="node187" class="node">
<title>expert_linear2_2_7</title>
<polygon fill="lightgreen" stroke="black" points="2327.5,-2121.95 2154.5,-2121.95 2154.5,-2068.95 2327.5,-2068.95 2327.5,-2121.95"/>
<text text-anchor="middle" x="2241" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2241" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2241" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 39</text>
</g>
<!-- expert_activation_2_7&#45;&gt;expert_linear2_2_7 -->
<g id="edge221" class="edge">
<title>expert_activation_2_7&#45;&gt;expert_linear2_2_7</title>
<path fill="none" stroke="black" d="M2226.89,-2157.82C2228.75,-2149.75 2230.83,-2140.69 2232.82,-2132.06"/>
<polygon fill="black" stroke="black" points="2236.25,-2132.73 2235.08,-2122.2 2229.43,-2131.16 2236.25,-2132.73"/>
</g>
<!-- expert_linear2_2_7&#45;&gt;aggregate_2 -->
<g id="edge261" class="edge">
<title>expert_linear2_2_7&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2288.62,-2068.84C2305.77,-2059.61 2325.88,-2048.8 2346.01,-2037.97"/>
<polygon fill="black" stroke="black" points="2347.79,-2040.98 2354.94,-2033.16 2344.48,-2034.82 2347.79,-2040.98"/>
</g>
<!-- expert_linear1_2_8 -->
<g id="node189" class="node">
<title>expert_linear1_2_8</title>
<polygon fill="lightgreen" stroke="black" points="2543,-2299.95 2361,-2299.95 2361,-2246.95 2543,-2246.95 2543,-2299.95"/>
<text text-anchor="middle" x="2452" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2452" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2452" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 40</text>
</g>
<!-- route_to_expert_2_8&#45;&gt;expert_linear1_2_8 -->
<g id="edge223" class="edge">
<title>route_to_expert_2_8&#45;&gt;expert_linear1_2_8</title>
<path fill="none" stroke="black" d="M2452,-2335.95C2452,-2327.53 2452,-2318.59 2452,-2310.2"/>
<polygon fill="black" stroke="black" points="2455.5,-2309.96 2452,-2299.96 2448.5,-2309.96 2455.5,-2309.96"/>
</g>
<!-- expert_activation_2_8 -->
<g id="node190" class="node">
<title>expert_activation_2_8</title>
<polygon fill="lightgreen" stroke="black" points="2543,-2210.95 2361,-2210.95 2361,-2157.95 2543,-2157.95 2543,-2210.95"/>
<text text-anchor="middle" x="2452" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2452" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2452" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 40</text>
</g>
<!-- expert_linear1_2_8&#45;&gt;expert_activation_2_8 -->
<g id="edge224" class="edge">
<title>expert_linear1_2_8&#45;&gt;expert_activation_2_8</title>
<path fill="none" stroke="black" d="M2452,-2246.82C2452,-2238.84 2452,-2229.89 2452,-2221.34"/>
<polygon fill="black" stroke="black" points="2455.5,-2221.2 2452,-2211.2 2448.5,-2221.2 2455.5,-2221.2"/>
</g>
<!-- expert_linear2_2_8 -->
<g id="node191" class="node">
<title>expert_linear2_2_8</title>
<polygon fill="lightgreen" stroke="black" points="2538.5,-2121.95 2365.5,-2121.95 2365.5,-2068.95 2538.5,-2068.95 2538.5,-2121.95"/>
<text text-anchor="middle" x="2452" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="2452" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2452" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 40</text>
</g>
<!-- expert_activation_2_8&#45;&gt;expert_linear2_2_8 -->
<g id="edge225" class="edge">
<title>expert_activation_2_8&#45;&gt;expert_linear2_2_8</title>
<path fill="none" stroke="black" d="M2452,-2157.82C2452,-2149.84 2452,-2140.89 2452,-2132.34"/>
<polygon fill="black" stroke="black" points="2455.5,-2132.2 2452,-2122.2 2448.5,-2132.2 2455.5,-2132.2"/>
</g>
<!-- expert_linear2_2_8&#45;&gt;aggregate_2 -->
<g id="edge262" class="edge">
<title>expert_linear2_2_8&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2452,-2068.7C2452,-2061 2452,-2052.2 2452,-2043.22"/>
<polygon fill="black" stroke="black" points="2455.5,-2043.05 2452,-2033.05 2448.5,-2043.05 2455.5,-2043.05"/>
</g>
<!-- expert_linear1_2_9 -->
<g id="node193" class="node">
<title>expert_linear1_2_9</title>
<polygon fill="lightgreen" stroke="black" points="2775,-2299.95 2593,-2299.95 2593,-2246.95 2775,-2246.95 2775,-2299.95"/>
<text text-anchor="middle" x="2684" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2684" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2684" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 41</text>
</g>
<!-- route_to_expert_2_9&#45;&gt;expert_linear1_2_9 -->
<g id="edge227" class="edge">
<title>route_to_expert_2_9&#45;&gt;expert_linear1_2_9</title>
<path fill="none" stroke="black" d="M2703.46,-2335.95C2700.73,-2327.34 2697.84,-2318.19 2695.13,-2309.64"/>
<polygon fill="black" stroke="black" points="2698.43,-2308.44 2692.07,-2299.96 2691.75,-2310.55 2698.43,-2308.44"/>
</g>
<!-- expert_activation_2_9 -->
<g id="node194" class="node">
<title>expert_activation_2_9</title>
<polygon fill="lightgreen" stroke="black" points="2765,-2210.95 2583,-2210.95 2583,-2157.95 2765,-2157.95 2765,-2210.95"/>
<text text-anchor="middle" x="2674" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="2674" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2674" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 41</text>
</g>
<!-- expert_linear1_2_9&#45;&gt;expert_activation_2_9 -->
<g id="edge228" class="edge">
<title>expert_linear1_2_9&#45;&gt;expert_activation_2_9</title>
<path fill="none" stroke="black" d="M2681.05,-2246.82C2680.14,-2238.84 2679.11,-2229.89 2678.12,-2221.34"/>
<polygon fill="black" stroke="black" points="2681.58,-2220.74 2676.96,-2211.2 2674.62,-2221.54 2681.58,-2220.74"/>
</g>
<!-- expert_linear2_2_9 -->
<g id="node195" class="node">
<title>expert_linear2_2_9</title>
<polygon fill="lightgreen" stroke="black" points="2740.5,-2121.95 2567.5,-2121.95 2567.5,-2068.95 2740.5,-2068.95 2740.5,-2121.95"/>
<text text-anchor="middle" x="2654" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2654" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2654" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 41</text>
</g>
<!-- expert_activation_2_9&#45;&gt;expert_linear2_2_9 -->
<g id="edge229" class="edge">
<title>expert_activation_2_9&#45;&gt;expert_linear2_2_9</title>
<path fill="none" stroke="black" d="M2668.11,-2157.82C2666.25,-2149.75 2664.17,-2140.69 2662.18,-2132.06"/>
<polygon fill="black" stroke="black" points="2665.57,-2131.16 2659.92,-2122.2 2658.75,-2132.73 2665.57,-2131.16"/>
</g>
<!-- expert_linear2_2_9&#45;&gt;aggregate_2 -->
<g id="edge263" class="edge">
<title>expert_linear2_2_9&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2608.42,-2068.84C2592.07,-2059.66 2572.92,-2048.89 2553.73,-2038.11"/>
<polygon fill="black" stroke="black" points="2555.35,-2035.01 2544.92,-2033.16 2551.92,-2041.11 2555.35,-2035.01"/>
</g>
<!-- expert_linear1_2_10 -->
<g id="node197" class="node">
<title>expert_linear1_2_10</title>
<polygon fill="lightgreen" stroke="black" points="3022,-2299.95 2840,-2299.95 2840,-2246.95 3022,-2246.95 3022,-2299.95"/>
<text text-anchor="middle" x="2931" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="2931" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2931" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 42</text>
</g>
<!-- route_to_expert_2_10&#45;&gt;expert_linear1_2_10 -->
<g id="edge231" class="edge">
<title>route_to_expert_2_10&#45;&gt;expert_linear1_2_10</title>
<path fill="none" stroke="black" d="M2960.63,-2336.23C2956.41,-2327.42 2951.9,-2318.02 2947.71,-2309.28"/>
<polygon fill="black" stroke="black" points="2950.79,-2307.61 2943.31,-2300.11 2944.48,-2310.64 2950.79,-2307.61"/>
</g>
<!-- expert_activation_2_10 -->
<g id="node198" class="node">
<title>expert_activation_2_10</title>
<polygon fill="lightgreen" stroke="black" points="3003,-2210.95 2821,-2210.95 2821,-2157.95 3003,-2157.95 3003,-2210.95"/>
<text text-anchor="middle" x="2912" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="2912" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2912" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 42</text>
</g>
<!-- expert_linear1_2_10&#45;&gt;expert_activation_2_10 -->
<g id="edge232" class="edge">
<title>expert_linear1_2_10&#45;&gt;expert_activation_2_10</title>
<path fill="none" stroke="black" d="M2925.4,-2246.82C2923.64,-2238.75 2921.66,-2229.69 2919.78,-2221.06"/>
<polygon fill="black" stroke="black" points="2923.18,-2220.23 2917.62,-2211.2 2916.34,-2221.72 2923.18,-2220.23"/>
</g>
<!-- expert_linear2_2_10 -->
<g id="node199" class="node">
<title>expert_linear2_2_10</title>
<polygon fill="lightgreen" stroke="black" points="2969.5,-2121.95 2796.5,-2121.95 2796.5,-2068.95 2969.5,-2068.95 2969.5,-2121.95"/>
<text text-anchor="middle" x="2883" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="2883" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2883" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 42</text>
</g>
<!-- expert_activation_2_10&#45;&gt;expert_linear2_2_10 -->
<g id="edge233" class="edge">
<title>expert_activation_2_10&#45;&gt;expert_linear2_2_10</title>
<path fill="none" stroke="black" d="M2903.46,-2157.82C2900.74,-2149.66 2897.68,-2140.49 2894.77,-2131.77"/>
<polygon fill="black" stroke="black" points="2898.07,-2130.58 2891.58,-2122.2 2891.43,-2132.8 2898.07,-2130.58"/>
</g>
<!-- expert_linear2_2_10&#45;&gt;aggregate_2 -->
<g id="edge264" class="edge">
<title>expert_linear2_2_10&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2796.3,-2071.62C2756.74,-2061.2 2708.04,-2048.38 2659.85,-2035.69"/>
<polygon fill="black" stroke="black" points="2660.47,-2032.23 2649.9,-2033.07 2658.68,-2039 2660.47,-2032.23"/>
</g>
<!-- expert_linear1_2_11 -->
<g id="node201" class="node">
<title>expert_linear1_2_11</title>
<polygon fill="lightgreen" stroke="black" points="3277,-2299.95 3095,-2299.95 3095,-2246.95 3277,-2246.95 3277,-2299.95"/>
<text text-anchor="middle" x="3186" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3186" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3186" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 43</text>
</g>
<!-- route_to_expert_2_11&#45;&gt;expert_linear1_2_11 -->
<g id="edge235" class="edge">
<title>route_to_expert_2_11&#45;&gt;expert_linear1_2_11</title>
<path fill="none" stroke="black" d="M3220.68,-2336.23C3215.68,-2327.32 3210.34,-2317.82 3205.39,-2309"/>
<polygon fill="black" stroke="black" points="3208.35,-2307.12 3200.4,-2300.11 3202.25,-2310.54 3208.35,-2307.12"/>
</g>
<!-- expert_activation_2_11 -->
<g id="node202" class="node">
<title>expert_activation_2_11</title>
<polygon fill="lightgreen" stroke="black" points="3252,-2210.95 3070,-2210.95 3070,-2157.95 3252,-2157.95 3252,-2210.95"/>
<text text-anchor="middle" x="3161" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3161" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3161" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 43</text>
</g>
<!-- expert_linear1_2_11&#45;&gt;expert_activation_2_11 -->
<g id="edge236" class="edge">
<title>expert_linear1_2_11&#45;&gt;expert_activation_2_11</title>
<path fill="none" stroke="black" d="M3178.63,-2246.82C3176.32,-2238.75 3173.71,-2229.69 3171.23,-2221.06"/>
<polygon fill="black" stroke="black" points="3174.53,-2219.85 3168.4,-2211.2 3167.8,-2221.78 3174.53,-2219.85"/>
</g>
<!-- expert_linear2_2_11 -->
<g id="node203" class="node">
<title>expert_linear2_2_11</title>
<polygon fill="lightgreen" stroke="black" points="3196.5,-2121.95 3023.5,-2121.95 3023.5,-2068.95 3196.5,-2068.95 3196.5,-2121.95"/>
<text text-anchor="middle" x="3110" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3110" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3110" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 43</text>
</g>
<!-- expert_activation_2_11&#45;&gt;expert_linear2_2_11 -->
<g id="edge237" class="edge">
<title>expert_activation_2_11&#45;&gt;expert_linear2_2_11</title>
<path fill="none" stroke="black" d="M3145.97,-2157.82C3141.04,-2149.4 3135.47,-2139.9 3130.21,-2130.93"/>
<polygon fill="black" stroke="black" points="3133.17,-2129.06 3125.09,-2122.2 3127.13,-2132.6 3133.17,-2129.06"/>
</g>
<!-- expert_linear2_2_11&#45;&gt;aggregate_2 -->
<g id="edge265" class="edge">
<title>expert_linear2_2_11&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3023.39,-2077.25C3008.59,-2074.41 2993.36,-2071.55 2979,-2068.95 2873.65,-2049.91 2756.18,-2030.15 2658.93,-2014.19"/>
<polygon fill="black" stroke="black" points="2659.42,-2010.72 2648.98,-2012.56 2658.29,-2017.63 2659.42,-2010.72"/>
</g>
<!-- expert_linear1_2_12 -->
<g id="node205" class="node">
<title>expert_linear1_2_12</title>
<polygon fill="lightgreen" stroke="black" points="3536,-2299.95 3354,-2299.95 3354,-2246.95 3536,-2246.95 3536,-2299.95"/>
<text text-anchor="middle" x="3445" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3445" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3445" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 44</text>
</g>
<!-- route_to_expert_2_12&#45;&gt;expert_linear1_2_12 -->
<g id="edge239" class="edge">
<title>route_to_expert_2_12&#45;&gt;expert_linear1_2_12</title>
<path fill="none" stroke="black" d="M3482.37,-2336.5C3476.89,-2327.41 3471.02,-2317.67 3465.6,-2308.66"/>
<polygon fill="black" stroke="black" points="3468.51,-2306.71 3460.36,-2299.95 3462.52,-2310.33 3468.51,-2306.71"/>
</g>
<!-- expert_activation_2_12 -->
<g id="node206" class="node">
<title>expert_activation_2_12</title>
<polygon fill="lightgreen" stroke="black" points="3507,-2210.95 3325,-2210.95 3325,-2157.95 3507,-2157.95 3507,-2210.95"/>
<text text-anchor="middle" x="3416" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3416" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3416" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 44</text>
</g>
<!-- expert_linear1_2_12&#45;&gt;expert_activation_2_12 -->
<g id="edge240" class="edge">
<title>expert_linear1_2_12&#45;&gt;expert_activation_2_12</title>
<path fill="none" stroke="black" d="M3436.46,-2246.82C3433.74,-2238.66 3430.68,-2229.49 3427.77,-2220.77"/>
<polygon fill="black" stroke="black" points="3431.07,-2219.58 3424.58,-2211.2 3424.43,-2221.8 3431.07,-2219.58"/>
</g>
<!-- expert_linear2_2_12 -->
<g id="node207" class="node">
<title>expert_linear2_2_12</title>
<polygon fill="lightgreen" stroke="black" points="3443.5,-2121.95 3270.5,-2121.95 3270.5,-2068.95 3443.5,-2068.95 3443.5,-2121.95"/>
<text text-anchor="middle" x="3357" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="3357" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3357" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 44</text>
</g>
<!-- expert_activation_2_12&#45;&gt;expert_linear2_2_12 -->
<g id="edge241" class="edge">
<title>expert_activation_2_12&#45;&gt;expert_linear2_2_12</title>
<path fill="none" stroke="black" d="M3398.62,-2157.82C3392.85,-2149.31 3386.33,-2139.7 3380.19,-2130.65"/>
<polygon fill="black" stroke="black" points="3382.97,-2128.51 3374.46,-2122.2 3377.18,-2132.44 3382.97,-2128.51"/>
</g>
<!-- expert_linear2_2_12&#45;&gt;aggregate_2 -->
<g id="edge266" class="edge">
<title>expert_linear2_2_12&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3270.48,-2079.06C3249.41,-2075.53 3226.92,-2071.94 3206,-2068.95 3017.4,-2042.04 2801.38,-2017.46 2649.05,-2001.16"/>
<polygon fill="black" stroke="black" points="2648.96,-1997.64 2638.65,-2000.05 2648.22,-2004.6 2648.96,-1997.64"/>
</g>
<!-- expert_linear1_2_13 -->
<g id="node209" class="node">
<title>expert_linear1_2_13</title>
<polygon fill="lightgreen" stroke="black" points="3797,-2299.95 3615,-2299.95 3615,-2246.95 3797,-2246.95 3797,-2299.95"/>
<text text-anchor="middle" x="3706" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="3706" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3706" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 45</text>
</g>
<!-- route_to_expert_2_13&#45;&gt;expert_linear1_2_13 -->
<g id="edge243" class="edge">
<title>route_to_expert_2_13&#45;&gt;expert_linear1_2_13</title>
<path fill="none" stroke="black" d="M3744.63,-2336.5C3738.97,-2327.41 3732.91,-2317.67 3727.3,-2308.66"/>
<polygon fill="black" stroke="black" points="3730.13,-2306.59 3721.88,-2299.95 3724.19,-2310.29 3730.13,-2306.59"/>
</g>
<!-- expert_activation_2_13 -->
<g id="node210" class="node">
<title>expert_activation_2_13</title>
<polygon fill="lightgreen" stroke="black" points="3767,-2210.95 3585,-2210.95 3585,-2157.95 3767,-2157.95 3767,-2210.95"/>
<text text-anchor="middle" x="3676" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="3676" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3676" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 45</text>
</g>
<!-- expert_linear1_2_13&#45;&gt;expert_activation_2_13 -->
<g id="edge244" class="edge">
<title>expert_linear1_2_13&#45;&gt;expert_activation_2_13</title>
<path fill="none" stroke="black" d="M3697.16,-2246.82C3694.35,-2238.66 3691.19,-2229.49 3688.18,-2220.77"/>
<polygon fill="black" stroke="black" points="3691.45,-2219.52 3684.88,-2211.2 3684.83,-2221.8 3691.45,-2219.52"/>
</g>
<!-- expert_linear2_2_13 -->
<g id="node211" class="node">
<title>expert_linear2_2_13</title>
<polygon fill="lightgreen" stroke="black" points="3698.5,-2121.95 3525.5,-2121.95 3525.5,-2068.95 3698.5,-2068.95 3698.5,-2121.95"/>
<text text-anchor="middle" x="3612" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="3612" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3612" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 45</text>
</g>
<!-- expert_activation_2_13&#45;&gt;expert_linear2_2_13 -->
<g id="edge245" class="edge">
<title>expert_activation_2_13&#45;&gt;expert_linear2_2_13</title>
<path fill="none" stroke="black" d="M3657.14,-2157.82C3650.82,-2149.22 3643.67,-2139.5 3636.95,-2130.37"/>
<polygon fill="black" stroke="black" points="3639.69,-2128.18 3630.94,-2122.2 3634.05,-2132.33 3639.69,-2128.18"/>
</g>
<!-- expert_linear2_2_13&#45;&gt;aggregate_2 -->
<g id="edge267" class="edge">
<title>expert_linear2_2_13&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3525.1,-2079.37C3501.73,-2075.63 3476.44,-2071.86 3453,-2068.95 3171.87,-2034.1 2844.63,-2008.05 2642.9,-1993.67"/>
<polygon fill="black" stroke="black" points="2643.01,-1990.17 2632.79,-1992.95 2642.51,-1997.15 2643.01,-1990.17"/>
</g>
<!-- expert_linear1_2_14 -->
<g id="node213" class="node">
<title>expert_linear1_2_14</title>
<polygon fill="lightgreen" stroke="black" points="4059,-2299.95 3877,-2299.95 3877,-2246.95 4059,-2246.95 4059,-2299.95"/>
<text text-anchor="middle" x="3968" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="3968" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3968" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 46</text>
</g>
<!-- route_to_expert_2_14&#45;&gt;expert_linear1_2_14 -->
<g id="edge247" class="edge">
<title>route_to_expert_2_14&#45;&gt;expert_linear1_2_14</title>
<path fill="none" stroke="black" d="M4007.27,-2336.5C4001.51,-2327.41 3995.35,-2317.67 3989.65,-2308.66"/>
<polygon fill="black" stroke="black" points="3992.44,-2306.53 3984.14,-2299.95 3986.53,-2310.28 3992.44,-2306.53"/>
</g>
<!-- expert_activation_2_14 -->
<g id="node214" class="node">
<title>expert_activation_2_14</title>
<polygon fill="lightgreen" stroke="black" points="4028,-2210.95 3846,-2210.95 3846,-2157.95 4028,-2157.95 4028,-2210.95"/>
<text text-anchor="middle" x="3937" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="3937" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3937" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 46</text>
</g>
<!-- expert_linear1_2_14&#45;&gt;expert_activation_2_14 -->
<g id="edge248" class="edge">
<title>expert_linear1_2_14&#45;&gt;expert_activation_2_14</title>
<path fill="none" stroke="black" d="M3958.87,-2246.82C3955.96,-2238.66 3952.69,-2229.49 3949.59,-2220.77"/>
<polygon fill="black" stroke="black" points="3952.83,-2219.45 3946.18,-2211.2 3946.23,-2221.8 3952.83,-2219.45"/>
</g>
<!-- expert_linear2_2_14 -->
<g id="node215" class="node">
<title>expert_linear2_2_14</title>
<polygon fill="lightgreen" stroke="black" points="3956.5,-2121.95 3783.5,-2121.95 3783.5,-2068.95 3956.5,-2068.95 3956.5,-2121.95"/>
<text text-anchor="middle" x="3870" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="3870" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3870" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 46</text>
</g>
<!-- expert_activation_2_14&#45;&gt;expert_linear2_2_14 -->
<g id="edge249" class="edge">
<title>expert_activation_2_14&#45;&gt;expert_linear2_2_14</title>
<path fill="none" stroke="black" d="M3917.26,-2157.82C3910.64,-2149.22 3903.15,-2139.5 3896.12,-2130.37"/>
<polygon fill="black" stroke="black" points="3898.7,-2127.99 3889.83,-2122.2 3893.16,-2132.26 3898.7,-2127.99"/>
</g>
<!-- expert_linear2_2_14&#45;&gt;aggregate_2 -->
<g id="edge268" class="edge">
<title>expert_linear2_2_14&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3783.17,-2079.37C3758.9,-2075.54 3732.47,-2071.73 3708,-2068.95 3329.89,-2026.03 2885.21,-2000.79 2639.35,-1989.03"/>
<polygon fill="black" stroke="black" points="2639.4,-1985.53 2629.24,-1988.55 2639.06,-1992.52 2639.4,-1985.53"/>
</g>
<!-- expert_linear1_2_15 -->
<g id="node217" class="node">
<title>expert_linear1_2_15</title>
<polygon fill="lightgreen" stroke="black" points="4322,-2299.95 4140,-2299.95 4140,-2246.95 4322,-2246.95 4322,-2299.95"/>
<text text-anchor="middle" x="4231" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4231" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4231" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 47</text>
</g>
<!-- route_to_expert_2_15&#45;&gt;expert_linear1_2_15 -->
<g id="edge251" class="edge">
<title>route_to_expert_2_15&#45;&gt;expert_linear1_2_15</title>
<path fill="none" stroke="black" d="M4270.27,-2336.5C4264.51,-2327.41 4258.35,-2317.67 4252.65,-2308.66"/>
<polygon fill="black" stroke="black" points="4255.44,-2306.53 4247.14,-2299.95 4249.53,-2310.28 4255.44,-2306.53"/>
</g>
<!-- expert_activation_2_15 -->
<g id="node218" class="node">
<title>expert_activation_2_15</title>
<polygon fill="lightgreen" stroke="black" points="4291,-2210.95 4109,-2210.95 4109,-2157.95 4291,-2157.95 4291,-2210.95"/>
<text text-anchor="middle" x="4200" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4200" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4200" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 47</text>
</g>
<!-- expert_linear1_2_15&#45;&gt;expert_activation_2_15 -->
<g id="edge252" class="edge">
<title>expert_linear1_2_15&#45;&gt;expert_activation_2_15</title>
<path fill="none" stroke="black" d="M4221.87,-2246.82C4218.96,-2238.66 4215.69,-2229.49 4212.59,-2220.77"/>
<polygon fill="black" stroke="black" points="4215.83,-2219.45 4209.18,-2211.2 4209.23,-2221.8 4215.83,-2219.45"/>
</g>
<!-- expert_linear2_2_15 -->
<g id="node219" class="node">
<title>expert_linear2_2_15</title>
<polygon fill="lightgreen" stroke="black" points="4217.5,-2121.95 4044.5,-2121.95 4044.5,-2068.95 4217.5,-2068.95 4217.5,-2121.95"/>
<text text-anchor="middle" x="4131" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4131" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4131" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 47</text>
</g>
<!-- expert_activation_2_15&#45;&gt;expert_linear2_2_15 -->
<g id="edge253" class="edge">
<title>expert_activation_2_15&#45;&gt;expert_linear2_2_15</title>
<path fill="none" stroke="black" d="M4179.67,-2157.82C4172.78,-2149.14 4164.98,-2139.3 4157.68,-2130.09"/>
<polygon fill="black" stroke="black" points="4160.38,-2127.86 4151.42,-2122.2 4154.89,-2132.21 4160.38,-2127.86"/>
</g>
<!-- expert_linear2_2_15&#45;&gt;aggregate_2 -->
<g id="edge269" class="edge">
<title>expert_linear2_2_15&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4044.29,-2079.46C4019.1,-2075.54 3991.51,-2071.66 3966,-2068.95 3488.28,-2018.27 2922.43,-1995.13 2636.76,-1986.02"/>
<polygon fill="black" stroke="black" points="2636.82,-1982.52 2626.72,-1985.7 2636.6,-1989.52 2636.82,-1982.52"/>
</g>
<!-- aggregate_2&#45;&gt;moe_residual_2 -->
<g id="edge271" class="edge">
<title>aggregate_2&#45;&gt;moe_residual_2</title>
<path fill="none" stroke="black" d="M2600.56,-1953.68C2751.96,-1927.93 2985.06,-1888.27 3133.75,-1862.98"/>
<polygon fill="black" stroke="black" points="3134.6,-1866.39 3143.87,-1861.26 3133.42,-1859.49 3134.6,-1866.39"/>
</g>
<!-- ln2_2 -->
<g id="node222" class="node">
<title>ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="3364.5,-1748.95 3185.5,-1748.95 3185.5,-1695.95 3364.5,-1695.95 3364.5,-1748.95"/>
<text text-anchor="middle" x="3275" y="-1733.75" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="3275" y="-1718.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3275" y="-1703.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- moe_residual_2&#45;&gt;ln2_2 -->
<g id="edge272" class="edge">
<title>moe_residual_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M3275,-1784.85C3275,-1776.18 3275,-1767.37 3275,-1759.22"/>
<polygon fill="black" stroke="black" points="3278.5,-1758.97 3275,-1748.97 3271.5,-1758.97 3278.5,-1758.97"/>
</g>
<!-- mha_qkv_3 -->
<g id="node223" class="node">
<title>mha_qkv_3</title>
<polygon fill="lightgreen" stroke="black" points="3305.5,-1648.95 3126.5,-1648.95 3126.5,-1595.95 3305.5,-1595.95 3305.5,-1648.95"/>
<text text-anchor="middle" x="3216" y="-1633.75" font-family="Times,serif" font-size="14.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3216" y="-1618.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3216" y="-1603.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_2&#45;&gt;mha_qkv_3 -->
<g id="edge273" class="edge">
<title>ln2_2&#45;&gt;mha_qkv_3</title>
<path fill="none" stroke="black" d="M3259.5,-1695.7C3252.52,-1684.11 3244.18,-1670.26 3236.68,-1657.8"/>
<polygon fill="black" stroke="black" points="3239.55,-1655.79 3231.4,-1649.03 3233.56,-1659.4 3239.55,-1655.79"/>
</g>
<!-- mha_residual_3 -->
<g id="node226" class="node">
<title>mha_residual_3</title>
<polygon fill="lightyellow" stroke="black" points="3460.66,-1381.95 3165.32,-1381.95 3089.34,-1275.95 3384.68,-1275.95 3460.66,-1381.95"/>
<text text-anchor="middle" x="3275" y="-1340.25" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="3275" y="-1325.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3275" y="-1310.25" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_2&#45;&gt;mha_residual_3 -->
<g id="edge277" class="edge">
<title>ln2_2&#45;&gt;mha_residual_3</title>
<path fill="none" stroke="black" d="M3305.49,-1695.52C3309.36,-1690.76 3312.75,-1685.52 3315,-1679.95 3358.57,-1571.97 3339.65,-1531.76 3315,-1417.95 3313.1,-1409.16 3310.23,-1400.19 3306.9,-1391.51"/>
<polygon fill="black" stroke="black" points="3310.13,-1390.16 3303.12,-1382.21 3303.65,-1392.79 3310.13,-1390.16"/>
</g>
<!-- mha_attn_3 -->
<g id="node224" class="node">
<title>mha_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="3305.5,-1559.95 3126.5,-1559.95 3126.5,-1506.95 3305.5,-1506.95 3305.5,-1559.95"/>
<text text-anchor="middle" x="3216" y="-1544.75" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3216" y="-1529.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3216" y="-1514.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_qkv_3&#45;&gt;mha_attn_3 -->
<g id="edge274" class="edge">
<title>mha_qkv_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M3216,-1595.82C3216,-1587.84 3216,-1578.89 3216,-1570.34"/>
<polygon fill="black" stroke="black" points="3219.5,-1570.2 3216,-1560.2 3212.5,-1570.2 3219.5,-1570.2"/>
</g>
<!-- mha_out_3 -->
<g id="node225" class="node">
<title>mha_out_3</title>
<polygon fill="lightgreen" stroke="black" points="3305.5,-1470.95 3126.5,-1470.95 3126.5,-1417.95 3305.5,-1417.95 3305.5,-1470.95"/>
<text text-anchor="middle" x="3216" y="-1455.75" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="3216" y="-1440.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3216" y="-1425.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge275" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M3216,-1506.82C3216,-1498.84 3216,-1489.89 3216,-1481.34"/>
<polygon fill="black" stroke="black" points="3219.5,-1481.2 3216,-1471.2 3212.5,-1481.2 3219.5,-1481.2"/>
</g>
<!-- mha_out_3&#45;&gt;mha_residual_3 -->
<g id="edge276" class="edge">
<title>mha_out_3&#45;&gt;mha_residual_3</title>
<path fill="none" stroke="black" d="M3229.39,-1417.7C3233.56,-1409.67 3238.36,-1400.45 3243.23,-1391.06"/>
<polygon fill="black" stroke="black" points="3246.41,-1392.54 3247.92,-1382.05 3240.2,-1389.31 3246.41,-1392.54"/>
</g>
<!-- ln1_3 -->
<g id="node227" class="node">
<title>ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="3364.5,-1239.95 3185.5,-1239.95 3185.5,-1186.95 3364.5,-1186.95 3364.5,-1239.95"/>
<text text-anchor="middle" x="3275" y="-1224.75" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="3275" y="-1209.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3275" y="-1194.75" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- mha_residual_3&#45;&gt;ln1_3 -->
<g id="edge278" class="edge">
<title>mha_residual_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M3275,-1275.85C3275,-1267.18 3275,-1258.37 3275,-1250.22"/>
<polygon fill="black" stroke="black" points="3278.5,-1249.97 3275,-1239.97 3271.5,-1249.97 3278.5,-1249.97"/>
</g>
<!-- gate_3 -->
<g id="node228" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="2408.83,-1150.95 2143.44,-1150.95 2075.17,-1044.95 2340.56,-1044.95 2408.83,-1150.95"/>
<text text-anchor="middle" x="2242" y="-1109.25" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="2242" y="-1094.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="2242" y="-1079.25" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_3&#45;&gt;gate_3 -->
<g id="edge279" class="edge">
<title>ln1_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M3185.14,-1202.58C3008.56,-1183.18 2614.55,-1139.89 2395.8,-1115.85"/>
<polygon fill="black" stroke="black" points="2396.16,-1112.37 2385.84,-1114.76 2395.4,-1119.33 2396.16,-1112.37"/>
</g>
<!-- moe_residual_3 -->
<g id="node294" class="node">
<title>moe_residual_3</title>
<polygon fill="lightyellow" stroke="black" points="3325.66,-489 3030.32,-489 2954.34,-383 3249.68,-383 3325.66,-489"/>
<text text-anchor="middle" x="3140" y="-447.3" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="3140" y="-432.3" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3140" y="-417.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln1_3&#45;&gt;moe_residual_3 -->
<g id="edge360" class="edge">
<title>ln1_3&#45;&gt;moe_residual_3</title>
<path fill="none" stroke="black" d="M3364.71,-1208.84C3601.27,-1196.89 4224,-1148.69 4224,-972.48 4224,-972.48 4224,-972.48 4224,-692.5 4224,-505.32 3603.96,-455.13 3301.75,-441.78"/>
<polygon fill="black" stroke="black" points="3301.72,-438.27 3291.58,-441.34 3301.42,-445.27 3301.72,-438.27"/>
</g>
<!-- route_to_expert_3_0 -->
<g id="node229" class="node">
<title>route_to_expert_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="138" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="138" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="138" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="138" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_0 -->
<g id="edge280" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2107.26,-1094.89C1722.75,-1088.36 625.09,-1065.2 270,-1008.95 257.68,-1007 244.86,-1004.32 232.27,-1001.28"/>
<polygon fill="black" stroke="black" points="232.79,-997.8 222.24,-998.78 231.09,-1004.6 232.79,-997.8"/>
</g>
<!-- route_to_expert_3_1 -->
<g id="node233" class="node">
<title>route_to_expert_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="401" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="401" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="401" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="401" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 49</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_1 -->
<g id="edge284" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2106.46,-1093.79C1757.61,-1085.04 835.07,-1057.87 533,-1008.95 520.68,-1006.96 507.87,-1004.25 495.28,-1001.2"/>
<polygon fill="black" stroke="black" points="495.8,-997.72 485.25,-998.69 494.1,-1004.52 495.8,-997.72"/>
</g>
<!-- route_to_expert_3_2 -->
<g id="node237" class="node">
<title>route_to_expert_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="664" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="664" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="664" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="664" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 50</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_2 -->
<g id="edge288" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2105.55,-1092.29C1795.48,-1081.1 1045.48,-1050.55 796,-1008.95 783.79,-1006.92 771.08,-1004.2 758.59,-1001.16"/>
<polygon fill="black" stroke="black" points="759.18,-997.7 748.62,-998.67 757.47,-1004.49 759.18,-997.7"/>
</g>
<!-- route_to_expert_3_3 -->
<g id="node241" class="node">
<title>route_to_expert_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="927" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="927" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="927" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="927" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 51</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_3 -->
<g id="edge292" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2107.45,-1095.47C1886.85,-1091.14 1435.15,-1074.27 1059,-1008.95 1046.89,-1006.85 1034.29,-1004.11 1021.9,-1001.08"/>
<polygon fill="black" stroke="black" points="1022.56,-997.63 1012.01,-998.59 1020.85,-1004.42 1022.56,-997.63"/>
</g>
<!-- route_to_expert_3_4 -->
<g id="node245" class="node">
<title>route_to_expert_3_4</title>
<ellipse fill="lightblue" stroke="black" cx="1190" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1190" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1190" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1190" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 52</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_4 -->
<g id="edge296" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2104.97,-1091.3C1924.31,-1082.16 1597.14,-1059.73 1322,-1008.95 1310.01,-1006.74 1297.52,-1003.95 1285.22,-1000.9"/>
<polygon fill="black" stroke="black" points="1285.97,-997.48 1275.41,-998.41 1284.24,-1004.26 1285.97,-997.48"/>
</g>
<!-- route_to_expert_3_5 -->
<g id="node249" class="node">
<title>route_to_expert_3_5</title>
<ellipse fill="lightblue" stroke="black" cx="1453" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1453" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="1453" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1453" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 53</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_5 -->
<g id="edge300" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2099.77,-1083.56C1966.06,-1069.65 1760.76,-1044.83 1585,-1008.95 1573.35,-1006.58 1561.22,-1003.74 1549.23,-1000.7"/>
<polygon fill="black" stroke="black" points="1549.77,-997.23 1539.22,-998.12 1548.02,-1004.01 1549.77,-997.23"/>
</g>
<!-- route_to_expert_3_6 -->
<g id="node253" class="node">
<title>route_to_expert_3_6</title>
<ellipse fill="lightblue" stroke="black" cx="1716" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1716" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="1716" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1716" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 54</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_6 -->
<g id="edge304" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2087.21,-1064.25C2014.41,-1048.39 1926.54,-1028.56 1848,-1008.95 1837.03,-1006.21 1825.58,-1003.23 1814.2,-1000.2"/>
<polygon fill="black" stroke="black" points="1814.8,-996.73 1804.24,-997.52 1812.99,-1003.49 1814.8,-996.73"/>
</g>
<!-- route_to_expert_3_7 -->
<g id="node257" class="node">
<title>route_to_expert_3_7</title>
<ellipse fill="lightblue" stroke="black" cx="1979" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1979" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="1979" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1979" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 55</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_7 -->
<g id="edge308" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2131.99,-1044.89C2105.53,-1032.36 2077.87,-1019.27 2053.47,-1007.72"/>
<polygon fill="black" stroke="black" points="2054.82,-1004.49 2044.29,-1003.38 2051.83,-1010.82 2054.82,-1004.49"/>
</g>
<!-- route_to_expert_3_8 -->
<g id="node261" class="node">
<title>route_to_expert_3_8</title>
<ellipse fill="lightblue" stroke="black" cx="2242" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2242" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2242" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2242" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 56</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_8 -->
<g id="edge312" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2242,-1044.89C2242,-1036.45 2242,-1027.77 2242,-1019.46"/>
<polygon fill="black" stroke="black" points="2245.5,-1019.2 2242,-1009.2 2238.5,-1019.2 2245.5,-1019.2"/>
</g>
<!-- route_to_expert_3_9 -->
<g id="node265" class="node">
<title>route_to_expert_3_9</title>
<ellipse fill="lightblue" stroke="black" cx="2505" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2505" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="2505" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2505" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 57</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_9 -->
<g id="edge316" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2343.31,-1049.01C2372.43,-1035.22 2403.64,-1020.45 2430.8,-1007.6"/>
<polygon fill="black" stroke="black" points="2432.3,-1010.76 2439.84,-1003.32 2429.3,-1004.43 2432.3,-1010.76"/>
</g>
<!-- route_to_expert_3_10 -->
<g id="node269" class="node">
<title>route_to_expert_3_10</title>
<ellipse fill="lightblue" stroke="black" cx="2768" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2768" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="2768" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2768" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 58</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_10 -->
<g id="edge320" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2358.73,-1072.48C2437.33,-1055.61 2543.18,-1032.13 2636,-1008.95 2646.97,-1006.21 2658.42,-1003.23 2669.8,-1000.2"/>
<polygon fill="black" stroke="black" points="2671.01,-1003.49 2679.76,-997.52 2669.2,-996.73 2671.01,-1003.49"/>
</g>
<!-- route_to_expert_3_11 -->
<g id="node273" class="node">
<title>route_to_expert_3_11</title>
<ellipse fill="lightblue" stroke="black" cx="3031" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3031" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3031" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3031" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 59</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_11 -->
<g id="edge324" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2366.66,-1085.37C2499.44,-1071.85 2715.35,-1046.45 2899,-1008.95 2910.65,-1006.58 2922.78,-1003.74 2934.77,-1000.7"/>
<polygon fill="black" stroke="black" points="2935.98,-1004.01 2944.78,-998.12 2934.23,-997.23 2935.98,-1004.01"/>
</g>
<!-- route_to_expert_3_12 -->
<g id="node277" class="node">
<title>route_to_expert_3_12</title>
<ellipse fill="lightblue" stroke="black" cx="3294" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3294" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3294" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3294" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 60</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_12 -->
<g id="edge328" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2370.97,-1091.71C2549.83,-1082.83 2882.72,-1060.49 3162,-1008.95 3173.99,-1006.74 3186.48,-1003.95 3198.78,-1000.9"/>
<polygon fill="black" stroke="black" points="3199.76,-1004.26 3208.59,-998.41 3198.03,-997.48 3199.76,-1004.26"/>
</g>
<!-- route_to_expert_3_13 -->
<g id="node281" class="node">
<title>route_to_expert_3_13</title>
<ellipse fill="lightblue" stroke="black" cx="3557" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3557" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="3557" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3557" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 61</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_13 -->
<g id="edge332" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2373.44,-1095.53C2592.88,-1091.29 3047.07,-1074.58 3425,-1008.95 3437.11,-1006.85 3449.71,-1004.11 3462.1,-1001.08"/>
<polygon fill="black" stroke="black" points="3463.15,-1004.42 3471.99,-998.59 3461.44,-997.63 3463.15,-1004.42"/>
</g>
<!-- route_to_expert_3_14 -->
<g id="node285" class="node">
<title>route_to_expert_3_14</title>
<ellipse fill="lightblue" stroke="black" cx="3820" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3820" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="3820" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3820" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 62</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_14 -->
<g id="edge336" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2371.3,-1092.55C2676.84,-1081.58 3436.58,-1050.87 3688,-1008.95 3700.21,-1006.92 3712.92,-1004.2 3725.41,-1001.16"/>
<polygon fill="black" stroke="black" points="3726.53,-1004.49 3735.38,-998.67 3724.82,-997.7 3726.53,-1004.49"/>
</g>
<!-- route_to_expert_3_15 -->
<g id="node289" class="node">
<title>route_to_expert_3_15</title>
<ellipse fill="lightblue" stroke="black" cx="4083" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4083" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4083" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4083" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 63</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_15 -->
<g id="edge340" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2372.19,-1093.93C2716.85,-1085.32 3647.37,-1058.12 3951,-1008.95 3963.32,-1006.96 3976.13,-1004.25 3988.72,-1001.2"/>
<polygon fill="black" stroke="black" points="3989.9,-1004.52 3998.75,-998.69 3988.2,-997.72 3989.9,-1004.52"/>
</g>
<!-- expert_linear1_3_0 -->
<g id="node230" class="node">
<title>expert_linear1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="259,-898 77,-898 77,-845 259,-845 259,-898"/>
<text text-anchor="middle" x="168" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="168" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="168" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- route_to_expert_3_0&#45;&gt;expert_linear1_3_0 -->
<g id="edge281" class="edge">
<title>route_to_expert_3_0&#45;&gt;expert_linear1_3_0</title>
<path fill="none" stroke="black" d="M149.17,-933.99C151.81,-925.39 154.61,-916.24 157.22,-907.69"/>
<polygon fill="black" stroke="black" points="160.61,-908.6 160.19,-898.01 153.91,-906.55 160.61,-908.6"/>
</g>
<!-- expert_activation_3_0 -->
<g id="node231" class="node">
<title>expert_activation_3_0</title>
<polygon fill="lightgreen" stroke="black" points="293,-809 111,-809 111,-756 293,-756 293,-809"/>
<text text-anchor="middle" x="202" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="202" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="202" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- expert_linear1_3_0&#45;&gt;expert_activation_3_0 -->
<g id="edge282" class="edge">
<title>expert_linear1_3_0&#45;&gt;expert_activation_3_0</title>
<path fill="none" stroke="black" d="M178.02,-844.87C181.21,-836.71 184.79,-827.54 188.2,-818.82"/>
<polygon fill="black" stroke="black" points="191.56,-819.84 191.94,-809.25 185.04,-817.29 191.56,-819.84"/>
</g>
<!-- expert_linear2_3_0 -->
<g id="node232" class="node">
<title>expert_linear2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="420.5,-720 247.5,-720 247.5,-667 420.5,-667 420.5,-720"/>
<text text-anchor="middle" x="334" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="334" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="334" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 48</text>
</g>
<!-- expert_activation_3_0&#45;&gt;expert_linear2_3_0 -->
<g id="edge283" class="edge">
<title>expert_activation_3_0&#45;&gt;expert_linear2_3_0</title>
<path fill="none" stroke="black" d="M240.89,-755.87C255.13,-746.48 271.41,-735.75 286.33,-725.92"/>
<polygon fill="black" stroke="black" points="288.51,-728.68 294.93,-720.25 284.66,-722.83 288.51,-728.68"/>
</g>
<!-- aggregate_3 -->
<g id="node293" class="node">
<title>aggregate_3</title>
<polygon fill="lightyellow" stroke="black" points="2455.64,-631 2115.79,-631 2028.36,-525 2368.21,-525 2455.64,-631"/>
<text text-anchor="middle" x="2242" y="-589.3" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="2242" y="-574.3" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="2242" y="-559.3" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- expert_linear2_3_0&#45;&gt;aggregate_3 -->
<g id="edge344" class="edge">
<title>expert_linear2_3_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M420.58,-680.96C460,-676.05 507.3,-670.63 550,-667 1102.61,-620.06 1759.03,-594.53 2066.59,-584.33"/>
<polygon fill="black" stroke="black" points="2067.05,-587.82 2076.93,-583.99 2066.82,-580.82 2067.05,-587.82"/>
</g>
<!-- expert_linear1_3_1 -->
<g id="node234" class="node">
<title>expert_linear1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="508,-898 326,-898 326,-845 508,-845 508,-898"/>
<text text-anchor="middle" x="417" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="417" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="417" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 49</text>
</g>
<!-- route_to_expert_3_1&#45;&gt;expert_linear1_3_1 -->
<g id="edge285" class="edge">
<title>route_to_expert_3_1&#45;&gt;expert_linear1_3_1</title>
<path fill="none" stroke="black" d="M406.96,-933.99C408.35,-925.48 409.83,-916.44 411.21,-907.97"/>
<polygon fill="black" stroke="black" points="414.68,-908.44 412.83,-898.01 407.77,-907.32 414.68,-908.44"/>
</g>
<!-- expert_activation_3_1 -->
<g id="node235" class="node">
<title>expert_activation_3_1</title>
<polygon fill="lightgreen" stroke="black" points="524,-809 342,-809 342,-756 524,-756 524,-809"/>
<text text-anchor="middle" x="433" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="433" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="433" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 49</text>
</g>
<!-- expert_linear1_3_1&#45;&gt;expert_activation_3_1 -->
<g id="edge286" class="edge">
<title>expert_linear1_3_1&#45;&gt;expert_activation_3_1</title>
<path fill="none" stroke="black" d="M421.71,-844.87C423.2,-836.8 424.86,-827.74 426.45,-819.1"/>
<polygon fill="black" stroke="black" points="429.9,-819.72 428.26,-809.25 423.01,-818.45 429.9,-819.72"/>
</g>
<!-- expert_linear2_3_1 -->
<g id="node236" class="node">
<title>expert_linear2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="732.5,-720 559.5,-720 559.5,-667 732.5,-667 732.5,-720"/>
<text text-anchor="middle" x="646" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="646" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="646" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 49</text>
</g>
<!-- expert_activation_3_1&#45;&gt;expert_linear2_3_1 -->
<g id="edge287" class="edge">
<title>expert_activation_3_1&#45;&gt;expert_linear2_3_1</title>
<path fill="none" stroke="black" d="M495.47,-755.98C520.18,-745.89 548.72,-734.23 574.27,-723.8"/>
<polygon fill="black" stroke="black" points="575.6,-727.04 583.53,-720.01 572.95,-720.56 575.6,-727.04"/>
</g>
<!-- expert_linear2_3_1&#45;&gt;aggregate_3 -->
<g id="edge345" class="edge">
<title>expert_linear2_3_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M732.68,-676.64C754.89,-673.01 778.78,-669.5 801,-667 1255.47,-615.87 1794.15,-592.92 2066.11,-583.96"/>
<polygon fill="black" stroke="black" points="2066.59,-587.44 2076.47,-583.62 2066.36,-580.45 2066.59,-587.44"/>
</g>
<!-- expert_linear1_3_2 -->
<g id="node238" class="node">
<title>expert_linear1_3_2</title>
<polygon fill="lightgreen" stroke="black" points="817,-898 635,-898 635,-845 817,-845 817,-898"/>
<text text-anchor="middle" x="726" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="726" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="726" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 50</text>
</g>
<!-- route_to_expert_3_2&#45;&gt;expert_linear1_3_2 -->
<g id="edge289" class="edge">
<title>route_to_expert_3_2&#45;&gt;expert_linear1_3_2</title>
<path fill="none" stroke="black" d="M686.73,-934.55C692.49,-925.46 698.65,-915.72 704.35,-906.71"/>
<polygon fill="black" stroke="black" points="707.47,-908.32 709.86,-898 701.56,-904.58 707.47,-908.32"/>
</g>
<!-- expert_activation_3_2 -->
<g id="node239" class="node">
<title>expert_activation_3_2</title>
<polygon fill="lightgreen" stroke="black" points="913,-809 731,-809 731,-756 913,-756 913,-809"/>
<text text-anchor="middle" x="822" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="822" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="822" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 50</text>
</g>
<!-- expert_linear1_3_2&#45;&gt;expert_activation_3_2 -->
<g id="edge290" class="edge">
<title>expert_linear1_3_2&#45;&gt;expert_activation_3_2</title>
<path fill="none" stroke="black" d="M754.28,-844.87C764.25,-835.83 775.6,-825.55 786.11,-816.03"/>
<polygon fill="black" stroke="black" points="788.53,-818.56 793.59,-809.25 783.83,-813.37 788.53,-818.56"/>
</g>
<!-- expert_linear2_3_2 -->
<g id="node240" class="node">
<title>expert_linear2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="983.5,-720 810.5,-720 810.5,-667 983.5,-667 983.5,-720"/>
<text text-anchor="middle" x="897" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="897" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="897" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 50</text>
</g>
<!-- expert_activation_3_2&#45;&gt;expert_linear2_3_2 -->
<g id="edge291" class="edge">
<title>expert_activation_3_2&#45;&gt;expert_linear2_3_2</title>
<path fill="none" stroke="black" d="M844.1,-755.87C851.66,-747.1 860.23,-737.15 868.24,-727.86"/>
<polygon fill="black" stroke="black" points="870.92,-730.11 874.8,-720.25 865.62,-725.54 870.92,-730.11"/>
</g>
<!-- expert_linear2_3_2&#45;&gt;aggregate_3 -->
<g id="edge346" class="edge">
<title>expert_linear2_3_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M983.83,-678.29C1010.75,-674.23 1040.56,-670.07 1068,-667 1423.01,-627.28 1840.49,-600.78 2069.66,-587.96"/>
<polygon fill="black" stroke="black" points="2069.97,-591.45 2079.76,-587.4 2069.58,-584.46 2069.97,-591.45"/>
</g>
<!-- expert_linear1_3_3 -->
<g id="node242" class="node">
<title>expert_linear1_3_3</title>
<polygon fill="lightgreen" stroke="black" points="1080,-898 898,-898 898,-845 1080,-845 1080,-898"/>
<text text-anchor="middle" x="989" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="989" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="989" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 51</text>
</g>
<!-- route_to_expert_3_3&#45;&gt;expert_linear1_3_3 -->
<g id="edge293" class="edge">
<title>route_to_expert_3_3&#45;&gt;expert_linear1_3_3</title>
<path fill="none" stroke="black" d="M949.73,-934.55C955.49,-925.46 961.65,-915.72 967.35,-906.71"/>
<polygon fill="black" stroke="black" points="970.47,-908.32 972.86,-898 964.56,-904.58 970.47,-908.32"/>
</g>
<!-- expert_activation_3_3 -->
<g id="node243" class="node">
<title>expert_activation_3_3</title>
<polygon fill="lightgreen" stroke="black" points="1207,-809 1025,-809 1025,-756 1207,-756 1207,-809"/>
<text text-anchor="middle" x="1116" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1116" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1116" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 51</text>
</g>
<!-- expert_linear1_3_3&#45;&gt;expert_activation_3_3 -->
<g id="edge294" class="edge">
<title>expert_linear1_3_3&#45;&gt;expert_activation_3_3</title>
<path fill="none" stroke="black" d="M1026.42,-844.87C1040.12,-835.48 1055.78,-824.75 1070.13,-814.92"/>
<polygon fill="black" stroke="black" points="1072.14,-817.79 1078.41,-809.25 1068.18,-812.01 1072.14,-817.79"/>
</g>
<!-- expert_linear2_3_3 -->
<g id="node244" class="node">
<title>expert_linear2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="1250.5,-720 1077.5,-720 1077.5,-667 1250.5,-667 1250.5,-720"/>
<text text-anchor="middle" x="1164" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1164" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1164" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 51</text>
</g>
<!-- expert_activation_3_3&#45;&gt;expert_linear2_3_3 -->
<g id="edge295" class="edge">
<title>expert_activation_3_3&#45;&gt;expert_linear2_3_3</title>
<path fill="none" stroke="black" d="M1130.14,-755.87C1134.74,-747.53 1139.92,-738.14 1144.82,-729.26"/>
<polygon fill="black" stroke="black" points="1148.03,-730.7 1149.79,-720.25 1141.9,-727.31 1148.03,-730.7"/>
</g>
<!-- expert_linear2_3_3&#45;&gt;aggregate_3 -->
<g id="edge347" class="edge">
<title>expert_linear2_3_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1250.63,-675.98C1269.5,-672.72 1289.38,-669.52 1308,-667 1573.66,-631.02 1883.81,-604.93 2071.42,-590.89"/>
<polygon fill="black" stroke="black" points="2071.94,-594.36 2081.65,-590.12 2071.42,-587.38 2071.94,-594.36"/>
</g>
<!-- expert_linear1_3_4 -->
<g id="node246" class="node">
<title>expert_linear1_3_4</title>
<polygon fill="lightgreen" stroke="black" points="1342,-898 1160,-898 1160,-845 1342,-845 1342,-898"/>
<text text-anchor="middle" x="1251" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1251" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1251" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 52</text>
</g>
<!-- route_to_expert_3_4&#45;&gt;expert_linear1_3_4 -->
<g id="edge297" class="edge">
<title>route_to_expert_3_4&#45;&gt;expert_linear1_3_4</title>
<path fill="none" stroke="black" d="M1212.37,-934.55C1218.03,-925.46 1224.09,-915.72 1229.7,-906.71"/>
<polygon fill="black" stroke="black" points="1232.81,-908.34 1235.12,-898 1226.87,-904.64 1232.81,-908.34"/>
</g>
<!-- expert_activation_3_4 -->
<g id="node247" class="node">
<title>expert_activation_3_4</title>
<polygon fill="lightgreen" stroke="black" points="1454,-809 1272,-809 1272,-756 1454,-756 1454,-809"/>
<text text-anchor="middle" x="1363" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1363" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1363" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 52</text>
</g>
<!-- expert_linear1_3_4&#45;&gt;expert_activation_3_4 -->
<g id="edge298" class="edge">
<title>expert_linear1_3_4&#45;&gt;expert_activation_3_4</title>
<path fill="none" stroke="black" d="M1284,-844.87C1295.85,-835.66 1309.38,-825.15 1321.84,-815.47"/>
<polygon fill="black" stroke="black" points="1324.1,-818.15 1329.85,-809.25 1319.81,-812.62 1324.1,-818.15"/>
</g>
<!-- expert_linear2_3_4 -->
<g id="node248" class="node">
<title>expert_linear2_3_4</title>
<polygon fill="lightgreen" stroke="black" points="1489.5,-720 1316.5,-720 1316.5,-667 1489.5,-667 1489.5,-720"/>
<text text-anchor="middle" x="1403" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="1403" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1403" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 52</text>
</g>
<!-- expert_activation_3_4&#45;&gt;expert_linear2_3_4 -->
<g id="edge299" class="edge">
<title>expert_activation_3_4&#45;&gt;expert_linear2_3_4</title>
<path fill="none" stroke="black" d="M1374.78,-755.87C1378.58,-747.62 1382.84,-738.34 1386.89,-729.54"/>
<polygon fill="black" stroke="black" points="1390.16,-730.8 1391.16,-720.25 1383.8,-727.87 1390.16,-730.8"/>
</g>
<!-- expert_linear2_3_4&#45;&gt;aggregate_3 -->
<g id="edge348" class="edge">
<title>expert_linear2_3_4&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1489.65,-671.84C1498.19,-670.09 1506.75,-668.43 1515,-667 1705.71,-633.84 1926.72,-609 2074.54,-594.31"/>
<polygon fill="black" stroke="black" points="2075,-597.78 2084.61,-593.31 2074.31,-590.81 2075,-597.78"/>
</g>
<!-- expert_linear1_3_5 -->
<g id="node250" class="node">
<title>expert_linear1_3_5</title>
<polygon fill="lightgreen" stroke="black" points="1603,-898 1421,-898 1421,-845 1603,-845 1603,-898"/>
<text text-anchor="middle" x="1512" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="1512" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1512" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 53</text>
</g>
<!-- route_to_expert_3_5&#45;&gt;expert_linear1_3_5 -->
<g id="edge301" class="edge">
<title>route_to_expert_3_5&#45;&gt;expert_linear1_3_5</title>
<path fill="none" stroke="black" d="M1474.63,-934.55C1480.11,-925.46 1485.98,-915.72 1491.4,-906.71"/>
<polygon fill="black" stroke="black" points="1494.48,-908.37 1496.64,-898 1488.49,-904.76 1494.48,-908.37"/>
</g>
<!-- expert_activation_3_5 -->
<g id="node251" class="node">
<title>expert_activation_3_5</title>
<polygon fill="lightgreen" stroke="black" points="1678,-809 1496,-809 1496,-756 1678,-756 1678,-809"/>
<text text-anchor="middle" x="1587" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1587" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1587" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 53</text>
</g>
<!-- expert_linear1_3_5&#45;&gt;expert_activation_3_5 -->
<g id="edge302" class="edge">
<title>expert_linear1_3_5&#45;&gt;expert_activation_3_5</title>
<path fill="none" stroke="black" d="M1534.1,-844.87C1541.66,-836.1 1550.23,-826.15 1558.24,-816.86"/>
<polygon fill="black" stroke="black" points="1560.92,-819.11 1564.8,-809.25 1555.62,-814.54 1560.92,-819.11"/>
</g>
<!-- expert_linear2_3_5 -->
<g id="node252" class="node">
<title>expert_linear2_3_5</title>
<polygon fill="lightgreen" stroke="black" points="1696.5,-720 1523.5,-720 1523.5,-667 1696.5,-667 1696.5,-720"/>
<text text-anchor="middle" x="1610" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="1610" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1610" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 53</text>
</g>
<!-- expert_activation_3_5&#45;&gt;expert_linear2_3_5 -->
<g id="edge303" class="edge">
<title>expert_activation_3_5&#45;&gt;expert_linear2_3_5</title>
<path fill="none" stroke="black" d="M1593.78,-755.87C1595.91,-747.8 1598.31,-738.74 1600.59,-730.1"/>
<polygon fill="black" stroke="black" points="1604.02,-730.81 1603.19,-720.25 1597.25,-729.02 1604.02,-730.81"/>
</g>
<!-- expert_linear2_3_5&#45;&gt;aggregate_3 -->
<g id="edge349" class="edge">
<title>expert_linear2_3_5&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1696.68,-673.49C1707.55,-671.24 1718.52,-669.02 1729,-667 1847.07,-644.23 1981,-621.36 2082.41,-604.64"/>
<polygon fill="black" stroke="black" points="2083.13,-608.07 2092.43,-602.99 2081.99,-601.16 2083.13,-608.07"/>
</g>
<!-- expert_linear1_3_6 -->
<g id="node254" class="node">
<title>expert_linear1_3_6</title>
<polygon fill="lightgreen" stroke="black" points="1862,-898 1680,-898 1680,-845 1862,-845 1862,-898"/>
<text text-anchor="middle" x="1771" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="1771" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1771" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 54</text>
</g>
<!-- route_to_expert_3_6&#45;&gt;expert_linear1_3_6 -->
<g id="edge305" class="edge">
<title>route_to_expert_3_6&#45;&gt;expert_linear1_3_6</title>
<path fill="none" stroke="black" d="M1736.32,-934.27C1741.32,-925.37 1746.66,-915.87 1751.61,-907.05"/>
<polygon fill="black" stroke="black" points="1754.75,-908.59 1756.6,-898.16 1748.65,-905.16 1754.75,-908.59"/>
</g>
<!-- expert_activation_3_6 -->
<g id="node255" class="node">
<title>expert_activation_3_6</title>
<polygon fill="lightgreen" stroke="black" points="1890,-809 1708,-809 1708,-756 1890,-756 1890,-809"/>
<text text-anchor="middle" x="1799" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1799" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1799" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 54</text>
</g>
<!-- expert_linear1_3_6&#45;&gt;expert_activation_3_6 -->
<g id="edge306" class="edge">
<title>expert_linear1_3_6&#45;&gt;expert_activation_3_6</title>
<path fill="none" stroke="black" d="M1779.25,-844.87C1781.87,-836.71 1784.83,-827.54 1787.63,-818.82"/>
<polygon fill="black" stroke="black" points="1790.98,-819.84 1790.71,-809.25 1784.32,-817.7 1790.98,-819.84"/>
</g>
<!-- expert_linear2_3_6 -->
<g id="node256" class="node">
<title>expert_linear2_3_6</title>
<polygon fill="lightgreen" stroke="black" points="1910.5,-720 1737.5,-720 1737.5,-667 1910.5,-667 1910.5,-720"/>
<text text-anchor="middle" x="1824" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="1824" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1824" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 54</text>
</g>
<!-- expert_activation_3_6&#45;&gt;expert_linear2_3_6 -->
<g id="edge307" class="edge">
<title>expert_activation_3_6&#45;&gt;expert_linear2_3_6</title>
<path fill="none" stroke="black" d="M1806.37,-755.87C1808.68,-747.8 1811.29,-738.74 1813.77,-730.1"/>
<polygon fill="black" stroke="black" points="1817.2,-730.83 1816.6,-720.25 1810.47,-728.89 1817.2,-730.83"/>
</g>
<!-- expert_linear2_3_6&#45;&gt;aggregate_3 -->
<g id="edge350" class="edge">
<title>expert_linear2_3_6&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1910.61,-668.98C1963.5,-654.62 2032.53,-635.88 2093.89,-619.22"/>
<polygon fill="black" stroke="black" points="2094.94,-622.56 2103.67,-616.56 2093.1,-615.8 2094.94,-622.56"/>
</g>
<!-- expert_linear1_3_7 -->
<g id="node258" class="node">
<title>expert_linear1_3_7</title>
<polygon fill="lightgreen" stroke="black" points="2079,-898 1897,-898 1897,-845 2079,-845 2079,-898"/>
<text text-anchor="middle" x="1988" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="1988" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1988" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 55</text>
</g>
<!-- route_to_expert_3_7&#45;&gt;expert_linear1_3_7 -->
<g id="edge309" class="edge">
<title>route_to_expert_3_7&#45;&gt;expert_linear1_3_7</title>
<path fill="none" stroke="black" d="M1982.35,-933.99C1983.13,-925.48 1983.96,-916.44 1984.74,-907.97"/>
<polygon fill="black" stroke="black" points="1988.23,-908.29 1985.66,-898.01 1981.26,-907.65 1988.23,-908.29"/>
</g>
<!-- expert_activation_3_7 -->
<g id="node259" class="node">
<title>expert_activation_3_7</title>
<polygon fill="lightgreen" stroke="black" points="2096,-809 1914,-809 1914,-756 2096,-756 2096,-809"/>
<text text-anchor="middle" x="2005" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2005" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2005" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 55</text>
</g>
<!-- expert_linear1_3_7&#45;&gt;expert_activation_3_7 -->
<g id="edge310" class="edge">
<title>expert_linear1_3_7&#45;&gt;expert_activation_3_7</title>
<path fill="none" stroke="black" d="M1993.01,-844.87C1994.59,-836.8 1996.36,-827.74 1998.04,-819.1"/>
<polygon fill="black" stroke="black" points="2001.49,-819.74 1999.97,-809.25 1994.62,-818.39 2001.49,-819.74"/>
</g>
<!-- expert_linear2_3_7 -->
<g id="node260" class="node">
<title>expert_linear2_3_7</title>
<polygon fill="lightgreen" stroke="black" points="2127.5,-720 1954.5,-720 1954.5,-667 2127.5,-667 2127.5,-720"/>
<text text-anchor="middle" x="2041" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2041" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2041" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 55</text>
</g>
<!-- expert_activation_3_7&#45;&gt;expert_linear2_3_7 -->
<g id="edge311" class="edge">
<title>expert_activation_3_7&#45;&gt;expert_linear2_3_7</title>
<path fill="none" stroke="black" d="M2015.61,-755.87C2019.02,-747.62 2022.86,-738.34 2026.5,-729.54"/>
<polygon fill="black" stroke="black" points="2029.76,-730.83 2030.34,-720.25 2023.29,-728.15 2029.76,-730.83"/>
</g>
<!-- expert_linear2_3_7&#45;&gt;aggregate_3 -->
<g id="edge351" class="edge">
<title>expert_linear2_3_7&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2086.36,-666.89C2102.63,-657.7 2121.68,-646.94 2140.78,-636.16"/>
<polygon fill="black" stroke="black" points="2142.55,-639.17 2149.54,-631.21 2139.11,-633.08 2142.55,-639.17"/>
</g>
<!-- expert_linear1_3_8 -->
<g id="node262" class="node">
<title>expert_linear1_3_8</title>
<polygon fill="lightgreen" stroke="black" points="2333,-898 2151,-898 2151,-845 2333,-845 2333,-898"/>
<text text-anchor="middle" x="2242" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2242" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2242" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 56</text>
</g>
<!-- route_to_expert_3_8&#45;&gt;expert_linear1_3_8 -->
<g id="edge313" class="edge">
<title>route_to_expert_3_8&#45;&gt;expert_linear1_3_8</title>
<path fill="none" stroke="black" d="M2242,-933.99C2242,-925.58 2242,-916.63 2242,-908.25"/>
<polygon fill="black" stroke="black" points="2245.5,-908.01 2242,-898.01 2238.5,-908.01 2245.5,-908.01"/>
</g>
<!-- expert_activation_3_8 -->
<g id="node263" class="node">
<title>expert_activation_3_8</title>
<polygon fill="lightgreen" stroke="black" points="2333,-809 2151,-809 2151,-756 2333,-756 2333,-809"/>
<text text-anchor="middle" x="2242" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2242" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2242" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 56</text>
</g>
<!-- expert_linear1_3_8&#45;&gt;expert_activation_3_8 -->
<g id="edge314" class="edge">
<title>expert_linear1_3_8&#45;&gt;expert_activation_3_8</title>
<path fill="none" stroke="black" d="M2242,-844.87C2242,-836.89 2242,-827.93 2242,-819.38"/>
<polygon fill="black" stroke="black" points="2245.5,-819.25 2242,-809.25 2238.5,-819.25 2245.5,-819.25"/>
</g>
<!-- expert_linear2_3_8 -->
<g id="node264" class="node">
<title>expert_linear2_3_8</title>
<polygon fill="lightgreen" stroke="black" points="2328.5,-720 2155.5,-720 2155.5,-667 2328.5,-667 2328.5,-720"/>
<text text-anchor="middle" x="2242" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="2242" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2242" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 56</text>
</g>
<!-- expert_activation_3_8&#45;&gt;expert_linear2_3_8 -->
<g id="edge315" class="edge">
<title>expert_activation_3_8&#45;&gt;expert_linear2_3_8</title>
<path fill="none" stroke="black" d="M2242,-755.87C2242,-747.89 2242,-738.93 2242,-730.38"/>
<polygon fill="black" stroke="black" points="2245.5,-730.25 2242,-720.25 2238.5,-730.25 2245.5,-730.25"/>
</g>
<!-- expert_linear2_3_8&#45;&gt;aggregate_3 -->
<g id="edge352" class="edge">
<title>expert_linear2_3_8&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2242,-666.75C2242,-659.05 2242,-650.25 2242,-641.27"/>
<polygon fill="black" stroke="black" points="2245.5,-641.1 2242,-631.1 2238.5,-641.1 2245.5,-641.1"/>
</g>
<!-- expert_linear1_3_9 -->
<g id="node266" class="node">
<title>expert_linear1_3_9</title>
<polygon fill="lightgreen" stroke="black" points="2564,-898 2382,-898 2382,-845 2564,-845 2564,-898"/>
<text text-anchor="middle" x="2473" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2473" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2473" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 57</text>
</g>
<!-- route_to_expert_3_9&#45;&gt;expert_linear1_3_9 -->
<g id="edge317" class="edge">
<title>route_to_expert_3_9&#45;&gt;expert_linear1_3_9</title>
<path fill="none" stroke="black" d="M2493.08,-933.99C2490.27,-925.39 2487.28,-916.24 2484.49,-907.69"/>
<polygon fill="black" stroke="black" points="2487.76,-906.43 2481.33,-898.01 2481.11,-908.6 2487.76,-906.43"/>
</g>
<!-- expert_activation_3_9 -->
<g id="node267" class="node">
<title>expert_activation_3_9</title>
<polygon fill="lightgreen" stroke="black" points="2548,-809 2366,-809 2366,-756 2548,-756 2548,-809"/>
<text text-anchor="middle" x="2457" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="2457" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2457" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 57</text>
</g>
<!-- expert_linear1_3_9&#45;&gt;expert_activation_3_9 -->
<g id="edge318" class="edge">
<title>expert_linear1_3_9&#45;&gt;expert_activation_3_9</title>
<path fill="none" stroke="black" d="M2468.29,-844.87C2466.8,-836.8 2465.14,-827.74 2463.55,-819.1"/>
<polygon fill="black" stroke="black" points="2466.99,-818.45 2461.74,-809.25 2460.1,-819.72 2466.99,-818.45"/>
</g>
<!-- expert_linear2_3_9 -->
<g id="node268" class="node">
<title>expert_linear2_3_9</title>
<polygon fill="lightgreen" stroke="black" points="2531.5,-720 2358.5,-720 2358.5,-667 2531.5,-667 2531.5,-720"/>
<text text-anchor="middle" x="2445" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2445" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2445" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 57</text>
</g>
<!-- expert_activation_3_9&#45;&gt;expert_linear2_3_9 -->
<g id="edge319" class="edge">
<title>expert_activation_3_9&#45;&gt;expert_linear2_3_9</title>
<path fill="none" stroke="black" d="M2453.46,-755.87C2452.36,-747.89 2451.13,-738.93 2449.95,-730.38"/>
<polygon fill="black" stroke="black" points="2453.39,-729.68 2448.55,-720.25 2446.45,-730.63 2453.39,-729.68"/>
</g>
<!-- expert_linear2_3_9&#45;&gt;aggregate_3 -->
<g id="edge353" class="edge">
<title>expert_linear2_3_9&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2399.19,-666.89C2382.76,-657.7 2363.51,-646.94 2344.23,-636.16"/>
<polygon fill="black" stroke="black" points="2345.82,-633.04 2335.38,-631.21 2342.4,-639.15 2345.82,-633.04"/>
</g>
<!-- expert_linear1_3_10 -->
<g id="node270" class="node">
<title>expert_linear1_3_10</title>
<polygon fill="lightgreen" stroke="black" points="2812,-898 2630,-898 2630,-845 2812,-845 2812,-898"/>
<text text-anchor="middle" x="2721" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="2721" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2721" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 58</text>
</g>
<!-- route_to_expert_3_10&#45;&gt;expert_linear1_3_10 -->
<g id="edge321" class="edge">
<title>route_to_expert_3_10&#45;&gt;expert_linear1_3_10</title>
<path fill="none" stroke="black" d="M2750.63,-934.27C2746.41,-925.47 2741.9,-916.07 2737.71,-907.32"/>
<polygon fill="black" stroke="black" points="2740.79,-905.66 2733.31,-898.16 2734.48,-908.69 2740.79,-905.66"/>
</g>
<!-- expert_activation_3_10 -->
<g id="node271" class="node">
<title>expert_activation_3_10</title>
<polygon fill="lightgreen" stroke="black" points="2791,-809 2609,-809 2609,-756 2791,-756 2791,-809"/>
<text text-anchor="middle" x="2700" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="2700" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2700" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 58</text>
</g>
<!-- expert_linear1_3_10&#45;&gt;expert_activation_3_10 -->
<g id="edge322" class="edge">
<title>expert_linear1_3_10&#45;&gt;expert_activation_3_10</title>
<path fill="none" stroke="black" d="M2714.81,-844.87C2712.87,-836.8 2710.68,-827.74 2708.59,-819.1"/>
<polygon fill="black" stroke="black" points="2711.96,-818.15 2706.22,-809.25 2705.16,-819.79 2711.96,-818.15"/>
</g>
<!-- expert_linear2_3_10 -->
<g id="node272" class="node">
<title>expert_linear2_3_10</title>
<polygon fill="lightgreen" stroke="black" points="2764.5,-720 2591.5,-720 2591.5,-667 2764.5,-667 2764.5,-720"/>
<text text-anchor="middle" x="2678" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="2678" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2678" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 58</text>
</g>
<!-- expert_activation_3_10&#45;&gt;expert_linear2_3_10 -->
<g id="edge323" class="edge">
<title>expert_activation_3_10&#45;&gt;expert_linear2_3_10</title>
<path fill="none" stroke="black" d="M2693.52,-755.87C2691.48,-747.8 2689.19,-738.74 2687,-730.1"/>
<polygon fill="black" stroke="black" points="2690.36,-729.09 2684.51,-720.25 2683.57,-730.8 2690.36,-729.09"/>
</g>
<!-- expert_linear2_3_10&#45;&gt;aggregate_3 -->
<g id="edge354" class="edge">
<title>expert_linear2_3_10&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2591.34,-669.94C2551.06,-659.46 2501.25,-646.49 2451.98,-633.66"/>
<polygon fill="black" stroke="black" points="2452.7,-630.23 2442.14,-631.1 2450.93,-637.01 2452.7,-630.23"/>
</g>
<!-- expert_linear1_3_11 -->
<g id="node274" class="node">
<title>expert_linear1_3_11</title>
<polygon fill="lightgreen" stroke="black" points="3067,-898 2885,-898 2885,-845 3067,-845 3067,-898"/>
<text text-anchor="middle" x="2976" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="2976" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2976" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 59</text>
</g>
<!-- route_to_expert_3_11&#45;&gt;expert_linear1_3_11 -->
<g id="edge325" class="edge">
<title>route_to_expert_3_11&#45;&gt;expert_linear1_3_11</title>
<path fill="none" stroke="black" d="M3010.68,-934.27C3005.68,-925.37 3000.34,-915.87 2995.39,-907.05"/>
<polygon fill="black" stroke="black" points="2998.35,-905.16 2990.4,-898.16 2992.25,-908.59 2998.35,-905.16"/>
</g>
<!-- expert_activation_3_11 -->
<g id="node275" class="node">
<title>expert_activation_3_11</title>
<polygon fill="lightgreen" stroke="black" points="3040,-809 2858,-809 2858,-756 3040,-756 3040,-809"/>
<text text-anchor="middle" x="2949" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="2949" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2949" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 59</text>
</g>
<!-- expert_linear1_3_11&#45;&gt;expert_activation_3_11 -->
<g id="edge326" class="edge">
<title>expert_linear1_3_11&#45;&gt;expert_activation_3_11</title>
<path fill="none" stroke="black" d="M2968.05,-844.87C2965.51,-836.71 2962.67,-827.54 2959.96,-818.82"/>
<polygon fill="black" stroke="black" points="2963.3,-817.76 2956.99,-809.25 2956.61,-819.84 2963.3,-817.76"/>
</g>
<!-- expert_linear2_3_11 -->
<g id="node276" class="node">
<title>expert_linear2_3_11</title>
<polygon fill="lightgreen" stroke="black" points="3008.5,-720 2835.5,-720 2835.5,-667 3008.5,-667 3008.5,-720"/>
<text text-anchor="middle" x="2922" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="2922" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2922" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 59</text>
</g>
<!-- expert_activation_3_11&#45;&gt;expert_linear2_3_11 -->
<g id="edge327" class="edge">
<title>expert_activation_3_11&#45;&gt;expert_linear2_3_11</title>
<path fill="none" stroke="black" d="M2941.05,-755.87C2938.51,-747.71 2935.67,-738.54 2932.96,-729.82"/>
<polygon fill="black" stroke="black" points="2936.3,-728.76 2929.99,-720.25 2929.61,-730.84 2936.3,-728.76"/>
</g>
<!-- expert_linear2_3_11&#45;&gt;aggregate_3 -->
<g id="edge355" class="edge">
<title>expert_linear2_3_11&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2835.15,-677.44C2815.07,-673.98 2793.8,-670.34 2774,-667 2667.02,-648.94 2547.87,-629.19 2449.49,-612.99"/>
<polygon fill="black" stroke="black" points="2449.87,-609.51 2439.43,-611.33 2448.73,-616.41 2449.87,-609.51"/>
</g>
<!-- expert_linear1_3_12 -->
<g id="node278" class="node">
<title>expert_linear1_3_12</title>
<polygon fill="lightgreen" stroke="black" points="3326,-898 3144,-898 3144,-845 3326,-845 3326,-898"/>
<text text-anchor="middle" x="3235" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3235" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3235" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 60</text>
</g>
<!-- route_to_expert_3_12&#45;&gt;expert_linear1_3_12 -->
<g id="edge329" class="edge">
<title>route_to_expert_3_12&#45;&gt;expert_linear1_3_12</title>
<path fill="none" stroke="black" d="M3272.37,-934.55C3266.89,-925.46 3261.02,-915.72 3255.6,-906.71"/>
<polygon fill="black" stroke="black" points="3258.51,-904.76 3250.36,-898 3252.52,-908.37 3258.51,-904.76"/>
</g>
<!-- expert_activation_3_12 -->
<g id="node279" class="node">
<title>expert_activation_3_12</title>
<polygon fill="lightgreen" stroke="black" points="3297,-809 3115,-809 3115,-756 3297,-756 3297,-809"/>
<text text-anchor="middle" x="3206" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3206" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3206" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 60</text>
</g>
<!-- expert_linear1_3_12&#45;&gt;expert_activation_3_12 -->
<g id="edge330" class="edge">
<title>expert_linear1_3_12&#45;&gt;expert_activation_3_12</title>
<path fill="none" stroke="black" d="M3226.46,-844.87C3223.74,-836.71 3220.68,-827.54 3217.77,-818.82"/>
<polygon fill="black" stroke="black" points="3221.07,-817.63 3214.58,-809.25 3214.43,-819.84 3221.07,-817.63"/>
</g>
<!-- expert_linear2_3_12 -->
<g id="node280" class="node">
<title>expert_linear2_3_12</title>
<polygon fill="lightgreen" stroke="black" points="3260.5,-720 3087.5,-720 3087.5,-667 3260.5,-667 3260.5,-720"/>
<text text-anchor="middle" x="3174" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="3174" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3174" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 60</text>
</g>
<!-- expert_activation_3_12&#45;&gt;expert_linear2_3_12 -->
<g id="edge331" class="edge">
<title>expert_activation_3_12&#45;&gt;expert_linear2_3_12</title>
<path fill="none" stroke="black" d="M3196.57,-755.87C3193.57,-747.71 3190.2,-738.54 3186.99,-729.82"/>
<polygon fill="black" stroke="black" points="3190.21,-728.43 3183.47,-720.25 3183.64,-730.84 3190.21,-728.43"/>
</g>
<!-- expert_linear2_3_12&#45;&gt;aggregate_3 -->
<g id="edge356" class="edge">
<title>expert_linear2_3_12&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3087.47,-677.58C3064.89,-673.9 3040.56,-670.12 3018,-667 2821.2,-639.77 2595.45,-614.88 2438.37,-598.58"/>
<polygon fill="black" stroke="black" points="2438.43,-595.06 2428.12,-597.51 2437.71,-602.03 2438.43,-595.06"/>
</g>
<!-- expert_linear1_3_13 -->
<g id="node282" class="node">
<title>expert_linear1_3_13</title>
<polygon fill="lightgreen" stroke="black" points="3587,-898 3405,-898 3405,-845 3587,-845 3587,-898"/>
<text text-anchor="middle" x="3496" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="3496" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3496" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 61</text>
</g>
<!-- route_to_expert_3_13&#45;&gt;expert_linear1_3_13 -->
<g id="edge333" class="edge">
<title>route_to_expert_3_13&#45;&gt;expert_linear1_3_13</title>
<path fill="none" stroke="black" d="M3534.63,-934.55C3528.97,-925.46 3522.91,-915.72 3517.3,-906.71"/>
<polygon fill="black" stroke="black" points="3520.13,-904.64 3511.88,-898 3514.19,-908.34 3520.13,-904.64"/>
</g>
<!-- expert_activation_3_13 -->
<g id="node283" class="node">
<title>expert_activation_3_13</title>
<polygon fill="lightgreen" stroke="black" points="3557,-809 3375,-809 3375,-756 3557,-756 3557,-809"/>
<text text-anchor="middle" x="3466" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="3466" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3466" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 61</text>
</g>
<!-- expert_linear1_3_13&#45;&gt;expert_activation_3_13 -->
<g id="edge334" class="edge">
<title>expert_linear1_3_13&#45;&gt;expert_activation_3_13</title>
<path fill="none" stroke="black" d="M3487.16,-844.87C3484.35,-836.71 3481.19,-827.54 3478.18,-818.82"/>
<polygon fill="black" stroke="black" points="3481.45,-817.56 3474.88,-809.25 3474.83,-819.84 3481.45,-817.56"/>
</g>
<!-- expert_linear2_3_13 -->
<g id="node284" class="node">
<title>expert_linear2_3_13</title>
<polygon fill="lightgreen" stroke="black" points="3516.5,-720 3343.5,-720 3343.5,-667 3516.5,-667 3516.5,-720"/>
<text text-anchor="middle" x="3430" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="3430" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3430" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 61</text>
</g>
<!-- expert_activation_3_13&#45;&gt;expert_linear2_3_13 -->
<g id="edge335" class="edge">
<title>expert_activation_3_13&#45;&gt;expert_linear2_3_13</title>
<path fill="none" stroke="black" d="M3455.39,-755.87C3451.98,-747.62 3448.14,-738.34 3444.5,-729.54"/>
<polygon fill="black" stroke="black" points="3447.71,-728.15 3440.66,-720.25 3441.24,-730.83 3447.71,-728.15"/>
</g>
<!-- expert_linear2_3_13&#45;&gt;aggregate_3 -->
<g id="edge357" class="edge">
<title>expert_linear2_3_13&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3343.39,-677.52C3319.65,-673.73 3293.87,-669.92 3270,-667 2978.73,-631.37 2639.28,-605.31 2432.59,-591.15"/>
<polygon fill="black" stroke="black" points="2432.76,-587.66 2422.54,-590.47 2432.28,-594.64 2432.76,-587.66"/>
</g>
<!-- expert_linear1_3_14 -->
<g id="node286" class="node">
<title>expert_linear1_3_14</title>
<polygon fill="lightgreen" stroke="black" points="3849,-898 3667,-898 3667,-845 3849,-845 3849,-898"/>
<text text-anchor="middle" x="3758" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="3758" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3758" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 62</text>
</g>
<!-- route_to_expert_3_14&#45;&gt;expert_linear1_3_14 -->
<g id="edge337" class="edge">
<title>route_to_expert_3_14&#45;&gt;expert_linear1_3_14</title>
<path fill="none" stroke="black" d="M3797.27,-934.55C3791.51,-925.46 3785.35,-915.72 3779.65,-906.71"/>
<polygon fill="black" stroke="black" points="3782.44,-904.58 3774.14,-898 3776.53,-908.32 3782.44,-904.58"/>
</g>
<!-- expert_activation_3_14 -->
<g id="node287" class="node">
<title>expert_activation_3_14</title>
<polygon fill="lightgreen" stroke="black" points="3818,-809 3636,-809 3636,-756 3818,-756 3818,-809"/>
<text text-anchor="middle" x="3727" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="3727" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3727" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 62</text>
</g>
<!-- expert_linear1_3_14&#45;&gt;expert_activation_3_14 -->
<g id="edge338" class="edge">
<title>expert_linear1_3_14&#45;&gt;expert_activation_3_14</title>
<path fill="none" stroke="black" d="M3748.87,-844.87C3745.96,-836.71 3742.69,-827.54 3739.59,-818.82"/>
<polygon fill="black" stroke="black" points="3742.83,-817.49 3736.18,-809.25 3736.23,-819.84 3742.83,-817.49"/>
</g>
<!-- expert_linear2_3_14 -->
<g id="node288" class="node">
<title>expert_linear2_3_14</title>
<polygon fill="lightgreen" stroke="black" points="3775.5,-720 3602.5,-720 3602.5,-667 3775.5,-667 3775.5,-720"/>
<text text-anchor="middle" x="3689" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="3689" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3689" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 62</text>
</g>
<!-- expert_activation_3_14&#45;&gt;expert_linear2_3_14 -->
<g id="edge339" class="edge">
<title>expert_activation_3_14&#45;&gt;expert_linear2_3_14</title>
<path fill="none" stroke="black" d="M3715.8,-755.87C3712.2,-747.62 3708.15,-738.34 3704.3,-729.54"/>
<polygon fill="black" stroke="black" points="3707.46,-728.01 3700.25,-720.25 3701.04,-730.81 3707.46,-728.01"/>
</g>
<!-- expert_linear2_3_14&#45;&gt;aggregate_3 -->
<g id="edge358" class="edge">
<title>expert_linear2_3_14&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3602.48,-677.54C3577.83,-673.66 3550.91,-669.8 3526,-667 3137.26,-623.35 2679.71,-598.25 2429.27,-586.74"/>
<polygon fill="black" stroke="black" points="2429.13,-583.23 2418.98,-586.27 2428.81,-590.22 2429.13,-583.23"/>
</g>
<!-- expert_linear1_3_15 -->
<g id="node290" class="node">
<title>expert_linear1_3_15</title>
<polygon fill="lightgreen" stroke="black" points="4112,-898 3930,-898 3930,-845 4112,-845 4112,-898"/>
<text text-anchor="middle" x="4021" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4021" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4021" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 63</text>
</g>
<!-- route_to_expert_3_15&#45;&gt;expert_linear1_3_15 -->
<g id="edge341" class="edge">
<title>route_to_expert_3_15&#45;&gt;expert_linear1_3_15</title>
<path fill="none" stroke="black" d="M4060.27,-934.55C4054.51,-925.46 4048.35,-915.72 4042.65,-906.71"/>
<polygon fill="black" stroke="black" points="4045.44,-904.58 4037.14,-898 4039.53,-908.32 4045.44,-904.58"/>
</g>
<!-- expert_activation_3_15 -->
<g id="node291" class="node">
<title>expert_activation_3_15</title>
<polygon fill="lightgreen" stroke="black" points="4081,-809 3899,-809 3899,-756 4081,-756 4081,-809"/>
<text text-anchor="middle" x="3990" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="3990" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3990" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 63</text>
</g>
<!-- expert_linear1_3_15&#45;&gt;expert_activation_3_15 -->
<g id="edge342" class="edge">
<title>expert_linear1_3_15&#45;&gt;expert_activation_3_15</title>
<path fill="none" stroke="black" d="M4011.87,-844.87C4008.96,-836.71 4005.69,-827.54 4002.59,-818.82"/>
<polygon fill="black" stroke="black" points="4005.83,-817.49 3999.18,-809.25 3999.23,-819.84 4005.83,-817.49"/>
</g>
<!-- expert_linear2_3_15 -->
<g id="node292" class="node">
<title>expert_linear2_3_15</title>
<polygon fill="lightgreen" stroke="black" points="4006.5,-720 3833.5,-720 3833.5,-667 4006.5,-667 4006.5,-720"/>
<text text-anchor="middle" x="3920" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="3920" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3920" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 63</text>
</g>
<!-- expert_activation_3_15&#45;&gt;expert_linear2_3_15 -->
<g id="edge343" class="edge">
<title>expert_activation_3_15&#45;&gt;expert_linear2_3_15</title>
<path fill="none" stroke="black" d="M3969.38,-755.87C3962.39,-747.18 3954.48,-737.35 3947.07,-728.14"/>
<polygon fill="black" stroke="black" points="3949.71,-725.85 3940.72,-720.25 3944.26,-730.24 3949.71,-725.85"/>
</g>
<!-- expert_linear2_3_15&#45;&gt;aggregate_3 -->
<g id="edge359" class="edge">
<title>expert_linear2_3_15&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3833.48,-674.44C3817.42,-671.57 3800.74,-668.93 3785,-667 3296.09,-607.14 2714.94,-587.88 2425.23,-581.77"/>
<polygon fill="black" stroke="black" points="2425.12,-578.27 2415.05,-581.56 2424.97,-585.27 2425.12,-578.27"/>
</g>
<!-- aggregate_3&#45;&gt;moe_residual_3 -->
<g id="edge361" class="edge">
<title>aggregate_3&#45;&gt;moe_residual_3</title>
<path fill="none" stroke="black" d="M2392.05,-553.61C2560.61,-527.33 2832.17,-484.99 2997.55,-459.21"/>
<polygon fill="black" stroke="black" points="2998.45,-462.61 3007.8,-457.61 2997.38,-455.69 2998.45,-462.61"/>
</g>
<!-- ln2_3 -->
<g id="node295" class="node">
<title>ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="3229.5,-347 3050.5,-347 3050.5,-294 3229.5,-294 3229.5,-347"/>
<text text-anchor="middle" x="3140" y="-331.8" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="3140" y="-316.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3140" y="-301.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- moe_residual_3&#45;&gt;ln2_3 -->
<g id="edge362" class="edge">
<title>moe_residual_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M3140,-382.9C3140,-374.23 3140,-365.41 3140,-357.27"/>
<polygon fill="black" stroke="black" points="3143.5,-357.01 3140,-347.01 3136.5,-357.01 3143.5,-357.01"/>
</g>
<!-- final_norm -->
<g id="node296" class="node">
<title>final_norm</title>
<polygon fill="lightgreen" stroke="black" points="3229.5,-247 3050.5,-247 3050.5,-194 3229.5,-194 3229.5,-247"/>
<text text-anchor="middle" x="3140" y="-231.8" font-family="Times,serif" font-size="14.00">Final Layer Norm</text>
<text text-anchor="middle" x="3140" y="-216.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="3140" y="-201.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- ln2_3&#45;&gt;final_norm -->
<g id="edge363" class="edge">
<title>ln2_3&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M3140,-293.75C3140,-282.61 3140,-269.38 3140,-257.31"/>
<polygon fill="black" stroke="black" points="3143.5,-257.08 3140,-247.08 3136.5,-257.08 3143.5,-257.08"/>
</g>
<!-- output_linear -->
<g id="node297" class="node">
<title>output_linear</title>
<polygon fill="lightgreen" stroke="black" points="3249.5,-158 3030.5,-158 3030.5,-105 3249.5,-105 3249.5,-158"/>
<text text-anchor="middle" x="3140" y="-142.8" font-family="Times,serif" font-size="14.00">Output Linear</text>
<text text-anchor="middle" x="3140" y="-127.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, vocab_size)</text>
<text text-anchor="middle" x="3140" y="-112.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- final_norm&#45;&gt;output_linear -->
<g id="edge364" class="edge">
<title>final_norm&#45;&gt;output_linear</title>
<path fill="none" stroke="black" d="M3140,-193.87C3140,-185.89 3140,-176.93 3140,-168.38"/>
<polygon fill="black" stroke="black" points="3143.5,-168.25 3140,-158.25 3136.5,-168.25 3143.5,-168.25"/>
</g>
<!-- softmax -->
<g id="node298" class="node">
<title>softmax</title>
<polygon fill="lightgreen" stroke="black" points="3249.5,-69 3030.5,-69 3030.5,-16 3249.5,-16 3249.5,-69"/>
<text text-anchor="middle" x="3140" y="-53.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="3140" y="-38.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, vocab_size)</text>
<text text-anchor="middle" x="3140" y="-23.8" font-family="Times,serif" font-size="14.00">GPU: all GPUs</text>
</g>
<!-- output_linear&#45;&gt;softmax -->
<g id="edge365" class="edge">
<title>output_linear&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M3140,-104.87C3140,-96.89 3140,-87.93 3140,-79.38"/>
<polygon fill="black" stroke="black" points="3143.5,-79.25 3140,-69.25 3136.5,-79.25 3143.5,-79.25"/>
</g>
</g>
</svg>
