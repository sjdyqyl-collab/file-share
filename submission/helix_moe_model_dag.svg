<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Helix_MoE_Model_DAG Pages: 1 -->
<svg width="2520pt" height="504pt"
 viewBox="0.00 0.00 2520.00 504.15" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 3774.75)">
<title>Helix_MoE_Model_DAG</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3774.75 18884,-3774.75 18884,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="black" d="M20,-2491.36C20,-2491.36 9402,-2491.36 9402,-2491.36 9408,-2491.36 9414,-2497.36 9414,-2503.36 9414,-2503.36 9414,-3689.32 9414,-3689.32 9414,-3695.32 9408,-3701.32 9402,-3701.32 9402,-3701.32 20,-3701.32 20,-3701.32 14,-3701.32 8,-3695.32 8,-3689.32 8,-3689.32 8,-2503.36 8,-2503.36 8,-2497.36 14,-2491.36 20,-2491.36"/>
<text text-anchor="middle" x="4711" y="-3686.12" font-family="Times,serif" font-size="14.00">Layer 1 (MoE)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="black" d="M9466,-2491.36C9466,-2491.36 18848,-2491.36 18848,-2491.36 18854,-2491.36 18860,-2497.36 18860,-2503.36 18860,-2503.36 18860,-3683.82 18860,-3683.82 18860,-3689.82 18854,-3695.82 18848,-3695.82 18848,-3695.82 9466,-3695.82 9466,-3695.82 9460,-3695.82 9454,-3689.82 9454,-3683.82 9454,-3683.82 9454,-2503.36 9454,-2503.36 9454,-2497.36 9460,-2491.36 9466,-2491.36"/>
<text text-anchor="middle" x="14157" y="-3680.62" font-family="Times,serif" font-size="14.00">Layer 2 (MoE)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="black" d="M8945,-1281.39C8945,-1281.39 18327,-1281.39 18327,-1281.39 18333,-1281.39 18339,-1287.39 18339,-1293.39 18339,-1293.39 18339,-2460.36 18339,-2460.36 18339,-2466.36 18333,-2472.36 18327,-2472.36 18327,-2472.36 8945,-2472.36 8945,-2472.36 8939,-2472.36 8933,-2466.36 8933,-2460.36 8933,-2460.36 8933,-1293.39 8933,-1293.39 8933,-1287.39 8939,-1281.39 8945,-1281.39"/>
<text text-anchor="middle" x="13636" y="-2457.16" font-family="Times,serif" font-size="14.00">Layer 3 (MoE)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer4</title>
<path fill="none" stroke="black" d="M9424,-71.43C9424,-71.43 18806,-71.43 18806,-71.43 18812,-71.43 18818,-77.43 18818,-83.43 18818,-83.43 18818,-1250.39 18818,-1250.39 18818,-1256.39 18812,-1262.39 18806,-1262.39 18806,-1262.39 9424,-1262.39 9424,-1262.39 9418,-1262.39 9412,-1256.39 9412,-1250.39 9412,-1250.39 9412,-83.43 9412,-83.43 9412,-77.43 9418,-71.43 9424,-71.43"/>
<text text-anchor="middle" x="14115" y="-1247.19" font-family="Times,serif" font-size="14.00">Layer 4 (MoE)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="9422" cy="-3749.54" rx="85.62" ry="21.43"/>
<text text-anchor="middle" x="9422" y="-3752.54" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="9422" y="-3741.54" font-family="Arial" font-size="10.00">X: [B=1024, L, D=8192]</text>
</g>
<!-- ln1 -->
<g id="node2" class="node">
<title>ln1</title>
<polygon fill="lightgreen" stroke="black" points="4862.5,-3670.32 4755.5,-3670.32 4755.5,-3618.32 4862.5,-3618.32 4862.5,-3670.32"/>
<text text-anchor="middle" x="4809" y="-3658.32" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="4809" y="-3647.32" font-family="Arial" font-size="10.00">X: [B=1024, L, 8192]</text>
<text text-anchor="middle" x="4809" y="-3636.32" font-family="Arial" font-size="10.00">→ [B=1024, L, 8192]</text>
<text text-anchor="middle" x="4809" y="-3625.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- input&#45;&gt;ln1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;ln1</title>
<path fill="none" stroke="black" d="M9337,-3746.63C8756.2,-3733.64 5380.64,-3658.11 4872.93,-3646.75"/>
<polygon fill="black" stroke="black" points="4872.93,-3643.25 4862.85,-3646.53 4872.77,-3650.25 4872.93,-3643.25"/>
</g>
<!-- res1 -->
<g id="node73" class="node">
<title>res1</title>
<ellipse fill="lightgreen" stroke="black" cx="8478" cy="-3058.33" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="8478" y="-3066.83" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8478" y="-3055.83" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8478" y="-3044.83" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- input&#45;&gt;res1 -->
<g id="edge128" class="edge">
<title>input&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M9425.8,-3728.06C9429.31,-3707.29 9434,-3674.19 9434,-3645.32 9434,-3645.32 9434,-3645.32 9434,-3143.82 9434,-3103.29 8881.46,-3075.55 8616.51,-3064.58"/>
<polygon fill="black" stroke="black" points="8616.57,-3061.08 8606.43,-3064.17 8616.28,-3068.08 8616.57,-3061.08"/>
</g>
<!-- q_proj_0_0 -->
<g id="node3" class="node">
<title>q_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1566,-3581.32 1388,-3581.32 1388,-3540.32 1566,-3540.32 1566,-3581.32"/>
<text text-anchor="middle" x="1477" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1477" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1477" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_0 -->
<g id="edge10" class="edge">
<title>ln1&#45;&gt;q_proj_0_0</title>
<path fill="none" stroke="black" d="M4755.43,-3643.09C4471.28,-3641.73 3111.53,-3633.67 2000,-3600.32 1814.24,-3594.75 1764.4,-3603.74 1576.06,-3581.35"/>
<polygon fill="black" stroke="black" points="1576.45,-3577.87 1566.11,-3580.15 1575.62,-3584.82 1576.45,-3577.87"/>
</g>
<!-- k_proj_0_0 -->
<g id="node4" class="node">
<title>k_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1762,-3581.32 1584,-3581.32 1584,-3540.32 1762,-3540.32 1762,-3581.32"/>
<text text-anchor="middle" x="1673" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="1673" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1673" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_0 -->
<g id="edge11" class="edge">
<title>ln1&#45;&gt;k_proj_0_0</title>
<path fill="none" stroke="black" d="M4755.49,-3643.52C4402.57,-3644.62 2404.1,-3647.84 1772.21,-3581.33"/>
<polygon fill="black" stroke="black" points="1772.41,-3577.83 1762.09,-3580.24 1771.67,-3584.79 1772.41,-3577.83"/>
</g>
<!-- v_proj_0_0 -->
<g id="node5" class="node">
<title>v_proj_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1370,-3581.32 1192,-3581.32 1192,-3540.32 1370,-3540.32 1370,-3581.32"/>
<text text-anchor="middle" x="1281" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="1281" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1281" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_0 -->
<g id="edge12" class="edge">
<title>ln1&#45;&gt;v_proj_0_0</title>
<path fill="none" stroke="black" d="M4755.2,-3642.86C4468.38,-3640.31 3089.97,-3627.17 1963,-3600.32 1706.68,-3594.22 1638.71,-3610.56 1380.17,-3581.35"/>
<polygon fill="black" stroke="black" points="1380.43,-3577.85 1370.1,-3580.2 1379.64,-3584.81 1380.43,-3577.85"/>
</g>
<!-- q_proj_0_1 -->
<g id="node7" class="node">
<title>q_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="978,-3581.32 800,-3581.32 800,-3540.32 978,-3540.32 978,-3581.32"/>
<text text-anchor="middle" x="889" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="889" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="889" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_1 -->
<g id="edge17" class="edge">
<title>ln1&#45;&gt;q_proj_0_1</title>
<path fill="none" stroke="black" d="M4755.28,-3642.96C4447.73,-3640.8 2878.92,-3628.81 1598,-3600.32 1329.7,-3594.36 1258.66,-3611.73 988.22,-3581.35"/>
<polygon fill="black" stroke="black" points="988.43,-3577.85 978.1,-3580.2 987.64,-3584.81 988.43,-3577.85"/>
</g>
<!-- k_proj_0_1 -->
<g id="node8" class="node">
<title>k_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1174,-3581.32 996,-3581.32 996,-3540.32 1174,-3540.32 1174,-3581.32"/>
<text text-anchor="middle" x="1085" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="1085" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1085" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_1 -->
<g id="edge18" class="edge">
<title>ln1&#45;&gt;k_proj_0_1</title>
<path fill="none" stroke="black" d="M4755.18,-3643.16C4449.55,-3642.13 2901.16,-3635.34 1637,-3600.32 1438.38,-3594.82 1385.23,-3604.99 1184.11,-3581.35"/>
<polygon fill="black" stroke="black" points="1184.45,-3577.86 1174.1,-3580.16 1183.62,-3584.82 1184.45,-3577.86"/>
</g>
<!-- v_proj_0_1 -->
<g id="node9" class="node">
<title>v_proj_0_1</title>
<polygon fill="lightgreen" stroke="black" points="782,-3581.32 604,-3581.32 604,-3540.32 782,-3540.32 782,-3581.32"/>
<text text-anchor="middle" x="693" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="693" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="693" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_1 -->
<g id="edge19" class="edge">
<title>ln1&#45;&gt;v_proj_0_1</title>
<path fill="none" stroke="black" d="M4755.31,-3643.32C4427.63,-3643.17 2663.43,-3640.43 1225,-3600.32 1035.3,-3595.03 984.41,-3604.13 792.26,-3581.37"/>
<polygon fill="black" stroke="black" points="792.45,-3577.87 782.11,-3580.15 791.62,-3584.82 792.45,-3577.87"/>
</g>
<!-- q_proj_0_2 -->
<g id="node11" class="node">
<title>q_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1958,-3581.32 1780,-3581.32 1780,-3540.32 1958,-3540.32 1958,-3581.32"/>
<text text-anchor="middle" x="1869" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="1869" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1869" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_2 -->
<g id="edge24" class="edge">
<title>ln1&#45;&gt;q_proj_0_2</title>
<path fill="none" stroke="black" d="M4755.36,-3641.75C4544.23,-3635.62 3749.97,-3612.93 3096,-3599.32 2848.32,-3594.17 2232.41,-3607.57 1968.11,-3581.29"/>
<polygon fill="black" stroke="black" points="1968.4,-3577.8 1958.09,-3580.26 1967.68,-3584.77 1968.4,-3577.8"/>
</g>
<!-- k_proj_0_2 -->
<g id="node12" class="node">
<title>k_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="2154,-3581.32 1976,-3581.32 1976,-3540.32 2154,-3540.32 2154,-3581.32"/>
<text text-anchor="middle" x="2065" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2065" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2065" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_2 -->
<g id="edge25" class="edge">
<title>ln1&#45;&gt;k_proj_0_2</title>
<path fill="none" stroke="black" d="M4755.34,-3639.99C4615.55,-3631.46 4228.6,-3608.84 3906,-3599.32 3715.43,-3593.7 2397.76,-3601.07 2164.38,-3581.25"/>
<polygon fill="black" stroke="black" points="2164.37,-3577.73 2154.09,-3580.28 2163.72,-3584.7 2164.37,-3577.73"/>
</g>
<!-- v_proj_0_2 -->
<g id="node13" class="node">
<title>v_proj_0_2</title>
<polygon fill="lightgreen" stroke="black" points="2350,-3581.32 2172,-3581.32 2172,-3540.32 2350,-3540.32 2350,-3581.32"/>
<text text-anchor="middle" x="2261" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="2261" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2261" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_2 -->
<g id="edge26" class="edge">
<title>ln1&#45;&gt;v_proj_0_2</title>
<path fill="none" stroke="black" d="M4755.37,-3637.14C4664.78,-3627 4475.6,-3607.2 4315,-3599.32 4100.99,-3588.82 2618.06,-3603.21 2360.43,-3581.25"/>
<polygon fill="black" stroke="black" points="2360.37,-3577.73 2350.09,-3580.29 2359.72,-3584.7 2360.37,-3577.73"/>
</g>
<!-- q_proj_0_3 -->
<g id="node15" class="node">
<title>q_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="194,-3581.32 16,-3581.32 16,-3540.32 194,-3540.32 194,-3581.32"/>
<text text-anchor="middle" x="105" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="105" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="105" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1&#45;&gt;q_proj_0_3 -->
<g id="edge31" class="edge">
<title>ln1&#45;&gt;q_proj_0_3</title>
<path fill="none" stroke="black" d="M4755.41,-3643.17C4406.64,-3642.06 2422.99,-3634.42 807,-3600.32 541.76,-3594.73 471.54,-3611.44 204.11,-3581.34"/>
<polygon fill="black" stroke="black" points="204.43,-3577.85 194.1,-3580.2 203.64,-3584.81 204.43,-3577.85"/>
</g>
<!-- k_proj_0_3 -->
<g id="node16" class="node">
<title>k_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="390,-3581.32 212,-3581.32 212,-3540.32 390,-3540.32 390,-3581.32"/>
<text text-anchor="middle" x="301" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="301" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="301" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1&#45;&gt;k_proj_0_3 -->
<g id="edge32" class="edge">
<title>ln1&#45;&gt;k_proj_0_3</title>
<path fill="none" stroke="black" d="M4755.37,-3643.38C4408.41,-3643.62 2445.17,-3642.97 846,-3600.32 650.52,-3595.11 598.16,-3604.69 400.25,-3581.37"/>
<polygon fill="black" stroke="black" points="400.45,-3577.87 390.1,-3580.16 399.62,-3584.82 400.45,-3577.87"/>
</g>
<!-- v_proj_0_3 -->
<g id="node17" class="node">
<title>v_proj_0_3</title>
<polygon fill="lightgreen" stroke="black" points="586,-3581.32 408,-3581.32 408,-3540.32 586,-3540.32 586,-3581.32"/>
<text text-anchor="middle" x="497" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="497" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="497" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1&#45;&gt;v_proj_0_3 -->
<g id="edge33" class="edge">
<title>ln1&#45;&gt;v_proj_0_3</title>
<path fill="none" stroke="black" d="M4755.29,-3643.09C4425.56,-3641.6 2641.68,-3632.3 1187,-3600.32 927.16,-3594.61 858.27,-3610.91 596.3,-3581.36"/>
<polygon fill="black" stroke="black" points="596.43,-3577.85 586.1,-3580.2 595.64,-3584.81 596.43,-3577.85"/>
</g>
<!-- q_proj_1_0 -->
<g id="node19" class="node">
<title>q_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="4310,-3581.32 4132,-3581.32 4132,-3540.32 4310,-3540.32 4310,-3581.32"/>
<text text-anchor="middle" x="4221" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="4221" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4221" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_0 -->
<g id="edge38" class="edge">
<title>ln1&#45;&gt;q_proj_1_0</title>
<path fill="none" stroke="black" d="M4799.55,-3617.9C4795.57,-3610.66 4790.16,-3603.6 4783,-3599.32 4740.73,-3574.1 4403.38,-3586.13 4320.27,-3581.03"/>
<polygon fill="black" stroke="black" points="4320.36,-3577.53 4310.1,-3580.17 4319.77,-3584.5 4320.36,-3577.53"/>
</g>
<!-- k_proj_1_0 -->
<g id="node20" class="node">
<title>k_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="4506,-3581.32 4328,-3581.32 4328,-3540.32 4506,-3540.32 4506,-3581.32"/>
<text text-anchor="middle" x="4417" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="4417" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4417" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_0 -->
<g id="edge39" class="edge">
<title>ln1&#45;&gt;k_proj_1_0</title>
<path fill="none" stroke="black" d="M4803.48,-3618.18C4800.65,-3610.96 4796.39,-3603.83 4790,-3599.32 4766.64,-3582.85 4573.67,-3584.93 4516.21,-3581.01"/>
<polygon fill="black" stroke="black" points="4516.4,-3577.51 4506.12,-3580.07 4515.75,-3584.48 4516.4,-3577.51"/>
</g>
<!-- v_proj_1_0 -->
<g id="node21" class="node">
<title>v_proj_1_0</title>
<polygon fill="lightgreen" stroke="black" points="4702,-3581.32 4524,-3581.32 4524,-3540.32 4702,-3540.32 4702,-3581.32"/>
<text text-anchor="middle" x="4613" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4613" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4613" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_0 -->
<g id="edge40" class="edge">
<title>ln1&#45;&gt;v_proj_1_0</title>
<path fill="none" stroke="black" d="M4806.97,-3617.96C4805.23,-3611.08 4802.2,-3604.19 4797,-3599.32 4796.55,-3598.9 4755.36,-3590.49 4712.07,-3581.74"/>
<polygon fill="black" stroke="black" points="4712.72,-3578.3 4702.22,-3579.75 4711.33,-3585.16 4712.72,-3578.3"/>
</g>
<!-- q_proj_1_1 -->
<g id="node23" class="node">
<title>q_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2546,-3581.32 2368,-3581.32 2368,-3540.32 2546,-3540.32 2546,-3581.32"/>
<text text-anchor="middle" x="2457" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="2457" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2457" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_1 -->
<g id="edge45" class="edge">
<title>ln1&#45;&gt;q_proj_1_1</title>
<path fill="none" stroke="black" d="M4755.24,-3632.69C4697.96,-3621.92 4604.49,-3605.93 4523,-3599.32 4090.38,-3564.25 3006.61,-3625.26 2556.28,-3581.31"/>
<polygon fill="black" stroke="black" points="2556.39,-3577.8 2546.09,-3580.29 2555.69,-3584.77 2556.39,-3577.8"/>
</g>
<!-- k_proj_1_1 -->
<g id="node24" class="node">
<title>k_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2742,-3581.32 2564,-3581.32 2564,-3540.32 2742,-3540.32 2742,-3581.32"/>
<text text-anchor="middle" x="2653" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="2653" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2653" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_1 -->
<g id="edge46" class="edge">
<title>ln1&#45;&gt;k_proj_1_1</title>
<path fill="none" stroke="black" d="M4755.17,-3626.63C4719.95,-3616.57 4672.7,-3604.7 4630,-3599.32 4425.88,-3573.61 3001.31,-3601.94 2752.4,-3581.24"/>
<polygon fill="black" stroke="black" points="2752.37,-3577.72 2742.09,-3580.28 2751.72,-3584.69 2752.37,-3577.72"/>
</g>
<!-- v_proj_1_1 -->
<g id="node25" class="node">
<title>v_proj_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2938,-3581.32 2760,-3581.32 2760,-3540.32 2938,-3540.32 2938,-3581.32"/>
<text text-anchor="middle" x="2849" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="2849" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2849" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_1 -->
<g id="edge47" class="edge">
<title>ln1&#45;&gt;v_proj_1_1</title>
<path fill="none" stroke="black" d="M4755.42,-3619.6C4734.5,-3611.51 4710.05,-3603.47 4687,-3599.32 4499.69,-3565.58 3181.45,-3600.16 2948.36,-3581.22"/>
<polygon fill="black" stroke="black" points="2948.37,-3577.71 2938.09,-3580.28 2947.73,-3584.68 2948.37,-3577.71"/>
</g>
<!-- q_proj_1_2 -->
<g id="node27" class="node">
<title>q_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3134,-3581.32 2956,-3581.32 2956,-3540.32 3134,-3540.32 3134,-3581.32"/>
<text text-anchor="middle" x="3045" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3045" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3045" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_2 -->
<g id="edge52" class="edge">
<title>ln1&#45;&gt;q_proj_1_2</title>
<path fill="none" stroke="black" d="M4767.42,-3618.23C4752.66,-3610.63 4735.58,-3603.26 4719,-3599.32 4636.05,-3579.63 3303.2,-3589.83 3144.36,-3581.03"/>
<polygon fill="black" stroke="black" points="3144.32,-3577.52 3134.09,-3580.28 3143.81,-3584.5 3144.32,-3577.52"/>
</g>
<!-- k_proj_1_2 -->
<g id="node28" class="node">
<title>k_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3330,-3581.32 3152,-3581.32 3152,-3540.32 3330,-3540.32 3330,-3581.32"/>
<text text-anchor="middle" x="3241" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3241" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3241" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_2 -->
<g id="edge53" class="edge">
<title>ln1&#45;&gt;k_proj_1_2</title>
<path fill="none" stroke="black" d="M4777.34,-3618.28C4765.91,-3610.69 4752.49,-3603.31 4739,-3599.32 4666.51,-3577.93 3486.11,-3588.79 3340.16,-3581"/>
<polygon fill="black" stroke="black" points="3340.32,-3577.5 3330.09,-3580.27 3339.81,-3584.48 3340.32,-3577.5"/>
</g>
<!-- v_proj_1_2 -->
<g id="node29" class="node">
<title>v_proj_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3526,-3581.32 3348,-3581.32 3348,-3540.32 3526,-3540.32 3526,-3581.32"/>
<text text-anchor="middle" x="3437" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="3437" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3437" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_2 -->
<g id="edge54" class="edge">
<title>ln1&#45;&gt;v_proj_1_2</title>
<path fill="none" stroke="black" d="M4783.6,-3618.12C4774.4,-3610.61 4763.45,-3603.32 4752,-3599.32 4690.16,-3577.72 3669.11,-3587.77 3536.13,-3580.98"/>
<polygon fill="black" stroke="black" points="3536.32,-3577.48 3526.09,-3580.26 3535.82,-3584.46 3536.32,-3577.48"/>
</g>
<!-- q_proj_1_3 -->
<g id="node31" class="node">
<title>q_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3722,-3581.32 3544,-3581.32 3544,-3540.32 3722,-3540.32 3722,-3581.32"/>
<text text-anchor="middle" x="3633" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="3633" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3633" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1&#45;&gt;q_proj_1_3 -->
<g id="edge59" class="edge">
<title>ln1&#45;&gt;q_proj_1_3</title>
<path fill="none" stroke="black" d="M4788,-3617.96C4780.35,-3610.54 4771.08,-3603.35 4761,-3599.32 4709.71,-3578.86 3851.52,-3586.81 3732.13,-3580.95"/>
<polygon fill="black" stroke="black" points="3732.31,-3577.46 3722.09,-3580.25 3731.83,-3584.44 3732.31,-3577.46"/>
</g>
<!-- k_proj_1_3 -->
<g id="node32" class="node">
<title>k_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3918,-3581.32 3740,-3581.32 3740,-3540.32 3918,-3540.32 3918,-3581.32"/>
<text text-anchor="middle" x="3829" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="3829" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3829" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1&#45;&gt;k_proj_1_3 -->
<g id="edge60" class="edge">
<title>ln1&#45;&gt;k_proj_1_3</title>
<path fill="none" stroke="black" d="M4792.23,-3618.06C4785.9,-3610.64 4778.02,-3603.43 4769,-3599.32 4728.16,-3580.73 4034.08,-3585.92 3928.34,-3580.94"/>
<polygon fill="black" stroke="black" points="3928.31,-3577.43 3918.1,-3580.24 3927.83,-3584.41 3928.31,-3577.43"/>
</g>
<!-- v_proj_1_3 -->
<g id="node33" class="node">
<title>v_proj_1_3</title>
<polygon fill="lightgreen" stroke="black" points="4114,-3581.32 3936,-3581.32 3936,-3540.32 4114,-3540.32 4114,-3581.32"/>
<text text-anchor="middle" x="4025" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4025" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4025" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1&#45;&gt;v_proj_1_3 -->
<g id="edge61" class="edge">
<title>ln1&#45;&gt;v_proj_1_3</title>
<path fill="none" stroke="black" d="M4795.98,-3618.18C4790.82,-3610.78 4784.14,-3603.53 4776,-3599.32 4745.31,-3583.45 4213.76,-3585.16 4124.14,-3580.9"/>
<polygon fill="black" stroke="black" points="4124.31,-3577.41 4114.1,-3580.21 4123.83,-3584.39 4124.31,-3577.41"/>
</g>
<!-- q_proj_2_0 -->
<g id="node35" class="node">
<title>q_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="5094,-3581.32 4916,-3581.32 4916,-3540.32 5094,-3540.32 5094,-3581.32"/>
<text text-anchor="middle" x="5005" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5005" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5005" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_0 -->
<g id="edge66" class="edge">
<title>ln1&#45;&gt;q_proj_2_0</title>
<path fill="none" stroke="black" d="M4862.56,-3621.05C4889.22,-3609.96 4921.46,-3596.56 4948.51,-3585.31"/>
<polygon fill="black" stroke="black" points="4949.96,-3588.5 4957.85,-3581.43 4947.27,-3582.04 4949.96,-3588.5"/>
</g>
<!-- k_proj_2_0 -->
<g id="node36" class="node">
<title>k_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="5290,-3581.32 5112,-3581.32 5112,-3540.32 5290,-3540.32 5290,-3581.32"/>
<text text-anchor="middle" x="5201" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5201" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5201" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_0 -->
<g id="edge67" class="edge">
<title>ln1&#45;&gt;k_proj_2_0</title>
<path fill="none" stroke="black" d="M4862.68,-3632.16C4924.09,-3619.39 5025.93,-3598.22 5101.87,-3582.43"/>
<polygon fill="black" stroke="black" points="5102.85,-3585.8 5111.93,-3580.34 5101.43,-3578.95 5102.85,-3585.8"/>
</g>
<!-- v_proj_2_0 -->
<g id="node37" class="node">
<title>v_proj_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4898,-3581.32 4720,-3581.32 4720,-3540.32 4898,-3540.32 4898,-3581.32"/>
<text text-anchor="middle" x="4809" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="4809" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4809" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_0 -->
<g id="edge68" class="edge">
<title>ln1&#45;&gt;v_proj_2_0</title>
<path fill="none" stroke="black" d="M4809,-3617.98C4809,-3609.61 4809,-3600.22 4809,-3591.55"/>
<polygon fill="black" stroke="black" points="4812.5,-3591.45 4809,-3581.45 4805.5,-3591.45 4812.5,-3591.45"/>
</g>
<!-- q_proj_2_1 -->
<g id="node39" class="node">
<title>q_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="6074,-3581.32 5896,-3581.32 5896,-3540.32 6074,-3540.32 6074,-3581.32"/>
<text text-anchor="middle" x="5985" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5985" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5985" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_1 -->
<g id="edge73" class="edge">
<title>ln1&#45;&gt;q_proj_2_1</title>
<path fill="none" stroke="black" d="M4862.52,-3642.87C5018.82,-3640.99 5488.15,-3631.38 5885.92,-3581.36"/>
<polygon fill="black" stroke="black" points="5886.41,-3584.83 5895.89,-3580.1 5885.53,-3577.89 5886.41,-3584.83"/>
</g>
<!-- k_proj_2_1 -->
<g id="node40" class="node">
<title>k_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="6270,-3581.32 6092,-3581.32 6092,-3540.32 6270,-3540.32 6270,-3581.32"/>
<text text-anchor="middle" x="6181" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6181" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6181" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_1 -->
<g id="edge74" class="edge">
<title>ln1&#45;&gt;k_proj_2_1</title>
<path fill="none" stroke="black" d="M4862.58,-3640.91C5003.49,-3634.54 5396.16,-3616.64 5723,-3600.32 5879.74,-3592.5 5922.29,-3600.87 6081.72,-3581.38"/>
<polygon fill="black" stroke="black" points="6082.4,-3584.82 6091.89,-3580.12 6081.54,-3577.88 6082.4,-3584.82"/>
</g>
<!-- v_proj_2_1 -->
<g id="node41" class="node">
<title>v_proj_2_1</title>
<polygon fill="lightgreen" stroke="black" points="6466,-3581.32 6288,-3581.32 6288,-3540.32 6466,-3540.32 6466,-3581.32"/>
<text text-anchor="middle" x="6377" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="6377" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6377" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_1 -->
<g id="edge75" class="edge">
<title>ln1&#45;&gt;v_proj_2_1</title>
<path fill="none" stroke="black" d="M4862.66,-3642.17C5090.1,-3637.12 5976.31,-3615.67 6277.85,-3581.33"/>
<polygon fill="black" stroke="black" points="6278.37,-3584.8 6287.9,-3580.16 6277.56,-3577.84 6278.37,-3584.8"/>
</g>
<!-- q_proj_2_2 -->
<g id="node43" class="node">
<title>q_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="6662,-3581.32 6484,-3581.32 6484,-3540.32 6662,-3540.32 6662,-3581.32"/>
<text text-anchor="middle" x="6573" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="6573" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6573" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_2 -->
<g id="edge80" class="edge">
<title>ln1&#45;&gt;q_proj_2_2</title>
<path fill="none" stroke="black" d="M4862.79,-3641.68C5035.89,-3636.33 5594.15,-3618.76 6056,-3600.32 6238.99,-3593.02 6288.23,-3603.42 6473.8,-3581.36"/>
<polygon fill="black" stroke="black" points="6474.38,-3584.82 6483.89,-3580.15 6473.55,-3577.87 6474.38,-3584.82"/>
</g>
<!-- k_proj_2_2 -->
<g id="node44" class="node">
<title>k_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="6858,-3581.32 6680,-3581.32 6680,-3540.32 6858,-3540.32 6858,-3581.32"/>
<text text-anchor="middle" x="6769" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="6769" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6769" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_2 -->
<g id="edge81" class="edge">
<title>ln1&#45;&gt;k_proj_2_2</title>
<path fill="none" stroke="black" d="M4862.54,-3642.72C5125.91,-3639.58 6286.26,-3623.61 6669.88,-3581.32"/>
<polygon fill="black" stroke="black" points="6670.36,-3584.79 6679.9,-3580.19 6669.57,-3577.84 6670.36,-3584.79"/>
</g>
<!-- v_proj_2_2 -->
<g id="node45" class="node">
<title>v_proj_2_2</title>
<polygon fill="lightgreen" stroke="black" points="7054,-3581.32 6876,-3581.32 6876,-3540.32 7054,-3540.32 7054,-3581.32"/>
<text text-anchor="middle" x="6965" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="6965" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6965" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_2 -->
<g id="edge82" class="edge">
<title>ln1&#45;&gt;v_proj_2_2</title>
<path fill="none" stroke="black" d="M4862.78,-3642.29C5068.46,-3638.24 5825.02,-3622.62 6448,-3600.32 6631.02,-3593.77 6680.23,-3603.45 6865.8,-3581.36"/>
<polygon fill="black" stroke="black" points="6866.38,-3584.82 6875.89,-3580.15 6865.55,-3577.87 6866.38,-3584.82"/>
</g>
<!-- q_proj_2_3 -->
<g id="node47" class="node">
<title>q_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="5682,-3581.32 5504,-3581.32 5504,-3540.32 5682,-3540.32 5682,-3581.32"/>
<text text-anchor="middle" x="5593" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="5593" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5593" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1&#45;&gt;q_proj_2_3 -->
<g id="edge87" class="edge">
<title>ln1&#45;&gt;q_proj_2_3</title>
<path fill="none" stroke="black" d="M4862.59,-3640.42C4976.86,-3633.82 5252.97,-3615.64 5493.87,-3581.41"/>
<polygon fill="black" stroke="black" points="5494.47,-3584.86 5503.87,-3579.98 5493.48,-3577.93 5494.47,-3584.86"/>
</g>
<!-- k_proj_2_3 -->
<g id="node48" class="node">
<title>k_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="5878,-3581.32 5700,-3581.32 5700,-3540.32 5878,-3540.32 5878,-3581.32"/>
<text text-anchor="middle" x="5789" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="5789" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5789" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1&#45;&gt;k_proj_2_3 -->
<g id="edge88" class="edge">
<title>ln1&#45;&gt;k_proj_2_3</title>
<path fill="none" stroke="black" d="M4862.68,-3641.91C4999.21,-3637.81 5370.82,-3623.48 5689.52,-3581.43"/>
<polygon fill="black" stroke="black" points="5690.43,-3584.84 5699.88,-3580.05 5689.51,-3577.9 5690.43,-3584.84"/>
</g>
<!-- v_proj_2_3 -->
<g id="node49" class="node">
<title>v_proj_2_3</title>
<polygon fill="lightgreen" stroke="black" points="5486,-3581.32 5308,-3581.32 5308,-3540.32 5486,-3540.32 5486,-3581.32"/>
<text text-anchor="middle" x="5397" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="5397" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5397" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1&#45;&gt;v_proj_2_3 -->
<g id="edge89" class="edge">
<title>ln1&#45;&gt;v_proj_2_3</title>
<path fill="none" stroke="black" d="M4862.83,-3637.77C4951.38,-3628.36 5133.49,-3607.84 5297.57,-3581.5"/>
<polygon fill="black" stroke="black" points="5298.54,-3584.89 5307.85,-3579.84 5297.42,-3577.98 5298.54,-3584.89"/>
</g>
<!-- q_proj_3_0 -->
<g id="node51" class="node">
<title>q_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="9014,-3581.32 8836,-3581.32 8836,-3540.32 9014,-3540.32 9014,-3581.32"/>
<text text-anchor="middle" x="8925" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8925" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8925" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_0 -->
<g id="edge94" class="edge">
<title>ln1&#45;&gt;q_proj_3_0</title>
<path fill="none" stroke="black" d="M4862.64,-3643C5180.04,-3641.02 6844.65,-3629.61 8203,-3600.32 8477.01,-3594.42 8549.56,-3612.28 8825.57,-3581.37"/>
<polygon fill="black" stroke="black" points="8826.36,-3584.81 8835.9,-3580.2 8825.57,-3577.85 8826.36,-3584.81"/>
</g>
<!-- k_proj_3_0 -->
<g id="node52" class="node">
<title>k_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="9210,-3581.32 9032,-3581.32 9032,-3540.32 9210,-3540.32 9210,-3581.32"/>
<text text-anchor="middle" x="9121" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9121" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9121" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_0 -->
<g id="edge95" class="edge">
<title>ln1&#45;&gt;k_proj_3_0</title>
<path fill="none" stroke="black" d="M4862.53,-3643.06C5190.22,-3641.34 6958.73,-3630.98 8401,-3600.32 8674.14,-3594.52 8746.45,-3612.2 9021.61,-3581.37"/>
<polygon fill="black" stroke="black" points="9022.36,-3584.81 9031.9,-3580.2 9021.57,-3577.85 9022.36,-3584.81"/>
</g>
<!-- v_proj_3_0 -->
<g id="node53" class="node">
<title>v_proj_3_0</title>
<polygon fill="lightgreen" stroke="black" points="9406,-3581.32 9228,-3581.32 9228,-3540.32 9406,-3540.32 9406,-3581.32"/>
<text text-anchor="middle" x="9317" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9317" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9317" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_0 -->
<g id="edge96" class="edge">
<title>ln1&#45;&gt;v_proj_3_0</title>
<path fill="none" stroke="black" d="M4862.7,-3643.1C5201.04,-3641.63 7072.52,-3632.31 8598,-3600.32 8870.7,-3594.6 8942.89,-3612.16 9217.62,-3581.37"/>
<polygon fill="black" stroke="black" points="9218.36,-3584.81 9227.9,-3580.2 9217.57,-3577.85 9218.36,-3584.81"/>
</g>
<!-- q_proj_3_1 -->
<g id="node55" class="node">
<title>q_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="7250,-3581.32 7072,-3581.32 7072,-3540.32 7250,-3540.32 7250,-3581.32"/>
<text text-anchor="middle" x="7161" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="7161" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7161" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_1 -->
<g id="edge101" class="edge">
<title>ln1&#45;&gt;q_proj_3_1</title>
<path fill="none" stroke="black" d="M4862.55,-3642.04C5069.05,-3637.07 5833.47,-3618.47 6463,-3600.32 6726.43,-3592.73 6796.24,-3611.22 7061.96,-3581.33"/>
<polygon fill="black" stroke="black" points="7062.36,-3584.81 7071.9,-3580.2 7061.57,-3577.85 7062.36,-3584.81"/>
</g>
<!-- k_proj_3_1 -->
<g id="node56" class="node">
<title>k_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="7446,-3581.32 7268,-3581.32 7268,-3540.32 7446,-3540.32 7446,-3581.32"/>
<text text-anchor="middle" x="7357" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7357" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7357" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_1 -->
<g id="edge102" class="edge">
<title>ln1&#45;&gt;k_proj_3_1</title>
<path fill="none" stroke="black" d="M4862.65,-3642.16C5081.02,-3637.42 5924.37,-3618.85 6618,-3600.32 6899.57,-3592.8 6974.07,-3612.99 7257.72,-3581.35"/>
<polygon fill="black" stroke="black" points="7258.36,-3584.8 7267.9,-3580.21 7257.57,-3577.85 7258.36,-3584.8"/>
</g>
<!-- v_proj_3_1 -->
<g id="node57" class="node">
<title>v_proj_3_1</title>
<polygon fill="lightgreen" stroke="black" points="7642,-3581.32 7464,-3581.32 7464,-3540.32 7642,-3540.32 7642,-3581.32"/>
<text text-anchor="middle" x="7553" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="7553" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7553" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_1 -->
<g id="edge103" class="edge">
<title>ln1&#45;&gt;v_proj_3_1</title>
<path fill="none" stroke="black" d="M4862.5,-3642.34C5094.9,-3638.04 6039.93,-3620.17 6816,-3600.32 7096.7,-3593.14 7170.96,-3612.91 7453.75,-3581.35"/>
<polygon fill="black" stroke="black" points="7454.36,-3584.8 7463.9,-3580.21 7453.57,-3577.85 7454.36,-3584.8"/>
</g>
<!-- q_proj_3_2 -->
<g id="node59" class="node">
<title>q_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="7838,-3581.32 7660,-3581.32 7660,-3540.32 7838,-3540.32 7838,-3581.32"/>
<text text-anchor="middle" x="7749" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="7749" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7749" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_2 -->
<g id="edge108" class="edge">
<title>ln1&#45;&gt;q_proj_3_2</title>
<path fill="none" stroke="black" d="M4862.7,-3642.48C5108.98,-3638.56 6155.03,-3621.47 7013,-3600.32 7293.27,-3593.42 7367.4,-3612.87 7649.77,-3581.35"/>
<polygon fill="black" stroke="black" points="7650.36,-3584.81 7659.9,-3580.21 7649.57,-3577.85 7650.36,-3584.81"/>
</g>
<!-- k_proj_3_2 -->
<g id="node60" class="node">
<title>k_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8034,-3581.32 7856,-3581.32 7856,-3540.32 8034,-3540.32 8034,-3581.32"/>
<text text-anchor="middle" x="7945" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="7945" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7945" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_2 -->
<g id="edge109" class="edge">
<title>ln1&#45;&gt;k_proj_3_2</title>
<path fill="none" stroke="black" d="M4862.78,-3642.6C5122.46,-3639.08 6272.67,-3622.91 7215,-3600.32 7492.64,-3593.67 7566.07,-3612.62 7845.86,-3581.34"/>
<polygon fill="black" stroke="black" points="7846.36,-3584.81 7855.9,-3580.21 7845.57,-3577.85 7846.36,-3584.81"/>
</g>
<!-- v_proj_3_2 -->
<g id="node61" class="node">
<title>v_proj_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8230,-3581.32 8052,-3581.32 8052,-3540.32 8230,-3540.32 8230,-3581.32"/>
<text text-anchor="middle" x="8141" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="8141" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8141" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_2 -->
<g id="edge110" class="edge">
<title>ln1&#45;&gt;v_proj_3_2</title>
<path fill="none" stroke="black" d="M4862.56,-3642.71C5134.08,-3639.52 6385.65,-3624.16 7410,-3600.32 7688.09,-3593.85 7761.63,-3612.67 8041.84,-3581.34"/>
<polygon fill="black" stroke="black" points="8042.36,-3584.81 8051.9,-3580.21 8041.57,-3577.85 8042.36,-3584.81"/>
</g>
<!-- q_proj_3_3 -->
<g id="node63" class="node">
<title>q_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="8426,-3581.32 8248,-3581.32 8248,-3540.32 8426,-3540.32 8426,-3581.32"/>
<text text-anchor="middle" x="8337" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="8337" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8337" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1&#45;&gt;q_proj_3_3 -->
<g id="edge115" class="edge">
<title>ln1&#45;&gt;q_proj_3_3</title>
<path fill="none" stroke="black" d="M4862.9,-3642.79C5147.32,-3639.95 6502.64,-3625.59 7611,-3600.32 7886.89,-3594.03 7959.85,-3612.46 8237.92,-3581.33"/>
<polygon fill="black" stroke="black" points="8238.36,-3584.81 8247.9,-3580.2 8237.57,-3577.85 8238.36,-3584.81"/>
</g>
<!-- k_proj_3_3 -->
<g id="node64" class="node">
<title>k_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="8622,-3581.32 8444,-3581.32 8444,-3540.32 8622,-3540.32 8622,-3581.32"/>
<text text-anchor="middle" x="8533" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="8533" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8533" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1&#45;&gt;k_proj_3_3 -->
<g id="edge116" class="edge">
<title>ln1&#45;&gt;k_proj_3_3</title>
<path fill="none" stroke="black" d="M4862.69,-3642.87C5158.02,-3640.31 6614.7,-3626.81 7805,-3600.32 8081.78,-3594.16 8154.96,-3612.55 8433.89,-3581.34"/>
<polygon fill="black" stroke="black" points="8434.36,-3584.81 8443.9,-3580.2 8433.57,-3577.85 8434.36,-3584.81"/>
</g>
<!-- v_proj_3_3 -->
<g id="node65" class="node">
<title>v_proj_3_3</title>
<polygon fill="lightgreen" stroke="black" points="8818,-3581.32 8640,-3581.32 8640,-3540.32 8818,-3540.32 8818,-3581.32"/>
<text text-anchor="middle" x="8729" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="8729" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8729" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1&#45;&gt;v_proj_3_3 -->
<g id="edge117" class="edge">
<title>ln1&#45;&gt;v_proj_3_3</title>
<path fill="none" stroke="black" d="M4862.71,-3642.94C5169.43,-3640.68 6730.4,-3628.24 8005,-3600.32 8280.02,-3594.3 8352.74,-3612.38 8629.95,-3581.33"/>
<polygon fill="black" stroke="black" points="8630.36,-3584.81 8639.9,-3580.2 8629.57,-3577.85 8630.36,-3584.81"/>
</g>
<!-- attn_0_0 -->
<g id="node6" class="node">
<title>attn_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1566,-3503.32 1388,-3503.32 1388,-3462.32 1566,-3462.32 1566,-3503.32"/>
<text text-anchor="middle" x="1477" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1477" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1477" y="-3469.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge13" class="edge">
<title>q_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M1477,-3540.25C1477,-3532.1 1477,-3522.45 1477,-3513.45"/>
<polygon fill="black" stroke="black" points="1480.5,-3513.33 1477,-3503.33 1473.5,-3513.33 1480.5,-3513.33"/>
</g>
<!-- k_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge14" class="edge">
<title>k_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M1622.53,-3540.25C1596.35,-3530.1 1564.2,-3517.64 1536.79,-3507.01"/>
<polygon fill="black" stroke="black" points="1537.89,-3503.68 1527.3,-3503.33 1535.36,-3510.21 1537.89,-3503.68"/>
</g>
<!-- v_proj_0_0&#45;&gt;attn_0_0 -->
<g id="edge15" class="edge">
<title>v_proj_0_0&#45;&gt;attn_0_0</title>
<path fill="none" stroke="black" d="M1331.47,-3540.25C1357.65,-3530.1 1389.8,-3517.64 1417.21,-3507.01"/>
<polygon fill="black" stroke="black" points="1418.64,-3510.21 1426.7,-3503.33 1416.11,-3503.68 1418.64,-3510.21"/>
</g>
<!-- agg_dim_0 -->
<g id="node67" class="node">
<title>agg_dim_0</title>
<polygon fill="lightcoral" stroke="black" points="1583.57,-3425.32 1414.04,-3425.32 1370.43,-3321.32 1539.96,-3321.32 1583.57,-3425.32"/>
<text text-anchor="middle" x="1477" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="1477" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="1477" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="1477" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_0_0&#45;&gt;agg_dim_0 -->
<g id="edge16" class="edge">
<title>attn_0_0&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M1477,-3462.11C1477,-3454.46 1477,-3445.25 1477,-3435.71"/>
<polygon fill="black" stroke="black" points="1480.5,-3435.71 1477,-3425.71 1473.5,-3435.71 1480.5,-3435.71"/>
</g>
<!-- attn_0_1 -->
<g id="node10" class="node">
<title>attn_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1054,-3503.32 876,-3503.32 876,-3462.32 1054,-3462.32 1054,-3503.32"/>
<text text-anchor="middle" x="965" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="965" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="965" y="-3469.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge20" class="edge">
<title>q_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M908.57,-3540.25C917.61,-3531.21 928.49,-3520.33 938.28,-3510.55"/>
<polygon fill="black" stroke="black" points="940.9,-3512.87 945.49,-3503.33 935.95,-3507.92 940.9,-3512.87"/>
</g>
<!-- k_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge21" class="edge">
<title>k_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M1054.1,-3540.25C1038.98,-3530.68 1020.61,-3519.04 1004.49,-3508.83"/>
<polygon fill="black" stroke="black" points="1006.12,-3505.72 995.8,-3503.33 1002.37,-3511.64 1006.12,-3505.72"/>
</g>
<!-- v_proj_0_1&#45;&gt;attn_0_1 -->
<g id="edge22" class="edge">
<title>v_proj_0_1&#45;&gt;attn_0_1</title>
<path fill="none" stroke="black" d="M763.05,-3540.25C800.48,-3529.79 846.72,-3516.87 885.5,-3506.04"/>
<polygon fill="black" stroke="black" points="886.5,-3509.39 895.19,-3503.33 884.62,-3502.65 886.5,-3509.39"/>
</g>
<!-- attn_0_1&#45;&gt;agg_dim_0 -->
<g id="edge23" class="edge">
<title>attn_0_1&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M1054.18,-3463.1C1148.31,-3443.34 1295.73,-3412.38 1389.29,-3392.74"/>
<polygon fill="black" stroke="black" points="1390.23,-3396.12 1399.3,-3390.64 1388.79,-3389.27 1390.23,-3396.12"/>
</g>
<!-- attn_0_2 -->
<g id="node14" class="node">
<title>attn_0_2</title>
<polygon fill="lightgreen" stroke="black" points="2009,-3503.32 1831,-3503.32 1831,-3462.32 2009,-3462.32 2009,-3503.32"/>
<text text-anchor="middle" x="1920" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="1920" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="1920" y="-3469.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge27" class="edge">
<title>q_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M1882.13,-3540.25C1887.96,-3531.56 1894.93,-3521.18 1901.29,-3511.7"/>
<polygon fill="black" stroke="black" points="1904.24,-3513.58 1906.91,-3503.33 1898.43,-3509.68 1904.24,-3513.58"/>
</g>
<!-- k_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge28" class="edge">
<title>k_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M2027.66,-3540.25C2008.89,-3530.41 1985.96,-3518.4 1966.1,-3507.99"/>
<polygon fill="black" stroke="black" points="1967.7,-3504.87 1957.21,-3503.33 1964.45,-3511.07 1967.7,-3504.87"/>
</g>
<!-- v_proj_0_2&#45;&gt;attn_0_2 -->
<g id="edge29" class="edge">
<title>v_proj_0_2&#45;&gt;attn_0_2</title>
<path fill="none" stroke="black" d="M2173.18,-3540.25C2125.55,-3529.64 2066.56,-3516.49 2017.51,-3505.56"/>
<polygon fill="black" stroke="black" points="2018.04,-3502.09 2007.52,-3503.33 2016.52,-3508.92 2018.04,-3502.09"/>
</g>
<!-- attn_0_2&#45;&gt;agg_dim_0 -->
<g id="edge30" class="edge">
<title>attn_0_2&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M1839.52,-3462.29C1767.28,-3444.76 1660.77,-3418.92 1581.88,-3399.77"/>
<polygon fill="black" stroke="black" points="1582.45,-3396.31 1571.91,-3397.35 1580.8,-3403.11 1582.45,-3396.31"/>
</g>
<!-- attn_0_3 -->
<g id="node18" class="node">
<title>attn_0_3</title>
<polygon fill="lightgreen" stroke="black" points="441,-3503.32 263,-3503.32 263,-3462.32 441,-3462.32 441,-3503.32"/>
<text text-anchor="middle" x="352" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="352" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="352" y="-3469.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge34" class="edge">
<title>q_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M168.61,-3540.25C202.32,-3529.88 243.88,-3517.09 278.91,-3506.31"/>
<polygon fill="black" stroke="black" points="280.08,-3509.61 288.61,-3503.33 278.02,-3502.92 280.08,-3509.61"/>
</g>
<!-- k_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge35" class="edge">
<title>k_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M314.13,-3540.25C319.96,-3531.56 326.93,-3521.18 333.29,-3511.7"/>
<polygon fill="black" stroke="black" points="336.24,-3513.58 338.91,-3503.33 330.43,-3509.68 336.24,-3513.58"/>
</g>
<!-- v_proj_0_3&#45;&gt;attn_0_3 -->
<g id="edge36" class="edge">
<title>v_proj_0_3&#45;&gt;attn_0_3</title>
<path fill="none" stroke="black" d="M459.66,-3540.25C440.89,-3530.41 417.96,-3518.4 398.1,-3507.99"/>
<polygon fill="black" stroke="black" points="399.7,-3504.87 389.21,-3503.33 396.45,-3511.07 399.7,-3504.87"/>
</g>
<!-- attn_0_3&#45;&gt;agg_dim_0 -->
<g id="edge37" class="edge">
<title>attn_0_3&#45;&gt;agg_dim_0</title>
<path fill="none" stroke="black" d="M441.22,-3473.3C650.99,-3453.25 1173.76,-3403.3 1385.64,-3383.05"/>
<polygon fill="black" stroke="black" points="1386.18,-3386.52 1395.8,-3382.08 1385.51,-3379.55 1386.18,-3386.52"/>
</g>
<!-- attn_1_0 -->
<g id="node22" class="node">
<title>attn_1_0</title>
<polygon fill="lightgreen" stroke="black" points="4384,-3503.32 4206,-3503.32 4206,-3462.32 4384,-3462.32 4384,-3503.32"/>
<text text-anchor="middle" x="4295" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="4295" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="4295" y="-3469.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge41" class="edge">
<title>q_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4240.06,-3540.25C4248.86,-3531.21 4259.45,-3520.33 4268.98,-3510.55"/>
<polygon fill="black" stroke="black" points="4271.54,-3512.93 4276.01,-3503.33 4266.52,-3508.05 4271.54,-3512.93"/>
</g>
<!-- k_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge42" class="edge">
<title>k_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4385.58,-3540.25C4370.21,-3530.68 4351.54,-3519.04 4335.15,-3508.83"/>
<polygon fill="black" stroke="black" points="4336.65,-3505.65 4326.31,-3503.33 4332.95,-3511.59 4336.65,-3505.65"/>
</g>
<!-- v_proj_1_0&#45;&gt;attn_1_0 -->
<g id="edge43" class="edge">
<title>v_proj_1_0&#45;&gt;attn_1_0</title>
<path fill="none" stroke="black" d="M4531.11,-3540.25C4486.87,-3529.68 4432.14,-3516.6 4386.51,-3505.69"/>
<polygon fill="black" stroke="black" points="4387.16,-3502.25 4376.62,-3503.33 4385.53,-3509.06 4387.16,-3502.25"/>
</g>
<!-- agg_dim_1 -->
<g id="node68" class="node">
<title>agg_dim_1</title>
<polygon fill="lightcoral" stroke="black" points="3935.57,-3425.32 3766.04,-3425.32 3722.43,-3321.32 3891.96,-3321.32 3935.57,-3425.32"/>
<text text-anchor="middle" x="3829" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="3829" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="3829" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="3829" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_1_0&#45;&gt;agg_dim_1 -->
<g id="edge44" class="edge">
<title>attn_1_0&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M4210.34,-3462.29C4132.47,-3444.33 4016.77,-3417.64 3933.24,-3398.37"/>
<polygon fill="black" stroke="black" points="3934.01,-3394.95 3923.47,-3396.12 3932.43,-3401.78 3934.01,-3394.95"/>
</g>
<!-- attn_1_1 -->
<g id="node26" class="node">
<title>attn_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2793,-3503.32 2615,-3503.32 2615,-3462.32 2793,-3462.32 2793,-3503.32"/>
<text text-anchor="middle" x="2704" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="2704" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="2704" y="-3469.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge48" class="edge">
<title>q_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M2520.61,-3540.25C2554.32,-3529.88 2595.88,-3517.09 2630.91,-3506.31"/>
<polygon fill="black" stroke="black" points="2632.08,-3509.61 2640.61,-3503.33 2630.02,-3502.92 2632.08,-3509.61"/>
</g>
<!-- k_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge49" class="edge">
<title>k_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M2666.13,-3540.25C2671.96,-3531.56 2678.93,-3521.18 2685.29,-3511.7"/>
<polygon fill="black" stroke="black" points="2688.24,-3513.58 2690.91,-3503.33 2682.43,-3509.68 2688.24,-3513.58"/>
</g>
<!-- v_proj_1_1&#45;&gt;attn_1_1 -->
<g id="edge50" class="edge">
<title>v_proj_1_1&#45;&gt;attn_1_1</title>
<path fill="none" stroke="black" d="M2811.66,-3540.25C2792.89,-3530.41 2769.96,-3518.4 2750.1,-3507.99"/>
<polygon fill="black" stroke="black" points="2751.7,-3504.87 2741.21,-3503.33 2748.45,-3511.07 2751.7,-3504.87"/>
</g>
<!-- attn_1_1&#45;&gt;agg_dim_1 -->
<g id="edge51" class="edge">
<title>attn_1_1&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M2793.22,-3473.3C3002.99,-3453.25 3525.76,-3403.3 3737.64,-3383.05"/>
<polygon fill="black" stroke="black" points="3738.18,-3386.52 3747.8,-3382.08 3737.51,-3379.55 3738.18,-3386.52"/>
</g>
<!-- attn_1_2 -->
<g id="node30" class="node">
<title>attn_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3429,-3503.32 3251,-3503.32 3251,-3462.32 3429,-3462.32 3429,-3503.32"/>
<text text-anchor="middle" x="3340" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3340" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3340" y="-3469.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge55" class="edge">
<title>q_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M3120.97,-3540.25C3161.83,-3529.72 3212.36,-3516.71 3254.58,-3505.83"/>
<polygon fill="black" stroke="black" points="3255.48,-3509.21 3264.29,-3503.33 3253.73,-3502.43 3255.48,-3509.21"/>
</g>
<!-- k_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge56" class="edge">
<title>k_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M3266.49,-3540.25C3278.62,-3530.94 3293.28,-3519.69 3306.31,-3509.69"/>
<polygon fill="black" stroke="black" points="3308.79,-3512.19 3314.59,-3503.33 3304.53,-3506.64 3308.79,-3512.19"/>
</g>
<!-- v_proj_1_2&#45;&gt;attn_1_2 -->
<g id="edge57" class="edge">
<title>v_proj_1_2&#45;&gt;attn_1_2</title>
<path fill="none" stroke="black" d="M3412.02,-3540.25C3400.14,-3530.94 3385.78,-3519.69 3373.01,-3509.69"/>
<polygon fill="black" stroke="black" points="3374.93,-3506.74 3364.9,-3503.33 3370.61,-3512.25 3374.93,-3506.74"/>
</g>
<!-- attn_1_2&#45;&gt;agg_dim_1 -->
<g id="edge58" class="edge">
<title>attn_1_2&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M3428.84,-3462.29C3517.66,-3442.77 3653.39,-3412.93 3741.68,-3393.52"/>
<polygon fill="black" stroke="black" points="3742.65,-3396.89 3751.67,-3391.32 3741.15,-3390.05 3742.65,-3396.89"/>
</g>
<!-- attn_1_3 -->
<g id="node34" class="node">
<title>attn_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3918,-3503.32 3740,-3503.32 3740,-3462.32 3918,-3462.32 3918,-3503.32"/>
<text text-anchor="middle" x="3829" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="3829" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="3829" y="-3469.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge62" class="edge">
<title>q_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M3683.47,-3540.25C3709.65,-3530.1 3741.8,-3517.64 3769.21,-3507.01"/>
<polygon fill="black" stroke="black" points="3770.64,-3510.21 3778.7,-3503.33 3768.11,-3503.68 3770.64,-3510.21"/>
</g>
<!-- k_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge63" class="edge">
<title>k_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M3829,-3540.25C3829,-3532.1 3829,-3522.45 3829,-3513.45"/>
<polygon fill="black" stroke="black" points="3832.5,-3513.33 3829,-3503.33 3825.5,-3513.33 3832.5,-3513.33"/>
</g>
<!-- v_proj_1_3&#45;&gt;attn_1_3 -->
<g id="edge64" class="edge">
<title>v_proj_1_3&#45;&gt;attn_1_3</title>
<path fill="none" stroke="black" d="M3974.53,-3540.25C3948.35,-3530.1 3916.2,-3517.64 3888.79,-3507.01"/>
<polygon fill="black" stroke="black" points="3889.89,-3503.68 3879.3,-3503.33 3887.36,-3510.21 3889.89,-3503.68"/>
</g>
<!-- attn_1_3&#45;&gt;agg_dim_1 -->
<g id="edge65" class="edge">
<title>attn_1_3&#45;&gt;agg_dim_1</title>
<path fill="none" stroke="black" d="M3829,-3462.11C3829,-3454.46 3829,-3445.25 3829,-3435.71"/>
<polygon fill="black" stroke="black" points="3832.5,-3435.71 3829,-3425.71 3825.5,-3435.71 3832.5,-3435.71"/>
</g>
<!-- attn_2_0 -->
<g id="node38" class="node">
<title>attn_2_0</title>
<polygon fill="lightgreen" stroke="black" points="5192,-3503.32 5014,-3503.32 5014,-3462.32 5192,-3462.32 5192,-3503.32"/>
<text text-anchor="middle" x="5103" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5103" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5103" y="-3469.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge69" class="edge">
<title>q_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M5030.24,-3540.25C5042.24,-3530.94 5056.75,-3519.69 5069.65,-3509.69"/>
<polygon fill="black" stroke="black" points="5072.09,-3512.22 5077.85,-3503.33 5067.8,-3506.69 5072.09,-3512.22"/>
</g>
<!-- k_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge70" class="edge">
<title>k_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M5175.76,-3540.25C5163.76,-3530.94 5149.25,-3519.69 5136.35,-3509.69"/>
<polygon fill="black" stroke="black" points="5138.2,-3506.69 5128.15,-3503.33 5133.91,-3512.22 5138.2,-3506.69"/>
</g>
<!-- v_proj_2_0&#45;&gt;attn_2_0 -->
<g id="edge71" class="edge">
<title>v_proj_2_0&#45;&gt;attn_2_0</title>
<path fill="none" stroke="black" d="M4884.71,-3540.25C4925.35,-3529.75 4975.58,-3516.76 5017.6,-3505.9"/>
<polygon fill="black" stroke="black" points="5018.74,-3509.22 5027.54,-3503.33 5016.99,-3502.44 5018.74,-3509.22"/>
</g>
<!-- agg_dim_2 -->
<g id="node69" class="node">
<title>agg_dim_2</title>
<polygon fill="lightcoral" stroke="black" points="5809.57,-3425.32 5640.04,-3425.32 5596.43,-3321.32 5765.96,-3321.32 5809.57,-3425.32"/>
<text text-anchor="middle" x="5703" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="5703" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="5703" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="5703" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_0&#45;&gt;agg_dim_2 -->
<g id="edge72" class="edge">
<title>attn_2_0&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M5192.18,-3465.85C5305.78,-3445.49 5500.94,-3410.53 5614.31,-3390.21"/>
<polygon fill="black" stroke="black" points="5615.12,-3393.62 5624.35,-3388.42 5613.89,-3386.73 5615.12,-3393.62"/>
</g>
<!-- attn_2_1 -->
<g id="node42" class="node">
<title>attn_2_1</title>
<polygon fill="lightgreen" stroke="black" points="6160,-3503.32 5982,-3503.32 5982,-3462.32 6160,-3462.32 6160,-3503.32"/>
<text text-anchor="middle" x="6071" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="6071" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6071" y="-3469.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge76" class="edge">
<title>q_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M6007.15,-3540.25C6017.58,-3531.03 6030.17,-3519.9 6041.41,-3509.97"/>
<polygon fill="black" stroke="black" points="6043.75,-3512.57 6048.93,-3503.33 6039.12,-3507.33 6043.75,-3512.57"/>
</g>
<!-- k_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge77" class="edge">
<title>k_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M6152.67,-3540.25C6138.94,-3530.77 6122.29,-3519.26 6107.61,-3509.12"/>
<polygon fill="black" stroke="black" points="6109.45,-3506.13 6099.23,-3503.33 6105.47,-3511.89 6109.45,-3506.13"/>
</g>
<!-- v_proj_2_1&#45;&gt;attn_2_1 -->
<g id="edge78" class="edge">
<title>v_proj_2_1&#45;&gt;attn_2_1</title>
<path fill="none" stroke="black" d="M6298.2,-3540.25C6255.72,-3529.7 6203.18,-3516.65 6159.33,-3505.76"/>
<polygon fill="black" stroke="black" points="6160.08,-3502.34 6149.54,-3503.33 6158.4,-3509.14 6160.08,-3502.34"/>
</g>
<!-- attn_2_1&#45;&gt;agg_dim_2 -->
<g id="edge79" class="edge">
<title>attn_2_1&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M6003.93,-3462.23C5949.82,-3446.42 5872.66,-3423.88 5810.02,-3405.59"/>
<polygon fill="black" stroke="black" points="5810.68,-3402.13 5800.1,-3402.69 5808.72,-3408.85 5810.68,-3402.13"/>
</g>
<!-- attn_2_2 -->
<g id="node46" class="node">
<title>attn_2_2</title>
<polygon fill="lightgreen" stroke="black" points="6738,-3503.32 6560,-3503.32 6560,-3462.32 6738,-3462.32 6738,-3503.32"/>
<text text-anchor="middle" x="6649" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="6649" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="6649" y="-3469.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge83" class="edge">
<title>q_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M6592.57,-3540.25C6601.61,-3531.21 6612.49,-3520.33 6622.28,-3510.55"/>
<polygon fill="black" stroke="black" points="6624.9,-3512.87 6629.49,-3503.33 6619.95,-3507.92 6624.9,-3512.87"/>
</g>
<!-- k_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge84" class="edge">
<title>k_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M6738.1,-3540.25C6722.98,-3530.68 6704.61,-3519.04 6688.49,-3508.83"/>
<polygon fill="black" stroke="black" points="6690.12,-3505.72 6679.8,-3503.33 6686.37,-3511.64 6690.12,-3505.72"/>
</g>
<!-- v_proj_2_2&#45;&gt;attn_2_2 -->
<g id="edge85" class="edge">
<title>v_proj_2_2&#45;&gt;attn_2_2</title>
<path fill="none" stroke="black" d="M6883.62,-3540.25C6839.67,-3529.68 6785.27,-3516.6 6739.93,-3505.69"/>
<polygon fill="black" stroke="black" points="6740.64,-3502.26 6730.1,-3503.33 6739.01,-3509.07 6740.64,-3502.26"/>
</g>
<!-- attn_2_2&#45;&gt;agg_dim_2 -->
<g id="edge86" class="edge">
<title>attn_2_2&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M6559.58,-3471.66C6382.4,-3451.53 5987.94,-3406.7 5802.71,-3385.65"/>
<polygon fill="black" stroke="black" points="5803.03,-3382.17 5792.7,-3384.52 5802.24,-3389.12 5803.03,-3382.17"/>
</g>
<!-- attn_2_3 -->
<g id="node50" class="node">
<title>attn_2_3</title>
<polygon fill="lightgreen" stroke="black" points="5721,-3503.32 5543,-3503.32 5543,-3462.32 5721,-3462.32 5721,-3503.32"/>
<text text-anchor="middle" x="5632" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="5632" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="5632" y="-3469.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge90" class="edge">
<title>q_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M5603.04,-3540.25C5607.41,-3531.74 5612.61,-3521.6 5617.39,-3512.28"/>
<polygon fill="black" stroke="black" points="5620.54,-3513.82 5621.99,-3503.33 5614.31,-3510.63 5620.54,-3513.82"/>
</g>
<!-- k_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge91" class="edge">
<title>k_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M5748.57,-3540.25C5728.06,-3530.32 5702.97,-3518.18 5681.33,-3507.7"/>
<polygon fill="black" stroke="black" points="5682.82,-3504.54 5672.29,-3503.33 5679.77,-3510.84 5682.82,-3504.54"/>
</g>
<!-- v_proj_2_3&#45;&gt;attn_2_3 -->
<g id="edge92" class="edge">
<title>v_proj_2_3&#45;&gt;attn_2_3</title>
<path fill="none" stroke="black" d="M5457.52,-3540.25C5489.45,-3529.92 5528.8,-3517.2 5562.03,-3506.45"/>
<polygon fill="black" stroke="black" points="5563.25,-3509.74 5571.69,-3503.33 5561.09,-3503.08 5563.25,-3509.74"/>
</g>
<!-- attn_2_3&#45;&gt;agg_dim_2 -->
<g id="edge93" class="edge">
<title>attn_2_3&#45;&gt;agg_dim_2</title>
<path fill="none" stroke="black" d="M5645.02,-3462.11C5650.34,-3454.06 5656.8,-3444.27 5663.45,-3434.2"/>
<polygon fill="black" stroke="black" points="5666.47,-3435.98 5669.06,-3425.71 5660.63,-3432.12 5666.47,-3435.98"/>
</g>
<!-- attn_3_0 -->
<g id="node54" class="node">
<title>attn_3_0</title>
<polygon fill="lightgreen" stroke="black" points="9113,-3503.32 8935,-3503.32 8935,-3462.32 9113,-3462.32 9113,-3503.32"/>
<text text-anchor="middle" x="9024" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9024" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9024" y="-3469.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge97" class="edge">
<title>q_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M8950.49,-3540.25C8962.62,-3530.94 8977.28,-3519.69 8990.31,-3509.69"/>
<polygon fill="black" stroke="black" points="8992.79,-3512.19 8998.59,-3503.33 8988.53,-3506.64 8992.79,-3512.19"/>
</g>
<!-- k_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge98" class="edge">
<title>k_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M9096.02,-3540.25C9084.14,-3530.94 9069.78,-3519.69 9057.01,-3509.69"/>
<polygon fill="black" stroke="black" points="9058.93,-3506.74 9048.9,-3503.33 9054.61,-3512.25 9058.93,-3506.74"/>
</g>
<!-- v_proj_3_0&#45;&gt;attn_3_0 -->
<g id="edge99" class="edge">
<title>v_proj_3_0&#45;&gt;attn_3_0</title>
<path fill="none" stroke="black" d="M9241.55,-3540.25C9201.05,-3529.75 9150.99,-3516.76 9109.11,-3505.9"/>
<polygon fill="black" stroke="black" points="9109.76,-3502.45 9099.2,-3503.33 9108,-3509.23 9109.76,-3502.45"/>
</g>
<!-- agg_dim_3 -->
<g id="node70" class="node">
<title>agg_dim_3</title>
<polygon fill="lightcoral" stroke="black" points="8051.57,-3425.32 7882.04,-3425.32 7838.43,-3321.32 8007.96,-3321.32 8051.57,-3425.32"/>
<text text-anchor="middle" x="7945" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="7945" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="7945" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="7945" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_0&#45;&gt;agg_dim_3 -->
<g id="edge100" class="edge">
<title>attn_3_0&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M8934.78,-3472.93C8734.95,-3453.03 8252.65,-3404.97 8043.97,-3384.18"/>
<polygon fill="black" stroke="black" points="8044.24,-3380.69 8033.94,-3383.18 8043.55,-3387.66 8044.24,-3380.69"/>
</g>
<!-- attn_3_1 -->
<g id="node58" class="node">
<title>attn_3_1</title>
<polygon fill="lightgreen" stroke="black" points="7544,-3503.32 7366,-3503.32 7366,-3462.32 7544,-3462.32 7544,-3503.32"/>
<text text-anchor="middle" x="7455" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7455" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7455" y="-3469.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge104" class="edge">
<title>q_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M7236.71,-3540.25C7277.35,-3529.75 7327.58,-3516.76 7369.6,-3505.9"/>
<polygon fill="black" stroke="black" points="7370.74,-3509.22 7379.54,-3503.33 7368.99,-3502.44 7370.74,-3509.22"/>
</g>
<!-- k_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge105" class="edge">
<title>k_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M7382.24,-3540.25C7394.24,-3530.94 7408.75,-3519.69 7421.65,-3509.69"/>
<polygon fill="black" stroke="black" points="7424.09,-3512.22 7429.85,-3503.33 7419.8,-3506.69 7424.09,-3512.22"/>
</g>
<!-- v_proj_3_1&#45;&gt;attn_3_1 -->
<g id="edge106" class="edge">
<title>v_proj_3_1&#45;&gt;attn_3_1</title>
<path fill="none" stroke="black" d="M7527.76,-3540.25C7515.76,-3530.94 7501.25,-3519.69 7488.35,-3509.69"/>
<polygon fill="black" stroke="black" points="7490.2,-3506.69 7480.15,-3503.33 7485.91,-3512.22 7490.2,-3506.69"/>
</g>
<!-- attn_3_1&#45;&gt;agg_dim_3 -->
<g id="edge107" class="edge">
<title>attn_3_1&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M7544.02,-3462.29C7633.02,-3442.77 7769.04,-3412.93 7857.5,-3393.52"/>
<polygon fill="black" stroke="black" points="7858.49,-3396.89 7867.51,-3391.32 7856.99,-3390.05 7858.49,-3396.89"/>
</g>
<!-- attn_3_2 -->
<g id="node62" class="node">
<title>attn_3_2</title>
<polygon fill="lightgreen" stroke="black" points="8034,-3503.32 7856,-3503.32 7856,-3462.32 8034,-3462.32 8034,-3503.32"/>
<text text-anchor="middle" x="7945" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="7945" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="7945" y="-3469.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge111" class="edge">
<title>q_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M7799.47,-3540.25C7825.65,-3530.1 7857.8,-3517.64 7885.21,-3507.01"/>
<polygon fill="black" stroke="black" points="7886.64,-3510.21 7894.7,-3503.33 7884.11,-3503.68 7886.64,-3510.21"/>
</g>
<!-- k_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge112" class="edge">
<title>k_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M7945,-3540.25C7945,-3532.1 7945,-3522.45 7945,-3513.45"/>
<polygon fill="black" stroke="black" points="7948.5,-3513.33 7945,-3503.33 7941.5,-3513.33 7948.5,-3513.33"/>
</g>
<!-- v_proj_3_2&#45;&gt;attn_3_2 -->
<g id="edge113" class="edge">
<title>v_proj_3_2&#45;&gt;attn_3_2</title>
<path fill="none" stroke="black" d="M8090.53,-3540.25C8064.35,-3530.1 8032.2,-3517.64 8004.79,-3507.01"/>
<polygon fill="black" stroke="black" points="8005.89,-3503.68 7995.3,-3503.33 8003.36,-3510.21 8005.89,-3503.68"/>
</g>
<!-- attn_3_2&#45;&gt;agg_dim_3 -->
<g id="edge114" class="edge">
<title>attn_3_2&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M7945,-3462.11C7945,-3454.46 7945,-3445.25 7945,-3435.71"/>
<polygon fill="black" stroke="black" points="7948.5,-3435.71 7945,-3425.71 7941.5,-3435.71 7948.5,-3435.71"/>
</g>
<!-- attn_3_3 -->
<g id="node66" class="node">
<title>attn_3_3</title>
<polygon fill="lightgreen" stroke="black" points="8525,-3503.32 8347,-3503.32 8347,-3462.32 8525,-3462.32 8525,-3503.32"/>
<text text-anchor="middle" x="8436" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="8436" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="8436" y="-3469.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- q_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge118" class="edge">
<title>q_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M8362.49,-3540.25C8374.62,-3530.94 8389.28,-3519.69 8402.31,-3509.69"/>
<polygon fill="black" stroke="black" points="8404.79,-3512.19 8410.59,-3503.33 8400.53,-3506.64 8404.79,-3512.19"/>
</g>
<!-- k_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge119" class="edge">
<title>k_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M8508.02,-3540.25C8496.14,-3530.94 8481.78,-3519.69 8469.01,-3509.69"/>
<polygon fill="black" stroke="black" points="8470.93,-3506.74 8460.9,-3503.33 8466.61,-3512.25 8470.93,-3506.74"/>
</g>
<!-- v_proj_3_3&#45;&gt;attn_3_3 -->
<g id="edge120" class="edge">
<title>v_proj_3_3&#45;&gt;attn_3_3</title>
<path fill="none" stroke="black" d="M8653.55,-3540.25C8613.05,-3529.75 8562.99,-3516.76 8521.11,-3505.9"/>
<polygon fill="black" stroke="black" points="8521.76,-3502.45 8511.2,-3503.33 8520,-3509.23 8521.76,-3502.45"/>
</g>
<!-- attn_3_3&#45;&gt;agg_dim_3 -->
<g id="edge121" class="edge">
<title>attn_3_3&#45;&gt;agg_dim_3</title>
<path fill="none" stroke="black" d="M8346.8,-3462.29C8262.85,-3443.91 8137.17,-3416.4 8048.78,-3397.04"/>
<polygon fill="black" stroke="black" points="8049.51,-3393.62 8039,-3394.9 8048.02,-3400.46 8049.51,-3393.62"/>
</g>
<!-- agg_heads -->
<g id="node71" class="node">
<title>agg_heads</title>
<polygon fill="lightcoral" stroke="black" points="5792.32,-3284.32 5650.23,-3284.32 5613.68,-3202.32 5755.77,-3202.32 5792.32,-3284.32"/>
<text text-anchor="middle" x="5703" y="-3251.82" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="5703" y="-3240.82" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="5703" y="-3229.82" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_0&#45;&gt;agg_heads -->
<g id="edge122" class="edge">
<title>agg_dim_0&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M1560.47,-3369.79C2100.31,-3353.44 5092.63,-3262.81 5622.72,-3246.75"/>
<polygon fill="black" stroke="black" points="5623.06,-3250.25 5632.95,-3246.44 5622.84,-3243.25 5623.06,-3250.25"/>
</g>
<!-- agg_dim_1&#45;&gt;agg_heads -->
<g id="edge123" class="edge">
<title>agg_dim_1&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M3911.03,-3366.72C4221.08,-3345.54 5319.29,-3270.53 5624.05,-3249.72"/>
<polygon fill="black" stroke="black" points="5624.39,-3253.2 5634.13,-3249.03 5623.91,-3246.22 5624.39,-3253.2"/>
</g>
<!-- agg_dim_2&#45;&gt;agg_heads -->
<g id="edge124" class="edge">
<title>agg_dim_2&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M5703,-3321C5703,-3312.39 5703,-3303.47 5703,-3294.89"/>
<polygon fill="black" stroke="black" points="5706.5,-3294.63 5703,-3284.63 5699.5,-3294.63 5706.5,-3294.63"/>
</g>
<!-- agg_dim_3&#45;&gt;agg_heads -->
<g id="edge125" class="edge">
<title>agg_dim_3&#45;&gt;agg_heads</title>
<path fill="none" stroke="black" d="M7857.46,-3367.32C7498.13,-3346.81 6138.93,-3269.21 5786.75,-3249.1"/>
<polygon fill="black" stroke="black" points="5786.81,-3245.6 5776.62,-3248.53 5786.41,-3252.59 5786.81,-3245.6"/>
</g>
<!-- out_proj1 -->
<g id="node72" class="node">
<title>out_proj1</title>
<polygon fill="lightgreen" stroke="black" points="6648,-3165.32 6460,-3165.32 6460,-3124.32 6648,-3124.32 6648,-3165.32"/>
<text text-anchor="middle" x="6554" y="-3153.32" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="6554" y="-3142.32" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="6554" y="-3131.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads&#45;&gt;out_proj1 -->
<g id="edge126" class="edge">
<title>agg_heads&#45;&gt;out_proj1</title>
<path fill="none" stroke="black" d="M5770.49,-3234.67C5918.57,-3217.88 6272.86,-3177.7 6449.78,-3157.64"/>
<polygon fill="black" stroke="black" points="6450.34,-3161.1 6459.88,-3156.5 6449.55,-3154.14 6450.34,-3161.1"/>
</g>
<!-- out_proj1&#45;&gt;res1 -->
<g id="edge127" class="edge">
<title>out_proj1&#45;&gt;res1</title>
<path fill="none" stroke="black" d="M6648.1,-3139.69C6961.38,-3125.93 7970.1,-3081.64 8340.19,-3065.38"/>
<polygon fill="black" stroke="black" points="8340.59,-3068.87 8350.42,-3064.93 8340.28,-3061.88 8340.59,-3068.87"/>
</g>
<!-- ln2 -->
<g id="node74" class="node">
<title>ln2</title>
<polygon fill="lightgreen" stroke="black" points="8082,-2992.34 7894,-2992.34 7894,-2951.34 8082,-2951.34 8082,-2992.34"/>
<text text-anchor="middle" x="7988" y="-2980.34" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="7988" y="-2969.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7988" y="-2958.34" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;ln2 -->
<g id="edge129" class="edge">
<title>res1&#45;&gt;ln2</title>
<path fill="none" stroke="black" d="M8376.77,-3039.88C8293.56,-3025.53 8176.11,-3005.28 8092.12,-2990.79"/>
<polygon fill="black" stroke="black" points="8092.49,-2987.31 8082.04,-2989.06 8091.3,-2994.2 8092.49,-2987.31"/>
</g>
<!-- res2 -->
<g id="node85" class="node">
<title>res2</title>
<ellipse fill="lightgreen" stroke="black" cx="8459" cy="-2528.35" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="8459" y="-2536.85" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="8459" y="-2525.85" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8459" y="-2514.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res1&#45;&gt;res2 -->
<g id="edge148" class="edge">
<title>res1&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M8580.15,-3039.95C8613.9,-3027.88 8643,-3007.44 8643,-2972.84 8643,-2972.84 8643,-2972.84 8643,-2634.34 8643,-2592.12 8605.99,-2566.65 8565.17,-2551.4"/>
<polygon fill="black" stroke="black" points="8566.18,-2548.04 8555.58,-2548.02 8563.85,-2554.64 8566.18,-2548.04"/>
</g>
<!-- gate -->
<g id="node75" class="node">
<title>gate</title>
<polygon fill="lightsteelblue" stroke="black" points="8021.22,-2914.34 7736.12,-2914.34 7662.78,-2810.34 7947.88,-2810.34 8021.22,-2914.34"/>
<text text-anchor="middle" x="7842" y="-2876.34" font-family="Arial" font-size="10.00">Gate Network</text>
<text text-anchor="middle" x="7842" y="-2865.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8]</text>
<text text-anchor="middle" x="7842" y="-2854.34" font-family="Arial" font-size="10.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="7842" y="-2843.34" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln2&#45;&gt;gate -->
<g id="edge130" class="edge">
<title>ln2&#45;&gt;gate</title>
<path fill="none" stroke="black" d="M7961.22,-2951.12C7949.34,-2942.38 7934.69,-2931.59 7919.78,-2920.61"/>
<polygon fill="black" stroke="black" points="7921.6,-2917.61 7911.48,-2914.5 7917.45,-2923.24 7921.6,-2917.61"/>
</g>
<!-- expert_0 -->
<g id="node76" class="node">
<title>expert_0</title>
<polygon fill="lightseagreen" stroke="black" points="8418,-2765.34 8230,-2765.34 8230,-2713.34 8418,-2713.34 8418,-2765.34"/>
<text text-anchor="middle" x="8324" y="-2753.34" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="8324" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="8324" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8324" y="-2720.34" font-family="Arial" font-size="10.00">GPU 0&#45;1</text>
</g>
<!-- ln2&#45;&gt;expert_0 -->
<g id="edge131" class="edge">
<title>ln2&#45;&gt;expert_0</title>
<path fill="none" stroke="black" d="M8032.86,-2951.31C8094.89,-2922.79 8208.14,-2865.12 8287,-2792.34 8292.9,-2786.9 8298.42,-2780.37 8303.31,-2773.81"/>
<polygon fill="black" stroke="black" points="8306.22,-2775.75 8309.14,-2765.57 8300.51,-2771.71 8306.22,-2775.75"/>
</g>
<!-- expert_1 -->
<g id="node77" class="node">
<title>expert_1</title>
<polygon fill="lightseagreen" stroke="black" points="7800,-2765.34 7612,-2765.34 7612,-2713.34 7800,-2713.34 7800,-2765.34"/>
<text text-anchor="middle" x="7706" y="-2753.34" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="7706" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="7706" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7706" y="-2720.34" font-family="Arial" font-size="10.00">GPU 2&#45;3</text>
</g>
<!-- ln2&#45;&gt;expert_1 -->
<g id="edge133" class="edge">
<title>ln2&#45;&gt;expert_1</title>
<path fill="none" stroke="black" d="M7893.79,-2967.76C7806.26,-2962.72 7684.9,-2949.43 7654,-2914.34 7615.49,-2870.62 7623.02,-2835.49 7649,-2783.34 7650.9,-2779.53 7653.31,-2775.97 7656.06,-2772.67"/>
<polygon fill="black" stroke="black" points="7658.64,-2775.04 7663.04,-2765.4 7653.59,-2770.19 7658.64,-2775.04"/>
</g>
<!-- expert_2 -->
<g id="node78" class="node">
<title>expert_2</title>
<polygon fill="lightseagreen" stroke="black" points="8624,-2765.34 8436,-2765.34 8436,-2713.34 8624,-2713.34 8624,-2765.34"/>
<text text-anchor="middle" x="8530" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="8530" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="8530" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8530" y="-2720.34" font-family="Arial" font-size="10.00">GPU 4&#45;5</text>
</g>
<!-- ln2&#45;&gt;expert_2 -->
<g id="edge135" class="edge">
<title>ln2&#45;&gt;expert_2</title>
<path fill="none" stroke="black" d="M8073.64,-2951.3C8110.61,-2941.79 8154.01,-2929.2 8192,-2914.34 8298.11,-2872.84 8414.81,-2808.19 8479.57,-2770.48"/>
<polygon fill="black" stroke="black" points="8481.49,-2773.41 8488.35,-2765.34 8477.95,-2767.37 8481.49,-2773.41"/>
</g>
<!-- expert_3 -->
<g id="node79" class="node">
<title>expert_3</title>
<polygon fill="lightseagreen" stroke="black" points="7388,-2765.34 7200,-2765.34 7200,-2713.34 7388,-2713.34 7388,-2765.34"/>
<text text-anchor="middle" x="7294" y="-2753.34" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="7294" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="7294" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7294" y="-2720.34" font-family="Arial" font-size="10.00">GPU 6&#45;7</text>
</g>
<!-- ln2&#45;&gt;expert_3 -->
<g id="edge137" class="edge">
<title>ln2&#45;&gt;expert_3</title>
<path fill="none" stroke="black" d="M7893.88,-2970.98C7799.17,-2968.43 7650.16,-2957.04 7529,-2914.34 7428.64,-2878.97 7397.26,-2868.55 7323,-2792.34 7317.84,-2787.05 7313.3,-2780.65 7309.44,-2774.19"/>
<polygon fill="black" stroke="black" points="7312.5,-2772.48 7304.6,-2765.42 7306.37,-2775.87 7312.5,-2772.48"/>
</g>
<!-- expert_4 -->
<g id="node80" class="node">
<title>expert_4</title>
<polygon fill="lightseagreen" stroke="black" points="8212,-2765.34 8024,-2765.34 8024,-2713.34 8212,-2713.34 8212,-2765.34"/>
<text text-anchor="middle" x="8118" y="-2753.34" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="8118" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="8118" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="8118" y="-2720.34" font-family="Arial" font-size="10.00">GPU 8&#45;9</text>
</g>
<!-- ln2&#45;&gt;expert_4 -->
<g id="edge139" class="edge">
<title>ln2&#45;&gt;expert_4</title>
<path fill="none" stroke="black" d="M8011.07,-2951.31C8022.4,-2941.02 8035.79,-2927.77 8046,-2914.34 8083.45,-2865.11 8094.78,-2851.46 8113,-2792.34 8114.65,-2786.98 8115.8,-2781.17 8116.59,-2775.44"/>
<polygon fill="black" stroke="black" points="8120.08,-2775.65 8117.65,-2765.34 8113.12,-2774.92 8120.08,-2775.65"/>
</g>
<!-- expert_5 -->
<g id="node81" class="node">
<title>expert_5</title>
<polygon fill="lightseagreen" stroke="black" points="7182,-2765.34 6994,-2765.34 6994,-2713.34 7182,-2713.34 7182,-2765.34"/>
<text text-anchor="middle" x="7088" y="-2753.34" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="7088" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="7088" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7088" y="-2720.34" font-family="Arial" font-size="10.00">GPU 10&#45;11</text>
</g>
<!-- ln2&#45;&gt;expert_5 -->
<g id="edge141" class="edge">
<title>ln2&#45;&gt;expert_5</title>
<path fill="none" stroke="black" d="M7893.97,-2968.65C7738.92,-2964.04 7436.84,-2950.59 7337,-2914.34 7250.31,-2882.87 7165.86,-2813.19 7121.04,-2772.2"/>
<polygon fill="black" stroke="black" points="7123.39,-2769.6 7113.67,-2765.39 7118.64,-2774.74 7123.39,-2769.6"/>
</g>
<!-- expert_6 -->
<g id="node82" class="node">
<title>expert_6</title>
<polygon fill="lightseagreen" stroke="black" points="8006,-2765.34 7818,-2765.34 7818,-2713.34 8006,-2713.34 8006,-2765.34"/>
<text text-anchor="middle" x="7912" y="-2753.34" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="7912" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="7912" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7912" y="-2720.34" font-family="Arial" font-size="10.00">GPU 12&#45;13</text>
</g>
<!-- ln2&#45;&gt;expert_6 -->
<g id="edge143" class="edge">
<title>ln2&#45;&gt;expert_6</title>
<path fill="none" stroke="black" d="M8007.26,-2951.14C8015.89,-2941 8025.19,-2927.94 8030,-2914.34 8049.44,-2859.41 8068.72,-2830.85 8035,-2783.34 8031.52,-2778.43 8024.17,-2773.71 8014.71,-2769.3"/>
<polygon fill="black" stroke="black" points="8016.05,-2766.07 8005.48,-2765.35 8013.29,-2772.5 8016.05,-2766.07"/>
</g>
<!-- expert_7 -->
<g id="node83" class="node">
<title>expert_7</title>
<polygon fill="lightseagreen" stroke="black" points="7594,-2765.34 7406,-2765.34 7406,-2713.34 7594,-2713.34 7594,-2765.34"/>
<text text-anchor="middle" x="7500" y="-2753.34" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="7500" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="7500" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7500" y="-2720.34" font-family="Arial" font-size="10.00">GPU 14&#45;15</text>
</g>
<!-- ln2&#45;&gt;expert_7 -->
<g id="edge145" class="edge">
<title>ln2&#45;&gt;expert_7</title>
<path fill="none" stroke="black" d="M7893.74,-2965.6C7800.45,-2958.78 7665.61,-2944.04 7623,-2914.34 7565.26,-2874.08 7558.55,-2852.5 7522,-2792.34 7518.66,-2786.84 7515.59,-2780.75 7512.86,-2774.72"/>
<polygon fill="black" stroke="black" points="7516.03,-2773.22 7508.88,-2765.4 7509.59,-2775.97 7516.03,-2773.22"/>
</g>
<!-- gate&#45;&gt;expert_0 -->
<g id="edge1" class="edge">
<title>gate&#45;&gt;expert_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7960.74,-2828.37C8014.15,-2813.92 8078.08,-2797.15 8136,-2783.34 8170.63,-2775.09 8181.65,-2774.02 8219.5,-2765.64"/>
<polygon fill="black" stroke="black" points="8220.74,-2768.95 8229.73,-2763.34 8219.2,-2762.12 8220.74,-2768.95"/>
<text text-anchor="middle" x="8160" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_1 -->
<g id="edge2" class="edge">
<title>gate&#45;&gt;expert_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7798.67,-2810.03C7789.9,-2800.74 7780.46,-2791.44 7771,-2783.34 7766.21,-2779.24 7761.01,-2775.21 7755.71,-2771.35"/>
<polygon fill="black" stroke="black" points="7757.54,-2768.35 7747.34,-2765.46 7753.51,-2774.08 7757.54,-2768.35"/>
<text text-anchor="middle" x="7803" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_2 -->
<g id="edge3" class="edge">
<title>gate&#45;&gt;expert_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7971.18,-2843C8087.63,-2825.81 8263.65,-2798.18 8425.61,-2765.57"/>
<polygon fill="black" stroke="black" points="8426.66,-2768.93 8435.76,-2763.51 8425.27,-2762.07 8426.66,-2768.93"/>
<text text-anchor="middle" x="8355" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_3 -->
<g id="edge4" class="edge">
<title>gate&#45;&gt;expert_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7670.83,-2822.24C7613.72,-2809.48 7549.69,-2795.48 7491,-2783.34 7452.19,-2775.31 7440.19,-2774.45 7398.04,-2765.52"/>
<polygon fill="black" stroke="black" points="7398.77,-2762.09 7388.26,-2763.41 7397.3,-2768.94 7398.77,-2762.09"/>
<text text-anchor="middle" x="7553" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_4 -->
<g id="edge5" class="edge">
<title>gate&#45;&gt;expert_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7936.7,-2810.16C7955.46,-2800.76 7975.18,-2791.38 7994,-2783.34 8005.77,-2778.31 8018.35,-2773.41 8030.81,-2768.84"/>
<polygon fill="black" stroke="black" points="8032.09,-2772.1 8040.3,-2765.41 8029.71,-2765.52 8032.09,-2772.1"/>
<text text-anchor="middle" x="8018" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_5 -->
<g id="edge6" class="edge">
<title>gate&#45;&gt;expert_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7685.11,-2842.31C7555.28,-2825.59 7365.97,-2799.01 7192.07,-2765.48"/>
<polygon fill="black" stroke="black" points="7192.71,-2762.04 7182.22,-2763.58 7191.37,-2768.92 7192.71,-2762.04"/>
<text text-anchor="middle" x="7356" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_6 -->
<g id="edge7" class="edge">
<title>gate&#45;&gt;expert_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7871.69,-2810.03C7878.67,-2797.95 7885.95,-2785.37 7892.37,-2774.28"/>
<polygon fill="black" stroke="black" points="7895.55,-2775.76 7897.53,-2765.36 7889.49,-2772.26 7895.55,-2775.76"/>
<text text-anchor="middle" x="7909" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- gate&#45;&gt;expert_7 -->
<g id="edge8" class="edge">
<title>gate&#45;&gt;expert_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7701.83,-2810.32C7676.61,-2801.25 7650.55,-2791.96 7626,-2783.34 7612.36,-2778.55 7597.86,-2773.53 7583.73,-2768.68"/>
<polygon fill="black" stroke="black" points="7584.62,-2765.29 7574.03,-2765.36 7582.36,-2771.91 7584.62,-2765.29"/>
<text text-anchor="middle" x="7673" y="-2785.94" font-family="Arial" font-size="8.00">Top&#45;2 routing</text>
</g>
<!-- expert_agg -->
<g id="node84" class="node">
<title>expert_agg</title>
<polygon fill="lightcoral" stroke="black" points="8119.2,-2676.34 7789.59,-2676.34 7704.8,-2594.34 8034.41,-2594.34 8119.2,-2676.34"/>
<text text-anchor="middle" x="7912" y="-2643.84" font-family="Arial" font-size="10.00">Weighted Sum</text>
<text text-anchor="middle" x="7912" y="-2632.84" font-family="Arial" font-size="10.00">8×[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="7912" y="-2621.84" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- expert_0&#45;&gt;expert_agg -->
<g id="edge132" class="edge">
<title>expert_0&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8230,-2715.07C8186.69,-2704.35 8133.9,-2691.28 8083.87,-2678.89"/>
<polygon fill="black" stroke="black" points="8084.45,-2675.43 8073.9,-2676.42 8082.77,-2682.22 8084.45,-2675.43"/>
</g>
<!-- expert_1&#45;&gt;expert_agg -->
<g id="edge134" class="edge">
<title>expert_1&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7756.66,-2713.26C7776.34,-2703.51 7799.5,-2692.04 7821.84,-2680.98"/>
<polygon fill="black" stroke="black" points="7823.61,-2684.01 7831.02,-2676.44 7820.5,-2677.74 7823.61,-2684.01"/>
</g>
<!-- expert_2&#45;&gt;expert_agg -->
<g id="edge136" class="edge">
<title>expert_2&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8435.78,-2715.11C8432.82,-2714.5 8429.89,-2713.91 8427,-2713.34 8324.07,-2693.2 8208.66,-2675.49 8113.22,-2662.16"/>
<polygon fill="black" stroke="black" points="8113.55,-2658.67 8103.16,-2660.76 8112.59,-2665.61 8113.55,-2658.67"/>
</g>
<!-- expert_3&#45;&gt;expert_agg -->
<g id="edge138" class="edge">
<title>expert_3&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7388.22,-2715.11C7391.18,-2714.5 7394.11,-2713.91 7397,-2713.34 7517.1,-2689.84 7654.18,-2669.66 7756.71,-2655.86"/>
<polygon fill="black" stroke="black" points="7757.39,-2659.3 7766.84,-2654.51 7756.46,-2652.37 7757.39,-2659.3"/>
</g>
<!-- expert_4&#45;&gt;expert_agg -->
<g id="edge140" class="edge">
<title>expert_4&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M8067.34,-2713.26C8047.66,-2703.51 8024.5,-2692.04 8002.16,-2680.98"/>
<polygon fill="black" stroke="black" points="8003.5,-2677.74 7992.98,-2676.44 8000.39,-2684.01 8003.5,-2677.74"/>
</g>
<!-- expert_5&#45;&gt;expert_agg -->
<g id="edge142" class="edge">
<title>expert_5&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7182.2,-2714.95C7185.16,-2714.38 7188.1,-2713.84 7191,-2713.34 7381.19,-2680.25 7602.24,-2659.17 7748.93,-2647.59"/>
<polygon fill="black" stroke="black" points="7749.23,-2651.08 7758.93,-2646.81 7748.68,-2644.1 7749.23,-2651.08"/>
</g>
<!-- expert_6&#45;&gt;expert_agg -->
<g id="edge144" class="edge">
<title>expert_6&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7912,-2713.13C7912,-2704.98 7912,-2695.65 7912,-2686.35"/>
<polygon fill="black" stroke="black" points="7915.5,-2686.35 7912,-2676.35 7908.5,-2686.35 7915.5,-2686.35"/>
</g>
<!-- expert_7&#45;&gt;expert_agg -->
<g id="edge146" class="edge">
<title>expert_7&#45;&gt;expert_agg</title>
<path fill="none" stroke="black" d="M7594,-2715.07C7646.54,-2702.06 7713.03,-2685.6 7771.61,-2671.1"/>
<polygon fill="black" stroke="black" points="7772.45,-2674.49 7781.32,-2668.69 7770.77,-2667.7 7772.45,-2674.49"/>
</g>
<!-- expert_agg&#45;&gt;res2 -->
<g id="edge147" class="edge">
<title>expert_agg&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M8048.97,-2608.05C8142.82,-2590.04 8265.52,-2566.49 8352.16,-2549.86"/>
<polygon fill="black" stroke="black" points="8352.85,-2553.29 8362.01,-2547.96 8351.53,-2546.41 8352.85,-2553.29"/>
</g>
<!-- ln2_1 -->
<g id="node86" class="node">
<title>ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="14349,-3664.82 14161,-3664.82 14161,-3623.82 14349,-3623.82 14349,-3664.82"/>
<text text-anchor="middle" x="14255" y="-3652.82" font-family="Arial" font-size="10.00">LayerNorm 2.1</text>
<text text-anchor="middle" x="14255" y="-3641.82" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="14255" y="-3630.82" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- q_proj_2_0_0 -->
<g id="node87" class="node">
<title>q_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="11012,-3581.32 10834,-3581.32 10834,-3540.32 11012,-3540.32 11012,-3581.32"/>
<text text-anchor="middle" x="10923" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="10923" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10923" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_0_0 -->
<g id="edge174" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_0_0</title>
<path fill="none" stroke="black" d="M14160.95,-3642.34C13818.76,-3638.65 12607.69,-3624.57 11609,-3600.32 11350.93,-3594.06 11282.49,-3610.73 11022.24,-3581.35"/>
<polygon fill="black" stroke="black" points="11022.43,-3577.85 11012.1,-3580.2 11021.64,-3584.81 11022.43,-3577.85"/>
</g>
<!-- k_proj_2_0_0 -->
<g id="node88" class="node">
<title>k_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="11208,-3581.32 11030,-3581.32 11030,-3540.32 11208,-3540.32 11208,-3581.32"/>
<text text-anchor="middle" x="11119" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11119" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11119" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_0_0 -->
<g id="edge175" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_0_0</title>
<path fill="none" stroke="black" d="M14160.8,-3642.72C13821.38,-3640.33 12629.15,-3630.19 11646,-3600.32 11458.49,-3594.63 11408.18,-3603.91 11218.15,-3581.36"/>
<polygon fill="black" stroke="black" points="11218.45,-3577.87 11208.11,-3580.15 11217.62,-3584.82 11218.45,-3577.87"/>
</g>
<!-- v_proj_2_0_0 -->
<g id="node89" class="node">
<title>v_proj_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="10816,-3581.32 10638,-3581.32 10638,-3540.32 10816,-3540.32 10816,-3581.32"/>
<text text-anchor="middle" x="10727" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10727" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10727" y="-3547.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_0_0 -->
<g id="edge176" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_0_0</title>
<path fill="none" stroke="black" d="M14160.88,-3642.9C13792.68,-3641.03 12414.34,-3632.2 11280,-3600.32 11080.94,-3594.73 11027.67,-3605.02 10826.13,-3581.35"/>
<polygon fill="black" stroke="black" points="10826.45,-3577.86 10816.1,-3580.16 10825.62,-3584.82 10826.45,-3577.86"/>
</g>
<!-- q_proj_2_0_1 -->
<g id="node91" class="node">
<title>q_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="10424,-3581.32 10246,-3581.32 10246,-3540.32 10424,-3540.32 10424,-3581.32"/>
<text text-anchor="middle" x="10335" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="10335" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10335" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_0_1 -->
<g id="edge181" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_0_1</title>
<path fill="none" stroke="black" d="M14160.69,-3643.19C13761.71,-3642.43 12172.99,-3637.1 10868,-3600.32 10677.87,-3594.96 10626.86,-3604.17 10434.28,-3581.37"/>
<polygon fill="black" stroke="black" points="10434.45,-3577.87 10424.11,-3580.15 10433.62,-3584.82 10434.45,-3577.87"/>
</g>
<!-- k_proj_2_0_1 -->
<g id="node92" class="node">
<title>k_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="10620,-3581.32 10442,-3581.32 10442,-3540.32 10620,-3540.32 10620,-3581.32"/>
<text text-anchor="middle" x="10531" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="10531" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10531" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_0_1 -->
<g id="edge182" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_0_1</title>
<path fill="none" stroke="black" d="M14160.92,-3642.56C13789.84,-3639.41 12391.68,-3626.39 11241,-3600.32 10972.26,-3594.23 10901.1,-3611.77 10630.23,-3581.35"/>
<polygon fill="black" stroke="black" points="10630.43,-3577.85 10620.1,-3580.2 10629.64,-3584.81 10630.43,-3577.85"/>
</g>
<!-- v_proj_2_0_1 -->
<g id="node93" class="node">
<title>v_proj_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="10228,-3581.32 10050,-3581.32 10050,-3540.32 10228,-3540.32 10228,-3581.32"/>
<text text-anchor="middle" x="10139" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10139" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10139" y="-3547.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_0_1 -->
<g id="edge183" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_0_1</title>
<path fill="none" stroke="black" d="M14160.67,-3642.81C13758.94,-3640.49 12150.94,-3629.77 10830,-3600.32 10569.72,-3594.52 10500.72,-3610.95 10238.32,-3581.36"/>
<polygon fill="black" stroke="black" points="10238.43,-3577.85 10228.1,-3580.2 10237.64,-3584.81 10238.43,-3577.85"/>
</g>
<!-- q_proj_2_0_2 -->
<g id="node95" class="node">
<title>q_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="11404,-3581.32 11226,-3581.32 11226,-3540.32 11404,-3540.32 11404,-3581.32"/>
<text text-anchor="middle" x="11315" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11315" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11315" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_0_2 -->
<g id="edge188" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_0_2</title>
<path fill="none" stroke="black" d="M14160.88,-3641.61C13863.93,-3636.15 12920.28,-3618.48 12139,-3600.32 11819.62,-3592.9 11735.5,-3616.67 11414.16,-3581.34"/>
<polygon fill="black" stroke="black" points="11414.42,-3577.84 11404.1,-3580.22 11413.65,-3584.8 11414.42,-3577.84"/>
</g>
<!-- k_proj_2_0_2 -->
<g id="node96" class="node">
<title>k_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="11600,-3581.32 11422,-3581.32 11422,-3540.32 11600,-3540.32 11600,-3581.32"/>
<text text-anchor="middle" x="11511" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11511" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11511" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_0_2 -->
<g id="edge189" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_0_2</title>
<path fill="none" stroke="black" d="M14160.99,-3641.77C13868.63,-3636.85 12949.33,-3620.73 12188,-3600.32 11933.89,-3593.51 11866.49,-3610.33 11610.09,-3581.34"/>
<polygon fill="black" stroke="black" points="11610.43,-3577.85 11600.1,-3580.19 11609.64,-3584.81 11610.43,-3577.85"/>
</g>
<!-- v_proj_2_0_2 -->
<g id="node97" class="node">
<title>v_proj_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="11796,-3581.32 11618,-3581.32 11618,-3540.32 11796,-3540.32 11796,-3581.32"/>
<text text-anchor="middle" x="11707" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="11707" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11707" y="-3547.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_0_2 -->
<g id="edge190" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_0_2</title>
<path fill="none" stroke="black" d="M14160.88,-3642.13C13871.78,-3638.31 12971.03,-3625.1 12225,-3600.32 12041.53,-3594.23 11992.22,-3603.51 11806.22,-3581.37"/>
<polygon fill="black" stroke="black" points="11806.45,-3577.87 11796.11,-3580.15 11805.62,-3584.82 11806.45,-3577.87"/>
</g>
<!-- q_proj_2_0_3 -->
<g id="node99" class="node">
<title>q_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="9640,-3581.32 9462,-3581.32 9462,-3540.32 9640,-3540.32 9640,-3581.32"/>
<text text-anchor="middle" x="9551" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="9551" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9551" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_0_3 -->
<g id="edge195" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_0_3</title>
<path fill="none" stroke="black" d="M14160.94,-3643.52C13708.91,-3644.25 11714.58,-3644.65 10081,-3600.32 9892.17,-3595.2 9841.52,-3604.05 9650.21,-3581.36"/>
<polygon fill="black" stroke="black" points="9650.45,-3577.87 9640.11,-3580.15 9649.62,-3584.82 9650.45,-3577.87"/>
</g>
<!-- k_proj_2_0_3 -->
<g id="node100" class="node">
<title>k_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="9836,-3581.32 9658,-3581.32 9658,-3540.32 9836,-3540.32 9836,-3581.32"/>
<text text-anchor="middle" x="9747" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9747" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9747" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_0_3 -->
<g id="edge196" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_0_3</title>
<path fill="none" stroke="black" d="M14160.85,-3642.96C13733.07,-3641.14 11929.48,-3631.91 10450,-3600.32 10184.32,-3594.65 10113.99,-3611.48 9846.12,-3581.34"/>
<polygon fill="black" stroke="black" points="9846.43,-3577.85 9836.1,-3580.2 9845.64,-3584.81 9846.43,-3577.85"/>
</g>
<!-- v_proj_2_0_3 -->
<g id="node101" class="node">
<title>v_proj_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="10032,-3581.32 9854,-3581.32 9854,-3540.32 10032,-3540.32 10032,-3581.32"/>
<text text-anchor="middle" x="9943" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9943" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9943" y="-3547.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_0_3 -->
<g id="edge197" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_0_3</title>
<path fill="none" stroke="black" d="M14160.74,-3643.32C13735.39,-3643.09 11951.9,-3639.69 10489,-3600.32 10293.09,-3595.05 10240.6,-3604.73 10042.28,-3581.37"/>
<polygon fill="black" stroke="black" points="10042.45,-3577.87 10032.1,-3580.16 10041.62,-3584.82 10042.45,-3577.87"/>
</g>
<!-- q_proj_2_1_0 -->
<g id="node103" class="node">
<title>q_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="13756,-3581.32 13578,-3581.32 13578,-3540.32 13756,-3540.32 13756,-3581.32"/>
<text text-anchor="middle" x="13667" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="13667" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13667" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_0 -->
<g id="edge202" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_0</title>
<path fill="none" stroke="black" d="M14238.16,-3623.63C14229.07,-3614.47 14217.05,-3604.48 14204,-3599.32 14160.82,-3582.25 13846.46,-3586.6 13766.5,-3581.09"/>
<polygon fill="black" stroke="black" points="13766.38,-3577.57 13756.1,-3580.16 13765.75,-3584.54 13766.38,-3577.57"/>
</g>
<!-- k_proj_2_1_0 -->
<g id="node104" class="node">
<title>k_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="13952,-3581.32 13774,-3581.32 13774,-3540.32 13952,-3540.32 13952,-3581.32"/>
<text text-anchor="middle" x="13863" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13863" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13863" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_0 -->
<g id="edge203" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_0</title>
<path fill="none" stroke="black" d="M14246.93,-3623.49C14242.22,-3614.53 14235.33,-3604.76 14226,-3599.32 14177.4,-3570.98 14033.86,-3587.38 13962.16,-3581.15"/>
<polygon fill="black" stroke="black" points="13962.44,-3577.66 13952.12,-3580.06 13961.68,-3584.62 13962.44,-3577.66"/>
</g>
<!-- v_proj_2_1_0 -->
<g id="node105" class="node">
<title>v_proj_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="14148,-3581.32 13970,-3581.32 13970,-3540.32 14148,-3540.32 14148,-3581.32"/>
<text text-anchor="middle" x="14059" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14059" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14059" y="-3547.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_0 -->
<g id="edge204" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_0</title>
<path fill="none" stroke="black" d="M14252.75,-3623.8C14250.76,-3615.13 14247.02,-3605.52 14240,-3599.32 14239.11,-3598.53 14199.96,-3590.38 14158.3,-3581.88"/>
<polygon fill="black" stroke="black" points="14158.75,-3578.4 14148.25,-3579.83 14157.35,-3585.26 14158.75,-3578.4"/>
</g>
<!-- q_proj_2_1_1 -->
<g id="node107" class="node">
<title>q_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="11992,-3581.32 11814,-3581.32 11814,-3540.32 11992,-3540.32 11992,-3581.32"/>
<text text-anchor="middle" x="11903" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11903" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11903" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_1 -->
<g id="edge209" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_1</title>
<path fill="none" stroke="black" d="M14160.79,-3642.85C13792.65,-3640.69 12450.06,-3629.67 12002.19,-3581.33"/>
<polygon fill="black" stroke="black" points="12002.42,-3577.83 11992.1,-3580.21 12001.65,-3584.79 12002.42,-3577.83"/>
</g>
<!-- k_proj_2_1_1 -->
<g id="node108" class="node">
<title>k_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="12188,-3581.32 12010,-3581.32 12010,-3540.32 12188,-3540.32 12188,-3581.32"/>
<text text-anchor="middle" x="12099" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="12099" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12099" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_1 -->
<g id="edge210" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_1</title>
<path fill="none" stroke="black" d="M14160.69,-3640.62C13928.6,-3633.94 13311.13,-3616.08 12796,-3600.32 12533.15,-3592.28 12463.39,-3611.15 12198.42,-3581.37"/>
<polygon fill="black" stroke="black" points="12198.43,-3577.85 12188.1,-3580.2 12197.64,-3584.81 12198.43,-3577.85"/>
</g>
<!-- v_proj_2_1_1 -->
<g id="node109" class="node">
<title>v_proj_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="12384,-3581.32 12206,-3581.32 12206,-3540.32 12384,-3540.32 12384,-3581.32"/>
<text text-anchor="middle" x="12295" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12295" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12295" y="-3547.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_1 -->
<g id="edge211" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_1</title>
<path fill="none" stroke="black" d="M14160.74,-3640.95C13931.62,-3635.09 13327.25,-3619.03 12823,-3600.32 12635.1,-3593.35 12584.63,-3603.91 12394.17,-3581.36"/>
<polygon fill="black" stroke="black" points="12394.45,-3577.87 12384.11,-3580.15 12393.62,-3584.82 12394.45,-3577.87"/>
</g>
<!-- q_proj_2_1_2 -->
<g id="node111" class="node">
<title>q_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="12580,-3581.32 12402,-3581.32 12402,-3540.32 12580,-3540.32 12580,-3581.32"/>
<text text-anchor="middle" x="12491" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12491" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12491" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_2 -->
<g id="edge216" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_2</title>
<path fill="none" stroke="black" d="M14160.83,-3641.79C13858.92,-3636.58 12916.45,-3617.84 12590.05,-3581.32"/>
<polygon fill="black" stroke="black" points="12590.44,-3577.84 12580.1,-3580.18 12589.64,-3584.79 12590.44,-3577.84"/>
</g>
<!-- k_proj_2_1_2 -->
<g id="node112" class="node">
<title>k_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="12776,-3581.32 12598,-3581.32 12598,-3540.32 12776,-3540.32 12776,-3581.32"/>
<text text-anchor="middle" x="12687" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="12687" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12687" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_2 -->
<g id="edge217" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_2</title>
<path fill="none" stroke="black" d="M14160.82,-3639.01C13983.4,-3630.92 13587.49,-3613.05 13254,-3599.32 13048.84,-3590.88 12993.87,-3605.29 12786.11,-3581.34"/>
<polygon fill="black" stroke="black" points="12786.44,-3577.86 12776.1,-3580.17 12785.63,-3584.81 12786.44,-3577.86"/>
</g>
<!-- v_proj_2_1_2 -->
<g id="node113" class="node">
<title>v_proj_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="12972,-3581.32 12794,-3581.32 12794,-3540.32 12972,-3540.32 12972,-3581.32"/>
<text text-anchor="middle" x="12883" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12883" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12883" y="-3547.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_2 -->
<g id="edge218" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_2</title>
<path fill="none" stroke="black" d="M14160.82,-3633.67C14056.38,-3623.36 13882.84,-3607.42 13733,-3599.32 13402.59,-3581.46 13315.08,-3617.33 12982.51,-3581.37"/>
<polygon fill="black" stroke="black" points="12982.42,-3577.84 12972.1,-3580.23 12981.66,-3584.8 12982.42,-3577.84"/>
</g>
<!-- q_proj_2_1_3 -->
<g id="node115" class="node">
<title>q_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="13168,-3581.32 12990,-3581.32 12990,-3540.32 13168,-3540.32 13168,-3581.32"/>
<text text-anchor="middle" x="13079" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="13079" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13079" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_1_3 -->
<g id="edge223" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_1_3</title>
<path fill="none" stroke="black" d="M14160.8,-3625.25C14106.9,-3615.72 14037.9,-3604.88 13976,-3599.32 13625.5,-3567.88 13531.81,-3619.16 13178.1,-3581.32"/>
<polygon fill="black" stroke="black" points="13178.42,-3577.83 13168.1,-3580.23 13177.66,-3584.79 13178.42,-3577.83"/>
</g>
<!-- k_proj_2_1_3 -->
<g id="node116" class="node">
<title>k_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="13364,-3581.32 13186,-3581.32 13186,-3540.32 13364,-3540.32 13364,-3581.32"/>
<text text-anchor="middle" x="13275" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13275" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13275" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_1_3 -->
<g id="edge224" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_1_3</title>
<path fill="none" stroke="black" d="M14199.44,-3623.76C14170.48,-3614.51 14134.26,-3604.4 14101,-3599.32 13944.07,-3575.36 13549.26,-3598.27 13374.05,-3581.26"/>
<polygon fill="black" stroke="black" points="13374.41,-3577.78 13364.1,-3580.23 13373.68,-3584.74 13374.41,-3577.78"/>
</g>
<!-- v_proj_2_1_3 -->
<g id="node117" class="node">
<title>v_proj_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="13560,-3581.32 13382,-3581.32 13382,-3540.32 13560,-3540.32 13560,-3581.32"/>
<text text-anchor="middle" x="13471" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13471" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13471" y="-3547.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_1_3 -->
<g id="edge225" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_1_3</title>
<path fill="none" stroke="black" d="M14224.11,-3623.73C14207.8,-3614.48 14187.04,-3604.37 14167,-3599.32 14041.1,-3567.6 13716.78,-3595 13570.33,-3581.27"/>
<polygon fill="black" stroke="black" points="13570.41,-3577.76 13560.1,-3580.2 13569.68,-3584.72 13570.41,-3577.76"/>
</g>
<!-- q_proj_2_2_0 -->
<g id="node119" class="node">
<title>q_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="14540,-3581.32 14362,-3581.32 14362,-3540.32 14540,-3540.32 14540,-3581.32"/>
<text text-anchor="middle" x="14451" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14451" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14451" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_2_0 -->
<g id="edge230" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_2_0</title>
<path fill="none" stroke="black" d="M14301.95,-3623.8C14329.85,-3612.2 14365.4,-3597.42 14394.79,-3585.2"/>
<polygon fill="black" stroke="black" points="14396.21,-3588.4 14404.1,-3581.33 14393.52,-3581.93 14396.21,-3588.4"/>
</g>
<!-- k_proj_2_2_0 -->
<g id="node120" class="node">
<title>k_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="14736,-3581.32 14558,-3581.32 14558,-3540.32 14736,-3540.32 14736,-3581.32"/>
<text text-anchor="middle" x="14647" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14647" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14647" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_2_0 -->
<g id="edge231" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_2_0</title>
<path fill="none" stroke="black" d="M14348.89,-3623.8C14408.97,-3611.31 14486.8,-3595.13 14547.87,-3582.43"/>
<polygon fill="black" stroke="black" points="14548.83,-3585.81 14557.91,-3580.35 14547.41,-3578.95 14548.83,-3585.81"/>
</g>
<!-- v_proj_2_2_0 -->
<g id="node121" class="node">
<title>v_proj_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="14344,-3581.32 14166,-3581.32 14166,-3540.32 14344,-3540.32 14344,-3581.32"/>
<text text-anchor="middle" x="14255" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14255" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14255" y="-3547.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_2_0 -->
<g id="edge232" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_2_0</title>
<path fill="none" stroke="black" d="M14255,-3623.59C14255,-3613.98 14255,-3602.23 14255,-3591.56"/>
<polygon fill="black" stroke="black" points="14258.5,-3591.37 14255,-3581.37 14251.5,-3591.37 14258.5,-3591.37"/>
</g>
<!-- q_proj_2_2_1 -->
<g id="node123" class="node">
<title>q_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="15520,-3581.32 15342,-3581.32 15342,-3540.32 15520,-3540.32 15520,-3581.32"/>
<text text-anchor="middle" x="15431" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15431" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15431" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_2_1 -->
<g id="edge237" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_2_1</title>
<path fill="none" stroke="black" d="M14349.13,-3642.3C14535.26,-3639.32 14963.49,-3627.69 15331.83,-3581.38"/>
<polygon fill="black" stroke="black" points="15332.41,-3584.83 15341.89,-3580.1 15331.53,-3577.89 15332.41,-3584.83"/>
</g>
<!-- k_proj_2_2_1 -->
<g id="node124" class="node">
<title>k_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="15716,-3581.32 15538,-3581.32 15538,-3540.32 15716,-3540.32 15716,-3581.32"/>
<text text-anchor="middle" x="15627" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15627" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15627" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_2_1 -->
<g id="edge238" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_2_1</title>
<path fill="none" stroke="black" d="M14349.09,-3639.07C14514.8,-3631.55 14869.53,-3615.27 15169,-3600.32 15325.74,-3592.5 15368.29,-3600.87 15527.72,-3581.38"/>
<polygon fill="black" stroke="black" points="15528.4,-3584.82 15537.89,-3580.12 15527.54,-3577.88 15528.4,-3584.82"/>
</g>
<!-- v_proj_2_2_1 -->
<g id="node125" class="node">
<title>v_proj_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="15912,-3581.32 15734,-3581.32 15734,-3540.32 15912,-3540.32 15912,-3581.32"/>
<text text-anchor="middle" x="15823" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15823" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15823" y="-3547.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_2_1 -->
<g id="edge239" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_2_1</title>
<path fill="none" stroke="black" d="M14349.49,-3641.24C14627.06,-3634.84 15437.81,-3613.93 15723.94,-3581.32"/>
<polygon fill="black" stroke="black" points="15724.37,-3584.8 15733.9,-3580.16 15723.56,-3577.84 15724.37,-3584.8"/>
</g>
<!-- q_proj_2_2_2 -->
<g id="node127" class="node">
<title>q_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16108,-3581.32 15930,-3581.32 15930,-3540.32 16108,-3540.32 16108,-3581.32"/>
<text text-anchor="middle" x="16019" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16019" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16019" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_2_2 -->
<g id="edge244" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_2_2</title>
<path fill="none" stroke="black" d="M14349.26,-3640.42C14557.32,-3633.94 15071.54,-3617.5 15502,-3600.32 15684.99,-3593.02 15734.23,-3603.42 15919.8,-3581.36"/>
<polygon fill="black" stroke="black" points="15920.38,-3584.82 15929.89,-3580.15 15919.55,-3577.87 15920.38,-3584.82"/>
</g>
<!-- k_proj_2_2_2 -->
<g id="node128" class="node">
<title>k_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16304,-3581.32 16126,-3581.32 16126,-3540.32 16304,-3540.32 16304,-3581.32"/>
<text text-anchor="middle" x="16215" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16215" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16215" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_2_2 -->
<g id="edge245" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_2_2</title>
<path fill="none" stroke="black" d="M14349.18,-3642.22C14674.26,-3638.1 15748.89,-3621.77 16115.78,-3581.33"/>
<polygon fill="black" stroke="black" points="16116.36,-3584.79 16125.9,-3580.19 16115.57,-3577.84 16116.36,-3584.79"/>
</g>
<!-- v_proj_2_2_2 -->
<g id="node129" class="node">
<title>v_proj_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16500,-3581.32 16322,-3581.32 16322,-3540.32 16500,-3540.32 16500,-3581.32"/>
<text text-anchor="middle" x="16411" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16411" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16411" y="-3547.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_2_2 -->
<g id="edge246" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_2_2</title>
<path fill="none" stroke="black" d="M14349.25,-3641.48C14600.39,-3636.43 15306.58,-3621.35 15894,-3600.32 16077.02,-3593.77 16126.23,-3603.45 16311.8,-3581.36"/>
<polygon fill="black" stroke="black" points="16312.38,-3584.82 16321.89,-3580.15 16311.55,-3577.87 16312.38,-3584.82"/>
</g>
<!-- q_proj_2_2_3 -->
<g id="node131" class="node">
<title>q_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15128,-3581.32 14950,-3581.32 14950,-3540.32 15128,-3540.32 15128,-3581.32"/>
<text text-anchor="middle" x="15039" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15039" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15039" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_2_3 -->
<g id="edge251" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_2_3</title>
<path fill="none" stroke="black" d="M14349.13,-3637.99C14479.66,-3629.89 14723.11,-3612.22 14939.9,-3581.41"/>
<polygon fill="black" stroke="black" points="14940.47,-3584.86 14949.87,-3579.98 14939.48,-3577.93 14940.47,-3584.86"/>
</g>
<!-- k_proj_2_2_3 -->
<g id="node132" class="node">
<title>k_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15324,-3581.32 15146,-3581.32 15146,-3540.32 15324,-3540.32 15324,-3581.32"/>
<text text-anchor="middle" x="15235" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15235" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15235" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_2_3 -->
<g id="edge252" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_2_3</title>
<path fill="none" stroke="black" d="M14349.06,-3640.61C14508.93,-3635.14 14843.91,-3619.95 15135.95,-3581.37"/>
<polygon fill="black" stroke="black" points="15136.43,-3584.84 15145.88,-3580.05 15135.51,-3577.9 15136.43,-3584.84"/>
</g>
<!-- v_proj_2_2_3 -->
<g id="node133" class="node">
<title>v_proj_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="14932,-3581.32 14754,-3581.32 14754,-3540.32 14932,-3540.32 14932,-3581.32"/>
<text text-anchor="middle" x="14843" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14843" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14843" y="-3547.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_2_3 -->
<g id="edge253" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_2_3</title>
<path fill="none" stroke="black" d="M14349.22,-3633.4C14445.77,-3622.77 14600.43,-3604.49 14743.57,-3581.5"/>
<polygon fill="black" stroke="black" points="14744.54,-3584.89 14753.85,-3579.84 14743.42,-3577.98 14744.54,-3584.89"/>
</g>
<!-- q_proj_2_3_0 -->
<g id="node135" class="node">
<title>q_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="18460,-3581.32 18282,-3581.32 18282,-3540.32 18460,-3540.32 18460,-3581.32"/>
<text text-anchor="middle" x="18371" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="18371" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18371" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_3_0 -->
<g id="edge258" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_3_0</title>
<path fill="none" stroke="black" d="M14349.15,-3642.74C14748.36,-3640.16 16340.73,-3628.53 17649,-3600.32 17923.01,-3594.42 17995.56,-3612.28 18271.57,-3581.37"/>
<polygon fill="black" stroke="black" points="18272.36,-3584.81 18281.9,-3580.2 18271.57,-3577.85 18272.36,-3584.81"/>
</g>
<!-- k_proj_2_3_0 -->
<g id="node136" class="node">
<title>k_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="18656,-3581.32 18478,-3581.32 18478,-3540.32 18656,-3540.32 18656,-3581.32"/>
<text text-anchor="middle" x="18567" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="18567" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18567" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_3_0 -->
<g id="edge259" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_3_0</title>
<path fill="none" stroke="black" d="M14349.01,-3642.84C14761.95,-3640.58 16456.17,-3629.89 17847,-3600.32 18120.14,-3594.52 18192.45,-3612.2 18467.61,-3581.37"/>
<polygon fill="black" stroke="black" points="18468.36,-3584.81 18477.9,-3580.2 18467.57,-3577.85 18468.36,-3584.81"/>
</g>
<!-- v_proj_2_3_0 -->
<g id="node137" class="node">
<title>v_proj_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="18852,-3581.32 18674,-3581.32 18674,-3540.32 18852,-3540.32 18852,-3581.32"/>
<text text-anchor="middle" x="18763" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="18763" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18763" y="-3547.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_3_0 -->
<g id="edge260" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_3_0</title>
<path fill="none" stroke="black" d="M14349.11,-3642.92C14775.73,-3640.96 16571.14,-3631.21 18044,-3600.32 18316.7,-3594.6 18388.89,-3612.16 18663.62,-3581.37"/>
<polygon fill="black" stroke="black" points="18664.36,-3584.81 18673.9,-3580.2 18663.57,-3577.85 18664.36,-3584.81"/>
</g>
<!-- q_proj_2_3_1 -->
<g id="node139" class="node">
<title>q_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="16696,-3581.32 16518,-3581.32 16518,-3540.32 16696,-3540.32 16696,-3581.32"/>
<text text-anchor="middle" x="16607" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16607" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16607" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_3_1 -->
<g id="edge265" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_3_1</title>
<path fill="none" stroke="black" d="M14349.18,-3641.06C14601.77,-3634.96 15315.36,-3617.44 15909,-3600.32 16172.43,-3592.73 16242.24,-3611.22 16507.96,-3581.33"/>
<polygon fill="black" stroke="black" points="16508.36,-3584.81 16517.9,-3580.2 16507.57,-3577.85 16508.36,-3584.81"/>
</g>
<!-- k_proj_2_3_1 -->
<g id="node140" class="node">
<title>k_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="16892,-3581.32 16714,-3581.32 16714,-3540.32 16892,-3540.32 16892,-3581.32"/>
<text text-anchor="middle" x="16803" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16803" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16803" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_3_1 -->
<g id="edge266" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_3_1</title>
<path fill="none" stroke="black" d="M14349.17,-3641.28C14617.27,-3635.42 15407.66,-3617.85 16064,-3600.32 16345.57,-3592.8 16420.07,-3612.99 16703.72,-3581.35"/>
<polygon fill="black" stroke="black" points="16704.36,-3584.8 16713.9,-3580.21 16703.57,-3577.85 16704.36,-3584.8"/>
</g>
<!-- v_proj_2_3_1 -->
<g id="node141" class="node">
<title>v_proj_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="17088,-3581.32 16910,-3581.32 16910,-3540.32 17088,-3540.32 17088,-3581.32"/>
<text text-anchor="middle" x="16999" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16999" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16999" y="-3547.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_3_1 -->
<g id="edge267" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_3_1</title>
<path fill="none" stroke="black" d="M14349.05,-3641.59C14635.92,-3636.23 15525.13,-3619.17 16262,-3600.32 16542.7,-3593.14 16616.96,-3612.91 16899.75,-3581.35"/>
<polygon fill="black" stroke="black" points="16900.36,-3584.8 16909.9,-3580.21 16899.57,-3577.85 16900.36,-3584.8"/>
</g>
<!-- q_proj_2_3_2 -->
<g id="node143" class="node">
<title>q_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="17284,-3581.32 17106,-3581.32 17106,-3540.32 17284,-3540.32 17284,-3581.32"/>
<text text-anchor="middle" x="17195" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17195" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17195" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_3_2 -->
<g id="edge272" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_3_2</title>
<path fill="none" stroke="black" d="M14349.26,-3641.83C14654.26,-3636.92 15641.92,-3620.46 16459,-3600.32 16739.27,-3593.42 16813.4,-3612.87 17095.77,-3581.35"/>
<polygon fill="black" stroke="black" points="17096.36,-3584.81 17105.9,-3580.21 17095.57,-3577.85 17096.36,-3584.81"/>
</g>
<!-- k_proj_2_3_2 -->
<g id="node144" class="node">
<title>k_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="17480,-3581.32 17302,-3581.32 17302,-3540.32 17480,-3540.32 17480,-3581.32"/>
<text text-anchor="middle" x="17391" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17391" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17391" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_3_2 -->
<g id="edge273" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_3_2</title>
<path fill="none" stroke="black" d="M14349.02,-3642.05C14671.28,-3637.62 15760.95,-3621.89 16661,-3600.32 16938.64,-3593.67 17012.07,-3612.62 17291.86,-3581.34"/>
<polygon fill="black" stroke="black" points="17292.36,-3584.81 17301.9,-3580.21 17291.57,-3577.85 17292.36,-3584.81"/>
</g>
<!-- v_proj_2_3_2 -->
<g id="node145" class="node">
<title>v_proj_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="17676,-3581.32 17498,-3581.32 17498,-3540.32 17676,-3540.32 17676,-3581.32"/>
<text text-anchor="middle" x="17587" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17587" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17587" y="-3547.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_3_2 -->
<g id="edge274" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_3_2</title>
<path fill="none" stroke="black" d="M14349.19,-3642.22C14687.92,-3638.18 15875.96,-3623.13 16856,-3600.32 17134.09,-3593.85 17207.63,-3612.67 17487.84,-3581.34"/>
<polygon fill="black" stroke="black" points="17488.36,-3584.81 17497.9,-3580.21 17487.57,-3577.85 17488.36,-3584.81"/>
</g>
<!-- q_proj_2_3_3 -->
<g id="node147" class="node">
<title>q_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="17872,-3581.32 17694,-3581.32 17694,-3540.32 17872,-3540.32 17872,-3581.32"/>
<text text-anchor="middle" x="17783" y="-3569.32" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17783" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17783" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln2_1&#45;&gt;q_proj_2_3_3 -->
<g id="edge279" class="edge">
<title>ln2_1&#45;&gt;q_proj_2_3_3</title>
<path fill="none" stroke="black" d="M14349.04,-3642.39C14703.68,-3638.75 15993.94,-3624.56 17057,-3600.32 17332.89,-3594.03 17405.85,-3612.46 17683.92,-3581.33"/>
<polygon fill="black" stroke="black" points="17684.36,-3584.81 17693.9,-3580.2 17683.57,-3577.85 17684.36,-3584.81"/>
</g>
<!-- k_proj_2_3_3 -->
<g id="node148" class="node">
<title>k_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="18068,-3581.32 17890,-3581.32 17890,-3540.32 18068,-3540.32 18068,-3581.32"/>
<text text-anchor="middle" x="17979" y="-3569.32" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17979" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17979" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln2_1&#45;&gt;k_proj_2_3_3 -->
<g id="edge280" class="edge">
<title>ln2_1&#45;&gt;k_proj_2_3_3</title>
<path fill="none" stroke="black" d="M14349.14,-3642.51C14718.96,-3639.22 16107.83,-3625.76 17251,-3600.32 17527.78,-3594.16 17600.96,-3612.55 17879.89,-3581.34"/>
<polygon fill="black" stroke="black" points="17880.36,-3584.81 17889.9,-3580.2 17879.57,-3577.85 17880.36,-3584.81"/>
</g>
<!-- v_proj_2_3_3 -->
<g id="node149" class="node">
<title>v_proj_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="18264,-3581.32 18086,-3581.32 18086,-3540.32 18264,-3540.32 18264,-3581.32"/>
<text text-anchor="middle" x="18175" y="-3569.32" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="18175" y="-3558.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18175" y="-3547.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln2_1&#45;&gt;v_proj_2_3_3 -->
<g id="edge281" class="edge">
<title>ln2_1&#45;&gt;v_proj_2_3_3</title>
<path fill="none" stroke="black" d="M14349.13,-3642.64C14733.92,-3639.71 16224.94,-3627.18 17451,-3600.32 17726.02,-3594.3 17798.74,-3612.38 18075.95,-3581.33"/>
<polygon fill="black" stroke="black" points="18076.36,-3584.81 18085.9,-3580.2 18075.57,-3577.85 18076.36,-3584.81"/>
</g>
<!-- attn_2_0_0 -->
<g id="node90" class="node">
<title>attn_2_0_0</title>
<polygon fill="lightgreen" stroke="black" points="11012,-3503.32 10834,-3503.32 10834,-3462.32 11012,-3462.32 11012,-3503.32"/>
<text text-anchor="middle" x="10923" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10923" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10923" y="-3469.32" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge177" class="edge">
<title>q_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M10923,-3540.25C10923,-3532.1 10923,-3522.45 10923,-3513.45"/>
<polygon fill="black" stroke="black" points="10926.5,-3513.33 10923,-3503.33 10919.5,-3513.33 10926.5,-3513.33"/>
</g>
<!-- k_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge178" class="edge">
<title>k_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M11068.53,-3540.25C11042.35,-3530.1 11010.2,-3517.64 10982.79,-3507.01"/>
<polygon fill="black" stroke="black" points="10983.89,-3503.68 10973.3,-3503.33 10981.36,-3510.21 10983.89,-3503.68"/>
</g>
<!-- v_proj_2_0_0&#45;&gt;attn_2_0_0 -->
<g id="edge179" class="edge">
<title>v_proj_2_0_0&#45;&gt;attn_2_0_0</title>
<path fill="none" stroke="black" d="M10777.47,-3540.25C10803.65,-3530.1 10835.8,-3517.64 10863.21,-3507.01"/>
<polygon fill="black" stroke="black" points="10864.64,-3510.21 10872.7,-3503.33 10862.11,-3503.68 10864.64,-3510.21"/>
</g>
<!-- agg_dim_2_0 -->
<g id="node151" class="node">
<title>agg_dim_2_0</title>
<polygon fill="lightcoral" stroke="black" points="11029.57,-3425.32 10860.04,-3425.32 10816.43,-3321.32 10985.96,-3321.32 11029.57,-3425.32"/>
<text text-anchor="middle" x="10923" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="10923" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="10923" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="10923" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_0_0&#45;&gt;agg_dim_2_0 -->
<g id="edge180" class="edge">
<title>attn_2_0_0&#45;&gt;agg_dim_2_0</title>
<path fill="none" stroke="black" d="M10923,-3462.11C10923,-3454.46 10923,-3445.25 10923,-3435.71"/>
<polygon fill="black" stroke="black" points="10926.5,-3435.71 10923,-3425.71 10919.5,-3435.71 10926.5,-3435.71"/>
</g>
<!-- attn_2_0_1 -->
<g id="node94" class="node">
<title>attn_2_0_1</title>
<polygon fill="lightgreen" stroke="black" points="10521,-3503.32 10343,-3503.32 10343,-3462.32 10521,-3462.32 10521,-3503.32"/>
<text text-anchor="middle" x="10432" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10432" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10432" y="-3469.32" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge184" class="edge">
<title>q_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M10359.98,-3540.25C10371.86,-3530.94 10386.22,-3519.69 10398.99,-3509.69"/>
<polygon fill="black" stroke="black" points="10401.39,-3512.25 10407.1,-3503.33 10397.07,-3506.74 10401.39,-3512.25"/>
</g>
<!-- k_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge185" class="edge">
<title>k_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M10505.51,-3540.25C10493.38,-3530.94 10478.72,-3519.69 10465.69,-3509.69"/>
<polygon fill="black" stroke="black" points="10467.47,-3506.64 10457.41,-3503.33 10463.21,-3512.19 10467.47,-3506.64"/>
</g>
<!-- v_proj_2_0_1&#45;&gt;attn_2_0_1 -->
<g id="edge186" class="edge">
<title>v_proj_2_0_1&#45;&gt;attn_2_0_1</title>
<path fill="none" stroke="black" d="M10214.45,-3540.25C10254.95,-3529.75 10305.01,-3516.76 10346.89,-3505.9"/>
<polygon fill="black" stroke="black" points="10348,-3509.23 10356.8,-3503.33 10346.24,-3502.45 10348,-3509.23"/>
</g>
<!-- attn_2_0_1&#45;&gt;agg_dim_2_0 -->
<g id="edge187" class="edge">
<title>attn_2_0_1&#45;&gt;agg_dim_2_0</title>
<path fill="none" stroke="black" d="M10521.2,-3462.29C10610.52,-3442.74 10747.08,-3412.84 10835.72,-3393.43"/>
<polygon fill="black" stroke="black" points="10836.72,-3396.8 10845.74,-3391.24 10835.23,-3389.96 10836.72,-3396.8"/>
</g>
<!-- attn_2_0_2 -->
<g id="node98" class="node">
<title>attn_2_0_2</title>
<polygon fill="lightgreen" stroke="black" points="11455,-3503.32 11277,-3503.32 11277,-3462.32 11455,-3462.32 11455,-3503.32"/>
<text text-anchor="middle" x="11366" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11366" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11366" y="-3469.32" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge191" class="edge">
<title>q_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M11328.13,-3540.25C11333.96,-3531.56 11340.93,-3521.18 11347.29,-3511.7"/>
<polygon fill="black" stroke="black" points="11350.24,-3513.58 11352.91,-3503.33 11344.43,-3509.68 11350.24,-3513.58"/>
</g>
<!-- k_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge192" class="edge">
<title>k_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M11473.66,-3540.25C11454.89,-3530.41 11431.96,-3518.4 11412.1,-3507.99"/>
<polygon fill="black" stroke="black" points="11413.7,-3504.87 11403.21,-3503.33 11410.45,-3511.07 11413.7,-3504.87"/>
</g>
<!-- v_proj_2_0_2&#45;&gt;attn_2_0_2 -->
<g id="edge193" class="edge">
<title>v_proj_2_0_2&#45;&gt;attn_2_0_2</title>
<path fill="none" stroke="black" d="M11619.18,-3540.25C11571.55,-3529.64 11512.56,-3516.49 11463.51,-3505.56"/>
<polygon fill="black" stroke="black" points="11464.04,-3502.09 11453.52,-3503.33 11462.52,-3508.92 11464.04,-3502.09"/>
</g>
<!-- attn_2_0_2&#45;&gt;agg_dim_2_0 -->
<g id="edge194" class="edge">
<title>attn_2_0_2&#45;&gt;agg_dim_2_0</title>
<path fill="none" stroke="black" d="M11285.52,-3462.29C11213.28,-3444.76 11106.77,-3418.92 11027.88,-3399.77"/>
<polygon fill="black" stroke="black" points="11028.45,-3396.31 11017.91,-3397.35 11026.8,-3403.11 11028.45,-3396.31"/>
</g>
<!-- attn_2_0_3 -->
<g id="node102" class="node">
<title>attn_2_0_3</title>
<polygon fill="lightgreen" stroke="black" points="9887,-3503.32 9709,-3503.32 9709,-3462.32 9887,-3462.32 9887,-3503.32"/>
<text text-anchor="middle" x="9798" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9798" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9798" y="-3469.32" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge198" class="edge">
<title>q_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M9614.61,-3540.25C9648.32,-3529.88 9689.88,-3517.09 9724.91,-3506.31"/>
<polygon fill="black" stroke="black" points="9726.08,-3509.61 9734.61,-3503.33 9724.02,-3502.92 9726.08,-3509.61"/>
</g>
<!-- k_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge199" class="edge">
<title>k_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M9760.13,-3540.25C9765.96,-3531.56 9772.93,-3521.18 9779.29,-3511.7"/>
<polygon fill="black" stroke="black" points="9782.24,-3513.58 9784.91,-3503.33 9776.43,-3509.68 9782.24,-3513.58"/>
</g>
<!-- v_proj_2_0_3&#45;&gt;attn_2_0_3 -->
<g id="edge200" class="edge">
<title>v_proj_2_0_3&#45;&gt;attn_2_0_3</title>
<path fill="none" stroke="black" d="M9905.66,-3540.25C9886.89,-3530.41 9863.96,-3518.4 9844.1,-3507.99"/>
<polygon fill="black" stroke="black" points="9845.7,-3504.87 9835.21,-3503.33 9842.45,-3511.07 9845.7,-3504.87"/>
</g>
<!-- attn_2_0_3&#45;&gt;agg_dim_2_0 -->
<g id="edge201" class="edge">
<title>attn_2_0_3&#45;&gt;agg_dim_2_0</title>
<path fill="none" stroke="black" d="M9887.22,-3473.3C10096.99,-3453.25 10619.76,-3403.3 10831.64,-3383.05"/>
<polygon fill="black" stroke="black" points="10832.18,-3386.52 10841.8,-3382.08 10831.51,-3379.55 10832.18,-3386.52"/>
</g>
<!-- attn_2_1_0 -->
<g id="node106" class="node">
<title>attn_2_1_0</title>
<polygon fill="lightgreen" stroke="black" points="13854,-3503.32 13676,-3503.32 13676,-3462.32 13854,-3462.32 13854,-3503.32"/>
<text text-anchor="middle" x="13765" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13765" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13765" y="-3469.32" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge205" class="edge">
<title>q_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M13692.24,-3540.25C13704.24,-3530.94 13718.75,-3519.69 13731.65,-3509.69"/>
<polygon fill="black" stroke="black" points="13734.09,-3512.22 13739.85,-3503.33 13729.8,-3506.69 13734.09,-3512.22"/>
</g>
<!-- k_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge206" class="edge">
<title>k_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M13837.76,-3540.25C13825.76,-3530.94 13811.25,-3519.69 13798.35,-3509.69"/>
<polygon fill="black" stroke="black" points="13800.2,-3506.69 13790.15,-3503.33 13795.91,-3512.22 13800.2,-3506.69"/>
</g>
<!-- v_proj_2_1_0&#45;&gt;attn_2_1_0 -->
<g id="edge207" class="edge">
<title>v_proj_2_1_0&#45;&gt;attn_2_1_0</title>
<path fill="none" stroke="black" d="M13983.29,-3540.25C13942.65,-3529.75 13892.42,-3516.76 13850.4,-3505.9"/>
<polygon fill="black" stroke="black" points="13851.01,-3502.44 13840.46,-3503.33 13849.26,-3509.22 13851.01,-3502.44"/>
</g>
<!-- agg_dim_2_1 -->
<g id="node152" class="node">
<title>agg_dim_2_1</title>
<polygon fill="lightcoral" stroke="black" points="13381.57,-3425.32 13212.04,-3425.32 13168.43,-3321.32 13337.96,-3321.32 13381.57,-3425.32"/>
<text text-anchor="middle" x="13275" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="13275" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="13275" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="13275" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_1_0&#45;&gt;agg_dim_2_1 -->
<g id="edge208" class="edge">
<title>attn_2_1_0&#45;&gt;agg_dim_2_1</title>
<path fill="none" stroke="black" d="M13675.98,-3462.29C13592.43,-3443.96 13467.44,-3416.54 13379.25,-3397.2"/>
<polygon fill="black" stroke="black" points="13379.75,-3393.72 13369.23,-3395 13378.25,-3400.56 13379.75,-3393.72"/>
</g>
<!-- attn_2_1_1 -->
<g id="node110" class="node">
<title>attn_2_1_1</title>
<polygon fill="lightgreen" stroke="black" points="12239,-3503.32 12061,-3503.32 12061,-3462.32 12239,-3462.32 12239,-3503.32"/>
<text text-anchor="middle" x="12150" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12150" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12150" y="-3469.32" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge212" class="edge">
<title>q_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M11966.61,-3540.25C12000.32,-3529.88 12041.88,-3517.09 12076.91,-3506.31"/>
<polygon fill="black" stroke="black" points="12078.08,-3509.61 12086.61,-3503.33 12076.02,-3502.92 12078.08,-3509.61"/>
</g>
<!-- k_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge213" class="edge">
<title>k_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M12112.13,-3540.25C12117.96,-3531.56 12124.93,-3521.18 12131.29,-3511.7"/>
<polygon fill="black" stroke="black" points="12134.24,-3513.58 12136.91,-3503.33 12128.43,-3509.68 12134.24,-3513.58"/>
</g>
<!-- v_proj_2_1_1&#45;&gt;attn_2_1_1 -->
<g id="edge214" class="edge">
<title>v_proj_2_1_1&#45;&gt;attn_2_1_1</title>
<path fill="none" stroke="black" d="M12257.66,-3540.25C12238.89,-3530.41 12215.96,-3518.4 12196.1,-3507.99"/>
<polygon fill="black" stroke="black" points="12197.7,-3504.87 12187.21,-3503.33 12194.45,-3511.07 12197.7,-3504.87"/>
</g>
<!-- attn_2_1_1&#45;&gt;agg_dim_2_1 -->
<g id="edge215" class="edge">
<title>attn_2_1_1&#45;&gt;agg_dim_2_1</title>
<path fill="none" stroke="black" d="M12239.22,-3473.3C12448.99,-3453.25 12971.76,-3403.3 13183.64,-3383.05"/>
<polygon fill="black" stroke="black" points="13184.18,-3386.52 13193.8,-3382.08 13183.51,-3379.55 13184.18,-3386.52"/>
</g>
<!-- attn_2_1_2 -->
<g id="node114" class="node">
<title>attn_2_1_2</title>
<polygon fill="lightgreen" stroke="black" points="12852,-3503.32 12674,-3503.32 12674,-3462.32 12852,-3462.32 12852,-3503.32"/>
<text text-anchor="middle" x="12763" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12763" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12763" y="-3469.32" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge219" class="edge">
<title>q_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M12561.05,-3540.25C12598.48,-3529.79 12644.72,-3516.87 12683.5,-3506.04"/>
<polygon fill="black" stroke="black" points="12684.5,-3509.39 12693.19,-3503.33 12682.62,-3502.65 12684.5,-3509.39"/>
</g>
<!-- k_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge220" class="edge">
<title>k_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M12706.57,-3540.25C12715.61,-3531.21 12726.49,-3520.33 12736.28,-3510.55"/>
<polygon fill="black" stroke="black" points="12738.9,-3512.87 12743.49,-3503.33 12733.95,-3507.92 12738.9,-3512.87"/>
</g>
<!-- v_proj_2_1_2&#45;&gt;attn_2_1_2 -->
<g id="edge221" class="edge">
<title>v_proj_2_1_2&#45;&gt;attn_2_1_2</title>
<path fill="none" stroke="black" d="M12852.1,-3540.25C12836.98,-3530.68 12818.61,-3519.04 12802.49,-3508.83"/>
<polygon fill="black" stroke="black" points="12804.12,-3505.72 12793.8,-3503.33 12800.37,-3511.64 12804.12,-3505.72"/>
</g>
<!-- attn_2_1_2&#45;&gt;agg_dim_2_1 -->
<g id="edge222" class="edge">
<title>attn_2_1_2&#45;&gt;agg_dim_2_1</title>
<path fill="none" stroke="black" d="M12852.18,-3463.1C12946.31,-3443.34 13093.73,-3412.38 13187.29,-3392.74"/>
<polygon fill="black" stroke="black" points="13188.23,-3396.12 13197.3,-3390.64 13186.79,-3389.27 13188.23,-3396.12"/>
</g>
<!-- attn_2_1_3 -->
<g id="node118" class="node">
<title>attn_2_1_3</title>
<polygon fill="lightgreen" stroke="black" points="13364,-3503.32 13186,-3503.32 13186,-3462.32 13364,-3462.32 13364,-3503.32"/>
<text text-anchor="middle" x="13275" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13275" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13275" y="-3469.32" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge226" class="edge">
<title>q_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M13129.47,-3540.25C13155.65,-3530.1 13187.8,-3517.64 13215.21,-3507.01"/>
<polygon fill="black" stroke="black" points="13216.64,-3510.21 13224.7,-3503.33 13214.11,-3503.68 13216.64,-3510.21"/>
</g>
<!-- k_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge227" class="edge">
<title>k_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M13275,-3540.25C13275,-3532.1 13275,-3522.45 13275,-3513.45"/>
<polygon fill="black" stroke="black" points="13278.5,-3513.33 13275,-3503.33 13271.5,-3513.33 13278.5,-3513.33"/>
</g>
<!-- v_proj_2_1_3&#45;&gt;attn_2_1_3 -->
<g id="edge228" class="edge">
<title>v_proj_2_1_3&#45;&gt;attn_2_1_3</title>
<path fill="none" stroke="black" d="M13420.53,-3540.25C13394.35,-3530.1 13362.2,-3517.64 13334.79,-3507.01"/>
<polygon fill="black" stroke="black" points="13335.89,-3503.68 13325.3,-3503.33 13333.36,-3510.21 13335.89,-3503.68"/>
</g>
<!-- attn_2_1_3&#45;&gt;agg_dim_2_1 -->
<g id="edge229" class="edge">
<title>attn_2_1_3&#45;&gt;agg_dim_2_1</title>
<path fill="none" stroke="black" d="M13275,-3462.11C13275,-3454.46 13275,-3445.25 13275,-3435.71"/>
<polygon fill="black" stroke="black" points="13278.5,-3435.71 13275,-3425.71 13271.5,-3435.71 13278.5,-3435.71"/>
</g>
<!-- attn_2_2_0 -->
<g id="node122" class="node">
<title>attn_2_2_0</title>
<polygon fill="lightgreen" stroke="black" points="14639,-3503.32 14461,-3503.32 14461,-3462.32 14639,-3462.32 14639,-3503.32"/>
<text text-anchor="middle" x="14550" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14550" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14550" y="-3469.32" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge233" class="edge">
<title>q_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M14476.49,-3540.25C14488.62,-3530.94 14503.28,-3519.69 14516.31,-3509.69"/>
<polygon fill="black" stroke="black" points="14518.79,-3512.19 14524.59,-3503.33 14514.53,-3506.64 14518.79,-3512.19"/>
</g>
<!-- k_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge234" class="edge">
<title>k_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M14622.02,-3540.25C14610.14,-3530.94 14595.78,-3519.69 14583.01,-3509.69"/>
<polygon fill="black" stroke="black" points="14584.93,-3506.74 14574.9,-3503.33 14580.61,-3512.25 14584.93,-3506.74"/>
</g>
<!-- v_proj_2_2_0&#45;&gt;attn_2_2_0 -->
<g id="edge235" class="edge">
<title>v_proj_2_2_0&#45;&gt;attn_2_2_0</title>
<path fill="none" stroke="black" d="M14330.97,-3540.25C14371.83,-3529.72 14422.36,-3516.71 14464.58,-3505.83"/>
<polygon fill="black" stroke="black" points="14465.48,-3509.21 14474.29,-3503.33 14463.73,-3502.43 14465.48,-3509.21"/>
</g>
<!-- agg_dim_2_2 -->
<g id="node153" class="node">
<title>agg_dim_2_2</title>
<polygon fill="lightcoral" stroke="black" points="15439.57,-3425.32 15270.04,-3425.32 15226.43,-3321.32 15395.96,-3321.32 15439.57,-3425.32"/>
<text text-anchor="middle" x="15333" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="15333" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="15333" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="15333" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_2_0&#45;&gt;agg_dim_2_2 -->
<g id="edge236" class="edge">
<title>attn_2_2_0&#45;&gt;agg_dim_2_2</title>
<path fill="none" stroke="black" d="M14639.06,-3469.6C14789.42,-3448.95 15091.97,-3407.41 15242.98,-3386.68"/>
<polygon fill="black" stroke="black" points="15243.71,-3390.11 15253.14,-3385.29 15242.76,-3383.18 15243.71,-3390.11"/>
</g>
<!-- attn_2_2_1 -->
<g id="node126" class="node">
<title>attn_2_2_1</title>
<polygon fill="lightgreen" stroke="black" points="15571,-3503.32 15393,-3503.32 15393,-3462.32 15571,-3462.32 15571,-3503.32"/>
<text text-anchor="middle" x="15482" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15482" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15482" y="-3469.32" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge240" class="edge">
<title>q_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M15444.13,-3540.25C15449.96,-3531.56 15456.93,-3521.18 15463.29,-3511.7"/>
<polygon fill="black" stroke="black" points="15466.24,-3513.58 15468.91,-3503.33 15460.43,-3509.68 15466.24,-3513.58"/>
</g>
<!-- k_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge241" class="edge">
<title>k_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M15589.66,-3540.25C15570.89,-3530.41 15547.96,-3518.4 15528.1,-3507.99"/>
<polygon fill="black" stroke="black" points="15529.7,-3504.87 15519.21,-3503.33 15526.45,-3511.07 15529.7,-3504.87"/>
</g>
<!-- v_proj_2_2_1&#45;&gt;attn_2_2_1 -->
<g id="edge242" class="edge">
<title>v_proj_2_2_1&#45;&gt;attn_2_2_1</title>
<path fill="none" stroke="black" d="M15735.18,-3540.25C15687.55,-3529.64 15628.56,-3516.49 15579.51,-3505.56"/>
<polygon fill="black" stroke="black" points="15580.04,-3502.09 15569.52,-3503.33 15578.52,-3508.92 15580.04,-3502.09"/>
</g>
<!-- attn_2_2_1&#45;&gt;agg_dim_2_2 -->
<g id="edge243" class="edge">
<title>attn_2_2_1&#45;&gt;agg_dim_2_2</title>
<path fill="none" stroke="black" d="M15454.67,-3462.11C15442.55,-3453.36 15427.6,-3442.57 15412.37,-3431.59"/>
<polygon fill="black" stroke="black" points="15414.06,-3428.49 15403.9,-3425.48 15409.97,-3434.17 15414.06,-3428.49"/>
</g>
<!-- attn_2_2_2 -->
<g id="node130" class="node">
<title>attn_2_2_2</title>
<polygon fill="lightgreen" stroke="black" points="16159,-3503.32 15981,-3503.32 15981,-3462.32 16159,-3462.32 16159,-3503.32"/>
<text text-anchor="middle" x="16070" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16070" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16070" y="-3469.32" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge247" class="edge">
<title>q_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M16032.13,-3540.25C16037.96,-3531.56 16044.93,-3521.18 16051.29,-3511.7"/>
<polygon fill="black" stroke="black" points="16054.24,-3513.58 16056.91,-3503.33 16048.43,-3509.68 16054.24,-3513.58"/>
</g>
<!-- k_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge248" class="edge">
<title>k_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M16177.66,-3540.25C16158.89,-3530.41 16135.96,-3518.4 16116.1,-3507.99"/>
<polygon fill="black" stroke="black" points="16117.7,-3504.87 16107.21,-3503.33 16114.45,-3511.07 16117.7,-3504.87"/>
</g>
<!-- v_proj_2_2_2&#45;&gt;attn_2_2_2 -->
<g id="edge249" class="edge">
<title>v_proj_2_2_2&#45;&gt;attn_2_2_2</title>
<path fill="none" stroke="black" d="M16323.18,-3540.25C16275.55,-3529.64 16216.56,-3516.49 16167.51,-3505.56"/>
<polygon fill="black" stroke="black" points="16168.04,-3502.09 16157.52,-3503.33 16166.52,-3508.92 16168.04,-3502.09"/>
</g>
<!-- attn_2_2_2&#45;&gt;agg_dim_2_2 -->
<g id="edge250" class="edge">
<title>attn_2_2_2&#45;&gt;agg_dim_2_2</title>
<path fill="none" stroke="black" d="M15980.73,-3468.8C15842.82,-3448.69 15578.79,-3410.17 15434.05,-3389.06"/>
<polygon fill="black" stroke="black" points="15434.24,-3385.55 15423.84,-3387.57 15433.23,-3392.48 15434.24,-3385.55"/>
</g>
<!-- attn_2_2_3 -->
<g id="node134" class="node">
<title>attn_2_2_3</title>
<polygon fill="lightgreen" stroke="black" points="15226,-3503.32 15048,-3503.32 15048,-3462.32 15226,-3462.32 15226,-3503.32"/>
<text text-anchor="middle" x="15137" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15137" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15137" y="-3469.32" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge254" class="edge">
<title>q_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M15064.24,-3540.25C15076.24,-3530.94 15090.75,-3519.69 15103.65,-3509.69"/>
<polygon fill="black" stroke="black" points="15106.09,-3512.22 15111.85,-3503.33 15101.8,-3506.69 15106.09,-3512.22"/>
</g>
<!-- k_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge255" class="edge">
<title>k_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M15209.76,-3540.25C15197.76,-3530.94 15183.25,-3519.69 15170.35,-3509.69"/>
<polygon fill="black" stroke="black" points="15172.2,-3506.69 15162.15,-3503.33 15167.91,-3512.22 15172.2,-3506.69"/>
</g>
<!-- v_proj_2_2_3&#45;&gt;attn_2_2_3 -->
<g id="edge256" class="edge">
<title>v_proj_2_2_3&#45;&gt;attn_2_2_3</title>
<path fill="none" stroke="black" d="M14918.71,-3540.25C14959.35,-3529.75 15009.58,-3516.76 15051.6,-3505.9"/>
<polygon fill="black" stroke="black" points="15052.74,-3509.22 15061.54,-3503.33 15050.99,-3502.44 15052.74,-3509.22"/>
</g>
<!-- attn_2_2_3&#45;&gt;agg_dim_2_2 -->
<g id="edge257" class="edge">
<title>attn_2_2_3&#45;&gt;agg_dim_2_2</title>
<path fill="none" stroke="black" d="M15172.95,-3462.11C15195.99,-3449.47 15226.79,-3432.58 15255.22,-3416.98"/>
<polygon fill="black" stroke="black" points="15257.27,-3419.85 15264.36,-3411.97 15253.91,-3413.71 15257.27,-3419.85"/>
</g>
<!-- attn_2_3_0 -->
<g id="node138" class="node">
<title>attn_2_3_0</title>
<polygon fill="lightgreen" stroke="black" points="18511,-3503.32 18333,-3503.32 18333,-3462.32 18511,-3462.32 18511,-3503.32"/>
<text text-anchor="middle" x="18422" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="18422" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18422" y="-3469.32" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge261" class="edge">
<title>q_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M18384.13,-3540.25C18389.96,-3531.56 18396.93,-3521.18 18403.29,-3511.7"/>
<polygon fill="black" stroke="black" points="18406.24,-3513.58 18408.91,-3503.33 18400.43,-3509.68 18406.24,-3513.58"/>
</g>
<!-- k_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge262" class="edge">
<title>k_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M18529.66,-3540.25C18510.89,-3530.41 18487.96,-3518.4 18468.1,-3507.99"/>
<polygon fill="black" stroke="black" points="18469.7,-3504.87 18459.21,-3503.33 18466.45,-3511.07 18469.7,-3504.87"/>
</g>
<!-- v_proj_2_3_0&#45;&gt;attn_2_3_0 -->
<g id="edge263" class="edge">
<title>v_proj_2_3_0&#45;&gt;attn_2_3_0</title>
<path fill="none" stroke="black" d="M18675.18,-3540.25C18627.55,-3529.64 18568.56,-3516.49 18519.51,-3505.56"/>
<polygon fill="black" stroke="black" points="18520.04,-3502.09 18509.52,-3503.33 18518.52,-3508.92 18520.04,-3502.09"/>
</g>
<!-- agg_dim_2_3 -->
<g id="node154" class="node">
<title>agg_dim_2_3</title>
<polygon fill="lightcoral" stroke="black" points="17497.57,-3425.32 17328.04,-3425.32 17284.43,-3321.32 17453.96,-3321.32 17497.57,-3425.32"/>
<text text-anchor="middle" x="17391" y="-3387.32" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="17391" y="-3376.32" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="17391" y="-3365.32" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="17391" y="-3354.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_2_3_0&#45;&gt;agg_dim_2_3 -->
<g id="edge264" class="edge">
<title>attn_2_3_0&#45;&gt;agg_dim_2_3</title>
<path fill="none" stroke="black" d="M18332.76,-3472.52C18141.03,-3452.53 17690.98,-3405.6 17490.45,-3384.69"/>
<polygon fill="black" stroke="black" points="17490.52,-3381.18 17480.21,-3383.63 17489.8,-3388.14 17490.52,-3381.18"/>
</g>
<!-- attn_2_3_1 -->
<g id="node142" class="node">
<title>attn_2_3_1</title>
<polygon fill="lightgreen" stroke="black" points="16990,-3503.32 16812,-3503.32 16812,-3462.32 16990,-3462.32 16990,-3503.32"/>
<text text-anchor="middle" x="16901" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16901" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16901" y="-3469.32" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge268" class="edge">
<title>q_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M16682.71,-3540.25C16723.35,-3529.75 16773.58,-3516.76 16815.6,-3505.9"/>
<polygon fill="black" stroke="black" points="16816.74,-3509.22 16825.54,-3503.33 16814.99,-3502.44 16816.74,-3509.22"/>
</g>
<!-- k_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge269" class="edge">
<title>k_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M16828.24,-3540.25C16840.24,-3530.94 16854.75,-3519.69 16867.65,-3509.69"/>
<polygon fill="black" stroke="black" points="16870.09,-3512.22 16875.85,-3503.33 16865.8,-3506.69 16870.09,-3512.22"/>
</g>
<!-- v_proj_2_3_1&#45;&gt;attn_2_3_1 -->
<g id="edge270" class="edge">
<title>v_proj_2_3_1&#45;&gt;attn_2_3_1</title>
<path fill="none" stroke="black" d="M16973.76,-3540.25C16961.76,-3530.94 16947.25,-3519.69 16934.35,-3509.69"/>
<polygon fill="black" stroke="black" points="16936.2,-3506.69 16926.15,-3503.33 16931.91,-3512.22 16936.2,-3506.69"/>
</g>
<!-- attn_2_3_1&#45;&gt;agg_dim_2_3 -->
<g id="edge271" class="edge">
<title>attn_2_3_1&#45;&gt;agg_dim_2_3</title>
<path fill="none" stroke="black" d="M16990.02,-3462.29C17079.02,-3442.77 17215.04,-3412.93 17303.5,-3393.52"/>
<polygon fill="black" stroke="black" points="17304.49,-3396.89 17313.51,-3391.32 17302.99,-3390.05 17304.49,-3396.89"/>
</g>
<!-- attn_2_3_2 -->
<g id="node146" class="node">
<title>attn_2_3_2</title>
<polygon fill="lightgreen" stroke="black" points="17480,-3503.32 17302,-3503.32 17302,-3462.32 17480,-3462.32 17480,-3503.32"/>
<text text-anchor="middle" x="17391" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17391" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17391" y="-3469.32" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge275" class="edge">
<title>q_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M17245.47,-3540.25C17271.65,-3530.1 17303.8,-3517.64 17331.21,-3507.01"/>
<polygon fill="black" stroke="black" points="17332.64,-3510.21 17340.7,-3503.33 17330.11,-3503.68 17332.64,-3510.21"/>
</g>
<!-- k_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge276" class="edge">
<title>k_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M17391,-3540.25C17391,-3532.1 17391,-3522.45 17391,-3513.45"/>
<polygon fill="black" stroke="black" points="17394.5,-3513.33 17391,-3503.33 17387.5,-3513.33 17394.5,-3513.33"/>
</g>
<!-- v_proj_2_3_2&#45;&gt;attn_2_3_2 -->
<g id="edge277" class="edge">
<title>v_proj_2_3_2&#45;&gt;attn_2_3_2</title>
<path fill="none" stroke="black" d="M17536.53,-3540.25C17510.35,-3530.1 17478.2,-3517.64 17450.79,-3507.01"/>
<polygon fill="black" stroke="black" points="17451.89,-3503.68 17441.3,-3503.33 17449.36,-3510.21 17451.89,-3503.68"/>
</g>
<!-- attn_2_3_2&#45;&gt;agg_dim_2_3 -->
<g id="edge278" class="edge">
<title>attn_2_3_2&#45;&gt;agg_dim_2_3</title>
<path fill="none" stroke="black" d="M17391,-3462.11C17391,-3454.46 17391,-3445.25 17391,-3435.71"/>
<polygon fill="black" stroke="black" points="17394.5,-3435.71 17391,-3425.71 17387.5,-3435.71 17394.5,-3435.71"/>
</g>
<!-- attn_2_3_3 -->
<g id="node150" class="node">
<title>attn_2_3_3</title>
<polygon fill="lightgreen" stroke="black" points="17971,-3503.32 17793,-3503.32 17793,-3462.32 17971,-3462.32 17971,-3503.32"/>
<text text-anchor="middle" x="17882" y="-3491.32" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17882" y="-3480.32" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17882" y="-3469.32" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- q_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge282" class="edge">
<title>q_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M17808.49,-3540.25C17820.62,-3530.94 17835.28,-3519.69 17848.31,-3509.69"/>
<polygon fill="black" stroke="black" points="17850.79,-3512.19 17856.59,-3503.33 17846.53,-3506.64 17850.79,-3512.19"/>
</g>
<!-- k_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge283" class="edge">
<title>k_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M17954.02,-3540.25C17942.14,-3530.94 17927.78,-3519.69 17915.01,-3509.69"/>
<polygon fill="black" stroke="black" points="17916.93,-3506.74 17906.9,-3503.33 17912.61,-3512.25 17916.93,-3506.74"/>
</g>
<!-- v_proj_2_3_3&#45;&gt;attn_2_3_3 -->
<g id="edge284" class="edge">
<title>v_proj_2_3_3&#45;&gt;attn_2_3_3</title>
<path fill="none" stroke="black" d="M18099.55,-3540.25C18059.05,-3529.75 18008.99,-3516.76 17967.11,-3505.9"/>
<polygon fill="black" stroke="black" points="17967.76,-3502.45 17957.2,-3503.33 17966,-3509.23 17967.76,-3502.45"/>
</g>
<!-- attn_2_3_3&#45;&gt;agg_dim_2_3 -->
<g id="edge285" class="edge">
<title>attn_2_3_3&#45;&gt;agg_dim_2_3</title>
<path fill="none" stroke="black" d="M17792.8,-3462.29C17708.85,-3443.91 17583.17,-3416.4 17494.78,-3397.04"/>
<polygon fill="black" stroke="black" points="17495.51,-3393.62 17485,-3394.9 17494.02,-3400.46 17495.51,-3393.62"/>
</g>
<!-- agg_heads_2 -->
<g id="node155" class="node">
<title>agg_heads_2</title>
<polygon fill="lightcoral" stroke="black" points="15422.32,-3284.32 15280.23,-3284.32 15243.68,-3202.32 15385.77,-3202.32 15422.32,-3284.32"/>
<text text-anchor="middle" x="15333" y="-3251.82" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="15333" y="-3240.82" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="15333" y="-3229.82" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_2_0&#45;&gt;agg_heads_2 -->
<g id="edge286" class="edge">
<title>agg_dim_2_0&#45;&gt;agg_heads_2</title>
<path fill="none" stroke="black" d="M11006.67,-3369.89C11561.87,-3353.78 14708.68,-3262.44 15252.84,-3246.65"/>
<polygon fill="black" stroke="black" points="15253.05,-3250.15 15262.94,-3246.36 15252.85,-3243.15 15253.05,-3250.15"/>
</g>
<!-- agg_dim_2_1&#45;&gt;agg_heads_2 -->
<g id="edge287" class="edge">
<title>agg_dim_2_1&#45;&gt;agg_heads_2</title>
<path fill="none" stroke="black" d="M13357.26,-3367.21C13689.17,-3346.56 14927.49,-3269.54 15253.78,-3249.25"/>
<polygon fill="black" stroke="black" points="15254.32,-3252.72 15264.09,-3248.61 15253.89,-3245.74 15254.32,-3252.72"/>
</g>
<!-- agg_dim_2_2&#45;&gt;agg_heads_2 -->
<g id="edge288" class="edge">
<title>agg_dim_2_2&#45;&gt;agg_heads_2</title>
<path fill="none" stroke="black" d="M15333,-3321C15333,-3312.39 15333,-3303.47 15333,-3294.89"/>
<polygon fill="black" stroke="black" points="15336.5,-3294.63 15333,-3284.63 15329.5,-3294.63 15336.5,-3294.63"/>
</g>
<!-- agg_dim_2_3&#45;&gt;agg_heads_2 -->
<g id="edge289" class="edge">
<title>agg_dim_2_3&#45;&gt;agg_heads_2</title>
<path fill="none" stroke="black" d="M17303.23,-3366.86C16964.94,-3345.82 15748.08,-3270.14 15416.79,-3249.53"/>
<polygon fill="black" stroke="black" points="15416.98,-3246.04 15406.78,-3248.91 15416.54,-3253.03 15416.98,-3246.04"/>
</g>
<!-- out_proj2 -->
<g id="node156" class="node">
<title>out_proj2</title>
<polygon fill="lightgreen" stroke="black" points="17276,-3165.32 17088,-3165.32 17088,-3124.32 17276,-3124.32 17276,-3165.32"/>
<text text-anchor="middle" x="17182" y="-3153.32" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="17182" y="-3142.32" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17182" y="-3131.32" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_2&#45;&gt;out_proj2 -->
<g id="edge290" class="edge">
<title>agg_heads_2&#45;&gt;out_proj2</title>
<path fill="none" stroke="black" d="M15402.11,-3238.72C15683.06,-3224.05 16740.63,-3168.86 17077.94,-3151.25"/>
<polygon fill="black" stroke="black" points="17078.14,-3154.75 17087.95,-3150.73 17077.78,-3147.76 17078.14,-3154.75"/>
</g>
<!-- res2_1 -->
<g id="node157" class="node">
<title>res2_1</title>
<ellipse fill="lightgreen" stroke="black" cx="17542" cy="-3058.33" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="17542" y="-3066.83" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17542" y="-3055.83" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17542" y="-3044.83" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- out_proj2&#45;&gt;res2_1 -->
<g id="edge291" class="edge">
<title>out_proj2&#45;&gt;res2_1</title>
<path fill="none" stroke="black" d="M17265.5,-3124.23C17318.89,-3111.69 17388.37,-3095.39 17444.32,-3082.26"/>
<polygon fill="black" stroke="black" points="17445.31,-3085.62 17454.25,-3079.93 17443.72,-3078.8 17445.31,-3085.62"/>
</g>
<!-- ln2_2 -->
<g id="node158" class="node">
<title>ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="17191,-2992.34 17003,-2992.34 17003,-2951.34 17191,-2951.34 17191,-2992.34"/>
<text text-anchor="middle" x="17097" y="-2980.34" font-family="Arial" font-size="10.00">LayerNorm 2.2</text>
<text text-anchor="middle" x="17097" y="-2969.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17097" y="-2958.34" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_1&#45;&gt;ln2_2 -->
<g id="edge293" class="edge">
<title>res2_1&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M17444.89,-3038.89C17372.96,-3025.24 17275.07,-3006.65 17201.45,-2992.67"/>
<polygon fill="black" stroke="black" points="17201.71,-2989.16 17191.23,-2990.73 17200.4,-2996.04 17201.71,-2989.16"/>
</g>
<!-- res2_2 -->
<g id="node169" class="node">
<title>res2_2</title>
<ellipse fill="lightgreen" stroke="black" cx="17508" cy="-2528.35" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="17508" y="-2536.85" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17508" y="-2525.85" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17508" y="-2514.85" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_1&#45;&gt;res2_2 -->
<g id="edge312" class="edge">
<title>res2_1&#45;&gt;res2_2</title>
<path fill="none" stroke="black" d="M17635.05,-3037.8C17666.13,-3025.39 17693,-3005.28 17693,-2972.84 17693,-2972.84 17693,-2972.84 17693,-2634.34 17693,-2591.94 17655.79,-2566.46 17614.75,-2551.24"/>
<polygon fill="black" stroke="black" points="17615.7,-2547.86 17605.11,-2547.87 17613.39,-2554.47 17615.7,-2547.86"/>
</g>
<!-- gate2 -->
<g id="node159" class="node">
<title>gate2</title>
<polygon fill="lightsteelblue" stroke="black" points="17129.22,-2914.34 16844.12,-2914.34 16770.78,-2810.34 17055.88,-2810.34 17129.22,-2914.34"/>
<text text-anchor="middle" x="16950" y="-2876.34" font-family="Arial" font-size="10.00">Gate Network 2</text>
<text text-anchor="middle" x="16950" y="-2865.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8]</text>
<text text-anchor="middle" x="16950" y="-2854.34" font-family="Arial" font-size="10.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="16950" y="-2843.34" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln2_2&#45;&gt;gate2 -->
<g id="edge294" class="edge">
<title>ln2_2&#45;&gt;gate2</title>
<path fill="none" stroke="black" d="M17070.04,-2951.12C17058.08,-2942.38 17043.33,-2931.59 17028.31,-2920.61"/>
<polygon fill="black" stroke="black" points="17030.09,-2917.57 17019.95,-2914.5 17025.96,-2923.22 17030.09,-2917.57"/>
</g>
<!-- expert_2_0 -->
<g id="node160" class="node">
<title>expert_2_0</title>
<polygon fill="lightseagreen" stroke="black" points="17468,-2765.34 17280,-2765.34 17280,-2713.34 17468,-2713.34 17468,-2765.34"/>
<text text-anchor="middle" x="17374" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.0</text>
<text text-anchor="middle" x="17374" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17374" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17374" y="-2720.34" font-family="Arial" font-size="10.00">GPU 0&#45;1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_0 -->
<g id="edge295" class="edge">
<title>ln2_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M17131.27,-2951.25C17140.18,-2945.76 17149.63,-2939.58 17158,-2933.34 17227.29,-2881.73 17300.86,-2812.46 17341.76,-2772.49"/>
<polygon fill="black" stroke="black" points="17344.32,-2774.88 17349.01,-2765.37 17339.42,-2769.88 17344.32,-2774.88"/>
</g>
<!-- expert_2_1 -->
<g id="node161" class="node">
<title>expert_2_1</title>
<polygon fill="lightseagreen" stroke="black" points="16850,-2765.34 16662,-2765.34 16662,-2713.34 16850,-2713.34 16850,-2765.34"/>
<text text-anchor="middle" x="16756" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.1</text>
<text text-anchor="middle" x="16756" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16756" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16756" y="-2720.34" font-family="Arial" font-size="10.00">GPU 2&#45;3</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_1 -->
<g id="edge297" class="edge">
<title>ln2_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M17002.88,-2967.87C16915.02,-2962.91 16792.94,-2949.68 16762,-2914.34 16728.83,-2876.45 16736.29,-2814.18 16745.55,-2775.31"/>
<polygon fill="black" stroke="black" points="16748.98,-2776.04 16748.05,-2765.48 16742.19,-2774.31 16748.98,-2776.04"/>
</g>
<!-- expert_2_2 -->
<g id="node162" class="node">
<title>expert_2_2</title>
<polygon fill="lightseagreen" stroke="black" points="17674,-2765.34 17486,-2765.34 17486,-2713.34 17674,-2713.34 17674,-2765.34"/>
<text text-anchor="middle" x="17580" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.2</text>
<text text-anchor="middle" x="17580" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17580" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17580" y="-2720.34" font-family="Arial" font-size="10.00">GPU 4&#45;5</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_2 -->
<g id="edge299" class="edge">
<title>ln2_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M17154.32,-2951.3C17182.83,-2941.1 17217.59,-2927.93 17248,-2914.34 17349.42,-2869 17463.22,-2806.75 17527.78,-2770.31"/>
<polygon fill="black" stroke="black" points="17529.58,-2773.31 17536.56,-2765.34 17526.13,-2767.22 17529.58,-2773.31"/>
</g>
<!-- expert_2_3 -->
<g id="node163" class="node">
<title>expert_2_3</title>
<polygon fill="lightseagreen" stroke="black" points="16438,-2765.34 16250,-2765.34 16250,-2713.34 16438,-2713.34 16438,-2765.34"/>
<text text-anchor="middle" x="16344" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.3</text>
<text text-anchor="middle" x="16344" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16344" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16344" y="-2720.34" font-family="Arial" font-size="10.00">GPU 6&#45;7</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_3 -->
<g id="edge301" class="edge">
<title>ln2_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M17003,-2965.18C16881.85,-2956.99 16678.42,-2939.96 16608,-2914.34 16517.84,-2881.54 16427.74,-2812.43 16379.64,-2771.87"/>
<polygon fill="black" stroke="black" points="16381.89,-2769.19 16372,-2765.38 16377.35,-2774.52 16381.89,-2769.19"/>
</g>
<!-- expert_2_4 -->
<g id="node164" class="node">
<title>expert_2_4</title>
<polygon fill="lightseagreen" stroke="black" points="17262,-2765.34 17074,-2765.34 17074,-2713.34 17262,-2713.34 17262,-2765.34"/>
<text text-anchor="middle" x="17168" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.4</text>
<text text-anchor="middle" x="17168" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17168" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17168" y="-2720.34" font-family="Arial" font-size="10.00">GPU 8&#45;9</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_4 -->
<g id="edge303" class="edge">
<title>ln2_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M17136.46,-2951.2C17142.98,-2946.25 17148.92,-2940.31 17153,-2933.34 17181.56,-2884.5 17179.04,-2816.43 17173.97,-2775.55"/>
<polygon fill="black" stroke="black" points="17177.43,-2774.96 17172.61,-2765.52 17170.49,-2775.9 17177.43,-2774.96"/>
</g>
<!-- expert_2_5 -->
<g id="node165" class="node">
<title>expert_2_5</title>
<polygon fill="lightseagreen" stroke="black" points="16232,-2765.34 16044,-2765.34 16044,-2713.34 16232,-2713.34 16232,-2765.34"/>
<text text-anchor="middle" x="16138" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.5</text>
<text text-anchor="middle" x="16138" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16138" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16138" y="-2720.34" font-family="Arial" font-size="10.00">GPU 10&#45;11</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_5 -->
<g id="edge305" class="edge">
<title>ln2_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M17002.73,-2968.22C16843.85,-2962.93 16529.8,-2948.42 16425,-2914.34 16327.69,-2882.69 16228.84,-2812.59 16176.35,-2771.68"/>
<polygon fill="black" stroke="black" points="16178.35,-2768.8 16168.33,-2765.37 16174.03,-2774.31 16178.35,-2768.8"/>
</g>
<!-- expert_2_6 -->
<g id="node166" class="node">
<title>expert_2_6</title>
<polygon fill="lightseagreen" stroke="black" points="17056,-2765.34 16868,-2765.34 16868,-2713.34 17056,-2713.34 17056,-2765.34"/>
<text text-anchor="middle" x="16962" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.6</text>
<text text-anchor="middle" x="16962" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16962" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16962" y="-2720.34" font-family="Arial" font-size="10.00">GPU 12&#45;13</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_6 -->
<g id="edge307" class="edge">
<title>ln2_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M17116.05,-2951.14C17124.53,-2941.01 17133.58,-2927.94 17138,-2914.34 17152.27,-2870.38 17163.95,-2848.59 17138,-2810.34 17128.04,-2795.66 17095.23,-2780.93 17060.6,-2768.79"/>
<polygon fill="black" stroke="black" points="17061.39,-2765.36 17050.8,-2765.44 17059.12,-2771.99 17061.39,-2765.36"/>
</g>
<!-- expert_2_7 -->
<g id="node167" class="node">
<title>expert_2_7</title>
<polygon fill="lightseagreen" stroke="black" points="16644,-2765.34 16456,-2765.34 16456,-2713.34 16644,-2713.34 16644,-2765.34"/>
<text text-anchor="middle" x="16550" y="-2753.34" font-family="Arial" font-size="10.00">Expert 2.7</text>
<text text-anchor="middle" x="16550" y="-2742.34" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16550" y="-2731.34" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16550" y="-2720.34" font-family="Arial" font-size="10.00">GPU 14&#45;15</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_7 -->
<g id="edge309" class="edge">
<title>ln2_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M17002.76,-2964.56C16910.26,-2956.92 16776.88,-2941.56 16733,-2914.34 16670.05,-2875.29 16610.47,-2811.98 16577.24,-2773.45"/>
<polygon fill="black" stroke="black" points="16579.71,-2770.95 16570.56,-2765.62 16574.39,-2775.5 16579.71,-2770.95"/>
</g>
<!-- gate2&#45;&gt;expert_2_0 -->
<g id="edge149" class="edge">
<title>gate2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17068.11,-2827.63C17133.7,-2808.92 17214.32,-2785.91 17276.32,-2768.22"/>
<polygon fill="black" stroke="black" points="17277.45,-2771.53 17286.11,-2765.42 17275.53,-2764.8 17277.45,-2771.53"/>
</g>
<!-- gate2&#45;&gt;expert_2_1 -->
<g id="edge150" class="edge">
<title>gate2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16868.01,-2810.2C16846.49,-2796.78 16823.95,-2782.72 16804.79,-2770.77"/>
<polygon fill="black" stroke="black" points="16806.57,-2767.76 16796.23,-2765.43 16802.87,-2773.7 16806.57,-2767.76"/>
</g>
<!-- gate2&#45;&gt;expert_2_2 -->
<g id="edge151" class="edge">
<title>gate2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17077.12,-2840.31C17181.61,-2822.53 17333.67,-2795.51 17475.55,-2765.61"/>
<polygon fill="black" stroke="black" points="17476.69,-2768.94 17485.75,-2763.45 17475.24,-2762.09 17476.69,-2768.94"/>
</g>
<!-- gate2&#45;&gt;expert_2_3 -->
<g id="edge152" class="edge">
<title>gate2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16783.62,-2829.13C16710.19,-2814.98 16622.82,-2798.22 16544,-2783.34 16503.86,-2775.76 16491.54,-2774.64 16448.29,-2765.57"/>
<polygon fill="black" stroke="black" points="16448.76,-2762.09 16438.25,-2763.44 16447.31,-2768.94 16448.76,-2762.09"/>
</g>
<!-- gate2&#45;&gt;expert_2_4 -->
<g id="edge153" class="edge">
<title>gate2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17042.14,-2810.2C17066.54,-2796.66 17092.1,-2782.47 17113.76,-2770.45"/>
<polygon fill="black" stroke="black" points="17115.74,-2773.35 17122.79,-2765.43 17112.35,-2767.23 17115.74,-2773.35"/>
</g>
<!-- gate2&#45;&gt;expert_2_5 -->
<g id="edge154" class="edge">
<title>gate2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16795.05,-2845.04C16653.31,-2829.04 16437.8,-2801.98 16242.11,-2765.48"/>
<polygon fill="black" stroke="black" points="16242.69,-2762.03 16232.21,-2763.62 16241.4,-2768.91 16242.69,-2762.03"/>
</g>
<!-- gate2&#45;&gt;expert_2_6 -->
<g id="edge155" class="edge">
<title>gate2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16955.09,-2810.03C16956.24,-2798.43 16957.43,-2786.38 16958.5,-2775.62"/>
<polygon fill="black" stroke="black" points="16962.01,-2775.65 16959.52,-2765.36 16955.05,-2774.96 16962.01,-2775.65"/>
</g>
<!-- gate2&#45;&gt;expert_2_7 -->
<g id="edge156" class="edge">
<title>gate2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16789.12,-2810.27C16759.84,-2801.17 16729.54,-2791.87 16701,-2783.34 16684.41,-2778.38 16666.75,-2773.23 16649.58,-2768.3"/>
<polygon fill="black" stroke="black" points="16650.12,-2764.81 16639.54,-2765.42 16648.19,-2771.54 16650.12,-2764.81"/>
</g>
<!-- expert_agg_2 -->
<g id="node168" class="node">
<title>expert_agg_2</title>
<polygon fill="lightcoral" stroke="black" points="17169.2,-2676.34 16839.59,-2676.34 16754.8,-2594.34 17084.41,-2594.34 17169.2,-2676.34"/>
<text text-anchor="middle" x="16962" y="-2643.84" font-family="Arial" font-size="10.00">Weighted Sum</text>
<text text-anchor="middle" x="16962" y="-2632.84" font-family="Arial" font-size="10.00">8×[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16962" y="-2621.84" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- expert_2_0&#45;&gt;expert_agg_2 -->
<g id="edge296" class="edge">
<title>expert_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M17280,-2715.07C17236.69,-2704.35 17183.9,-2691.28 17133.87,-2678.89"/>
<polygon fill="black" stroke="black" points="17134.45,-2675.43 17123.9,-2676.42 17132.77,-2682.22 17134.45,-2675.43"/>
</g>
<!-- expert_2_1&#45;&gt;expert_agg_2 -->
<g id="edge298" class="edge">
<title>expert_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16806.66,-2713.26C16826.34,-2703.51 16849.5,-2692.04 16871.84,-2680.98"/>
<polygon fill="black" stroke="black" points="16873.61,-2684.01 16881.02,-2676.44 16870.5,-2677.74 16873.61,-2684.01"/>
</g>
<!-- expert_2_2&#45;&gt;expert_agg_2 -->
<g id="edge300" class="edge">
<title>expert_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M17485.78,-2715.11C17482.82,-2714.5 17479.89,-2713.91 17477,-2713.34 17374.07,-2693.2 17258.66,-2675.49 17163.22,-2662.16"/>
<polygon fill="black" stroke="black" points="17163.55,-2658.67 17153.16,-2660.76 17162.59,-2665.61 17163.55,-2658.67"/>
</g>
<!-- expert_2_3&#45;&gt;expert_agg_2 -->
<g id="edge302" class="edge">
<title>expert_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16438.22,-2715.11C16441.18,-2714.5 16444.11,-2713.91 16447,-2713.34 16567.1,-2689.84 16704.18,-2669.66 16806.71,-2655.86"/>
<polygon fill="black" stroke="black" points="16807.39,-2659.3 16816.84,-2654.51 16806.46,-2652.37 16807.39,-2659.3"/>
</g>
<!-- expert_2_4&#45;&gt;expert_agg_2 -->
<g id="edge304" class="edge">
<title>expert_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M17117.34,-2713.26C17097.66,-2703.51 17074.5,-2692.04 17052.16,-2680.98"/>
<polygon fill="black" stroke="black" points="17053.5,-2677.74 17042.98,-2676.44 17050.39,-2684.01 17053.5,-2677.74"/>
</g>
<!-- expert_2_5&#45;&gt;expert_agg_2 -->
<g id="edge306" class="edge">
<title>expert_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16232.2,-2714.95C16235.16,-2714.38 16238.1,-2713.84 16241,-2713.34 16431.19,-2680.25 16652.24,-2659.17 16798.93,-2647.59"/>
<polygon fill="black" stroke="black" points="16799.23,-2651.08 16808.93,-2646.81 16798.68,-2644.1 16799.23,-2651.08"/>
</g>
<!-- expert_2_6&#45;&gt;expert_agg_2 -->
<g id="edge308" class="edge">
<title>expert_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16962,-2713.13C16962,-2704.98 16962,-2695.65 16962,-2686.35"/>
<polygon fill="black" stroke="black" points="16965.5,-2686.35 16962,-2676.35 16958.5,-2686.35 16965.5,-2686.35"/>
</g>
<!-- expert_2_7&#45;&gt;expert_agg_2 -->
<g id="edge310" class="edge">
<title>expert_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M16644,-2715.07C16696.54,-2702.06 16763.03,-2685.6 16821.61,-2671.1"/>
<polygon fill="black" stroke="black" points="16822.45,-2674.49 16831.32,-2668.69 16820.77,-2667.7 16822.45,-2674.49"/>
</g>
<!-- expert_agg_2&#45;&gt;res2_2 -->
<g id="edge311" class="edge">
<title>expert_agg_2&#45;&gt;res2_2</title>
<path fill="none" stroke="black" d="M17098.72,-2608.05C17192.4,-2590.04 17314.88,-2566.49 17401.35,-2549.86"/>
<polygon fill="black" stroke="black" points="17402.03,-2553.29 17411.19,-2547.96 17400.71,-2546.42 17402.03,-2553.29"/>
</g>
<!-- ln3_1 -->
<g id="node170" class="node">
<title>ln3_1</title>
<polygon fill="lightgreen" stroke="black" points="13828,-2441.36 13640,-2441.36 13640,-2400.36 13828,-2400.36 13828,-2441.36"/>
<text text-anchor="middle" x="13734" y="-2429.36" font-family="Arial" font-size="10.00">LayerNorm 3.1</text>
<text text-anchor="middle" x="13734" y="-2418.36" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="13734" y="-2407.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_2&#45;&gt;ln3_1 -->
<g id="edge313" class="edge">
<title>res2_2&#45;&gt;ln3_1</title>
<path fill="none" stroke="black" d="M17378.64,-2523.73C16790.21,-2507.29 14372.08,-2439.69 13838.5,-2424.78"/>
<polygon fill="black" stroke="black" points="13838.23,-2421.27 13828.13,-2424.49 13838.03,-2428.27 13838.23,-2421.27"/>
</g>
<!-- res3_1 -->
<g id="node241" class="node">
<title>res3_1</title>
<ellipse fill="lightgreen" stroke="black" cx="17710" cy="-1840.37" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="17710" y="-1848.87" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17710" y="-1837.87" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17710" y="-1826.87" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res2_2&#45;&gt;res3_1 -->
<g id="edge432" class="edge">
<title>res2_2&#45;&gt;res3_1</title>
<path fill="none" stroke="black" d="M17637.71,-2524.36C17875.94,-2517.14 18359,-2493.64 18359,-2421.86 18359,-2421.86 18359,-2421.86 18359,-1925.86 18359,-1874.86 18039.79,-1853.84 17849.11,-1845.83"/>
<polygon fill="black" stroke="black" points="17849.13,-1842.33 17839,-1845.41 17848.84,-1849.32 17849.13,-1842.33"/>
</g>
<!-- q_proj_3_0_0 -->
<g id="node171" class="node">
<title>q_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15391,-2363.36 15213,-2363.36 15213,-2322.36 15391,-2322.36 15391,-2363.36"/>
<text text-anchor="middle" x="15302" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15302" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15302" y="-2329.36" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_0_0 -->
<g id="edge314" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_0_0</title>
<path fill="none" stroke="black" d="M13828.49,-2418.18C14106.05,-2412.94 14916.79,-2395.38 15202.94,-2363.35"/>
<polygon fill="black" stroke="black" points="15203.36,-2366.83 15212.9,-2362.21 15202.56,-2359.87 15203.36,-2366.83"/>
</g>
<!-- k_proj_3_0_0 -->
<g id="node172" class="node">
<title>k_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="14999,-2363.36 14821,-2363.36 14821,-2322.36 14999,-2322.36 14999,-2363.36"/>
<text text-anchor="middle" x="14910" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14910" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14910" y="-2329.36" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_0_0 -->
<g id="edge315" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_0_0</title>
<path fill="none" stroke="black" d="M13828.13,-2419.48C14014.26,-2417.75 14442.49,-2408.81 14810.83,-2363.4"/>
<polygon fill="black" stroke="black" points="14811.4,-2366.86 14820.89,-2362.15 14810.53,-2359.91 14811.4,-2366.86"/>
</g>
<!-- v_proj_3_0_0 -->
<g id="node173" class="node">
<title>v_proj_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15195,-2363.36 15017,-2363.36 15017,-2322.36 15195,-2322.36 15195,-2363.36"/>
<text text-anchor="middle" x="15106" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15106" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15106" y="-2329.36" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_0_0 -->
<g id="edge316" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_0_0</title>
<path fill="none" stroke="black" d="M13828.03,-2416.29C13992.75,-2409.97 14344.25,-2396.17 14641,-2382.36 14800.81,-2374.92 14844.16,-2383.22 15006.53,-2363.44"/>
<polygon fill="black" stroke="black" points="15007.4,-2366.86 15016.89,-2362.16 15006.54,-2359.91 15007.4,-2366.86"/>
</g>
<!-- q_proj_3_0_1 -->
<g id="node175" class="node">
<title>q_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="15979,-2363.36 15801,-2363.36 15801,-2322.36 15979,-2322.36 15979,-2363.36"/>
<text text-anchor="middle" x="15890" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15890" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15890" y="-2329.36" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_0_1 -->
<g id="edge321" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_0_1</title>
<path fill="none" stroke="black" d="M13828.12,-2417.45C14054.8,-2411.62 14648.96,-2396.23 15145,-2382.36 15429.2,-2374.41 15504.4,-2395.26 15790.63,-2363.4"/>
<polygon fill="black" stroke="black" points="15791.36,-2366.84 15800.9,-2362.24 15790.57,-2359.88 15791.36,-2366.84"/>
</g>
<!-- k_proj_3_0_1 -->
<g id="node176" class="node">
<title>k_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="15587,-2363.36 15409,-2363.36 15409,-2322.36 15587,-2322.36 15587,-2363.36"/>
<text text-anchor="middle" x="15498" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15498" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15498" y="-2329.36" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_0_1 -->
<g id="edge322" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_0_1</title>
<path fill="none" stroke="black" d="M13828.22,-2417.41C14034.36,-2411.97 14540.87,-2398.08 14965,-2382.36 15155.08,-2375.31 15206.14,-2386.15 15398.72,-2363.4"/>
<polygon fill="black" stroke="black" points="15399.38,-2366.85 15408.89,-2362.19 15398.55,-2359.9 15399.38,-2366.85"/>
</g>
<!-- v_proj_3_0_1 -->
<g id="node177" class="node">
<title>v_proj_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="15783,-2363.36 15605,-2363.36 15605,-2322.36 15783,-2322.36 15783,-2363.36"/>
<text text-anchor="middle" x="15694" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15694" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15694" y="-2329.36" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_0_1 -->
<g id="edge323" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_0_1</title>
<path fill="none" stroke="black" d="M13828.25,-2417.05C14036.28,-2410.85 14550.45,-2395.48 14981,-2382.36 15251,-2374.13 15322.56,-2393.88 15594.72,-2363.39"/>
<polygon fill="black" stroke="black" points="15595.36,-2366.84 15604.9,-2362.24 15594.57,-2359.88 15595.36,-2366.84"/>
</g>
<!-- q_proj_3_0_2 -->
<g id="node179" class="node">
<title>q_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14215,-2363.36 14037,-2363.36 14037,-2322.36 14215,-2322.36 14215,-2363.36"/>
<text text-anchor="middle" x="14126" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14126" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14126" y="-2329.36" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_0_2 -->
<g id="edge328" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_0_2</title>
<path fill="none" stroke="black" d="M13828.04,-2401.95C13883.17,-2391.41 13954.44,-2377.72 14026.62,-2363.62"/>
<polygon fill="black" stroke="black" points="14027.66,-2366.98 14036.81,-2361.63 14026.32,-2360.11 14027.66,-2366.98"/>
</g>
<!-- k_proj_3_0_2 -->
<g id="node180" class="node">
<title>k_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="13823,-2363.36 13645,-2363.36 13645,-2322.36 13823,-2322.36 13823,-2363.36"/>
<text text-anchor="middle" x="13734" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13734" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13734" y="-2329.36" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_0_2 -->
<g id="edge329" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_0_2</title>
<path fill="none" stroke="black" d="M13734,-2400.29C13734,-2392.13 13734,-2382.48 13734,-2373.49"/>
<polygon fill="black" stroke="black" points="13737.5,-2373.36 13734,-2363.36 13730.5,-2373.36 13737.5,-2373.36"/>
</g>
<!-- v_proj_3_0_2 -->
<g id="node181" class="node">
<title>v_proj_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14019,-2363.36 13841,-2363.36 13841,-2322.36 14019,-2322.36 14019,-2363.36"/>
<text text-anchor="middle" x="13930" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13930" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13930" y="-2329.36" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_0_2 -->
<g id="edge330" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_0_2</title>
<path fill="none" stroke="black" d="M13784.47,-2400.29C13810.65,-2390.14 13842.8,-2377.67 13870.21,-2367.04"/>
<polygon fill="black" stroke="black" points="13871.64,-2370.24 13879.7,-2363.36 13869.11,-2363.72 13871.64,-2370.24"/>
</g>
<!-- q_proj_3_0_3 -->
<g id="node183" class="node">
<title>q_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="14803,-2363.36 14625,-2363.36 14625,-2322.36 14803,-2322.36 14803,-2363.36"/>
<text text-anchor="middle" x="14714" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14714" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14714" y="-2329.36" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_0_3 -->
<g id="edge335" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_0_3</title>
<path fill="none" stroke="black" d="M13828.06,-2417.92C13987.93,-2413.72 14322.91,-2401.02 14614.95,-2363.4"/>
<polygon fill="black" stroke="black" points="14615.42,-2366.87 14624.89,-2362.11 14614.52,-2359.93 14615.42,-2366.87"/>
</g>
<!-- k_proj_3_0_3 -->
<g id="node184" class="node">
<title>k_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="14411,-2363.36 14233,-2363.36 14233,-2322.36 14411,-2322.36 14411,-2363.36"/>
<text text-anchor="middle" x="14322" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14322" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14322" y="-2329.36" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_0_3 -->
<g id="edge336" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_0_3</title>
<path fill="none" stroke="black" d="M13828.24,-2411.29C13924.82,-2401.99 14079.49,-2385.65 14222.58,-2363.52"/>
<polygon fill="black" stroke="black" points="14223.52,-2366.91 14232.86,-2361.92 14222.44,-2360 14223.52,-2366.91"/>
</g>
<!-- v_proj_3_0_3 -->
<g id="node185" class="node">
<title>v_proj_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="14607,-2363.36 14429,-2363.36 14429,-2322.36 14607,-2322.36 14607,-2363.36"/>
<text text-anchor="middle" x="14518" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14518" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14518" y="-2329.36" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_0_3 -->
<g id="edge337" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_0_3</title>
<path fill="none" stroke="black" d="M13828.14,-2415.51C13958.68,-2408.73 14202.13,-2393.33 14418.9,-2363.43"/>
<polygon fill="black" stroke="black" points="14419.45,-2366.89 14428.88,-2362.04 14418.49,-2359.95 14419.45,-2366.89"/>
</g>
<!-- q_proj_3_1_0 -->
<g id="node187" class="node">
<title>q_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17743,-2363.36 17565,-2363.36 17565,-2322.36 17743,-2322.36 17743,-2363.36"/>
<text text-anchor="middle" x="17654" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17654" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17654" y="-2329.36" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_0 -->
<g id="edge342" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_0</title>
<path fill="none" stroke="black" d="M13828.28,-2419.4C14213.67,-2417.41 15707.03,-2408.33 16935,-2382.36 17207.7,-2376.59 17279.89,-2394.19 17554.62,-2363.4"/>
<polygon fill="black" stroke="black" points="17555.36,-2366.84 17564.9,-2362.24 17554.57,-2359.88 17555.36,-2366.84"/>
</g>
<!-- k_proj_3_1_0 -->
<g id="node188" class="node">
<title>k_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17351,-2363.36 17173,-2363.36 17173,-2322.36 17351,-2322.36 17351,-2363.36"/>
<text text-anchor="middle" x="17262" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17262" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17262" y="-2329.36" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_0 -->
<g id="edge343" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_0</title>
<path fill="none" stroke="black" d="M13828.14,-2419.18C14183.16,-2416.5 15474.81,-2405.65 16539,-2382.36 16813.45,-2376.35 16886.11,-2394.36 17162.56,-2363.41"/>
<polygon fill="black" stroke="black" points="17163.36,-2366.84 17172.9,-2362.24 17162.57,-2359.88 17163.36,-2366.84"/>
</g>
<!-- v_proj_3_1_0 -->
<g id="node189" class="node">
<title>v_proj_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17547,-2363.36 17369,-2363.36 17369,-2322.36 17547,-2322.36 17547,-2363.36"/>
<text text-anchor="middle" x="17458" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17458" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17458" y="-2329.36" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_0 -->
<g id="edge344" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_0</title>
<path fill="none" stroke="black" d="M13828.05,-2419.3C14198.25,-2416.97 15590.85,-2406.99 16737,-2382.36 17010.57,-2376.48 17083,-2394.27 17358.59,-2363.4"/>
<polygon fill="black" stroke="black" points="17359.36,-2366.84 17368.9,-2362.24 17358.57,-2359.88 17359.36,-2366.84"/>
</g>
<!-- q_proj_3_1_1 -->
<g id="node191" class="node">
<title>q_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18331,-2363.36 18153,-2363.36 18153,-2322.36 18331,-2322.36 18331,-2363.36"/>
<text text-anchor="middle" x="18242" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="18242" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18242" y="-2329.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_1 -->
<g id="edge349" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_1</title>
<path fill="none" stroke="black" d="M13828.11,-2419.64C14254.73,-2418.52 16050.14,-2412.17 17523,-2382.36 17795.7,-2376.84 17867.89,-2394.2 18142.62,-2363.4"/>
<polygon fill="black" stroke="black" points="18143.36,-2366.84 18152.9,-2362.24 18142.57,-2359.89 18143.36,-2366.84"/>
</g>
<!-- k_proj_3_1_1 -->
<g id="node192" class="node">
<title>k_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="17939,-2363.36 17761,-2363.36 17761,-2322.36 17939,-2322.36 17939,-2363.36"/>
<text text-anchor="middle" x="17850" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17850" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17850" y="-2329.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_1 -->
<g id="edge350" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_1</title>
<path fill="none" stroke="black" d="M13828.12,-2419.48C14227.21,-2417.76 15819.11,-2409.46 17127,-2382.36 17401.45,-2376.67 17474.11,-2394.36 17750.56,-2363.41"/>
<polygon fill="black" stroke="black" points="17751.36,-2366.84 17760.9,-2362.24 17750.57,-2359.88 17751.36,-2366.84"/>
</g>
<!-- v_proj_3_1_1 -->
<g id="node193" class="node">
<title>v_proj_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18135,-2363.36 17957,-2363.36 17957,-2322.36 18135,-2322.36 18135,-2363.36"/>
<text text-anchor="middle" x="18046" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="18046" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18046" y="-2329.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_1 -->
<g id="edge351" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_1</title>
<path fill="none" stroke="black" d="M13828.33,-2419.57C14241.76,-2418.15 15934.95,-2410.81 17325,-2382.36 17598.58,-2376.76 17671,-2394.28 17946.59,-2363.4"/>
<polygon fill="black" stroke="black" points="17947.36,-2366.84 17956.9,-2362.24 17946.57,-2359.88 17947.36,-2366.84"/>
</g>
<!-- q_proj_3_1_2 -->
<g id="node195" class="node">
<title>q_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16567,-2363.36 16389,-2363.36 16389,-2322.36 16567,-2322.36 16567,-2363.36"/>
<text text-anchor="middle" x="16478" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16478" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16478" y="-2329.36" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_2 -->
<g id="edge356" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_2</title>
<path fill="none" stroke="black" d="M13828.19,-2418.48C14115.5,-2414.18 15006.04,-2400.26 15744,-2382.36 16023.4,-2375.58 16097.29,-2394.82 16378.8,-2363.38"/>
<polygon fill="black" stroke="black" points="16379.36,-2366.84 16388.9,-2362.24 16378.57,-2359.88 16379.36,-2366.84"/>
</g>
<!-- k_proj_3_1_2 -->
<g id="node196" class="node">
<title>k_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16175,-2363.36 15997,-2363.36 15997,-2322.36 16175,-2322.36 16175,-2363.36"/>
<text text-anchor="middle" x="16086" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16086" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16086" y="-2329.36" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_2 -->
<g id="edge357" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_2</title>
<path fill="none" stroke="black" d="M13828.37,-2417.86C14076.59,-2412.58 14768.25,-2397.56 15344,-2382.36 15626.89,-2374.89 15701.73,-2395.15 15986.68,-2363.39"/>
<polygon fill="black" stroke="black" points="15987.36,-2366.84 15996.9,-2362.24 15986.57,-2359.88 15987.36,-2366.84"/>
</g>
<!-- v_proj_3_1_2 -->
<g id="node197" class="node">
<title>v_proj_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16371,-2363.36 16193,-2363.36 16193,-2322.36 16371,-2322.36 16371,-2363.36"/>
<text text-anchor="middle" x="16282" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16282" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16282" y="-2329.36" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_2 -->
<g id="edge358" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_2</title>
<path fill="none" stroke="black" d="M13828.43,-2418.21C14097.28,-2413.46 14889.86,-2398.99 15548,-2382.36 15827.39,-2375.3 15901.29,-2394.82 16182.8,-2363.38"/>
<polygon fill="black" stroke="black" points="16183.36,-2366.84 16192.9,-2362.24 16182.57,-2359.88 16183.36,-2366.84"/>
</g>
<!-- q_proj_3_1_3 -->
<g id="node199" class="node">
<title>q_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="17155,-2363.36 16977,-2363.36 16977,-2322.36 17155,-2322.36 17155,-2363.36"/>
<text text-anchor="middle" x="17066" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17066" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17066" y="-2329.36" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_1_3 -->
<g id="edge363" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_1_3</title>
<path fill="none" stroke="black" d="M13828.08,-2419.04C14167.07,-2415.99 15357.8,-2404.28 16340,-2382.36 16615.9,-2376.2 16688.85,-2394.5 16966.92,-2363.37"/>
<polygon fill="black" stroke="black" points="16967.36,-2366.84 16976.9,-2362.24 16966.57,-2359.88 16967.36,-2366.84"/>
</g>
<!-- k_proj_3_1_3 -->
<g id="node200" class="node">
<title>k_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="16763,-2363.36 16585,-2363.36 16585,-2322.36 16763,-2322.36 16763,-2363.36"/>
<text text-anchor="middle" x="16674" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16674" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16674" y="-2329.36" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_1_3 -->
<g id="edge364" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_1_3</title>
<path fill="none" stroke="black" d="M13828.06,-2418.71C14133.55,-2414.87 15125.49,-2401.68 15946,-2382.36 16222.77,-2375.84 16295.96,-2394.58 16574.89,-2363.37"/>
<polygon fill="black" stroke="black" points="16575.36,-2366.84 16584.9,-2362.24 16574.57,-2359.88 16575.36,-2366.84"/>
</g>
<!-- v_proj_3_1_3 -->
<g id="node201" class="node">
<title>v_proj_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="16959,-2363.36 16781,-2363.36 16781,-2322.36 16959,-2322.36 16959,-2363.36"/>
<text text-anchor="middle" x="16870" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16870" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16870" y="-2329.36" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_1_3 -->
<g id="edge365" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_1_3</title>
<path fill="none" stroke="black" d="M13828.02,-2418.88C14150.28,-2415.43 15239.96,-2402.9 16140,-2382.36 16417.65,-2376.02 16491.07,-2394.66 16770.86,-2363.37"/>
<polygon fill="black" stroke="black" points="16771.36,-2366.84 16780.9,-2362.24 16770.57,-2359.88 16771.36,-2366.84"/>
</g>
<!-- q_proj_3_2_0 -->
<g id="node203" class="node">
<title>q_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10687,-2363.36 10509,-2363.36 10509,-2322.36 10687,-2322.36 10687,-2363.36"/>
<text text-anchor="middle" x="10598" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="10598" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10598" y="-2329.36" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_2_0 -->
<g id="edge370" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_2_0</title>
<path fill="none" stroke="black" d="M13639.79,-2419.49C13301.02,-2417.94 12112.86,-2410.72 11133,-2382.36 10941.9,-2376.83 10890.7,-2386.29 10697.04,-2363.38"/>
<polygon fill="black" stroke="black" points="10697.45,-2359.9 10687.11,-2362.19 10696.62,-2366.85 10697.45,-2359.9"/>
</g>
<!-- k_proj_3_2_0 -->
<g id="node204" class="node">
<title>k_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10295,-2363.36 10117,-2363.36 10117,-2322.36 10295,-2322.36 10295,-2363.36"/>
<text text-anchor="middle" x="10206" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="10206" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10206" y="-2329.36" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_2_0 -->
<g id="edge371" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_2_0</title>
<path fill="none" stroke="black" d="M13639.97,-2419.7C13271.37,-2418.84 11889.32,-2413.62 10752,-2382.36 10556.09,-2376.97 10503.6,-2386.76 10305.28,-2363.4"/>
<polygon fill="black" stroke="black" points="10305.45,-2359.9 10295.1,-2362.19 10304.62,-2366.85 10305.45,-2359.9"/>
</g>
<!-- v_proj_3_2_0 -->
<g id="node205" class="node">
<title>v_proj_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10491,-2363.36 10313,-2363.36 10313,-2322.36 10491,-2322.36 10491,-2363.36"/>
<text text-anchor="middle" x="10402" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10402" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10402" y="-2329.36" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_2_0 -->
<g id="edge372" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_2_0</title>
<path fill="none" stroke="black" d="M13639.91,-2419.12C13298.21,-2416.33 12090.76,-2405.33 11095,-2382.36 10833.85,-2376.33 10764.61,-2393.06 10501.35,-2363.4"/>
<polygon fill="black" stroke="black" points="10501.43,-2359.89 10491.1,-2362.23 10500.64,-2366.84 10501.43,-2359.89"/>
</g>
<!-- q_proj_3_2_1 -->
<g id="node207" class="node">
<title>q_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11275,-2363.36 11097,-2363.36 11097,-2322.36 11275,-2322.36 11275,-2363.36"/>
<text text-anchor="middle" x="11186" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11186" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11186" y="-2329.36" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_2_1 -->
<g id="edge377" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_2_1</title>
<path fill="none" stroke="black" d="M13639.65,-2418.32C13367.38,-2413.82 12556.78,-2399.83 11884,-2382.36 11620.55,-2375.52 11550.76,-2393.27 11285.04,-2363.36"/>
<polygon fill="black" stroke="black" points="11285.43,-2359.89 11275.1,-2362.23 11284.64,-2366.84 11285.43,-2359.89"/>
</g>
<!-- k_proj_3_2_1 -->
<g id="node208" class="node">
<title>k_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10883,-2363.36 10705,-2363.36 10705,-2322.36 10883,-2322.36 10883,-2363.36"/>
<text text-anchor="middle" x="10794" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="10794" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10794" y="-2329.36" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_2_1 -->
<g id="edge378" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_2_1</title>
<path fill="none" stroke="black" d="M13639.92,-2418.74C13333.27,-2415 12334.81,-2402.03 11509,-2382.36 11238.07,-2375.9 11166.33,-2394.01 10893.31,-2363.39"/>
<polygon fill="black" stroke="black" points="10893.43,-2359.88 10883.1,-2362.24 10892.64,-2366.84 10893.43,-2359.88"/>
</g>
<!-- v_proj_3_2_1 -->
<g id="node209" class="node">
<title>v_proj_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11079,-2363.36 10901,-2363.36 10901,-2322.36 11079,-2322.36 11079,-2363.36"/>
<text text-anchor="middle" x="10990" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10990" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10990" y="-2329.36" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_2_1 -->
<g id="edge379" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_2_1</title>
<path fill="none" stroke="black" d="M13639.75,-2419.05C13336.42,-2416.27 12358.19,-2405.97 11549,-2382.36 11347.33,-2376.47 11293.35,-2387.3 11089.25,-2363.4"/>
<polygon fill="black" stroke="black" points="11089.45,-2359.9 11079.1,-2362.2 11088.62,-2366.85 11089.45,-2359.9"/>
</g>
<!-- q_proj_3_2_2 -->
<g id="node211" class="node">
<title>q_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9511,-2363.36 9333,-2363.36 9333,-2322.36 9511,-2322.36 9511,-2363.36"/>
<text text-anchor="middle" x="9422" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="9422" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9422" y="-2329.36" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_2_2 -->
<g id="edge384" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_2_2</title>
<path fill="none" stroke="black" d="M13639.9,-2420.07C13214.28,-2420.81 11426.4,-2421.29 9960,-2382.36 9767.58,-2377.25 9716.04,-2386.43 9521.1,-2363.38"/>
<polygon fill="black" stroke="black" points="9521.45,-2359.9 9511.1,-2362.19 9520.62,-2366.85 9521.45,-2359.9"/>
</g>
<!-- k_proj_3_2_2 -->
<g id="node212" class="node">
<title>k_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9119,-2363.36 8941,-2363.36 8941,-2322.36 9119,-2322.36 9119,-2363.36"/>
<text text-anchor="middle" x="9030" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9030" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9030" y="-2329.36" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_2_2 -->
<g id="edge385" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_2_2</title>
<path fill="none" stroke="black" d="M13639.86,-2420.18C13188.52,-2421.49 11201.07,-2424.44 9573,-2382.36 9378.39,-2377.33 9326.26,-2386.65 9129.21,-2363.4"/>
<polygon fill="black" stroke="black" points="9129.45,-2359.9 9119.1,-2362.19 9128.62,-2366.85 9129.45,-2359.9"/>
</g>
<!-- v_proj_3_2_2 -->
<g id="node213" class="node">
<title>v_proj_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9315,-2363.36 9137,-2363.36 9137,-2322.36 9315,-2322.36 9315,-2363.36"/>
<text text-anchor="middle" x="9226" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9226" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9226" y="-2329.36" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_2_2 -->
<g id="edge386" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_2_2</title>
<path fill="none" stroke="black" d="M13639.77,-2419.72C13210.61,-2418.91 11397.88,-2413.71 9911,-2382.36 9653.35,-2376.92 9585.04,-2392.74 9325.22,-2363.39"/>
<polygon fill="black" stroke="black" points="9325.43,-2359.89 9315.1,-2362.23 9324.64,-2366.84 9325.43,-2359.89"/>
</g>
<!-- q_proj_3_2_3 -->
<g id="node215" class="node">
<title>q_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10099,-2363.36 9921,-2363.36 9921,-2322.36 10099,-2322.36 10099,-2363.36"/>
<text text-anchor="middle" x="10010" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="10010" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10010" y="-2329.36" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_2_3 -->
<g id="edge391" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_2_3</title>
<path fill="none" stroke="black" d="M13639.7,-2419.34C13267.76,-2417.15 11866.34,-2407.62 10713,-2382.36 10447.33,-2376.54 10376.99,-2393.51 10109.12,-2363.37"/>
<polygon fill="black" stroke="black" points="10109.43,-2359.89 10099.1,-2362.23 10108.64,-2366.84 10109.43,-2359.89"/>
</g>
<!-- k_proj_3_2_3 -->
<g id="node216" class="node">
<title>k_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="9707,-2363.36 9529,-2363.36 9529,-2322.36 9707,-2322.36 9707,-2363.36"/>
<text text-anchor="middle" x="9618" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9618" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9618" y="-2329.36" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_2_3 -->
<g id="edge392" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_2_3</title>
<path fill="none" stroke="black" d="M13639.86,-2419.54C13238.96,-2418.03 11634.25,-2410.46 10316,-2382.36 10052.52,-2376.74 9982.76,-2393.3 9717.04,-2363.36"/>
<polygon fill="black" stroke="black" points="9717.43,-2359.89 9707.1,-2362.23 9716.64,-2366.84 9717.43,-2359.89"/>
</g>
<!-- v_proj_3_2_3 -->
<g id="node217" class="node">
<title>v_proj_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="9903,-2363.36 9725,-2363.36 9725,-2322.36 9903,-2322.36 9903,-2363.36"/>
<text text-anchor="middle" x="9814" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9814" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9814" y="-2329.36" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_2_3 -->
<g id="edge393" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_2_3</title>
<path fill="none" stroke="black" d="M13639.89,-2419.91C13241.73,-2419.91 11656.31,-2417.56 10354,-2382.36 10160.71,-2377.13 10108.93,-2386.51 9913.14,-2363.39"/>
<polygon fill="black" stroke="black" points="9913.45,-2359.9 9903.1,-2362.19 9912.62,-2366.85 9913.45,-2359.9"/>
</g>
<!-- q_proj_3_3_0 -->
<g id="node219" class="node">
<title>q_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13039,-2363.36 12861,-2363.36 12861,-2322.36 13039,-2322.36 13039,-2363.36"/>
<text text-anchor="middle" x="12950" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12950" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12950" y="-2329.36" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_3_0 -->
<g id="edge398" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_3_0</title>
<path fill="none" stroke="black" d="M13715.74,-2400.13C13707.71,-2392.82 13697.67,-2385.34 13687,-2381.36 13622.86,-2357.42 13154.28,-2370.3 13049.33,-2363.14"/>
<polygon fill="black" stroke="black" points="13049.36,-2359.63 13039.1,-2362.25 13048.76,-2366.6 13049.36,-2359.63"/>
</g>
<!-- k_proj_3_3_0 -->
<g id="node220" class="node">
<title>k_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12647,-2363.36 12469,-2363.36 12469,-2322.36 12647,-2322.36 12647,-2363.36"/>
<text text-anchor="middle" x="12558" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="12558" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12558" y="-2329.36" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_3_0 -->
<g id="edge399" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_3_0</title>
<path fill="none" stroke="black" d="M13686.87,-2400.31C13666.65,-2392.89 13642.54,-2385.28 13620,-2381.36 13412,-2345.19 12884.77,-2385.15 12657.05,-2363.3"/>
<polygon fill="black" stroke="black" points="12657.4,-2359.82 12647.09,-2362.28 12656.69,-2366.78 12657.4,-2359.82"/>
</g>
<!-- v_proj_3_3_0 -->
<g id="node221" class="node">
<title>v_proj_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12843,-2363.36 12665,-2363.36 12665,-2322.36 12843,-2322.36 12843,-2363.36"/>
<text text-anchor="middle" x="12754" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12754" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12754" y="-2329.36" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_3_0 -->
<g id="edge400" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_3_0</title>
<path fill="none" stroke="black" d="M13704.83,-2400.23C13692.22,-2392.84 13676.94,-2385.28 13662,-2381.36 13577.48,-2359.18 12978.13,-2372.35 12853.09,-2363.16"/>
<polygon fill="black" stroke="black" points="12853.37,-2359.67 12843.1,-2362.27 12852.74,-2366.65 12853.37,-2359.67"/>
</g>
<!-- q_proj_3_3_1 -->
<g id="node223" class="node">
<title>q_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13627,-2363.36 13449,-2363.36 13449,-2322.36 13627,-2322.36 13627,-2363.36"/>
<text text-anchor="middle" x="13538" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="13538" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13538" y="-2329.36" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_3_1 -->
<g id="edge405" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_3_1</title>
<path fill="none" stroke="black" d="M13731.4,-2400C13729.55,-2393.2 13726.39,-2386.12 13721,-2381.36 13720.09,-2380.55 13679.73,-2372.24 13637.14,-2363.65"/>
<polygon fill="black" stroke="black" points="13637.67,-2360.19 13627.17,-2361.64 13636.28,-2367.05 13637.67,-2360.19"/>
</g>
<!-- k_proj_3_3_1 -->
<g id="node224" class="node">
<title>k_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13235,-2363.36 13057,-2363.36 13057,-2322.36 13235,-2322.36 13235,-2363.36"/>
<text text-anchor="middle" x="13146" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13146" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13146" y="-2329.36" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_3_1 -->
<g id="edge406" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_3_1</title>
<path fill="none" stroke="black" d="M13723.2,-2400.31C13718.09,-2393.02 13711.28,-2385.52 13703,-2381.36 13659.54,-2359.5 13327.99,-2368.41 13245.42,-2363.1"/>
<polygon fill="black" stroke="black" points="13245.37,-2359.58 13235.1,-2362.2 13244.76,-2366.55 13245.37,-2359.58"/>
</g>
<!-- v_proj_3_3_1 -->
<g id="node225" class="node">
<title>v_proj_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13431,-2363.36 13253,-2363.36 13253,-2322.36 13431,-2322.36 13431,-2363.36"/>
<text text-anchor="middle" x="13342" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13342" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13342" y="-2329.36" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_3_1 -->
<g id="edge407" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_3_1</title>
<path fill="none" stroke="black" d="M13727.82,-2400.17C13724.57,-2393.05 13719.8,-2385.7 13713,-2381.36 13689.09,-2366.07 13498.15,-2367.1 13441.14,-2363.05"/>
<polygon fill="black" stroke="black" points="13441.4,-2359.56 13431.12,-2362.1 13440.74,-2366.53 13441.4,-2359.56"/>
</g>
<!-- q_proj_3_3_2 -->
<g id="node227" class="node">
<title>q_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11863,-2363.36 11685,-2363.36 11685,-2322.36 11863,-2322.36 11863,-2363.36"/>
<text text-anchor="middle" x="11774" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11774" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11774" y="-2329.36" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_3_2 -->
<g id="edge412" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_3_2</title>
<path fill="none" stroke="black" d="M13639.87,-2416.7C13436.92,-2409.94 12942.99,-2393.64 12529,-2381.36 12386.15,-2377.12 12032.76,-2379.56 11873.32,-2363.34"/>
<polygon fill="black" stroke="black" points="11873.41,-2359.84 11863.1,-2362.25 11872.67,-2366.8 11873.41,-2359.84"/>
</g>
<!-- k_proj_3_3_2 -->
<g id="node228" class="node">
<title>k_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11471,-2363.36 11293,-2363.36 11293,-2322.36 11471,-2322.36 11471,-2363.36"/>
<text text-anchor="middle" x="11382" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11382" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11382" y="-2329.36" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_3_2 -->
<g id="edge413" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_3_2</title>
<path fill="none" stroke="black" d="M13639.66,-2418.65C13371.08,-2415.04 12579.29,-2403.28 11922,-2382.36 11728.74,-2376.2 11676.93,-2386.48 11481.14,-2363.39"/>
<polygon fill="black" stroke="black" points="11481.45,-2359.9 11471.1,-2362.19 11480.62,-2366.85 11481.45,-2359.9"/>
</g>
<!-- v_proj_3_3_2 -->
<g id="node229" class="node">
<title>v_proj_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11667,-2363.36 11489,-2363.36 11489,-2322.36 11667,-2322.36 11667,-2363.36"/>
<text text-anchor="middle" x="11578" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="11578" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11578" y="-2329.36" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_3_2 -->
<g id="edge414" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_3_2</title>
<path fill="none" stroke="black" d="M13639.74,-2419.39C13292.52,-2417.32 12084.44,-2407.16 11677.16,-2363.36"/>
<polygon fill="black" stroke="black" points="11677.42,-2359.86 11667.1,-2362.25 11676.66,-2366.82 11677.42,-2359.86"/>
</g>
<!-- q_proj_3_3_3 -->
<g id="node231" class="node">
<title>q_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12451,-2363.36 12273,-2363.36 12273,-2322.36 12451,-2322.36 12451,-2363.36"/>
<text text-anchor="middle" x="12362" y="-2351.36" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12362" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12362" y="-2329.36" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln3_1&#45;&gt;q_proj_3_3_3 -->
<g id="edge419" class="edge">
<title>ln3_1&#45;&gt;q_proj_3_3_3</title>
<path fill="none" stroke="black" d="M13653.23,-2400.28C13619.12,-2392.89 13578.84,-2385.32 13542,-2381.36 13067.19,-2330.23 12940.03,-2413.3 12461.39,-2363.38"/>
<polygon fill="black" stroke="black" points="12461.41,-2359.86 12451.09,-2362.29 12460.67,-2366.82 12461.41,-2359.86"/>
</g>
<!-- k_proj_3_3_3 -->
<g id="node232" class="node">
<title>k_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12059,-2363.36 11881,-2363.36 11881,-2322.36 12059,-2322.36 12059,-2363.36"/>
<text text-anchor="middle" x="11970" y="-2351.36" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11970" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11970" y="-2329.36" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln3_1&#45;&gt;k_proj_3_3_3 -->
<g id="edge420" class="edge">
<title>ln3_1&#45;&gt;k_proj_3_3_3</title>
<path fill="none" stroke="black" d="M13639.99,-2412.84C13516.75,-2403.93 13293.82,-2388.83 13103,-2381.36 12876.4,-2372.48 12312.98,-2387.47 12069.39,-2363.35"/>
<polygon fill="black" stroke="black" points="12069.4,-2359.83 12059.09,-2362.29 12068.68,-2366.8 12069.4,-2359.83"/>
</g>
<!-- v_proj_3_3_3 -->
<g id="node233" class="node">
<title>v_proj_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12255,-2363.36 12077,-2363.36 12077,-2322.36 12255,-2322.36 12255,-2363.36"/>
<text text-anchor="middle" x="12166" y="-2351.36" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12166" y="-2340.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12166" y="-2329.36" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln3_1&#45;&gt;v_proj_3_3_3 -->
<g id="edge421" class="edge">
<title>ln3_1&#45;&gt;v_proj_3_3_3</title>
<path fill="none" stroke="black" d="M13639.77,-2406.74C13571.43,-2397.84 13476.68,-2386.74 13393,-2381.36 13145.77,-2365.47 12529.42,-2389.33 12265.11,-2363.32"/>
<polygon fill="black" stroke="black" points="12265.4,-2359.83 12255.09,-2362.29 12264.68,-2366.8 12265.4,-2359.83"/>
</g>
<!-- attn_3_0_0 -->
<g id="node174" class="node">
<title>attn_3_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15097,-2285.36 14919,-2285.36 14919,-2244.36 15097,-2244.36 15097,-2285.36"/>
<text text-anchor="middle" x="15008" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15008" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15008" y="-2251.36" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge317" class="edge">
<title>q_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M15226.29,-2322.29C15185.65,-2311.78 15135.42,-2298.8 15093.4,-2287.93"/>
<polygon fill="black" stroke="black" points="15094.01,-2284.48 15083.46,-2285.36 15092.26,-2291.25 15094.01,-2284.48"/>
</g>
<!-- k_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge318" class="edge">
<title>k_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M14935.24,-2322.29C14947.24,-2312.98 14961.75,-2301.72 14974.65,-2291.72"/>
<polygon fill="black" stroke="black" points="14977.09,-2294.26 14982.85,-2285.36 14972.8,-2288.73 14977.09,-2294.26"/>
</g>
<!-- v_proj_3_0_0&#45;&gt;attn_3_0_0 -->
<g id="edge319" class="edge">
<title>v_proj_3_0_0&#45;&gt;attn_3_0_0</title>
<path fill="none" stroke="black" d="M15080.76,-2322.29C15068.76,-2312.98 15054.25,-2301.72 15041.35,-2291.72"/>
<polygon fill="black" stroke="black" points="15043.2,-2288.73 15033.15,-2285.36 15038.91,-2294.26 15043.2,-2288.73"/>
</g>
<!-- agg_dim_3_0 -->
<g id="node235" class="node">
<title>agg_dim_3_0</title>
<polygon fill="lightcoral" stroke="black" points="14918.57,-2207.36 14749.04,-2207.36 14705.43,-2103.36 14874.96,-2103.36 14918.57,-2207.36"/>
<text text-anchor="middle" x="14812" y="-2169.36" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="14812" y="-2158.36" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="14812" y="-2147.36" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="14812" y="-2136.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_0_0&#45;&gt;agg_dim_3_0 -->
<g id="edge320" class="edge">
<title>attn_3_0_0&#45;&gt;agg_dim_3_0</title>
<path fill="none" stroke="black" d="M14972.05,-2244.14C14955.51,-2235.07 14934.98,-2223.81 14914.18,-2212.4"/>
<polygon fill="black" stroke="black" points="14915.72,-2209.25 14905.27,-2207.51 14912.35,-2215.39 14915.72,-2209.25"/>
</g>
<!-- attn_3_0_1 -->
<g id="node178" class="node">
<title>attn_3_0_1</title>
<polygon fill="lightgreen" stroke="black" points="15638,-2285.36 15460,-2285.36 15460,-2244.36 15638,-2244.36 15638,-2285.36"/>
<text text-anchor="middle" x="15549" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15549" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15549" y="-2251.36" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge324" class="edge">
<title>q_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M15802.18,-2322.29C15754.55,-2311.67 15695.56,-2298.52 15646.51,-2287.59"/>
<polygon fill="black" stroke="black" points="15647.04,-2284.12 15636.52,-2285.36 15645.52,-2290.95 15647.04,-2284.12"/>
</g>
<!-- k_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge325" class="edge">
<title>k_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M15511.13,-2322.29C15516.96,-2313.6 15523.93,-2303.21 15530.29,-2293.74"/>
<polygon fill="black" stroke="black" points="15533.24,-2295.62 15535.91,-2285.36 15527.43,-2291.72 15533.24,-2295.62"/>
</g>
<!-- v_proj_3_0_1&#45;&gt;attn_3_0_1 -->
<g id="edge326" class="edge">
<title>v_proj_3_0_1&#45;&gt;attn_3_0_1</title>
<path fill="none" stroke="black" d="M15656.66,-2322.29C15637.89,-2312.45 15614.96,-2300.43 15595.1,-2290.02"/>
<polygon fill="black" stroke="black" points="15596.7,-2286.91 15586.21,-2285.36 15593.45,-2293.11 15596.7,-2286.91"/>
</g>
<!-- attn_3_0_1&#45;&gt;agg_dim_3_0 -->
<g id="edge327" class="edge">
<title>attn_3_0_1&#45;&gt;agg_dim_3_0</title>
<path fill="none" stroke="black" d="M15459.73,-2250.84C15321.82,-2230.72 15057.79,-2192.21 14913.05,-2171.1"/>
<polygon fill="black" stroke="black" points="14913.24,-2167.59 14902.84,-2169.61 14912.23,-2174.51 14913.24,-2167.59"/>
</g>
<!-- attn_3_0_2 -->
<g id="node182" class="node">
<title>attn_3_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14070,-2285.36 13892,-2285.36 13892,-2244.36 14070,-2244.36 14070,-2285.36"/>
<text text-anchor="middle" x="13981" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13981" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13981" y="-2251.36" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge331" class="edge">
<title>q_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M14088.66,-2322.29C14069.89,-2312.45 14046.96,-2300.43 14027.1,-2290.02"/>
<polygon fill="black" stroke="black" points="14028.7,-2286.91 14018.21,-2285.36 14025.45,-2293.11 14028.7,-2286.91"/>
</g>
<!-- k_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge332" class="edge">
<title>k_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M13797.61,-2322.29C13831.32,-2311.91 13872.88,-2299.12 13907.91,-2288.35"/>
<polygon fill="black" stroke="black" points="13909.08,-2291.65 13917.61,-2285.36 13907.02,-2284.96 13909.08,-2291.65"/>
</g>
<!-- v_proj_3_0_2&#45;&gt;attn_3_0_2 -->
<g id="edge333" class="edge">
<title>v_proj_3_0_2&#45;&gt;attn_3_0_2</title>
<path fill="none" stroke="black" d="M13943.13,-2322.29C13948.96,-2313.6 13955.93,-2303.21 13962.29,-2293.74"/>
<polygon fill="black" stroke="black" points="13965.24,-2295.62 13967.91,-2285.36 13959.43,-2291.72 13965.24,-2295.62"/>
</g>
<!-- attn_3_0_2&#45;&gt;agg_dim_3_0 -->
<g id="edge334" class="edge">
<title>attn_3_0_2&#45;&gt;agg_dim_3_0</title>
<path fill="none" stroke="black" d="M14070.33,-2252.3C14229.68,-2231.69 14561.27,-2188.79 14721.49,-2168.07"/>
<polygon fill="black" stroke="black" points="14722.32,-2171.49 14731.79,-2166.73 14721.42,-2164.55 14722.32,-2171.49"/>
</g>
<!-- attn_3_0_3 -->
<g id="node186" class="node">
<title>attn_3_0_3</title>
<polygon fill="lightgreen" stroke="black" points="14705,-2285.36 14527,-2285.36 14527,-2244.36 14705,-2244.36 14705,-2285.36"/>
<text text-anchor="middle" x="14616" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14616" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14616" y="-2251.36" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge338" class="edge">
<title>q_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M14688.76,-2322.29C14676.76,-2312.98 14662.25,-2301.72 14649.35,-2291.72"/>
<polygon fill="black" stroke="black" points="14651.2,-2288.73 14641.15,-2285.36 14646.91,-2294.26 14651.2,-2288.73"/>
</g>
<!-- k_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge339" class="edge">
<title>k_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M14397.71,-2322.29C14438.35,-2311.78 14488.58,-2298.8 14530.6,-2287.93"/>
<polygon fill="black" stroke="black" points="14531.74,-2291.25 14540.54,-2285.36 14529.99,-2284.48 14531.74,-2291.25"/>
</g>
<!-- v_proj_3_0_3&#45;&gt;attn_3_0_3 -->
<g id="edge340" class="edge">
<title>v_proj_3_0_3&#45;&gt;attn_3_0_3</title>
<path fill="none" stroke="black" d="M14543.24,-2322.29C14555.24,-2312.98 14569.75,-2301.72 14582.65,-2291.72"/>
<polygon fill="black" stroke="black" points="14585.09,-2294.26 14590.85,-2285.36 14580.8,-2288.73 14585.09,-2294.26"/>
</g>
<!-- attn_3_0_3&#45;&gt;agg_dim_3_0 -->
<g id="edge341" class="edge">
<title>attn_3_0_3&#45;&gt;agg_dim_3_0</title>
<path fill="none" stroke="black" d="M14651.95,-2244.14C14674.99,-2231.51 14705.79,-2214.61 14734.22,-2199.02"/>
<polygon fill="black" stroke="black" points="14736.27,-2201.88 14743.36,-2194.01 14732.91,-2195.75 14736.27,-2201.88"/>
</g>
<!-- attn_3_1_0 -->
<g id="node190" class="node">
<title>attn_3_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17450,-2285.36 17272,-2285.36 17272,-2244.36 17450,-2244.36 17450,-2285.36"/>
<text text-anchor="middle" x="17361" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17361" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17361" y="-2251.36" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge345" class="edge">
<title>q_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M17578.55,-2322.29C17538.05,-2311.78 17487.99,-2298.8 17446.11,-2287.93"/>
<polygon fill="black" stroke="black" points="17446.76,-2284.49 17436.2,-2285.36 17445,-2291.26 17446.76,-2284.49"/>
</g>
<!-- k_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge346" class="edge">
<title>k_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M17287.49,-2322.29C17299.62,-2312.98 17314.28,-2301.72 17327.31,-2291.72"/>
<polygon fill="black" stroke="black" points="17329.79,-2294.23 17335.59,-2285.36 17325.53,-2288.68 17329.79,-2294.23"/>
</g>
<!-- v_proj_3_1_0&#45;&gt;attn_3_1_0 -->
<g id="edge347" class="edge">
<title>v_proj_3_1_0&#45;&gt;attn_3_1_0</title>
<path fill="none" stroke="black" d="M17433.02,-2322.29C17421.14,-2312.98 17406.78,-2301.72 17394.01,-2291.72"/>
<polygon fill="black" stroke="black" points="17395.93,-2288.78 17385.9,-2285.36 17391.61,-2294.29 17395.93,-2288.78"/>
</g>
<!-- agg_dim_3_1 -->
<g id="node236" class="node">
<title>agg_dim_3_1</title>
<polygon fill="lightcoral" stroke="black" points="16976.57,-2207.36 16807.04,-2207.36 16763.43,-2103.36 16932.96,-2103.36 16976.57,-2207.36"/>
<text text-anchor="middle" x="16870" y="-2169.36" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="16870" y="-2158.36" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="16870" y="-2147.36" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="16870" y="-2136.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_1_0&#45;&gt;agg_dim_3_1 -->
<g id="edge348" class="edge">
<title>attn_3_1_0&#45;&gt;agg_dim_3_1</title>
<path fill="none" stroke="black" d="M17271.8,-2244.33C17187.85,-2225.95 17062.17,-2198.43 16973.78,-2179.08"/>
<polygon fill="black" stroke="black" points="16974.51,-2175.66 16964,-2176.94 16973.02,-2182.5 16974.51,-2175.66"/>
</g>
<!-- attn_3_1_1 -->
<g id="node194" class="node">
<title>attn_3_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18038,-2285.36 17860,-2285.36 17860,-2244.36 18038,-2244.36 18038,-2285.36"/>
<text text-anchor="middle" x="17949" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17949" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17949" y="-2251.36" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge352" class="edge">
<title>q_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M18166.55,-2322.29C18126.05,-2311.78 18075.99,-2298.8 18034.11,-2287.93"/>
<polygon fill="black" stroke="black" points="18034.76,-2284.49 18024.2,-2285.36 18033,-2291.26 18034.76,-2284.49"/>
</g>
<!-- k_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge353" class="edge">
<title>k_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M17875.49,-2322.29C17887.62,-2312.98 17902.28,-2301.72 17915.31,-2291.72"/>
<polygon fill="black" stroke="black" points="17917.79,-2294.23 17923.59,-2285.36 17913.53,-2288.68 17917.79,-2294.23"/>
</g>
<!-- v_proj_3_1_1&#45;&gt;attn_3_1_1 -->
<g id="edge354" class="edge">
<title>v_proj_3_1_1&#45;&gt;attn_3_1_1</title>
<path fill="none" stroke="black" d="M18021.02,-2322.29C18009.14,-2312.98 17994.78,-2301.72 17982.01,-2291.72"/>
<polygon fill="black" stroke="black" points="17983.93,-2288.78 17973.9,-2285.36 17979.61,-2294.29 17983.93,-2288.78"/>
</g>
<!-- attn_3_1_1&#45;&gt;agg_dim_3_1 -->
<g id="edge355" class="edge">
<title>attn_3_1_1&#45;&gt;agg_dim_3_1</title>
<path fill="none" stroke="black" d="M17859.78,-2254.97C17659.95,-2235.06 17177.65,-2187.01 16968.97,-2166.22"/>
<polygon fill="black" stroke="black" points="16969.24,-2162.73 16958.94,-2165.22 16968.55,-2169.69 16969.24,-2162.73"/>
</g>
<!-- attn_3_1_2 -->
<g id="node198" class="node">
<title>attn_3_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16422,-2285.36 16244,-2285.36 16244,-2244.36 16422,-2244.36 16422,-2285.36"/>
<text text-anchor="middle" x="16333" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16333" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16333" y="-2251.36" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge359" class="edge">
<title>q_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M16440.66,-2322.29C16421.89,-2312.45 16398.96,-2300.43 16379.1,-2290.02"/>
<polygon fill="black" stroke="black" points="16380.7,-2286.91 16370.21,-2285.36 16377.45,-2293.11 16380.7,-2286.91"/>
</g>
<!-- k_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge360" class="edge">
<title>k_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M16149.61,-2322.29C16183.32,-2311.91 16224.88,-2299.12 16259.91,-2288.35"/>
<polygon fill="black" stroke="black" points="16261.08,-2291.65 16269.61,-2285.36 16259.02,-2284.96 16261.08,-2291.65"/>
</g>
<!-- v_proj_3_1_2&#45;&gt;attn_3_1_2 -->
<g id="edge361" class="edge">
<title>v_proj_3_1_2&#45;&gt;attn_3_1_2</title>
<path fill="none" stroke="black" d="M16295.13,-2322.29C16300.96,-2313.6 16307.93,-2303.21 16314.29,-2293.74"/>
<polygon fill="black" stroke="black" points="16317.24,-2295.62 16319.91,-2285.36 16311.43,-2291.72 16317.24,-2295.62"/>
</g>
<!-- attn_3_1_2&#45;&gt;agg_dim_3_1 -->
<g id="edge362" class="edge">
<title>attn_3_1_2&#45;&gt;agg_dim_3_1</title>
<path fill="none" stroke="black" d="M16422.28,-2245.99C16522.04,-2226.01 16682.56,-2193.88 16781.86,-2174"/>
<polygon fill="black" stroke="black" points="16782.75,-2177.39 16791.87,-2172 16781.38,-2170.53 16782.75,-2177.39"/>
</g>
<!-- attn_3_1_3 -->
<g id="node202" class="node">
<title>attn_3_1_3</title>
<polygon fill="lightgreen" stroke="black" points="16959,-2285.36 16781,-2285.36 16781,-2244.36 16959,-2244.36 16959,-2285.36"/>
<text text-anchor="middle" x="16870" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16870" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16870" y="-2251.36" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge366" class="edge">
<title>q_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M17015.53,-2322.29C16989.35,-2312.14 16957.2,-2299.67 16929.79,-2289.04"/>
<polygon fill="black" stroke="black" points="16930.89,-2285.72 16920.3,-2285.36 16928.36,-2292.24 16930.89,-2285.72"/>
</g>
<!-- k_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge367" class="edge">
<title>k_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M16724.47,-2322.29C16750.65,-2312.14 16782.8,-2299.67 16810.21,-2289.04"/>
<polygon fill="black" stroke="black" points="16811.64,-2292.24 16819.7,-2285.36 16809.11,-2285.72 16811.64,-2292.24"/>
</g>
<!-- v_proj_3_1_3&#45;&gt;attn_3_1_3 -->
<g id="edge368" class="edge">
<title>v_proj_3_1_3&#45;&gt;attn_3_1_3</title>
<path fill="none" stroke="black" d="M16870,-2322.29C16870,-2314.13 16870,-2304.48 16870,-2295.49"/>
<polygon fill="black" stroke="black" points="16873.5,-2295.36 16870,-2285.36 16866.5,-2295.36 16873.5,-2295.36"/>
</g>
<!-- attn_3_1_3&#45;&gt;agg_dim_3_1 -->
<g id="edge369" class="edge">
<title>attn_3_1_3&#45;&gt;agg_dim_3_1</title>
<path fill="none" stroke="black" d="M16870,-2244.14C16870,-2236.49 16870,-2227.28 16870,-2217.75"/>
<polygon fill="black" stroke="black" points="16873.5,-2217.74 16870,-2207.74 16866.5,-2217.74 16873.5,-2217.74"/>
</g>
<!-- attn_3_2_0 -->
<g id="node206" class="node">
<title>attn_3_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10491,-2285.36 10313,-2285.36 10313,-2244.36 10491,-2244.36 10491,-2285.36"/>
<text text-anchor="middle" x="10402" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10402" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10402" y="-2251.36" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge373" class="edge">
<title>q_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M10547.53,-2322.29C10521.35,-2312.14 10489.2,-2299.67 10461.79,-2289.04"/>
<polygon fill="black" stroke="black" points="10462.89,-2285.72 10452.3,-2285.36 10460.36,-2292.24 10462.89,-2285.72"/>
</g>
<!-- k_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge374" class="edge">
<title>k_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M10256.47,-2322.29C10282.65,-2312.14 10314.8,-2299.67 10342.21,-2289.04"/>
<polygon fill="black" stroke="black" points="10343.64,-2292.24 10351.7,-2285.36 10341.11,-2285.72 10343.64,-2292.24"/>
</g>
<!-- v_proj_3_2_0&#45;&gt;attn_3_2_0 -->
<g id="edge375" class="edge">
<title>v_proj_3_2_0&#45;&gt;attn_3_2_0</title>
<path fill="none" stroke="black" d="M10402,-2322.29C10402,-2314.13 10402,-2304.48 10402,-2295.49"/>
<polygon fill="black" stroke="black" points="10405.5,-2295.36 10402,-2285.36 10398.5,-2295.36 10405.5,-2295.36"/>
</g>
<!-- agg_dim_3_2 -->
<g id="node237" class="node">
<title>agg_dim_3_2</title>
<polygon fill="lightcoral" stroke="black" points="10508.57,-2207.36 10339.04,-2207.36 10295.43,-2103.36 10464.96,-2103.36 10508.57,-2207.36"/>
<text text-anchor="middle" x="10402" y="-2169.36" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="10402" y="-2158.36" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="10402" y="-2147.36" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="10402" y="-2136.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_2_0&#45;&gt;agg_dim_3_2 -->
<g id="edge376" class="edge">
<title>attn_3_2_0&#45;&gt;agg_dim_3_2</title>
<path fill="none" stroke="black" d="M10402,-2244.14C10402,-2236.49 10402,-2227.28 10402,-2217.75"/>
<polygon fill="black" stroke="black" points="10405.5,-2217.74 10402,-2207.74 10398.5,-2217.74 10405.5,-2217.74"/>
</g>
<!-- attn_3_2_1 -->
<g id="node210" class="node">
<title>attn_3_2_1</title>
<polygon fill="lightgreen" stroke="black" points="10934,-2285.36 10756,-2285.36 10756,-2244.36 10934,-2244.36 10934,-2285.36"/>
<text text-anchor="middle" x="10845" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10845" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10845" y="-2251.36" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge380" class="edge">
<title>q_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M11098.18,-2322.29C11050.55,-2311.67 10991.56,-2298.52 10942.51,-2287.59"/>
<polygon fill="black" stroke="black" points="10943.04,-2284.12 10932.52,-2285.36 10941.52,-2290.95 10943.04,-2284.12"/>
</g>
<!-- k_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge381" class="edge">
<title>k_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M10807.13,-2322.29C10812.96,-2313.6 10819.93,-2303.21 10826.29,-2293.74"/>
<polygon fill="black" stroke="black" points="10829.24,-2295.62 10831.91,-2285.36 10823.43,-2291.72 10829.24,-2295.62"/>
</g>
<!-- v_proj_3_2_1&#45;&gt;attn_3_2_1 -->
<g id="edge382" class="edge">
<title>v_proj_3_2_1&#45;&gt;attn_3_2_1</title>
<path fill="none" stroke="black" d="M10952.66,-2322.29C10933.89,-2312.45 10910.96,-2300.43 10891.1,-2290.02"/>
<polygon fill="black" stroke="black" points="10892.7,-2286.91 10882.21,-2285.36 10889.45,-2293.11 10892.7,-2286.91"/>
</g>
<!-- attn_3_2_1&#45;&gt;agg_dim_3_2 -->
<g id="edge383" class="edge">
<title>attn_3_2_1&#45;&gt;agg_dim_3_2</title>
<path fill="none" stroke="black" d="M10764.52,-2244.33C10692.28,-2226.8 10585.77,-2200.95 10506.88,-2181.81"/>
<polygon fill="black" stroke="black" points="10507.45,-2178.35 10496.91,-2179.39 10505.8,-2185.15 10507.45,-2178.35"/>
</g>
<!-- attn_3_2_2 -->
<g id="node214" class="node">
<title>attn_3_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9413,-2285.36 9235,-2285.36 9235,-2244.36 9413,-2244.36 9413,-2285.36"/>
<text text-anchor="middle" x="9324" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9324" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9324" y="-2251.36" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge387" class="edge">
<title>q_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M9396.76,-2322.29C9384.76,-2312.98 9370.25,-2301.72 9357.35,-2291.72"/>
<polygon fill="black" stroke="black" points="9359.2,-2288.73 9349.15,-2285.36 9354.91,-2294.26 9359.2,-2288.73"/>
</g>
<!-- k_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge388" class="edge">
<title>k_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M9105.71,-2322.29C9146.35,-2311.78 9196.58,-2298.8 9238.6,-2287.93"/>
<polygon fill="black" stroke="black" points="9239.74,-2291.25 9248.54,-2285.36 9237.99,-2284.48 9239.74,-2291.25"/>
</g>
<!-- v_proj_3_2_2&#45;&gt;attn_3_2_2 -->
<g id="edge389" class="edge">
<title>v_proj_3_2_2&#45;&gt;attn_3_2_2</title>
<path fill="none" stroke="black" d="M9251.24,-2322.29C9263.24,-2312.98 9277.75,-2301.72 9290.65,-2291.72"/>
<polygon fill="black" stroke="black" points="9293.09,-2294.26 9298.85,-2285.36 9288.8,-2288.73 9293.09,-2294.26"/>
</g>
<!-- attn_3_2_2&#45;&gt;agg_dim_3_2 -->
<g id="edge390" class="edge">
<title>attn_3_2_2&#45;&gt;agg_dim_3_2</title>
<path fill="none" stroke="black" d="M9413.13,-2254.97C9615.28,-2234.81 10106.77,-2185.8 10310.84,-2165.45"/>
<polygon fill="black" stroke="black" points="10311.32,-2168.92 10320.92,-2164.44 10310.63,-2161.95 10311.32,-2168.92"/>
</g>
<!-- attn_3_2_3 -->
<g id="node218" class="node">
<title>attn_3_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10002,-2285.36 9824,-2285.36 9824,-2244.36 10002,-2244.36 10002,-2285.36"/>
<text text-anchor="middle" x="9913" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9913" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9913" y="-2251.36" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge394" class="edge">
<title>q_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M9985.02,-2322.29C9973.14,-2312.98 9958.78,-2301.72 9946.01,-2291.72"/>
<polygon fill="black" stroke="black" points="9947.93,-2288.78 9937.9,-2285.36 9943.61,-2294.29 9947.93,-2288.78"/>
</g>
<!-- k_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge395" class="edge">
<title>k_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M9693.97,-2322.29C9734.83,-2311.76 9785.36,-2298.74 9827.58,-2287.86"/>
<polygon fill="black" stroke="black" points="9828.48,-2291.25 9837.29,-2285.36 9826.73,-2284.47 9828.48,-2291.25"/>
</g>
<!-- v_proj_3_2_3&#45;&gt;attn_3_2_3 -->
<g id="edge396" class="edge">
<title>v_proj_3_2_3&#45;&gt;attn_3_2_3</title>
<path fill="none" stroke="black" d="M9839.49,-2322.29C9851.62,-2312.98 9866.28,-2301.72 9879.31,-2291.72"/>
<polygon fill="black" stroke="black" points="9881.79,-2294.23 9887.59,-2285.36 9877.53,-2288.68 9881.79,-2294.23"/>
</g>
<!-- attn_3_2_3&#45;&gt;agg_dim_3_2 -->
<g id="edge397" class="edge">
<title>attn_3_2_3&#45;&gt;agg_dim_3_2</title>
<path fill="none" stroke="black" d="M10001.84,-2244.33C10090.66,-2224.8 10226.39,-2194.96 10314.68,-2175.55"/>
<polygon fill="black" stroke="black" points="10315.65,-2178.92 10324.67,-2173.36 10314.15,-2172.09 10315.65,-2178.92"/>
</g>
<!-- attn_3_3_0 -->
<g id="node222" class="node">
<title>attn_3_3_0</title>
<polygon fill="lightgreen" stroke="black" points="12843,-2285.36 12665,-2285.36 12665,-2244.36 12843,-2244.36 12843,-2285.36"/>
<text text-anchor="middle" x="12754" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12754" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12754" y="-2251.36" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge401" class="edge">
<title>q_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M12899.53,-2322.29C12873.35,-2312.14 12841.2,-2299.67 12813.79,-2289.04"/>
<polygon fill="black" stroke="black" points="12814.89,-2285.72 12804.3,-2285.36 12812.36,-2292.24 12814.89,-2285.72"/>
</g>
<!-- k_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge402" class="edge">
<title>k_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M12608.47,-2322.29C12634.65,-2312.14 12666.8,-2299.67 12694.21,-2289.04"/>
<polygon fill="black" stroke="black" points="12695.64,-2292.24 12703.7,-2285.36 12693.11,-2285.72 12695.64,-2292.24"/>
</g>
<!-- v_proj_3_3_0&#45;&gt;attn_3_3_0 -->
<g id="edge403" class="edge">
<title>v_proj_3_3_0&#45;&gt;attn_3_3_0</title>
<path fill="none" stroke="black" d="M12754,-2322.29C12754,-2314.13 12754,-2304.48 12754,-2295.49"/>
<polygon fill="black" stroke="black" points="12757.5,-2295.36 12754,-2285.36 12750.5,-2295.36 12757.5,-2295.36"/>
</g>
<!-- agg_dim_3_3 -->
<g id="node238" class="node">
<title>agg_dim_3_3</title>
<polygon fill="lightcoral" stroke="black" points="12860.57,-2207.36 12691.04,-2207.36 12647.43,-2103.36 12816.96,-2103.36 12860.57,-2207.36"/>
<text text-anchor="middle" x="12754" y="-2169.36" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="12754" y="-2158.36" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="12754" y="-2147.36" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="12754" y="-2136.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_3_3_0&#45;&gt;agg_dim_3_3 -->
<g id="edge404" class="edge">
<title>attn_3_3_0&#45;&gt;agg_dim_3_3</title>
<path fill="none" stroke="black" d="M12754,-2244.14C12754,-2236.49 12754,-2227.28 12754,-2217.75"/>
<polygon fill="black" stroke="black" points="12757.5,-2217.74 12754,-2207.74 12750.5,-2217.74 12757.5,-2217.74"/>
</g>
<!-- attn_3_3_1 -->
<g id="node226" class="node">
<title>attn_3_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13286,-2285.36 13108,-2285.36 13108,-2244.36 13286,-2244.36 13286,-2285.36"/>
<text text-anchor="middle" x="13197" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13197" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13197" y="-2251.36" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge408" class="edge">
<title>q_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M13450.18,-2322.29C13402.55,-2311.67 13343.56,-2298.52 13294.51,-2287.59"/>
<polygon fill="black" stroke="black" points="13295.04,-2284.12 13284.52,-2285.36 13293.52,-2290.95 13295.04,-2284.12"/>
</g>
<!-- k_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge409" class="edge">
<title>k_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M13159.13,-2322.29C13164.96,-2313.6 13171.93,-2303.21 13178.29,-2293.74"/>
<polygon fill="black" stroke="black" points="13181.24,-2295.62 13183.91,-2285.36 13175.43,-2291.72 13181.24,-2295.62"/>
</g>
<!-- v_proj_3_3_1&#45;&gt;attn_3_3_1 -->
<g id="edge410" class="edge">
<title>v_proj_3_3_1&#45;&gt;attn_3_3_1</title>
<path fill="none" stroke="black" d="M13304.66,-2322.29C13285.89,-2312.45 13262.96,-2300.43 13243.1,-2290.02"/>
<polygon fill="black" stroke="black" points="13244.7,-2286.91 13234.21,-2285.36 13241.45,-2293.11 13244.7,-2286.91"/>
</g>
<!-- attn_3_3_1&#45;&gt;agg_dim_3_3 -->
<g id="edge411" class="edge">
<title>attn_3_3_1&#45;&gt;agg_dim_3_3</title>
<path fill="none" stroke="black" d="M13116.52,-2244.33C13044.28,-2226.8 12937.77,-2200.95 12858.88,-2181.81"/>
<polygon fill="black" stroke="black" points="12859.45,-2178.35 12848.91,-2179.39 12857.8,-2185.15 12859.45,-2178.35"/>
</g>
<!-- attn_3_3_2 -->
<g id="node230" class="node">
<title>attn_3_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11764,-2285.36 11586,-2285.36 11586,-2244.36 11764,-2244.36 11764,-2285.36"/>
<text text-anchor="middle" x="11675" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11675" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11675" y="-2251.36" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge415" class="edge">
<title>q_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M11748.51,-2322.29C11736.38,-2312.98 11721.72,-2301.72 11708.69,-2291.72"/>
<polygon fill="black" stroke="black" points="11710.47,-2288.68 11700.41,-2285.36 11706.21,-2294.23 11710.47,-2288.68"/>
</g>
<!-- k_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge416" class="edge">
<title>k_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M11457.45,-2322.29C11497.95,-2311.78 11548.01,-2298.8 11589.89,-2287.93"/>
<polygon fill="black" stroke="black" points="11591,-2291.26 11599.8,-2285.36 11589.24,-2284.49 11591,-2291.26"/>
</g>
<!-- v_proj_3_3_2&#45;&gt;attn_3_3_2 -->
<g id="edge417" class="edge">
<title>v_proj_3_3_2&#45;&gt;attn_3_3_2</title>
<path fill="none" stroke="black" d="M11602.98,-2322.29C11614.86,-2312.98 11629.22,-2301.72 11641.99,-2291.72"/>
<polygon fill="black" stroke="black" points="11644.39,-2294.29 11650.1,-2285.36 11640.07,-2288.78 11644.39,-2294.29"/>
</g>
<!-- attn_3_3_2&#45;&gt;agg_dim_3_3 -->
<g id="edge418" class="edge">
<title>attn_3_3_2&#45;&gt;agg_dim_3_3</title>
<path fill="none" stroke="black" d="M11764.22,-2254.97C11966.55,-2234.81 12458.5,-2185.8 12662.75,-2165.45"/>
<polygon fill="black" stroke="black" points="12663.24,-2168.92 12672.85,-2164.44 12662.55,-2161.95 12663.24,-2168.92"/>
</g>
<!-- attn_3_3_3 -->
<g id="node234" class="node">
<title>attn_3_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12353,-2285.36 12175,-2285.36 12175,-2244.36 12353,-2244.36 12353,-2285.36"/>
<text text-anchor="middle" x="12264" y="-2273.36" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12264" y="-2262.36" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12264" y="-2251.36" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- q_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge422" class="edge">
<title>q_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M12336.76,-2322.29C12324.76,-2312.98 12310.25,-2301.72 12297.35,-2291.72"/>
<polygon fill="black" stroke="black" points="12299.2,-2288.73 12289.15,-2285.36 12294.91,-2294.26 12299.2,-2288.73"/>
</g>
<!-- k_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge423" class="edge">
<title>k_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M12045.71,-2322.29C12086.35,-2311.78 12136.58,-2298.8 12178.6,-2287.93"/>
<polygon fill="black" stroke="black" points="12179.74,-2291.25 12188.54,-2285.36 12177.99,-2284.48 12179.74,-2291.25"/>
</g>
<!-- v_proj_3_3_3&#45;&gt;attn_3_3_3 -->
<g id="edge424" class="edge">
<title>v_proj_3_3_3&#45;&gt;attn_3_3_3</title>
<path fill="none" stroke="black" d="M12191.24,-2322.29C12203.24,-2312.98 12217.75,-2301.72 12230.65,-2291.72"/>
<polygon fill="black" stroke="black" points="12233.09,-2294.26 12238.85,-2285.36 12228.8,-2288.73 12233.09,-2294.26"/>
</g>
<!-- attn_3_3_3&#45;&gt;agg_dim_3_3 -->
<g id="edge425" class="edge">
<title>attn_3_3_3&#45;&gt;agg_dim_3_3</title>
<path fill="none" stroke="black" d="M12353.02,-2244.33C12442.02,-2224.8 12578.04,-2194.96 12666.5,-2175.55"/>
<polygon fill="black" stroke="black" points="12667.49,-2178.92 12676.51,-2173.36 12665.99,-2172.08 12667.49,-2178.92"/>
</g>
<!-- agg_heads_3 -->
<g id="node239" class="node">
<title>agg_heads_3</title>
<polygon fill="lightcoral" stroke="black" points="14901.32,-2066.36 14759.23,-2066.36 14722.68,-1984.36 14864.77,-1984.36 14901.32,-2066.36"/>
<text text-anchor="middle" x="14812" y="-2033.86" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="14812" y="-2022.86" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="14812" y="-2011.86" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_3_0&#45;&gt;agg_heads_3 -->
<g id="edge426" class="edge">
<title>agg_dim_3_0&#45;&gt;agg_heads_3</title>
<path fill="none" stroke="black" d="M14812,-2103.03C14812,-2094.43 14812,-2085.51 14812,-2076.92"/>
<polygon fill="black" stroke="black" points="14815.5,-2076.66 14812,-2066.66 14808.5,-2076.66 14815.5,-2076.66"/>
</g>
<!-- agg_dim_3_1&#45;&gt;agg_heads_3 -->
<g id="edge427" class="edge">
<title>agg_dim_3_1&#45;&gt;agg_heads_3</title>
<path fill="none" stroke="black" d="M16782.23,-2148.9C16443.94,-2127.86 15227.08,-2052.17 14895.79,-2031.57"/>
<polygon fill="black" stroke="black" points="14895.98,-2028.07 14885.78,-2030.95 14895.54,-2035.06 14895.98,-2028.07"/>
</g>
<!-- agg_dim_3_2&#45;&gt;agg_heads_3 -->
<g id="edge428" class="edge">
<title>agg_dim_3_2&#45;&gt;agg_heads_3</title>
<path fill="none" stroke="black" d="M10485.67,-2151.93C11040.87,-2135.81 14187.68,-2044.48 14731.84,-2028.68"/>
<polygon fill="black" stroke="black" points="14732.05,-2032.18 14741.94,-2028.39 14731.85,-2025.18 14732.05,-2032.18"/>
</g>
<!-- agg_dim_3_3&#45;&gt;agg_heads_3 -->
<g id="edge429" class="edge">
<title>agg_dim_3_3&#45;&gt;agg_heads_3</title>
<path fill="none" stroke="black" d="M12836.26,-2149.24C13168.17,-2128.6 14406.49,-2051.58 14732.78,-2031.28"/>
<polygon fill="black" stroke="black" points="14733.32,-2034.76 14743.09,-2030.64 14732.89,-2027.77 14733.32,-2034.76"/>
</g>
<!-- out_proj3 -->
<g id="node240" class="node">
<title>out_proj3</title>
<polygon fill="lightgreen" stroke="black" points="16080,-1947.36 15892,-1947.36 15892,-1906.36 16080,-1906.36 16080,-1947.36"/>
<text text-anchor="middle" x="15986" y="-1935.36" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="15986" y="-1924.36" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="15986" y="-1913.36" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_3&#45;&gt;out_proj3 -->
<g id="edge430" class="edge">
<title>agg_heads_3&#45;&gt;out_proj3</title>
<path fill="none" stroke="black" d="M14880.19,-2018.75C15076.81,-2002.59 15645.79,-1955.82 15881.66,-1936.43"/>
<polygon fill="black" stroke="black" points="15882.27,-1939.9 15891.95,-1935.59 15881.7,-1932.92 15882.27,-1939.9"/>
</g>
<!-- out_proj3&#45;&gt;res3_1 -->
<g id="edge431" class="edge">
<title>out_proj3&#45;&gt;res3_1</title>
<path fill="none" stroke="black" d="M16080.22,-1921.24C16367.76,-1907.15 17234.89,-1864.65 17572.96,-1848.08"/>
<polygon fill="black" stroke="black" points="17573.23,-1851.57 17583.05,-1847.59 17572.89,-1844.58 17573.23,-1851.57"/>
</g>
<!-- ln3_2 -->
<g id="node242" class="node">
<title>ln3_2</title>
<polygon fill="lightgreen" stroke="black" points="17359,-1774.37 17171,-1774.37 17171,-1733.37 17359,-1733.37 17359,-1774.37"/>
<text text-anchor="middle" x="17265" y="-1762.37" font-family="Arial" font-size="10.00">LayerNorm 3.2</text>
<text text-anchor="middle" x="17265" y="-1751.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17265" y="-1740.37" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_1&#45;&gt;ln3_2 -->
<g id="edge433" class="edge">
<title>res3_1&#45;&gt;ln3_2</title>
<path fill="none" stroke="black" d="M17612.89,-1820.93C17540.96,-1807.27 17443.07,-1788.68 17369.45,-1774.71"/>
<polygon fill="black" stroke="black" points="17369.71,-1771.19 17359.23,-1772.77 17368.4,-1778.07 17369.71,-1771.19"/>
</g>
<!-- res3_2 -->
<g id="node253" class="node">
<title>res3_2</title>
<ellipse fill="lightgreen" stroke="black" cx="17676" cy="-1318.38" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="17676" y="-1326.88" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17676" y="-1315.88" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17676" y="-1304.88" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_1&#45;&gt;res3_2 -->
<g id="edge452" class="edge">
<title>res3_1&#45;&gt;res3_2</title>
<path fill="none" stroke="black" d="M17803.05,-1819.83C17834.13,-1807.42 17861,-1787.32 17861,-1754.87 17861,-1754.87 17861,-1754.87 17861,-1424.37 17861,-1381.98 17823.79,-1356.49 17782.75,-1341.27"/>
<polygon fill="black" stroke="black" points="17783.7,-1337.9 17773.11,-1337.9 17781.39,-1344.51 17783.7,-1337.9"/>
</g>
<!-- gate3 -->
<g id="node243" class="node">
<title>gate3</title>
<polygon fill="lightsteelblue" stroke="black" points="17297.22,-1696.37 17012.12,-1696.37 16938.78,-1592.37 17223.88,-1592.37 17297.22,-1696.37"/>
<text text-anchor="middle" x="17118" y="-1658.37" font-family="Arial" font-size="10.00">Gate Network 3</text>
<text text-anchor="middle" x="17118" y="-1647.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8]</text>
<text text-anchor="middle" x="17118" y="-1636.37" font-family="Arial" font-size="10.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="17118" y="-1625.37" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln3_2&#45;&gt;gate3 -->
<g id="edge434" class="edge">
<title>ln3_2&#45;&gt;gate3</title>
<path fill="none" stroke="black" d="M17238.04,-1733.16C17226.08,-1724.41 17211.33,-1713.62 17196.31,-1702.64"/>
<polygon fill="black" stroke="black" points="17198.09,-1699.61 17187.95,-1696.53 17193.96,-1705.26 17198.09,-1699.61"/>
</g>
<!-- expert_3_0 -->
<g id="node244" class="node">
<title>expert_3_0</title>
<polygon fill="lightseagreen" stroke="black" points="17018,-1555.37 16830,-1555.37 16830,-1503.37 17018,-1503.37 17018,-1555.37"/>
<text text-anchor="middle" x="16924" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.0</text>
<text text-anchor="middle" x="16924" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16924" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16924" y="-1510.37" font-family="Arial" font-size="10.00">GPU 0&#45;1</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_0 -->
<g id="edge435" class="edge">
<title>ln3_2&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M17170.89,-1749.89C17083.04,-1744.93 16960.96,-1731.68 16930,-1696.37 16898.8,-1660.8 16905.13,-1602.64 16913.7,-1565.45"/>
<polygon fill="black" stroke="black" points="16917.14,-1566.11 16916.14,-1555.56 16910.35,-1564.43 16917.14,-1566.11"/>
</g>
<!-- expert_3_1 -->
<g id="node245" class="node">
<title>expert_3_1</title>
<polygon fill="lightseagreen" stroke="black" points="16400,-1555.37 16212,-1555.37 16212,-1503.37 16400,-1503.37 16400,-1555.37"/>
<text text-anchor="middle" x="16306" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.1</text>
<text text-anchor="middle" x="16306" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16306" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16306" y="-1510.37" font-family="Arial" font-size="10.00">GPU 2&#45;3</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_1 -->
<g id="edge437" class="edge">
<title>ln3_2&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M17170.92,-1750.28C17010.6,-1745 16691.48,-1730.46 16585,-1696.37 16491.95,-1666.59 16396.99,-1601.02 16345.37,-1561.8"/>
<polygon fill="black" stroke="black" points="16347.22,-1558.81 16337.16,-1555.5 16342.96,-1564.36 16347.22,-1558.81"/>
</g>
<!-- expert_3_2 -->
<g id="node246" class="node">
<title>expert_3_2</title>
<polygon fill="lightseagreen" stroke="black" points="17430,-1555.37 17242,-1555.37 17242,-1503.37 17430,-1503.37 17430,-1555.37"/>
<text text-anchor="middle" x="17336" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.2</text>
<text text-anchor="middle" x="17336" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17336" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17336" y="-1510.37" font-family="Arial" font-size="10.00">GPU 4&#45;5</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_2 -->
<g id="edge439" class="edge">
<title>ln3_2&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M17304.45,-1733.22C17310.96,-1728.27 17316.91,-1722.34 17321,-1715.37 17348.12,-1669.17 17346.34,-1604.95 17341.76,-1565.61"/>
<polygon fill="black" stroke="black" points="17345.2,-1564.91 17340.45,-1555.44 17338.26,-1565.81 17345.2,-1564.91"/>
</g>
<!-- expert_3_3 -->
<g id="node247" class="node">
<title>expert_3_3</title>
<polygon fill="lightseagreen" stroke="black" points="17636,-1555.37 17448,-1555.37 17448,-1503.37 17636,-1503.37 17636,-1555.37"/>
<text text-anchor="middle" x="17542" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.3</text>
<text text-anchor="middle" x="17542" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17542" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17542" y="-1510.37" font-family="Arial" font-size="10.00">GPU 6&#45;7</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_3 -->
<g id="edge441" class="edge">
<title>ln3_2&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M17298.86,-1733.36C17307.87,-1727.82 17317.46,-1721.6 17326,-1715.37 17393.81,-1665.97 17466.76,-1600.64 17508.16,-1562.3"/>
<polygon fill="black" stroke="black" points="17510.57,-1564.83 17515.51,-1555.46 17505.81,-1559.71 17510.57,-1564.83"/>
</g>
<!-- expert_3_4 -->
<g id="node248" class="node">
<title>expert_3_4</title>
<polygon fill="lightseagreen" stroke="black" points="17842,-1555.37 17654,-1555.37 17654,-1503.37 17842,-1503.37 17842,-1555.37"/>
<text text-anchor="middle" x="17748" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.4</text>
<text text-anchor="middle" x="17748" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17748" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17748" y="-1510.37" font-family="Arial" font-size="10.00">GPU 8&#45;9</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_4 -->
<g id="edge443" class="edge">
<title>ln3_2&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M17323.03,-1733.37C17352.15,-1723.13 17387.78,-1709.92 17419,-1696.37 17517.73,-1653.53 17628.77,-1595.31 17693.31,-1560.43"/>
<polygon fill="black" stroke="black" points="17695.36,-1563.29 17702.49,-1555.45 17692.03,-1557.14 17695.36,-1563.29"/>
</g>
<!-- expert_3_5 -->
<g id="node249" class="node">
<title>expert_3_5</title>
<polygon fill="lightseagreen" stroke="black" points="16812,-1555.37 16624,-1555.37 16624,-1503.37 16812,-1503.37 16812,-1555.37"/>
<text text-anchor="middle" x="16718" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.5</text>
<text text-anchor="middle" x="16718" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16718" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16718" y="-1510.37" font-family="Arial" font-size="10.00">GPU 10&#45;11</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_5 -->
<g id="edge445" class="edge">
<title>ln3_2&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M17170.79,-1747.39C17108.34,-1742.33 17024.97,-1732.84 16953,-1715.37 16929.49,-1709.67 16922.68,-1708.92 16902,-1696.37 16840.53,-1659.08 16780.91,-1599.74 16746.91,-1563.03"/>
<polygon fill="black" stroke="black" points="16749.39,-1560.56 16740.06,-1555.55 16744.24,-1565.29 16749.39,-1560.56"/>
</g>
<!-- expert_3_6 -->
<g id="node250" class="node">
<title>expert_3_6</title>
<polygon fill="lightseagreen" stroke="black" points="17224,-1555.37 17036,-1555.37 17036,-1503.37 17224,-1503.37 17224,-1555.37"/>
<text text-anchor="middle" x="17130" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.6</text>
<text text-anchor="middle" x="17130" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17130" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17130" y="-1510.37" font-family="Arial" font-size="10.00">GPU 12&#45;13</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_6 -->
<g id="edge447" class="edge">
<title>ln3_2&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M17284.05,-1733.18C17292.53,-1723.04 17301.58,-1709.98 17306,-1696.37 17320.27,-1652.41 17332.71,-1630.1 17306,-1592.37 17296.46,-1578.9 17266.61,-1566.32 17234.14,-1556.07"/>
<polygon fill="black" stroke="black" points="17235.05,-1552.69 17224.46,-1553.1 17233,-1559.38 17235.05,-1552.69"/>
</g>
<!-- expert_3_7 -->
<g id="node251" class="node">
<title>expert_3_7</title>
<polygon fill="lightseagreen" stroke="black" points="16606,-1555.37 16418,-1555.37 16418,-1503.37 16606,-1503.37 16606,-1555.37"/>
<text text-anchor="middle" x="16512" y="-1543.37" font-family="Arial" font-size="10.00">Expert 3.7</text>
<text text-anchor="middle" x="16512" y="-1532.37" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16512" y="-1521.37" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16512" y="-1510.37" font-family="Arial" font-size="10.00">GPU 14&#45;15</text>
</g>
<!-- ln3_2&#45;&gt;expert_3_7 -->
<g id="edge449" class="edge">
<title>ln3_2&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M17170.87,-1747.2C17048.63,-1738.95 16842.47,-1721.81 16771,-1696.37 16684.19,-1665.48 16596.76,-1600.84 16548.97,-1561.96"/>
<polygon fill="black" stroke="black" points="16551.03,-1559.13 16541.08,-1555.49 16546.59,-1564.54 16551.03,-1559.13"/>
</g>
<!-- gate3&#45;&gt;expert_3_0 -->
<g id="edge157" class="edge">
<title>gate3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17050.08,-1592.26C17040.19,-1585.59 17029.98,-1579.1 17020,-1573.37 17011.77,-1568.65 17002.93,-1564.08 16994.06,-1559.78"/>
<polygon fill="black" stroke="black" points="16995.37,-1556.53 16984.83,-1555.42 16992.37,-1562.86 16995.37,-1556.53"/>
</g>
<!-- gate3&#45;&gt;expert_3_1 -->
<g id="edge158" class="edge">
<title>gate3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16964.75,-1629.47C16823.02,-1615.43 16606.52,-1590.97 16410.14,-1555.5"/>
<polygon fill="black" stroke="black" points="16410.67,-1552.04 16400.21,-1553.7 16409.42,-1558.93 16410.67,-1552.04"/>
</g>
<!-- gate3&#45;&gt;expert_3_2 -->
<g id="edge159" class="edge">
<title>gate3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17216.48,-1592.33C17237.71,-1581.32 17259.49,-1570.04 17278.53,-1560.16"/>
<polygon fill="black" stroke="black" points="17280.38,-1563.15 17287.65,-1555.44 17277.16,-1556.93 17280.38,-1563.15"/>
</g>
<!-- gate3&#45;&gt;expert_3_3 -->
<g id="edge160" class="edge">
<title>gate3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17237.52,-1611.52C17300.62,-1594.7 17377.32,-1574.26 17437.95,-1558.1"/>
<polygon fill="black" stroke="black" points="17439.16,-1561.4 17447.93,-1555.45 17437.36,-1554.64 17439.16,-1561.4"/>
</g>
<!-- gate3&#45;&gt;expert_3_4 -->
<g id="edge161" class="edge">
<title>gate3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17246.81,-1624.54C17351.3,-1608.64 17502.53,-1584.21 17643.62,-1555.6"/>
<polygon fill="black" stroke="black" points="17644.66,-1558.96 17653.76,-1553.54 17643.26,-1552.11 17644.66,-1558.96"/>
</g>
<!-- gate3&#45;&gt;expert_3_5 -->
<g id="edge162" class="edge">
<title>gate3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16938.92,-1592.57C16916.06,-1586.1 16892.98,-1579.58 16871,-1573.37 16853.64,-1568.47 16835.16,-1563.27 16817.27,-1558.24"/>
<polygon fill="black" stroke="black" points="16817.98,-1554.8 16807.41,-1555.47 16816.09,-1561.54 16817.98,-1554.8"/>
</g>
<!-- gate3&#45;&gt;expert_3_6 -->
<g id="edge163" class="edge">
<title>gate3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17123.44,-1592.16C17124.39,-1583.21 17125.36,-1574.08 17126.25,-1565.69"/>
<polygon fill="black" stroke="black" points="17129.76,-1565.82 17127.33,-1555.51 17122.79,-1565.08 17129.76,-1565.82"/>
</g>
<!-- gate3&#45;&gt;expert_3_7 -->
<g id="edge164" class="edge">
<title>gate3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M16956.66,-1617.88C16860.44,-1602.02 16735.72,-1580.32 16616.3,-1555.6"/>
<polygon fill="black" stroke="black" points="16616.75,-1552.12 16606.24,-1553.51 16615.32,-1558.97 16616.75,-1552.12"/>
</g>
<!-- expert_agg_3 -->
<g id="node252" class="node">
<title>expert_agg_3</title>
<polygon fill="lightcoral" stroke="black" points="17337.2,-1466.37 17007.59,-1466.37 16922.8,-1384.37 17252.41,-1384.37 17337.2,-1466.37"/>
<text text-anchor="middle" x="17130" y="-1433.87" font-family="Arial" font-size="10.00">Weighted Sum</text>
<text text-anchor="middle" x="17130" y="-1422.87" font-family="Arial" font-size="10.00">8×[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17130" y="-1411.87" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- expert_3_0&#45;&gt;expert_agg_3 -->
<g id="edge436" class="edge">
<title>expert_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M16974.66,-1503.29C16994.34,-1493.55 17017.5,-1482.08 17039.84,-1471.02"/>
<polygon fill="black" stroke="black" points="17041.61,-1474.05 17049.02,-1466.47 17038.5,-1467.77 17041.61,-1474.05"/>
</g>
<!-- expert_3_1&#45;&gt;expert_agg_3 -->
<g id="edge438" class="edge">
<title>expert_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M16400.2,-1504.99C16403.16,-1504.42 16406.1,-1503.88 16409,-1503.37 16599.19,-1470.29 16820.24,-1449.21 16966.93,-1437.63"/>
<polygon fill="black" stroke="black" points="16967.23,-1441.11 16976.93,-1436.84 16966.68,-1434.14 16967.23,-1441.11"/>
</g>
<!-- expert_3_2&#45;&gt;expert_agg_3 -->
<g id="edge440" class="edge">
<title>expert_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M17285.34,-1503.29C17265.66,-1493.55 17242.5,-1482.08 17220.16,-1471.02"/>
<polygon fill="black" stroke="black" points="17221.5,-1467.77 17210.98,-1466.47 17218.39,-1474.05 17221.5,-1467.77"/>
</g>
<!-- expert_3_3&#45;&gt;expert_agg_3 -->
<g id="edge442" class="edge">
<title>expert_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M17448,-1505.1C17404.69,-1494.38 17351.9,-1481.31 17301.87,-1468.92"/>
<polygon fill="black" stroke="black" points="17302.45,-1465.46 17291.9,-1466.46 17300.77,-1472.26 17302.45,-1465.46"/>
</g>
<!-- expert_3_4&#45;&gt;expert_agg_3 -->
<g id="edge444" class="edge">
<title>expert_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M17653.78,-1505.15C17650.82,-1504.53 17647.89,-1503.94 17645,-1503.37 17542.07,-1483.23 17426.66,-1465.53 17331.22,-1452.2"/>
<polygon fill="black" stroke="black" points="17331.55,-1448.71 17321.16,-1450.8 17330.59,-1455.64 17331.55,-1448.71"/>
</g>
<!-- expert_3_5&#45;&gt;expert_agg_3 -->
<g id="edge446" class="edge">
<title>expert_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M16812,-1505.1C16864.54,-1492.1 16931.03,-1475.64 16989.61,-1461.13"/>
<polygon fill="black" stroke="black" points="16990.45,-1464.53 16999.32,-1458.73 16988.77,-1457.73 16990.45,-1464.53"/>
</g>
<!-- expert_3_6&#45;&gt;expert_agg_3 -->
<g id="edge448" class="edge">
<title>expert_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M17130,-1503.16C17130,-1495.02 17130,-1485.68 17130,-1476.39"/>
<polygon fill="black" stroke="black" points="17133.5,-1476.38 17130,-1466.38 17126.5,-1476.38 17133.5,-1476.38"/>
</g>
<!-- expert_3_7&#45;&gt;expert_agg_3 -->
<g id="edge450" class="edge">
<title>expert_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M16606.22,-1505.15C16609.18,-1504.53 16612.11,-1503.94 16615,-1503.37 16735.1,-1479.87 16872.18,-1459.69 16974.71,-1445.9"/>
<polygon fill="black" stroke="black" points="16975.39,-1449.34 16984.84,-1444.54 16974.46,-1442.4 16975.39,-1449.34"/>
</g>
<!-- expert_agg_3&#45;&gt;res3_2 -->
<g id="edge451" class="edge">
<title>expert_agg_3&#45;&gt;res3_2</title>
<path fill="none" stroke="black" d="M17266.72,-1398.08C17360.4,-1380.07 17482.88,-1356.52 17569.35,-1339.89"/>
<polygon fill="black" stroke="black" points="17570.03,-1343.32 17579.19,-1338 17568.71,-1336.45 17570.03,-1343.32"/>
</g>
<!-- ln4_1 -->
<g id="node254" class="node">
<title>ln4_1</title>
<polygon fill="lightgreen" stroke="black" points="14307,-1231.39 14119,-1231.39 14119,-1190.39 14307,-1190.39 14307,-1231.39"/>
<text text-anchor="middle" x="14213" y="-1219.39" font-family="Arial" font-size="10.00">LayerNorm 4.1</text>
<text text-anchor="middle" x="14213" y="-1208.39" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="14213" y="-1197.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_2&#45;&gt;ln4_1 -->
<g id="edge453" class="edge">
<title>res3_2&#45;&gt;ln4_1</title>
<path fill="none" stroke="black" d="M17547.09,-1313.46C16993.08,-1296.58 14819.82,-1230.38 14317.17,-1215.07"/>
<polygon fill="black" stroke="black" points="14317.13,-1211.56 14307.03,-1214.76 14316.91,-1218.56 14317.13,-1211.56"/>
</g>
<!-- res4_1 -->
<g id="node325" class="node">
<title>res4_1</title>
<ellipse fill="lightgreen" stroke="black" cx="18109" cy="-630.4" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="18109" y="-638.9" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="18109" y="-627.9" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="18109" y="-616.9" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res3_2&#45;&gt;res4_1 -->
<g id="edge572" class="edge">
<title>res3_2&#45;&gt;res4_1</title>
<path fill="none" stroke="black" d="M17803.96,-1312.34C18105.98,-1299.57 18838,-1263.34 18838,-1211.89 18838,-1211.89 18838,-1211.89 18838,-715.89 18838,-657.29 18461.45,-639.28 18249.6,-633.78"/>
<polygon fill="black" stroke="black" points="18249.42,-630.28 18239.33,-633.52 18249.24,-637.28 18249.42,-630.28"/>
</g>
<!-- q_proj_4_0_0 -->
<g id="node255" class="node">
<title>q_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15870,-1153.39 15692,-1153.39 15692,-1112.39 15870,-1112.39 15870,-1153.39"/>
<text text-anchor="middle" x="15781" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15781" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15781" y="-1119.39" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_0_0 -->
<g id="edge454" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_0_0</title>
<path fill="none" stroke="black" d="M14307.49,-1208.21C14585.05,-1202.98 15395.79,-1185.41 15681.94,-1153.39"/>
<polygon fill="black" stroke="black" points="15682.36,-1156.86 15691.9,-1152.24 15681.56,-1149.91 15682.36,-1156.86"/>
</g>
<!-- k_proj_4_0_0 -->
<g id="node256" class="node">
<title>k_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15478,-1153.39 15300,-1153.39 15300,-1112.39 15478,-1112.39 15478,-1153.39"/>
<text text-anchor="middle" x="15389" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15389" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15389" y="-1119.39" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_0_0 -->
<g id="edge455" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_0_0</title>
<path fill="none" stroke="black" d="M14307.13,-1209.52C14493.26,-1207.78 14921.49,-1198.85 15289.83,-1153.44"/>
<polygon fill="black" stroke="black" points="15290.4,-1156.89 15299.89,-1152.19 15289.53,-1149.95 15290.4,-1156.89"/>
</g>
<!-- v_proj_4_0_0 -->
<g id="node257" class="node">
<title>v_proj_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15674,-1153.39 15496,-1153.39 15496,-1112.39 15674,-1112.39 15674,-1153.39"/>
<text text-anchor="middle" x="15585" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="15585" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15585" y="-1119.39" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_0_0 -->
<g id="edge456" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_0_0</title>
<path fill="none" stroke="black" d="M14307.03,-1206.33C14471.75,-1200.01 14823.25,-1186.21 15120,-1172.39 15279.81,-1164.95 15323.16,-1173.25 15485.53,-1153.47"/>
<polygon fill="black" stroke="black" points="15486.4,-1156.89 15495.89,-1152.19 15485.54,-1149.94 15486.4,-1156.89"/>
</g>
<!-- q_proj_4_0_1 -->
<g id="node259" class="node">
<title>q_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="16458,-1153.39 16280,-1153.39 16280,-1112.39 16458,-1112.39 16458,-1153.39"/>
<text text-anchor="middle" x="16369" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16369" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16369" y="-1119.39" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_0_1 -->
<g id="edge461" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_0_1</title>
<path fill="none" stroke="black" d="M14307.12,-1207.48C14533.8,-1201.66 15127.96,-1186.27 15624,-1172.39 15908.2,-1164.44 15983.4,-1185.3 16269.63,-1153.43"/>
<polygon fill="black" stroke="black" points="16270.36,-1156.87 16279.9,-1152.28 16269.57,-1149.92 16270.36,-1156.87"/>
</g>
<!-- k_proj_4_0_1 -->
<g id="node260" class="node">
<title>k_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="16066,-1153.39 15888,-1153.39 15888,-1112.39 16066,-1112.39 16066,-1153.39"/>
<text text-anchor="middle" x="15977" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="15977" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15977" y="-1119.39" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_0_1 -->
<g id="edge462" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_0_1</title>
<path fill="none" stroke="black" d="M14307.22,-1207.45C14513.36,-1202 15019.87,-1188.11 15444,-1172.39 15634.08,-1165.35 15685.14,-1176.18 15877.72,-1153.44"/>
<polygon fill="black" stroke="black" points="15878.38,-1156.88 15887.89,-1152.22 15877.55,-1149.93 15878.38,-1156.88"/>
</g>
<!-- v_proj_4_0_1 -->
<g id="node261" class="node">
<title>v_proj_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="16262,-1153.39 16084,-1153.39 16084,-1112.39 16262,-1112.39 16262,-1153.39"/>
<text text-anchor="middle" x="16173" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16173" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16173" y="-1119.39" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_0_1 -->
<g id="edge463" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_0_1</title>
<path fill="none" stroke="black" d="M14307.25,-1207.08C14515.28,-1200.88 15029.45,-1185.52 15460,-1172.39 15730,-1164.16 15801.56,-1183.91 16073.72,-1153.42"/>
<polygon fill="black" stroke="black" points="16074.36,-1156.87 16083.9,-1152.27 16073.57,-1149.92 16074.36,-1156.87"/>
</g>
<!-- q_proj_4_0_2 -->
<g id="node263" class="node">
<title>q_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14694,-1153.39 14516,-1153.39 14516,-1112.39 14694,-1112.39 14694,-1153.39"/>
<text text-anchor="middle" x="14605" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14605" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14605" y="-1119.39" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_0_2 -->
<g id="edge468" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_0_2</title>
<path fill="none" stroke="black" d="M14307.04,-1191.98C14362.17,-1181.44 14433.44,-1167.76 14505.62,-1153.66"/>
<polygon fill="black" stroke="black" points="14506.66,-1157.02 14515.81,-1151.67 14505.32,-1150.15 14506.66,-1157.02"/>
</g>
<!-- k_proj_4_0_2 -->
<g id="node264" class="node">
<title>k_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14302,-1153.39 14124,-1153.39 14124,-1112.39 14302,-1112.39 14302,-1153.39"/>
<text text-anchor="middle" x="14213" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14213" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14213" y="-1119.39" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_0_2 -->
<g id="edge469" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_0_2</title>
<path fill="none" stroke="black" d="M14213,-1190.32C14213,-1182.16 14213,-1172.51 14213,-1163.52"/>
<polygon fill="black" stroke="black" points="14216.5,-1163.4 14213,-1153.4 14209.5,-1163.4 14216.5,-1163.4"/>
</g>
<!-- v_proj_4_0_2 -->
<g id="node265" class="node">
<title>v_proj_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14498,-1153.39 14320,-1153.39 14320,-1112.39 14498,-1112.39 14498,-1153.39"/>
<text text-anchor="middle" x="14409" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14409" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14409" y="-1119.39" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_0_2 -->
<g id="edge470" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_0_2</title>
<path fill="none" stroke="black" d="M14263.47,-1190.32C14289.65,-1180.17 14321.8,-1167.7 14349.21,-1157.07"/>
<polygon fill="black" stroke="black" points="14350.64,-1160.28 14358.7,-1153.4 14348.11,-1153.75 14350.64,-1160.28"/>
</g>
<!-- q_proj_4_0_3 -->
<g id="node267" class="node">
<title>q_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="15282,-1153.39 15104,-1153.39 15104,-1112.39 15282,-1112.39 15282,-1153.39"/>
<text text-anchor="middle" x="15193" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="15193" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15193" y="-1119.39" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_0_3 -->
<g id="edge475" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_0_3</title>
<path fill="none" stroke="black" d="M14307.06,-1207.95C14466.93,-1203.75 14801.91,-1191.06 15093.95,-1153.44"/>
<polygon fill="black" stroke="black" points="15094.42,-1156.9 15103.89,-1152.14 15093.52,-1149.96 15094.42,-1156.9"/>
</g>
<!-- k_proj_4_0_3 -->
<g id="node268" class="node">
<title>k_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="14890,-1153.39 14712,-1153.39 14712,-1112.39 14890,-1112.39 14890,-1153.39"/>
<text text-anchor="middle" x="14801" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="14801" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14801" y="-1119.39" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_0_3 -->
<g id="edge476" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_0_3</title>
<path fill="none" stroke="black" d="M14307.24,-1201.33C14403.82,-1192.03 14558.49,-1175.68 14701.58,-1153.55"/>
<polygon fill="black" stroke="black" points="14702.52,-1156.95 14711.86,-1151.95 14701.44,-1150.03 14702.52,-1156.95"/>
</g>
<!-- v_proj_4_0_3 -->
<g id="node269" class="node">
<title>v_proj_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="15086,-1153.39 14908,-1153.39 14908,-1112.39 15086,-1112.39 15086,-1153.39"/>
<text text-anchor="middle" x="14997" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="14997" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14997" y="-1119.39" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_0_3 -->
<g id="edge477" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_0_3</title>
<path fill="none" stroke="black" d="M14307.14,-1205.55C14437.68,-1198.76 14681.13,-1183.36 14897.9,-1153.46"/>
<polygon fill="black" stroke="black" points="14898.45,-1156.92 14907.88,-1152.07 14897.49,-1149.99 14898.45,-1156.92"/>
</g>
<!-- q_proj_4_1_0 -->
<g id="node271" class="node">
<title>q_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="18222,-1153.39 18044,-1153.39 18044,-1112.39 18222,-1112.39 18222,-1153.39"/>
<text text-anchor="middle" x="18133" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="18133" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18133" y="-1119.39" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_0 -->
<g id="edge482" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_0</title>
<path fill="none" stroke="black" d="M14307.28,-1209.44C14692.67,-1207.44 16186.03,-1198.37 17414,-1172.39 17686.7,-1166.62 17758.89,-1184.23 18033.62,-1153.44"/>
<polygon fill="black" stroke="black" points="18034.36,-1156.87 18043.9,-1152.27 18033.57,-1149.92 18034.36,-1156.87"/>
</g>
<!-- k_proj_4_1_0 -->
<g id="node272" class="node">
<title>k_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17830,-1153.39 17652,-1153.39 17652,-1112.39 17830,-1112.39 17830,-1153.39"/>
<text text-anchor="middle" x="17741" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17741" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17741" y="-1119.39" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_0 -->
<g id="edge483" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_0</title>
<path fill="none" stroke="black" d="M14307.14,-1209.21C14662.16,-1206.54 15953.81,-1195.68 17018,-1172.39 17292.45,-1166.39 17365.11,-1184.39 17641.56,-1153.44"/>
<polygon fill="black" stroke="black" points="17642.36,-1156.87 17651.9,-1152.27 17641.57,-1149.92 17642.36,-1156.87"/>
</g>
<!-- v_proj_4_1_0 -->
<g id="node273" class="node">
<title>v_proj_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="18026,-1153.39 17848,-1153.39 17848,-1112.39 18026,-1112.39 18026,-1153.39"/>
<text text-anchor="middle" x="17937" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17937" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17937" y="-1119.39" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_0 -->
<g id="edge484" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_0</title>
<path fill="none" stroke="black" d="M14307.05,-1209.33C14677.25,-1207.01 16069.85,-1197.02 17216,-1172.39 17489.57,-1166.51 17562,-1184.31 17837.59,-1153.44"/>
<polygon fill="black" stroke="black" points="17838.36,-1156.87 17847.9,-1152.27 17837.57,-1149.92 17838.36,-1156.87"/>
</g>
<!-- q_proj_4_1_1 -->
<g id="node275" class="node">
<title>q_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18810,-1153.39 18632,-1153.39 18632,-1112.39 18810,-1112.39 18810,-1153.39"/>
<text text-anchor="middle" x="18721" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="18721" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18721" y="-1119.39" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_1 -->
<g id="edge489" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_1</title>
<path fill="none" stroke="black" d="M14307.11,-1209.68C14733.73,-1208.56 16529.14,-1202.21 18002,-1172.39 18274.7,-1166.87 18346.89,-1184.23 18621.62,-1153.44"/>
<polygon fill="black" stroke="black" points="18622.36,-1156.88 18631.9,-1152.27 18621.57,-1149.92 18622.36,-1156.88"/>
</g>
<!-- k_proj_4_1_1 -->
<g id="node276" class="node">
<title>k_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18418,-1153.39 18240,-1153.39 18240,-1112.39 18418,-1112.39 18418,-1153.39"/>
<text text-anchor="middle" x="18329" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="18329" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18329" y="-1119.39" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_1 -->
<g id="edge490" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_1</title>
<path fill="none" stroke="black" d="M14307.12,-1209.52C14706.21,-1207.79 16298.11,-1199.5 17606,-1172.39 17880.45,-1166.7 17953.11,-1184.4 18229.56,-1153.44"/>
<polygon fill="black" stroke="black" points="18230.36,-1156.87 18239.9,-1152.27 18229.57,-1149.92 18230.36,-1156.87"/>
</g>
<!-- v_proj_4_1_1 -->
<g id="node277" class="node">
<title>v_proj_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18614,-1153.39 18436,-1153.39 18436,-1112.39 18614,-1112.39 18614,-1153.39"/>
<text text-anchor="middle" x="18525" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="18525" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18525" y="-1119.39" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_1 -->
<g id="edge491" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_1</title>
<path fill="none" stroke="black" d="M14307.33,-1209.6C14720.76,-1208.18 16413.95,-1200.84 17804,-1172.39 18077.58,-1166.79 18150,-1184.32 18425.59,-1153.44"/>
<polygon fill="black" stroke="black" points="18426.36,-1156.87 18435.9,-1152.27 18425.57,-1149.92 18426.36,-1156.87"/>
</g>
<!-- q_proj_4_1_2 -->
<g id="node279" class="node">
<title>q_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="17046,-1153.39 16868,-1153.39 16868,-1112.39 17046,-1112.39 17046,-1153.39"/>
<text text-anchor="middle" x="16957" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="16957" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16957" y="-1119.39" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_2 -->
<g id="edge496" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_2</title>
<path fill="none" stroke="black" d="M14307.19,-1208.51C14594.5,-1204.21 15485.04,-1190.3 16223,-1172.39 16502.4,-1165.61 16576.29,-1184.86 16857.8,-1153.41"/>
<polygon fill="black" stroke="black" points="16858.36,-1156.87 16867.9,-1152.27 16857.57,-1149.92 16858.36,-1156.87"/>
</g>
<!-- k_proj_4_1_2 -->
<g id="node280" class="node">
<title>k_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16654,-1153.39 16476,-1153.39 16476,-1112.39 16654,-1112.39 16654,-1153.39"/>
<text text-anchor="middle" x="16565" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="16565" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16565" y="-1119.39" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_2 -->
<g id="edge497" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_2</title>
<path fill="none" stroke="black" d="M14307.37,-1207.9C14555.59,-1202.61 15247.25,-1187.59 15823,-1172.39 16105.89,-1164.92 16180.73,-1185.18 16465.68,-1153.43"/>
<polygon fill="black" stroke="black" points="16466.36,-1156.87 16475.9,-1152.28 16465.57,-1149.92 16466.36,-1156.87"/>
</g>
<!-- v_proj_4_1_2 -->
<g id="node281" class="node">
<title>v_proj_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16850,-1153.39 16672,-1153.39 16672,-1112.39 16850,-1112.39 16850,-1153.39"/>
<text text-anchor="middle" x="16761" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="16761" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16761" y="-1119.39" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_2 -->
<g id="edge498" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_2</title>
<path fill="none" stroke="black" d="M14307.43,-1208.25C14576.28,-1203.49 15368.86,-1189.02 16027,-1172.39 16306.39,-1165.33 16380.29,-1184.85 16661.8,-1153.41"/>
<polygon fill="black" stroke="black" points="16662.36,-1156.87 16671.9,-1152.27 16661.57,-1149.92 16662.36,-1156.87"/>
</g>
<!-- q_proj_4_1_3 -->
<g id="node283" class="node">
<title>q_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="17634,-1153.39 17456,-1153.39 17456,-1112.39 17634,-1112.39 17634,-1153.39"/>
<text text-anchor="middle" x="17545" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="17545" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17545" y="-1119.39" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_1_3 -->
<g id="edge503" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_1_3</title>
<path fill="none" stroke="black" d="M14307.08,-1209.08C14646.07,-1206.03 15836.8,-1194.32 16819,-1172.39 17094.9,-1166.23 17167.85,-1184.53 17445.92,-1153.4"/>
<polygon fill="black" stroke="black" points="17446.36,-1156.87 17455.9,-1152.27 17445.57,-1149.92 17446.36,-1156.87"/>
</g>
<!-- k_proj_4_1_3 -->
<g id="node284" class="node">
<title>k_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="17242,-1153.39 17064,-1153.39 17064,-1112.39 17242,-1112.39 17242,-1153.39"/>
<text text-anchor="middle" x="17153" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="17153" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17153" y="-1119.39" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_1_3 -->
<g id="edge504" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_1_3</title>
<path fill="none" stroke="black" d="M14307.06,-1208.74C14612.55,-1204.91 15604.49,-1191.72 16425,-1172.39 16701.77,-1165.87 16774.96,-1184.61 17053.89,-1153.4"/>
<polygon fill="black" stroke="black" points="17054.36,-1156.87 17063.9,-1152.27 17053.57,-1149.92 17054.36,-1156.87"/>
</g>
<!-- v_proj_4_1_3 -->
<g id="node285" class="node">
<title>v_proj_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="17438,-1153.39 17260,-1153.39 17260,-1112.39 17438,-1112.39 17438,-1153.39"/>
<text text-anchor="middle" x="17349" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="17349" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17349" y="-1119.39" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_1_3 -->
<g id="edge505" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_1_3</title>
<path fill="none" stroke="black" d="M14307.02,-1208.92C14629.28,-1205.46 15718.96,-1192.93 16619,-1172.39 16896.65,-1166.05 16970.07,-1184.7 17249.86,-1153.41"/>
<polygon fill="black" stroke="black" points="17250.36,-1156.87 17259.9,-1152.27 17249.57,-1149.92 17250.36,-1156.87"/>
</g>
<!-- q_proj_4_2_0 -->
<g id="node287" class="node">
<title>q_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="11166,-1153.39 10988,-1153.39 10988,-1112.39 11166,-1112.39 11166,-1153.39"/>
<text text-anchor="middle" x="11077" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11077" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11077" y="-1119.39" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_2_0 -->
<g id="edge510" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_2_0</title>
<path fill="none" stroke="black" d="M14118.9,-1209.48C13781.18,-1207.79 12598.45,-1200.13 11623,-1172.39 11427.1,-1166.82 11374.6,-1176.79 11176.28,-1153.44"/>
<polygon fill="black" stroke="black" points="11176.45,-1149.93 11166.1,-1152.23 11175.62,-1156.89 11176.45,-1149.93"/>
</g>
<!-- k_proj_4_2_0 -->
<g id="node288" class="node">
<title>k_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10774,-1153.39 10596,-1153.39 10596,-1112.39 10774,-1112.39 10774,-1153.39"/>
<text text-anchor="middle" x="10685" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="10685" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10685" y="-1119.39" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_2_0 -->
<g id="edge511" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_2_0</title>
<path fill="none" stroke="black" d="M14118.78,-1209.75C13749.44,-1208.98 12364.6,-1204.03 11225,-1172.39 11031.71,-1167.03 10979.93,-1176.54 10784.14,-1153.42"/>
<polygon fill="black" stroke="black" points="10784.45,-1149.94 10774.1,-1152.22 10783.62,-1156.89 10784.45,-1149.94"/>
</g>
<!-- v_proj_4_2_0 -->
<g id="node289" class="node">
<title>v_proj_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10970,-1153.39 10792,-1153.39 10792,-1112.39 10970,-1112.39 10970,-1153.39"/>
<text text-anchor="middle" x="10881" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10881" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10881" y="-1119.39" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_2_0 -->
<g id="edge512" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_2_0</title>
<path fill="none" stroke="black" d="M14118.97,-1209.13C13778.18,-1206.26 12575.71,-1195.04 11584,-1172.39 11318.33,-1166.33 11247.99,-1183.54 10980.12,-1153.41"/>
<polygon fill="black" stroke="black" points="10980.43,-1149.92 10970.1,-1152.27 10979.64,-1156.88 10980.43,-1149.92"/>
</g>
<!-- q_proj_4_2_1 -->
<g id="node291" class="node">
<title>q_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11754,-1153.39 11576,-1153.39 11576,-1112.39 11754,-1112.39 11754,-1153.39"/>
<text text-anchor="middle" x="11665" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="11665" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11665" y="-1119.39" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_2_1 -->
<g id="edge517" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_2_1</title>
<path fill="none" stroke="black" d="M14118.99,-1208.23C13851.33,-1203.43 13062.24,-1188.86 12407,-1172.39 12124.1,-1165.28 12049.27,-1185.19 11764.32,-1153.43"/>
<polygon fill="black" stroke="black" points="11764.43,-1149.92 11754.1,-1152.28 11763.64,-1156.87 11764.43,-1149.92"/>
</g>
<!-- k_proj_4_2_1 -->
<g id="node292" class="node">
<title>k_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11362,-1153.39 11184,-1153.39 11184,-1112.39 11362,-1112.39 11362,-1153.39"/>
<text text-anchor="middle" x="11273" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11273" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11273" y="-1119.39" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_2_1 -->
<g id="edge518" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_2_1</title>
<path fill="none" stroke="black" d="M14118.76,-1208.84C13809.89,-1205.26 12800.06,-1192.71 11965,-1172.39 11704.3,-1166.05 11635.16,-1183.05 11372.34,-1153.43"/>
<polygon fill="black" stroke="black" points="11372.43,-1149.92 11362.1,-1152.27 11371.64,-1156.88 11372.43,-1149.92"/>
</g>
<!-- v_proj_4_2_1 -->
<g id="node293" class="node">
<title>v_proj_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11558,-1153.39 11380,-1153.39 11380,-1112.39 11558,-1112.39 11558,-1153.39"/>
<text text-anchor="middle" x="11469" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="11469" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11469" y="-1119.39" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_2_1 -->
<g id="edge519" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_2_1</title>
<path fill="none" stroke="black" d="M14118.74,-1209.19C13813.18,-1206.72 12822.38,-1197.19 12003,-1172.39 11812.44,-1166.62 11761.3,-1176.27 11568.3,-1153.44"/>
<polygon fill="black" stroke="black" points="11568.45,-1149.94 11558.11,-1152.22 11567.62,-1156.89 11568.45,-1149.94"/>
</g>
<!-- q_proj_4_2_2 -->
<g id="node295" class="node">
<title>q_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9990,-1153.39 9812,-1153.39 9812,-1112.39 9990,-1112.39 9990,-1153.39"/>
<text text-anchor="middle" x="9901" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="9901" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9901" y="-1119.39" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_2_2 -->
<g id="edge524" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_2_2</title>
<path fill="none" stroke="black" d="M14118.9,-1210.11C13693.28,-1210.84 11905.4,-1211.33 10439,-1172.39 10246.58,-1167.28 10195.04,-1176.47 10000.1,-1153.42"/>
<polygon fill="black" stroke="black" points="10000.45,-1149.94 9990.1,-1152.22 9999.62,-1156.89 10000.45,-1149.94"/>
</g>
<!-- k_proj_4_2_2 -->
<g id="node296" class="node">
<title>k_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9598,-1153.39 9420,-1153.39 9420,-1112.39 9598,-1112.39 9598,-1153.39"/>
<text text-anchor="middle" x="9509" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="9509" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9509" y="-1119.39" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_2_2 -->
<g id="edge525" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_2_2</title>
<path fill="none" stroke="black" d="M14118.86,-1210.22C13667.52,-1211.52 11680.07,-1214.47 10052,-1172.39 9857.39,-1167.36 9805.26,-1176.68 9608.21,-1153.43"/>
<polygon fill="black" stroke="black" points="9608.45,-1149.94 9598.1,-1152.23 9607.62,-1156.89 9608.45,-1149.94"/>
</g>
<!-- v_proj_4_2_2 -->
<g id="node297" class="node">
<title>v_proj_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9794,-1153.39 9616,-1153.39 9616,-1112.39 9794,-1112.39 9794,-1153.39"/>
<text text-anchor="middle" x="9705" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="9705" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9705" y="-1119.39" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_2_2 -->
<g id="edge526" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_2_2</title>
<path fill="none" stroke="black" d="M14118.77,-1209.75C13689.61,-1208.94 11876.88,-1203.74 10390,-1172.39 10132.35,-1166.96 10064.04,-1182.77 9804.22,-1153.42"/>
<polygon fill="black" stroke="black" points="9804.43,-1149.92 9794.1,-1152.27 9803.64,-1156.88 9804.43,-1149.92"/>
</g>
<!-- q_proj_4_2_3 -->
<g id="node299" class="node">
<title>q_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10578,-1153.39 10400,-1153.39 10400,-1112.39 10578,-1112.39 10578,-1153.39"/>
<text text-anchor="middle" x="10489" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="10489" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10489" y="-1119.39" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_2_3 -->
<g id="edge531" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_2_3</title>
<path fill="none" stroke="black" d="M14118.86,-1209.39C13746.78,-1207.25 12342.57,-1197.85 11187,-1172.39 10923.52,-1166.59 10853.76,-1183.33 10588.04,-1153.4"/>
<polygon fill="black" stroke="black" points="10588.43,-1149.92 10578.1,-1152.27 10587.64,-1156.88 10588.43,-1149.92"/>
</g>
<!-- k_proj_4_2_3 -->
<g id="node300" class="node">
<title>k_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10186,-1153.39 10008,-1153.39 10008,-1112.39 10186,-1112.39 10186,-1153.39"/>
<text text-anchor="middle" x="10097" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="10097" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10097" y="-1119.39" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_2_3 -->
<g id="edge532" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_2_3</title>
<path fill="none" stroke="black" d="M14118.8,-1209.58C13717.67,-1208.08 12112.02,-1200.57 10793,-1172.39 10530.52,-1166.78 10460.94,-1183.24 10196.4,-1153.44"/>
<polygon fill="black" stroke="black" points="10196.43,-1149.92 10186.1,-1152.27 10195.64,-1156.88 10196.43,-1149.92"/>
</g>
<!-- v_proj_4_2_3 -->
<g id="node301" class="node">
<title>v_proj_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10382,-1153.39 10204,-1153.39 10204,-1112.39 10382,-1112.39 10382,-1153.39"/>
<text text-anchor="middle" x="10293" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="10293" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10293" y="-1119.39" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_2_3 -->
<g id="edge533" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_2_3</title>
<path fill="none" stroke="black" d="M14118.83,-1209.95C13720.44,-1209.98 12134.08,-1207.74 10831,-1172.39 10638.58,-1167.17 10587.04,-1176.46 10392.1,-1153.42"/>
<polygon fill="black" stroke="black" points="10392.45,-1149.94 10382.1,-1152.22 10391.62,-1156.89 10392.45,-1149.94"/>
</g>
<!-- q_proj_4_3_0 -->
<g id="node303" class="node">
<title>q_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13518,-1153.39 13340,-1153.39 13340,-1112.39 13518,-1112.39 13518,-1153.39"/>
<text text-anchor="middle" x="13429" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="13429" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13429" y="-1119.39" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_3_0 -->
<g id="edge538" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_3_0</title>
<path fill="none" stroke="black" d="M14176.82,-1190.33C14161.32,-1182.95 14142.73,-1175.38 14125,-1171.39 13998.33,-1142.9 13674.74,-1167.22 13528.33,-1153.34"/>
<polygon fill="black" stroke="black" points="13528.41,-1149.83 13518.1,-1152.27 13527.68,-1156.79 13528.41,-1149.83"/>
</g>
<!-- k_proj_4_3_0 -->
<g id="node304" class="node">
<title>k_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13126,-1153.39 12948,-1153.39 12948,-1112.39 13126,-1112.39 13126,-1153.39"/>
<text text-anchor="middle" x="13037" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13037" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13037" y="-1119.39" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_3_0 -->
<g id="edge539" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_3_0</title>
<path fill="none" stroke="black" d="M14118.7,-1194.14C14064.78,-1185.82 13995.78,-1176.33 13934,-1171.39 13583.21,-1143.33 13489.8,-1191.29 13136.1,-1153.39"/>
<polygon fill="black" stroke="black" points="13136.42,-1149.9 13126.1,-1152.3 13135.66,-1156.86 13136.42,-1149.9"/>
</g>
<!-- v_proj_4_3_0 -->
<g id="node305" class="node">
<title>v_proj_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13322,-1153.39 13144,-1153.39 13144,-1112.39 13322,-1112.39 13322,-1153.39"/>
<text text-anchor="middle" x="13233" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13233" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13233" y="-1119.39" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_3_0 -->
<g id="edge540" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_3_0</title>
<path fill="none" stroke="black" d="M14148.43,-1190.38C14121.1,-1183.01 14088.77,-1175.43 14059,-1171.39 13741.57,-1128.33 13654.46,-1187.86 13332.19,-1153.4"/>
<polygon fill="black" stroke="black" points="13332.42,-1149.9 13322.1,-1152.29 13331.66,-1156.86 13332.42,-1149.9"/>
</g>
<!-- q_proj_4_3_1 -->
<g id="node307" class="node">
<title>q_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="14106,-1153.39 13928,-1153.39 13928,-1112.39 14106,-1112.39 14106,-1153.39"/>
<text text-anchor="middle" x="14017" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="14017" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14017" y="-1119.39" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_3_1 -->
<g id="edge545" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_3_1</title>
<path fill="none" stroke="black" d="M14209.44,-1190.39C14207.24,-1183.47 14203.7,-1176.21 14198,-1171.39 14197.09,-1170.62 14157.94,-1162.47 14116.29,-1153.96"/>
<polygon fill="black" stroke="black" points="14116.74,-1150.48 14106.24,-1151.91 14115.34,-1157.34 14116.74,-1150.48"/>
</g>
<!-- k_proj_4_3_1 -->
<g id="node308" class="node">
<title>k_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13714,-1153.39 13536,-1153.39 13536,-1112.39 13714,-1112.39 13714,-1153.39"/>
<text text-anchor="middle" x="13625" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="13625" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13625" y="-1119.39" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_3_1 -->
<g id="edge546" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_3_1</title>
<path fill="none" stroke="black" d="M14192.88,-1190.22C14184.12,-1182.91 14173.28,-1175.43 14162,-1171.39 14072.86,-1139.48 13834.95,-1163.41 13724.11,-1153.28"/>
<polygon fill="black" stroke="black" points="13724.41,-1149.8 13714.1,-1152.23 13723.68,-1156.76 13724.41,-1149.8"/>
</g>
<!-- v_proj_4_3_1 -->
<g id="node309" class="node">
<title>v_proj_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13910,-1153.39 13732,-1153.39 13732,-1112.39 13910,-1112.39 13910,-1153.39"/>
<text text-anchor="middle" x="13821" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="13821" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13821" y="-1119.39" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_3_1 -->
<g id="edge547" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_3_1</title>
<path fill="none" stroke="black" d="M14202.83,-1190.08C14198.11,-1182.94 14191.8,-1175.62 14184,-1171.39 14134.54,-1144.59 13991.78,-1159.59 13920.15,-1153.23"/>
<polygon fill="black" stroke="black" points="13920.44,-1149.74 13910.12,-1152.13 13919.68,-1156.7 13920.44,-1149.74"/>
</g>
<!-- q_proj_4_3_2 -->
<g id="node311" class="node">
<title>q_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12342,-1153.39 12164,-1153.39 12164,-1112.39 12342,-1112.39 12342,-1153.39"/>
<text text-anchor="middle" x="12253" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12253" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12253" y="-1119.39" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_3_2 -->
<g id="edge552" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_3_2</title>
<path fill="none" stroke="black" d="M14118.73,-1208.01C13889.61,-1203.31 13285.23,-1190.13 12781,-1172.39 12593.09,-1165.78 12542.63,-1175.99 12352.17,-1153.43"/>
<polygon fill="black" stroke="black" points="12352.45,-1149.94 12342.11,-1152.22 12351.62,-1156.89 12352.45,-1149.94"/>
</g>
<!-- k_proj_4_3_2 -->
<g id="node312" class="node">
<title>k_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="11950,-1153.39 11772,-1153.39 11772,-1112.39 11950,-1112.39 11950,-1153.39"/>
<text text-anchor="middle" x="11861" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="11861" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11861" y="-1119.39" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_3_2 -->
<g id="edge553" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_3_2</title>
<path fill="none" stroke="black" d="M14118.81,-1208.47C13855.1,-1204.36 13087.01,-1191.54 12449,-1172.39 12234.45,-1165.95 12177.16,-1178.57 11960.22,-1153.43"/>
<polygon fill="black" stroke="black" points="11960.44,-1149.93 11950.1,-1152.24 11959.63,-1156.88 11960.44,-1149.93"/>
</g>
<!-- v_proj_4_3_2 -->
<g id="node313" class="node">
<title>v_proj_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12146,-1153.39 11968,-1153.39 11968,-1112.39 12146,-1112.39 12146,-1153.39"/>
<text text-anchor="middle" x="12057" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12057" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12057" y="-1119.39" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_3_2 -->
<g id="edge554" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_3_2</title>
<path fill="none" stroke="black" d="M14118.69,-1207.66C13886.59,-1202.14 13269.1,-1187.18 12754,-1172.39 12491.13,-1164.84 12421.39,-1183.23 12156.42,-1153.44"/>
<polygon fill="black" stroke="black" points="12156.43,-1149.92 12146.1,-1152.27 12155.64,-1156.88 12156.43,-1149.92"/>
</g>
<!-- q_proj_4_3_3 -->
<g id="node315" class="node">
<title>q_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12930,-1153.39 12752,-1153.39 12752,-1112.39 12930,-1112.39 12930,-1153.39"/>
<text text-anchor="middle" x="12841" y="-1141.39" font-family="Arial" font-size="10.00">Q Projection</text>
<text text-anchor="middle" x="12841" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12841" y="-1119.39" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln4_1&#45;&gt;q_proj_4_3_3 -->
<g id="edge559" class="edge">
<title>ln4_1&#45;&gt;q_proj_4_3_3</title>
<path fill="none" stroke="black" d="M14118.79,-1201.53C14014.32,-1192.58 13840.76,-1178.7 13691,-1171.39 13360.5,-1155.26 13273.08,-1189.44 12940.51,-1153.44"/>
<polygon fill="black" stroke="black" points="12940.42,-1149.91 12930.1,-1152.3 12939.66,-1156.87 12940.42,-1149.91"/>
</g>
<!-- k_proj_4_3_3 -->
<g id="node316" class="node">
<title>k_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12538,-1153.39 12360,-1153.39 12360,-1112.39 12538,-1112.39 12538,-1153.39"/>
<text text-anchor="middle" x="12449" y="-1141.39" font-family="Arial" font-size="10.00">K Projection</text>
<text text-anchor="middle" x="12449" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12449" y="-1119.39" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln4_1&#45;&gt;k_proj_4_3_3 -->
<g id="edge560" class="edge">
<title>ln4_1&#45;&gt;k_proj_4_3_3</title>
<path fill="none" stroke="black" d="M14118.83,-1208.71C13816.93,-1204.62 12874.48,-1189.32 12548.05,-1153.38"/>
<polygon fill="black" stroke="black" points="12548.43,-1149.9 12538.1,-1152.26 12547.64,-1156.86 12548.43,-1149.9"/>
</g>
<!-- v_proj_4_3_3 -->
<g id="node317" class="node">
<title>v_proj_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12734,-1153.39 12556,-1153.39 12556,-1112.39 12734,-1112.39 12734,-1153.39"/>
<text text-anchor="middle" x="12645" y="-1141.39" font-family="Arial" font-size="10.00">V Projection</text>
<text text-anchor="middle" x="12645" y="-1130.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12645" y="-1119.39" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln4_1&#45;&gt;v_proj_4_3_3 -->
<g id="edge561" class="edge">
<title>ln4_1&#45;&gt;v_proj_4_3_3</title>
<path fill="none" stroke="black" d="M14118.81,-1206.27C13941.38,-1199.44 13545.45,-1184.2 13212,-1171.39 13006.81,-1163.51 12951.87,-1177.38 12744.11,-1153.41"/>
<polygon fill="black" stroke="black" points="12744.44,-1149.93 12734.1,-1152.24 12743.63,-1156.88 12744.44,-1149.93"/>
</g>
<!-- attn_4_0_0 -->
<g id="node258" class="node">
<title>attn_4_0_0</title>
<polygon fill="lightgreen" stroke="black" points="15529,-1075.39 15351,-1075.39 15351,-1034.39 15529,-1034.39 15529,-1075.39"/>
<text text-anchor="middle" x="15440" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15440" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15440" y="-1041.39" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- q_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge457" class="edge">
<title>q_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M15693.18,-1112.32C15645.55,-1101.7 15586.56,-1088.56 15537.51,-1077.62"/>
<polygon fill="black" stroke="black" points="15538.04,-1074.16 15527.52,-1075.4 15536.52,-1080.99 15538.04,-1074.16"/>
</g>
<!-- k_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge458" class="edge">
<title>k_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M15402.13,-1112.32C15407.96,-1103.63 15414.93,-1093.25 15421.29,-1083.77"/>
<polygon fill="black" stroke="black" points="15424.24,-1085.65 15426.91,-1075.4 15418.43,-1081.75 15424.24,-1085.65"/>
</g>
<!-- v_proj_4_0_0&#45;&gt;attn_4_0_0 -->
<g id="edge459" class="edge">
<title>v_proj_4_0_0&#45;&gt;attn_4_0_0</title>
<path fill="none" stroke="black" d="M15547.66,-1112.32C15528.89,-1102.48 15505.96,-1090.46 15486.1,-1080.05"/>
<polygon fill="black" stroke="black" points="15487.7,-1076.94 15477.21,-1075.4 15484.45,-1083.14 15487.7,-1076.94"/>
</g>
<!-- agg_dim_4_0 -->
<g id="node319" class="node">
<title>agg_dim_4_0</title>
<polygon fill="lightcoral" stroke="black" points="15350.57,-997.39 15181.04,-997.39 15137.43,-893.39 15306.96,-893.39 15350.57,-997.39"/>
<text text-anchor="middle" x="15244" y="-959.39" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="15244" y="-948.39" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="15244" y="-937.39" font-family="Arial" font-size="10.00">Head Group 0</text>
<text text-anchor="middle" x="15244" y="-926.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_4_0_0&#45;&gt;agg_dim_4_0 -->
<g id="edge460" class="edge">
<title>attn_4_0_0&#45;&gt;agg_dim_4_0</title>
<path fill="none" stroke="black" d="M15404.05,-1034.17C15387.51,-1025.11 15366.98,-1013.84 15346.18,-1002.44"/>
<polygon fill="black" stroke="black" points="15347.72,-999.29 15337.27,-997.55 15344.35,-1005.42 15347.72,-999.29"/>
</g>
<!-- attn_4_0_1 -->
<g id="node262" class="node">
<title>attn_4_0_1</title>
<polygon fill="lightgreen" stroke="black" points="16117,-1075.39 15939,-1075.39 15939,-1034.39 16117,-1034.39 16117,-1075.39"/>
<text text-anchor="middle" x="16028" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16028" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16028" y="-1041.39" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- q_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge464" class="edge">
<title>q_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M16281.18,-1112.32C16233.55,-1101.7 16174.56,-1088.56 16125.51,-1077.62"/>
<polygon fill="black" stroke="black" points="16126.04,-1074.16 16115.52,-1075.4 16124.52,-1080.99 16126.04,-1074.16"/>
</g>
<!-- k_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge465" class="edge">
<title>k_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M15990.13,-1112.32C15995.96,-1103.63 16002.93,-1093.25 16009.29,-1083.77"/>
<polygon fill="black" stroke="black" points="16012.24,-1085.65 16014.91,-1075.4 16006.43,-1081.75 16012.24,-1085.65"/>
</g>
<!-- v_proj_4_0_1&#45;&gt;attn_4_0_1 -->
<g id="edge466" class="edge">
<title>v_proj_4_0_1&#45;&gt;attn_4_0_1</title>
<path fill="none" stroke="black" d="M16135.66,-1112.32C16116.89,-1102.48 16093.96,-1090.46 16074.1,-1080.05"/>
<polygon fill="black" stroke="black" points="16075.7,-1076.94 16065.21,-1075.4 16072.45,-1083.14 16075.7,-1076.94"/>
</g>
<!-- attn_4_0_1&#45;&gt;agg_dim_4_0 -->
<g id="edge467" class="edge">
<title>attn_4_0_1&#45;&gt;agg_dim_4_0</title>
<path fill="none" stroke="black" d="M15938.83,-1041.66C15791.66,-1021.49 15498.88,-981.34 15344.56,-960.18"/>
<polygon fill="black" stroke="black" points="15344.98,-956.71 15334.6,-958.81 15344.03,-963.64 15344.98,-956.71"/>
</g>
<!-- attn_4_0_2 -->
<g id="node266" class="node">
<title>attn_4_0_2</title>
<polygon fill="lightgreen" stroke="black" points="14574,-1075.39 14396,-1075.39 14396,-1034.39 14574,-1034.39 14574,-1075.39"/>
<text text-anchor="middle" x="14485" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="14485" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="14485" y="-1041.39" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- q_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge471" class="edge">
<title>q_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M14574.1,-1112.32C14558.98,-1102.75 14540.61,-1091.11 14524.49,-1080.9"/>
<polygon fill="black" stroke="black" points="14526.12,-1077.79 14515.8,-1075.4 14522.37,-1083.7 14526.12,-1077.79"/>
</g>
<!-- k_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge472" class="edge">
<title>k_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M14283.05,-1112.32C14320.48,-1101.86 14366.72,-1088.94 14405.5,-1078.1"/>
<polygon fill="black" stroke="black" points="14406.5,-1081.46 14415.19,-1075.4 14404.62,-1074.72 14406.5,-1081.46"/>
</g>
<!-- v_proj_4_0_2&#45;&gt;attn_4_0_2 -->
<g id="edge473" class="edge">
<title>v_proj_4_0_2&#45;&gt;attn_4_0_2</title>
<path fill="none" stroke="black" d="M14428.57,-1112.32C14437.61,-1103.28 14448.49,-1092.4 14458.28,-1082.62"/>
<polygon fill="black" stroke="black" points="14460.9,-1084.94 14465.49,-1075.4 14455.95,-1079.99 14460.9,-1084.94"/>
</g>
<!-- attn_4_0_2&#45;&gt;agg_dim_4_0 -->
<g id="edge474" class="edge">
<title>attn_4_0_2&#45;&gt;agg_dim_4_0</title>
<path fill="none" stroke="black" d="M14574.3,-1041.24C14720.1,-1020.59 15007.66,-979.87 15153.95,-959.15"/>
<polygon fill="black" stroke="black" points="15154.82,-962.56 15164.23,-957.69 15153.84,-955.63 15154.82,-962.56"/>
</g>
<!-- attn_4_0_3 -->
<g id="node270" class="node">
<title>attn_4_0_3</title>
<polygon fill="lightgreen" stroke="black" points="15184,-1075.39 15006,-1075.39 15006,-1034.39 15184,-1034.39 15184,-1075.39"/>
<text text-anchor="middle" x="15095" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="15095" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="15095" y="-1041.39" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- q_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge478" class="edge">
<title>q_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M15167.76,-1112.32C15155.76,-1103.01 15141.25,-1091.76 15128.35,-1081.76"/>
<polygon fill="black" stroke="black" points="15130.2,-1078.76 15120.15,-1075.4 15125.91,-1084.29 15130.2,-1078.76"/>
</g>
<!-- k_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge479" class="edge">
<title>k_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M14876.71,-1112.32C14917.35,-1101.82 14967.58,-1088.83 15009.6,-1077.97"/>
<polygon fill="black" stroke="black" points="15010.74,-1081.29 15019.54,-1075.4 15008.99,-1074.51 15010.74,-1081.29"/>
</g>
<!-- v_proj_4_0_3&#45;&gt;attn_4_0_3 -->
<g id="edge480" class="edge">
<title>v_proj_4_0_3&#45;&gt;attn_4_0_3</title>
<path fill="none" stroke="black" d="M15022.24,-1112.32C15034.24,-1103.01 15048.75,-1091.76 15061.65,-1081.76"/>
<polygon fill="black" stroke="black" points="15064.09,-1084.29 15069.85,-1075.4 15059.8,-1078.76 15064.09,-1084.29"/>
</g>
<!-- attn_4_0_3&#45;&gt;agg_dim_4_0 -->
<g id="edge481" class="edge">
<title>attn_4_0_3&#45;&gt;agg_dim_4_0</title>
<path fill="none" stroke="black" d="M15122.33,-1034.17C15136.05,-1024.28 15153.39,-1011.77 15170.65,-999.31"/>
<polygon fill="black" stroke="black" points="15173.04,-1001.9 15179.1,-993.22 15168.94,-996.23 15173.04,-1001.9"/>
</g>
<!-- attn_4_1_0 -->
<g id="node274" class="node">
<title>attn_4_1_0</title>
<polygon fill="lightgreen" stroke="black" points="17929,-1075.39 17751,-1075.39 17751,-1034.39 17929,-1034.39 17929,-1075.39"/>
<text text-anchor="middle" x="17840" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17840" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17840" y="-1041.39" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- q_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge485" class="edge">
<title>q_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M18057.55,-1112.32C18017.05,-1101.82 17966.99,-1088.83 17925.11,-1077.97"/>
<polygon fill="black" stroke="black" points="17925.76,-1074.52 17915.2,-1075.4 17924,-1081.3 17925.76,-1074.52"/>
</g>
<!-- k_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge486" class="edge">
<title>k_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M17766.49,-1112.32C17778.62,-1103.01 17793.28,-1091.76 17806.31,-1081.76"/>
<polygon fill="black" stroke="black" points="17808.79,-1084.26 17814.59,-1075.4 17804.53,-1078.71 17808.79,-1084.26"/>
</g>
<!-- v_proj_4_1_0&#45;&gt;attn_4_1_0 -->
<g id="edge487" class="edge">
<title>v_proj_4_1_0&#45;&gt;attn_4_1_0</title>
<path fill="none" stroke="black" d="M17912.02,-1112.32C17900.14,-1103.01 17885.78,-1091.76 17873.01,-1081.76"/>
<polygon fill="black" stroke="black" points="17874.93,-1078.81 17864.9,-1075.4 17870.61,-1084.32 17874.93,-1078.81"/>
</g>
<!-- agg_dim_4_1 -->
<g id="node320" class="node">
<title>agg_dim_4_1</title>
<polygon fill="lightcoral" stroke="black" points="17455.57,-997.39 17286.04,-997.39 17242.43,-893.39 17411.96,-893.39 17455.57,-997.39"/>
<text text-anchor="middle" x="17349" y="-959.39" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="17349" y="-948.39" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="17349" y="-937.39" font-family="Arial" font-size="10.00">Head Group 1</text>
<text text-anchor="middle" x="17349" y="-926.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_4_1_0&#45;&gt;agg_dim_4_1 -->
<g id="edge488" class="edge">
<title>attn_4_1_0&#45;&gt;agg_dim_4_1</title>
<path fill="none" stroke="black" d="M17750.8,-1034.36C17666.85,-1015.98 17541.17,-988.47 17452.78,-969.11"/>
<polygon fill="black" stroke="black" points="17453.51,-965.69 17443,-966.97 17452.02,-972.53 17453.51,-965.69"/>
</g>
<!-- attn_4_1_1 -->
<g id="node278" class="node">
<title>attn_4_1_1</title>
<polygon fill="lightgreen" stroke="black" points="18517,-1075.39 18339,-1075.39 18339,-1034.39 18517,-1034.39 18517,-1075.39"/>
<text text-anchor="middle" x="18428" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="18428" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="18428" y="-1041.39" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- q_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge492" class="edge">
<title>q_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M18645.55,-1112.32C18605.05,-1101.82 18554.99,-1088.83 18513.11,-1077.97"/>
<polygon fill="black" stroke="black" points="18513.76,-1074.52 18503.2,-1075.4 18512,-1081.3 18513.76,-1074.52"/>
</g>
<!-- k_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge493" class="edge">
<title>k_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M18354.49,-1112.32C18366.62,-1103.01 18381.28,-1091.76 18394.31,-1081.76"/>
<polygon fill="black" stroke="black" points="18396.79,-1084.26 18402.59,-1075.4 18392.53,-1078.71 18396.79,-1084.26"/>
</g>
<!-- v_proj_4_1_1&#45;&gt;attn_4_1_1 -->
<g id="edge494" class="edge">
<title>v_proj_4_1_1&#45;&gt;attn_4_1_1</title>
<path fill="none" stroke="black" d="M18500.02,-1112.32C18488.14,-1103.01 18473.78,-1091.76 18461.01,-1081.76"/>
<polygon fill="black" stroke="black" points="18462.93,-1078.81 18452.9,-1075.4 18458.61,-1084.32 18462.93,-1078.81"/>
</g>
<!-- attn_4_1_1&#45;&gt;agg_dim_4_1 -->
<g id="edge495" class="edge">
<title>attn_4_1_1&#45;&gt;agg_dim_4_1</title>
<path fill="none" stroke="black" d="M18338.78,-1045C18138.95,-1025.09 17656.65,-977.04 17447.97,-956.25"/>
<polygon fill="black" stroke="black" points="17448.24,-952.76 17437.94,-955.25 17447.55,-959.73 17448.24,-952.76"/>
</g>
<!-- attn_4_1_2 -->
<g id="node282" class="node">
<title>attn_4_1_2</title>
<polygon fill="lightgreen" stroke="black" points="16947,-1075.39 16769,-1075.39 16769,-1034.39 16947,-1034.39 16947,-1075.39"/>
<text text-anchor="middle" x="16858" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="16858" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="16858" y="-1041.39" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- q_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge499" class="edge">
<title>q_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M16931.51,-1112.32C16919.38,-1103.01 16904.72,-1091.76 16891.69,-1081.76"/>
<polygon fill="black" stroke="black" points="16893.47,-1078.71 16883.41,-1075.4 16889.21,-1084.26 16893.47,-1078.71"/>
</g>
<!-- k_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge500" class="edge">
<title>k_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M16640.45,-1112.32C16680.95,-1101.82 16731.01,-1088.83 16772.89,-1077.97"/>
<polygon fill="black" stroke="black" points="16774,-1081.3 16782.8,-1075.4 16772.24,-1074.52 16774,-1081.3"/>
</g>
<!-- v_proj_4_1_2&#45;&gt;attn_4_1_2 -->
<g id="edge501" class="edge">
<title>v_proj_4_1_2&#45;&gt;attn_4_1_2</title>
<path fill="none" stroke="black" d="M16785.98,-1112.32C16797.86,-1103.01 16812.22,-1091.76 16824.99,-1081.76"/>
<polygon fill="black" stroke="black" points="16827.39,-1084.32 16833.1,-1075.4 16823.07,-1078.81 16827.39,-1084.32"/>
</g>
<!-- attn_4_1_2&#45;&gt;agg_dim_4_1 -->
<g id="edge502" class="edge">
<title>attn_4_1_2&#45;&gt;agg_dim_4_1</title>
<path fill="none" stroke="black" d="M16947.2,-1034.36C17036.52,-1014.81 17173.08,-984.91 17261.72,-965.5"/>
<polygon fill="black" stroke="black" points="17262.72,-968.86 17271.74,-963.31 17261.23,-962.03 17262.72,-968.86"/>
</g>
<!-- attn_4_1_3 -->
<g id="node286" class="node">
<title>attn_4_1_3</title>
<polygon fill="lightgreen" stroke="black" points="17438,-1075.39 17260,-1075.39 17260,-1034.39 17438,-1034.39 17438,-1075.39"/>
<text text-anchor="middle" x="17349" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="17349" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="17349" y="-1041.39" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- q_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge506" class="edge">
<title>q_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M17494.53,-1112.32C17468.35,-1102.17 17436.2,-1089.7 17408.79,-1079.07"/>
<polygon fill="black" stroke="black" points="17409.89,-1075.75 17399.3,-1075.4 17407.36,-1082.28 17409.89,-1075.75"/>
</g>
<!-- k_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge507" class="edge">
<title>k_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M17203.47,-1112.32C17229.65,-1102.17 17261.8,-1089.7 17289.21,-1079.07"/>
<polygon fill="black" stroke="black" points="17290.64,-1082.28 17298.7,-1075.4 17288.11,-1075.75 17290.64,-1082.28"/>
</g>
<!-- v_proj_4_1_3&#45;&gt;attn_4_1_3 -->
<g id="edge508" class="edge">
<title>v_proj_4_1_3&#45;&gt;attn_4_1_3</title>
<path fill="none" stroke="black" d="M17349,-1112.32C17349,-1104.16 17349,-1094.51 17349,-1085.52"/>
<polygon fill="black" stroke="black" points="17352.5,-1085.4 17349,-1075.4 17345.5,-1085.4 17352.5,-1085.4"/>
</g>
<!-- attn_4_1_3&#45;&gt;agg_dim_4_1 -->
<g id="edge509" class="edge">
<title>attn_4_1_3&#45;&gt;agg_dim_4_1</title>
<path fill="none" stroke="black" d="M17349,-1034.17C17349,-1026.53 17349,-1017.32 17349,-1007.78"/>
<polygon fill="black" stroke="black" points="17352.5,-1007.78 17349,-997.78 17345.5,-1007.78 17352.5,-1007.78"/>
</g>
<!-- attn_4_2_0 -->
<g id="node290" class="node">
<title>attn_4_2_0</title>
<polygon fill="lightgreen" stroke="black" points="10970,-1075.39 10792,-1075.39 10792,-1034.39 10970,-1034.39 10970,-1075.39"/>
<text text-anchor="middle" x="10881" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10881" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10881" y="-1041.39" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- q_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge513" class="edge">
<title>q_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M11026.53,-1112.32C11000.35,-1102.17 10968.2,-1089.7 10940.79,-1079.07"/>
<polygon fill="black" stroke="black" points="10941.89,-1075.75 10931.3,-1075.4 10939.36,-1082.28 10941.89,-1075.75"/>
</g>
<!-- k_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge514" class="edge">
<title>k_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M10735.47,-1112.32C10761.65,-1102.17 10793.8,-1089.7 10821.21,-1079.07"/>
<polygon fill="black" stroke="black" points="10822.64,-1082.28 10830.7,-1075.4 10820.11,-1075.75 10822.64,-1082.28"/>
</g>
<!-- v_proj_4_2_0&#45;&gt;attn_4_2_0 -->
<g id="edge515" class="edge">
<title>v_proj_4_2_0&#45;&gt;attn_4_2_0</title>
<path fill="none" stroke="black" d="M10881,-1112.32C10881,-1104.16 10881,-1094.51 10881,-1085.52"/>
<polygon fill="black" stroke="black" points="10884.5,-1085.4 10881,-1075.4 10877.5,-1085.4 10884.5,-1085.4"/>
</g>
<!-- agg_dim_4_2 -->
<g id="node321" class="node">
<title>agg_dim_4_2</title>
<polygon fill="lightcoral" stroke="black" points="10987.57,-997.39 10818.04,-997.39 10774.43,-893.39 10943.96,-893.39 10987.57,-997.39"/>
<text text-anchor="middle" x="10881" y="-959.39" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="10881" y="-948.39" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="10881" y="-937.39" font-family="Arial" font-size="10.00">Head Group 2</text>
<text text-anchor="middle" x="10881" y="-926.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_4_2_0&#45;&gt;agg_dim_4_2 -->
<g id="edge516" class="edge">
<title>attn_4_2_0&#45;&gt;agg_dim_4_2</title>
<path fill="none" stroke="black" d="M10881,-1034.17C10881,-1026.53 10881,-1017.32 10881,-1007.78"/>
<polygon fill="black" stroke="black" points="10884.5,-1007.78 10881,-997.78 10877.5,-1007.78 10884.5,-1007.78"/>
</g>
<!-- attn_4_2_1 -->
<g id="node294" class="node">
<title>attn_4_2_1</title>
<polygon fill="lightgreen" stroke="black" points="11413,-1075.39 11235,-1075.39 11235,-1034.39 11413,-1034.39 11413,-1075.39"/>
<text text-anchor="middle" x="11324" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="11324" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="11324" y="-1041.39" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- q_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge520" class="edge">
<title>q_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M11577.18,-1112.32C11529.55,-1101.7 11470.56,-1088.56 11421.51,-1077.62"/>
<polygon fill="black" stroke="black" points="11422.04,-1074.16 11411.52,-1075.4 11420.52,-1080.99 11422.04,-1074.16"/>
</g>
<!-- k_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge521" class="edge">
<title>k_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M11286.13,-1112.32C11291.96,-1103.63 11298.93,-1093.25 11305.29,-1083.77"/>
<polygon fill="black" stroke="black" points="11308.24,-1085.65 11310.91,-1075.4 11302.43,-1081.75 11308.24,-1085.65"/>
</g>
<!-- v_proj_4_2_1&#45;&gt;attn_4_2_1 -->
<g id="edge522" class="edge">
<title>v_proj_4_2_1&#45;&gt;attn_4_2_1</title>
<path fill="none" stroke="black" d="M11431.66,-1112.32C11412.89,-1102.48 11389.96,-1090.46 11370.1,-1080.05"/>
<polygon fill="black" stroke="black" points="11371.7,-1076.94 11361.21,-1075.4 11368.45,-1083.14 11371.7,-1076.94"/>
</g>
<!-- attn_4_2_1&#45;&gt;agg_dim_4_2 -->
<g id="edge523" class="edge">
<title>attn_4_2_1&#45;&gt;agg_dim_4_2</title>
<path fill="none" stroke="black" d="M11243.52,-1034.36C11171.28,-1016.83 11064.77,-990.99 10985.88,-971.84"/>
<polygon fill="black" stroke="black" points="10986.45,-968.38 10975.91,-969.42 10984.8,-975.18 10986.45,-968.38"/>
</g>
<!-- attn_4_2_2 -->
<g id="node298" class="node">
<title>attn_4_2_2</title>
<polygon fill="lightgreen" stroke="black" points="9845,-1075.39 9667,-1075.39 9667,-1034.39 9845,-1034.39 9845,-1075.39"/>
<text text-anchor="middle" x="9756" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="9756" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="9756" y="-1041.39" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- q_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge527" class="edge">
<title>q_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M9863.66,-1112.32C9844.89,-1102.48 9821.96,-1090.46 9802.1,-1080.05"/>
<polygon fill="black" stroke="black" points="9803.7,-1076.94 9793.21,-1075.4 9800.45,-1083.14 9803.7,-1076.94"/>
</g>
<!-- k_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge528" class="edge">
<title>k_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M9572.61,-1112.32C9606.32,-1101.95 9647.88,-1089.16 9682.91,-1078.38"/>
<polygon fill="black" stroke="black" points="9684.08,-1081.68 9692.61,-1075.4 9682.02,-1074.99 9684.08,-1081.68"/>
</g>
<!-- v_proj_4_2_2&#45;&gt;attn_4_2_2 -->
<g id="edge529" class="edge">
<title>v_proj_4_2_2&#45;&gt;attn_4_2_2</title>
<path fill="none" stroke="black" d="M9718.13,-1112.32C9723.96,-1103.63 9730.93,-1093.25 9737.29,-1083.77"/>
<polygon fill="black" stroke="black" points="9740.24,-1085.65 9742.91,-1075.4 9734.43,-1081.75 9740.24,-1085.65"/>
</g>
<!-- attn_4_2_2&#45;&gt;agg_dim_4_2 -->
<g id="edge530" class="edge">
<title>attn_4_2_2&#45;&gt;agg_dim_4_2</title>
<path fill="none" stroke="black" d="M9845.22,-1045.37C10054.99,-1025.32 10577.76,-975.37 10789.64,-955.12"/>
<polygon fill="black" stroke="black" points="10790.18,-958.59 10799.8,-954.15 10789.51,-951.62 10790.18,-958.59"/>
</g>
<!-- attn_4_2_3 -->
<g id="node302" class="node">
<title>attn_4_2_3</title>
<polygon fill="lightgreen" stroke="black" points="10433,-1075.39 10255,-1075.39 10255,-1034.39 10433,-1034.39 10433,-1075.39"/>
<text text-anchor="middle" x="10344" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="10344" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="10344" y="-1041.39" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- q_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge534" class="edge">
<title>q_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M10451.66,-1112.32C10432.89,-1102.48 10409.96,-1090.46 10390.1,-1080.05"/>
<polygon fill="black" stroke="black" points="10391.7,-1076.94 10381.21,-1075.4 10388.45,-1083.14 10391.7,-1076.94"/>
</g>
<!-- k_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge535" class="edge">
<title>k_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M10160.61,-1112.32C10194.32,-1101.95 10235.88,-1089.16 10270.91,-1078.38"/>
<polygon fill="black" stroke="black" points="10272.08,-1081.68 10280.61,-1075.4 10270.02,-1074.99 10272.08,-1081.68"/>
</g>
<!-- v_proj_4_2_3&#45;&gt;attn_4_2_3 -->
<g id="edge536" class="edge">
<title>v_proj_4_2_3&#45;&gt;attn_4_2_3</title>
<path fill="none" stroke="black" d="M10306.13,-1112.32C10311.96,-1103.63 10318.93,-1093.25 10325.29,-1083.77"/>
<polygon fill="black" stroke="black" points="10328.24,-1085.65 10330.91,-1075.4 10322.43,-1081.75 10328.24,-1085.65"/>
</g>
<!-- attn_4_2_3&#45;&gt;agg_dim_4_2 -->
<g id="edge537" class="edge">
<title>attn_4_2_3&#45;&gt;agg_dim_4_2</title>
<path fill="none" stroke="black" d="M10433.28,-1036.02C10533.04,-1016.05 10693.56,-983.92 10792.86,-964.04"/>
<polygon fill="black" stroke="black" points="10793.75,-967.43 10802.87,-962.03 10792.38,-960.56 10793.75,-967.43"/>
</g>
<!-- attn_4_3_0 -->
<g id="node306" class="node">
<title>attn_4_3_0</title>
<polygon fill="lightgreen" stroke="black" points="13322,-1075.39 13144,-1075.39 13144,-1034.39 13322,-1034.39 13322,-1075.39"/>
<text text-anchor="middle" x="13233" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13233" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13233" y="-1041.39" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- q_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge541" class="edge">
<title>q_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M13378.53,-1112.32C13352.35,-1102.17 13320.2,-1089.7 13292.79,-1079.07"/>
<polygon fill="black" stroke="black" points="13293.89,-1075.75 13283.3,-1075.4 13291.36,-1082.28 13293.89,-1075.75"/>
</g>
<!-- k_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge542" class="edge">
<title>k_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M13087.47,-1112.32C13113.65,-1102.17 13145.8,-1089.7 13173.21,-1079.07"/>
<polygon fill="black" stroke="black" points="13174.64,-1082.28 13182.7,-1075.4 13172.11,-1075.75 13174.64,-1082.28"/>
</g>
<!-- v_proj_4_3_0&#45;&gt;attn_4_3_0 -->
<g id="edge543" class="edge">
<title>v_proj_4_3_0&#45;&gt;attn_4_3_0</title>
<path fill="none" stroke="black" d="M13233,-1112.32C13233,-1104.16 13233,-1094.51 13233,-1085.52"/>
<polygon fill="black" stroke="black" points="13236.5,-1085.4 13233,-1075.4 13229.5,-1085.4 13236.5,-1085.4"/>
</g>
<!-- agg_dim_4_3 -->
<g id="node322" class="node">
<title>agg_dim_4_3</title>
<polygon fill="lightcoral" stroke="black" points="13339.57,-997.39 13170.04,-997.39 13126.43,-893.39 13295.96,-893.39 13339.57,-997.39"/>
<text text-anchor="middle" x="13233" y="-959.39" font-family="Arial" font-size="10.00">Concat Dimensions</text>
<text text-anchor="middle" x="13233" y="-948.39" font-family="Arial" font-size="10.00">4×512 → 2048</text>
<text text-anchor="middle" x="13233" y="-937.39" font-family="Arial" font-size="10.00">Head Group 3</text>
<text text-anchor="middle" x="13233" y="-926.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- attn_4_3_0&#45;&gt;agg_dim_4_3 -->
<g id="edge544" class="edge">
<title>attn_4_3_0&#45;&gt;agg_dim_4_3</title>
<path fill="none" stroke="black" d="M13233,-1034.17C13233,-1026.53 13233,-1017.32 13233,-1007.78"/>
<polygon fill="black" stroke="black" points="13236.5,-1007.78 13233,-997.78 13229.5,-1007.78 13236.5,-1007.78"/>
</g>
<!-- attn_4_3_1 -->
<g id="node310" class="node">
<title>attn_4_3_1</title>
<polygon fill="lightgreen" stroke="black" points="13812,-1075.39 13634,-1075.39 13634,-1034.39 13812,-1034.39 13812,-1075.39"/>
<text text-anchor="middle" x="13723" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="13723" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="13723" y="-1041.39" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- q_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge548" class="edge">
<title>q_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M13941.29,-1112.32C13900.65,-1101.82 13850.42,-1088.83 13808.4,-1077.97"/>
<polygon fill="black" stroke="black" points="13809.01,-1074.51 13798.46,-1075.4 13807.26,-1081.29 13809.01,-1074.51"/>
</g>
<!-- k_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge549" class="edge">
<title>k_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M13650.24,-1112.32C13662.24,-1103.01 13676.75,-1091.76 13689.65,-1081.76"/>
<polygon fill="black" stroke="black" points="13692.09,-1084.29 13697.85,-1075.4 13687.8,-1078.76 13692.09,-1084.29"/>
</g>
<!-- v_proj_4_3_1&#45;&gt;attn_4_3_1 -->
<g id="edge550" class="edge">
<title>v_proj_4_3_1&#45;&gt;attn_4_3_1</title>
<path fill="none" stroke="black" d="M13795.76,-1112.32C13783.76,-1103.01 13769.25,-1091.76 13756.35,-1081.76"/>
<polygon fill="black" stroke="black" points="13758.2,-1078.76 13748.15,-1075.4 13753.91,-1084.29 13758.2,-1078.76"/>
</g>
<!-- attn_4_3_1&#45;&gt;agg_dim_4_3 -->
<g id="edge551" class="edge">
<title>attn_4_3_1&#45;&gt;agg_dim_4_3</title>
<path fill="none" stroke="black" d="M13633.98,-1034.36C13550.43,-1016.03 13425.44,-988.61 13337.25,-969.26"/>
<polygon fill="black" stroke="black" points="13337.75,-965.79 13327.23,-967.06 13336.25,-972.63 13337.75,-965.79"/>
</g>
<!-- attn_4_3_2 -->
<g id="node314" class="node">
<title>attn_4_3_2</title>
<polygon fill="lightgreen" stroke="black" points="12222,-1075.39 12044,-1075.39 12044,-1034.39 12222,-1034.39 12222,-1075.39"/>
<text text-anchor="middle" x="12133" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12133" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12133" y="-1041.39" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- q_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge555" class="edge">
<title>q_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M12222.1,-1112.32C12206.98,-1102.75 12188.61,-1091.11 12172.49,-1080.9"/>
<polygon fill="black" stroke="black" points="12174.12,-1077.79 12163.8,-1075.4 12170.37,-1083.7 12174.12,-1077.79"/>
</g>
<!-- k_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge556" class="edge">
<title>k_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M11931.05,-1112.32C11968.48,-1101.86 12014.72,-1088.94 12053.5,-1078.1"/>
<polygon fill="black" stroke="black" points="12054.5,-1081.46 12063.19,-1075.4 12052.62,-1074.72 12054.5,-1081.46"/>
</g>
<!-- v_proj_4_3_2&#45;&gt;attn_4_3_2 -->
<g id="edge557" class="edge">
<title>v_proj_4_3_2&#45;&gt;attn_4_3_2</title>
<path fill="none" stroke="black" d="M12076.57,-1112.32C12085.61,-1103.28 12096.49,-1092.4 12106.28,-1082.62"/>
<polygon fill="black" stroke="black" points="12108.9,-1084.94 12113.49,-1075.4 12103.95,-1079.99 12108.9,-1084.94"/>
</g>
<!-- attn_4_3_2&#45;&gt;agg_dim_4_3 -->
<g id="edge558" class="edge">
<title>attn_4_3_2&#45;&gt;agg_dim_4_3</title>
<path fill="none" stroke="black" d="M12222.09,-1045.19C12427.78,-1025.08 12934.04,-975.61 13141.79,-955.31"/>
<polygon fill="black" stroke="black" points="13142.14,-958.79 13151.75,-954.33 13141.46,-951.82 13142.14,-958.79"/>
</g>
<!-- attn_4_3_3 -->
<g id="node318" class="node">
<title>attn_4_3_3</title>
<polygon fill="lightgreen" stroke="black" points="12810,-1075.39 12632,-1075.39 12632,-1034.39 12810,-1034.39 12810,-1075.39"/>
<text text-anchor="middle" x="12721" y="-1063.39" font-family="Arial" font-size="10.00">Attention</text>
<text text-anchor="middle" x="12721" y="-1052.39" font-family="Arial" font-size="10.00">[B=1024, L, 512] → [B=1024, L, 512]</text>
<text text-anchor="middle" x="12721" y="-1041.39" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- q_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge562" class="edge">
<title>q_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M12810.1,-1112.32C12794.98,-1102.75 12776.61,-1091.11 12760.49,-1080.9"/>
<polygon fill="black" stroke="black" points="12762.12,-1077.79 12751.8,-1075.4 12758.37,-1083.7 12762.12,-1077.79"/>
</g>
<!-- k_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge563" class="edge">
<title>k_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M12519.05,-1112.32C12556.48,-1101.86 12602.72,-1088.94 12641.5,-1078.1"/>
<polygon fill="black" stroke="black" points="12642.5,-1081.46 12651.19,-1075.4 12640.62,-1074.72 12642.5,-1081.46"/>
</g>
<!-- v_proj_4_3_3&#45;&gt;attn_4_3_3 -->
<g id="edge564" class="edge">
<title>v_proj_4_3_3&#45;&gt;attn_4_3_3</title>
<path fill="none" stroke="black" d="M12664.57,-1112.32C12673.61,-1103.28 12684.49,-1092.4 12694.28,-1082.62"/>
<polygon fill="black" stroke="black" points="12696.9,-1084.94 12701.49,-1075.4 12691.95,-1079.99 12696.9,-1084.94"/>
</g>
<!-- attn_4_3_3&#45;&gt;agg_dim_4_3 -->
<g id="edge565" class="edge">
<title>attn_4_3_3&#45;&gt;agg_dim_4_3</title>
<path fill="none" stroke="black" d="M12810.18,-1035.17C12904.31,-1015.4 13051.73,-984.45 13145.29,-964.81"/>
<polygon fill="black" stroke="black" points="13146.23,-968.19 13155.3,-962.71 13144.79,-961.34 13146.23,-968.19"/>
</g>
<!-- agg_heads_4 -->
<g id="node323" class="node">
<title>agg_heads_4</title>
<polygon fill="lightcoral" stroke="black" points="15333.32,-856.39 15191.23,-856.39 15154.68,-774.39 15296.77,-774.39 15333.32,-856.39"/>
<text text-anchor="middle" x="15244" y="-823.89" font-family="Arial" font-size="10.00">Concat Heads</text>
<text text-anchor="middle" x="15244" y="-812.89" font-family="Arial" font-size="10.00">4×2048 → 8192</text>
<text text-anchor="middle" x="15244" y="-801.89" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_dim_4_0&#45;&gt;agg_heads_4 -->
<g id="edge566" class="edge">
<title>agg_dim_4_0&#45;&gt;agg_heads_4</title>
<path fill="none" stroke="black" d="M15244,-893.07C15244,-884.46 15244,-875.54 15244,-866.96"/>
<polygon fill="black" stroke="black" points="15247.5,-866.7 15244,-856.7 15240.5,-866.7 15247.5,-866.7"/>
</g>
<!-- agg_dim_4_1&#45;&gt;agg_heads_4 -->
<g id="edge567" class="edge">
<title>agg_dim_4_1&#45;&gt;agg_heads_4</title>
<path fill="none" stroke="black" d="M17261.56,-939.08C16918.2,-918.2 15664.5,-841.96 15327.75,-821.48"/>
<polygon fill="black" stroke="black" points="15327.77,-817.98 15317.58,-820.87 15327.35,-824.97 15327.77,-817.98"/>
</g>
<!-- agg_dim_4_2&#45;&gt;agg_heads_4 -->
<g id="edge568" class="edge">
<title>agg_dim_4_2&#45;&gt;agg_heads_4</title>
<path fill="none" stroke="black" d="M10964.74,-941.94C11516.42,-925.75 14623.66,-834.59 15163.91,-818.74"/>
<polygon fill="black" stroke="black" points="15164.06,-822.24 15173.95,-818.45 15163.85,-815.24 15164.06,-822.24"/>
</g>
<!-- agg_dim_4_3&#45;&gt;agg_heads_4 -->
<g id="edge569" class="edge">
<title>agg_dim_4_3&#45;&gt;agg_heads_4</title>
<path fill="none" stroke="black" d="M13315.27,-939.16C13641.81,-918.37 14844.28,-841.83 15164.97,-821.42"/>
<polygon fill="black" stroke="black" points="15165.34,-824.91 15175.1,-820.78 15164.9,-817.92 15165.34,-824.91"/>
</g>
<!-- out_proj4 -->
<g id="node324" class="node">
<title>out_proj4</title>
<polygon fill="lightgreen" stroke="black" points="16230,-737.39 16042,-737.39 16042,-696.39 16230,-696.39 16230,-737.39"/>
<text text-anchor="middle" x="16136" y="-725.39" font-family="Arial" font-size="10.00">Output Projection</text>
<text text-anchor="middle" x="16136" y="-714.39" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16136" y="-703.39" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- agg_heads_4&#45;&gt;out_proj4 -->
<g id="edge570" class="edge">
<title>agg_heads_4&#45;&gt;out_proj4</title>
<path fill="none" stroke="black" d="M15311.41,-807.1C15465.94,-790.38 15846.64,-749.2 16031.68,-729.18"/>
<polygon fill="black" stroke="black" points="16032.12,-732.65 16041.69,-728.09 16031.37,-725.69 16032.12,-732.65"/>
</g>
<!-- out_proj4&#45;&gt;res4_1 -->
<g id="edge571" class="edge">
<title>out_proj4&#45;&gt;res4_1</title>
<path fill="none" stroke="black" d="M16230.17,-711.86C16549.69,-698.18 17593.62,-653.47 17971.17,-637.3"/>
<polygon fill="black" stroke="black" points="17971.48,-640.79 17981.32,-636.87 17971.18,-633.8 17971.48,-640.79"/>
</g>
<!-- ln4_2 -->
<g id="node326" class="node">
<title>ln4_2</title>
<polygon fill="lightgreen" stroke="black" points="17745,-564.41 17557,-564.41 17557,-523.41 17745,-523.41 17745,-564.41"/>
<text text-anchor="middle" x="17651" y="-552.41" font-family="Arial" font-size="10.00">LayerNorm 4.2</text>
<text text-anchor="middle" x="17651" y="-541.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17651" y="-530.41" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res4_1&#45;&gt;ln4_2 -->
<g id="edge573" class="edge">
<title>res4_1&#45;&gt;ln4_2</title>
<path fill="none" stroke="black" d="M18010.47,-611.22C17935.24,-597.34 17831.81,-578.27 17755.21,-564.13"/>
<polygon fill="black" stroke="black" points="17755.53,-560.63 17745.06,-562.26 17754.26,-567.52 17755.53,-560.63"/>
</g>
<!-- res4_2 -->
<g id="node337" class="node">
<title>res4_2</title>
<ellipse fill="lightgreen" stroke="black" cx="17882" cy="-108.42" rx="130.63" ry="28.98"/>
<text text-anchor="middle" x="17882" y="-116.92" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="17882" y="-105.92" font-family="Arial" font-size="10.00">[B=1024, L, 8192] + [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17882" y="-94.92" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- res4_1&#45;&gt;res4_2 -->
<g id="edge592" class="edge">
<title>res4_1&#45;&gt;res4_2</title>
<path fill="none" stroke="black" d="M18193.25,-608.11C18221.98,-595.39 18247,-575.53 18247,-544.91 18247,-544.91 18247,-544.91 18247,-214.41 18247,-163.79 18115.69,-136.12 18010.59,-122.08"/>
<polygon fill="black" stroke="black" points="18010.87,-118.59 18000.51,-120.77 18009.97,-125.53 18010.87,-118.59"/>
</g>
<!-- gate4 -->
<g id="node327" class="node">
<title>gate4</title>
<polygon fill="lightsteelblue" stroke="black" points="17683.22,-486.41 17398.12,-486.41 17324.78,-382.41 17609.88,-382.41 17683.22,-486.41"/>
<text text-anchor="middle" x="17504" y="-448.41" font-family="Arial" font-size="10.00">Gate Network 4</text>
<text text-anchor="middle" x="17504" y="-437.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8]</text>
<text text-anchor="middle" x="17504" y="-426.41" font-family="Arial" font-size="10.00">Top&#45;2 Expert Selection</text>
<text text-anchor="middle" x="17504" y="-415.41" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- ln4_2&#45;&gt;gate4 -->
<g id="edge574" class="edge">
<title>ln4_2&#45;&gt;gate4</title>
<path fill="none" stroke="black" d="M17624.04,-523.19C17612.08,-514.45 17597.33,-503.66 17582.31,-492.68"/>
<polygon fill="black" stroke="black" points="17584.09,-489.64 17573.95,-486.56 17579.96,-495.29 17584.09,-489.64"/>
</g>
<!-- expert_4_0 -->
<g id="node328" class="node">
<title>expert_4_0</title>
<polygon fill="lightseagreen" stroke="black" points="17404,-345.41 17216,-345.41 17216,-293.41 17404,-293.41 17404,-345.41"/>
<text text-anchor="middle" x="17310" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.0</text>
<text text-anchor="middle" x="17310" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17310" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17310" y="-300.41" font-family="Arial" font-size="10.00">GPU 0&#45;1</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_0 -->
<g id="edge575" class="edge">
<title>ln4_2&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M17556.89,-539.93C17469.04,-534.96 17346.96,-521.72 17316,-486.41 17284.8,-450.83 17291.13,-392.67 17299.7,-355.49"/>
<polygon fill="black" stroke="black" points="17303.14,-356.14 17302.14,-345.59 17296.35,-354.46 17303.14,-356.14"/>
</g>
<!-- expert_4_1 -->
<g id="node329" class="node">
<title>expert_4_1</title>
<polygon fill="lightseagreen" stroke="black" points="16786,-345.41 16598,-345.41 16598,-293.41 16786,-293.41 16786,-345.41"/>
<text text-anchor="middle" x="16692" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.1</text>
<text text-anchor="middle" x="16692" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16692" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16692" y="-300.41" font-family="Arial" font-size="10.00">GPU 2&#45;3</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_1 -->
<g id="edge577" class="edge">
<title>ln4_2&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M17556.92,-540.32C17396.6,-535.03 17077.48,-520.49 16971,-486.41 16877.95,-456.62 16782.99,-391.06 16731.37,-351.83"/>
<polygon fill="black" stroke="black" points="16733.22,-348.84 16723.16,-345.53 16728.96,-354.4 16733.22,-348.84"/>
</g>
<!-- expert_4_2 -->
<g id="node330" class="node">
<title>expert_4_2</title>
<polygon fill="lightseagreen" stroke="black" points="17816,-345.41 17628,-345.41 17628,-293.41 17816,-293.41 17816,-345.41"/>
<text text-anchor="middle" x="17722" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.2</text>
<text text-anchor="middle" x="17722" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17722" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17722" y="-300.41" font-family="Arial" font-size="10.00">GPU 4&#45;5</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_2 -->
<g id="edge579" class="edge">
<title>ln4_2&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M17690.45,-523.26C17696.96,-518.31 17702.91,-512.37 17707,-505.41 17734.12,-459.21 17732.34,-394.99 17727.76,-355.64"/>
<polygon fill="black" stroke="black" points="17731.2,-354.95 17726.45,-345.48 17724.26,-355.84 17731.2,-354.95"/>
</g>
<!-- expert_4_3 -->
<g id="node331" class="node">
<title>expert_4_3</title>
<polygon fill="lightseagreen" stroke="black" points="18022,-345.41 17834,-345.41 17834,-293.41 18022,-293.41 18022,-345.41"/>
<text text-anchor="middle" x="17928" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.3</text>
<text text-anchor="middle" x="17928" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17928" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17928" y="-300.41" font-family="Arial" font-size="10.00">GPU 6&#45;7</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_3 -->
<g id="edge581" class="edge">
<title>ln4_2&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M17684.86,-523.4C17693.87,-517.86 17703.46,-511.63 17712,-505.41 17779.81,-456 17852.76,-390.67 17894.16,-352.33"/>
<polygon fill="black" stroke="black" points="17896.57,-354.87 17901.51,-345.5 17891.81,-349.74 17896.57,-354.87"/>
</g>
<!-- expert_4_4 -->
<g id="node332" class="node">
<title>expert_4_4</title>
<polygon fill="lightseagreen" stroke="black" points="18228,-345.41 18040,-345.41 18040,-293.41 18228,-293.41 18228,-345.41"/>
<text text-anchor="middle" x="18134" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.4</text>
<text text-anchor="middle" x="18134" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="18134" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="18134" y="-300.41" font-family="Arial" font-size="10.00">GPU 8&#45;9</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_4 -->
<g id="edge583" class="edge">
<title>ln4_2&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M17709.03,-523.41C17738.15,-513.17 17773.78,-499.96 17805,-486.41 17903.73,-443.56 18014.77,-385.34 18079.31,-350.46"/>
<polygon fill="black" stroke="black" points="18081.36,-353.33 18088.49,-345.49 18078.03,-347.17 18081.36,-353.33"/>
</g>
<!-- expert_4_5 -->
<g id="node333" class="node">
<title>expert_4_5</title>
<polygon fill="lightseagreen" stroke="black" points="17198,-345.41 17010,-345.41 17010,-293.41 17198,-293.41 17198,-345.41"/>
<text text-anchor="middle" x="17104" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.5</text>
<text text-anchor="middle" x="17104" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17104" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17104" y="-300.41" font-family="Arial" font-size="10.00">GPU 10&#45;11</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_5 -->
<g id="edge585" class="edge">
<title>ln4_2&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M17556.79,-537.42C17494.34,-532.37 17410.97,-522.88 17339,-505.41 17315.49,-499.7 17308.68,-498.96 17288,-486.41 17226.53,-449.12 17166.91,-389.77 17132.91,-353.06"/>
<polygon fill="black" stroke="black" points="17135.39,-350.59 17126.06,-345.59 17130.24,-355.32 17135.39,-350.59"/>
</g>
<!-- expert_4_6 -->
<g id="node334" class="node">
<title>expert_4_6</title>
<polygon fill="lightseagreen" stroke="black" points="17610,-345.41 17422,-345.41 17422,-293.41 17610,-293.41 17610,-345.41"/>
<text text-anchor="middle" x="17516" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.6</text>
<text text-anchor="middle" x="17516" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="17516" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17516" y="-300.41" font-family="Arial" font-size="10.00">GPU 12&#45;13</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_6 -->
<g id="edge587" class="edge">
<title>ln4_2&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M17670.05,-523.21C17678.53,-513.08 17687.58,-500.01 17692,-486.41 17706.27,-442.45 17718.71,-420.13 17692,-382.41 17682.46,-368.93 17652.61,-356.36 17620.14,-346.1"/>
<polygon fill="black" stroke="black" points="17621.05,-342.72 17610.46,-343.14 17619,-349.41 17621.05,-342.72"/>
</g>
<!-- expert_4_7 -->
<g id="node335" class="node">
<title>expert_4_7</title>
<polygon fill="lightseagreen" stroke="black" points="16992,-345.41 16804,-345.41 16804,-293.41 16992,-293.41 16992,-345.41"/>
<text text-anchor="middle" x="16898" y="-333.41" font-family="Arial" font-size="10.00">Expert 4.7</text>
<text text-anchor="middle" x="16898" y="-322.41" font-family="Arial" font-size="10.00">MLP Block</text>
<text text-anchor="middle" x="16898" y="-311.41" font-family="Arial" font-size="10.00">[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="16898" y="-300.41" font-family="Arial" font-size="10.00">GPU 14&#45;15</text>
</g>
<!-- ln4_2&#45;&gt;expert_4_7 -->
<g id="edge589" class="edge">
<title>ln4_2&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M17556.87,-537.23C17434.63,-528.98 17228.47,-511.84 17157,-486.41 17070.19,-455.51 16982.76,-390.87 16934.97,-352"/>
<polygon fill="black" stroke="black" points="16937.03,-349.16 16927.08,-345.52 16932.59,-354.57 16937.03,-349.16"/>
</g>
<!-- gate4&#45;&gt;expert_4_0 -->
<g id="edge165" class="edge">
<title>gate4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17416.36,-382.36C17397.81,-371.56 17378.79,-360.48 17362.07,-350.74"/>
<polygon fill="black" stroke="black" points="17363.43,-347.48 17353.03,-345.47 17359.91,-353.53 17363.43,-347.48"/>
</g>
<!-- gate4&#45;&gt;expert_4_1 -->
<g id="edge166" class="edge">
<title>gate4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17350.75,-419.51C17209.02,-405.47 16992.52,-381 16796.14,-345.54"/>
<polygon fill="black" stroke="black" points="16796.67,-342.08 16786.21,-343.73 16795.42,-348.97 16796.67,-342.08"/>
</g>
<!-- gate4&#45;&gt;expert_4_2 -->
<g id="edge167" class="edge">
<title>gate4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17602.48,-382.36C17623.71,-371.36 17645.49,-360.07 17664.53,-350.2"/>
<polygon fill="black" stroke="black" points="17666.38,-353.18 17673.65,-345.47 17663.16,-346.97 17666.38,-353.18"/>
</g>
<!-- gate4&#45;&gt;expert_4_3 -->
<g id="edge168" class="edge">
<title>gate4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17623.52,-401.56C17686.62,-384.74 17763.32,-364.3 17823.95,-348.14"/>
<polygon fill="black" stroke="black" points="17825.16,-351.44 17833.93,-345.48 17823.36,-344.67 17825.16,-351.44"/>
</g>
<!-- gate4&#45;&gt;expert_4_4 -->
<g id="edge169" class="edge">
<title>gate4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17632.81,-414.58C17737.3,-398.67 17888.53,-374.24 18029.62,-345.64"/>
<polygon fill="black" stroke="black" points="18030.66,-349 18039.76,-343.57 18029.26,-342.14 18030.66,-349"/>
</g>
<!-- gate4&#45;&gt;expert_4_5 -->
<g id="edge170" class="edge">
<title>gate4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17325.06,-382.86C17282.86,-370.94 17239.4,-358.66 17202.29,-348.18"/>
<polygon fill="black" stroke="black" points="17203.08,-344.76 17192.51,-345.41 17201.18,-351.5 17203.08,-344.76"/>
</g>
<!-- gate4&#45;&gt;expert_4_6 -->
<g id="edge171" class="edge">
<title>gate4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17509.44,-382.2C17510.39,-373.25 17511.36,-364.12 17512.25,-355.72"/>
<polygon fill="black" stroke="black" points="17515.76,-355.85 17513.33,-345.54 17508.79,-355.11 17515.76,-355.85"/>
</g>
<!-- gate4&#45;&gt;expert_4_7 -->
<g id="edge172" class="edge">
<title>gate4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17340.71,-405.39C17215.71,-383.85 17056.9,-356.28 17002.27,-345.56"/>
<polygon fill="black" stroke="black" points="17002.74,-342.09 16992.24,-343.54 17001.35,-348.95 17002.74,-342.09"/>
</g>
<!-- expert_agg_4 -->
<g id="node336" class="node">
<title>expert_agg_4</title>
<polygon fill="lightcoral" stroke="black" points="17723.2,-256.41 17393.59,-256.41 17308.8,-174.41 17638.41,-174.41 17723.2,-256.41"/>
<text text-anchor="middle" x="17516" y="-223.91" font-family="Arial" font-size="10.00">Weighted Sum</text>
<text text-anchor="middle" x="17516" y="-212.91" font-family="Arial" font-size="10.00">8×[B=1024, L, 8192] → [B=1024, L, 8192]</text>
<text text-anchor="middle" x="17516" y="-201.91" font-family="Arial" font-size="10.00">All GPUs</text>
</g>
<!-- expert_4_0&#45;&gt;expert_agg_4 -->
<g id="edge576" class="edge">
<title>expert_4_0&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17360.66,-293.33C17380.34,-283.58 17403.5,-272.11 17425.84,-261.05"/>
<polygon fill="black" stroke="black" points="17427.61,-264.08 17435.02,-256.51 17424.5,-257.81 17427.61,-264.08"/>
</g>
<!-- expert_4_1&#45;&gt;expert_agg_4 -->
<g id="edge578" class="edge">
<title>expert_4_1&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16786.2,-295.02C16789.16,-294.45 16792.1,-293.91 16795,-293.41 16985.19,-260.32 17206.24,-239.24 17352.93,-227.66"/>
<polygon fill="black" stroke="black" points="17353.23,-231.15 17362.93,-226.88 17352.68,-224.17 17353.23,-231.15"/>
</g>
<!-- expert_4_2&#45;&gt;expert_agg_4 -->
<g id="edge580" class="edge">
<title>expert_4_2&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17671.34,-293.33C17651.66,-283.58 17628.5,-272.11 17606.16,-261.05"/>
<polygon fill="black" stroke="black" points="17607.5,-257.81 17596.98,-256.51 17604.39,-264.08 17607.5,-257.81"/>
</g>
<!-- expert_4_3&#45;&gt;expert_agg_4 -->
<g id="edge582" class="edge">
<title>expert_4_3&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17834,-295.14C17790.69,-284.41 17737.9,-271.34 17687.87,-258.96"/>
<polygon fill="black" stroke="black" points="17688.45,-255.5 17677.9,-256.49 17686.77,-262.29 17688.45,-255.5"/>
</g>
<!-- expert_4_4&#45;&gt;expert_agg_4 -->
<g id="edge584" class="edge">
<title>expert_4_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M18039.78,-295.18C18036.82,-294.57 18033.89,-293.97 18031,-293.41 17928.07,-273.26 17812.66,-255.56 17717.22,-242.23"/>
<polygon fill="black" stroke="black" points="17717.55,-238.74 17707.16,-240.83 17716.59,-245.68 17717.55,-238.74"/>
</g>
<!-- expert_4_5&#45;&gt;expert_agg_4 -->
<g id="edge586" class="edge">
<title>expert_4_5&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17198,-295.14C17250.54,-282.13 17317.03,-265.67 17375.61,-251.17"/>
<polygon fill="black" stroke="black" points="17376.45,-254.56 17385.32,-248.76 17374.77,-247.77 17376.45,-254.56"/>
</g>
<!-- expert_4_6&#45;&gt;expert_agg_4 -->
<g id="edge588" class="edge">
<title>expert_4_6&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M17516,-293.2C17516,-285.05 17516,-275.72 17516,-266.42"/>
<polygon fill="black" stroke="black" points="17519.5,-266.42 17516,-256.42 17512.5,-266.42 17519.5,-266.42"/>
</g>
<!-- expert_4_7&#45;&gt;expert_agg_4 -->
<g id="edge590" class="edge">
<title>expert_4_7&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M16992.22,-295.18C16995.18,-294.57 16998.11,-293.97 17001,-293.41 17121.1,-269.91 17258.18,-249.73 17360.71,-235.93"/>
<polygon fill="black" stroke="black" points="17361.39,-239.37 17370.84,-234.57 17360.46,-232.43 17361.39,-239.37"/>
</g>
<!-- expert_agg_4&#45;&gt;res4_2 -->
<g id="edge591" class="edge">
<title>expert_agg_4&#45;&gt;res4_2</title>
<path fill="none" stroke="black" d="M17642.47,-178.13C17692.52,-163.77 17748.82,-147.62 17794.26,-134.59"/>
<polygon fill="black" stroke="black" points="17795.44,-137.89 17804.08,-131.77 17793.51,-131.16 17795.44,-137.89"/>
</g>
<!-- output -->
<g id="node339" class="node">
<title>output</title>
<ellipse fill="lightpink" stroke="black" cx="17882" cy="-21.21" rx="67.35" ry="21.43"/>
<text text-anchor="middle" x="17882" y="-24.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="17882" y="-13.21" font-family="Arial" font-size="10.00">[B=1024, L, 8192]</text>
</g>
<!-- res4_2&#45;&gt;output -->
<g id="edge593" class="edge">
<title>res4_2&#45;&gt;output</title>
<path fill="none" stroke="black" d="M17882,-79.05C17882,-70.58 17882,-61.27 17882,-52.67"/>
<polygon fill="black" stroke="black" points="17885.5,-52.65 17882,-42.65 17878.5,-52.65 17885.5,-52.65"/>
</g>
<!-- res1_2 -->
<g id="node338" class="node">
<title>res1_2</title>
<ellipse fill="none" stroke="black" cx="17717" cy="-3749.54" rx="27.16" ry="18"/>
<text text-anchor="middle" x="17717" y="-3747.04" font-family="Arial" font-size="10.00">res1_2</text>
</g>
<!-- res1_2&#45;&gt;ln2_1 -->
<g id="edge173" class="edge">
<title>res1_2&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M17689.89,-3747.73C17401.8,-3739.14 14904.02,-3664.67 14359.52,-3648.44"/>
<polygon fill="black" stroke="black" points="14359.43,-3644.93 14349.33,-3648.14 14359.22,-3651.93 14359.43,-3644.93"/>
</g>
<!-- res1_2&#45;&gt;res2_1 -->
<g id="edge292" class="edge">
<title>res1_2&#45;&gt;res2_1</title>
<path fill="none" stroke="black" d="M17744.04,-3747.6C17918.66,-3741.35 18880,-3704.3 18880,-3645.32 18880,-3645.32 18880,-3645.32 18880,-3143.82 18880,-3084.31 18025.81,-3065.96 17682.43,-3060.99"/>
<polygon fill="black" stroke="black" points="17682.47,-3057.49 17672.42,-3060.84 17682.37,-3064.49 17682.47,-3057.49"/>
</g>
</g>
</svg>
