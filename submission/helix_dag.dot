// Helix Model Deployment on 16 GPUs
digraph Helix_Two_Level_Attention_Partitioning {
	bgcolor=white compound=true fontname=Arial rankdir=TB size="20,30"
	node [fontname=Arial shape=rectangle style=filled]
	edge [fontname=Arial]
	input [label="Input Tensor
X ∈ ℝ^(1024×L×8192)" fillcolor=lightblue shape=parallelogram]
	broadcast [label="Broadcast
All 16 GPUs" fillcolor=lightgreen shape=ellipse]
	input -> broadcast [label="Full tensor"]
	subgraph cluster_gpu0 {
		bgcolor=lightgray color=black label="GPU 0
Group 0, Slice 0" style=rounded
		proj_q_0 [label="Q Projection
W_Q^(0,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_0 [label="K Projection
W_K^(0,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_0 [label="V Projection
W_V^(0,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_0 [label="Q^(0,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_0 [label="K^(0,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_0 [label="V^(0,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_0 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_0 [label="Attention^(0,0)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_0
		broadcast -> proj_k_0
		broadcast -> proj_v_0
		proj_q_0 -> q_0
		proj_k_0 -> k_0
		proj_v_0 -> v_0
		q_0 -> attn_0
		k_0 -> attn_0
		v_0 -> attn_0
		attn_0 -> out_0
	}
	subgraph cluster_gpu1 {
		bgcolor=lightgray color=black label="GPU 1
Group 0, Slice 1" style=rounded
		proj_q_1 [label="Q Projection
W_Q^(0,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_1 [label="K Projection
W_K^(0,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_1 [label="V Projection
W_V^(0,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_1 [label="Q^(0,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_1 [label="K^(0,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_1 [label="V^(0,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_1 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_1 [label="Attention^(0,1)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_1
		broadcast -> proj_k_1
		broadcast -> proj_v_1
		proj_q_1 -> q_1
		proj_k_1 -> k_1
		proj_v_1 -> v_1
		q_1 -> attn_1
		k_1 -> attn_1
		v_1 -> attn_1
		attn_1 -> out_1
	}
	subgraph cluster_gpu2 {
		bgcolor=lightgray color=black label="GPU 2
Group 0, Slice 2" style=rounded
		proj_q_2 [label="Q Projection
W_Q^(0,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_2 [label="K Projection
W_K^(0,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_2 [label="V Projection
W_V^(0,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_2 [label="Q^(0,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_2 [label="K^(0,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_2 [label="V^(0,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_2 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_2 [label="Attention^(0,2)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_2
		broadcast -> proj_k_2
		broadcast -> proj_v_2
		proj_q_2 -> q_2
		proj_k_2 -> k_2
		proj_v_2 -> v_2
		q_2 -> attn_2
		k_2 -> attn_2
		v_2 -> attn_2
		attn_2 -> out_2
	}
	subgraph cluster_gpu3 {
		bgcolor=lightgray color=black label="GPU 3
Group 0, Slice 3" style=rounded
		proj_q_3 [label="Q Projection
W_Q^(0,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_3 [label="K Projection
W_K^(0,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_3 [label="V Projection
W_V^(0,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_3 [label="Q^(0,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_3 [label="K^(0,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_3 [label="V^(0,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_3 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_3 [label="Attention^(0,3)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_3
		broadcast -> proj_k_3
		broadcast -> proj_v_3
		proj_q_3 -> q_3
		proj_k_3 -> k_3
		proj_v_3 -> v_3
		q_3 -> attn_3
		k_3 -> attn_3
		v_3 -> attn_3
		attn_3 -> out_3
	}
	subgraph cluster_gpu4 {
		bgcolor=lightgray color=black label="GPU 4
Group 1, Slice 0" style=rounded
		proj_q_4 [label="Q Projection
W_Q^(1,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_4 [label="K Projection
W_K^(1,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_4 [label="V Projection
W_V^(1,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_4 [label="Q^(1,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_4 [label="K^(1,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_4 [label="V^(1,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_4 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_4 [label="Attention^(1,0)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_4
		broadcast -> proj_k_4
		broadcast -> proj_v_4
		proj_q_4 -> q_4
		proj_k_4 -> k_4
		proj_v_4 -> v_4
		q_4 -> attn_4
		k_4 -> attn_4
		v_4 -> attn_4
		attn_4 -> out_4
	}
	subgraph cluster_gpu5 {
		bgcolor=lightgray color=black label="GPU 5
Group 1, Slice 1" style=rounded
		proj_q_5 [label="Q Projection
W_Q^(1,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_5 [label="K Projection
W_K^(1,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_5 [label="V Projection
W_V^(1,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_5 [label="Q^(1,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_5 [label="K^(1,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_5 [label="V^(1,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_5 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_5 [label="Attention^(1,1)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_5
		broadcast -> proj_k_5
		broadcast -> proj_v_5
		proj_q_5 -> q_5
		proj_k_5 -> k_5
		proj_v_5 -> v_5
		q_5 -> attn_5
		k_5 -> attn_5
		v_5 -> attn_5
		attn_5 -> out_5
	}
	subgraph cluster_gpu6 {
		bgcolor=lightgray color=black label="GPU 6
Group 1, Slice 2" style=rounded
		proj_q_6 [label="Q Projection
W_Q^(1,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_6 [label="K Projection
W_K^(1,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_6 [label="V Projection
W_V^(1,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_6 [label="Q^(1,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_6 [label="K^(1,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_6 [label="V^(1,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_6 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_6 [label="Attention^(1,2)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_6
		broadcast -> proj_k_6
		broadcast -> proj_v_6
		proj_q_6 -> q_6
		proj_k_6 -> k_6
		proj_v_6 -> v_6
		q_6 -> attn_6
		k_6 -> attn_6
		v_6 -> attn_6
		attn_6 -> out_6
	}
	subgraph cluster_gpu7 {
		bgcolor=lightgray color=black label="GPU 7
Group 1, Slice 3" style=rounded
		proj_q_7 [label="Q Projection
W_Q^(1,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_7 [label="K Projection
W_K^(1,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_7 [label="V Projection
W_V^(1,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_7 [label="Q^(1,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_7 [label="K^(1,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_7 [label="V^(1,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_7 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_7 [label="Attention^(1,3)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_7
		broadcast -> proj_k_7
		broadcast -> proj_v_7
		proj_q_7 -> q_7
		proj_k_7 -> k_7
		proj_v_7 -> v_7
		q_7 -> attn_7
		k_7 -> attn_7
		v_7 -> attn_7
		attn_7 -> out_7
	}
	subgraph cluster_gpu8 {
		bgcolor=lightgray color=black label="GPU 8
Group 2, Slice 0" style=rounded
		proj_q_8 [label="Q Projection
W_Q^(2,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_8 [label="K Projection
W_K^(2,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_8 [label="V Projection
W_V^(2,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_8 [label="Q^(2,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_8 [label="K^(2,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_8 [label="V^(2,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_8 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_8 [label="Attention^(2,0)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_8
		broadcast -> proj_k_8
		broadcast -> proj_v_8
		proj_q_8 -> q_8
		proj_k_8 -> k_8
		proj_v_8 -> v_8
		q_8 -> attn_8
		k_8 -> attn_8
		v_8 -> attn_8
		attn_8 -> out_8
	}
	subgraph cluster_gpu9 {
		bgcolor=lightgray color=black label="GPU 9
Group 2, Slice 1" style=rounded
		proj_q_9 [label="Q Projection
W_Q^(2,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_9 [label="K Projection
W_K^(2,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_9 [label="V Projection
W_V^(2,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_9 [label="Q^(2,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_9 [label="K^(2,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_9 [label="V^(2,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_9 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_9 [label="Attention^(2,1)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_9
		broadcast -> proj_k_9
		broadcast -> proj_v_9
		proj_q_9 -> q_9
		proj_k_9 -> k_9
		proj_v_9 -> v_9
		q_9 -> attn_9
		k_9 -> attn_9
		v_9 -> attn_9
		attn_9 -> out_9
	}
	subgraph cluster_gpu10 {
		bgcolor=lightgray color=black label="GPU 10
Group 2, Slice 2" style=rounded
		proj_q_10 [label="Q Projection
W_Q^(2,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_10 [label="K Projection
W_K^(2,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_10 [label="V Projection
W_V^(2,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_10 [label="Q^(2,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_10 [label="K^(2,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_10 [label="V^(2,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_10 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_10 [label="Attention^(2,2)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_10
		broadcast -> proj_k_10
		broadcast -> proj_v_10
		proj_q_10 -> q_10
		proj_k_10 -> k_10
		proj_v_10 -> v_10
		q_10 -> attn_10
		k_10 -> attn_10
		v_10 -> attn_10
		attn_10 -> out_10
	}
	subgraph cluster_gpu11 {
		bgcolor=lightgray color=black label="GPU 11
Group 2, Slice 3" style=rounded
		proj_q_11 [label="Q Projection
W_Q^(2,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_11 [label="K Projection
W_K^(2,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_11 [label="V Projection
W_V^(2,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_11 [label="Q^(2,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_11 [label="K^(2,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_11 [label="V^(2,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_11 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_11 [label="Attention^(2,3)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_11
		broadcast -> proj_k_11
		broadcast -> proj_v_11
		proj_q_11 -> q_11
		proj_k_11 -> k_11
		proj_v_11 -> v_11
		q_11 -> attn_11
		k_11 -> attn_11
		v_11 -> attn_11
		attn_11 -> out_11
	}
	subgraph cluster_gpu12 {
		bgcolor=lightgray color=black label="GPU 12
Group 3, Slice 0" style=rounded
		proj_q_12 [label="Q Projection
W_Q^(3,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_12 [label="K Projection
W_K^(3,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_12 [label="V Projection
W_V^(3,0)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_12 [label="Q^(3,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_12 [label="K^(3,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_12 [label="V^(3,0)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_12 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_12 [label="Attention^(3,0)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_12
		broadcast -> proj_k_12
		broadcast -> proj_v_12
		proj_q_12 -> q_12
		proj_k_12 -> k_12
		proj_v_12 -> v_12
		q_12 -> attn_12
		k_12 -> attn_12
		v_12 -> attn_12
		attn_12 -> out_12
	}
	subgraph cluster_gpu13 {
		bgcolor=lightgray color=black label="GPU 13
Group 3, Slice 1" style=rounded
		proj_q_13 [label="Q Projection
W_Q^(3,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_13 [label="K Projection
W_K^(3,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_13 [label="V Projection
W_V^(3,1)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_13 [label="Q^(3,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_13 [label="K^(3,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_13 [label="V^(3,1)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_13 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_13 [label="Attention^(3,1)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_13
		broadcast -> proj_k_13
		broadcast -> proj_v_13
		proj_q_13 -> q_13
		proj_k_13 -> k_13
		proj_v_13 -> v_13
		q_13 -> attn_13
		k_13 -> attn_13
		v_13 -> attn_13
		attn_13 -> out_13
	}
	subgraph cluster_gpu14 {
		bgcolor=lightgray color=black label="GPU 14
Group 3, Slice 2" style=rounded
		proj_q_14 [label="Q Projection
W_Q^(3,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_14 [label="K Projection
W_K^(3,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_14 [label="V Projection
W_V^(3,2)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_14 [label="Q^(3,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_14 [label="K^(3,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_14 [label="V^(3,2)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_14 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_14 [label="Attention^(3,2)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_14
		broadcast -> proj_k_14
		broadcast -> proj_v_14
		proj_q_14 -> q_14
		proj_k_14 -> k_14
		proj_v_14 -> v_14
		q_14 -> attn_14
		k_14 -> attn_14
		v_14 -> attn_14
		attn_14 -> out_14
	}
	subgraph cluster_gpu15 {
		bgcolor=lightgray color=black label="GPU 15
Group 3, Slice 3" style=rounded
		proj_q_15 [label="Q Projection
W_Q^(3,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_k_15 [label="K Projection
W_K^(3,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		proj_v_15 [label="V Projection
W_V^(3,3)
ℝ^(8192×128)" fillcolor=lightyellow]
		q_15 [label="Q^(3,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		k_15 [label="K^(3,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		v_15 [label="V^(3,3)
ℝ^(1024×L×128)" fillcolor=lightcyan]
		attn_15 [label="Softmax Attention
QK^TV/√128
ℝ^(1024×L×128)" fillcolor=lightpink]
		out_15 [label="Attention^(3,3)
ℝ^(1024×L×128)" fillcolor=lightgreen]
		broadcast -> proj_q_15
		broadcast -> proj_k_15
		broadcast -> proj_v_15
		proj_q_15 -> q_15
		proj_k_15 -> k_15
		proj_v_15 -> v_15
		q_15 -> attn_15
		k_15 -> attn_15
		v_15 -> attn_15
		attn_15 -> out_15
	}
	concat_group_0 [label="Intra-group Concat
Group 0
ℝ^(1024×L×512)" fillcolor=orange shape=diamond]
	out_0 -> concat_group_0 [label="GPU 0 slice" style=dashed]
	out_1 -> concat_group_0 [label="GPU 1 slice" style=dashed]
	out_2 -> concat_group_0 [label="GPU 2 slice" style=dashed]
	out_3 -> concat_group_0 [label="GPU 3 slice" style=dashed]
	concat_group_1 [label="Intra-group Concat
Group 1
ℝ^(1024×L×512)" fillcolor=orange shape=diamond]
	out_4 -> concat_group_1 [label="GPU 4 slice" style=dashed]
	out_5 -> concat_group_1 [label="GPU 5 slice" style=dashed]
	out_6 -> concat_group_1 [label="GPU 6 slice" style=dashed]
	out_7 -> concat_group_1 [label="GPU 7 slice" style=dashed]
	concat_group_2 [label="Intra-group Concat
Group 2
ℝ^(1024×L×512)" fillcolor=orange shape=diamond]
	out_8 -> concat_group_2 [label="GPU 8 slice" style=dashed]
	out_9 -> concat_group_2 [label="GPU 9 slice" style=dashed]
	out_10 -> concat_group_2 [label="GPU 10 slice" style=dashed]
	out_11 -> concat_group_2 [label="GPU 11 slice" style=dashed]
	concat_group_3 [label="Intra-group Concat
Group 3
ℝ^(1024×L×512)" fillcolor=orange shape=diamond]
	out_12 -> concat_group_3 [label="GPU 12 slice" style=dashed]
	out_13 -> concat_group_3 [label="GPU 13 slice" style=dashed]
	out_14 -> concat_group_3 [label="GPU 14 slice" style=dashed]
	out_15 -> concat_group_3 [label="GPU 15 slice" style=dashed]
	final_concat [label="Final Concatenation
ℝ^(1024×L×8192)" fillcolor=gold shape=diamond]
	concat_group_0 -> final_concat [label="Group 0 output" style=bold]
	concat_group_1 -> final_concat [label="Group 1 output" style=bold]
	concat_group_2 -> final_concat [label="Group 2 output" style=bold]
	concat_group_3 -> final_concat [label="Group 3 output" style=bold]
	output [label="Output Tensor
ℝ^(1024×L×8192)" fillcolor=lightblue shape=parallelogram]
	final_concat -> output
	comm_group_0 [label="All-gather
Group 0" fillcolor=red shape=ellipse style=dashed]
	comm_group_0 -> concat_group_0 [label="Gather 4 slices" style=dashed]
	comm_group_1 [label="All-gather
Group 1" fillcolor=red shape=ellipse style=dashed]
	comm_group_1 -> concat_group_1 [label="Gather 4 slices" style=dashed]
	comm_group_2 [label="All-gather
Group 2" fillcolor=red shape=ellipse style=dashed]
	comm_group_2 -> concat_group_2 [label="Gather 4 slices" style=dashed]
	comm_group_3 [label="All-gather
Group 3" fillcolor=red shape=ellipse style=dashed]
	comm_group_3 -> concat_group_3 [label="Gather 4 slices" style=dashed]
	final_comm [label="Final Gather
Across Groups" fillcolor=red shape=ellipse style=dashed]
	final_comm -> final_concat [label="Gather 4 group outputs" style=dashed]
}
