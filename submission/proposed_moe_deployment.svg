<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2160pt" height="1172pt"
 viewBox="0.00 0.00 2160.00 1171.95" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.26 0.26) rotate(0) translate(4 4586.16)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-4586.16 8456,-4586.16 8456,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M3762,-4495.56C3762,-4495.56 3946,-4495.56 3946,-4495.56 3952,-4495.56 3958,-4501.56 3958,-4507.56 3958,-4507.56 3958,-4562.16 3958,-4562.16 3958,-4568.16 3952,-4574.16 3946,-4574.16 3946,-4574.16 3762,-4574.16 3762,-4574.16 3756,-4574.16 3750,-4568.16 3750,-4562.16 3750,-4562.16 3750,-4507.56 3750,-4507.56 3750,-4501.56 3756,-4495.56 3762,-4495.56"/>
<text text-anchor="middle" x="3854" y="-4558.96" font-family="Times,serif" font-size="14.00">Input (Batch: 1024 tokens)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<path fill="none" stroke="blue" d="M20,-3392.82C20,-3392.82 6956,-3392.82 6956,-3392.82 6962,-3392.82 6968,-3398.82 6968,-3404.82 6968,-3404.82 6968,-4464.56 6968,-4464.56 6968,-4470.56 6962,-4476.56 6956,-4476.56 6956,-4476.56 20,-4476.56 20,-4476.56 14,-4476.56 8,-4470.56 8,-4464.56 8,-4464.56 8,-3404.82 8,-3404.82 8,-3398.82 14,-3392.82 20,-3392.82"/>
<text text-anchor="middle" x="3488" y="-4461.36" font-family="Times,serif" font-size="14.00">Layer 0 &#45; EP=16 (64 GPUs)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0_mha</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="3675,-4100.56 3675,-4445.56 3957,-4445.56 3957,-4100.56 3675,-4100.56"/>
<text text-anchor="middle" x="3816" y="-4430.36" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="3816" y="-4415.36" font-family="Times,serif" font-size="14.00">TP across selected GPUs</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_expert0_0</title>
<path fill="none" stroke="blue" d="M2616,-3618.82C2616,-3618.82 3010,-3618.82 3010,-3618.82 3016,-3618.82 3022,-3624.82 3022,-3630.82 3022,-3630.82 3022,-4052.56 3022,-4052.56 3022,-4058.56 3016,-4064.56 3010,-4064.56 3010,-4064.56 2616,-4064.56 2616,-4064.56 2610,-4064.56 2604,-4058.56 2604,-4052.56 2604,-4052.56 2604,-3630.82 2604,-3630.82 2604,-3624.82 2610,-3618.82 2616,-3618.82"/>
<text text-anchor="middle" x="2813" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2813" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 0&#45;3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_expert0_1</title>
<path fill="none" stroke="blue" d="M4356,-3618.82C4356,-3618.82 4750,-3618.82 4750,-3618.82 4756,-3618.82 4762,-3624.82 4762,-3630.82 4762,-3630.82 4762,-4052.56 4762,-4052.56 4762,-4058.56 4756,-4064.56 4750,-4064.56 4750,-4064.56 4356,-4064.56 4356,-4064.56 4350,-4064.56 4344,-4058.56 4344,-4052.56 4344,-4052.56 4344,-3630.82 4344,-3630.82 4344,-3624.82 4350,-3618.82 4356,-3618.82"/>
<text text-anchor="middle" x="4553" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4553" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 4&#45;7</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_expert0_2</title>
<path fill="none" stroke="blue" d="M2190,-3618.82C2190,-3618.82 2584,-3618.82 2584,-3618.82 2590,-3618.82 2596,-3624.82 2596,-3630.82 2596,-3630.82 2596,-4052.56 2596,-4052.56 2596,-4058.56 2590,-4064.56 2584,-4064.56 2584,-4064.56 2190,-4064.56 2190,-4064.56 2184,-4064.56 2178,-4058.56 2178,-4052.56 2178,-4052.56 2178,-3630.82 2178,-3630.82 2178,-3624.82 2184,-3618.82 2190,-3618.82"/>
<text text-anchor="middle" x="2387" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2387" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 8&#45;11</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_expert0_3</title>
<path fill="none" stroke="blue" d="M28,-3618.82C28,-3618.82 426,-3618.82 426,-3618.82 432,-3618.82 438,-3624.82 438,-3630.82 438,-3630.82 438,-4052.56 438,-4052.56 438,-4058.56 432,-4064.56 426,-4064.56 426,-4064.56 28,-4064.56 28,-4064.56 22,-4064.56 16,-4058.56 16,-4052.56 16,-4052.56 16,-3630.82 16,-3630.82 16,-3624.82 22,-3618.82 28,-3618.82"/>
<text text-anchor="middle" x="227" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="227" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 12&#45;15</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_expert0_4</title>
<path fill="none" stroke="blue" d="M3484,-3618.82C3484,-3618.82 3882,-3618.82 3882,-3618.82 3888,-3618.82 3894,-3624.82 3894,-3630.82 3894,-3630.82 3894,-4052.56 3894,-4052.56 3894,-4058.56 3888,-4064.56 3882,-4064.56 3882,-4064.56 3484,-4064.56 3484,-4064.56 3478,-4064.56 3472,-4058.56 3472,-4052.56 3472,-4052.56 3472,-3630.82 3472,-3630.82 3472,-3624.82 3478,-3618.82 3484,-3618.82"/>
<text text-anchor="middle" x="3683" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3683" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 16&#45;19</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_expert0_5</title>
<path fill="none" stroke="blue" d="M1318,-3618.82C1318,-3618.82 1716,-3618.82 1716,-3618.82 1722,-3618.82 1728,-3624.82 1728,-3630.82 1728,-3630.82 1728,-4052.56 1728,-4052.56 1728,-4058.56 1722,-4064.56 1716,-4064.56 1716,-4064.56 1318,-4064.56 1318,-4064.56 1312,-4064.56 1306,-4058.56 1306,-4052.56 1306,-4052.56 1306,-3630.82 1306,-3630.82 1306,-3624.82 1312,-3618.82 1318,-3618.82"/>
<text text-anchor="middle" x="1517" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="1517" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 20&#45;23</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_expert0_6</title>
<path fill="none" stroke="blue" d="M4782,-3618.82C4782,-3618.82 5180,-3618.82 5180,-3618.82 5186,-3618.82 5192,-3624.82 5192,-3630.82 5192,-3630.82 5192,-4052.56 5192,-4052.56 5192,-4058.56 5186,-4064.56 5180,-4064.56 5180,-4064.56 4782,-4064.56 4782,-4064.56 4776,-4064.56 4770,-4058.56 4770,-4052.56 4770,-4052.56 4770,-3630.82 4770,-3630.82 4770,-3624.82 4776,-3618.82 4782,-3618.82"/>
<text text-anchor="middle" x="4981" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="4981" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 24&#45;27</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_expert0_7</title>
<path fill="none" stroke="blue" d="M458,-3618.82C458,-3618.82 856,-3618.82 856,-3618.82 862,-3618.82 868,-3624.82 868,-3630.82 868,-3630.82 868,-4052.56 868,-4052.56 868,-4058.56 862,-4064.56 856,-4064.56 856,-4064.56 458,-4064.56 458,-4064.56 452,-4064.56 446,-4058.56 446,-4052.56 446,-4052.56 446,-3630.82 446,-3630.82 446,-3624.82 452,-3618.82 458,-3618.82"/>
<text text-anchor="middle" x="657" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="657" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 28&#45;31</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_expert0_8</title>
<path fill="none" stroke="blue" d="M5654,-3618.82C5654,-3618.82 6052,-3618.82 6052,-3618.82 6058,-3618.82 6064,-3624.82 6064,-3630.82 6064,-3630.82 6064,-4052.56 6064,-4052.56 6064,-4058.56 6058,-4064.56 6052,-4064.56 6052,-4064.56 5654,-4064.56 5654,-4064.56 5648,-4064.56 5642,-4058.56 5642,-4052.56 5642,-4052.56 5642,-3630.82 5642,-3630.82 5642,-3624.82 5648,-3618.82 5654,-3618.82"/>
<text text-anchor="middle" x="5853" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="5853" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 32&#45;35</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_expert0_9</title>
<path fill="none" stroke="blue" d="M888,-3618.82C888,-3618.82 1286,-3618.82 1286,-3618.82 1292,-3618.82 1298,-3624.82 1298,-3630.82 1298,-3630.82 1298,-4052.56 1298,-4052.56 1298,-4058.56 1292,-4064.56 1286,-4064.56 1286,-4064.56 888,-4064.56 888,-4064.56 882,-4064.56 876,-4058.56 876,-4052.56 876,-4052.56 876,-3630.82 876,-3630.82 876,-3624.82 882,-3618.82 888,-3618.82"/>
<text text-anchor="middle" x="1087" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="1087" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 36&#45;39</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_expert0_10</title>
<path fill="none" stroke="blue" d="M1748,-3618.82C1748,-3618.82 2158,-3618.82 2158,-3618.82 2164,-3618.82 2170,-3624.82 2170,-3630.82 2170,-3630.82 2170,-4052.56 2170,-4052.56 2170,-4058.56 2164,-4064.56 2158,-4064.56 2158,-4064.56 1748,-4064.56 1748,-4064.56 1742,-4064.56 1736,-4058.56 1736,-4052.56 1736,-4052.56 1736,-3630.82 1736,-3630.82 1736,-3624.82 1742,-3618.82 1748,-3618.82"/>
<text text-anchor="middle" x="1953" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="1953" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 40&#45;43</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_expert0_11</title>
<path fill="none" stroke="blue" d="M3042,-3618.82C3042,-3618.82 3452,-3618.82 3452,-3618.82 3458,-3618.82 3464,-3624.82 3464,-3630.82 3464,-3630.82 3464,-4052.56 3464,-4052.56 3464,-4058.56 3458,-4064.56 3452,-4064.56 3452,-4064.56 3042,-4064.56 3042,-4064.56 3036,-4064.56 3030,-4058.56 3030,-4052.56 3030,-4052.56 3030,-3630.82 3030,-3630.82 3030,-3624.82 3036,-3618.82 3042,-3618.82"/>
<text text-anchor="middle" x="3247" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3247" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 44&#45;47</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_expert0_12</title>
<path fill="none" stroke="blue" d="M3914,-3618.82C3914,-3618.82 4324,-3618.82 4324,-3618.82 4330,-3618.82 4336,-3624.82 4336,-3630.82 4336,-3630.82 4336,-4052.56 4336,-4052.56 4336,-4058.56 4330,-4064.56 4324,-4064.56 4324,-4064.56 3914,-4064.56 3914,-4064.56 3908,-4064.56 3902,-4058.56 3902,-4052.56 3902,-4052.56 3902,-3630.82 3902,-3630.82 3902,-3624.82 3908,-3618.82 3914,-3618.82"/>
<text text-anchor="middle" x="4119" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="4119" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 48&#45;51</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_expert0_13</title>
<path fill="none" stroke="blue" d="M5212,-3618.82C5212,-3618.82 5622,-3618.82 5622,-3618.82 5628,-3618.82 5634,-3624.82 5634,-3630.82 5634,-3630.82 5634,-4052.56 5634,-4052.56 5634,-4058.56 5628,-4064.56 5622,-4064.56 5622,-4064.56 5212,-4064.56 5212,-4064.56 5206,-4064.56 5200,-4058.56 5200,-4052.56 5200,-4052.56 5200,-3630.82 5200,-3630.82 5200,-3624.82 5206,-3618.82 5212,-3618.82"/>
<text text-anchor="middle" x="5417" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="5417" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 52&#45;55</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_expert0_14</title>
<path fill="none" stroke="blue" d="M6084,-3618.82C6084,-3618.82 6494,-3618.82 6494,-3618.82 6500,-3618.82 6506,-3624.82 6506,-3630.82 6506,-3630.82 6506,-4052.56 6506,-4052.56 6506,-4058.56 6500,-4064.56 6494,-4064.56 6494,-4064.56 6084,-4064.56 6084,-4064.56 6078,-4064.56 6072,-4058.56 6072,-4052.56 6072,-4052.56 6072,-3630.82 6072,-3630.82 6072,-3624.82 6078,-3618.82 6084,-3618.82"/>
<text text-anchor="middle" x="6289" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="6289" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 56&#45;59</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_expert0_15</title>
<path fill="none" stroke="blue" d="M6526,-3618.82C6526,-3618.82 6936,-3618.82 6936,-3618.82 6942,-3618.82 6948,-3624.82 6948,-3630.82 6948,-3630.82 6948,-4052.56 6948,-4052.56 6948,-4058.56 6942,-4064.56 6936,-4064.56 6936,-4064.56 6526,-4064.56 6526,-4064.56 6520,-4064.56 6514,-4058.56 6514,-4052.56 6514,-4052.56 6514,-3630.82 6514,-3630.82 6514,-3624.82 6520,-3618.82 6526,-3618.82"/>
<text text-anchor="middle" x="6731" y="-4049.36" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="6731" y="-4034.36" font-family="Times,serif" font-size="14.00">GPUs 60&#45;63</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_layer1</title>
<path fill="none" stroke="blue" d="M945,-2297.08C945,-2297.08 7893,-2297.08 7893,-2297.08 7899,-2297.08 7905,-2303.08 7905,-2309.08 7905,-2309.08 7905,-3361.82 7905,-3361.82 7905,-3367.82 7899,-3373.82 7893,-3373.82 7893,-3373.82 945,-3373.82 945,-3373.82 939,-3373.82 933,-3367.82 933,-3361.82 933,-3361.82 933,-2309.08 933,-2309.08 933,-2303.08 939,-2297.08 945,-2297.08"/>
<text text-anchor="middle" x="4419" y="-3358.62" font-family="Times,serif" font-size="14.00">Layer 1 &#45; EP=16 (64 GPUs)</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_layer1_mha</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="4608,-2997.82 4608,-3342.82 4890,-3342.82 4890,-2997.82 4608,-2997.82"/>
<text text-anchor="middle" x="4749" y="-3327.62" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="4749" y="-3312.62" font-family="Times,serif" font-size="14.00">TP across selected GPUs</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_expert1_0</title>
<path fill="none" stroke="blue" d="M3545,-2523.08C3545,-2523.08 3943,-2523.08 3943,-2523.08 3949,-2523.08 3955,-2529.08 3955,-2535.08 3955,-2535.08 3955,-2956.82 3955,-2956.82 3955,-2962.82 3949,-2968.82 3943,-2968.82 3943,-2968.82 3545,-2968.82 3545,-2968.82 3539,-2968.82 3533,-2962.82 3533,-2956.82 3533,-2956.82 3533,-2535.08 3533,-2535.08 3533,-2529.08 3539,-2523.08 3545,-2523.08"/>
<text text-anchor="middle" x="3744" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3744" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 16&#45;19</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_expert1_1</title>
<path fill="none" stroke="blue" d="M5289,-2523.08C5289,-2523.08 5687,-2523.08 5687,-2523.08 5693,-2523.08 5699,-2529.08 5699,-2535.08 5699,-2535.08 5699,-2956.82 5699,-2956.82 5699,-2962.82 5693,-2968.82 5687,-2968.82 5687,-2968.82 5289,-2968.82 5289,-2968.82 5283,-2968.82 5277,-2962.82 5277,-2956.82 5277,-2956.82 5277,-2535.08 5277,-2535.08 5277,-2529.08 5283,-2523.08 5289,-2523.08"/>
<text text-anchor="middle" x="5488" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5488" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 20&#45;23</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_expert1_2</title>
<path fill="none" stroke="blue" d="M3115,-2523.08C3115,-2523.08 3513,-2523.08 3513,-2523.08 3519,-2523.08 3525,-2529.08 3525,-2535.08 3525,-2535.08 3525,-2956.82 3525,-2956.82 3525,-2962.82 3519,-2968.82 3513,-2968.82 3513,-2968.82 3115,-2968.82 3115,-2968.82 3109,-2968.82 3103,-2962.82 3103,-2956.82 3103,-2956.82 3103,-2535.08 3103,-2535.08 3103,-2529.08 3109,-2523.08 3115,-2523.08"/>
<text text-anchor="middle" x="3314" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3314" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 24&#45;27</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_expert1_3</title>
<path fill="none" stroke="blue" d="M953,-2523.08C953,-2523.08 1351,-2523.08 1351,-2523.08 1357,-2523.08 1363,-2529.08 1363,-2535.08 1363,-2535.08 1363,-2956.82 1363,-2956.82 1363,-2962.82 1357,-2968.82 1351,-2968.82 1351,-2968.82 953,-2968.82 953,-2968.82 947,-2968.82 941,-2962.82 941,-2956.82 941,-2956.82 941,-2535.08 941,-2535.08 941,-2529.08 947,-2523.08 953,-2523.08"/>
<text text-anchor="middle" x="1152" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1152" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 28&#45;31</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_expert1_4</title>
<path fill="none" stroke="blue" d="M4417,-2523.08C4417,-2523.08 4815,-2523.08 4815,-2523.08 4821,-2523.08 4827,-2529.08 4827,-2535.08 4827,-2535.08 4827,-2956.82 4827,-2956.82 4827,-2962.82 4821,-2968.82 4815,-2968.82 4815,-2968.82 4417,-2968.82 4417,-2968.82 4411,-2968.82 4405,-2962.82 4405,-2956.82 4405,-2956.82 4405,-2535.08 4405,-2535.08 4405,-2529.08 4411,-2523.08 4417,-2523.08"/>
<text text-anchor="middle" x="4616" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4616" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 32&#45;35</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_expert1_5</title>
<path fill="none" stroke="blue" d="M2243,-2523.08C2243,-2523.08 2641,-2523.08 2641,-2523.08 2647,-2523.08 2653,-2529.08 2653,-2535.08 2653,-2535.08 2653,-2956.82 2653,-2956.82 2653,-2962.82 2647,-2968.82 2641,-2968.82 2641,-2968.82 2243,-2968.82 2243,-2968.82 2237,-2968.82 2231,-2962.82 2231,-2956.82 2231,-2956.82 2231,-2535.08 2231,-2535.08 2231,-2529.08 2237,-2523.08 2243,-2523.08"/>
<text text-anchor="middle" x="2442" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2442" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 36&#45;39</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_expert1_6</title>
<path fill="none" stroke="blue" d="M5719,-2523.08C5719,-2523.08 6117,-2523.08 6117,-2523.08 6123,-2523.08 6129,-2529.08 6129,-2535.08 6129,-2535.08 6129,-2956.82 6129,-2956.82 6129,-2962.82 6123,-2968.82 6117,-2968.82 6117,-2968.82 5719,-2968.82 5719,-2968.82 5713,-2968.82 5707,-2962.82 5707,-2956.82 5707,-2956.82 5707,-2535.08 5707,-2535.08 5707,-2529.08 5713,-2523.08 5719,-2523.08"/>
<text text-anchor="middle" x="5918" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5918" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 40&#45;43</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_expert1_7</title>
<path fill="none" stroke="blue" d="M1383,-2523.08C1383,-2523.08 1781,-2523.08 1781,-2523.08 1787,-2523.08 1793,-2529.08 1793,-2535.08 1793,-2535.08 1793,-2956.82 1793,-2956.82 1793,-2962.82 1787,-2968.82 1781,-2968.82 1781,-2968.82 1383,-2968.82 1383,-2968.82 1377,-2968.82 1371,-2962.82 1371,-2956.82 1371,-2956.82 1371,-2535.08 1371,-2535.08 1371,-2529.08 1377,-2523.08 1383,-2523.08"/>
<text text-anchor="middle" x="1582" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1582" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 44&#45;47</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_expert1_8</title>
<path fill="none" stroke="blue" d="M6591,-2523.08C6591,-2523.08 6989,-2523.08 6989,-2523.08 6995,-2523.08 7001,-2529.08 7001,-2535.08 7001,-2535.08 7001,-2956.82 7001,-2956.82 7001,-2962.82 6995,-2968.82 6989,-2968.82 6989,-2968.82 6591,-2968.82 6591,-2968.82 6585,-2968.82 6579,-2962.82 6579,-2956.82 6579,-2956.82 6579,-2535.08 6579,-2535.08 6579,-2529.08 6585,-2523.08 6591,-2523.08"/>
<text text-anchor="middle" x="6790" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="6790" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 48&#45;51</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_expert1_9</title>
<path fill="none" stroke="blue" d="M1813,-2523.08C1813,-2523.08 2211,-2523.08 2211,-2523.08 2217,-2523.08 2223,-2529.08 2223,-2535.08 2223,-2535.08 2223,-2956.82 2223,-2956.82 2223,-2962.82 2217,-2968.82 2211,-2968.82 2211,-2968.82 1813,-2968.82 1813,-2968.82 1807,-2968.82 1801,-2962.82 1801,-2956.82 1801,-2956.82 1801,-2535.08 1801,-2535.08 1801,-2529.08 1807,-2523.08 1813,-2523.08"/>
<text text-anchor="middle" x="2012" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2012" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 52&#45;55</text>
</g>
<g id="clust32" class="cluster">
<title>cluster_expert1_10</title>
<path fill="none" stroke="blue" d="M2673,-2523.08C2673,-2523.08 3083,-2523.08 3083,-2523.08 3089,-2523.08 3095,-2529.08 3095,-2535.08 3095,-2535.08 3095,-2956.82 3095,-2956.82 3095,-2962.82 3089,-2968.82 3083,-2968.82 3083,-2968.82 2673,-2968.82 2673,-2968.82 2667,-2968.82 2661,-2962.82 2661,-2956.82 2661,-2956.82 2661,-2535.08 2661,-2535.08 2661,-2529.08 2667,-2523.08 2673,-2523.08"/>
<text text-anchor="middle" x="2878" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="2878" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 56&#45;59</text>
</g>
<g id="clust33" class="cluster">
<title>cluster_expert1_11</title>
<path fill="none" stroke="blue" d="M3975,-2523.08C3975,-2523.08 4385,-2523.08 4385,-2523.08 4391,-2523.08 4397,-2529.08 4397,-2535.08 4397,-2535.08 4397,-2956.82 4397,-2956.82 4397,-2962.82 4391,-2968.82 4385,-2968.82 4385,-2968.82 3975,-2968.82 3975,-2968.82 3969,-2968.82 3963,-2962.82 3963,-2956.82 3963,-2956.82 3963,-2535.08 3963,-2535.08 3963,-2529.08 3969,-2523.08 3975,-2523.08"/>
<text text-anchor="middle" x="4180" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4180" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 60&#45;63</text>
</g>
<g id="clust34" class="cluster">
<title>cluster_expert1_12</title>
<path fill="none" stroke="blue" d="M4847,-2523.08C4847,-2523.08 5257,-2523.08 5257,-2523.08 5263,-2523.08 5269,-2529.08 5269,-2535.08 5269,-2535.08 5269,-2956.82 5269,-2956.82 5269,-2962.82 5263,-2968.82 5257,-2968.82 5257,-2968.82 4847,-2968.82 4847,-2968.82 4841,-2968.82 4835,-2962.82 4835,-2956.82 4835,-2956.82 4835,-2535.08 4835,-2535.08 4835,-2529.08 4841,-2523.08 4847,-2523.08"/>
<text text-anchor="middle" x="5052" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5052" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 64&#45;67</text>
</g>
<g id="clust35" class="cluster">
<title>cluster_expert1_13</title>
<path fill="none" stroke="blue" d="M6149,-2523.08C6149,-2523.08 6559,-2523.08 6559,-2523.08 6565,-2523.08 6571,-2529.08 6571,-2535.08 6571,-2535.08 6571,-2956.82 6571,-2956.82 6571,-2962.82 6565,-2968.82 6559,-2968.82 6559,-2968.82 6149,-2968.82 6149,-2968.82 6143,-2968.82 6137,-2962.82 6137,-2956.82 6137,-2956.82 6137,-2535.08 6137,-2535.08 6137,-2529.08 6143,-2523.08 6149,-2523.08"/>
<text text-anchor="middle" x="6354" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6354" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 68&#45;71</text>
</g>
<g id="clust36" class="cluster">
<title>cluster_expert1_14</title>
<path fill="none" stroke="blue" d="M7021,-2523.08C7021,-2523.08 7431,-2523.08 7431,-2523.08 7437,-2523.08 7443,-2529.08 7443,-2535.08 7443,-2535.08 7443,-2956.82 7443,-2956.82 7443,-2962.82 7437,-2968.82 7431,-2968.82 7431,-2968.82 7021,-2968.82 7021,-2968.82 7015,-2968.82 7009,-2962.82 7009,-2956.82 7009,-2956.82 7009,-2535.08 7009,-2535.08 7009,-2529.08 7015,-2523.08 7021,-2523.08"/>
<text text-anchor="middle" x="7226" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7226" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 72&#45;75</text>
</g>
<g id="clust37" class="cluster">
<title>cluster_expert1_15</title>
<path fill="none" stroke="blue" d="M7463,-2523.08C7463,-2523.08 7873,-2523.08 7873,-2523.08 7879,-2523.08 7885,-2529.08 7885,-2535.08 7885,-2535.08 7885,-2956.82 7885,-2956.82 7885,-2962.82 7879,-2968.82 7873,-2968.82 7873,-2968.82 7463,-2968.82 7463,-2968.82 7457,-2968.82 7451,-2962.82 7451,-2956.82 7451,-2956.82 7451,-2535.08 7451,-2535.08 7451,-2529.08 7457,-2523.08 7463,-2523.08"/>
<text text-anchor="middle" x="7668" y="-2953.62" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="7668" y="-2938.62" font-family="Times,serif" font-size="14.00">GPUs 76&#45;79</text>
</g>
<g id="clust38" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="blue" d="M1281,-1201.34C1281,-1201.34 8229,-1201.34 8229,-1201.34 8235,-1201.34 8241,-1207.34 8241,-1213.34 8241,-1213.34 8241,-2266.08 8241,-2266.08 8241,-2272.08 8235,-2278.08 8229,-2278.08 8229,-2278.08 1281,-2278.08 1281,-2278.08 1275,-2278.08 1269,-2272.08 1269,-2266.08 1269,-2266.08 1269,-1213.34 1269,-1213.34 1269,-1207.34 1275,-1201.34 1281,-1201.34"/>
<text text-anchor="middle" x="4755" y="-2262.88" font-family="Times,serif" font-size="14.00">Layer 2 &#45; EP=16 (64 GPUs)</text>
</g>
<g id="clust39" class="cluster">
<title>cluster_layer2_mha</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="4944,-1902.08 4944,-2247.08 5226,-2247.08 5226,-1902.08 4944,-1902.08"/>
<text text-anchor="middle" x="5085" y="-2231.88" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5085" y="-2216.88" font-family="Times,serif" font-size="14.00">TP across selected GPUs</text>
</g>
<g id="clust40" class="cluster">
<title>cluster_expert2_0</title>
<path fill="none" stroke="blue" d="M3881,-1427.34C3881,-1427.34 4279,-1427.34 4279,-1427.34 4285,-1427.34 4291,-1433.34 4291,-1439.34 4291,-1439.34 4291,-1861.08 4291,-1861.08 4291,-1867.08 4285,-1873.08 4279,-1873.08 4279,-1873.08 3881,-1873.08 3881,-1873.08 3875,-1873.08 3869,-1867.08 3869,-1861.08 3869,-1861.08 3869,-1439.34 3869,-1439.34 3869,-1433.34 3875,-1427.34 3881,-1427.34"/>
<text text-anchor="middle" x="4080" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4080" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 32&#45;35</text>
</g>
<g id="clust41" class="cluster">
<title>cluster_expert2_1</title>
<path fill="none" stroke="blue" d="M5625,-1427.34C5625,-1427.34 6023,-1427.34 6023,-1427.34 6029,-1427.34 6035,-1433.34 6035,-1439.34 6035,-1439.34 6035,-1861.08 6035,-1861.08 6035,-1867.08 6029,-1873.08 6023,-1873.08 6023,-1873.08 5625,-1873.08 5625,-1873.08 5619,-1873.08 5613,-1867.08 5613,-1861.08 5613,-1861.08 5613,-1439.34 5613,-1439.34 5613,-1433.34 5619,-1427.34 5625,-1427.34"/>
<text text-anchor="middle" x="5824" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5824" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 36&#45;39</text>
</g>
<g id="clust42" class="cluster">
<title>cluster_expert2_2</title>
<path fill="none" stroke="blue" d="M3451,-1427.34C3451,-1427.34 3849,-1427.34 3849,-1427.34 3855,-1427.34 3861,-1433.34 3861,-1439.34 3861,-1439.34 3861,-1861.08 3861,-1861.08 3861,-1867.08 3855,-1873.08 3849,-1873.08 3849,-1873.08 3451,-1873.08 3451,-1873.08 3445,-1873.08 3439,-1867.08 3439,-1861.08 3439,-1861.08 3439,-1439.34 3439,-1439.34 3439,-1433.34 3445,-1427.34 3451,-1427.34"/>
<text text-anchor="middle" x="3650" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3650" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 40&#45;43</text>
</g>
<g id="clust43" class="cluster">
<title>cluster_expert2_3</title>
<path fill="none" stroke="blue" d="M1289,-1427.34C1289,-1427.34 1687,-1427.34 1687,-1427.34 1693,-1427.34 1699,-1433.34 1699,-1439.34 1699,-1439.34 1699,-1861.08 1699,-1861.08 1699,-1867.08 1693,-1873.08 1687,-1873.08 1687,-1873.08 1289,-1873.08 1289,-1873.08 1283,-1873.08 1277,-1867.08 1277,-1861.08 1277,-1861.08 1277,-1439.34 1277,-1439.34 1277,-1433.34 1283,-1427.34 1289,-1427.34"/>
<text text-anchor="middle" x="1488" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1488" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 44&#45;47</text>
</g>
<g id="clust44" class="cluster">
<title>cluster_expert2_4</title>
<path fill="none" stroke="blue" d="M4753,-1427.34C4753,-1427.34 5151,-1427.34 5151,-1427.34 5157,-1427.34 5163,-1433.34 5163,-1439.34 5163,-1439.34 5163,-1861.08 5163,-1861.08 5163,-1867.08 5157,-1873.08 5151,-1873.08 5151,-1873.08 4753,-1873.08 4753,-1873.08 4747,-1873.08 4741,-1867.08 4741,-1861.08 4741,-1861.08 4741,-1439.34 4741,-1439.34 4741,-1433.34 4747,-1427.34 4753,-1427.34"/>
<text text-anchor="middle" x="4952" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4952" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 48&#45;51</text>
</g>
<g id="clust45" class="cluster">
<title>cluster_expert2_5</title>
<path fill="none" stroke="blue" d="M2579,-1427.34C2579,-1427.34 2977,-1427.34 2977,-1427.34 2983,-1427.34 2989,-1433.34 2989,-1439.34 2989,-1439.34 2989,-1861.08 2989,-1861.08 2989,-1867.08 2983,-1873.08 2977,-1873.08 2977,-1873.08 2579,-1873.08 2579,-1873.08 2573,-1873.08 2567,-1867.08 2567,-1861.08 2567,-1861.08 2567,-1439.34 2567,-1439.34 2567,-1433.34 2573,-1427.34 2579,-1427.34"/>
<text text-anchor="middle" x="2778" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2778" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 52&#45;55</text>
</g>
<g id="clust46" class="cluster">
<title>cluster_expert2_6</title>
<path fill="none" stroke="blue" d="M6055,-1427.34C6055,-1427.34 6453,-1427.34 6453,-1427.34 6459,-1427.34 6465,-1433.34 6465,-1439.34 6465,-1439.34 6465,-1861.08 6465,-1861.08 6465,-1867.08 6459,-1873.08 6453,-1873.08 6453,-1873.08 6055,-1873.08 6055,-1873.08 6049,-1873.08 6043,-1867.08 6043,-1861.08 6043,-1861.08 6043,-1439.34 6043,-1439.34 6043,-1433.34 6049,-1427.34 6055,-1427.34"/>
<text text-anchor="middle" x="6254" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6254" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 56&#45;59</text>
</g>
<g id="clust47" class="cluster">
<title>cluster_expert2_7</title>
<path fill="none" stroke="blue" d="M1719,-1427.34C1719,-1427.34 2117,-1427.34 2117,-1427.34 2123,-1427.34 2129,-1433.34 2129,-1439.34 2129,-1439.34 2129,-1861.08 2129,-1861.08 2129,-1867.08 2123,-1873.08 2117,-1873.08 2117,-1873.08 1719,-1873.08 1719,-1873.08 1713,-1873.08 1707,-1867.08 1707,-1861.08 1707,-1861.08 1707,-1439.34 1707,-1439.34 1707,-1433.34 1713,-1427.34 1719,-1427.34"/>
<text text-anchor="middle" x="1918" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="1918" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 60&#45;63</text>
</g>
<g id="clust48" class="cluster">
<title>cluster_expert2_8</title>
<path fill="none" stroke="blue" d="M6927,-1427.34C6927,-1427.34 7325,-1427.34 7325,-1427.34 7331,-1427.34 7337,-1433.34 7337,-1439.34 7337,-1439.34 7337,-1861.08 7337,-1861.08 7337,-1867.08 7331,-1873.08 7325,-1873.08 7325,-1873.08 6927,-1873.08 6927,-1873.08 6921,-1873.08 6915,-1867.08 6915,-1861.08 6915,-1861.08 6915,-1439.34 6915,-1439.34 6915,-1433.34 6921,-1427.34 6927,-1427.34"/>
<text text-anchor="middle" x="7126" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7126" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 64&#45;67</text>
</g>
<g id="clust49" class="cluster">
<title>cluster_expert2_9</title>
<path fill="none" stroke="blue" d="M2149,-1427.34C2149,-1427.34 2547,-1427.34 2547,-1427.34 2553,-1427.34 2559,-1433.34 2559,-1439.34 2559,-1439.34 2559,-1861.08 2559,-1861.08 2559,-1867.08 2553,-1873.08 2547,-1873.08 2547,-1873.08 2149,-1873.08 2149,-1873.08 2143,-1873.08 2137,-1867.08 2137,-1861.08 2137,-1861.08 2137,-1439.34 2137,-1439.34 2137,-1433.34 2143,-1427.34 2149,-1427.34"/>
<text text-anchor="middle" x="2348" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2348" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 68&#45;71</text>
</g>
<g id="clust50" class="cluster">
<title>cluster_expert2_10</title>
<path fill="none" stroke="blue" d="M3009,-1427.34C3009,-1427.34 3419,-1427.34 3419,-1427.34 3425,-1427.34 3431,-1433.34 3431,-1439.34 3431,-1439.34 3431,-1861.08 3431,-1861.08 3431,-1867.08 3425,-1873.08 3419,-1873.08 3419,-1873.08 3009,-1873.08 3009,-1873.08 3003,-1873.08 2997,-1867.08 2997,-1861.08 2997,-1861.08 2997,-1439.34 2997,-1439.34 2997,-1433.34 3003,-1427.34 3009,-1427.34"/>
<text text-anchor="middle" x="3214" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3214" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 72&#45;75</text>
</g>
<g id="clust51" class="cluster">
<title>cluster_expert2_11</title>
<path fill="none" stroke="blue" d="M4311,-1427.34C4311,-1427.34 4721,-1427.34 4721,-1427.34 4727,-1427.34 4733,-1433.34 4733,-1439.34 4733,-1439.34 4733,-1861.08 4733,-1861.08 4733,-1867.08 4727,-1873.08 4721,-1873.08 4721,-1873.08 4311,-1873.08 4311,-1873.08 4305,-1873.08 4299,-1867.08 4299,-1861.08 4299,-1861.08 4299,-1439.34 4299,-1439.34 4299,-1433.34 4305,-1427.34 4311,-1427.34"/>
<text text-anchor="middle" x="4516" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4516" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 76&#45;79</text>
</g>
<g id="clust52" class="cluster">
<title>cluster_expert2_12</title>
<path fill="none" stroke="blue" d="M5183,-1427.34C5183,-1427.34 5593,-1427.34 5593,-1427.34 5599,-1427.34 5605,-1433.34 5605,-1439.34 5605,-1439.34 5605,-1861.08 5605,-1861.08 5605,-1867.08 5599,-1873.08 5593,-1873.08 5593,-1873.08 5183,-1873.08 5183,-1873.08 5177,-1873.08 5171,-1867.08 5171,-1861.08 5171,-1861.08 5171,-1439.34 5171,-1439.34 5171,-1433.34 5177,-1427.34 5183,-1427.34"/>
<text text-anchor="middle" x="5388" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5388" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 80&#45;83</text>
</g>
<g id="clust53" class="cluster">
<title>cluster_expert2_13</title>
<path fill="none" stroke="blue" d="M6485,-1427.34C6485,-1427.34 6895,-1427.34 6895,-1427.34 6901,-1427.34 6907,-1433.34 6907,-1439.34 6907,-1439.34 6907,-1861.08 6907,-1861.08 6907,-1867.08 6901,-1873.08 6895,-1873.08 6895,-1873.08 6485,-1873.08 6485,-1873.08 6479,-1873.08 6473,-1867.08 6473,-1861.08 6473,-1861.08 6473,-1439.34 6473,-1439.34 6473,-1433.34 6479,-1427.34 6485,-1427.34"/>
<text text-anchor="middle" x="6690" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6690" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 84&#45;87</text>
</g>
<g id="clust54" class="cluster">
<title>cluster_expert2_14</title>
<path fill="none" stroke="blue" d="M7357,-1427.34C7357,-1427.34 7767,-1427.34 7767,-1427.34 7773,-1427.34 7779,-1433.34 7779,-1439.34 7779,-1439.34 7779,-1861.08 7779,-1861.08 7779,-1867.08 7773,-1873.08 7767,-1873.08 7767,-1873.08 7357,-1873.08 7357,-1873.08 7351,-1873.08 7345,-1867.08 7345,-1861.08 7345,-1861.08 7345,-1439.34 7345,-1439.34 7345,-1433.34 7351,-1427.34 7357,-1427.34"/>
<text text-anchor="middle" x="7562" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7562" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 88&#45;91</text>
</g>
<g id="clust55" class="cluster">
<title>cluster_expert2_15</title>
<path fill="none" stroke="blue" d="M7799,-1427.34C7799,-1427.34 8209,-1427.34 8209,-1427.34 8215,-1427.34 8221,-1433.34 8221,-1439.34 8221,-1439.34 8221,-1861.08 8221,-1861.08 8221,-1867.08 8215,-1873.08 8209,-1873.08 8209,-1873.08 7799,-1873.08 7799,-1873.08 7793,-1873.08 7787,-1867.08 7787,-1861.08 7787,-1861.08 7787,-1439.34 7787,-1439.34 7787,-1433.34 7793,-1427.34 7799,-1427.34"/>
<text text-anchor="middle" x="8004" y="-1857.88" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="8004" y="-1842.88" font-family="Times,serif" font-size="14.00">GPUs 92&#45;95</text>
</g>
<g id="clust56" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="blue" d="M1463,-105.6C1463,-105.6 8432,-105.6 8432,-105.6 8438,-105.6 8444,-111.6 8444,-117.6 8444,-117.6 8444,-1170.34 8444,-1170.34 8444,-1176.34 8438,-1182.34 8432,-1182.34 8432,-1182.34 1463,-1182.34 1463,-1182.34 1457,-1182.34 1451,-1176.34 1451,-1170.34 1451,-1170.34 1451,-117.6 1451,-117.6 1451,-111.6 1457,-105.6 1463,-105.6"/>
<text text-anchor="middle" x="4947.5" y="-1167.14" font-family="Times,serif" font-size="14.00">Layer 3 &#45; EP=16 (64 GPUs)</text>
</g>
<g id="clust57" class="cluster">
<title>cluster_layer3_mha</title>
<polygon fill="none" stroke="blue" stroke-dasharray="1,5" points="5126,-806.34 5126,-1151.34 5408,-1151.34 5408,-806.34 5126,-806.34"/>
<text text-anchor="middle" x="5267" y="-1136.14" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="5267" y="-1121.14" font-family="Times,serif" font-size="14.00">TP across selected GPUs</text>
</g>
<g id="clust58" class="cluster">
<title>cluster_expert3_0</title>
<path fill="none" stroke="blue" d="M4063,-331.6C4063,-331.6 4461,-331.6 4461,-331.6 4467,-331.6 4473,-337.6 4473,-343.6 4473,-343.6 4473,-765.34 4473,-765.34 4473,-771.34 4467,-777.34 4461,-777.34 4461,-777.34 4063,-777.34 4063,-777.34 4057,-777.34 4051,-771.34 4051,-765.34 4051,-765.34 4051,-343.6 4051,-343.6 4051,-337.6 4057,-331.6 4063,-331.6"/>
<text text-anchor="middle" x="4262" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4262" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 48&#45;51</text>
</g>
<g id="clust59" class="cluster">
<title>cluster_expert3_1</title>
<path fill="none" stroke="blue" d="M5807,-331.6C5807,-331.6 6205,-331.6 6205,-331.6 6211,-331.6 6217,-337.6 6217,-343.6 6217,-343.6 6217,-765.34 6217,-765.34 6217,-771.34 6211,-777.34 6205,-777.34 6205,-777.34 5807,-777.34 5807,-777.34 5801,-777.34 5795,-771.34 5795,-765.34 5795,-765.34 5795,-343.6 5795,-343.6 5795,-337.6 5801,-331.6 5807,-331.6"/>
<text text-anchor="middle" x="6006" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6006" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 52&#45;55</text>
</g>
<g id="clust60" class="cluster">
<title>cluster_expert3_2</title>
<path fill="none" stroke="blue" d="M3633,-331.6C3633,-331.6 4031,-331.6 4031,-331.6 4037,-331.6 4043,-337.6 4043,-343.6 4043,-343.6 4043,-765.34 4043,-765.34 4043,-771.34 4037,-777.34 4031,-777.34 4031,-777.34 3633,-777.34 3633,-777.34 3627,-777.34 3621,-771.34 3621,-765.34 3621,-765.34 3621,-343.6 3621,-343.6 3621,-337.6 3627,-331.6 3633,-331.6"/>
<text text-anchor="middle" x="3832" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3832" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 56&#45;59</text>
</g>
<g id="clust61" class="cluster">
<title>cluster_expert3_3</title>
<path fill="none" stroke="blue" d="M1471,-331.6C1471,-331.6 1869,-331.6 1869,-331.6 1875,-331.6 1881,-337.6 1881,-343.6 1881,-343.6 1881,-765.34 1881,-765.34 1881,-771.34 1875,-777.34 1869,-777.34 1869,-777.34 1471,-777.34 1471,-777.34 1465,-777.34 1459,-771.34 1459,-765.34 1459,-765.34 1459,-343.6 1459,-343.6 1459,-337.6 1465,-331.6 1471,-331.6"/>
<text text-anchor="middle" x="1670" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1670" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 60&#45;63</text>
</g>
<g id="clust62" class="cluster">
<title>cluster_expert3_4</title>
<path fill="none" stroke="blue" d="M4935,-331.6C4935,-331.6 5333,-331.6 5333,-331.6 5339,-331.6 5345,-337.6 5345,-343.6 5345,-343.6 5345,-765.34 5345,-765.34 5345,-771.34 5339,-777.34 5333,-777.34 5333,-777.34 4935,-777.34 4935,-777.34 4929,-777.34 4923,-771.34 4923,-765.34 4923,-765.34 4923,-343.6 4923,-343.6 4923,-337.6 4929,-331.6 4935,-331.6"/>
<text text-anchor="middle" x="5134" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="5134" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 64&#45;67</text>
</g>
<g id="clust63" class="cluster">
<title>cluster_expert3_5</title>
<path fill="none" stroke="blue" d="M2761,-331.6C2761,-331.6 3159,-331.6 3159,-331.6 3165,-331.6 3171,-337.6 3171,-343.6 3171,-343.6 3171,-765.34 3171,-765.34 3171,-771.34 3165,-777.34 3159,-777.34 3159,-777.34 2761,-777.34 2761,-777.34 2755,-777.34 2749,-771.34 2749,-765.34 2749,-765.34 2749,-343.6 2749,-343.6 2749,-337.6 2755,-331.6 2761,-331.6"/>
<text text-anchor="middle" x="2960" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="2960" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 68&#45;71</text>
</g>
<g id="clust64" class="cluster">
<title>cluster_expert3_6</title>
<path fill="none" stroke="blue" d="M6237,-331.6C6237,-331.6 6635,-331.6 6635,-331.6 6641,-331.6 6647,-337.6 6647,-343.6 6647,-343.6 6647,-765.34 6647,-765.34 6647,-771.34 6641,-777.34 6635,-777.34 6635,-777.34 6237,-777.34 6237,-777.34 6231,-777.34 6225,-771.34 6225,-765.34 6225,-765.34 6225,-343.6 6225,-343.6 6225,-337.6 6231,-331.6 6237,-331.6"/>
<text text-anchor="middle" x="6436" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="6436" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 72&#45;75</text>
</g>
<g id="clust65" class="cluster">
<title>cluster_expert3_7</title>
<path fill="none" stroke="blue" d="M1901,-331.6C1901,-331.6 2299,-331.6 2299,-331.6 2305,-331.6 2311,-337.6 2311,-343.6 2311,-343.6 2311,-765.34 2311,-765.34 2311,-771.34 2305,-777.34 2299,-777.34 2299,-777.34 1901,-777.34 1901,-777.34 1895,-777.34 1889,-771.34 1889,-765.34 1889,-765.34 1889,-343.6 1889,-343.6 1889,-337.6 1895,-331.6 1901,-331.6"/>
<text text-anchor="middle" x="2100" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2100" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 76&#45;79</text>
</g>
<g id="clust66" class="cluster">
<title>cluster_expert3_8</title>
<path fill="none" stroke="blue" d="M7116,-331.6C7116,-331.6 7514,-331.6 7514,-331.6 7520,-331.6 7526,-337.6 7526,-343.6 7526,-343.6 7526,-765.34 7526,-765.34 7526,-771.34 7520,-777.34 7514,-777.34 7514,-777.34 7116,-777.34 7116,-777.34 7110,-777.34 7104,-771.34 7104,-765.34 7104,-765.34 7104,-343.6 7104,-343.6 7104,-337.6 7110,-331.6 7116,-331.6"/>
<text text-anchor="middle" x="7315" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="7315" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 80&#45;83</text>
</g>
<g id="clust67" class="cluster">
<title>cluster_expert3_9</title>
<path fill="none" stroke="blue" d="M2331,-331.6C2331,-331.6 2729,-331.6 2729,-331.6 2735,-331.6 2741,-337.6 2741,-343.6 2741,-343.6 2741,-765.34 2741,-765.34 2741,-771.34 2735,-777.34 2729,-777.34 2729,-777.34 2331,-777.34 2331,-777.34 2325,-777.34 2319,-771.34 2319,-765.34 2319,-765.34 2319,-343.6 2319,-343.6 2319,-337.6 2325,-331.6 2331,-331.6"/>
<text text-anchor="middle" x="2530" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="2530" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 84&#45;87</text>
</g>
<g id="clust68" class="cluster">
<title>cluster_expert3_10</title>
<path fill="none" stroke="blue" d="M3191,-331.6C3191,-331.6 3601,-331.6 3601,-331.6 3607,-331.6 3613,-337.6 3613,-343.6 3613,-343.6 3613,-765.34 3613,-765.34 3613,-771.34 3607,-777.34 3601,-777.34 3601,-777.34 3191,-777.34 3191,-777.34 3185,-777.34 3179,-771.34 3179,-765.34 3179,-765.34 3179,-343.6 3179,-343.6 3179,-337.6 3185,-331.6 3191,-331.6"/>
<text text-anchor="middle" x="3396" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3396" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 88&#45;91</text>
</g>
<g id="clust69" class="cluster">
<title>cluster_expert3_11</title>
<path fill="none" stroke="blue" d="M4493,-331.6C4493,-331.6 4903,-331.6 4903,-331.6 4909,-331.6 4915,-337.6 4915,-343.6 4915,-343.6 4915,-765.34 4915,-765.34 4915,-771.34 4909,-777.34 4903,-777.34 4903,-777.34 4493,-777.34 4493,-777.34 4487,-777.34 4481,-771.34 4481,-765.34 4481,-765.34 4481,-343.6 4481,-343.6 4481,-337.6 4487,-331.6 4493,-331.6"/>
<text text-anchor="middle" x="4698" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="4698" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 92&#45;95</text>
</g>
<g id="clust70" class="cluster">
<title>cluster_expert3_12</title>
<path fill="none" stroke="blue" d="M5365,-331.6C5365,-331.6 5775,-331.6 5775,-331.6 5781,-331.6 5787,-337.6 5787,-343.6 5787,-343.6 5787,-765.34 5787,-765.34 5787,-771.34 5781,-777.34 5775,-777.34 5775,-777.34 5365,-777.34 5365,-777.34 5359,-777.34 5353,-771.34 5353,-765.34 5353,-765.34 5353,-343.6 5353,-343.6 5353,-337.6 5359,-331.6 5365,-331.6"/>
<text text-anchor="middle" x="5570" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="5570" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 96&#45;99</text>
</g>
<g id="clust71" class="cluster">
<title>cluster_expert3_13</title>
<path fill="none" stroke="blue" d="M6667,-331.6C6667,-331.6 7084,-331.6 7084,-331.6 7090,-331.6 7096,-337.6 7096,-343.6 7096,-343.6 7096,-765.34 7096,-765.34 7096,-771.34 7090,-777.34 7084,-777.34 7084,-777.34 6667,-777.34 6667,-777.34 6661,-777.34 6655,-771.34 6655,-765.34 6655,-765.34 6655,-343.6 6655,-343.6 6655,-337.6 6661,-331.6 6667,-331.6"/>
<text text-anchor="middle" x="6875.5" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6875.5" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 100&#45;103</text>
</g>
<g id="clust72" class="cluster">
<title>cluster_expert3_14</title>
<path fill="none" stroke="blue" d="M7546,-331.6C7546,-331.6 7963,-331.6 7963,-331.6 7969,-331.6 7975,-337.6 7975,-343.6 7975,-343.6 7975,-765.34 7975,-765.34 7975,-771.34 7969,-777.34 7963,-777.34 7963,-777.34 7546,-777.34 7546,-777.34 7540,-777.34 7534,-771.34 7534,-765.34 7534,-765.34 7534,-343.6 7534,-343.6 7534,-337.6 7540,-331.6 7546,-331.6"/>
<text text-anchor="middle" x="7754.5" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="7754.5" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 104&#45;107</text>
</g>
<g id="clust73" class="cluster">
<title>cluster_expert3_15</title>
<path fill="none" stroke="blue" d="M7995,-331.6C7995,-331.6 8412,-331.6 8412,-331.6 8418,-331.6 8424,-337.6 8424,-343.6 8424,-343.6 8424,-765.34 8424,-765.34 8424,-771.34 8418,-777.34 8412,-777.34 8412,-777.34 7995,-777.34 7995,-777.34 7989,-777.34 7983,-771.34 7983,-765.34 7983,-765.34 7983,-343.6 7983,-343.6 7983,-337.6 7989,-331.6 7995,-331.6"/>
<text text-anchor="middle" x="8203.5" y="-762.14" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="8203.5" y="-747.14" font-family="Times,serif" font-size="14.00">GPUs 108&#45;111</text>
</g>
<g id="clust74" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M6730,-8C6730,-8 6828,-8 6828,-8 6834,-8 6840,-14 6840,-20 6840,-20 6840,-74.6 6840,-74.6 6840,-80.6 6834,-86.6 6828,-86.6 6828,-86.6 6730,-86.6 6730,-86.6 6724,-86.6 6718,-80.6 6718,-74.6 6718,-74.6 6718,-20 6718,-20 6718,-14 6724,-8 6730,-8"/>
<text text-anchor="middle" x="6779" y="-71.4" font-family="Times,serif" font-size="14.00">Output</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="3854" cy="-4523.36" rx="48.17" ry="19.6"/>
<text text-anchor="middle" x="3854" y="-4526.16" font-family="Arial" font-size="9.00">Input Tokens</text>
<text text-anchor="middle" x="3854" y="-4516.16" font-family="Arial" font-size="9.00">[1024, 8192]</text>
</g>
<!-- l0_mha_qkv -->
<g id="node2" class="node">
<title>l0_mha_qkv</title>
<polygon fill="none" stroke="black" points="3858.5,-4399.56 3705.5,-4399.56 3705.5,-4361.56 3858.5,-4361.56 3858.5,-4399.56"/>
<text text-anchor="middle" x="3782" y="-4388.36" font-family="Arial" font-size="9.00">MHA QKV Linear</text>
<text text-anchor="middle" x="3782" y="-4378.36" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="3782" y="-4368.36" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_mha_qkv</title>
<path fill="none" stroke="black" d="M3844.44,-4503.66C3832.05,-4479.44 3810.36,-4437.01 3796.08,-4409.1"/>
<polygon fill="black" stroke="black" points="3799.04,-4407.2 3791.37,-4399.89 3792.81,-4410.38 3799.04,-4407.2"/>
</g>
<!-- l0_mha_res -->
<g id="node5" class="node">
<title>l0_mha_res</title>
<polygon fill="none" stroke="black" points="3948.91,-4164.56 3737.48,-4164.56 3683.09,-4108.56 3894.52,-4108.56 3948.91,-4164.56"/>
<text text-anchor="middle" x="3816" y="-4139.36" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="3816" y="-4129.36" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- input&#45;&gt;l0_mha_res -->
<g id="edge5" class="edge">
<title>input&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M3861.32,-4503.56C3871.05,-4476.86 3887,-4426.25 3887,-4381.56 3887,-4381.56 3887,-4381.56 3887,-4229.56 3887,-4207.54 3874.1,-4187.57 3859.29,-4171.91"/>
<polygon fill="black" stroke="black" points="3861.47,-4169.15 3851.92,-4164.58 3856.54,-4174.11 3861.47,-4169.15"/>
</g>
<!-- l0_mha_attn -->
<g id="node3" class="node">
<title>l0_mha_attn</title>
<polygon fill="none" stroke="black" points="3825.5,-4324.56 3742.5,-4324.56 3742.5,-4286.56 3825.5,-4286.56 3825.5,-4324.56"/>
<text text-anchor="middle" x="3784" y="-4313.36" font-family="Arial" font-size="9.00">MHA Attention</text>
<text text-anchor="middle" x="3784" y="-4303.36" font-family="Arial" font-size="9.00">[1024, 16×512]</text>
<text text-anchor="middle" x="3784" y="-4293.36" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l0_mha_qkv&#45;&gt;l0_mha_attn -->
<g id="edge2" class="edge">
<title>l0_mha_qkv&#45;&gt;l0_mha_attn</title>
<path fill="none" stroke="black" d="M3782.49,-4361.51C3782.72,-4353.44 3782.98,-4343.73 3783.23,-4334.74"/>
<polygon fill="black" stroke="black" points="3786.73,-4334.74 3783.5,-4324.65 3779.73,-4334.55 3786.73,-4334.74"/>
</g>
<!-- l0_mha_out -->
<g id="node4" class="node">
<title>l0_mha_out</title>
<polygon fill="none" stroke="black" points="3856,-4249.56 3724,-4249.56 3724,-4211.56 3856,-4211.56 3856,-4249.56"/>
<text text-anchor="middle" x="3790" y="-4238.36" font-family="Arial" font-size="9.00">MHA Output Linear</text>
<text text-anchor="middle" x="3790" y="-4228.36" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="3790" y="-4218.36" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l0_mha_attn&#45;&gt;l0_mha_out -->
<g id="edge3" class="edge">
<title>l0_mha_attn&#45;&gt;l0_mha_out</title>
<path fill="none" stroke="black" d="M3785.48,-4286.51C3786.15,-4278.44 3786.94,-4268.73 3787.68,-4259.74"/>
<polygon fill="black" stroke="black" points="3791.18,-4259.9 3788.51,-4249.65 3784.21,-4259.33 3791.18,-4259.9"/>
</g>
<!-- l0_mha_out&#45;&gt;l0_mha_res -->
<g id="edge4" class="edge">
<title>l0_mha_out&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M3795.14,-4211.38C3798.1,-4200.89 3801.94,-4187.3 3805.52,-4174.64"/>
<polygon fill="black" stroke="black" points="3808.96,-4175.35 3808.31,-4164.77 3802.22,-4173.44 3808.96,-4175.35"/>
</g>
<!-- l0_global_gate -->
<g id="node6" class="node">
<title>l0_global_gate</title>
<polygon fill="none" stroke="black" points="3647.47,-4174.56 3446.29,-4174.56 3394.53,-4098.56 3595.71,-4098.56 3647.47,-4174.56"/>
<text text-anchor="middle" x="3521" y="-4144.36" font-family="Arial" font-size="9.00">Global Gate</text>
<text text-anchor="middle" x="3521" y="-4134.36" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3521" y="-4124.36" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_global_gate -->
<g id="edge6" class="edge">
<title>l0_mha_res&#45;&gt;l0_global_gate</title>
<path fill="none" stroke="black" d="M3710.19,-4136.56C3684.08,-4136.56 3657.96,-4136.56 3631.84,-4136.56"/>
<polygon fill="black" stroke="black" points="3631.83,-4133.06 3621.83,-4136.56 3631.83,-4140.06 3631.83,-4133.06"/>
</g>
<!-- l0_gather_0 -->
<g id="node8" class="node">
<title>l0_gather_0</title>
<ellipse fill="none" stroke="black" cx="2946" cy="-3980.56" rx="67.76" ry="26.74"/>
<text text-anchor="middle" x="2946" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2946" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2946" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 0</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_0 -->
<g id="edge8" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_0</title>
<path fill="none" stroke="black" d="M3722.42,-4108.54C3707.96,-4104.87 3693.13,-4101.4 3679,-4098.56 3619.65,-4086.64 3599.67,-4104.33 3544,-4080.56 3538.77,-4078.32 3539.36,-4074.48 3534,-4072.56 3507.44,-4063.01 3051.89,-4075.8 3026,-4064.56 3002.28,-4054.26 2982.13,-4033.21 2967.98,-4014.89"/>
<polygon fill="black" stroke="black" points="2970.68,-4012.66 2961.91,-4006.71 2965.06,-4016.83 2970.68,-4012.66"/>
<text text-anchor="middle" x="3555" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_1 -->
<g id="node14" class="node">
<title>l0_gather_1</title>
<ellipse fill="none" stroke="black" cx="4686" cy="-3980.56" rx="67.76" ry="26.74"/>
<text text-anchor="middle" x="4686" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4686" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4686" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 4</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_1 -->
<g id="edge15" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_1</title>
<path fill="none" stroke="black" d="M3920.9,-4135.47C4098.58,-4134.06 4450.61,-4125.46 4565,-4080.56 4570.3,-4078.48 4569.88,-4075.05 4575,-4072.56 4588.96,-4065.77 4595.58,-4072.37 4609,-4064.56 4630.17,-4052.24 4648.97,-4032.25 4662.7,-4014.97"/>
<polygon fill="black" stroke="black" points="4665.7,-4016.82 4669.02,-4006.76 4660.15,-4012.55 4665.7,-4016.82"/>
<text text-anchor="middle" x="4586" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_2 -->
<g id="node20" class="node">
<title>l0_gather_2</title>
<ellipse fill="none" stroke="black" cx="2520" cy="-3980.56" rx="67.76" ry="26.74"/>
<text text-anchor="middle" x="2520" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2520" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2520" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 8</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_2 -->
<g id="edge22" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_2</title>
<path fill="none" stroke="black" d="M3725.54,-4108.47C3710.12,-4104.62 3694.18,-4101.11 3679,-4098.56 3622.1,-4088.99 3473.75,-4101.53 3420,-4080.56 3414.7,-4078.49 3415.36,-4074.47 3410,-4072.56 3367.61,-4057.45 2641.33,-4082.37 2600,-4064.56 2576.25,-4054.33 2556.1,-4033.28 2541.96,-4014.94"/>
<polygon fill="black" stroke="black" points="2544.66,-4012.7 2535.89,-4006.75 2539.03,-4016.87 2544.66,-4012.7"/>
<text text-anchor="middle" x="3431" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_3 -->
<g id="node26" class="node">
<title>l0_gather_3</title>
<ellipse fill="none" stroke="black" cx="360" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="360" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="360" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="360" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 12</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_3 -->
<g id="edge29" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_3</title>
<path fill="none" stroke="black" d="M3728.98,-4108.51C3712.53,-4104.41 3695.35,-4100.81 3679,-4098.56 3572.44,-4083.92 1844.33,-4116.63 1743,-4080.56 1737.64,-4078.65 1738.36,-4074.46 1733,-4072.56 1699.2,-4060.58 475.05,-4078.48 442,-4064.56 417.88,-4054.39 397.22,-4033.35 382.67,-4014.99"/>
<polygon fill="black" stroke="black" points="385.27,-4012.63 376.42,-4006.79 379.7,-4016.87 385.27,-4012.63"/>
<text text-anchor="middle" x="1754" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_4 -->
<g id="node32" class="node">
<title>l0_gather_4</title>
<ellipse fill="none" stroke="black" cx="3816" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3816" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3816" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3816" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 16</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_4 -->
<g id="edge36" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_4</title>
<path fill="none" stroke="black" d="M3808.85,-4108.33C3806.86,-4099.53 3804.98,-4089.69 3804,-4080.56 3801.74,-4059.64 3804.33,-4036.28 3807.68,-4017.51"/>
<polygon fill="black" stroke="black" points="3811.13,-4018.07 3809.58,-4007.59 3804.26,-4016.75 3811.13,-4018.07"/>
<text text-anchor="middle" x="3815" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_5 -->
<g id="node38" class="node">
<title>l0_gather_5</title>
<ellipse fill="none" stroke="black" cx="1650" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1650" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1650" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1650" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 20</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_5 -->
<g id="edge43" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_5</title>
<path fill="none" stroke="black" d="M3727.46,-4108.48C3711.46,-4104.5 3694.84,-4100.94 3679,-4098.56 3622.38,-4090.04 3217.69,-4100.45 3164,-4080.56 3158.66,-4078.58 3159.37,-4074.46 3154,-4072.56 3116.76,-4059.38 1768.4,-4079.89 1732,-4064.56 1707.88,-4054.4 1687.22,-4033.35 1672.67,-4015"/>
<polygon fill="black" stroke="black" points="1675.27,-4012.63 1666.42,-4006.8 1669.7,-4016.87 1675.27,-4012.63"/>
<text text-anchor="middle" x="3175" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_6 -->
<g id="node44" class="node">
<title>l0_gather_6</title>
<ellipse fill="none" stroke="black" cx="5114" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5114" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5114" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5114" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 24</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_6 -->
<g id="edge50" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_6</title>
<path fill="none" stroke="black" d="M3919.65,-4134.36C4188,-4130.73 4891.44,-4117.74 4990,-4080.56 4995.33,-4078.55 4994.87,-4075.03 5000,-4072.56 5014.37,-4065.62 5021.13,-4072.45 5035,-4064.56 5056.54,-4052.3 5075.83,-4032.31 5089.96,-4015.02"/>
<polygon fill="black" stroke="black" points="5093,-4016.81 5096.46,-4006.79 5087.51,-4012.46 5093,-4016.81"/>
<text text-anchor="middle" x="5011" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_7 -->
<g id="node50" class="node">
<title>l0_gather_7</title>
<ellipse fill="none" stroke="black" cx="790" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="790" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="790" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="790" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 28</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_7 -->
<g id="edge57" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_7</title>
<path fill="none" stroke="black" d="M3728.6,-4108.54C3712.26,-4104.46 3695.22,-4100.86 3679,-4098.56 3624.48,-4090.82 2739.79,-4099.26 2688,-4080.56 2682.65,-4078.63 2683.37,-4074.45 2678,-4072.56 2630.7,-4055.85 918.25,-4084 872,-4064.56 847.87,-4054.42 827.21,-4033.37 812.66,-4015.01"/>
<polygon fill="black" stroke="black" points="815.26,-4012.64 806.42,-4006.81 809.69,-4016.88 815.26,-4012.64"/>
<text text-anchor="middle" x="2699" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_8 -->
<g id="node56" class="node">
<title>l0_gather_8</title>
<ellipse fill="none" stroke="black" cx="5986" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5986" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5986" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5986" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 32</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_8 -->
<g id="edge64" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_8</title>
<path fill="none" stroke="black" d="M3920.06,-4134.59C4323.6,-4130.62 5767.34,-4114.1 5859,-4080.56 5864.34,-4078.6 5863.85,-4074.99 5869,-4072.56 5884.61,-4065.19 5891.93,-4072.97 5907,-4064.56 5928.65,-4052.48 5947.94,-4032.5 5962.04,-4015.16"/>
<polygon fill="black" stroke="black" points="5965.1,-4016.94 5968.53,-4006.91 5959.6,-4012.61 5965.1,-4016.94"/>
<text text-anchor="middle" x="5880" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_9 -->
<g id="node62" class="node">
<title>l0_gather_9</title>
<ellipse fill="none" stroke="black" cx="1220" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1220" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1220" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1220" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 36</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_9 -->
<g id="edge71" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_9</title>
<path fill="none" stroke="black" d="M3727.84,-4108.47C3711.73,-4104.46 3694.97,-4100.9 3679,-4098.56 3605.42,-4087.79 3079.83,-4106.11 3010,-4080.56 3004.66,-4078.6 3005.37,-4074.46 3000,-4072.56 2955.53,-4056.84 1345.48,-4082.84 1302,-4064.56 1277.87,-4054.41 1257.21,-4033.36 1242.66,-4015"/>
<polygon fill="black" stroke="black" points="1245.26,-4012.64 1236.42,-4006.81 1239.69,-4016.88 1245.26,-4012.64"/>
<text text-anchor="middle" x="3021" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_10 -->
<g id="node68" class="node">
<title>l0_gather_10</title>
<ellipse fill="none" stroke="black" cx="2092" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2092" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2092" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2092" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 40</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_10 -->
<g id="edge78" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_10</title>
<path fill="none" stroke="black" d="M3726.69,-4108.47C3710.93,-4104.54 3694.58,-4101.01 3679,-4098.56 3596.8,-4085.64 3382.83,-4109.98 3305,-4080.56 3299.68,-4078.55 3300.36,-4074.46 3295,-4072.56 3265.65,-4062.15 2202.69,-4076.66 2174,-4064.56 2149.89,-4054.38 2129.22,-4033.33 2114.67,-4014.98"/>
<polygon fill="black" stroke="black" points="2117.27,-4012.62 2108.43,-4006.79 2111.71,-4016.86 2117.27,-4012.62"/>
<text text-anchor="middle" x="3316" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_11 -->
<g id="node74" class="node">
<title>l0_gather_11</title>
<ellipse fill="none" stroke="black" cx="3386" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3386" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3386" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3386" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 44</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_11 -->
<g id="edge85" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_11</title>
<path fill="none" stroke="black" d="M3729,-4108.49C3708.42,-4100.67 3686.96,-4091.3 3668,-4080.56 3663.05,-4077.75 3663.33,-4074.55 3658,-4072.56 3618.43,-4057.73 3506.64,-4081.67 3468,-4064.56 3444.23,-4054.03 3423.68,-4033.2 3409.1,-4015.04"/>
<polygon fill="black" stroke="black" points="3411.72,-4012.7 3402.83,-4006.93 3406.18,-4016.98 3411.72,-4012.7"/>
<text text-anchor="middle" x="3679" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_12 -->
<g id="node80" class="node">
<title>l0_gather_12</title>
<ellipse fill="none" stroke="black" cx="4258" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4258" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4258" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4258" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 48</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_12 -->
<g id="edge92" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_12</title>
<path fill="none" stroke="black" d="M3917.82,-4132.48C3986.99,-4127.2 4079.16,-4113.8 4154,-4080.56 4159.2,-4078.25 4159.25,-4075.69 4164,-4072.56 4170.31,-4068.4 4172.99,-4069.13 4179,-4064.56 4198.19,-4049.97 4216.91,-4030.6 4231.31,-4014.24"/>
<polygon fill="black" stroke="black" points="4234.12,-4016.33 4238.02,-4006.48 4228.83,-4011.76 4234.12,-4016.33"/>
<text text-anchor="middle" x="4175" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_13 -->
<g id="node86" class="node">
<title>l0_gather_13</title>
<ellipse fill="none" stroke="black" cx="5556" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5556" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5556" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5556" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 52</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_13 -->
<g id="edge99" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_13</title>
<path fill="none" stroke="black" d="M3921.04,-4135.8C4256.1,-4136.03 5285.76,-4132.46 5426,-4080.56 5431.34,-4078.58 5430.84,-4074.95 5436,-4072.56 5452.85,-4064.76 5460.72,-4073.48 5477,-4064.56 5498.89,-4052.56 5518.3,-4032.39 5532.4,-4014.93"/>
<polygon fill="black" stroke="black" points="5535.49,-4016.67 5538.88,-4006.63 5529.97,-4012.36 5535.49,-4016.67"/>
<text text-anchor="middle" x="5447" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_14 -->
<g id="node92" class="node">
<title>l0_gather_14</title>
<ellipse fill="none" stroke="black" cx="6428" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6428" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6428" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6428" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 56</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_14 -->
<g id="edge106" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_14</title>
<path fill="none" stroke="black" d="M3920.28,-4135.01C4361.42,-4132.47 6062.45,-4120.17 6299,-4080.56 6322.01,-4076.7 6329.23,-4076.95 6349,-4064.56 6369.86,-4051.48 6389.01,-4031.65 6403.23,-4014.66"/>
<polygon fill="black" stroke="black" points="6406.21,-4016.55 6409.81,-4006.58 6400.78,-4012.13 6406.21,-4016.55"/>
<text text-anchor="middle" x="6344" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_gather_15 -->
<g id="node98" class="node">
<title>l0_gather_15</title>
<ellipse fill="none" stroke="black" cx="6870" cy="-3980.56" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6870" y="-3988.36" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6870" y="-3978.36" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6870" y="-3968.36" font-family="Arial" font-size="9.00">All GPUs → GPU 60</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gather_15 -->
<g id="edge113" class="edge">
<title>l0_mha_res&#45;&gt;l0_gather_15</title>
<path fill="none" stroke="black" d="M3919.27,-4133.9C4264.68,-4128.21 5411.36,-4108.35 6359,-4080.56 6365,-4080.38 6785.53,-4067.03 6791,-4064.56 6814.28,-4054.06 6834.07,-4033.23 6848.02,-4015.06"/>
<polygon fill="black" stroke="black" points="6850.89,-4017.07 6854.01,-4006.95 6845.26,-4012.92 6850.89,-4017.07"/>
<text text-anchor="middle" x="6598" y="-4074.96" font-family="Arial" font-size="7.00">tokens</text>
</g>
<!-- l0_moe_res -->
<g id="node104" class="node">
<title>l0_moe_res</title>
<polygon fill="none" stroke="black" points="4920.91,-3456.82 4709.48,-3456.82 4655.09,-3400.82 4866.52,-3400.82 4920.91,-3456.82"/>
<text text-anchor="middle" x="4788" y="-3431.62" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="4788" y="-3421.62" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_moe_res -->
<g id="edge120" class="edge">
<title>l0_mha_res&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M3919.84,-4134.55C4287.5,-4130.74 5561.78,-4115.69 6613,-4080.56 6763.75,-4075.52 6843.39,-4169.22 6952,-4064.56 6978.66,-4038.87 6959,-4018.58 6959,-3981.56 6959,-3981.56 6959,-3981.56 6959,-3540.82 6959,-3437.03 5355.52,-3429.65 4904.66,-3429.63"/>
<polygon fill="black" stroke="black" points="4904.55,-3426.13 4894.55,-3429.63 4904.55,-3433.13 4904.55,-3426.13"/>
</g>
<!-- l0_route_0 -->
<g id="node7" class="node">
<title>l0_route_0</title>
<polygon fill="none" stroke="black" points="2860.32,-4018.56 2662.55,-4018.56 2611.68,-3942.56 2809.45,-3942.56 2860.32,-4018.56"/>
<text text-anchor="middle" x="2736" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2736" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 0</text>
<text text-anchor="middle" x="2736" y="-3968.36" font-family="Arial" font-size="9.00">GPU 0</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_0 -->
<g id="edge7" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3414.47,-4098.47C3375.19,-4084.79 3340.07,-4072.57 3340,-4072.56 3288.47,-4063.4 2919.19,-4079.4 2869,-4064.56 2840.87,-4056.24 2812.86,-4040.22 2789.84,-4024.45"/>
<polygon fill="black" stroke="black" points="2791.8,-4021.55 2781.6,-4018.67 2787.78,-4027.28 2791.8,-4021.55"/>
<text text-anchor="middle" x="3385.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 0</text>
</g>
<!-- l0_route_1 -->
<g id="node13" class="node">
<title>l0_route_1</title>
<polygon fill="none" stroke="black" points="4600.32,-4018.56 4402.55,-4018.56 4351.68,-3942.56 4549.45,-3942.56 4600.32,-4018.56"/>
<text text-anchor="middle" x="4476" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4476" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 1</text>
<text text-anchor="middle" x="4476" y="-3968.36" font-family="Arial" font-size="9.00">GPU 4</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_1 -->
<g id="edge14" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.95,-4112C3626.33,-4106.79 3649.39,-4101.85 3671,-4098.56 3861.16,-4069.63 3910.86,-4081.58 4103,-4072.56 4129.32,-4071.32 4314.76,-4072.11 4340,-4064.56 4368.44,-4056.05 4396.93,-4040.08 4420.44,-4024.41"/>
<polygon fill="black" stroke="black" points="4422.58,-4027.19 4428.87,-4018.67 4418.63,-4021.41 4422.58,-4027.19"/>
<text text-anchor="middle" x="4126.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 1</text>
</g>
<!-- l0_route_2 -->
<g id="node19" class="node">
<title>l0_route_2</title>
<polygon fill="none" stroke="black" points="2434.32,-4018.56 2236.55,-4018.56 2185.68,-3942.56 2383.45,-3942.56 2434.32,-4018.56"/>
<text text-anchor="middle" x="2310" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2310" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 2</text>
<text text-anchor="middle" x="2310" y="-3968.36" font-family="Arial" font-size="9.00">GPU 8</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_2 -->
<g id="edge21" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3403.25,-4111.78C3316.68,-4094.38 3212.35,-4073.63 3202,-4072.56 3160.05,-4068.23 2483.48,-4076.38 2443,-4064.56 2414.85,-4056.33 2386.83,-4040.32 2363.82,-4024.54"/>
<polygon fill="black" stroke="black" points="2365.77,-4021.64 2355.58,-4018.75 2361.75,-4027.37 2365.77,-4021.64"/>
<text text-anchor="middle" x="3265.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 2</text>
</g>
<!-- l0_route_3 -->
<g id="node25" class="node">
<title>l0_route_3</title>
<polygon fill="none" stroke="black" points="272.32,-4018.56 74.55,-4018.56 23.68,-3942.56 221.45,-3942.56 272.32,-4018.56"/>
<text text-anchor="middle" x="148" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="148" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 3</text>
<text text-anchor="middle" x="148" y="-3968.36" font-family="Arial" font-size="9.00">GPU 12</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_3 -->
<g id="edge28" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3418.47,-4134.08C3054.05,-4128.71 1787.26,-4109.04 742,-4080.56 537.06,-4074.97 477.08,-4124.42 281,-4064.56 253.06,-4056.03 225.18,-4040.06 202.21,-4024.4"/>
<polygon fill="black" stroke="black" points="204.18,-4021.51 193.97,-4018.65 200.17,-4027.25 204.18,-4021.51"/>
<text text-anchor="middle" x="765.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 3</text>
</g>
<!-- l0_route_4 -->
<g id="node31" class="node">
<title>l0_route_4</title>
<polygon fill="none" stroke="black" points="3728.32,-4018.56 3530.55,-4018.56 3479.68,-3942.56 3677.45,-3942.56 3728.32,-4018.56"/>
<text text-anchor="middle" x="3604" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3604" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 4</text>
<text text-anchor="middle" x="3604" y="-3968.36" font-family="Arial" font-size="9.00">GPU 16</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_4 -->
<g id="edge35" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3567.52,-4098.53C3572.62,-4092.94 3577.29,-4086.9 3581,-4080.56 3590.15,-4064.89 3595.66,-4045.84 3598.98,-4028.65"/>
<polygon fill="black" stroke="black" points="3602.43,-4029.23 3600.69,-4018.78 3595.53,-4028.04 3602.43,-4029.23"/>
<text text-anchor="middle" x="3607.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 4</text>
</g>
<!-- l0_route_5 -->
<g id="node37" class="node">
<title>l0_route_5</title>
<polygon fill="none" stroke="black" points="1562.32,-4018.56 1364.55,-4018.56 1313.68,-3942.56 1511.45,-3942.56 1562.32,-4018.56"/>
<text text-anchor="middle" x="1438" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1438" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 5</text>
<text text-anchor="middle" x="1438" y="-3968.36" font-family="Arial" font-size="9.00">GPU 20</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_5 -->
<g id="edge42" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3411.85,-4124.4C3258.77,-4109.32 2971.53,-4083.12 2726,-4072.56 2693.95,-4071.18 1601.81,-4073.5 1571,-4064.56 1542.71,-4056.35 1514.58,-4040.25 1491.52,-4024.4"/>
<polygon fill="black" stroke="black" points="1493.45,-4021.48 1483.26,-4018.59 1489.42,-4027.2 1493.45,-4021.48"/>
<text text-anchor="middle" x="2879.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 5</text>
</g>
<!-- l0_route_6 -->
<g id="node43" class="node">
<title>l0_route_6</title>
<polygon fill="none" stroke="black" points="5026.32,-4018.56 4828.55,-4018.56 4777.68,-3942.56 4975.45,-3942.56 5026.32,-4018.56"/>
<text text-anchor="middle" x="4902" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4902" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 6</text>
<text text-anchor="middle" x="4902" y="-3968.36" font-family="Arial" font-size="9.00">GPU 24</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_6 -->
<g id="edge49" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.88,-4111.57C3626.27,-4106.36 3649.34,-4101.53 3671,-4098.56 3672.88,-4098.3 4764.18,-4065.1 4766,-4064.56 4794.45,-4056.08 4822.95,-4040.13 4846.45,-4024.45"/>
<polygon fill="black" stroke="black" points="4848.59,-4027.23 4854.88,-4018.7 4844.65,-4021.45 4848.59,-4027.23"/>
<text text-anchor="middle" x="4523.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 6</text>
</g>
<!-- l0_route_7 -->
<g id="node49" class="node">
<title>l0_route_7</title>
<polygon fill="none" stroke="black" points="702.32,-4018.56 504.55,-4018.56 453.68,-3942.56 651.45,-3942.56 702.32,-4018.56"/>
<text text-anchor="middle" x="578" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="578" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 7</text>
<text text-anchor="middle" x="578" y="-3968.36" font-family="Arial" font-size="9.00">GPU 28</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_7 -->
<g id="edge56" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3418.91,-4134.49C2929.63,-4129.15 842.97,-4104.17 711,-4064.56 682.91,-4056.13 654.9,-4040.09 631.88,-4024.34"/>
<polygon fill="black" stroke="black" points="633.83,-4021.43 623.63,-4018.56 629.82,-4027.16 633.83,-4021.43"/>
<text text-anchor="middle" x="888.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 7</text>
</g>
<!-- l0_route_8 -->
<g id="node55" class="node">
<title>l0_route_8</title>
<polygon fill="none" stroke="black" points="5898.32,-4018.56 5700.55,-4018.56 5649.68,-3942.56 5847.45,-3942.56 5898.32,-4018.56"/>
<text text-anchor="middle" x="5774" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5774" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 8</text>
<text text-anchor="middle" x="5774" y="-3968.36" font-family="Arial" font-size="9.00">GPU 32</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_8 -->
<g id="edge63" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.45,-4111.39C3625.95,-4106.16 3649.18,-4101.36 3671,-4098.56 3820.35,-4079.4 4875.46,-4083.53 5026,-4080.56 5034.5,-4080.39 5629.84,-4066.97 5638,-4064.56 5666.47,-4056.15 5694.97,-4040.21 5718.47,-4024.52"/>
<polygon fill="black" stroke="black" points="5720.61,-4027.3 5726.9,-4018.77 5716.67,-4021.52 5720.61,-4027.3"/>
<text text-anchor="middle" x="5373.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 8</text>
</g>
<!-- l0_route_9 -->
<g id="node61" class="node">
<title>l0_route_9</title>
<polygon fill="none" stroke="black" points="1132.32,-4018.56 934.55,-4018.56 883.68,-3942.56 1081.45,-3942.56 1132.32,-4018.56"/>
<text text-anchor="middle" x="1008" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1008" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 9</text>
<text text-anchor="middle" x="1008" y="-3968.36" font-family="Arial" font-size="9.00">GPU 36</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_9 -->
<g id="edge70" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3416.09,-4130.89C3145.42,-4119.04 2401.25,-4087.66 1781,-4072.56 1745.45,-4071.69 1175.12,-4074.56 1141,-4064.56 1112.85,-4056.31 1084.84,-4040.29 1061.83,-4024.52"/>
<polygon fill="black" stroke="black" points="1063.78,-4021.61 1053.58,-4018.73 1059.76,-4027.34 1063.78,-4021.61"/>
<text text-anchor="middle" x="2088.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 9</text>
</g>
<!-- l0_route_10 -->
<g id="node67" class="node">
<title>l0_route_10</title>
<polygon fill="none" stroke="black" points="2003.69,-4018.56 1797.38,-4018.56 1744.31,-3942.56 1950.62,-3942.56 2003.69,-4018.56"/>
<text text-anchor="middle" x="1874" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1874" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 10</text>
<text text-anchor="middle" x="1874" y="-3968.36" font-family="Arial" font-size="9.00">GPU 40</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_10 -->
<g id="edge77" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3410.05,-4121.38C3325.78,-4110.51 3207.04,-4094.97 3103,-4080.56 3078.53,-4077.17 3072.63,-4074.44 3048,-4072.56 3019.33,-4070.37 2040.69,-4072.31 2013,-4064.56 1983.58,-4056.32 1954.09,-4040.12 1929.89,-4024.2"/>
<polygon fill="black" stroke="black" points="1931.81,-4021.27 1921.56,-4018.59 1927.9,-4027.08 1931.81,-4021.27"/>
<text text-anchor="middle" x="3128.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 10</text>
</g>
<!-- l0_route_11 -->
<g id="node73" class="node">
<title>l0_route_11</title>
<polygon fill="none" stroke="black" points="3297.69,-4018.56 3091.38,-4018.56 3038.31,-3942.56 3244.62,-3942.56 3297.69,-4018.56"/>
<text text-anchor="middle" x="3168" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3168" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 11</text>
<text text-anchor="middle" x="3168" y="-3968.36" font-family="Arial" font-size="9.00">GPU 44</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_11 -->
<g id="edge84" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3492.57,-4098.25C3482.79,-4088.12 3471,-4078.35 3458,-4072.56 3427.31,-4058.88 3339.15,-4074.35 3307,-4064.56 3278.26,-4055.81 3249.3,-4039.9 3225.3,-4024.33"/>
<polygon fill="black" stroke="black" points="3226.96,-4021.23 3216.69,-4018.62 3223.09,-4027.07 3226.96,-4021.23"/>
<text text-anchor="middle" x="3495.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 11</text>
</g>
<!-- l0_route_12 -->
<g id="node79" class="node">
<title>l0_route_12</title>
<polygon fill="none" stroke="black" points="4169.69,-4018.56 3963.38,-4018.56 3910.31,-3942.56 4116.62,-3942.56 4169.69,-4018.56"/>
<text text-anchor="middle" x="4040" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4040" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 12</text>
<text text-anchor="middle" x="4040" y="-3968.36" font-family="Arial" font-size="9.00">GPU 48</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_12 -->
<g id="edge91" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3602.53,-4108.3C3645.33,-4095.17 3698.96,-4080.57 3748,-4072.56 3780.94,-4067.17 3866.02,-4074.14 3898,-4064.56 3927.36,-4055.76 3957.07,-4039.75 3981.67,-4024.12"/>
<polygon fill="black" stroke="black" points="3983.66,-4027 3990.14,-4018.62 3979.85,-4021.12 3983.66,-4027"/>
<text text-anchor="middle" x="3773.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 12</text>
</g>
<!-- l0_route_13 -->
<g id="node85" class="node">
<title>l0_route_13</title>
<polygon fill="none" stroke="black" points="5467.69,-4018.56 5261.38,-4018.56 5208.31,-3942.56 5414.62,-3942.56 5467.69,-4018.56"/>
<text text-anchor="middle" x="5338" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5338" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 13</text>
<text text-anchor="middle" x="5338" y="-3968.36" font-family="Arial" font-size="9.00">GPU 52</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_13 -->
<g id="edge98" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.86,-4111.39C3626.25,-4106.19 3649.33,-4101.41 3671,-4098.56 3875.95,-4071.64 4394.35,-4085.34 4601,-4080.56 4609.26,-4080.37 5188.05,-4066.83 5196,-4064.56 5225.6,-4056.11 5255.45,-4040.07 5280.09,-4024.31"/>
<polygon fill="black" stroke="black" points="5282.12,-4027.17 5288.58,-4018.77 5278.29,-4021.31 5282.12,-4027.17"/>
<text text-anchor="middle" x="4941.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 13</text>
</g>
<!-- l0_route_14 -->
<g id="node91" class="node">
<title>l0_route_14</title>
<polygon fill="none" stroke="black" points="6339.69,-4018.56 6133.38,-4018.56 6080.31,-3942.56 6286.62,-3942.56 6339.69,-4018.56"/>
<text text-anchor="middle" x="6210" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6210" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 14</text>
<text text-anchor="middle" x="6210" y="-3968.36" font-family="Arial" font-size="9.00">GPU 56</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_14 -->
<g id="edge105" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.45,-4111.34C3625.95,-4106.11 3649.18,-4101.32 3671,-4098.56 3868.43,-4073.56 5263.02,-4084.18 5462,-4080.56 5470.42,-4080.41 6059.9,-4066.87 6068,-4064.56 6097.6,-4056.12 6127.45,-4040.07 6152.09,-4024.32"/>
<polygon fill="black" stroke="black" points="6154.12,-4027.17 6160.58,-4018.77 6150.29,-4021.31 6154.12,-4027.17"/>
<text text-anchor="middle" x="5808.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 14</text>
</g>
<!-- l0_route_15 -->
<g id="node97" class="node">
<title>l0_route_15</title>
<polygon fill="none" stroke="black" points="6781.69,-4018.56 6575.38,-4018.56 6522.31,-3942.56 6728.62,-3942.56 6781.69,-4018.56"/>
<text text-anchor="middle" x="6652" y="-3988.36" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6652" y="-3978.36" font-family="Arial" font-size="9.00">Select tokens for Expert 15</text>
<text text-anchor="middle" x="6652" y="-3968.36" font-family="Arial" font-size="9.00">GPU 60</text>
</g>
<!-- l0_global_gate&#45;&gt;l0_route_15 -->
<g id="edge112" class="edge">
<title>l0_global_gate&#45;&gt;l0_route_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3604.44,-4111.31C3625.94,-4106.08 3649.18,-4101.3 3671,-4098.56 3793.6,-4083.16 5771.46,-4082.67 5895,-4080.56 5903.54,-4080.41 6501.78,-4066.9 6510,-4064.56 6539.73,-4056.09 6569.7,-4039.95 6594.4,-4024.13"/>
<polygon fill="black" stroke="black" points="6596.45,-4026.97 6602.9,-4018.56 6592.62,-4021.11 6596.45,-4026.97"/>
<text text-anchor="middle" x="6245.5" y="-4074.96" font-family="Arial" font-size="7.00">select expert 15</text>
</g>
<!-- l0_exp0_linear1 -->
<g id="node9" class="node">
<title>l0_exp0_linear1</title>
<polygon fill="none" stroke="black" points="3014,-3905.56 2850,-3905.56 2850,-3867.56 3014,-3867.56 3014,-3905.56"/>
<text text-anchor="middle" x="2932" y="-3894.36" font-family="Arial" font-size="9.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="2932" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2932" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 0&#45;3</text>
</g>
<!-- l0_gather_0&#45;&gt;l0_exp0_linear1 -->
<g id="edge9" class="edge">
<title>l0_gather_0&#45;&gt;l0_exp0_linear1</title>
<path fill="none" stroke="black" d="M2942.03,-3953.44C2940.22,-3941.61 2938.09,-3927.6 2936.26,-3915.55"/>
<polygon fill="black" stroke="black" points="2939.71,-3914.93 2934.74,-3905.57 2932.79,-3915.98 2939.71,-3914.93"/>
</g>
<!-- l0_exp0_gelu -->
<g id="node10" class="node">
<title>l0_exp0_gelu</title>
<polygon fill="none" stroke="black" points="2975,-3830.56 2889,-3830.56 2889,-3792.56 2975,-3792.56 2975,-3830.56"/>
<text text-anchor="middle" x="2932" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2932" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2932" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 0&#45;3</text>
</g>
<!-- l0_exp0_linear1&#45;&gt;l0_exp0_gelu -->
<g id="edge10" class="edge">
<title>l0_exp0_linear1&#45;&gt;l0_exp0_gelu</title>
<path fill="none" stroke="black" d="M2932,-3867.51C2932,-3859.44 2932,-3849.73 2932,-3840.74"/>
<polygon fill="black" stroke="black" points="2935.5,-3840.65 2932,-3830.65 2928.5,-3840.65 2935.5,-3840.65"/>
</g>
<!-- l0_exp0_linear2 -->
<g id="node11" class="node">
<title>l0_exp0_linear2</title>
<polygon fill="none" stroke="black" points="3014,-3755.56 2850,-3755.56 2850,-3717.56 3014,-3717.56 3014,-3755.56"/>
<text text-anchor="middle" x="2932" y="-3744.36" font-family="Arial" font-size="9.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="2932" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2932" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 0&#45;3</text>
</g>
<!-- l0_exp0_gelu&#45;&gt;l0_exp0_linear2 -->
<g id="edge11" class="edge">
<title>l0_exp0_gelu&#45;&gt;l0_exp0_linear2</title>
<path fill="none" stroke="black" d="M2932,-3792.51C2932,-3784.44 2932,-3774.73 2932,-3765.74"/>
<polygon fill="black" stroke="black" points="2935.5,-3765.65 2932,-3755.65 2928.5,-3765.65 2935.5,-3765.65"/>
</g>
<!-- l0_scatter_0 -->
<g id="node12" class="node">
<title>l0_scatter_0</title>
<ellipse fill="none" stroke="black" cx="2944" cy="-3653.69" rx="66.44" ry="26.74"/>
<text text-anchor="middle" x="2944" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2944" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2944" y="-3641.49" font-family="Arial" font-size="9.00">GPU 0 → All GPUs</text>
</g>
<!-- l0_exp0_linear2&#45;&gt;l0_scatter_0 -->
<g id="edge12" class="edge">
<title>l0_exp0_linear2&#45;&gt;l0_scatter_0</title>
<path fill="none" stroke="black" d="M2934.72,-3717.21C2935.89,-3709.35 2937.29,-3699.89 2938.65,-3690.74"/>
<polygon fill="black" stroke="black" points="2942.14,-3691.04 2940.15,-3680.63 2935.22,-3690.01 2942.14,-3691.04"/>
</g>
<!-- l0_expert_agg -->
<g id="node103" class="node">
<title>l0_expert_agg</title>
<polygon fill="none" stroke="black" points="3934.76,-3589.82 3726.75,-3589.82 3673.24,-3493.82 3881.25,-3493.82 3934.76,-3589.82"/>
<text text-anchor="middle" x="3804" y="-3554.62" font-family="Arial" font-size="9.00">Expert Aggregation</text>
<text text-anchor="middle" x="3804" y="-3544.62" font-family="Arial" font-size="9.00">Combine all expert outputs</text>
<text text-anchor="middle" x="3804" y="-3534.62" font-family="Arial" font-size="9.00">[1024, 8192]</text>
<text text-anchor="middle" x="3804" y="-3524.62" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l0_scatter_0&#45;&gt;l0_expert_agg -->
<g id="edge13" class="edge">
<title>l0_scatter_0&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M2985.76,-3632.67C2998.42,-3627.36 3012.55,-3622.17 3026,-3618.82 3257.21,-3561.12 3537.26,-3546.82 3690.38,-3543.53"/>
<polygon fill="black" stroke="black" points="3690.81,-3547.02 3700.73,-3543.32 3690.66,-3540.02 3690.81,-3547.02"/>
</g>
<!-- l0_exp1_linear1 -->
<g id="node15" class="node">
<title>l0_exp1_linear1</title>
<polygon fill="none" stroke="black" points="4635,-3905.56 4471,-3905.56 4471,-3867.56 4635,-3867.56 4635,-3905.56"/>
<text text-anchor="middle" x="4553" y="-3894.36" font-family="Arial" font-size="9.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="4553" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4553" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 4&#45;7</text>
</g>
<!-- l0_gather_1&#45;&gt;l0_exp1_linear1 -->
<g id="edge16" class="edge">
<title>l0_gather_1&#45;&gt;l0_exp1_linear1</title>
<path fill="none" stroke="black" d="M4653.12,-3956.82C4633.2,-3943.04 4607.81,-3925.47 4587.59,-3911.48"/>
<polygon fill="black" stroke="black" points="4589.48,-3908.54 4579.27,-3905.73 4585.5,-3914.3 4589.48,-3908.54"/>
</g>
<!-- l0_exp1_gelu -->
<g id="node16" class="node">
<title>l0_exp1_gelu</title>
<polygon fill="none" stroke="black" points="4581,-3830.56 4495,-3830.56 4495,-3792.56 4581,-3792.56 4581,-3830.56"/>
<text text-anchor="middle" x="4538" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4538" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4538" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 4&#45;7</text>
</g>
<!-- l0_exp1_linear1&#45;&gt;l0_exp1_gelu -->
<g id="edge17" class="edge">
<title>l0_exp1_linear1&#45;&gt;l0_exp1_gelu</title>
<path fill="none" stroke="black" d="M4549.29,-3867.51C4547.62,-3859.35 4545.6,-3849.52 4543.73,-3840.45"/>
<polygon fill="black" stroke="black" points="4547.16,-3839.74 4541.72,-3830.65 4540.3,-3841.15 4547.16,-3839.74"/>
</g>
<!-- l0_exp1_linear2 -->
<g id="node17" class="node">
<title>l0_exp1_linear2</title>
<polygon fill="none" stroke="black" points="4546,-3755.56 4382,-3755.56 4382,-3717.56 4546,-3717.56 4546,-3755.56"/>
<text text-anchor="middle" x="4464" y="-3744.36" font-family="Arial" font-size="9.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="4464" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4464" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 4&#45;7</text>
</g>
<!-- l0_exp1_gelu&#45;&gt;l0_exp1_linear2 -->
<g id="edge18" class="edge">
<title>l0_exp1_gelu&#45;&gt;l0_exp1_linear2</title>
<path fill="none" stroke="black" d="M4519.71,-3792.51C4510.64,-3783.56 4499.53,-3772.61 4489.62,-3762.84"/>
<polygon fill="black" stroke="black" points="4491.92,-3760.18 4482.34,-3755.65 4487,-3765.16 4491.92,-3760.18"/>
</g>
<!-- l0_scatter_1 -->
<g id="node18" class="node">
<title>l0_scatter_1</title>
<ellipse fill="none" stroke="black" cx="4441" cy="-3653.69" rx="66.44" ry="26.74"/>
<text text-anchor="middle" x="4441" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4441" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4441" y="-3641.49" font-family="Arial" font-size="9.00">GPU 4 → All GPUs</text>
</g>
<!-- l0_exp1_linear2&#45;&gt;l0_scatter_1 -->
<g id="edge19" class="edge">
<title>l0_exp1_linear2&#45;&gt;l0_scatter_1</title>
<path fill="none" stroke="black" d="M4458.78,-3717.21C4456.52,-3709.27 4453.8,-3699.69 4451.17,-3690.44"/>
<polygon fill="black" stroke="black" points="4454.48,-3689.29 4448.38,-3680.63 4447.75,-3691.21 4454.48,-3689.29"/>
</g>
<!-- l0_scatter_1&#45;&gt;l0_expert_agg -->
<g id="edge20" class="edge">
<title>l0_scatter_1&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M4393.48,-3634.76C4376.77,-3628.99 4357.73,-3623.01 4340,-3618.82 4199.09,-3585.5 4033.65,-3564.76 3924.24,-3553.52"/>
<polygon fill="black" stroke="black" points="3924.47,-3550.03 3914.16,-3552.5 3923.76,-3556.99 3924.47,-3550.03"/>
</g>
<!-- l0_exp2_linear1 -->
<g id="node21" class="node">
<title>l0_exp2_linear1</title>
<polygon fill="none" stroke="black" points="2588,-3905.56 2424,-3905.56 2424,-3867.56 2588,-3867.56 2588,-3905.56"/>
<text text-anchor="middle" x="2506" y="-3894.36" font-family="Arial" font-size="9.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="2506" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2506" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 8&#45;11</text>
</g>
<!-- l0_gather_2&#45;&gt;l0_exp2_linear1 -->
<g id="edge23" class="edge">
<title>l0_gather_2&#45;&gt;l0_exp2_linear1</title>
<path fill="none" stroke="black" d="M2516.03,-3953.44C2514.22,-3941.61 2512.09,-3927.6 2510.26,-3915.55"/>
<polygon fill="black" stroke="black" points="2513.71,-3914.93 2508.74,-3905.57 2506.79,-3915.98 2513.71,-3914.93"/>
</g>
<!-- l0_exp2_gelu -->
<g id="node22" class="node">
<title>l0_exp2_gelu</title>
<polygon fill="none" stroke="black" points="2549,-3830.56 2463,-3830.56 2463,-3792.56 2549,-3792.56 2549,-3830.56"/>
<text text-anchor="middle" x="2506" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2506" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2506" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 8&#45;11</text>
</g>
<!-- l0_exp2_linear1&#45;&gt;l0_exp2_gelu -->
<g id="edge24" class="edge">
<title>l0_exp2_linear1&#45;&gt;l0_exp2_gelu</title>
<path fill="none" stroke="black" d="M2506,-3867.51C2506,-3859.44 2506,-3849.73 2506,-3840.74"/>
<polygon fill="black" stroke="black" points="2509.5,-3840.65 2506,-3830.65 2502.5,-3840.65 2509.5,-3840.65"/>
</g>
<!-- l0_exp2_linear2 -->
<g id="node23" class="node">
<title>l0_exp2_linear2</title>
<polygon fill="none" stroke="black" points="2588,-3755.56 2424,-3755.56 2424,-3717.56 2588,-3717.56 2588,-3755.56"/>
<text text-anchor="middle" x="2506" y="-3744.36" font-family="Arial" font-size="9.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="2506" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2506" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 8&#45;11</text>
</g>
<!-- l0_exp2_gelu&#45;&gt;l0_exp2_linear2 -->
<g id="edge25" class="edge">
<title>l0_exp2_gelu&#45;&gt;l0_exp2_linear2</title>
<path fill="none" stroke="black" d="M2506,-3792.51C2506,-3784.44 2506,-3774.73 2506,-3765.74"/>
<polygon fill="black" stroke="black" points="2509.5,-3765.65 2506,-3755.65 2502.5,-3765.65 2509.5,-3765.65"/>
</g>
<!-- l0_scatter_2 -->
<g id="node24" class="node">
<title>l0_scatter_2</title>
<ellipse fill="none" stroke="black" cx="2514" cy="-3653.69" rx="66.44" ry="26.74"/>
<text text-anchor="middle" x="2514" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2514" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2514" y="-3641.49" font-family="Arial" font-size="9.00">GPU 8 → All GPUs</text>
</g>
<!-- l0_exp2_linear2&#45;&gt;l0_scatter_2 -->
<g id="edge26" class="edge">
<title>l0_exp2_linear2&#45;&gt;l0_scatter_2</title>
<path fill="none" stroke="black" d="M2507.82,-3717.21C2508.59,-3709.35 2509.53,-3699.89 2510.43,-3690.74"/>
<polygon fill="black" stroke="black" points="2513.93,-3690.93 2511.43,-3680.63 2506.97,-3690.24 2513.93,-3690.93"/>
</g>
<!-- l0_scatter_2&#45;&gt;l0_expert_agg -->
<g id="edge27" class="edge">
<title>l0_scatter_2&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M2556.48,-3632.93C2570.1,-3627.42 2585.43,-3622.06 2600,-3618.82 2805.9,-3572.97 3433.21,-3552.22 3691.28,-3545.46"/>
<polygon fill="black" stroke="black" points="3691.52,-3548.95 3701.42,-3545.19 3691.34,-3541.95 3691.52,-3548.95"/>
</g>
<!-- l0_exp3_linear1 -->
<g id="node27" class="node">
<title>l0_exp3_linear1</title>
<polygon fill="none" stroke="black" points="430,-3905.56 266,-3905.56 266,-3867.56 430,-3867.56 430,-3905.56"/>
<text text-anchor="middle" x="348" y="-3894.36" font-family="Arial" font-size="9.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="348" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="348" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 12&#45;15</text>
</g>
<!-- l0_gather_3&#45;&gt;l0_exp3_linear1 -->
<g id="edge30" class="edge">
<title>l0_gather_3&#45;&gt;l0_exp3_linear1</title>
<path fill="none" stroke="black" d="M356.59,-3953.44C355.05,-3941.61 353.22,-3927.6 351.65,-3915.55"/>
<polygon fill="black" stroke="black" points="355.11,-3915.03 350.35,-3905.57 348.17,-3915.94 355.11,-3915.03"/>
</g>
<!-- l0_exp3_gelu -->
<g id="node28" class="node">
<title>l0_exp3_gelu</title>
<polygon fill="none" stroke="black" points="391,-3830.56 305,-3830.56 305,-3792.56 391,-3792.56 391,-3830.56"/>
<text text-anchor="middle" x="348" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="348" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="348" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 12&#45;15</text>
</g>
<!-- l0_exp3_linear1&#45;&gt;l0_exp3_gelu -->
<g id="edge31" class="edge">
<title>l0_exp3_linear1&#45;&gt;l0_exp3_gelu</title>
<path fill="none" stroke="black" d="M348,-3867.51C348,-3859.44 348,-3849.73 348,-3840.74"/>
<polygon fill="black" stroke="black" points="351.5,-3840.65 348,-3830.65 344.5,-3840.65 351.5,-3840.65"/>
</g>
<!-- l0_exp3_linear2 -->
<g id="node29" class="node">
<title>l0_exp3_linear2</title>
<polygon fill="none" stroke="black" points="430,-3755.56 266,-3755.56 266,-3717.56 430,-3717.56 430,-3755.56"/>
<text text-anchor="middle" x="348" y="-3744.36" font-family="Arial" font-size="9.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="348" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="348" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 12&#45;15</text>
</g>
<!-- l0_exp3_gelu&#45;&gt;l0_exp3_linear2 -->
<g id="edge32" class="edge">
<title>l0_exp3_gelu&#45;&gt;l0_exp3_linear2</title>
<path fill="none" stroke="black" d="M348,-3792.51C348,-3784.44 348,-3774.73 348,-3765.74"/>
<polygon fill="black" stroke="black" points="351.5,-3765.65 348,-3755.65 344.5,-3765.65 351.5,-3765.65"/>
</g>
<!-- l0_scatter_3 -->
<g id="node30" class="node">
<title>l0_scatter_3</title>
<ellipse fill="none" stroke="black" cx="357" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="357" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="357" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="357" y="-3641.49" font-family="Arial" font-size="9.00">GPU 12 → All GPUs</text>
</g>
<!-- l0_exp3_linear2&#45;&gt;l0_scatter_3 -->
<g id="edge33" class="edge">
<title>l0_exp3_linear2&#45;&gt;l0_scatter_3</title>
<path fill="none" stroke="black" d="M350.04,-3717.21C350.92,-3709.35 351.97,-3699.89 352.99,-3690.74"/>
<polygon fill="black" stroke="black" points="356.49,-3690.96 354.11,-3680.63 349.53,-3690.18 356.49,-3690.96"/>
</g>
<!-- l0_scatter_3&#45;&gt;l0_expert_agg -->
<g id="edge34" class="edge">
<title>l0_scatter_3&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M399.76,-3632.21C413,-3626.82 427.84,-3621.7 442,-3618.82 765.31,-3552.98 3139.13,-3544.16 3690.04,-3542.99"/>
<polygon fill="black" stroke="black" points="3690.38,-3546.49 3700.37,-3542.97 3690.36,-3539.49 3690.38,-3546.49"/>
</g>
<!-- l0_exp4_linear1 -->
<g id="node33" class="node">
<title>l0_exp4_linear1</title>
<polygon fill="none" stroke="black" points="3886,-3905.56 3722,-3905.56 3722,-3867.56 3886,-3867.56 3886,-3905.56"/>
<text text-anchor="middle" x="3804" y="-3894.36" font-family="Arial" font-size="9.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="3804" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3804" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 16&#45;19</text>
</g>
<!-- l0_gather_4&#45;&gt;l0_exp4_linear1 -->
<g id="edge37" class="edge">
<title>l0_gather_4&#45;&gt;l0_exp4_linear1</title>
<path fill="none" stroke="black" d="M3812.59,-3953.44C3811.05,-3941.61 3809.22,-3927.6 3807.65,-3915.55"/>
<polygon fill="black" stroke="black" points="3811.11,-3915.03 3806.35,-3905.57 3804.17,-3915.94 3811.11,-3915.03"/>
</g>
<!-- l0_exp4_gelu -->
<g id="node34" class="node">
<title>l0_exp4_gelu</title>
<polygon fill="none" stroke="black" points="3847,-3830.56 3761,-3830.56 3761,-3792.56 3847,-3792.56 3847,-3830.56"/>
<text text-anchor="middle" x="3804" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3804" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3804" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 16&#45;19</text>
</g>
<!-- l0_exp4_linear1&#45;&gt;l0_exp4_gelu -->
<g id="edge38" class="edge">
<title>l0_exp4_linear1&#45;&gt;l0_exp4_gelu</title>
<path fill="none" stroke="black" d="M3804,-3867.51C3804,-3859.44 3804,-3849.73 3804,-3840.74"/>
<polygon fill="black" stroke="black" points="3807.5,-3840.65 3804,-3830.65 3800.5,-3840.65 3807.5,-3840.65"/>
</g>
<!-- l0_exp4_linear2 -->
<g id="node35" class="node">
<title>l0_exp4_linear2</title>
<polygon fill="none" stroke="black" points="3886,-3755.56 3722,-3755.56 3722,-3717.56 3886,-3717.56 3886,-3755.56"/>
<text text-anchor="middle" x="3804" y="-3744.36" font-family="Arial" font-size="9.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="3804" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3804" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 16&#45;19</text>
</g>
<!-- l0_exp4_gelu&#45;&gt;l0_exp4_linear2 -->
<g id="edge39" class="edge">
<title>l0_exp4_gelu&#45;&gt;l0_exp4_linear2</title>
<path fill="none" stroke="black" d="M3804,-3792.51C3804,-3784.44 3804,-3774.73 3804,-3765.74"/>
<polygon fill="black" stroke="black" points="3807.5,-3765.65 3804,-3755.65 3800.5,-3765.65 3807.5,-3765.65"/>
</g>
<!-- l0_scatter_4 -->
<g id="node36" class="node">
<title>l0_scatter_4</title>
<ellipse fill="none" stroke="black" cx="3804" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3804" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3804" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3804" y="-3641.49" font-family="Arial" font-size="9.00">GPU 16 → All GPUs</text>
</g>
<!-- l0_exp4_linear2&#45;&gt;l0_scatter_4 -->
<g id="edge40" class="edge">
<title>l0_exp4_linear2&#45;&gt;l0_scatter_4</title>
<path fill="none" stroke="black" d="M3804,-3717.21C3804,-3709.35 3804,-3699.89 3804,-3690.74"/>
<polygon fill="black" stroke="black" points="3807.5,-3690.63 3804,-3680.63 3800.5,-3690.63 3807.5,-3690.63"/>
</g>
<!-- l0_scatter_4&#45;&gt;l0_expert_agg -->
<g id="edge41" class="edge">
<title>l0_scatter_4&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M3804,-3626.65C3804,-3618.64 3804,-3609.47 3804,-3600.22"/>
<polygon fill="black" stroke="black" points="3807.5,-3600.19 3804,-3590.19 3800.5,-3600.19 3807.5,-3600.19"/>
</g>
<!-- l0_exp5_linear1 -->
<g id="node39" class="node">
<title>l0_exp5_linear1</title>
<polygon fill="none" stroke="black" points="1720,-3905.56 1556,-3905.56 1556,-3867.56 1720,-3867.56 1720,-3905.56"/>
<text text-anchor="middle" x="1638" y="-3894.36" font-family="Arial" font-size="9.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="1638" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1638" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 20&#45;23</text>
</g>
<!-- l0_gather_5&#45;&gt;l0_exp5_linear1 -->
<g id="edge44" class="edge">
<title>l0_gather_5&#45;&gt;l0_exp5_linear1</title>
<path fill="none" stroke="black" d="M1646.59,-3953.44C1645.05,-3941.61 1643.22,-3927.6 1641.65,-3915.55"/>
<polygon fill="black" stroke="black" points="1645.11,-3915.03 1640.35,-3905.57 1638.17,-3915.94 1645.11,-3915.03"/>
</g>
<!-- l0_exp5_gelu -->
<g id="node40" class="node">
<title>l0_exp5_gelu</title>
<polygon fill="none" stroke="black" points="1681,-3830.56 1595,-3830.56 1595,-3792.56 1681,-3792.56 1681,-3830.56"/>
<text text-anchor="middle" x="1638" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1638" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1638" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 20&#45;23</text>
</g>
<!-- l0_exp5_linear1&#45;&gt;l0_exp5_gelu -->
<g id="edge45" class="edge">
<title>l0_exp5_linear1&#45;&gt;l0_exp5_gelu</title>
<path fill="none" stroke="black" d="M1638,-3867.51C1638,-3859.44 1638,-3849.73 1638,-3840.74"/>
<polygon fill="black" stroke="black" points="1641.5,-3840.65 1638,-3830.65 1634.5,-3840.65 1641.5,-3840.65"/>
</g>
<!-- l0_exp5_linear2 -->
<g id="node41" class="node">
<title>l0_exp5_linear2</title>
<polygon fill="none" stroke="black" points="1720,-3755.56 1556,-3755.56 1556,-3717.56 1720,-3717.56 1720,-3755.56"/>
<text text-anchor="middle" x="1638" y="-3744.36" font-family="Arial" font-size="9.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="1638" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1638" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 20&#45;23</text>
</g>
<!-- l0_exp5_gelu&#45;&gt;l0_exp5_linear2 -->
<g id="edge46" class="edge">
<title>l0_exp5_gelu&#45;&gt;l0_exp5_linear2</title>
<path fill="none" stroke="black" d="M1638,-3792.51C1638,-3784.44 1638,-3774.73 1638,-3765.74"/>
<polygon fill="black" stroke="black" points="1641.5,-3765.65 1638,-3755.65 1634.5,-3765.65 1641.5,-3765.65"/>
</g>
<!-- l0_scatter_5 -->
<g id="node42" class="node">
<title>l0_scatter_5</title>
<ellipse fill="none" stroke="black" cx="1647" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1647" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1647" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1647" y="-3641.49" font-family="Arial" font-size="9.00">GPU 20 → All GPUs</text>
</g>
<!-- l0_exp5_linear2&#45;&gt;l0_scatter_5 -->
<g id="edge47" class="edge">
<title>l0_exp5_linear2&#45;&gt;l0_scatter_5</title>
<path fill="none" stroke="black" d="M1640.04,-3717.21C1640.92,-3709.35 1641.97,-3699.89 1642.99,-3690.74"/>
<polygon fill="black" stroke="black" points="1646.49,-3690.96 1644.11,-3680.63 1639.53,-3690.18 1646.49,-3690.96"/>
</g>
<!-- l0_scatter_5&#45;&gt;l0_expert_agg -->
<g id="edge48" class="edge">
<title>l0_scatter_5&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M1689.79,-3632.33C1703.03,-3626.94 1717.86,-3621.8 1732,-3618.82 1923.62,-3578.39 3286.81,-3551.78 3691.2,-3544.7"/>
<polygon fill="black" stroke="black" points="3691.5,-3548.2 3701.44,-3544.53 3691.38,-3541.2 3691.5,-3548.2"/>
</g>
<!-- l0_exp6_linear1 -->
<g id="node45" class="node">
<title>l0_exp6_linear1</title>
<polygon fill="none" stroke="black" points="5176,-3905.56 5012,-3905.56 5012,-3867.56 5176,-3867.56 5176,-3905.56"/>
<text text-anchor="middle" x="5094" y="-3894.36" font-family="Arial" font-size="9.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="5094" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5094" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 24&#45;27</text>
</g>
<!-- l0_gather_6&#45;&gt;l0_exp6_linear1 -->
<g id="edge51" class="edge">
<title>l0_gather_6&#45;&gt;l0_exp6_linear1</title>
<path fill="none" stroke="black" d="M5108.32,-3953.44C5105.75,-3941.61 5102.7,-3927.6 5100.09,-3915.55"/>
<polygon fill="black" stroke="black" points="5103.46,-3914.6 5097.92,-3905.57 5096.62,-3916.09 5103.46,-3914.6"/>
</g>
<!-- l0_exp6_gelu -->
<g id="node46" class="node">
<title>l0_exp6_gelu</title>
<polygon fill="none" stroke="black" points="5008,-3830.56 4922,-3830.56 4922,-3792.56 5008,-3792.56 5008,-3830.56"/>
<text text-anchor="middle" x="4965" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4965" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4965" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 24&#45;27</text>
</g>
<!-- l0_exp6_linear1&#45;&gt;l0_exp6_gelu -->
<g id="edge52" class="edge">
<title>l0_exp6_linear1&#45;&gt;l0_exp6_gelu</title>
<path fill="none" stroke="black" d="M5062.11,-3867.51C5045.21,-3857.95 5024.26,-3846.09 5006.14,-3835.84"/>
<polygon fill="black" stroke="black" points="5007.39,-3832.53 4996.97,-3830.65 5003.95,-3838.62 5007.39,-3832.53"/>
</g>
<!-- l0_exp6_linear2 -->
<g id="node47" class="node">
<title>l0_exp6_linear2</title>
<polygon fill="none" stroke="black" points="4972,-3755.56 4808,-3755.56 4808,-3717.56 4972,-3717.56 4972,-3755.56"/>
<text text-anchor="middle" x="4890" y="-3744.36" font-family="Arial" font-size="9.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="4890" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4890" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 24&#45;27</text>
</g>
<!-- l0_exp6_gelu&#45;&gt;l0_exp6_linear2 -->
<g id="edge53" class="edge">
<title>l0_exp6_gelu&#45;&gt;l0_exp6_linear2</title>
<path fill="none" stroke="black" d="M4946.46,-3792.51C4937.27,-3783.56 4926.01,-3772.61 4915.97,-3762.84"/>
<polygon fill="black" stroke="black" points="4918.19,-3760.12 4908.59,-3755.65 4913.31,-3765.13 4918.19,-3760.12"/>
</g>
<!-- l0_scatter_6 -->
<g id="node48" class="node">
<title>l0_scatter_6</title>
<ellipse fill="none" stroke="black" cx="4869" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4869" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4869" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4869" y="-3641.49" font-family="Arial" font-size="9.00">GPU 24 → All GPUs</text>
</g>
<!-- l0_exp6_linear2&#45;&gt;l0_scatter_6 -->
<g id="edge54" class="edge">
<title>l0_exp6_linear2&#45;&gt;l0_scatter_6</title>
<path fill="none" stroke="black" d="M4885.23,-3717.21C4883.17,-3709.27 4880.69,-3699.69 4878.28,-3690.44"/>
<polygon fill="black" stroke="black" points="4881.64,-3689.43 4875.74,-3680.63 4874.86,-3691.19 4881.64,-3689.43"/>
</g>
<!-- l0_scatter_6&#45;&gt;l0_expert_agg -->
<g id="edge55" class="edge">
<title>l0_scatter_6&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M4820.65,-3634.15C4803.62,-3628.33 4784.18,-3622.47 4766,-3618.82 4464.35,-3558.21 4100.4,-3545.45 3918.79,-3543.08"/>
<polygon fill="black" stroke="black" points="3918.73,-3539.58 3908.69,-3542.95 3918.64,-3546.57 3918.73,-3539.58"/>
</g>
<!-- l0_exp7_linear1 -->
<g id="node51" class="node">
<title>l0_exp7_linear1</title>
<polygon fill="none" stroke="black" points="860,-3905.56 696,-3905.56 696,-3867.56 860,-3867.56 860,-3905.56"/>
<text text-anchor="middle" x="778" y="-3894.36" font-family="Arial" font-size="9.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="778" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="778" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 28&#45;31</text>
</g>
<!-- l0_gather_7&#45;&gt;l0_exp7_linear1 -->
<g id="edge58" class="edge">
<title>l0_gather_7&#45;&gt;l0_exp7_linear1</title>
<path fill="none" stroke="black" d="M786.59,-3953.44C785.05,-3941.61 783.22,-3927.6 781.65,-3915.55"/>
<polygon fill="black" stroke="black" points="785.11,-3915.03 780.35,-3905.57 778.17,-3915.94 785.11,-3915.03"/>
</g>
<!-- l0_exp7_gelu -->
<g id="node52" class="node">
<title>l0_exp7_gelu</title>
<polygon fill="none" stroke="black" points="821,-3830.56 735,-3830.56 735,-3792.56 821,-3792.56 821,-3830.56"/>
<text text-anchor="middle" x="778" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="778" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="778" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 28&#45;31</text>
</g>
<!-- l0_exp7_linear1&#45;&gt;l0_exp7_gelu -->
<g id="edge59" class="edge">
<title>l0_exp7_linear1&#45;&gt;l0_exp7_gelu</title>
<path fill="none" stroke="black" d="M778,-3867.51C778,-3859.44 778,-3849.73 778,-3840.74"/>
<polygon fill="black" stroke="black" points="781.5,-3840.65 778,-3830.65 774.5,-3840.65 781.5,-3840.65"/>
</g>
<!-- l0_exp7_linear2 -->
<g id="node53" class="node">
<title>l0_exp7_linear2</title>
<polygon fill="none" stroke="black" points="860,-3755.56 696,-3755.56 696,-3717.56 860,-3717.56 860,-3755.56"/>
<text text-anchor="middle" x="778" y="-3744.36" font-family="Arial" font-size="9.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="778" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="778" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 28&#45;31</text>
</g>
<!-- l0_exp7_gelu&#45;&gt;l0_exp7_linear2 -->
<g id="edge60" class="edge">
<title>l0_exp7_gelu&#45;&gt;l0_exp7_linear2</title>
<path fill="none" stroke="black" d="M778,-3792.51C778,-3784.44 778,-3774.73 778,-3765.74"/>
<polygon fill="black" stroke="black" points="781.5,-3765.65 778,-3755.65 774.5,-3765.65 781.5,-3765.65"/>
</g>
<!-- l0_scatter_7 -->
<g id="node54" class="node">
<title>l0_scatter_7</title>
<ellipse fill="none" stroke="black" cx="787" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="787" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="787" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="787" y="-3641.49" font-family="Arial" font-size="9.00">GPU 28 → All GPUs</text>
</g>
<!-- l0_exp7_linear2&#45;&gt;l0_scatter_7 -->
<g id="edge61" class="edge">
<title>l0_exp7_linear2&#45;&gt;l0_scatter_7</title>
<path fill="none" stroke="black" d="M780.04,-3717.21C780.92,-3709.35 781.97,-3699.89 782.99,-3690.74"/>
<polygon fill="black" stroke="black" points="786.49,-3690.96 784.11,-3680.63 779.53,-3690.18 786.49,-3690.96"/>
</g>
<!-- l0_scatter_7&#45;&gt;l0_expert_agg -->
<g id="edge62" class="edge">
<title>l0_scatter_7&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M829.77,-3632.24C843.01,-3626.85 857.84,-3621.73 872,-3618.82 1151.19,-3561.48 3184.76,-3546.3 3690.41,-3543.4"/>
<polygon fill="black" stroke="black" points="3690.65,-3546.9 3700.63,-3543.34 3690.61,-3539.9 3690.65,-3546.9"/>
</g>
<!-- l0_exp8_linear1 -->
<g id="node57" class="node">
<title>l0_exp8_linear1</title>
<polygon fill="none" stroke="black" points="6048,-3905.56 5884,-3905.56 5884,-3867.56 6048,-3867.56 6048,-3905.56"/>
<text text-anchor="middle" x="5966" y="-3894.36" font-family="Arial" font-size="9.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="5966" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5966" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l0_gather_8&#45;&gt;l0_exp8_linear1 -->
<g id="edge65" class="edge">
<title>l0_gather_8&#45;&gt;l0_exp8_linear1</title>
<path fill="none" stroke="black" d="M5980.32,-3953.44C5977.75,-3941.61 5974.7,-3927.6 5972.09,-3915.55"/>
<polygon fill="black" stroke="black" points="5975.46,-3914.6 5969.92,-3905.57 5968.62,-3916.09 5975.46,-3914.6"/>
</g>
<!-- l0_exp8_gelu -->
<g id="node58" class="node">
<title>l0_exp8_gelu</title>
<polygon fill="none" stroke="black" points="5880,-3830.56 5794,-3830.56 5794,-3792.56 5880,-3792.56 5880,-3830.56"/>
<text text-anchor="middle" x="5837" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5837" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5837" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 32&#45;35</text>
</g>
<!-- l0_exp8_linear1&#45;&gt;l0_exp8_gelu -->
<g id="edge66" class="edge">
<title>l0_exp8_linear1&#45;&gt;l0_exp8_gelu</title>
<path fill="none" stroke="black" d="M5934.11,-3867.51C5917.21,-3857.95 5896.26,-3846.09 5878.14,-3835.84"/>
<polygon fill="black" stroke="black" points="5879.39,-3832.53 5868.97,-3830.65 5875.95,-3838.62 5879.39,-3832.53"/>
</g>
<!-- l0_exp8_linear2 -->
<g id="node59" class="node">
<title>l0_exp8_linear2</title>
<polygon fill="none" stroke="black" points="5844,-3755.56 5680,-3755.56 5680,-3717.56 5844,-3717.56 5844,-3755.56"/>
<text text-anchor="middle" x="5762" y="-3744.36" font-family="Arial" font-size="9.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="5762" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5762" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l0_exp8_gelu&#45;&gt;l0_exp8_linear2 -->
<g id="edge67" class="edge">
<title>l0_exp8_gelu&#45;&gt;l0_exp8_linear2</title>
<path fill="none" stroke="black" d="M5818.46,-3792.51C5809.27,-3783.56 5798.01,-3772.61 5787.97,-3762.84"/>
<polygon fill="black" stroke="black" points="5790.19,-3760.12 5780.59,-3755.65 5785.31,-3765.13 5790.19,-3760.12"/>
</g>
<!-- l0_scatter_8 -->
<g id="node60" class="node">
<title>l0_scatter_8</title>
<ellipse fill="none" stroke="black" cx="5741" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5741" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5741" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5741" y="-3641.49" font-family="Arial" font-size="9.00">GPU 32 → All GPUs</text>
</g>
<!-- l0_exp8_linear2&#45;&gt;l0_scatter_8 -->
<g id="edge68" class="edge">
<title>l0_exp8_linear2&#45;&gt;l0_scatter_8</title>
<path fill="none" stroke="black" d="M5757.23,-3717.21C5755.17,-3709.27 5752.69,-3699.69 5750.28,-3690.44"/>
<polygon fill="black" stroke="black" points="5753.64,-3689.43 5747.74,-3680.63 5746.86,-3691.19 5753.64,-3689.43"/>
</g>
<!-- l0_scatter_8&#45;&gt;l0_expert_agg -->
<g id="edge69" class="edge">
<title>l0_scatter_8&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M5693.25,-3633.94C5676.09,-3628.02 5656.43,-3622.16 5638,-3618.82 5305.87,-3558.53 4267.5,-3545.98 3919.2,-3543.44"/>
<polygon fill="black" stroke="black" points="3919.13,-3539.94 3909.1,-3543.37 3919.08,-3546.94 3919.13,-3539.94"/>
</g>
<!-- l0_exp9_linear1 -->
<g id="node63" class="node">
<title>l0_exp9_linear1</title>
<polygon fill="none" stroke="black" points="1290,-3905.56 1126,-3905.56 1126,-3867.56 1290,-3867.56 1290,-3905.56"/>
<text text-anchor="middle" x="1208" y="-3894.36" font-family="Arial" font-size="9.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="1208" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1208" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l0_gather_9&#45;&gt;l0_exp9_linear1 -->
<g id="edge72" class="edge">
<title>l0_gather_9&#45;&gt;l0_exp9_linear1</title>
<path fill="none" stroke="black" d="M1216.59,-3953.44C1215.05,-3941.61 1213.22,-3927.6 1211.65,-3915.55"/>
<polygon fill="black" stroke="black" points="1215.11,-3915.03 1210.35,-3905.57 1208.17,-3915.94 1215.11,-3915.03"/>
</g>
<!-- l0_exp9_gelu -->
<g id="node64" class="node">
<title>l0_exp9_gelu</title>
<polygon fill="none" stroke="black" points="1251,-3830.56 1165,-3830.56 1165,-3792.56 1251,-3792.56 1251,-3830.56"/>
<text text-anchor="middle" x="1208" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1208" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1208" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 36&#45;39</text>
</g>
<!-- l0_exp9_linear1&#45;&gt;l0_exp9_gelu -->
<g id="edge73" class="edge">
<title>l0_exp9_linear1&#45;&gt;l0_exp9_gelu</title>
<path fill="none" stroke="black" d="M1208,-3867.51C1208,-3859.44 1208,-3849.73 1208,-3840.74"/>
<polygon fill="black" stroke="black" points="1211.5,-3840.65 1208,-3830.65 1204.5,-3840.65 1211.5,-3840.65"/>
</g>
<!-- l0_exp9_linear2 -->
<g id="node65" class="node">
<title>l0_exp9_linear2</title>
<polygon fill="none" stroke="black" points="1290,-3755.56 1126,-3755.56 1126,-3717.56 1290,-3717.56 1290,-3755.56"/>
<text text-anchor="middle" x="1208" y="-3744.36" font-family="Arial" font-size="9.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="1208" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1208" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l0_exp9_gelu&#45;&gt;l0_exp9_linear2 -->
<g id="edge74" class="edge">
<title>l0_exp9_gelu&#45;&gt;l0_exp9_linear2</title>
<path fill="none" stroke="black" d="M1208,-3792.51C1208,-3784.44 1208,-3774.73 1208,-3765.74"/>
<polygon fill="black" stroke="black" points="1211.5,-3765.65 1208,-3755.65 1204.5,-3765.65 1211.5,-3765.65"/>
</g>
<!-- l0_scatter_9 -->
<g id="node66" class="node">
<title>l0_scatter_9</title>
<ellipse fill="none" stroke="black" cx="1214" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1214" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1214" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1214" y="-3641.49" font-family="Arial" font-size="9.00">GPU 36 → All GPUs</text>
</g>
<!-- l0_exp9_linear2&#45;&gt;l0_scatter_9 -->
<g id="edge75" class="edge">
<title>l0_exp9_linear2&#45;&gt;l0_scatter_9</title>
<path fill="none" stroke="black" d="M1209.36,-3717.21C1209.94,-3709.35 1210.65,-3699.89 1211.33,-3690.74"/>
<polygon fill="black" stroke="black" points="1214.83,-3690.86 1212.08,-3680.63 1207.84,-3690.34 1214.83,-3690.86"/>
</g>
<!-- l0_scatter_9&#45;&gt;l0_expert_agg -->
<g id="edge76" class="edge">
<title>l0_scatter_9&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M1257.9,-3632.46C1271.72,-3627.01 1287.24,-3621.79 1302,-3618.82 1537.57,-3571.34 3233.87,-3549.17 3690.85,-3544.02"/>
<polygon fill="black" stroke="black" points="3691.13,-3547.52 3701.09,-3543.9 3691.05,-3540.52 3691.13,-3547.52"/>
</g>
<!-- l0_exp10_linear1 -->
<g id="node69" class="node">
<title>l0_exp10_linear1</title>
<polygon fill="none" stroke="black" points="2162,-3905.56 1998,-3905.56 1998,-3867.56 2162,-3867.56 2162,-3905.56"/>
<text text-anchor="middle" x="2080" y="-3894.36" font-family="Arial" font-size="9.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="2080" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2080" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l0_gather_10&#45;&gt;l0_exp10_linear1 -->
<g id="edge79" class="edge">
<title>l0_gather_10&#45;&gt;l0_exp10_linear1</title>
<path fill="none" stroke="black" d="M2088.59,-3953.44C2087.05,-3941.61 2085.22,-3927.6 2083.65,-3915.55"/>
<polygon fill="black" stroke="black" points="2087.11,-3915.03 2082.35,-3905.57 2080.17,-3915.94 2087.11,-3915.03"/>
</g>
<!-- l0_exp10_gelu -->
<g id="node70" class="node">
<title>l0_exp10_gelu</title>
<polygon fill="none" stroke="black" points="2123,-3830.56 2037,-3830.56 2037,-3792.56 2123,-3792.56 2123,-3830.56"/>
<text text-anchor="middle" x="2080" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2080" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2080" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 40&#45;43</text>
</g>
<!-- l0_exp10_linear1&#45;&gt;l0_exp10_gelu -->
<g id="edge80" class="edge">
<title>l0_exp10_linear1&#45;&gt;l0_exp10_gelu</title>
<path fill="none" stroke="black" d="M2080,-3867.51C2080,-3859.44 2080,-3849.73 2080,-3840.74"/>
<polygon fill="black" stroke="black" points="2083.5,-3840.65 2080,-3830.65 2076.5,-3840.65 2083.5,-3840.65"/>
</g>
<!-- l0_exp10_linear2 -->
<g id="node71" class="node">
<title>l0_exp10_linear2</title>
<polygon fill="none" stroke="black" points="2162,-3755.56 1998,-3755.56 1998,-3717.56 2162,-3717.56 2162,-3755.56"/>
<text text-anchor="middle" x="2080" y="-3744.36" font-family="Arial" font-size="9.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="2080" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2080" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l0_exp10_gelu&#45;&gt;l0_exp10_linear2 -->
<g id="edge81" class="edge">
<title>l0_exp10_gelu&#45;&gt;l0_exp10_linear2</title>
<path fill="none" stroke="black" d="M2080,-3792.51C2080,-3784.44 2080,-3774.73 2080,-3765.74"/>
<polygon fill="black" stroke="black" points="2083.5,-3765.65 2080,-3755.65 2076.5,-3765.65 2083.5,-3765.65"/>
</g>
<!-- l0_scatter_10 -->
<g id="node72" class="node">
<title>l0_scatter_10</title>
<ellipse fill="none" stroke="black" cx="2086" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2086" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2086" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2086" y="-3641.49" font-family="Arial" font-size="9.00">GPU 40 → All GPUs</text>
</g>
<!-- l0_exp10_linear2&#45;&gt;l0_scatter_10 -->
<g id="edge82" class="edge">
<title>l0_exp10_linear2&#45;&gt;l0_scatter_10</title>
<path fill="none" stroke="black" d="M2081.36,-3717.21C2081.94,-3709.35 2082.65,-3699.89 2083.33,-3690.74"/>
<polygon fill="black" stroke="black" points="2086.83,-3690.86 2084.08,-3680.63 2079.84,-3690.34 2086.83,-3690.86"/>
</g>
<!-- l0_scatter_10&#45;&gt;l0_expert_agg -->
<g id="edge83" class="edge">
<title>l0_scatter_10&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M2129.93,-3632.61C2143.75,-3627.16 2159.26,-3621.91 2174,-3618.82 2464.29,-3557.85 3370.38,-3545.77 3690.55,-3543.4"/>
<polygon fill="black" stroke="black" points="3690.8,-3546.89 3700.77,-3543.32 3690.74,-3539.89 3690.8,-3546.89"/>
</g>
<!-- l0_exp11_linear1 -->
<g id="node75" class="node">
<title>l0_exp11_linear1</title>
<polygon fill="none" stroke="black" points="3456,-3905.56 3292,-3905.56 3292,-3867.56 3456,-3867.56 3456,-3905.56"/>
<text text-anchor="middle" x="3374" y="-3894.36" font-family="Arial" font-size="9.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3374" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3374" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l0_gather_11&#45;&gt;l0_exp11_linear1 -->
<g id="edge86" class="edge">
<title>l0_gather_11&#45;&gt;l0_exp11_linear1</title>
<path fill="none" stroke="black" d="M3382.59,-3953.44C3381.05,-3941.61 3379.22,-3927.6 3377.65,-3915.55"/>
<polygon fill="black" stroke="black" points="3381.11,-3915.03 3376.35,-3905.57 3374.17,-3915.94 3381.11,-3915.03"/>
</g>
<!-- l0_exp11_gelu -->
<g id="node76" class="node">
<title>l0_exp11_gelu</title>
<polygon fill="none" stroke="black" points="3417,-3830.56 3331,-3830.56 3331,-3792.56 3417,-3792.56 3417,-3830.56"/>
<text text-anchor="middle" x="3374" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3374" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3374" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 44&#45;47</text>
</g>
<!-- l0_exp11_linear1&#45;&gt;l0_exp11_gelu -->
<g id="edge87" class="edge">
<title>l0_exp11_linear1&#45;&gt;l0_exp11_gelu</title>
<path fill="none" stroke="black" d="M3374,-3867.51C3374,-3859.44 3374,-3849.73 3374,-3840.74"/>
<polygon fill="black" stroke="black" points="3377.5,-3840.65 3374,-3830.65 3370.5,-3840.65 3377.5,-3840.65"/>
</g>
<!-- l0_exp11_linear2 -->
<g id="node77" class="node">
<title>l0_exp11_linear2</title>
<polygon fill="none" stroke="black" points="3456,-3755.56 3292,-3755.56 3292,-3717.56 3456,-3717.56 3456,-3755.56"/>
<text text-anchor="middle" x="3374" y="-3744.36" font-family="Arial" font-size="9.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3374" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3374" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l0_exp11_gelu&#45;&gt;l0_exp11_linear2 -->
<g id="edge88" class="edge">
<title>l0_exp11_gelu&#45;&gt;l0_exp11_linear2</title>
<path fill="none" stroke="black" d="M3374,-3792.51C3374,-3784.44 3374,-3774.73 3374,-3765.74"/>
<polygon fill="black" stroke="black" points="3377.5,-3765.65 3374,-3755.65 3370.5,-3765.65 3377.5,-3765.65"/>
</g>
<!-- l0_scatter_11 -->
<g id="node78" class="node">
<title>l0_scatter_11</title>
<ellipse fill="none" stroke="black" cx="3380" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3380" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3380" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3380" y="-3641.49" font-family="Arial" font-size="9.00">GPU 44 → All GPUs</text>
</g>
<!-- l0_exp11_linear2&#45;&gt;l0_scatter_11 -->
<g id="edge89" class="edge">
<title>l0_exp11_linear2&#45;&gt;l0_scatter_11</title>
<path fill="none" stroke="black" d="M3375.36,-3717.21C3375.94,-3709.35 3376.65,-3699.89 3377.33,-3690.74"/>
<polygon fill="black" stroke="black" points="3380.83,-3690.86 3378.08,-3680.63 3373.84,-3690.34 3380.83,-3690.86"/>
</g>
<!-- l0_scatter_11&#45;&gt;l0_expert_agg -->
<g id="edge90" class="edge">
<title>l0_scatter_11&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M3426.6,-3633.31C3439.84,-3628.2 3454.37,-3622.96 3468,-3618.82 3544.61,-3595.54 3632.98,-3575.83 3699.87,-3562.31"/>
<polygon fill="black" stroke="black" points="3700.88,-3565.68 3709.99,-3560.28 3699.5,-3558.82 3700.88,-3565.68"/>
</g>
<!-- l0_exp12_linear1 -->
<g id="node81" class="node">
<title>l0_exp12_linear1</title>
<polygon fill="none" stroke="black" points="4201,-3905.56 4037,-3905.56 4037,-3867.56 4201,-3867.56 4201,-3905.56"/>
<text text-anchor="middle" x="4119" y="-3894.36" font-family="Arial" font-size="9.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="4119" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4119" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l0_gather_12&#45;&gt;l0_exp12_linear1 -->
<g id="edge93" class="edge">
<title>l0_gather_12&#45;&gt;l0_exp12_linear1</title>
<path fill="none" stroke="black" d="M4224,-3957.05C4203.09,-3943.21 4176.32,-3925.5 4155.04,-3911.41"/>
<polygon fill="black" stroke="black" points="4156.86,-3908.42 4146.59,-3905.82 4153,-3914.26 4156.86,-3908.42"/>
</g>
<!-- l0_exp12_gelu -->
<g id="node82" class="node">
<title>l0_exp12_gelu</title>
<polygon fill="none" stroke="black" points="4146,-3830.56 4060,-3830.56 4060,-3792.56 4146,-3792.56 4146,-3830.56"/>
<text text-anchor="middle" x="4103" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4103" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4103" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 48&#45;51</text>
</g>
<!-- l0_exp12_linear1&#45;&gt;l0_exp12_gelu -->
<g id="edge94" class="edge">
<title>l0_exp12_linear1&#45;&gt;l0_exp12_gelu</title>
<path fill="none" stroke="black" d="M4115.04,-3867.51C4113.26,-3859.35 4111.1,-3849.52 4109.11,-3840.45"/>
<polygon fill="black" stroke="black" points="4112.52,-3839.67 4106.97,-3830.65 4105.69,-3841.17 4112.52,-3839.67"/>
</g>
<!-- l0_exp12_linear2 -->
<g id="node83" class="node">
<title>l0_exp12_linear2</title>
<polygon fill="none" stroke="black" points="4106,-3755.56 3942,-3755.56 3942,-3717.56 4106,-3717.56 4106,-3755.56"/>
<text text-anchor="middle" x="4024" y="-3744.36" font-family="Arial" font-size="9.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="4024" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4024" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l0_exp12_gelu&#45;&gt;l0_exp12_linear2 -->
<g id="edge95" class="edge">
<title>l0_exp12_gelu&#45;&gt;l0_exp12_linear2</title>
<path fill="none" stroke="black" d="M4083.47,-3792.51C4073.69,-3783.48 4061.69,-3772.39 4051.04,-3762.55"/>
<polygon fill="black" stroke="black" points="4053.3,-3759.86 4043.58,-3755.65 4048.55,-3765.01 4053.3,-3759.86"/>
</g>
<!-- l0_scatter_12 -->
<g id="node84" class="node">
<title>l0_scatter_12</title>
<ellipse fill="none" stroke="black" cx="4002" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4002" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4002" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4002" y="-3641.49" font-family="Arial" font-size="9.00">GPU 48 → All GPUs</text>
</g>
<!-- l0_exp12_linear2&#45;&gt;l0_scatter_12 -->
<g id="edge96" class="edge">
<title>l0_exp12_linear2&#45;&gt;l0_scatter_12</title>
<path fill="none" stroke="black" d="M4019.01,-3717.21C4016.85,-3709.27 4014.24,-3699.69 4011.73,-3690.44"/>
<polygon fill="black" stroke="black" points="4015.06,-3689.36 4009.06,-3680.63 4008.31,-3691.2 4015.06,-3689.36"/>
</g>
<!-- l0_scatter_12&#45;&gt;l0_expert_agg -->
<g id="edge97" class="edge">
<title>l0_scatter_12&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M3963.35,-3631.24C3944.49,-3620.78 3920.91,-3607.69 3897.71,-3594.82"/>
<polygon fill="black" stroke="black" points="3899.29,-3591.69 3888.85,-3589.9 3895.89,-3597.81 3899.29,-3591.69"/>
</g>
<!-- l0_exp13_linear1 -->
<g id="node87" class="node">
<title>l0_exp13_linear1</title>
<polygon fill="none" stroke="black" points="5499,-3905.56 5335,-3905.56 5335,-3867.56 5499,-3867.56 5499,-3905.56"/>
<text text-anchor="middle" x="5417" y="-3894.36" font-family="Arial" font-size="9.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="5417" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5417" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l0_gather_13&#45;&gt;l0_exp13_linear1 -->
<g id="edge100" class="edge">
<title>l0_gather_13&#45;&gt;l0_exp13_linear1</title>
<path fill="none" stroke="black" d="M5522,-3957.05C5501.09,-3943.21 5474.32,-3925.5 5453.04,-3911.41"/>
<polygon fill="black" stroke="black" points="5454.86,-3908.42 5444.59,-3905.82 5451,-3914.26 5454.86,-3908.42"/>
</g>
<!-- l0_exp13_gelu -->
<g id="node88" class="node">
<title>l0_exp13_gelu</title>
<polygon fill="none" stroke="black" points="5444,-3830.56 5358,-3830.56 5358,-3792.56 5444,-3792.56 5444,-3830.56"/>
<text text-anchor="middle" x="5401" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5401" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5401" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 52&#45;55</text>
</g>
<!-- l0_exp13_linear1&#45;&gt;l0_exp13_gelu -->
<g id="edge101" class="edge">
<title>l0_exp13_linear1&#45;&gt;l0_exp13_gelu</title>
<path fill="none" stroke="black" d="M5413.04,-3867.51C5411.26,-3859.35 5409.1,-3849.52 5407.11,-3840.45"/>
<polygon fill="black" stroke="black" points="5410.52,-3839.67 5404.97,-3830.65 5403.69,-3841.17 5410.52,-3839.67"/>
</g>
<!-- l0_exp13_linear2 -->
<g id="node89" class="node">
<title>l0_exp13_linear2</title>
<polygon fill="none" stroke="black" points="5404,-3755.56 5240,-3755.56 5240,-3717.56 5404,-3717.56 5404,-3755.56"/>
<text text-anchor="middle" x="5322" y="-3744.36" font-family="Arial" font-size="9.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="5322" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5322" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l0_exp13_gelu&#45;&gt;l0_exp13_linear2 -->
<g id="edge102" class="edge">
<title>l0_exp13_gelu&#45;&gt;l0_exp13_linear2</title>
<path fill="none" stroke="black" d="M5381.47,-3792.51C5371.69,-3783.48 5359.69,-3772.39 5349.04,-3762.55"/>
<polygon fill="black" stroke="black" points="5351.3,-3759.86 5341.58,-3755.65 5346.55,-3765.01 5351.3,-3759.86"/>
</g>
<!-- l0_scatter_13 -->
<g id="node90" class="node">
<title>l0_scatter_13</title>
<ellipse fill="none" stroke="black" cx="5300" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5300" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5300" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5300" y="-3641.49" font-family="Arial" font-size="9.00">GPU 52 → All GPUs</text>
</g>
<!-- l0_exp13_linear2&#45;&gt;l0_scatter_13 -->
<g id="edge103" class="edge">
<title>l0_exp13_linear2&#45;&gt;l0_scatter_13</title>
<path fill="none" stroke="black" d="M5317.01,-3717.21C5314.85,-3709.27 5312.24,-3699.69 5309.73,-3690.44"/>
<polygon fill="black" stroke="black" points="5313.06,-3689.36 5307.06,-3680.63 5306.31,-3691.2 5313.06,-3689.36"/>
</g>
<!-- l0_scatter_13&#45;&gt;l0_expert_agg -->
<g id="edge104" class="edge">
<title>l0_scatter_13&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M5251.74,-3634.08C5234.42,-3628.18 5214.57,-3622.29 5196,-3618.82 4952.5,-3573.33 4208.42,-3551.99 3919.97,-3545.27"/>
<polygon fill="black" stroke="black" points="3919.98,-3541.77 3909.9,-3545.04 3919.81,-3548.77 3919.98,-3541.77"/>
</g>
<!-- l0_exp14_linear1 -->
<g id="node93" class="node">
<title>l0_exp14_linear1</title>
<polygon fill="none" stroke="black" points="6371,-3905.56 6207,-3905.56 6207,-3867.56 6371,-3867.56 6371,-3905.56"/>
<text text-anchor="middle" x="6289" y="-3894.36" font-family="Arial" font-size="9.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="6289" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6289" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l0_gather_14&#45;&gt;l0_exp14_linear1 -->
<g id="edge107" class="edge">
<title>l0_gather_14&#45;&gt;l0_exp14_linear1</title>
<path fill="none" stroke="black" d="M6394,-3957.05C6373.09,-3943.21 6346.32,-3925.5 6325.04,-3911.41"/>
<polygon fill="black" stroke="black" points="6326.86,-3908.42 6316.59,-3905.82 6323,-3914.26 6326.86,-3908.42"/>
</g>
<!-- l0_exp14_gelu -->
<g id="node94" class="node">
<title>l0_exp14_gelu</title>
<polygon fill="none" stroke="black" points="6316,-3830.56 6230,-3830.56 6230,-3792.56 6316,-3792.56 6316,-3830.56"/>
<text text-anchor="middle" x="6273" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6273" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6273" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 56&#45;59</text>
</g>
<!-- l0_exp14_linear1&#45;&gt;l0_exp14_gelu -->
<g id="edge108" class="edge">
<title>l0_exp14_linear1&#45;&gt;l0_exp14_gelu</title>
<path fill="none" stroke="black" d="M6285.04,-3867.51C6283.26,-3859.35 6281.1,-3849.52 6279.11,-3840.45"/>
<polygon fill="black" stroke="black" points="6282.52,-3839.67 6276.97,-3830.65 6275.69,-3841.17 6282.52,-3839.67"/>
</g>
<!-- l0_exp14_linear2 -->
<g id="node95" class="node">
<title>l0_exp14_linear2</title>
<polygon fill="none" stroke="black" points="6276,-3755.56 6112,-3755.56 6112,-3717.56 6276,-3717.56 6276,-3755.56"/>
<text text-anchor="middle" x="6194" y="-3744.36" font-family="Arial" font-size="9.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="6194" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6194" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l0_exp14_gelu&#45;&gt;l0_exp14_linear2 -->
<g id="edge109" class="edge">
<title>l0_exp14_gelu&#45;&gt;l0_exp14_linear2</title>
<path fill="none" stroke="black" d="M6253.47,-3792.51C6243.69,-3783.48 6231.69,-3772.39 6221.04,-3762.55"/>
<polygon fill="black" stroke="black" points="6223.3,-3759.86 6213.58,-3755.65 6218.55,-3765.01 6223.3,-3759.86"/>
</g>
<!-- l0_scatter_14 -->
<g id="node96" class="node">
<title>l0_scatter_14</title>
<ellipse fill="none" stroke="black" cx="6172" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6172" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6172" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6172" y="-3641.49" font-family="Arial" font-size="9.00">GPU 56 → All GPUs</text>
</g>
<!-- l0_exp14_linear2&#45;&gt;l0_scatter_14 -->
<g id="edge110" class="edge">
<title>l0_exp14_linear2&#45;&gt;l0_scatter_14</title>
<path fill="none" stroke="black" d="M6189.01,-3717.21C6186.85,-3709.27 6184.24,-3699.69 6181.73,-3690.44"/>
<polygon fill="black" stroke="black" points="6185.06,-3689.36 6179.06,-3680.63 6178.31,-3691.2 6185.06,-3689.36"/>
</g>
<!-- l0_scatter_14&#45;&gt;l0_expert_agg -->
<g id="edge111" class="edge">
<title>l0_scatter_14&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M6124.04,-3633.95C6106.66,-3628 6086.7,-3622.11 6068,-3618.82 5648.58,-3545.01 4318.5,-3541.69 3918.73,-3542.42"/>
<polygon fill="black" stroke="black" points="3918.59,-3538.92 3908.6,-3542.44 3918.61,-3545.92 3918.59,-3538.92"/>
</g>
<!-- l0_exp15_linear1 -->
<g id="node99" class="node">
<title>l0_exp15_linear1</title>
<polygon fill="none" stroke="black" points="6932,-3905.56 6768,-3905.56 6768,-3867.56 6932,-3867.56 6932,-3905.56"/>
<text text-anchor="middle" x="6850" y="-3894.36" font-family="Arial" font-size="9.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="6850" y="-3884.36" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6850" y="-3874.36" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l0_gather_15&#45;&gt;l0_exp15_linear1 -->
<g id="edge114" class="edge">
<title>l0_gather_15&#45;&gt;l0_exp15_linear1</title>
<path fill="none" stroke="black" d="M6864.32,-3953.44C6861.75,-3941.61 6858.7,-3927.6 6856.09,-3915.55"/>
<polygon fill="black" stroke="black" points="6859.46,-3914.6 6853.92,-3905.57 6852.62,-3916.09 6859.46,-3914.6"/>
</g>
<!-- l0_exp15_gelu -->
<g id="node100" class="node">
<title>l0_exp15_gelu</title>
<polygon fill="none" stroke="black" points="6758,-3830.56 6672,-3830.56 6672,-3792.56 6758,-3792.56 6758,-3830.56"/>
<text text-anchor="middle" x="6715" y="-3819.36" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6715" y="-3809.36" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6715" y="-3799.36" font-family="Arial" font-size="9.00">GPUs 60&#45;63</text>
</g>
<!-- l0_exp15_linear1&#45;&gt;l0_exp15_gelu -->
<g id="edge115" class="edge">
<title>l0_exp15_linear1&#45;&gt;l0_exp15_gelu</title>
<path fill="none" stroke="black" d="M6767.81,-3872.91C6753.2,-3867.62 6739.13,-3860.13 6728,-3849.56 6725.22,-3846.92 6723.04,-3843.65 6721.32,-3840.15"/>
<polygon fill="black" stroke="black" points="6724.55,-3838.8 6717.77,-3830.66 6717.99,-3841.25 6724.55,-3838.8"/>
</g>
<!-- l0_exp15_linear2 -->
<g id="node101" class="node">
<title>l0_exp15_linear2</title>
<polygon fill="none" stroke="black" points="6718,-3755.56 6554,-3755.56 6554,-3717.56 6718,-3717.56 6718,-3755.56"/>
<text text-anchor="middle" x="6636" y="-3744.36" font-family="Arial" font-size="9.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="6636" y="-3734.36" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6636" y="-3724.36" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l0_exp15_gelu&#45;&gt;l0_exp15_linear2 -->
<g id="edge116" class="edge">
<title>l0_exp15_gelu&#45;&gt;l0_exp15_linear2</title>
<path fill="none" stroke="black" d="M6679.47,-3792.41C6671.5,-3787.32 6663.49,-3781.31 6657,-3774.56 6654.14,-3771.59 6651.54,-3768.16 6649.2,-3764.6"/>
<polygon fill="black" stroke="black" points="6652.07,-3762.57 6643.99,-3755.72 6646.03,-3766.12 6652.07,-3762.57"/>
</g>
<!-- l0_scatter_15 -->
<g id="node102" class="node">
<title>l0_scatter_15</title>
<ellipse fill="none" stroke="black" cx="6614" cy="-3653.69" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6614" y="-3661.49" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6614" y="-3651.49" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6614" y="-3641.49" font-family="Arial" font-size="9.00">GPU 60 → All GPUs</text>
</g>
<!-- l0_exp15_linear2&#45;&gt;l0_scatter_15 -->
<g id="edge117" class="edge">
<title>l0_exp15_linear2&#45;&gt;l0_scatter_15</title>
<path fill="none" stroke="black" d="M6631.01,-3717.21C6628.85,-3709.27 6626.24,-3699.69 6623.73,-3690.44"/>
<polygon fill="black" stroke="black" points="6627.06,-3689.36 6621.06,-3680.63 6620.31,-3691.2 6627.06,-3689.36"/>
</g>
<!-- l0_scatter_15&#45;&gt;l0_expert_agg -->
<g id="edge118" class="edge">
<title>l0_scatter_15&#45;&gt;l0_expert_agg</title>
<path fill="none" stroke="black" d="M6566.31,-3633.98C6548.87,-3627.99 6528.8,-3622.07 6510,-3618.82 6252.72,-3574.27 4402.99,-3549.79 3919.42,-3544.11"/>
<polygon fill="black" stroke="black" points="3919.33,-3540.61 3909.29,-3543.99 3919.25,-3547.61 3919.33,-3540.61"/>
</g>
<!-- l0_expert_agg&#45;&gt;l0_moe_res -->
<g id="edge119" class="edge">
<title>l0_expert_agg&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M3901.49,-3529.82C4087.63,-3508.82 4492.08,-3463.2 4683.53,-3441.6"/>
<polygon fill="black" stroke="black" points="4684.05,-3445.07 4693.6,-3440.47 4683.27,-3438.11 4684.05,-3445.07"/>
</g>
<!-- l1_mha_qkv -->
<g id="node105" class="node">
<title>l1_mha_qkv</title>
<polygon fill="none" stroke="black" points="4791.5,-3296.82 4638.5,-3296.82 4638.5,-3258.82 4791.5,-3258.82 4791.5,-3296.82"/>
<text text-anchor="middle" x="4715" y="-3285.62" font-family="Arial" font-size="9.00">MHA QKV Linear</text>
<text text-anchor="middle" x="4715" y="-3275.62" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="4715" y="-3265.62" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l0_moe_res&#45;&gt;l1_mha_qkv -->
<g id="edge121" class="edge">
<title>l0_moe_res&#45;&gt;l1_mha_qkv</title>
<path fill="none" stroke="black" d="M4774.61,-3400.49C4761.49,-3373.7 4741.59,-3333.09 4728.45,-3306.27"/>
<polygon fill="black" stroke="black" points="4731.48,-3304.5 4723.94,-3297.06 4725.19,-3307.58 4731.48,-3304.5"/>
</g>
<!-- l1_mha_res -->
<g id="node108" class="node">
<title>l1_mha_res</title>
<polygon fill="none" stroke="black" points="4881.91,-3061.82 4670.48,-3061.82 4616.09,-3005.82 4827.52,-3005.82 4881.91,-3061.82"/>
<text text-anchor="middle" x="4749" y="-3036.62" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="4749" y="-3026.62" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l0_moe_res&#45;&gt;l1_mha_res -->
<g id="edge125" class="edge">
<title>l0_moe_res&#45;&gt;l1_mha_res</title>
<path fill="none" stroke="black" d="M4797.43,-3400.73C4806.87,-3371.16 4820,-3322.21 4820,-3278.82 4820,-3278.82 4820,-3278.82 4820,-3126.82 4820,-3104.8 4807.1,-3084.83 4792.29,-3069.17"/>
<polygon fill="black" stroke="black" points="4794.47,-3066.41 4784.92,-3061.84 4789.54,-3071.37 4794.47,-3066.41"/>
</g>
<!-- l1_mha_attn -->
<g id="node106" class="node">
<title>l1_mha_attn</title>
<polygon fill="none" stroke="black" points="4758.5,-3221.82 4675.5,-3221.82 4675.5,-3183.82 4758.5,-3183.82 4758.5,-3221.82"/>
<text text-anchor="middle" x="4717" y="-3210.62" font-family="Arial" font-size="9.00">MHA Attention</text>
<text text-anchor="middle" x="4717" y="-3200.62" font-family="Arial" font-size="9.00">[1024, 16×512]</text>
<text text-anchor="middle" x="4717" y="-3190.62" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l1_mha_qkv&#45;&gt;l1_mha_attn -->
<g id="edge122" class="edge">
<title>l1_mha_qkv&#45;&gt;l1_mha_attn</title>
<path fill="none" stroke="black" d="M4715.49,-3258.77C4715.72,-3250.7 4715.98,-3240.99 4716.23,-3232"/>
<polygon fill="black" stroke="black" points="4719.73,-3232 4716.5,-3221.91 4712.73,-3231.81 4719.73,-3232"/>
</g>
<!-- l1_mha_out -->
<g id="node107" class="node">
<title>l1_mha_out</title>
<polygon fill="none" stroke="black" points="4789,-3146.82 4657,-3146.82 4657,-3108.82 4789,-3108.82 4789,-3146.82"/>
<text text-anchor="middle" x="4723" y="-3135.62" font-family="Arial" font-size="9.00">MHA Output Linear</text>
<text text-anchor="middle" x="4723" y="-3125.62" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="4723" y="-3115.62" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l1_mha_attn&#45;&gt;l1_mha_out -->
<g id="edge123" class="edge">
<title>l1_mha_attn&#45;&gt;l1_mha_out</title>
<path fill="none" stroke="black" d="M4718.48,-3183.77C4719.15,-3175.7 4719.94,-3165.99 4720.68,-3157"/>
<polygon fill="black" stroke="black" points="4724.18,-3157.16 4721.51,-3146.91 4717.21,-3156.59 4724.18,-3157.16"/>
</g>
<!-- l1_mha_out&#45;&gt;l1_mha_res -->
<g id="edge124" class="edge">
<title>l1_mha_out&#45;&gt;l1_mha_res</title>
<path fill="none" stroke="black" d="M4728.14,-3108.64C4731.1,-3098.15 4734.94,-3084.56 4738.52,-3071.9"/>
<polygon fill="black" stroke="black" points="4741.96,-3072.61 4741.31,-3062.03 4735.22,-3070.7 4741.96,-3072.61"/>
</g>
<!-- l1_global_gate -->
<g id="node109" class="node">
<title>l1_global_gate</title>
<polygon fill="none" stroke="black" points="4580.47,-3071.82 4379.29,-3071.82 4327.53,-2995.82 4528.71,-2995.82 4580.47,-3071.82"/>
<text text-anchor="middle" x="4454" y="-3041.62" font-family="Arial" font-size="9.00">Global Gate</text>
<text text-anchor="middle" x="4454" y="-3031.62" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="4454" y="-3021.62" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_global_gate -->
<g id="edge126" class="edge">
<title>l1_mha_res&#45;&gt;l1_global_gate</title>
<path fill="none" stroke="black" d="M4643.19,-3033.82C4617.08,-3033.82 4590.96,-3033.82 4564.84,-3033.82"/>
<polygon fill="black" stroke="black" points="4564.83,-3030.32 4554.83,-3033.82 4564.83,-3037.32 4564.83,-3030.32"/>
</g>
<!-- l1_gather_0 -->
<g id="node111" class="node">
<title>l1_gather_0</title>
<ellipse fill="none" stroke="black" cx="3877" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3877" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3877" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3877" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 16</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_0 -->
<g id="edge128" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_0</title>
<path fill="none" stroke="black" d="M4660.07,-3005.73C4644.19,-3001.78 4627.71,-2998.23 4612,-2995.82 4576.11,-2990.3 3992.21,-2983.5 3959,-2968.82 3935.22,-2958.3 3914.68,-2937.47 3900.1,-2919.31"/>
<polygon fill="black" stroke="black" points="3902.71,-2916.97 3893.83,-2911.2 3897.18,-2921.25 3902.71,-2916.97"/>
</g>
<!-- l1_gather_1 -->
<g id="node117" class="node">
<title>l1_gather_1</title>
<ellipse fill="none" stroke="black" cx="5621" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5621" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5621" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5621" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 20</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_1 -->
<g id="edge135" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_1</title>
<path fill="none" stroke="black" d="M4854.49,-3033.52C5041.62,-3033.27 5423.19,-3025.52 5542,-2968.82 5564.89,-2957.9 5584.57,-2937.27 5598.56,-2919.31"/>
<polygon fill="black" stroke="black" points="5601.38,-2921.39 5604.58,-2911.3 5595.78,-2917.19 5601.38,-2921.39"/>
</g>
<!-- l1_gather_2 -->
<g id="node123" class="node">
<title>l1_gather_2</title>
<ellipse fill="none" stroke="black" cx="3447" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3447" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3447" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3447" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 24</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_2 -->
<g id="edge142" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_2</title>
<path fill="none" stroke="black" d="M4661.21,-3005.79C4644.99,-3001.75 4628.09,-2998.16 4612,-2995.82 4552.44,-2987.16 3584.24,-2992.71 3529,-2968.82 3505.14,-2958.5 3484.59,-2937.66 3470.03,-2919.45"/>
<polygon fill="black" stroke="black" points="3472.65,-2917.11 3463.78,-2911.32 3467.1,-2921.38 3472.65,-2917.11"/>
</g>
<!-- l1_gather_3 -->
<g id="node129" class="node">
<title>l1_gather_3</title>
<ellipse fill="none" stroke="black" cx="1285" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1285" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1285" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1285" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 28</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_3 -->
<g id="edge149" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_3</title>
<path fill="none" stroke="black" d="M4661.98,-3005.74C4645.53,-3001.64 4628.36,-2998.05 4612,-2995.82 4468.38,-2976.26 2147.94,-2979.34 2003,-2977.82 1994.17,-2977.73 1375.13,-2972.28 1367,-2968.82 1342.92,-2958.56 1322.26,-2937.51 1307.7,-2919.18"/>
<polygon fill="black" stroke="black" points="1310.3,-2916.82 1301.45,-2911 1304.74,-2921.07 1310.3,-2916.82"/>
</g>
<!-- l1_gather_4 -->
<g id="node135" class="node">
<title>l1_gather_4</title>
<ellipse fill="none" stroke="black" cx="4749" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4749" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4749" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4749" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 32</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_4 -->
<g id="edge156" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_4</title>
<path fill="none" stroke="black" d="M4749,-3005.51C4749,-2982.02 4749,-2947.92 4749,-2922.13"/>
<polygon fill="black" stroke="black" points="4752.5,-2921.99 4749,-2911.99 4745.5,-2921.99 4752.5,-2921.99"/>
</g>
<!-- l1_gather_5 -->
<g id="node141" class="node">
<title>l1_gather_5</title>
<ellipse fill="none" stroke="black" cx="2575" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2575" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2575" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2575" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 36</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_5 -->
<g id="edge163" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_5</title>
<path fill="none" stroke="black" d="M4661.97,-3005.81C4645.53,-3001.71 4628.35,-2998.09 4612,-2995.82 4451.2,-2973.48 3313.33,-2980.3 3151,-2977.82 3123.55,-2977.4 2682.23,-2979.63 2657,-2968.82 2632.94,-2958.51 2612.28,-2937.46 2597.71,-2919.14"/>
<polygon fill="black" stroke="black" points="2600.32,-2916.78 2591.46,-2910.97 2594.76,-2921.04 2600.32,-2916.78"/>
</g>
<!-- l1_gather_6 -->
<g id="node147" class="node">
<title>l1_gather_6</title>
<ellipse fill="none" stroke="black" cx="6051" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6051" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6051" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6051" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 40</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_6 -->
<g id="edge170" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_6</title>
<path fill="none" stroke="black" d="M4852.77,-3031.77C5129.65,-3028.35 5871.74,-3014.94 5972,-2968.82 5995.2,-2958.15 6014.99,-2937.31 6028.96,-2919.19"/>
<polygon fill="black" stroke="black" points="6031.82,-2921.22 6034.96,-2911.1 6026.19,-2917.05 6031.82,-2921.22"/>
</g>
<!-- l1_gather_7 -->
<g id="node153" class="node">
<title>l1_gather_7</title>
<ellipse fill="none" stroke="black" cx="1715" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1715" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1715" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1715" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 44</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_7 -->
<g id="edge177" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_7</title>
<path fill="none" stroke="black" d="M4661.98,-3005.75C4645.53,-3001.65 4628.35,-2998.05 4612,-2995.82 4483.25,-2978.23 2402.94,-2979.55 2273,-2977.82 2246.55,-2977.47 1821.31,-2979.24 1797,-2968.82 1772.95,-2958.5 1752.28,-2937.45 1737.72,-2919.14"/>
<polygon fill="black" stroke="black" points="1740.32,-2916.78 1731.46,-2910.96 1734.76,-2921.03 1740.32,-2916.78"/>
</g>
<!-- l1_gather_8 -->
<g id="node159" class="node">
<title>l1_gather_8</title>
<ellipse fill="none" stroke="black" cx="6923" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6923" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6923" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6923" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 48</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_8 -->
<g id="edge184" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_8</title>
<path fill="none" stroke="black" d="M4853.05,-3031.83C5263.51,-3027.66 6752.41,-3009.76 6844,-2968.82 6867.31,-2958.4 6887.1,-2937.57 6901.05,-2919.38"/>
<polygon fill="black" stroke="black" points="6903.92,-2921.38 6907.03,-2911.26 6898.28,-2917.23 6903.92,-2921.38"/>
</g>
<!-- l1_gather_9 -->
<g id="node165" class="node">
<title>l1_gather_9</title>
<ellipse fill="none" stroke="black" cx="2145" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2145" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2145" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2145" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 52</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_9 -->
<g id="edge191" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_9</title>
<path fill="none" stroke="black" d="M4661.98,-3005.78C4645.53,-3001.68 4628.35,-2998.07 4612,-2995.82 4515.41,-2982.5 2954.5,-2979.01 2857,-2977.82 2787,-2976.96 2291.4,-2996.27 2227,-2968.82 2202.92,-2958.56 2182.26,-2937.51 2167.7,-2919.18"/>
<polygon fill="black" stroke="black" points="2170.3,-2916.82 2161.45,-2911 2164.74,-2921.07 2170.3,-2916.82"/>
</g>
<!-- l1_gather_10 -->
<g id="node171" class="node">
<title>l1_gather_10</title>
<ellipse fill="none" stroke="black" cx="3017" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3017" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3017" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3017" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 56</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_10 -->
<g id="edge198" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_10</title>
<path fill="none" stroke="black" d="M4661.6,-3005.79C4645.26,-3001.72 4628.22,-2998.12 4612,-2995.82 4500.21,-2979.98 3708.89,-2979.84 3596,-2977.82 3540.78,-2976.83 3149.77,-2990.57 3099,-2968.82 3074.94,-2958.51 3054.28,-2937.46 3039.71,-2919.14"/>
<polygon fill="black" stroke="black" points="3042.32,-2916.78 3033.46,-2910.97 3036.76,-2921.04 3042.32,-2916.78"/>
</g>
<!-- l1_gather_11 -->
<g id="node177" class="node">
<title>l1_gather_11</title>
<ellipse fill="none" stroke="black" cx="4319" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4319" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4319" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4319" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 60</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_11 -->
<g id="edge205" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_11</title>
<path fill="none" stroke="black" d="M4655.44,-3005.73C4640.97,-3002.07 4626.14,-2998.62 4612,-2995.82 4519.26,-2977.45 4485.74,-3010.74 4401,-2968.82 4377.86,-2957.37 4357.43,-2936.74 4342.75,-2918.92"/>
<polygon fill="black" stroke="black" points="4345.39,-2916.61 4336.42,-2910.97 4339.91,-2920.97 4345.39,-2916.61"/>
</g>
<!-- l1_gather_12 -->
<g id="node183" class="node">
<title>l1_gather_12</title>
<ellipse fill="none" stroke="black" cx="5191" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5191" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5191" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5191" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 64</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_12 -->
<g id="edge212" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_12</title>
<path fill="none" stroke="black" d="M4852.8,-3031.62C4928.63,-3026.81 5031.78,-3011.84 5112,-2968.82 5134,-2957.02 5153.41,-2936.85 5167.48,-2919.35"/>
<polygon fill="black" stroke="black" points="5170.58,-2921.06 5173.95,-2911.02 5165.06,-2916.77 5170.58,-2921.06"/>
</g>
<!-- l1_gather_13 -->
<g id="node189" class="node">
<title>l1_gather_13</title>
<ellipse fill="none" stroke="black" cx="6493" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6493" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6493" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6493" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 68</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_13 -->
<g id="edge219" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_13</title>
<path fill="none" stroke="black" d="M4854.33,-3033.35C5197.98,-3034.46 6272.55,-3032.71 6414,-2968.82 6437.27,-2958.31 6457.06,-2937.47 6471.02,-2919.31"/>
<polygon fill="black" stroke="black" points="6473.88,-2921.32 6477.01,-2911.2 6468.25,-2917.16 6473.88,-2921.32"/>
</g>
<!-- l1_gather_14 -->
<g id="node195" class="node">
<title>l1_gather_14</title>
<ellipse fill="none" stroke="black" cx="7365" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7365" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7365" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7365" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 72</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_14 -->
<g id="edge226" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_14</title>
<path fill="none" stroke="black" d="M4853.5,-3032.41C5317.49,-3030.32 7173.3,-3018.83 7286,-2968.82 7309.34,-2958.46 7329.13,-2937.63 7343.07,-2919.43"/>
<polygon fill="black" stroke="black" points="7345.94,-2921.42 7349.05,-2911.29 7340.31,-2917.27 7345.94,-2921.42"/>
</g>
<!-- l1_gather_15 -->
<g id="node201" class="node">
<title>l1_gather_15</title>
<ellipse fill="none" stroke="black" cx="7807" cy="-2884.82" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7807" y="-2892.62" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7807" y="-2882.62" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7807" y="-2872.62" font-family="Arial" font-size="9.00">All GPUs → GPU 76</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_gather_15 -->
<g id="edge233" class="edge">
<title>l1_mha_res&#45;&gt;l1_gather_15</title>
<path fill="none" stroke="black" d="M4851.82,-3030.68C5375.73,-3019.75 7723.8,-2970.67 7728,-2968.82 7751.36,-2958.51 7771.15,-2937.67 7785.08,-2919.46"/>
<polygon fill="black" stroke="black" points="7787.96,-2921.45 7791.06,-2911.32 7782.32,-2917.31 7787.96,-2921.45"/>
</g>
<!-- l1_moe_res -->
<g id="node207" class="node">
<title>l1_moe_res</title>
<polygon fill="none" stroke="black" points="5256.91,-2361.08 5045.48,-2361.08 4991.09,-2305.08 5202.52,-2305.08 5256.91,-2361.08"/>
<text text-anchor="middle" x="5124" y="-2335.88" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="5124" y="-2325.88" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l1_mha_res&#45;&gt;l1_moe_res -->
<g id="edge240" class="edge">
<title>l1_mha_res&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M4853.65,-3032.59C5392.62,-3031.19 7832.41,-3021.91 7889,-2968.82 7916,-2943.49 7896,-2922.84 7896,-2885.82 7896,-2885.82 7896,-2885.82 7896,-2445.08 7896,-2377.63 5772.25,-2343.21 5242.57,-2335.68"/>
<polygon fill="black" stroke="black" points="5242.29,-2332.18 5232.24,-2335.53 5242.19,-2339.17 5242.29,-2332.18"/>
</g>
<!-- l1_route_0 -->
<g id="node110" class="node">
<title>l1_route_0</title>
<polygon fill="none" stroke="black" points="3789.32,-2922.82 3591.55,-2922.82 3540.68,-2846.82 3738.45,-2846.82 3789.32,-2922.82"/>
<text text-anchor="middle" x="3665" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3665" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 0</text>
<text text-anchor="middle" x="3665" y="-2872.62" font-family="Arial" font-size="9.00">GPU 16</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_0 -->
<g id="edge127" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4349.55,-3028.44C4190.96,-3020.81 3897.34,-3002.58 3798,-2968.82 3770.92,-2959.62 3743.67,-2943.98 3720.94,-2928.75"/>
<polygon fill="black" stroke="black" points="3722.69,-2925.71 3712.46,-2922.95 3718.74,-2931.49 3722.69,-2925.71"/>
</g>
<!-- l1_route_1 -->
<g id="node116" class="node">
<title>l1_route_1</title>
<polygon fill="none" stroke="black" points="5533.32,-2922.82 5335.55,-2922.82 5284.68,-2846.82 5482.45,-2846.82 5533.32,-2922.82"/>
<text text-anchor="middle" x="5409" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5409" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 1</text>
<text text-anchor="middle" x="5409" y="-2872.62" font-family="Arial" font-size="9.00">GPU 20</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_1 -->
<g id="edge134" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.9,-3008.97C4559.29,-3003.76 4582.36,-2998.89 4604,-2995.82 4751.31,-2974.9 5130.6,-3011.96 5273,-2968.82 5301.41,-2960.21 5329.9,-2944.23 5353.41,-2928.58"/>
<polygon fill="black" stroke="black" points="5355.55,-2931.36 5361.84,-2922.84 5351.61,-2925.58 5355.55,-2931.36"/>
</g>
<!-- l1_route_2 -->
<g id="node122" class="node">
<title>l1_route_2</title>
<polygon fill="none" stroke="black" points="3359.32,-2922.82 3161.55,-2922.82 3110.68,-2846.82 3308.45,-2846.82 3359.32,-2922.82"/>
<text text-anchor="middle" x="3235" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3235" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 2</text>
<text text-anchor="middle" x="3235" y="-2872.62" font-family="Arial" font-size="9.00">GPU 24</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_2 -->
<g id="edge141" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.82,-3033.21C4119.43,-3033.08 3549.53,-3026.65 3368,-2968.82 3340.52,-2960.06 3313,-2944.34 3290.19,-2928.91"/>
<polygon fill="black" stroke="black" points="3291.9,-2925.84 3281.68,-2923.03 3287.91,-2931.59 3291.9,-2925.84"/>
</g>
<!-- l1_route_3 -->
<g id="node128" class="node">
<title>l1_route_3</title>
<polygon fill="none" stroke="black" points="1197.32,-2922.82 999.55,-2922.82 948.68,-2846.82 1146.45,-2846.82 1197.32,-2922.82"/>
<text text-anchor="middle" x="1073" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1073" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 3</text>
<text text-anchor="middle" x="1073" y="-2872.62" font-family="Arial" font-size="9.00">GPU 28</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_3 -->
<g id="edge148" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.34,-3032.34C3818.75,-3029.61 1360.17,-3014.62 1206,-2968.82 1177.88,-2960.46 1149.87,-2944.44 1126.86,-2928.67"/>
<polygon fill="black" stroke="black" points="1128.81,-2925.77 1118.61,-2922.89 1124.79,-2931.5 1128.81,-2925.77"/>
</g>
<!-- l1_route_4 -->
<g id="node134" class="node">
<title>l1_route_4</title>
<polygon fill="none" stroke="black" points="4661.32,-2922.82 4463.55,-2922.82 4412.68,-2846.82 4610.45,-2846.82 4661.32,-2922.82"/>
<text text-anchor="middle" x="4537" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4537" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 4</text>
<text text-anchor="middle" x="4537" y="-2872.62" font-family="Arial" font-size="9.00">GPU 32</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_4 -->
<g id="edge155" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4474.94,-2995.72C4485.9,-2976.31 4499.42,-2952.37 4511.04,-2931.79"/>
<polygon fill="black" stroke="black" points="4514.19,-2933.33 4516.06,-2922.9 4508.1,-2929.89 4514.19,-2933.33"/>
</g>
<!-- l1_route_5 -->
<g id="node140" class="node">
<title>l1_route_5</title>
<polygon fill="none" stroke="black" points="2487.32,-2922.82 2289.55,-2922.82 2238.68,-2846.82 2436.45,-2846.82 2487.32,-2922.82"/>
<text text-anchor="middle" x="2363" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2363" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 5</text>
<text text-anchor="middle" x="2363" y="-2872.62" font-family="Arial" font-size="9.00">GPU 36</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_5 -->
<g id="edge162" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.35,-3032.58C3975.94,-3031.29 2673.85,-3022.92 2496,-2968.82 2468.05,-2960.32 2440.17,-2944.36 2417.2,-2928.69"/>
<polygon fill="black" stroke="black" points="2419.17,-2925.79 2408.97,-2922.94 2415.16,-2931.53 2419.17,-2925.79"/>
</g>
<!-- l1_route_6 -->
<g id="node146" class="node">
<title>l1_route_6</title>
<polygon fill="none" stroke="black" points="5963.32,-2922.82 5765.55,-2922.82 5714.68,-2846.82 5912.45,-2846.82 5963.32,-2922.82"/>
<text text-anchor="middle" x="5839" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5839" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 6</text>
<text text-anchor="middle" x="5839" y="-2872.62" font-family="Arial" font-size="9.00">GPU 40</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_6 -->
<g id="edge169" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.87,-3008.73C4559.26,-3003.53 4582.33,-2998.72 4604,-2995.82 4725.07,-2979.6 5585.82,-3003.31 5703,-2968.82 5731.6,-2960.4 5760.22,-2944.36 5783.77,-2928.61"/>
<polygon fill="black" stroke="black" points="5785.94,-2931.37 5792.21,-2922.83 5781.98,-2925.59 5785.94,-2931.37"/>
</g>
<!-- l1_route_7 -->
<g id="node152" class="node">
<title>l1_route_7</title>
<polygon fill="none" stroke="black" points="1627.32,-2922.82 1429.55,-2922.82 1378.68,-2846.82 1576.45,-2846.82 1627.32,-2922.82"/>
<text text-anchor="middle" x="1503" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1503" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 7</text>
<text text-anchor="middle" x="1503" y="-2872.62" font-family="Arial" font-size="9.00">GPU 44</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_7 -->
<g id="edge176" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.02,-3032.01C3862.12,-3027.96 1768.42,-3008.38 1636,-2968.82 1607.9,-2960.42 1579.88,-2944.39 1556.87,-2928.63"/>
<polygon fill="black" stroke="black" points="1558.82,-2925.73 1548.62,-2922.85 1554.8,-2931.46 1558.82,-2925.73"/>
</g>
<!-- l1_route_8 -->
<g id="node158" class="node">
<title>l1_route_8</title>
<polygon fill="none" stroke="black" points="6835.32,-2922.82 6637.55,-2922.82 6586.68,-2846.82 6784.45,-2846.82 6835.32,-2922.82"/>
<text text-anchor="middle" x="6711" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6711" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 8</text>
<text text-anchor="middle" x="6711" y="-2872.62" font-family="Arial" font-size="9.00">GPU 48</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_8 -->
<g id="edge183" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.45,-3008.64C4558.95,-3003.41 4582.18,-2998.61 4604,-2995.82 4760.4,-2975.81 5865.34,-2980.1 6023,-2977.82 6053.67,-2977.37 6545.54,-2977.36 6575,-2968.82 6603.63,-2960.52 6632.26,-2944.5 6655.81,-2928.73"/>
<polygon fill="black" stroke="black" points="6657.98,-2931.49 6664.25,-2922.95 6654.02,-2925.71 6657.98,-2931.49"/>
</g>
<!-- l1_route_9 -->
<g id="node164" class="node">
<title>l1_route_9</title>
<polygon fill="none" stroke="black" points="2057.32,-2922.82 1859.55,-2922.82 1808.68,-2846.82 2006.45,-2846.82 2057.32,-2922.82"/>
<text text-anchor="middle" x="1933" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1933" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 9</text>
<text text-anchor="middle" x="1933" y="-2872.62" font-family="Arial" font-size="9.00">GPU 52</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_9 -->
<g id="edge190" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4352.65,-3033.24C3925.88,-3034.57 2286.78,-3035.27 2066,-2968.82 2038.03,-2960.4 2010.14,-2944.45 1987.17,-2928.77"/>
<polygon fill="black" stroke="black" points="1989.14,-2925.88 1978.94,-2923.02 1985.13,-2931.61 1989.14,-2925.88"/>
</g>
<!-- l1_route_10 -->
<g id="node170" class="node">
<title>l1_route_10</title>
<polygon fill="none" stroke="black" points="2928.69,-2922.82 2722.38,-2922.82 2669.31,-2846.82 2875.62,-2846.82 2928.69,-2922.82"/>
<text text-anchor="middle" x="2799" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2799" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 10</text>
<text text-anchor="middle" x="2799" y="-2872.62" font-family="Arial" font-size="9.00">GPU 56</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_10 -->
<g id="edge197" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4351.71,-3031.41C4033.21,-3026.62 3072.45,-3008.98 2938,-2968.82 2909.22,-2960.22 2880.24,-2944.34 2856.25,-2928.75"/>
<polygon fill="black" stroke="black" points="2857.91,-2925.65 2847.64,-2923.03 2854.04,-2931.48 2857.91,-2925.65"/>
</g>
<!-- l1_route_11 -->
<g id="node176" class="node">
<title>l1_route_11</title>
<polygon fill="none" stroke="black" points="4230.69,-2922.82 4024.38,-2922.82 3971.31,-2846.82 4177.62,-2846.82 4230.69,-2922.82"/>
<text text-anchor="middle" x="4101" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4101" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 11</text>
<text text-anchor="middle" x="4101" y="-2872.62" font-family="Arial" font-size="9.00">GPU 60</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_11 -->
<g id="edge204" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4331.58,-3001.89C4301.13,-2992.66 4268.93,-2981.55 4240,-2968.82 4214.45,-2957.58 4187.8,-2942.57 4164.76,-2928.4"/>
<polygon fill="black" stroke="black" points="4166.45,-2925.34 4156.11,-2923.03 4162.76,-2931.28 4166.45,-2925.34"/>
</g>
<!-- l1_route_12 -->
<g id="node182" class="node">
<title>l1_route_12</title>
<polygon fill="none" stroke="black" points="5102.69,-2922.82 4896.38,-2922.82 4843.31,-2846.82 5049.62,-2846.82 5102.69,-2922.82"/>
<text text-anchor="middle" x="4973" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4973" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 12</text>
<text text-anchor="middle" x="4973" y="-2872.62" font-family="Arial" font-size="9.00">GPU 64</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_12 -->
<g id="edge211" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4538.49,-3010.04C4559.76,-3004.84 4582.63,-2999.71 4604,-2995.82 4703.96,-2977.62 4734.68,-3001.13 4831,-2968.82 4859.45,-2959.27 4888.47,-2943.58 4912.8,-2928.39"/>
<polygon fill="black" stroke="black" points="4914.99,-2931.15 4921.55,-2922.83 4911.23,-2925.24 4914.99,-2931.15"/>
</g>
<!-- l1_route_13 -->
<g id="node188" class="node">
<title>l1_route_13</title>
<polygon fill="none" stroke="black" points="6404.69,-2922.82 6198.38,-2922.82 6145.31,-2846.82 6351.62,-2846.82 6404.69,-2922.82"/>
<text text-anchor="middle" x="6275" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6275" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 13</text>
<text text-anchor="middle" x="6275" y="-2872.62" font-family="Arial" font-size="9.00">GPU 68</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_13 -->
<g id="edge218" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.86,-3008.62C4559.25,-3003.42 4582.32,-2998.64 4604,-2995.82 4688.25,-2984.85 6051.21,-2991.79 6133,-2968.82 6162.76,-2960.46 6192.73,-2944.33 6217.43,-2928.5"/>
<polygon fill="black" stroke="black" points="6219.49,-2931.33 6225.93,-2922.92 6215.65,-2925.48 6219.49,-2931.33"/>
</g>
<!-- l1_route_14 -->
<g id="node194" class="node">
<title>l1_route_14</title>
<polygon fill="none" stroke="black" points="7276.69,-2922.82 7070.38,-2922.82 7017.31,-2846.82 7223.62,-2846.82 7276.69,-2922.82"/>
<text text-anchor="middle" x="7147" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7147" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 14</text>
<text text-anchor="middle" x="7147" y="-2872.62" font-family="Arial" font-size="9.00">GPU 72</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_14 -->
<g id="edge225" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.45,-3008.62C4558.95,-3003.39 4582.18,-2998.59 4604,-2995.82 4637.08,-2991.61 6972.86,-2977.72 7005,-2968.82 7034.79,-2960.57 7064.77,-2944.46 7089.46,-2928.61"/>
<polygon fill="black" stroke="black" points="7091.52,-2931.44 7097.96,-2923.03 7087.68,-2925.59 7091.52,-2931.44"/>
</g>
<!-- l1_route_15 -->
<g id="node200" class="node">
<title>l1_route_15</title>
<polygon fill="none" stroke="black" points="7718.69,-2922.82 7512.38,-2922.82 7459.31,-2846.82 7665.62,-2846.82 7718.69,-2922.82"/>
<text text-anchor="middle" x="7589" y="-2892.62" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7589" y="-2882.62" font-family="Arial" font-size="9.00">Select tokens for Expert 15</text>
<text text-anchor="middle" x="7589" y="-2872.62" font-family="Arial" font-size="9.00">GPU 76</text>
</g>
<!-- l1_global_gate&#45;&gt;l1_route_15 -->
<g id="edge232" class="edge">
<title>l1_global_gate&#45;&gt;l1_route_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4537.45,-3008.59C4558.95,-3003.36 4582.18,-2998.57 4604,-2995.82 4709.17,-2982.54 6406,-2978.83 6512,-2977.82 6563.94,-2977.32 7396.93,-2982.64 7447,-2968.82 7476.92,-2960.56 7507.03,-2944.36 7531.77,-2928.44"/>
<polygon fill="black" stroke="black" points="7533.86,-2931.25 7540.29,-2922.83 7530.01,-2925.4 7533.86,-2931.25"/>
</g>
<!-- l1_exp0_linear1 -->
<g id="node112" class="node">
<title>l1_exp0_linear1</title>
<polygon fill="none" stroke="black" points="3947,-2809.82 3783,-2809.82 3783,-2771.82 3947,-2771.82 3947,-2809.82"/>
<text text-anchor="middle" x="3865" y="-2798.62" font-family="Arial" font-size="9.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="3865" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3865" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 16&#45;19</text>
</g>
<!-- l1_gather_0&#45;&gt;l1_exp0_linear1 -->
<g id="edge129" class="edge">
<title>l1_gather_0&#45;&gt;l1_exp0_linear1</title>
<path fill="none" stroke="black" d="M3873.59,-2857.7C3872.05,-2845.87 3870.22,-2831.86 3868.65,-2819.81"/>
<polygon fill="black" stroke="black" points="3872.11,-2819.29 3867.35,-2809.83 3865.17,-2820.2 3872.11,-2819.29"/>
</g>
<!-- l1_exp0_gelu -->
<g id="node113" class="node">
<title>l1_exp0_gelu</title>
<polygon fill="none" stroke="black" points="3908,-2734.82 3822,-2734.82 3822,-2696.82 3908,-2696.82 3908,-2734.82"/>
<text text-anchor="middle" x="3865" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3865" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3865" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 16&#45;19</text>
</g>
<!-- l1_exp0_linear1&#45;&gt;l1_exp0_gelu -->
<g id="edge130" class="edge">
<title>l1_exp0_linear1&#45;&gt;l1_exp0_gelu</title>
<path fill="none" stroke="black" d="M3865,-2771.77C3865,-2763.7 3865,-2753.99 3865,-2745"/>
<polygon fill="black" stroke="black" points="3868.5,-2744.91 3865,-2734.91 3861.5,-2744.91 3868.5,-2744.91"/>
</g>
<!-- l1_exp0_linear2 -->
<g id="node114" class="node">
<title>l1_exp0_linear2</title>
<polygon fill="none" stroke="black" points="3947,-2659.82 3783,-2659.82 3783,-2621.82 3947,-2621.82 3947,-2659.82"/>
<text text-anchor="middle" x="3865" y="-2648.62" font-family="Arial" font-size="9.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="3865" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3865" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 16&#45;19</text>
</g>
<!-- l1_exp0_gelu&#45;&gt;l1_exp0_linear2 -->
<g id="edge131" class="edge">
<title>l1_exp0_gelu&#45;&gt;l1_exp0_linear2</title>
<path fill="none" stroke="black" d="M3865,-2696.77C3865,-2688.7 3865,-2678.99 3865,-2670"/>
<polygon fill="black" stroke="black" points="3868.5,-2669.91 3865,-2659.91 3861.5,-2669.91 3868.5,-2669.91"/>
</g>
<!-- l1_scatter_0 -->
<g id="node115" class="node">
<title>l1_scatter_0</title>
<ellipse fill="none" stroke="black" cx="3874" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3874" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3874" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3874" y="-2545.75" font-family="Arial" font-size="9.00">GPU 16 → All GPUs</text>
</g>
<!-- l1_exp0_linear2&#45;&gt;l1_scatter_0 -->
<g id="edge132" class="edge">
<title>l1_exp0_linear2&#45;&gt;l1_scatter_0</title>
<path fill="none" stroke="black" d="M3867.04,-2621.47C3867.92,-2613.61 3868.97,-2604.15 3869.99,-2595"/>
<polygon fill="black" stroke="black" points="3873.49,-2595.22 3871.11,-2584.89 3866.53,-2594.44 3873.49,-2595.22"/>
</g>
<!-- l1_expert_agg -->
<g id="node206" class="node">
<title>l1_expert_agg</title>
<polygon fill="none" stroke="black" points="4867.76,-2494.08 4659.75,-2494.08 4606.24,-2398.08 4814.25,-2398.08 4867.76,-2494.08"/>
<text text-anchor="middle" x="4737" y="-2458.88" font-family="Arial" font-size="9.00">Expert Aggregation</text>
<text text-anchor="middle" x="4737" y="-2448.88" font-family="Arial" font-size="9.00">Combine all expert outputs</text>
<text text-anchor="middle" x="4737" y="-2438.88" font-family="Arial" font-size="9.00">[1024, 8192]</text>
<text text-anchor="middle" x="4737" y="-2428.88" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l1_scatter_0&#45;&gt;l1_expert_agg -->
<g id="edge133" class="edge">
<title>l1_scatter_0&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M3917.78,-2536.77C3930.8,-2531.53 3945.26,-2526.42 3959,-2523.08 4190.56,-2466.83 4470.49,-2451.99 4623.49,-2448.21"/>
<polygon fill="black" stroke="black" points="4623.92,-2451.71 4633.83,-2447.97 4623.75,-2444.71 4623.92,-2451.71"/>
</g>
<!-- l1_exp1_linear1 -->
<g id="node118" class="node">
<title>l1_exp1_linear1</title>
<polygon fill="none" stroke="black" points="5570,-2809.82 5406,-2809.82 5406,-2771.82 5570,-2771.82 5570,-2809.82"/>
<text text-anchor="middle" x="5488" y="-2798.62" font-family="Arial" font-size="9.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="5488" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5488" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 20&#45;23</text>
</g>
<!-- l1_gather_1&#45;&gt;l1_exp1_linear1 -->
<g id="edge136" class="edge">
<title>l1_gather_1&#45;&gt;l1_exp1_linear1</title>
<path fill="none" stroke="black" d="M5588.12,-2861.08C5568.2,-2847.3 5542.81,-2829.73 5522.59,-2815.74"/>
<polygon fill="black" stroke="black" points="5524.48,-2812.8 5514.27,-2809.99 5520.5,-2818.56 5524.48,-2812.8"/>
</g>
<!-- l1_exp1_gelu -->
<g id="node119" class="node">
<title>l1_exp1_gelu</title>
<polygon fill="none" stroke="black" points="5515,-2734.82 5429,-2734.82 5429,-2696.82 5515,-2696.82 5515,-2734.82"/>
<text text-anchor="middle" x="5472" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5472" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5472" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 20&#45;23</text>
</g>
<!-- l1_exp1_linear1&#45;&gt;l1_exp1_gelu -->
<g id="edge137" class="edge">
<title>l1_exp1_linear1&#45;&gt;l1_exp1_gelu</title>
<path fill="none" stroke="black" d="M5484.04,-2771.77C5482.26,-2763.61 5480.1,-2753.78 5478.11,-2744.71"/>
<polygon fill="black" stroke="black" points="5481.52,-2743.93 5475.97,-2734.91 5474.69,-2745.43 5481.52,-2743.93"/>
</g>
<!-- l1_exp1_linear2 -->
<g id="node120" class="node">
<title>l1_exp1_linear2</title>
<polygon fill="none" stroke="black" points="5479,-2659.82 5315,-2659.82 5315,-2621.82 5479,-2621.82 5479,-2659.82"/>
<text text-anchor="middle" x="5397" y="-2648.62" font-family="Arial" font-size="9.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="5397" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5397" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 20&#45;23</text>
</g>
<!-- l1_exp1_gelu&#45;&gt;l1_exp1_linear2 -->
<g id="edge138" class="edge">
<title>l1_exp1_gelu&#45;&gt;l1_exp1_linear2</title>
<path fill="none" stroke="black" d="M5453.46,-2696.77C5444.27,-2687.82 5433.01,-2676.87 5422.97,-2667.1"/>
<polygon fill="black" stroke="black" points="5425.19,-2664.38 5415.59,-2659.91 5420.31,-2669.39 5425.19,-2664.38"/>
</g>
<!-- l1_scatter_1 -->
<g id="node121" class="node">
<title>l1_scatter_1</title>
<ellipse fill="none" stroke="black" cx="5376" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5376" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5376" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5376" y="-2545.75" font-family="Arial" font-size="9.00">GPU 20 → All GPUs</text>
</g>
<!-- l1_exp1_linear2&#45;&gt;l1_scatter_1 -->
<g id="edge139" class="edge">
<title>l1_exp1_linear2&#45;&gt;l1_scatter_1</title>
<path fill="none" stroke="black" d="M5392.23,-2621.47C5390.17,-2613.53 5387.69,-2603.95 5385.28,-2594.7"/>
<polygon fill="black" stroke="black" points="5388.64,-2593.69 5382.74,-2584.89 5381.86,-2595.45 5388.64,-2593.69"/>
</g>
<!-- l1_scatter_1&#45;&gt;l1_expert_agg -->
<g id="edge140" class="edge">
<title>l1_scatter_1&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M5326.73,-2538.78C5309.88,-2533.1 5290.78,-2527.23 5273,-2523.08 5131.99,-2490.17 4966.57,-2469.34 4857.2,-2457.98"/>
<polygon fill="black" stroke="black" points="4857.43,-2454.48 4847.12,-2456.94 4856.71,-2461.45 4857.43,-2454.48"/>
</g>
<!-- l1_exp2_linear1 -->
<g id="node124" class="node">
<title>l1_exp2_linear1</title>
<polygon fill="none" stroke="black" points="3517,-2809.82 3353,-2809.82 3353,-2771.82 3517,-2771.82 3517,-2809.82"/>
<text text-anchor="middle" x="3435" y="-2798.62" font-family="Arial" font-size="9.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="3435" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3435" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 24&#45;27</text>
</g>
<!-- l1_gather_2&#45;&gt;l1_exp2_linear1 -->
<g id="edge143" class="edge">
<title>l1_gather_2&#45;&gt;l1_exp2_linear1</title>
<path fill="none" stroke="black" d="M3443.59,-2857.7C3442.05,-2845.87 3440.22,-2831.86 3438.65,-2819.81"/>
<polygon fill="black" stroke="black" points="3442.11,-2819.29 3437.35,-2809.83 3435.17,-2820.2 3442.11,-2819.29"/>
</g>
<!-- l1_exp2_gelu -->
<g id="node125" class="node">
<title>l1_exp2_gelu</title>
<polygon fill="none" stroke="black" points="3478,-2734.82 3392,-2734.82 3392,-2696.82 3478,-2696.82 3478,-2734.82"/>
<text text-anchor="middle" x="3435" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3435" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3435" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 24&#45;27</text>
</g>
<!-- l1_exp2_linear1&#45;&gt;l1_exp2_gelu -->
<g id="edge144" class="edge">
<title>l1_exp2_linear1&#45;&gt;l1_exp2_gelu</title>
<path fill="none" stroke="black" d="M3435,-2771.77C3435,-2763.7 3435,-2753.99 3435,-2745"/>
<polygon fill="black" stroke="black" points="3438.5,-2744.91 3435,-2734.91 3431.5,-2744.91 3438.5,-2744.91"/>
</g>
<!-- l1_exp2_linear2 -->
<g id="node126" class="node">
<title>l1_exp2_linear2</title>
<polygon fill="none" stroke="black" points="3517,-2659.82 3353,-2659.82 3353,-2621.82 3517,-2621.82 3517,-2659.82"/>
<text text-anchor="middle" x="3435" y="-2648.62" font-family="Arial" font-size="9.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="3435" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3435" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 24&#45;27</text>
</g>
<!-- l1_exp2_gelu&#45;&gt;l1_exp2_linear2 -->
<g id="edge145" class="edge">
<title>l1_exp2_gelu&#45;&gt;l1_exp2_linear2</title>
<path fill="none" stroke="black" d="M3435,-2696.77C3435,-2688.7 3435,-2678.99 3435,-2670"/>
<polygon fill="black" stroke="black" points="3438.5,-2669.91 3435,-2659.91 3431.5,-2669.91 3438.5,-2669.91"/>
</g>
<!-- l1_scatter_2 -->
<g id="node127" class="node">
<title>l1_scatter_2</title>
<ellipse fill="none" stroke="black" cx="3441" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3441" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3441" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3441" y="-2545.75" font-family="Arial" font-size="9.00">GPU 24 → All GPUs</text>
</g>
<!-- l1_exp2_linear2&#45;&gt;l1_scatter_2 -->
<g id="edge146" class="edge">
<title>l1_exp2_linear2&#45;&gt;l1_scatter_2</title>
<path fill="none" stroke="black" d="M3436.36,-2621.47C3436.94,-2613.61 3437.65,-2604.15 3438.33,-2595"/>
<polygon fill="black" stroke="black" points="3441.83,-2595.12 3439.08,-2584.89 3434.84,-2594.6 3441.83,-2595.12"/>
</g>
<!-- l1_scatter_2&#45;&gt;l1_expert_agg -->
<g id="edge147" class="edge">
<title>l1_scatter_2&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M3484.96,-2537.02C3498.78,-2531.57 3514.29,-2526.29 3529,-2523.08 3735.89,-2477.87 4365.83,-2456.74 4624.41,-2449.79"/>
<polygon fill="black" stroke="black" points="4624.67,-2453.29 4634.57,-2449.52 4624.48,-2446.29 4624.67,-2453.29"/>
</g>
<!-- l1_exp3_linear1 -->
<g id="node130" class="node">
<title>l1_exp3_linear1</title>
<polygon fill="none" stroke="black" points="1355,-2809.82 1191,-2809.82 1191,-2771.82 1355,-2771.82 1355,-2809.82"/>
<text text-anchor="middle" x="1273" y="-2798.62" font-family="Arial" font-size="9.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1273" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1273" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 28&#45;31</text>
</g>
<!-- l1_gather_3&#45;&gt;l1_exp3_linear1 -->
<g id="edge150" class="edge">
<title>l1_gather_3&#45;&gt;l1_exp3_linear1</title>
<path fill="none" stroke="black" d="M1281.59,-2857.7C1280.05,-2845.87 1278.22,-2831.86 1276.65,-2819.81"/>
<polygon fill="black" stroke="black" points="1280.11,-2819.29 1275.35,-2809.83 1273.17,-2820.2 1280.11,-2819.29"/>
</g>
<!-- l1_exp3_gelu -->
<g id="node131" class="node">
<title>l1_exp3_gelu</title>
<polygon fill="none" stroke="black" points="1316,-2734.82 1230,-2734.82 1230,-2696.82 1316,-2696.82 1316,-2734.82"/>
<text text-anchor="middle" x="1273" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1273" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1273" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 28&#45;31</text>
</g>
<!-- l1_exp3_linear1&#45;&gt;l1_exp3_gelu -->
<g id="edge151" class="edge">
<title>l1_exp3_linear1&#45;&gt;l1_exp3_gelu</title>
<path fill="none" stroke="black" d="M1273,-2771.77C1273,-2763.7 1273,-2753.99 1273,-2745"/>
<polygon fill="black" stroke="black" points="1276.5,-2744.91 1273,-2734.91 1269.5,-2744.91 1276.5,-2744.91"/>
</g>
<!-- l1_exp3_linear2 -->
<g id="node132" class="node">
<title>l1_exp3_linear2</title>
<polygon fill="none" stroke="black" points="1355,-2659.82 1191,-2659.82 1191,-2621.82 1355,-2621.82 1355,-2659.82"/>
<text text-anchor="middle" x="1273" y="-2648.62" font-family="Arial" font-size="9.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1273" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1273" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 28&#45;31</text>
</g>
<!-- l1_exp3_gelu&#45;&gt;l1_exp3_linear2 -->
<g id="edge152" class="edge">
<title>l1_exp3_gelu&#45;&gt;l1_exp3_linear2</title>
<path fill="none" stroke="black" d="M1273,-2696.77C1273,-2688.7 1273,-2678.99 1273,-2670"/>
<polygon fill="black" stroke="black" points="1276.5,-2669.91 1273,-2659.91 1269.5,-2669.91 1276.5,-2669.91"/>
</g>
<!-- l1_scatter_3 -->
<g id="node133" class="node">
<title>l1_scatter_3</title>
<ellipse fill="none" stroke="black" cx="1282" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1282" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1282" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1282" y="-2545.75" font-family="Arial" font-size="9.00">GPU 28 → All GPUs</text>
</g>
<!-- l1_exp3_linear2&#45;&gt;l1_scatter_3 -->
<g id="edge153" class="edge">
<title>l1_exp3_linear2&#45;&gt;l1_scatter_3</title>
<path fill="none" stroke="black" d="M1275.04,-2621.47C1275.92,-2613.61 1276.97,-2604.15 1277.99,-2595"/>
<polygon fill="black" stroke="black" points="1281.49,-2595.22 1279.11,-2584.89 1274.53,-2594.44 1281.49,-2595.22"/>
</g>
<!-- l1_scatter_3&#45;&gt;l1_expert_agg -->
<g id="edge154" class="edge">
<title>l1_scatter_3&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M1324.76,-2536.47C1338,-2531.08 1352.83,-2525.96 1367,-2523.08 1691.17,-2457.07 4071.86,-2448.38 4623.22,-2447.25"/>
<polygon fill="black" stroke="black" points="4623.57,-2450.74 4633.56,-2447.22 4623.55,-2443.74 4623.57,-2450.74"/>
</g>
<!-- l1_exp4_linear1 -->
<g id="node136" class="node">
<title>l1_exp4_linear1</title>
<polygon fill="none" stroke="black" points="4819,-2809.82 4655,-2809.82 4655,-2771.82 4819,-2771.82 4819,-2809.82"/>
<text text-anchor="middle" x="4737" y="-2798.62" font-family="Arial" font-size="9.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="4737" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4737" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l1_gather_4&#45;&gt;l1_exp4_linear1 -->
<g id="edge157" class="edge">
<title>l1_gather_4&#45;&gt;l1_exp4_linear1</title>
<path fill="none" stroke="black" d="M4745.59,-2857.7C4744.05,-2845.87 4742.22,-2831.86 4740.65,-2819.81"/>
<polygon fill="black" stroke="black" points="4744.11,-2819.29 4739.35,-2809.83 4737.17,-2820.2 4744.11,-2819.29"/>
</g>
<!-- l1_exp4_gelu -->
<g id="node137" class="node">
<title>l1_exp4_gelu</title>
<polygon fill="none" stroke="black" points="4780,-2734.82 4694,-2734.82 4694,-2696.82 4780,-2696.82 4780,-2734.82"/>
<text text-anchor="middle" x="4737" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4737" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4737" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 32&#45;35</text>
</g>
<!-- l1_exp4_linear1&#45;&gt;l1_exp4_gelu -->
<g id="edge158" class="edge">
<title>l1_exp4_linear1&#45;&gt;l1_exp4_gelu</title>
<path fill="none" stroke="black" d="M4737,-2771.77C4737,-2763.7 4737,-2753.99 4737,-2745"/>
<polygon fill="black" stroke="black" points="4740.5,-2744.91 4737,-2734.91 4733.5,-2744.91 4740.5,-2744.91"/>
</g>
<!-- l1_exp4_linear2 -->
<g id="node138" class="node">
<title>l1_exp4_linear2</title>
<polygon fill="none" stroke="black" points="4819,-2659.82 4655,-2659.82 4655,-2621.82 4819,-2621.82 4819,-2659.82"/>
<text text-anchor="middle" x="4737" y="-2648.62" font-family="Arial" font-size="9.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="4737" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4737" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l1_exp4_gelu&#45;&gt;l1_exp4_linear2 -->
<g id="edge159" class="edge">
<title>l1_exp4_gelu&#45;&gt;l1_exp4_linear2</title>
<path fill="none" stroke="black" d="M4737,-2696.77C4737,-2688.7 4737,-2678.99 4737,-2670"/>
<polygon fill="black" stroke="black" points="4740.5,-2669.91 4737,-2659.91 4733.5,-2669.91 4740.5,-2669.91"/>
</g>
<!-- l1_scatter_4 -->
<g id="node139" class="node">
<title>l1_scatter_4</title>
<ellipse fill="none" stroke="black" cx="4737" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4737" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4737" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4737" y="-2545.75" font-family="Arial" font-size="9.00">GPU 32 → All GPUs</text>
</g>
<!-- l1_exp4_linear2&#45;&gt;l1_scatter_4 -->
<g id="edge160" class="edge">
<title>l1_exp4_linear2&#45;&gt;l1_scatter_4</title>
<path fill="none" stroke="black" d="M4737,-2621.47C4737,-2613.61 4737,-2604.15 4737,-2595"/>
<polygon fill="black" stroke="black" points="4740.5,-2594.89 4737,-2584.89 4733.5,-2594.89 4740.5,-2594.89"/>
</g>
<!-- l1_scatter_4&#45;&gt;l1_expert_agg -->
<g id="edge161" class="edge">
<title>l1_scatter_4&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M4737,-2530.91C4737,-2522.9 4737,-2513.73 4737,-2504.48"/>
<polygon fill="black" stroke="black" points="4740.5,-2504.45 4737,-2494.45 4733.5,-2504.45 4740.5,-2504.45"/>
</g>
<!-- l1_exp5_linear1 -->
<g id="node142" class="node">
<title>l1_exp5_linear1</title>
<polygon fill="none" stroke="black" points="2645,-2809.82 2481,-2809.82 2481,-2771.82 2645,-2771.82 2645,-2809.82"/>
<text text-anchor="middle" x="2563" y="-2798.62" font-family="Arial" font-size="9.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="2563" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2563" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l1_gather_5&#45;&gt;l1_exp5_linear1 -->
<g id="edge164" class="edge">
<title>l1_gather_5&#45;&gt;l1_exp5_linear1</title>
<path fill="none" stroke="black" d="M2571.59,-2857.7C2570.05,-2845.87 2568.22,-2831.86 2566.65,-2819.81"/>
<polygon fill="black" stroke="black" points="2570.11,-2819.29 2565.35,-2809.83 2563.17,-2820.2 2570.11,-2819.29"/>
</g>
<!-- l1_exp5_gelu -->
<g id="node143" class="node">
<title>l1_exp5_gelu</title>
<polygon fill="none" stroke="black" points="2606,-2734.82 2520,-2734.82 2520,-2696.82 2606,-2696.82 2606,-2734.82"/>
<text text-anchor="middle" x="2563" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2563" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2563" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 36&#45;39</text>
</g>
<!-- l1_exp5_linear1&#45;&gt;l1_exp5_gelu -->
<g id="edge165" class="edge">
<title>l1_exp5_linear1&#45;&gt;l1_exp5_gelu</title>
<path fill="none" stroke="black" d="M2563,-2771.77C2563,-2763.7 2563,-2753.99 2563,-2745"/>
<polygon fill="black" stroke="black" points="2566.5,-2744.91 2563,-2734.91 2559.5,-2744.91 2566.5,-2744.91"/>
</g>
<!-- l1_exp5_linear2 -->
<g id="node144" class="node">
<title>l1_exp5_linear2</title>
<polygon fill="none" stroke="black" points="2645,-2659.82 2481,-2659.82 2481,-2621.82 2645,-2621.82 2645,-2659.82"/>
<text text-anchor="middle" x="2563" y="-2648.62" font-family="Arial" font-size="9.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2563" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2563" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l1_exp5_gelu&#45;&gt;l1_exp5_linear2 -->
<g id="edge166" class="edge">
<title>l1_exp5_gelu&#45;&gt;l1_exp5_linear2</title>
<path fill="none" stroke="black" d="M2563,-2696.77C2563,-2688.7 2563,-2678.99 2563,-2670"/>
<polygon fill="black" stroke="black" points="2566.5,-2669.91 2563,-2659.91 2559.5,-2669.91 2566.5,-2669.91"/>
</g>
<!-- l1_scatter_5 -->
<g id="node145" class="node">
<title>l1_scatter_5</title>
<ellipse fill="none" stroke="black" cx="2569" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2569" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2569" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2569" y="-2545.75" font-family="Arial" font-size="9.00">GPU 36 → All GPUs</text>
</g>
<!-- l1_exp5_linear2&#45;&gt;l1_scatter_5 -->
<g id="edge167" class="edge">
<title>l1_exp5_linear2&#45;&gt;l1_scatter_5</title>
<path fill="none" stroke="black" d="M2564.36,-2621.47C2564.94,-2613.61 2565.65,-2604.15 2566.33,-2595"/>
<polygon fill="black" stroke="black" points="2569.83,-2595.12 2567.08,-2584.89 2562.84,-2594.6 2569.83,-2595.12"/>
</g>
<!-- l1_scatter_5&#45;&gt;l1_expert_agg -->
<g id="edge168" class="edge">
<title>l1_scatter_5&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M2612.91,-2536.78C2626.73,-2531.32 2642.25,-2526.1 2657,-2523.08 2849.66,-2483.63 4218.66,-2456.32 4624.12,-2449.02"/>
<polygon fill="black" stroke="black" points="4624.45,-2452.52 4634.39,-2448.84 4624.33,-2445.52 4624.45,-2452.52"/>
</g>
<!-- l1_exp6_linear1 -->
<g id="node148" class="node">
<title>l1_exp6_linear1</title>
<polygon fill="none" stroke="black" points="6113,-2809.82 5949,-2809.82 5949,-2771.82 6113,-2771.82 6113,-2809.82"/>
<text text-anchor="middle" x="6031" y="-2798.62" font-family="Arial" font-size="9.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="6031" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6031" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l1_gather_6&#45;&gt;l1_exp6_linear1 -->
<g id="edge171" class="edge">
<title>l1_gather_6&#45;&gt;l1_exp6_linear1</title>
<path fill="none" stroke="black" d="M6045.32,-2857.7C6042.75,-2845.87 6039.7,-2831.86 6037.09,-2819.81"/>
<polygon fill="black" stroke="black" points="6040.46,-2818.86 6034.92,-2809.83 6033.62,-2820.35 6040.46,-2818.86"/>
</g>
<!-- l1_exp6_gelu -->
<g id="node149" class="node">
<title>l1_exp6_gelu</title>
<polygon fill="none" stroke="black" points="5945,-2734.82 5859,-2734.82 5859,-2696.82 5945,-2696.82 5945,-2734.82"/>
<text text-anchor="middle" x="5902" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5902" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5902" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 40&#45;43</text>
</g>
<!-- l1_exp6_linear1&#45;&gt;l1_exp6_gelu -->
<g id="edge172" class="edge">
<title>l1_exp6_linear1&#45;&gt;l1_exp6_gelu</title>
<path fill="none" stroke="black" d="M5999.11,-2771.77C5982.21,-2762.21 5961.26,-2750.35 5943.14,-2740.1"/>
<polygon fill="black" stroke="black" points="5944.39,-2736.79 5933.97,-2734.91 5940.95,-2742.88 5944.39,-2736.79"/>
</g>
<!-- l1_exp6_linear2 -->
<g id="node150" class="node">
<title>l1_exp6_linear2</title>
<polygon fill="none" stroke="black" points="5909,-2659.82 5745,-2659.82 5745,-2621.82 5909,-2621.82 5909,-2659.82"/>
<text text-anchor="middle" x="5827" y="-2648.62" font-family="Arial" font-size="9.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="5827" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5827" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l1_exp6_gelu&#45;&gt;l1_exp6_linear2 -->
<g id="edge173" class="edge">
<title>l1_exp6_gelu&#45;&gt;l1_exp6_linear2</title>
<path fill="none" stroke="black" d="M5883.46,-2696.77C5874.27,-2687.82 5863.01,-2676.87 5852.97,-2667.1"/>
<polygon fill="black" stroke="black" points="5855.19,-2664.38 5845.59,-2659.91 5850.31,-2669.39 5855.19,-2664.38"/>
</g>
<!-- l1_scatter_6 -->
<g id="node151" class="node">
<title>l1_scatter_6</title>
<ellipse fill="none" stroke="black" cx="5806" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5806" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5806" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5806" y="-2545.75" font-family="Arial" font-size="9.00">GPU 40 → All GPUs</text>
</g>
<!-- l1_exp6_linear2&#45;&gt;l1_scatter_6 -->
<g id="edge174" class="edge">
<title>l1_exp6_linear2&#45;&gt;l1_scatter_6</title>
<path fill="none" stroke="black" d="M5822.23,-2621.47C5820.17,-2613.53 5817.69,-2603.95 5815.28,-2594.7"/>
<polygon fill="black" stroke="black" points="5818.64,-2593.69 5812.74,-2584.89 5811.86,-2595.45 5818.64,-2593.69"/>
</g>
<!-- l1_scatter_6&#45;&gt;l1_expert_agg -->
<g id="edge175" class="edge">
<title>l1_scatter_6&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M5757.65,-2538.41C5740.62,-2532.58 5721.18,-2526.73 5703,-2523.08 5399.89,-2462.23 5034.15,-2449.58 4851.9,-2447.28"/>
<polygon fill="black" stroke="black" points="4851.81,-2443.78 4841.77,-2447.16 4851.72,-2450.78 4851.81,-2443.78"/>
</g>
<!-- l1_exp7_linear1 -->
<g id="node154" class="node">
<title>l1_exp7_linear1</title>
<polygon fill="none" stroke="black" points="1785,-2809.82 1621,-2809.82 1621,-2771.82 1785,-2771.82 1785,-2809.82"/>
<text text-anchor="middle" x="1703" y="-2798.62" font-family="Arial" font-size="9.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="1703" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1703" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l1_gather_7&#45;&gt;l1_exp7_linear1 -->
<g id="edge178" class="edge">
<title>l1_gather_7&#45;&gt;l1_exp7_linear1</title>
<path fill="none" stroke="black" d="M1711.59,-2857.7C1710.05,-2845.87 1708.22,-2831.86 1706.65,-2819.81"/>
<polygon fill="black" stroke="black" points="1710.11,-2819.29 1705.35,-2809.83 1703.17,-2820.2 1710.11,-2819.29"/>
</g>
<!-- l1_exp7_gelu -->
<g id="node155" class="node">
<title>l1_exp7_gelu</title>
<polygon fill="none" stroke="black" points="1746,-2734.82 1660,-2734.82 1660,-2696.82 1746,-2696.82 1746,-2734.82"/>
<text text-anchor="middle" x="1703" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1703" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1703" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 44&#45;47</text>
</g>
<!-- l1_exp7_linear1&#45;&gt;l1_exp7_gelu -->
<g id="edge179" class="edge">
<title>l1_exp7_linear1&#45;&gt;l1_exp7_gelu</title>
<path fill="none" stroke="black" d="M1703,-2771.77C1703,-2763.7 1703,-2753.99 1703,-2745"/>
<polygon fill="black" stroke="black" points="1706.5,-2744.91 1703,-2734.91 1699.5,-2744.91 1706.5,-2744.91"/>
</g>
<!-- l1_exp7_linear2 -->
<g id="node156" class="node">
<title>l1_exp7_linear2</title>
<polygon fill="none" stroke="black" points="1785,-2659.82 1621,-2659.82 1621,-2621.82 1785,-2621.82 1785,-2659.82"/>
<text text-anchor="middle" x="1703" y="-2648.62" font-family="Arial" font-size="9.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="1703" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1703" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l1_exp7_gelu&#45;&gt;l1_exp7_linear2 -->
<g id="edge180" class="edge">
<title>l1_exp7_gelu&#45;&gt;l1_exp7_linear2</title>
<path fill="none" stroke="black" d="M1703,-2696.77C1703,-2688.7 1703,-2678.99 1703,-2670"/>
<polygon fill="black" stroke="black" points="1706.5,-2669.91 1703,-2659.91 1699.5,-2669.91 1706.5,-2669.91"/>
</g>
<!-- l1_scatter_7 -->
<g id="node157" class="node">
<title>l1_scatter_7</title>
<ellipse fill="none" stroke="black" cx="1712" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1712" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1712" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1712" y="-2545.75" font-family="Arial" font-size="9.00">GPU 44 → All GPUs</text>
</g>
<!-- l1_exp7_linear2&#45;&gt;l1_scatter_7 -->
<g id="edge181" class="edge">
<title>l1_exp7_linear2&#45;&gt;l1_scatter_7</title>
<path fill="none" stroke="black" d="M1705.04,-2621.47C1705.92,-2613.61 1706.97,-2604.15 1707.99,-2595"/>
<polygon fill="black" stroke="black" points="1711.49,-2595.22 1709.11,-2584.89 1704.53,-2594.44 1711.49,-2595.22"/>
</g>
<!-- l1_scatter_7&#45;&gt;l1_expert_agg -->
<g id="edge182" class="edge">
<title>l1_scatter_7&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M1754.77,-2536.5C1768.01,-2531.11 1782.84,-2525.99 1797,-2523.08 2077.03,-2465.58 4117.2,-2450.52 4623.52,-2447.65"/>
<polygon fill="black" stroke="black" points="4623.78,-2451.15 4633.76,-2447.59 4623.74,-2444.15 4623.78,-2451.15"/>
</g>
<!-- l1_exp8_linear1 -->
<g id="node160" class="node">
<title>l1_exp8_linear1</title>
<polygon fill="none" stroke="black" points="6872,-2809.82 6708,-2809.82 6708,-2771.82 6872,-2771.82 6872,-2809.82"/>
<text text-anchor="middle" x="6790" y="-2798.62" font-family="Arial" font-size="9.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="6790" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6790" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l1_gather_8&#45;&gt;l1_exp8_linear1 -->
<g id="edge185" class="edge">
<title>l1_gather_8&#45;&gt;l1_exp8_linear1</title>
<path fill="none" stroke="black" d="M6890.12,-2861.08C6870.2,-2847.3 6844.81,-2829.73 6824.59,-2815.74"/>
<polygon fill="black" stroke="black" points="6826.48,-2812.8 6816.27,-2809.99 6822.5,-2818.56 6826.48,-2812.8"/>
</g>
<!-- l1_exp8_gelu -->
<g id="node161" class="node">
<title>l1_exp8_gelu</title>
<polygon fill="none" stroke="black" points="6817,-2734.82 6731,-2734.82 6731,-2696.82 6817,-2696.82 6817,-2734.82"/>
<text text-anchor="middle" x="6774" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6774" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6774" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 48&#45;51</text>
</g>
<!-- l1_exp8_linear1&#45;&gt;l1_exp8_gelu -->
<g id="edge186" class="edge">
<title>l1_exp8_linear1&#45;&gt;l1_exp8_gelu</title>
<path fill="none" stroke="black" d="M6786.04,-2771.77C6784.26,-2763.61 6782.1,-2753.78 6780.11,-2744.71"/>
<polygon fill="black" stroke="black" points="6783.52,-2743.93 6777.97,-2734.91 6776.69,-2745.43 6783.52,-2743.93"/>
</g>
<!-- l1_exp8_linear2 -->
<g id="node162" class="node">
<title>l1_exp8_linear2</title>
<polygon fill="none" stroke="black" points="6781,-2659.82 6617,-2659.82 6617,-2621.82 6781,-2621.82 6781,-2659.82"/>
<text text-anchor="middle" x="6699" y="-2648.62" font-family="Arial" font-size="9.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="6699" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6699" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l1_exp8_gelu&#45;&gt;l1_exp8_linear2 -->
<g id="edge187" class="edge">
<title>l1_exp8_gelu&#45;&gt;l1_exp8_linear2</title>
<path fill="none" stroke="black" d="M6755.46,-2696.77C6746.27,-2687.82 6735.01,-2676.87 6724.97,-2667.1"/>
<polygon fill="black" stroke="black" points="6727.19,-2664.38 6717.59,-2659.91 6722.31,-2669.39 6727.19,-2664.38"/>
</g>
<!-- l1_scatter_8 -->
<g id="node163" class="node">
<title>l1_scatter_8</title>
<ellipse fill="none" stroke="black" cx="6678" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6678" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6678" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6678" y="-2545.75" font-family="Arial" font-size="9.00">GPU 48 → All GPUs</text>
</g>
<!-- l1_exp8_linear2&#45;&gt;l1_scatter_8 -->
<g id="edge188" class="edge">
<title>l1_exp8_linear2&#45;&gt;l1_scatter_8</title>
<path fill="none" stroke="black" d="M6694.23,-2621.47C6692.17,-2613.53 6689.69,-2603.95 6687.28,-2594.7"/>
<polygon fill="black" stroke="black" points="6690.64,-2593.69 6684.74,-2584.89 6683.86,-2595.45 6690.64,-2593.69"/>
</g>
<!-- l1_scatter_8&#45;&gt;l1_expert_agg -->
<g id="edge189" class="edge">
<title>l1_scatter_8&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M6630.25,-2538.2C6613.09,-2532.28 6593.43,-2526.42 6575,-2523.08 6242.05,-2462.66 5200.9,-2450.19 4852.15,-2447.69"/>
<polygon fill="black" stroke="black" points="4852.06,-2444.19 4842.03,-2447.62 4852.01,-2451.19 4852.06,-2444.19"/>
</g>
<!-- l1_exp9_linear1 -->
<g id="node166" class="node">
<title>l1_exp9_linear1</title>
<polygon fill="none" stroke="black" points="2215,-2809.82 2051,-2809.82 2051,-2771.82 2215,-2771.82 2215,-2809.82"/>
<text text-anchor="middle" x="2133" y="-2798.62" font-family="Arial" font-size="9.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2133" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2133" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l1_gather_9&#45;&gt;l1_exp9_linear1 -->
<g id="edge192" class="edge">
<title>l1_gather_9&#45;&gt;l1_exp9_linear1</title>
<path fill="none" stroke="black" d="M2141.59,-2857.7C2140.05,-2845.87 2138.22,-2831.86 2136.65,-2819.81"/>
<polygon fill="black" stroke="black" points="2140.11,-2819.29 2135.35,-2809.83 2133.17,-2820.2 2140.11,-2819.29"/>
</g>
<!-- l1_exp9_gelu -->
<g id="node167" class="node">
<title>l1_exp9_gelu</title>
<polygon fill="none" stroke="black" points="2176,-2734.82 2090,-2734.82 2090,-2696.82 2176,-2696.82 2176,-2734.82"/>
<text text-anchor="middle" x="2133" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2133" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2133" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 52&#45;55</text>
</g>
<!-- l1_exp9_linear1&#45;&gt;l1_exp9_gelu -->
<g id="edge193" class="edge">
<title>l1_exp9_linear1&#45;&gt;l1_exp9_gelu</title>
<path fill="none" stroke="black" d="M2133,-2771.77C2133,-2763.7 2133,-2753.99 2133,-2745"/>
<polygon fill="black" stroke="black" points="2136.5,-2744.91 2133,-2734.91 2129.5,-2744.91 2136.5,-2744.91"/>
</g>
<!-- l1_exp9_linear2 -->
<g id="node168" class="node">
<title>l1_exp9_linear2</title>
<polygon fill="none" stroke="black" points="2215,-2659.82 2051,-2659.82 2051,-2621.82 2215,-2621.82 2215,-2659.82"/>
<text text-anchor="middle" x="2133" y="-2648.62" font-family="Arial" font-size="9.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2133" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2133" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l1_exp9_gelu&#45;&gt;l1_exp9_linear2 -->
<g id="edge194" class="edge">
<title>l1_exp9_gelu&#45;&gt;l1_exp9_linear2</title>
<path fill="none" stroke="black" d="M2133,-2696.77C2133,-2688.7 2133,-2678.99 2133,-2670"/>
<polygon fill="black" stroke="black" points="2136.5,-2669.91 2133,-2659.91 2129.5,-2669.91 2136.5,-2669.91"/>
</g>
<!-- l1_scatter_9 -->
<g id="node169" class="node">
<title>l1_scatter_9</title>
<ellipse fill="none" stroke="black" cx="2139" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2139" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2139" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2139" y="-2545.75" font-family="Arial" font-size="9.00">GPU 52 → All GPUs</text>
</g>
<!-- l1_exp9_linear2&#45;&gt;l1_scatter_9 -->
<g id="edge195" class="edge">
<title>l1_exp9_linear2&#45;&gt;l1_scatter_9</title>
<path fill="none" stroke="black" d="M2134.36,-2621.47C2134.94,-2613.61 2135.65,-2604.15 2136.33,-2595"/>
<polygon fill="black" stroke="black" points="2139.83,-2595.12 2137.08,-2584.89 2132.84,-2594.6 2139.83,-2595.12"/>
</g>
<!-- l1_scatter_9&#45;&gt;l1_expert_agg -->
<g id="edge196" class="edge">
<title>l1_scatter_9&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M2182.9,-2536.72C2196.72,-2531.26 2212.24,-2526.05 2227,-2523.08 2463.39,-2475.44 4166,-2453.38 4623.88,-2448.27"/>
<polygon fill="black" stroke="black" points="4624.17,-2451.76 4634.13,-2448.15 4624.1,-2444.76 4624.17,-2451.76"/>
</g>
<!-- l1_exp10_linear1 -->
<g id="node172" class="node">
<title>l1_exp10_linear1</title>
<polygon fill="none" stroke="black" points="3087,-2809.82 2923,-2809.82 2923,-2771.82 3087,-2771.82 3087,-2809.82"/>
<text text-anchor="middle" x="3005" y="-2798.62" font-family="Arial" font-size="9.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3005" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3005" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l1_gather_10&#45;&gt;l1_exp10_linear1 -->
<g id="edge199" class="edge">
<title>l1_gather_10&#45;&gt;l1_exp10_linear1</title>
<path fill="none" stroke="black" d="M3013.59,-2857.7C3012.05,-2845.87 3010.22,-2831.86 3008.65,-2819.81"/>
<polygon fill="black" stroke="black" points="3012.11,-2819.29 3007.35,-2809.83 3005.17,-2820.2 3012.11,-2819.29"/>
</g>
<!-- l1_exp10_gelu -->
<g id="node173" class="node">
<title>l1_exp10_gelu</title>
<polygon fill="none" stroke="black" points="3048,-2734.82 2962,-2734.82 2962,-2696.82 3048,-2696.82 3048,-2734.82"/>
<text text-anchor="middle" x="3005" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3005" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3005" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 56&#45;59</text>
</g>
<!-- l1_exp10_linear1&#45;&gt;l1_exp10_gelu -->
<g id="edge200" class="edge">
<title>l1_exp10_linear1&#45;&gt;l1_exp10_gelu</title>
<path fill="none" stroke="black" d="M3005,-2771.77C3005,-2763.7 3005,-2753.99 3005,-2745"/>
<polygon fill="black" stroke="black" points="3008.5,-2744.91 3005,-2734.91 3001.5,-2744.91 3008.5,-2744.91"/>
</g>
<!-- l1_exp10_linear2 -->
<g id="node174" class="node">
<title>l1_exp10_linear2</title>
<polygon fill="none" stroke="black" points="3087,-2659.82 2923,-2659.82 2923,-2621.82 3087,-2621.82 3087,-2659.82"/>
<text text-anchor="middle" x="3005" y="-2648.62" font-family="Arial" font-size="9.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3005" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3005" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l1_exp10_gelu&#45;&gt;l1_exp10_linear2 -->
<g id="edge201" class="edge">
<title>l1_exp10_gelu&#45;&gt;l1_exp10_linear2</title>
<path fill="none" stroke="black" d="M3005,-2696.77C3005,-2688.7 3005,-2678.99 3005,-2670"/>
<polygon fill="black" stroke="black" points="3008.5,-2669.91 3005,-2659.91 3001.5,-2669.91 3008.5,-2669.91"/>
</g>
<!-- l1_scatter_10 -->
<g id="node175" class="node">
<title>l1_scatter_10</title>
<ellipse fill="none" stroke="black" cx="3011" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3011" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3011" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3011" y="-2545.75" font-family="Arial" font-size="9.00">GPU 56 → All GPUs</text>
</g>
<!-- l1_exp10_linear2&#45;&gt;l1_scatter_10 -->
<g id="edge202" class="edge">
<title>l1_exp10_linear2&#45;&gt;l1_scatter_10</title>
<path fill="none" stroke="black" d="M3006.36,-2621.47C3006.94,-2613.61 3007.65,-2604.15 3008.33,-2595"/>
<polygon fill="black" stroke="black" points="3011.83,-2595.12 3009.08,-2584.89 3004.84,-2594.6 3011.83,-2595.12"/>
</g>
<!-- l1_scatter_10&#45;&gt;l1_expert_agg -->
<g id="edge203" class="edge">
<title>l1_scatter_10&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M3054.93,-2536.87C3068.75,-2531.42 3084.26,-2526.17 3099,-2523.08 3390.9,-2461.81 4302.33,-2449.92 4623.56,-2447.63"/>
<polygon fill="black" stroke="black" points="4623.84,-2451.12 4633.82,-2447.55 4623.79,-2444.12 4623.84,-2451.12"/>
</g>
<!-- l1_exp11_linear1 -->
<g id="node178" class="node">
<title>l1_exp11_linear1</title>
<polygon fill="none" stroke="black" points="4389,-2809.82 4225,-2809.82 4225,-2771.82 4389,-2771.82 4389,-2809.82"/>
<text text-anchor="middle" x="4307" y="-2798.62" font-family="Arial" font-size="9.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="4307" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4307" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l1_gather_11&#45;&gt;l1_exp11_linear1 -->
<g id="edge206" class="edge">
<title>l1_gather_11&#45;&gt;l1_exp11_linear1</title>
<path fill="none" stroke="black" d="M4315.59,-2857.7C4314.05,-2845.87 4312.22,-2831.86 4310.65,-2819.81"/>
<polygon fill="black" stroke="black" points="4314.11,-2819.29 4309.35,-2809.83 4307.17,-2820.2 4314.11,-2819.29"/>
</g>
<!-- l1_exp11_gelu -->
<g id="node179" class="node">
<title>l1_exp11_gelu</title>
<polygon fill="none" stroke="black" points="4350,-2734.82 4264,-2734.82 4264,-2696.82 4350,-2696.82 4350,-2734.82"/>
<text text-anchor="middle" x="4307" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4307" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4307" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 60&#45;63</text>
</g>
<!-- l1_exp11_linear1&#45;&gt;l1_exp11_gelu -->
<g id="edge207" class="edge">
<title>l1_exp11_linear1&#45;&gt;l1_exp11_gelu</title>
<path fill="none" stroke="black" d="M4307,-2771.77C4307,-2763.7 4307,-2753.99 4307,-2745"/>
<polygon fill="black" stroke="black" points="4310.5,-2744.91 4307,-2734.91 4303.5,-2744.91 4310.5,-2744.91"/>
</g>
<!-- l1_exp11_linear2 -->
<g id="node180" class="node">
<title>l1_exp11_linear2</title>
<polygon fill="none" stroke="black" points="4389,-2659.82 4225,-2659.82 4225,-2621.82 4389,-2621.82 4389,-2659.82"/>
<text text-anchor="middle" x="4307" y="-2648.62" font-family="Arial" font-size="9.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="4307" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4307" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l1_exp11_gelu&#45;&gt;l1_exp11_linear2 -->
<g id="edge208" class="edge">
<title>l1_exp11_gelu&#45;&gt;l1_exp11_linear2</title>
<path fill="none" stroke="black" d="M4307,-2696.77C4307,-2688.7 4307,-2678.99 4307,-2670"/>
<polygon fill="black" stroke="black" points="4310.5,-2669.91 4307,-2659.91 4303.5,-2669.91 4310.5,-2669.91"/>
</g>
<!-- l1_scatter_11 -->
<g id="node181" class="node">
<title>l1_scatter_11</title>
<ellipse fill="none" stroke="black" cx="4316" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4316" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4316" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4316" y="-2545.75" font-family="Arial" font-size="9.00">GPU 60 → All GPUs</text>
</g>
<!-- l1_exp11_linear2&#45;&gt;l1_scatter_11 -->
<g id="edge209" class="edge">
<title>l1_exp11_linear2&#45;&gt;l1_scatter_11</title>
<path fill="none" stroke="black" d="M4309.04,-2621.47C4309.92,-2613.61 4310.97,-2604.15 4311.99,-2595"/>
<polygon fill="black" stroke="black" points="4315.49,-2595.22 4313.11,-2584.89 4308.53,-2594.44 4315.49,-2595.22"/>
</g>
<!-- l1_scatter_11&#45;&gt;l1_expert_agg -->
<g id="edge210" class="edge">
<title>l1_scatter_11&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M4361.41,-2537.33C4374.08,-2532.28 4387.95,-2527.13 4401,-2523.08 4477.47,-2499.35 4565.85,-2479.66 4632.77,-2466.27"/>
<polygon fill="black" stroke="black" points="4633.78,-2469.63 4642.9,-2464.25 4632.41,-2462.77 4633.78,-2469.63"/>
</g>
<!-- l1_exp12_linear1 -->
<g id="node184" class="node">
<title>l1_exp12_linear1</title>
<polygon fill="none" stroke="black" points="5253,-2809.82 5089,-2809.82 5089,-2771.82 5253,-2771.82 5253,-2809.82"/>
<text text-anchor="middle" x="5171" y="-2798.62" font-family="Arial" font-size="9.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="5171" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5171" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l1_gather_12&#45;&gt;l1_exp12_linear1 -->
<g id="edge213" class="edge">
<title>l1_gather_12&#45;&gt;l1_exp12_linear1</title>
<path fill="none" stroke="black" d="M5185.32,-2857.7C5182.75,-2845.87 5179.7,-2831.86 5177.09,-2819.81"/>
<polygon fill="black" stroke="black" points="5180.46,-2818.86 5174.92,-2809.83 5173.62,-2820.35 5180.46,-2818.86"/>
</g>
<!-- l1_exp12_gelu -->
<g id="node185" class="node">
<title>l1_exp12_gelu</title>
<polygon fill="none" stroke="black" points="5079,-2734.82 4993,-2734.82 4993,-2696.82 5079,-2696.82 5079,-2734.82"/>
<text text-anchor="middle" x="5036" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5036" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5036" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 64&#45;67</text>
</g>
<!-- l1_exp12_linear1&#45;&gt;l1_exp12_gelu -->
<g id="edge214" class="edge">
<title>l1_exp12_linear1&#45;&gt;l1_exp12_gelu</title>
<path fill="none" stroke="black" d="M5137.63,-2771.77C5119.7,-2762.08 5097.41,-2750.02 5078.28,-2739.68"/>
<polygon fill="black" stroke="black" points="5079.92,-2736.59 5069.45,-2734.91 5076.59,-2742.74 5079.92,-2736.59"/>
</g>
<!-- l1_exp12_linear2 -->
<g id="node186" class="node">
<title>l1_exp12_linear2</title>
<polygon fill="none" stroke="black" points="5039,-2659.82 4875,-2659.82 4875,-2621.82 5039,-2621.82 5039,-2659.82"/>
<text text-anchor="middle" x="4957" y="-2648.62" font-family="Arial" font-size="9.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="4957" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4957" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l1_exp12_gelu&#45;&gt;l1_exp12_linear2 -->
<g id="edge215" class="edge">
<title>l1_exp12_gelu&#45;&gt;l1_exp12_linear2</title>
<path fill="none" stroke="black" d="M5016.47,-2696.77C5006.69,-2687.74 4994.69,-2676.65 4984.04,-2666.81"/>
<polygon fill="black" stroke="black" points="4986.3,-2664.12 4976.58,-2659.91 4981.55,-2669.27 4986.3,-2664.12"/>
</g>
<!-- l1_scatter_12 -->
<g id="node187" class="node">
<title>l1_scatter_12</title>
<ellipse fill="none" stroke="black" cx="4935" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4935" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4935" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4935" y="-2545.75" font-family="Arial" font-size="9.00">GPU 64 → All GPUs</text>
</g>
<!-- l1_exp12_linear2&#45;&gt;l1_scatter_12 -->
<g id="edge216" class="edge">
<title>l1_exp12_linear2&#45;&gt;l1_scatter_12</title>
<path fill="none" stroke="black" d="M4952.01,-2621.47C4949.85,-2613.53 4947.24,-2603.95 4944.73,-2594.7"/>
<polygon fill="black" stroke="black" points="4948.06,-2593.62 4942.06,-2584.89 4941.31,-2595.46 4948.06,-2593.62"/>
</g>
<!-- l1_scatter_12&#45;&gt;l1_expert_agg -->
<g id="edge217" class="edge">
<title>l1_scatter_12&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M4896.35,-2535.5C4877.49,-2525.04 4853.91,-2511.95 4830.71,-2499.08"/>
<polygon fill="black" stroke="black" points="4832.29,-2495.95 4821.85,-2494.16 4828.89,-2502.07 4832.29,-2495.95"/>
</g>
<!-- l1_exp13_linear1 -->
<g id="node190" class="node">
<title>l1_exp13_linear1</title>
<polygon fill="none" stroke="black" points="6436,-2809.82 6272,-2809.82 6272,-2771.82 6436,-2771.82 6436,-2809.82"/>
<text text-anchor="middle" x="6354" y="-2798.62" font-family="Arial" font-size="9.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="6354" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6354" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l1_gather_13&#45;&gt;l1_exp13_linear1 -->
<g id="edge220" class="edge">
<title>l1_gather_13&#45;&gt;l1_exp13_linear1</title>
<path fill="none" stroke="black" d="M6459,-2861.31C6438.09,-2847.47 6411.32,-2829.76 6390.04,-2815.67"/>
<polygon fill="black" stroke="black" points="6391.86,-2812.68 6381.59,-2810.08 6388,-2818.52 6391.86,-2812.68"/>
</g>
<!-- l1_exp13_gelu -->
<g id="node191" class="node">
<title>l1_exp13_gelu</title>
<polygon fill="none" stroke="black" points="6381,-2734.82 6295,-2734.82 6295,-2696.82 6381,-2696.82 6381,-2734.82"/>
<text text-anchor="middle" x="6338" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6338" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6338" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 68&#45;71</text>
</g>
<!-- l1_exp13_linear1&#45;&gt;l1_exp13_gelu -->
<g id="edge221" class="edge">
<title>l1_exp13_linear1&#45;&gt;l1_exp13_gelu</title>
<path fill="none" stroke="black" d="M6350.04,-2771.77C6348.26,-2763.61 6346.1,-2753.78 6344.11,-2744.71"/>
<polygon fill="black" stroke="black" points="6347.52,-2743.93 6341.97,-2734.91 6340.69,-2745.43 6347.52,-2743.93"/>
</g>
<!-- l1_exp13_linear2 -->
<g id="node192" class="node">
<title>l1_exp13_linear2</title>
<polygon fill="none" stroke="black" points="6341,-2659.82 6177,-2659.82 6177,-2621.82 6341,-2621.82 6341,-2659.82"/>
<text text-anchor="middle" x="6259" y="-2648.62" font-family="Arial" font-size="9.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="6259" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6259" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l1_exp13_gelu&#45;&gt;l1_exp13_linear2 -->
<g id="edge222" class="edge">
<title>l1_exp13_gelu&#45;&gt;l1_exp13_linear2</title>
<path fill="none" stroke="black" d="M6318.47,-2696.77C6308.69,-2687.74 6296.69,-2676.65 6286.04,-2666.81"/>
<polygon fill="black" stroke="black" points="6288.3,-2664.12 6278.58,-2659.91 6283.55,-2669.27 6288.3,-2664.12"/>
</g>
<!-- l1_scatter_13 -->
<g id="node193" class="node">
<title>l1_scatter_13</title>
<ellipse fill="none" stroke="black" cx="6237" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6237" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6237" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6237" y="-2545.75" font-family="Arial" font-size="9.00">GPU 68 → All GPUs</text>
</g>
<!-- l1_exp13_linear2&#45;&gt;l1_scatter_13 -->
<g id="edge223" class="edge">
<title>l1_exp13_linear2&#45;&gt;l1_scatter_13</title>
<path fill="none" stroke="black" d="M6254.01,-2621.47C6251.85,-2613.53 6249.24,-2603.95 6246.73,-2594.7"/>
<polygon fill="black" stroke="black" points="6250.06,-2593.62 6244.06,-2584.89 6243.31,-2595.46 6250.06,-2593.62"/>
</g>
<!-- l1_scatter_13&#45;&gt;l1_expert_agg -->
<g id="edge224" class="edge">
<title>l1_scatter_13&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M6188.74,-2538.34C6171.42,-2532.44 6151.57,-2526.55 6133,-2523.08 5888.73,-2477.46 5142.13,-2456.2 4853.04,-2449.51"/>
<polygon fill="black" stroke="black" points="4853.03,-2446.01 4842.95,-2449.28 4852.86,-2453.01 4853.03,-2446.01"/>
</g>
<!-- l1_exp14_linear1 -->
<g id="node196" class="node">
<title>l1_exp14_linear1</title>
<polygon fill="none" stroke="black" points="7308,-2809.82 7144,-2809.82 7144,-2771.82 7308,-2771.82 7308,-2809.82"/>
<text text-anchor="middle" x="7226" y="-2798.62" font-family="Arial" font-size="9.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="7226" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7226" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l1_gather_14&#45;&gt;l1_exp14_linear1 -->
<g id="edge227" class="edge">
<title>l1_gather_14&#45;&gt;l1_exp14_linear1</title>
<path fill="none" stroke="black" d="M7331,-2861.31C7310.09,-2847.47 7283.32,-2829.76 7262.04,-2815.67"/>
<polygon fill="black" stroke="black" points="7263.86,-2812.68 7253.59,-2810.08 7260,-2818.52 7263.86,-2812.68"/>
</g>
<!-- l1_exp14_gelu -->
<g id="node197" class="node">
<title>l1_exp14_gelu</title>
<polygon fill="none" stroke="black" points="7253,-2734.82 7167,-2734.82 7167,-2696.82 7253,-2696.82 7253,-2734.82"/>
<text text-anchor="middle" x="7210" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7210" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7210" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 72&#45;75</text>
</g>
<!-- l1_exp14_linear1&#45;&gt;l1_exp14_gelu -->
<g id="edge228" class="edge">
<title>l1_exp14_linear1&#45;&gt;l1_exp14_gelu</title>
<path fill="none" stroke="black" d="M7222.04,-2771.77C7220.26,-2763.61 7218.1,-2753.78 7216.11,-2744.71"/>
<polygon fill="black" stroke="black" points="7219.52,-2743.93 7213.97,-2734.91 7212.69,-2745.43 7219.52,-2743.93"/>
</g>
<!-- l1_exp14_linear2 -->
<g id="node198" class="node">
<title>l1_exp14_linear2</title>
<polygon fill="none" stroke="black" points="7213,-2659.82 7049,-2659.82 7049,-2621.82 7213,-2621.82 7213,-2659.82"/>
<text text-anchor="middle" x="7131" y="-2648.62" font-family="Arial" font-size="9.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="7131" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7131" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l1_exp14_gelu&#45;&gt;l1_exp14_linear2 -->
<g id="edge229" class="edge">
<title>l1_exp14_gelu&#45;&gt;l1_exp14_linear2</title>
<path fill="none" stroke="black" d="M7190.47,-2696.77C7180.69,-2687.74 7168.69,-2676.65 7158.04,-2666.81"/>
<polygon fill="black" stroke="black" points="7160.3,-2664.12 7150.58,-2659.91 7155.55,-2669.27 7160.3,-2664.12"/>
</g>
<!-- l1_scatter_14 -->
<g id="node199" class="node">
<title>l1_scatter_14</title>
<ellipse fill="none" stroke="black" cx="7109" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7109" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7109" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7109" y="-2545.75" font-family="Arial" font-size="9.00">GPU 72 → All GPUs</text>
</g>
<!-- l1_exp14_linear2&#45;&gt;l1_scatter_14 -->
<g id="edge230" class="edge">
<title>l1_exp14_linear2&#45;&gt;l1_scatter_14</title>
<path fill="none" stroke="black" d="M7126.01,-2621.47C7123.85,-2613.53 7121.24,-2603.95 7118.73,-2594.7"/>
<polygon fill="black" stroke="black" points="7122.06,-2593.62 7116.06,-2584.89 7115.31,-2595.46 7122.06,-2593.62"/>
</g>
<!-- l1_scatter_14&#45;&gt;l1_expert_agg -->
<g id="edge231" class="edge">
<title>l1_scatter_14&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M7061.04,-2538.21C7043.66,-2532.26 7023.7,-2526.37 7005,-2523.08 6584.72,-2449.13 5251.64,-2445.91 4851.59,-2446.67"/>
<polygon fill="black" stroke="black" points="4851.45,-2443.17 4841.45,-2446.69 4851.46,-2450.17 4851.45,-2443.17"/>
</g>
<!-- l1_exp15_linear1 -->
<g id="node202" class="node">
<title>l1_exp15_linear1</title>
<polygon fill="none" stroke="black" points="7750,-2809.82 7586,-2809.82 7586,-2771.82 7750,-2771.82 7750,-2809.82"/>
<text text-anchor="middle" x="7668" y="-2798.62" font-family="Arial" font-size="9.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="7668" y="-2788.62" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7668" y="-2778.62" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l1_gather_15&#45;&gt;l1_exp15_linear1 -->
<g id="edge234" class="edge">
<title>l1_gather_15&#45;&gt;l1_exp15_linear1</title>
<path fill="none" stroke="black" d="M7773,-2861.31C7752.09,-2847.47 7725.32,-2829.76 7704.04,-2815.67"/>
<polygon fill="black" stroke="black" points="7705.86,-2812.68 7695.59,-2810.08 7702,-2818.52 7705.86,-2812.68"/>
</g>
<!-- l1_exp15_gelu -->
<g id="node203" class="node">
<title>l1_exp15_gelu</title>
<polygon fill="none" stroke="black" points="7695,-2734.82 7609,-2734.82 7609,-2696.82 7695,-2696.82 7695,-2734.82"/>
<text text-anchor="middle" x="7652" y="-2723.62" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7652" y="-2713.62" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7652" y="-2703.62" font-family="Arial" font-size="9.00">GPUs 76&#45;79</text>
</g>
<!-- l1_exp15_linear1&#45;&gt;l1_exp15_gelu -->
<g id="edge235" class="edge">
<title>l1_exp15_linear1&#45;&gt;l1_exp15_gelu</title>
<path fill="none" stroke="black" d="M7664.04,-2771.77C7662.26,-2763.61 7660.1,-2753.78 7658.11,-2744.71"/>
<polygon fill="black" stroke="black" points="7661.52,-2743.93 7655.97,-2734.91 7654.69,-2745.43 7661.52,-2743.93"/>
</g>
<!-- l1_exp15_linear2 -->
<g id="node204" class="node">
<title>l1_exp15_linear2</title>
<polygon fill="none" stroke="black" points="7655,-2659.82 7491,-2659.82 7491,-2621.82 7655,-2621.82 7655,-2659.82"/>
<text text-anchor="middle" x="7573" y="-2648.62" font-family="Arial" font-size="9.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="7573" y="-2638.62" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7573" y="-2628.62" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l1_exp15_gelu&#45;&gt;l1_exp15_linear2 -->
<g id="edge236" class="edge">
<title>l1_exp15_gelu&#45;&gt;l1_exp15_linear2</title>
<path fill="none" stroke="black" d="M7616.47,-2696.67C7608.5,-2691.58 7600.49,-2685.57 7594,-2678.82 7591.14,-2675.85 7588.54,-2672.42 7586.2,-2668.86"/>
<polygon fill="black" stroke="black" points="7589.07,-2666.83 7580.99,-2659.98 7583.03,-2670.38 7589.07,-2666.83"/>
</g>
<!-- l1_scatter_15 -->
<g id="node205" class="node">
<title>l1_scatter_15</title>
<ellipse fill="none" stroke="black" cx="7551" cy="-2557.95" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7551" y="-2565.75" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7551" y="-2555.75" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7551" y="-2545.75" font-family="Arial" font-size="9.00">GPU 76 → All GPUs</text>
</g>
<!-- l1_exp15_linear2&#45;&gt;l1_scatter_15 -->
<g id="edge237" class="edge">
<title>l1_exp15_linear2&#45;&gt;l1_scatter_15</title>
<path fill="none" stroke="black" d="M7568.01,-2621.47C7565.85,-2613.53 7563.24,-2603.95 7560.73,-2594.7"/>
<polygon fill="black" stroke="black" points="7564.06,-2593.62 7558.06,-2584.89 7557.31,-2595.46 7564.06,-2593.62"/>
</g>
<!-- l1_scatter_15&#45;&gt;l1_expert_agg -->
<g id="edge238" class="edge">
<title>l1_scatter_15&#45;&gt;l1_expert_agg</title>
<path fill="none" stroke="black" d="M7503.31,-2538.24C7485.87,-2532.25 7465.8,-2526.33 7447,-2523.08 7189.34,-2478.47 5336.87,-2454.04 4852.59,-2448.37"/>
<polygon fill="black" stroke="black" points="4852.48,-2444.87 4842.44,-2448.25 4852.4,-2451.87 4852.48,-2444.87"/>
</g>
<!-- l1_expert_agg&#45;&gt;l1_moe_res -->
<g id="edge239" class="edge">
<title>l1_expert_agg&#45;&gt;l1_moe_res</title>
<path fill="none" stroke="black" d="M4826.27,-2419.47C4887.93,-2401.79 4969.72,-2378.33 5031.97,-2360.48"/>
<polygon fill="black" stroke="black" points="5033.13,-2363.78 5041.78,-2357.66 5031.2,-2357.05 5033.13,-2363.78"/>
</g>
<!-- l2_mha_qkv -->
<g id="node208" class="node">
<title>l2_mha_qkv</title>
<polygon fill="none" stroke="black" points="5127.5,-2201.08 4974.5,-2201.08 4974.5,-2163.08 5127.5,-2163.08 5127.5,-2201.08"/>
<text text-anchor="middle" x="5051" y="-2189.88" font-family="Arial" font-size="9.00">MHA QKV Linear</text>
<text text-anchor="middle" x="5051" y="-2179.88" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="5051" y="-2169.88" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l1_moe_res&#45;&gt;l2_mha_qkv -->
<g id="edge241" class="edge">
<title>l1_moe_res&#45;&gt;l2_mha_qkv</title>
<path fill="none" stroke="black" d="M5110.61,-2304.75C5097.49,-2277.96 5077.59,-2237.35 5064.45,-2210.53"/>
<polygon fill="black" stroke="black" points="5067.48,-2208.76 5059.94,-2201.32 5061.19,-2211.84 5067.48,-2208.76"/>
</g>
<!-- l2_mha_res -->
<g id="node211" class="node">
<title>l2_mha_res</title>
<polygon fill="none" stroke="black" points="5217.91,-1966.08 5006.48,-1966.08 4952.09,-1910.08 5163.52,-1910.08 5217.91,-1966.08"/>
<text text-anchor="middle" x="5085" y="-1940.88" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="5085" y="-1930.88" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l1_moe_res&#45;&gt;l2_mha_res -->
<g id="edge245" class="edge">
<title>l1_moe_res&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M5133.43,-2304.99C5142.87,-2275.42 5156,-2226.47 5156,-2183.08 5156,-2183.08 5156,-2183.08 5156,-2031.08 5156,-2009.06 5143.1,-1989.09 5128.29,-1973.43"/>
<polygon fill="black" stroke="black" points="5130.47,-1970.67 5120.92,-1966.1 5125.54,-1975.63 5130.47,-1970.67"/>
</g>
<!-- l2_mha_attn -->
<g id="node209" class="node">
<title>l2_mha_attn</title>
<polygon fill="none" stroke="black" points="5094.5,-2126.08 5011.5,-2126.08 5011.5,-2088.08 5094.5,-2088.08 5094.5,-2126.08"/>
<text text-anchor="middle" x="5053" y="-2114.88" font-family="Arial" font-size="9.00">MHA Attention</text>
<text text-anchor="middle" x="5053" y="-2104.88" font-family="Arial" font-size="9.00">[1024, 16×512]</text>
<text text-anchor="middle" x="5053" y="-2094.88" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_attn -->
<g id="edge242" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M5051.49,-2163.03C5051.72,-2154.96 5051.98,-2145.25 5052.23,-2136.26"/>
<polygon fill="black" stroke="black" points="5055.73,-2136.26 5052.5,-2126.17 5048.73,-2136.07 5055.73,-2136.26"/>
</g>
<!-- l2_mha_out -->
<g id="node210" class="node">
<title>l2_mha_out</title>
<polygon fill="none" stroke="black" points="5125,-2051.08 4993,-2051.08 4993,-2013.08 5125,-2013.08 5125,-2051.08"/>
<text text-anchor="middle" x="5059" y="-2039.88" font-family="Arial" font-size="9.00">MHA Output Linear</text>
<text text-anchor="middle" x="5059" y="-2029.88" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="5059" y="-2019.88" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_out -->
<g id="edge243" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_out</title>
<path fill="none" stroke="black" d="M5054.48,-2088.03C5055.15,-2079.96 5055.94,-2070.25 5056.68,-2061.26"/>
<polygon fill="black" stroke="black" points="5060.18,-2061.42 5057.51,-2051.17 5053.21,-2060.85 5060.18,-2061.42"/>
</g>
<!-- l2_mha_out&#45;&gt;l2_mha_res -->
<g id="edge244" class="edge">
<title>l2_mha_out&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M5064.14,-2012.9C5067.1,-2002.41 5070.94,-1988.82 5074.52,-1976.16"/>
<polygon fill="black" stroke="black" points="5077.96,-1976.87 5077.31,-1966.29 5071.22,-1974.96 5077.96,-1976.87"/>
</g>
<!-- l2_global_gate -->
<g id="node212" class="node">
<title>l2_global_gate</title>
<polygon fill="none" stroke="black" points="4916.47,-1976.08 4715.29,-1976.08 4663.53,-1900.08 4864.71,-1900.08 4916.47,-1976.08"/>
<text text-anchor="middle" x="4790" y="-1945.88" font-family="Arial" font-size="9.00">Global Gate</text>
<text text-anchor="middle" x="4790" y="-1935.88" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="4790" y="-1925.88" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_global_gate -->
<g id="edge246" class="edge">
<title>l2_mha_res&#45;&gt;l2_global_gate</title>
<path fill="none" stroke="black" d="M4979.19,-1938.08C4953.08,-1938.08 4926.96,-1938.08 4900.84,-1938.08"/>
<polygon fill="black" stroke="black" points="4900.83,-1934.58 4890.83,-1938.08 4900.83,-1941.58 4900.83,-1934.58"/>
</g>
<!-- l2_gather_0 -->
<g id="node214" class="node">
<title>l2_gather_0</title>
<ellipse fill="none" stroke="black" cx="4213" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4213" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4213" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4213" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 32</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_0 -->
<g id="edge248" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_0</title>
<path fill="none" stroke="black" d="M4996.07,-1909.99C4980.19,-1906.04 4963.71,-1902.49 4948,-1900.08 4912.11,-1894.56 4328.21,-1887.76 4295,-1873.08 4271.22,-1862.56 4250.68,-1841.73 4236.1,-1823.57"/>
<polygon fill="black" stroke="black" points="4238.71,-1821.23 4229.83,-1815.46 4233.18,-1825.51 4238.71,-1821.23"/>
</g>
<!-- l2_gather_1 -->
<g id="node220" class="node">
<title>l2_gather_1</title>
<ellipse fill="none" stroke="black" cx="5957" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5957" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5957" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5957" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 36</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_1 -->
<g id="edge255" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_1</title>
<path fill="none" stroke="black" d="M5190.49,-1937.78C5377.62,-1937.53 5759.19,-1929.78 5878,-1873.08 5900.89,-1862.15 5920.57,-1841.53 5934.56,-1823.57"/>
<polygon fill="black" stroke="black" points="5937.38,-1825.65 5940.58,-1815.56 5931.78,-1821.45 5937.38,-1825.65"/>
</g>
<!-- l2_gather_2 -->
<g id="node226" class="node">
<title>l2_gather_2</title>
<ellipse fill="none" stroke="black" cx="3783" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3783" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3783" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3783" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 40</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_2 -->
<g id="edge262" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_2</title>
<path fill="none" stroke="black" d="M4997.21,-1910.05C4980.99,-1906.01 4964.09,-1902.42 4948,-1900.08 4888.44,-1891.42 3920.24,-1896.97 3865,-1873.08 3841.14,-1862.76 3820.59,-1841.92 3806.03,-1823.71"/>
<polygon fill="black" stroke="black" points="3808.65,-1821.37 3799.78,-1815.58 3803.1,-1825.64 3808.65,-1821.37"/>
</g>
<!-- l2_gather_3 -->
<g id="node232" class="node">
<title>l2_gather_3</title>
<ellipse fill="none" stroke="black" cx="1621" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1621" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1621" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1621" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 44</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_3 -->
<g id="edge269" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_3</title>
<path fill="none" stroke="black" d="M4997.98,-1910C4981.53,-1905.9 4964.36,-1902.31 4948,-1900.08 4804.38,-1880.52 2483.94,-1883.6 2339,-1882.08 2330.17,-1881.99 1711.13,-1876.54 1703,-1873.08 1678.92,-1862.82 1658.26,-1841.77 1643.7,-1823.44"/>
<polygon fill="black" stroke="black" points="1646.3,-1821.08 1637.45,-1815.26 1640.74,-1825.33 1646.3,-1821.08"/>
</g>
<!-- l2_gather_4 -->
<g id="node238" class="node">
<title>l2_gather_4</title>
<ellipse fill="none" stroke="black" cx="5085" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5085" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5085" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5085" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 48</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_4 -->
<g id="edge276" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_4</title>
<path fill="none" stroke="black" d="M5085,-1909.77C5085,-1886.28 5085,-1852.18 5085,-1826.39"/>
<polygon fill="black" stroke="black" points="5088.5,-1826.25 5085,-1816.25 5081.5,-1826.25 5088.5,-1826.25"/>
</g>
<!-- l2_gather_5 -->
<g id="node244" class="node">
<title>l2_gather_5</title>
<ellipse fill="none" stroke="black" cx="2911" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2911" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2911" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2911" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 52</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_5 -->
<g id="edge283" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_5</title>
<path fill="none" stroke="black" d="M4997.97,-1910.07C4981.53,-1905.97 4964.35,-1902.35 4948,-1900.08 4787.2,-1877.74 3649.33,-1884.56 3487,-1882.08 3459.55,-1881.66 3018.23,-1883.89 2993,-1873.08 2968.94,-1862.77 2948.28,-1841.72 2933.71,-1823.4"/>
<polygon fill="black" stroke="black" points="2936.32,-1821.04 2927.46,-1815.23 2930.76,-1825.3 2936.32,-1821.04"/>
</g>
<!-- l2_gather_6 -->
<g id="node250" class="node">
<title>l2_gather_6</title>
<ellipse fill="none" stroke="black" cx="6387" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6387" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6387" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6387" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 56</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_6 -->
<g id="edge290" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_6</title>
<path fill="none" stroke="black" d="M5188.77,-1936.03C5465.65,-1932.61 6207.74,-1919.2 6308,-1873.08 6331.2,-1862.41 6350.99,-1841.57 6364.96,-1823.45"/>
<polygon fill="black" stroke="black" points="6367.82,-1825.48 6370.96,-1815.36 6362.19,-1821.31 6367.82,-1825.48"/>
</g>
<!-- l2_gather_7 -->
<g id="node256" class="node">
<title>l2_gather_7</title>
<ellipse fill="none" stroke="black" cx="2051" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2051" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2051" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2051" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 60</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_7 -->
<g id="edge297" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_7</title>
<path fill="none" stroke="black" d="M4997.98,-1910.01C4981.53,-1905.91 4964.35,-1902.31 4948,-1900.08 4819.25,-1882.49 2738.94,-1883.81 2609,-1882.08 2582.55,-1881.73 2157.31,-1883.5 2133,-1873.08 2108.95,-1862.76 2088.28,-1841.71 2073.72,-1823.4"/>
<polygon fill="black" stroke="black" points="2076.32,-1821.04 2067.46,-1815.22 2070.76,-1825.29 2076.32,-1821.04"/>
</g>
<!-- l2_gather_8 -->
<g id="node262" class="node">
<title>l2_gather_8</title>
<ellipse fill="none" stroke="black" cx="7259" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7259" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7259" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7259" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 64</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_8 -->
<g id="edge304" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_8</title>
<path fill="none" stroke="black" d="M5189.05,-1936.09C5599.51,-1931.92 7088.41,-1914.02 7180,-1873.08 7203.31,-1862.66 7223.1,-1841.83 7237.05,-1823.64"/>
<polygon fill="black" stroke="black" points="7239.92,-1825.64 7243.03,-1815.52 7234.28,-1821.49 7239.92,-1825.64"/>
</g>
<!-- l2_gather_9 -->
<g id="node268" class="node">
<title>l2_gather_9</title>
<ellipse fill="none" stroke="black" cx="2481" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2481" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2481" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2481" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 68</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_9 -->
<g id="edge311" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_9</title>
<path fill="none" stroke="black" d="M4997.98,-1910.04C4981.53,-1905.94 4964.35,-1902.33 4948,-1900.08 4851.41,-1886.76 3290.5,-1883.27 3193,-1882.08 3123,-1881.22 2627.4,-1900.53 2563,-1873.08 2538.92,-1862.82 2518.26,-1841.77 2503.7,-1823.44"/>
<polygon fill="black" stroke="black" points="2506.3,-1821.08 2497.45,-1815.26 2500.74,-1825.33 2506.3,-1821.08"/>
</g>
<!-- l2_gather_10 -->
<g id="node274" class="node">
<title>l2_gather_10</title>
<ellipse fill="none" stroke="black" cx="3353" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3353" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3353" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3353" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 72</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_10 -->
<g id="edge318" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_10</title>
<path fill="none" stroke="black" d="M4997.6,-1910.05C4981.26,-1905.98 4964.22,-1902.38 4948,-1900.08 4836.21,-1884.24 4044.89,-1884.1 3932,-1882.08 3876.78,-1881.09 3485.77,-1894.83 3435,-1873.08 3410.94,-1862.77 3390.28,-1841.72 3375.71,-1823.4"/>
<polygon fill="black" stroke="black" points="3378.32,-1821.04 3369.46,-1815.23 3372.76,-1825.3 3378.32,-1821.04"/>
</g>
<!-- l2_gather_11 -->
<g id="node280" class="node">
<title>l2_gather_11</title>
<ellipse fill="none" stroke="black" cx="4655" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4655" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4655" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4655" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 76</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_11 -->
<g id="edge325" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_11</title>
<path fill="none" stroke="black" d="M4991.44,-1909.99C4976.97,-1906.33 4962.14,-1902.88 4948,-1900.08 4855.26,-1881.71 4821.74,-1915 4737,-1873.08 4713.86,-1861.63 4693.43,-1841 4678.75,-1823.18"/>
<polygon fill="black" stroke="black" points="4681.39,-1820.87 4672.42,-1815.23 4675.91,-1825.23 4681.39,-1820.87"/>
</g>
<!-- l2_gather_12 -->
<g id="node286" class="node">
<title>l2_gather_12</title>
<ellipse fill="none" stroke="black" cx="5527" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5527" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5527" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5527" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 80</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_12 -->
<g id="edge332" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_12</title>
<path fill="none" stroke="black" d="M5188.8,-1935.88C5264.63,-1931.07 5367.78,-1916.1 5448,-1873.08 5470,-1861.28 5489.41,-1841.11 5503.48,-1823.61"/>
<polygon fill="black" stroke="black" points="5506.58,-1825.32 5509.95,-1815.28 5501.06,-1821.03 5506.58,-1825.32"/>
</g>
<!-- l2_gather_13 -->
<g id="node292" class="node">
<title>l2_gather_13</title>
<ellipse fill="none" stroke="black" cx="6829" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6829" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6829" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6829" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 84</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_13 -->
<g id="edge339" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_13</title>
<path fill="none" stroke="black" d="M5190.33,-1937.61C5533.98,-1938.72 6608.55,-1936.97 6750,-1873.08 6773.27,-1862.57 6793.06,-1841.73 6807.02,-1823.57"/>
<polygon fill="black" stroke="black" points="6809.88,-1825.58 6813.01,-1815.46 6804.25,-1821.42 6809.88,-1825.58"/>
</g>
<!-- l2_gather_14 -->
<g id="node298" class="node">
<title>l2_gather_14</title>
<ellipse fill="none" stroke="black" cx="7701" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7701" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7701" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7701" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 88</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_14 -->
<g id="edge346" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_14</title>
<path fill="none" stroke="black" d="M5189.5,-1936.67C5653.49,-1934.58 7509.3,-1923.09 7622,-1873.08 7645.34,-1862.72 7665.13,-1841.89 7679.07,-1823.69"/>
<polygon fill="black" stroke="black" points="7681.94,-1825.68 7685.05,-1815.55 7676.31,-1821.53 7681.94,-1825.68"/>
</g>
<!-- l2_gather_15 -->
<g id="node304" class="node">
<title>l2_gather_15</title>
<ellipse fill="none" stroke="black" cx="8143" cy="-1789.08" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="8143" y="-1796.88" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="8143" y="-1786.88" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="8143" y="-1776.88" font-family="Arial" font-size="9.00">All GPUs → GPU 92</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gather_15 -->
<g id="edge353" class="edge">
<title>l2_mha_res&#45;&gt;l2_gather_15</title>
<path fill="none" stroke="black" d="M5188.09,-1935C5712.08,-1924.4 8055.59,-1876.79 8064,-1873.08 8087.36,-1862.77 8107.15,-1841.93 8121.08,-1823.72"/>
<polygon fill="black" stroke="black" points="8123.96,-1825.71 8127.06,-1815.58 8118.32,-1821.57 8123.96,-1825.71"/>
</g>
<!-- l2_moe_res -->
<g id="node310" class="node">
<title>l2_moe_res</title>
<polygon fill="none" stroke="black" points="5440.91,-1265.34 5229.48,-1265.34 5175.09,-1209.34 5386.52,-1209.34 5440.91,-1265.34"/>
<text text-anchor="middle" x="5308" y="-1240.14" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="5308" y="-1230.14" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_res -->
<g id="edge360" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M5189.65,-1936.85C5728.62,-1935.45 8168.41,-1926.17 8225,-1873.08 8252,-1847.75 8232,-1827.1 8232,-1790.08 8232,-1790.08 8232,-1790.08 8232,-1349.34 8232,-1277.9 5973.28,-1246.29 5426.24,-1239.68"/>
<polygon fill="black" stroke="black" points="5426.01,-1236.18 5415.97,-1239.56 5425.93,-1243.18 5426.01,-1236.18"/>
</g>
<!-- l2_route_0 -->
<g id="node213" class="node">
<title>l2_route_0</title>
<polygon fill="none" stroke="black" points="4125.32,-1827.08 3927.55,-1827.08 3876.68,-1751.08 4074.45,-1751.08 4125.32,-1827.08"/>
<text text-anchor="middle" x="4001" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4001" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 0</text>
<text text-anchor="middle" x="4001" y="-1776.88" font-family="Arial" font-size="9.00">GPU 32</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_0 -->
<g id="edge247" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4685.55,-1932.7C4526.96,-1925.07 4233.34,-1906.84 4134,-1873.08 4106.92,-1863.88 4079.67,-1848.24 4056.94,-1833.01"/>
<polygon fill="black" stroke="black" points="4058.69,-1829.97 4048.46,-1827.21 4054.74,-1835.75 4058.69,-1829.97"/>
</g>
<!-- l2_route_1 -->
<g id="node219" class="node">
<title>l2_route_1</title>
<polygon fill="none" stroke="black" points="5869.32,-1827.08 5671.55,-1827.08 5620.68,-1751.08 5818.45,-1751.08 5869.32,-1827.08"/>
<text text-anchor="middle" x="5745" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5745" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 1</text>
<text text-anchor="middle" x="5745" y="-1776.88" font-family="Arial" font-size="9.00">GPU 36</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_1 -->
<g id="edge254" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.9,-1913.23C4895.29,-1908.02 4918.36,-1903.15 4940,-1900.08 5087.31,-1879.16 5466.6,-1916.22 5609,-1873.08 5637.41,-1864.47 5665.9,-1848.49 5689.41,-1832.84"/>
<polygon fill="black" stroke="black" points="5691.55,-1835.62 5697.84,-1827.1 5687.61,-1829.84 5691.55,-1835.62"/>
</g>
<!-- l2_route_2 -->
<g id="node225" class="node">
<title>l2_route_2</title>
<polygon fill="none" stroke="black" points="3695.32,-1827.08 3497.55,-1827.08 3446.68,-1751.08 3644.45,-1751.08 3695.32,-1827.08"/>
<text text-anchor="middle" x="3571" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3571" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 2</text>
<text text-anchor="middle" x="3571" y="-1776.88" font-family="Arial" font-size="9.00">GPU 40</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_2 -->
<g id="edge261" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4688.82,-1937.46C4455.43,-1937.34 3885.53,-1930.91 3704,-1873.08 3676.52,-1864.32 3649,-1848.6 3626.19,-1833.17"/>
<polygon fill="black" stroke="black" points="3627.9,-1830.1 3617.68,-1827.29 3623.91,-1835.85 3627.9,-1830.1"/>
</g>
<!-- l2_route_3 -->
<g id="node231" class="node">
<title>l2_route_3</title>
<polygon fill="none" stroke="black" points="1533.32,-1827.08 1335.55,-1827.08 1284.68,-1751.08 1482.45,-1751.08 1533.32,-1827.08"/>
<text text-anchor="middle" x="1409" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1409" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 3</text>
<text text-anchor="middle" x="1409" y="-1776.88" font-family="Arial" font-size="9.00">GPU 44</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_3 -->
<g id="edge268" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4688.34,-1936.6C4154.75,-1933.87 1696.17,-1918.88 1542,-1873.08 1513.88,-1864.72 1485.87,-1848.7 1462.86,-1832.93"/>
<polygon fill="black" stroke="black" points="1464.81,-1830.03 1454.61,-1827.15 1460.79,-1835.76 1464.81,-1830.03"/>
</g>
<!-- l2_route_4 -->
<g id="node237" class="node">
<title>l2_route_4</title>
<polygon fill="none" stroke="black" points="4997.32,-1827.08 4799.55,-1827.08 4748.68,-1751.08 4946.45,-1751.08 4997.32,-1827.08"/>
<text text-anchor="middle" x="4873" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4873" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 4</text>
<text text-anchor="middle" x="4873" y="-1776.88" font-family="Arial" font-size="9.00">GPU 48</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_4 -->
<g id="edge275" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4810.94,-1899.98C4821.9,-1880.57 4835.42,-1856.63 4847.04,-1836.05"/>
<polygon fill="black" stroke="black" points="4850.19,-1837.59 4852.06,-1827.16 4844.1,-1834.15 4850.19,-1837.59"/>
</g>
<!-- l2_route_5 -->
<g id="node243" class="node">
<title>l2_route_5</title>
<polygon fill="none" stroke="black" points="2823.32,-1827.08 2625.55,-1827.08 2574.68,-1751.08 2772.45,-1751.08 2823.32,-1827.08"/>
<text text-anchor="middle" x="2699" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2699" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 5</text>
<text text-anchor="middle" x="2699" y="-1776.88" font-family="Arial" font-size="9.00">GPU 52</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_5 -->
<g id="edge282" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4688.35,-1936.84C4311.94,-1935.55 3009.85,-1927.18 2832,-1873.08 2804.05,-1864.58 2776.17,-1848.62 2753.2,-1832.95"/>
<polygon fill="black" stroke="black" points="2755.17,-1830.05 2744.97,-1827.2 2751.16,-1835.79 2755.17,-1830.05"/>
</g>
<!-- l2_route_6 -->
<g id="node249" class="node">
<title>l2_route_6</title>
<polygon fill="none" stroke="black" points="6299.32,-1827.08 6101.55,-1827.08 6050.68,-1751.08 6248.45,-1751.08 6299.32,-1827.08"/>
<text text-anchor="middle" x="6175" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6175" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 6</text>
<text text-anchor="middle" x="6175" y="-1776.88" font-family="Arial" font-size="9.00">GPU 56</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_6 -->
<g id="edge289" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.87,-1912.99C4895.26,-1907.79 4918.33,-1902.98 4940,-1900.08 5061.07,-1883.86 5921.82,-1907.57 6039,-1873.08 6067.6,-1864.66 6096.22,-1848.62 6119.77,-1832.87"/>
<polygon fill="black" stroke="black" points="6121.94,-1835.63 6128.21,-1827.09 6117.98,-1829.85 6121.94,-1835.63"/>
</g>
<!-- l2_route_7 -->
<g id="node255" class="node">
<title>l2_route_7</title>
<polygon fill="none" stroke="black" points="1963.32,-1827.08 1765.55,-1827.08 1714.68,-1751.08 1912.45,-1751.08 1963.32,-1827.08"/>
<text text-anchor="middle" x="1839" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1839" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 7</text>
<text text-anchor="middle" x="1839" y="-1776.88" font-family="Arial" font-size="9.00">GPU 60</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_7 -->
<g id="edge296" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4688.02,-1936.27C4198.12,-1932.22 2104.42,-1912.64 1972,-1873.08 1943.9,-1864.68 1915.88,-1848.65 1892.87,-1832.89"/>
<polygon fill="black" stroke="black" points="1894.82,-1829.99 1884.62,-1827.11 1890.8,-1835.72 1894.82,-1829.99"/>
</g>
<!-- l2_route_8 -->
<g id="node261" class="node">
<title>l2_route_8</title>
<polygon fill="none" stroke="black" points="7171.32,-1827.08 6973.55,-1827.08 6922.68,-1751.08 7120.45,-1751.08 7171.32,-1827.08"/>
<text text-anchor="middle" x="7047" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7047" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 8</text>
<text text-anchor="middle" x="7047" y="-1776.88" font-family="Arial" font-size="9.00">GPU 64</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_8 -->
<g id="edge303" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.45,-1912.9C4894.95,-1907.66 4918.18,-1902.86 4940,-1900.08 5103.68,-1879.18 6260.01,-1884.61 6425,-1882.08 6533.01,-1880.42 6807.29,-1903.27 6911,-1873.08 6939.62,-1864.75 6968.25,-1848.72 6991.8,-1832.96"/>
<polygon fill="black" stroke="black" points="6993.97,-1835.72 7000.24,-1827.18 6990.01,-1829.94 6993.97,-1835.72"/>
</g>
<!-- l2_route_9 -->
<g id="node267" class="node">
<title>l2_route_9</title>
<polygon fill="none" stroke="black" points="2393.32,-1827.08 2195.55,-1827.08 2144.68,-1751.08 2342.45,-1751.08 2393.32,-1827.08"/>
<text text-anchor="middle" x="2269" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2269" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 9</text>
<text text-anchor="middle" x="2269" y="-1776.88" font-family="Arial" font-size="9.00">GPU 68</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_9 -->
<g id="edge310" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4688.65,-1937.5C4261.88,-1938.83 2622.78,-1939.53 2402,-1873.08 2374.03,-1864.66 2346.14,-1848.71 2323.17,-1833.03"/>
<polygon fill="black" stroke="black" points="2325.14,-1830.14 2314.94,-1827.28 2321.13,-1835.87 2325.14,-1830.14"/>
</g>
<!-- l2_route_10 -->
<g id="node273" class="node">
<title>l2_route_10</title>
<polygon fill="none" stroke="black" points="3264.69,-1827.08 3058.38,-1827.08 3005.31,-1751.08 3211.62,-1751.08 3264.69,-1827.08"/>
<text text-anchor="middle" x="3135" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3135" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 10</text>
<text text-anchor="middle" x="3135" y="-1776.88" font-family="Arial" font-size="9.00">GPU 72</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_10 -->
<g id="edge317" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4687.71,-1935.67C4369.21,-1930.88 3408.45,-1913.24 3274,-1873.08 3245.22,-1864.48 3216.24,-1848.6 3192.25,-1833.01"/>
<polygon fill="black" stroke="black" points="3193.91,-1829.91 3183.64,-1827.29 3190.04,-1835.74 3193.91,-1829.91"/>
</g>
<!-- l2_route_11 -->
<g id="node279" class="node">
<title>l2_route_11</title>
<polygon fill="none" stroke="black" points="4566.69,-1827.08 4360.38,-1827.08 4307.31,-1751.08 4513.62,-1751.08 4566.69,-1827.08"/>
<text text-anchor="middle" x="4437" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4437" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 11</text>
<text text-anchor="middle" x="4437" y="-1776.88" font-family="Arial" font-size="9.00">GPU 76</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_11 -->
<g id="edge324" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4667.58,-1906.15C4637.13,-1896.91 4604.93,-1885.8 4576,-1873.08 4550.45,-1861.84 4523.8,-1846.83 4500.76,-1832.66"/>
<polygon fill="black" stroke="black" points="4502.45,-1829.6 4492.11,-1827.29 4498.76,-1835.54 4502.45,-1829.6"/>
</g>
<!-- l2_route_12 -->
<g id="node285" class="node">
<title>l2_route_12</title>
<polygon fill="none" stroke="black" points="5438.69,-1827.08 5232.38,-1827.08 5179.31,-1751.08 5385.62,-1751.08 5438.69,-1827.08"/>
<text text-anchor="middle" x="5309" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5309" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 12</text>
<text text-anchor="middle" x="5309" y="-1776.88" font-family="Arial" font-size="9.00">GPU 80</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_12 -->
<g id="edge331" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4874.49,-1914.3C4895.76,-1909.1 4918.63,-1903.97 4940,-1900.08 5039.96,-1881.88 5070.68,-1905.39 5167,-1873.08 5195.45,-1863.53 5224.47,-1847.84 5248.8,-1832.65"/>
<polygon fill="black" stroke="black" points="5250.99,-1835.41 5257.55,-1827.09 5247.23,-1829.5 5250.99,-1835.41"/>
</g>
<!-- l2_route_13 -->
<g id="node291" class="node">
<title>l2_route_13</title>
<polygon fill="none" stroke="black" points="6740.69,-1827.08 6534.38,-1827.08 6481.31,-1751.08 6687.62,-1751.08 6740.69,-1827.08"/>
<text text-anchor="middle" x="6611" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6611" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 13</text>
<text text-anchor="middle" x="6611" y="-1776.88" font-family="Arial" font-size="9.00">GPU 84</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_13 -->
<g id="edge338" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.86,-1912.88C4895.25,-1907.68 4918.32,-1902.9 4940,-1900.08 5108.49,-1878.13 6305.42,-1919.03 6469,-1873.08 6498.76,-1864.72 6528.73,-1848.59 6553.43,-1832.76"/>
<polygon fill="black" stroke="black" points="6555.49,-1835.59 6561.93,-1827.18 6551.65,-1829.74 6555.49,-1835.59"/>
</g>
<!-- l2_route_14 -->
<g id="node297" class="node">
<title>l2_route_14</title>
<polygon fill="none" stroke="black" points="7612.69,-1827.08 7406.38,-1827.08 7353.31,-1751.08 7559.62,-1751.08 7612.69,-1827.08"/>
<text text-anchor="middle" x="7483" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7483" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 14</text>
<text text-anchor="middle" x="7483" y="-1776.88" font-family="Arial" font-size="9.00">GPU 88</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_14 -->
<g id="edge345" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.45,-1912.87C4894.95,-1907.64 4918.18,-1902.85 4940,-1900.08 5128.5,-1876.17 6460,-1884.32 6650,-1882.08 6688.39,-1881.63 7304.01,-1883.36 7341,-1873.08 7370.78,-1864.8 7400.76,-1848.69 7425.45,-1832.84"/>
<polygon fill="black" stroke="black" points="7427.52,-1835.68 7433.96,-1827.26 7423.67,-1829.82 7427.52,-1835.68"/>
</g>
<!-- l2_route_15 -->
<g id="node303" class="node">
<title>l2_route_15</title>
<polygon fill="none" stroke="black" points="8054.69,-1827.08 7848.38,-1827.08 7795.31,-1751.08 8001.62,-1751.08 8054.69,-1827.08"/>
<text text-anchor="middle" x="7925" y="-1796.88" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7925" y="-1786.88" font-family="Arial" font-size="9.00">Select tokens for Expert 15</text>
<text text-anchor="middle" x="7925" y="-1776.88" font-family="Arial" font-size="9.00">GPU 92</text>
</g>
<!-- l2_global_gate&#45;&gt;l2_route_15 -->
<g id="edge352" class="edge">
<title>l2_global_gate&#45;&gt;l2_route_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4873.45,-1912.86C4894.95,-1907.62 4918.18,-1902.83 4940,-1900.08 5044.56,-1886.87 6731.61,-1883.08 6837,-1882.08 6942.11,-1881.08 7681.67,-1901.04 7783,-1873.08 7812.92,-1864.82 7843.03,-1848.62 7867.77,-1832.7"/>
<polygon fill="black" stroke="black" points="7869.86,-1835.51 7876.29,-1827.09 7866.01,-1829.67 7869.86,-1835.51"/>
</g>
<!-- l2_exp0_linear1 -->
<g id="node215" class="node">
<title>l2_exp0_linear1</title>
<polygon fill="none" stroke="black" points="4283,-1714.08 4119,-1714.08 4119,-1676.08 4283,-1676.08 4283,-1714.08"/>
<text text-anchor="middle" x="4201" y="-1702.88" font-family="Arial" font-size="9.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="4201" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4201" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l2_gather_0&#45;&gt;l2_exp0_linear1 -->
<g id="edge249" class="edge">
<title>l2_gather_0&#45;&gt;l2_exp0_linear1</title>
<path fill="none" stroke="black" d="M4209.59,-1761.96C4208.05,-1750.13 4206.22,-1736.12 4204.65,-1724.07"/>
<polygon fill="black" stroke="black" points="4208.11,-1723.55 4203.35,-1714.09 4201.17,-1724.46 4208.11,-1723.55"/>
</g>
<!-- l2_exp0_gelu -->
<g id="node216" class="node">
<title>l2_exp0_gelu</title>
<polygon fill="none" stroke="black" points="4244,-1639.08 4158,-1639.08 4158,-1601.08 4244,-1601.08 4244,-1639.08"/>
<text text-anchor="middle" x="4201" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4201" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4201" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 32&#45;35</text>
</g>
<!-- l2_exp0_linear1&#45;&gt;l2_exp0_gelu -->
<g id="edge250" class="edge">
<title>l2_exp0_linear1&#45;&gt;l2_exp0_gelu</title>
<path fill="none" stroke="black" d="M4201,-1676.03C4201,-1667.96 4201,-1658.25 4201,-1649.26"/>
<polygon fill="black" stroke="black" points="4204.5,-1649.17 4201,-1639.17 4197.5,-1649.17 4204.5,-1649.17"/>
</g>
<!-- l2_exp0_linear2 -->
<g id="node217" class="node">
<title>l2_exp0_linear2</title>
<polygon fill="none" stroke="black" points="4283,-1564.08 4119,-1564.08 4119,-1526.08 4283,-1526.08 4283,-1564.08"/>
<text text-anchor="middle" x="4201" y="-1552.88" font-family="Arial" font-size="9.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="4201" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4201" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 32&#45;35</text>
</g>
<!-- l2_exp0_gelu&#45;&gt;l2_exp0_linear2 -->
<g id="edge251" class="edge">
<title>l2_exp0_gelu&#45;&gt;l2_exp0_linear2</title>
<path fill="none" stroke="black" d="M4201,-1601.03C4201,-1592.96 4201,-1583.25 4201,-1574.26"/>
<polygon fill="black" stroke="black" points="4204.5,-1574.17 4201,-1564.17 4197.5,-1574.17 4204.5,-1574.17"/>
</g>
<!-- l2_scatter_0 -->
<g id="node218" class="node">
<title>l2_scatter_0</title>
<ellipse fill="none" stroke="black" cx="4207" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4207" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4207" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4207" y="-1450.01" font-family="Arial" font-size="9.00">GPU 32 → All GPUs</text>
</g>
<!-- l2_exp0_linear2&#45;&gt;l2_scatter_0 -->
<g id="edge252" class="edge">
<title>l2_exp0_linear2&#45;&gt;l2_scatter_0</title>
<path fill="none" stroke="black" d="M4202.36,-1525.73C4202.94,-1517.87 4203.65,-1508.41 4204.33,-1499.26"/>
<polygon fill="black" stroke="black" points="4207.83,-1499.38 4205.08,-1489.15 4200.84,-1498.86 4207.83,-1499.38"/>
</g>
<!-- l2_expert_agg -->
<g id="node309" class="node">
<title>l2_expert_agg</title>
<polygon fill="none" stroke="black" points="5203.76,-1398.34 4995.75,-1398.34 4942.24,-1302.34 5150.25,-1302.34 5203.76,-1398.34"/>
<text text-anchor="middle" x="5073" y="-1363.14" font-family="Arial" font-size="9.00">Expert Aggregation</text>
<text text-anchor="middle" x="5073" y="-1353.14" font-family="Arial" font-size="9.00">Combine all expert outputs</text>
<text text-anchor="middle" x="5073" y="-1343.14" font-family="Arial" font-size="9.00">[1024, 8192]</text>
<text text-anchor="middle" x="5073" y="-1333.14" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l2_scatter_0&#45;&gt;l2_expert_agg -->
<g id="edge253" class="edge">
<title>l2_scatter_0&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M4251.48,-1441.41C4265.19,-1436.04 4280.5,-1430.77 4295,-1427.34 4527.05,-1372.42 4807.08,-1357.09 4959.9,-1352.87"/>
<polygon fill="black" stroke="black" points="4960.33,-1356.36 4970.23,-1352.6 4960.14,-1349.36 4960.33,-1356.36"/>
</g>
<!-- l2_exp1_linear1 -->
<g id="node221" class="node">
<title>l2_exp1_linear1</title>
<polygon fill="none" stroke="black" points="5906,-1714.08 5742,-1714.08 5742,-1676.08 5906,-1676.08 5906,-1714.08"/>
<text text-anchor="middle" x="5824" y="-1702.88" font-family="Arial" font-size="9.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="5824" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5824" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l2_gather_1&#45;&gt;l2_exp1_linear1 -->
<g id="edge256" class="edge">
<title>l2_gather_1&#45;&gt;l2_exp1_linear1</title>
<path fill="none" stroke="black" d="M5924.12,-1765.34C5904.2,-1751.56 5878.81,-1733.99 5858.59,-1720"/>
<polygon fill="black" stroke="black" points="5860.48,-1717.06 5850.27,-1714.25 5856.5,-1722.81 5860.48,-1717.06"/>
</g>
<!-- l2_exp1_gelu -->
<g id="node222" class="node">
<title>l2_exp1_gelu</title>
<polygon fill="none" stroke="black" points="5851,-1639.08 5765,-1639.08 5765,-1601.08 5851,-1601.08 5851,-1639.08"/>
<text text-anchor="middle" x="5808" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5808" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5808" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 36&#45;39</text>
</g>
<!-- l2_exp1_linear1&#45;&gt;l2_exp1_gelu -->
<g id="edge257" class="edge">
<title>l2_exp1_linear1&#45;&gt;l2_exp1_gelu</title>
<path fill="none" stroke="black" d="M5820.04,-1676.03C5818.26,-1667.87 5816.1,-1658.04 5814.11,-1648.97"/>
<polygon fill="black" stroke="black" points="5817.52,-1648.19 5811.97,-1639.17 5810.69,-1649.69 5817.52,-1648.19"/>
</g>
<!-- l2_exp1_linear2 -->
<g id="node223" class="node">
<title>l2_exp1_linear2</title>
<polygon fill="none" stroke="black" points="5815,-1564.08 5651,-1564.08 5651,-1526.08 5815,-1526.08 5815,-1564.08"/>
<text text-anchor="middle" x="5733" y="-1552.88" font-family="Arial" font-size="9.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="5733" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5733" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 36&#45;39</text>
</g>
<!-- l2_exp1_gelu&#45;&gt;l2_exp1_linear2 -->
<g id="edge258" class="edge">
<title>l2_exp1_gelu&#45;&gt;l2_exp1_linear2</title>
<path fill="none" stroke="black" d="M5789.46,-1601.03C5780.27,-1592.08 5769.01,-1581.13 5758.97,-1571.36"/>
<polygon fill="black" stroke="black" points="5761.19,-1568.64 5751.59,-1564.17 5756.31,-1573.65 5761.19,-1568.64"/>
</g>
<!-- l2_scatter_1 -->
<g id="node224" class="node">
<title>l2_scatter_1</title>
<ellipse fill="none" stroke="black" cx="5712" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5712" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5712" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5712" y="-1450.01" font-family="Arial" font-size="9.00">GPU 36 → All GPUs</text>
</g>
<!-- l2_exp1_linear2&#45;&gt;l2_scatter_1 -->
<g id="edge259" class="edge">
<title>l2_exp1_linear2&#45;&gt;l2_scatter_1</title>
<path fill="none" stroke="black" d="M5728.23,-1525.73C5726.17,-1517.79 5723.69,-1508.21 5721.28,-1498.96"/>
<polygon fill="black" stroke="black" points="5724.64,-1497.95 5718.74,-1489.15 5717.86,-1499.71 5724.64,-1497.95"/>
</g>
<!-- l2_scatter_1&#45;&gt;l2_expert_agg -->
<g id="edge260" class="edge">
<title>l2_scatter_1&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M5662.73,-1443.04C5645.88,-1437.36 5626.78,-1431.49 5609,-1427.34 5467.99,-1394.43 5302.57,-1373.6 5193.2,-1362.24"/>
<polygon fill="black" stroke="black" points="5193.43,-1358.74 5183.12,-1361.2 5192.71,-1365.71 5193.43,-1358.74"/>
</g>
<!-- l2_exp2_linear1 -->
<g id="node227" class="node">
<title>l2_exp2_linear1</title>
<polygon fill="none" stroke="black" points="3853,-1714.08 3689,-1714.08 3689,-1676.08 3853,-1676.08 3853,-1714.08"/>
<text text-anchor="middle" x="3771" y="-1702.88" font-family="Arial" font-size="9.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="3771" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3771" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l2_gather_2&#45;&gt;l2_exp2_linear1 -->
<g id="edge263" class="edge">
<title>l2_gather_2&#45;&gt;l2_exp2_linear1</title>
<path fill="none" stroke="black" d="M3779.59,-1761.96C3778.05,-1750.13 3776.22,-1736.12 3774.65,-1724.07"/>
<polygon fill="black" stroke="black" points="3778.11,-1723.55 3773.35,-1714.09 3771.17,-1724.46 3778.11,-1723.55"/>
</g>
<!-- l2_exp2_gelu -->
<g id="node228" class="node">
<title>l2_exp2_gelu</title>
<polygon fill="none" stroke="black" points="3814,-1639.08 3728,-1639.08 3728,-1601.08 3814,-1601.08 3814,-1639.08"/>
<text text-anchor="middle" x="3771" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3771" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3771" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 40&#45;43</text>
</g>
<!-- l2_exp2_linear1&#45;&gt;l2_exp2_gelu -->
<g id="edge264" class="edge">
<title>l2_exp2_linear1&#45;&gt;l2_exp2_gelu</title>
<path fill="none" stroke="black" d="M3771,-1676.03C3771,-1667.96 3771,-1658.25 3771,-1649.26"/>
<polygon fill="black" stroke="black" points="3774.5,-1649.17 3771,-1639.17 3767.5,-1649.17 3774.5,-1649.17"/>
</g>
<!-- l2_exp2_linear2 -->
<g id="node229" class="node">
<title>l2_exp2_linear2</title>
<polygon fill="none" stroke="black" points="3853,-1564.08 3689,-1564.08 3689,-1526.08 3853,-1526.08 3853,-1564.08"/>
<text text-anchor="middle" x="3771" y="-1552.88" font-family="Arial" font-size="9.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="3771" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3771" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 40&#45;43</text>
</g>
<!-- l2_exp2_gelu&#45;&gt;l2_exp2_linear2 -->
<g id="edge265" class="edge">
<title>l2_exp2_gelu&#45;&gt;l2_exp2_linear2</title>
<path fill="none" stroke="black" d="M3771,-1601.03C3771,-1592.96 3771,-1583.25 3771,-1574.26"/>
<polygon fill="black" stroke="black" points="3774.5,-1574.17 3771,-1564.17 3767.5,-1574.17 3774.5,-1574.17"/>
</g>
<!-- l2_scatter_2 -->
<g id="node230" class="node">
<title>l2_scatter_2</title>
<ellipse fill="none" stroke="black" cx="3780" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3780" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3780" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3780" y="-1450.01" font-family="Arial" font-size="9.00">GPU 40 → All GPUs</text>
</g>
<!-- l2_exp2_linear2&#45;&gt;l2_scatter_2 -->
<g id="edge266" class="edge">
<title>l2_exp2_linear2&#45;&gt;l2_scatter_2</title>
<path fill="none" stroke="black" d="M3773.04,-1525.73C3773.92,-1517.87 3774.97,-1508.41 3775.99,-1499.26"/>
<polygon fill="black" stroke="black" points="3779.49,-1499.48 3777.11,-1489.15 3772.53,-1498.7 3779.49,-1499.48"/>
</g>
<!-- l2_scatter_2&#45;&gt;l2_expert_agg -->
<g id="edge267" class="edge">
<title>l2_scatter_2&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M3823.27,-1440.91C3836.4,-1435.59 3851.05,-1430.47 3865,-1427.34 3878.32,-1424.35 4666.78,-1376.09 4962.54,-1358.06"/>
<polygon fill="black" stroke="black" points="4963.08,-1361.53 4972.85,-1357.43 4962.66,-1354.55 4963.08,-1361.53"/>
</g>
<!-- l2_exp3_linear1 -->
<g id="node233" class="node">
<title>l2_exp3_linear1</title>
<polygon fill="none" stroke="black" points="1691,-1714.08 1527,-1714.08 1527,-1676.08 1691,-1676.08 1691,-1714.08"/>
<text text-anchor="middle" x="1609" y="-1702.88" font-family="Arial" font-size="9.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1609" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1609" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l2_gather_3&#45;&gt;l2_exp3_linear1 -->
<g id="edge270" class="edge">
<title>l2_gather_3&#45;&gt;l2_exp3_linear1</title>
<path fill="none" stroke="black" d="M1617.59,-1761.96C1616.05,-1750.13 1614.22,-1736.12 1612.65,-1724.07"/>
<polygon fill="black" stroke="black" points="1616.11,-1723.55 1611.35,-1714.09 1609.17,-1724.46 1616.11,-1723.55"/>
</g>
<!-- l2_exp3_gelu -->
<g id="node234" class="node">
<title>l2_exp3_gelu</title>
<polygon fill="none" stroke="black" points="1652,-1639.08 1566,-1639.08 1566,-1601.08 1652,-1601.08 1652,-1639.08"/>
<text text-anchor="middle" x="1609" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1609" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1609" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 44&#45;47</text>
</g>
<!-- l2_exp3_linear1&#45;&gt;l2_exp3_gelu -->
<g id="edge271" class="edge">
<title>l2_exp3_linear1&#45;&gt;l2_exp3_gelu</title>
<path fill="none" stroke="black" d="M1609,-1676.03C1609,-1667.96 1609,-1658.25 1609,-1649.26"/>
<polygon fill="black" stroke="black" points="1612.5,-1649.17 1609,-1639.17 1605.5,-1649.17 1612.5,-1649.17"/>
</g>
<!-- l2_exp3_linear2 -->
<g id="node235" class="node">
<title>l2_exp3_linear2</title>
<polygon fill="none" stroke="black" points="1691,-1564.08 1527,-1564.08 1527,-1526.08 1691,-1526.08 1691,-1564.08"/>
<text text-anchor="middle" x="1609" y="-1552.88" font-family="Arial" font-size="9.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1609" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1609" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 44&#45;47</text>
</g>
<!-- l2_exp3_gelu&#45;&gt;l2_exp3_linear2 -->
<g id="edge272" class="edge">
<title>l2_exp3_gelu&#45;&gt;l2_exp3_linear2</title>
<path fill="none" stroke="black" d="M1609,-1601.03C1609,-1592.96 1609,-1583.25 1609,-1574.26"/>
<polygon fill="black" stroke="black" points="1612.5,-1574.17 1609,-1564.17 1605.5,-1574.17 1612.5,-1574.17"/>
</g>
<!-- l2_scatter_3 -->
<g id="node236" class="node">
<title>l2_scatter_3</title>
<ellipse fill="none" stroke="black" cx="1615" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1615" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1615" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1615" y="-1450.01" font-family="Arial" font-size="9.00">GPU 44 → All GPUs</text>
</g>
<!-- l2_exp3_linear2&#45;&gt;l2_scatter_3 -->
<g id="edge273" class="edge">
<title>l2_exp3_linear2&#45;&gt;l2_scatter_3</title>
<path fill="none" stroke="black" d="M1610.36,-1525.73C1610.94,-1517.87 1611.65,-1508.41 1612.33,-1499.26"/>
<polygon fill="black" stroke="black" points="1615.83,-1499.38 1613.08,-1489.15 1608.84,-1498.86 1615.83,-1499.38"/>
</g>
<!-- l2_scatter_3&#45;&gt;l2_expert_agg -->
<g id="edge274" class="edge">
<title>l2_scatter_3&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M1658.43,-1441.09C1672.37,-1435.56 1688.06,-1430.29 1703,-1427.34 2027.55,-1363.24 4407.95,-1353.08 4959.24,-1351.58"/>
<polygon fill="black" stroke="black" points="4959.59,-1355.08 4969.58,-1351.56 4959.57,-1348.08 4959.59,-1355.08"/>
</g>
<!-- l2_exp4_linear1 -->
<g id="node239" class="node">
<title>l2_exp4_linear1</title>
<polygon fill="none" stroke="black" points="5155,-1714.08 4991,-1714.08 4991,-1676.08 5155,-1676.08 5155,-1714.08"/>
<text text-anchor="middle" x="5073" y="-1702.88" font-family="Arial" font-size="9.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="5073" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5073" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l2_gather_4&#45;&gt;l2_exp4_linear1 -->
<g id="edge277" class="edge">
<title>l2_gather_4&#45;&gt;l2_exp4_linear1</title>
<path fill="none" stroke="black" d="M5081.59,-1761.96C5080.05,-1750.13 5078.22,-1736.12 5076.65,-1724.07"/>
<polygon fill="black" stroke="black" points="5080.11,-1723.55 5075.35,-1714.09 5073.17,-1724.46 5080.11,-1723.55"/>
</g>
<!-- l2_exp4_gelu -->
<g id="node240" class="node">
<title>l2_exp4_gelu</title>
<polygon fill="none" stroke="black" points="5116,-1639.08 5030,-1639.08 5030,-1601.08 5116,-1601.08 5116,-1639.08"/>
<text text-anchor="middle" x="5073" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5073" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5073" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 48&#45;51</text>
</g>
<!-- l2_exp4_linear1&#45;&gt;l2_exp4_gelu -->
<g id="edge278" class="edge">
<title>l2_exp4_linear1&#45;&gt;l2_exp4_gelu</title>
<path fill="none" stroke="black" d="M5073,-1676.03C5073,-1667.96 5073,-1658.25 5073,-1649.26"/>
<polygon fill="black" stroke="black" points="5076.5,-1649.17 5073,-1639.17 5069.5,-1649.17 5076.5,-1649.17"/>
</g>
<!-- l2_exp4_linear2 -->
<g id="node241" class="node">
<title>l2_exp4_linear2</title>
<polygon fill="none" stroke="black" points="5155,-1564.08 4991,-1564.08 4991,-1526.08 5155,-1526.08 5155,-1564.08"/>
<text text-anchor="middle" x="5073" y="-1552.88" font-family="Arial" font-size="9.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="5073" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5073" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l2_exp4_gelu&#45;&gt;l2_exp4_linear2 -->
<g id="edge279" class="edge">
<title>l2_exp4_gelu&#45;&gt;l2_exp4_linear2</title>
<path fill="none" stroke="black" d="M5073,-1601.03C5073,-1592.96 5073,-1583.25 5073,-1574.26"/>
<polygon fill="black" stroke="black" points="5076.5,-1574.17 5073,-1564.17 5069.5,-1574.17 5076.5,-1574.17"/>
</g>
<!-- l2_scatter_4 -->
<g id="node242" class="node">
<title>l2_scatter_4</title>
<ellipse fill="none" stroke="black" cx="5073" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5073" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5073" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5073" y="-1450.01" font-family="Arial" font-size="9.00">GPU 48 → All GPUs</text>
</g>
<!-- l2_exp4_linear2&#45;&gt;l2_scatter_4 -->
<g id="edge280" class="edge">
<title>l2_exp4_linear2&#45;&gt;l2_scatter_4</title>
<path fill="none" stroke="black" d="M5073,-1525.73C5073,-1517.87 5073,-1508.41 5073,-1499.26"/>
<polygon fill="black" stroke="black" points="5076.5,-1499.15 5073,-1489.15 5069.5,-1499.15 5076.5,-1499.15"/>
</g>
<!-- l2_scatter_4&#45;&gt;l2_expert_agg -->
<g id="edge281" class="edge">
<title>l2_scatter_4&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M5073,-1435.17C5073,-1427.16 5073,-1417.99 5073,-1408.74"/>
<polygon fill="black" stroke="black" points="5076.5,-1408.71 5073,-1398.71 5069.5,-1408.71 5076.5,-1408.71"/>
</g>
<!-- l2_exp5_linear1 -->
<g id="node245" class="node">
<title>l2_exp5_linear1</title>
<polygon fill="none" stroke="black" points="2981,-1714.08 2817,-1714.08 2817,-1676.08 2981,-1676.08 2981,-1714.08"/>
<text text-anchor="middle" x="2899" y="-1702.88" font-family="Arial" font-size="9.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="2899" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2899" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l2_gather_5&#45;&gt;l2_exp5_linear1 -->
<g id="edge284" class="edge">
<title>l2_gather_5&#45;&gt;l2_exp5_linear1</title>
<path fill="none" stroke="black" d="M2907.59,-1761.96C2906.05,-1750.13 2904.22,-1736.12 2902.65,-1724.07"/>
<polygon fill="black" stroke="black" points="2906.11,-1723.55 2901.35,-1714.09 2899.17,-1724.46 2906.11,-1723.55"/>
</g>
<!-- l2_exp5_gelu -->
<g id="node246" class="node">
<title>l2_exp5_gelu</title>
<polygon fill="none" stroke="black" points="2942,-1639.08 2856,-1639.08 2856,-1601.08 2942,-1601.08 2942,-1639.08"/>
<text text-anchor="middle" x="2899" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2899" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2899" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 52&#45;55</text>
</g>
<!-- l2_exp5_linear1&#45;&gt;l2_exp5_gelu -->
<g id="edge285" class="edge">
<title>l2_exp5_linear1&#45;&gt;l2_exp5_gelu</title>
<path fill="none" stroke="black" d="M2899,-1676.03C2899,-1667.96 2899,-1658.25 2899,-1649.26"/>
<polygon fill="black" stroke="black" points="2902.5,-1649.17 2899,-1639.17 2895.5,-1649.17 2902.5,-1649.17"/>
</g>
<!-- l2_exp5_linear2 -->
<g id="node247" class="node">
<title>l2_exp5_linear2</title>
<polygon fill="none" stroke="black" points="2981,-1564.08 2817,-1564.08 2817,-1526.08 2981,-1526.08 2981,-1564.08"/>
<text text-anchor="middle" x="2899" y="-1552.88" font-family="Arial" font-size="9.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2899" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2899" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l2_exp5_gelu&#45;&gt;l2_exp5_linear2 -->
<g id="edge286" class="edge">
<title>l2_exp5_gelu&#45;&gt;l2_exp5_linear2</title>
<path fill="none" stroke="black" d="M2899,-1601.03C2899,-1592.96 2899,-1583.25 2899,-1574.26"/>
<polygon fill="black" stroke="black" points="2902.5,-1574.17 2899,-1564.17 2895.5,-1574.17 2902.5,-1574.17"/>
</g>
<!-- l2_scatter_5 -->
<g id="node248" class="node">
<title>l2_scatter_5</title>
<ellipse fill="none" stroke="black" cx="2905" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2905" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2905" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2905" y="-1450.01" font-family="Arial" font-size="9.00">GPU 52 → All GPUs</text>
</g>
<!-- l2_exp5_linear2&#45;&gt;l2_scatter_5 -->
<g id="edge287" class="edge">
<title>l2_exp5_linear2&#45;&gt;l2_scatter_5</title>
<path fill="none" stroke="black" d="M2900.36,-1525.73C2900.94,-1517.87 2901.65,-1508.41 2902.33,-1499.26"/>
<polygon fill="black" stroke="black" points="2905.83,-1499.38 2903.08,-1489.15 2898.84,-1498.86 2905.83,-1499.38"/>
</g>
<!-- l2_scatter_5&#45;&gt;l2_expert_agg -->
<g id="edge288" class="edge">
<title>l2_scatter_5&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M2948.91,-1441.04C2962.73,-1435.58 2978.25,-1430.36 2993,-1427.34 3185.66,-1387.89 4554.66,-1360.58 4960.12,-1353.28"/>
<polygon fill="black" stroke="black" points="4960.45,-1356.78 4970.39,-1353.1 4960.33,-1349.78 4960.45,-1356.78"/>
</g>
<!-- l2_exp6_linear1 -->
<g id="node251" class="node">
<title>l2_exp6_linear1</title>
<polygon fill="none" stroke="black" points="6336,-1714.08 6172,-1714.08 6172,-1676.08 6336,-1676.08 6336,-1714.08"/>
<text text-anchor="middle" x="6254" y="-1702.88" font-family="Arial" font-size="9.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="6254" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6254" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l2_gather_6&#45;&gt;l2_exp6_linear1 -->
<g id="edge291" class="edge">
<title>l2_gather_6&#45;&gt;l2_exp6_linear1</title>
<path fill="none" stroke="black" d="M6354.12,-1765.34C6334.2,-1751.56 6308.81,-1733.99 6288.59,-1720"/>
<polygon fill="black" stroke="black" points="6290.48,-1717.06 6280.27,-1714.25 6286.5,-1722.81 6290.48,-1717.06"/>
</g>
<!-- l2_exp6_gelu -->
<g id="node252" class="node">
<title>l2_exp6_gelu</title>
<polygon fill="none" stroke="black" points="6281,-1639.08 6195,-1639.08 6195,-1601.08 6281,-1601.08 6281,-1639.08"/>
<text text-anchor="middle" x="6238" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6238" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6238" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 56&#45;59</text>
</g>
<!-- l2_exp6_linear1&#45;&gt;l2_exp6_gelu -->
<g id="edge292" class="edge">
<title>l2_exp6_linear1&#45;&gt;l2_exp6_gelu</title>
<path fill="none" stroke="black" d="M6250.04,-1676.03C6248.26,-1667.87 6246.1,-1658.04 6244.11,-1648.97"/>
<polygon fill="black" stroke="black" points="6247.52,-1648.19 6241.97,-1639.17 6240.69,-1649.69 6247.52,-1648.19"/>
</g>
<!-- l2_exp6_linear2 -->
<g id="node253" class="node">
<title>l2_exp6_linear2</title>
<polygon fill="none" stroke="black" points="6245,-1564.08 6081,-1564.08 6081,-1526.08 6245,-1526.08 6245,-1564.08"/>
<text text-anchor="middle" x="6163" y="-1552.88" font-family="Arial" font-size="9.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="6163" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6163" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l2_exp6_gelu&#45;&gt;l2_exp6_linear2 -->
<g id="edge293" class="edge">
<title>l2_exp6_gelu&#45;&gt;l2_exp6_linear2</title>
<path fill="none" stroke="black" d="M6219.46,-1601.03C6210.27,-1592.08 6199.01,-1581.13 6188.97,-1571.36"/>
<polygon fill="black" stroke="black" points="6191.19,-1568.64 6181.59,-1564.17 6186.31,-1573.65 6191.19,-1568.64"/>
</g>
<!-- l2_scatter_6 -->
<g id="node254" class="node">
<title>l2_scatter_6</title>
<ellipse fill="none" stroke="black" cx="6142" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6142" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6142" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6142" y="-1450.01" font-family="Arial" font-size="9.00">GPU 56 → All GPUs</text>
</g>
<!-- l2_exp6_linear2&#45;&gt;l2_scatter_6 -->
<g id="edge294" class="edge">
<title>l2_exp6_linear2&#45;&gt;l2_scatter_6</title>
<path fill="none" stroke="black" d="M6158.23,-1525.73C6156.17,-1517.79 6153.69,-1508.21 6151.28,-1498.96"/>
<polygon fill="black" stroke="black" points="6154.64,-1497.95 6148.74,-1489.15 6147.86,-1499.71 6154.64,-1497.95"/>
</g>
<!-- l2_scatter_6&#45;&gt;l2_expert_agg -->
<g id="edge295" class="edge">
<title>l2_scatter_6&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M6093.65,-1442.67C6076.62,-1436.84 6057.18,-1430.99 6039,-1427.34 5735.89,-1366.49 5370.15,-1353.84 5187.9,-1351.54"/>
<polygon fill="black" stroke="black" points="5187.81,-1348.04 5177.77,-1351.42 5187.72,-1355.04 5187.81,-1348.04"/>
</g>
<!-- l2_exp7_linear1 -->
<g id="node257" class="node">
<title>l2_exp7_linear1</title>
<polygon fill="none" stroke="black" points="2121,-1714.08 1957,-1714.08 1957,-1676.08 2121,-1676.08 2121,-1714.08"/>
<text text-anchor="middle" x="2039" y="-1702.88" font-family="Arial" font-size="9.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2039" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2039" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l2_gather_7&#45;&gt;l2_exp7_linear1 -->
<g id="edge298" class="edge">
<title>l2_gather_7&#45;&gt;l2_exp7_linear1</title>
<path fill="none" stroke="black" d="M2047.59,-1761.96C2046.05,-1750.13 2044.22,-1736.12 2042.65,-1724.07"/>
<polygon fill="black" stroke="black" points="2046.11,-1723.55 2041.35,-1714.09 2039.17,-1724.46 2046.11,-1723.55"/>
</g>
<!-- l2_exp7_gelu -->
<g id="node258" class="node">
<title>l2_exp7_gelu</title>
<polygon fill="none" stroke="black" points="2082,-1639.08 1996,-1639.08 1996,-1601.08 2082,-1601.08 2082,-1639.08"/>
<text text-anchor="middle" x="2039" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2039" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2039" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 60&#45;63</text>
</g>
<!-- l2_exp7_linear1&#45;&gt;l2_exp7_gelu -->
<g id="edge299" class="edge">
<title>l2_exp7_linear1&#45;&gt;l2_exp7_gelu</title>
<path fill="none" stroke="black" d="M2039,-1676.03C2039,-1667.96 2039,-1658.25 2039,-1649.26"/>
<polygon fill="black" stroke="black" points="2042.5,-1649.17 2039,-1639.17 2035.5,-1649.17 2042.5,-1649.17"/>
</g>
<!-- l2_exp7_linear2 -->
<g id="node259" class="node">
<title>l2_exp7_linear2</title>
<polygon fill="none" stroke="black" points="2121,-1564.08 1957,-1564.08 1957,-1526.08 2121,-1526.08 2121,-1564.08"/>
<text text-anchor="middle" x="2039" y="-1552.88" font-family="Arial" font-size="9.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2039" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2039" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l2_exp7_gelu&#45;&gt;l2_exp7_linear2 -->
<g id="edge300" class="edge">
<title>l2_exp7_gelu&#45;&gt;l2_exp7_linear2</title>
<path fill="none" stroke="black" d="M2039,-1601.03C2039,-1592.96 2039,-1583.25 2039,-1574.26"/>
<polygon fill="black" stroke="black" points="2042.5,-1574.17 2039,-1564.17 2035.5,-1574.17 2042.5,-1574.17"/>
</g>
<!-- l2_scatter_7 -->
<g id="node260" class="node">
<title>l2_scatter_7</title>
<ellipse fill="none" stroke="black" cx="2048" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2048" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2048" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2048" y="-1450.01" font-family="Arial" font-size="9.00">GPU 60 → All GPUs</text>
</g>
<!-- l2_exp7_linear2&#45;&gt;l2_scatter_7 -->
<g id="edge301" class="edge">
<title>l2_exp7_linear2&#45;&gt;l2_scatter_7</title>
<path fill="none" stroke="black" d="M2041.04,-1525.73C2041.92,-1517.87 2042.97,-1508.41 2043.99,-1499.26"/>
<polygon fill="black" stroke="black" points="2047.49,-1499.48 2045.11,-1489.15 2040.53,-1498.7 2047.49,-1499.48"/>
</g>
<!-- l2_scatter_7&#45;&gt;l2_expert_agg -->
<g id="edge302" class="edge">
<title>l2_scatter_7&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M2090.77,-1440.76C2104.01,-1435.37 2118.84,-1430.25 2133,-1427.34 2413.03,-1369.84 4453.2,-1354.78 4959.52,-1351.91"/>
<polygon fill="black" stroke="black" points="4959.78,-1355.41 4969.76,-1351.85 4959.74,-1348.41 4959.78,-1355.41"/>
</g>
<!-- l2_exp8_linear1 -->
<g id="node263" class="node">
<title>l2_exp8_linear1</title>
<polygon fill="none" stroke="black" points="7321,-1714.08 7157,-1714.08 7157,-1676.08 7321,-1676.08 7321,-1714.08"/>
<text text-anchor="middle" x="7239" y="-1702.88" font-family="Arial" font-size="9.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="7239" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7239" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l2_gather_8&#45;&gt;l2_exp8_linear1 -->
<g id="edge305" class="edge">
<title>l2_gather_8&#45;&gt;l2_exp8_linear1</title>
<path fill="none" stroke="black" d="M7253.32,-1761.96C7250.75,-1750.13 7247.7,-1736.12 7245.09,-1724.07"/>
<polygon fill="black" stroke="black" points="7248.46,-1723.12 7242.92,-1714.09 7241.62,-1724.61 7248.46,-1723.12"/>
</g>
<!-- l2_exp8_gelu -->
<g id="node264" class="node">
<title>l2_exp8_gelu</title>
<polygon fill="none" stroke="black" points="7153,-1639.08 7067,-1639.08 7067,-1601.08 7153,-1601.08 7153,-1639.08"/>
<text text-anchor="middle" x="7110" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7110" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7110" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 64&#45;67</text>
</g>
<!-- l2_exp8_linear1&#45;&gt;l2_exp8_gelu -->
<g id="edge306" class="edge">
<title>l2_exp8_linear1&#45;&gt;l2_exp8_gelu</title>
<path fill="none" stroke="black" d="M7207.11,-1676.03C7190.21,-1666.47 7169.26,-1654.61 7151.14,-1644.36"/>
<polygon fill="black" stroke="black" points="7152.39,-1641.05 7141.97,-1639.17 7148.95,-1647.14 7152.39,-1641.05"/>
</g>
<!-- l2_exp8_linear2 -->
<g id="node265" class="node">
<title>l2_exp8_linear2</title>
<polygon fill="none" stroke="black" points="7117,-1564.08 6953,-1564.08 6953,-1526.08 7117,-1526.08 7117,-1564.08"/>
<text text-anchor="middle" x="7035" y="-1552.88" font-family="Arial" font-size="9.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="7035" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7035" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l2_exp8_gelu&#45;&gt;l2_exp8_linear2 -->
<g id="edge307" class="edge">
<title>l2_exp8_gelu&#45;&gt;l2_exp8_linear2</title>
<path fill="none" stroke="black" d="M7091.46,-1601.03C7082.27,-1592.08 7071.01,-1581.13 7060.97,-1571.36"/>
<polygon fill="black" stroke="black" points="7063.19,-1568.64 7053.59,-1564.17 7058.31,-1573.65 7063.19,-1568.64"/>
</g>
<!-- l2_scatter_8 -->
<g id="node266" class="node">
<title>l2_scatter_8</title>
<ellipse fill="none" stroke="black" cx="7014" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7014" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7014" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7014" y="-1450.01" font-family="Arial" font-size="9.00">GPU 64 → All GPUs</text>
</g>
<!-- l2_exp8_linear2&#45;&gt;l2_scatter_8 -->
<g id="edge308" class="edge">
<title>l2_exp8_linear2&#45;&gt;l2_scatter_8</title>
<path fill="none" stroke="black" d="M7030.23,-1525.73C7028.17,-1517.79 7025.69,-1508.21 7023.28,-1498.96"/>
<polygon fill="black" stroke="black" points="7026.64,-1497.95 7020.74,-1489.15 7019.86,-1499.71 7026.64,-1497.95"/>
</g>
<!-- l2_scatter_8&#45;&gt;l2_expert_agg -->
<g id="edge309" class="edge">
<title>l2_scatter_8&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M6966.25,-1442.46C6949.09,-1436.54 6929.43,-1430.68 6911,-1427.34 6578.05,-1366.92 5536.9,-1354.45 5188.15,-1351.95"/>
<polygon fill="black" stroke="black" points="5188.06,-1348.45 5178.03,-1351.88 5188.01,-1355.45 5188.06,-1348.45"/>
</g>
<!-- l2_exp9_linear1 -->
<g id="node269" class="node">
<title>l2_exp9_linear1</title>
<polygon fill="none" stroke="black" points="2551,-1714.08 2387,-1714.08 2387,-1676.08 2551,-1676.08 2551,-1714.08"/>
<text text-anchor="middle" x="2469" y="-1702.88" font-family="Arial" font-size="9.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2469" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2469" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l2_gather_9&#45;&gt;l2_exp9_linear1 -->
<g id="edge312" class="edge">
<title>l2_gather_9&#45;&gt;l2_exp9_linear1</title>
<path fill="none" stroke="black" d="M2477.59,-1761.96C2476.05,-1750.13 2474.22,-1736.12 2472.65,-1724.07"/>
<polygon fill="black" stroke="black" points="2476.11,-1723.55 2471.35,-1714.09 2469.17,-1724.46 2476.11,-1723.55"/>
</g>
<!-- l2_exp9_gelu -->
<g id="node270" class="node">
<title>l2_exp9_gelu</title>
<polygon fill="none" stroke="black" points="2512,-1639.08 2426,-1639.08 2426,-1601.08 2512,-1601.08 2512,-1639.08"/>
<text text-anchor="middle" x="2469" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2469" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2469" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 68&#45;71</text>
</g>
<!-- l2_exp9_linear1&#45;&gt;l2_exp9_gelu -->
<g id="edge313" class="edge">
<title>l2_exp9_linear1&#45;&gt;l2_exp9_gelu</title>
<path fill="none" stroke="black" d="M2469,-1676.03C2469,-1667.96 2469,-1658.25 2469,-1649.26"/>
<polygon fill="black" stroke="black" points="2472.5,-1649.17 2469,-1639.17 2465.5,-1649.17 2472.5,-1649.17"/>
</g>
<!-- l2_exp9_linear2 -->
<g id="node271" class="node">
<title>l2_exp9_linear2</title>
<polygon fill="none" stroke="black" points="2551,-1564.08 2387,-1564.08 2387,-1526.08 2551,-1526.08 2551,-1564.08"/>
<text text-anchor="middle" x="2469" y="-1552.88" font-family="Arial" font-size="9.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2469" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2469" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l2_exp9_gelu&#45;&gt;l2_exp9_linear2 -->
<g id="edge314" class="edge">
<title>l2_exp9_gelu&#45;&gt;l2_exp9_linear2</title>
<path fill="none" stroke="black" d="M2469,-1601.03C2469,-1592.96 2469,-1583.25 2469,-1574.26"/>
<polygon fill="black" stroke="black" points="2472.5,-1574.17 2469,-1564.17 2465.5,-1574.17 2472.5,-1574.17"/>
</g>
<!-- l2_scatter_9 -->
<g id="node272" class="node">
<title>l2_scatter_9</title>
<ellipse fill="none" stroke="black" cx="2478" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2478" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2478" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2478" y="-1450.01" font-family="Arial" font-size="9.00">GPU 68 → All GPUs</text>
</g>
<!-- l2_exp9_linear2&#45;&gt;l2_scatter_9 -->
<g id="edge315" class="edge">
<title>l2_exp9_linear2&#45;&gt;l2_scatter_9</title>
<path fill="none" stroke="black" d="M2471.04,-1525.73C2471.92,-1517.87 2472.97,-1508.41 2473.99,-1499.26"/>
<polygon fill="black" stroke="black" points="2477.49,-1499.48 2475.11,-1489.15 2470.53,-1498.7 2477.49,-1499.48"/>
</g>
<!-- l2_scatter_9&#45;&gt;l2_expert_agg -->
<g id="edge316" class="edge">
<title>l2_scatter_9&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M2520.78,-1440.8C2534.01,-1435.41 2548.85,-1430.28 2563,-1427.34 2799.04,-1378.33 4500.97,-1357.27 4959.48,-1352.45"/>
<polygon fill="black" stroke="black" points="4959.78,-1355.95 4969.75,-1352.35 4959.71,-1348.95 4959.78,-1355.95"/>
</g>
<!-- l2_exp10_linear1 -->
<g id="node275" class="node">
<title>l2_exp10_linear1</title>
<polygon fill="none" stroke="black" points="3423,-1714.08 3259,-1714.08 3259,-1676.08 3423,-1676.08 3423,-1714.08"/>
<text text-anchor="middle" x="3341" y="-1702.88" font-family="Arial" font-size="9.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3341" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3341" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l2_gather_10&#45;&gt;l2_exp10_linear1 -->
<g id="edge319" class="edge">
<title>l2_gather_10&#45;&gt;l2_exp10_linear1</title>
<path fill="none" stroke="black" d="M3349.59,-1761.96C3348.05,-1750.13 3346.22,-1736.12 3344.65,-1724.07"/>
<polygon fill="black" stroke="black" points="3348.11,-1723.55 3343.35,-1714.09 3341.17,-1724.46 3348.11,-1723.55"/>
</g>
<!-- l2_exp10_gelu -->
<g id="node276" class="node">
<title>l2_exp10_gelu</title>
<polygon fill="none" stroke="black" points="3384,-1639.08 3298,-1639.08 3298,-1601.08 3384,-1601.08 3384,-1639.08"/>
<text text-anchor="middle" x="3341" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3341" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3341" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 72&#45;75</text>
</g>
<!-- l2_exp10_linear1&#45;&gt;l2_exp10_gelu -->
<g id="edge320" class="edge">
<title>l2_exp10_linear1&#45;&gt;l2_exp10_gelu</title>
<path fill="none" stroke="black" d="M3341,-1676.03C3341,-1667.96 3341,-1658.25 3341,-1649.26"/>
<polygon fill="black" stroke="black" points="3344.5,-1649.17 3341,-1639.17 3337.5,-1649.17 3344.5,-1649.17"/>
</g>
<!-- l2_exp10_linear2 -->
<g id="node277" class="node">
<title>l2_exp10_linear2</title>
<polygon fill="none" stroke="black" points="3423,-1564.08 3259,-1564.08 3259,-1526.08 3423,-1526.08 3423,-1564.08"/>
<text text-anchor="middle" x="3341" y="-1552.88" font-family="Arial" font-size="9.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3341" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3341" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l2_exp10_gelu&#45;&gt;l2_exp10_linear2 -->
<g id="edge321" class="edge">
<title>l2_exp10_gelu&#45;&gt;l2_exp10_linear2</title>
<path fill="none" stroke="black" d="M3341,-1601.03C3341,-1592.96 3341,-1583.25 3341,-1574.26"/>
<polygon fill="black" stroke="black" points="3344.5,-1574.17 3341,-1564.17 3337.5,-1574.17 3344.5,-1574.17"/>
</g>
<!-- l2_scatter_10 -->
<g id="node278" class="node">
<title>l2_scatter_10</title>
<ellipse fill="none" stroke="black" cx="3347" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3347" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3347" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3347" y="-1450.01" font-family="Arial" font-size="9.00">GPU 72 → All GPUs</text>
</g>
<!-- l2_exp10_linear2&#45;&gt;l2_scatter_10 -->
<g id="edge322" class="edge">
<title>l2_exp10_linear2&#45;&gt;l2_scatter_10</title>
<path fill="none" stroke="black" d="M3342.36,-1525.73C3342.94,-1517.87 3343.65,-1508.41 3344.33,-1499.26"/>
<polygon fill="black" stroke="black" points="3347.83,-1499.38 3345.08,-1489.15 3340.84,-1498.86 3347.83,-1499.38"/>
</g>
<!-- l2_scatter_10&#45;&gt;l2_expert_agg -->
<g id="edge323" class="edge">
<title>l2_scatter_10&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M3390.93,-1441.13C3404.75,-1435.68 3420.26,-1430.43 3435,-1427.34 3726.9,-1366.07 4638.33,-1354.18 4959.56,-1351.89"/>
<polygon fill="black" stroke="black" points="4959.84,-1355.38 4969.82,-1351.81 4959.79,-1348.38 4959.84,-1355.38"/>
</g>
<!-- l2_exp11_linear1 -->
<g id="node281" class="node">
<title>l2_exp11_linear1</title>
<polygon fill="none" stroke="black" points="4725,-1714.08 4561,-1714.08 4561,-1676.08 4725,-1676.08 4725,-1714.08"/>
<text text-anchor="middle" x="4643" y="-1702.88" font-family="Arial" font-size="9.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="4643" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4643" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l2_gather_11&#45;&gt;l2_exp11_linear1 -->
<g id="edge326" class="edge">
<title>l2_gather_11&#45;&gt;l2_exp11_linear1</title>
<path fill="none" stroke="black" d="M4651.59,-1761.96C4650.05,-1750.13 4648.22,-1736.12 4646.65,-1724.07"/>
<polygon fill="black" stroke="black" points="4650.11,-1723.55 4645.35,-1714.09 4643.17,-1724.46 4650.11,-1723.55"/>
</g>
<!-- l2_exp11_gelu -->
<g id="node282" class="node">
<title>l2_exp11_gelu</title>
<polygon fill="none" stroke="black" points="4686,-1639.08 4600,-1639.08 4600,-1601.08 4686,-1601.08 4686,-1639.08"/>
<text text-anchor="middle" x="4643" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4643" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4643" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 76&#45;79</text>
</g>
<!-- l2_exp11_linear1&#45;&gt;l2_exp11_gelu -->
<g id="edge327" class="edge">
<title>l2_exp11_linear1&#45;&gt;l2_exp11_gelu</title>
<path fill="none" stroke="black" d="M4643,-1676.03C4643,-1667.96 4643,-1658.25 4643,-1649.26"/>
<polygon fill="black" stroke="black" points="4646.5,-1649.17 4643,-1639.17 4639.5,-1649.17 4646.5,-1649.17"/>
</g>
<!-- l2_exp11_linear2 -->
<g id="node283" class="node">
<title>l2_exp11_linear2</title>
<polygon fill="none" stroke="black" points="4725,-1564.08 4561,-1564.08 4561,-1526.08 4725,-1526.08 4725,-1564.08"/>
<text text-anchor="middle" x="4643" y="-1552.88" font-family="Arial" font-size="9.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="4643" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4643" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l2_exp11_gelu&#45;&gt;l2_exp11_linear2 -->
<g id="edge328" class="edge">
<title>l2_exp11_gelu&#45;&gt;l2_exp11_linear2</title>
<path fill="none" stroke="black" d="M4643,-1601.03C4643,-1592.96 4643,-1583.25 4643,-1574.26"/>
<polygon fill="black" stroke="black" points="4646.5,-1574.17 4643,-1564.17 4639.5,-1574.17 4646.5,-1574.17"/>
</g>
<!-- l2_scatter_11 -->
<g id="node284" class="node">
<title>l2_scatter_11</title>
<ellipse fill="none" stroke="black" cx="4652" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4652" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4652" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4652" y="-1450.01" font-family="Arial" font-size="9.00">GPU 76 → All GPUs</text>
</g>
<!-- l2_exp11_linear2&#45;&gt;l2_scatter_11 -->
<g id="edge329" class="edge">
<title>l2_exp11_linear2&#45;&gt;l2_scatter_11</title>
<path fill="none" stroke="black" d="M4645.04,-1525.73C4645.92,-1517.87 4646.97,-1508.41 4647.99,-1499.26"/>
<polygon fill="black" stroke="black" points="4651.49,-1499.48 4649.11,-1489.15 4644.53,-1498.7 4651.49,-1499.48"/>
</g>
<!-- l2_scatter_11&#45;&gt;l2_expert_agg -->
<g id="edge330" class="edge">
<title>l2_scatter_11&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M4697.41,-1441.59C4710.08,-1436.54 4723.95,-1431.39 4737,-1427.34 4813.47,-1403.61 4901.85,-1383.92 4968.77,-1370.53"/>
<polygon fill="black" stroke="black" points="4969.78,-1373.89 4978.9,-1368.51 4968.41,-1367.03 4969.78,-1373.89"/>
</g>
<!-- l2_exp12_linear1 -->
<g id="node287" class="node">
<title>l2_exp12_linear1</title>
<polygon fill="none" stroke="black" points="5589,-1714.08 5425,-1714.08 5425,-1676.08 5589,-1676.08 5589,-1714.08"/>
<text text-anchor="middle" x="5507" y="-1702.88" font-family="Arial" font-size="9.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="5507" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5507" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 80&#45;83</text>
</g>
<!-- l2_gather_12&#45;&gt;l2_exp12_linear1 -->
<g id="edge333" class="edge">
<title>l2_gather_12&#45;&gt;l2_exp12_linear1</title>
<path fill="none" stroke="black" d="M5521.32,-1761.96C5518.75,-1750.13 5515.7,-1736.12 5513.09,-1724.07"/>
<polygon fill="black" stroke="black" points="5516.46,-1723.12 5510.92,-1714.09 5509.62,-1724.61 5516.46,-1723.12"/>
</g>
<!-- l2_exp12_gelu -->
<g id="node288" class="node">
<title>l2_exp12_gelu</title>
<polygon fill="none" stroke="black" points="5415,-1639.08 5329,-1639.08 5329,-1601.08 5415,-1601.08 5415,-1639.08"/>
<text text-anchor="middle" x="5372" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5372" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5372" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 80&#45;83</text>
</g>
<!-- l2_exp12_linear1&#45;&gt;l2_exp12_gelu -->
<g id="edge334" class="edge">
<title>l2_exp12_linear1&#45;&gt;l2_exp12_gelu</title>
<path fill="none" stroke="black" d="M5473.63,-1676.03C5455.7,-1666.34 5433.41,-1654.28 5414.28,-1643.94"/>
<polygon fill="black" stroke="black" points="5415.92,-1640.85 5405.45,-1639.17 5412.59,-1647 5415.92,-1640.85"/>
</g>
<!-- l2_exp12_linear2 -->
<g id="node289" class="node">
<title>l2_exp12_linear2</title>
<polygon fill="none" stroke="black" points="5375,-1564.08 5211,-1564.08 5211,-1526.08 5375,-1526.08 5375,-1564.08"/>
<text text-anchor="middle" x="5293" y="-1552.88" font-family="Arial" font-size="9.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="5293" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5293" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 80&#45;83</text>
</g>
<!-- l2_exp12_gelu&#45;&gt;l2_exp12_linear2 -->
<g id="edge335" class="edge">
<title>l2_exp12_gelu&#45;&gt;l2_exp12_linear2</title>
<path fill="none" stroke="black" d="M5352.47,-1601.03C5342.69,-1592 5330.69,-1580.91 5320.04,-1571.07"/>
<polygon fill="black" stroke="black" points="5322.3,-1568.38 5312.58,-1564.17 5317.55,-1573.53 5322.3,-1568.38"/>
</g>
<!-- l2_scatter_12 -->
<g id="node290" class="node">
<title>l2_scatter_12</title>
<ellipse fill="none" stroke="black" cx="5271" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5271" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5271" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5271" y="-1450.01" font-family="Arial" font-size="9.00">GPU 80 → All GPUs</text>
</g>
<!-- l2_exp12_linear2&#45;&gt;l2_scatter_12 -->
<g id="edge336" class="edge">
<title>l2_exp12_linear2&#45;&gt;l2_scatter_12</title>
<path fill="none" stroke="black" d="M5288.01,-1525.73C5285.85,-1517.79 5283.24,-1508.21 5280.73,-1498.96"/>
<polygon fill="black" stroke="black" points="5284.06,-1497.88 5278.06,-1489.15 5277.31,-1499.72 5284.06,-1497.88"/>
</g>
<!-- l2_scatter_12&#45;&gt;l2_expert_agg -->
<g id="edge337" class="edge">
<title>l2_scatter_12&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M5232.35,-1439.76C5213.49,-1429.3 5189.91,-1416.21 5166.71,-1403.34"/>
<polygon fill="black" stroke="black" points="5168.29,-1400.21 5157.85,-1398.42 5164.89,-1406.33 5168.29,-1400.21"/>
</g>
<!-- l2_exp13_linear1 -->
<g id="node293" class="node">
<title>l2_exp13_linear1</title>
<polygon fill="none" stroke="black" points="6891,-1714.08 6727,-1714.08 6727,-1676.08 6891,-1676.08 6891,-1714.08"/>
<text text-anchor="middle" x="6809" y="-1702.88" font-family="Arial" font-size="9.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="6809" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6809" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 84&#45;87</text>
</g>
<!-- l2_gather_13&#45;&gt;l2_exp13_linear1 -->
<g id="edge340" class="edge">
<title>l2_gather_13&#45;&gt;l2_exp13_linear1</title>
<path fill="none" stroke="black" d="M6823.32,-1761.96C6820.75,-1750.13 6817.7,-1736.12 6815.09,-1724.07"/>
<polygon fill="black" stroke="black" points="6818.46,-1723.12 6812.92,-1714.09 6811.62,-1724.61 6818.46,-1723.12"/>
</g>
<!-- l2_exp13_gelu -->
<g id="node294" class="node">
<title>l2_exp13_gelu</title>
<polygon fill="none" stroke="black" points="6717,-1639.08 6631,-1639.08 6631,-1601.08 6717,-1601.08 6717,-1639.08"/>
<text text-anchor="middle" x="6674" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6674" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6674" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 84&#45;87</text>
</g>
<!-- l2_exp13_linear1&#45;&gt;l2_exp13_gelu -->
<g id="edge341" class="edge">
<title>l2_exp13_linear1&#45;&gt;l2_exp13_gelu</title>
<path fill="none" stroke="black" d="M6775.63,-1676.03C6757.7,-1666.34 6735.41,-1654.28 6716.28,-1643.94"/>
<polygon fill="black" stroke="black" points="6717.92,-1640.85 6707.45,-1639.17 6714.59,-1647 6717.92,-1640.85"/>
</g>
<!-- l2_exp13_linear2 -->
<g id="node295" class="node">
<title>l2_exp13_linear2</title>
<polygon fill="none" stroke="black" points="6677,-1564.08 6513,-1564.08 6513,-1526.08 6677,-1526.08 6677,-1564.08"/>
<text text-anchor="middle" x="6595" y="-1552.88" font-family="Arial" font-size="9.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="6595" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6595" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 84&#45;87</text>
</g>
<!-- l2_exp13_gelu&#45;&gt;l2_exp13_linear2 -->
<g id="edge342" class="edge">
<title>l2_exp13_gelu&#45;&gt;l2_exp13_linear2</title>
<path fill="none" stroke="black" d="M6654.47,-1601.03C6644.69,-1592 6632.69,-1580.91 6622.04,-1571.07"/>
<polygon fill="black" stroke="black" points="6624.3,-1568.38 6614.58,-1564.17 6619.55,-1573.53 6624.3,-1568.38"/>
</g>
<!-- l2_scatter_13 -->
<g id="node296" class="node">
<title>l2_scatter_13</title>
<ellipse fill="none" stroke="black" cx="6573" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6573" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6573" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6573" y="-1450.01" font-family="Arial" font-size="9.00">GPU 84 → All GPUs</text>
</g>
<!-- l2_exp13_linear2&#45;&gt;l2_scatter_13 -->
<g id="edge343" class="edge">
<title>l2_exp13_linear2&#45;&gt;l2_scatter_13</title>
<path fill="none" stroke="black" d="M6590.01,-1525.73C6587.85,-1517.79 6585.24,-1508.21 6582.73,-1498.96"/>
<polygon fill="black" stroke="black" points="6586.06,-1497.88 6580.06,-1489.15 6579.31,-1499.72 6586.06,-1497.88"/>
</g>
<!-- l2_scatter_13&#45;&gt;l2_expert_agg -->
<g id="edge344" class="edge">
<title>l2_scatter_13&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M6524.74,-1442.6C6507.42,-1436.7 6487.57,-1430.81 6469,-1427.34 6224.73,-1381.72 5478.13,-1360.46 5189.04,-1353.77"/>
<polygon fill="black" stroke="black" points="5189.03,-1350.27 5178.95,-1353.54 5188.86,-1357.27 5189.03,-1350.27"/>
</g>
<!-- l2_exp14_linear1 -->
<g id="node299" class="node">
<title>l2_exp14_linear1</title>
<polygon fill="none" stroke="black" points="7644,-1714.08 7480,-1714.08 7480,-1676.08 7644,-1676.08 7644,-1714.08"/>
<text text-anchor="middle" x="7562" y="-1702.88" font-family="Arial" font-size="9.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="7562" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7562" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 88&#45;91</text>
</g>
<!-- l2_gather_14&#45;&gt;l2_exp14_linear1 -->
<g id="edge347" class="edge">
<title>l2_gather_14&#45;&gt;l2_exp14_linear1</title>
<path fill="none" stroke="black" d="M7667,-1765.57C7646.09,-1751.73 7619.32,-1734.02 7598.04,-1719.93"/>
<polygon fill="black" stroke="black" points="7599.86,-1716.94 7589.59,-1714.34 7596,-1722.78 7599.86,-1716.94"/>
</g>
<!-- l2_exp14_gelu -->
<g id="node300" class="node">
<title>l2_exp14_gelu</title>
<polygon fill="none" stroke="black" points="7589,-1639.08 7503,-1639.08 7503,-1601.08 7589,-1601.08 7589,-1639.08"/>
<text text-anchor="middle" x="7546" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7546" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7546" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 88&#45;91</text>
</g>
<!-- l2_exp14_linear1&#45;&gt;l2_exp14_gelu -->
<g id="edge348" class="edge">
<title>l2_exp14_linear1&#45;&gt;l2_exp14_gelu</title>
<path fill="none" stroke="black" d="M7558.04,-1676.03C7556.26,-1667.87 7554.1,-1658.04 7552.11,-1648.97"/>
<polygon fill="black" stroke="black" points="7555.52,-1648.19 7549.97,-1639.17 7548.69,-1649.69 7555.52,-1648.19"/>
</g>
<!-- l2_exp14_linear2 -->
<g id="node301" class="node">
<title>l2_exp14_linear2</title>
<polygon fill="none" stroke="black" points="7549,-1564.08 7385,-1564.08 7385,-1526.08 7549,-1526.08 7549,-1564.08"/>
<text text-anchor="middle" x="7467" y="-1552.88" font-family="Arial" font-size="9.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="7467" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7467" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 88&#45;91</text>
</g>
<!-- l2_exp14_gelu&#45;&gt;l2_exp14_linear2 -->
<g id="edge349" class="edge">
<title>l2_exp14_gelu&#45;&gt;l2_exp14_linear2</title>
<path fill="none" stroke="black" d="M7526.47,-1601.03C7516.69,-1592 7504.69,-1580.91 7494.04,-1571.07"/>
<polygon fill="black" stroke="black" points="7496.3,-1568.38 7486.58,-1564.17 7491.55,-1573.53 7496.3,-1568.38"/>
</g>
<!-- l2_scatter_14 -->
<g id="node302" class="node">
<title>l2_scatter_14</title>
<ellipse fill="none" stroke="black" cx="7445" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7445" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7445" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7445" y="-1450.01" font-family="Arial" font-size="9.00">GPU 88 → All GPUs</text>
</g>
<!-- l2_exp14_linear2&#45;&gt;l2_scatter_14 -->
<g id="edge350" class="edge">
<title>l2_exp14_linear2&#45;&gt;l2_scatter_14</title>
<path fill="none" stroke="black" d="M7462.01,-1525.73C7459.85,-1517.79 7457.24,-1508.21 7454.73,-1498.96"/>
<polygon fill="black" stroke="black" points="7458.06,-1497.88 7452.06,-1489.15 7451.31,-1499.72 7458.06,-1497.88"/>
</g>
<!-- l2_scatter_14&#45;&gt;l2_expert_agg -->
<g id="edge351" class="edge">
<title>l2_scatter_14&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M7397.04,-1442.47C7379.66,-1436.52 7359.7,-1430.63 7341,-1427.34 6920.72,-1353.39 5587.64,-1350.17 5187.59,-1350.93"/>
<polygon fill="black" stroke="black" points="5187.45,-1347.43 5177.45,-1350.95 5187.46,-1354.43 5187.45,-1347.43"/>
</g>
<!-- l2_exp15_linear1 -->
<g id="node305" class="node">
<title>l2_exp15_linear1</title>
<polygon fill="none" stroke="black" points="8086,-1714.08 7922,-1714.08 7922,-1676.08 8086,-1676.08 8086,-1714.08"/>
<text text-anchor="middle" x="8004" y="-1702.88" font-family="Arial" font-size="9.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="8004" y="-1692.88" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="8004" y="-1682.88" font-family="Arial" font-size="9.00">TP across GPUs 92&#45;95</text>
</g>
<!-- l2_gather_15&#45;&gt;l2_exp15_linear1 -->
<g id="edge354" class="edge">
<title>l2_gather_15&#45;&gt;l2_exp15_linear1</title>
<path fill="none" stroke="black" d="M8109,-1765.57C8088.09,-1751.73 8061.32,-1734.02 8040.04,-1719.93"/>
<polygon fill="black" stroke="black" points="8041.86,-1716.94 8031.59,-1714.34 8038,-1722.78 8041.86,-1716.94"/>
</g>
<!-- l2_exp15_gelu -->
<g id="node306" class="node">
<title>l2_exp15_gelu</title>
<polygon fill="none" stroke="black" points="8031,-1639.08 7945,-1639.08 7945,-1601.08 8031,-1601.08 8031,-1639.08"/>
<text text-anchor="middle" x="7988" y="-1627.88" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7988" y="-1617.88" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7988" y="-1607.88" font-family="Arial" font-size="9.00">GPUs 92&#45;95</text>
</g>
<!-- l2_exp15_linear1&#45;&gt;l2_exp15_gelu -->
<g id="edge355" class="edge">
<title>l2_exp15_linear1&#45;&gt;l2_exp15_gelu</title>
<path fill="none" stroke="black" d="M8000.04,-1676.03C7998.26,-1667.87 7996.1,-1658.04 7994.11,-1648.97"/>
<polygon fill="black" stroke="black" points="7997.52,-1648.19 7991.97,-1639.17 7990.69,-1649.69 7997.52,-1648.19"/>
</g>
<!-- l2_exp15_linear2 -->
<g id="node307" class="node">
<title>l2_exp15_linear2</title>
<polygon fill="none" stroke="black" points="7991,-1564.08 7827,-1564.08 7827,-1526.08 7991,-1526.08 7991,-1564.08"/>
<text text-anchor="middle" x="7909" y="-1552.88" font-family="Arial" font-size="9.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="7909" y="-1542.88" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7909" y="-1532.88" font-family="Arial" font-size="9.00">TP across GPUs 92&#45;95</text>
</g>
<!-- l2_exp15_gelu&#45;&gt;l2_exp15_linear2 -->
<g id="edge356" class="edge">
<title>l2_exp15_gelu&#45;&gt;l2_exp15_linear2</title>
<path fill="none" stroke="black" d="M7952.47,-1600.93C7944.5,-1595.84 7936.49,-1589.83 7930,-1583.08 7927.14,-1580.11 7924.54,-1576.68 7922.2,-1573.12"/>
<polygon fill="black" stroke="black" points="7925.07,-1571.09 7916.99,-1564.24 7919.03,-1574.64 7925.07,-1571.09"/>
</g>
<!-- l2_scatter_15 -->
<g id="node308" class="node">
<title>l2_scatter_15</title>
<ellipse fill="none" stroke="black" cx="7887" cy="-1462.21" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7887" y="-1470.01" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7887" y="-1460.01" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7887" y="-1450.01" font-family="Arial" font-size="9.00">GPU 92 → All GPUs</text>
</g>
<!-- l2_exp15_linear2&#45;&gt;l2_scatter_15 -->
<g id="edge357" class="edge">
<title>l2_exp15_linear2&#45;&gt;l2_scatter_15</title>
<path fill="none" stroke="black" d="M7904.01,-1525.73C7901.85,-1517.79 7899.24,-1508.21 7896.73,-1498.96"/>
<polygon fill="black" stroke="black" points="7900.06,-1497.88 7894.06,-1489.15 7893.31,-1499.72 7900.06,-1497.88"/>
</g>
<!-- l2_scatter_15&#45;&gt;l2_expert_agg -->
<g id="edge358" class="edge">
<title>l2_scatter_15&#45;&gt;l2_expert_agg</title>
<path fill="none" stroke="black" d="M7839.31,-1442.5C7821.87,-1436.51 7801.8,-1430.59 7783,-1427.34 7525.34,-1382.73 5672.87,-1358.3 5188.59,-1352.63"/>
<polygon fill="black" stroke="black" points="5188.48,-1349.13 5178.44,-1352.51 5188.4,-1356.13 5188.48,-1349.13"/>
</g>
<!-- l2_expert_agg&#45;&gt;l2_moe_res -->
<g id="edge359" class="edge">
<title>l2_expert_agg&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M5155.19,-1310.52C5183.37,-1297.21 5214.54,-1282.48 5241.33,-1269.83"/>
<polygon fill="black" stroke="black" points="5243.07,-1272.88 5250.62,-1265.44 5240.08,-1266.55 5243.07,-1272.88"/>
</g>
<!-- l3_mha_qkv -->
<g id="node311" class="node">
<title>l3_mha_qkv</title>
<polygon fill="none" stroke="black" points="5311.5,-1105.34 5158.5,-1105.34 5158.5,-1067.34 5311.5,-1067.34 5311.5,-1105.34"/>
<text text-anchor="middle" x="5235" y="-1094.14" font-family="Arial" font-size="9.00">MHA QKV Linear</text>
<text text-anchor="middle" x="5235" y="-1084.14" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="5235" y="-1074.14" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l2_moe_res&#45;&gt;l3_mha_qkv -->
<g id="edge361" class="edge">
<title>l2_moe_res&#45;&gt;l3_mha_qkv</title>
<path fill="none" stroke="black" d="M5294.61,-1209.01C5281.49,-1182.22 5261.59,-1141.61 5248.45,-1114.79"/>
<polygon fill="black" stroke="black" points="5251.48,-1113.02 5243.94,-1105.58 5245.19,-1116.1 5251.48,-1113.02"/>
</g>
<!-- l3_mha_res -->
<g id="node314" class="node">
<title>l3_mha_res</title>
<polygon fill="none" stroke="black" points="5399.91,-870.34 5188.48,-870.34 5134.09,-814.34 5345.52,-814.34 5399.91,-870.34"/>
<text text-anchor="middle" x="5267" y="-845.14" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="5267" y="-835.14" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l2_moe_res&#45;&gt;l3_mha_res -->
<g id="edge365" class="edge">
<title>l2_moe_res&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M5317.43,-1209.25C5326.87,-1179.68 5340,-1130.73 5340,-1087.34 5340,-1087.34 5340,-1087.34 5340,-935.34 5340,-913.26 5326.94,-893.4 5311.87,-877.83"/>
<polygon fill="black" stroke="black" points="5313.97,-874.99 5304.36,-870.54 5309.09,-880.02 5313.97,-874.99"/>
</g>
<!-- l3_mha_attn -->
<g id="node312" class="node">
<title>l3_mha_attn</title>
<polygon fill="none" stroke="black" points="5278.5,-1030.34 5195.5,-1030.34 5195.5,-992.34 5278.5,-992.34 5278.5,-1030.34"/>
<text text-anchor="middle" x="5237" y="-1019.14" font-family="Arial" font-size="9.00">MHA Attention</text>
<text text-anchor="middle" x="5237" y="-1009.14" font-family="Arial" font-size="9.00">[1024, 16×512]</text>
<text text-anchor="middle" x="5237" y="-999.14" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l3_mha_qkv&#45;&gt;l3_mha_attn -->
<g id="edge362" class="edge">
<title>l3_mha_qkv&#45;&gt;l3_mha_attn</title>
<path fill="none" stroke="black" d="M5235.49,-1067.29C5235.72,-1059.22 5235.98,-1049.51 5236.23,-1040.52"/>
<polygon fill="black" stroke="black" points="5239.73,-1040.52 5236.5,-1030.43 5232.73,-1040.33 5239.73,-1040.52"/>
</g>
<!-- l3_mha_out -->
<g id="node313" class="node">
<title>l3_mha_out</title>
<polygon fill="none" stroke="black" points="5309,-955.34 5177,-955.34 5177,-917.34 5309,-917.34 5309,-955.34"/>
<text text-anchor="middle" x="5243" y="-944.14" font-family="Arial" font-size="9.00">MHA Output Linear</text>
<text text-anchor="middle" x="5243" y="-934.14" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="5243" y="-924.14" font-family="Arial" font-size="9.00">TP across GPUs</text>
</g>
<!-- l3_mha_attn&#45;&gt;l3_mha_out -->
<g id="edge363" class="edge">
<title>l3_mha_attn&#45;&gt;l3_mha_out</title>
<path fill="none" stroke="black" d="M5238.48,-992.29C5239.15,-984.22 5239.94,-974.51 5240.68,-965.52"/>
<polygon fill="black" stroke="black" points="5244.18,-965.68 5241.51,-955.43 5237.21,-965.11 5244.18,-965.68"/>
</g>
<!-- l3_mha_out&#45;&gt;l3_mha_res -->
<g id="edge364" class="edge">
<title>l3_mha_out&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M5247.74,-917.16C5250.48,-906.67 5254.02,-893.08 5257.33,-880.42"/>
<polygon fill="black" stroke="black" points="5260.76,-881.11 5259.9,-870.55 5253.99,-879.34 5260.76,-881.11"/>
</g>
<!-- l3_global_gate -->
<g id="node315" class="node">
<title>l3_global_gate</title>
<polygon fill="none" stroke="black" points="5098.47,-880.34 4897.29,-880.34 4845.53,-804.34 5046.71,-804.34 5098.47,-880.34"/>
<text text-anchor="middle" x="4972" y="-850.14" font-family="Arial" font-size="9.00">Global Gate</text>
<text text-anchor="middle" x="4972" y="-840.14" font-family="Arial" font-size="9.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="4972" y="-830.14" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_global_gate -->
<g id="edge366" class="edge">
<title>l3_mha_res&#45;&gt;l3_global_gate</title>
<path fill="none" stroke="black" d="M5161.19,-842.34C5135.08,-842.34 5108.96,-842.34 5082.84,-842.34"/>
<polygon fill="black" stroke="black" points="5082.83,-838.84 5072.83,-842.34 5082.83,-845.84 5082.83,-838.84"/>
</g>
<!-- l3_gather_0 -->
<g id="node317" class="node">
<title>l3_gather_0</title>
<ellipse fill="none" stroke="black" cx="4395" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4395" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4395" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4395" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 48</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_0 -->
<g id="edge368" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_0</title>
<path fill="none" stroke="black" d="M5178.07,-814.25C5162.19,-810.3 5145.71,-806.75 5130,-804.34 5094.11,-798.82 4510.21,-792.02 4477,-777.34 4453.22,-766.82 4432.68,-745.99 4418.1,-727.83"/>
<polygon fill="black" stroke="black" points="4420.71,-725.49 4411.83,-719.72 4415.18,-729.77 4420.71,-725.49"/>
</g>
<!-- l3_gather_1 -->
<g id="node323" class="node">
<title>l3_gather_1</title>
<ellipse fill="none" stroke="black" cx="6139" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6139" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6139" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6139" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 52</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_1 -->
<g id="edge375" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_1</title>
<path fill="none" stroke="black" d="M5372.49,-842.04C5559.62,-841.79 5941.19,-834.04 6060,-777.34 6082.89,-766.41 6102.57,-745.79 6116.56,-727.83"/>
<polygon fill="black" stroke="black" points="6119.38,-729.91 6122.58,-719.82 6113.78,-725.71 6119.38,-729.91"/>
</g>
<!-- l3_gather_2 -->
<g id="node329" class="node">
<title>l3_gather_2</title>
<ellipse fill="none" stroke="black" cx="3965" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3965" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3965" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3965" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 56</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_2 -->
<g id="edge382" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_2</title>
<path fill="none" stroke="black" d="M5179.21,-814.31C5162.99,-810.27 5146.09,-806.68 5130,-804.34 5070.44,-795.68 4102.24,-801.23 4047,-777.34 4023.14,-767.02 4002.59,-746.18 3988.03,-727.97"/>
<polygon fill="black" stroke="black" points="3990.65,-725.63 3981.78,-719.84 3985.1,-729.9 3990.65,-725.63"/>
</g>
<!-- l3_gather_3 -->
<g id="node335" class="node">
<title>l3_gather_3</title>
<ellipse fill="none" stroke="black" cx="1803" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1803" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="1803" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="1803" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 60</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_3 -->
<g id="edge389" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_3</title>
<path fill="none" stroke="black" d="M5179.98,-814.26C5163.53,-810.16 5146.36,-806.56 5130,-804.34 4984.56,-784.54 2634.77,-787.93 2488,-786.34 2479.62,-786.25 1892.7,-780.62 1885,-777.34 1860.93,-767.07 1840.26,-746.02 1825.7,-727.69"/>
<polygon fill="black" stroke="black" points="1828.3,-725.33 1819.45,-719.51 1822.74,-729.58 1828.3,-725.33"/>
</g>
<!-- l3_gather_4 -->
<g id="node341" class="node">
<title>l3_gather_4</title>
<ellipse fill="none" stroke="black" cx="5267" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5267" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5267" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5267" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 64</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_4 -->
<g id="edge396" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_4</title>
<path fill="none" stroke="black" d="M5267,-814.03C5267,-790.53 5267,-756.44 5267,-730.65"/>
<polygon fill="black" stroke="black" points="5270.5,-730.51 5267,-720.51 5263.5,-730.51 5270.5,-730.51"/>
</g>
<!-- l3_gather_5 -->
<g id="node347" class="node">
<title>l3_gather_5</title>
<ellipse fill="none" stroke="black" cx="3093" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3093" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3093" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3093" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 68</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_5 -->
<g id="edge403" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_5</title>
<path fill="none" stroke="black" d="M5179.97,-814.33C5163.53,-810.23 5146.35,-806.61 5130,-804.34 4969.2,-782 3831.33,-788.82 3669,-786.34 3641.55,-785.92 3200.23,-788.15 3175,-777.34 3150.94,-767.03 3130.28,-745.98 3115.71,-727.66"/>
<polygon fill="black" stroke="black" points="3118.32,-725.3 3109.46,-719.49 3112.76,-729.56 3118.32,-725.3"/>
</g>
<!-- l3_gather_6 -->
<g id="node353" class="node">
<title>l3_gather_6</title>
<ellipse fill="none" stroke="black" cx="6569" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6569" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="6569" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="6569" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 72</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_6 -->
<g id="edge410" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_6</title>
<path fill="none" stroke="black" d="M5370.77,-840.29C5647.65,-836.87 6389.74,-823.46 6490,-777.34 6513.2,-766.67 6532.99,-745.83 6546.96,-727.71"/>
<polygon fill="black" stroke="black" points="6549.82,-729.74 6552.96,-719.62 6544.19,-725.57 6549.82,-729.74"/>
</g>
<!-- l3_gather_7 -->
<g id="node359" class="node">
<title>l3_gather_7</title>
<ellipse fill="none" stroke="black" cx="2233" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2233" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2233" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2233" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 76</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_7 -->
<g id="edge417" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_7</title>
<path fill="none" stroke="black" d="M5179.98,-814.27C5163.53,-810.18 5146.35,-806.57 5130,-804.34 5007.25,-787.55 3023.88,-787.79 2900,-786.34 2867.5,-785.96 2344.89,-790.1 2315,-777.34 2290.93,-767.06 2270.27,-746.02 2255.7,-727.69"/>
<polygon fill="black" stroke="black" points="2258.31,-725.33 2249.45,-719.51 2252.74,-729.58 2258.31,-725.33"/>
</g>
<!-- l3_gather_8 -->
<g id="node365" class="node">
<title>l3_gather_8</title>
<ellipse fill="none" stroke="black" cx="7448" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7448" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7448" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7448" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 80</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_8 -->
<g id="edge424" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_8</title>
<path fill="none" stroke="black" d="M5371.05,-840.36C5782.38,-836.23 7277.07,-818.42 7369,-777.34 7392.31,-766.92 7412.1,-746.09 7426.05,-727.9"/>
<polygon fill="black" stroke="black" points="7428.92,-729.9 7432.03,-719.78 7423.28,-725.75 7428.92,-729.9"/>
</g>
<!-- l3_gather_9 -->
<g id="node371" class="node">
<title>l3_gather_9</title>
<ellipse fill="none" stroke="black" cx="2663" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2663" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="2663" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="2663" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 84</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_9 -->
<g id="edge431" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_9</title>
<path fill="none" stroke="black" d="M5179.98,-814.3C5163.53,-810.2 5146.35,-806.59 5130,-804.34 5033.41,-791.02 3472.5,-787.53 3375,-786.34 3340,-785.91 2777.2,-791.06 2745,-777.34 2720.92,-767.08 2700.26,-746.03 2685.7,-727.7"/>
<polygon fill="black" stroke="black" points="2688.3,-725.34 2679.45,-719.52 2682.74,-729.59 2688.3,-725.34"/>
</g>
<!-- l3_gather_10 -->
<g id="node377" class="node">
<title>l3_gather_10</title>
<ellipse fill="none" stroke="black" cx="3535" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3535" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="3535" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="3535" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 88</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_10 -->
<g id="edge438" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_10</title>
<path fill="none" stroke="black" d="M5179.6,-814.31C5163.26,-810.24 5146.22,-806.64 5130,-804.34 5018.21,-788.5 4226.89,-788.36 4114,-786.34 4058.78,-785.35 3667.77,-799.09 3617,-777.34 3592.94,-767.03 3572.28,-745.98 3557.71,-727.66"/>
<polygon fill="black" stroke="black" points="3560.32,-725.3 3551.46,-719.49 3554.76,-729.56 3560.32,-725.3"/>
</g>
<!-- l3_gather_11 -->
<g id="node383" class="node">
<title>l3_gather_11</title>
<ellipse fill="none" stroke="black" cx="4837" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4837" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="4837" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="4837" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 92</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_11 -->
<g id="edge445" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_11</title>
<path fill="none" stroke="black" d="M5173.44,-814.25C5158.97,-810.59 5144.14,-807.14 5130,-804.34 5037.26,-785.97 5003.74,-819.26 4919,-777.34 4895.86,-765.89 4875.43,-745.26 4860.75,-727.44"/>
<polygon fill="black" stroke="black" points="4863.39,-725.13 4854.42,-719.49 4857.91,-729.49 4863.39,-725.13"/>
</g>
<!-- l3_gather_12 -->
<g id="node389" class="node">
<title>l3_gather_12</title>
<ellipse fill="none" stroke="black" cx="5709" cy="-693.34" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5709" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="5709" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="5709" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 96</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_12 -->
<g id="edge452" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_12</title>
<path fill="none" stroke="black" d="M5370.8,-840.14C5446.63,-835.33 5549.78,-820.36 5630,-777.34 5652,-765.54 5671.41,-745.37 5685.48,-727.87"/>
<polygon fill="black" stroke="black" points="5688.58,-729.58 5691.95,-719.54 5683.06,-725.29 5688.58,-729.58"/>
</g>
<!-- l3_gather_13 -->
<g id="node395" class="node">
<title>l3_gather_13</title>
<ellipse fill="none" stroke="black" cx="7014" cy="-693.34" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="7014" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7014" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7014" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 100</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_13 -->
<g id="edge459" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_13</title>
<path fill="none" stroke="black" d="M5372.29,-841.77C5715.79,-842.55 6789.96,-839.91 6932,-777.34 6955.79,-766.86 6976.34,-746.02 6990.91,-727.85"/>
<polygon fill="black" stroke="black" points="6993.84,-729.79 6997.18,-719.74 6988.3,-725.51 6993.84,-729.79"/>
</g>
<!-- l3_gather_14 -->
<g id="node401" class="node">
<title>l3_gather_14</title>
<ellipse fill="none" stroke="black" cx="7893" cy="-693.34" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="7893" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="7893" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="7893" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 104</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_14 -->
<g id="edge466" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_14</title>
<path fill="none" stroke="black" d="M5371.38,-840.89C5835.91,-838.61 7697.5,-826.44 7811,-777.34 7834.86,-767.02 7855.41,-746.18 7869.96,-727.97"/>
<polygon fill="black" stroke="black" points="7872.9,-729.9 7876.22,-719.84 7867.35,-725.63 7872.9,-729.9"/>
</g>
<!-- l3_gather_15 -->
<g id="node407" class="node">
<title>l3_gather_15</title>
<ellipse fill="none" stroke="black" cx="8342" cy="-693.34" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="8342" y="-701.14" font-family="Arial" font-size="9.00">Gather Tokens</text>
<text text-anchor="middle" x="8342" y="-691.14" font-family="Arial" font-size="9.00">Dynamic batch size</text>
<text text-anchor="middle" x="8342" y="-681.14" font-family="Arial" font-size="9.00">All GPUs → GPU 108</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gather_15 -->
<g id="edge473" class="edge">
<title>l3_mha_res&#45;&gt;l3_gather_15</title>
<path fill="none" stroke="black" d="M5370.14,-839.26C5895.72,-828.67 8251.52,-780.99 8260,-777.34 8283.88,-767.06 8304.43,-746.23 8318.98,-728"/>
<polygon fill="black" stroke="black" points="8321.92,-729.92 8325.23,-719.86 8316.37,-725.66 8321.92,-729.92"/>
</g>
<!-- l3_moe_res -->
<g id="node413" class="node">
<title>l3_moe_res</title>
<polygon fill="none" stroke="black" points="6911.91,-169.6 6700.48,-169.6 6646.09,-113.6 6857.52,-113.6 6911.91,-169.6"/>
<text text-anchor="middle" x="6779" y="-144.4" font-family="Arial" font-size="9.00">Residual Add</text>
<text text-anchor="middle" x="6779" y="-134.4" font-family="Arial" font-size="9.00">[1024, 8192] + [1024, 8192]</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_moe_res -->
<g id="edge480" class="edge">
<title>l3_mha_res&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M5371.9,-841.12C5913.57,-839.79 8371.02,-830.79 8428,-777.34 8455,-752.01 8435,-731.36 8435,-694.34 8435,-694.34 8435,-694.34 8435,-253.6 8435,-176.48 7276.6,-150.71 6897.51,-144.35"/>
<polygon fill="black" stroke="black" points="6897.39,-140.84 6887.34,-144.18 6897.28,-147.84 6897.39,-140.84"/>
</g>
<!-- l3_route_0 -->
<g id="node316" class="node">
<title>l3_route_0</title>
<polygon fill="none" stroke="black" points="4307.32,-731.34 4109.55,-731.34 4058.68,-655.34 4256.45,-655.34 4307.32,-731.34"/>
<text text-anchor="middle" x="4183" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4183" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 0</text>
<text text-anchor="middle" x="4183" y="-681.14" font-family="Arial" font-size="9.00">GPU 48</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_0 -->
<g id="edge367" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4867.55,-836.96C4708.96,-829.33 4415.34,-811.1 4316,-777.34 4288.92,-768.14 4261.67,-752.5 4238.94,-737.27"/>
<polygon fill="black" stroke="black" points="4240.69,-734.23 4230.46,-731.47 4236.74,-740.01 4240.69,-734.23"/>
</g>
<!-- l3_route_1 -->
<g id="node322" class="node">
<title>l3_route_1</title>
<polygon fill="none" stroke="black" points="6051.32,-731.34 5853.55,-731.34 5802.68,-655.34 6000.45,-655.34 6051.32,-731.34"/>
<text text-anchor="middle" x="5927" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5927" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 1</text>
<text text-anchor="middle" x="5927" y="-681.14" font-family="Arial" font-size="9.00">GPU 52</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_1 -->
<g id="edge374" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.9,-817.49C5077.29,-812.28 5100.36,-807.41 5122,-804.34 5269.31,-783.42 5648.6,-820.47 5791,-777.34 5819.41,-768.73 5847.9,-752.75 5871.41,-737.1"/>
<polygon fill="black" stroke="black" points="5873.55,-739.88 5879.84,-731.36 5869.61,-734.1 5873.55,-739.88"/>
</g>
<!-- l3_route_2 -->
<g id="node328" class="node">
<title>l3_route_2</title>
<polygon fill="none" stroke="black" points="3877.32,-731.34 3679.55,-731.34 3628.68,-655.34 3826.45,-655.34 3877.32,-731.34"/>
<text text-anchor="middle" x="3753" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3753" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 2</text>
<text text-anchor="middle" x="3753" y="-681.14" font-family="Arial" font-size="9.00">GPU 56</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_2 -->
<g id="edge381" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.82,-841.72C4637.43,-841.6 4067.53,-835.17 3886,-777.34 3858.52,-768.58 3831,-752.86 3808.19,-737.43"/>
<polygon fill="black" stroke="black" points="3809.9,-734.36 3799.68,-731.55 3805.91,-740.11 3809.9,-734.36"/>
</g>
<!-- l3_route_3 -->
<g id="node334" class="node">
<title>l3_route_3</title>
<polygon fill="none" stroke="black" points="1715.32,-731.34 1517.55,-731.34 1466.68,-655.34 1664.45,-655.34 1715.32,-731.34"/>
<text text-anchor="middle" x="1591" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="1591" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 3</text>
<text text-anchor="middle" x="1591" y="-681.14" font-family="Arial" font-size="9.00">GPU 60</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_3 -->
<g id="edge388" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.34,-840.86C4336.75,-838.13 1878.17,-823.14 1724,-777.34 1695.88,-768.98 1667.87,-752.96 1644.86,-737.19"/>
<polygon fill="black" stroke="black" points="1646.81,-734.29 1636.61,-731.41 1642.79,-740.02 1646.81,-734.29"/>
</g>
<!-- l3_route_4 -->
<g id="node340" class="node">
<title>l3_route_4</title>
<polygon fill="none" stroke="black" points="5179.32,-731.34 4981.55,-731.34 4930.68,-655.34 5128.45,-655.34 5179.32,-731.34"/>
<text text-anchor="middle" x="5055" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5055" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 4</text>
<text text-anchor="middle" x="5055" y="-681.14" font-family="Arial" font-size="9.00">GPU 64</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_4 -->
<g id="edge395" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4992.94,-804.24C5003.9,-784.83 5017.42,-760.89 5029.04,-740.31"/>
<polygon fill="black" stroke="black" points="5032.19,-741.85 5034.06,-731.42 5026.1,-738.41 5032.19,-741.85"/>
</g>
<!-- l3_route_5 -->
<g id="node346" class="node">
<title>l3_route_5</title>
<polygon fill="none" stroke="black" points="3005.32,-731.34 2807.55,-731.34 2756.68,-655.34 2954.45,-655.34 3005.32,-731.34"/>
<text text-anchor="middle" x="2881" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2881" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 5</text>
<text text-anchor="middle" x="2881" y="-681.14" font-family="Arial" font-size="9.00">GPU 68</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_5 -->
<g id="edge402" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.35,-841.1C4493.94,-839.81 3191.85,-831.44 3014,-777.34 2986.05,-768.84 2958.17,-752.88 2935.2,-737.21"/>
<polygon fill="black" stroke="black" points="2937.17,-734.31 2926.97,-731.46 2933.16,-740.05 2937.17,-734.31"/>
</g>
<!-- l3_route_6 -->
<g id="node352" class="node">
<title>l3_route_6</title>
<polygon fill="none" stroke="black" points="6481.32,-731.34 6283.55,-731.34 6232.68,-655.34 6430.45,-655.34 6481.32,-731.34"/>
<text text-anchor="middle" x="6357" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6357" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 6</text>
<text text-anchor="middle" x="6357" y="-681.14" font-family="Arial" font-size="9.00">GPU 72</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_6 -->
<g id="edge409" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.87,-817.25C5077.26,-812.05 5100.33,-807.24 5122,-804.34 5243.07,-788.12 6103.82,-811.83 6221,-777.34 6249.6,-768.92 6278.22,-752.88 6301.77,-737.13"/>
<polygon fill="black" stroke="black" points="6303.94,-739.89 6310.21,-731.35 6299.98,-734.11 6303.94,-739.89"/>
</g>
<!-- l3_route_7 -->
<g id="node358" class="node">
<title>l3_route_7</title>
<polygon fill="none" stroke="black" points="2145.32,-731.34 1947.55,-731.34 1896.68,-655.34 2094.45,-655.34 2145.32,-731.34"/>
<text text-anchor="middle" x="2021" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2021" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 7</text>
<text text-anchor="middle" x="2021" y="-681.14" font-family="Arial" font-size="9.00">GPU 76</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_7 -->
<g id="edge416" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.02,-840.53C4380.12,-836.48 2286.42,-816.9 2154,-777.34 2125.9,-768.94 2097.88,-752.91 2074.87,-737.15"/>
<polygon fill="black" stroke="black" points="2076.82,-734.25 2066.62,-731.37 2072.8,-739.98 2076.82,-734.25"/>
</g>
<!-- l3_route_8 -->
<g id="node364" class="node">
<title>l3_route_8</title>
<polygon fill="none" stroke="black" points="7360.32,-731.34 7162.55,-731.34 7111.68,-655.34 7309.45,-655.34 7360.32,-731.34"/>
<text text-anchor="middle" x="7236" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7236" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 8</text>
<text text-anchor="middle" x="7236" y="-681.14" font-family="Arial" font-size="9.00">GPU 80</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_8 -->
<g id="edge423" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.45,-817.16C5076.95,-811.92 5100.18,-807.12 5122,-804.34 5285.68,-783.44 6442.01,-788.84 6607,-786.34 6716.56,-784.67 6994.79,-807.95 7100,-777.34 7128.62,-769.01 7157.25,-752.99 7180.8,-737.22"/>
<polygon fill="black" stroke="black" points="7182.97,-739.98 7189.24,-731.44 7179.01,-734.2 7182.97,-739.98"/>
</g>
<!-- l3_route_9 -->
<g id="node370" class="node">
<title>l3_route_9</title>
<polygon fill="none" stroke="black" points="2575.32,-731.34 2377.55,-731.34 2326.68,-655.34 2524.45,-655.34 2575.32,-731.34"/>
<text text-anchor="middle" x="2451" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="2451" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 9</text>
<text text-anchor="middle" x="2451" y="-681.14" font-family="Arial" font-size="9.00">GPU 84</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_9 -->
<g id="edge430" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4870.65,-841.76C4443.88,-843.09 2804.78,-843.79 2584,-777.34 2556.03,-768.92 2528.14,-752.97 2505.17,-737.29"/>
<polygon fill="black" stroke="black" points="2507.14,-734.4 2496.94,-731.54 2503.13,-740.13 2507.14,-734.4"/>
</g>
<!-- l3_route_10 -->
<g id="node376" class="node">
<title>l3_route_10</title>
<polygon fill="none" stroke="black" points="3446.69,-731.34 3240.38,-731.34 3187.31,-655.34 3393.62,-655.34 3446.69,-731.34"/>
<text text-anchor="middle" x="3317" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="3317" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 10</text>
<text text-anchor="middle" x="3317" y="-681.14" font-family="Arial" font-size="9.00">GPU 88</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_10 -->
<g id="edge437" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4869.71,-839.93C4551.21,-835.14 3590.45,-817.5 3456,-777.34 3427.22,-768.74 3398.24,-752.86 3374.25,-737.27"/>
<polygon fill="black" stroke="black" points="3375.91,-734.17 3365.64,-731.55 3372.04,-740 3375.91,-734.17"/>
</g>
<!-- l3_route_11 -->
<g id="node382" class="node">
<title>l3_route_11</title>
<polygon fill="none" stroke="black" points="4748.69,-731.34 4542.38,-731.34 4489.31,-655.34 4695.62,-655.34 4748.69,-731.34"/>
<text text-anchor="middle" x="4619" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="4619" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 11</text>
<text text-anchor="middle" x="4619" y="-681.14" font-family="Arial" font-size="9.00">GPU 92</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_11 -->
<g id="edge444" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4849.58,-810.41C4819.13,-801.17 4786.93,-790.06 4758,-777.34 4732.45,-766.1 4705.8,-751.09 4682.76,-736.92"/>
<polygon fill="black" stroke="black" points="4684.45,-733.86 4674.11,-731.55 4680.76,-739.8 4684.45,-733.86"/>
</g>
<!-- l3_route_12 -->
<g id="node388" class="node">
<title>l3_route_12</title>
<polygon fill="none" stroke="black" points="5620.69,-731.34 5414.38,-731.34 5361.31,-655.34 5567.62,-655.34 5620.69,-731.34"/>
<text text-anchor="middle" x="5491" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="5491" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 12</text>
<text text-anchor="middle" x="5491" y="-681.14" font-family="Arial" font-size="9.00">GPU 96</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_12 -->
<g id="edge451" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5056.49,-818.56C5077.76,-813.36 5100.63,-808.23 5122,-804.34 5221.96,-786.14 5252.68,-809.65 5349,-777.34 5377.45,-767.79 5406.47,-752.1 5430.8,-736.91"/>
<polygon fill="black" stroke="black" points="5432.99,-739.67 5439.55,-731.35 5429.23,-733.76 5432.99,-739.67"/>
</g>
<!-- l3_route_13 -->
<g id="node394" class="node">
<title>l3_route_13</title>
<polygon fill="none" stroke="black" points="6922.69,-731.34 6716.38,-731.34 6663.31,-655.34 6869.62,-655.34 6922.69,-731.34"/>
<text text-anchor="middle" x="6793" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="6793" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 13</text>
<text text-anchor="middle" x="6793" y="-681.14" font-family="Arial" font-size="9.00">GPU 100</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_13 -->
<g id="edge458" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.86,-817.14C5077.25,-811.94 5100.32,-807.16 5122,-804.34 5290.49,-782.39 6487.42,-823.29 6651,-777.34 6680.76,-768.98 6710.73,-752.85 6735.43,-737.02"/>
<polygon fill="black" stroke="black" points="6737.49,-739.85 6743.93,-731.44 6733.65,-734 6737.49,-739.85"/>
</g>
<!-- l3_route_14 -->
<g id="node400" class="node">
<title>l3_route_14</title>
<polygon fill="none" stroke="black" points="7801.69,-731.34 7595.38,-731.34 7542.31,-655.34 7748.62,-655.34 7801.69,-731.34"/>
<text text-anchor="middle" x="7672" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="7672" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 14</text>
<text text-anchor="middle" x="7672" y="-681.14" font-family="Arial" font-size="9.00">GPU 104</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_14 -->
<g id="edge465" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.45,-817.13C5076.95,-811.9 5100.18,-807.11 5122,-804.34 5310.94,-780.37 6645.56,-788.57 6836,-786.34 6874.56,-785.89 7492.85,-787.66 7530,-777.34 7559.78,-769.07 7589.76,-752.95 7614.45,-737.1"/>
<polygon fill="black" stroke="black" points="7616.52,-739.94 7622.96,-731.52 7612.67,-734.08 7616.52,-739.94"/>
</g>
<!-- l3_route_15 -->
<g id="node406" class="node">
<title>l3_route_15</title>
<polygon fill="none" stroke="black" points="8250.69,-731.34 8044.38,-731.34 7991.31,-655.34 8197.62,-655.34 8250.69,-731.34"/>
<text text-anchor="middle" x="8121" y="-701.14" font-family="Arial" font-size="9.00">Token Routing</text>
<text text-anchor="middle" x="8121" y="-691.14" font-family="Arial" font-size="9.00">Select tokens for Expert 15</text>
<text text-anchor="middle" x="8121" y="-681.14" font-family="Arial" font-size="9.00">GPU 108</text>
</g>
<!-- l3_global_gate&#45;&gt;l3_route_15 -->
<g id="edge472" class="edge">
<title>l3_global_gate&#45;&gt;l3_route_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5055.45,-817.11C5076.95,-811.88 5100.18,-807.09 5122,-804.34 5279.48,-784.45 7825.99,-819.55 7979,-777.34 8008.92,-769.08 8039.03,-752.88 8063.77,-736.96"/>
<polygon fill="black" stroke="black" points="8065.86,-739.78 8072.29,-731.36 8062.01,-733.93 8065.86,-739.78"/>
</g>
<!-- l3_exp0_linear1 -->
<g id="node318" class="node">
<title>l3_exp0_linear1</title>
<polygon fill="none" stroke="black" points="4465,-618.34 4301,-618.34 4301,-580.34 4465,-580.34 4465,-618.34"/>
<text text-anchor="middle" x="4383" y="-607.14" font-family="Arial" font-size="9.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="4383" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4383" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l3_gather_0&#45;&gt;l3_exp0_linear1 -->
<g id="edge369" class="edge">
<title>l3_gather_0&#45;&gt;l3_exp0_linear1</title>
<path fill="none" stroke="black" d="M4391.59,-666.22C4390.05,-654.39 4388.22,-640.38 4386.65,-628.33"/>
<polygon fill="black" stroke="black" points="4390.11,-627.81 4385.35,-618.35 4383.17,-628.72 4390.11,-627.81"/>
</g>
<!-- l3_exp0_gelu -->
<g id="node319" class="node">
<title>l3_exp0_gelu</title>
<polygon fill="none" stroke="black" points="4426,-543.34 4340,-543.34 4340,-505.34 4426,-505.34 4426,-543.34"/>
<text text-anchor="middle" x="4383" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4383" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4383" y="-512.14" font-family="Arial" font-size="9.00">GPUs 48&#45;51</text>
</g>
<!-- l3_exp0_linear1&#45;&gt;l3_exp0_gelu -->
<g id="edge370" class="edge">
<title>l3_exp0_linear1&#45;&gt;l3_exp0_gelu</title>
<path fill="none" stroke="black" d="M4383,-580.29C4383,-572.22 4383,-562.51 4383,-553.52"/>
<polygon fill="black" stroke="black" points="4386.5,-553.43 4383,-543.43 4379.5,-553.43 4386.5,-553.43"/>
</g>
<!-- l3_exp0_linear2 -->
<g id="node320" class="node">
<title>l3_exp0_linear2</title>
<polygon fill="none" stroke="black" points="4465,-468.34 4301,-468.34 4301,-430.34 4465,-430.34 4465,-468.34"/>
<text text-anchor="middle" x="4383" y="-457.14" font-family="Arial" font-size="9.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="4383" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4383" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 48&#45;51</text>
</g>
<!-- l3_exp0_gelu&#45;&gt;l3_exp0_linear2 -->
<g id="edge371" class="edge">
<title>l3_exp0_gelu&#45;&gt;l3_exp0_linear2</title>
<path fill="none" stroke="black" d="M4383,-505.29C4383,-497.22 4383,-487.51 4383,-478.52"/>
<polygon fill="black" stroke="black" points="4386.5,-478.43 4383,-468.43 4379.5,-478.43 4386.5,-478.43"/>
</g>
<!-- l3_scatter_0 -->
<g id="node321" class="node">
<title>l3_scatter_0</title>
<ellipse fill="none" stroke="black" cx="4389" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4389" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4389" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4389" y="-354.27" font-family="Arial" font-size="9.00">GPU 48 → All GPUs</text>
</g>
<!-- l3_exp0_linear2&#45;&gt;l3_scatter_0 -->
<g id="edge372" class="edge">
<title>l3_exp0_linear2&#45;&gt;l3_scatter_0</title>
<path fill="none" stroke="black" d="M4384.36,-429.99C4384.94,-422.13 4385.65,-412.67 4386.33,-403.52"/>
<polygon fill="black" stroke="black" points="4389.83,-403.64 4387.08,-393.41 4382.84,-403.12 4389.83,-403.64"/>
</g>
<!-- l3_expert_agg -->
<g id="node412" class="node">
<title>l3_expert_agg</title>
<polygon fill="none" stroke="black" points="5385.76,-302.6 5177.75,-302.6 5124.24,-206.6 5332.25,-206.6 5385.76,-302.6"/>
<text text-anchor="middle" x="5255" y="-267.4" font-family="Arial" font-size="9.00">Expert Aggregation</text>
<text text-anchor="middle" x="5255" y="-257.4" font-family="Arial" font-size="9.00">Combine all expert outputs</text>
<text text-anchor="middle" x="5255" y="-247.4" font-family="Arial" font-size="9.00">[1024, 8192]</text>
<text text-anchor="middle" x="5255" y="-237.4" font-family="Arial" font-size="9.00">All GPUs</text>
</g>
<!-- l3_scatter_0&#45;&gt;l3_expert_agg -->
<g id="edge373" class="edge">
<title>l3_scatter_0&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M4433.48,-345.67C4447.19,-340.3 4462.5,-335.03 4477,-331.6 4709.05,-276.68 4989.08,-261.34 5141.9,-257.13"/>
<polygon fill="black" stroke="black" points="5142.33,-260.62 5152.23,-256.86 5142.14,-253.62 5142.33,-260.62"/>
</g>
<!-- l3_exp1_linear1 -->
<g id="node324" class="node">
<title>l3_exp1_linear1</title>
<polygon fill="none" stroke="black" points="6088,-618.34 5924,-618.34 5924,-580.34 6088,-580.34 6088,-618.34"/>
<text text-anchor="middle" x="6006" y="-607.14" font-family="Arial" font-size="9.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="6006" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6006" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l3_gather_1&#45;&gt;l3_exp1_linear1 -->
<g id="edge376" class="edge">
<title>l3_gather_1&#45;&gt;l3_exp1_linear1</title>
<path fill="none" stroke="black" d="M6106.12,-669.6C6086.2,-655.81 6060.81,-638.25 6040.59,-624.26"/>
<polygon fill="black" stroke="black" points="6042.48,-621.32 6032.27,-618.51 6038.5,-627.07 6042.48,-621.32"/>
</g>
<!-- l3_exp1_gelu -->
<g id="node325" class="node">
<title>l3_exp1_gelu</title>
<polygon fill="none" stroke="black" points="6033,-543.34 5947,-543.34 5947,-505.34 6033,-505.34 6033,-543.34"/>
<text text-anchor="middle" x="5990" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5990" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5990" y="-512.14" font-family="Arial" font-size="9.00">GPUs 52&#45;55</text>
</g>
<!-- l3_exp1_linear1&#45;&gt;l3_exp1_gelu -->
<g id="edge377" class="edge">
<title>l3_exp1_linear1&#45;&gt;l3_exp1_gelu</title>
<path fill="none" stroke="black" d="M6002.04,-580.29C6000.26,-572.13 5998.1,-562.3 5996.11,-553.23"/>
<polygon fill="black" stroke="black" points="5999.52,-552.45 5993.97,-543.43 5992.69,-553.95 5999.52,-552.45"/>
</g>
<!-- l3_exp1_linear2 -->
<g id="node326" class="node">
<title>l3_exp1_linear2</title>
<polygon fill="none" stroke="black" points="5997,-468.34 5833,-468.34 5833,-430.34 5997,-430.34 5997,-468.34"/>
<text text-anchor="middle" x="5915" y="-457.14" font-family="Arial" font-size="9.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="5915" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5915" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 52&#45;55</text>
</g>
<!-- l3_exp1_gelu&#45;&gt;l3_exp1_linear2 -->
<g id="edge378" class="edge">
<title>l3_exp1_gelu&#45;&gt;l3_exp1_linear2</title>
<path fill="none" stroke="black" d="M5971.46,-505.29C5962.27,-496.34 5951.01,-485.39 5940.97,-475.62"/>
<polygon fill="black" stroke="black" points="5943.19,-472.9 5933.59,-468.43 5938.31,-477.91 5943.19,-472.9"/>
</g>
<!-- l3_scatter_1 -->
<g id="node327" class="node">
<title>l3_scatter_1</title>
<ellipse fill="none" stroke="black" cx="5894" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5894" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5894" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5894" y="-354.27" font-family="Arial" font-size="9.00">GPU 52 → All GPUs</text>
</g>
<!-- l3_exp1_linear2&#45;&gt;l3_scatter_1 -->
<g id="edge379" class="edge">
<title>l3_exp1_linear2&#45;&gt;l3_scatter_1</title>
<path fill="none" stroke="black" d="M5910.23,-429.99C5908.17,-422.05 5905.69,-412.47 5903.28,-403.22"/>
<polygon fill="black" stroke="black" points="5906.64,-402.21 5900.74,-393.41 5899.86,-403.97 5906.64,-402.21"/>
</g>
<!-- l3_scatter_1&#45;&gt;l3_expert_agg -->
<g id="edge380" class="edge">
<title>l3_scatter_1&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M5844.73,-347.3C5827.88,-341.62 5808.78,-335.75 5791,-331.6 5649.99,-298.69 5484.57,-277.86 5375.2,-266.5"/>
<polygon fill="black" stroke="black" points="5375.43,-263 5365.12,-265.46 5374.71,-269.97 5375.43,-263"/>
</g>
<!-- l3_exp2_linear1 -->
<g id="node330" class="node">
<title>l3_exp2_linear1</title>
<polygon fill="none" stroke="black" points="4035,-618.34 3871,-618.34 3871,-580.34 4035,-580.34 4035,-618.34"/>
<text text-anchor="middle" x="3953" y="-607.14" font-family="Arial" font-size="9.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="3953" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3953" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l3_gather_2&#45;&gt;l3_exp2_linear1 -->
<g id="edge383" class="edge">
<title>l3_gather_2&#45;&gt;l3_exp2_linear1</title>
<path fill="none" stroke="black" d="M3961.59,-666.22C3960.05,-654.39 3958.22,-640.38 3956.65,-628.33"/>
<polygon fill="black" stroke="black" points="3960.11,-627.81 3955.35,-618.35 3953.17,-628.72 3960.11,-627.81"/>
</g>
<!-- l3_exp2_gelu -->
<g id="node331" class="node">
<title>l3_exp2_gelu</title>
<polygon fill="none" stroke="black" points="3996,-543.34 3910,-543.34 3910,-505.34 3996,-505.34 3996,-543.34"/>
<text text-anchor="middle" x="3953" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3953" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3953" y="-512.14" font-family="Arial" font-size="9.00">GPUs 56&#45;59</text>
</g>
<!-- l3_exp2_linear1&#45;&gt;l3_exp2_gelu -->
<g id="edge384" class="edge">
<title>l3_exp2_linear1&#45;&gt;l3_exp2_gelu</title>
<path fill="none" stroke="black" d="M3953,-580.29C3953,-572.22 3953,-562.51 3953,-553.52"/>
<polygon fill="black" stroke="black" points="3956.5,-553.43 3953,-543.43 3949.5,-553.43 3956.5,-553.43"/>
</g>
<!-- l3_exp2_linear2 -->
<g id="node332" class="node">
<title>l3_exp2_linear2</title>
<polygon fill="none" stroke="black" points="4035,-468.34 3871,-468.34 3871,-430.34 4035,-430.34 4035,-468.34"/>
<text text-anchor="middle" x="3953" y="-457.14" font-family="Arial" font-size="9.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="3953" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3953" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 56&#45;59</text>
</g>
<!-- l3_exp2_gelu&#45;&gt;l3_exp2_linear2 -->
<g id="edge385" class="edge">
<title>l3_exp2_gelu&#45;&gt;l3_exp2_linear2</title>
<path fill="none" stroke="black" d="M3953,-505.29C3953,-497.22 3953,-487.51 3953,-478.52"/>
<polygon fill="black" stroke="black" points="3956.5,-478.43 3953,-468.43 3949.5,-478.43 3956.5,-478.43"/>
</g>
<!-- l3_scatter_2 -->
<g id="node333" class="node">
<title>l3_scatter_2</title>
<ellipse fill="none" stroke="black" cx="3959" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3959" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3959" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3959" y="-354.27" font-family="Arial" font-size="9.00">GPU 56 → All GPUs</text>
</g>
<!-- l3_exp2_linear2&#45;&gt;l3_scatter_2 -->
<g id="edge386" class="edge">
<title>l3_exp2_linear2&#45;&gt;l3_scatter_2</title>
<path fill="none" stroke="black" d="M3954.36,-429.99C3954.94,-422.13 3955.65,-412.67 3956.33,-403.52"/>
<polygon fill="black" stroke="black" points="3959.83,-403.64 3957.08,-393.41 3952.84,-403.12 3959.83,-403.64"/>
</g>
<!-- l3_scatter_2&#45;&gt;l3_expert_agg -->
<g id="edge387" class="edge">
<title>l3_scatter_2&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M4002.96,-345.54C4016.78,-340.09 4032.29,-334.81 4047,-331.6 4253.89,-286.39 4883.83,-265.26 5142.41,-258.31"/>
<polygon fill="black" stroke="black" points="5142.67,-261.81 5152.57,-258.04 5142.48,-254.81 5142.67,-261.81"/>
</g>
<!-- l3_exp3_linear1 -->
<g id="node336" class="node">
<title>l3_exp3_linear1</title>
<polygon fill="none" stroke="black" points="1873,-618.34 1709,-618.34 1709,-580.34 1873,-580.34 1873,-618.34"/>
<text text-anchor="middle" x="1791" y="-607.14" font-family="Arial" font-size="9.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1791" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="1791" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l3_gather_3&#45;&gt;l3_exp3_linear1 -->
<g id="edge390" class="edge">
<title>l3_gather_3&#45;&gt;l3_exp3_linear1</title>
<path fill="none" stroke="black" d="M1799.59,-666.22C1798.05,-654.39 1796.22,-640.38 1794.65,-628.33"/>
<polygon fill="black" stroke="black" points="1798.11,-627.81 1793.35,-618.35 1791.17,-628.72 1798.11,-627.81"/>
</g>
<!-- l3_exp3_gelu -->
<g id="node337" class="node">
<title>l3_exp3_gelu</title>
<polygon fill="none" stroke="black" points="1834,-543.34 1748,-543.34 1748,-505.34 1834,-505.34 1834,-543.34"/>
<text text-anchor="middle" x="1791" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="1791" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="1791" y="-512.14" font-family="Arial" font-size="9.00">GPUs 60&#45;63</text>
</g>
<!-- l3_exp3_linear1&#45;&gt;l3_exp3_gelu -->
<g id="edge391" class="edge">
<title>l3_exp3_linear1&#45;&gt;l3_exp3_gelu</title>
<path fill="none" stroke="black" d="M1791,-580.29C1791,-572.22 1791,-562.51 1791,-553.52"/>
<polygon fill="black" stroke="black" points="1794.5,-553.43 1791,-543.43 1787.5,-553.43 1794.5,-553.43"/>
</g>
<!-- l3_exp3_linear2 -->
<g id="node338" class="node">
<title>l3_exp3_linear2</title>
<polygon fill="none" stroke="black" points="1873,-468.34 1709,-468.34 1709,-430.34 1873,-430.34 1873,-468.34"/>
<text text-anchor="middle" x="1791" y="-457.14" font-family="Arial" font-size="9.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1791" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="1791" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 60&#45;63</text>
</g>
<!-- l3_exp3_gelu&#45;&gt;l3_exp3_linear2 -->
<g id="edge392" class="edge">
<title>l3_exp3_gelu&#45;&gt;l3_exp3_linear2</title>
<path fill="none" stroke="black" d="M1791,-505.29C1791,-497.22 1791,-487.51 1791,-478.52"/>
<polygon fill="black" stroke="black" points="1794.5,-478.43 1791,-468.43 1787.5,-478.43 1794.5,-478.43"/>
</g>
<!-- l3_scatter_3 -->
<g id="node339" class="node">
<title>l3_scatter_3</title>
<ellipse fill="none" stroke="black" cx="1797" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="1797" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="1797" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="1797" y="-354.27" font-family="Arial" font-size="9.00">GPU 60 → All GPUs</text>
</g>
<!-- l3_exp3_linear2&#45;&gt;l3_scatter_3 -->
<g id="edge393" class="edge">
<title>l3_exp3_linear2&#45;&gt;l3_scatter_3</title>
<path fill="none" stroke="black" d="M1792.36,-429.99C1792.94,-422.13 1793.65,-412.67 1794.33,-403.52"/>
<polygon fill="black" stroke="black" points="1797.83,-403.64 1795.08,-393.41 1790.84,-403.12 1797.83,-403.64"/>
</g>
<!-- l3_scatter_3&#45;&gt;l3_expert_agg -->
<g id="edge394" class="edge">
<title>l3_scatter_3&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M1840.43,-345.35C1854.37,-339.82 1870.06,-334.55 1885,-331.6 2209.55,-267.5 4589.95,-257.34 5141.24,-255.84"/>
<polygon fill="black" stroke="black" points="5141.59,-259.34 5151.58,-255.82 5141.57,-252.34 5141.59,-259.34"/>
</g>
<!-- l3_exp4_linear1 -->
<g id="node342" class="node">
<title>l3_exp4_linear1</title>
<polygon fill="none" stroke="black" points="5337,-618.34 5173,-618.34 5173,-580.34 5337,-580.34 5337,-618.34"/>
<text text-anchor="middle" x="5255" y="-607.14" font-family="Arial" font-size="9.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="5255" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5255" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l3_gather_4&#45;&gt;l3_exp4_linear1 -->
<g id="edge397" class="edge">
<title>l3_gather_4&#45;&gt;l3_exp4_linear1</title>
<path fill="none" stroke="black" d="M5263.59,-666.22C5262.05,-654.39 5260.22,-640.38 5258.65,-628.33"/>
<polygon fill="black" stroke="black" points="5262.11,-627.81 5257.35,-618.35 5255.17,-628.72 5262.11,-627.81"/>
</g>
<!-- l3_exp4_gelu -->
<g id="node343" class="node">
<title>l3_exp4_gelu</title>
<polygon fill="none" stroke="black" points="5298,-543.34 5212,-543.34 5212,-505.34 5298,-505.34 5298,-543.34"/>
<text text-anchor="middle" x="5255" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5255" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5255" y="-512.14" font-family="Arial" font-size="9.00">GPUs 64&#45;67</text>
</g>
<!-- l3_exp4_linear1&#45;&gt;l3_exp4_gelu -->
<g id="edge398" class="edge">
<title>l3_exp4_linear1&#45;&gt;l3_exp4_gelu</title>
<path fill="none" stroke="black" d="M5255,-580.29C5255,-572.22 5255,-562.51 5255,-553.52"/>
<polygon fill="black" stroke="black" points="5258.5,-553.43 5255,-543.43 5251.5,-553.43 5258.5,-553.43"/>
</g>
<!-- l3_exp4_linear2 -->
<g id="node344" class="node">
<title>l3_exp4_linear2</title>
<polygon fill="none" stroke="black" points="5337,-468.34 5173,-468.34 5173,-430.34 5337,-430.34 5337,-468.34"/>
<text text-anchor="middle" x="5255" y="-457.14" font-family="Arial" font-size="9.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="5255" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5255" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 64&#45;67</text>
</g>
<!-- l3_exp4_gelu&#45;&gt;l3_exp4_linear2 -->
<g id="edge399" class="edge">
<title>l3_exp4_gelu&#45;&gt;l3_exp4_linear2</title>
<path fill="none" stroke="black" d="M5255,-505.29C5255,-497.22 5255,-487.51 5255,-478.52"/>
<polygon fill="black" stroke="black" points="5258.5,-478.43 5255,-468.43 5251.5,-478.43 5258.5,-478.43"/>
</g>
<!-- l3_scatter_4 -->
<g id="node345" class="node">
<title>l3_scatter_4</title>
<ellipse fill="none" stroke="black" cx="5255" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5255" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5255" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5255" y="-354.27" font-family="Arial" font-size="9.00">GPU 64 → All GPUs</text>
</g>
<!-- l3_exp4_linear2&#45;&gt;l3_scatter_4 -->
<g id="edge400" class="edge">
<title>l3_exp4_linear2&#45;&gt;l3_scatter_4</title>
<path fill="none" stroke="black" d="M5255,-429.99C5255,-422.13 5255,-412.67 5255,-403.52"/>
<polygon fill="black" stroke="black" points="5258.5,-403.41 5255,-393.41 5251.5,-403.41 5258.5,-403.41"/>
</g>
<!-- l3_scatter_4&#45;&gt;l3_expert_agg -->
<g id="edge401" class="edge">
<title>l3_scatter_4&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M5255,-339.43C5255,-331.41 5255,-322.25 5255,-313"/>
<polygon fill="black" stroke="black" points="5258.5,-312.96 5255,-302.97 5251.5,-312.97 5258.5,-312.96"/>
</g>
<!-- l3_exp5_linear1 -->
<g id="node348" class="node">
<title>l3_exp5_linear1</title>
<polygon fill="none" stroke="black" points="3163,-618.34 2999,-618.34 2999,-580.34 3163,-580.34 3163,-618.34"/>
<text text-anchor="middle" x="3081" y="-607.14" font-family="Arial" font-size="9.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="3081" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3081" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l3_gather_5&#45;&gt;l3_exp5_linear1 -->
<g id="edge404" class="edge">
<title>l3_gather_5&#45;&gt;l3_exp5_linear1</title>
<path fill="none" stroke="black" d="M3089.59,-666.22C3088.05,-654.39 3086.22,-640.38 3084.65,-628.33"/>
<polygon fill="black" stroke="black" points="3088.11,-627.81 3083.35,-618.35 3081.17,-628.72 3088.11,-627.81"/>
</g>
<!-- l3_exp5_gelu -->
<g id="node349" class="node">
<title>l3_exp5_gelu</title>
<polygon fill="none" stroke="black" points="3124,-543.34 3038,-543.34 3038,-505.34 3124,-505.34 3124,-543.34"/>
<text text-anchor="middle" x="3081" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3081" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3081" y="-512.14" font-family="Arial" font-size="9.00">GPUs 68&#45;71</text>
</g>
<!-- l3_exp5_linear1&#45;&gt;l3_exp5_gelu -->
<g id="edge405" class="edge">
<title>l3_exp5_linear1&#45;&gt;l3_exp5_gelu</title>
<path fill="none" stroke="black" d="M3081,-580.29C3081,-572.22 3081,-562.51 3081,-553.52"/>
<polygon fill="black" stroke="black" points="3084.5,-553.43 3081,-543.43 3077.5,-553.43 3084.5,-553.43"/>
</g>
<!-- l3_exp5_linear2 -->
<g id="node350" class="node">
<title>l3_exp5_linear2</title>
<polygon fill="none" stroke="black" points="3163,-468.34 2999,-468.34 2999,-430.34 3163,-430.34 3163,-468.34"/>
<text text-anchor="middle" x="3081" y="-457.14" font-family="Arial" font-size="9.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="3081" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3081" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 68&#45;71</text>
</g>
<!-- l3_exp5_gelu&#45;&gt;l3_exp5_linear2 -->
<g id="edge406" class="edge">
<title>l3_exp5_gelu&#45;&gt;l3_exp5_linear2</title>
<path fill="none" stroke="black" d="M3081,-505.29C3081,-497.22 3081,-487.51 3081,-478.52"/>
<polygon fill="black" stroke="black" points="3084.5,-478.43 3081,-468.43 3077.5,-478.43 3084.5,-478.43"/>
</g>
<!-- l3_scatter_5 -->
<g id="node351" class="node">
<title>l3_scatter_5</title>
<ellipse fill="none" stroke="black" cx="3087" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3087" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3087" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3087" y="-354.27" font-family="Arial" font-size="9.00">GPU 68 → All GPUs</text>
</g>
<!-- l3_exp5_linear2&#45;&gt;l3_scatter_5 -->
<g id="edge407" class="edge">
<title>l3_exp5_linear2&#45;&gt;l3_scatter_5</title>
<path fill="none" stroke="black" d="M3082.36,-429.99C3082.94,-422.13 3083.65,-412.67 3084.33,-403.52"/>
<polygon fill="black" stroke="black" points="3087.83,-403.64 3085.08,-393.41 3080.84,-403.12 3087.83,-403.64"/>
</g>
<!-- l3_scatter_5&#45;&gt;l3_expert_agg -->
<g id="edge408" class="edge">
<title>l3_scatter_5&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M3130.91,-345.3C3144.73,-339.84 3160.25,-334.62 3175,-331.6 3367.66,-292.15 4736.66,-264.84 5142.12,-257.54"/>
<polygon fill="black" stroke="black" points="5142.45,-261.04 5152.39,-257.36 5142.33,-254.04 5142.45,-261.04"/>
</g>
<!-- l3_exp6_linear1 -->
<g id="node354" class="node">
<title>l3_exp6_linear1</title>
<polygon fill="none" stroke="black" points="6631,-618.34 6467,-618.34 6467,-580.34 6631,-580.34 6631,-618.34"/>
<text text-anchor="middle" x="6549" y="-607.14" font-family="Arial" font-size="9.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="6549" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6549" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l3_gather_6&#45;&gt;l3_exp6_linear1 -->
<g id="edge411" class="edge">
<title>l3_gather_6&#45;&gt;l3_exp6_linear1</title>
<path fill="none" stroke="black" d="M6563.32,-666.22C6560.75,-654.39 6557.7,-640.38 6555.09,-628.33"/>
<polygon fill="black" stroke="black" points="6558.46,-627.38 6552.92,-618.35 6551.62,-628.87 6558.46,-627.38"/>
</g>
<!-- l3_exp6_gelu -->
<g id="node355" class="node">
<title>l3_exp6_gelu</title>
<polygon fill="none" stroke="black" points="6463,-543.34 6377,-543.34 6377,-505.34 6463,-505.34 6463,-543.34"/>
<text text-anchor="middle" x="6420" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6420" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6420" y="-512.14" font-family="Arial" font-size="9.00">GPUs 72&#45;75</text>
</g>
<!-- l3_exp6_linear1&#45;&gt;l3_exp6_gelu -->
<g id="edge412" class="edge">
<title>l3_exp6_linear1&#45;&gt;l3_exp6_gelu</title>
<path fill="none" stroke="black" d="M6517.11,-580.29C6500.21,-570.73 6479.26,-558.87 6461.14,-548.62"/>
<polygon fill="black" stroke="black" points="6462.39,-545.31 6451.97,-543.43 6458.95,-551.4 6462.39,-545.31"/>
</g>
<!-- l3_exp6_linear2 -->
<g id="node356" class="node">
<title>l3_exp6_linear2</title>
<polygon fill="none" stroke="black" points="6427,-468.34 6263,-468.34 6263,-430.34 6427,-430.34 6427,-468.34"/>
<text text-anchor="middle" x="6345" y="-457.14" font-family="Arial" font-size="9.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="6345" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6345" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 72&#45;75</text>
</g>
<!-- l3_exp6_gelu&#45;&gt;l3_exp6_linear2 -->
<g id="edge413" class="edge">
<title>l3_exp6_gelu&#45;&gt;l3_exp6_linear2</title>
<path fill="none" stroke="black" d="M6401.46,-505.29C6392.27,-496.34 6381.01,-485.39 6370.97,-475.62"/>
<polygon fill="black" stroke="black" points="6373.19,-472.9 6363.59,-468.43 6368.31,-477.91 6373.19,-472.9"/>
</g>
<!-- l3_scatter_6 -->
<g id="node357" class="node">
<title>l3_scatter_6</title>
<ellipse fill="none" stroke="black" cx="6324" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="6324" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6324" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6324" y="-354.27" font-family="Arial" font-size="9.00">GPU 72 → All GPUs</text>
</g>
<!-- l3_exp6_linear2&#45;&gt;l3_scatter_6 -->
<g id="edge414" class="edge">
<title>l3_exp6_linear2&#45;&gt;l3_scatter_6</title>
<path fill="none" stroke="black" d="M6340.23,-429.99C6338.17,-422.05 6335.69,-412.47 6333.28,-403.22"/>
<polygon fill="black" stroke="black" points="6336.64,-402.21 6330.74,-393.41 6329.86,-403.97 6336.64,-402.21"/>
</g>
<!-- l3_scatter_6&#45;&gt;l3_expert_agg -->
<g id="edge415" class="edge">
<title>l3_scatter_6&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M6275.65,-346.93C6258.62,-341.1 6239.18,-335.25 6221,-331.6 5917.89,-270.75 5552.15,-258.1 5369.9,-255.8"/>
<polygon fill="black" stroke="black" points="5369.81,-252.3 5359.77,-255.68 5369.72,-259.3 5369.81,-252.3"/>
</g>
<!-- l3_exp7_linear1 -->
<g id="node360" class="node">
<title>l3_exp7_linear1</title>
<polygon fill="none" stroke="black" points="2303,-618.34 2139,-618.34 2139,-580.34 2303,-580.34 2303,-618.34"/>
<text text-anchor="middle" x="2221" y="-607.14" font-family="Arial" font-size="9.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2221" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2221" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l3_gather_7&#45;&gt;l3_exp7_linear1 -->
<g id="edge418" class="edge">
<title>l3_gather_7&#45;&gt;l3_exp7_linear1</title>
<path fill="none" stroke="black" d="M2229.59,-666.22C2228.05,-654.39 2226.22,-640.38 2224.65,-628.33"/>
<polygon fill="black" stroke="black" points="2228.11,-627.81 2223.35,-618.35 2221.17,-628.72 2228.11,-627.81"/>
</g>
<!-- l3_exp7_gelu -->
<g id="node361" class="node">
<title>l3_exp7_gelu</title>
<polygon fill="none" stroke="black" points="2264,-543.34 2178,-543.34 2178,-505.34 2264,-505.34 2264,-543.34"/>
<text text-anchor="middle" x="2221" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2221" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2221" y="-512.14" font-family="Arial" font-size="9.00">GPUs 76&#45;79</text>
</g>
<!-- l3_exp7_linear1&#45;&gt;l3_exp7_gelu -->
<g id="edge419" class="edge">
<title>l3_exp7_linear1&#45;&gt;l3_exp7_gelu</title>
<path fill="none" stroke="black" d="M2221,-580.29C2221,-572.22 2221,-562.51 2221,-553.52"/>
<polygon fill="black" stroke="black" points="2224.5,-553.43 2221,-543.43 2217.5,-553.43 2224.5,-553.43"/>
</g>
<!-- l3_exp7_linear2 -->
<g id="node362" class="node">
<title>l3_exp7_linear2</title>
<polygon fill="none" stroke="black" points="2303,-468.34 2139,-468.34 2139,-430.34 2303,-430.34 2303,-468.34"/>
<text text-anchor="middle" x="2221" y="-457.14" font-family="Arial" font-size="9.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2221" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2221" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 76&#45;79</text>
</g>
<!-- l3_exp7_gelu&#45;&gt;l3_exp7_linear2 -->
<g id="edge420" class="edge">
<title>l3_exp7_gelu&#45;&gt;l3_exp7_linear2</title>
<path fill="none" stroke="black" d="M2221,-505.29C2221,-497.22 2221,-487.51 2221,-478.52"/>
<polygon fill="black" stroke="black" points="2224.5,-478.43 2221,-468.43 2217.5,-478.43 2224.5,-478.43"/>
</g>
<!-- l3_scatter_7 -->
<g id="node363" class="node">
<title>l3_scatter_7</title>
<ellipse fill="none" stroke="black" cx="2227" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2227" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2227" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2227" y="-354.27" font-family="Arial" font-size="9.00">GPU 76 → All GPUs</text>
</g>
<!-- l3_exp7_linear2&#45;&gt;l3_scatter_7 -->
<g id="edge421" class="edge">
<title>l3_exp7_linear2&#45;&gt;l3_scatter_7</title>
<path fill="none" stroke="black" d="M2222.36,-429.99C2222.94,-422.13 2223.65,-412.67 2224.33,-403.52"/>
<polygon fill="black" stroke="black" points="2227.83,-403.64 2225.08,-393.41 2220.84,-403.12 2227.83,-403.64"/>
</g>
<!-- l3_scatter_7&#45;&gt;l3_expert_agg -->
<g id="edge422" class="edge">
<title>l3_scatter_7&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M2270.44,-345.38C2284.37,-339.86 2300.07,-334.57 2315,-331.6 2595.37,-275.75 4635.29,-259.45 5141.54,-256.25"/>
<polygon fill="black" stroke="black" points="5141.79,-259.75 5151.77,-256.18 5141.75,-252.75 5141.79,-259.75"/>
</g>
<!-- l3_exp8_linear1 -->
<g id="node366" class="node">
<title>l3_exp8_linear1</title>
<polygon fill="none" stroke="black" points="7510,-618.34 7346,-618.34 7346,-580.34 7510,-580.34 7510,-618.34"/>
<text text-anchor="middle" x="7428" y="-607.14" font-family="Arial" font-size="9.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="7428" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7428" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 80&#45;83</text>
</g>
<!-- l3_gather_8&#45;&gt;l3_exp8_linear1 -->
<g id="edge425" class="edge">
<title>l3_gather_8&#45;&gt;l3_exp8_linear1</title>
<path fill="none" stroke="black" d="M7442.32,-666.22C7439.75,-654.39 7436.7,-640.38 7434.09,-628.33"/>
<polygon fill="black" stroke="black" points="7437.46,-627.38 7431.92,-618.35 7430.62,-628.87 7437.46,-627.38"/>
</g>
<!-- l3_exp8_gelu -->
<g id="node367" class="node">
<title>l3_exp8_gelu</title>
<polygon fill="none" stroke="black" points="7342,-543.34 7256,-543.34 7256,-505.34 7342,-505.34 7342,-543.34"/>
<text text-anchor="middle" x="7299" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7299" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7299" y="-512.14" font-family="Arial" font-size="9.00">GPUs 80&#45;83</text>
</g>
<!-- l3_exp8_linear1&#45;&gt;l3_exp8_gelu -->
<g id="edge426" class="edge">
<title>l3_exp8_linear1&#45;&gt;l3_exp8_gelu</title>
<path fill="none" stroke="black" d="M7396.11,-580.29C7379.21,-570.73 7358.26,-558.87 7340.14,-548.62"/>
<polygon fill="black" stroke="black" points="7341.39,-545.31 7330.97,-543.43 7337.95,-551.4 7341.39,-545.31"/>
</g>
<!-- l3_exp8_linear2 -->
<g id="node368" class="node">
<title>l3_exp8_linear2</title>
<polygon fill="none" stroke="black" points="7306,-468.34 7142,-468.34 7142,-430.34 7306,-430.34 7306,-468.34"/>
<text text-anchor="middle" x="7224" y="-457.14" font-family="Arial" font-size="9.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="7224" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7224" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 80&#45;83</text>
</g>
<!-- l3_exp8_gelu&#45;&gt;l3_exp8_linear2 -->
<g id="edge427" class="edge">
<title>l3_exp8_gelu&#45;&gt;l3_exp8_linear2</title>
<path fill="none" stroke="black" d="M7280.46,-505.29C7271.27,-496.34 7260.01,-485.39 7249.97,-475.62"/>
<polygon fill="black" stroke="black" points="7252.19,-472.9 7242.59,-468.43 7247.31,-477.91 7252.19,-472.9"/>
</g>
<!-- l3_scatter_8 -->
<g id="node369" class="node">
<title>l3_scatter_8</title>
<ellipse fill="none" stroke="black" cx="7203" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="7203" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7203" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7203" y="-354.27" font-family="Arial" font-size="9.00">GPU 80 → All GPUs</text>
</g>
<!-- l3_exp8_linear2&#45;&gt;l3_scatter_8 -->
<g id="edge428" class="edge">
<title>l3_exp8_linear2&#45;&gt;l3_scatter_8</title>
<path fill="none" stroke="black" d="M7219.23,-429.99C7217.17,-422.05 7214.69,-412.47 7212.28,-403.22"/>
<polygon fill="black" stroke="black" points="7215.64,-402.21 7209.74,-393.41 7208.86,-403.97 7215.64,-402.21"/>
</g>
<!-- l3_scatter_8&#45;&gt;l3_expert_agg -->
<g id="edge429" class="edge">
<title>l3_scatter_8&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M7155.25,-346.72C7138.09,-340.8 7118.43,-334.94 7100,-331.6 6765.68,-270.96 5720.05,-258.63 5370.28,-256.19"/>
<polygon fill="black" stroke="black" points="5370.16,-252.69 5360.14,-256.12 5370.11,-259.69 5370.16,-252.69"/>
</g>
<!-- l3_exp9_linear1 -->
<g id="node372" class="node">
<title>l3_exp9_linear1</title>
<polygon fill="none" stroke="black" points="2733,-618.34 2569,-618.34 2569,-580.34 2733,-580.34 2733,-618.34"/>
<text text-anchor="middle" x="2651" y="-607.14" font-family="Arial" font-size="9.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2651" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="2651" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 84&#45;87</text>
</g>
<!-- l3_gather_9&#45;&gt;l3_exp9_linear1 -->
<g id="edge432" class="edge">
<title>l3_gather_9&#45;&gt;l3_exp9_linear1</title>
<path fill="none" stroke="black" d="M2659.59,-666.22C2658.05,-654.39 2656.22,-640.38 2654.65,-628.33"/>
<polygon fill="black" stroke="black" points="2658.11,-627.81 2653.35,-618.35 2651.17,-628.72 2658.11,-627.81"/>
</g>
<!-- l3_exp9_gelu -->
<g id="node373" class="node">
<title>l3_exp9_gelu</title>
<polygon fill="none" stroke="black" points="2694,-543.34 2608,-543.34 2608,-505.34 2694,-505.34 2694,-543.34"/>
<text text-anchor="middle" x="2651" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="2651" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="2651" y="-512.14" font-family="Arial" font-size="9.00">GPUs 84&#45;87</text>
</g>
<!-- l3_exp9_linear1&#45;&gt;l3_exp9_gelu -->
<g id="edge433" class="edge">
<title>l3_exp9_linear1&#45;&gt;l3_exp9_gelu</title>
<path fill="none" stroke="black" d="M2651,-580.29C2651,-572.22 2651,-562.51 2651,-553.52"/>
<polygon fill="black" stroke="black" points="2654.5,-553.43 2651,-543.43 2647.5,-553.43 2654.5,-553.43"/>
</g>
<!-- l3_exp9_linear2 -->
<g id="node374" class="node">
<title>l3_exp9_linear2</title>
<polygon fill="none" stroke="black" points="2733,-468.34 2569,-468.34 2569,-430.34 2733,-430.34 2733,-468.34"/>
<text text-anchor="middle" x="2651" y="-457.14" font-family="Arial" font-size="9.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2651" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="2651" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 84&#45;87</text>
</g>
<!-- l3_exp9_gelu&#45;&gt;l3_exp9_linear2 -->
<g id="edge434" class="edge">
<title>l3_exp9_gelu&#45;&gt;l3_exp9_linear2</title>
<path fill="none" stroke="black" d="M2651,-505.29C2651,-497.22 2651,-487.51 2651,-478.52"/>
<polygon fill="black" stroke="black" points="2654.5,-478.43 2651,-468.43 2647.5,-478.43 2654.5,-478.43"/>
</g>
<!-- l3_scatter_9 -->
<g id="node375" class="node">
<title>l3_scatter_9</title>
<ellipse fill="none" stroke="black" cx="2657" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="2657" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="2657" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="2657" y="-354.27" font-family="Arial" font-size="9.00">GPU 84 → All GPUs</text>
</g>
<!-- l3_exp9_linear2&#45;&gt;l3_scatter_9 -->
<g id="edge435" class="edge">
<title>l3_exp9_linear2&#45;&gt;l3_scatter_9</title>
<path fill="none" stroke="black" d="M2652.36,-429.99C2652.94,-422.13 2653.65,-412.67 2654.33,-403.52"/>
<polygon fill="black" stroke="black" points="2657.83,-403.64 2655.08,-393.41 2650.84,-403.12 2657.83,-403.64"/>
</g>
<!-- l3_scatter_9&#45;&gt;l3_expert_agg -->
<g id="edge436" class="edge">
<title>l3_scatter_9&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M2700.9,-345.24C2714.72,-339.78 2730.24,-334.57 2745,-331.6 2981.39,-283.96 4684,-261.9 5141.88,-256.79"/>
<polygon fill="black" stroke="black" points="5142.17,-260.28 5152.13,-256.67 5142.1,-253.28 5142.17,-260.28"/>
</g>
<!-- l3_exp10_linear1 -->
<g id="node378" class="node">
<title>l3_exp10_linear1</title>
<polygon fill="none" stroke="black" points="3605,-618.34 3441,-618.34 3441,-580.34 3605,-580.34 3605,-618.34"/>
<text text-anchor="middle" x="3523" y="-607.14" font-family="Arial" font-size="9.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3523" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="3523" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 88&#45;91</text>
</g>
<!-- l3_gather_10&#45;&gt;l3_exp10_linear1 -->
<g id="edge439" class="edge">
<title>l3_gather_10&#45;&gt;l3_exp10_linear1</title>
<path fill="none" stroke="black" d="M3531.59,-666.22C3530.05,-654.39 3528.22,-640.38 3526.65,-628.33"/>
<polygon fill="black" stroke="black" points="3530.11,-627.81 3525.35,-618.35 3523.17,-628.72 3530.11,-627.81"/>
</g>
<!-- l3_exp10_gelu -->
<g id="node379" class="node">
<title>l3_exp10_gelu</title>
<polygon fill="none" stroke="black" points="3566,-543.34 3480,-543.34 3480,-505.34 3566,-505.34 3566,-543.34"/>
<text text-anchor="middle" x="3523" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="3523" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="3523" y="-512.14" font-family="Arial" font-size="9.00">GPUs 88&#45;91</text>
</g>
<!-- l3_exp10_linear1&#45;&gt;l3_exp10_gelu -->
<g id="edge440" class="edge">
<title>l3_exp10_linear1&#45;&gt;l3_exp10_gelu</title>
<path fill="none" stroke="black" d="M3523,-580.29C3523,-572.22 3523,-562.51 3523,-553.52"/>
<polygon fill="black" stroke="black" points="3526.5,-553.43 3523,-543.43 3519.5,-553.43 3526.5,-553.43"/>
</g>
<!-- l3_exp10_linear2 -->
<g id="node380" class="node">
<title>l3_exp10_linear2</title>
<polygon fill="none" stroke="black" points="3605,-468.34 3441,-468.34 3441,-430.34 3605,-430.34 3605,-468.34"/>
<text text-anchor="middle" x="3523" y="-457.14" font-family="Arial" font-size="9.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3523" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="3523" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 88&#45;91</text>
</g>
<!-- l3_exp10_gelu&#45;&gt;l3_exp10_linear2 -->
<g id="edge441" class="edge">
<title>l3_exp10_gelu&#45;&gt;l3_exp10_linear2</title>
<path fill="none" stroke="black" d="M3523,-505.29C3523,-497.22 3523,-487.51 3523,-478.52"/>
<polygon fill="black" stroke="black" points="3526.5,-478.43 3523,-468.43 3519.5,-478.43 3526.5,-478.43"/>
</g>
<!-- l3_scatter_10 -->
<g id="node381" class="node">
<title>l3_scatter_10</title>
<ellipse fill="none" stroke="black" cx="3529" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="3529" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="3529" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="3529" y="-354.27" font-family="Arial" font-size="9.00">GPU 88 → All GPUs</text>
</g>
<!-- l3_exp10_linear2&#45;&gt;l3_scatter_10 -->
<g id="edge442" class="edge">
<title>l3_exp10_linear2&#45;&gt;l3_scatter_10</title>
<path fill="none" stroke="black" d="M3524.36,-429.99C3524.94,-422.13 3525.65,-412.67 3526.33,-403.52"/>
<polygon fill="black" stroke="black" points="3529.83,-403.64 3527.08,-393.41 3522.84,-403.12 3529.83,-403.64"/>
</g>
<!-- l3_scatter_10&#45;&gt;l3_expert_agg -->
<g id="edge443" class="edge">
<title>l3_scatter_10&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M3572.93,-345.39C3586.75,-339.94 3602.26,-334.69 3617,-331.6 3908.9,-270.33 4820.33,-258.44 5141.56,-256.15"/>
<polygon fill="black" stroke="black" points="5141.84,-259.64 5151.82,-256.07 5141.79,-252.64 5141.84,-259.64"/>
</g>
<!-- l3_exp11_linear1 -->
<g id="node384" class="node">
<title>l3_exp11_linear1</title>
<polygon fill="none" stroke="black" points="4907,-618.34 4743,-618.34 4743,-580.34 4907,-580.34 4907,-618.34"/>
<text text-anchor="middle" x="4825" y="-607.14" font-family="Arial" font-size="9.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="4825" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="4825" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 92&#45;95</text>
</g>
<!-- l3_gather_11&#45;&gt;l3_exp11_linear1 -->
<g id="edge446" class="edge">
<title>l3_gather_11&#45;&gt;l3_exp11_linear1</title>
<path fill="none" stroke="black" d="M4833.59,-666.22C4832.05,-654.39 4830.22,-640.38 4828.65,-628.33"/>
<polygon fill="black" stroke="black" points="4832.11,-627.81 4827.35,-618.35 4825.17,-628.72 4832.11,-627.81"/>
</g>
<!-- l3_exp11_gelu -->
<g id="node385" class="node">
<title>l3_exp11_gelu</title>
<polygon fill="none" stroke="black" points="4868,-543.34 4782,-543.34 4782,-505.34 4868,-505.34 4868,-543.34"/>
<text text-anchor="middle" x="4825" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="4825" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="4825" y="-512.14" font-family="Arial" font-size="9.00">GPUs 92&#45;95</text>
</g>
<!-- l3_exp11_linear1&#45;&gt;l3_exp11_gelu -->
<g id="edge447" class="edge">
<title>l3_exp11_linear1&#45;&gt;l3_exp11_gelu</title>
<path fill="none" stroke="black" d="M4825,-580.29C4825,-572.22 4825,-562.51 4825,-553.52"/>
<polygon fill="black" stroke="black" points="4828.5,-553.43 4825,-543.43 4821.5,-553.43 4828.5,-553.43"/>
</g>
<!-- l3_exp11_linear2 -->
<g id="node386" class="node">
<title>l3_exp11_linear2</title>
<polygon fill="none" stroke="black" points="4907,-468.34 4743,-468.34 4743,-430.34 4907,-430.34 4907,-468.34"/>
<text text-anchor="middle" x="4825" y="-457.14" font-family="Arial" font-size="9.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="4825" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="4825" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 92&#45;95</text>
</g>
<!-- l3_exp11_gelu&#45;&gt;l3_exp11_linear2 -->
<g id="edge448" class="edge">
<title>l3_exp11_gelu&#45;&gt;l3_exp11_linear2</title>
<path fill="none" stroke="black" d="M4825,-505.29C4825,-497.22 4825,-487.51 4825,-478.52"/>
<polygon fill="black" stroke="black" points="4828.5,-478.43 4825,-468.43 4821.5,-478.43 4828.5,-478.43"/>
</g>
<!-- l3_scatter_11 -->
<g id="node387" class="node">
<title>l3_scatter_11</title>
<ellipse fill="none" stroke="black" cx="4831" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="4831" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="4831" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="4831" y="-354.27" font-family="Arial" font-size="9.00">GPU 92 → All GPUs</text>
</g>
<!-- l3_exp11_linear2&#45;&gt;l3_scatter_11 -->
<g id="edge449" class="edge">
<title>l3_exp11_linear2&#45;&gt;l3_scatter_11</title>
<path fill="none" stroke="black" d="M4826.36,-429.99C4826.94,-422.13 4827.65,-412.67 4828.33,-403.52"/>
<polygon fill="black" stroke="black" points="4831.83,-403.64 4829.08,-393.41 4824.84,-403.12 4831.83,-403.64"/>
</g>
<!-- l3_scatter_11&#45;&gt;l3_expert_agg -->
<g id="edge450" class="edge">
<title>l3_scatter_11&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M4877.6,-346.09C4890.84,-340.98 4905.37,-335.74 4919,-331.6 4995.61,-308.32 5083.98,-288.61 5150.87,-275.09"/>
<polygon fill="black" stroke="black" points="5151.88,-278.46 5160.99,-273.06 5150.5,-271.6 5151.88,-278.46"/>
</g>
<!-- l3_exp12_linear1 -->
<g id="node390" class="node">
<title>l3_exp12_linear1</title>
<polygon fill="none" stroke="black" points="5652,-618.34 5488,-618.34 5488,-580.34 5652,-580.34 5652,-618.34"/>
<text text-anchor="middle" x="5570" y="-607.14" font-family="Arial" font-size="9.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="5570" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="5570" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 96&#45;99</text>
</g>
<!-- l3_gather_12&#45;&gt;l3_exp12_linear1 -->
<g id="edge453" class="edge">
<title>l3_gather_12&#45;&gt;l3_exp12_linear1</title>
<path fill="none" stroke="black" d="M5675,-669.83C5654.09,-655.99 5627.32,-638.28 5606.04,-624.19"/>
<polygon fill="black" stroke="black" points="5607.86,-621.2 5597.59,-618.6 5604,-627.04 5607.86,-621.2"/>
</g>
<!-- l3_exp12_gelu -->
<g id="node391" class="node">
<title>l3_exp12_gelu</title>
<polygon fill="none" stroke="black" points="5597,-543.34 5511,-543.34 5511,-505.34 5597,-505.34 5597,-543.34"/>
<text text-anchor="middle" x="5554" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="5554" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="5554" y="-512.14" font-family="Arial" font-size="9.00">GPUs 96&#45;99</text>
</g>
<!-- l3_exp12_linear1&#45;&gt;l3_exp12_gelu -->
<g id="edge454" class="edge">
<title>l3_exp12_linear1&#45;&gt;l3_exp12_gelu</title>
<path fill="none" stroke="black" d="M5566.04,-580.29C5564.26,-572.13 5562.1,-562.3 5560.11,-553.23"/>
<polygon fill="black" stroke="black" points="5563.52,-552.45 5557.97,-543.43 5556.69,-553.95 5563.52,-552.45"/>
</g>
<!-- l3_exp12_linear2 -->
<g id="node392" class="node">
<title>l3_exp12_linear2</title>
<polygon fill="none" stroke="black" points="5557,-468.34 5393,-468.34 5393,-430.34 5557,-430.34 5557,-468.34"/>
<text text-anchor="middle" x="5475" y="-457.14" font-family="Arial" font-size="9.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="5475" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="5475" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 96&#45;99</text>
</g>
<!-- l3_exp12_gelu&#45;&gt;l3_exp12_linear2 -->
<g id="edge455" class="edge">
<title>l3_exp12_gelu&#45;&gt;l3_exp12_linear2</title>
<path fill="none" stroke="black" d="M5534.47,-505.29C5524.69,-496.26 5512.69,-485.17 5502.04,-475.33"/>
<polygon fill="black" stroke="black" points="5504.3,-472.64 5494.58,-468.43 5499.55,-477.79 5504.3,-472.64"/>
</g>
<!-- l3_scatter_12 -->
<g id="node393" class="node">
<title>l3_scatter_12</title>
<ellipse fill="none" stroke="black" cx="5453" cy="-366.47" rx="70.01" ry="26.74"/>
<text text-anchor="middle" x="5453" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="5453" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="5453" y="-354.27" font-family="Arial" font-size="9.00">GPU 96 → All GPUs</text>
</g>
<!-- l3_exp12_linear2&#45;&gt;l3_scatter_12 -->
<g id="edge456" class="edge">
<title>l3_exp12_linear2&#45;&gt;l3_scatter_12</title>
<path fill="none" stroke="black" d="M5470.01,-429.99C5467.85,-422.05 5465.24,-412.47 5462.73,-403.22"/>
<polygon fill="black" stroke="black" points="5466.06,-402.14 5460.06,-393.41 5459.31,-403.98 5466.06,-402.14"/>
</g>
<!-- l3_scatter_12&#45;&gt;l3_expert_agg -->
<g id="edge457" class="edge">
<title>l3_scatter_12&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M5414.35,-344.02C5395.49,-333.56 5371.91,-320.47 5348.71,-307.6"/>
<polygon fill="black" stroke="black" points="5350.29,-304.47 5339.85,-302.68 5346.89,-310.59 5350.29,-304.47"/>
</g>
<!-- l3_exp13_linear1 -->
<g id="node396" class="node">
<title>l3_exp13_linear1</title>
<polygon fill="none" stroke="black" points="6957,-618.34 6793,-618.34 6793,-580.34 6957,-580.34 6957,-618.34"/>
<text text-anchor="middle" x="6875" y="-607.14" font-family="Arial" font-size="9.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="6875" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="6875" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 100&#45;103</text>
</g>
<!-- l3_gather_13&#45;&gt;l3_exp13_linear1 -->
<g id="edge460" class="edge">
<title>l3_gather_13&#45;&gt;l3_exp13_linear1</title>
<path fill="none" stroke="black" d="M6979.28,-669.36C6958.36,-655.51 6931.78,-637.92 6910.69,-623.96"/>
<polygon fill="black" stroke="black" points="6912.58,-621.02 6902.31,-618.41 6908.72,-626.85 6912.58,-621.02"/>
</g>
<!-- l3_exp13_gelu -->
<g id="node397" class="node">
<title>l3_exp13_gelu</title>
<polygon fill="none" stroke="black" points="6901,-543.34 6815,-543.34 6815,-505.34 6901,-505.34 6901,-543.34"/>
<text text-anchor="middle" x="6858" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="6858" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="6858" y="-512.14" font-family="Arial" font-size="9.00">GPUs 100&#45;103</text>
</g>
<!-- l3_exp13_linear1&#45;&gt;l3_exp13_gelu -->
<g id="edge461" class="edge">
<title>l3_exp13_linear1&#45;&gt;l3_exp13_gelu</title>
<path fill="none" stroke="black" d="M6870.8,-580.29C6868.9,-572.13 6866.61,-562.3 6864.49,-553.23"/>
<polygon fill="black" stroke="black" points="6867.89,-552.37 6862.21,-543.43 6861.07,-553.96 6867.89,-552.37"/>
</g>
<!-- l3_exp13_linear2 -->
<g id="node398" class="node">
<title>l3_exp13_linear2</title>
<polygon fill="none" stroke="black" points="6859,-468.34 6695,-468.34 6695,-430.34 6859,-430.34 6859,-468.34"/>
<text text-anchor="middle" x="6777" y="-457.14" font-family="Arial" font-size="9.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="6777" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="6777" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 100&#45;103</text>
</g>
<!-- l3_exp13_gelu&#45;&gt;l3_exp13_linear2 -->
<g id="edge462" class="edge">
<title>l3_exp13_gelu&#45;&gt;l3_exp13_linear2</title>
<path fill="none" stroke="black" d="M6837.98,-505.29C6827.95,-496.26 6815.65,-485.17 6804.73,-475.33"/>
<polygon fill="black" stroke="black" points="6806.84,-472.52 6797.07,-468.43 6802.16,-477.72 6806.84,-472.52"/>
</g>
<!-- l3_scatter_13 -->
<g id="node399" class="node">
<title>l3_scatter_13</title>
<ellipse fill="none" stroke="black" cx="6757" cy="-366.47" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="6757" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="6757" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="6757" y="-354.27" font-family="Arial" font-size="9.00">GPU 100 → All GPUs</text>
</g>
<!-- l3_exp13_linear2&#45;&gt;l3_scatter_13 -->
<g id="edge463" class="edge">
<title>l3_exp13_linear2&#45;&gt;l3_scatter_13</title>
<path fill="none" stroke="black" d="M6772.46,-429.99C6770.5,-422.05 6768.13,-412.47 6765.84,-403.22"/>
<polygon fill="black" stroke="black" points="6769.21,-402.28 6763.42,-393.41 6762.42,-403.96 6769.21,-402.28"/>
</g>
<!-- l3_scatter_13&#45;&gt;l3_expert_agg -->
<g id="edge464" class="edge">
<title>l3_scatter_13&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M6706.99,-346.6C6689.52,-340.79 6669.62,-335.02 6651,-331.6 6406.6,-286.66 5660.08,-264.99 5371.02,-258.11"/>
<polygon fill="black" stroke="black" points="5371.01,-254.61 5360.93,-257.87 5370.85,-261.61 5371.01,-254.61"/>
</g>
<!-- l3_exp14_linear1 -->
<g id="node402" class="node">
<title>l3_exp14_linear1</title>
<polygon fill="none" stroke="black" points="7836,-618.34 7672,-618.34 7672,-580.34 7836,-580.34 7836,-618.34"/>
<text text-anchor="middle" x="7754" y="-607.14" font-family="Arial" font-size="9.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="7754" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="7754" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 104&#45;107</text>
</g>
<!-- l3_gather_14&#45;&gt;l3_exp14_linear1 -->
<g id="edge467" class="edge">
<title>l3_gather_14&#45;&gt;l3_exp14_linear1</title>
<path fill="none" stroke="black" d="M7858.28,-669.36C7837.36,-655.51 7810.78,-637.92 7789.69,-623.96"/>
<polygon fill="black" stroke="black" points="7791.58,-621.02 7781.31,-618.41 7787.72,-626.85 7791.58,-621.02"/>
</g>
<!-- l3_exp14_gelu -->
<g id="node403" class="node">
<title>l3_exp14_gelu</title>
<polygon fill="none" stroke="black" points="7780,-543.34 7694,-543.34 7694,-505.34 7780,-505.34 7780,-543.34"/>
<text text-anchor="middle" x="7737" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="7737" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="7737" y="-512.14" font-family="Arial" font-size="9.00">GPUs 104&#45;107</text>
</g>
<!-- l3_exp14_linear1&#45;&gt;l3_exp14_gelu -->
<g id="edge468" class="edge">
<title>l3_exp14_linear1&#45;&gt;l3_exp14_gelu</title>
<path fill="none" stroke="black" d="M7749.8,-580.29C7747.9,-572.13 7745.61,-562.3 7743.49,-553.23"/>
<polygon fill="black" stroke="black" points="7746.89,-552.37 7741.21,-543.43 7740.07,-553.96 7746.89,-552.37"/>
</g>
<!-- l3_exp14_linear2 -->
<g id="node404" class="node">
<title>l3_exp14_linear2</title>
<polygon fill="none" stroke="black" points="7738,-468.34 7574,-468.34 7574,-430.34 7738,-430.34 7738,-468.34"/>
<text text-anchor="middle" x="7656" y="-457.14" font-family="Arial" font-size="9.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="7656" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="7656" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 104&#45;107</text>
</g>
<!-- l3_exp14_gelu&#45;&gt;l3_exp14_linear2 -->
<g id="edge469" class="edge">
<title>l3_exp14_gelu&#45;&gt;l3_exp14_linear2</title>
<path fill="none" stroke="black" d="M7716.98,-505.29C7706.95,-496.26 7694.65,-485.17 7683.73,-475.33"/>
<polygon fill="black" stroke="black" points="7685.84,-472.52 7676.07,-468.43 7681.16,-477.72 7685.84,-472.52"/>
</g>
<!-- l3_scatter_14 -->
<g id="node405" class="node">
<title>l3_scatter_14</title>
<ellipse fill="none" stroke="black" cx="7636" cy="-366.47" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="7636" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="7636" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="7636" y="-354.27" font-family="Arial" font-size="9.00">GPU 104 → All GPUs</text>
</g>
<!-- l3_exp14_linear2&#45;&gt;l3_scatter_14 -->
<g id="edge470" class="edge">
<title>l3_exp14_linear2&#45;&gt;l3_scatter_14</title>
<path fill="none" stroke="black" d="M7651.46,-429.99C7649.5,-422.05 7647.13,-412.47 7644.84,-403.22"/>
<polygon fill="black" stroke="black" points="7648.21,-402.28 7642.42,-393.41 7641.42,-403.96 7648.21,-402.28"/>
</g>
<!-- l3_scatter_14&#45;&gt;l3_expert_agg -->
<g id="edge471" class="edge">
<title>l3_scatter_14&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M7586.56,-346.56C7568.97,-340.66 7548.85,-334.86 7530,-331.6 7108.1,-258.6 5770.4,-254.73 5369.58,-255.26"/>
<polygon fill="black" stroke="black" points="5369.42,-251.76 5359.43,-255.27 5369.43,-258.76 5369.42,-251.76"/>
</g>
<!-- l3_exp15_linear1 -->
<g id="node408" class="node">
<title>l3_exp15_linear1</title>
<polygon fill="none" stroke="black" points="8285,-618.34 8121,-618.34 8121,-580.34 8285,-580.34 8285,-618.34"/>
<text text-anchor="middle" x="8203" y="-607.14" font-family="Arial" font-size="9.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="8203" y="-597.14" font-family="Arial" font-size="9.00">[dynamic, 8192] → [dynamic, 32768]</text>
<text text-anchor="middle" x="8203" y="-587.14" font-family="Arial" font-size="9.00">TP across GPUs 108&#45;111</text>
</g>
<!-- l3_gather_15&#45;&gt;l3_exp15_linear1 -->
<g id="edge474" class="edge">
<title>l3_gather_15&#45;&gt;l3_exp15_linear1</title>
<path fill="none" stroke="black" d="M8307.28,-669.36C8286.36,-655.51 8259.78,-637.92 8238.69,-623.96"/>
<polygon fill="black" stroke="black" points="8240.58,-621.02 8230.31,-618.41 8236.72,-626.85 8240.58,-621.02"/>
</g>
<!-- l3_exp15_gelu -->
<g id="node409" class="node">
<title>l3_exp15_gelu</title>
<polygon fill="none" stroke="black" points="8229,-543.34 8143,-543.34 8143,-505.34 8229,-505.34 8229,-543.34"/>
<text text-anchor="middle" x="8186" y="-532.14" font-family="Arial" font-size="9.00">GELU Activation</text>
<text text-anchor="middle" x="8186" y="-522.14" font-family="Arial" font-size="9.00">[dynamic, 32768]</text>
<text text-anchor="middle" x="8186" y="-512.14" font-family="Arial" font-size="9.00">GPUs 108&#45;111</text>
</g>
<!-- l3_exp15_linear1&#45;&gt;l3_exp15_gelu -->
<g id="edge475" class="edge">
<title>l3_exp15_linear1&#45;&gt;l3_exp15_gelu</title>
<path fill="none" stroke="black" d="M8198.8,-580.29C8196.9,-572.13 8194.61,-562.3 8192.49,-553.23"/>
<polygon fill="black" stroke="black" points="8195.89,-552.37 8190.21,-543.43 8189.07,-553.96 8195.89,-552.37"/>
</g>
<!-- l3_exp15_linear2 -->
<g id="node410" class="node">
<title>l3_exp15_linear2</title>
<polygon fill="none" stroke="black" points="8187,-468.34 8023,-468.34 8023,-430.34 8187,-430.34 8187,-468.34"/>
<text text-anchor="middle" x="8105" y="-457.14" font-family="Arial" font-size="9.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="8105" y="-447.14" font-family="Arial" font-size="9.00">[dynamic, 32768] → [dynamic, 8192]</text>
<text text-anchor="middle" x="8105" y="-437.14" font-family="Arial" font-size="9.00">TP across GPUs 108&#45;111</text>
</g>
<!-- l3_exp15_gelu&#45;&gt;l3_exp15_linear2 -->
<g id="edge476" class="edge">
<title>l3_exp15_gelu&#45;&gt;l3_exp15_linear2</title>
<path fill="none" stroke="black" d="M8148.92,-505.16C8140.77,-500.11 8132.62,-494.12 8126,-487.34 8123.12,-484.39 8120.5,-480.97 8118.16,-477.42"/>
<polygon fill="black" stroke="black" points="8121.03,-475.39 8112.94,-468.54 8114.99,-478.94 8121.03,-475.39"/>
</g>
<!-- l3_scatter_15 -->
<g id="node411" class="node">
<title>l3_scatter_15</title>
<ellipse fill="none" stroke="black" cx="8085" cy="-366.47" rx="73.58" ry="26.74"/>
<text text-anchor="middle" x="8085" y="-374.27" font-family="Arial" font-size="9.00">Scatter Results</text>
<text text-anchor="middle" x="8085" y="-364.27" font-family="Arial" font-size="9.00">[dynamic, 8192]</text>
<text text-anchor="middle" x="8085" y="-354.27" font-family="Arial" font-size="9.00">GPU 108 → All GPUs</text>
</g>
<!-- l3_exp15_linear2&#45;&gt;l3_scatter_15 -->
<g id="edge477" class="edge">
<title>l3_exp15_linear2&#45;&gt;l3_scatter_15</title>
<path fill="none" stroke="black" d="M8100.46,-429.99C8098.5,-422.05 8096.13,-412.47 8093.84,-403.22"/>
<polygon fill="black" stroke="black" points="8097.21,-402.28 8091.42,-393.41 8090.42,-403.96 8097.21,-402.28"/>
</g>
<!-- l3_scatter_15&#45;&gt;l3_expert_agg -->
<g id="edge478" class="edge">
<title>l3_scatter_15&#45;&gt;l3_expert_agg</title>
<path fill="none" stroke="black" d="M8035.57,-346.5C8017.98,-340.6 7997.86,-334.81 7979,-331.6 7719.81,-287.48 5856.9,-262.68 5370.78,-256.91"/>
<polygon fill="black" stroke="black" points="5370.63,-253.41 5360.59,-256.79 5370.55,-260.41 5370.63,-253.41"/>
</g>
<!-- l3_expert_agg&#45;&gt;l3_moe_res -->
<g id="edge479" class="edge">
<title>l3_expert_agg&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M5354.7,-246.34C5628.02,-226.43 6387.64,-171.1 6670.78,-150.48"/>
<polygon fill="black" stroke="black" points="6671.34,-153.95 6681.06,-149.73 6670.83,-146.97 6671.34,-153.95"/>
</g>
<!-- output -->
<g id="node414" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="6779" cy="-35.8" rx="53.07" ry="19.6"/>
<text text-anchor="middle" x="6779" y="-38.6" font-family="Arial" font-size="9.00">Output Tokens</text>
<text text-anchor="middle" x="6779" y="-28.6" font-family="Arial" font-size="9.00">[1024, 8192]</text>
</g>
<!-- l3_moe_res&#45;&gt;output -->
<g id="edge481" class="edge">
<title>l3_moe_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M6779,-113.6C6779,-99 6779,-80.96 6779,-66.03"/>
<polygon fill="black" stroke="black" points="6782.5,-65.8 6779,-55.8 6775.5,-65.8 6782.5,-65.8"/>
</g>
</g>
</svg>
