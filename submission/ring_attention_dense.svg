<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="269pt"
 viewBox="0.00 0.00 1440.00 268.96" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.22 0.22) rotate(0) translate(4 1217.17)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1217.17 6534,-1217.17 6534,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="lightblue" stroke="black" d="M20,-117.74C20,-117.74 750,-117.74 750,-117.74 756,-117.74 762,-123.74 762,-129.74 762,-129.74 762,-1024.17 762,-1024.17 762,-1030.17 756,-1036.17 750,-1036.17 750,-1036.17 20,-1036.17 20,-1036.17 14,-1036.17 8,-1030.17 8,-1024.17 8,-1024.17 8,-129.74 8,-129.74 8,-123.74 14,-117.74 20,-117.74"/>
<text text-anchor="middle" x="385" y="-1020.97" font-family="Times,serif" font-size="14.00">GPU 0 (Sequence Parallel)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="lightgreen" stroke="black" d="M1648,-117.74C1648,-117.74 2378,-117.74 2378,-117.74 2384,-117.74 2390,-123.74 2390,-129.74 2390,-129.74 2390,-1024.17 2390,-1024.17 2390,-1030.17 2384,-1036.17 2378,-1036.17 2378,-1036.17 1648,-1036.17 1648,-1036.17 1642,-1036.17 1636,-1030.17 1636,-1024.17 1636,-1024.17 1636,-129.74 1636,-129.74 1636,-123.74 1642,-117.74 1648,-117.74"/>
<text text-anchor="middle" x="2013" y="-1020.97" font-family="Times,serif" font-size="14.00">GPU 1 (Sequence Parallel)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="lightyellow" stroke="black" d="M4152,-117.74C4152,-117.74 4882,-117.74 4882,-117.74 4888,-117.74 4894,-123.74 4894,-129.74 4894,-129.74 4894,-1024.17 4894,-1024.17 4894,-1030.17 4888,-1036.17 4882,-1036.17 4882,-1036.17 4152,-1036.17 4152,-1036.17 4146,-1036.17 4140,-1030.17 4140,-1024.17 4140,-1024.17 4140,-129.74 4140,-129.74 4140,-123.74 4146,-117.74 4152,-117.74"/>
<text text-anchor="middle" x="4517" y="-1020.97" font-family="Times,serif" font-size="14.00">GPU 2 (Sequence Parallel)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="lightcoral" stroke="black" d="M5780,-117.74C5780,-117.74 6510,-117.74 6510,-117.74 6516,-117.74 6522,-123.74 6522,-129.74 6522,-129.74 6522,-1024.17 6522,-1024.17 6522,-1030.17 6516,-1036.17 6510,-1036.17 6510,-1036.17 5780,-1036.17 5780,-1036.17 5774,-1036.17 5768,-1030.17 5768,-1024.17 5768,-1024.17 5768,-129.74 5768,-129.74 5768,-123.74 5774,-117.74 5780,-117.74"/>
<text text-anchor="middle" x="6145" y="-1020.97" font-family="Times,serif" font-size="14.00">GPU 3 (Sequence Parallel)</text>
</g>
<!-- total_input -->
<g id="node1" class="node">
<title>total_input</title>
<ellipse fill="lightgray" stroke="black" cx="3493" cy="-1145.17" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3493" y="-1148.97" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="3493" y="-1133.97" font-family="Times,serif" font-size="14.00">(B, L, d_model)</text>
</g>
<!-- input_0 -->
<g id="node2" class="node">
<title>input_0</title>
<ellipse fill="white" stroke="black" cx="119" cy="-967.7" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="119" y="-979" font-family="Times,serif" font-size="14.00">Sequence Split</text>
<text text-anchor="middle" x="119" y="-964" font-family="Times,serif" font-size="14.00">X[0]</text>
<text text-anchor="middle" x="119" y="-949" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- total_input&#45;&gt;input_0 -->
<g id="edge1" class="edge">
<title>total_input&#45;&gt;input_0</title>
<path fill="none" stroke="black" d="M3407.06,-1139.7C2942.83,-1115.56 736.73,-1000.82 225.12,-974.22"/>
<polygon fill="black" stroke="black" points="224.97,-970.7 214.8,-973.68 224.61,-977.69 224.97,-970.7"/>
</g>
<!-- input_1 -->
<g id="node12" class="node">
<title>input_1</title>
<ellipse fill="white" stroke="black" cx="2285" cy="-967.7" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2285" y="-979" font-family="Times,serif" font-size="14.00">Sequence Split</text>
<text text-anchor="middle" x="2285" y="-964" font-family="Times,serif" font-size="14.00">X[1]</text>
<text text-anchor="middle" x="2285" y="-949" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- total_input&#45;&gt;input_1 -->
<g id="edge3" class="edge">
<title>total_input&#45;&gt;input_1</title>
<path fill="none" stroke="black" d="M3414.67,-1132.8C3202.96,-1102.04 2619.52,-1017.29 2384.76,-983.19"/>
<polygon fill="black" stroke="black" points="2385.26,-979.73 2374.87,-981.75 2384.26,-986.65 2385.26,-979.73"/>
</g>
<!-- input_2 -->
<g id="node22" class="node">
<title>input_2</title>
<ellipse fill="white" stroke="black" cx="4701" cy="-967.7" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4701" y="-979" font-family="Times,serif" font-size="14.00">Sequence Split</text>
<text text-anchor="middle" x="4701" y="-964" font-family="Times,serif" font-size="14.00">X[2]</text>
<text text-anchor="middle" x="4701" y="-949" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- total_input&#45;&gt;input_2 -->
<g id="edge5" class="edge">
<title>total_input&#45;&gt;input_2</title>
<path fill="none" stroke="black" d="M3520.54,-1119.45C3538.88,-1104.52 3564.25,-1086.6 3590,-1077.17 3772.89,-1010.23 4353.42,-981.54 4594.47,-972.3"/>
<polygon fill="black" stroke="black" points="4594.79,-975.79 4604.65,-971.91 4594.52,-968.79 4594.79,-975.79"/>
</g>
<!-- input_3 -->
<g id="node32" class="node">
<title>input_3</title>
<ellipse fill="white" stroke="black" cx="5873" cy="-967.7" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="5873" y="-979" font-family="Times,serif" font-size="14.00">Sequence Split</text>
<text text-anchor="middle" x="5873" y="-964" font-family="Times,serif" font-size="14.00">X[3]</text>
<text text-anchor="middle" x="5873" y="-949" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- total_input&#45;&gt;input_3 -->
<g id="edge7" class="edge">
<title>total_input&#45;&gt;input_3</title>
<path fill="none" stroke="black" d="M3519.53,-1119.55C3537.84,-1104.24 3563.56,-1085.87 3590,-1077.17 3728.12,-1031.72 4752.78,-1043.47 4898,-1036.17 5215.3,-1020.23 5590.03,-991.51 5768.44,-977.23"/>
<polygon fill="black" stroke="black" points="5768.92,-980.71 5778.61,-976.42 5768.36,-973.73 5768.92,-980.71"/>
</g>
<!-- qkv_0 -->
<g id="node3" class="node">
<title>qkv_0</title>
<polygon fill="white" stroke="black" points="187.5,-858.22 50.5,-858.22 50.5,-820.22 187.5,-820.22 187.5,-858.22"/>
<text text-anchor="middle" x="119" y="-843.02" font-family="Times,serif" font-size="14.00">QKV Projections</text>
<text text-anchor="middle" x="119" y="-828.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_0&#45;&gt;qkv_0 -->
<g id="edge2" class="edge">
<title>input_0&#45;&gt;qkv_0</title>
<path fill="none" stroke="black" d="M119,-930.11C119,-910.57 119,-886.86 119,-868.71"/>
<polygon fill="black" stroke="black" points="122.5,-868.47 119,-858.47 115.5,-868.47 122.5,-868.47"/>
</g>
<!-- residual_0 -->
<g id="node10" class="node">
<title>residual_0</title>
<ellipse fill="white" stroke="black" cx="391" cy="-278.35" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="391" y="-282.15" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="391" y="-267.15" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_0&#45;&gt;residual_0 -->
<g id="edge22" class="edge">
<title>input_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M87.88,-932.02C71.44,-911.85 52.36,-885.15 41,-858.22 17.22,-801.87 17,-783.88 17,-722.72 17,-722.72 17,-722.72 17,-554.22 17,-409.71 200.54,-332.78 310.47,-299.66"/>
<polygon fill="black" stroke="black" points="311.62,-302.97 320.21,-296.78 309.63,-296.26 311.62,-302.97"/>
</g>
<!-- ring_stage_0_0 -->
<g id="node4" class="node">
<title>ring_stage_0_0</title>
<path fill="white" stroke="black" d="M190,-748.22C190,-748.22 48,-748.22 48,-748.22 42,-748.22 36,-742.22 36,-736.22 36,-736.22 36,-707.22 36,-707.22 36,-701.22 42,-695.22 48,-695.22 48,-695.22 190,-695.22 190,-695.22 196,-695.22 202,-701.22 202,-707.22 202,-707.22 202,-736.22 202,-736.22 202,-742.22 196,-748.22 190,-748.22"/>
<text text-anchor="middle" x="119" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="119" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[0], K[0], V[0])</text>
<text text-anchor="middle" x="119" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- qkv_0&#45;&gt;ring_stage_0_0 -->
<g id="edge9" class="edge">
<title>qkv_0&#45;&gt;ring_stage_0_0</title>
<path fill="none" stroke="black" d="M119,-820.17C119,-803.75 119,-779.02 119,-758.58"/>
<polygon fill="black" stroke="black" points="122.5,-758.35 119,-748.35 115.5,-758.35 122.5,-758.35"/>
</g>
<!-- accum_0 -->
<g id="node8" class="node">
<title>accum_0</title>
<ellipse fill="white" stroke="black" cx="391" cy="-555.22" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="391" y="-566.52" font-family="Times,serif" font-size="14.00">Accumulate</text>
<text text-anchor="middle" x="391" y="-551.52" font-family="Times,serif" font-size="14.00">Ring Results</text>
<text text-anchor="middle" x="391" y="-536.52" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_0&#45;&gt;accum_0 -->
<g id="edge16" class="edge">
<title>ring_stage_0_0&#45;&gt;accum_0</title>
<path fill="none" stroke="black" d="M161.2,-695.2C206.76,-667.64 279.71,-623.53 331.17,-592.4"/>
<polygon fill="black" stroke="black" points="333.14,-595.31 339.88,-587.14 329.51,-589.32 333.14,-595.31"/>
</g>
<!-- comm_0_0 -->
<g id="node42" class="node">
<title>comm_0_0</title>
<polygon fill="lightgray" stroke="black" points="907,-623.22 770,-555.22 907,-487.22 1044,-555.22 907,-623.22"/>
<text text-anchor="middle" x="907" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="907" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
<text text-anchor="middle" x="907" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="907" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_0&#45;&gt;comm_0_0 -->
<g id="edge11" class="edge">
<title>ring_stage_0_0&#45;&gt;comm_0_0</title>
<path fill="none" stroke="black" d="M202.12,-697.12C205.11,-696.45 208.08,-695.81 211,-695.22 454.79,-645.88 527.39,-693.46 766,-623.22 788.98,-616.46 812.89,-606.38 834.36,-596.08"/>
<polygon fill="black" stroke="black" points="835.96,-599.2 843.4,-591.66 832.88,-592.91 835.96,-599.2"/>
</g>
<!-- ring_stage_0_1 -->
<g id="node5" class="node">
<title>ring_stage_0_1</title>
<path fill="white" stroke="black" d="M374,-748.22C374,-748.22 232,-748.22 232,-748.22 226,-748.22 220,-742.22 220,-736.22 220,-736.22 220,-707.22 220,-707.22 220,-701.22 226,-695.22 232,-695.22 232,-695.22 374,-695.22 374,-695.22 380,-695.22 386,-701.22 386,-707.22 386,-707.22 386,-736.22 386,-736.22 386,-742.22 380,-748.22 374,-748.22"/>
<text text-anchor="middle" x="303" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="303" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[0], K[3], V[3])</text>
<text text-anchor="middle" x="303" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_1&#45;&gt;accum_0 -->
<g id="edge17" class="edge">
<title>ring_stage_0_1&#45;&gt;accum_0</title>
<path fill="none" stroke="black" d="M316.75,-695.02C330.16,-669.96 350.82,-631.33 366.95,-601.18"/>
<polygon fill="black" stroke="black" points="370.17,-602.59 371.8,-592.12 363.99,-599.28 370.17,-602.59"/>
</g>
<!-- comm_0_1 -->
<g id="node46" class="node">
<title>comm_0_1</title>
<polygon fill="lightgray" stroke="black" points="1491,-623.22 1354,-555.22 1491,-487.22 1628,-555.22 1491,-623.22"/>
<text text-anchor="middle" x="1491" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="1491" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
<text text-anchor="middle" x="1491" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="1491" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_1&#45;&gt;comm_0_1 -->
<g id="edge13" class="edge">
<title>ring_stage_0_1&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M386.08,-696.91C389.08,-696.3 392.06,-695.73 395,-695.22 812.11,-622.32 935.04,-729.18 1345,-623.22 1369.56,-616.87 1395.1,-606.57 1417.83,-595.94"/>
<polygon fill="black" stroke="black" points="1419.53,-599 1427.05,-591.53 1416.52,-592.68 1419.53,-599"/>
</g>
<!-- ring_stage_0_2 -->
<g id="node6" class="node">
<title>ring_stage_0_2</title>
<path fill="white" stroke="black" d="M742,-748.22C742,-748.22 600,-748.22 600,-748.22 594,-748.22 588,-742.22 588,-736.22 588,-736.22 588,-707.22 588,-707.22 588,-701.22 594,-695.22 600,-695.22 600,-695.22 742,-695.22 742,-695.22 748,-695.22 754,-701.22 754,-707.22 754,-707.22 754,-736.22 754,-736.22 754,-742.22 748,-748.22 742,-748.22"/>
<text text-anchor="middle" x="671" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="671" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[0], K[2], V[2])</text>
<text text-anchor="middle" x="671" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_2&#45;&gt;accum_0 -->
<g id="edge18" class="edge">
<title>ring_stage_0_2&#45;&gt;accum_0</title>
<path fill="none" stroke="black" d="M627.56,-695.2C580.41,-667.5 504.79,-623.07 451.77,-591.92"/>
<polygon fill="black" stroke="black" points="453.52,-588.89 443.13,-586.85 449.98,-594.93 453.52,-588.89"/>
</g>
<!-- comm_0_2 -->
<g id="node50" class="node">
<title>comm_0_2</title>
<polygon fill="lightgray" stroke="black" points="1199,-623.22 1062,-555.22 1199,-487.22 1336,-555.22 1199,-623.22"/>
<text text-anchor="middle" x="1199" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="1199" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
<text text-anchor="middle" x="1199" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="1199" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_2&#45;&gt;comm_0_2 -->
<g id="edge15" class="edge">
<title>ring_stage_0_2&#45;&gt;comm_0_2</title>
<path fill="none" stroke="black" d="M754.25,-704.01C832.51,-687.25 952.34,-658.84 1053,-623.22 1076.01,-615.08 1100.34,-604.68 1122.41,-594.51"/>
<polygon fill="black" stroke="black" points="1124.13,-597.57 1131.72,-590.17 1121.18,-591.22 1124.13,-597.57"/>
</g>
<!-- ring_stage_0_3 -->
<g id="node7" class="node">
<title>ring_stage_0_3</title>
<path fill="white" stroke="black" d="M558,-748.22C558,-748.22 416,-748.22 416,-748.22 410,-748.22 404,-742.22 404,-736.22 404,-736.22 404,-707.22 404,-707.22 404,-701.22 410,-695.22 416,-695.22 416,-695.22 558,-695.22 558,-695.22 564,-695.22 570,-701.22 570,-707.22 570,-707.22 570,-736.22 570,-736.22 570,-742.22 564,-748.22 558,-748.22"/>
<text text-anchor="middle" x="487" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="487" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[0], K[1], V[1])</text>
<text text-anchor="middle" x="487" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_0_3&#45;&gt;accum_0 -->
<g id="edge19" class="edge">
<title>ring_stage_0_3&#45;&gt;accum_0</title>
<path fill="none" stroke="black" d="M472,-695.02C457.31,-669.85 434.64,-630.99 417.01,-600.79"/>
<polygon fill="black" stroke="black" points="420.01,-598.99 411.95,-592.12 413.97,-602.52 420.01,-598.99"/>
</g>
<!-- out_proj_0 -->
<g id="node9" class="node">
<title>out_proj_0</title>
<polygon fill="white" stroke="black" points="463,-415.22 319,-415.22 319,-377.22 463,-377.22 463,-415.22"/>
<text text-anchor="middle" x="391" y="-400.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="391" y="-385.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- accum_0&#45;&gt;out_proj_0 -->
<g id="edge20" class="edge">
<title>accum_0&#45;&gt;out_proj_0</title>
<path fill="none" stroke="black" d="M391,-517.41C391,-489.34 391,-451.24 391,-425.53"/>
<polygon fill="black" stroke="black" points="394.5,-425.33 391,-415.33 387.5,-425.33 394.5,-425.33"/>
</g>
<!-- out_proj_0&#45;&gt;residual_0 -->
<g id="edge21" class="edge">
<title>out_proj_0&#45;&gt;residual_0</title>
<path fill="none" stroke="black" d="M391,-377.12C391,-360.75 391,-336.16 391,-315.73"/>
<polygon fill="black" stroke="black" points="394.5,-315.5 391,-305.5 387.5,-315.5 394.5,-315.5"/>
</g>
<!-- output_0 -->
<g id="node11" class="node">
<title>output_0</title>
<ellipse fill="white" stroke="black" cx="480" cy="-152.61" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="480" y="-156.41" font-family="Times,serif" font-size="14.00">Output Chunk</text>
<text text-anchor="middle" x="480" y="-141.41" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- residual_0&#45;&gt;output_0 -->
<g id="edge23" class="edge">
<title>residual_0&#45;&gt;output_0</title>
<path fill="none" stroke="black" d="M409.44,-251.71C422.81,-233.13 441.01,-207.81 455.59,-187.56"/>
<polygon fill="black" stroke="black" points="458.59,-189.38 461.58,-179.22 452.9,-185.29 458.59,-189.38"/>
</g>
<!-- final_output -->
<g id="node58" class="node">
<title>final_output</title>
<ellipse fill="lightgray" stroke="black" cx="3328" cy="-26.87" rx="87.86" ry="26.74"/>
<text text-anchor="middle" x="3328" y="-30.67" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="3328" y="-15.67" font-family="Times,serif" font-size="14.00">(B, L, d_model)</text>
</g>
<!-- output_0&#45;&gt;final_output -->
<g id="edge69" class="edge">
<title>output_0&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M575.16,-147.48C1008.75,-128.64 2794.82,-51.04 3231.39,-32.07"/>
<polygon fill="black" stroke="black" points="3231.61,-35.56 3241.45,-31.63 3231.31,-28.57 3231.61,-35.56"/>
</g>
<!-- qkv_1 -->
<g id="node13" class="node">
<title>qkv_1</title>
<polygon fill="white" stroke="black" points="2360.5,-858.22 2223.5,-858.22 2223.5,-820.22 2360.5,-820.22 2360.5,-858.22"/>
<text text-anchor="middle" x="2292" y="-843.02" font-family="Times,serif" font-size="14.00">QKV Projections</text>
<text text-anchor="middle" x="2292" y="-828.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_1&#45;&gt;qkv_1 -->
<g id="edge4" class="edge">
<title>input_1&#45;&gt;qkv_1</title>
<path fill="none" stroke="black" d="M2287.02,-930.11C2288.11,-910.57 2289.42,-886.86 2290.42,-868.71"/>
<polygon fill="black" stroke="black" points="2293.93,-868.64 2290.99,-858.47 2286.94,-868.26 2293.93,-868.64"/>
</g>
<!-- residual_1 -->
<g id="node20" class="node">
<title>residual_1</title>
<ellipse fill="white" stroke="black" cx="2197" cy="-278.35" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="2197" y="-282.15" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2197" y="-267.15" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_1&#45;&gt;residual_1 -->
<g id="edge37" class="edge">
<title>input_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M2256.72,-931.69C2241.86,-911.42 2224.75,-884.72 2215,-858.22 2194.02,-801.21 2197,-783.47 2197,-722.72 2197,-722.72 2197,-722.72 2197,-554.22 2197,-468.73 2197,-368.27 2197,-315.67"/>
<polygon fill="black" stroke="black" points="2200.5,-315.5 2197,-305.5 2193.5,-315.5 2200.5,-315.5"/>
</g>
<!-- ring_stage_1_0 -->
<g id="node14" class="node">
<title>ring_stage_1_0</title>
<path fill="white" stroke="black" d="M2370,-748.22C2370,-748.22 2228,-748.22 2228,-748.22 2222,-748.22 2216,-742.22 2216,-736.22 2216,-736.22 2216,-707.22 2216,-707.22 2216,-701.22 2222,-695.22 2228,-695.22 2228,-695.22 2370,-695.22 2370,-695.22 2376,-695.22 2382,-701.22 2382,-707.22 2382,-707.22 2382,-736.22 2382,-736.22 2382,-742.22 2376,-748.22 2370,-748.22"/>
<text text-anchor="middle" x="2299" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="2299" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[1], K[1], V[1])</text>
<text text-anchor="middle" x="2299" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- qkv_1&#45;&gt;ring_stage_1_0 -->
<g id="edge24" class="edge">
<title>qkv_1&#45;&gt;ring_stage_1_0</title>
<path fill="none" stroke="black" d="M2293.09,-820.17C2294.09,-803.75 2295.59,-779.02 2296.83,-758.58"/>
<polygon fill="black" stroke="black" points="2300.34,-758.55 2297.45,-748.35 2293.35,-758.12 2300.34,-758.55"/>
</g>
<!-- accum_1 -->
<g id="node18" class="node">
<title>accum_1</title>
<ellipse fill="white" stroke="black" cx="2081" cy="-555.22" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="2081" y="-566.52" font-family="Times,serif" font-size="14.00">Accumulate</text>
<text text-anchor="middle" x="2081" y="-551.52" font-family="Times,serif" font-size="14.00">Ring Results</text>
<text text-anchor="middle" x="2081" y="-536.52" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_0&#45;&gt;accum_1 -->
<g id="edge31" class="edge">
<title>ring_stage_1_0&#45;&gt;accum_1</title>
<path fill="none" stroke="black" d="M2264.94,-695.02C2229.42,-668.22 2173.34,-625.9 2132.43,-595.03"/>
<polygon fill="black" stroke="black" points="2134.29,-592.05 2124.2,-588.82 2130.07,-597.64 2134.29,-592.05"/>
</g>
<!-- comm_1_0 -->
<g id="node43" class="node">
<title>comm_1_0</title>
<polygon fill="lightgray" stroke="black" points="3703,-623.22 3566,-555.22 3703,-487.22 3840,-555.22 3703,-623.22"/>
<text text-anchor="middle" x="3703" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="3703" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
<text text-anchor="middle" x="3703" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="3703" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_0&#45;&gt;comm_1_0 -->
<g id="edge26" class="edge">
<title>ring_stage_1_0&#45;&gt;comm_1_0</title>
<path fill="none" stroke="black" d="M2382.07,-718.09C2625.43,-709.79 3333.56,-681.18 3557,-623.22 3581.56,-616.85 3607.1,-606.55 3629.82,-595.91"/>
<polygon fill="black" stroke="black" points="3631.53,-598.97 3639.04,-591.51 3628.51,-592.66 3631.53,-598.97"/>
</g>
<!-- ring_stage_1_1 -->
<g id="node15" class="node">
<title>ring_stage_1_1</title>
<path fill="white" stroke="black" d="M1982,-748.22C1982,-748.22 1840,-748.22 1840,-748.22 1834,-748.22 1828,-742.22 1828,-736.22 1828,-736.22 1828,-707.22 1828,-707.22 1828,-701.22 1834,-695.22 1840,-695.22 1840,-695.22 1982,-695.22 1982,-695.22 1988,-695.22 1994,-701.22 1994,-707.22 1994,-707.22 1994,-736.22 1994,-736.22 1994,-742.22 1988,-748.22 1982,-748.22"/>
<text text-anchor="middle" x="1911" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="1911" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[1], K[0], V[0])</text>
<text text-anchor="middle" x="1911" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_1&#45;&gt;accum_1 -->
<g id="edge32" class="edge">
<title>ring_stage_1_1&#45;&gt;accum_1</title>
<path fill="none" stroke="black" d="M1937.56,-695.02C1964.54,-668.92 2006.73,-628.09 2038.38,-597.46"/>
<polygon fill="black" stroke="black" points="2041.02,-599.77 2045.78,-590.3 2036.16,-594.74 2041.02,-599.77"/>
</g>
<!-- comm_1_1 -->
<g id="node47" class="node">
<title>comm_1_1</title>
<polygon fill="lightgray" stroke="black" points="3119,-623.22 2982,-555.22 3119,-487.22 3256,-555.22 3119,-623.22"/>
<text text-anchor="middle" x="3119" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="3119" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
<text text-anchor="middle" x="3119" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3119" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_1&#45;&gt;comm_1_1 -->
<g id="edge28" class="edge">
<title>ring_stage_1_1&#45;&gt;comm_1_1</title>
<path fill="none" stroke="black" d="M1994.08,-696.91C1997.08,-696.3 2000.06,-695.73 2003,-695.22 2428.9,-621.13 2554.37,-731.08 2973,-623.22 2997.57,-616.89 3023.11,-606.6 3045.83,-595.96"/>
<polygon fill="black" stroke="black" points="3047.54,-599.02 3055.05,-591.55 3044.52,-592.71 3047.54,-599.02"/>
</g>
<!-- ring_stage_1_2 -->
<g id="node16" class="node">
<title>ring_stage_1_2</title>
<path fill="white" stroke="black" d="M2166,-748.22C2166,-748.22 2024,-748.22 2024,-748.22 2018,-748.22 2012,-742.22 2012,-736.22 2012,-736.22 2012,-707.22 2012,-707.22 2012,-701.22 2018,-695.22 2024,-695.22 2024,-695.22 2166,-695.22 2166,-695.22 2172,-695.22 2178,-701.22 2178,-707.22 2178,-707.22 2178,-736.22 2178,-736.22 2178,-742.22 2172,-748.22 2166,-748.22"/>
<text text-anchor="middle" x="2095" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="2095" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[1], K[3], V[3])</text>
<text text-anchor="middle" x="2095" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_2&#45;&gt;accum_1 -->
<g id="edge33" class="edge">
<title>ring_stage_1_2&#45;&gt;accum_1</title>
<path fill="none" stroke="black" d="M2092.81,-695.02C2090.72,-670.44 2087.52,-632.82 2084.98,-602.94"/>
<polygon fill="black" stroke="black" points="2088.44,-602.4 2084.11,-592.73 2081.47,-602.99 2088.44,-602.4"/>
</g>
<!-- comm_1_2 -->
<g id="node51" class="node">
<title>comm_1_2</title>
<polygon fill="lightgray" stroke="black" points="2827,-623.22 2690,-555.22 2827,-487.22 2964,-555.22 2827,-623.22"/>
<text text-anchor="middle" x="2827" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="2827" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
<text text-anchor="middle" x="2827" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="2827" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_2&#45;&gt;comm_1_2 -->
<g id="edge30" class="edge">
<title>ring_stage_1_2&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M2178.04,-701.1C2187.78,-699.01 2197.6,-697 2207,-695.22 2416.36,-655.54 2476.84,-684.25 2681,-623.22 2704.95,-616.06 2730.04,-605.7 2752.52,-595.25"/>
<polygon fill="black" stroke="black" points="2754.1,-598.38 2761.65,-590.94 2751.12,-592.05 2754.1,-598.38"/>
</g>
<!-- ring_stage_1_3 -->
<g id="node17" class="node">
<title>ring_stage_1_3</title>
<path fill="white" stroke="black" d="M1798,-748.22C1798,-748.22 1656,-748.22 1656,-748.22 1650,-748.22 1644,-742.22 1644,-736.22 1644,-736.22 1644,-707.22 1644,-707.22 1644,-701.22 1650,-695.22 1656,-695.22 1656,-695.22 1798,-695.22 1798,-695.22 1804,-695.22 1810,-701.22 1810,-707.22 1810,-707.22 1810,-736.22 1810,-736.22 1810,-742.22 1804,-748.22 1798,-748.22"/>
<text text-anchor="middle" x="1727" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="1727" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[1], K[2], V[2])</text>
<text text-anchor="middle" x="1727" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_1_3&#45;&gt;accum_1 -->
<g id="edge34" class="edge">
<title>ring_stage_1_3&#45;&gt;accum_1</title>
<path fill="none" stroke="black" d="M1781.92,-695.2C1843.5,-666.58 1943.52,-620.11 2010.74,-588.87"/>
<polygon fill="black" stroke="black" points="2012.41,-591.95 2020,-584.56 2009.46,-585.6 2012.41,-591.95"/>
</g>
<!-- out_proj_1 -->
<g id="node19" class="node">
<title>out_proj_1</title>
<polygon fill="white" stroke="black" points="2165,-415.22 2021,-415.22 2021,-377.22 2165,-377.22 2165,-415.22"/>
<text text-anchor="middle" x="2093" y="-400.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="2093" y="-385.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- accum_1&#45;&gt;out_proj_1 -->
<g id="edge35" class="edge">
<title>accum_1&#45;&gt;out_proj_1</title>
<path fill="none" stroke="black" d="M2083.81,-517.41C2085.96,-489.34 2088.87,-451.24 2090.84,-425.53"/>
<polygon fill="black" stroke="black" points="2094.34,-425.56 2091.62,-415.33 2087.36,-425.03 2094.34,-425.56"/>
</g>
<!-- out_proj_1&#45;&gt;residual_1 -->
<g id="edge36" class="edge">
<title>out_proj_1&#45;&gt;residual_1</title>
<path fill="none" stroke="black" d="M2109.25,-377.12C2124.82,-359.77 2148.68,-333.19 2167.59,-312.12"/>
<polygon fill="black" stroke="black" points="2170.23,-314.42 2174.31,-304.64 2165.02,-309.74 2170.23,-314.42"/>
</g>
<!-- output_1 -->
<g id="node21" class="node">
<title>output_1</title>
<ellipse fill="white" stroke="black" cx="2241" cy="-152.61" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="2241" y="-156.41" font-family="Times,serif" font-size="14.00">Output Chunk</text>
<text text-anchor="middle" x="2241" y="-141.41" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- residual_1&#45;&gt;output_1 -->
<g id="edge38" class="edge">
<title>residual_1&#45;&gt;output_1</title>
<path fill="none" stroke="black" d="M2206.22,-251.41C2212.65,-233.34 2221.3,-209.02 2228.36,-189.15"/>
<polygon fill="black" stroke="black" points="2231.74,-190.11 2231.79,-179.52 2225.14,-187.77 2231.74,-190.11"/>
</g>
<!-- output_1&#45;&gt;final_output -->
<g id="edge70" class="edge">
<title>output_1&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M2329.49,-141.54C2532.61,-118.41 3030.57,-61.73 3236.53,-38.28"/>
<polygon fill="black" stroke="black" points="3237.17,-41.73 3246.71,-37.12 3236.38,-34.78 3237.17,-41.73"/>
</g>
<!-- qkv_2 -->
<g id="node23" class="node">
<title>qkv_2</title>
<polygon fill="white" stroke="black" points="4864.5,-858.22 4727.5,-858.22 4727.5,-820.22 4864.5,-820.22 4864.5,-858.22"/>
<text text-anchor="middle" x="4796" y="-843.02" font-family="Times,serif" font-size="14.00">QKV Projections</text>
<text text-anchor="middle" x="4796" y="-828.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_2&#45;&gt;qkv_2 -->
<g id="edge6" class="edge">
<title>input_2&#45;&gt;qkv_2</title>
<path fill="none" stroke="black" d="M4727.46,-931.47C4742.89,-910.93 4762.02,-885.45 4776.15,-866.65"/>
<polygon fill="black" stroke="black" points="4779.05,-868.61 4782.26,-858.51 4773.45,-864.41 4779.05,-868.61"/>
</g>
<!-- residual_2 -->
<g id="node30" class="node">
<title>residual_2</title>
<ellipse fill="white" stroke="black" cx="4500" cy="-278.35" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="4500" y="-282.15" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4500" y="-267.15" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_2&#45;&gt;residual_2 -->
<g id="edge52" class="edge">
<title>input_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M4701,-929.91C4701,-882.15 4701,-796.21 4701,-722.72 4701,-722.72 4701,-722.72 4701,-554.22 4701,-448.07 4602.12,-355.6 4543.07,-309.85"/>
<polygon fill="black" stroke="black" points="4545.09,-306.99 4535.01,-303.7 4540.84,-312.55 4545.09,-306.99"/>
</g>
<!-- ring_stage_2_0 -->
<g id="node24" class="node">
<title>ring_stage_2_0</title>
<path fill="white" stroke="black" d="M4874,-748.22C4874,-748.22 4732,-748.22 4732,-748.22 4726,-748.22 4720,-742.22 4720,-736.22 4720,-736.22 4720,-707.22 4720,-707.22 4720,-701.22 4726,-695.22 4732,-695.22 4732,-695.22 4874,-695.22 4874,-695.22 4880,-695.22 4886,-701.22 4886,-707.22 4886,-707.22 4886,-736.22 4886,-736.22 4886,-742.22 4880,-748.22 4874,-748.22"/>
<text text-anchor="middle" x="4803" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="4803" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[2], K[2], V[2])</text>
<text text-anchor="middle" x="4803" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- qkv_2&#45;&gt;ring_stage_2_0 -->
<g id="edge39" class="edge">
<title>qkv_2&#45;&gt;ring_stage_2_0</title>
<path fill="none" stroke="black" d="M4797.09,-820.17C4798.09,-803.75 4799.59,-779.02 4800.83,-758.58"/>
<polygon fill="black" stroke="black" points="4804.34,-758.55 4801.45,-748.35 4797.35,-758.12 4804.34,-758.55"/>
</g>
<!-- accum_2 -->
<g id="node28" class="node">
<title>accum_2</title>
<ellipse fill="white" stroke="black" cx="4500" cy="-555.22" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="4500" y="-566.52" font-family="Times,serif" font-size="14.00">Accumulate</text>
<text text-anchor="middle" x="4500" y="-551.52" font-family="Times,serif" font-size="14.00">Ring Results</text>
<text text-anchor="middle" x="4500" y="-536.52" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_0&#45;&gt;accum_2 -->
<g id="edge46" class="edge">
<title>ring_stage_2_0&#45;&gt;accum_2</title>
<path fill="none" stroke="black" d="M4755.99,-695.2C4704.47,-667.23 4621.53,-622.2 4564.08,-591.01"/>
<polygon fill="black" stroke="black" points="4565.54,-587.82 4555.09,-586.13 4562.2,-593.97 4565.54,-587.82"/>
</g>
<!-- comm_2_0 -->
<g id="node44" class="node">
<title>comm_2_0</title>
<polygon fill="lightgray" stroke="black" points="5623,-623.22 5486,-555.22 5623,-487.22 5760,-555.22 5623,-623.22"/>
<text text-anchor="middle" x="5623" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="5623" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
<text text-anchor="middle" x="5623" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="5623" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_0&#45;&gt;comm_2_0 -->
<g id="edge41" class="edge">
<title>ring_stage_2_0&#45;&gt;comm_2_0</title>
<path fill="none" stroke="black" d="M4886.07,-716.36C5014.93,-707.9 5269.77,-684.37 5477,-623.22 5500.98,-616.14 5526.07,-605.81 5548.55,-595.36"/>
<polygon fill="black" stroke="black" points="5550.14,-598.48 5557.68,-591.05 5547.15,-592.15 5550.14,-598.48"/>
</g>
<!-- ring_stage_2_1 -->
<g id="node25" class="node">
<title>ring_stage_2_1</title>
<path fill="white" stroke="black" d="M4486,-748.22C4486,-748.22 4344,-748.22 4344,-748.22 4338,-748.22 4332,-742.22 4332,-736.22 4332,-736.22 4332,-707.22 4332,-707.22 4332,-701.22 4338,-695.22 4344,-695.22 4344,-695.22 4486,-695.22 4486,-695.22 4492,-695.22 4498,-701.22 4498,-707.22 4498,-707.22 4498,-736.22 4498,-736.22 4498,-742.22 4492,-748.22 4486,-748.22"/>
<text text-anchor="middle" x="4415" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="4415" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[2], K[1], V[1])</text>
<text text-anchor="middle" x="4415" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_1&#45;&gt;accum_2 -->
<g id="edge47" class="edge">
<title>ring_stage_2_1&#45;&gt;accum_2</title>
<path fill="none" stroke="black" d="M4428.28,-695.02C4441.23,-669.96 4461.19,-631.33 4476.77,-601.18"/>
<polygon fill="black" stroke="black" points="4479.97,-602.61 4481.45,-592.12 4473.75,-599.39 4479.97,-602.61"/>
</g>
<!-- comm_2_1 -->
<g id="node48" class="node">
<title>comm_2_1</title>
<polygon fill="lightgray" stroke="black" points="5039,-623.22 4902,-555.22 5039,-487.22 5176,-555.22 5039,-623.22"/>
<text text-anchor="middle" x="5039" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="5039" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
<text text-anchor="middle" x="5039" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="5039" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_1&#45;&gt;comm_2_1 -->
<g id="edge43" class="edge">
<title>ring_stage_2_1&#45;&gt;comm_2_1</title>
<path fill="none" stroke="black" d="M4498.16,-697.32C4501.14,-696.59 4504.09,-695.89 4507,-695.22 4679.2,-655.58 4729.88,-677.6 4898,-623.22 4920.46,-615.95 4943.96,-605.88 4965.2,-595.74"/>
<polygon fill="black" stroke="black" points="4966.99,-598.76 4974.46,-591.24 4963.94,-592.46 4966.99,-598.76"/>
</g>
<!-- ring_stage_2_2 -->
<g id="node26" class="node">
<title>ring_stage_2_2</title>
<path fill="white" stroke="black" d="M4670,-748.22C4670,-748.22 4528,-748.22 4528,-748.22 4522,-748.22 4516,-742.22 4516,-736.22 4516,-736.22 4516,-707.22 4516,-707.22 4516,-701.22 4522,-695.22 4528,-695.22 4528,-695.22 4670,-695.22 4670,-695.22 4676,-695.22 4682,-701.22 4682,-707.22 4682,-707.22 4682,-736.22 4682,-736.22 4682,-742.22 4676,-748.22 4670,-748.22"/>
<text text-anchor="middle" x="4599" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="4599" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[2], K[0], V[0])</text>
<text text-anchor="middle" x="4599" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_2&#45;&gt;accum_2 -->
<g id="edge48" class="edge">
<title>ring_stage_2_2&#45;&gt;accum_2</title>
<path fill="none" stroke="black" d="M4583.53,-695.02C4568.34,-669.77 4544.85,-630.74 4526.64,-600.49"/>
<polygon fill="black" stroke="black" points="4529.58,-598.58 4521.42,-591.81 4523.58,-602.19 4529.58,-598.58"/>
</g>
<!-- comm_2_2 -->
<g id="node52" class="node">
<title>comm_2_2</title>
<polygon fill="lightgray" stroke="black" points="5331,-623.22 5194,-555.22 5331,-487.22 5468,-555.22 5331,-623.22"/>
<text text-anchor="middle" x="5331" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="5331" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
<text text-anchor="middle" x="5331" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="5331" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_2&#45;&gt;comm_2_2 -->
<g id="edge45" class="edge">
<title>ring_stage_2_2&#45;&gt;comm_2_2</title>
<path fill="none" stroke="black" d="M4682.04,-701.1C4691.78,-699.01 4701.6,-697 4711,-695.22 4920.36,-655.54 4980.84,-684.25 5185,-623.22 5208.95,-616.06 5234.04,-605.7 5256.52,-595.25"/>
<polygon fill="black" stroke="black" points="5258.1,-598.38 5265.65,-590.94 5255.12,-592.05 5258.1,-598.38"/>
</g>
<!-- ring_stage_2_3 -->
<g id="node27" class="node">
<title>ring_stage_2_3</title>
<path fill="white" stroke="black" d="M4302,-748.22C4302,-748.22 4160,-748.22 4160,-748.22 4154,-748.22 4148,-742.22 4148,-736.22 4148,-736.22 4148,-707.22 4148,-707.22 4148,-701.22 4154,-695.22 4160,-695.22 4160,-695.22 4302,-695.22 4302,-695.22 4308,-695.22 4314,-701.22 4314,-707.22 4314,-707.22 4314,-736.22 4314,-736.22 4314,-742.22 4308,-748.22 4302,-748.22"/>
<text text-anchor="middle" x="4231" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="4231" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[2], K[3], V[3])</text>
<text text-anchor="middle" x="4231" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_2_3&#45;&gt;accum_2 -->
<g id="edge49" class="edge">
<title>ring_stage_2_3&#45;&gt;accum_2</title>
<path fill="none" stroke="black" d="M4272.74,-695.2C4317.66,-667.73 4389.49,-623.8 4440.36,-592.69"/>
<polygon fill="black" stroke="black" points="4442.26,-595.63 4448.97,-587.43 4438.61,-589.66 4442.26,-595.63"/>
</g>
<!-- out_proj_2 -->
<g id="node29" class="node">
<title>out_proj_2</title>
<polygon fill="white" stroke="black" points="4572,-415.22 4428,-415.22 4428,-377.22 4572,-377.22 4572,-415.22"/>
<text text-anchor="middle" x="4500" y="-400.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="4500" y="-385.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- accum_2&#45;&gt;out_proj_2 -->
<g id="edge50" class="edge">
<title>accum_2&#45;&gt;out_proj_2</title>
<path fill="none" stroke="black" d="M4500,-517.41C4500,-489.34 4500,-451.24 4500,-425.53"/>
<polygon fill="black" stroke="black" points="4503.5,-425.33 4500,-415.33 4496.5,-425.33 4503.5,-425.33"/>
</g>
<!-- out_proj_2&#45;&gt;residual_2 -->
<g id="edge51" class="edge">
<title>out_proj_2&#45;&gt;residual_2</title>
<path fill="none" stroke="black" d="M4500,-377.12C4500,-360.75 4500,-336.16 4500,-315.73"/>
<polygon fill="black" stroke="black" points="4503.5,-315.5 4500,-305.5 4496.5,-315.5 4503.5,-315.5"/>
</g>
<!-- output_2 -->
<g id="node31" class="node">
<title>output_2</title>
<ellipse fill="white" stroke="black" cx="4415" cy="-152.61" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="4415" y="-156.41" font-family="Times,serif" font-size="14.00">Output Chunk</text>
<text text-anchor="middle" x="4415" y="-141.41" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- residual_2&#45;&gt;output_2 -->
<g id="edge53" class="edge">
<title>residual_2&#45;&gt;output_2</title>
<path fill="none" stroke="black" d="M4482.39,-251.71C4469.62,-233.13 4452.23,-207.81 4438.32,-187.56"/>
<polygon fill="black" stroke="black" points="4441.14,-185.48 4432.59,-179.22 4435.37,-189.44 4441.14,-185.48"/>
</g>
<!-- output_2&#45;&gt;final_output -->
<g id="edge71" class="edge">
<title>output_2&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M4326.51,-141.54C4123.39,-118.41 3625.43,-61.73 3419.47,-38.28"/>
<polygon fill="black" stroke="black" points="3419.62,-34.78 3409.29,-37.12 3418.83,-41.73 3419.62,-34.78"/>
</g>
<!-- qkv_3 -->
<g id="node33" class="node">
<title>qkv_3</title>
<polygon fill="white" stroke="black" points="5934.5,-858.22 5797.5,-858.22 5797.5,-820.22 5934.5,-820.22 5934.5,-858.22"/>
<text text-anchor="middle" x="5866" y="-843.02" font-family="Times,serif" font-size="14.00">QKV Projections</text>
<text text-anchor="middle" x="5866" y="-828.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_3&#45;&gt;qkv_3 -->
<g id="edge8" class="edge">
<title>input_3&#45;&gt;qkv_3</title>
<path fill="none" stroke="black" d="M5870.98,-930.11C5869.89,-910.57 5868.58,-886.86 5867.58,-868.71"/>
<polygon fill="black" stroke="black" points="5871.06,-868.26 5867.01,-858.47 5864.07,-868.64 5871.06,-868.26"/>
</g>
<!-- residual_3 -->
<g id="node40" class="node">
<title>residual_3</title>
<ellipse fill="white" stroke="black" cx="6135" cy="-278.35" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="6135" y="-282.15" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6135" y="-267.15" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- input_3&#45;&gt;residual_3 -->
<g id="edge67" class="edge">
<title>input_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M5961.32,-952.1C6136.89,-920.57 6513,-839.4 6513,-722.72 6513,-722.72 6513,-722.72 6513,-554.22 6513,-408.7 6327.5,-332.17 6216.39,-299.39"/>
<polygon fill="black" stroke="black" points="6217.12,-295.96 6206.54,-296.54 6215.18,-302.68 6217.12,-295.96"/>
</g>
<!-- ring_stage_3_0 -->
<g id="node34" class="node">
<title>ring_stage_3_0</title>
<path fill="white" stroke="black" d="M5930,-748.22C5930,-748.22 5788,-748.22 5788,-748.22 5782,-748.22 5776,-742.22 5776,-736.22 5776,-736.22 5776,-707.22 5776,-707.22 5776,-701.22 5782,-695.22 5788,-695.22 5788,-695.22 5930,-695.22 5930,-695.22 5936,-695.22 5942,-701.22 5942,-707.22 5942,-707.22 5942,-736.22 5942,-736.22 5942,-742.22 5936,-748.22 5930,-748.22"/>
<text text-anchor="middle" x="5859" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 0</text>
<text text-anchor="middle" x="5859" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[3], K[3], V[3])</text>
<text text-anchor="middle" x="5859" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- qkv_3&#45;&gt;ring_stage_3_0 -->
<g id="edge54" class="edge">
<title>qkv_3&#45;&gt;ring_stage_3_0</title>
<path fill="none" stroke="black" d="M5864.91,-820.17C5863.91,-803.75 5862.41,-779.02 5861.17,-758.58"/>
<polygon fill="black" stroke="black" points="5864.65,-758.12 5860.55,-748.35 5857.66,-758.55 5864.65,-758.12"/>
</g>
<!-- accum_3 -->
<g id="node38" class="node">
<title>accum_3</title>
<ellipse fill="white" stroke="black" cx="6135" cy="-555.22" rx="96.75" ry="37.45"/>
<text text-anchor="middle" x="6135" y="-566.52" font-family="Times,serif" font-size="14.00">Accumulate</text>
<text text-anchor="middle" x="6135" y="-551.52" font-family="Times,serif" font-size="14.00">Ring Results</text>
<text text-anchor="middle" x="6135" y="-536.52" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_0&#45;&gt;accum_3 -->
<g id="edge61" class="edge">
<title>ring_stage_3_0&#45;&gt;accum_3</title>
<path fill="none" stroke="black" d="M5901.82,-695.2C5948.05,-667.64 6022.07,-623.53 6074.29,-592.4"/>
<polygon fill="black" stroke="black" points="6076.33,-595.26 6083.13,-587.14 6072.75,-589.25 6076.33,-595.26"/>
</g>
<!-- comm_3_0 -->
<g id="node45" class="node">
<title>comm_3_0</title>
<polygon fill="lightgray" stroke="black" points="2535,-623.22 2398,-555.22 2535,-487.22 2672,-555.22 2535,-623.22"/>
<text text-anchor="middle" x="2535" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="2535" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
<text text-anchor="middle" x="2535" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 0</text>
<text text-anchor="middle" x="2535" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_0&#45;&gt;comm_3_0 -->
<g id="edge56" class="edge">
<title>ring_stage_3_0&#45;&gt;comm_3_0</title>
<path fill="none" stroke="black" d="M5775.91,-718.4C5278.95,-704.46 2719.81,-632.33 2681,-623.22 2656.18,-617.4 2630.47,-607.19 2607.67,-596.47"/>
<polygon fill="black" stroke="black" points="2608.95,-593.21 2598.43,-592.02 2605.92,-599.51 2608.95,-593.21"/>
</g>
<!-- ring_stage_3_1 -->
<g id="node35" class="node">
<title>ring_stage_3_1</title>
<path fill="white" stroke="black" d="M6298,-748.22C6298,-748.22 6156,-748.22 6156,-748.22 6150,-748.22 6144,-742.22 6144,-736.22 6144,-736.22 6144,-707.22 6144,-707.22 6144,-701.22 6150,-695.22 6156,-695.22 6156,-695.22 6298,-695.22 6298,-695.22 6304,-695.22 6310,-701.22 6310,-707.22 6310,-707.22 6310,-736.22 6310,-736.22 6310,-742.22 6304,-748.22 6298,-748.22"/>
<text text-anchor="middle" x="6227" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 1</text>
<text text-anchor="middle" x="6227" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[3], K[2], V[2])</text>
<text text-anchor="middle" x="6227" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_1&#45;&gt;accum_3 -->
<g id="edge62" class="edge">
<title>ring_stage_3_1&#45;&gt;accum_3</title>
<path fill="none" stroke="black" d="M6212.62,-695.02C6198.61,-669.96 6177.01,-631.33 6160.14,-601.18"/>
<polygon fill="black" stroke="black" points="6163.01,-599.14 6155.08,-592.12 6156.9,-602.55 6163.01,-599.14"/>
</g>
<!-- comm_3_1 -->
<g id="node49" class="node">
<title>comm_3_1</title>
<polygon fill="lightgray" stroke="black" points="3995,-623.22 3858,-555.22 3995,-487.22 4132,-555.22 3995,-623.22"/>
<text text-anchor="middle" x="3995" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="3995" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
<text text-anchor="middle" x="3995" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 1</text>
<text text-anchor="middle" x="3995" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_1&#45;&gt;comm_3_1 -->
<g id="edge58" class="edge">
<title>ring_stage_3_1&#45;&gt;comm_3_1</title>
<path fill="none" stroke="black" d="M6143.95,-696.76C6140.94,-696.19 6137.95,-695.68 6135,-695.22 5695.7,-627.39 4567.79,-728.79 4136,-623.22 4112.39,-617.45 4088.01,-607.5 4066.31,-597"/>
<polygon fill="black" stroke="black" points="4067.7,-593.78 4057.18,-592.48 4064.59,-600.06 4067.7,-593.78"/>
</g>
<!-- ring_stage_3_2 -->
<g id="node36" class="node">
<title>ring_stage_3_2</title>
<path fill="white" stroke="black" d="M6114,-748.22C6114,-748.22 5972,-748.22 5972,-748.22 5966,-748.22 5960,-742.22 5960,-736.22 5960,-736.22 5960,-707.22 5960,-707.22 5960,-701.22 5966,-695.22 5972,-695.22 5972,-695.22 6114,-695.22 6114,-695.22 6120,-695.22 6126,-701.22 6126,-707.22 6126,-707.22 6126,-736.22 6126,-736.22 6126,-742.22 6120,-748.22 6114,-748.22"/>
<text text-anchor="middle" x="6043" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 2</text>
<text text-anchor="middle" x="6043" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[3], K[1], V[1])</text>
<text text-anchor="middle" x="6043" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_2&#45;&gt;accum_3 -->
<g id="edge63" class="edge">
<title>ring_stage_3_2&#45;&gt;accum_3</title>
<path fill="none" stroke="black" d="M6057.38,-695.02C6071.39,-669.96 6092.99,-631.33 6109.86,-601.18"/>
<polygon fill="black" stroke="black" points="6113.1,-602.55 6114.92,-592.12 6106.99,-599.14 6113.1,-602.55"/>
</g>
<!-- comm_3_2 -->
<g id="node53" class="node">
<title>comm_3_2</title>
<polygon fill="lightgray" stroke="black" points="3411,-623.22 3274,-555.22 3411,-487.22 3548,-555.22 3411,-623.22"/>
<text text-anchor="middle" x="3411" y="-574.02" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="3411" y="-559.02" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
<text text-anchor="middle" x="3411" y="-544.02" font-family="Times,serif" font-size="14.00">Stage 2</text>
<text text-anchor="middle" x="3411" y="-529.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_2&#45;&gt;comm_3_2 -->
<g id="edge60" class="edge">
<title>ring_stage_3_2&#45;&gt;comm_3_2</title>
<path fill="none" stroke="black" d="M5959.95,-696.74C5956.94,-696.18 5953.95,-695.67 5951,-695.22 5424.75,-615.56 4075.21,-744.64 3557,-623.22 3532.18,-617.41 3506.47,-607.2 3483.67,-596.48"/>
<polygon fill="black" stroke="black" points="3484.95,-593.22 3474.42,-592.03 3481.92,-599.52 3484.95,-593.22"/>
</g>
<!-- ring_stage_3_3 -->
<g id="node37" class="node">
<title>ring_stage_3_3</title>
<path fill="white" stroke="black" d="M6482,-748.22C6482,-748.22 6340,-748.22 6340,-748.22 6334,-748.22 6328,-742.22 6328,-736.22 6328,-736.22 6328,-707.22 6328,-707.22 6328,-701.22 6334,-695.22 6340,-695.22 6340,-695.22 6482,-695.22 6482,-695.22 6488,-695.22 6494,-701.22 6494,-707.22 6494,-707.22 6494,-736.22 6494,-736.22 6494,-742.22 6488,-748.22 6482,-748.22"/>
<text text-anchor="middle" x="6411" y="-733.02" font-family="Times,serif" font-size="14.00">Ring Stage 3</text>
<text text-anchor="middle" x="6411" y="-718.02" font-family="Times,serif" font-size="14.00">Attn(Q[3], K[0], V[0])</text>
<text text-anchor="middle" x="6411" y="-703.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- ring_stage_3_3&#45;&gt;accum_3 -->
<g id="edge64" class="edge">
<title>ring_stage_3_3&#45;&gt;accum_3</title>
<path fill="none" stroke="black" d="M6368.18,-695.2C6321.95,-667.64 6247.93,-623.53 6195.71,-592.4"/>
<polygon fill="black" stroke="black" points="6197.25,-589.25 6186.87,-587.14 6193.67,-595.26 6197.25,-589.25"/>
</g>
<!-- out_proj_3 -->
<g id="node39" class="node">
<title>out_proj_3</title>
<polygon fill="white" stroke="black" points="6207,-415.22 6063,-415.22 6063,-377.22 6207,-377.22 6207,-415.22"/>
<text text-anchor="middle" x="6135" y="-400.02" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="6135" y="-385.02" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- accum_3&#45;&gt;out_proj_3 -->
<g id="edge65" class="edge">
<title>accum_3&#45;&gt;out_proj_3</title>
<path fill="none" stroke="black" d="M6135,-517.41C6135,-489.34 6135,-451.24 6135,-425.53"/>
<polygon fill="black" stroke="black" points="6138.5,-425.33 6135,-415.33 6131.5,-425.33 6138.5,-425.33"/>
</g>
<!-- out_proj_3&#45;&gt;residual_3 -->
<g id="edge66" class="edge">
<title>out_proj_3&#45;&gt;residual_3</title>
<path fill="none" stroke="black" d="M6135,-377.12C6135,-360.75 6135,-336.16 6135,-315.73"/>
<polygon fill="black" stroke="black" points="6138.5,-315.5 6135,-305.5 6131.5,-315.5 6138.5,-315.5"/>
</g>
<!-- output_3 -->
<g id="node41" class="node">
<title>output_3</title>
<ellipse fill="white" stroke="black" cx="6050" cy="-152.61" rx="96.75" ry="26.74"/>
<text text-anchor="middle" x="6050" y="-156.41" font-family="Times,serif" font-size="14.00">Output Chunk</text>
<text text-anchor="middle" x="6050" y="-141.41" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- residual_3&#45;&gt;output_3 -->
<g id="edge68" class="edge">
<title>residual_3&#45;&gt;output_3</title>
<path fill="none" stroke="black" d="M6117.39,-251.71C6104.62,-233.13 6087.23,-207.81 6073.32,-187.56"/>
<polygon fill="black" stroke="black" points="6076.14,-185.48 6067.59,-179.22 6070.37,-189.44 6076.14,-185.48"/>
</g>
<!-- output_3&#45;&gt;final_output -->
<g id="edge72" class="edge">
<title>output_3&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M5954.72,-147.28C5534.23,-128.16 3846.79,-51.45 3424.29,-32.25"/>
<polygon fill="black" stroke="black" points="3424.39,-28.75 3414.24,-31.79 3424.07,-35.74 3424.39,-28.75"/>
</g>
<!-- comm_0_0&#45;&gt;ring_stage_1_1 -->
<g id="edge25" class="edge">
<title>comm_0_0&#45;&gt;ring_stage_1_1</title>
<path fill="none" stroke="black" d="M971.38,-591.44C996.2,-603.48 1025.25,-615.78 1053,-623.22 1380.05,-710.92 1480.74,-634.83 1817.87,-695.16"/>
<polygon fill="black" stroke="black" points="1817.44,-698.64 1827.91,-696.98 1818.7,-691.75 1817.44,-698.64"/>
</g>
<!-- comm_1_0&#45;&gt;ring_stage_2_1 -->
<g id="edge40" class="edge">
<title>comm_1_0&#45;&gt;ring_stage_2_1</title>
<path fill="none" stroke="black" d="M3768.35,-590.94C3793.03,-602.78 3821.75,-615.07 3849,-623.22 4049.97,-683.3 4112.67,-651.71 4321.8,-695.08"/>
<polygon fill="black" stroke="black" points="4321.36,-698.56 4331.87,-697.2 4322.8,-691.71 4321.36,-698.56"/>
</g>
<!-- comm_2_0&#45;&gt;ring_stage_3_1 -->
<g id="edge55" class="edge">
<title>comm_2_0&#45;&gt;ring_stage_3_1</title>
<path fill="none" stroke="black" d="M5687.94,-591.28C5711.38,-602.8 5738.38,-614.8 5764,-623.22 5920.45,-674.66 5969.58,-657.47 6133.87,-695.04"/>
<polygon fill="black" stroke="black" points="6133.3,-698.5 6143.83,-697.35 6134.88,-691.68 6133.3,-698.5"/>
</g>
<!-- comm_3_0&#45;&gt;ring_stage_0_1 -->
<g id="edge10" class="edge">
<title>comm_3_0&#45;&gt;ring_stage_0_1</title>
<path fill="none" stroke="black" d="M2472.82,-592.48C2448.96,-604.57 2420.98,-616.62 2394,-623.22 1965.37,-728.02 850.79,-628.86 396.01,-695.26"/>
<polygon fill="black" stroke="black" points="395.42,-691.81 386.05,-696.76 396.46,-698.74 395.42,-691.81"/>
</g>
<!-- comm_0_1&#45;&gt;ring_stage_1_2 -->
<g id="edge27" class="edge">
<title>comm_0_1&#45;&gt;ring_stage_1_2</title>
<path fill="none" stroke="black" d="M1555.94,-591.28C1579.38,-602.8 1606.38,-614.8 1632,-623.22 1788.45,-674.66 1837.58,-657.47 2001.87,-695.04"/>
<polygon fill="black" stroke="black" points="2001.3,-698.5 2011.83,-697.35 2002.88,-691.68 2001.3,-698.5"/>
</g>
<!-- comm_1_1&#45;&gt;ring_stage_2_2 -->
<g id="edge42" class="edge">
<title>comm_1_1&#45;&gt;ring_stage_2_2</title>
<path fill="none" stroke="black" d="M3182.88,-591.8C3207.76,-603.96 3236.99,-616.25 3265,-623.22 3798.26,-756.02 3959.54,-606.71 4505.82,-695.19"/>
<polygon fill="black" stroke="black" points="4505.5,-698.68 4515.93,-696.84 4506.63,-691.77 4505.5,-698.68"/>
</g>
<!-- comm_2_1&#45;&gt;ring_stage_3_2 -->
<g id="edge57" class="edge">
<title>comm_2_1&#45;&gt;ring_stage_3_2</title>
<path fill="none" stroke="black" d="M5103.38,-591.44C5128.2,-603.48 5157.25,-615.78 5185,-623.22 5512.05,-710.92 5612.74,-634.83 5949.87,-695.16"/>
<polygon fill="black" stroke="black" points="5949.44,-698.64 5959.91,-696.98 5950.7,-691.75 5949.44,-698.64"/>
</g>
<!-- comm_3_1&#45;&gt;ring_stage_0_2 -->
<g id="edge12" class="edge">
<title>comm_3_1&#45;&gt;ring_stage_0_2</title>
<path fill="none" stroke="black" d="M3931.57,-592.02C3906.63,-604.3 3877.24,-616.6 3849,-623.22 3810.44,-632.27 1284.68,-703.51 764.18,-718.11"/>
<polygon fill="black" stroke="black" points="763.98,-714.62 754.09,-718.4 764.18,-721.61 763.98,-714.62"/>
</g>
<!-- comm_0_2&#45;&gt;ring_stage_1_3 -->
<g id="edge29" class="edge">
<title>comm_0_2&#45;&gt;ring_stage_1_3</title>
<path fill="none" stroke="black" d="M1266.28,-590.17C1290.68,-601.66 1318.71,-613.92 1345,-623.22 1441.53,-657.37 1555.69,-684.91 1633.92,-701.89"/>
<polygon fill="black" stroke="black" points="1633.24,-705.33 1643.75,-704.01 1634.71,-698.48 1633.24,-705.33"/>
</g>
<!-- comm_1_2&#45;&gt;ring_stage_2_3 -->
<g id="edge44" class="edge">
<title>comm_1_2&#45;&gt;ring_stage_2_3</title>
<path fill="none" stroke="black" d="M2890.96,-591.51C2915.85,-603.63 2945.06,-615.97 2973,-623.22 3193.38,-680.38 3885.3,-709 4137.69,-717.74"/>
<polygon fill="black" stroke="black" points="4137.81,-721.25 4147.93,-718.09 4138.05,-714.25 4137.81,-721.25"/>
</g>
<!-- comm_2_2&#45;&gt;ring_stage_3_3 -->
<g id="edge59" class="edge">
<title>comm_2_2&#45;&gt;ring_stage_3_3</title>
<path fill="none" stroke="black" d="M5395.35,-591.56C5420.16,-603.62 5449.22,-615.9 5477,-623.22 5836.99,-718.12 5947.4,-630.35 6317.99,-695.19"/>
<polygon fill="black" stroke="black" points="6317.46,-698.65 6327.91,-696.95 6318.68,-691.76 6317.46,-698.65"/>
</g>
<!-- comm_3_2&#45;&gt;ring_stage_0_3 -->
<g id="edge14" class="edge">
<title>comm_3_2&#45;&gt;ring_stage_0_3</title>
<path fill="none" stroke="black" d="M3347.59,-592.08C3322.64,-604.36 3293.25,-616.65 3265,-623.22 2686.69,-757.72 1186.5,-608.52 580.23,-695.23"/>
<polygon fill="black" stroke="black" points="579.44,-691.81 570.05,-696.73 580.45,-698.74 579.44,-691.81"/>
</g>
<!-- comm_0_3 -->
<g id="node54" class="node">
<title>comm_0_3</title>
<polygon fill="lightgray" stroke="black" points="3736,-1213.17 3599,-1145.17 3736,-1077.17 3873,-1145.17 3736,-1213.17"/>
<text text-anchor="middle" x="3736" y="-1163.97" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="3736" y="-1148.97" font-family="Times,serif" font-size="14.00">GPU 0→1</text>
<text text-anchor="middle" x="3736" y="-1133.97" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="3736" y="-1118.97" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- comm_1_3 -->
<g id="node55" class="node">
<title>comm_1_3</title>
<polygon fill="lightgray" stroke="black" points="4028,-1213.17 3891,-1145.17 4028,-1077.17 4165,-1145.17 4028,-1213.17"/>
<text text-anchor="middle" x="4028" y="-1163.97" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="4028" y="-1148.97" font-family="Times,serif" font-size="14.00">GPU 1→2</text>
<text text-anchor="middle" x="4028" y="-1133.97" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4028" y="-1118.97" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- comm_2_3 -->
<g id="node56" class="node">
<title>comm_2_3</title>
<polygon fill="lightgray" stroke="black" points="4320,-1213.17 4183,-1145.17 4320,-1077.17 4457,-1145.17 4320,-1213.17"/>
<text text-anchor="middle" x="4320" y="-1163.97" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="4320" y="-1148.97" font-family="Times,serif" font-size="14.00">GPU 2→3</text>
<text text-anchor="middle" x="4320" y="-1133.97" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4320" y="-1118.97" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
<!-- comm_3_3 -->
<g id="node57" class="node">
<title>comm_3_3</title>
<polygon fill="lightgray" stroke="black" points="4612,-1213.17 4475,-1145.17 4612,-1077.17 4749,-1145.17 4612,-1213.17"/>
<text text-anchor="middle" x="4612" y="-1163.97" font-family="Times,serif" font-size="14.00">KV Transfer</text>
<text text-anchor="middle" x="4612" y="-1148.97" font-family="Times,serif" font-size="14.00">GPU 3→0</text>
<text text-anchor="middle" x="4612" y="-1133.97" font-family="Times,serif" font-size="14.00">Stage 3</text>
<text text-anchor="middle" x="4612" y="-1118.97" font-family="Times,serif" font-size="14.00">(B, L/4, d_model)</text>
</g>
</g>
</svg>
