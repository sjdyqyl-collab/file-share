<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: moe_model_dag Pages: 1 -->
<svg width="394pt" height="1800pt"
 viewBox="0.00 0.00 394.21 1800.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.08 0.08) rotate(0) translate(4 23125.58)">
<title>moe_model_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-23125.58 5061.5,-23125.58 5061.5,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="927" cy="-23094.71" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="927" y="-23098.51" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="927" y="-23083.51" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightyellow" stroke="black" points="1372,-23030.84 1202,-23030.84 1202,-22977.84 1372,-22977.84 1372,-23030.84"/>
<text text-anchor="middle" x="1287" y="-23015.64" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1287" y="-23000.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1287" y="-22985.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M1020.18,-23070.84C1073.03,-23057.86 1139.02,-23041.67 1192.15,-23028.62"/>
<polygon fill="black" stroke="black" points="1193.04,-23032.01 1201.92,-23026.23 1191.37,-23025.21 1193.04,-23032.01"/>
</g>
<!-- residual1_1 -->
<g id="node8" class="node">
<title>residual1_1</title>
<polygon fill="lightcoral" stroke="black" points="1284.86,-22670.84 715.58,-22670.84 569.14,-22564.84 1138.42,-22564.84 1284.86,-22670.84"/>
<text text-anchor="middle" x="927" y="-22629.14" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="927" y="-22614.14" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="927" y="-22599.14" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M921.56,-23067.54C918.39,-23050.02 915,-23026.4 915,-23005.34 915,-23005.34 915,-23005.34 915,-22733.34 915,-22716.38 916.32,-22698.07 918.08,-22681.18"/>
<polygon fill="black" stroke="black" points="921.6,-22681.2 919.23,-22670.88 914.65,-22680.43 921.6,-22681.2"/>
</g>
<!-- mha_q_1 -->
<g id="node3" class="node">
<title>mha_q_1</title>
<polygon fill="lightblue" stroke="black" points="1987,-22940.84 1651,-22940.84 1651,-22887.84 1987,-22887.84 1987,-22940.84"/>
<text text-anchor="middle" x="1819" y="-22925.64" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1819" y="-22910.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1819" y="-22895.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_q_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M1372.18,-22989.25C1448.01,-22976.71 1561.07,-22958.01 1654.49,-22942.55"/>
<polygon fill="black" stroke="black" points="1655.32,-22945.96 1664.62,-22940.88 1654.18,-22939.06 1655.32,-22945.96"/>
</g>
<!-- mha_k_1 -->
<g id="node4" class="node">
<title>mha_k_1</title>
<polygon fill="lightblue" stroke="black" points="1279,-22940.84 943,-22940.84 943,-22887.84 1279,-22887.84 1279,-22940.84"/>
<text text-anchor="middle" x="1111" y="-22925.64" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="1111" y="-22910.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1111" y="-22895.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_k_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M1235.62,-22977.65C1215.47,-22967.58 1192.2,-22955.94 1171.26,-22945.47"/>
<polygon fill="black" stroke="black" points="1172.65,-22942.25 1162.14,-22940.91 1169.52,-22948.51 1172.65,-22942.25"/>
</g>
<!-- mha_v_1 -->
<g id="node5" class="node">
<title>mha_v_1</title>
<polygon fill="lightblue" stroke="black" points="1633,-22940.84 1297,-22940.84 1297,-22887.84 1633,-22887.84 1633,-22940.84"/>
<text text-anchor="middle" x="1465" y="-22925.64" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1465" y="-22910.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1465" y="-22895.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_v_1 -->
<g id="edge4" class="edge">
<title>ln1_1&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M1338.96,-22977.65C1359.34,-22967.58 1382.88,-22955.94 1404.05,-22945.47"/>
<polygon fill="black" stroke="black" points="1405.87,-22948.48 1413.28,-22940.91 1402.76,-22942.21 1405.87,-22948.48"/>
</g>
<!-- mha_attn_1 -->
<g id="node6" class="node">
<title>mha_attn_1</title>
<polygon fill="lightblue" stroke="black" points="1382,-22850.84 1212,-22850.84 1212,-22797.84 1382,-22797.84 1382,-22850.84"/>
<text text-anchor="middle" x="1297" y="-22835.64" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1297" y="-22820.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1297" y="-22805.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1667.67,-22887.83C1578.78,-22872.84 1469.15,-22854.36 1392.26,-22841.4"/>
<polygon fill="black" stroke="black" points="1392.55,-22837.9 1382.1,-22839.69 1391.38,-22844.8 1392.55,-22837.9"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1165.05,-22887.77C1186.54,-22877.6 1211.42,-22865.83 1233.75,-22855.27"/>
<polygon fill="black" stroke="black" points="1235.27,-22858.42 1242.82,-22850.98 1232.28,-22852.09 1235.27,-22858.42"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge7" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1415.96,-22887.65C1396.81,-22877.62 1374.71,-22866.05 1354.79,-22855.61"/>
<polygon fill="black" stroke="black" points="1356.3,-22852.45 1345.81,-22850.91 1353.05,-22858.65 1356.3,-22852.45"/>
</g>
<!-- mha_out_1 -->
<g id="node7" class="node">
<title>mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="1291,-22760.84 955,-22760.84 955,-22707.84 1291,-22707.84 1291,-22760.84"/>
<text text-anchor="middle" x="1123" y="-22745.64" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1123" y="-22730.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1123" y="-22715.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge8" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M1246.2,-22797.65C1226.28,-22787.58 1203.28,-22775.94 1182.58,-22765.47"/>
<polygon fill="black" stroke="black" points="1184.06,-22762.3 1173.56,-22760.91 1180.9,-22768.55 1184.06,-22762.3"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge10" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M1079.01,-22707.65C1062.86,-22698.21 1043.87,-22687.11 1024.88,-22676.02"/>
<polygon fill="black" stroke="black" points="1026.57,-22672.95 1016.17,-22670.93 1023.03,-22679 1026.57,-22672.95"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="lightyellow" stroke="black" points="2309,-22527.84 2139,-22527.84 2139,-22474.84 2309,-22474.84 2309,-22527.84"/>
<text text-anchor="middle" x="2224" y="-22512.64" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2224" y="-22497.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2224" y="-22482.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge11" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M1179.77,-22594.53C1469.74,-22568.93 1930.62,-22528.24 2128.56,-22510.77"/>
<polygon fill="black" stroke="black" points="2128.99,-22514.24 2138.64,-22509.88 2128.37,-22507.27 2128.99,-22514.24"/>
</g>
<!-- residual2_1 -->
<g id="node36" class="node">
<title>residual2_1</title>
<polygon fill="lightcoral" stroke="black" points="1284.86,-21822.84 715.58,-21822.84 569.14,-21716.84 1138.42,-21716.84 1284.86,-21822.84"/>
<text text-anchor="middle" x="927" y="-21781.14" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="927" y="-21766.14" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="927" y="-21751.14" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge54" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M919.23,-22564.81C916.92,-22545.27 915,-22522.83 915,-22502.34 915,-22502.34 915,-22502.34 915,-21926.84 915,-21896 917.36,-21861.82 919.99,-21833.34"/>
<polygon fill="black" stroke="black" points="923.5,-21833.41 920.96,-21823.12 916.53,-21832.74 923.5,-21833.41"/>
</g>
<!-- gate_1 -->
<g id="node10" class="node">
<title>gate_1</title>
<polygon fill="orange" stroke="black" points="2393,-22437.84 2084,-22384.84 2393,-22331.84 2702,-22384.84 2393,-22437.84"/>
<text text-anchor="middle" x="2393" y="-22396.14" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2393" y="-22381.14" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2393" y="-22366.14" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;gate_1 -->
<g id="edge12" class="edge">
<title>ln2_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M2261.93,-22474.65C2280.05,-22462.36 2302.34,-22447.26 2323.36,-22433.02"/>
<polygon fill="black" stroke="black" points="2325.34,-22435.91 2331.65,-22427.41 2321.41,-22430.12 2325.34,-22435.91"/>
</g>
<!-- expert_1_0 -->
<g id="node11" class="node">
<title>expert_1_0</title>
<polygon fill="lightcyan" stroke="black" points="1650.5,-22280.84 1305.5,-22280.84 1305.5,-22212.84 1650.5,-22212.84 1650.5,-22280.84"/>
<text text-anchor="middle" x="1478" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1478" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1478" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1478" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_0 -->
<g id="edge14" class="edge">
<title>ln2_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" d="M2138.9,-22497.04C1998.15,-22487.66 1713.6,-22451.67 1524,-22313.84 1515,-22307.3 1507.15,-22298.45 1500.61,-22289.35"/>
<polygon fill="black" stroke="black" points="1503.46,-22287.32 1494.97,-22280.98 1497.66,-22291.23 1503.46,-22287.32"/>
</g>
<!-- expert_1_1 -->
<g id="node14" class="node">
<title>expert_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2776.5,-22280.84 2431.5,-22280.84 2431.5,-22212.84 2776.5,-22212.84 2776.5,-22280.84"/>
<text text-anchor="middle" x="2604" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2604" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2604" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2604" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_1 -->
<g id="edge19" class="edge">
<title>ln2_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" d="M2309.19,-22495.31C2441.57,-22486.63 2684.35,-22466.93 2711,-22437.84 2752.76,-22392.26 2749.45,-22350.83 2716,-22298.84 2713.46,-22294.89 2710.53,-22291.25 2707.3,-22287.88"/>
<polygon fill="black" stroke="black" points="2709.5,-22285.15 2699.77,-22280.95 2704.76,-22290.3 2709.5,-22285.15"/>
</g>
<!-- expert_1_2 -->
<g id="node17" class="node">
<title>expert_1_2</title>
<polygon fill="lightcyan" stroke="black" points="3502.5,-22280.84 3157.5,-22280.84 3157.5,-22212.84 3502.5,-22212.84 3502.5,-22280.84"/>
<text text-anchor="middle" x="3330" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3330" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3330" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3330" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_2 -->
<g id="edge24" class="edge">
<title>ln2_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" d="M2309.15,-22494.32C2405.25,-22487.12 2566.15,-22473.89 2704,-22456.84 2972.63,-22423.61 3084.89,-22483.26 3296,-22313.84 3303.76,-22307.61 3309.93,-22299.14 3314.77,-22290.35"/>
<polygon fill="black" stroke="black" points="3318.02,-22291.65 3319.33,-22281.14 3311.75,-22288.54 3318.02,-22291.65"/>
</g>
<!-- expert_1_3 -->
<g id="node20" class="node">
<title>expert_1_3</title>
<polygon fill="lightcyan" stroke="black" points="1287.5,-22280.84 942.5,-22280.84 942.5,-22212.84 1287.5,-22212.84 1287.5,-22280.84"/>
<text text-anchor="middle" x="1115" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1115" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1115" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1115" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_3 -->
<g id="edge29" class="edge">
<title>ln2_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" d="M2138.73,-22501.22C2008.73,-22500.62 1754.12,-22491.77 1546,-22437.84 1411.2,-22402.91 1265.02,-22330.37 1182.25,-22285.72"/>
<polygon fill="black" stroke="black" points="1183.92,-22282.65 1173.46,-22280.96 1180.58,-22288.8 1183.92,-22282.65"/>
</g>
<!-- expert_1_4 -->
<g id="node23" class="node">
<title>expert_1_4</title>
<polygon fill="lightcyan" stroke="black" points="3139.5,-22280.84 2794.5,-22280.84 2794.5,-22212.84 3139.5,-22212.84 3139.5,-22280.84"/>
<text text-anchor="middle" x="2967" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2967" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2967" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2967" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_4 -->
<g id="edge34" class="edge">
<title>ln2_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" d="M2309.24,-22497.48C2436.1,-22491.97 2667.45,-22476.79 2740,-22437.84 2814.26,-22397.97 2886.54,-22331.2 2928.9,-22288.36"/>
<polygon fill="black" stroke="black" points="2931.44,-22290.77 2935.95,-22281.18 2926.45,-22285.87 2931.44,-22290.77"/>
</g>
<!-- expert_1_5 -->
<g id="node26" class="node">
<title>expert_1_5</title>
<polygon fill="lightcyan" stroke="black" points="3865.5,-22280.84 3520.5,-22280.84 3520.5,-22212.84 3865.5,-22212.84 3865.5,-22280.84"/>
<text text-anchor="middle" x="3693" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3693" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3693" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3693" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_5 -->
<g id="edge39" class="edge">
<title>ln2_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" d="M2309.22,-22497.56C2507.12,-22490.63 2993.08,-22470.72 3153,-22437.84 3320.02,-22403.51 3505.72,-22329.85 3610.04,-22285"/>
<polygon fill="black" stroke="black" points="3611.46,-22288.2 3619.26,-22281.02 3608.69,-22281.77 3611.46,-22288.2"/>
</g>
<!-- expert_1_6 -->
<g id="node29" class="node">
<title>expert_1_6</title>
<polygon fill="lightcyan" stroke="black" points="2013.5,-22280.84 1668.5,-22280.84 1668.5,-22212.84 2013.5,-22212.84 2013.5,-22280.84"/>
<text text-anchor="middle" x="1841" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1841" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1841" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1841" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_6 -->
<g id="edge44" class="edge">
<title>ln2_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" d="M2138.67,-22476.01C2121.35,-22470.31 2103.42,-22463.83 2087,-22456.84 1987.2,-22414.36 1982.24,-22370.71 1901,-22298.84 1896.9,-22295.22 1892.62,-22291.48 1888.32,-22287.76"/>
<polygon fill="black" stroke="black" points="1890.43,-22284.96 1880.57,-22281.09 1885.86,-22290.27 1890.43,-22284.96"/>
</g>
<!-- expert_1_7 -->
<g id="node32" class="node">
<title>expert_1_7</title>
<polygon fill="lightcyan" stroke="black" points="2376.5,-22280.84 2031.5,-22280.84 2031.5,-22212.84 2376.5,-22212.84 2376.5,-22280.84"/>
<text text-anchor="middle" x="2204" y="-22265.64" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2204" y="-22250.64" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2204" y="-22235.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2204" y="-22220.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;expert_1_7 -->
<g id="edge49" class="edge">
<title>ln2_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" d="M2138.84,-22483.61C2114.08,-22474.36 2089.76,-22460.03 2075,-22437.84 2048.91,-22398.61 2052.55,-22373.26 2075,-22331.84 2084.96,-22313.47 2100.87,-22298.48 2118.17,-22286.53"/>
<polygon fill="black" stroke="black" points="2120.31,-22289.31 2126.76,-22280.9 2116.48,-22283.46 2120.31,-22289.31"/>
</g>
<!-- gate_1&#45;&gt;expert_1_0 -->
<g id="edge13" class="edge">
<title>gate_1&#45;&gt;expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2219.8,-22361.48C2073.55,-22342.13 1858.39,-22312.58 1660.88,-22280.96"/>
<polygon fill="black" stroke="black" points="1661.32,-22277.49 1650.89,-22279.36 1660.21,-22284.4 1661.32,-22277.49"/>
<text text-anchor="middle" x="1905.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_1 -->
<g id="edge18" class="edge">
<title>gate_1&#45;&gt;expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2443.59,-22340.51C2461.19,-22326.4 2481.43,-22311.2 2501,-22298.84 2508.09,-22294.36 2515.64,-22289.98 2523.29,-22285.78"/>
<polygon fill="black" stroke="black" points="2525.15,-22288.75 2532.3,-22280.94 2521.83,-22282.59 2525.15,-22288.75"/>
<text text-anchor="middle" x="2546.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_2 -->
<g id="edge23" class="edge">
<title>gate_1&#45;&gt;expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2569.38,-22362.09C2720.34,-22342.94 2943.64,-22313.34 3147.12,-22281.12"/>
<polygon fill="black" stroke="black" points="3147.78,-22284.56 3157.1,-22279.54 3146.68,-22277.65 3147.78,-22284.56"/>
<text text-anchor="middle" x="3070.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_3 -->
<g id="edge28" class="edge">
<title>gate_1&#45;&gt;expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2176.35,-22368.98C1957.19,-22352.68 1608.59,-22323.25 1297.97,-22280.94"/>
<polygon fill="black" stroke="black" points="1298.24,-22277.44 1287.86,-22279.55 1297.29,-22284.38 1298.24,-22277.44"/>
<text text-anchor="middle" x="1611.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_4 -->
<g id="edge33" class="edge">
<title>gate_1&#45;&gt;expert_1_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2497.92,-22349.83C2552.43,-22332.96 2620.37,-22313.19 2682,-22298.84 2724.74,-22288.89 2738.11,-22288.99 2784.09,-22281.14"/>
<polygon fill="black" stroke="black" points="2784.83,-22284.57 2794.08,-22279.4 2783.63,-22277.67 2784.83,-22284.57"/>
<text text-anchor="middle" x="2727.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_5 -->
<g id="edge38" class="edge">
<title>gate_1&#45;&gt;expert_1_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2612.36,-22369.42C2836.02,-22353.38 3193.04,-22324.09 3509.82,-22281.11"/>
<polygon fill="black" stroke="black" points="3510.69,-22284.52 3520.13,-22279.7 3509.75,-22277.59 3510.69,-22284.52"/>
<text text-anchor="middle" x="3405.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_6 -->
<g id="edge43" class="edge">
<title>gate_1&#45;&gt;expert_1_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2268.43,-22353.15C2184.3,-22332.42 2072.98,-22305 1985.03,-22283.33"/>
<polygon fill="black" stroke="black" points="1985.79,-22279.91 1975.25,-22280.92 1984.12,-22286.71 1985.79,-22279.91"/>
<text text-anchor="middle" x="2145.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_1&#45;&gt;expert_1_7 -->
<g id="edge48" class="edge">
<title>gate_1&#45;&gt;expert_1_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2334.49,-22341.74C2310.15,-22324.23 2282.06,-22304.02 2258.2,-22286.84"/>
<polygon fill="black" stroke="black" points="2260.11,-22283.9 2249.94,-22280.9 2256.02,-22289.58 2260.11,-22283.9"/>
<text text-anchor="middle" x="2337.5" y="-22302.64" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_1 -->
<g id="node35" class="node">
<title>expert_agg_1</title>
<polygon fill="lightpink" stroke="black" points="2564.86,-21995.84 2219.88,-21995.84 2131.14,-21859.84 2476.12,-21859.84 2564.86,-21995.84"/>
<text text-anchor="middle" x="2348" y="-21946.64" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2348" y="-21931.64" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2348" y="-21916.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2348" y="-21901.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gate_1&#45;&gt;expert_agg_1 -->
<g id="edge53" class="edge">
<title>gate_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2399.11,-22332.58C2401.64,-22307.14 2404,-22275.91 2404,-22247.84 2404,-22247.84 2404,-22247.84 2404,-22058.34 2404,-22040.63 2399.53,-22022.59 2393.12,-22005.83"/>
<polygon fill="black" stroke="black" points="2396.17,-22004.04 2389.14,-21996.11 2389.69,-22006.69 2396.17,-22004.04"/>
<text text-anchor="middle" x="2432.5" y="-22145.64" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_1_0 -->
<g id="node12" class="node">
<title>expert_gelu_1_0</title>
<polygon fill="lightcyan" stroke="black" points="1567.5,-22175.84 1388.5,-22175.84 1388.5,-22122.84 1567.5,-22122.84 1567.5,-22175.84"/>
<text text-anchor="middle" x="1478" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1478" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1478" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_0&#45;&gt;expert_gelu_1_0 -->
<g id="edge15" class="edge">
<title>expert_1_0&#45;&gt;expert_gelu_1_0</title>
<path fill="none" stroke="black" d="M1478,-22212.71C1478,-22204.13 1478,-22194.85 1478,-22186.14"/>
<polygon fill="black" stroke="black" points="1481.5,-22185.89 1478,-22175.89 1474.5,-22185.89 1481.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_0 -->
<g id="node13" class="node">
<title>expert_ffn2_1_0</title>
<polygon fill="lightcyan" stroke="black" points="1650.5,-22085.84 1305.5,-22085.84 1305.5,-22032.84 1650.5,-22032.84 1650.5,-22085.84"/>
<text text-anchor="middle" x="1478" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1478" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1478" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_0&#45;&gt;expert_ffn2_1_0 -->
<g id="edge16" class="edge">
<title>expert_gelu_1_0&#45;&gt;expert_ffn2_1_0</title>
<path fill="none" stroke="black" d="M1478,-22122.41C1478,-22114.18 1478,-22104.92 1478,-22096.12"/>
<polygon fill="black" stroke="black" points="1481.5,-22096.08 1478,-22086.08 1474.5,-22096.08 1481.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_0&#45;&gt;expert_agg_1 -->
<g id="edge17" class="edge">
<title>expert_ffn2_1_0&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1649.36,-22032.83C1803.52,-22009.89 2028.61,-21976.38 2181.31,-21953.65"/>
<polygon fill="black" stroke="black" points="2181.89,-21957.11 2191.26,-21952.17 2180.86,-21950.18 2181.89,-21957.11"/>
</g>
<!-- expert_gelu_1_1 -->
<g id="node15" class="node">
<title>expert_gelu_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2693.5,-22175.84 2514.5,-22175.84 2514.5,-22122.84 2693.5,-22122.84 2693.5,-22175.84"/>
<text text-anchor="middle" x="2604" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2604" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2604" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_1&#45;&gt;expert_gelu_1_1 -->
<g id="edge20" class="edge">
<title>expert_1_1&#45;&gt;expert_gelu_1_1</title>
<path fill="none" stroke="black" d="M2604,-22212.71C2604,-22204.13 2604,-22194.85 2604,-22186.14"/>
<polygon fill="black" stroke="black" points="2607.5,-22185.89 2604,-22175.89 2600.5,-22185.89 2607.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_1 -->
<g id="node16" class="node">
<title>expert_ffn2_1_1</title>
<polygon fill="lightcyan" stroke="black" points="2776.5,-22085.84 2431.5,-22085.84 2431.5,-22032.84 2776.5,-22032.84 2776.5,-22085.84"/>
<text text-anchor="middle" x="2604" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2604" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2604" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_1&#45;&gt;expert_ffn2_1_1 -->
<g id="edge21" class="edge">
<title>expert_gelu_1_1&#45;&gt;expert_ffn2_1_1</title>
<path fill="none" stroke="black" d="M2604,-22122.41C2604,-22114.18 2604,-22104.92 2604,-22096.12"/>
<polygon fill="black" stroke="black" points="2607.5,-22096.08 2604,-22086.08 2600.5,-22096.08 2607.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_1&#45;&gt;expert_agg_1 -->
<g id="edge22" class="edge">
<title>expert_ffn2_1_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2553.42,-22032.76C2534.71,-22023.29 2512.45,-22012.03 2489.61,-22000.48"/>
<polygon fill="black" stroke="black" points="2491,-21997.25 2480.49,-21995.86 2487.84,-22003.5 2491,-21997.25"/>
</g>
<!-- expert_gelu_1_2 -->
<g id="node18" class="node">
<title>expert_gelu_1_2</title>
<polygon fill="lightcyan" stroke="black" points="3419.5,-22175.84 3240.5,-22175.84 3240.5,-22122.84 3419.5,-22122.84 3419.5,-22175.84"/>
<text text-anchor="middle" x="3330" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3330" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3330" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_2&#45;&gt;expert_gelu_1_2 -->
<g id="edge25" class="edge">
<title>expert_1_2&#45;&gt;expert_gelu_1_2</title>
<path fill="none" stroke="black" d="M3330,-22212.71C3330,-22204.13 3330,-22194.85 3330,-22186.14"/>
<polygon fill="black" stroke="black" points="3333.5,-22185.89 3330,-22175.89 3326.5,-22185.89 3333.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_2 -->
<g id="node19" class="node">
<title>expert_ffn2_1_2</title>
<polygon fill="lightcyan" stroke="black" points="3502.5,-22085.84 3157.5,-22085.84 3157.5,-22032.84 3502.5,-22032.84 3502.5,-22085.84"/>
<text text-anchor="middle" x="3330" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3330" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3330" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_2&#45;&gt;expert_ffn2_1_2 -->
<g id="edge26" class="edge">
<title>expert_gelu_1_2&#45;&gt;expert_ffn2_1_2</title>
<path fill="none" stroke="black" d="M3330,-22122.41C3330,-22114.18 3330,-22104.92 3330,-22096.12"/>
<polygon fill="black" stroke="black" points="3333.5,-22096.08 3330,-22086.08 3326.5,-22096.08 3333.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_2&#45;&gt;expert_agg_1 -->
<g id="edge27" class="edge">
<title>expert_ffn2_1_2&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M3157.08,-22033.94C3154.37,-22033.57 3151.67,-22033.2 3149,-22032.84 2943.98,-22005.09 2709.23,-21974.78 2547.11,-21954.08"/>
<polygon fill="black" stroke="black" points="2547.39,-21950.59 2537.03,-21952.8 2546.5,-21957.54 2547.39,-21950.59"/>
</g>
<!-- expert_gelu_1_3 -->
<g id="node21" class="node">
<title>expert_gelu_1_3</title>
<polygon fill="lightcyan" stroke="black" points="1204.5,-22175.84 1025.5,-22175.84 1025.5,-22122.84 1204.5,-22122.84 1204.5,-22175.84"/>
<text text-anchor="middle" x="1115" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1115" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1115" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_3&#45;&gt;expert_gelu_1_3 -->
<g id="edge30" class="edge">
<title>expert_1_3&#45;&gt;expert_gelu_1_3</title>
<path fill="none" stroke="black" d="M1115,-22212.71C1115,-22204.13 1115,-22194.85 1115,-22186.14"/>
<polygon fill="black" stroke="black" points="1118.5,-22185.89 1115,-22175.89 1111.5,-22185.89 1118.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_3 -->
<g id="node22" class="node">
<title>expert_ffn2_1_3</title>
<polygon fill="lightcyan" stroke="black" points="1287.5,-22085.84 942.5,-22085.84 942.5,-22032.84 1287.5,-22032.84 1287.5,-22085.84"/>
<text text-anchor="middle" x="1115" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1115" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1115" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_3&#45;&gt;expert_ffn2_1_3 -->
<g id="edge31" class="edge">
<title>expert_gelu_1_3&#45;&gt;expert_ffn2_1_3</title>
<path fill="none" stroke="black" d="M1115,-22122.41C1115,-22114.18 1115,-22104.92 1115,-22096.12"/>
<polygon fill="black" stroke="black" points="1118.5,-22096.08 1115,-22086.08 1111.5,-22096.08 1118.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_3&#45;&gt;expert_agg_1 -->
<g id="edge32" class="edge">
<title>expert_ffn2_1_3&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1287.9,-22033.94C1290.95,-22033.57 1293.99,-22033.2 1297,-22032.84 1605.77,-21995.95 1966.7,-21962.29 2175.17,-21943.78"/>
<polygon fill="black" stroke="black" points="2175.63,-21947.25 2185.29,-21942.88 2175.02,-21940.28 2175.63,-21947.25"/>
</g>
<!-- expert_gelu_1_4 -->
<g id="node24" class="node">
<title>expert_gelu_1_4</title>
<polygon fill="lightcyan" stroke="black" points="3056.5,-22175.84 2877.5,-22175.84 2877.5,-22122.84 3056.5,-22122.84 3056.5,-22175.84"/>
<text text-anchor="middle" x="2967" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="2967" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2967" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_4&#45;&gt;expert_gelu_1_4 -->
<g id="edge35" class="edge">
<title>expert_1_4&#45;&gt;expert_gelu_1_4</title>
<path fill="none" stroke="black" d="M2967,-22212.71C2967,-22204.13 2967,-22194.85 2967,-22186.14"/>
<polygon fill="black" stroke="black" points="2970.5,-22185.89 2967,-22175.89 2963.5,-22185.89 2970.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_4 -->
<g id="node25" class="node">
<title>expert_ffn2_1_4</title>
<polygon fill="lightcyan" stroke="black" points="3139.5,-22085.84 2794.5,-22085.84 2794.5,-22032.84 3139.5,-22032.84 3139.5,-22085.84"/>
<text text-anchor="middle" x="2967" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="2967" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2967" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_4&#45;&gt;expert_ffn2_1_4 -->
<g id="edge36" class="edge">
<title>expert_gelu_1_4&#45;&gt;expert_ffn2_1_4</title>
<path fill="none" stroke="black" d="M2967,-22122.41C2967,-22114.18 2967,-22104.92 2967,-22096.12"/>
<polygon fill="black" stroke="black" points="2970.5,-22096.08 2967,-22086.08 2963.5,-22096.08 2970.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_4&#45;&gt;expert_agg_1 -->
<g id="edge37" class="edge">
<title>expert_ffn2_1_4&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2845.07,-22032.83C2763.44,-22015.75 2653.84,-21992.83 2558.33,-21972.84"/>
<polygon fill="black" stroke="black" points="2559.05,-21969.42 2548.54,-21970.8 2557.61,-21976.27 2559.05,-21969.42"/>
</g>
<!-- expert_gelu_1_5 -->
<g id="node27" class="node">
<title>expert_gelu_1_5</title>
<polygon fill="lightcyan" stroke="black" points="3782.5,-22175.84 3603.5,-22175.84 3603.5,-22122.84 3782.5,-22122.84 3782.5,-22175.84"/>
<text text-anchor="middle" x="3693" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3693" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3693" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_5&#45;&gt;expert_gelu_1_5 -->
<g id="edge40" class="edge">
<title>expert_1_5&#45;&gt;expert_gelu_1_5</title>
<path fill="none" stroke="black" d="M3693,-22212.71C3693,-22204.13 3693,-22194.85 3693,-22186.14"/>
<polygon fill="black" stroke="black" points="3696.5,-22185.89 3693,-22175.89 3689.5,-22185.89 3696.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_5 -->
<g id="node28" class="node">
<title>expert_ffn2_1_5</title>
<polygon fill="lightcyan" stroke="black" points="3865.5,-22085.84 3520.5,-22085.84 3520.5,-22032.84 3865.5,-22032.84 3865.5,-22085.84"/>
<text text-anchor="middle" x="3693" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3693" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3693" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_5&#45;&gt;expert_ffn2_1_5 -->
<g id="edge41" class="edge">
<title>expert_gelu_1_5&#45;&gt;expert_ffn2_1_5</title>
<path fill="none" stroke="black" d="M3693,-22122.41C3693,-22114.18 3693,-22104.92 3693,-22096.12"/>
<polygon fill="black" stroke="black" points="3696.5,-22096.08 3693,-22086.08 3689.5,-22096.08 3696.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_5&#45;&gt;expert_agg_1 -->
<g id="edge42" class="edge">
<title>expert_ffn2_1_5&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M3520.1,-22033.79C3517.38,-22033.47 3514.68,-22033.15 3512,-22032.84 3170.52,-21993.56 2771.22,-21960.72 2540.19,-21943"/>
<polygon fill="black" stroke="black" points="2540.24,-21939.5 2530,-21942.22 2539.7,-21946.48 2540.24,-21939.5"/>
</g>
<!-- expert_gelu_1_6 -->
<g id="node30" class="node">
<title>expert_gelu_1_6</title>
<polygon fill="lightcyan" stroke="black" points="1930.5,-22175.84 1751.5,-22175.84 1751.5,-22122.84 1930.5,-22122.84 1930.5,-22175.84"/>
<text text-anchor="middle" x="1841" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1841" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1841" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_6&#45;&gt;expert_gelu_1_6 -->
<g id="edge45" class="edge">
<title>expert_1_6&#45;&gt;expert_gelu_1_6</title>
<path fill="none" stroke="black" d="M1841,-22212.71C1841,-22204.13 1841,-22194.85 1841,-22186.14"/>
<polygon fill="black" stroke="black" points="1844.5,-22185.89 1841,-22175.89 1837.5,-22185.89 1844.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_6 -->
<g id="node31" class="node">
<title>expert_ffn2_1_6</title>
<polygon fill="lightcyan" stroke="black" points="2013.5,-22085.84 1668.5,-22085.84 1668.5,-22032.84 2013.5,-22032.84 2013.5,-22085.84"/>
<text text-anchor="middle" x="1841" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1841" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1841" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_6&#45;&gt;expert_ffn2_1_6 -->
<g id="edge46" class="edge">
<title>expert_gelu_1_6&#45;&gt;expert_ffn2_1_6</title>
<path fill="none" stroke="black" d="M1841,-22122.41C1841,-22114.18 1841,-22104.92 1841,-22096.12"/>
<polygon fill="black" stroke="black" points="1844.5,-22096.08 1841,-22086.08 1837.5,-22096.08 1844.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_6&#45;&gt;expert_agg_1 -->
<g id="edge47" class="edge">
<title>expert_ffn2_1_6&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M1940.86,-22032.83C2011.97,-22014.67 2108.97,-21989.9 2190.45,-21969.08"/>
<polygon fill="black" stroke="black" points="2191.49,-21972.43 2200.31,-21966.57 2189.75,-21965.65 2191.49,-21972.43"/>
</g>
<!-- expert_gelu_1_7 -->
<g id="node33" class="node">
<title>expert_gelu_1_7</title>
<polygon fill="lightcyan" stroke="black" points="2293.5,-22175.84 2114.5,-22175.84 2114.5,-22122.84 2293.5,-22122.84 2293.5,-22175.84"/>
<text text-anchor="middle" x="2204" y="-22160.64" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2204" y="-22145.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2204" y="-22130.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_1_7&#45;&gt;expert_gelu_1_7 -->
<g id="edge50" class="edge">
<title>expert_1_7&#45;&gt;expert_gelu_1_7</title>
<path fill="none" stroke="black" d="M2204,-22212.71C2204,-22204.13 2204,-22194.85 2204,-22186.14"/>
<polygon fill="black" stroke="black" points="2207.5,-22185.89 2204,-22175.89 2200.5,-22185.89 2207.5,-22185.89"/>
</g>
<!-- expert_ffn2_1_7 -->
<g id="node34" class="node">
<title>expert_ffn2_1_7</title>
<polygon fill="lightcyan" stroke="black" points="2376.5,-22085.84 2031.5,-22085.84 2031.5,-22032.84 2376.5,-22032.84 2376.5,-22085.84"/>
<text text-anchor="middle" x="2204" y="-22070.64" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2204" y="-22055.64" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2204" y="-22040.64" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- expert_gelu_1_7&#45;&gt;expert_ffn2_1_7 -->
<g id="edge51" class="edge">
<title>expert_gelu_1_7&#45;&gt;expert_ffn2_1_7</title>
<path fill="none" stroke="black" d="M2204,-22122.41C2204,-22114.18 2204,-22104.92 2204,-22096.12"/>
<polygon fill="black" stroke="black" points="2207.5,-22096.08 2204,-22086.08 2200.5,-22096.08 2207.5,-22096.08"/>
</g>
<!-- expert_ffn2_1_7&#45;&gt;expert_agg_1 -->
<g id="edge52" class="edge">
<title>expert_ffn2_1_7&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="black" d="M2232.45,-22032.76C2242.29,-22023.91 2253.87,-22013.49 2265.84,-22002.73"/>
<polygon fill="black" stroke="black" points="2268.23,-22005.29 2273.32,-21996 2263.55,-22000.08 2268.23,-22005.29"/>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge55" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M2161.13,-21906.33C1936.32,-21881.65 1554.28,-21839.71 1274.69,-21809.01"/>
<polygon fill="black" stroke="black" points="1274.7,-21805.49 1264.37,-21807.88 1273.93,-21812.45 1274.7,-21805.49"/>
</g>
<!-- comm_1_2 -->
<g id="node72" class="node">
<title>comm_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="927" cy="-21652.97" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="927" y="-21656.77" font-family="Times,serif" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="927" y="-21641.77" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_1&#45;&gt;comm_1_2 -->
<g id="edge56" class="edge">
<title>residual2_1&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M927,-21716.78C927,-21707.85 927,-21698.75 927,-21690.34"/>
<polygon fill="black" stroke="black" points="930.5,-21690.13 927,-21680.13 923.5,-21690.13 930.5,-21690.13"/>
</g>
<!-- ln1_2 -->
<g id="node37" class="node">
<title>ln1_2</title>
<polygon fill="lightyellow" stroke="black" points="785,-21589.1 615,-21589.1 615,-21536.1 785,-21536.1 785,-21589.1"/>
<text text-anchor="middle" x="700" y="-21573.9" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="700" y="-21558.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="700" y="-21543.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_q_2 -->
<g id="node38" class="node">
<title>mha_q_2</title>
<polygon fill="lightblue" stroke="black" points="1044,-21499.1 708,-21499.1 708,-21446.1 1044,-21446.1 1044,-21499.1"/>
<text text-anchor="middle" x="876" y="-21483.9" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="876" y="-21468.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="876" y="-21453.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_q_2 -->
<g id="edge58" class="edge">
<title>ln1_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M751.38,-21535.91C771.53,-21525.84 794.8,-21514.2 815.74,-21503.73"/>
<polygon fill="black" stroke="black" points="817.48,-21506.77 824.86,-21499.17 814.35,-21500.51 817.48,-21506.77"/>
</g>
<!-- mha_k_2 -->
<g id="node39" class="node">
<title>mha_k_2</title>
<polygon fill="lightblue" stroke="black" points="336,-21499.1 0,-21499.1 0,-21446.1 336,-21446.1 336,-21499.1"/>
<text text-anchor="middle" x="168" y="-21483.9" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="168" y="-21468.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="168" y="-21453.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_k_2 -->
<g id="edge59" class="edge">
<title>ln1_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M614.82,-21547.51C538.99,-21534.97 425.93,-21516.27 332.51,-21500.81"/>
<polygon fill="black" stroke="black" points="332.82,-21497.32 322.38,-21499.14 331.68,-21504.22 332.82,-21497.32"/>
</g>
<!-- mha_v_2 -->
<g id="node40" class="node">
<title>mha_v_2</title>
<polygon fill="lightblue" stroke="black" points="690,-21499.1 354,-21499.1 354,-21446.1 690,-21446.1 690,-21499.1"/>
<text text-anchor="middle" x="522" y="-21483.9" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="522" y="-21468.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="522" y="-21453.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_v_2 -->
<g id="edge60" class="edge">
<title>ln1_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M648.04,-21535.91C627.66,-21525.84 604.12,-21514.2 582.95,-21503.73"/>
<polygon fill="black" stroke="black" points="584.24,-21500.47 573.72,-21499.17 581.13,-21506.74 584.24,-21500.47"/>
</g>
<!-- mha_attn_2 -->
<g id="node41" class="node">
<title>mha_attn_2</title>
<polygon fill="lightblue" stroke="black" points="693,-21409.1 523,-21409.1 523,-21356.1 693,-21356.1 693,-21409.1"/>
<text text-anchor="middle" x="608" y="-21393.9" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="608" y="-21378.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="608" y="-21363.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge61" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M798.12,-21446.03C766.05,-21435.5 728.75,-21423.25 695.72,-21412.4"/>
<polygon fill="black" stroke="black" points="696.66,-21409.03 686.07,-21409.24 694.48,-21415.68 696.66,-21409.03"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge62" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M295.56,-21446.09C364.94,-21432.21 449.3,-21415.34 512.87,-21402.63"/>
<polygon fill="black" stroke="black" points="513.77,-21406.02 522.89,-21400.62 512.39,-21399.15 513.77,-21406.02"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge63" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M547.34,-21445.67C556.26,-21436.54 566.41,-21426.16 575.82,-21416.53"/>
<polygon fill="black" stroke="black" points="578.36,-21418.94 582.84,-21409.34 573.35,-21414.05 578.36,-21418.94"/>
</g>
<!-- mha_out_2 -->
<g id="node42" class="node">
<title>mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="794,-21319.1 458,-21319.1 458,-21266.1 794,-21266.1 794,-21319.1"/>
<text text-anchor="middle" x="626" y="-21303.9" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="626" y="-21288.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="626" y="-21273.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge64" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M613.3,-21355.67C614.99,-21347.44 616.88,-21338.18 618.68,-21329.38"/>
<polygon fill="black" stroke="black" points="622.16,-21329.84 620.73,-21319.34 615.3,-21328.44 622.16,-21329.84"/>
</g>
<!-- residual1_2 -->
<g id="node43" class="node">
<title>residual1_2</title>
<polygon fill="lightcoral" stroke="black" points="1327.86,-21229.1 758.58,-21229.1 612.14,-21123.1 1181.42,-21123.1 1327.86,-21229.1"/>
<text text-anchor="middle" x="970" y="-21187.4" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="970" y="-21172.4" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="970" y="-21157.4" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge66" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M702.77,-21266.05C732.73,-21256.08 768.31,-21244.23 803.58,-21232.49"/>
<polygon fill="black" stroke="black" points="805.13,-21235.67 813.51,-21229.19 802.92,-21229.03 805.13,-21235.67"/>
</g>
<!-- ln2_2 -->
<g id="node44" class="node">
<title>ln2_2</title>
<polygon fill="lightyellow" stroke="black" points="2352,-21086.1 2182,-21086.1 2182,-21033.1 2352,-21033.1 2352,-21086.1"/>
<text text-anchor="middle" x="2267" y="-21070.9" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2267" y="-21055.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2267" y="-21040.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge67" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M1222.77,-21152.79C1512.74,-21127.19 1973.62,-21086.5 2171.56,-21069.03"/>
<polygon fill="black" stroke="black" points="2171.99,-21072.5 2181.64,-21068.14 2171.37,-21065.53 2171.99,-21072.5"/>
</g>
<!-- residual2_2 -->
<g id="node71" class="node">
<title>residual2_2</title>
<polygon fill="lightcoral" stroke="black" points="1327.86,-20381.1 758.58,-20381.1 612.14,-20275.1 1181.42,-20275.1 1327.86,-20381.1"/>
<text text-anchor="middle" x="970" y="-20339.4" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="970" y="-20324.4" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="970" y="-20309.4" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge110" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M962.23,-21123.07C959.92,-21103.53 958,-21081.09 958,-21060.6 958,-21060.6 958,-21060.6 958,-20485.1 958,-20454.26 960.36,-20420.08 962.99,-20391.6"/>
<polygon fill="black" stroke="black" points="966.5,-20391.67 963.96,-20381.38 959.53,-20391 966.5,-20391.67"/>
</g>
<!-- gate_2 -->
<g id="node45" class="node">
<title>gate_2</title>
<polygon fill="orange" stroke="black" points="2436,-20996.1 2127,-20943.1 2436,-20890.1 2745,-20943.1 2436,-20996.1"/>
<text text-anchor="middle" x="2436" y="-20954.4" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2436" y="-20939.4" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2436" y="-20924.4" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;gate_2 -->
<g id="edge68" class="edge">
<title>ln2_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M2304.93,-21032.91C2323.05,-21020.62 2345.34,-21005.52 2366.36,-20991.28"/>
<polygon fill="black" stroke="black" points="2368.34,-20994.17 2374.65,-20985.67 2364.41,-20988.38 2368.34,-20994.17"/>
</g>
<!-- expert_2_0 -->
<g id="node46" class="node">
<title>expert_2_0</title>
<polygon fill="lightcyan" stroke="black" points="1693.5,-20839.1 1348.5,-20839.1 1348.5,-20771.1 1693.5,-20771.1 1693.5,-20839.1"/>
<text text-anchor="middle" x="1521" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1521" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1521" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1521" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_0 -->
<g id="edge70" class="edge">
<title>ln2_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" d="M2181.9,-21050.95C2046.44,-21035.5 1777.43,-20991.23 1585,-20872.1 1573.97,-20865.27 1563.49,-20856.13 1554.33,-20846.83"/>
<polygon fill="black" stroke="black" points="1556.69,-20844.23 1547.28,-20839.37 1551.61,-20849.04 1556.69,-20844.23"/>
</g>
<!-- expert_2_1 -->
<g id="node49" class="node">
<title>expert_2_1</title>
<polygon fill="lightcyan" stroke="black" points="2819.5,-20839.1 2474.5,-20839.1 2474.5,-20771.1 2819.5,-20771.1 2819.5,-20839.1"/>
<text text-anchor="middle" x="2647" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2647" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2647" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2647" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_1 -->
<g id="edge75" class="edge">
<title>ln2_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" d="M2352.19,-21053.57C2484.57,-21044.89 2727.35,-21025.19 2754,-20996.1 2795.76,-20950.52 2792.45,-20909.09 2759,-20857.1 2756.46,-20853.15 2753.53,-20849.51 2750.3,-20846.14"/>
<polygon fill="black" stroke="black" points="2752.5,-20843.41 2742.77,-20839.21 2747.76,-20848.56 2752.5,-20843.41"/>
</g>
<!-- expert_2_2 -->
<g id="node52" class="node">
<title>expert_2_2</title>
<polygon fill="lightcyan" stroke="black" points="3545.5,-20839.1 3200.5,-20839.1 3200.5,-20771.1 3545.5,-20771.1 3545.5,-20839.1"/>
<text text-anchor="middle" x="3373" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3373" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3373" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3373" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_2 -->
<g id="edge80" class="edge">
<title>ln2_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" d="M2352.15,-21052.57C2448.25,-21045.38 2609.15,-21032.15 2747,-21015.1 3015.63,-20981.87 3127.89,-21041.52 3339,-20872.1 3346.76,-20865.87 3352.93,-20857.4 3357.77,-20848.61"/>
<polygon fill="black" stroke="black" points="3361.02,-20849.91 3362.33,-20839.4 3354.75,-20846.8 3361.02,-20849.91"/>
</g>
<!-- expert_2_3 -->
<g id="node55" class="node">
<title>expert_2_3</title>
<polygon fill="lightcyan" stroke="black" points="1330.5,-20839.1 985.5,-20839.1 985.5,-20771.1 1330.5,-20771.1 1330.5,-20839.1"/>
<text text-anchor="middle" x="1158" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1158" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1158" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1158" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_3 -->
<g id="edge85" class="edge">
<title>ln2_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" d="M2181.88,-21058.59C2055.59,-21056.76 1811.99,-21046.26 1612,-20996.1 1470.92,-20960.72 1316.73,-20888.38 1229.23,-20843.88"/>
<polygon fill="black" stroke="black" points="1230.7,-20840.7 1220.2,-20839.26 1227.51,-20846.93 1230.7,-20840.7"/>
</g>
<!-- expert_2_4 -->
<g id="node58" class="node">
<title>expert_2_4</title>
<polygon fill="lightcyan" stroke="black" points="3182.5,-20839.1 2837.5,-20839.1 2837.5,-20771.1 3182.5,-20771.1 3182.5,-20839.1"/>
<text text-anchor="middle" x="3010" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3010" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3010" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3010" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_4 -->
<g id="edge90" class="edge">
<title>ln2_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" d="M2352.24,-21055.74C2479.1,-21050.23 2710.45,-21035.05 2783,-20996.1 2857.26,-20956.23 2929.54,-20889.46 2971.9,-20846.62"/>
<polygon fill="black" stroke="black" points="2974.44,-20849.03 2978.95,-20839.44 2969.45,-20844.13 2974.44,-20849.03"/>
</g>
<!-- expert_2_5 -->
<g id="node61" class="node">
<title>expert_2_5</title>
<polygon fill="lightcyan" stroke="black" points="3908.5,-20839.1 3563.5,-20839.1 3563.5,-20771.1 3908.5,-20771.1 3908.5,-20839.1"/>
<text text-anchor="middle" x="3736" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3736" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3736" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3736" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_5 -->
<g id="edge95" class="edge">
<title>ln2_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" d="M2352.22,-21055.82C2550.12,-21048.88 3036.08,-21028.98 3196,-20996.1 3363.02,-20961.77 3548.72,-20888.11 3653.04,-20843.26"/>
<polygon fill="black" stroke="black" points="3654.46,-20846.46 3662.26,-20839.28 3651.69,-20840.03 3654.46,-20846.46"/>
</g>
<!-- expert_2_6 -->
<g id="node64" class="node">
<title>expert_2_6</title>
<polygon fill="lightcyan" stroke="black" points="2056.5,-20839.1 1711.5,-20839.1 1711.5,-20771.1 2056.5,-20771.1 2056.5,-20839.1"/>
<text text-anchor="middle" x="1884" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1884" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1884" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1884" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_6 -->
<g id="edge100" class="edge">
<title>ln2_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" d="M2181.67,-21034.27C2164.35,-21028.57 2146.42,-21022.09 2130,-21015.1 2030.2,-20972.62 2025.24,-20928.97 1944,-20857.1 1939.9,-20853.48 1935.62,-20849.74 1931.32,-20846.02"/>
<polygon fill="black" stroke="black" points="1933.43,-20843.22 1923.57,-20839.35 1928.86,-20848.53 1933.43,-20843.22"/>
</g>
<!-- expert_2_7 -->
<g id="node67" class="node">
<title>expert_2_7</title>
<polygon fill="lightcyan" stroke="black" points="2419.5,-20839.1 2074.5,-20839.1 2074.5,-20771.1 2419.5,-20771.1 2419.5,-20839.1"/>
<text text-anchor="middle" x="2247" y="-20823.9" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2247" y="-20808.9" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2247" y="-20793.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2247" y="-20778.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;expert_2_7 -->
<g id="edge105" class="edge">
<title>ln2_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" d="M2181.84,-21041.87C2157.08,-21032.62 2132.76,-21018.29 2118,-20996.1 2091.91,-20956.87 2095.55,-20931.52 2118,-20890.1 2127.96,-20871.73 2143.87,-20856.74 2161.17,-20844.79"/>
<polygon fill="black" stroke="black" points="2163.31,-20847.57 2169.76,-20839.16 2159.48,-20841.72 2163.31,-20847.57"/>
</g>
<!-- gate_2&#45;&gt;expert_2_0 -->
<g id="edge69" class="edge">
<title>gate_2&#45;&gt;expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2262.8,-20919.74C2116.55,-20900.39 1901.39,-20870.84 1703.88,-20839.22"/>
<polygon fill="black" stroke="black" points="1704.32,-20835.75 1693.89,-20837.62 1703.21,-20842.66 1704.32,-20835.75"/>
<text text-anchor="middle" x="1948.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_1 -->
<g id="edge74" class="edge">
<title>gate_2&#45;&gt;expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2486.59,-20898.77C2504.19,-20884.66 2524.43,-20869.46 2544,-20857.1 2551.09,-20852.62 2558.64,-20848.24 2566.29,-20844.04"/>
<polygon fill="black" stroke="black" points="2568.15,-20847.01 2575.3,-20839.2 2564.83,-20840.85 2568.15,-20847.01"/>
<text text-anchor="middle" x="2589.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_2 -->
<g id="edge79" class="edge">
<title>gate_2&#45;&gt;expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2612.38,-20920.35C2763.34,-20901.2 2986.64,-20871.6 3190.12,-20839.38"/>
<polygon fill="black" stroke="black" points="3190.78,-20842.82 3200.1,-20837.8 3189.68,-20835.91 3190.78,-20842.82"/>
<text text-anchor="middle" x="3113.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_3 -->
<g id="edge84" class="edge">
<title>gate_2&#45;&gt;expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2219.35,-20927.24C2000.19,-20910.94 1651.59,-20881.51 1340.97,-20839.2"/>
<polygon fill="black" stroke="black" points="1341.24,-20835.7 1330.86,-20837.81 1340.29,-20842.64 1341.24,-20835.7"/>
<text text-anchor="middle" x="1654.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_4 -->
<g id="edge89" class="edge">
<title>gate_2&#45;&gt;expert_2_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2540.92,-20908.09C2595.43,-20891.22 2663.37,-20871.45 2725,-20857.1 2767.74,-20847.15 2781.11,-20847.25 2827.09,-20839.4"/>
<polygon fill="black" stroke="black" points="2827.83,-20842.83 2837.08,-20837.66 2826.63,-20835.93 2827.83,-20842.83"/>
<text text-anchor="middle" x="2770.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_5 -->
<g id="edge94" class="edge">
<title>gate_2&#45;&gt;expert_2_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2655.36,-20927.68C2879.02,-20911.64 3236.04,-20882.35 3552.82,-20839.37"/>
<polygon fill="black" stroke="black" points="3553.69,-20842.78 3563.13,-20837.96 3552.75,-20835.85 3553.69,-20842.78"/>
<text text-anchor="middle" x="3448.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_6 -->
<g id="edge99" class="edge">
<title>gate_2&#45;&gt;expert_2_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2311.43,-20911.41C2227.3,-20890.68 2115.98,-20863.26 2028.03,-20841.59"/>
<polygon fill="black" stroke="black" points="2028.79,-20838.17 2018.25,-20839.18 2027.12,-20844.97 2028.79,-20838.17"/>
<text text-anchor="middle" x="2188.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_2&#45;&gt;expert_2_7 -->
<g id="edge104" class="edge">
<title>gate_2&#45;&gt;expert_2_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2377.49,-20900C2353.15,-20882.49 2325.06,-20862.28 2301.2,-20845.1"/>
<polygon fill="black" stroke="black" points="2303.11,-20842.16 2292.94,-20839.16 2299.02,-20847.84 2303.11,-20842.16"/>
<text text-anchor="middle" x="2380.5" y="-20860.9" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_2 -->
<g id="node70" class="node">
<title>expert_agg_2</title>
<polygon fill="lightpink" stroke="black" points="2607.86,-20554.1 2262.88,-20554.1 2174.14,-20418.1 2519.12,-20418.1 2607.86,-20554.1"/>
<text text-anchor="middle" x="2391" y="-20504.9" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2391" y="-20489.9" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2391" y="-20474.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2391" y="-20459.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gate_2&#45;&gt;expert_agg_2 -->
<g id="edge109" class="edge">
<title>gate_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2442.11,-20890.84C2444.64,-20865.4 2447,-20834.17 2447,-20806.1 2447,-20806.1 2447,-20806.1 2447,-20616.6 2447,-20598.89 2442.53,-20580.85 2436.12,-20564.09"/>
<polygon fill="black" stroke="black" points="2439.17,-20562.3 2432.14,-20554.37 2432.69,-20564.95 2439.17,-20562.3"/>
<text text-anchor="middle" x="2475.5" y="-20703.9" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_2_0 -->
<g id="node47" class="node">
<title>expert_gelu_2_0</title>
<polygon fill="lightcyan" stroke="black" points="1610.5,-20734.1 1431.5,-20734.1 1431.5,-20681.1 1610.5,-20681.1 1610.5,-20734.1"/>
<text text-anchor="middle" x="1521" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1521" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1521" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_0&#45;&gt;expert_gelu_2_0 -->
<g id="edge71" class="edge">
<title>expert_2_0&#45;&gt;expert_gelu_2_0</title>
<path fill="none" stroke="black" d="M1521,-20770.97C1521,-20762.39 1521,-20753.11 1521,-20744.4"/>
<polygon fill="black" stroke="black" points="1524.5,-20744.15 1521,-20734.15 1517.5,-20744.15 1524.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_0 -->
<g id="node48" class="node">
<title>expert_ffn2_2_0</title>
<polygon fill="lightcyan" stroke="black" points="1693.5,-20644.1 1348.5,-20644.1 1348.5,-20591.1 1693.5,-20591.1 1693.5,-20644.1"/>
<text text-anchor="middle" x="1521" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1521" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1521" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_0&#45;&gt;expert_ffn2_2_0 -->
<g id="edge72" class="edge">
<title>expert_gelu_2_0&#45;&gt;expert_ffn2_2_0</title>
<path fill="none" stroke="black" d="M1521,-20680.67C1521,-20672.44 1521,-20663.18 1521,-20654.38"/>
<polygon fill="black" stroke="black" points="1524.5,-20654.34 1521,-20644.34 1517.5,-20654.34 1524.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_0&#45;&gt;expert_agg_2 -->
<g id="edge73" class="edge">
<title>expert_ffn2_2_0&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1692.36,-20591.09C1846.52,-20568.15 2071.61,-20534.64 2224.31,-20511.91"/>
<polygon fill="black" stroke="black" points="2224.89,-20515.37 2234.26,-20510.43 2223.86,-20508.44 2224.89,-20515.37"/>
</g>
<!-- expert_gelu_2_1 -->
<g id="node50" class="node">
<title>expert_gelu_2_1</title>
<polygon fill="lightcyan" stroke="black" points="2736.5,-20734.1 2557.5,-20734.1 2557.5,-20681.1 2736.5,-20681.1 2736.5,-20734.1"/>
<text text-anchor="middle" x="2647" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2647" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2647" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_1&#45;&gt;expert_gelu_2_1 -->
<g id="edge76" class="edge">
<title>expert_2_1&#45;&gt;expert_gelu_2_1</title>
<path fill="none" stroke="black" d="M2647,-20770.97C2647,-20762.39 2647,-20753.11 2647,-20744.4"/>
<polygon fill="black" stroke="black" points="2650.5,-20744.15 2647,-20734.15 2643.5,-20744.15 2650.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_1 -->
<g id="node51" class="node">
<title>expert_ffn2_2_1</title>
<polygon fill="lightcyan" stroke="black" points="2819.5,-20644.1 2474.5,-20644.1 2474.5,-20591.1 2819.5,-20591.1 2819.5,-20644.1"/>
<text text-anchor="middle" x="2647" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2647" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2647" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_1&#45;&gt;expert_ffn2_2_1 -->
<g id="edge77" class="edge">
<title>expert_gelu_2_1&#45;&gt;expert_ffn2_2_1</title>
<path fill="none" stroke="black" d="M2647,-20680.67C2647,-20672.44 2647,-20663.18 2647,-20654.38"/>
<polygon fill="black" stroke="black" points="2650.5,-20654.34 2647,-20644.34 2643.5,-20654.34 2650.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_1&#45;&gt;expert_agg_2 -->
<g id="edge78" class="edge">
<title>expert_ffn2_2_1&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2596.42,-20591.02C2577.71,-20581.55 2555.45,-20570.29 2532.61,-20558.74"/>
<polygon fill="black" stroke="black" points="2534,-20555.51 2523.49,-20554.12 2530.84,-20561.76 2534,-20555.51"/>
</g>
<!-- expert_gelu_2_2 -->
<g id="node53" class="node">
<title>expert_gelu_2_2</title>
<polygon fill="lightcyan" stroke="black" points="3462.5,-20734.1 3283.5,-20734.1 3283.5,-20681.1 3462.5,-20681.1 3462.5,-20734.1"/>
<text text-anchor="middle" x="3373" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3373" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3373" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_2&#45;&gt;expert_gelu_2_2 -->
<g id="edge81" class="edge">
<title>expert_2_2&#45;&gt;expert_gelu_2_2</title>
<path fill="none" stroke="black" d="M3373,-20770.97C3373,-20762.39 3373,-20753.11 3373,-20744.4"/>
<polygon fill="black" stroke="black" points="3376.5,-20744.15 3373,-20734.15 3369.5,-20744.15 3376.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_2 -->
<g id="node54" class="node">
<title>expert_ffn2_2_2</title>
<polygon fill="lightcyan" stroke="black" points="3545.5,-20644.1 3200.5,-20644.1 3200.5,-20591.1 3545.5,-20591.1 3545.5,-20644.1"/>
<text text-anchor="middle" x="3373" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3373" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3373" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_2&#45;&gt;expert_ffn2_2_2 -->
<g id="edge82" class="edge">
<title>expert_gelu_2_2&#45;&gt;expert_ffn2_2_2</title>
<path fill="none" stroke="black" d="M3373,-20680.67C3373,-20672.44 3373,-20663.18 3373,-20654.38"/>
<polygon fill="black" stroke="black" points="3376.5,-20654.34 3373,-20644.34 3369.5,-20654.34 3376.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_2&#45;&gt;expert_agg_2 -->
<g id="edge83" class="edge">
<title>expert_ffn2_2_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M3200.08,-20592.2C3197.37,-20591.83 3194.67,-20591.46 3192,-20591.1 2986.98,-20563.35 2752.23,-20533.04 2590.11,-20512.34"/>
<polygon fill="black" stroke="black" points="2590.39,-20508.85 2580.03,-20511.06 2589.5,-20515.8 2590.39,-20508.85"/>
</g>
<!-- expert_gelu_2_3 -->
<g id="node56" class="node">
<title>expert_gelu_2_3</title>
<polygon fill="lightcyan" stroke="black" points="1247.5,-20734.1 1068.5,-20734.1 1068.5,-20681.1 1247.5,-20681.1 1247.5,-20734.1"/>
<text text-anchor="middle" x="1158" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1158" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1158" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_3&#45;&gt;expert_gelu_2_3 -->
<g id="edge86" class="edge">
<title>expert_2_3&#45;&gt;expert_gelu_2_3</title>
<path fill="none" stroke="black" d="M1158,-20770.97C1158,-20762.39 1158,-20753.11 1158,-20744.4"/>
<polygon fill="black" stroke="black" points="1161.5,-20744.15 1158,-20734.15 1154.5,-20744.15 1161.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_3 -->
<g id="node57" class="node">
<title>expert_ffn2_2_3</title>
<polygon fill="lightcyan" stroke="black" points="1330.5,-20644.1 985.5,-20644.1 985.5,-20591.1 1330.5,-20591.1 1330.5,-20644.1"/>
<text text-anchor="middle" x="1158" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1158" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1158" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_3&#45;&gt;expert_ffn2_2_3 -->
<g id="edge87" class="edge">
<title>expert_gelu_2_3&#45;&gt;expert_ffn2_2_3</title>
<path fill="none" stroke="black" d="M1158,-20680.67C1158,-20672.44 1158,-20663.18 1158,-20654.38"/>
<polygon fill="black" stroke="black" points="1161.5,-20654.34 1158,-20644.34 1154.5,-20654.34 1161.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_3&#45;&gt;expert_agg_2 -->
<g id="edge88" class="edge">
<title>expert_ffn2_2_3&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1330.9,-20592.2C1333.95,-20591.83 1336.99,-20591.46 1340,-20591.1 1648.77,-20554.21 2009.7,-20520.55 2218.17,-20502.04"/>
<polygon fill="black" stroke="black" points="2218.63,-20505.51 2228.29,-20501.14 2218.02,-20498.54 2218.63,-20505.51"/>
</g>
<!-- expert_gelu_2_4 -->
<g id="node59" class="node">
<title>expert_gelu_2_4</title>
<polygon fill="lightcyan" stroke="black" points="3099.5,-20734.1 2920.5,-20734.1 2920.5,-20681.1 3099.5,-20681.1 3099.5,-20734.1"/>
<text text-anchor="middle" x="3010" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3010" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3010" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_4&#45;&gt;expert_gelu_2_4 -->
<g id="edge91" class="edge">
<title>expert_2_4&#45;&gt;expert_gelu_2_4</title>
<path fill="none" stroke="black" d="M3010,-20770.97C3010,-20762.39 3010,-20753.11 3010,-20744.4"/>
<polygon fill="black" stroke="black" points="3013.5,-20744.15 3010,-20734.15 3006.5,-20744.15 3013.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_4 -->
<g id="node60" class="node">
<title>expert_ffn2_2_4</title>
<polygon fill="lightcyan" stroke="black" points="3182.5,-20644.1 2837.5,-20644.1 2837.5,-20591.1 3182.5,-20591.1 3182.5,-20644.1"/>
<text text-anchor="middle" x="3010" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3010" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3010" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_4&#45;&gt;expert_ffn2_2_4 -->
<g id="edge92" class="edge">
<title>expert_gelu_2_4&#45;&gt;expert_ffn2_2_4</title>
<path fill="none" stroke="black" d="M3010,-20680.67C3010,-20672.44 3010,-20663.18 3010,-20654.38"/>
<polygon fill="black" stroke="black" points="3013.5,-20654.34 3010,-20644.34 3006.5,-20654.34 3013.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_4&#45;&gt;expert_agg_2 -->
<g id="edge93" class="edge">
<title>expert_ffn2_2_4&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2888.07,-20591.09C2806.44,-20574.01 2696.84,-20551.09 2601.33,-20531.1"/>
<polygon fill="black" stroke="black" points="2602.05,-20527.68 2591.54,-20529.06 2600.61,-20534.53 2602.05,-20527.68"/>
</g>
<!-- expert_gelu_2_5 -->
<g id="node62" class="node">
<title>expert_gelu_2_5</title>
<polygon fill="lightcyan" stroke="black" points="3825.5,-20734.1 3646.5,-20734.1 3646.5,-20681.1 3825.5,-20681.1 3825.5,-20734.1"/>
<text text-anchor="middle" x="3736" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3736" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3736" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_5&#45;&gt;expert_gelu_2_5 -->
<g id="edge96" class="edge">
<title>expert_2_5&#45;&gt;expert_gelu_2_5</title>
<path fill="none" stroke="black" d="M3736,-20770.97C3736,-20762.39 3736,-20753.11 3736,-20744.4"/>
<polygon fill="black" stroke="black" points="3739.5,-20744.15 3736,-20734.15 3732.5,-20744.15 3739.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_5 -->
<g id="node63" class="node">
<title>expert_ffn2_2_5</title>
<polygon fill="lightcyan" stroke="black" points="3908.5,-20644.1 3563.5,-20644.1 3563.5,-20591.1 3908.5,-20591.1 3908.5,-20644.1"/>
<text text-anchor="middle" x="3736" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3736" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3736" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_5&#45;&gt;expert_ffn2_2_5 -->
<g id="edge97" class="edge">
<title>expert_gelu_2_5&#45;&gt;expert_ffn2_2_5</title>
<path fill="none" stroke="black" d="M3736,-20680.67C3736,-20672.44 3736,-20663.18 3736,-20654.38"/>
<polygon fill="black" stroke="black" points="3739.5,-20654.34 3736,-20644.34 3732.5,-20654.34 3739.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_5&#45;&gt;expert_agg_2 -->
<g id="edge98" class="edge">
<title>expert_ffn2_2_5&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M3563.1,-20592.05C3560.38,-20591.73 3557.68,-20591.41 3555,-20591.1 3213.52,-20551.82 2814.22,-20518.98 2583.19,-20501.26"/>
<polygon fill="black" stroke="black" points="2583.24,-20497.76 2573,-20500.48 2582.7,-20504.74 2583.24,-20497.76"/>
</g>
<!-- expert_gelu_2_6 -->
<g id="node65" class="node">
<title>expert_gelu_2_6</title>
<polygon fill="lightcyan" stroke="black" points="1973.5,-20734.1 1794.5,-20734.1 1794.5,-20681.1 1973.5,-20681.1 1973.5,-20734.1"/>
<text text-anchor="middle" x="1884" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1884" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1884" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_6&#45;&gt;expert_gelu_2_6 -->
<g id="edge101" class="edge">
<title>expert_2_6&#45;&gt;expert_gelu_2_6</title>
<path fill="none" stroke="black" d="M1884,-20770.97C1884,-20762.39 1884,-20753.11 1884,-20744.4"/>
<polygon fill="black" stroke="black" points="1887.5,-20744.15 1884,-20734.15 1880.5,-20744.15 1887.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_6 -->
<g id="node66" class="node">
<title>expert_ffn2_2_6</title>
<polygon fill="lightcyan" stroke="black" points="2056.5,-20644.1 1711.5,-20644.1 1711.5,-20591.1 2056.5,-20591.1 2056.5,-20644.1"/>
<text text-anchor="middle" x="1884" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1884" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1884" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_6&#45;&gt;expert_ffn2_2_6 -->
<g id="edge102" class="edge">
<title>expert_gelu_2_6&#45;&gt;expert_ffn2_2_6</title>
<path fill="none" stroke="black" d="M1884,-20680.67C1884,-20672.44 1884,-20663.18 1884,-20654.38"/>
<polygon fill="black" stroke="black" points="1887.5,-20654.34 1884,-20644.34 1880.5,-20654.34 1887.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_6&#45;&gt;expert_agg_2 -->
<g id="edge103" class="edge">
<title>expert_ffn2_2_6&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M1983.86,-20591.09C2054.97,-20572.93 2151.97,-20548.16 2233.45,-20527.34"/>
<polygon fill="black" stroke="black" points="2234.49,-20530.69 2243.31,-20524.83 2232.75,-20523.91 2234.49,-20530.69"/>
</g>
<!-- expert_gelu_2_7 -->
<g id="node68" class="node">
<title>expert_gelu_2_7</title>
<polygon fill="lightcyan" stroke="black" points="2336.5,-20734.1 2157.5,-20734.1 2157.5,-20681.1 2336.5,-20681.1 2336.5,-20734.1"/>
<text text-anchor="middle" x="2247" y="-20718.9" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2247" y="-20703.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2247" y="-20688.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_2_7&#45;&gt;expert_gelu_2_7 -->
<g id="edge106" class="edge">
<title>expert_2_7&#45;&gt;expert_gelu_2_7</title>
<path fill="none" stroke="black" d="M2247,-20770.97C2247,-20762.39 2247,-20753.11 2247,-20744.4"/>
<polygon fill="black" stroke="black" points="2250.5,-20744.15 2247,-20734.15 2243.5,-20744.15 2250.5,-20744.15"/>
</g>
<!-- expert_ffn2_2_7 -->
<g id="node69" class="node">
<title>expert_ffn2_2_7</title>
<polygon fill="lightcyan" stroke="black" points="2419.5,-20644.1 2074.5,-20644.1 2074.5,-20591.1 2419.5,-20591.1 2419.5,-20644.1"/>
<text text-anchor="middle" x="2247" y="-20628.9" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2247" y="-20613.9" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2247" y="-20598.9" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- expert_gelu_2_7&#45;&gt;expert_ffn2_2_7 -->
<g id="edge107" class="edge">
<title>expert_gelu_2_7&#45;&gt;expert_ffn2_2_7</title>
<path fill="none" stroke="black" d="M2247,-20680.67C2247,-20672.44 2247,-20663.18 2247,-20654.38"/>
<polygon fill="black" stroke="black" points="2250.5,-20654.34 2247,-20644.34 2243.5,-20654.34 2250.5,-20654.34"/>
</g>
<!-- expert_ffn2_2_7&#45;&gt;expert_agg_2 -->
<g id="edge108" class="edge">
<title>expert_ffn2_2_7&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="black" d="M2275.45,-20591.02C2285.29,-20582.17 2296.87,-20571.75 2308.84,-20560.99"/>
<polygon fill="black" stroke="black" points="2311.23,-20563.55 2316.32,-20554.26 2306.55,-20558.34 2311.23,-20563.55"/>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge111" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M2204.13,-20464.59C1979.32,-20439.91 1597.28,-20397.97 1317.69,-20367.27"/>
<polygon fill="black" stroke="black" points="1317.7,-20363.75 1307.37,-20366.14 1316.93,-20370.71 1317.7,-20363.75"/>
</g>
<!-- comm_2_3 -->
<g id="node108" class="node">
<title>comm_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="970" cy="-20211.23" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="970" y="-20215.03" font-family="Times,serif" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="970" y="-20200.03" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_2&#45;&gt;comm_2_3 -->
<g id="edge112" class="edge">
<title>residual2_2&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M970,-20275.04C970,-20266.11 970,-20257.01 970,-20248.6"/>
<polygon fill="black" stroke="black" points="973.5,-20248.39 970,-20238.39 966.5,-20248.39 973.5,-20248.39"/>
</g>
<!-- comm_1_2&#45;&gt;ln1_2 -->
<g id="edge57" class="edge">
<title>comm_1_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M868.84,-21629.33C840.27,-21618.21 805.5,-21604.67 774.96,-21592.78"/>
<polygon fill="black" stroke="black" points="776.22,-21589.52 765.63,-21589.15 773.68,-21596.04 776.22,-21589.52"/>
</g>
<!-- comm_1_2&#45;&gt;residual1_2 -->
<g id="edge65" class="edge">
<title>comm_1_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M1007.98,-21632.95C1041.19,-21619.88 1072,-21598.39 1072,-21563.6 1072,-21563.6 1072,-21563.6 1072,-21291.6 1072,-21271.13 1062.79,-21252.62 1049.91,-21236.74"/>
<polygon fill="black" stroke="black" points="1052.52,-21234.41 1043.32,-21229.17 1047.24,-21239.01 1052.52,-21234.41"/>
</g>
<!-- ln1_3 -->
<g id="node73" class="node">
<title>ln1_3</title>
<polygon fill="lightyellow" stroke="black" points="828,-20147.36 658,-20147.36 658,-20094.36 828,-20094.36 828,-20147.36"/>
<text text-anchor="middle" x="743" y="-20132.16" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="743" y="-20117.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="743" y="-20102.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_q_3 -->
<g id="node74" class="node">
<title>mha_q_3</title>
<polygon fill="lightblue" stroke="black" points="1087,-20057.36 751,-20057.36 751,-20004.36 1087,-20004.36 1087,-20057.36"/>
<text text-anchor="middle" x="919" y="-20042.16" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="919" y="-20027.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="919" y="-20012.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_q_3 -->
<g id="edge114" class="edge">
<title>ln1_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M794.38,-20094.17C814.53,-20084.1 837.8,-20072.46 858.74,-20061.99"/>
<polygon fill="black" stroke="black" points="860.48,-20065.03 867.86,-20057.43 857.35,-20058.77 860.48,-20065.03"/>
</g>
<!-- mha_k_3 -->
<g id="node75" class="node">
<title>mha_k_3</title>
<polygon fill="lightblue" stroke="black" points="379,-20057.36 43,-20057.36 43,-20004.36 379,-20004.36 379,-20057.36"/>
<text text-anchor="middle" x="211" y="-20042.16" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="211" y="-20027.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="211" y="-20012.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_k_3 -->
<g id="edge115" class="edge">
<title>ln1_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M657.82,-20105.77C581.99,-20093.23 468.93,-20074.53 375.51,-20059.07"/>
<polygon fill="black" stroke="black" points="375.82,-20055.58 365.38,-20057.4 374.68,-20062.48 375.82,-20055.58"/>
</g>
<!-- mha_v_3 -->
<g id="node76" class="node">
<title>mha_v_3</title>
<polygon fill="lightblue" stroke="black" points="733,-20057.36 397,-20057.36 397,-20004.36 733,-20004.36 733,-20057.36"/>
<text text-anchor="middle" x="565" y="-20042.16" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="565" y="-20027.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="565" y="-20012.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_v_3 -->
<g id="edge116" class="edge">
<title>ln1_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M691.04,-20094.17C670.66,-20084.1 647.12,-20072.46 625.95,-20061.99"/>
<polygon fill="black" stroke="black" points="627.24,-20058.73 616.72,-20057.43 624.13,-20065 627.24,-20058.73"/>
</g>
<!-- mha_attn_3 -->
<g id="node77" class="node">
<title>mha_attn_3</title>
<polygon fill="lightblue" stroke="black" points="716,-19967.36 546,-19967.36 546,-19914.36 716,-19914.36 716,-19967.36"/>
<text text-anchor="middle" x="631" y="-19952.16" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="631" y="-19937.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="631" y="-19922.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge117" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M835.31,-20004.29C800.7,-19993.71 760.41,-19981.4 724.81,-19970.52"/>
<polygon fill="black" stroke="black" points="725.48,-19967.07 714.9,-19967.5 723.44,-19973.77 725.48,-19967.07"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge118" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M332.76,-20004.35C397.47,-19990.79 475.84,-19974.37 536,-19961.77"/>
<polygon fill="black" stroke="black" points="536.81,-19965.17 545.88,-19959.7 535.37,-19958.32 536.81,-19965.17"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge119" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M584.45,-20003.93C591.09,-19995.07 598.63,-19985.03 605.67,-19975.64"/>
<polygon fill="black" stroke="black" points="608.49,-19977.7 611.69,-19967.6 602.89,-19973.5 608.49,-19977.7"/>
</g>
<!-- mha_out_3 -->
<g id="node78" class="node">
<title>mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="999,-19877.36 663,-19877.36 663,-19824.36 999,-19824.36 999,-19877.36"/>
<text text-anchor="middle" x="831" y="-19862.16" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="831" y="-19847.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="831" y="-19832.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge120" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M689.12,-19914.29C712.33,-19904.08 739.22,-19892.24 763.31,-19881.65"/>
<polygon fill="black" stroke="black" points="764.99,-19884.73 772.74,-19877.5 762.18,-19878.32 764.99,-19884.73"/>
</g>
<!-- residual1_3 -->
<g id="node79" class="node">
<title>residual1_3</title>
<polygon fill="lightcoral" stroke="black" points="1374.86,-19787.36 805.58,-19787.36 659.14,-19681.36 1228.42,-19681.36 1374.86,-19787.36"/>
<text text-anchor="middle" x="1017" y="-19745.66" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1017" y="-19730.66" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1017" y="-19715.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge122" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M872.74,-19824.17C887.93,-19814.82 905.77,-19803.83 923.63,-19792.84"/>
<polygon fill="black" stroke="black" points="925.7,-19795.67 932.38,-19787.45 922.03,-19789.71 925.7,-19795.67"/>
</g>
<!-- ln2_3 -->
<g id="node80" class="node">
<title>ln2_3</title>
<polygon fill="lightyellow" stroke="black" points="2399,-19644.36 2229,-19644.36 2229,-19591.36 2399,-19591.36 2399,-19644.36"/>
<text text-anchor="middle" x="2314" y="-19629.16" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2314" y="-19614.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2314" y="-19599.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge123" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M1269.77,-19711.05C1559.74,-19685.45 2020.62,-19644.76 2218.56,-19627.29"/>
<polygon fill="black" stroke="black" points="2218.99,-19630.76 2228.64,-19626.4 2218.37,-19623.79 2218.99,-19630.76"/>
</g>
<!-- residual2_3 -->
<g id="node107" class="node">
<title>residual2_3</title>
<polygon fill="lightcoral" stroke="black" points="1374.86,-18939.36 805.58,-18939.36 659.14,-18833.36 1228.42,-18833.36 1374.86,-18939.36"/>
<text text-anchor="middle" x="1017" y="-18897.66" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1017" y="-18882.66" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1017" y="-18867.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge166" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M1009.23,-19681.33C1006.92,-19661.79 1005,-19639.35 1005,-19618.86 1005,-19618.86 1005,-19618.86 1005,-19043.36 1005,-19012.52 1007.36,-18978.34 1009.99,-18949.86"/>
<polygon fill="black" stroke="black" points="1013.5,-18949.93 1010.96,-18939.64 1006.53,-18949.26 1013.5,-18949.93"/>
</g>
<!-- gate_3 -->
<g id="node81" class="node">
<title>gate_3</title>
<polygon fill="orange" stroke="black" points="2483,-19554.36 2174,-19501.36 2483,-19448.36 2792,-19501.36 2483,-19554.36"/>
<text text-anchor="middle" x="2483" y="-19512.66" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2483" y="-19497.66" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2483" y="-19482.66" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;gate_3 -->
<g id="edge124" class="edge">
<title>ln2_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M2351.93,-19591.17C2370.05,-19578.88 2392.34,-19563.78 2413.36,-19549.54"/>
<polygon fill="black" stroke="black" points="2415.34,-19552.43 2421.65,-19543.93 2411.41,-19546.64 2415.34,-19552.43"/>
</g>
<!-- expert_3_0 -->
<g id="node82" class="node">
<title>expert_3_0</title>
<polygon fill="lightcyan" stroke="black" points="1740.5,-19397.36 1395.5,-19397.36 1395.5,-19329.36 1740.5,-19329.36 1740.5,-19397.36"/>
<text text-anchor="middle" x="1568" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1568" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1568" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1568" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_0 -->
<g id="edge126" class="edge">
<title>ln2_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" d="M2228.98,-19613.87C2088.02,-19604.92 1802.79,-19569.56 1614,-19430.36 1605.05,-19423.76 1597.22,-19414.88 1590.67,-19405.78"/>
<polygon fill="black" stroke="black" points="1593.52,-19403.75 1585.03,-19397.42 1587.72,-19407.66 1593.52,-19403.75"/>
</g>
<!-- expert_3_1 -->
<g id="node85" class="node">
<title>expert_3_1</title>
<polygon fill="lightcyan" stroke="black" points="2866.5,-19397.36 2521.5,-19397.36 2521.5,-19329.36 2866.5,-19329.36 2866.5,-19397.36"/>
<text text-anchor="middle" x="2694" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2694" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2694" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2694" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_1 -->
<g id="edge131" class="edge">
<title>ln2_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" d="M2399.19,-19611.83C2531.57,-19603.15 2774.35,-19583.45 2801,-19554.36 2842.76,-19508.78 2839.45,-19467.35 2806,-19415.36 2803.46,-19411.41 2800.53,-19407.77 2797.3,-19404.4"/>
<polygon fill="black" stroke="black" points="2799.5,-19401.67 2789.77,-19397.47 2794.76,-19406.82 2799.5,-19401.67"/>
</g>
<!-- expert_3_2 -->
<g id="node88" class="node">
<title>expert_3_2</title>
<polygon fill="lightcyan" stroke="black" points="3592.5,-19397.36 3247.5,-19397.36 3247.5,-19329.36 3592.5,-19329.36 3592.5,-19397.36"/>
<text text-anchor="middle" x="3420" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3420" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3420" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3420" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_2 -->
<g id="edge136" class="edge">
<title>ln2_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" d="M2399.15,-19610.83C2495.25,-19603.64 2656.15,-19590.41 2794,-19573.36 3062.63,-19540.13 3174.89,-19599.77 3386,-19430.36 3393.76,-19424.13 3399.93,-19415.66 3404.77,-19406.87"/>
<polygon fill="black" stroke="black" points="3408.02,-19408.17 3409.33,-19397.66 3401.75,-19405.06 3408.02,-19408.17"/>
</g>
<!-- expert_3_3 -->
<g id="node91" class="node">
<title>expert_3_3</title>
<polygon fill="lightcyan" stroke="black" points="1377.5,-19397.36 1032.5,-19397.36 1032.5,-19329.36 1377.5,-19329.36 1377.5,-19397.36"/>
<text text-anchor="middle" x="1205" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1205" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1205" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1205" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_3 -->
<g id="edge141" class="edge">
<title>ln2_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" d="M2228.73,-19617.74C2098.73,-19617.14 1844.12,-19608.29 1636,-19554.36 1501.2,-19519.43 1355.02,-19446.89 1272.25,-19402.24"/>
<polygon fill="black" stroke="black" points="1273.92,-19399.17 1263.46,-19397.48 1270.58,-19405.32 1273.92,-19399.17"/>
</g>
<!-- expert_3_4 -->
<g id="node94" class="node">
<title>expert_3_4</title>
<polygon fill="lightcyan" stroke="black" points="3229.5,-19397.36 2884.5,-19397.36 2884.5,-19329.36 3229.5,-19329.36 3229.5,-19397.36"/>
<text text-anchor="middle" x="3057" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3057" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3057" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3057" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_4 -->
<g id="edge146" class="edge">
<title>ln2_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" d="M2399.24,-19614C2526.1,-19608.49 2757.45,-19593.31 2830,-19554.36 2904.26,-19514.49 2976.54,-19447.72 3018.9,-19404.88"/>
<polygon fill="black" stroke="black" points="3021.44,-19407.29 3025.95,-19397.7 3016.45,-19402.39 3021.44,-19407.29"/>
</g>
<!-- expert_3_5 -->
<g id="node97" class="node">
<title>expert_3_5</title>
<polygon fill="lightcyan" stroke="black" points="3955.5,-19397.36 3610.5,-19397.36 3610.5,-19329.36 3955.5,-19329.36 3955.5,-19397.36"/>
<text text-anchor="middle" x="3783" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3783" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3783" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3783" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_5 -->
<g id="edge151" class="edge">
<title>ln2_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" d="M2399.22,-19614.08C2597.12,-19607.14 3083.08,-19587.24 3243,-19554.36 3410.02,-19520.03 3595.72,-19446.37 3700.04,-19401.52"/>
<polygon fill="black" stroke="black" points="3701.46,-19404.72 3709.26,-19397.54 3698.69,-19398.29 3701.46,-19404.72"/>
</g>
<!-- expert_3_6 -->
<g id="node100" class="node">
<title>expert_3_6</title>
<polygon fill="lightcyan" stroke="black" points="2103.5,-19397.36 1758.5,-19397.36 1758.5,-19329.36 2103.5,-19329.36 2103.5,-19397.36"/>
<text text-anchor="middle" x="1931" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1931" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1931" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1931" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_6 -->
<g id="edge156" class="edge">
<title>ln2_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" d="M2228.67,-19592.53C2211.35,-19586.83 2193.42,-19580.35 2177,-19573.36 2088.41,-19535.65 2007.93,-19454.42 1964.57,-19405.07"/>
<polygon fill="black" stroke="black" points="1967.14,-19402.69 1957.94,-19397.44 1961.86,-19407.28 1967.14,-19402.69"/>
</g>
<!-- expert_3_7 -->
<g id="node103" class="node">
<title>expert_3_7</title>
<polygon fill="lightcyan" stroke="black" points="2466.5,-19397.36 2121.5,-19397.36 2121.5,-19329.36 2466.5,-19329.36 2466.5,-19397.36"/>
<text text-anchor="middle" x="2294" y="-19382.16" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2294" y="-19367.16" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2294" y="-19352.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2294" y="-19337.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;expert_3_7 -->
<g id="edge161" class="edge">
<title>ln2_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" d="M2228.84,-19600.13C2204.08,-19590.88 2179.76,-19576.55 2165,-19554.36 2138.91,-19515.13 2142.55,-19489.78 2165,-19448.36 2174.96,-19429.99 2190.87,-19415 2208.17,-19403.05"/>
<polygon fill="black" stroke="black" points="2210.31,-19405.83 2216.76,-19397.42 2206.48,-19399.98 2210.31,-19405.83"/>
</g>
<!-- gate_3&#45;&gt;expert_3_0 -->
<g id="edge125" class="edge">
<title>gate_3&#45;&gt;expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2309.8,-19478C2163.55,-19458.65 1948.39,-19429.1 1750.88,-19397.48"/>
<polygon fill="black" stroke="black" points="1751.32,-19394.01 1740.89,-19395.88 1750.21,-19400.92 1751.32,-19394.01"/>
<text text-anchor="middle" x="1995.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_1 -->
<g id="edge130" class="edge">
<title>gate_3&#45;&gt;expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2533.59,-19457.03C2551.19,-19442.92 2571.43,-19427.72 2591,-19415.36 2598.09,-19410.88 2605.64,-19406.5 2613.29,-19402.3"/>
<polygon fill="black" stroke="black" points="2615.15,-19405.27 2622.3,-19397.46 2611.83,-19399.11 2615.15,-19405.27"/>
<text text-anchor="middle" x="2636.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_2 -->
<g id="edge135" class="edge">
<title>gate_3&#45;&gt;expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2659.38,-19478.61C2810.34,-19459.46 3033.64,-19429.86 3237.12,-19397.64"/>
<polygon fill="black" stroke="black" points="3237.78,-19401.08 3247.1,-19396.06 3236.68,-19394.17 3237.78,-19401.08"/>
<text text-anchor="middle" x="3160.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_3 -->
<g id="edge140" class="edge">
<title>gate_3&#45;&gt;expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2266.35,-19485.5C2047.19,-19469.2 1698.59,-19439.77 1387.97,-19397.46"/>
<polygon fill="black" stroke="black" points="1388.24,-19393.96 1377.86,-19396.07 1387.29,-19400.9 1388.24,-19393.96"/>
<text text-anchor="middle" x="1701.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_4 -->
<g id="edge145" class="edge">
<title>gate_3&#45;&gt;expert_3_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2587.92,-19466.35C2642.43,-19449.48 2710.37,-19429.71 2772,-19415.36 2814.74,-19405.41 2828.11,-19405.51 2874.09,-19397.66"/>
<polygon fill="black" stroke="black" points="2874.83,-19401.09 2884.08,-19395.92 2873.63,-19394.19 2874.83,-19401.09"/>
<text text-anchor="middle" x="2817.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_5 -->
<g id="edge150" class="edge">
<title>gate_3&#45;&gt;expert_3_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2702.36,-19485.94C2926.02,-19469.9 3283.04,-19440.6 3599.82,-19397.63"/>
<polygon fill="black" stroke="black" points="3600.69,-19401.04 3610.13,-19396.22 3599.75,-19394.11 3600.69,-19401.04"/>
<text text-anchor="middle" x="3495.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_6 -->
<g id="edge155" class="edge">
<title>gate_3&#45;&gt;expert_3_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2358.43,-19469.67C2274.3,-19448.94 2162.98,-19421.52 2075.03,-19399.85"/>
<polygon fill="black" stroke="black" points="2075.79,-19396.43 2065.25,-19397.44 2074.12,-19403.23 2075.79,-19396.43"/>
<text text-anchor="middle" x="2235.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_3&#45;&gt;expert_3_7 -->
<g id="edge160" class="edge">
<title>gate_3&#45;&gt;expert_3_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2424.49,-19458.26C2400.15,-19440.75 2372.06,-19420.53 2348.2,-19403.36"/>
<polygon fill="black" stroke="black" points="2350.11,-19400.42 2339.94,-19397.42 2346.02,-19406.1 2350.11,-19400.42"/>
<text text-anchor="middle" x="2427.5" y="-19419.16" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_3 -->
<g id="node106" class="node">
<title>expert_agg_3</title>
<polygon fill="lightpink" stroke="black" points="2654.86,-19112.36 2309.88,-19112.36 2221.14,-18976.36 2566.12,-18976.36 2654.86,-19112.36"/>
<text text-anchor="middle" x="2438" y="-19063.16" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2438" y="-19048.16" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2438" y="-19033.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2438" y="-19018.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gate_3&#45;&gt;expert_agg_3 -->
<g id="edge165" class="edge">
<title>gate_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2489.11,-19449.1C2491.64,-19423.66 2494,-19392.43 2494,-19364.36 2494,-19364.36 2494,-19364.36 2494,-19174.86 2494,-19157.15 2489.53,-19139.11 2483.12,-19122.35"/>
<polygon fill="black" stroke="black" points="2486.17,-19120.56 2479.14,-19112.63 2479.69,-19123.21 2486.17,-19120.56"/>
<text text-anchor="middle" x="2522.5" y="-19262.16" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_3_0 -->
<g id="node83" class="node">
<title>expert_gelu_3_0</title>
<polygon fill="lightcyan" stroke="black" points="1657.5,-19292.36 1478.5,-19292.36 1478.5,-19239.36 1657.5,-19239.36 1657.5,-19292.36"/>
<text text-anchor="middle" x="1568" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1568" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1568" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_0&#45;&gt;expert_gelu_3_0 -->
<g id="edge127" class="edge">
<title>expert_3_0&#45;&gt;expert_gelu_3_0</title>
<path fill="none" stroke="black" d="M1568,-19329.23C1568,-19320.65 1568,-19311.37 1568,-19302.66"/>
<polygon fill="black" stroke="black" points="1571.5,-19302.41 1568,-19292.41 1564.5,-19302.41 1571.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_0 -->
<g id="node84" class="node">
<title>expert_ffn2_3_0</title>
<polygon fill="lightcyan" stroke="black" points="1740.5,-19202.36 1395.5,-19202.36 1395.5,-19149.36 1740.5,-19149.36 1740.5,-19202.36"/>
<text text-anchor="middle" x="1568" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1568" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1568" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_0&#45;&gt;expert_ffn2_3_0 -->
<g id="edge128" class="edge">
<title>expert_gelu_3_0&#45;&gt;expert_ffn2_3_0</title>
<path fill="none" stroke="black" d="M1568,-19238.93C1568,-19230.7 1568,-19221.44 1568,-19212.64"/>
<polygon fill="black" stroke="black" points="1571.5,-19212.6 1568,-19202.6 1564.5,-19212.6 1571.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_0&#45;&gt;expert_agg_3 -->
<g id="edge129" class="edge">
<title>expert_ffn2_3_0&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1739.36,-19149.35C1893.52,-19126.41 2118.61,-19092.9 2271.31,-19070.17"/>
<polygon fill="black" stroke="black" points="2271.89,-19073.63 2281.26,-19068.69 2270.86,-19066.7 2271.89,-19073.63"/>
</g>
<!-- expert_gelu_3_1 -->
<g id="node86" class="node">
<title>expert_gelu_3_1</title>
<polygon fill="lightcyan" stroke="black" points="2783.5,-19292.36 2604.5,-19292.36 2604.5,-19239.36 2783.5,-19239.36 2783.5,-19292.36"/>
<text text-anchor="middle" x="2694" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2694" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2694" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_1&#45;&gt;expert_gelu_3_1 -->
<g id="edge132" class="edge">
<title>expert_3_1&#45;&gt;expert_gelu_3_1</title>
<path fill="none" stroke="black" d="M2694,-19329.23C2694,-19320.65 2694,-19311.37 2694,-19302.66"/>
<polygon fill="black" stroke="black" points="2697.5,-19302.41 2694,-19292.41 2690.5,-19302.41 2697.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_1 -->
<g id="node87" class="node">
<title>expert_ffn2_3_1</title>
<polygon fill="lightcyan" stroke="black" points="2866.5,-19202.36 2521.5,-19202.36 2521.5,-19149.36 2866.5,-19149.36 2866.5,-19202.36"/>
<text text-anchor="middle" x="2694" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2694" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2694" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_1&#45;&gt;expert_ffn2_3_1 -->
<g id="edge133" class="edge">
<title>expert_gelu_3_1&#45;&gt;expert_ffn2_3_1</title>
<path fill="none" stroke="black" d="M2694,-19238.93C2694,-19230.7 2694,-19221.44 2694,-19212.64"/>
<polygon fill="black" stroke="black" points="2697.5,-19212.6 2694,-19202.6 2690.5,-19212.6 2697.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_1&#45;&gt;expert_agg_3 -->
<g id="edge134" class="edge">
<title>expert_ffn2_3_1&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2643.42,-19149.28C2624.71,-19139.81 2602.45,-19128.55 2579.61,-19117"/>
<polygon fill="black" stroke="black" points="2581,-19113.77 2570.49,-19112.38 2577.84,-19120.02 2581,-19113.77"/>
</g>
<!-- expert_gelu_3_2 -->
<g id="node89" class="node">
<title>expert_gelu_3_2</title>
<polygon fill="lightcyan" stroke="black" points="3509.5,-19292.36 3330.5,-19292.36 3330.5,-19239.36 3509.5,-19239.36 3509.5,-19292.36"/>
<text text-anchor="middle" x="3420" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3420" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3420" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_2&#45;&gt;expert_gelu_3_2 -->
<g id="edge137" class="edge">
<title>expert_3_2&#45;&gt;expert_gelu_3_2</title>
<path fill="none" stroke="black" d="M3420,-19329.23C3420,-19320.65 3420,-19311.37 3420,-19302.66"/>
<polygon fill="black" stroke="black" points="3423.5,-19302.41 3420,-19292.41 3416.5,-19302.41 3423.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_2 -->
<g id="node90" class="node">
<title>expert_ffn2_3_2</title>
<polygon fill="lightcyan" stroke="black" points="3592.5,-19202.36 3247.5,-19202.36 3247.5,-19149.36 3592.5,-19149.36 3592.5,-19202.36"/>
<text text-anchor="middle" x="3420" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3420" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3420" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_2&#45;&gt;expert_ffn2_3_2 -->
<g id="edge138" class="edge">
<title>expert_gelu_3_2&#45;&gt;expert_ffn2_3_2</title>
<path fill="none" stroke="black" d="M3420,-19238.93C3420,-19230.7 3420,-19221.44 3420,-19212.64"/>
<polygon fill="black" stroke="black" points="3423.5,-19212.6 3420,-19202.6 3416.5,-19212.6 3423.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_2&#45;&gt;expert_agg_3 -->
<g id="edge139" class="edge">
<title>expert_ffn2_3_2&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M3247.08,-19150.46C3244.37,-19150.09 3241.67,-19149.72 3239,-19149.36 3033.98,-19121.61 2799.23,-19091.3 2637.11,-19070.6"/>
<polygon fill="black" stroke="black" points="2637.39,-19067.11 2627.03,-19069.32 2636.5,-19074.06 2637.39,-19067.11"/>
</g>
<!-- expert_gelu_3_3 -->
<g id="node92" class="node">
<title>expert_gelu_3_3</title>
<polygon fill="lightcyan" stroke="black" points="1294.5,-19292.36 1115.5,-19292.36 1115.5,-19239.36 1294.5,-19239.36 1294.5,-19292.36"/>
<text text-anchor="middle" x="1205" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1205" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1205" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_3&#45;&gt;expert_gelu_3_3 -->
<g id="edge142" class="edge">
<title>expert_3_3&#45;&gt;expert_gelu_3_3</title>
<path fill="none" stroke="black" d="M1205,-19329.23C1205,-19320.65 1205,-19311.37 1205,-19302.66"/>
<polygon fill="black" stroke="black" points="1208.5,-19302.41 1205,-19292.41 1201.5,-19302.41 1208.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_3 -->
<g id="node93" class="node">
<title>expert_ffn2_3_3</title>
<polygon fill="lightcyan" stroke="black" points="1377.5,-19202.36 1032.5,-19202.36 1032.5,-19149.36 1377.5,-19149.36 1377.5,-19202.36"/>
<text text-anchor="middle" x="1205" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1205" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1205" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_3&#45;&gt;expert_ffn2_3_3 -->
<g id="edge143" class="edge">
<title>expert_gelu_3_3&#45;&gt;expert_ffn2_3_3</title>
<path fill="none" stroke="black" d="M1205,-19238.93C1205,-19230.7 1205,-19221.44 1205,-19212.64"/>
<polygon fill="black" stroke="black" points="1208.5,-19212.6 1205,-19202.6 1201.5,-19212.6 1208.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_3&#45;&gt;expert_agg_3 -->
<g id="edge144" class="edge">
<title>expert_ffn2_3_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M1377.9,-19150.46C1380.95,-19150.09 1383.99,-19149.72 1387,-19149.36 1695.77,-19112.47 2056.7,-19078.81 2265.17,-19060.3"/>
<polygon fill="black" stroke="black" points="2265.63,-19063.77 2275.29,-19059.4 2265.02,-19056.8 2265.63,-19063.77"/>
</g>
<!-- expert_gelu_3_4 -->
<g id="node95" class="node">
<title>expert_gelu_3_4</title>
<polygon fill="lightcyan" stroke="black" points="3146.5,-19292.36 2967.5,-19292.36 2967.5,-19239.36 3146.5,-19239.36 3146.5,-19292.36"/>
<text text-anchor="middle" x="3057" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3057" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3057" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_4&#45;&gt;expert_gelu_3_4 -->
<g id="edge147" class="edge">
<title>expert_3_4&#45;&gt;expert_gelu_3_4</title>
<path fill="none" stroke="black" d="M3057,-19329.23C3057,-19320.65 3057,-19311.37 3057,-19302.66"/>
<polygon fill="black" stroke="black" points="3060.5,-19302.41 3057,-19292.41 3053.5,-19302.41 3060.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_4 -->
<g id="node96" class="node">
<title>expert_ffn2_3_4</title>
<polygon fill="lightcyan" stroke="black" points="3229.5,-19202.36 2884.5,-19202.36 2884.5,-19149.36 3229.5,-19149.36 3229.5,-19202.36"/>
<text text-anchor="middle" x="3057" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3057" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3057" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_4&#45;&gt;expert_ffn2_3_4 -->
<g id="edge148" class="edge">
<title>expert_gelu_3_4&#45;&gt;expert_ffn2_3_4</title>
<path fill="none" stroke="black" d="M3057,-19238.93C3057,-19230.7 3057,-19221.44 3057,-19212.64"/>
<polygon fill="black" stroke="black" points="3060.5,-19212.6 3057,-19202.6 3053.5,-19212.6 3060.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_4&#45;&gt;expert_agg_3 -->
<g id="edge149" class="edge">
<title>expert_ffn2_3_4&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2935.07,-19149.35C2853.44,-19132.27 2743.84,-19109.35 2648.33,-19089.36"/>
<polygon fill="black" stroke="black" points="2649.05,-19085.94 2638.54,-19087.32 2647.61,-19092.79 2649.05,-19085.94"/>
</g>
<!-- expert_gelu_3_5 -->
<g id="node98" class="node">
<title>expert_gelu_3_5</title>
<polygon fill="lightcyan" stroke="black" points="3872.5,-19292.36 3693.5,-19292.36 3693.5,-19239.36 3872.5,-19239.36 3872.5,-19292.36"/>
<text text-anchor="middle" x="3783" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3783" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3783" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_5&#45;&gt;expert_gelu_3_5 -->
<g id="edge152" class="edge">
<title>expert_3_5&#45;&gt;expert_gelu_3_5</title>
<path fill="none" stroke="black" d="M3783,-19329.23C3783,-19320.65 3783,-19311.37 3783,-19302.66"/>
<polygon fill="black" stroke="black" points="3786.5,-19302.41 3783,-19292.41 3779.5,-19302.41 3786.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_5 -->
<g id="node99" class="node">
<title>expert_ffn2_3_5</title>
<polygon fill="lightcyan" stroke="black" points="3955.5,-19202.36 3610.5,-19202.36 3610.5,-19149.36 3955.5,-19149.36 3955.5,-19202.36"/>
<text text-anchor="middle" x="3783" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3783" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3783" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_5&#45;&gt;expert_ffn2_3_5 -->
<g id="edge153" class="edge">
<title>expert_gelu_3_5&#45;&gt;expert_ffn2_3_5</title>
<path fill="none" stroke="black" d="M3783,-19238.93C3783,-19230.7 3783,-19221.44 3783,-19212.64"/>
<polygon fill="black" stroke="black" points="3786.5,-19212.6 3783,-19202.6 3779.5,-19212.6 3786.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_5&#45;&gt;expert_agg_3 -->
<g id="edge154" class="edge">
<title>expert_ffn2_3_5&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M3610.1,-19150.31C3607.38,-19149.99 3604.68,-19149.67 3602,-19149.36 3260.52,-19110.08 2861.22,-19077.24 2630.19,-19059.52"/>
<polygon fill="black" stroke="black" points="2630.24,-19056.02 2620,-19058.74 2629.7,-19063 2630.24,-19056.02"/>
</g>
<!-- expert_gelu_3_6 -->
<g id="node101" class="node">
<title>expert_gelu_3_6</title>
<polygon fill="lightcyan" stroke="black" points="2020.5,-19292.36 1841.5,-19292.36 1841.5,-19239.36 2020.5,-19239.36 2020.5,-19292.36"/>
<text text-anchor="middle" x="1931" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1931" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1931" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_6&#45;&gt;expert_gelu_3_6 -->
<g id="edge157" class="edge">
<title>expert_3_6&#45;&gt;expert_gelu_3_6</title>
<path fill="none" stroke="black" d="M1931,-19329.23C1931,-19320.65 1931,-19311.37 1931,-19302.66"/>
<polygon fill="black" stroke="black" points="1934.5,-19302.41 1931,-19292.41 1927.5,-19302.41 1934.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_6 -->
<g id="node102" class="node">
<title>expert_ffn2_3_6</title>
<polygon fill="lightcyan" stroke="black" points="2103.5,-19202.36 1758.5,-19202.36 1758.5,-19149.36 2103.5,-19149.36 2103.5,-19202.36"/>
<text text-anchor="middle" x="1931" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1931" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1931" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_6&#45;&gt;expert_ffn2_3_6 -->
<g id="edge158" class="edge">
<title>expert_gelu_3_6&#45;&gt;expert_ffn2_3_6</title>
<path fill="none" stroke="black" d="M1931,-19238.93C1931,-19230.7 1931,-19221.44 1931,-19212.64"/>
<polygon fill="black" stroke="black" points="1934.5,-19212.6 1931,-19202.6 1927.5,-19212.6 1934.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_6&#45;&gt;expert_agg_3 -->
<g id="edge159" class="edge">
<title>expert_ffn2_3_6&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2030.86,-19149.35C2101.97,-19131.19 2198.97,-19106.42 2280.45,-19085.6"/>
<polygon fill="black" stroke="black" points="2281.49,-19088.95 2290.31,-19083.09 2279.75,-19082.17 2281.49,-19088.95"/>
</g>
<!-- expert_gelu_3_7 -->
<g id="node104" class="node">
<title>expert_gelu_3_7</title>
<polygon fill="lightcyan" stroke="black" points="2383.5,-19292.36 2204.5,-19292.36 2204.5,-19239.36 2383.5,-19239.36 2383.5,-19292.36"/>
<text text-anchor="middle" x="2294" y="-19277.16" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2294" y="-19262.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2294" y="-19247.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_3_7&#45;&gt;expert_gelu_3_7 -->
<g id="edge162" class="edge">
<title>expert_3_7&#45;&gt;expert_gelu_3_7</title>
<path fill="none" stroke="black" d="M2294,-19329.23C2294,-19320.65 2294,-19311.37 2294,-19302.66"/>
<polygon fill="black" stroke="black" points="2297.5,-19302.41 2294,-19292.41 2290.5,-19302.41 2297.5,-19302.41"/>
</g>
<!-- expert_ffn2_3_7 -->
<g id="node105" class="node">
<title>expert_ffn2_3_7</title>
<polygon fill="lightcyan" stroke="black" points="2466.5,-19202.36 2121.5,-19202.36 2121.5,-19149.36 2466.5,-19149.36 2466.5,-19202.36"/>
<text text-anchor="middle" x="2294" y="-19187.16" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2294" y="-19172.16" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2294" y="-19157.16" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- expert_gelu_3_7&#45;&gt;expert_ffn2_3_7 -->
<g id="edge163" class="edge">
<title>expert_gelu_3_7&#45;&gt;expert_ffn2_3_7</title>
<path fill="none" stroke="black" d="M2294,-19238.93C2294,-19230.7 2294,-19221.44 2294,-19212.64"/>
<polygon fill="black" stroke="black" points="2297.5,-19212.6 2294,-19202.6 2290.5,-19212.6 2297.5,-19212.6"/>
</g>
<!-- expert_ffn2_3_7&#45;&gt;expert_agg_3 -->
<g id="edge164" class="edge">
<title>expert_ffn2_3_7&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="black" d="M2322.45,-19149.28C2332.29,-19140.43 2343.87,-19130.01 2355.84,-19119.25"/>
<polygon fill="black" stroke="black" points="2358.23,-19121.81 2363.32,-19112.52 2353.55,-19116.6 2358.23,-19121.81"/>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge167" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M2251.13,-19022.85C2026.32,-18998.17 1644.28,-18956.23 1364.69,-18925.53"/>
<polygon fill="black" stroke="black" points="1364.7,-18922.01 1354.37,-18924.4 1363.93,-18928.97 1364.7,-18922.01"/>
</g>
<!-- comm_3_4 -->
<g id="node144" class="node">
<title>comm_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="1017" cy="-18769.49" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1017" y="-18773.29" font-family="Times,serif" font-size="14.00">GPU 2 → GPU 3</text>
<text text-anchor="middle" x="1017" y="-18758.29" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_3&#45;&gt;comm_3_4 -->
<g id="edge168" class="edge">
<title>residual2_3&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M1017,-18833.3C1017,-18824.37 1017,-18815.26 1017,-18806.86"/>
<polygon fill="black" stroke="black" points="1020.5,-18806.65 1017,-18796.65 1013.5,-18806.65 1020.5,-18806.65"/>
</g>
<!-- comm_2_3&#45;&gt;ln1_3 -->
<g id="edge113" class="edge">
<title>comm_2_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M911.84,-20187.59C883.27,-20176.47 848.5,-20162.93 817.96,-20151.04"/>
<polygon fill="black" stroke="black" points="819.22,-20147.78 808.63,-20147.41 816.68,-20154.3 819.22,-20147.78"/>
</g>
<!-- comm_2_3&#45;&gt;residual1_3 -->
<g id="edge121" class="edge">
<title>comm_2_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1050.98,-20191.21C1084.19,-20178.14 1115,-20156.65 1115,-20121.86 1115,-20121.86 1115,-20121.86 1115,-19849.86 1115,-19829.81 1106.22,-19811.5 1093.91,-19795.69"/>
<polygon fill="black" stroke="black" points="1096.28,-19793.07 1087.18,-19787.65 1090.92,-19797.57 1096.28,-19793.07"/>
</g>
<!-- ln1_4 -->
<g id="node109" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="875,-18705.62 705,-18705.62 705,-18652.62 875,-18652.62 875,-18705.62"/>
<text text-anchor="middle" x="790" y="-18690.42" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="790" y="-18675.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="790" y="-18660.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_q_4 -->
<g id="node110" class="node">
<title>mha_q_4</title>
<polygon fill="lightblue" stroke="black" points="1134,-18615.62 798,-18615.62 798,-18562.62 1134,-18562.62 1134,-18615.62"/>
<text text-anchor="middle" x="966" y="-18600.42" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="966" y="-18585.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="966" y="-18570.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_q_4 -->
<g id="edge170" class="edge">
<title>ln1_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M841.38,-18652.43C861.53,-18642.36 884.8,-18630.72 905.74,-18620.25"/>
<polygon fill="black" stroke="black" points="907.48,-18623.29 914.86,-18615.69 904.35,-18617.03 907.48,-18623.29"/>
</g>
<!-- mha_k_4 -->
<g id="node111" class="node">
<title>mha_k_4</title>
<polygon fill="lightblue" stroke="black" points="426,-18615.62 90,-18615.62 90,-18562.62 426,-18562.62 426,-18615.62"/>
<text text-anchor="middle" x="258" y="-18600.42" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="258" y="-18585.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="258" y="-18570.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_k_4 -->
<g id="edge171" class="edge">
<title>ln1_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M704.82,-18664.03C628.99,-18651.49 515.93,-18632.79 422.51,-18617.33"/>
<polygon fill="black" stroke="black" points="422.82,-18613.84 412.38,-18615.66 421.68,-18620.74 422.82,-18613.84"/>
</g>
<!-- mha_v_4 -->
<g id="node112" class="node">
<title>mha_v_4</title>
<polygon fill="lightblue" stroke="black" points="780,-18615.62 444,-18615.62 444,-18562.62 780,-18562.62 780,-18615.62"/>
<text text-anchor="middle" x="612" y="-18600.42" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="612" y="-18585.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="612" y="-18570.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_v_4 -->
<g id="edge172" class="edge">
<title>ln1_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M738.04,-18652.43C717.66,-18642.36 694.12,-18630.72 672.95,-18620.25"/>
<polygon fill="black" stroke="black" points="674.24,-18616.99 663.72,-18615.69 671.13,-18623.26 674.24,-18616.99"/>
</g>
<!-- mha_attn_4 -->
<g id="node113" class="node">
<title>mha_attn_4</title>
<polygon fill="lightblue" stroke="black" points="763,-18525.62 593,-18525.62 593,-18472.62 763,-18472.62 763,-18525.62"/>
<text text-anchor="middle" x="678" y="-18510.42" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="678" y="-18495.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="678" y="-18480.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge173" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M882.31,-18562.55C847.7,-18551.97 807.41,-18539.66 771.81,-18528.78"/>
<polygon fill="black" stroke="black" points="772.48,-18525.33 761.9,-18525.76 770.44,-18532.03 772.48,-18525.33"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge174" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M379.76,-18562.61C444.47,-18549.05 522.84,-18532.63 583,-18520.03"/>
<polygon fill="black" stroke="black" points="583.81,-18523.43 592.88,-18517.96 582.37,-18516.58 583.81,-18523.43"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge175" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M631.45,-18562.19C638.09,-18553.33 645.63,-18543.29 652.67,-18533.9"/>
<polygon fill="black" stroke="black" points="655.49,-18535.96 658.69,-18525.86 649.89,-18531.76 655.49,-18535.96"/>
</g>
<!-- mha_out_4 -->
<g id="node114" class="node">
<title>mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="1046,-18435.62 710,-18435.62 710,-18382.62 1046,-18382.62 1046,-18435.62"/>
<text text-anchor="middle" x="878" y="-18420.42" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="878" y="-18405.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="878" y="-18390.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge176" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M736.12,-18472.55C759.33,-18462.34 786.22,-18450.5 810.31,-18439.91"/>
<polygon fill="black" stroke="black" points="811.99,-18442.99 819.74,-18435.76 809.18,-18436.58 811.99,-18442.99"/>
</g>
<!-- residual1_4 -->
<g id="node115" class="node">
<title>residual1_4</title>
<polygon fill="lightcoral" stroke="black" points="1375.86,-18345.62 806.58,-18345.62 660.14,-18239.62 1229.42,-18239.62 1375.86,-18345.62"/>
<text text-anchor="middle" x="1018" y="-18303.92" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1018" y="-18288.92" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1018" y="-18273.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge178" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M909.42,-18382.43C920.43,-18373.42 933.3,-18362.89 946.25,-18352.3"/>
<polygon fill="black" stroke="black" points="948.79,-18354.75 954.31,-18345.71 944.35,-18349.33 948.79,-18354.75"/>
</g>
<!-- ln2_4 -->
<g id="node116" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="2400,-18202.62 2230,-18202.62 2230,-18149.62 2400,-18149.62 2400,-18202.62"/>
<text text-anchor="middle" x="2315" y="-18187.42" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2315" y="-18172.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2315" y="-18157.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge179" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M1270.77,-18269.31C1560.74,-18243.71 2021.62,-18203.02 2219.56,-18185.55"/>
<polygon fill="black" stroke="black" points="2219.99,-18189.02 2229.64,-18184.66 2219.37,-18182.05 2219.99,-18189.02"/>
</g>
<!-- residual2_4 -->
<g id="node143" class="node">
<title>residual2_4</title>
<polygon fill="lightcoral" stroke="black" points="1375.86,-17497.62 806.58,-17497.62 660.14,-17391.62 1229.42,-17391.62 1375.86,-17497.62"/>
<text text-anchor="middle" x="1018" y="-17455.92" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1018" y="-17440.92" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1018" y="-17425.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge222" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M1010.23,-18239.59C1007.92,-18220.05 1006,-18197.61 1006,-18177.12 1006,-18177.12 1006,-18177.12 1006,-17601.62 1006,-17570.78 1008.36,-17536.6 1010.99,-17508.12"/>
<polygon fill="black" stroke="black" points="1014.5,-17508.19 1011.96,-17497.9 1007.53,-17507.52 1014.5,-17508.19"/>
</g>
<!-- gate_4 -->
<g id="node117" class="node">
<title>gate_4</title>
<polygon fill="orange" stroke="black" points="2484,-18112.62 2175,-18059.62 2484,-18006.62 2793,-18059.62 2484,-18112.62"/>
<text text-anchor="middle" x="2484" y="-18070.92" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2484" y="-18055.92" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2484" y="-18040.92" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;gate_4 -->
<g id="edge180" class="edge">
<title>ln2_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M2352.93,-18149.43C2371.05,-18137.14 2393.34,-18122.04 2414.36,-18107.8"/>
<polygon fill="black" stroke="black" points="2416.34,-18110.69 2422.65,-18102.19 2412.41,-18104.9 2416.34,-18110.69"/>
</g>
<!-- expert_4_0 -->
<g id="node118" class="node">
<title>expert_4_0</title>
<polygon fill="lightcyan" stroke="black" points="1741.5,-17955.62 1396.5,-17955.62 1396.5,-17887.62 1741.5,-17887.62 1741.5,-17955.62"/>
<text text-anchor="middle" x="1569" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1569" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1569" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1569" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_0 -->
<g id="edge182" class="edge">
<title>ln2_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" d="M2229.98,-18172.13C2089.02,-18163.18 1803.79,-18127.82 1615,-17988.62 1606.05,-17982.02 1598.22,-17973.14 1591.67,-17964.04"/>
<polygon fill="black" stroke="black" points="1594.52,-17962.01 1586.03,-17955.68 1588.72,-17965.92 1594.52,-17962.01"/>
</g>
<!-- expert_4_1 -->
<g id="node121" class="node">
<title>expert_4_1</title>
<polygon fill="lightcyan" stroke="black" points="2867.5,-17955.62 2522.5,-17955.62 2522.5,-17887.62 2867.5,-17887.62 2867.5,-17955.62"/>
<text text-anchor="middle" x="2695" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2695" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2695" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2695" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_1 -->
<g id="edge187" class="edge">
<title>ln2_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" d="M2400.19,-18170.09C2532.57,-18161.41 2775.35,-18141.71 2802,-18112.62 2843.76,-18067.04 2840.45,-18025.61 2807,-17973.62 2804.46,-17969.67 2801.53,-17966.03 2798.3,-17962.66"/>
<polygon fill="black" stroke="black" points="2800.5,-17959.93 2790.77,-17955.73 2795.76,-17965.08 2800.5,-17959.93"/>
</g>
<!-- expert_4_2 -->
<g id="node124" class="node">
<title>expert_4_2</title>
<polygon fill="lightcyan" stroke="black" points="3593.5,-17955.62 3248.5,-17955.62 3248.5,-17887.62 3593.5,-17887.62 3593.5,-17955.62"/>
<text text-anchor="middle" x="3421" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3421" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3421" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3421" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_2 -->
<g id="edge192" class="edge">
<title>ln2_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" d="M2400.15,-18169.09C2496.25,-18161.9 2657.15,-18148.67 2795,-18131.62 3063.63,-18098.39 3175.89,-18158.03 3387,-17988.62 3394.76,-17982.39 3400.93,-17973.92 3405.77,-17965.13"/>
<polygon fill="black" stroke="black" points="3409.02,-17966.43 3410.33,-17955.92 3402.75,-17963.32 3409.02,-17966.43"/>
</g>
<!-- expert_4_3 -->
<g id="node127" class="node">
<title>expert_4_3</title>
<polygon fill="lightcyan" stroke="black" points="1378.5,-17955.62 1033.5,-17955.62 1033.5,-17887.62 1378.5,-17887.62 1378.5,-17955.62"/>
<text text-anchor="middle" x="1206" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1206" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1206" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1206" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_3 -->
<g id="edge197" class="edge">
<title>ln2_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" d="M2229.73,-18176C2099.73,-18175.4 1845.12,-18166.55 1637,-18112.62 1502.2,-18077.69 1356.02,-18005.15 1273.25,-17960.5"/>
<polygon fill="black" stroke="black" points="1274.92,-17957.43 1264.46,-17955.74 1271.58,-17963.58 1274.92,-17957.43"/>
</g>
<!-- expert_4_4 -->
<g id="node130" class="node">
<title>expert_4_4</title>
<polygon fill="lightcyan" stroke="black" points="3230.5,-17955.62 2885.5,-17955.62 2885.5,-17887.62 3230.5,-17887.62 3230.5,-17955.62"/>
<text text-anchor="middle" x="3058" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3058" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3058" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3058" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_4 -->
<g id="edge202" class="edge">
<title>ln2_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" d="M2400.24,-18172.26C2527.1,-18166.75 2758.45,-18151.57 2831,-18112.62 2905.26,-18072.75 2977.54,-18005.98 3019.9,-17963.14"/>
<polygon fill="black" stroke="black" points="3022.44,-17965.55 3026.95,-17955.96 3017.45,-17960.65 3022.44,-17965.55"/>
</g>
<!-- expert_4_5 -->
<g id="node133" class="node">
<title>expert_4_5</title>
<polygon fill="lightcyan" stroke="black" points="3956.5,-17955.62 3611.5,-17955.62 3611.5,-17887.62 3956.5,-17887.62 3956.5,-17955.62"/>
<text text-anchor="middle" x="3784" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3784" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3784" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3784" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_5 -->
<g id="edge207" class="edge">
<title>ln2_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" d="M2400.22,-18172.34C2598.12,-18165.4 3084.08,-18145.5 3244,-18112.62 3411.02,-18078.29 3596.72,-18004.63 3701.04,-17959.78"/>
<polygon fill="black" stroke="black" points="3702.46,-17962.98 3710.26,-17955.8 3699.69,-17956.55 3702.46,-17962.98"/>
</g>
<!-- expert_4_6 -->
<g id="node136" class="node">
<title>expert_4_6</title>
<polygon fill="lightcyan" stroke="black" points="2104.5,-17955.62 1759.5,-17955.62 1759.5,-17887.62 2104.5,-17887.62 2104.5,-17955.62"/>
<text text-anchor="middle" x="1932" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1932" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1932" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1932" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_6 -->
<g id="edge212" class="edge">
<title>ln2_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" d="M2229.67,-18150.79C2212.35,-18145.09 2194.42,-18138.61 2178,-18131.62 2089.41,-18093.91 2008.93,-18012.68 1965.57,-17963.33"/>
<polygon fill="black" stroke="black" points="1968.14,-17960.95 1958.94,-17955.7 1962.86,-17965.54 1968.14,-17960.95"/>
</g>
<!-- expert_4_7 -->
<g id="node139" class="node">
<title>expert_4_7</title>
<polygon fill="lightcyan" stroke="black" points="2467.5,-17955.62 2122.5,-17955.62 2122.5,-17887.62 2467.5,-17887.62 2467.5,-17955.62"/>
<text text-anchor="middle" x="2295" y="-17940.42" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2295" y="-17925.42" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2295" y="-17910.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2295" y="-17895.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;expert_4_7 -->
<g id="edge217" class="edge">
<title>ln2_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" d="M2229.84,-18158.39C2205.08,-18149.14 2180.76,-18134.81 2166,-18112.62 2139.91,-18073.39 2143.55,-18048.04 2166,-18006.62 2175.96,-17988.25 2191.87,-17973.26 2209.17,-17961.31"/>
<polygon fill="black" stroke="black" points="2211.31,-17964.09 2217.76,-17955.68 2207.48,-17958.24 2211.31,-17964.09"/>
</g>
<!-- gate_4&#45;&gt;expert_4_0 -->
<g id="edge181" class="edge">
<title>gate_4&#45;&gt;expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2310.8,-18036.26C2164.55,-18016.91 1949.39,-17987.36 1751.88,-17955.74"/>
<polygon fill="black" stroke="black" points="1752.32,-17952.27 1741.89,-17954.14 1751.21,-17959.18 1752.32,-17952.27"/>
<text text-anchor="middle" x="1996.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_1 -->
<g id="edge186" class="edge">
<title>gate_4&#45;&gt;expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2534.59,-18015.29C2552.19,-18001.18 2572.43,-17985.98 2592,-17973.62 2599.09,-17969.14 2606.64,-17964.76 2614.29,-17960.56"/>
<polygon fill="black" stroke="black" points="2616.15,-17963.53 2623.3,-17955.72 2612.83,-17957.37 2616.15,-17963.53"/>
<text text-anchor="middle" x="2637.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_2 -->
<g id="edge191" class="edge">
<title>gate_4&#45;&gt;expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2660.38,-18036.87C2811.34,-18017.72 3034.64,-17988.12 3238.12,-17955.9"/>
<polygon fill="black" stroke="black" points="3238.78,-17959.34 3248.1,-17954.32 3237.68,-17952.43 3238.78,-17959.34"/>
<text text-anchor="middle" x="3161.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_3 -->
<g id="edge196" class="edge">
<title>gate_4&#45;&gt;expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2267.35,-18043.76C2048.19,-18027.46 1699.59,-17998.03 1388.97,-17955.72"/>
<polygon fill="black" stroke="black" points="1389.24,-17952.22 1378.86,-17954.33 1388.29,-17959.16 1389.24,-17952.22"/>
<text text-anchor="middle" x="1702.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_4 -->
<g id="edge201" class="edge">
<title>gate_4&#45;&gt;expert_4_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2588.92,-18024.61C2643.43,-18007.74 2711.37,-17987.97 2773,-17973.62 2815.74,-17963.67 2829.11,-17963.77 2875.09,-17955.92"/>
<polygon fill="black" stroke="black" points="2875.83,-17959.35 2885.08,-17954.18 2874.63,-17952.45 2875.83,-17959.35"/>
<text text-anchor="middle" x="2818.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_5 -->
<g id="edge206" class="edge">
<title>gate_4&#45;&gt;expert_4_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2703.36,-18044.2C2927.02,-18028.16 3284.04,-17998.86 3600.82,-17955.89"/>
<polygon fill="black" stroke="black" points="3601.69,-17959.3 3611.13,-17954.48 3600.75,-17952.37 3601.69,-17959.3"/>
<text text-anchor="middle" x="3496.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_6 -->
<g id="edge211" class="edge">
<title>gate_4&#45;&gt;expert_4_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2359.43,-18027.93C2275.3,-18007.2 2163.98,-17979.78 2076.03,-17958.11"/>
<polygon fill="black" stroke="black" points="2076.79,-17954.69 2066.25,-17955.7 2075.12,-17961.49 2076.79,-17954.69"/>
<text text-anchor="middle" x="2236.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_4&#45;&gt;expert_4_7 -->
<g id="edge216" class="edge">
<title>gate_4&#45;&gt;expert_4_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2425.49,-18016.52C2401.15,-17999.01 2373.06,-17978.79 2349.2,-17961.62"/>
<polygon fill="black" stroke="black" points="2351.11,-17958.68 2340.94,-17955.68 2347.02,-17964.36 2351.11,-17958.68"/>
<text text-anchor="middle" x="2428.5" y="-17977.42" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_4 -->
<g id="node142" class="node">
<title>expert_agg_4</title>
<polygon fill="lightpink" stroke="black" points="2662.86,-17670.62 2317.88,-17670.62 2229.14,-17534.62 2574.12,-17534.62 2662.86,-17670.62"/>
<text text-anchor="middle" x="2446" y="-17621.42" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2446" y="-17606.42" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2446" y="-17591.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2446" y="-17576.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gate_4&#45;&gt;expert_agg_4 -->
<g id="edge221" class="edge">
<title>gate_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2490.11,-18007.36C2492.64,-17981.92 2495,-17950.69 2495,-17922.62 2495,-17922.62 2495,-17922.62 2495,-17733.12 2495,-17715.54 2491,-17697.43 2485.29,-17680.54"/>
<polygon fill="black" stroke="black" points="2488.43,-17678.95 2481.74,-17670.74 2481.85,-17681.33 2488.43,-17678.95"/>
<text text-anchor="middle" x="2523.5" y="-17820.42" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_4_0 -->
<g id="node119" class="node">
<title>expert_gelu_4_0</title>
<polygon fill="lightcyan" stroke="black" points="1658.5,-17850.62 1479.5,-17850.62 1479.5,-17797.62 1658.5,-17797.62 1658.5,-17850.62"/>
<text text-anchor="middle" x="1569" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1569" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1569" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_0&#45;&gt;expert_gelu_4_0 -->
<g id="edge183" class="edge">
<title>expert_4_0&#45;&gt;expert_gelu_4_0</title>
<path fill="none" stroke="black" d="M1569,-17887.49C1569,-17878.91 1569,-17869.63 1569,-17860.92"/>
<polygon fill="black" stroke="black" points="1572.5,-17860.67 1569,-17850.67 1565.5,-17860.67 1572.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_0 -->
<g id="node120" class="node">
<title>expert_ffn2_4_0</title>
<polygon fill="lightcyan" stroke="black" points="1741.5,-17760.62 1396.5,-17760.62 1396.5,-17707.62 1741.5,-17707.62 1741.5,-17760.62"/>
<text text-anchor="middle" x="1569" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1569" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1569" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_0&#45;&gt;expert_ffn2_4_0 -->
<g id="edge184" class="edge">
<title>expert_gelu_4_0&#45;&gt;expert_ffn2_4_0</title>
<path fill="none" stroke="black" d="M1569,-17797.19C1569,-17788.96 1569,-17779.7 1569,-17770.9"/>
<polygon fill="black" stroke="black" points="1572.5,-17770.86 1569,-17760.86 1565.5,-17770.86 1572.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_0&#45;&gt;expert_agg_4 -->
<g id="edge185" class="edge">
<title>expert_ffn2_4_0&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M1741.74,-17707.61C1897.51,-17684.61 2125.11,-17651.01 2279.06,-17628.27"/>
<polygon fill="black" stroke="black" points="2279.71,-17631.71 2289.09,-17626.79 2278.69,-17624.79 2279.71,-17631.71"/>
</g>
<!-- expert_gelu_4_1 -->
<g id="node122" class="node">
<title>expert_gelu_4_1</title>
<polygon fill="lightcyan" stroke="black" points="2784.5,-17850.62 2605.5,-17850.62 2605.5,-17797.62 2784.5,-17797.62 2784.5,-17850.62"/>
<text text-anchor="middle" x="2695" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2695" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2695" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_1&#45;&gt;expert_gelu_4_1 -->
<g id="edge188" class="edge">
<title>expert_4_1&#45;&gt;expert_gelu_4_1</title>
<path fill="none" stroke="black" d="M2695,-17887.49C2695,-17878.91 2695,-17869.63 2695,-17860.92"/>
<polygon fill="black" stroke="black" points="2698.5,-17860.67 2695,-17850.67 2691.5,-17860.67 2698.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_1 -->
<g id="node123" class="node">
<title>expert_ffn2_4_1</title>
<polygon fill="lightcyan" stroke="black" points="2867.5,-17760.62 2522.5,-17760.62 2522.5,-17707.62 2867.5,-17707.62 2867.5,-17760.62"/>
<text text-anchor="middle" x="2695" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2695" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2695" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_1&#45;&gt;expert_ffn2_4_1 -->
<g id="edge189" class="edge">
<title>expert_gelu_4_1&#45;&gt;expert_ffn2_4_1</title>
<path fill="none" stroke="black" d="M2695,-17797.19C2695,-17788.96 2695,-17779.7 2695,-17770.9"/>
<polygon fill="black" stroke="black" points="2698.5,-17770.86 2695,-17760.86 2691.5,-17770.86 2698.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_1&#45;&gt;expert_agg_4 -->
<g id="edge190" class="edge">
<title>expert_ffn2_4_1&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M2645.81,-17707.54C2627.68,-17698.11 2606.15,-17686.91 2584.03,-17675.41"/>
<polygon fill="black" stroke="black" points="2585.36,-17672.15 2574.87,-17670.64 2582.13,-17678.36 2585.36,-17672.15"/>
</g>
<!-- expert_gelu_4_2 -->
<g id="node125" class="node">
<title>expert_gelu_4_2</title>
<polygon fill="lightcyan" stroke="black" points="3510.5,-17850.62 3331.5,-17850.62 3331.5,-17797.62 3510.5,-17797.62 3510.5,-17850.62"/>
<text text-anchor="middle" x="3421" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3421" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3421" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_2&#45;&gt;expert_gelu_4_2 -->
<g id="edge193" class="edge">
<title>expert_4_2&#45;&gt;expert_gelu_4_2</title>
<path fill="none" stroke="black" d="M3421,-17887.49C3421,-17878.91 3421,-17869.63 3421,-17860.92"/>
<polygon fill="black" stroke="black" points="3424.5,-17860.67 3421,-17850.67 3417.5,-17860.67 3424.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_2 -->
<g id="node126" class="node">
<title>expert_ffn2_4_2</title>
<polygon fill="lightcyan" stroke="black" points="3593.5,-17760.62 3248.5,-17760.62 3248.5,-17707.62 3593.5,-17707.62 3593.5,-17760.62"/>
<text text-anchor="middle" x="3421" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3421" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3421" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_2&#45;&gt;expert_ffn2_4_2 -->
<g id="edge194" class="edge">
<title>expert_gelu_4_2&#45;&gt;expert_ffn2_4_2</title>
<path fill="none" stroke="black" d="M3421,-17797.19C3421,-17788.96 3421,-17779.7 3421,-17770.9"/>
<polygon fill="black" stroke="black" points="3424.5,-17770.86 3421,-17760.86 3417.5,-17770.86 3424.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_2&#45;&gt;expert_agg_4 -->
<g id="edge195" class="edge">
<title>expert_ffn2_4_2&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M3248.08,-17708.72C3245.37,-17708.35 3242.67,-17707.98 3240,-17707.62 3037.43,-17680.09 2805.61,-17649.87 2644.97,-17629.14"/>
<polygon fill="black" stroke="black" points="2645.34,-17625.66 2634.97,-17627.85 2644.44,-17632.6 2645.34,-17625.66"/>
</g>
<!-- expert_gelu_4_3 -->
<g id="node128" class="node">
<title>expert_gelu_4_3</title>
<polygon fill="lightcyan" stroke="black" points="1295.5,-17850.62 1116.5,-17850.62 1116.5,-17797.62 1295.5,-17797.62 1295.5,-17850.62"/>
<text text-anchor="middle" x="1206" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1206" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1206" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_3&#45;&gt;expert_gelu_4_3 -->
<g id="edge198" class="edge">
<title>expert_4_3&#45;&gt;expert_gelu_4_3</title>
<path fill="none" stroke="black" d="M1206,-17887.49C1206,-17878.91 1206,-17869.63 1206,-17860.92"/>
<polygon fill="black" stroke="black" points="1209.5,-17860.67 1206,-17850.67 1202.5,-17860.67 1209.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_3 -->
<g id="node129" class="node">
<title>expert_ffn2_4_3</title>
<polygon fill="lightcyan" stroke="black" points="1378.5,-17760.62 1033.5,-17760.62 1033.5,-17707.62 1378.5,-17707.62 1378.5,-17760.62"/>
<text text-anchor="middle" x="1206" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1206" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1206" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_3&#45;&gt;expert_ffn2_4_3 -->
<g id="edge199" class="edge">
<title>expert_gelu_4_3&#45;&gt;expert_ffn2_4_3</title>
<path fill="none" stroke="black" d="M1206,-17797.19C1206,-17788.96 1206,-17779.7 1206,-17770.9"/>
<polygon fill="black" stroke="black" points="1209.5,-17770.86 1206,-17760.86 1202.5,-17770.86 1209.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_3&#45;&gt;expert_agg_4 -->
<g id="edge200" class="edge">
<title>expert_ffn2_4_3&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M1378.9,-17708.72C1381.95,-17708.35 1384.99,-17707.98 1388,-17707.62 1699.27,-17670.53 2063.21,-17636.88 2272.93,-17618.43"/>
<polygon fill="black" stroke="black" points="2273.45,-17621.9 2283.1,-17617.53 2272.84,-17614.92 2273.45,-17621.9"/>
</g>
<!-- expert_gelu_4_4 -->
<g id="node131" class="node">
<title>expert_gelu_4_4</title>
<polygon fill="lightcyan" stroke="black" points="3147.5,-17850.62 2968.5,-17850.62 2968.5,-17797.62 3147.5,-17797.62 3147.5,-17850.62"/>
<text text-anchor="middle" x="3058" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3058" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3058" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_4&#45;&gt;expert_gelu_4_4 -->
<g id="edge203" class="edge">
<title>expert_4_4&#45;&gt;expert_gelu_4_4</title>
<path fill="none" stroke="black" d="M3058,-17887.49C3058,-17878.91 3058,-17869.63 3058,-17860.92"/>
<polygon fill="black" stroke="black" points="3061.5,-17860.67 3058,-17850.67 3054.5,-17860.67 3061.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_4 -->
<g id="node132" class="node">
<title>expert_ffn2_4_4</title>
<polygon fill="lightcyan" stroke="black" points="3230.5,-17760.62 2885.5,-17760.62 2885.5,-17707.62 3230.5,-17707.62 3230.5,-17760.62"/>
<text text-anchor="middle" x="3058" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3058" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3058" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_4&#45;&gt;expert_ffn2_4_4 -->
<g id="edge204" class="edge">
<title>expert_gelu_4_4&#45;&gt;expert_ffn2_4_4</title>
<path fill="none" stroke="black" d="M3058,-17797.19C3058,-17788.96 3058,-17779.7 3058,-17770.9"/>
<polygon fill="black" stroke="black" points="3061.5,-17770.86 3058,-17760.86 3054.5,-17770.86 3061.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_4&#45;&gt;expert_agg_4 -->
<g id="edge205" class="edge">
<title>expert_ffn2_4_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M2937.45,-17707.61C2857.58,-17690.71 2750.63,-17668.08 2656.9,-17648.25"/>
<polygon fill="black" stroke="black" points="2657.51,-17644.8 2647,-17646.15 2656.06,-17651.65 2657.51,-17644.8"/>
</g>
<!-- expert_gelu_4_5 -->
<g id="node134" class="node">
<title>expert_gelu_4_5</title>
<polygon fill="lightcyan" stroke="black" points="3873.5,-17850.62 3694.5,-17850.62 3694.5,-17797.62 3873.5,-17797.62 3873.5,-17850.62"/>
<text text-anchor="middle" x="3784" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3784" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3784" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_5&#45;&gt;expert_gelu_4_5 -->
<g id="edge208" class="edge">
<title>expert_4_5&#45;&gt;expert_gelu_4_5</title>
<path fill="none" stroke="black" d="M3784,-17887.49C3784,-17878.91 3784,-17869.63 3784,-17860.92"/>
<polygon fill="black" stroke="black" points="3787.5,-17860.67 3784,-17850.67 3780.5,-17860.67 3787.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_5 -->
<g id="node135" class="node">
<title>expert_ffn2_4_5</title>
<polygon fill="lightcyan" stroke="black" points="3956.5,-17760.62 3611.5,-17760.62 3611.5,-17707.62 3956.5,-17707.62 3956.5,-17760.62"/>
<text text-anchor="middle" x="3784" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3784" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3784" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_5&#45;&gt;expert_ffn2_4_5 -->
<g id="edge209" class="edge">
<title>expert_gelu_4_5&#45;&gt;expert_ffn2_4_5</title>
<path fill="none" stroke="black" d="M3784,-17797.19C3784,-17788.96 3784,-17779.7 3784,-17770.9"/>
<polygon fill="black" stroke="black" points="3787.5,-17770.86 3784,-17760.86 3780.5,-17770.86 3787.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_5&#45;&gt;expert_agg_4 -->
<g id="edge210" class="edge">
<title>expert_ffn2_4_5&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M3611.1,-17708.57C3608.38,-17708.25 3605.68,-17707.93 3603,-17707.62 3264.19,-17668.55 2868.12,-17635.72 2638.29,-17617.93"/>
<polygon fill="black" stroke="black" points="2638.39,-17614.43 2628.15,-17617.15 2637.85,-17621.41 2638.39,-17614.43"/>
</g>
<!-- expert_gelu_4_6 -->
<g id="node137" class="node">
<title>expert_gelu_4_6</title>
<polygon fill="lightcyan" stroke="black" points="2021.5,-17850.62 1842.5,-17850.62 1842.5,-17797.62 2021.5,-17797.62 2021.5,-17850.62"/>
<text text-anchor="middle" x="1932" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1932" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1932" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_6&#45;&gt;expert_gelu_4_6 -->
<g id="edge213" class="edge">
<title>expert_4_6&#45;&gt;expert_gelu_4_6</title>
<path fill="none" stroke="black" d="M1932,-17887.49C1932,-17878.91 1932,-17869.63 1932,-17860.92"/>
<polygon fill="black" stroke="black" points="1935.5,-17860.67 1932,-17850.67 1928.5,-17860.67 1935.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_6 -->
<g id="node138" class="node">
<title>expert_ffn2_4_6</title>
<polygon fill="lightcyan" stroke="black" points="2104.5,-17760.62 1759.5,-17760.62 1759.5,-17707.62 2104.5,-17707.62 2104.5,-17760.62"/>
<text text-anchor="middle" x="1932" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1932" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1932" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_6&#45;&gt;expert_ffn2_4_6 -->
<g id="edge214" class="edge">
<title>expert_gelu_4_6&#45;&gt;expert_ffn2_4_6</title>
<path fill="none" stroke="black" d="M1932,-17797.19C1932,-17788.96 1932,-17779.7 1932,-17770.9"/>
<polygon fill="black" stroke="black" points="1935.5,-17770.86 1932,-17760.86 1928.5,-17770.86 1935.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_6&#45;&gt;expert_agg_4 -->
<g id="edge215" class="edge">
<title>expert_ffn2_4_6&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M2033.24,-17707.61C2105.97,-17689.29 2205.41,-17664.24 2288.46,-17643.31"/>
<polygon fill="black" stroke="black" points="2289.4,-17646.68 2298.24,-17640.85 2287.69,-17639.9 2289.4,-17646.68"/>
</g>
<!-- expert_gelu_4_7 -->
<g id="node140" class="node">
<title>expert_gelu_4_7</title>
<polygon fill="lightcyan" stroke="black" points="2384.5,-17850.62 2205.5,-17850.62 2205.5,-17797.62 2384.5,-17797.62 2384.5,-17850.62"/>
<text text-anchor="middle" x="2295" y="-17835.42" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2295" y="-17820.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2295" y="-17805.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_4_7&#45;&gt;expert_gelu_4_7 -->
<g id="edge218" class="edge">
<title>expert_4_7&#45;&gt;expert_gelu_4_7</title>
<path fill="none" stroke="black" d="M2295,-17887.49C2295,-17878.91 2295,-17869.63 2295,-17860.92"/>
<polygon fill="black" stroke="black" points="2298.5,-17860.67 2295,-17850.67 2291.5,-17860.67 2298.5,-17860.67"/>
</g>
<!-- expert_ffn2_4_7 -->
<g id="node141" class="node">
<title>expert_ffn2_4_7</title>
<polygon fill="lightcyan" stroke="black" points="2467.5,-17760.62 2122.5,-17760.62 2122.5,-17707.62 2467.5,-17707.62 2467.5,-17760.62"/>
<text text-anchor="middle" x="2295" y="-17745.42" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2295" y="-17730.42" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2295" y="-17715.42" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- expert_gelu_4_7&#45;&gt;expert_ffn2_4_7 -->
<g id="edge219" class="edge">
<title>expert_gelu_4_7&#45;&gt;expert_ffn2_4_7</title>
<path fill="none" stroke="black" d="M2295,-17797.19C2295,-17788.96 2295,-17779.7 2295,-17770.9"/>
<polygon fill="black" stroke="black" points="2298.5,-17770.86 2295,-17760.86 2291.5,-17770.86 2298.5,-17770.86"/>
</g>
<!-- expert_ffn2_4_7&#45;&gt;expert_agg_4 -->
<g id="edge220" class="edge">
<title>expert_ffn2_4_7&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="black" d="M2324.83,-17707.54C2335.15,-17698.69 2347.3,-17688.27 2359.84,-17677.51"/>
<polygon fill="black" stroke="black" points="2362.38,-17679.95 2367.69,-17670.78 2357.82,-17674.63 2362.38,-17679.95"/>
</g>
<!-- expert_agg_4&#45;&gt;residual2_4 -->
<g id="edge223" class="edge">
<title>expert_agg_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M2259.31,-17581.23C2032.93,-17556.5 1646.74,-17514.31 1365.12,-17483.54"/>
<polygon fill="black" stroke="black" points="1365.47,-17480.06 1355.14,-17482.45 1364.71,-17487.02 1365.47,-17480.06"/>
</g>
<!-- comm_4_5 -->
<g id="node180" class="node">
<title>comm_4_5</title>
<ellipse fill="lightgreen" stroke="black" cx="1018" cy="-17327.75" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1018" y="-17331.55" font-family="Times,serif" font-size="14.00">GPU 3 → GPU 4</text>
<text text-anchor="middle" x="1018" y="-17316.55" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_4&#45;&gt;comm_4_5 -->
<g id="edge224" class="edge">
<title>residual2_4&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M1018,-17391.56C1018,-17382.63 1018,-17373.52 1018,-17365.12"/>
<polygon fill="black" stroke="black" points="1021.5,-17364.91 1018,-17354.91 1014.5,-17364.91 1021.5,-17364.91"/>
</g>
<!-- comm_3_4&#45;&gt;ln1_4 -->
<g id="edge169" class="edge">
<title>comm_3_4&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M958.84,-18745.85C930.27,-18734.73 895.5,-18721.19 864.96,-18709.3"/>
<polygon fill="black" stroke="black" points="866.22,-18706.04 855.63,-18705.67 863.68,-18712.56 866.22,-18706.04"/>
</g>
<!-- comm_3_4&#45;&gt;residual1_4 -->
<g id="edge177" class="edge">
<title>comm_3_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M1097.98,-18749.47C1131.19,-18736.4 1162,-18714.91 1162,-18680.12 1162,-18680.12 1162,-18680.12 1162,-18408.12 1162,-18386.3 1151.74,-18367.97 1136.71,-18352.82"/>
<polygon fill="black" stroke="black" points="1138.68,-18349.88 1128.96,-18345.64 1133.92,-18355.01 1138.68,-18349.88"/>
</g>
<!-- ln1_5 -->
<g id="node145" class="node">
<title>ln1_5</title>
<polygon fill="lightyellow" stroke="black" points="876,-17263.88 706,-17263.88 706,-17210.88 876,-17210.88 876,-17263.88"/>
<text text-anchor="middle" x="791" y="-17248.68" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="791" y="-17233.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="791" y="-17218.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_q_5 -->
<g id="node146" class="node">
<title>mha_q_5</title>
<polygon fill="lightblue" stroke="black" points="1135,-17173.88 799,-17173.88 799,-17120.88 1135,-17120.88 1135,-17173.88"/>
<text text-anchor="middle" x="967" y="-17158.68" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="967" y="-17143.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="967" y="-17128.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_q_5 -->
<g id="edge226" class="edge">
<title>ln1_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M842.38,-17210.69C862.53,-17200.62 885.8,-17188.98 906.74,-17178.51"/>
<polygon fill="black" stroke="black" points="908.48,-17181.55 915.86,-17173.95 905.35,-17175.29 908.48,-17181.55"/>
</g>
<!-- mha_k_5 -->
<g id="node147" class="node">
<title>mha_k_5</title>
<polygon fill="lightblue" stroke="black" points="427,-17173.88 91,-17173.88 91,-17120.88 427,-17120.88 427,-17173.88"/>
<text text-anchor="middle" x="259" y="-17158.68" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="259" y="-17143.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="259" y="-17128.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_k_5 -->
<g id="edge227" class="edge">
<title>ln1_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M705.82,-17222.29C629.99,-17209.75 516.93,-17191.05 423.51,-17175.59"/>
<polygon fill="black" stroke="black" points="423.82,-17172.1 413.38,-17173.92 422.68,-17179 423.82,-17172.1"/>
</g>
<!-- mha_v_5 -->
<g id="node148" class="node">
<title>mha_v_5</title>
<polygon fill="lightblue" stroke="black" points="781,-17173.88 445,-17173.88 445,-17120.88 781,-17120.88 781,-17173.88"/>
<text text-anchor="middle" x="613" y="-17158.68" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="613" y="-17143.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="613" y="-17128.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_v_5 -->
<g id="edge228" class="edge">
<title>ln1_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M739.04,-17210.69C718.66,-17200.62 695.12,-17188.98 673.95,-17178.51"/>
<polygon fill="black" stroke="black" points="675.24,-17175.25 664.72,-17173.95 672.13,-17181.52 675.24,-17175.25"/>
</g>
<!-- mha_attn_5 -->
<g id="node149" class="node">
<title>mha_attn_5</title>
<polygon fill="lightblue" stroke="black" points="764,-17083.88 594,-17083.88 594,-17030.88 764,-17030.88 764,-17083.88"/>
<text text-anchor="middle" x="679" y="-17068.68" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="679" y="-17053.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="679" y="-17038.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge229" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M883.31,-17120.81C848.7,-17110.23 808.41,-17097.92 772.81,-17087.04"/>
<polygon fill="black" stroke="black" points="773.48,-17083.59 762.9,-17084.02 771.44,-17090.29 773.48,-17083.59"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge230" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M380.76,-17120.87C445.47,-17107.31 523.84,-17090.89 584,-17078.29"/>
<polygon fill="black" stroke="black" points="584.81,-17081.69 593.88,-17076.22 583.37,-17074.84 584.81,-17081.69"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge231" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M632.45,-17120.45C639.09,-17111.59 646.63,-17101.55 653.67,-17092.16"/>
<polygon fill="black" stroke="black" points="656.49,-17094.22 659.69,-17084.12 650.89,-17090.02 656.49,-17094.22"/>
</g>
<!-- mha_out_5 -->
<g id="node150" class="node">
<title>mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="1047,-16993.88 711,-16993.88 711,-16940.88 1047,-16940.88 1047,-16993.88"/>
<text text-anchor="middle" x="879" y="-16978.68" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="879" y="-16963.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="879" y="-16948.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge232" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M737.12,-17030.81C760.33,-17020.6 787.22,-17008.76 811.31,-16998.17"/>
<polygon fill="black" stroke="black" points="812.99,-17001.25 820.74,-16994.02 810.18,-16994.84 812.99,-17001.25"/>
</g>
<!-- residual1_5 -->
<g id="node151" class="node">
<title>residual1_5</title>
<polygon fill="lightcoral" stroke="black" points="1422.86,-16903.88 853.58,-16903.88 707.14,-16797.88 1276.42,-16797.88 1422.86,-16903.88"/>
<text text-anchor="middle" x="1065" y="-16862.18" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1065" y="-16847.18" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1065" y="-16832.18" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge234" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M920.74,-16940.69C935.93,-16931.34 953.77,-16920.35 971.63,-16909.36"/>
<polygon fill="black" stroke="black" points="973.7,-16912.19 980.38,-16903.97 970.03,-16906.23 973.7,-16912.19"/>
</g>
<!-- ln2_5 -->
<g id="node152" class="node">
<title>ln2_5</title>
<polygon fill="lightyellow" stroke="black" points="2447,-16760.88 2277,-16760.88 2277,-16707.88 2447,-16707.88 2447,-16760.88"/>
<text text-anchor="middle" x="2362" y="-16745.68" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2362" y="-16730.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2362" y="-16715.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge235" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M1317.77,-16827.57C1607.74,-16801.97 2068.62,-16761.28 2266.56,-16743.81"/>
<polygon fill="black" stroke="black" points="2266.99,-16747.28 2276.64,-16742.92 2266.37,-16740.31 2266.99,-16747.28"/>
</g>
<!-- residual2_5 -->
<g id="node179" class="node">
<title>residual2_5</title>
<polygon fill="lightcoral" stroke="black" points="1422.86,-16055.88 853.58,-16055.88 707.14,-15949.88 1276.42,-15949.88 1422.86,-16055.88"/>
<text text-anchor="middle" x="1065" y="-16014.18" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1065" y="-15999.18" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1065" y="-15984.18" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge278" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1057.23,-16797.85C1054.92,-16778.31 1053,-16755.87 1053,-16735.38 1053,-16735.38 1053,-16735.38 1053,-16159.88 1053,-16129.04 1055.36,-16094.86 1057.99,-16066.38"/>
<polygon fill="black" stroke="black" points="1061.5,-16066.45 1058.96,-16056.16 1054.53,-16065.78 1061.5,-16066.45"/>
</g>
<!-- gate_5 -->
<g id="node153" class="node">
<title>gate_5</title>
<polygon fill="orange" stroke="black" points="2531,-16670.88 2222,-16617.88 2531,-16564.88 2840,-16617.88 2531,-16670.88"/>
<text text-anchor="middle" x="2531" y="-16629.18" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2531" y="-16614.18" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2531" y="-16599.18" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;gate_5 -->
<g id="edge236" class="edge">
<title>ln2_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M2399.93,-16707.69C2418.05,-16695.4 2440.34,-16680.3 2461.36,-16666.06"/>
<polygon fill="black" stroke="black" points="2463.34,-16668.95 2469.65,-16660.45 2459.41,-16663.16 2463.34,-16668.95"/>
</g>
<!-- expert_5_0 -->
<g id="node154" class="node">
<title>expert_5_0</title>
<polygon fill="lightcyan" stroke="black" points="1788.5,-16513.88 1443.5,-16513.88 1443.5,-16445.88 1788.5,-16445.88 1788.5,-16513.88"/>
<text text-anchor="middle" x="1616" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1616" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1616" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1616" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_0 -->
<g id="edge238" class="edge">
<title>ln2_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" d="M2276.9,-16725.73C2141.44,-16710.28 1872.43,-16666.01 1680,-16546.88 1668.97,-16540.05 1658.49,-16530.91 1649.33,-16521.61"/>
<polygon fill="black" stroke="black" points="1651.69,-16519.01 1642.28,-16514.15 1646.61,-16523.82 1651.69,-16519.01"/>
</g>
<!-- expert_5_1 -->
<g id="node157" class="node">
<title>expert_5_1</title>
<polygon fill="lightcyan" stroke="black" points="2914.5,-16513.88 2569.5,-16513.88 2569.5,-16445.88 2914.5,-16445.88 2914.5,-16513.88"/>
<text text-anchor="middle" x="2742" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2742" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2742" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2742" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_1 -->
<g id="edge243" class="edge">
<title>ln2_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" d="M2447.19,-16728.35C2579.57,-16719.67 2822.35,-16699.97 2849,-16670.88 2890.76,-16625.3 2887.45,-16583.87 2854,-16531.88 2851.46,-16527.93 2848.53,-16524.29 2845.3,-16520.92"/>
<polygon fill="black" stroke="black" points="2847.5,-16518.19 2837.77,-16513.99 2842.76,-16523.34 2847.5,-16518.19"/>
</g>
<!-- expert_5_2 -->
<g id="node160" class="node">
<title>expert_5_2</title>
<polygon fill="lightcyan" stroke="black" points="3640.5,-16513.88 3295.5,-16513.88 3295.5,-16445.88 3640.5,-16445.88 3640.5,-16513.88"/>
<text text-anchor="middle" x="3468" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3468" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3468" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3468" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_2 -->
<g id="edge248" class="edge">
<title>ln2_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" d="M2447.15,-16727.35C2543.25,-16720.16 2704.15,-16706.93 2842,-16689.88 3110.63,-16656.65 3222.89,-16716.29 3434,-16546.88 3441.76,-16540.65 3447.93,-16532.18 3452.77,-16523.39"/>
<polygon fill="black" stroke="black" points="3456.02,-16524.69 3457.33,-16514.18 3449.75,-16521.58 3456.02,-16524.69"/>
</g>
<!-- expert_5_3 -->
<g id="node163" class="node">
<title>expert_5_3</title>
<polygon fill="lightcyan" stroke="black" points="1425.5,-16513.88 1080.5,-16513.88 1080.5,-16445.88 1425.5,-16445.88 1425.5,-16513.88"/>
<text text-anchor="middle" x="1253" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1253" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1253" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1253" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_3 -->
<g id="edge253" class="edge">
<title>ln2_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" d="M2276.88,-16733.37C2150.59,-16731.54 1906.99,-16721.04 1707,-16670.88 1565.92,-16635.5 1411.73,-16563.16 1324.23,-16518.66"/>
<polygon fill="black" stroke="black" points="1325.7,-16515.48 1315.2,-16514.04 1322.51,-16521.71 1325.7,-16515.48"/>
</g>
<!-- expert_5_4 -->
<g id="node166" class="node">
<title>expert_5_4</title>
<polygon fill="lightcyan" stroke="black" points="3277.5,-16513.88 2932.5,-16513.88 2932.5,-16445.88 3277.5,-16445.88 3277.5,-16513.88"/>
<text text-anchor="middle" x="3105" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3105" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3105" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3105" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_4 -->
<g id="edge258" class="edge">
<title>ln2_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" d="M2447.24,-16730.52C2574.1,-16725.01 2805.45,-16709.83 2878,-16670.88 2952.26,-16631.01 3024.54,-16564.24 3066.9,-16521.4"/>
<polygon fill="black" stroke="black" points="3069.44,-16523.81 3073.95,-16514.22 3064.45,-16518.91 3069.44,-16523.81"/>
</g>
<!-- expert_5_5 -->
<g id="node169" class="node">
<title>expert_5_5</title>
<polygon fill="lightcyan" stroke="black" points="4003.5,-16513.88 3658.5,-16513.88 3658.5,-16445.88 4003.5,-16445.88 4003.5,-16513.88"/>
<text text-anchor="middle" x="3831" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3831" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3831" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3831" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_5 -->
<g id="edge263" class="edge">
<title>ln2_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" d="M2447.22,-16730.6C2645.12,-16723.66 3131.08,-16703.76 3291,-16670.88 3458.02,-16636.55 3643.72,-16562.89 3748.04,-16518.04"/>
<polygon fill="black" stroke="black" points="3749.46,-16521.24 3757.26,-16514.06 3746.69,-16514.81 3749.46,-16521.24"/>
</g>
<!-- expert_5_6 -->
<g id="node172" class="node">
<title>expert_5_6</title>
<polygon fill="lightcyan" stroke="black" points="2151.5,-16513.88 1806.5,-16513.88 1806.5,-16445.88 2151.5,-16445.88 2151.5,-16513.88"/>
<text text-anchor="middle" x="1979" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1979" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1979" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1979" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_6 -->
<g id="edge268" class="edge">
<title>ln2_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" d="M2276.67,-16709.05C2259.35,-16703.35 2241.42,-16696.87 2225,-16689.88 2125.2,-16647.4 2120.24,-16603.75 2039,-16531.88 2034.9,-16528.26 2030.62,-16524.52 2026.32,-16520.8"/>
<polygon fill="black" stroke="black" points="2028.43,-16518 2018.57,-16514.13 2023.86,-16523.3 2028.43,-16518"/>
</g>
<!-- expert_5_7 -->
<g id="node175" class="node">
<title>expert_5_7</title>
<polygon fill="lightcyan" stroke="black" points="2514.5,-16513.88 2169.5,-16513.88 2169.5,-16445.88 2514.5,-16445.88 2514.5,-16513.88"/>
<text text-anchor="middle" x="2342" y="-16498.68" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2342" y="-16483.68" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2342" y="-16468.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2342" y="-16453.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;expert_5_7 -->
<g id="edge273" class="edge">
<title>ln2_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" d="M2276.84,-16716.65C2252.08,-16707.4 2227.76,-16693.07 2213,-16670.88 2186.91,-16631.65 2190.55,-16606.3 2213,-16564.88 2222.96,-16546.51 2238.87,-16531.52 2256.17,-16519.57"/>
<polygon fill="black" stroke="black" points="2258.31,-16522.35 2264.76,-16513.94 2254.48,-16516.49 2258.31,-16522.35"/>
</g>
<!-- gate_5&#45;&gt;expert_5_0 -->
<g id="edge237" class="edge">
<title>gate_5&#45;&gt;expert_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2357.8,-16594.52C2211.55,-16575.17 1996.39,-16545.62 1798.88,-16514"/>
<polygon fill="black" stroke="black" points="1799.32,-16510.53 1788.89,-16512.4 1798.21,-16517.44 1799.32,-16510.53"/>
<text text-anchor="middle" x="2043.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_1 -->
<g id="edge242" class="edge">
<title>gate_5&#45;&gt;expert_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2581.59,-16573.55C2599.19,-16559.44 2619.43,-16544.24 2639,-16531.88 2646.09,-16527.4 2653.64,-16523.02 2661.29,-16518.82"/>
<polygon fill="black" stroke="black" points="2663.15,-16521.79 2670.3,-16513.98 2659.83,-16515.63 2663.15,-16521.79"/>
<text text-anchor="middle" x="2684.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_2 -->
<g id="edge247" class="edge">
<title>gate_5&#45;&gt;expert_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2707.38,-16595.13C2858.34,-16575.98 3081.64,-16546.38 3285.12,-16514.16"/>
<polygon fill="black" stroke="black" points="3285.78,-16517.6 3295.1,-16512.58 3284.68,-16510.69 3285.78,-16517.6"/>
<text text-anchor="middle" x="3208.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_3 -->
<g id="edge252" class="edge">
<title>gate_5&#45;&gt;expert_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2314.35,-16602.02C2095.19,-16585.72 1746.59,-16556.29 1435.97,-16513.98"/>
<polygon fill="black" stroke="black" points="1436.24,-16510.48 1425.86,-16512.59 1435.29,-16517.42 1436.24,-16510.48"/>
<text text-anchor="middle" x="1749.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_4 -->
<g id="edge257" class="edge">
<title>gate_5&#45;&gt;expert_5_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2635.92,-16582.87C2690.43,-16566 2758.37,-16546.23 2820,-16531.88 2862.74,-16521.93 2876.11,-16522.03 2922.09,-16514.18"/>
<polygon fill="black" stroke="black" points="2922.83,-16517.61 2932.08,-16512.44 2921.63,-16510.71 2922.83,-16517.61"/>
<text text-anchor="middle" x="2865.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_5 -->
<g id="edge262" class="edge">
<title>gate_5&#45;&gt;expert_5_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2750.36,-16602.46C2974.02,-16586.42 3331.04,-16557.12 3647.82,-16514.15"/>
<polygon fill="black" stroke="black" points="3648.69,-16517.56 3658.13,-16512.74 3647.75,-16510.62 3648.69,-16517.56"/>
<text text-anchor="middle" x="3543.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_6 -->
<g id="edge267" class="edge">
<title>gate_5&#45;&gt;expert_5_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2406.43,-16586.19C2322.3,-16565.46 2210.98,-16538.04 2123.03,-16516.37"/>
<polygon fill="black" stroke="black" points="2123.79,-16512.95 2113.25,-16513.96 2122.12,-16519.75 2123.79,-16512.95"/>
<text text-anchor="middle" x="2283.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_5&#45;&gt;expert_5_7 -->
<g id="edge272" class="edge">
<title>gate_5&#45;&gt;expert_5_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2472.49,-16574.78C2448.15,-16557.27 2420.06,-16537.05 2396.2,-16519.88"/>
<polygon fill="black" stroke="black" points="2398.11,-16516.94 2387.94,-16513.94 2394.02,-16522.62 2398.11,-16516.94"/>
<text text-anchor="middle" x="2475.5" y="-16535.68" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_5 -->
<g id="node178" class="node">
<title>expert_agg_5</title>
<polygon fill="lightpink" stroke="black" points="2702.86,-16228.88 2357.88,-16228.88 2269.14,-16092.88 2614.12,-16092.88 2702.86,-16228.88"/>
<text text-anchor="middle" x="2486" y="-16179.68" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2486" y="-16164.68" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2486" y="-16149.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2486" y="-16134.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gate_5&#45;&gt;expert_agg_5 -->
<g id="edge277" class="edge">
<title>gate_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2537.11,-16565.62C2539.64,-16540.18 2542,-16508.95 2542,-16480.88 2542,-16480.88 2542,-16480.88 2542,-16291.38 2542,-16273.67 2537.53,-16255.63 2531.12,-16238.87"/>
<polygon fill="black" stroke="black" points="2534.17,-16237.08 2527.14,-16229.15 2527.69,-16239.73 2534.17,-16237.08"/>
<text text-anchor="middle" x="2570.5" y="-16378.68" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_5_0 -->
<g id="node155" class="node">
<title>expert_gelu_5_0</title>
<polygon fill="lightcyan" stroke="black" points="1705.5,-16408.88 1526.5,-16408.88 1526.5,-16355.88 1705.5,-16355.88 1705.5,-16408.88"/>
<text text-anchor="middle" x="1616" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1616" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1616" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_0&#45;&gt;expert_gelu_5_0 -->
<g id="edge239" class="edge">
<title>expert_5_0&#45;&gt;expert_gelu_5_0</title>
<path fill="none" stroke="black" d="M1616,-16445.75C1616,-16437.17 1616,-16427.89 1616,-16419.18"/>
<polygon fill="black" stroke="black" points="1619.5,-16418.93 1616,-16408.93 1612.5,-16418.93 1619.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_0 -->
<g id="node156" class="node">
<title>expert_ffn2_5_0</title>
<polygon fill="lightcyan" stroke="black" points="1788.5,-16318.88 1443.5,-16318.88 1443.5,-16265.88 1788.5,-16265.88 1788.5,-16318.88"/>
<text text-anchor="middle" x="1616" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1616" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1616" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_0&#45;&gt;expert_ffn2_5_0 -->
<g id="edge240" class="edge">
<title>expert_gelu_5_0&#45;&gt;expert_ffn2_5_0</title>
<path fill="none" stroke="black" d="M1616,-16355.45C1616,-16347.22 1616,-16337.96 1616,-16329.16"/>
<polygon fill="black" stroke="black" points="1619.5,-16329.12 1616,-16319.12 1612.5,-16329.12 1619.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_0&#45;&gt;expert_agg_5 -->
<g id="edge241" class="edge">
<title>expert_ffn2_5_0&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M1787.36,-16265.87C1941.52,-16242.93 2166.61,-16209.42 2319.31,-16186.69"/>
<polygon fill="black" stroke="black" points="2319.89,-16190.15 2329.26,-16185.21 2318.86,-16183.22 2319.89,-16190.15"/>
</g>
<!-- expert_gelu_5_1 -->
<g id="node158" class="node">
<title>expert_gelu_5_1</title>
<polygon fill="lightcyan" stroke="black" points="2831.5,-16408.88 2652.5,-16408.88 2652.5,-16355.88 2831.5,-16355.88 2831.5,-16408.88"/>
<text text-anchor="middle" x="2742" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2742" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2742" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_1&#45;&gt;expert_gelu_5_1 -->
<g id="edge244" class="edge">
<title>expert_5_1&#45;&gt;expert_gelu_5_1</title>
<path fill="none" stroke="black" d="M2742,-16445.75C2742,-16437.17 2742,-16427.89 2742,-16419.18"/>
<polygon fill="black" stroke="black" points="2745.5,-16418.93 2742,-16408.93 2738.5,-16418.93 2745.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_1 -->
<g id="node159" class="node">
<title>expert_ffn2_5_1</title>
<polygon fill="lightcyan" stroke="black" points="2914.5,-16318.88 2569.5,-16318.88 2569.5,-16265.88 2914.5,-16265.88 2914.5,-16318.88"/>
<text text-anchor="middle" x="2742" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2742" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2742" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_1&#45;&gt;expert_ffn2_5_1 -->
<g id="edge245" class="edge">
<title>expert_gelu_5_1&#45;&gt;expert_ffn2_5_1</title>
<path fill="none" stroke="black" d="M2742,-16355.45C2742,-16347.22 2742,-16337.96 2742,-16329.16"/>
<polygon fill="black" stroke="black" points="2745.5,-16329.12 2742,-16319.12 2738.5,-16329.12 2745.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_1&#45;&gt;expert_agg_5 -->
<g id="edge246" class="edge">
<title>expert_ffn2_5_1&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M2691.42,-16265.8C2672.71,-16256.33 2650.45,-16245.07 2627.61,-16233.52"/>
<polygon fill="black" stroke="black" points="2629,-16230.29 2618.49,-16228.9 2625.84,-16236.54 2629,-16230.29"/>
</g>
<!-- expert_gelu_5_2 -->
<g id="node161" class="node">
<title>expert_gelu_5_2</title>
<polygon fill="lightcyan" stroke="black" points="3557.5,-16408.88 3378.5,-16408.88 3378.5,-16355.88 3557.5,-16355.88 3557.5,-16408.88"/>
<text text-anchor="middle" x="3468" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3468" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3468" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_2&#45;&gt;expert_gelu_5_2 -->
<g id="edge249" class="edge">
<title>expert_5_2&#45;&gt;expert_gelu_5_2</title>
<path fill="none" stroke="black" d="M3468,-16445.75C3468,-16437.17 3468,-16427.89 3468,-16419.18"/>
<polygon fill="black" stroke="black" points="3471.5,-16418.93 3468,-16408.93 3464.5,-16418.93 3471.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_2 -->
<g id="node162" class="node">
<title>expert_ffn2_5_2</title>
<polygon fill="lightcyan" stroke="black" points="3640.5,-16318.88 3295.5,-16318.88 3295.5,-16265.88 3640.5,-16265.88 3640.5,-16318.88"/>
<text text-anchor="middle" x="3468" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3468" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3468" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_2&#45;&gt;expert_ffn2_5_2 -->
<g id="edge250" class="edge">
<title>expert_gelu_5_2&#45;&gt;expert_ffn2_5_2</title>
<path fill="none" stroke="black" d="M3468,-16355.45C3468,-16347.22 3468,-16337.96 3468,-16329.16"/>
<polygon fill="black" stroke="black" points="3471.5,-16329.12 3468,-16319.12 3464.5,-16329.12 3471.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_2&#45;&gt;expert_agg_5 -->
<g id="edge251" class="edge">
<title>expert_ffn2_5_2&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M3295.08,-16266.98C3292.37,-16266.61 3289.67,-16266.24 3287,-16265.88 3081.98,-16238.13 2847.23,-16207.82 2685.11,-16187.12"/>
<polygon fill="black" stroke="black" points="2685.39,-16183.63 2675.03,-16185.84 2684.5,-16190.57 2685.39,-16183.63"/>
</g>
<!-- expert_gelu_5_3 -->
<g id="node164" class="node">
<title>expert_gelu_5_3</title>
<polygon fill="lightcyan" stroke="black" points="1342.5,-16408.88 1163.5,-16408.88 1163.5,-16355.88 1342.5,-16355.88 1342.5,-16408.88"/>
<text text-anchor="middle" x="1253" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1253" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1253" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_3&#45;&gt;expert_gelu_5_3 -->
<g id="edge254" class="edge">
<title>expert_5_3&#45;&gt;expert_gelu_5_3</title>
<path fill="none" stroke="black" d="M1253,-16445.75C1253,-16437.17 1253,-16427.89 1253,-16419.18"/>
<polygon fill="black" stroke="black" points="1256.5,-16418.93 1253,-16408.93 1249.5,-16418.93 1256.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_3 -->
<g id="node165" class="node">
<title>expert_ffn2_5_3</title>
<polygon fill="lightcyan" stroke="black" points="1425.5,-16318.88 1080.5,-16318.88 1080.5,-16265.88 1425.5,-16265.88 1425.5,-16318.88"/>
<text text-anchor="middle" x="1253" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1253" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1253" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_3&#45;&gt;expert_ffn2_5_3 -->
<g id="edge255" class="edge">
<title>expert_gelu_5_3&#45;&gt;expert_ffn2_5_3</title>
<path fill="none" stroke="black" d="M1253,-16355.45C1253,-16347.22 1253,-16337.96 1253,-16329.16"/>
<polygon fill="black" stroke="black" points="1256.5,-16329.12 1253,-16319.12 1249.5,-16329.12 1256.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_3&#45;&gt;expert_agg_5 -->
<g id="edge256" class="edge">
<title>expert_ffn2_5_3&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M1425.9,-16266.98C1428.95,-16266.61 1431.99,-16266.24 1435,-16265.88 1743.77,-16228.99 2104.7,-16195.33 2313.17,-16176.82"/>
<polygon fill="black" stroke="black" points="2313.63,-16180.29 2323.29,-16175.92 2313.02,-16173.32 2313.63,-16180.29"/>
</g>
<!-- expert_gelu_5_4 -->
<g id="node167" class="node">
<title>expert_gelu_5_4</title>
<polygon fill="lightcyan" stroke="black" points="3194.5,-16408.88 3015.5,-16408.88 3015.5,-16355.88 3194.5,-16355.88 3194.5,-16408.88"/>
<text text-anchor="middle" x="3105" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3105" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3105" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_4&#45;&gt;expert_gelu_5_4 -->
<g id="edge259" class="edge">
<title>expert_5_4&#45;&gt;expert_gelu_5_4</title>
<path fill="none" stroke="black" d="M3105,-16445.75C3105,-16437.17 3105,-16427.89 3105,-16419.18"/>
<polygon fill="black" stroke="black" points="3108.5,-16418.93 3105,-16408.93 3101.5,-16418.93 3108.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_4 -->
<g id="node168" class="node">
<title>expert_ffn2_5_4</title>
<polygon fill="lightcyan" stroke="black" points="3277.5,-16318.88 2932.5,-16318.88 2932.5,-16265.88 3277.5,-16265.88 3277.5,-16318.88"/>
<text text-anchor="middle" x="3105" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3105" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3105" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_4&#45;&gt;expert_ffn2_5_4 -->
<g id="edge260" class="edge">
<title>expert_gelu_5_4&#45;&gt;expert_ffn2_5_4</title>
<path fill="none" stroke="black" d="M3105,-16355.45C3105,-16347.22 3105,-16337.96 3105,-16329.16"/>
<polygon fill="black" stroke="black" points="3108.5,-16329.12 3105,-16319.12 3101.5,-16329.12 3108.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_4&#45;&gt;expert_agg_5 -->
<g id="edge261" class="edge">
<title>expert_ffn2_5_4&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M2983.07,-16265.87C2901.44,-16248.79 2791.84,-16225.87 2696.33,-16205.88"/>
<polygon fill="black" stroke="black" points="2697.05,-16202.46 2686.54,-16203.84 2695.61,-16209.31 2697.05,-16202.46"/>
</g>
<!-- expert_gelu_5_5 -->
<g id="node170" class="node">
<title>expert_gelu_5_5</title>
<polygon fill="lightcyan" stroke="black" points="3920.5,-16408.88 3741.5,-16408.88 3741.5,-16355.88 3920.5,-16355.88 3920.5,-16408.88"/>
<text text-anchor="middle" x="3831" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3831" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3831" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_5&#45;&gt;expert_gelu_5_5 -->
<g id="edge264" class="edge">
<title>expert_5_5&#45;&gt;expert_gelu_5_5</title>
<path fill="none" stroke="black" d="M3831,-16445.75C3831,-16437.17 3831,-16427.89 3831,-16419.18"/>
<polygon fill="black" stroke="black" points="3834.5,-16418.93 3831,-16408.93 3827.5,-16418.93 3834.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_5 -->
<g id="node171" class="node">
<title>expert_ffn2_5_5</title>
<polygon fill="lightcyan" stroke="black" points="4003.5,-16318.88 3658.5,-16318.88 3658.5,-16265.88 4003.5,-16265.88 4003.5,-16318.88"/>
<text text-anchor="middle" x="3831" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3831" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3831" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_5&#45;&gt;expert_ffn2_5_5 -->
<g id="edge265" class="edge">
<title>expert_gelu_5_5&#45;&gt;expert_ffn2_5_5</title>
<path fill="none" stroke="black" d="M3831,-16355.45C3831,-16347.22 3831,-16337.96 3831,-16329.16"/>
<polygon fill="black" stroke="black" points="3834.5,-16329.12 3831,-16319.12 3827.5,-16329.12 3834.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_5&#45;&gt;expert_agg_5 -->
<g id="edge266" class="edge">
<title>expert_ffn2_5_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M3658.1,-16266.83C3655.38,-16266.51 3652.68,-16266.19 3650,-16265.88 3308.52,-16226.6 2909.22,-16193.76 2678.19,-16176.04"/>
<polygon fill="black" stroke="black" points="2678.24,-16172.54 2668,-16175.26 2677.7,-16179.52 2678.24,-16172.54"/>
</g>
<!-- expert_gelu_5_6 -->
<g id="node173" class="node">
<title>expert_gelu_5_6</title>
<polygon fill="lightcyan" stroke="black" points="2068.5,-16408.88 1889.5,-16408.88 1889.5,-16355.88 2068.5,-16355.88 2068.5,-16408.88"/>
<text text-anchor="middle" x="1979" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1979" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1979" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_6&#45;&gt;expert_gelu_5_6 -->
<g id="edge269" class="edge">
<title>expert_5_6&#45;&gt;expert_gelu_5_6</title>
<path fill="none" stroke="black" d="M1979,-16445.75C1979,-16437.17 1979,-16427.89 1979,-16419.18"/>
<polygon fill="black" stroke="black" points="1982.5,-16418.93 1979,-16408.93 1975.5,-16418.93 1982.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_6 -->
<g id="node174" class="node">
<title>expert_ffn2_5_6</title>
<polygon fill="lightcyan" stroke="black" points="2151.5,-16318.88 1806.5,-16318.88 1806.5,-16265.88 2151.5,-16265.88 2151.5,-16318.88"/>
<text text-anchor="middle" x="1979" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1979" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1979" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_6&#45;&gt;expert_ffn2_5_6 -->
<g id="edge270" class="edge">
<title>expert_gelu_5_6&#45;&gt;expert_ffn2_5_6</title>
<path fill="none" stroke="black" d="M1979,-16355.45C1979,-16347.22 1979,-16337.96 1979,-16329.16"/>
<polygon fill="black" stroke="black" points="1982.5,-16329.12 1979,-16319.12 1975.5,-16329.12 1982.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_6&#45;&gt;expert_agg_5 -->
<g id="edge271" class="edge">
<title>expert_ffn2_5_6&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M2078.86,-16265.87C2149.97,-16247.71 2246.97,-16222.94 2328.45,-16202.12"/>
<polygon fill="black" stroke="black" points="2329.49,-16205.47 2338.31,-16199.61 2327.75,-16198.69 2329.49,-16205.47"/>
</g>
<!-- expert_gelu_5_7 -->
<g id="node176" class="node">
<title>expert_gelu_5_7</title>
<polygon fill="lightcyan" stroke="black" points="2431.5,-16408.88 2252.5,-16408.88 2252.5,-16355.88 2431.5,-16355.88 2431.5,-16408.88"/>
<text text-anchor="middle" x="2342" y="-16393.68" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2342" y="-16378.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2342" y="-16363.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_5_7&#45;&gt;expert_gelu_5_7 -->
<g id="edge274" class="edge">
<title>expert_5_7&#45;&gt;expert_gelu_5_7</title>
<path fill="none" stroke="black" d="M2342,-16445.75C2342,-16437.17 2342,-16427.89 2342,-16419.18"/>
<polygon fill="black" stroke="black" points="2345.5,-16418.93 2342,-16408.93 2338.5,-16418.93 2345.5,-16418.93"/>
</g>
<!-- expert_ffn2_5_7 -->
<g id="node177" class="node">
<title>expert_ffn2_5_7</title>
<polygon fill="lightcyan" stroke="black" points="2514.5,-16318.88 2169.5,-16318.88 2169.5,-16265.88 2514.5,-16265.88 2514.5,-16318.88"/>
<text text-anchor="middle" x="2342" y="-16303.68" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2342" y="-16288.68" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2342" y="-16273.68" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- expert_gelu_5_7&#45;&gt;expert_ffn2_5_7 -->
<g id="edge275" class="edge">
<title>expert_gelu_5_7&#45;&gt;expert_ffn2_5_7</title>
<path fill="none" stroke="black" d="M2342,-16355.45C2342,-16347.22 2342,-16337.96 2342,-16329.16"/>
<polygon fill="black" stroke="black" points="2345.5,-16329.12 2342,-16319.12 2338.5,-16329.12 2345.5,-16329.12"/>
</g>
<!-- expert_ffn2_5_7&#45;&gt;expert_agg_5 -->
<g id="edge276" class="edge">
<title>expert_ffn2_5_7&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="black" d="M2370.45,-16265.8C2380.29,-16256.95 2391.87,-16246.53 2403.84,-16235.77"/>
<polygon fill="black" stroke="black" points="2406.23,-16238.33 2411.32,-16229.04 2401.55,-16233.12 2406.23,-16238.33"/>
</g>
<!-- expert_agg_5&#45;&gt;residual2_5 -->
<g id="edge279" class="edge">
<title>expert_agg_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M2299.13,-16139.37C2074.32,-16114.69 1692.28,-16072.75 1412.69,-16042.05"/>
<polygon fill="black" stroke="black" points="1412.7,-16038.53 1402.37,-16040.92 1411.93,-16045.49 1412.7,-16038.53"/>
</g>
<!-- comm_5_6 -->
<g id="node216" class="node">
<title>comm_5_6</title>
<ellipse fill="lightgreen" stroke="black" cx="1065" cy="-15886.01" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1065" y="-15889.81" font-family="Times,serif" font-size="14.00">GPU 4 → GPU 5</text>
<text text-anchor="middle" x="1065" y="-15874.81" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_5&#45;&gt;comm_5_6 -->
<g id="edge280" class="edge">
<title>residual2_5&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M1065,-15949.82C1065,-15940.89 1065,-15931.78 1065,-15923.38"/>
<polygon fill="black" stroke="black" points="1068.5,-15923.17 1065,-15913.17 1061.5,-15923.17 1068.5,-15923.17"/>
</g>
<!-- comm_4_5&#45;&gt;ln1_5 -->
<g id="edge225" class="edge">
<title>comm_4_5&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M959.84,-17304.11C931.27,-17292.99 896.5,-17279.45 865.96,-17267.56"/>
<polygon fill="black" stroke="black" points="867.22,-17264.3 856.63,-17263.93 864.68,-17270.82 867.22,-17264.3"/>
</g>
<!-- comm_4_5&#45;&gt;residual1_5 -->
<g id="edge233" class="edge">
<title>comm_4_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1098.98,-17307.72C1132.19,-17294.66 1163,-17273.17 1163,-17238.38 1163,-17238.38 1163,-17238.38 1163,-16966.38 1163,-16946.33 1154.22,-16928.02 1141.91,-16912.21"/>
<polygon fill="black" stroke="black" points="1144.28,-16909.59 1135.18,-16904.17 1138.92,-16914.09 1144.28,-16909.59"/>
</g>
<!-- ln1_6 -->
<g id="node181" class="node">
<title>ln1_6</title>
<polygon fill="lightyellow" stroke="black" points="923,-15822.14 753,-15822.14 753,-15769.14 923,-15769.14 923,-15822.14"/>
<text text-anchor="middle" x="838" y="-15806.94" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="838" y="-15791.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="838" y="-15776.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_q_6 -->
<g id="node182" class="node">
<title>mha_q_6</title>
<polygon fill="lightblue" stroke="black" points="1182,-15732.14 846,-15732.14 846,-15679.14 1182,-15679.14 1182,-15732.14"/>
<text text-anchor="middle" x="1014" y="-15716.94" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1014" y="-15701.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1014" y="-15686.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_q_6 -->
<g id="edge282" class="edge">
<title>ln1_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M889.38,-15768.95C909.53,-15758.88 932.8,-15747.24 953.74,-15736.77"/>
<polygon fill="black" stroke="black" points="955.48,-15739.81 962.86,-15732.21 952.35,-15733.55 955.48,-15739.81"/>
</g>
<!-- mha_k_6 -->
<g id="node183" class="node">
<title>mha_k_6</title>
<polygon fill="lightblue" stroke="black" points="474,-15732.14 138,-15732.14 138,-15679.14 474,-15679.14 474,-15732.14"/>
<text text-anchor="middle" x="306" y="-15716.94" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="306" y="-15701.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="306" y="-15686.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_k_6 -->
<g id="edge283" class="edge">
<title>ln1_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M752.82,-15780.55C676.99,-15768.01 563.93,-15749.31 470.51,-15733.85"/>
<polygon fill="black" stroke="black" points="470.82,-15730.36 460.38,-15732.18 469.68,-15737.26 470.82,-15730.36"/>
</g>
<!-- mha_v_6 -->
<g id="node184" class="node">
<title>mha_v_6</title>
<polygon fill="lightblue" stroke="black" points="828,-15732.14 492,-15732.14 492,-15679.14 828,-15679.14 828,-15732.14"/>
<text text-anchor="middle" x="660" y="-15716.94" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="660" y="-15701.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="660" y="-15686.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_v_6 -->
<g id="edge284" class="edge">
<title>ln1_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M786.04,-15768.95C765.66,-15758.88 742.12,-15747.24 720.95,-15736.77"/>
<polygon fill="black" stroke="black" points="722.24,-15733.51 711.72,-15732.21 719.13,-15739.78 722.24,-15733.51"/>
</g>
<!-- mha_attn_6 -->
<g id="node185" class="node">
<title>mha_attn_6</title>
<polygon fill="lightblue" stroke="black" points="811,-15642.14 641,-15642.14 641,-15589.14 811,-15589.14 811,-15642.14"/>
<text text-anchor="middle" x="726" y="-15626.94" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="726" y="-15611.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="726" y="-15596.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge285" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M930.31,-15679.07C895.7,-15668.49 855.41,-15656.18 819.81,-15645.3"/>
<polygon fill="black" stroke="black" points="820.48,-15641.85 809.9,-15642.28 818.44,-15648.55 820.48,-15641.85"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge286" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M427.76,-15679.13C492.47,-15665.57 570.84,-15649.15 631,-15636.55"/>
<polygon fill="black" stroke="black" points="631.81,-15639.95 640.88,-15634.48 630.37,-15633.1 631.81,-15639.95"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge287" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M679.45,-15678.71C686.09,-15669.85 693.63,-15659.81 700.67,-15650.42"/>
<polygon fill="black" stroke="black" points="703.49,-15652.48 706.69,-15642.38 697.89,-15648.28 703.49,-15652.48"/>
</g>
<!-- mha_out_6 -->
<g id="node186" class="node">
<title>mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="1094,-15552.14 758,-15552.14 758,-15499.14 1094,-15499.14 1094,-15552.14"/>
<text text-anchor="middle" x="926" y="-15536.94" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="926" y="-15521.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="926" y="-15506.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge288" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M784.12,-15589.07C807.33,-15578.86 834.22,-15567.02 858.31,-15556.43"/>
<polygon fill="black" stroke="black" points="859.99,-15559.51 867.74,-15552.28 857.18,-15553.1 859.99,-15559.51"/>
</g>
<!-- residual1_6 -->
<g id="node187" class="node">
<title>residual1_6</title>
<polygon fill="lightcoral" stroke="black" points="1423.86,-15462.14 854.58,-15462.14 708.14,-15356.14 1277.42,-15356.14 1423.86,-15462.14"/>
<text text-anchor="middle" x="1066" y="-15420.44" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1066" y="-15405.44" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1066" y="-15390.44" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge290" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M957.42,-15498.95C968.43,-15489.94 981.3,-15479.41 994.25,-15468.82"/>
<polygon fill="black" stroke="black" points="996.79,-15471.27 1002.31,-15462.23 992.35,-15465.85 996.79,-15471.27"/>
</g>
<!-- ln2_6 -->
<g id="node188" class="node">
<title>ln2_6</title>
<polygon fill="lightyellow" stroke="black" points="2448,-15319.14 2278,-15319.14 2278,-15266.14 2448,-15266.14 2448,-15319.14"/>
<text text-anchor="middle" x="2363" y="-15303.94" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2363" y="-15288.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2363" y="-15273.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge291" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M1318.77,-15385.83C1608.74,-15360.23 2069.62,-15319.54 2267.56,-15302.07"/>
<polygon fill="black" stroke="black" points="2267.99,-15305.54 2277.64,-15301.18 2267.37,-15298.57 2267.99,-15305.54"/>
</g>
<!-- residual2_6 -->
<g id="node215" class="node">
<title>residual2_6</title>
<polygon fill="lightcoral" stroke="black" points="1423.86,-14614.14 854.58,-14614.14 708.14,-14508.14 1277.42,-14508.14 1423.86,-14614.14"/>
<text text-anchor="middle" x="1066" y="-14572.44" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1066" y="-14557.44" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1066" y="-14542.44" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge334" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1058.23,-15356.11C1055.92,-15336.57 1054,-15314.13 1054,-15293.64 1054,-15293.64 1054,-15293.64 1054,-14718.14 1054,-14687.3 1056.36,-14653.12 1058.99,-14624.64"/>
<polygon fill="black" stroke="black" points="1062.5,-14624.71 1059.96,-14614.42 1055.53,-14624.04 1062.5,-14624.71"/>
</g>
<!-- gate_6 -->
<g id="node189" class="node">
<title>gate_6</title>
<polygon fill="orange" stroke="black" points="2532,-15229.14 2223,-15176.14 2532,-15123.14 2841,-15176.14 2532,-15229.14"/>
<text text-anchor="middle" x="2532" y="-15187.44" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2532" y="-15172.44" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2532" y="-15157.44" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;gate_6 -->
<g id="edge292" class="edge">
<title>ln2_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M2400.93,-15265.95C2419.05,-15253.66 2441.34,-15238.56 2462.36,-15224.32"/>
<polygon fill="black" stroke="black" points="2464.34,-15227.21 2470.65,-15218.71 2460.41,-15221.42 2464.34,-15227.21"/>
</g>
<!-- expert_6_0 -->
<g id="node190" class="node">
<title>expert_6_0</title>
<polygon fill="lightcyan" stroke="black" points="1789.5,-15072.14 1444.5,-15072.14 1444.5,-15004.14 1789.5,-15004.14 1789.5,-15072.14"/>
<text text-anchor="middle" x="1617" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1617" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1617" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1617" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_0 -->
<g id="edge294" class="edge">
<title>ln2_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" d="M2277.98,-15288.65C2137.02,-15279.7 1851.79,-15244.34 1663,-15105.14 1654.05,-15098.54 1646.22,-15089.66 1639.67,-15080.56"/>
<polygon fill="black" stroke="black" points="1642.52,-15078.53 1634.03,-15072.2 1636.72,-15082.44 1642.52,-15078.53"/>
</g>
<!-- expert_6_1 -->
<g id="node193" class="node">
<title>expert_6_1</title>
<polygon fill="lightcyan" stroke="black" points="2915.5,-15072.14 2570.5,-15072.14 2570.5,-15004.14 2915.5,-15004.14 2915.5,-15072.14"/>
<text text-anchor="middle" x="2743" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2743" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2743" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2743" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_1 -->
<g id="edge299" class="edge">
<title>ln2_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" d="M2448.19,-15286.61C2580.57,-15277.93 2823.35,-15258.23 2850,-15229.14 2891.76,-15183.56 2888.45,-15142.13 2855,-15090.14 2852.46,-15086.19 2849.53,-15082.55 2846.3,-15079.18"/>
<polygon fill="black" stroke="black" points="2848.5,-15076.45 2838.77,-15072.25 2843.76,-15081.6 2848.5,-15076.45"/>
</g>
<!-- expert_6_2 -->
<g id="node196" class="node">
<title>expert_6_2</title>
<polygon fill="lightcyan" stroke="black" points="3641.5,-15072.14 3296.5,-15072.14 3296.5,-15004.14 3641.5,-15004.14 3641.5,-15072.14"/>
<text text-anchor="middle" x="3469" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3469" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3469" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3469" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_2 -->
<g id="edge304" class="edge">
<title>ln2_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" d="M2448.15,-15285.61C2544.25,-15278.42 2705.15,-15265.19 2843,-15248.14 3111.63,-15214.91 3223.89,-15274.55 3435,-15105.14 3442.76,-15098.91 3448.93,-15090.44 3453.77,-15081.65"/>
<polygon fill="black" stroke="black" points="3457.02,-15082.95 3458.33,-15072.44 3450.75,-15079.84 3457.02,-15082.95"/>
</g>
<!-- expert_6_3 -->
<g id="node199" class="node">
<title>expert_6_3</title>
<polygon fill="lightcyan" stroke="black" points="1426.5,-15072.14 1081.5,-15072.14 1081.5,-15004.14 1426.5,-15004.14 1426.5,-15072.14"/>
<text text-anchor="middle" x="1254" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1254" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1254" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1254" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_3 -->
<g id="edge309" class="edge">
<title>ln2_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" d="M2277.73,-15292.52C2147.73,-15291.92 1893.12,-15283.07 1685,-15229.14 1550.2,-15194.21 1404.02,-15121.67 1321.25,-15077.02"/>
<polygon fill="black" stroke="black" points="1322.92,-15073.95 1312.46,-15072.26 1319.58,-15080.1 1322.92,-15073.95"/>
</g>
<!-- expert_6_4 -->
<g id="node202" class="node">
<title>expert_6_4</title>
<polygon fill="lightcyan" stroke="black" points="3278.5,-15072.14 2933.5,-15072.14 2933.5,-15004.14 3278.5,-15004.14 3278.5,-15072.14"/>
<text text-anchor="middle" x="3106" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3106" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3106" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3106" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_4 -->
<g id="edge314" class="edge">
<title>ln2_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" d="M2448.24,-15288.78C2575.1,-15283.27 2806.45,-15268.09 2879,-15229.14 2953.26,-15189.27 3025.54,-15122.5 3067.9,-15079.66"/>
<polygon fill="black" stroke="black" points="3070.44,-15082.07 3074.95,-15072.48 3065.45,-15077.17 3070.44,-15082.07"/>
</g>
<!-- expert_6_5 -->
<g id="node205" class="node">
<title>expert_6_5</title>
<polygon fill="lightcyan" stroke="black" points="4004.5,-15072.14 3659.5,-15072.14 3659.5,-15004.14 4004.5,-15004.14 4004.5,-15072.14"/>
<text text-anchor="middle" x="3832" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3832" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3832" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3832" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_5 -->
<g id="edge319" class="edge">
<title>ln2_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" d="M2448.22,-15288.86C2646.12,-15281.92 3132.08,-15262.02 3292,-15229.14 3459.02,-15194.81 3644.72,-15121.15 3749.04,-15076.3"/>
<polygon fill="black" stroke="black" points="3750.46,-15079.5 3758.26,-15072.32 3747.69,-15073.07 3750.46,-15079.5"/>
</g>
<!-- expert_6_6 -->
<g id="node208" class="node">
<title>expert_6_6</title>
<polygon fill="lightcyan" stroke="black" points="2152.5,-15072.14 1807.5,-15072.14 1807.5,-15004.14 2152.5,-15004.14 2152.5,-15072.14"/>
<text text-anchor="middle" x="1980" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="1980" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1980" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1980" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_6 -->
<g id="edge324" class="edge">
<title>ln2_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" d="M2277.67,-15267.31C2260.35,-15261.61 2242.42,-15255.13 2226,-15248.14 2137.41,-15210.43 2056.93,-15129.2 2013.57,-15079.85"/>
<polygon fill="black" stroke="black" points="2016.14,-15077.47 2006.94,-15072.22 2010.86,-15082.06 2016.14,-15077.47"/>
</g>
<!-- expert_6_7 -->
<g id="node211" class="node">
<title>expert_6_7</title>
<polygon fill="lightcyan" stroke="black" points="2515.5,-15072.14 2170.5,-15072.14 2170.5,-15004.14 2515.5,-15004.14 2515.5,-15072.14"/>
<text text-anchor="middle" x="2343" y="-15056.94" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2343" y="-15041.94" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2343" y="-15026.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2343" y="-15011.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;expert_6_7 -->
<g id="edge329" class="edge">
<title>ln2_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" d="M2277.84,-15274.91C2253.08,-15265.66 2228.76,-15251.33 2214,-15229.14 2187.91,-15189.91 2191.55,-15164.56 2214,-15123.14 2223.96,-15104.77 2239.87,-15089.78 2257.17,-15077.83"/>
<polygon fill="black" stroke="black" points="2259.31,-15080.61 2265.76,-15072.2 2255.48,-15074.75 2259.31,-15080.61"/>
</g>
<!-- gate_6&#45;&gt;expert_6_0 -->
<g id="edge293" class="edge">
<title>gate_6&#45;&gt;expert_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2358.8,-15152.78C2212.55,-15133.43 1997.39,-15103.88 1799.88,-15072.26"/>
<polygon fill="black" stroke="black" points="1800.32,-15068.79 1789.89,-15070.66 1799.21,-15075.7 1800.32,-15068.79"/>
<text text-anchor="middle" x="2044.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_1 -->
<g id="edge298" class="edge">
<title>gate_6&#45;&gt;expert_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2582.59,-15131.81C2600.19,-15117.7 2620.43,-15102.5 2640,-15090.14 2647.09,-15085.66 2654.64,-15081.28 2662.29,-15077.08"/>
<polygon fill="black" stroke="black" points="2664.15,-15080.05 2671.3,-15072.24 2660.83,-15073.89 2664.15,-15080.05"/>
<text text-anchor="middle" x="2685.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_2 -->
<g id="edge303" class="edge">
<title>gate_6&#45;&gt;expert_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2708.38,-15153.39C2859.34,-15134.24 3082.64,-15104.64 3286.12,-15072.42"/>
<polygon fill="black" stroke="black" points="3286.78,-15075.86 3296.1,-15070.84 3285.68,-15068.95 3286.78,-15075.86"/>
<text text-anchor="middle" x="3209.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_3 -->
<g id="edge308" class="edge">
<title>gate_6&#45;&gt;expert_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2315.35,-15160.28C2096.19,-15143.98 1747.59,-15114.55 1436.97,-15072.24"/>
<polygon fill="black" stroke="black" points="1437.24,-15068.74 1426.86,-15070.85 1436.29,-15075.68 1437.24,-15068.74"/>
<text text-anchor="middle" x="1750.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_4 -->
<g id="edge313" class="edge">
<title>gate_6&#45;&gt;expert_6_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2636.92,-15141.13C2691.43,-15124.26 2759.37,-15104.49 2821,-15090.14 2863.74,-15080.19 2877.11,-15080.29 2923.09,-15072.44"/>
<polygon fill="black" stroke="black" points="2923.83,-15075.87 2933.08,-15070.7 2922.63,-15068.97 2923.83,-15075.87"/>
<text text-anchor="middle" x="2866.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_5 -->
<g id="edge318" class="edge">
<title>gate_6&#45;&gt;expert_6_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2751.36,-15160.72C2975.02,-15144.68 3332.04,-15115.38 3648.82,-15072.41"/>
<polygon fill="black" stroke="black" points="3649.69,-15075.82 3659.13,-15071 3648.75,-15068.88 3649.69,-15075.82"/>
<text text-anchor="middle" x="3544.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_6 -->
<g id="edge323" class="edge">
<title>gate_6&#45;&gt;expert_6_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2407.43,-15144.45C2323.3,-15123.72 2211.98,-15096.3 2124.03,-15074.63"/>
<polygon fill="black" stroke="black" points="2124.79,-15071.21 2114.25,-15072.22 2123.12,-15078.01 2124.79,-15071.21"/>
<text text-anchor="middle" x="2284.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_6&#45;&gt;expert_6_7 -->
<g id="edge328" class="edge">
<title>gate_6&#45;&gt;expert_6_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2473.49,-15133.04C2449.15,-15115.53 2421.06,-15095.31 2397.2,-15078.14"/>
<polygon fill="black" stroke="black" points="2399.11,-15075.2 2388.94,-15072.2 2395.02,-15080.88 2399.11,-15075.2"/>
<text text-anchor="middle" x="2476.5" y="-15093.94" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_6 -->
<g id="node214" class="node">
<title>expert_agg_6</title>
<polygon fill="lightpink" stroke="black" points="2709.86,-14787.14 2364.88,-14787.14 2276.14,-14651.14 2621.12,-14651.14 2709.86,-14787.14"/>
<text text-anchor="middle" x="2493" y="-14737.94" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2493" y="-14722.94" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2493" y="-14707.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2493" y="-14692.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gate_6&#45;&gt;expert_agg_6 -->
<g id="edge333" class="edge">
<title>gate_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2538.11,-15123.88C2540.64,-15098.44 2543,-15067.21 2543,-15039.14 2543,-15039.14 2543,-15039.14 2543,-14849.64 2543,-14832.01 2538.92,-14813.89 2533.09,-14796.99"/>
<polygon fill="black" stroke="black" points="2536.22,-14795.36 2529.47,-14787.19 2529.65,-14797.78 2536.22,-14795.36"/>
<text text-anchor="middle" x="2571.5" y="-14936.94" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_6_0 -->
<g id="node191" class="node">
<title>expert_gelu_6_0</title>
<polygon fill="lightcyan" stroke="black" points="1706.5,-14967.14 1527.5,-14967.14 1527.5,-14914.14 1706.5,-14914.14 1706.5,-14967.14"/>
<text text-anchor="middle" x="1617" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1617" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1617" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_0&#45;&gt;expert_gelu_6_0 -->
<g id="edge295" class="edge">
<title>expert_6_0&#45;&gt;expert_gelu_6_0</title>
<path fill="none" stroke="black" d="M1617,-15004.01C1617,-14995.43 1617,-14986.15 1617,-14977.44"/>
<polygon fill="black" stroke="black" points="1620.5,-14977.19 1617,-14967.19 1613.5,-14977.19 1620.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_0 -->
<g id="node192" class="node">
<title>expert_ffn2_6_0</title>
<polygon fill="lightcyan" stroke="black" points="1789.5,-14877.14 1444.5,-14877.14 1444.5,-14824.14 1789.5,-14824.14 1789.5,-14877.14"/>
<text text-anchor="middle" x="1617" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1617" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1617" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_0&#45;&gt;expert_ffn2_6_0 -->
<g id="edge296" class="edge">
<title>expert_gelu_6_0&#45;&gt;expert_ffn2_6_0</title>
<path fill="none" stroke="black" d="M1617,-14913.71C1617,-14905.48 1617,-14896.22 1617,-14887.42"/>
<polygon fill="black" stroke="black" points="1620.5,-14887.38 1617,-14877.38 1613.5,-14887.38 1620.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_0&#45;&gt;expert_agg_6 -->
<g id="edge297" class="edge">
<title>expert_ffn2_6_0&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M1789.55,-14824.13C1945.13,-14801.13 2172.48,-14767.52 2326.25,-14744.79"/>
<polygon fill="black" stroke="black" points="2326.89,-14748.24 2336.27,-14743.31 2325.86,-14741.31 2326.89,-14748.24"/>
</g>
<!-- expert_gelu_6_1 -->
<g id="node194" class="node">
<title>expert_gelu_6_1</title>
<polygon fill="lightcyan" stroke="black" points="2832.5,-14967.14 2653.5,-14967.14 2653.5,-14914.14 2832.5,-14914.14 2832.5,-14967.14"/>
<text text-anchor="middle" x="2743" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2743" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2743" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_1&#45;&gt;expert_gelu_6_1 -->
<g id="edge300" class="edge">
<title>expert_6_1&#45;&gt;expert_gelu_6_1</title>
<path fill="none" stroke="black" d="M2743,-15004.01C2743,-14995.43 2743,-14986.15 2743,-14977.44"/>
<polygon fill="black" stroke="black" points="2746.5,-14977.19 2743,-14967.19 2739.5,-14977.19 2746.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_1 -->
<g id="node195" class="node">
<title>expert_ffn2_6_1</title>
<polygon fill="lightcyan" stroke="black" points="2915.5,-14877.14 2570.5,-14877.14 2570.5,-14824.14 2915.5,-14824.14 2915.5,-14877.14"/>
<text text-anchor="middle" x="2743" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2743" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2743" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_1&#45;&gt;expert_ffn2_6_1 -->
<g id="edge301" class="edge">
<title>expert_gelu_6_1&#45;&gt;expert_ffn2_6_1</title>
<path fill="none" stroke="black" d="M2743,-14913.71C2743,-14905.48 2743,-14896.22 2743,-14887.42"/>
<polygon fill="black" stroke="black" points="2746.5,-14887.38 2743,-14877.38 2739.5,-14887.38 2746.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_1&#45;&gt;expert_agg_6 -->
<g id="edge302" class="edge">
<title>expert_ffn2_6_1&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M2693.61,-14824.06C2675.33,-14814.59 2653.6,-14803.33 2631.29,-14791.78"/>
<polygon fill="black" stroke="black" points="2632.88,-14788.66 2622.39,-14787.16 2629.66,-14794.87 2632.88,-14788.66"/>
</g>
<!-- expert_gelu_6_2 -->
<g id="node197" class="node">
<title>expert_gelu_6_2</title>
<polygon fill="lightcyan" stroke="black" points="3558.5,-14967.14 3379.5,-14967.14 3379.5,-14914.14 3558.5,-14914.14 3558.5,-14967.14"/>
<text text-anchor="middle" x="3469" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3469" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3469" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_2&#45;&gt;expert_gelu_6_2 -->
<g id="edge305" class="edge">
<title>expert_6_2&#45;&gt;expert_gelu_6_2</title>
<path fill="none" stroke="black" d="M3469,-15004.01C3469,-14995.43 3469,-14986.15 3469,-14977.44"/>
<polygon fill="black" stroke="black" points="3472.5,-14977.19 3469,-14967.19 3465.5,-14977.19 3472.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_2 -->
<g id="node198" class="node">
<title>expert_ffn2_6_2</title>
<polygon fill="lightcyan" stroke="black" points="3641.5,-14877.14 3296.5,-14877.14 3296.5,-14824.14 3641.5,-14824.14 3641.5,-14877.14"/>
<text text-anchor="middle" x="3469" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3469" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3469" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_2&#45;&gt;expert_ffn2_6_2 -->
<g id="edge306" class="edge">
<title>expert_gelu_6_2&#45;&gt;expert_ffn2_6_2</title>
<path fill="none" stroke="black" d="M3469,-14913.71C3469,-14905.48 3469,-14896.22 3469,-14887.42"/>
<polygon fill="black" stroke="black" points="3472.5,-14887.38 3469,-14877.38 3465.5,-14887.38 3472.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_2&#45;&gt;expert_agg_6 -->
<g id="edge307" class="edge">
<title>expert_ffn2_6_2&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M3296.08,-14825.24C3293.37,-14824.87 3290.67,-14824.5 3288,-14824.14 3085.18,-14796.59 2853.06,-14766.38 2692.22,-14745.65"/>
<polygon fill="black" stroke="black" points="2692.58,-14742.17 2682.21,-14744.36 2691.68,-14749.11 2692.58,-14742.17"/>
</g>
<!-- expert_gelu_6_3 -->
<g id="node200" class="node">
<title>expert_gelu_6_3</title>
<polygon fill="lightcyan" stroke="black" points="1343.5,-14967.14 1164.5,-14967.14 1164.5,-14914.14 1343.5,-14914.14 1343.5,-14967.14"/>
<text text-anchor="middle" x="1254" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1254" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1254" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_3&#45;&gt;expert_gelu_6_3 -->
<g id="edge310" class="edge">
<title>expert_6_3&#45;&gt;expert_gelu_6_3</title>
<path fill="none" stroke="black" d="M1254,-15004.01C1254,-14995.43 1254,-14986.15 1254,-14977.44"/>
<polygon fill="black" stroke="black" points="1257.5,-14977.19 1254,-14967.19 1250.5,-14977.19 1257.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_3 -->
<g id="node201" class="node">
<title>expert_ffn2_6_3</title>
<polygon fill="lightcyan" stroke="black" points="1426.5,-14877.14 1081.5,-14877.14 1081.5,-14824.14 1426.5,-14824.14 1426.5,-14877.14"/>
<text text-anchor="middle" x="1254" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1254" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1254" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_3&#45;&gt;expert_ffn2_6_3 -->
<g id="edge311" class="edge">
<title>expert_gelu_6_3&#45;&gt;expert_ffn2_6_3</title>
<path fill="none" stroke="black" d="M1254,-14913.71C1254,-14905.48 1254,-14896.22 1254,-14887.42"/>
<polygon fill="black" stroke="black" points="1257.5,-14887.38 1254,-14877.38 1250.5,-14887.38 1257.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_3&#45;&gt;expert_agg_6 -->
<g id="edge312" class="edge">
<title>expert_ffn2_6_3&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M1426.9,-14825.24C1429.95,-14824.87 1432.99,-14824.5 1436,-14824.14 1746.75,-14787.1 2110.05,-14753.46 2319.63,-14735"/>
<polygon fill="black" stroke="black" points="2320.15,-14738.46 2329.81,-14734.1 2319.54,-14731.49 2320.15,-14738.46"/>
</g>
<!-- expert_gelu_6_4 -->
<g id="node203" class="node">
<title>expert_gelu_6_4</title>
<polygon fill="lightcyan" stroke="black" points="3195.5,-14967.14 3016.5,-14967.14 3016.5,-14914.14 3195.5,-14914.14 3195.5,-14967.14"/>
<text text-anchor="middle" x="3106" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3106" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3106" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_4&#45;&gt;expert_gelu_6_4 -->
<g id="edge315" class="edge">
<title>expert_6_4&#45;&gt;expert_gelu_6_4</title>
<path fill="none" stroke="black" d="M3106,-15004.01C3106,-14995.43 3106,-14986.15 3106,-14977.44"/>
<polygon fill="black" stroke="black" points="3109.5,-14977.19 3106,-14967.19 3102.5,-14977.19 3109.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_4 -->
<g id="node204" class="node">
<title>expert_ffn2_6_4</title>
<polygon fill="lightcyan" stroke="black" points="3278.5,-14877.14 2933.5,-14877.14 2933.5,-14824.14 3278.5,-14824.14 3278.5,-14877.14"/>
<text text-anchor="middle" x="3106" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3106" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3106" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_4&#45;&gt;expert_ffn2_6_4 -->
<g id="edge316" class="edge">
<title>expert_gelu_6_4&#45;&gt;expert_ffn2_6_4</title>
<path fill="none" stroke="black" d="M3106,-14913.71C3106,-14905.48 3106,-14896.22 3106,-14887.42"/>
<polygon fill="black" stroke="black" points="3109.5,-14887.38 3106,-14877.38 3102.5,-14887.38 3109.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_4&#45;&gt;expert_agg_6 -->
<g id="edge317" class="edge">
<title>expert_ffn2_6_4&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M2985.26,-14824.13C2905.16,-14807.21 2797.9,-14784.55 2703.95,-14764.71"/>
<polygon fill="black" stroke="black" points="2704.53,-14761.25 2694.02,-14762.61 2703.08,-14768.1 2704.53,-14761.25"/>
</g>
<!-- expert_gelu_6_5 -->
<g id="node206" class="node">
<title>expert_gelu_6_5</title>
<polygon fill="lightcyan" stroke="black" points="3921.5,-14967.14 3742.5,-14967.14 3742.5,-14914.14 3921.5,-14914.14 3921.5,-14967.14"/>
<text text-anchor="middle" x="3832" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3832" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3832" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_5&#45;&gt;expert_gelu_6_5 -->
<g id="edge320" class="edge">
<title>expert_6_5&#45;&gt;expert_gelu_6_5</title>
<path fill="none" stroke="black" d="M3832,-15004.01C3832,-14995.43 3832,-14986.15 3832,-14977.44"/>
<polygon fill="black" stroke="black" points="3835.5,-14977.19 3832,-14967.19 3828.5,-14977.19 3835.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_5 -->
<g id="node207" class="node">
<title>expert_ffn2_6_5</title>
<polygon fill="lightcyan" stroke="black" points="4004.5,-14877.14 3659.5,-14877.14 3659.5,-14824.14 4004.5,-14824.14 4004.5,-14877.14"/>
<text text-anchor="middle" x="3832" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3832" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3832" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_5&#45;&gt;expert_ffn2_6_5 -->
<g id="edge321" class="edge">
<title>expert_gelu_6_5&#45;&gt;expert_ffn2_6_5</title>
<path fill="none" stroke="black" d="M3832,-14913.71C3832,-14905.48 3832,-14896.22 3832,-14887.42"/>
<polygon fill="black" stroke="black" points="3835.5,-14887.38 3832,-14877.38 3828.5,-14887.38 3835.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_5&#45;&gt;expert_agg_6 -->
<g id="edge322" class="edge">
<title>expert_ffn2_6_5&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M3659.1,-14825.09C3656.38,-14824.77 3653.68,-14824.45 3651,-14824.14 3311.89,-14785.05 2915.48,-14752.22 2685.45,-14734.44"/>
<polygon fill="black" stroke="black" points="2685.54,-14730.94 2675.3,-14733.66 2685.01,-14737.92 2685.54,-14730.94"/>
</g>
<!-- expert_gelu_6_6 -->
<g id="node209" class="node">
<title>expert_gelu_6_6</title>
<polygon fill="lightcyan" stroke="black" points="2069.5,-14967.14 1890.5,-14967.14 1890.5,-14914.14 2069.5,-14914.14 2069.5,-14967.14"/>
<text text-anchor="middle" x="1980" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1980" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1980" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_6&#45;&gt;expert_gelu_6_6 -->
<g id="edge325" class="edge">
<title>expert_6_6&#45;&gt;expert_gelu_6_6</title>
<path fill="none" stroke="black" d="M1980,-15004.01C1980,-14995.43 1980,-14986.15 1980,-14977.44"/>
<polygon fill="black" stroke="black" points="1983.5,-14977.19 1980,-14967.19 1976.5,-14977.19 1983.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_6 -->
<g id="node210" class="node">
<title>expert_ffn2_6_6</title>
<polygon fill="lightcyan" stroke="black" points="2152.5,-14877.14 1807.5,-14877.14 1807.5,-14824.14 2152.5,-14824.14 2152.5,-14877.14"/>
<text text-anchor="middle" x="1980" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="1980" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1980" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_6&#45;&gt;expert_ffn2_6_6 -->
<g id="edge326" class="edge">
<title>expert_gelu_6_6&#45;&gt;expert_ffn2_6_6</title>
<path fill="none" stroke="black" d="M1980,-14913.71C1980,-14905.48 1980,-14896.22 1980,-14887.42"/>
<polygon fill="black" stroke="black" points="1983.5,-14887.38 1980,-14877.38 1976.5,-14887.38 1983.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_6&#45;&gt;expert_agg_6 -->
<g id="edge327" class="edge">
<title>expert_ffn2_6_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M2081.05,-14824.13C2153.49,-14805.85 2252.49,-14780.85 2335.28,-14759.95"/>
<polygon fill="black" stroke="black" points="2336.2,-14763.33 2345.04,-14757.49 2334.49,-14756.55 2336.2,-14763.33"/>
</g>
<!-- expert_gelu_6_7 -->
<g id="node212" class="node">
<title>expert_gelu_6_7</title>
<polygon fill="lightcyan" stroke="black" points="2432.5,-14967.14 2253.5,-14967.14 2253.5,-14914.14 2432.5,-14914.14 2432.5,-14967.14"/>
<text text-anchor="middle" x="2343" y="-14951.94" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2343" y="-14936.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2343" y="-14921.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_6_7&#45;&gt;expert_gelu_6_7 -->
<g id="edge330" class="edge">
<title>expert_6_7&#45;&gt;expert_gelu_6_7</title>
<path fill="none" stroke="black" d="M2343,-15004.01C2343,-14995.43 2343,-14986.15 2343,-14977.44"/>
<polygon fill="black" stroke="black" points="2346.5,-14977.19 2343,-14967.19 2339.5,-14977.19 2346.5,-14977.19"/>
</g>
<!-- expert_ffn2_6_7 -->
<g id="node213" class="node">
<title>expert_ffn2_6_7</title>
<polygon fill="lightcyan" stroke="black" points="2515.5,-14877.14 2170.5,-14877.14 2170.5,-14824.14 2515.5,-14824.14 2515.5,-14877.14"/>
<text text-anchor="middle" x="2343" y="-14861.94" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2343" y="-14846.94" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2343" y="-14831.94" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- expert_gelu_6_7&#45;&gt;expert_ffn2_6_7 -->
<g id="edge331" class="edge">
<title>expert_gelu_6_7&#45;&gt;expert_ffn2_6_7</title>
<path fill="none" stroke="black" d="M2343,-14913.71C2343,-14905.48 2343,-14896.22 2343,-14887.42"/>
<polygon fill="black" stroke="black" points="2346.5,-14887.38 2343,-14877.38 2339.5,-14887.38 2346.5,-14887.38"/>
</g>
<!-- expert_ffn2_6_7&#45;&gt;expert_agg_6 -->
<g id="edge332" class="edge">
<title>expert_ffn2_6_7&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="black" d="M2372.64,-14824.06C2382.89,-14815.21 2394.95,-14804.79 2407.41,-14794.03"/>
<polygon fill="black" stroke="black" points="2409.93,-14796.48 2415.21,-14787.3 2405.35,-14791.18 2409.93,-14796.48"/>
</g>
<!-- expert_agg_6&#45;&gt;residual2_6 -->
<g id="edge335" class="edge">
<title>expert_agg_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M2306.44,-14697.75C2080.22,-14673.02 1694.3,-14630.83 1412.87,-14600.06"/>
<polygon fill="black" stroke="black" points="1413.23,-14596.58 1402.91,-14598.97 1412.47,-14603.54 1413.23,-14596.58"/>
</g>
<!-- comm_6_7 -->
<g id="node252" class="node">
<title>comm_6_7</title>
<ellipse fill="lightgreen" stroke="black" cx="1066" cy="-14444.27" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1066" y="-14448.07" font-family="Times,serif" font-size="14.00">GPU 5 → GPU 6</text>
<text text-anchor="middle" x="1066" y="-14433.07" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_6&#45;&gt;comm_6_7 -->
<g id="edge336" class="edge">
<title>residual2_6&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M1066,-14508.08C1066,-14499.15 1066,-14490.04 1066,-14481.64"/>
<polygon fill="black" stroke="black" points="1069.5,-14481.43 1066,-14471.43 1062.5,-14481.43 1069.5,-14481.43"/>
</g>
<!-- comm_5_6&#45;&gt;ln1_6 -->
<g id="edge281" class="edge">
<title>comm_5_6&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M1006.84,-15862.37C978.27,-15851.25 943.5,-15837.71 912.96,-15825.82"/>
<polygon fill="black" stroke="black" points="914.22,-15822.56 903.63,-15822.19 911.68,-15829.08 914.22,-15822.56"/>
</g>
<!-- comm_5_6&#45;&gt;residual1_6 -->
<g id="edge289" class="edge">
<title>comm_5_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1145.98,-15865.98C1179.19,-15852.92 1210,-15831.43 1210,-15796.64 1210,-15796.64 1210,-15796.64 1210,-15524.64 1210,-15502.82 1199.74,-15484.49 1184.71,-15469.34"/>
<polygon fill="black" stroke="black" points="1186.68,-15466.4 1176.96,-15462.16 1181.92,-15471.53 1186.68,-15466.4"/>
</g>
<!-- ln1_7 -->
<g id="node217" class="node">
<title>ln1_7</title>
<polygon fill="lightyellow" stroke="black" points="924,-14380.4 754,-14380.4 754,-14327.4 924,-14327.4 924,-14380.4"/>
<text text-anchor="middle" x="839" y="-14365.2" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="839" y="-14350.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="839" y="-14335.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_q_7 -->
<g id="node218" class="node">
<title>mha_q_7</title>
<polygon fill="lightblue" stroke="black" points="1184,-14290.4 848,-14290.4 848,-14237.4 1184,-14237.4 1184,-14290.4"/>
<text text-anchor="middle" x="1016" y="-14275.2" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1016" y="-14260.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1016" y="-14245.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_q_7 -->
<g id="edge338" class="edge">
<title>ln1_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M890.67,-14327.21C910.94,-14317.14 934.34,-14305.5 955.39,-14295.03"/>
<polygon fill="black" stroke="black" points="957.17,-14298.06 964.57,-14290.47 954.06,-14291.79 957.17,-14298.06"/>
</g>
<!-- mha_k_7 -->
<g id="node219" class="node">
<title>mha_k_7</title>
<polygon fill="lightblue" stroke="black" points="476,-14290.4 140,-14290.4 140,-14237.4 476,-14237.4 476,-14290.4"/>
<text text-anchor="middle" x="308" y="-14275.2" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="308" y="-14260.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="308" y="-14245.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_k_7 -->
<g id="edge339" class="edge">
<title>ln1_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M753.98,-14338.81C678.29,-14326.27 565.44,-14307.57 472.2,-14292.11"/>
<polygon fill="black" stroke="black" points="472.53,-14288.62 462.09,-14290.44 471.38,-14295.53 472.53,-14288.62"/>
</g>
<!-- mha_v_7 -->
<g id="node220" class="node">
<title>mha_v_7</title>
<polygon fill="lightblue" stroke="black" points="830,-14290.4 494,-14290.4 494,-14237.4 830,-14237.4 830,-14290.4"/>
<text text-anchor="middle" x="662" y="-14275.2" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="662" y="-14260.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="662" y="-14245.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_v_7 -->
<g id="edge340" class="edge">
<title>ln1_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M787.33,-14327.21C767.06,-14317.14 743.66,-14305.5 722.61,-14295.03"/>
<polygon fill="black" stroke="black" points="723.94,-14291.79 713.43,-14290.47 720.83,-14298.06 723.94,-14291.79"/>
</g>
<!-- mha_attn_7 -->
<g id="node221" class="node">
<title>mha_attn_7</title>
<polygon fill="lightblue" stroke="black" points="813,-14200.4 643,-14200.4 643,-14147.4 813,-14147.4 813,-14200.4"/>
<text text-anchor="middle" x="728" y="-14185.2" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="728" y="-14170.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="728" y="-14155.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge341" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M932.31,-14237.33C897.7,-14226.75 857.41,-14214.44 821.81,-14203.56"/>
<polygon fill="black" stroke="black" points="822.48,-14200.11 811.9,-14200.54 820.44,-14206.81 822.48,-14200.11"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge342" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M429.76,-14237.39C494.47,-14223.83 572.84,-14207.41 633,-14194.81"/>
<polygon fill="black" stroke="black" points="633.81,-14198.21 642.88,-14192.74 632.37,-14191.36 633.81,-14198.21"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge343" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M681.45,-14236.97C688.09,-14228.11 695.63,-14218.07 702.67,-14208.68"/>
<polygon fill="black" stroke="black" points="705.49,-14210.74 708.69,-14200.64 699.89,-14206.54 705.49,-14210.74"/>
</g>
<!-- mha_out_7 -->
<g id="node222" class="node">
<title>mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="1096,-14110.4 760,-14110.4 760,-14057.4 1096,-14057.4 1096,-14110.4"/>
<text text-anchor="middle" x="928" y="-14095.2" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="928" y="-14080.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="928" y="-14065.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge344" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M786.12,-14147.33C809.33,-14137.12 836.22,-14125.28 860.31,-14114.69"/>
<polygon fill="black" stroke="black" points="861.99,-14117.77 869.74,-14110.54 859.18,-14111.36 861.99,-14117.77"/>
</g>
<!-- residual1_7 -->
<g id="node223" class="node">
<title>residual1_7</title>
<polygon fill="lightcoral" stroke="black" points="1471.86,-14020.4 902.58,-14020.4 756.14,-13914.4 1325.42,-13914.4 1471.86,-14020.4"/>
<text text-anchor="middle" x="1114" y="-13978.7" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1114" y="-13963.7" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1114" y="-13948.7" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge346" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M969.74,-14057.21C984.93,-14047.86 1002.77,-14036.87 1020.63,-14025.88"/>
<polygon fill="black" stroke="black" points="1022.7,-14028.71 1029.38,-14020.49 1019.03,-14022.75 1022.7,-14028.71"/>
</g>
<!-- ln2_7 -->
<g id="node224" class="node">
<title>ln2_7</title>
<polygon fill="lightyellow" stroke="black" points="2496,-13877.4 2326,-13877.4 2326,-13824.4 2496,-13824.4 2496,-13877.4"/>
<text text-anchor="middle" x="2411" y="-13862.2" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2411" y="-13847.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2411" y="-13832.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge347" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M1366.77,-13944.09C1656.74,-13918.49 2117.62,-13877.8 2315.56,-13860.33"/>
<polygon fill="black" stroke="black" points="2315.99,-13863.8 2325.64,-13859.44 2315.37,-13856.83 2315.99,-13863.8"/>
</g>
<!-- residual2_7 -->
<g id="node251" class="node">
<title>residual2_7</title>
<polygon fill="lightcoral" stroke="black" points="1471.86,-13172.4 902.58,-13172.4 756.14,-13066.4 1325.42,-13066.4 1471.86,-13172.4"/>
<text text-anchor="middle" x="1114" y="-13130.7" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1114" y="-13115.7" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1114" y="-13100.7" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge390" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1106.23,-13914.37C1103.92,-13894.83 1102,-13872.39 1102,-13851.9 1102,-13851.9 1102,-13851.9 1102,-13276.4 1102,-13245.56 1104.36,-13211.38 1106.99,-13182.9"/>
<polygon fill="black" stroke="black" points="1110.5,-13182.97 1107.96,-13172.68 1103.53,-13182.3 1110.5,-13182.97"/>
</g>
<!-- gate_7 -->
<g id="node225" class="node">
<title>gate_7</title>
<polygon fill="orange" stroke="black" points="2580,-13787.4 2271,-13734.4 2580,-13681.4 2889,-13734.4 2580,-13787.4"/>
<text text-anchor="middle" x="2580" y="-13745.7" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2580" y="-13730.7" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2580" y="-13715.7" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;gate_7 -->
<g id="edge348" class="edge">
<title>ln2_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M2448.93,-13824.21C2467.05,-13811.92 2489.34,-13796.82 2510.36,-13782.58"/>
<polygon fill="black" stroke="black" points="2512.34,-13785.47 2518.65,-13776.97 2508.41,-13779.68 2512.34,-13785.47"/>
</g>
<!-- expert_7_0 -->
<g id="node226" class="node">
<title>expert_7_0</title>
<polygon fill="lightcyan" stroke="black" points="1837.5,-13630.4 1492.5,-13630.4 1492.5,-13562.4 1837.5,-13562.4 1837.5,-13630.4"/>
<text text-anchor="middle" x="1665" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1665" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1665" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1665" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_0 -->
<g id="edge350" class="edge">
<title>ln2_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" d="M2325.9,-13842.25C2190.44,-13826.8 1921.43,-13782.53 1729,-13663.4 1717.97,-13656.57 1707.49,-13647.43 1698.33,-13638.13"/>
<polygon fill="black" stroke="black" points="1700.69,-13635.53 1691.28,-13630.67 1695.61,-13640.34 1700.69,-13635.53"/>
</g>
<!-- expert_7_1 -->
<g id="node229" class="node">
<title>expert_7_1</title>
<polygon fill="lightcyan" stroke="black" points="2963.5,-13630.4 2618.5,-13630.4 2618.5,-13562.4 2963.5,-13562.4 2963.5,-13630.4"/>
<text text-anchor="middle" x="2791" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2791" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2791" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2791" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_1 -->
<g id="edge355" class="edge">
<title>ln2_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" d="M2496.19,-13844.87C2628.57,-13836.19 2871.35,-13816.49 2898,-13787.4 2939.76,-13741.82 2936.45,-13700.39 2903,-13648.4 2900.46,-13644.45 2897.53,-13640.81 2894.3,-13637.44"/>
<polygon fill="black" stroke="black" points="2896.5,-13634.71 2886.77,-13630.51 2891.76,-13639.86 2896.5,-13634.71"/>
</g>
<!-- expert_7_2 -->
<g id="node232" class="node">
<title>expert_7_2</title>
<polygon fill="lightcyan" stroke="black" points="3689.5,-13630.4 3344.5,-13630.4 3344.5,-13562.4 3689.5,-13562.4 3689.5,-13630.4"/>
<text text-anchor="middle" x="3517" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3517" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3517" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3517" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_2 -->
<g id="edge360" class="edge">
<title>ln2_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" d="M2496.15,-13843.87C2592.25,-13836.68 2753.15,-13823.45 2891,-13806.4 3159.63,-13773.17 3271.89,-13832.81 3483,-13663.4 3490.76,-13657.17 3496.93,-13648.7 3501.77,-13639.91"/>
<polygon fill="black" stroke="black" points="3505.02,-13641.21 3506.33,-13630.7 3498.75,-13638.1 3505.02,-13641.21"/>
</g>
<!-- expert_7_3 -->
<g id="node235" class="node">
<title>expert_7_3</title>
<polygon fill="lightcyan" stroke="black" points="1474.5,-13630.4 1129.5,-13630.4 1129.5,-13562.4 1474.5,-13562.4 1474.5,-13630.4"/>
<text text-anchor="middle" x="1302" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1302" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1302" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1302" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_3 -->
<g id="edge365" class="edge">
<title>ln2_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" d="M2325.88,-13849.89C2199.59,-13848.06 1955.99,-13837.56 1756,-13787.4 1614.92,-13752.02 1460.73,-13679.68 1373.23,-13635.18"/>
<polygon fill="black" stroke="black" points="1374.7,-13632 1364.2,-13630.56 1371.51,-13638.23 1374.7,-13632"/>
</g>
<!-- expert_7_4 -->
<g id="node238" class="node">
<title>expert_7_4</title>
<polygon fill="lightcyan" stroke="black" points="3326.5,-13630.4 2981.5,-13630.4 2981.5,-13562.4 3326.5,-13562.4 3326.5,-13630.4"/>
<text text-anchor="middle" x="3154" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3154" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3154" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3154" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_4 -->
<g id="edge370" class="edge">
<title>ln2_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" d="M2496.24,-13847.04C2623.1,-13841.53 2854.45,-13826.35 2927,-13787.4 3001.26,-13747.53 3073.54,-13680.76 3115.9,-13637.92"/>
<polygon fill="black" stroke="black" points="3118.44,-13640.33 3122.95,-13630.74 3113.45,-13635.43 3118.44,-13640.33"/>
</g>
<!-- expert_7_5 -->
<g id="node241" class="node">
<title>expert_7_5</title>
<polygon fill="lightcyan" stroke="black" points="4052.5,-13630.4 3707.5,-13630.4 3707.5,-13562.4 4052.5,-13562.4 4052.5,-13630.4"/>
<text text-anchor="middle" x="3880" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3880" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3880" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3880" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_5 -->
<g id="edge375" class="edge">
<title>ln2_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" d="M2496.22,-13847.12C2694.12,-13840.18 3180.08,-13820.28 3340,-13787.4 3507.02,-13753.07 3692.72,-13679.41 3797.04,-13634.56"/>
<polygon fill="black" stroke="black" points="3798.46,-13637.76 3806.26,-13630.58 3795.69,-13631.33 3798.46,-13637.76"/>
</g>
<!-- expert_7_6 -->
<g id="node244" class="node">
<title>expert_7_6</title>
<polygon fill="lightcyan" stroke="black" points="2200.5,-13630.4 1855.5,-13630.4 1855.5,-13562.4 2200.5,-13562.4 2200.5,-13630.4"/>
<text text-anchor="middle" x="2028" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2028" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2028" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2028" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_6 -->
<g id="edge380" class="edge">
<title>ln2_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" d="M2325.67,-13825.57C2308.35,-13819.87 2290.42,-13813.39 2274,-13806.4 2174.2,-13763.92 2169.24,-13720.27 2088,-13648.4 2083.9,-13644.78 2079.62,-13641.04 2075.32,-13637.32"/>
<polygon fill="black" stroke="black" points="2077.43,-13634.52 2067.57,-13630.65 2072.86,-13639.82 2077.43,-13634.52"/>
</g>
<!-- expert_7_7 -->
<g id="node247" class="node">
<title>expert_7_7</title>
<polygon fill="lightcyan" stroke="black" points="2563.5,-13630.4 2218.5,-13630.4 2218.5,-13562.4 2563.5,-13562.4 2563.5,-13630.4"/>
<text text-anchor="middle" x="2391" y="-13615.2" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2391" y="-13600.2" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2391" y="-13585.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2391" y="-13570.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;expert_7_7 -->
<g id="edge385" class="edge">
<title>ln2_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" d="M2325.84,-13833.17C2301.08,-13823.92 2276.76,-13809.59 2262,-13787.4 2235.91,-13748.17 2239.55,-13722.82 2262,-13681.4 2271.96,-13663.03 2287.87,-13648.04 2305.17,-13636.09"/>
<polygon fill="black" stroke="black" points="2307.31,-13638.87 2313.76,-13630.46 2303.48,-13633.01 2307.31,-13638.87"/>
</g>
<!-- gate_7&#45;&gt;expert_7_0 -->
<g id="edge349" class="edge">
<title>gate_7&#45;&gt;expert_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2406.8,-13711.04C2260.55,-13691.69 2045.39,-13662.14 1847.88,-13630.52"/>
<polygon fill="black" stroke="black" points="1848.32,-13627.05 1837.89,-13628.92 1847.21,-13633.96 1848.32,-13627.05"/>
<text text-anchor="middle" x="2092.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_1 -->
<g id="edge354" class="edge">
<title>gate_7&#45;&gt;expert_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2630.59,-13690.07C2648.19,-13675.96 2668.43,-13660.76 2688,-13648.4 2695.09,-13643.92 2702.64,-13639.54 2710.29,-13635.34"/>
<polygon fill="black" stroke="black" points="2712.15,-13638.31 2719.3,-13630.5 2708.83,-13632.15 2712.15,-13638.31"/>
<text text-anchor="middle" x="2733.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_2 -->
<g id="edge359" class="edge">
<title>gate_7&#45;&gt;expert_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2756.38,-13711.65C2907.34,-13692.5 3130.64,-13662.9 3334.12,-13630.68"/>
<polygon fill="black" stroke="black" points="3334.78,-13634.12 3344.1,-13629.1 3333.68,-13627.21 3334.78,-13634.12"/>
<text text-anchor="middle" x="3257.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_3 -->
<g id="edge364" class="edge">
<title>gate_7&#45;&gt;expert_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2363.35,-13718.54C2144.19,-13702.24 1795.59,-13672.81 1484.97,-13630.5"/>
<polygon fill="black" stroke="black" points="1485.24,-13627 1474.86,-13629.11 1484.29,-13633.94 1485.24,-13627"/>
<text text-anchor="middle" x="1798.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_4 -->
<g id="edge369" class="edge">
<title>gate_7&#45;&gt;expert_7_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2684.92,-13699.39C2739.43,-13682.52 2807.37,-13662.75 2869,-13648.4 2911.74,-13638.45 2925.11,-13638.55 2971.09,-13630.7"/>
<polygon fill="black" stroke="black" points="2971.83,-13634.13 2981.08,-13628.96 2970.63,-13627.23 2971.83,-13634.13"/>
<text text-anchor="middle" x="2914.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_5 -->
<g id="edge374" class="edge">
<title>gate_7&#45;&gt;expert_7_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2799.36,-13718.98C3023.02,-13702.94 3380.04,-13673.64 3696.82,-13630.67"/>
<polygon fill="black" stroke="black" points="3697.69,-13634.08 3707.13,-13629.26 3696.75,-13627.14 3697.69,-13634.08"/>
<text text-anchor="middle" x="3592.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_6 -->
<g id="edge379" class="edge">
<title>gate_7&#45;&gt;expert_7_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2455.43,-13702.71C2371.3,-13681.98 2259.98,-13654.56 2172.03,-13632.89"/>
<polygon fill="black" stroke="black" points="2172.79,-13629.47 2162.25,-13630.48 2171.12,-13636.27 2172.79,-13629.47"/>
<text text-anchor="middle" x="2332.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_7&#45;&gt;expert_7_7 -->
<g id="edge384" class="edge">
<title>gate_7&#45;&gt;expert_7_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2521.49,-13691.3C2497.15,-13673.79 2469.06,-13653.57 2445.2,-13636.4"/>
<polygon fill="black" stroke="black" points="2447.11,-13633.46 2436.94,-13630.46 2443.02,-13639.14 2447.11,-13633.46"/>
<text text-anchor="middle" x="2524.5" y="-13652.2" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_7 -->
<g id="node250" class="node">
<title>expert_agg_7</title>
<polygon fill="lightpink" stroke="black" points="2751.86,-13345.4 2406.88,-13345.4 2318.14,-13209.4 2663.12,-13209.4 2751.86,-13345.4"/>
<text text-anchor="middle" x="2535" y="-13296.2" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2535" y="-13281.2" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2535" y="-13266.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2535" y="-13251.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gate_7&#45;&gt;expert_agg_7 -->
<g id="edge389" class="edge">
<title>gate_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2586.11,-13682.14C2588.64,-13656.7 2591,-13625.47 2591,-13597.4 2591,-13597.4 2591,-13597.4 2591,-13407.9 2591,-13390.19 2586.53,-13372.15 2580.12,-13355.38"/>
<polygon fill="black" stroke="black" points="2583.17,-13353.6 2576.14,-13345.67 2576.69,-13356.25 2583.17,-13353.6"/>
<text text-anchor="middle" x="2619.5" y="-13495.2" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_7_0 -->
<g id="node227" class="node">
<title>expert_gelu_7_0</title>
<polygon fill="lightcyan" stroke="black" points="1754.5,-13525.4 1575.5,-13525.4 1575.5,-13472.4 1754.5,-13472.4 1754.5,-13525.4"/>
<text text-anchor="middle" x="1665" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1665" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1665" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_0&#45;&gt;expert_gelu_7_0 -->
<g id="edge351" class="edge">
<title>expert_7_0&#45;&gt;expert_gelu_7_0</title>
<path fill="none" stroke="black" d="M1665,-13562.27C1665,-13553.69 1665,-13544.41 1665,-13535.7"/>
<polygon fill="black" stroke="black" points="1668.5,-13535.45 1665,-13525.45 1661.5,-13535.45 1668.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_0 -->
<g id="node228" class="node">
<title>expert_ffn2_7_0</title>
<polygon fill="lightcyan" stroke="black" points="1837.5,-13435.4 1492.5,-13435.4 1492.5,-13382.4 1837.5,-13382.4 1837.5,-13435.4"/>
<text text-anchor="middle" x="1665" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1665" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1665" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_0&#45;&gt;expert_ffn2_7_0 -->
<g id="edge352" class="edge">
<title>expert_gelu_7_0&#45;&gt;expert_ffn2_7_0</title>
<path fill="none" stroke="black" d="M1665,-13471.97C1665,-13463.74 1665,-13454.48 1665,-13445.68"/>
<polygon fill="black" stroke="black" points="1668.5,-13445.64 1665,-13435.64 1661.5,-13445.64 1668.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_0&#45;&gt;expert_agg_7 -->
<g id="edge353" class="edge">
<title>expert_ffn2_7_0&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M1836.36,-13382.39C1990.52,-13359.45 2215.61,-13325.94 2368.31,-13303.21"/>
<polygon fill="black" stroke="black" points="2368.89,-13306.67 2378.26,-13301.73 2367.86,-13299.74 2368.89,-13306.67"/>
</g>
<!-- expert_gelu_7_1 -->
<g id="node230" class="node">
<title>expert_gelu_7_1</title>
<polygon fill="lightcyan" stroke="black" points="2880.5,-13525.4 2701.5,-13525.4 2701.5,-13472.4 2880.5,-13472.4 2880.5,-13525.4"/>
<text text-anchor="middle" x="2791" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2791" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2791" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_1&#45;&gt;expert_gelu_7_1 -->
<g id="edge356" class="edge">
<title>expert_7_1&#45;&gt;expert_gelu_7_1</title>
<path fill="none" stroke="black" d="M2791,-13562.27C2791,-13553.69 2791,-13544.41 2791,-13535.7"/>
<polygon fill="black" stroke="black" points="2794.5,-13535.45 2791,-13525.45 2787.5,-13535.45 2794.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_1 -->
<g id="node231" class="node">
<title>expert_ffn2_7_1</title>
<polygon fill="lightcyan" stroke="black" points="2963.5,-13435.4 2618.5,-13435.4 2618.5,-13382.4 2963.5,-13382.4 2963.5,-13435.4"/>
<text text-anchor="middle" x="2791" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2791" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2791" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_1&#45;&gt;expert_ffn2_7_1 -->
<g id="edge357" class="edge">
<title>expert_gelu_7_1&#45;&gt;expert_ffn2_7_1</title>
<path fill="none" stroke="black" d="M2791,-13471.97C2791,-13463.74 2791,-13454.48 2791,-13445.68"/>
<polygon fill="black" stroke="black" points="2794.5,-13445.64 2791,-13435.64 2787.5,-13445.64 2794.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_1&#45;&gt;expert_agg_7 -->
<g id="edge358" class="edge">
<title>expert_ffn2_7_1&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M2740.42,-13382.32C2721.71,-13372.85 2699.45,-13361.59 2676.61,-13350.04"/>
<polygon fill="black" stroke="black" points="2678,-13346.81 2667.49,-13345.42 2674.84,-13353.06 2678,-13346.81"/>
</g>
<!-- expert_gelu_7_2 -->
<g id="node233" class="node">
<title>expert_gelu_7_2</title>
<polygon fill="lightcyan" stroke="black" points="3606.5,-13525.4 3427.5,-13525.4 3427.5,-13472.4 3606.5,-13472.4 3606.5,-13525.4"/>
<text text-anchor="middle" x="3517" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3517" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3517" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_2&#45;&gt;expert_gelu_7_2 -->
<g id="edge361" class="edge">
<title>expert_7_2&#45;&gt;expert_gelu_7_2</title>
<path fill="none" stroke="black" d="M3517,-13562.27C3517,-13553.69 3517,-13544.41 3517,-13535.7"/>
<polygon fill="black" stroke="black" points="3520.5,-13535.45 3517,-13525.45 3513.5,-13535.45 3520.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_2 -->
<g id="node234" class="node">
<title>expert_ffn2_7_2</title>
<polygon fill="lightcyan" stroke="black" points="3689.5,-13435.4 3344.5,-13435.4 3344.5,-13382.4 3689.5,-13382.4 3689.5,-13435.4"/>
<text text-anchor="middle" x="3517" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3517" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3517" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_2&#45;&gt;expert_ffn2_7_2 -->
<g id="edge362" class="edge">
<title>expert_gelu_7_2&#45;&gt;expert_ffn2_7_2</title>
<path fill="none" stroke="black" d="M3517,-13471.97C3517,-13463.74 3517,-13454.48 3517,-13445.68"/>
<polygon fill="black" stroke="black" points="3520.5,-13445.64 3517,-13435.64 3513.5,-13445.64 3520.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_2&#45;&gt;expert_agg_7 -->
<g id="edge363" class="edge">
<title>expert_ffn2_7_2&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M3344.08,-13383.5C3341.37,-13383.13 3338.67,-13382.76 3336,-13382.4 3130.98,-13354.65 2896.23,-13324.34 2734.11,-13303.64"/>
<polygon fill="black" stroke="black" points="2734.39,-13300.15 2724.03,-13302.36 2733.5,-13307.09 2734.39,-13300.15"/>
</g>
<!-- expert_gelu_7_3 -->
<g id="node236" class="node">
<title>expert_gelu_7_3</title>
<polygon fill="lightcyan" stroke="black" points="1391.5,-13525.4 1212.5,-13525.4 1212.5,-13472.4 1391.5,-13472.4 1391.5,-13525.4"/>
<text text-anchor="middle" x="1302" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1302" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1302" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_3&#45;&gt;expert_gelu_7_3 -->
<g id="edge366" class="edge">
<title>expert_7_3&#45;&gt;expert_gelu_7_3</title>
<path fill="none" stroke="black" d="M1302,-13562.27C1302,-13553.69 1302,-13544.41 1302,-13535.7"/>
<polygon fill="black" stroke="black" points="1305.5,-13535.45 1302,-13525.45 1298.5,-13535.45 1305.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_3 -->
<g id="node237" class="node">
<title>expert_ffn2_7_3</title>
<polygon fill="lightcyan" stroke="black" points="1474.5,-13435.4 1129.5,-13435.4 1129.5,-13382.4 1474.5,-13382.4 1474.5,-13435.4"/>
<text text-anchor="middle" x="1302" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1302" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1302" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_3&#45;&gt;expert_ffn2_7_3 -->
<g id="edge367" class="edge">
<title>expert_gelu_7_3&#45;&gt;expert_ffn2_7_3</title>
<path fill="none" stroke="black" d="M1302,-13471.97C1302,-13463.74 1302,-13454.48 1302,-13445.68"/>
<polygon fill="black" stroke="black" points="1305.5,-13445.64 1302,-13435.64 1298.5,-13445.64 1305.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_3&#45;&gt;expert_agg_7 -->
<g id="edge368" class="edge">
<title>expert_ffn2_7_3&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M1474.9,-13383.5C1477.95,-13383.13 1480.99,-13382.76 1484,-13382.4 1792.77,-13345.51 2153.7,-13311.85 2362.17,-13293.34"/>
<polygon fill="black" stroke="black" points="2362.63,-13296.81 2372.29,-13292.44 2362.02,-13289.84 2362.63,-13296.81"/>
</g>
<!-- expert_gelu_7_4 -->
<g id="node239" class="node">
<title>expert_gelu_7_4</title>
<polygon fill="lightcyan" stroke="black" points="3243.5,-13525.4 3064.5,-13525.4 3064.5,-13472.4 3243.5,-13472.4 3243.5,-13525.4"/>
<text text-anchor="middle" x="3154" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3154" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3154" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_4&#45;&gt;expert_gelu_7_4 -->
<g id="edge371" class="edge">
<title>expert_7_4&#45;&gt;expert_gelu_7_4</title>
<path fill="none" stroke="black" d="M3154,-13562.27C3154,-13553.69 3154,-13544.41 3154,-13535.7"/>
<polygon fill="black" stroke="black" points="3157.5,-13535.45 3154,-13525.45 3150.5,-13535.45 3157.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_4 -->
<g id="node240" class="node">
<title>expert_ffn2_7_4</title>
<polygon fill="lightcyan" stroke="black" points="3326.5,-13435.4 2981.5,-13435.4 2981.5,-13382.4 3326.5,-13382.4 3326.5,-13435.4"/>
<text text-anchor="middle" x="3154" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3154" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3154" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_4&#45;&gt;expert_ffn2_7_4 -->
<g id="edge372" class="edge">
<title>expert_gelu_7_4&#45;&gt;expert_ffn2_7_4</title>
<path fill="none" stroke="black" d="M3154,-13471.97C3154,-13463.74 3154,-13454.48 3154,-13445.68"/>
<polygon fill="black" stroke="black" points="3157.5,-13445.64 3154,-13435.64 3150.5,-13445.64 3157.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_4&#45;&gt;expert_agg_7 -->
<g id="edge373" class="edge">
<title>expert_ffn2_7_4&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M3032.07,-13382.39C2950.44,-13365.31 2840.84,-13342.39 2745.33,-13322.4"/>
<polygon fill="black" stroke="black" points="2746.05,-13318.98 2735.54,-13320.36 2744.61,-13325.83 2746.05,-13318.98"/>
</g>
<!-- expert_gelu_7_5 -->
<g id="node242" class="node">
<title>expert_gelu_7_5</title>
<polygon fill="lightcyan" stroke="black" points="3969.5,-13525.4 3790.5,-13525.4 3790.5,-13472.4 3969.5,-13472.4 3969.5,-13525.4"/>
<text text-anchor="middle" x="3880" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3880" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3880" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_5&#45;&gt;expert_gelu_7_5 -->
<g id="edge376" class="edge">
<title>expert_7_5&#45;&gt;expert_gelu_7_5</title>
<path fill="none" stroke="black" d="M3880,-13562.27C3880,-13553.69 3880,-13544.41 3880,-13535.7"/>
<polygon fill="black" stroke="black" points="3883.5,-13535.45 3880,-13525.45 3876.5,-13535.45 3883.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_5 -->
<g id="node243" class="node">
<title>expert_ffn2_7_5</title>
<polygon fill="lightcyan" stroke="black" points="4052.5,-13435.4 3707.5,-13435.4 3707.5,-13382.4 4052.5,-13382.4 4052.5,-13435.4"/>
<text text-anchor="middle" x="3880" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3880" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3880" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_5&#45;&gt;expert_ffn2_7_5 -->
<g id="edge377" class="edge">
<title>expert_gelu_7_5&#45;&gt;expert_ffn2_7_5</title>
<path fill="none" stroke="black" d="M3880,-13471.97C3880,-13463.74 3880,-13454.48 3880,-13445.68"/>
<polygon fill="black" stroke="black" points="3883.5,-13445.64 3880,-13435.64 3876.5,-13445.64 3883.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_5&#45;&gt;expert_agg_7 -->
<g id="edge378" class="edge">
<title>expert_ffn2_7_5&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M3707.1,-13383.35C3704.38,-13383.03 3701.68,-13382.71 3699,-13382.4 3357.52,-13343.12 2958.22,-13310.28 2727.19,-13292.56"/>
<polygon fill="black" stroke="black" points="2727.24,-13289.06 2717,-13291.78 2726.7,-13296.04 2727.24,-13289.06"/>
</g>
<!-- expert_gelu_7_6 -->
<g id="node245" class="node">
<title>expert_gelu_7_6</title>
<polygon fill="lightcyan" stroke="black" points="2117.5,-13525.4 1938.5,-13525.4 1938.5,-13472.4 2117.5,-13472.4 2117.5,-13525.4"/>
<text text-anchor="middle" x="2028" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2028" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2028" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_6&#45;&gt;expert_gelu_7_6 -->
<g id="edge381" class="edge">
<title>expert_7_6&#45;&gt;expert_gelu_7_6</title>
<path fill="none" stroke="black" d="M2028,-13562.27C2028,-13553.69 2028,-13544.41 2028,-13535.7"/>
<polygon fill="black" stroke="black" points="2031.5,-13535.45 2028,-13525.45 2024.5,-13535.45 2031.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_6 -->
<g id="node246" class="node">
<title>expert_ffn2_7_6</title>
<polygon fill="lightcyan" stroke="black" points="2200.5,-13435.4 1855.5,-13435.4 1855.5,-13382.4 2200.5,-13382.4 2200.5,-13435.4"/>
<text text-anchor="middle" x="2028" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2028" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2028" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_6&#45;&gt;expert_ffn2_7_6 -->
<g id="edge382" class="edge">
<title>expert_gelu_7_6&#45;&gt;expert_ffn2_7_6</title>
<path fill="none" stroke="black" d="M2028,-13471.97C2028,-13463.74 2028,-13454.48 2028,-13445.68"/>
<polygon fill="black" stroke="black" points="2031.5,-13445.64 2028,-13435.64 2024.5,-13445.64 2031.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_6&#45;&gt;expert_agg_7 -->
<g id="edge383" class="edge">
<title>expert_ffn2_7_6&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M2127.86,-13382.39C2198.97,-13364.23 2295.97,-13339.46 2377.45,-13318.64"/>
<polygon fill="black" stroke="black" points="2378.49,-13321.99 2387.31,-13316.12 2376.75,-13315.21 2378.49,-13321.99"/>
</g>
<!-- expert_gelu_7_7 -->
<g id="node248" class="node">
<title>expert_gelu_7_7</title>
<polygon fill="lightcyan" stroke="black" points="2480.5,-13525.4 2301.5,-13525.4 2301.5,-13472.4 2480.5,-13472.4 2480.5,-13525.4"/>
<text text-anchor="middle" x="2391" y="-13510.2" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2391" y="-13495.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2391" y="-13480.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_7_7&#45;&gt;expert_gelu_7_7 -->
<g id="edge386" class="edge">
<title>expert_7_7&#45;&gt;expert_gelu_7_7</title>
<path fill="none" stroke="black" d="M2391,-13562.27C2391,-13553.69 2391,-13544.41 2391,-13535.7"/>
<polygon fill="black" stroke="black" points="2394.5,-13535.45 2391,-13525.45 2387.5,-13535.45 2394.5,-13535.45"/>
</g>
<!-- expert_ffn2_7_7 -->
<g id="node249" class="node">
<title>expert_ffn2_7_7</title>
<polygon fill="lightcyan" stroke="black" points="2563.5,-13435.4 2218.5,-13435.4 2218.5,-13382.4 2563.5,-13382.4 2563.5,-13435.4"/>
<text text-anchor="middle" x="2391" y="-13420.2" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2391" y="-13405.2" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2391" y="-13390.2" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- expert_gelu_7_7&#45;&gt;expert_ffn2_7_7 -->
<g id="edge387" class="edge">
<title>expert_gelu_7_7&#45;&gt;expert_ffn2_7_7</title>
<path fill="none" stroke="black" d="M2391,-13471.97C2391,-13463.74 2391,-13454.48 2391,-13445.68"/>
<polygon fill="black" stroke="black" points="2394.5,-13445.64 2391,-13435.64 2387.5,-13445.64 2394.5,-13445.64"/>
</g>
<!-- expert_ffn2_7_7&#45;&gt;expert_agg_7 -->
<g id="edge388" class="edge">
<title>expert_ffn2_7_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="black" d="M2419.45,-13382.32C2429.29,-13373.46 2440.87,-13363.05 2452.84,-13352.29"/>
<polygon fill="black" stroke="black" points="2455.23,-13354.85 2460.32,-13345.56 2450.55,-13349.64 2455.23,-13354.85"/>
</g>
<!-- expert_agg_7&#45;&gt;residual2_7 -->
<g id="edge391" class="edge">
<title>expert_agg_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M2348.13,-13255.89C2123.32,-13231.21 1741.28,-13189.27 1461.69,-13158.57"/>
<polygon fill="black" stroke="black" points="1461.7,-13155.05 1451.37,-13157.44 1460.93,-13162.01 1461.7,-13155.05"/>
</g>
<!-- comm_7_8 -->
<g id="node288" class="node">
<title>comm_7_8</title>
<ellipse fill="lightgreen" stroke="black" cx="1114" cy="-13002.53" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1114" y="-13006.33" font-family="Times,serif" font-size="14.00">GPU 6 → GPU 7</text>
<text text-anchor="middle" x="1114" y="-12991.33" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_7&#45;&gt;comm_7_8 -->
<g id="edge392" class="edge">
<title>residual2_7&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M1114,-13066.34C1114,-13057.41 1114,-13048.3 1114,-13039.9"/>
<polygon fill="black" stroke="black" points="1117.5,-13039.69 1114,-13029.69 1110.5,-13039.69 1117.5,-13039.69"/>
</g>
<!-- comm_6_7&#45;&gt;ln1_7 -->
<g id="edge337" class="edge">
<title>comm_6_7&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M1007.84,-14420.63C979.27,-14409.51 944.5,-14395.97 913.96,-14384.08"/>
<polygon fill="black" stroke="black" points="915.22,-14380.82 904.63,-14380.45 912.68,-14387.34 915.22,-14380.82"/>
</g>
<!-- comm_6_7&#45;&gt;residual1_7 -->
<g id="edge345" class="edge">
<title>comm_6_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1147.54,-14424.4C1180.98,-14411.37 1212,-14389.86 1212,-14354.9 1212,-14354.9 1212,-14354.9 1212,-14082.9 1212,-14062.85 1203.22,-14044.54 1190.91,-14028.73"/>
<polygon fill="black" stroke="black" points="1193.28,-14026.11 1184.18,-14020.69 1187.92,-14030.61 1193.28,-14026.11"/>
</g>
<!-- ln1_8 -->
<g id="node253" class="node">
<title>ln1_8</title>
<polygon fill="lightyellow" stroke="black" points="1052,-12938.66 882,-12938.66 882,-12885.66 1052,-12885.66 1052,-12938.66"/>
<text text-anchor="middle" x="967" y="-12923.46" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="967" y="-12908.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="967" y="-12893.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_q_8 -->
<g id="node254" class="node">
<title>mha_q_8</title>
<polygon fill="lightblue" stroke="black" points="1311,-12848.66 975,-12848.66 975,-12795.66 1311,-12795.66 1311,-12848.66"/>
<text text-anchor="middle" x="1143" y="-12833.46" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1143" y="-12818.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1143" y="-12803.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_q_8 -->
<g id="edge394" class="edge">
<title>ln1_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M1018.38,-12885.47C1038.53,-12875.4 1061.8,-12863.76 1082.74,-12853.29"/>
<polygon fill="black" stroke="black" points="1084.48,-12856.33 1091.86,-12848.73 1081.35,-12850.07 1084.48,-12856.33"/>
</g>
<!-- mha_k_8 -->
<g id="node255" class="node">
<title>mha_k_8</title>
<polygon fill="lightblue" stroke="black" points="603,-12848.66 267,-12848.66 267,-12795.66 603,-12795.66 603,-12848.66"/>
<text text-anchor="middle" x="435" y="-12833.46" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="435" y="-12818.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="435" y="-12803.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_k_8 -->
<g id="edge395" class="edge">
<title>ln1_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M881.82,-12897.07C805.99,-12884.53 692.93,-12865.83 599.51,-12850.37"/>
<polygon fill="black" stroke="black" points="599.82,-12846.88 589.38,-12848.7 598.68,-12853.78 599.82,-12846.88"/>
</g>
<!-- mha_v_8 -->
<g id="node256" class="node">
<title>mha_v_8</title>
<polygon fill="lightblue" stroke="black" points="957,-12848.66 621,-12848.66 621,-12795.66 957,-12795.66 957,-12848.66"/>
<text text-anchor="middle" x="789" y="-12833.46" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="789" y="-12818.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="789" y="-12803.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_v_8 -->
<g id="edge396" class="edge">
<title>ln1_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M915.04,-12885.47C894.66,-12875.4 871.12,-12863.76 849.95,-12853.29"/>
<polygon fill="black" stroke="black" points="851.24,-12850.02 840.72,-12848.73 848.13,-12856.3 851.24,-12850.02"/>
</g>
<!-- mha_attn_8 -->
<g id="node257" class="node">
<title>mha_attn_8</title>
<polygon fill="lightblue" stroke="black" points="940,-12758.66 770,-12758.66 770,-12705.66 940,-12705.66 940,-12758.66"/>
<text text-anchor="middle" x="855" y="-12743.46" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="855" y="-12728.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="855" y="-12713.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge397" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M1059.31,-12795.59C1024.7,-12785.01 984.41,-12772.7 948.81,-12761.82"/>
<polygon fill="black" stroke="black" points="949.48,-12758.37 938.9,-12758.8 947.44,-12765.07 949.48,-12758.37"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge398" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M556.76,-12795.65C621.47,-12782.09 699.84,-12765.67 760,-12753.07"/>
<polygon fill="black" stroke="black" points="760.81,-12756.47 769.88,-12751 759.37,-12749.62 760.81,-12756.47"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge399" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M808.45,-12795.23C815.09,-12786.37 822.63,-12776.33 829.67,-12766.94"/>
<polygon fill="black" stroke="black" points="832.49,-12769 835.69,-12758.9 826.89,-12764.8 832.49,-12769"/>
</g>
<!-- mha_out_8 -->
<g id="node258" class="node">
<title>mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="1223,-12668.66 887,-12668.66 887,-12615.66 1223,-12615.66 1223,-12668.66"/>
<text text-anchor="middle" x="1055" y="-12653.46" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1055" y="-12638.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1055" y="-12623.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge400" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M913.12,-12705.59C936.33,-12695.38 963.22,-12683.54 987.31,-12672.95"/>
<polygon fill="black" stroke="black" points="988.99,-12676.03 996.74,-12668.8 986.18,-12669.62 988.99,-12676.03"/>
</g>
<!-- residual1_8 -->
<g id="node259" class="node">
<title>residual1_8</title>
<polygon fill="lightcoral" stroke="black" points="1552.86,-12578.66 983.58,-12578.66 837.14,-12472.66 1406.42,-12472.66 1552.86,-12578.66"/>
<text text-anchor="middle" x="1195" y="-12536.96" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1195" y="-12521.96" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1195" y="-12506.96" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge402" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1086.42,-12615.47C1097.43,-12606.46 1110.3,-12595.93 1123.25,-12585.34"/>
<polygon fill="black" stroke="black" points="1125.79,-12587.79 1131.31,-12578.75 1121.35,-12582.37 1125.79,-12587.79"/>
</g>
<!-- ln2_8 -->
<g id="node260" class="node">
<title>ln2_8</title>
<polygon fill="lightyellow" stroke="black" points="2577,-12435.66 2407,-12435.66 2407,-12382.66 2577,-12382.66 2577,-12435.66"/>
<text text-anchor="middle" x="2492" y="-12420.46" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2492" y="-12405.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2492" y="-12390.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge403" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1447.77,-12502.35C1737.74,-12476.75 2198.62,-12436.06 2396.56,-12418.59"/>
<polygon fill="black" stroke="black" points="2396.99,-12422.06 2406.64,-12417.7 2396.37,-12415.09 2396.99,-12422.06"/>
</g>
<!-- residual2_8 -->
<g id="node287" class="node">
<title>residual2_8</title>
<polygon fill="lightcoral" stroke="black" points="1552.86,-11730.66 983.58,-11730.66 837.14,-11624.66 1406.42,-11624.66 1552.86,-11730.66"/>
<text text-anchor="middle" x="1195" y="-11688.96" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1195" y="-11673.96" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1195" y="-11658.96" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge446" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1187.23,-12472.63C1184.92,-12453.09 1183,-12430.65 1183,-12410.16 1183,-12410.16 1183,-12410.16 1183,-11834.66 1183,-11803.82 1185.36,-11769.64 1187.99,-11741.16"/>
<polygon fill="black" stroke="black" points="1191.5,-11741.23 1188.96,-11730.94 1184.53,-11740.56 1191.5,-11741.23"/>
</g>
<!-- gate_8 -->
<g id="node261" class="node">
<title>gate_8</title>
<polygon fill="orange" stroke="black" points="2661,-12345.66 2352,-12292.66 2661,-12239.66 2970,-12292.66 2661,-12345.66"/>
<text text-anchor="middle" x="2661" y="-12303.96" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2661" y="-12288.96" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2661" y="-12273.96" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;gate_8 -->
<g id="edge404" class="edge">
<title>ln2_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M2529.93,-12382.47C2548.05,-12370.18 2570.34,-12355.08 2591.36,-12340.84"/>
<polygon fill="black" stroke="black" points="2593.34,-12343.73 2599.65,-12335.23 2589.41,-12337.94 2593.34,-12343.73"/>
</g>
<!-- expert_8_0 -->
<g id="node262" class="node">
<title>expert_8_0</title>
<polygon fill="lightcyan" stroke="black" points="1918.5,-12188.66 1573.5,-12188.66 1573.5,-12120.66 1918.5,-12120.66 1918.5,-12188.66"/>
<text text-anchor="middle" x="1746" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1746" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1746" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1746" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_0 -->
<g id="edge406" class="edge">
<title>ln2_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" d="M2406.98,-12405.17C2266.02,-12396.22 1980.79,-12360.86 1792,-12221.66 1783.05,-12215.06 1775.22,-12206.18 1768.67,-12197.08"/>
<polygon fill="black" stroke="black" points="1771.52,-12195.05 1763.03,-12188.72 1765.72,-12198.96 1771.52,-12195.05"/>
</g>
<!-- expert_8_1 -->
<g id="node265" class="node">
<title>expert_8_1</title>
<polygon fill="lightcyan" stroke="black" points="3044.5,-12188.66 2699.5,-12188.66 2699.5,-12120.66 3044.5,-12120.66 3044.5,-12188.66"/>
<text text-anchor="middle" x="2872" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2872" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2872" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2872" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_1 -->
<g id="edge411" class="edge">
<title>ln2_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" d="M2577.19,-12403.13C2709.57,-12394.45 2952.35,-12374.75 2979,-12345.66 3020.76,-12300.08 3017.45,-12258.65 2984,-12206.66 2981.46,-12202.71 2978.53,-12199.07 2975.3,-12195.7"/>
<polygon fill="black" stroke="black" points="2977.5,-12192.97 2967.77,-12188.77 2972.76,-12198.12 2977.5,-12192.97"/>
</g>
<!-- expert_8_2 -->
<g id="node268" class="node">
<title>expert_8_2</title>
<polygon fill="lightcyan" stroke="black" points="3770.5,-12188.66 3425.5,-12188.66 3425.5,-12120.66 3770.5,-12120.66 3770.5,-12188.66"/>
<text text-anchor="middle" x="3598" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3598" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3598" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3598" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_2 -->
<g id="edge416" class="edge">
<title>ln2_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" d="M2577.15,-12402.13C2673.25,-12394.94 2834.15,-12381.71 2972,-12364.66 3240.63,-12331.43 3352.89,-12391.07 3564,-12221.66 3571.76,-12215.43 3577.93,-12206.96 3582.77,-12198.16"/>
<polygon fill="black" stroke="black" points="3586.02,-12199.47 3587.33,-12188.96 3579.75,-12196.36 3586.02,-12199.47"/>
</g>
<!-- expert_8_3 -->
<g id="node271" class="node">
<title>expert_8_3</title>
<polygon fill="lightcyan" stroke="black" points="1555.5,-12188.66 1210.5,-12188.66 1210.5,-12120.66 1555.5,-12120.66 1555.5,-12188.66"/>
<text text-anchor="middle" x="1383" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1383" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1383" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1383" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_3 -->
<g id="edge421" class="edge">
<title>ln2_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" d="M2406.73,-12409.04C2276.73,-12408.44 2022.12,-12399.59 1814,-12345.66 1679.2,-12310.73 1533.02,-12238.19 1450.25,-12193.54"/>
<polygon fill="black" stroke="black" points="1451.92,-12190.47 1441.46,-12188.78 1448.58,-12196.62 1451.92,-12190.47"/>
</g>
<!-- expert_8_4 -->
<g id="node274" class="node">
<title>expert_8_4</title>
<polygon fill="lightcyan" stroke="black" points="3407.5,-12188.66 3062.5,-12188.66 3062.5,-12120.66 3407.5,-12120.66 3407.5,-12188.66"/>
<text text-anchor="middle" x="3235" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3235" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3235" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3235" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_4 -->
<g id="edge426" class="edge">
<title>ln2_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" d="M2577.24,-12405.3C2704.1,-12399.79 2935.45,-12384.61 3008,-12345.66 3082.26,-12305.79 3154.54,-12239.02 3196.9,-12196.18"/>
<polygon fill="black" stroke="black" points="3199.44,-12198.59 3203.95,-12189 3194.45,-12193.69 3199.44,-12198.59"/>
</g>
<!-- expert_8_5 -->
<g id="node277" class="node">
<title>expert_8_5</title>
<polygon fill="lightcyan" stroke="black" points="4133.5,-12188.66 3788.5,-12188.66 3788.5,-12120.66 4133.5,-12120.66 4133.5,-12188.66"/>
<text text-anchor="middle" x="3961" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="3961" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3961" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3961" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_5 -->
<g id="edge431" class="edge">
<title>ln2_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" d="M2577.22,-12405.38C2775.12,-12398.44 3261.08,-12378.54 3421,-12345.66 3588.02,-12311.33 3773.72,-12237.67 3878.04,-12192.82"/>
<polygon fill="black" stroke="black" points="3879.46,-12196.02 3887.26,-12188.84 3876.69,-12189.59 3879.46,-12196.02"/>
</g>
<!-- expert_8_6 -->
<g id="node280" class="node">
<title>expert_8_6</title>
<polygon fill="lightcyan" stroke="black" points="2281.5,-12188.66 1936.5,-12188.66 1936.5,-12120.66 2281.5,-12120.66 2281.5,-12188.66"/>
<text text-anchor="middle" x="2109" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2109" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2109" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2109" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_6 -->
<g id="edge436" class="edge">
<title>ln2_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" d="M2406.67,-12383.83C2389.35,-12378.13 2371.42,-12371.65 2355,-12364.66 2266.41,-12326.95 2185.93,-12245.72 2142.57,-12196.37"/>
<polygon fill="black" stroke="black" points="2145.14,-12193.99 2135.94,-12188.74 2139.86,-12198.58 2145.14,-12193.99"/>
</g>
<!-- expert_8_7 -->
<g id="node283" class="node">
<title>expert_8_7</title>
<polygon fill="lightcyan" stroke="black" points="2644.5,-12188.66 2299.5,-12188.66 2299.5,-12120.66 2644.5,-12120.66 2644.5,-12188.66"/>
<text text-anchor="middle" x="2472" y="-12173.46" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2472" y="-12158.46" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2472" y="-12143.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2472" y="-12128.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;expert_8_7 -->
<g id="edge441" class="edge">
<title>ln2_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" d="M2406.84,-12391.42C2382.08,-12382.18 2357.76,-12367.85 2343,-12345.66 2316.91,-12306.43 2320.55,-12281.08 2343,-12239.66 2352.96,-12221.29 2368.87,-12206.3 2386.17,-12194.35"/>
<polygon fill="black" stroke="black" points="2388.31,-12197.13 2394.76,-12188.72 2384.48,-12191.27 2388.31,-12197.13"/>
</g>
<!-- gate_8&#45;&gt;expert_8_0 -->
<g id="edge405" class="edge">
<title>gate_8&#45;&gt;expert_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2487.8,-12269.3C2341.55,-12249.95 2126.39,-12220.4 1928.88,-12188.78"/>
<polygon fill="black" stroke="black" points="1929.32,-12185.31 1918.89,-12187.18 1928.21,-12192.22 1929.32,-12185.31"/>
<text text-anchor="middle" x="2173.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_1 -->
<g id="edge410" class="edge">
<title>gate_8&#45;&gt;expert_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2711.59,-12248.33C2729.19,-12234.22 2749.43,-12219.02 2769,-12206.66 2776.09,-12202.18 2783.64,-12197.8 2791.29,-12193.6"/>
<polygon fill="black" stroke="black" points="2793.15,-12196.57 2800.3,-12188.76 2789.83,-12190.41 2793.15,-12196.57"/>
<text text-anchor="middle" x="2814.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_2 -->
<g id="edge415" class="edge">
<title>gate_8&#45;&gt;expert_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2837.38,-12269.91C2988.34,-12250.76 3211.64,-12221.16 3415.12,-12188.94"/>
<polygon fill="black" stroke="black" points="3415.78,-12192.38 3425.1,-12187.36 3414.68,-12185.47 3415.78,-12192.38"/>
<text text-anchor="middle" x="3338.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_3 -->
<g id="edge420" class="edge">
<title>gate_8&#45;&gt;expert_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2444.35,-12276.8C2225.19,-12260.5 1876.59,-12231.07 1565.97,-12188.76"/>
<polygon fill="black" stroke="black" points="1566.24,-12185.26 1555.86,-12187.37 1565.29,-12192.2 1566.24,-12185.26"/>
<text text-anchor="middle" x="1879.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_4 -->
<g id="edge425" class="edge">
<title>gate_8&#45;&gt;expert_8_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2765.92,-12257.65C2820.43,-12240.78 2888.37,-12221.01 2950,-12206.66 2992.74,-12196.71 3006.11,-12196.81 3052.09,-12188.96"/>
<polygon fill="black" stroke="black" points="3052.83,-12192.39 3062.08,-12187.22 3051.63,-12185.49 3052.83,-12192.39"/>
<text text-anchor="middle" x="2995.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_5 -->
<g id="edge430" class="edge">
<title>gate_8&#45;&gt;expert_8_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2880.36,-12277.24C3104.02,-12261.2 3461.04,-12231.9 3777.82,-12188.93"/>
<polygon fill="black" stroke="black" points="3778.69,-12192.34 3788.13,-12187.52 3777.75,-12185.4 3778.69,-12192.34"/>
<text text-anchor="middle" x="3673.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_6 -->
<g id="edge435" class="edge">
<title>gate_8&#45;&gt;expert_8_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2536.43,-12260.97C2452.3,-12240.24 2340.98,-12212.82 2253.03,-12191.15"/>
<polygon fill="black" stroke="black" points="2253.79,-12187.73 2243.25,-12188.74 2252.12,-12194.53 2253.79,-12187.73"/>
<text text-anchor="middle" x="2413.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_8&#45;&gt;expert_8_7 -->
<g id="edge440" class="edge">
<title>gate_8&#45;&gt;expert_8_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2602.49,-12249.56C2578.15,-12232.05 2550.06,-12211.83 2526.2,-12194.66"/>
<polygon fill="black" stroke="black" points="2528.11,-12191.72 2517.94,-12188.72 2524.02,-12197.4 2528.11,-12191.72"/>
<text text-anchor="middle" x="2605.5" y="-12210.46" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_8 -->
<g id="node286" class="node">
<title>expert_agg_8</title>
<polygon fill="lightpink" stroke="black" points="2838.86,-11903.66 2493.88,-11903.66 2405.14,-11767.66 2750.12,-11767.66 2838.86,-11903.66"/>
<text text-anchor="middle" x="2622" y="-11854.46" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2622" y="-11839.46" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2622" y="-11824.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2622" y="-11809.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gate_8&#45;&gt;expert_agg_8 -->
<g id="edge445" class="edge">
<title>gate_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2667.11,-12240.4C2669.64,-12214.96 2672,-12183.73 2672,-12155.66 2672,-12155.66 2672,-12155.66 2672,-11966.16 2672,-11948.53 2667.92,-11930.41 2662.09,-11913.51"/>
<polygon fill="black" stroke="black" points="2665.22,-11911.88 2658.47,-11903.71 2658.65,-11914.3 2665.22,-11911.88"/>
<text text-anchor="middle" x="2700.5" y="-12053.46" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_8_0 -->
<g id="node263" class="node">
<title>expert_gelu_8_0</title>
<polygon fill="lightcyan" stroke="black" points="1835.5,-12083.66 1656.5,-12083.66 1656.5,-12030.66 1835.5,-12030.66 1835.5,-12083.66"/>
<text text-anchor="middle" x="1746" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1746" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1746" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_0&#45;&gt;expert_gelu_8_0 -->
<g id="edge407" class="edge">
<title>expert_8_0&#45;&gt;expert_gelu_8_0</title>
<path fill="none" stroke="black" d="M1746,-12120.53C1746,-12111.95 1746,-12102.67 1746,-12093.96"/>
<polygon fill="black" stroke="black" points="1749.5,-12093.71 1746,-12083.71 1742.5,-12093.71 1749.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_0 -->
<g id="node264" class="node">
<title>expert_ffn2_8_0</title>
<polygon fill="lightcyan" stroke="black" points="1918.5,-11993.66 1573.5,-11993.66 1573.5,-11940.66 1918.5,-11940.66 1918.5,-11993.66"/>
<text text-anchor="middle" x="1746" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1746" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1746" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_0&#45;&gt;expert_ffn2_8_0 -->
<g id="edge408" class="edge">
<title>expert_gelu_8_0&#45;&gt;expert_ffn2_8_0</title>
<path fill="none" stroke="black" d="M1746,-12030.23C1746,-12022 1746,-12012.74 1746,-12003.94"/>
<polygon fill="black" stroke="black" points="1749.5,-12003.9 1746,-11993.9 1742.5,-12003.9 1749.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_0&#45;&gt;expert_agg_8 -->
<g id="edge409" class="edge">
<title>expert_ffn2_8_0&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M1918.55,-11940.65C2074.13,-11917.65 2301.48,-11884.04 2455.25,-11861.31"/>
<polygon fill="black" stroke="black" points="2455.89,-11864.76 2465.27,-11859.83 2454.86,-11857.83 2455.89,-11864.76"/>
</g>
<!-- expert_gelu_8_1 -->
<g id="node266" class="node">
<title>expert_gelu_8_1</title>
<polygon fill="lightcyan" stroke="black" points="2961.5,-12083.66 2782.5,-12083.66 2782.5,-12030.66 2961.5,-12030.66 2961.5,-12083.66"/>
<text text-anchor="middle" x="2872" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2872" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2872" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_1&#45;&gt;expert_gelu_8_1 -->
<g id="edge412" class="edge">
<title>expert_8_1&#45;&gt;expert_gelu_8_1</title>
<path fill="none" stroke="black" d="M2872,-12120.53C2872,-12111.95 2872,-12102.67 2872,-12093.96"/>
<polygon fill="black" stroke="black" points="2875.5,-12093.71 2872,-12083.71 2868.5,-12093.71 2875.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_1 -->
<g id="node267" class="node">
<title>expert_ffn2_8_1</title>
<polygon fill="lightcyan" stroke="black" points="3044.5,-11993.66 2699.5,-11993.66 2699.5,-11940.66 3044.5,-11940.66 3044.5,-11993.66"/>
<text text-anchor="middle" x="2872" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2872" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2872" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_1&#45;&gt;expert_ffn2_8_1 -->
<g id="edge413" class="edge">
<title>expert_gelu_8_1&#45;&gt;expert_ffn2_8_1</title>
<path fill="none" stroke="black" d="M2872,-12030.23C2872,-12022 2872,-12012.74 2872,-12003.94"/>
<polygon fill="black" stroke="black" points="2875.5,-12003.9 2872,-11993.9 2868.5,-12003.9 2875.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_1&#45;&gt;expert_agg_8 -->
<g id="edge414" class="edge">
<title>expert_ffn2_8_1&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M2822.61,-11940.58C2804.33,-11931.11 2782.6,-11919.85 2760.29,-11908.3"/>
<polygon fill="black" stroke="black" points="2761.88,-11905.18 2751.39,-11903.68 2758.66,-11911.39 2761.88,-11905.18"/>
</g>
<!-- expert_gelu_8_2 -->
<g id="node269" class="node">
<title>expert_gelu_8_2</title>
<polygon fill="lightcyan" stroke="black" points="3687.5,-12083.66 3508.5,-12083.66 3508.5,-12030.66 3687.5,-12030.66 3687.5,-12083.66"/>
<text text-anchor="middle" x="3598" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3598" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3598" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_2&#45;&gt;expert_gelu_8_2 -->
<g id="edge417" class="edge">
<title>expert_8_2&#45;&gt;expert_gelu_8_2</title>
<path fill="none" stroke="black" d="M3598,-12120.53C3598,-12111.95 3598,-12102.67 3598,-12093.96"/>
<polygon fill="black" stroke="black" points="3601.5,-12093.71 3598,-12083.71 3594.5,-12093.71 3601.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_2 -->
<g id="node270" class="node">
<title>expert_ffn2_8_2</title>
<polygon fill="lightcyan" stroke="black" points="3770.5,-11993.66 3425.5,-11993.66 3425.5,-11940.66 3770.5,-11940.66 3770.5,-11993.66"/>
<text text-anchor="middle" x="3598" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3598" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3598" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_2&#45;&gt;expert_ffn2_8_2 -->
<g id="edge418" class="edge">
<title>expert_gelu_8_2&#45;&gt;expert_ffn2_8_2</title>
<path fill="none" stroke="black" d="M3598,-12030.23C3598,-12022 3598,-12012.74 3598,-12003.94"/>
<polygon fill="black" stroke="black" points="3601.5,-12003.9 3598,-11993.9 3594.5,-12003.9 3601.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_2&#45;&gt;expert_agg_8 -->
<g id="edge419" class="edge">
<title>expert_ffn2_8_2&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M3425.08,-11941.76C3422.37,-11941.39 3419.67,-11941.02 3417,-11940.66 3214.18,-11913.11 2982.06,-11882.89 2821.22,-11862.17"/>
<polygon fill="black" stroke="black" points="2821.58,-11858.69 2811.21,-11860.88 2820.68,-11865.63 2821.58,-11858.69"/>
</g>
<!-- expert_gelu_8_3 -->
<g id="node272" class="node">
<title>expert_gelu_8_3</title>
<polygon fill="lightcyan" stroke="black" points="1472.5,-12083.66 1293.5,-12083.66 1293.5,-12030.66 1472.5,-12030.66 1472.5,-12083.66"/>
<text text-anchor="middle" x="1383" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1383" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1383" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_3&#45;&gt;expert_gelu_8_3 -->
<g id="edge422" class="edge">
<title>expert_8_3&#45;&gt;expert_gelu_8_3</title>
<path fill="none" stroke="black" d="M1383,-12120.53C1383,-12111.95 1383,-12102.67 1383,-12093.96"/>
<polygon fill="black" stroke="black" points="1386.5,-12093.71 1383,-12083.71 1379.5,-12093.71 1386.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_3 -->
<g id="node273" class="node">
<title>expert_ffn2_8_3</title>
<polygon fill="lightcyan" stroke="black" points="1555.5,-11993.66 1210.5,-11993.66 1210.5,-11940.66 1555.5,-11940.66 1555.5,-11993.66"/>
<text text-anchor="middle" x="1383" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1383" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1383" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_3&#45;&gt;expert_ffn2_8_3 -->
<g id="edge423" class="edge">
<title>expert_gelu_8_3&#45;&gt;expert_ffn2_8_3</title>
<path fill="none" stroke="black" d="M1383,-12030.23C1383,-12022 1383,-12012.74 1383,-12003.94"/>
<polygon fill="black" stroke="black" points="1386.5,-12003.9 1383,-11993.9 1379.5,-12003.9 1386.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_3&#45;&gt;expert_agg_8 -->
<g id="edge424" class="edge">
<title>expert_ffn2_8_3&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M1555.9,-11941.76C1558.95,-11941.39 1561.99,-11941.02 1565,-11940.66 1875.75,-11903.62 2239.05,-11869.98 2448.63,-11851.52"/>
<polygon fill="black" stroke="black" points="2449.15,-11854.98 2458.81,-11850.62 2448.54,-11848.01 2449.15,-11854.98"/>
</g>
<!-- expert_gelu_8_4 -->
<g id="node275" class="node">
<title>expert_gelu_8_4</title>
<polygon fill="lightcyan" stroke="black" points="3324.5,-12083.66 3145.5,-12083.66 3145.5,-12030.66 3324.5,-12030.66 3324.5,-12083.66"/>
<text text-anchor="middle" x="3235" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3235" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3235" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_4&#45;&gt;expert_gelu_8_4 -->
<g id="edge427" class="edge">
<title>expert_8_4&#45;&gt;expert_gelu_8_4</title>
<path fill="none" stroke="black" d="M3235,-12120.53C3235,-12111.95 3235,-12102.67 3235,-12093.96"/>
<polygon fill="black" stroke="black" points="3238.5,-12093.71 3235,-12083.71 3231.5,-12093.71 3238.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_4 -->
<g id="node276" class="node">
<title>expert_ffn2_8_4</title>
<polygon fill="lightcyan" stroke="black" points="3407.5,-11993.66 3062.5,-11993.66 3062.5,-11940.66 3407.5,-11940.66 3407.5,-11993.66"/>
<text text-anchor="middle" x="3235" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3235" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3235" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_4&#45;&gt;expert_ffn2_8_4 -->
<g id="edge428" class="edge">
<title>expert_gelu_8_4&#45;&gt;expert_ffn2_8_4</title>
<path fill="none" stroke="black" d="M3235,-12030.23C3235,-12022 3235,-12012.74 3235,-12003.94"/>
<polygon fill="black" stroke="black" points="3238.5,-12003.9 3235,-11993.9 3231.5,-12003.9 3238.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_4&#45;&gt;expert_agg_8 -->
<g id="edge429" class="edge">
<title>expert_ffn2_8_4&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M3114.26,-11940.65C3034.16,-11923.73 2926.9,-11901.07 2832.95,-11881.22"/>
<polygon fill="black" stroke="black" points="2833.53,-11877.77 2823.02,-11879.13 2832.08,-11884.62 2833.53,-11877.77"/>
</g>
<!-- expert_gelu_8_5 -->
<g id="node278" class="node">
<title>expert_gelu_8_5</title>
<polygon fill="lightcyan" stroke="black" points="4050.5,-12083.66 3871.5,-12083.66 3871.5,-12030.66 4050.5,-12030.66 4050.5,-12083.66"/>
<text text-anchor="middle" x="3961" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3961" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3961" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_5&#45;&gt;expert_gelu_8_5 -->
<g id="edge432" class="edge">
<title>expert_8_5&#45;&gt;expert_gelu_8_5</title>
<path fill="none" stroke="black" d="M3961,-12120.53C3961,-12111.95 3961,-12102.67 3961,-12093.96"/>
<polygon fill="black" stroke="black" points="3964.5,-12093.71 3961,-12083.71 3957.5,-12093.71 3964.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_5 -->
<g id="node279" class="node">
<title>expert_ffn2_8_5</title>
<polygon fill="lightcyan" stroke="black" points="4133.5,-11993.66 3788.5,-11993.66 3788.5,-11940.66 4133.5,-11940.66 4133.5,-11993.66"/>
<text text-anchor="middle" x="3961" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="3961" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3961" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_5&#45;&gt;expert_ffn2_8_5 -->
<g id="edge433" class="edge">
<title>expert_gelu_8_5&#45;&gt;expert_ffn2_8_5</title>
<path fill="none" stroke="black" d="M3961,-12030.23C3961,-12022 3961,-12012.74 3961,-12003.94"/>
<polygon fill="black" stroke="black" points="3964.5,-12003.9 3961,-11993.9 3957.5,-12003.9 3964.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_5&#45;&gt;expert_agg_8 -->
<g id="edge434" class="edge">
<title>expert_ffn2_8_5&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M3788.1,-11941.61C3785.38,-11941.29 3782.68,-11940.97 3780,-11940.66 3440.89,-11901.57 3044.48,-11868.74 2814.45,-11850.96"/>
<polygon fill="black" stroke="black" points="2814.54,-11847.46 2804.3,-11850.18 2814.01,-11854.44 2814.54,-11847.46"/>
</g>
<!-- expert_gelu_8_6 -->
<g id="node281" class="node">
<title>expert_gelu_8_6</title>
<polygon fill="lightcyan" stroke="black" points="2198.5,-12083.66 2019.5,-12083.66 2019.5,-12030.66 2198.5,-12030.66 2198.5,-12083.66"/>
<text text-anchor="middle" x="2109" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2109" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2109" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_6&#45;&gt;expert_gelu_8_6 -->
<g id="edge437" class="edge">
<title>expert_8_6&#45;&gt;expert_gelu_8_6</title>
<path fill="none" stroke="black" d="M2109,-12120.53C2109,-12111.95 2109,-12102.67 2109,-12093.96"/>
<polygon fill="black" stroke="black" points="2112.5,-12093.71 2109,-12083.71 2105.5,-12093.71 2112.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_6 -->
<g id="node282" class="node">
<title>expert_ffn2_8_6</title>
<polygon fill="lightcyan" stroke="black" points="2281.5,-11993.66 1936.5,-11993.66 1936.5,-11940.66 2281.5,-11940.66 2281.5,-11993.66"/>
<text text-anchor="middle" x="2109" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2109" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2109" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_6&#45;&gt;expert_ffn2_8_6 -->
<g id="edge438" class="edge">
<title>expert_gelu_8_6&#45;&gt;expert_ffn2_8_6</title>
<path fill="none" stroke="black" d="M2109,-12030.23C2109,-12022 2109,-12012.74 2109,-12003.94"/>
<polygon fill="black" stroke="black" points="2112.5,-12003.9 2109,-11993.9 2105.5,-12003.9 2112.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_6&#45;&gt;expert_agg_8 -->
<g id="edge439" class="edge">
<title>expert_ffn2_8_6&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M2210.05,-11940.65C2282.49,-11922.37 2381.49,-11897.37 2464.28,-11876.47"/>
<polygon fill="black" stroke="black" points="2465.2,-11879.85 2474.04,-11874.01 2463.49,-11873.07 2465.2,-11879.85"/>
</g>
<!-- expert_gelu_8_7 -->
<g id="node284" class="node">
<title>expert_gelu_8_7</title>
<polygon fill="lightcyan" stroke="black" points="2561.5,-12083.66 2382.5,-12083.66 2382.5,-12030.66 2561.5,-12030.66 2561.5,-12083.66"/>
<text text-anchor="middle" x="2472" y="-12068.46" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2472" y="-12053.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2472" y="-12038.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_8_7&#45;&gt;expert_gelu_8_7 -->
<g id="edge442" class="edge">
<title>expert_8_7&#45;&gt;expert_gelu_8_7</title>
<path fill="none" stroke="black" d="M2472,-12120.53C2472,-12111.95 2472,-12102.67 2472,-12093.96"/>
<polygon fill="black" stroke="black" points="2475.5,-12093.71 2472,-12083.71 2468.5,-12093.71 2475.5,-12093.71"/>
</g>
<!-- expert_ffn2_8_7 -->
<g id="node285" class="node">
<title>expert_ffn2_8_7</title>
<polygon fill="lightcyan" stroke="black" points="2644.5,-11993.66 2299.5,-11993.66 2299.5,-11940.66 2644.5,-11940.66 2644.5,-11993.66"/>
<text text-anchor="middle" x="2472" y="-11978.46" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2472" y="-11963.46" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2472" y="-11948.46" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- expert_gelu_8_7&#45;&gt;expert_ffn2_8_7 -->
<g id="edge443" class="edge">
<title>expert_gelu_8_7&#45;&gt;expert_ffn2_8_7</title>
<path fill="none" stroke="black" d="M2472,-12030.23C2472,-12022 2472,-12012.74 2472,-12003.94"/>
<polygon fill="black" stroke="black" points="2475.5,-12003.9 2472,-11993.9 2468.5,-12003.9 2475.5,-12003.9"/>
</g>
<!-- expert_ffn2_8_7&#45;&gt;expert_agg_8 -->
<g id="edge444" class="edge">
<title>expert_ffn2_8_7&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="black" d="M2501.64,-11940.58C2511.89,-11931.72 2523.95,-11921.31 2536.41,-11910.55"/>
<polygon fill="black" stroke="black" points="2538.93,-11913 2544.21,-11903.82 2534.35,-11907.7 2538.93,-11913"/>
</g>
<!-- expert_agg_8&#45;&gt;residual2_8 -->
<g id="edge447" class="edge">
<title>expert_agg_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M2435.44,-11814.27C2209.22,-11789.54 1823.3,-11747.35 1541.87,-11716.58"/>
<polygon fill="black" stroke="black" points="1542.23,-11713.1 1531.91,-11715.49 1541.47,-11720.06 1542.23,-11713.1"/>
</g>
<!-- comm_8_9 -->
<g id="node324" class="node">
<title>comm_8_9</title>
<ellipse fill="lightgreen" stroke="black" cx="1195" cy="-11560.79" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1195" y="-11564.59" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
<text text-anchor="middle" x="1195" y="-11549.59" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_8&#45;&gt;comm_8_9 -->
<g id="edge448" class="edge">
<title>residual2_8&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M1195,-11624.6C1195,-11615.67 1195,-11606.56 1195,-11598.16"/>
<polygon fill="black" stroke="black" points="1198.5,-11597.95 1195,-11587.95 1191.5,-11597.95 1198.5,-11597.95"/>
</g>
<!-- comm_7_8&#45;&gt;ln1_8 -->
<g id="edge393" class="edge">
<title>comm_7_8&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M1073.44,-12977.15C1056.35,-12966.88 1036.27,-12954.8 1018.18,-12943.93"/>
<polygon fill="black" stroke="black" points="1019.85,-12940.85 1009.48,-12938.7 1016.24,-12946.85 1019.85,-12940.85"/>
</g>
<!-- comm_7_8&#45;&gt;residual1_8 -->
<g id="edge401" class="edge">
<title>comm_7_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1201.31,-12983.97C1264.56,-12968.65 1339,-12944.06 1339,-12913.16 1339,-12913.16 1339,-12913.16 1339,-12641.16 1339,-12619.34 1328.74,-12601.01 1313.71,-12585.86"/>
<polygon fill="black" stroke="black" points="1315.68,-12582.92 1305.96,-12578.68 1310.92,-12588.05 1315.68,-12582.92"/>
</g>
<!-- ln1_9 -->
<g id="node289" class="node">
<title>ln1_9</title>
<polygon fill="lightyellow" stroke="black" points="1053,-11496.92 883,-11496.92 883,-11443.92 1053,-11443.92 1053,-11496.92"/>
<text text-anchor="middle" x="968" y="-11481.72" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="968" y="-11466.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="968" y="-11451.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_q_9 -->
<g id="node290" class="node">
<title>mha_q_9</title>
<polygon fill="lightblue" stroke="black" points="1312,-11406.92 976,-11406.92 976,-11353.92 1312,-11353.92 1312,-11406.92"/>
<text text-anchor="middle" x="1144" y="-11391.72" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1144" y="-11376.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1144" y="-11361.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_q_9 -->
<g id="edge450" class="edge">
<title>ln1_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M1019.38,-11443.73C1039.53,-11433.66 1062.8,-11422.02 1083.74,-11411.55"/>
<polygon fill="black" stroke="black" points="1085.48,-11414.59 1092.86,-11406.99 1082.35,-11408.33 1085.48,-11414.59"/>
</g>
<!-- mha_k_9 -->
<g id="node291" class="node">
<title>mha_k_9</title>
<polygon fill="lightblue" stroke="black" points="604,-11406.92 268,-11406.92 268,-11353.92 604,-11353.92 604,-11406.92"/>
<text text-anchor="middle" x="436" y="-11391.72" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="436" y="-11376.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="436" y="-11361.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_k_9 -->
<g id="edge451" class="edge">
<title>ln1_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M882.82,-11455.33C806.99,-11442.79 693.93,-11424.09 600.51,-11408.63"/>
<polygon fill="black" stroke="black" points="600.82,-11405.14 590.38,-11406.96 599.68,-11412.04 600.82,-11405.14"/>
</g>
<!-- mha_v_9 -->
<g id="node292" class="node">
<title>mha_v_9</title>
<polygon fill="lightblue" stroke="black" points="958,-11406.92 622,-11406.92 622,-11353.92 958,-11353.92 958,-11406.92"/>
<text text-anchor="middle" x="790" y="-11391.72" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="790" y="-11376.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="790" y="-11361.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_v_9 -->
<g id="edge452" class="edge">
<title>ln1_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M916.04,-11443.73C895.66,-11433.66 872.12,-11422.02 850.95,-11411.55"/>
<polygon fill="black" stroke="black" points="852.24,-11408.28 841.72,-11406.99 849.13,-11414.56 852.24,-11408.28"/>
</g>
<!-- mha_attn_9 -->
<g id="node293" class="node">
<title>mha_attn_9</title>
<polygon fill="lightblue" stroke="black" points="961,-11316.92 791,-11316.92 791,-11263.92 961,-11263.92 961,-11316.92"/>
<text text-anchor="middle" x="876" y="-11301.72" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="876" y="-11286.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="876" y="-11271.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge453" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1066.12,-11353.85C1034.05,-11343.32 996.75,-11331.07 963.72,-11320.22"/>
<polygon fill="black" stroke="black" points="964.66,-11316.85 954.07,-11317.06 962.48,-11323.5 964.66,-11316.85"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge454" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M563.56,-11353.91C632.94,-11340.03 717.3,-11323.16 780.87,-11310.45"/>
<polygon fill="black" stroke="black" points="781.77,-11313.84 790.89,-11308.44 780.39,-11306.97 781.77,-11313.84"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge455" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M815.34,-11353.49C824.26,-11344.36 834.41,-11333.98 843.82,-11324.35"/>
<polygon fill="black" stroke="black" points="846.36,-11326.76 850.84,-11317.16 841.35,-11321.87 846.36,-11326.76"/>
</g>
<!-- mha_out_9 -->
<g id="node294" class="node">
<title>mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="1306,-11226.92 970,-11226.92 970,-11173.92 1306,-11173.92 1306,-11226.92"/>
<text text-anchor="middle" x="1138" y="-11211.72" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1138" y="-11196.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1138" y="-11181.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge456" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M952.13,-11263.85C983.35,-11253.36 1019.64,-11241.17 1051.83,-11230.36"/>
<polygon fill="black" stroke="black" points="1053.31,-11233.56 1061.68,-11227.06 1051.08,-11226.92 1053.31,-11233.56"/>
</g>
<!-- residual1_9 -->
<g id="node295" class="node">
<title>residual1_9</title>
<polygon fill="lightcoral" stroke="black" points="1635.86,-11136.92 1066.58,-11136.92 920.14,-11030.92 1489.42,-11030.92 1635.86,-11136.92"/>
<text text-anchor="middle" x="1278" y="-11095.22" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1278" y="-11080.22" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1278" y="-11065.22" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge458" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1169.42,-11173.72C1180.43,-11164.72 1193.3,-11154.19 1206.25,-11143.6"/>
<polygon fill="black" stroke="black" points="1208.79,-11146.05 1214.31,-11137.01 1204.35,-11140.63 1208.79,-11146.05"/>
</g>
<!-- ln2_9 -->
<g id="node296" class="node">
<title>ln2_9</title>
<polygon fill="lightyellow" stroke="black" points="2660,-10993.92 2490,-10993.92 2490,-10940.92 2660,-10940.92 2660,-10993.92"/>
<text text-anchor="middle" x="2575" y="-10978.72" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2575" y="-10963.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2575" y="-10948.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge459" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M1530.77,-11060.61C1820.74,-11035.01 2281.62,-10994.32 2479.56,-10976.85"/>
<polygon fill="black" stroke="black" points="2479.99,-10980.32 2489.64,-10975.96 2479.37,-10973.35 2479.99,-10980.32"/>
</g>
<!-- residual2_9 -->
<g id="node323" class="node">
<title>residual2_9</title>
<polygon fill="lightcoral" stroke="black" points="1635.86,-10288.92 1066.58,-10288.92 920.14,-10182.92 1489.42,-10182.92 1635.86,-10288.92"/>
<text text-anchor="middle" x="1278" y="-10247.22" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1278" y="-10232.22" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1278" y="-10217.22" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge502" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1270.23,-11030.89C1267.92,-11011.35 1266,-10988.91 1266,-10968.42 1266,-10968.42 1266,-10968.42 1266,-10392.92 1266,-10362.08 1268.36,-10327.9 1270.99,-10299.42"/>
<polygon fill="black" stroke="black" points="1274.5,-10299.49 1271.96,-10289.2 1267.53,-10298.82 1274.5,-10299.49"/>
</g>
<!-- gate_9 -->
<g id="node297" class="node">
<title>gate_9</title>
<polygon fill="orange" stroke="black" points="2744,-10903.92 2435,-10850.92 2744,-10797.92 3053,-10850.92 2744,-10903.92"/>
<text text-anchor="middle" x="2744" y="-10862.22" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2744" y="-10847.22" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2744" y="-10832.22" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;gate_9 -->
<g id="edge460" class="edge">
<title>ln2_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M2612.93,-10940.72C2631.05,-10928.44 2653.34,-10913.34 2674.36,-10899.1"/>
<polygon fill="black" stroke="black" points="2676.34,-10901.99 2682.65,-10893.49 2672.41,-10896.2 2676.34,-10901.99"/>
</g>
<!-- expert_9_0 -->
<g id="node298" class="node">
<title>expert_9_0</title>
<polygon fill="lightcyan" stroke="black" points="2001.5,-10746.92 1656.5,-10746.92 1656.5,-10678.92 2001.5,-10678.92 2001.5,-10746.92"/>
<text text-anchor="middle" x="1829" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1829" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1829" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1829" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_0 -->
<g id="edge462" class="edge">
<title>ln2_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" d="M2489.9,-10958.77C2354.44,-10943.32 2085.43,-10899.05 1893,-10779.92 1881.97,-10773.09 1871.49,-10763.95 1862.33,-10754.65"/>
<polygon fill="black" stroke="black" points="1864.69,-10752.05 1855.28,-10747.19 1859.61,-10756.86 1864.69,-10752.05"/>
</g>
<!-- expert_9_1 -->
<g id="node301" class="node">
<title>expert_9_1</title>
<polygon fill="lightcyan" stroke="black" points="3127.5,-10746.92 2782.5,-10746.92 2782.5,-10678.92 3127.5,-10678.92 3127.5,-10746.92"/>
<text text-anchor="middle" x="2955" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2955" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2955" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2955" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_1 -->
<g id="edge467" class="edge">
<title>ln2_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" d="M2660.19,-10961.39C2792.57,-10952.71 3035.35,-10933.01 3062,-10903.92 3103.76,-10858.34 3100.45,-10816.91 3067,-10764.92 3064.46,-10760.97 3061.53,-10757.33 3058.3,-10753.96"/>
<polygon fill="black" stroke="black" points="3060.5,-10751.23 3050.77,-10747.03 3055.76,-10756.38 3060.5,-10751.23"/>
</g>
<!-- expert_9_2 -->
<g id="node304" class="node">
<title>expert_9_2</title>
<polygon fill="lightcyan" stroke="black" points="3853.5,-10746.92 3508.5,-10746.92 3508.5,-10678.92 3853.5,-10678.92 3853.5,-10746.92"/>
<text text-anchor="middle" x="3681" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3681" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3681" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3681" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_2 -->
<g id="edge472" class="edge">
<title>ln2_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" d="M2660.15,-10960.39C2756.25,-10953.2 2917.15,-10939.97 3055,-10922.92 3323.63,-10889.69 3435.89,-10949.33 3647,-10779.92 3654.76,-10773.69 3660.93,-10765.22 3665.77,-10756.42"/>
<polygon fill="black" stroke="black" points="3669.02,-10757.73 3670.33,-10747.22 3662.75,-10754.62 3669.02,-10757.73"/>
</g>
<!-- expert_9_3 -->
<g id="node307" class="node">
<title>expert_9_3</title>
<polygon fill="lightcyan" stroke="black" points="1638.5,-10746.92 1293.5,-10746.92 1293.5,-10678.92 1638.5,-10678.92 1638.5,-10746.92"/>
<text text-anchor="middle" x="1466" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1466" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1466" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1466" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_3 -->
<g id="edge477" class="edge">
<title>ln2_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" d="M2489.88,-10966.41C2363.59,-10964.58 2119.99,-10954.08 1920,-10903.92 1778.92,-10868.54 1624.73,-10796.2 1537.23,-10751.7"/>
<polygon fill="black" stroke="black" points="1538.7,-10748.52 1528.2,-10747.08 1535.51,-10754.75 1538.7,-10748.52"/>
</g>
<!-- expert_9_4 -->
<g id="node310" class="node">
<title>expert_9_4</title>
<polygon fill="lightcyan" stroke="black" points="3490.5,-10746.92 3145.5,-10746.92 3145.5,-10678.92 3490.5,-10678.92 3490.5,-10746.92"/>
<text text-anchor="middle" x="3318" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3318" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3318" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3318" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_4 -->
<g id="edge482" class="edge">
<title>ln2_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" d="M2660.24,-10963.56C2787.1,-10958.05 3018.45,-10942.87 3091,-10903.92 3165.26,-10864.05 3237.54,-10797.28 3279.9,-10754.44"/>
<polygon fill="black" stroke="black" points="3282.44,-10756.85 3286.95,-10747.26 3277.45,-10751.95 3282.44,-10756.85"/>
</g>
<!-- expert_9_5 -->
<g id="node313" class="node">
<title>expert_9_5</title>
<polygon fill="lightcyan" stroke="black" points="4216.5,-10746.92 3871.5,-10746.92 3871.5,-10678.92 4216.5,-10678.92 4216.5,-10746.92"/>
<text text-anchor="middle" x="4044" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4044" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4044" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4044" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_5 -->
<g id="edge487" class="edge">
<title>ln2_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" d="M2660.22,-10963.64C2858.12,-10956.7 3344.08,-10936.8 3504,-10903.92 3671.02,-10869.59 3856.72,-10795.93 3961.04,-10751.08"/>
<polygon fill="black" stroke="black" points="3962.46,-10754.28 3970.26,-10747.1 3959.69,-10747.85 3962.46,-10754.28"/>
</g>
<!-- expert_9_6 -->
<g id="node316" class="node">
<title>expert_9_6</title>
<polygon fill="lightcyan" stroke="black" points="2364.5,-10746.92 2019.5,-10746.92 2019.5,-10678.92 2364.5,-10678.92 2364.5,-10746.92"/>
<text text-anchor="middle" x="2192" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2192" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2192" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2192" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_6 -->
<g id="edge492" class="edge">
<title>ln2_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" d="M2489.67,-10942.09C2472.35,-10936.39 2454.42,-10929.91 2438,-10922.92 2338.2,-10880.44 2333.24,-10836.79 2252,-10764.92 2247.9,-10761.3 2243.62,-10757.56 2239.32,-10753.84"/>
<polygon fill="black" stroke="black" points="2241.43,-10751.04 2231.57,-10747.17 2236.86,-10756.34 2241.43,-10751.04"/>
</g>
<!-- expert_9_7 -->
<g id="node319" class="node">
<title>expert_9_7</title>
<polygon fill="lightcyan" stroke="black" points="2727.5,-10746.92 2382.5,-10746.92 2382.5,-10678.92 2727.5,-10678.92 2727.5,-10746.92"/>
<text text-anchor="middle" x="2555" y="-10731.72" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2555" y="-10716.72" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2555" y="-10701.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2555" y="-10686.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;expert_9_7 -->
<g id="edge497" class="edge">
<title>ln2_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" d="M2489.84,-10949.68C2465.08,-10940.44 2440.76,-10926.11 2426,-10903.92 2399.91,-10864.69 2403.55,-10839.34 2426,-10797.92 2435.96,-10779.55 2451.87,-10764.56 2469.17,-10752.61"/>
<polygon fill="black" stroke="black" points="2471.31,-10755.39 2477.76,-10746.98 2467.48,-10749.53 2471.31,-10755.39"/>
</g>
<!-- gate_9&#45;&gt;expert_9_0 -->
<g id="edge461" class="edge">
<title>gate_9&#45;&gt;expert_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2570.8,-10827.56C2424.55,-10808.21 2209.39,-10778.66 2011.88,-10747.04"/>
<polygon fill="black" stroke="black" points="2012.32,-10743.57 2001.89,-10745.44 2011.21,-10750.48 2012.32,-10743.57"/>
<text text-anchor="middle" x="2256.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_1 -->
<g id="edge466" class="edge">
<title>gate_9&#45;&gt;expert_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2794.59,-10806.59C2812.19,-10792.48 2832.43,-10777.28 2852,-10764.92 2859.09,-10760.44 2866.64,-10756.06 2874.29,-10751.86"/>
<polygon fill="black" stroke="black" points="2876.15,-10754.83 2883.3,-10747.02 2872.83,-10748.67 2876.15,-10754.83"/>
<text text-anchor="middle" x="2897.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_2 -->
<g id="edge471" class="edge">
<title>gate_9&#45;&gt;expert_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2920.38,-10828.17C3071.34,-10809.02 3294.64,-10779.42 3498.12,-10747.2"/>
<polygon fill="black" stroke="black" points="3498.78,-10750.64 3508.1,-10745.62 3497.68,-10743.73 3498.78,-10750.64"/>
<text text-anchor="middle" x="3421.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_3 -->
<g id="edge476" class="edge">
<title>gate_9&#45;&gt;expert_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2527.35,-10835.06C2308.19,-10818.76 1959.59,-10789.33 1648.97,-10747.02"/>
<polygon fill="black" stroke="black" points="1649.24,-10743.52 1638.86,-10745.63 1648.29,-10750.46 1649.24,-10743.52"/>
<text text-anchor="middle" x="1962.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_4 -->
<g id="edge481" class="edge">
<title>gate_9&#45;&gt;expert_9_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2848.92,-10815.91C2903.43,-10799.04 2971.37,-10779.27 3033,-10764.92 3075.74,-10754.97 3089.11,-10755.07 3135.09,-10747.22"/>
<polygon fill="black" stroke="black" points="3135.83,-10750.65 3145.08,-10745.48 3134.63,-10743.75 3135.83,-10750.65"/>
<text text-anchor="middle" x="3078.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_5 -->
<g id="edge486" class="edge">
<title>gate_9&#45;&gt;expert_9_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2963.36,-10835.5C3187.02,-10819.46 3544.04,-10790.16 3860.82,-10747.19"/>
<polygon fill="black" stroke="black" points="3861.69,-10750.6 3871.13,-10745.78 3860.75,-10743.66 3861.69,-10750.6"/>
<text text-anchor="middle" x="3756.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_6 -->
<g id="edge491" class="edge">
<title>gate_9&#45;&gt;expert_9_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2619.43,-10819.23C2535.3,-10798.5 2423.98,-10771.07 2336.03,-10749.41"/>
<polygon fill="black" stroke="black" points="2336.79,-10745.99 2326.25,-10747 2335.12,-10752.79 2336.79,-10745.99"/>
<text text-anchor="middle" x="2496.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_9&#45;&gt;expert_9_7 -->
<g id="edge496" class="edge">
<title>gate_9&#45;&gt;expert_9_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2685.49,-10807.82C2661.15,-10790.31 2633.06,-10770.09 2609.2,-10752.92"/>
<polygon fill="black" stroke="black" points="2611.11,-10749.98 2600.94,-10746.98 2607.02,-10755.66 2611.11,-10749.98"/>
<text text-anchor="middle" x="2688.5" y="-10768.72" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_9 -->
<g id="node322" class="node">
<title>expert_agg_9</title>
<polygon fill="lightpink" stroke="black" points="2915.86,-10461.92 2570.88,-10461.92 2482.14,-10325.92 2827.12,-10325.92 2915.86,-10461.92"/>
<text text-anchor="middle" x="2699" y="-10412.72" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2699" y="-10397.72" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2699" y="-10382.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2699" y="-10367.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- gate_9&#45;&gt;expert_agg_9 -->
<g id="edge501" class="edge">
<title>gate_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2750.11,-10798.66C2752.64,-10773.22 2755,-10741.99 2755,-10713.92 2755,-10713.92 2755,-10713.92 2755,-10524.42 2755,-10506.71 2750.53,-10488.67 2744.12,-10471.9"/>
<polygon fill="black" stroke="black" points="2747.17,-10470.12 2740.14,-10462.19 2740.69,-10472.77 2747.17,-10470.12"/>
<text text-anchor="middle" x="2783.5" y="-10611.72" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_9_0 -->
<g id="node299" class="node">
<title>expert_gelu_9_0</title>
<polygon fill="lightcyan" stroke="black" points="1918.5,-10641.92 1739.5,-10641.92 1739.5,-10588.92 1918.5,-10588.92 1918.5,-10641.92"/>
<text text-anchor="middle" x="1829" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1829" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1829" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_0&#45;&gt;expert_gelu_9_0 -->
<g id="edge463" class="edge">
<title>expert_9_0&#45;&gt;expert_gelu_9_0</title>
<path fill="none" stroke="black" d="M1829,-10678.79C1829,-10670.21 1829,-10660.93 1829,-10652.22"/>
<polygon fill="black" stroke="black" points="1832.5,-10651.97 1829,-10641.97 1825.5,-10651.97 1832.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_0 -->
<g id="node300" class="node">
<title>expert_ffn2_9_0</title>
<polygon fill="lightcyan" stroke="black" points="2001.5,-10551.92 1656.5,-10551.92 1656.5,-10498.92 2001.5,-10498.92 2001.5,-10551.92"/>
<text text-anchor="middle" x="1829" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1829" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1829" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_0&#45;&gt;expert_ffn2_9_0 -->
<g id="edge464" class="edge">
<title>expert_gelu_9_0&#45;&gt;expert_ffn2_9_0</title>
<path fill="none" stroke="black" d="M1829,-10588.49C1829,-10580.26 1829,-10571 1829,-10562.2"/>
<polygon fill="black" stroke="black" points="1832.5,-10562.16 1829,-10552.16 1825.5,-10562.16 1832.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_0&#45;&gt;expert_agg_9 -->
<g id="edge465" class="edge">
<title>expert_ffn2_9_0&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M2000.36,-10498.91C2154.52,-10475.97 2379.61,-10442.46 2532.31,-10419.73"/>
<polygon fill="black" stroke="black" points="2532.89,-10423.19 2542.26,-10418.25 2531.86,-10416.26 2532.89,-10423.19"/>
</g>
<!-- expert_gelu_9_1 -->
<g id="node302" class="node">
<title>expert_gelu_9_1</title>
<polygon fill="lightcyan" stroke="black" points="3044.5,-10641.92 2865.5,-10641.92 2865.5,-10588.92 3044.5,-10588.92 3044.5,-10641.92"/>
<text text-anchor="middle" x="2955" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2955" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2955" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_1&#45;&gt;expert_gelu_9_1 -->
<g id="edge468" class="edge">
<title>expert_9_1&#45;&gt;expert_gelu_9_1</title>
<path fill="none" stroke="black" d="M2955,-10678.79C2955,-10670.21 2955,-10660.93 2955,-10652.22"/>
<polygon fill="black" stroke="black" points="2958.5,-10651.97 2955,-10641.97 2951.5,-10651.97 2958.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_1 -->
<g id="node303" class="node">
<title>expert_ffn2_9_1</title>
<polygon fill="lightcyan" stroke="black" points="3127.5,-10551.92 2782.5,-10551.92 2782.5,-10498.92 3127.5,-10498.92 3127.5,-10551.92"/>
<text text-anchor="middle" x="2955" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="2955" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2955" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_1&#45;&gt;expert_ffn2_9_1 -->
<g id="edge469" class="edge">
<title>expert_gelu_9_1&#45;&gt;expert_ffn2_9_1</title>
<path fill="none" stroke="black" d="M2955,-10588.49C2955,-10580.26 2955,-10571 2955,-10562.2"/>
<polygon fill="black" stroke="black" points="2958.5,-10562.16 2955,-10552.16 2951.5,-10562.16 2958.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_1&#45;&gt;expert_agg_9 -->
<g id="edge470" class="edge">
<title>expert_ffn2_9_1&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M2904.42,-10498.84C2885.71,-10489.37 2863.45,-10478.11 2840.61,-10466.56"/>
<polygon fill="black" stroke="black" points="2842,-10463.33 2831.49,-10461.94 2838.84,-10469.58 2842,-10463.33"/>
</g>
<!-- expert_gelu_9_2 -->
<g id="node305" class="node">
<title>expert_gelu_9_2</title>
<polygon fill="lightcyan" stroke="black" points="3770.5,-10641.92 3591.5,-10641.92 3591.5,-10588.92 3770.5,-10588.92 3770.5,-10641.92"/>
<text text-anchor="middle" x="3681" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3681" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3681" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_2&#45;&gt;expert_gelu_9_2 -->
<g id="edge473" class="edge">
<title>expert_9_2&#45;&gt;expert_gelu_9_2</title>
<path fill="none" stroke="black" d="M3681,-10678.79C3681,-10670.21 3681,-10660.93 3681,-10652.22"/>
<polygon fill="black" stroke="black" points="3684.5,-10651.97 3681,-10641.97 3677.5,-10651.97 3684.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_2 -->
<g id="node306" class="node">
<title>expert_ffn2_9_2</title>
<polygon fill="lightcyan" stroke="black" points="3853.5,-10551.92 3508.5,-10551.92 3508.5,-10498.92 3853.5,-10498.92 3853.5,-10551.92"/>
<text text-anchor="middle" x="3681" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3681" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3681" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_2&#45;&gt;expert_ffn2_9_2 -->
<g id="edge474" class="edge">
<title>expert_gelu_9_2&#45;&gt;expert_ffn2_9_2</title>
<path fill="none" stroke="black" d="M3681,-10588.49C3681,-10580.26 3681,-10571 3681,-10562.2"/>
<polygon fill="black" stroke="black" points="3684.5,-10562.16 3681,-10552.16 3677.5,-10562.16 3684.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_2&#45;&gt;expert_agg_9 -->
<g id="edge475" class="edge">
<title>expert_ffn2_9_2&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M3508.08,-10500.02C3505.37,-10499.65 3502.67,-10499.28 3500,-10498.92 3294.98,-10471.17 3060.23,-10440.86 2898.11,-10420.16"/>
<polygon fill="black" stroke="black" points="2898.39,-10416.67 2888.03,-10418.88 2897.5,-10423.61 2898.39,-10416.67"/>
</g>
<!-- expert_gelu_9_3 -->
<g id="node308" class="node">
<title>expert_gelu_9_3</title>
<polygon fill="lightcyan" stroke="black" points="1555.5,-10641.92 1376.5,-10641.92 1376.5,-10588.92 1555.5,-10588.92 1555.5,-10641.92"/>
<text text-anchor="middle" x="1466" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1466" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1466" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_3&#45;&gt;expert_gelu_9_3 -->
<g id="edge478" class="edge">
<title>expert_9_3&#45;&gt;expert_gelu_9_3</title>
<path fill="none" stroke="black" d="M1466,-10678.79C1466,-10670.21 1466,-10660.93 1466,-10652.22"/>
<polygon fill="black" stroke="black" points="1469.5,-10651.97 1466,-10641.97 1462.5,-10651.97 1469.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_3 -->
<g id="node309" class="node">
<title>expert_ffn2_9_3</title>
<polygon fill="lightcyan" stroke="black" points="1638.5,-10551.92 1293.5,-10551.92 1293.5,-10498.92 1638.5,-10498.92 1638.5,-10551.92"/>
<text text-anchor="middle" x="1466" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1466" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1466" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_3&#45;&gt;expert_ffn2_9_3 -->
<g id="edge479" class="edge">
<title>expert_gelu_9_3&#45;&gt;expert_ffn2_9_3</title>
<path fill="none" stroke="black" d="M1466,-10588.49C1466,-10580.26 1466,-10571 1466,-10562.2"/>
<polygon fill="black" stroke="black" points="1469.5,-10562.16 1466,-10552.16 1462.5,-10562.16 1469.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_3&#45;&gt;expert_agg_9 -->
<g id="edge480" class="edge">
<title>expert_ffn2_9_3&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M1638.9,-10500.02C1641.95,-10499.65 1644.99,-10499.28 1648,-10498.92 1956.77,-10462.03 2317.7,-10428.37 2526.17,-10409.86"/>
<polygon fill="black" stroke="black" points="2526.63,-10413.33 2536.29,-10408.96 2526.02,-10406.36 2526.63,-10413.33"/>
</g>
<!-- expert_gelu_9_4 -->
<g id="node311" class="node">
<title>expert_gelu_9_4</title>
<polygon fill="lightcyan" stroke="black" points="3407.5,-10641.92 3228.5,-10641.92 3228.5,-10588.92 3407.5,-10588.92 3407.5,-10641.92"/>
<text text-anchor="middle" x="3318" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3318" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3318" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_4&#45;&gt;expert_gelu_9_4 -->
<g id="edge483" class="edge">
<title>expert_9_4&#45;&gt;expert_gelu_9_4</title>
<path fill="none" stroke="black" d="M3318,-10678.79C3318,-10670.21 3318,-10660.93 3318,-10652.22"/>
<polygon fill="black" stroke="black" points="3321.5,-10651.97 3318,-10641.97 3314.5,-10651.97 3321.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_4 -->
<g id="node312" class="node">
<title>expert_ffn2_9_4</title>
<polygon fill="lightcyan" stroke="black" points="3490.5,-10551.92 3145.5,-10551.92 3145.5,-10498.92 3490.5,-10498.92 3490.5,-10551.92"/>
<text text-anchor="middle" x="3318" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3318" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3318" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_4&#45;&gt;expert_ffn2_9_4 -->
<g id="edge484" class="edge">
<title>expert_gelu_9_4&#45;&gt;expert_ffn2_9_4</title>
<path fill="none" stroke="black" d="M3318,-10588.49C3318,-10580.26 3318,-10571 3318,-10562.2"/>
<polygon fill="black" stroke="black" points="3321.5,-10562.16 3318,-10552.16 3314.5,-10562.16 3321.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_4&#45;&gt;expert_agg_9 -->
<g id="edge485" class="edge">
<title>expert_ffn2_9_4&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M3196.07,-10498.91C3114.44,-10481.83 3004.84,-10458.91 2909.33,-10438.92"/>
<polygon fill="black" stroke="black" points="2910.05,-10435.5 2899.54,-10436.88 2908.61,-10442.35 2910.05,-10435.5"/>
</g>
<!-- expert_gelu_9_5 -->
<g id="node314" class="node">
<title>expert_gelu_9_5</title>
<polygon fill="lightcyan" stroke="black" points="4133.5,-10641.92 3954.5,-10641.92 3954.5,-10588.92 4133.5,-10588.92 4133.5,-10641.92"/>
<text text-anchor="middle" x="4044" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4044" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4044" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_5&#45;&gt;expert_gelu_9_5 -->
<g id="edge488" class="edge">
<title>expert_9_5&#45;&gt;expert_gelu_9_5</title>
<path fill="none" stroke="black" d="M4044,-10678.79C4044,-10670.21 4044,-10660.93 4044,-10652.22"/>
<polygon fill="black" stroke="black" points="4047.5,-10651.97 4044,-10641.97 4040.5,-10651.97 4047.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_5 -->
<g id="node315" class="node">
<title>expert_ffn2_9_5</title>
<polygon fill="lightcyan" stroke="black" points="4216.5,-10551.92 3871.5,-10551.92 3871.5,-10498.92 4216.5,-10498.92 4216.5,-10551.92"/>
<text text-anchor="middle" x="4044" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4044" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4044" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_5&#45;&gt;expert_ffn2_9_5 -->
<g id="edge489" class="edge">
<title>expert_gelu_9_5&#45;&gt;expert_ffn2_9_5</title>
<path fill="none" stroke="black" d="M4044,-10588.49C4044,-10580.26 4044,-10571 4044,-10562.2"/>
<polygon fill="black" stroke="black" points="4047.5,-10562.16 4044,-10552.16 4040.5,-10562.16 4047.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_5&#45;&gt;expert_agg_9 -->
<g id="edge490" class="edge">
<title>expert_ffn2_9_5&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M3871.1,-10499.87C3868.38,-10499.55 3865.68,-10499.23 3863,-10498.92 3521.52,-10459.64 3122.22,-10426.8 2891.19,-10409.08"/>
<polygon fill="black" stroke="black" points="2891.24,-10405.58 2881,-10408.3 2890.7,-10412.55 2891.24,-10405.58"/>
</g>
<!-- expert_gelu_9_6 -->
<g id="node317" class="node">
<title>expert_gelu_9_6</title>
<polygon fill="lightcyan" stroke="black" points="2281.5,-10641.92 2102.5,-10641.92 2102.5,-10588.92 2281.5,-10588.92 2281.5,-10641.92"/>
<text text-anchor="middle" x="2192" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2192" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2192" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_6&#45;&gt;expert_gelu_9_6 -->
<g id="edge493" class="edge">
<title>expert_9_6&#45;&gt;expert_gelu_9_6</title>
<path fill="none" stroke="black" d="M2192,-10678.79C2192,-10670.21 2192,-10660.93 2192,-10652.22"/>
<polygon fill="black" stroke="black" points="2195.5,-10651.97 2192,-10641.97 2188.5,-10651.97 2195.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_6 -->
<g id="node318" class="node">
<title>expert_ffn2_9_6</title>
<polygon fill="lightcyan" stroke="black" points="2364.5,-10551.92 2019.5,-10551.92 2019.5,-10498.92 2364.5,-10498.92 2364.5,-10551.92"/>
<text text-anchor="middle" x="2192" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2192" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2192" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_6&#45;&gt;expert_ffn2_9_6 -->
<g id="edge494" class="edge">
<title>expert_gelu_9_6&#45;&gt;expert_ffn2_9_6</title>
<path fill="none" stroke="black" d="M2192,-10588.49C2192,-10580.26 2192,-10571 2192,-10562.2"/>
<polygon fill="black" stroke="black" points="2195.5,-10562.16 2192,-10552.16 2188.5,-10562.16 2195.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_6&#45;&gt;expert_agg_9 -->
<g id="edge495" class="edge">
<title>expert_ffn2_9_6&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M2291.86,-10498.91C2362.97,-10480.75 2459.97,-10455.98 2541.45,-10435.16"/>
<polygon fill="black" stroke="black" points="2542.49,-10438.51 2551.31,-10432.64 2540.75,-10431.73 2542.49,-10438.51"/>
</g>
<!-- expert_gelu_9_7 -->
<g id="node320" class="node">
<title>expert_gelu_9_7</title>
<polygon fill="lightcyan" stroke="black" points="2644.5,-10641.92 2465.5,-10641.92 2465.5,-10588.92 2644.5,-10588.92 2644.5,-10641.92"/>
<text text-anchor="middle" x="2555" y="-10626.72" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2555" y="-10611.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2555" y="-10596.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_9_7&#45;&gt;expert_gelu_9_7 -->
<g id="edge498" class="edge">
<title>expert_9_7&#45;&gt;expert_gelu_9_7</title>
<path fill="none" stroke="black" d="M2555,-10678.79C2555,-10670.21 2555,-10660.93 2555,-10652.22"/>
<polygon fill="black" stroke="black" points="2558.5,-10651.97 2555,-10641.97 2551.5,-10651.97 2558.5,-10651.97"/>
</g>
<!-- expert_ffn2_9_7 -->
<g id="node321" class="node">
<title>expert_ffn2_9_7</title>
<polygon fill="lightcyan" stroke="black" points="2727.5,-10551.92 2382.5,-10551.92 2382.5,-10498.92 2727.5,-10498.92 2727.5,-10551.92"/>
<text text-anchor="middle" x="2555" y="-10536.72" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2555" y="-10521.72" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2555" y="-10506.72" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- expert_gelu_9_7&#45;&gt;expert_ffn2_9_7 -->
<g id="edge499" class="edge">
<title>expert_gelu_9_7&#45;&gt;expert_ffn2_9_7</title>
<path fill="none" stroke="black" d="M2555,-10588.49C2555,-10580.26 2555,-10571 2555,-10562.2"/>
<polygon fill="black" stroke="black" points="2558.5,-10562.16 2555,-10552.16 2551.5,-10562.16 2558.5,-10562.16"/>
</g>
<!-- expert_ffn2_9_7&#45;&gt;expert_agg_9 -->
<g id="edge500" class="edge">
<title>expert_ffn2_9_7&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="black" d="M2583.45,-10498.84C2593.29,-10489.98 2604.87,-10479.57 2616.84,-10468.81"/>
<polygon fill="black" stroke="black" points="2619.23,-10471.37 2624.32,-10462.08 2614.55,-10466.16 2619.23,-10471.37"/>
</g>
<!-- expert_agg_9&#45;&gt;residual2_9 -->
<g id="edge503" class="edge">
<title>expert_agg_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M2512.13,-10372.41C2287.32,-10347.73 1905.28,-10305.79 1625.69,-10275.09"/>
<polygon fill="black" stroke="black" points="1625.7,-10271.57 1615.37,-10273.96 1624.93,-10278.53 1625.7,-10271.57"/>
</g>
<!-- comm_9_10 -->
<g id="node360" class="node">
<title>comm_9_10</title>
<ellipse fill="lightgreen" stroke="black" cx="1278" cy="-10119.05" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1278" y="-10122.85" font-family="Times,serif" font-size="14.00">GPU 8 → GPU 9</text>
<text text-anchor="middle" x="1278" y="-10107.85" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_9&#45;&gt;comm_9_10 -->
<g id="edge504" class="edge">
<title>residual2_9&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M1278,-10182.86C1278,-10173.93 1278,-10164.82 1278,-10156.42"/>
<polygon fill="black" stroke="black" points="1281.5,-10156.21 1278,-10146.21 1274.5,-10156.21 1281.5,-10156.21"/>
</g>
<!-- comm_8_9&#45;&gt;ln1_9 -->
<g id="edge449" class="edge">
<title>comm_8_9&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M1136.84,-11537.15C1108.27,-11526.03 1073.5,-11512.49 1042.96,-11500.6"/>
<polygon fill="black" stroke="black" points="1044.22,-11497.34 1033.63,-11496.97 1041.68,-11503.86 1044.22,-11497.34"/>
</g>
<!-- comm_8_9&#45;&gt;residual1_9 -->
<g id="edge457" class="edge">
<title>comm_8_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1275.98,-11540.76C1309.19,-11527.7 1340,-11506.21 1340,-11471.42 1340,-11471.42 1340,-11471.42 1340,-11199.42 1340,-11180.92 1333.66,-11162.55 1325.04,-11146.11"/>
<polygon fill="black" stroke="black" points="1327.98,-11144.2 1320.04,-11137.19 1321.88,-11147.62 1327.98,-11144.2"/>
</g>
<!-- ln1_10 -->
<g id="node325" class="node">
<title>ln1_10</title>
<polygon fill="lightyellow" stroke="black" points="1133,-10055.18 963,-10055.18 963,-10002.18 1133,-10002.18 1133,-10055.18"/>
<text text-anchor="middle" x="1048" y="-10039.98" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1048" y="-10024.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1048" y="-10009.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_q_10 -->
<g id="node326" class="node">
<title>mha_q_10</title>
<polygon fill="lightblue" stroke="black" points="1481,-9965.18 1145,-9965.18 1145,-9912.18 1481,-9912.18 1481,-9965.18"/>
<text text-anchor="middle" x="1313" y="-9949.98" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1313" y="-9934.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1313" y="-9919.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_q_10 -->
<g id="edge506" class="edge">
<title>ln1_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M1125,-10002.11C1156.72,-9991.58 1193.6,-9979.33 1226.26,-9968.48"/>
<polygon fill="black" stroke="black" points="1227.42,-9971.79 1235.8,-9965.32 1225.21,-9965.15 1227.42,-9971.79"/>
</g>
<!-- mha_k_10 -->
<g id="node327" class="node">
<title>mha_k_10</title>
<polygon fill="lightblue" stroke="black" points="773,-9965.18 437,-9965.18 437,-9912.18 773,-9912.18 773,-9965.18"/>
<text text-anchor="middle" x="605" y="-9949.98" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="605" y="-9934.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="605" y="-9919.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_k_10 -->
<g id="edge507" class="edge">
<title>ln1_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M962.85,-10010.77C900.8,-9998.44 815.38,-9981.47 743.56,-9967.21"/>
<polygon fill="black" stroke="black" points="744.01,-9963.73 733.52,-9965.21 742.65,-9970.59 744.01,-9963.73"/>
</g>
<!-- mha_v_10 -->
<g id="node328" class="node">
<title>mha_v_10</title>
<polygon fill="lightblue" stroke="black" points="1127,-9965.18 791,-9965.18 791,-9912.18 1127,-9912.18 1127,-9965.18"/>
<text text-anchor="middle" x="959" y="-9949.98" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="959" y="-9934.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="959" y="-9919.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_v_10 -->
<g id="edge508" class="edge">
<title>ln1_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M1021.78,-10001.75C1012.54,-9992.62 1002.04,-9982.24 992.3,-9972.61"/>
<polygon fill="black" stroke="black" points="994.61,-9969.96 985.03,-9965.42 989.68,-9974.94 994.61,-9969.96"/>
</g>
<!-- mha_attn_10 -->
<g id="node329" class="node">
<title>mha_attn_10</title>
<polygon fill="lightblue" stroke="black" points="1110,-9875.18 940,-9875.18 940,-9822.18 1110,-9822.18 1110,-9875.18"/>
<text text-anchor="middle" x="1025" y="-9859.98" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1025" y="-9844.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1025" y="-9829.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge509" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1229.31,-9912.11C1194.7,-9901.53 1154.41,-9889.22 1118.81,-9878.34"/>
<polygon fill="black" stroke="black" points="1119.48,-9874.89 1108.9,-9875.32 1117.44,-9881.59 1119.48,-9874.89"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge510" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M726.76,-9912.17C791.47,-9898.61 869.84,-9882.19 930,-9869.59"/>
<polygon fill="black" stroke="black" points="930.81,-9872.99 939.88,-9867.52 929.37,-9866.14 930.81,-9872.99"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge511" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M978.45,-9911.75C985.09,-9902.89 992.63,-9892.85 999.67,-9883.46"/>
<polygon fill="black" stroke="black" points="1002.49,-9885.52 1005.69,-9875.42 996.89,-9881.32 1002.49,-9885.52"/>
</g>
<!-- mha_out_10 -->
<g id="node330" class="node">
<title>mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="1393,-9785.18 1057,-9785.18 1057,-9732.18 1393,-9732.18 1393,-9785.18"/>
<text text-anchor="middle" x="1225" y="-9769.98" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1225" y="-9754.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1225" y="-9739.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge512" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M1083.12,-9822.11C1106.33,-9811.9 1133.22,-9800.06 1157.31,-9789.46"/>
<polygon fill="black" stroke="black" points="1158.99,-9792.55 1166.74,-9785.32 1156.18,-9786.14 1158.99,-9792.55"/>
</g>
<!-- residual1_10 -->
<g id="node331" class="node">
<title>residual1_10</title>
<polygon fill="lightcoral" stroke="black" points="1768.86,-9695.18 1199.58,-9695.18 1053.14,-9589.18 1622.42,-9589.18 1768.86,-9695.18"/>
<text text-anchor="middle" x="1411" y="-9653.48" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1411" y="-9638.48" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1411" y="-9623.48" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge514" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1266.74,-9731.98C1281.93,-9722.64 1299.77,-9711.65 1317.63,-9700.66"/>
<polygon fill="black" stroke="black" points="1319.7,-9703.49 1326.38,-9695.27 1316.03,-9697.53 1319.7,-9703.49"/>
</g>
<!-- ln2_10 -->
<g id="node332" class="node">
<title>ln2_10</title>
<polygon fill="lightyellow" stroke="black" points="2793,-9552.18 2623,-9552.18 2623,-9499.18 2793,-9499.18 2793,-9552.18"/>
<text text-anchor="middle" x="2708" y="-9536.98" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2708" y="-9521.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2708" y="-9506.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge515" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M1663.77,-9618.87C1953.74,-9593.27 2414.62,-9552.58 2612.56,-9535.11"/>
<polygon fill="black" stroke="black" points="2612.99,-9538.58 2622.64,-9534.22 2612.37,-9531.61 2612.99,-9538.58"/>
</g>
<!-- residual2_10 -->
<g id="node359" class="node">
<title>residual2_10</title>
<polygon fill="lightcoral" stroke="black" points="1768.86,-8847.18 1199.58,-8847.18 1053.14,-8741.18 1622.42,-8741.18 1768.86,-8847.18"/>
<text text-anchor="middle" x="1411" y="-8805.48" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1411" y="-8790.48" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1411" y="-8775.48" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge558" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1403.23,-9589.15C1400.92,-9569.61 1399,-9547.17 1399,-9526.68 1399,-9526.68 1399,-9526.68 1399,-8951.18 1399,-8920.34 1401.36,-8886.16 1403.99,-8857.68"/>
<polygon fill="black" stroke="black" points="1407.5,-8857.75 1404.96,-8847.46 1400.53,-8857.08 1407.5,-8857.75"/>
</g>
<!-- gate_10 -->
<g id="node333" class="node">
<title>gate_10</title>
<polygon fill="orange" stroke="black" points="2877,-9462.18 2568,-9409.18 2877,-9356.18 3186,-9409.18 2877,-9462.18"/>
<text text-anchor="middle" x="2877" y="-9420.48" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2877" y="-9405.48" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2877" y="-9390.48" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;gate_10 -->
<g id="edge516" class="edge">
<title>ln2_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M2745.93,-9498.98C2764.05,-9486.7 2786.34,-9471.6 2807.36,-9457.36"/>
<polygon fill="black" stroke="black" points="2809.34,-9460.25 2815.65,-9451.74 2805.41,-9454.46 2809.34,-9460.25"/>
</g>
<!-- expert_10_0 -->
<g id="node334" class="node">
<title>expert_10_0</title>
<polygon fill="lightcyan" stroke="black" points="2134.5,-9305.18 1789.5,-9305.18 1789.5,-9237.18 2134.5,-9237.18 2134.5,-9305.18"/>
<text text-anchor="middle" x="1962" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1962" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1962" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1962" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_0 -->
<g id="edge518" class="edge">
<title>ln2_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" d="M2622.98,-9521.69C2482.02,-9512.74 2196.79,-9477.38 2008,-9338.18 1999.05,-9331.58 1991.22,-9322.7 1984.67,-9313.6"/>
<polygon fill="black" stroke="black" points="1987.52,-9311.57 1979.03,-9305.24 1981.72,-9315.48 1987.52,-9311.57"/>
</g>
<!-- expert_10_1 -->
<g id="node337" class="node">
<title>expert_10_1</title>
<polygon fill="lightcyan" stroke="black" points="3260.5,-9305.18 2915.5,-9305.18 2915.5,-9237.18 3260.5,-9237.18 3260.5,-9305.18"/>
<text text-anchor="middle" x="3088" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3088" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3088" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3088" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_1 -->
<g id="edge523" class="edge">
<title>ln2_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" d="M2793.19,-9519.65C2925.57,-9510.97 3168.35,-9491.27 3195,-9462.18 3236.76,-9416.6 3233.45,-9375.17 3200,-9323.18 3197.46,-9319.23 3194.53,-9315.59 3191.3,-9312.22"/>
<polygon fill="black" stroke="black" points="3193.5,-9309.49 3183.77,-9305.29 3188.76,-9314.64 3193.5,-9309.49"/>
</g>
<!-- expert_10_2 -->
<g id="node340" class="node">
<title>expert_10_2</title>
<polygon fill="lightcyan" stroke="black" points="3986.5,-9305.18 3641.5,-9305.18 3641.5,-9237.18 3986.5,-9237.18 3986.5,-9305.18"/>
<text text-anchor="middle" x="3814" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3814" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3814" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3814" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_2 -->
<g id="edge528" class="edge">
<title>ln2_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" d="M2793.15,-9518.65C2889.25,-9511.46 3050.15,-9498.23 3188,-9481.18 3456.63,-9447.95 3568.89,-9507.59 3780,-9338.18 3787.76,-9331.95 3793.93,-9323.48 3798.77,-9314.68"/>
<polygon fill="black" stroke="black" points="3802.02,-9315.99 3803.33,-9305.48 3795.75,-9312.88 3802.02,-9315.99"/>
</g>
<!-- expert_10_3 -->
<g id="node343" class="node">
<title>expert_10_3</title>
<polygon fill="lightcyan" stroke="black" points="1771.5,-9305.18 1426.5,-9305.18 1426.5,-9237.18 1771.5,-9237.18 1771.5,-9305.18"/>
<text text-anchor="middle" x="1599" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1599" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1599" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1599" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_3 -->
<g id="edge533" class="edge">
<title>ln2_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" d="M2622.73,-9525.56C2492.73,-9524.96 2238.12,-9516.11 2030,-9462.18 1895.2,-9427.25 1749.02,-9354.71 1666.25,-9310.06"/>
<polygon fill="black" stroke="black" points="1667.92,-9306.99 1657.46,-9305.3 1664.58,-9313.14 1667.92,-9306.99"/>
</g>
<!-- expert_10_4 -->
<g id="node346" class="node">
<title>expert_10_4</title>
<polygon fill="lightcyan" stroke="black" points="3623.5,-9305.18 3278.5,-9305.18 3278.5,-9237.18 3623.5,-9237.18 3623.5,-9305.18"/>
<text text-anchor="middle" x="3451" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3451" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3451" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3451" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_4 -->
<g id="edge538" class="edge">
<title>ln2_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" d="M2793.24,-9521.82C2920.1,-9516.31 3151.45,-9501.13 3224,-9462.18 3298.26,-9422.31 3370.54,-9355.54 3412.9,-9312.7"/>
<polygon fill="black" stroke="black" points="3415.44,-9315.11 3419.95,-9305.52 3410.45,-9310.21 3415.44,-9315.11"/>
</g>
<!-- expert_10_5 -->
<g id="node349" class="node">
<title>expert_10_5</title>
<polygon fill="lightcyan" stroke="black" points="4349.5,-9305.18 4004.5,-9305.18 4004.5,-9237.18 4349.5,-9237.18 4349.5,-9305.18"/>
<text text-anchor="middle" x="4177" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4177" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4177" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4177" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_5 -->
<g id="edge543" class="edge">
<title>ln2_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" d="M2793.22,-9521.9C2991.12,-9514.96 3477.08,-9495.06 3637,-9462.18 3804.02,-9427.85 3989.72,-9354.19 4094.04,-9309.34"/>
<polygon fill="black" stroke="black" points="4095.46,-9312.54 4103.26,-9305.36 4092.69,-9306.11 4095.46,-9312.54"/>
</g>
<!-- expert_10_6 -->
<g id="node352" class="node">
<title>expert_10_6</title>
<polygon fill="lightcyan" stroke="black" points="2497.5,-9305.18 2152.5,-9305.18 2152.5,-9237.18 2497.5,-9237.18 2497.5,-9305.18"/>
<text text-anchor="middle" x="2325" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2325" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2325" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2325" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_6 -->
<g id="edge548" class="edge">
<title>ln2_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" d="M2622.67,-9500.35C2605.35,-9494.65 2587.42,-9488.17 2571,-9481.18 2482.41,-9443.47 2401.93,-9362.24 2358.57,-9312.89"/>
<polygon fill="black" stroke="black" points="2361.14,-9310.51 2351.94,-9305.26 2355.86,-9315.1 2361.14,-9310.51"/>
</g>
<!-- expert_10_7 -->
<g id="node355" class="node">
<title>expert_10_7</title>
<polygon fill="lightcyan" stroke="black" points="2860.5,-9305.18 2515.5,-9305.18 2515.5,-9237.18 2860.5,-9237.18 2860.5,-9305.18"/>
<text text-anchor="middle" x="2688" y="-9289.98" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2688" y="-9274.98" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2688" y="-9259.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2688" y="-9244.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;expert_10_7 -->
<g id="edge553" class="edge">
<title>ln2_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" d="M2622.84,-9507.94C2598.08,-9498.7 2573.76,-9484.37 2559,-9462.18 2532.91,-9422.95 2536.55,-9397.6 2559,-9356.18 2568.96,-9337.81 2584.87,-9322.82 2602.17,-9310.87"/>
<polygon fill="black" stroke="black" points="2604.31,-9313.65 2610.76,-9305.24 2600.48,-9307.79 2604.31,-9313.65"/>
</g>
<!-- gate_10&#45;&gt;expert_10_0 -->
<g id="edge517" class="edge">
<title>gate_10&#45;&gt;expert_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2703.8,-9385.82C2557.55,-9366.47 2342.39,-9336.92 2144.88,-9305.3"/>
<polygon fill="black" stroke="black" points="2145.32,-9301.83 2134.89,-9303.7 2144.21,-9308.74 2145.32,-9301.83"/>
<text text-anchor="middle" x="2389.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_1 -->
<g id="edge522" class="edge">
<title>gate_10&#45;&gt;expert_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2927.59,-9364.85C2945.19,-9350.74 2965.43,-9335.54 2985,-9323.18 2992.09,-9318.7 2999.64,-9314.32 3007.29,-9310.12"/>
<polygon fill="black" stroke="black" points="3009.15,-9313.09 3016.3,-9305.28 3005.83,-9306.93 3009.15,-9313.09"/>
<text text-anchor="middle" x="3030.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_2 -->
<g id="edge527" class="edge">
<title>gate_10&#45;&gt;expert_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3053.38,-9386.43C3204.34,-9367.28 3427.64,-9337.68 3631.12,-9305.46"/>
<polygon fill="black" stroke="black" points="3631.78,-9308.9 3641.1,-9303.88 3630.68,-9301.99 3631.78,-9308.9"/>
<text text-anchor="middle" x="3554.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_3 -->
<g id="edge532" class="edge">
<title>gate_10&#45;&gt;expert_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2660.35,-9393.32C2441.19,-9377.02 2092.59,-9347.59 1781.97,-9305.28"/>
<polygon fill="black" stroke="black" points="1782.24,-9301.78 1771.86,-9303.89 1781.29,-9308.72 1782.24,-9301.78"/>
<text text-anchor="middle" x="2095.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_4 -->
<g id="edge537" class="edge">
<title>gate_10&#45;&gt;expert_10_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2981.92,-9374.17C3036.43,-9357.3 3104.37,-9337.53 3166,-9323.18 3208.74,-9313.23 3222.11,-9313.33 3268.09,-9305.48"/>
<polygon fill="black" stroke="black" points="3268.83,-9308.91 3278.08,-9303.74 3267.63,-9302.01 3268.83,-9308.91"/>
<text text-anchor="middle" x="3211.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_5 -->
<g id="edge542" class="edge">
<title>gate_10&#45;&gt;expert_10_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3096.36,-9393.76C3320.02,-9377.72 3677.04,-9348.42 3993.82,-9305.45"/>
<polygon fill="black" stroke="black" points="3994.69,-9308.86 4004.13,-9304.04 3993.75,-9301.92 3994.69,-9308.86"/>
<text text-anchor="middle" x="3889.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_6 -->
<g id="edge547" class="edge">
<title>gate_10&#45;&gt;expert_10_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2752.43,-9377.49C2668.3,-9356.76 2556.98,-9329.33 2469.03,-9307.67"/>
<polygon fill="black" stroke="black" points="2469.79,-9304.25 2459.25,-9305.26 2468.12,-9311.05 2469.79,-9304.25"/>
<text text-anchor="middle" x="2629.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_10&#45;&gt;expert_10_7 -->
<g id="edge552" class="edge">
<title>gate_10&#45;&gt;expert_10_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2818.49,-9366.08C2794.15,-9348.57 2766.06,-9328.35 2742.2,-9311.18"/>
<polygon fill="black" stroke="black" points="2744.11,-9308.24 2733.94,-9305.24 2740.02,-9313.92 2744.11,-9308.24"/>
<text text-anchor="middle" x="2821.5" y="-9326.98" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_10 -->
<g id="node358" class="node">
<title>expert_agg_10</title>
<polygon fill="lightpink" stroke="black" points="3054.86,-9020.18 2709.88,-9020.18 2621.14,-8884.18 2966.12,-8884.18 3054.86,-9020.18"/>
<text text-anchor="middle" x="2838" y="-8970.98" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2838" y="-8955.98" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2838" y="-8940.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2838" y="-8925.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- gate_10&#45;&gt;expert_agg_10 -->
<g id="edge557" class="edge">
<title>gate_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2883.11,-9356.92C2885.64,-9331.48 2888,-9300.25 2888,-9272.18 2888,-9272.18 2888,-9272.18 2888,-9082.68 2888,-9065.05 2883.92,-9046.93 2878.09,-9030.03"/>
<polygon fill="black" stroke="black" points="2881.22,-9028.4 2874.47,-9020.23 2874.65,-9030.82 2881.22,-9028.4"/>
<text text-anchor="middle" x="2916.5" y="-9169.98" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_10_0 -->
<g id="node335" class="node">
<title>expert_gelu_10_0</title>
<polygon fill="lightcyan" stroke="black" points="2051.5,-9200.18 1872.5,-9200.18 1872.5,-9147.18 2051.5,-9147.18 2051.5,-9200.18"/>
<text text-anchor="middle" x="1962" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1962" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1962" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_0&#45;&gt;expert_gelu_10_0 -->
<g id="edge519" class="edge">
<title>expert_10_0&#45;&gt;expert_gelu_10_0</title>
<path fill="none" stroke="black" d="M1962,-9237.05C1962,-9228.47 1962,-9219.19 1962,-9210.48"/>
<polygon fill="black" stroke="black" points="1965.5,-9210.23 1962,-9200.23 1958.5,-9210.23 1965.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_0 -->
<g id="node336" class="node">
<title>expert_ffn2_10_0</title>
<polygon fill="lightcyan" stroke="black" points="2134.5,-9110.18 1789.5,-9110.18 1789.5,-9057.18 2134.5,-9057.18 2134.5,-9110.18"/>
<text text-anchor="middle" x="1962" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="1962" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1962" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_0&#45;&gt;expert_ffn2_10_0 -->
<g id="edge520" class="edge">
<title>expert_gelu_10_0&#45;&gt;expert_ffn2_10_0</title>
<path fill="none" stroke="black" d="M1962,-9146.75C1962,-9138.52 1962,-9129.26 1962,-9120.46"/>
<polygon fill="black" stroke="black" points="1965.5,-9120.42 1962,-9110.42 1958.5,-9120.42 1965.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_0&#45;&gt;expert_agg_10 -->
<g id="edge521" class="edge">
<title>expert_ffn2_10_0&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M2134.55,-9057.17C2290.13,-9034.17 2517.48,-9000.56 2671.25,-8977.83"/>
<polygon fill="black" stroke="black" points="2671.89,-8981.28 2681.27,-8976.35 2670.86,-8974.35 2671.89,-8981.28"/>
</g>
<!-- expert_gelu_10_1 -->
<g id="node338" class="node">
<title>expert_gelu_10_1</title>
<polygon fill="lightcyan" stroke="black" points="3177.5,-9200.18 2998.5,-9200.18 2998.5,-9147.18 3177.5,-9147.18 3177.5,-9200.18"/>
<text text-anchor="middle" x="3088" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3088" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3088" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_1&#45;&gt;expert_gelu_10_1 -->
<g id="edge524" class="edge">
<title>expert_10_1&#45;&gt;expert_gelu_10_1</title>
<path fill="none" stroke="black" d="M3088,-9237.05C3088,-9228.47 3088,-9219.19 3088,-9210.48"/>
<polygon fill="black" stroke="black" points="3091.5,-9210.23 3088,-9200.23 3084.5,-9210.23 3091.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_1 -->
<g id="node339" class="node">
<title>expert_ffn2_10_1</title>
<polygon fill="lightcyan" stroke="black" points="3260.5,-9110.18 2915.5,-9110.18 2915.5,-9057.18 3260.5,-9057.18 3260.5,-9110.18"/>
<text text-anchor="middle" x="3088" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3088" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3088" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_1&#45;&gt;expert_ffn2_10_1 -->
<g id="edge525" class="edge">
<title>expert_gelu_10_1&#45;&gt;expert_ffn2_10_1</title>
<path fill="none" stroke="black" d="M3088,-9146.75C3088,-9138.52 3088,-9129.26 3088,-9120.46"/>
<polygon fill="black" stroke="black" points="3091.5,-9120.42 3088,-9110.42 3084.5,-9120.42 3091.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_1&#45;&gt;expert_agg_10 -->
<g id="edge526" class="edge">
<title>expert_ffn2_10_1&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M3038.61,-9057.1C3020.33,-9047.63 2998.6,-9036.37 2976.29,-9024.82"/>
<polygon fill="black" stroke="black" points="2977.88,-9021.69 2967.39,-9020.2 2974.66,-9027.91 2977.88,-9021.69"/>
</g>
<!-- expert_gelu_10_2 -->
<g id="node341" class="node">
<title>expert_gelu_10_2</title>
<polygon fill="lightcyan" stroke="black" points="3903.5,-9200.18 3724.5,-9200.18 3724.5,-9147.18 3903.5,-9147.18 3903.5,-9200.18"/>
<text text-anchor="middle" x="3814" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3814" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3814" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_2&#45;&gt;expert_gelu_10_2 -->
<g id="edge529" class="edge">
<title>expert_10_2&#45;&gt;expert_gelu_10_2</title>
<path fill="none" stroke="black" d="M3814,-9237.05C3814,-9228.47 3814,-9219.19 3814,-9210.48"/>
<polygon fill="black" stroke="black" points="3817.5,-9210.23 3814,-9200.23 3810.5,-9210.23 3817.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_2 -->
<g id="node342" class="node">
<title>expert_ffn2_10_2</title>
<polygon fill="lightcyan" stroke="black" points="3986.5,-9110.18 3641.5,-9110.18 3641.5,-9057.18 3986.5,-9057.18 3986.5,-9110.18"/>
<text text-anchor="middle" x="3814" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3814" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3814" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_2&#45;&gt;expert_ffn2_10_2 -->
<g id="edge530" class="edge">
<title>expert_gelu_10_2&#45;&gt;expert_ffn2_10_2</title>
<path fill="none" stroke="black" d="M3814,-9146.75C3814,-9138.52 3814,-9129.26 3814,-9120.46"/>
<polygon fill="black" stroke="black" points="3817.5,-9120.42 3814,-9110.42 3810.5,-9120.42 3817.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_2&#45;&gt;expert_agg_10 -->
<g id="edge531" class="edge">
<title>expert_ffn2_10_2&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M3641.08,-9058.28C3638.37,-9057.91 3635.67,-9057.54 3633,-9057.18 3430.18,-9029.63 3198.06,-8999.41 3037.22,-8978.69"/>
<polygon fill="black" stroke="black" points="3037.58,-8975.2 3027.21,-8977.4 3036.68,-8982.15 3037.58,-8975.2"/>
</g>
<!-- expert_gelu_10_3 -->
<g id="node344" class="node">
<title>expert_gelu_10_3</title>
<polygon fill="lightcyan" stroke="black" points="1688.5,-9200.18 1509.5,-9200.18 1509.5,-9147.18 1688.5,-9147.18 1688.5,-9200.18"/>
<text text-anchor="middle" x="1599" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1599" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1599" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_3&#45;&gt;expert_gelu_10_3 -->
<g id="edge534" class="edge">
<title>expert_10_3&#45;&gt;expert_gelu_10_3</title>
<path fill="none" stroke="black" d="M1599,-9237.05C1599,-9228.47 1599,-9219.19 1599,-9210.48"/>
<polygon fill="black" stroke="black" points="1602.5,-9210.23 1599,-9200.23 1595.5,-9210.23 1602.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_3 -->
<g id="node345" class="node">
<title>expert_ffn2_10_3</title>
<polygon fill="lightcyan" stroke="black" points="1771.5,-9110.18 1426.5,-9110.18 1426.5,-9057.18 1771.5,-9057.18 1771.5,-9110.18"/>
<text text-anchor="middle" x="1599" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1599" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1599" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_3&#45;&gt;expert_ffn2_10_3 -->
<g id="edge535" class="edge">
<title>expert_gelu_10_3&#45;&gt;expert_ffn2_10_3</title>
<path fill="none" stroke="black" d="M1599,-9146.75C1599,-9138.52 1599,-9129.26 1599,-9120.46"/>
<polygon fill="black" stroke="black" points="1602.5,-9120.42 1599,-9110.42 1595.5,-9120.42 1602.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_3&#45;&gt;expert_agg_10 -->
<g id="edge536" class="edge">
<title>expert_ffn2_10_3&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M1771.9,-9058.28C1774.95,-9057.91 1777.99,-9057.54 1781,-9057.18 2091.75,-9020.14 2455.05,-8986.5 2664.63,-8968.04"/>
<polygon fill="black" stroke="black" points="2665.15,-8971.5 2674.81,-8967.14 2664.54,-8964.53 2665.15,-8971.5"/>
</g>
<!-- expert_gelu_10_4 -->
<g id="node347" class="node">
<title>expert_gelu_10_4</title>
<polygon fill="lightcyan" stroke="black" points="3540.5,-9200.18 3361.5,-9200.18 3361.5,-9147.18 3540.5,-9147.18 3540.5,-9200.18"/>
<text text-anchor="middle" x="3451" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3451" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3451" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_4&#45;&gt;expert_gelu_10_4 -->
<g id="edge539" class="edge">
<title>expert_10_4&#45;&gt;expert_gelu_10_4</title>
<path fill="none" stroke="black" d="M3451,-9237.05C3451,-9228.47 3451,-9219.19 3451,-9210.48"/>
<polygon fill="black" stroke="black" points="3454.5,-9210.23 3451,-9200.23 3447.5,-9210.23 3454.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_4 -->
<g id="node348" class="node">
<title>expert_ffn2_10_4</title>
<polygon fill="lightcyan" stroke="black" points="3623.5,-9110.18 3278.5,-9110.18 3278.5,-9057.18 3623.5,-9057.18 3623.5,-9110.18"/>
<text text-anchor="middle" x="3451" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3451" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3451" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_4&#45;&gt;expert_ffn2_10_4 -->
<g id="edge540" class="edge">
<title>expert_gelu_10_4&#45;&gt;expert_ffn2_10_4</title>
<path fill="none" stroke="black" d="M3451,-9146.75C3451,-9138.52 3451,-9129.26 3451,-9120.46"/>
<polygon fill="black" stroke="black" points="3454.5,-9120.42 3451,-9110.42 3447.5,-9120.42 3454.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_4&#45;&gt;expert_agg_10 -->
<g id="edge541" class="edge">
<title>expert_ffn2_10_4&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M3330.26,-9057.17C3250.16,-9040.25 3142.9,-9017.59 3048.95,-8997.74"/>
<polygon fill="black" stroke="black" points="3049.53,-8994.29 3039.02,-8995.65 3048.08,-9001.14 3049.53,-8994.29"/>
</g>
<!-- expert_gelu_10_5 -->
<g id="node350" class="node">
<title>expert_gelu_10_5</title>
<polygon fill="lightcyan" stroke="black" points="4266.5,-9200.18 4087.5,-9200.18 4087.5,-9147.18 4266.5,-9147.18 4266.5,-9200.18"/>
<text text-anchor="middle" x="4177" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4177" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4177" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_5&#45;&gt;expert_gelu_10_5 -->
<g id="edge544" class="edge">
<title>expert_10_5&#45;&gt;expert_gelu_10_5</title>
<path fill="none" stroke="black" d="M4177,-9237.05C4177,-9228.47 4177,-9219.19 4177,-9210.48"/>
<polygon fill="black" stroke="black" points="4180.5,-9210.23 4177,-9200.23 4173.5,-9210.23 4180.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_5 -->
<g id="node351" class="node">
<title>expert_ffn2_10_5</title>
<polygon fill="lightcyan" stroke="black" points="4349.5,-9110.18 4004.5,-9110.18 4004.5,-9057.18 4349.5,-9057.18 4349.5,-9110.18"/>
<text text-anchor="middle" x="4177" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4177" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4177" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_5&#45;&gt;expert_ffn2_10_5 -->
<g id="edge545" class="edge">
<title>expert_gelu_10_5&#45;&gt;expert_ffn2_10_5</title>
<path fill="none" stroke="black" d="M4177,-9146.75C4177,-9138.52 4177,-9129.26 4177,-9120.46"/>
<polygon fill="black" stroke="black" points="4180.5,-9120.42 4177,-9110.42 4173.5,-9120.42 4180.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_5&#45;&gt;expert_agg_10 -->
<g id="edge546" class="edge">
<title>expert_ffn2_10_5&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M4004.1,-9058.13C4001.38,-9057.81 3998.68,-9057.49 3996,-9057.18 3656.89,-9018.09 3260.48,-8985.26 3030.45,-8967.48"/>
<polygon fill="black" stroke="black" points="3030.54,-8963.98 3020.3,-8966.7 3030.01,-8970.96 3030.54,-8963.98"/>
</g>
<!-- expert_gelu_10_6 -->
<g id="node353" class="node">
<title>expert_gelu_10_6</title>
<polygon fill="lightcyan" stroke="black" points="2414.5,-9200.18 2235.5,-9200.18 2235.5,-9147.18 2414.5,-9147.18 2414.5,-9200.18"/>
<text text-anchor="middle" x="2325" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2325" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2325" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_6&#45;&gt;expert_gelu_10_6 -->
<g id="edge549" class="edge">
<title>expert_10_6&#45;&gt;expert_gelu_10_6</title>
<path fill="none" stroke="black" d="M2325,-9237.05C2325,-9228.47 2325,-9219.19 2325,-9210.48"/>
<polygon fill="black" stroke="black" points="2328.5,-9210.23 2325,-9200.23 2321.5,-9210.23 2328.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_6 -->
<g id="node354" class="node">
<title>expert_ffn2_10_6</title>
<polygon fill="lightcyan" stroke="black" points="2497.5,-9110.18 2152.5,-9110.18 2152.5,-9057.18 2497.5,-9057.18 2497.5,-9110.18"/>
<text text-anchor="middle" x="2325" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2325" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2325" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_6&#45;&gt;expert_ffn2_10_6 -->
<g id="edge550" class="edge">
<title>expert_gelu_10_6&#45;&gt;expert_ffn2_10_6</title>
<path fill="none" stroke="black" d="M2325,-9146.75C2325,-9138.52 2325,-9129.26 2325,-9120.46"/>
<polygon fill="black" stroke="black" points="2328.5,-9120.42 2325,-9110.42 2321.5,-9120.42 2328.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_6&#45;&gt;expert_agg_10 -->
<g id="edge551" class="edge">
<title>expert_ffn2_10_6&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M2426.05,-9057.17C2498.49,-9038.89 2597.49,-9013.89 2680.28,-8992.99"/>
<polygon fill="black" stroke="black" points="2681.2,-8996.37 2690.04,-8990.53 2679.49,-8989.59 2681.2,-8996.37"/>
</g>
<!-- expert_gelu_10_7 -->
<g id="node356" class="node">
<title>expert_gelu_10_7</title>
<polygon fill="lightcyan" stroke="black" points="2777.5,-9200.18 2598.5,-9200.18 2598.5,-9147.18 2777.5,-9147.18 2777.5,-9200.18"/>
<text text-anchor="middle" x="2688" y="-9184.98" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2688" y="-9169.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2688" y="-9154.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_10_7&#45;&gt;expert_gelu_10_7 -->
<g id="edge554" class="edge">
<title>expert_10_7&#45;&gt;expert_gelu_10_7</title>
<path fill="none" stroke="black" d="M2688,-9237.05C2688,-9228.47 2688,-9219.19 2688,-9210.48"/>
<polygon fill="black" stroke="black" points="2691.5,-9210.23 2688,-9200.23 2684.5,-9210.23 2691.5,-9210.23"/>
</g>
<!-- expert_ffn2_10_7 -->
<g id="node357" class="node">
<title>expert_ffn2_10_7</title>
<polygon fill="lightcyan" stroke="black" points="2860.5,-9110.18 2515.5,-9110.18 2515.5,-9057.18 2860.5,-9057.18 2860.5,-9110.18"/>
<text text-anchor="middle" x="2688" y="-9094.98" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2688" y="-9079.98" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2688" y="-9064.98" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- expert_gelu_10_7&#45;&gt;expert_ffn2_10_7 -->
<g id="edge555" class="edge">
<title>expert_gelu_10_7&#45;&gt;expert_ffn2_10_7</title>
<path fill="none" stroke="black" d="M2688,-9146.75C2688,-9138.52 2688,-9129.26 2688,-9120.46"/>
<polygon fill="black" stroke="black" points="2691.5,-9120.42 2688,-9110.42 2684.5,-9120.42 2691.5,-9120.42"/>
</g>
<!-- expert_ffn2_10_7&#45;&gt;expert_agg_10 -->
<g id="edge556" class="edge">
<title>expert_ffn2_10_7&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="black" d="M2717.64,-9057.1C2727.89,-9048.24 2739.95,-9037.83 2752.41,-9027.07"/>
<polygon fill="black" stroke="black" points="2754.93,-9029.52 2760.21,-9020.34 2750.35,-9024.22 2754.93,-9029.52"/>
</g>
<!-- expert_agg_10&#45;&gt;residual2_10 -->
<g id="edge559" class="edge">
<title>expert_agg_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M2651.44,-8930.79C2425.22,-8906.06 2039.3,-8863.87 1757.87,-8833.1"/>
<polygon fill="black" stroke="black" points="1758.23,-8829.62 1747.91,-8832.01 1757.47,-8836.58 1758.23,-8829.62"/>
</g>
<!-- comm_10_11 -->
<g id="node396" class="node">
<title>comm_10_11</title>
<ellipse fill="lightgreen" stroke="black" cx="1411" cy="-8677.31" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1411" y="-8681.11" font-family="Times,serif" font-size="14.00">GPU 9 → GPU 10</text>
<text text-anchor="middle" x="1411" y="-8666.11" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_10&#45;&gt;comm_10_11 -->
<g id="edge560" class="edge">
<title>residual2_10&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M1411,-8741.12C1411,-8732.19 1411,-8723.08 1411,-8714.68"/>
<polygon fill="black" stroke="black" points="1414.5,-8714.47 1411,-8704.47 1407.5,-8714.47 1414.5,-8714.47"/>
</g>
<!-- comm_9_10&#45;&gt;ln1_10 -->
<g id="edge505" class="edge">
<title>comm_9_10&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M1219.37,-10095.52C1190.42,-10084.4 1155.14,-10070.85 1124.13,-10058.93"/>
<polygon fill="black" stroke="black" points="1125.25,-10055.61 1114.66,-10055.29 1122.74,-10062.15 1125.25,-10055.61"/>
</g>
<!-- comm_9_10&#45;&gt;residual1_10 -->
<g id="edge513" class="edge">
<title>comm_9_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1367.31,-10100.95C1432.31,-10085.86 1509,-10061.35 1509,-10029.68 1509,-10029.68 1509,-10029.68 1509,-9757.68 1509,-9737.63 1500.22,-9719.32 1487.91,-9703.51"/>
<polygon fill="black" stroke="black" points="1490.28,-9700.89 1481.18,-9695.47 1484.92,-9705.39 1490.28,-9700.89"/>
</g>
<!-- ln1_11 -->
<g id="node361" class="node">
<title>ln1_11</title>
<polygon fill="lightyellow" stroke="black" points="1269,-8613.44 1099,-8613.44 1099,-8560.44 1269,-8560.44 1269,-8613.44"/>
<text text-anchor="middle" x="1184" y="-8598.24" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1184" y="-8583.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1184" y="-8568.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_q_11 -->
<g id="node362" class="node">
<title>mha_q_11</title>
<polygon fill="lightblue" stroke="black" points="1528,-8523.44 1192,-8523.44 1192,-8470.44 1528,-8470.44 1528,-8523.44"/>
<text text-anchor="middle" x="1360" y="-8508.24" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1360" y="-8493.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1360" y="-8478.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_q_11 -->
<g id="edge562" class="edge">
<title>ln1_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M1235.38,-8560.25C1255.53,-8550.18 1278.8,-8538.54 1299.74,-8528.07"/>
<polygon fill="black" stroke="black" points="1301.48,-8531.11 1308.86,-8523.51 1298.35,-8524.85 1301.48,-8531.11"/>
</g>
<!-- mha_k_11 -->
<g id="node363" class="node">
<title>mha_k_11</title>
<polygon fill="lightblue" stroke="black" points="820,-8523.44 484,-8523.44 484,-8470.44 820,-8470.44 820,-8523.44"/>
<text text-anchor="middle" x="652" y="-8508.24" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="652" y="-8493.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="652" y="-8478.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_k_11 -->
<g id="edge563" class="edge">
<title>ln1_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M1098.82,-8571.85C1022.99,-8559.31 909.93,-8540.61 816.51,-8525.15"/>
<polygon fill="black" stroke="black" points="816.82,-8521.66 806.38,-8523.48 815.68,-8528.56 816.82,-8521.66"/>
</g>
<!-- mha_v_11 -->
<g id="node364" class="node">
<title>mha_v_11</title>
<polygon fill="lightblue" stroke="black" points="1174,-8523.44 838,-8523.44 838,-8470.44 1174,-8470.44 1174,-8523.44"/>
<text text-anchor="middle" x="1006" y="-8508.24" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1006" y="-8493.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1006" y="-8478.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_v_11 -->
<g id="edge564" class="edge">
<title>ln1_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M1132.04,-8560.25C1111.66,-8550.18 1088.12,-8538.54 1066.95,-8528.07"/>
<polygon fill="black" stroke="black" points="1068.24,-8524.8 1057.72,-8523.51 1065.13,-8531.08 1068.24,-8524.8"/>
</g>
<!-- mha_attn_11 -->
<g id="node365" class="node">
<title>mha_attn_11</title>
<polygon fill="lightblue" stroke="black" points="1177,-8433.44 1007,-8433.44 1007,-8380.44 1177,-8380.44 1177,-8433.44"/>
<text text-anchor="middle" x="1092" y="-8418.24" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1092" y="-8403.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1092" y="-8388.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge565" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1282.12,-8470.37C1250.05,-8459.84 1212.75,-8447.59 1179.72,-8436.74"/>
<polygon fill="black" stroke="black" points="1180.66,-8433.37 1170.07,-8433.58 1178.48,-8440.02 1180.66,-8433.37"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge566" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M779.56,-8470.43C848.94,-8456.55 933.3,-8439.68 996.87,-8426.97"/>
<polygon fill="black" stroke="black" points="997.77,-8430.36 1006.89,-8424.96 996.39,-8423.49 997.77,-8430.36"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge567" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1031.34,-8470.01C1040.26,-8460.88 1050.41,-8450.5 1059.82,-8440.87"/>
<polygon fill="black" stroke="black" points="1062.36,-8443.28 1066.84,-8433.68 1057.35,-8438.39 1062.36,-8443.28"/>
</g>
<!-- mha_out_11 -->
<g id="node366" class="node">
<title>mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="1522,-8343.44 1186,-8343.44 1186,-8290.44 1522,-8290.44 1522,-8343.44"/>
<text text-anchor="middle" x="1354" y="-8328.24" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1354" y="-8313.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1354" y="-8298.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge568" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M1168.13,-8380.37C1199.35,-8369.88 1235.64,-8357.69 1267.83,-8346.88"/>
<polygon fill="black" stroke="black" points="1269.31,-8350.08 1277.68,-8343.58 1267.08,-8343.44 1269.31,-8350.08"/>
</g>
<!-- residual1_11 -->
<g id="node367" class="node">
<title>residual1_11</title>
<polygon fill="lightcoral" stroke="black" points="1815.86,-8253.44 1246.58,-8253.44 1100.14,-8147.44 1669.42,-8147.44 1815.86,-8253.44"/>
<text text-anchor="middle" x="1458" y="-8211.74" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1458" y="-8196.74" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1458" y="-8181.74" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge570" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1377.34,-8290.24C1385.24,-8281.54 1394.43,-8271.43 1403.72,-8261.21"/>
<polygon fill="black" stroke="black" points="1406.34,-8263.52 1410.48,-8253.76 1401.16,-8258.81 1406.34,-8263.52"/>
</g>
<!-- ln2_11 -->
<g id="node368" class="node">
<title>ln2_11</title>
<polygon fill="lightyellow" stroke="black" points="2840,-8110.44 2670,-8110.44 2670,-8057.44 2840,-8057.44 2840,-8110.44"/>
<text text-anchor="middle" x="2755" y="-8095.24" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2755" y="-8080.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2755" y="-8065.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge571" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M1710.77,-8177.13C2000.74,-8151.53 2461.62,-8110.84 2659.56,-8093.37"/>
<polygon fill="black" stroke="black" points="2659.99,-8096.84 2669.64,-8092.48 2659.37,-8089.87 2659.99,-8096.84"/>
</g>
<!-- residual2_11 -->
<g id="node395" class="node">
<title>residual2_11</title>
<polygon fill="lightcoral" stroke="black" points="1815.86,-7405.44 1246.58,-7405.44 1100.14,-7299.44 1669.42,-7299.44 1815.86,-7405.44"/>
<text text-anchor="middle" x="1458" y="-7363.74" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1458" y="-7348.74" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1458" y="-7333.74" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge614" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1450.23,-8147.41C1447.92,-8127.86 1446,-8105.43 1446,-8084.94 1446,-8084.94 1446,-8084.94 1446,-7509.44 1446,-7478.6 1448.36,-7444.42 1450.99,-7415.94"/>
<polygon fill="black" stroke="black" points="1454.5,-7416.01 1451.96,-7405.72 1447.53,-7415.34 1454.5,-7416.01"/>
</g>
<!-- gate_11 -->
<g id="node369" class="node">
<title>gate_11</title>
<polygon fill="orange" stroke="black" points="2924,-8020.44 2615,-7967.44 2924,-7914.44 3233,-7967.44 2924,-8020.44"/>
<text text-anchor="middle" x="2924" y="-7978.74" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="2924" y="-7963.74" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="2924" y="-7948.74" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;gate_11 -->
<g id="edge572" class="edge">
<title>ln2_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M2792.93,-8057.24C2811.05,-8044.96 2833.34,-8029.86 2854.36,-8015.62"/>
<polygon fill="black" stroke="black" points="2856.34,-8018.51 2862.65,-8010 2852.41,-8012.72 2856.34,-8018.51"/>
</g>
<!-- expert_11_0 -->
<g id="node370" class="node">
<title>expert_11_0</title>
<polygon fill="lightcyan" stroke="black" points="2181.5,-7863.44 1836.5,-7863.44 1836.5,-7795.44 2181.5,-7795.44 2181.5,-7863.44"/>
<text text-anchor="middle" x="2009" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2009" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2009" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2009" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_0 -->
<g id="edge574" class="edge">
<title>ln2_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" d="M2669.9,-8079.64C2529.15,-8070.26 2244.6,-8034.27 2055,-7896.44 2046,-7889.9 2038.15,-7881.05 2031.61,-7871.95"/>
<polygon fill="black" stroke="black" points="2034.46,-7869.91 2025.97,-7863.58 2028.66,-7873.83 2034.46,-7869.91"/>
</g>
<!-- expert_11_1 -->
<g id="node373" class="node">
<title>expert_11_1</title>
<polygon fill="lightcyan" stroke="black" points="3307.5,-7863.44 2962.5,-7863.44 2962.5,-7795.44 3307.5,-7795.44 3307.5,-7863.44"/>
<text text-anchor="middle" x="3135" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3135" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3135" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3135" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_1 -->
<g id="edge579" class="edge">
<title>ln2_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" d="M2840.19,-8077.91C2972.57,-8069.23 3215.35,-8049.53 3242,-8020.44 3283.76,-7974.86 3280.45,-7933.43 3247,-7881.44 3244.46,-7877.49 3241.53,-7873.85 3238.3,-7870.48"/>
<polygon fill="black" stroke="black" points="3240.5,-7867.75 3230.77,-7863.55 3235.76,-7872.9 3240.5,-7867.75"/>
</g>
<!-- expert_11_2 -->
<g id="node376" class="node">
<title>expert_11_2</title>
<polygon fill="lightcyan" stroke="black" points="4033.5,-7863.44 3688.5,-7863.44 3688.5,-7795.44 4033.5,-7795.44 4033.5,-7863.44"/>
<text text-anchor="middle" x="3861" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3861" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3861" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3861" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_2 -->
<g id="edge584" class="edge">
<title>ln2_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" d="M2840.15,-8076.91C2936.25,-8069.72 3097.15,-8056.49 3235,-8039.44 3503.63,-8006.21 3615.89,-8065.85 3827,-7896.44 3834.76,-7890.21 3840.93,-7881.74 3845.77,-7872.94"/>
<polygon fill="black" stroke="black" points="3849.02,-7874.25 3850.33,-7863.74 3842.75,-7871.14 3849.02,-7874.25"/>
</g>
<!-- expert_11_3 -->
<g id="node379" class="node">
<title>expert_11_3</title>
<polygon fill="lightcyan" stroke="black" points="1818.5,-7863.44 1473.5,-7863.44 1473.5,-7795.44 1818.5,-7795.44 1818.5,-7863.44"/>
<text text-anchor="middle" x="1646" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1646" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1646" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1646" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_3 -->
<g id="edge589" class="edge">
<title>ln2_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" d="M2669.73,-8083.82C2539.73,-8083.22 2285.12,-8074.37 2077,-8020.44 1942.2,-7985.51 1796.02,-7912.97 1713.25,-7868.32"/>
<polygon fill="black" stroke="black" points="1714.92,-7865.24 1704.46,-7863.56 1711.58,-7871.4 1714.92,-7865.24"/>
</g>
<!-- expert_11_4 -->
<g id="node382" class="node">
<title>expert_11_4</title>
<polygon fill="lightcyan" stroke="black" points="3670.5,-7863.44 3325.5,-7863.44 3325.5,-7795.44 3670.5,-7795.44 3670.5,-7863.44"/>
<text text-anchor="middle" x="3498" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3498" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3498" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3498" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_4 -->
<g id="edge594" class="edge">
<title>ln2_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" d="M2840.24,-8080.08C2967.1,-8074.57 3198.45,-8059.39 3271,-8020.44 3345.26,-7980.57 3417.54,-7913.8 3459.9,-7870.96"/>
<polygon fill="black" stroke="black" points="3462.44,-7873.37 3466.95,-7863.78 3457.45,-7868.47 3462.44,-7873.37"/>
</g>
<!-- expert_11_5 -->
<g id="node385" class="node">
<title>expert_11_5</title>
<polygon fill="lightcyan" stroke="black" points="4396.5,-7863.44 4051.5,-7863.44 4051.5,-7795.44 4396.5,-7795.44 4396.5,-7863.44"/>
<text text-anchor="middle" x="4224" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4224" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4224" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4224" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_5 -->
<g id="edge599" class="edge">
<title>ln2_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" d="M2840.22,-8080.16C3038.12,-8073.22 3524.08,-8053.32 3684,-8020.44 3851.02,-7986.11 4036.72,-7912.45 4141.04,-7867.6"/>
<polygon fill="black" stroke="black" points="4142.46,-7870.8 4150.26,-7863.62 4139.69,-7864.37 4142.46,-7870.8"/>
</g>
<!-- expert_11_6 -->
<g id="node388" class="node">
<title>expert_11_6</title>
<polygon fill="lightcyan" stroke="black" points="2544.5,-7863.44 2199.5,-7863.44 2199.5,-7795.44 2544.5,-7795.44 2544.5,-7863.44"/>
<text text-anchor="middle" x="2372" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2372" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2372" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2372" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_6 -->
<g id="edge604" class="edge">
<title>ln2_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" d="M2669.67,-8058.61C2652.35,-8052.91 2634.42,-8046.43 2618,-8039.44 2518.2,-7996.96 2513.24,-7953.31 2432,-7881.44 2427.9,-7877.82 2423.62,-7874.08 2419.32,-7870.36"/>
<polygon fill="black" stroke="black" points="2421.43,-7867.56 2411.57,-7863.69 2416.86,-7872.86 2421.43,-7867.56"/>
</g>
<!-- expert_11_7 -->
<g id="node391" class="node">
<title>expert_11_7</title>
<polygon fill="lightcyan" stroke="black" points="2907.5,-7863.44 2562.5,-7863.44 2562.5,-7795.44 2907.5,-7795.44 2907.5,-7863.44"/>
<text text-anchor="middle" x="2735" y="-7848.24" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2735" y="-7833.24" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2735" y="-7818.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2735" y="-7803.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;expert_11_7 -->
<g id="edge609" class="edge">
<title>ln2_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" d="M2669.84,-8066.2C2645.08,-8056.96 2620.76,-8042.63 2606,-8020.44 2579.91,-7981.21 2583.55,-7955.86 2606,-7914.44 2615.96,-7896.07 2631.87,-7881.08 2649.17,-7869.13"/>
<polygon fill="black" stroke="black" points="2651.31,-7871.91 2657.76,-7863.5 2647.48,-7866.05 2651.31,-7871.91"/>
</g>
<!-- gate_11&#45;&gt;expert_11_0 -->
<g id="edge573" class="edge">
<title>gate_11&#45;&gt;expert_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2750.8,-7944.08C2604.55,-7924.73 2389.39,-7895.18 2191.88,-7863.56"/>
<polygon fill="black" stroke="black" points="2192.32,-7860.09 2181.89,-7861.96 2191.21,-7867 2192.32,-7860.09"/>
<text text-anchor="middle" x="2436.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_1 -->
<g id="edge578" class="edge">
<title>gate_11&#45;&gt;expert_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2974.59,-7923.11C2992.19,-7909 3012.43,-7893.8 3032,-7881.44 3039.09,-7876.96 3046.64,-7872.58 3054.29,-7868.38"/>
<polygon fill="black" stroke="black" points="3056.15,-7871.35 3063.3,-7863.54 3052.83,-7865.19 3056.15,-7871.35"/>
<text text-anchor="middle" x="3077.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_2 -->
<g id="edge583" class="edge">
<title>gate_11&#45;&gt;expert_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3100.38,-7944.69C3251.34,-7925.54 3474.64,-7895.94 3678.12,-7863.72"/>
<polygon fill="black" stroke="black" points="3678.78,-7867.16 3688.1,-7862.14 3677.68,-7860.25 3678.78,-7867.16"/>
<text text-anchor="middle" x="3601.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_3 -->
<g id="edge588" class="edge">
<title>gate_11&#45;&gt;expert_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2707.35,-7951.58C2488.19,-7935.28 2139.59,-7905.85 1828.97,-7863.54"/>
<polygon fill="black" stroke="black" points="1829.24,-7860.04 1818.86,-7862.15 1828.29,-7866.98 1829.24,-7860.04"/>
<text text-anchor="middle" x="2142.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_4 -->
<g id="edge593" class="edge">
<title>gate_11&#45;&gt;expert_11_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3028.92,-7932.43C3083.43,-7915.56 3151.37,-7895.79 3213,-7881.44 3255.74,-7871.49 3269.11,-7871.59 3315.09,-7863.74"/>
<polygon fill="black" stroke="black" points="3315.83,-7867.17 3325.08,-7862 3314.63,-7860.27 3315.83,-7867.17"/>
<text text-anchor="middle" x="3258.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_5 -->
<g id="edge598" class="edge">
<title>gate_11&#45;&gt;expert_11_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3143.36,-7952.02C3367.02,-7935.98 3724.04,-7906.68 4040.82,-7863.71"/>
<polygon fill="black" stroke="black" points="4041.69,-7867.12 4051.13,-7862.3 4040.75,-7860.18 4041.69,-7867.12"/>
<text text-anchor="middle" x="3936.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_6 -->
<g id="edge603" class="edge">
<title>gate_11&#45;&gt;expert_11_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2799.43,-7935.75C2715.3,-7915.02 2603.98,-7887.59 2516.03,-7865.93"/>
<polygon fill="black" stroke="black" points="2516.79,-7862.51 2506.25,-7863.52 2515.12,-7869.31 2516.79,-7862.51"/>
<text text-anchor="middle" x="2676.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_11&#45;&gt;expert_11_7 -->
<g id="edge608" class="edge">
<title>gate_11&#45;&gt;expert_11_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2865.49,-7924.34C2841.15,-7906.83 2813.06,-7886.61 2789.2,-7869.44"/>
<polygon fill="black" stroke="black" points="2791.11,-7866.5 2780.94,-7863.5 2787.02,-7872.18 2791.11,-7866.5"/>
<text text-anchor="middle" x="2868.5" y="-7885.24" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_11 -->
<g id="node394" class="node">
<title>expert_agg_11</title>
<polygon fill="lightpink" stroke="black" points="3095.86,-7578.44 2750.88,-7578.44 2662.14,-7442.44 3007.12,-7442.44 3095.86,-7578.44"/>
<text text-anchor="middle" x="2879" y="-7529.24" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2879" y="-7514.24" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2879" y="-7499.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2879" y="-7484.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- gate_11&#45;&gt;expert_agg_11 -->
<g id="edge613" class="edge">
<title>gate_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2930.11,-7915.18C2932.64,-7889.74 2935,-7858.51 2935,-7830.44 2935,-7830.44 2935,-7830.44 2935,-7640.94 2935,-7623.23 2930.53,-7605.19 2924.12,-7588.42"/>
<polygon fill="black" stroke="black" points="2927.17,-7586.64 2920.14,-7578.71 2920.69,-7589.29 2927.17,-7586.64"/>
<text text-anchor="middle" x="2963.5" y="-7728.24" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_11_0 -->
<g id="node371" class="node">
<title>expert_gelu_11_0</title>
<polygon fill="lightcyan" stroke="black" points="2098.5,-7758.44 1919.5,-7758.44 1919.5,-7705.44 2098.5,-7705.44 2098.5,-7758.44"/>
<text text-anchor="middle" x="2009" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2009" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2009" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_0&#45;&gt;expert_gelu_11_0 -->
<g id="edge575" class="edge">
<title>expert_11_0&#45;&gt;expert_gelu_11_0</title>
<path fill="none" stroke="black" d="M2009,-7795.31C2009,-7786.73 2009,-7777.45 2009,-7768.74"/>
<polygon fill="black" stroke="black" points="2012.5,-7768.49 2009,-7758.49 2005.5,-7768.49 2012.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_0 -->
<g id="node372" class="node">
<title>expert_ffn2_11_0</title>
<polygon fill="lightcyan" stroke="black" points="2181.5,-7668.44 1836.5,-7668.44 1836.5,-7615.44 2181.5,-7615.44 2181.5,-7668.44"/>
<text text-anchor="middle" x="2009" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2009" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2009" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_0&#45;&gt;expert_ffn2_11_0 -->
<g id="edge576" class="edge">
<title>expert_gelu_11_0&#45;&gt;expert_ffn2_11_0</title>
<path fill="none" stroke="black" d="M2009,-7705.01C2009,-7696.78 2009,-7687.52 2009,-7678.72"/>
<polygon fill="black" stroke="black" points="2012.5,-7678.68 2009,-7668.68 2005.5,-7678.68 2012.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_0&#45;&gt;expert_agg_11 -->
<g id="edge577" class="edge">
<title>expert_ffn2_11_0&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M2180.36,-7615.43C2334.52,-7592.49 2559.61,-7558.98 2712.31,-7536.25"/>
<polygon fill="black" stroke="black" points="2712.89,-7539.71 2722.26,-7534.77 2711.86,-7532.78 2712.89,-7539.71"/>
</g>
<!-- expert_gelu_11_1 -->
<g id="node374" class="node">
<title>expert_gelu_11_1</title>
<polygon fill="lightcyan" stroke="black" points="3224.5,-7758.44 3045.5,-7758.44 3045.5,-7705.44 3224.5,-7705.44 3224.5,-7758.44"/>
<text text-anchor="middle" x="3135" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3135" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3135" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_1&#45;&gt;expert_gelu_11_1 -->
<g id="edge580" class="edge">
<title>expert_11_1&#45;&gt;expert_gelu_11_1</title>
<path fill="none" stroke="black" d="M3135,-7795.31C3135,-7786.73 3135,-7777.45 3135,-7768.74"/>
<polygon fill="black" stroke="black" points="3138.5,-7768.49 3135,-7758.49 3131.5,-7768.49 3138.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_1 -->
<g id="node375" class="node">
<title>expert_ffn2_11_1</title>
<polygon fill="lightcyan" stroke="black" points="3307.5,-7668.44 2962.5,-7668.44 2962.5,-7615.44 3307.5,-7615.44 3307.5,-7668.44"/>
<text text-anchor="middle" x="3135" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3135" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3135" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_1&#45;&gt;expert_ffn2_11_1 -->
<g id="edge581" class="edge">
<title>expert_gelu_11_1&#45;&gt;expert_ffn2_11_1</title>
<path fill="none" stroke="black" d="M3135,-7705.01C3135,-7696.78 3135,-7687.52 3135,-7678.72"/>
<polygon fill="black" stroke="black" points="3138.5,-7678.68 3135,-7668.68 3131.5,-7678.68 3138.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_1&#45;&gt;expert_agg_11 -->
<g id="edge582" class="edge">
<title>expert_ffn2_11_1&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M3084.42,-7615.36C3065.71,-7605.89 3043.45,-7594.63 3020.61,-7583.08"/>
<polygon fill="black" stroke="black" points="3022,-7579.85 3011.49,-7578.46 3018.84,-7586.1 3022,-7579.85"/>
</g>
<!-- expert_gelu_11_2 -->
<g id="node377" class="node">
<title>expert_gelu_11_2</title>
<polygon fill="lightcyan" stroke="black" points="3950.5,-7758.44 3771.5,-7758.44 3771.5,-7705.44 3950.5,-7705.44 3950.5,-7758.44"/>
<text text-anchor="middle" x="3861" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3861" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3861" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_2&#45;&gt;expert_gelu_11_2 -->
<g id="edge585" class="edge">
<title>expert_11_2&#45;&gt;expert_gelu_11_2</title>
<path fill="none" stroke="black" d="M3861,-7795.31C3861,-7786.73 3861,-7777.45 3861,-7768.74"/>
<polygon fill="black" stroke="black" points="3864.5,-7768.49 3861,-7758.49 3857.5,-7768.49 3864.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_2 -->
<g id="node378" class="node">
<title>expert_ffn2_11_2</title>
<polygon fill="lightcyan" stroke="black" points="4033.5,-7668.44 3688.5,-7668.44 3688.5,-7615.44 4033.5,-7615.44 4033.5,-7668.44"/>
<text text-anchor="middle" x="3861" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3861" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3861" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_2&#45;&gt;expert_ffn2_11_2 -->
<g id="edge586" class="edge">
<title>expert_gelu_11_2&#45;&gt;expert_ffn2_11_2</title>
<path fill="none" stroke="black" d="M3861,-7705.01C3861,-7696.78 3861,-7687.52 3861,-7678.72"/>
<polygon fill="black" stroke="black" points="3864.5,-7678.68 3861,-7668.68 3857.5,-7678.68 3864.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_2&#45;&gt;expert_agg_11 -->
<g id="edge587" class="edge">
<title>expert_ffn2_11_2&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M3688.08,-7616.54C3685.37,-7616.17 3682.67,-7615.8 3680,-7615.44 3474.98,-7587.69 3240.23,-7557.38 3078.11,-7536.68"/>
<polygon fill="black" stroke="black" points="3078.39,-7533.19 3068.03,-7535.4 3077.5,-7540.13 3078.39,-7533.19"/>
</g>
<!-- expert_gelu_11_3 -->
<g id="node380" class="node">
<title>expert_gelu_11_3</title>
<polygon fill="lightcyan" stroke="black" points="1735.5,-7758.44 1556.5,-7758.44 1556.5,-7705.44 1735.5,-7705.44 1735.5,-7758.44"/>
<text text-anchor="middle" x="1646" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1646" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1646" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_3&#45;&gt;expert_gelu_11_3 -->
<g id="edge590" class="edge">
<title>expert_11_3&#45;&gt;expert_gelu_11_3</title>
<path fill="none" stroke="black" d="M1646,-7795.31C1646,-7786.73 1646,-7777.45 1646,-7768.74"/>
<polygon fill="black" stroke="black" points="1649.5,-7768.49 1646,-7758.49 1642.5,-7768.49 1649.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_3 -->
<g id="node381" class="node">
<title>expert_ffn2_11_3</title>
<polygon fill="lightcyan" stroke="black" points="1818.5,-7668.44 1473.5,-7668.44 1473.5,-7615.44 1818.5,-7615.44 1818.5,-7668.44"/>
<text text-anchor="middle" x="1646" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1646" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1646" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_3&#45;&gt;expert_ffn2_11_3 -->
<g id="edge591" class="edge">
<title>expert_gelu_11_3&#45;&gt;expert_ffn2_11_3</title>
<path fill="none" stroke="black" d="M1646,-7705.01C1646,-7696.78 1646,-7687.52 1646,-7678.72"/>
<polygon fill="black" stroke="black" points="1649.5,-7678.68 1646,-7668.68 1642.5,-7678.68 1649.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_3&#45;&gt;expert_agg_11 -->
<g id="edge592" class="edge">
<title>expert_ffn2_11_3&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M1818.9,-7616.54C1821.95,-7616.17 1824.99,-7615.8 1828,-7615.44 2136.77,-7578.55 2497.7,-7544.89 2706.17,-7526.38"/>
<polygon fill="black" stroke="black" points="2706.63,-7529.85 2716.29,-7525.48 2706.02,-7522.88 2706.63,-7529.85"/>
</g>
<!-- expert_gelu_11_4 -->
<g id="node383" class="node">
<title>expert_gelu_11_4</title>
<polygon fill="lightcyan" stroke="black" points="3587.5,-7758.44 3408.5,-7758.44 3408.5,-7705.44 3587.5,-7705.44 3587.5,-7758.44"/>
<text text-anchor="middle" x="3498" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3498" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3498" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_4&#45;&gt;expert_gelu_11_4 -->
<g id="edge595" class="edge">
<title>expert_11_4&#45;&gt;expert_gelu_11_4</title>
<path fill="none" stroke="black" d="M3498,-7795.31C3498,-7786.73 3498,-7777.45 3498,-7768.74"/>
<polygon fill="black" stroke="black" points="3501.5,-7768.49 3498,-7758.49 3494.5,-7768.49 3501.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_4 -->
<g id="node384" class="node">
<title>expert_ffn2_11_4</title>
<polygon fill="lightcyan" stroke="black" points="3670.5,-7668.44 3325.5,-7668.44 3325.5,-7615.44 3670.5,-7615.44 3670.5,-7668.44"/>
<text text-anchor="middle" x="3498" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3498" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3498" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_4&#45;&gt;expert_ffn2_11_4 -->
<g id="edge596" class="edge">
<title>expert_gelu_11_4&#45;&gt;expert_ffn2_11_4</title>
<path fill="none" stroke="black" d="M3498,-7705.01C3498,-7696.78 3498,-7687.52 3498,-7678.72"/>
<polygon fill="black" stroke="black" points="3501.5,-7678.68 3498,-7668.68 3494.5,-7678.68 3501.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_4&#45;&gt;expert_agg_11 -->
<g id="edge597" class="edge">
<title>expert_ffn2_11_4&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M3376.07,-7615.43C3294.44,-7598.35 3184.84,-7575.42 3089.33,-7555.44"/>
<polygon fill="black" stroke="black" points="3090.05,-7552.02 3079.54,-7553.4 3088.61,-7558.87 3090.05,-7552.02"/>
</g>
<!-- expert_gelu_11_5 -->
<g id="node386" class="node">
<title>expert_gelu_11_5</title>
<polygon fill="lightcyan" stroke="black" points="4313.5,-7758.44 4134.5,-7758.44 4134.5,-7705.44 4313.5,-7705.44 4313.5,-7758.44"/>
<text text-anchor="middle" x="4224" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4224" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4224" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_5&#45;&gt;expert_gelu_11_5 -->
<g id="edge600" class="edge">
<title>expert_11_5&#45;&gt;expert_gelu_11_5</title>
<path fill="none" stroke="black" d="M4224,-7795.31C4224,-7786.73 4224,-7777.45 4224,-7768.74"/>
<polygon fill="black" stroke="black" points="4227.5,-7768.49 4224,-7758.49 4220.5,-7768.49 4227.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_5 -->
<g id="node387" class="node">
<title>expert_ffn2_11_5</title>
<polygon fill="lightcyan" stroke="black" points="4396.5,-7668.44 4051.5,-7668.44 4051.5,-7615.44 4396.5,-7615.44 4396.5,-7668.44"/>
<text text-anchor="middle" x="4224" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4224" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4224" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_5&#45;&gt;expert_ffn2_11_5 -->
<g id="edge601" class="edge">
<title>expert_gelu_11_5&#45;&gt;expert_ffn2_11_5</title>
<path fill="none" stroke="black" d="M4224,-7705.01C4224,-7696.78 4224,-7687.52 4224,-7678.72"/>
<polygon fill="black" stroke="black" points="4227.5,-7678.68 4224,-7668.68 4220.5,-7678.68 4227.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_5&#45;&gt;expert_agg_11 -->
<g id="edge602" class="edge">
<title>expert_ffn2_11_5&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M4051.1,-7616.39C4048.38,-7616.06 4045.68,-7615.75 4043,-7615.44 3701.52,-7576.16 3302.22,-7543.32 3071.19,-7525.6"/>
<polygon fill="black" stroke="black" points="3071.24,-7522.1 3061,-7524.82 3070.7,-7529.07 3071.24,-7522.1"/>
</g>
<!-- expert_gelu_11_6 -->
<g id="node389" class="node">
<title>expert_gelu_11_6</title>
<polygon fill="lightcyan" stroke="black" points="2461.5,-7758.44 2282.5,-7758.44 2282.5,-7705.44 2461.5,-7705.44 2461.5,-7758.44"/>
<text text-anchor="middle" x="2372" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2372" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2372" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_6&#45;&gt;expert_gelu_11_6 -->
<g id="edge605" class="edge">
<title>expert_11_6&#45;&gt;expert_gelu_11_6</title>
<path fill="none" stroke="black" d="M2372,-7795.31C2372,-7786.73 2372,-7777.45 2372,-7768.74"/>
<polygon fill="black" stroke="black" points="2375.5,-7768.49 2372,-7758.49 2368.5,-7768.49 2375.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_6 -->
<g id="node390" class="node">
<title>expert_ffn2_11_6</title>
<polygon fill="lightcyan" stroke="black" points="2544.5,-7668.44 2199.5,-7668.44 2199.5,-7615.44 2544.5,-7615.44 2544.5,-7668.44"/>
<text text-anchor="middle" x="2372" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2372" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2372" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_6&#45;&gt;expert_ffn2_11_6 -->
<g id="edge606" class="edge">
<title>expert_gelu_11_6&#45;&gt;expert_ffn2_11_6</title>
<path fill="none" stroke="black" d="M2372,-7705.01C2372,-7696.78 2372,-7687.52 2372,-7678.72"/>
<polygon fill="black" stroke="black" points="2375.5,-7678.68 2372,-7668.68 2368.5,-7678.68 2375.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_6&#45;&gt;expert_agg_11 -->
<g id="edge607" class="edge">
<title>expert_ffn2_11_6&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M2471.86,-7615.43C2542.97,-7597.27 2639.97,-7572.49 2721.45,-7551.68"/>
<polygon fill="black" stroke="black" points="2722.49,-7555.03 2731.31,-7549.16 2720.75,-7548.25 2722.49,-7555.03"/>
</g>
<!-- expert_gelu_11_7 -->
<g id="node392" class="node">
<title>expert_gelu_11_7</title>
<polygon fill="lightcyan" stroke="black" points="2824.5,-7758.44 2645.5,-7758.44 2645.5,-7705.44 2824.5,-7705.44 2824.5,-7758.44"/>
<text text-anchor="middle" x="2735" y="-7743.24" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2735" y="-7728.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2735" y="-7713.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_11_7&#45;&gt;expert_gelu_11_7 -->
<g id="edge610" class="edge">
<title>expert_11_7&#45;&gt;expert_gelu_11_7</title>
<path fill="none" stroke="black" d="M2735,-7795.31C2735,-7786.73 2735,-7777.45 2735,-7768.74"/>
<polygon fill="black" stroke="black" points="2738.5,-7768.49 2735,-7758.49 2731.5,-7768.49 2738.5,-7768.49"/>
</g>
<!-- expert_ffn2_11_7 -->
<g id="node393" class="node">
<title>expert_ffn2_11_7</title>
<polygon fill="lightcyan" stroke="black" points="2907.5,-7668.44 2562.5,-7668.44 2562.5,-7615.44 2907.5,-7615.44 2907.5,-7668.44"/>
<text text-anchor="middle" x="2735" y="-7653.24" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2735" y="-7638.24" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2735" y="-7623.24" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- expert_gelu_11_7&#45;&gt;expert_ffn2_11_7 -->
<g id="edge611" class="edge">
<title>expert_gelu_11_7&#45;&gt;expert_ffn2_11_7</title>
<path fill="none" stroke="black" d="M2735,-7705.01C2735,-7696.78 2735,-7687.52 2735,-7678.72"/>
<polygon fill="black" stroke="black" points="2738.5,-7678.68 2735,-7668.68 2731.5,-7678.68 2738.5,-7678.68"/>
</g>
<!-- expert_ffn2_11_7&#45;&gt;expert_agg_11 -->
<g id="edge612" class="edge">
<title>expert_ffn2_11_7&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="black" d="M2763.45,-7615.36C2773.29,-7606.5 2784.87,-7596.09 2796.84,-7585.33"/>
<polygon fill="black" stroke="black" points="2799.23,-7587.89 2804.32,-7578.6 2794.55,-7582.68 2799.23,-7587.89"/>
</g>
<!-- expert_agg_11&#45;&gt;residual2_11 -->
<g id="edge615" class="edge">
<title>expert_agg_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M2692.13,-7488.93C2467.32,-7464.25 2085.28,-7422.31 1805.69,-7391.61"/>
<polygon fill="black" stroke="black" points="1805.7,-7388.09 1795.37,-7390.48 1804.93,-7395.05 1805.7,-7388.09"/>
</g>
<!-- comm_11_12 -->
<g id="node432" class="node">
<title>comm_11_12</title>
<ellipse fill="lightgreen" stroke="black" cx="1458" cy="-7235.57" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1458" y="-7239.37" font-family="Times,serif" font-size="14.00">GPU 10 → GPU 11</text>
<text text-anchor="middle" x="1458" y="-7224.37" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_11&#45;&gt;comm_11_12 -->
<g id="edge616" class="edge">
<title>residual2_11&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M1458,-7299.38C1458,-7290.45 1458,-7281.34 1458,-7272.94"/>
<polygon fill="black" stroke="black" points="1461.5,-7272.73 1458,-7262.73 1454.5,-7272.73 1461.5,-7272.73"/>
</g>
<!-- comm_10_11&#45;&gt;ln1_11 -->
<g id="edge561" class="edge">
<title>comm_10_11&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M1352.84,-8653.67C1324.27,-8642.55 1289.5,-8629.01 1258.96,-8617.12"/>
<polygon fill="black" stroke="black" points="1260.22,-8613.86 1249.63,-8613.49 1257.68,-8620.38 1260.22,-8613.86"/>
</g>
<!-- comm_10_11&#45;&gt;residual1_11 -->
<g id="edge569" class="edge">
<title>comm_10_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1491.98,-8657.28C1525.19,-8644.22 1556,-8622.73 1556,-8587.94 1556,-8587.94 1556,-8587.94 1556,-8315.94 1556,-8295.89 1547.22,-8277.58 1534.91,-8261.77"/>
<polygon fill="black" stroke="black" points="1537.28,-8259.15 1528.18,-8253.73 1531.92,-8263.65 1537.28,-8259.15"/>
</g>
<!-- ln1_12 -->
<g id="node397" class="node">
<title>ln1_12</title>
<polygon fill="lightyellow" stroke="black" points="1396,-7171.7 1226,-7171.7 1226,-7118.7 1396,-7118.7 1396,-7171.7"/>
<text text-anchor="middle" x="1311" y="-7156.5" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1311" y="-7141.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1311" y="-7126.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_q_12 -->
<g id="node398" class="node">
<title>mha_q_12</title>
<polygon fill="lightblue" stroke="black" points="1655,-7081.7 1319,-7081.7 1319,-7028.7 1655,-7028.7 1655,-7081.7"/>
<text text-anchor="middle" x="1487" y="-7066.5" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1487" y="-7051.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1487" y="-7036.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_q_12 -->
<g id="edge618" class="edge">
<title>ln1_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M1362.38,-7118.51C1382.53,-7108.44 1405.8,-7096.8 1426.74,-7086.33"/>
<polygon fill="black" stroke="black" points="1428.48,-7089.37 1435.86,-7081.77 1425.35,-7083.11 1428.48,-7089.37"/>
</g>
<!-- mha_k_12 -->
<g id="node399" class="node">
<title>mha_k_12</title>
<polygon fill="lightblue" stroke="black" points="947,-7081.7 611,-7081.7 611,-7028.7 947,-7028.7 947,-7081.7"/>
<text text-anchor="middle" x="779" y="-7066.5" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="779" y="-7051.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="779" y="-7036.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_k_12 -->
<g id="edge619" class="edge">
<title>ln1_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M1225.82,-7130.11C1149.99,-7117.57 1036.93,-7098.87 943.51,-7083.41"/>
<polygon fill="black" stroke="black" points="943.82,-7079.92 933.38,-7081.74 942.68,-7086.82 943.82,-7079.92"/>
</g>
<!-- mha_v_12 -->
<g id="node400" class="node">
<title>mha_v_12</title>
<polygon fill="lightblue" stroke="black" points="1301,-7081.7 965,-7081.7 965,-7028.7 1301,-7028.7 1301,-7081.7"/>
<text text-anchor="middle" x="1133" y="-7066.5" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1133" y="-7051.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1133" y="-7036.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_v_12 -->
<g id="edge620" class="edge">
<title>ln1_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M1259.04,-7118.51C1238.66,-7108.44 1215.12,-7096.8 1193.95,-7086.33"/>
<polygon fill="black" stroke="black" points="1195.24,-7083.06 1184.72,-7081.77 1192.13,-7089.34 1195.24,-7083.06"/>
</g>
<!-- mha_attn_12 -->
<g id="node401" class="node">
<title>mha_attn_12</title>
<polygon fill="lightblue" stroke="black" points="1284,-6991.7 1114,-6991.7 1114,-6938.7 1284,-6938.7 1284,-6991.7"/>
<text text-anchor="middle" x="1199" y="-6976.5" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1199" y="-6961.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1199" y="-6946.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge621" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1403.31,-7028.63C1368.7,-7018.05 1328.41,-7005.74 1292.81,-6994.86"/>
<polygon fill="black" stroke="black" points="1293.48,-6991.41 1282.9,-6991.84 1291.44,-6998.11 1293.48,-6991.41"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge622" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M900.76,-7028.69C965.47,-7015.13 1043.84,-6998.71 1104,-6986.1"/>
<polygon fill="black" stroke="black" points="1104.81,-6989.51 1113.88,-6984.04 1103.37,-6982.66 1104.81,-6989.51"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge623" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1152.45,-7028.27C1159.09,-7019.41 1166.63,-7009.37 1173.67,-6999.98"/>
<polygon fill="black" stroke="black" points="1176.49,-7002.04 1179.69,-6991.94 1170.89,-6997.84 1176.49,-7002.04"/>
</g>
<!-- mha_out_12 -->
<g id="node402" class="node">
<title>mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="1567,-6901.7 1231,-6901.7 1231,-6848.7 1567,-6848.7 1567,-6901.7"/>
<text text-anchor="middle" x="1399" y="-6886.5" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1399" y="-6871.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1399" y="-6856.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge624" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M1257.12,-6938.63C1280.33,-6928.41 1307.22,-6916.58 1331.31,-6905.98"/>
<polygon fill="black" stroke="black" points="1332.99,-6909.07 1340.74,-6901.84 1330.18,-6902.66 1332.99,-6909.07"/>
</g>
<!-- residual1_12 -->
<g id="node403" class="node">
<title>residual1_12</title>
<polygon fill="lightcoral" stroke="black" points="1896.86,-6811.7 1327.58,-6811.7 1181.14,-6705.7 1750.42,-6705.7 1896.86,-6811.7"/>
<text text-anchor="middle" x="1539" y="-6770" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1539" y="-6755" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1539" y="-6740" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge626" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1430.42,-6848.5C1441.43,-6839.5 1454.3,-6828.97 1467.25,-6818.38"/>
<polygon fill="black" stroke="black" points="1469.79,-6820.83 1475.31,-6811.79 1465.35,-6815.41 1469.79,-6820.83"/>
</g>
<!-- ln2_12 -->
<g id="node404" class="node">
<title>ln2_12</title>
<polygon fill="lightyellow" stroke="black" points="2765,-6668.7 2595,-6668.7 2595,-6615.7 2765,-6615.7 2765,-6668.7"/>
<text text-anchor="middle" x="2680" y="-6653.5" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2680" y="-6638.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2680" y="-6623.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge627" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M1787.99,-6732.71C2038.24,-6707.6 2411.04,-6670.19 2584.65,-6652.77"/>
<polygon fill="black" stroke="black" points="2585.18,-6656.23 2594.78,-6651.75 2584.48,-6649.27 2585.18,-6656.23"/>
</g>
<!-- residual2_12 -->
<g id="node431" class="node">
<title>residual2_12</title>
<polygon fill="lightcoral" stroke="black" points="1896.86,-5963.7 1327.58,-5963.7 1181.14,-5857.7 1750.42,-5857.7 1896.86,-5963.7"/>
<text text-anchor="middle" x="1539" y="-5922" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1539" y="-5907" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1539" y="-5892" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge670" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M1531.23,-6705.67C1528.92,-6686.12 1527,-6663.69 1527,-6643.2 1527,-6643.2 1527,-6643.2 1527,-6067.7 1527,-6036.86 1529.36,-6002.68 1531.99,-5974.2"/>
<polygon fill="black" stroke="black" points="1535.5,-5974.27 1532.96,-5963.98 1528.53,-5973.6 1535.5,-5974.27"/>
</g>
<!-- gate_12 -->
<g id="node405" class="node">
<title>gate_12</title>
<polygon fill="orange" stroke="black" points="3005,-6578.7 2696,-6525.7 3005,-6472.7 3314,-6525.7 3005,-6578.7"/>
<text text-anchor="middle" x="3005" y="-6537" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3005" y="-6522" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="3005" y="-6507" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;gate_12 -->
<g id="edge628" class="edge">
<title>ln2_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M2752.53,-6615.65C2794.71,-6600.79 2848.7,-6581.77 2895.92,-6565.13"/>
<polygon fill="black" stroke="black" points="2897.31,-6568.35 2905.58,-6561.73 2894.98,-6561.75 2897.31,-6568.35"/>
</g>
<!-- expert_12_0 -->
<g id="node406" class="node">
<title>expert_12_0</title>
<polygon fill="lightcyan" stroke="black" points="2262.5,-6421.7 1917.5,-6421.7 1917.5,-6353.7 2262.5,-6353.7 2262.5,-6421.7"/>
<text text-anchor="middle" x="2090" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2090" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2090" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2090" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_0 -->
<g id="edge630" class="edge">
<title>ln2_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" d="M2594.93,-6623.77C2486.23,-6598.75 2295.25,-6545.39 2154,-6454.7 2143.08,-6447.69 2132.65,-6438.48 2123.49,-6429.17"/>
<polygon fill="black" stroke="black" points="2125.85,-6426.58 2116.43,-6421.73 2120.77,-6431.39 2125.85,-6426.58"/>
</g>
<!-- expert_12_1 -->
<g id="node409" class="node">
<title>expert_12_1</title>
<polygon fill="lightcyan" stroke="black" points="3388.5,-6421.7 3043.5,-6421.7 3043.5,-6353.7 3388.5,-6353.7 3388.5,-6421.7"/>
<text text-anchor="middle" x="3216" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3216" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3216" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3216" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_1 -->
<g id="edge635" class="edge">
<title>ln2_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" d="M2765.09,-6639.03C2931.12,-6633.94 3285.4,-6618.49 3323,-6578.7 3365.46,-6533.77 3361.45,-6491.69 3328,-6439.7 3325.46,-6435.75 3322.53,-6432.11 3319.3,-6428.74"/>
<polygon fill="black" stroke="black" points="3321.5,-6426.01 3311.77,-6421.81 3316.76,-6431.16 3321.5,-6426.01"/>
</g>
<!-- expert_12_2 -->
<g id="node412" class="node">
<title>expert_12_2</title>
<polygon fill="lightcyan" stroke="black" points="4114.5,-6421.7 3769.5,-6421.7 3769.5,-6353.7 4114.5,-6353.7 4114.5,-6421.7"/>
<text text-anchor="middle" x="3942" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3942" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3942" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3942" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_2 -->
<g id="edge640" class="edge">
<title>ln2_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" d="M2765.01,-6641.09C2906.14,-6639.38 3197,-6629.32 3437,-6578.7 3648.81,-6534.03 3739.17,-6590.18 3908,-6454.7 3915.76,-6448.47 3921.93,-6440 3926.77,-6431.2"/>
<polygon fill="black" stroke="black" points="3930.02,-6432.51 3931.33,-6422 3923.75,-6429.4 3930.02,-6432.51"/>
</g>
<!-- expert_12_3 -->
<g id="node415" class="node">
<title>expert_12_3</title>
<polygon fill="lightcyan" stroke="black" points="1899.5,-6421.7 1554.5,-6421.7 1554.5,-6353.7 1899.5,-6353.7 1899.5,-6421.7"/>
<text text-anchor="middle" x="1727" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1727" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1727" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1727" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_3 -->
<g id="edge645" class="edge">
<title>ln2_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" d="M2594.96,-6637.53C2494.74,-6631.6 2323.88,-6616.48 2182,-6578.7 2041.79,-6541.37 1887.78,-6470.18 1799.71,-6426.33"/>
<polygon fill="black" stroke="black" points="1801.12,-6423.12 1790.61,-6421.78 1797.99,-6429.38 1801.12,-6423.12"/>
</g>
<!-- expert_12_4 -->
<g id="node418" class="node">
<title>expert_12_4</title>
<polygon fill="lightcyan" stroke="black" points="3751.5,-6421.7 3406.5,-6421.7 3406.5,-6353.7 3751.5,-6353.7 3751.5,-6421.7"/>
<text text-anchor="middle" x="3579" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3579" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3579" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3579" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_4 -->
<g id="edge650" class="edge">
<title>ln2_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" d="M2765.23,-6641.5C2922.85,-6640.72 3252.87,-6632.48 3352,-6578.7 3426.09,-6538.5 3498.42,-6471.82 3540.83,-6429.1"/>
<polygon fill="black" stroke="black" points="3543.37,-6431.51 3547.89,-6421.93 3538.38,-6426.6 3543.37,-6431.51"/>
</g>
<!-- expert_12_5 -->
<g id="node421" class="node">
<title>expert_12_5</title>
<polygon fill="lightcyan" stroke="black" points="4477.5,-6421.7 4132.5,-6421.7 4132.5,-6353.7 4477.5,-6353.7 4477.5,-6421.7"/>
<text text-anchor="middle" x="4305" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4305" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4305" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4305" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_5 -->
<g id="edge655" class="edge">
<title>ln2_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" d="M2765.1,-6638.34C2972.33,-6630.97 3498.85,-6609.72 3672,-6578.7 3866.36,-6543.88 4085.46,-6470.02 4208.2,-6425.34"/>
<polygon fill="black" stroke="black" points="4209.77,-6428.49 4217.96,-6421.77 4207.37,-6421.91 4209.77,-6428.49"/>
</g>
<!-- expert_12_6 -->
<g id="node424" class="node">
<title>expert_12_6</title>
<polygon fill="lightcyan" stroke="black" points="2625.5,-6421.7 2280.5,-6421.7 2280.5,-6353.7 2625.5,-6353.7 2625.5,-6421.7"/>
<text text-anchor="middle" x="2453" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2453" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2453" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2453" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_6 -->
<g id="edge660" class="edge">
<title>ln2_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" d="M2661.02,-6615.5C2631.33,-6575.98 2571.27,-6498.7 2513,-6439.7 2509.37,-6436.03 2505.51,-6432.32 2501.55,-6428.69"/>
<polygon fill="black" stroke="black" points="2503.66,-6425.87 2493.89,-6421.79 2498.98,-6431.08 2503.66,-6425.87"/>
</g>
<!-- expert_12_7 -->
<g id="node427" class="node">
<title>expert_12_7</title>
<polygon fill="lightcyan" stroke="black" points="2988.5,-6421.7 2643.5,-6421.7 2643.5,-6353.7 2988.5,-6353.7 2988.5,-6421.7"/>
<text text-anchor="middle" x="2816" y="-6406.5" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2816" y="-6391.5" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2816" y="-6376.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2816" y="-6361.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;expert_12_7 -->
<g id="edge665" class="edge">
<title>ln2_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" d="M2674.21,-6615.54C2667.79,-6580.69 2661.43,-6517.61 2687,-6472.7 2697.4,-6454.44 2713.58,-6439.47 2731.01,-6427.49"/>
<polygon fill="black" stroke="black" points="2733.19,-6430.25 2739.65,-6421.85 2729.36,-6424.39 2733.19,-6430.25"/>
</g>
<!-- gate_12&#45;&gt;expert_12_0 -->
<g id="edge629" class="edge">
<title>gate_12&#45;&gt;expert_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2831.8,-6502.34C2685.55,-6482.99 2470.39,-6453.44 2272.88,-6421.82"/>
<polygon fill="black" stroke="black" points="2273.32,-6418.35 2262.89,-6420.22 2272.21,-6425.26 2273.32,-6418.35"/>
<text text-anchor="middle" x="2517.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_1 -->
<g id="edge634" class="edge">
<title>gate_12&#45;&gt;expert_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3055.59,-6481.36C3073.19,-6467.26 3093.43,-6452.06 3113,-6439.7 3120.09,-6435.22 3127.64,-6430.84 3135.29,-6426.64"/>
<polygon fill="black" stroke="black" points="3137.15,-6429.61 3144.3,-6421.8 3133.83,-6423.45 3137.15,-6429.61"/>
<text text-anchor="middle" x="3158.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_2 -->
<g id="edge639" class="edge">
<title>gate_12&#45;&gt;expert_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3181.38,-6502.95C3332.34,-6483.8 3555.64,-6454.2 3759.12,-6421.98"/>
<polygon fill="black" stroke="black" points="3759.78,-6425.42 3769.1,-6420.4 3758.68,-6418.51 3759.78,-6425.42"/>
<text text-anchor="middle" x="3682.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_3 -->
<g id="edge644" class="edge">
<title>gate_12&#45;&gt;expert_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2788.35,-6509.84C2569.19,-6493.54 2220.59,-6464.11 1909.97,-6421.8"/>
<polygon fill="black" stroke="black" points="1910.24,-6418.3 1899.86,-6420.41 1909.29,-6425.24 1910.24,-6418.3"/>
<text text-anchor="middle" x="2223.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_4 -->
<g id="edge649" class="edge">
<title>gate_12&#45;&gt;expert_12_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3109.92,-6490.69C3164.43,-6473.82 3232.37,-6454.05 3294,-6439.7 3336.74,-6429.75 3350.11,-6429.85 3396.09,-6422"/>
<polygon fill="black" stroke="black" points="3396.83,-6425.43 3406.08,-6420.26 3395.63,-6418.53 3396.83,-6425.43"/>
<text text-anchor="middle" x="3339.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_5 -->
<g id="edge654" class="edge">
<title>gate_12&#45;&gt;expert_12_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3224.36,-6510.28C3448.02,-6494.24 3805.04,-6464.94 4121.82,-6421.97"/>
<polygon fill="black" stroke="black" points="4122.69,-6425.38 4132.13,-6420.56 4121.75,-6418.44 4122.69,-6425.38"/>
<text text-anchor="middle" x="4017.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_6 -->
<g id="edge659" class="edge">
<title>gate_12&#45;&gt;expert_12_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2880.43,-6494.01C2796.3,-6473.28 2684.98,-6445.85 2597.03,-6424.19"/>
<polygon fill="black" stroke="black" points="2597.79,-6420.77 2587.25,-6421.78 2596.12,-6427.57 2597.79,-6420.77"/>
<text text-anchor="middle" x="2757.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_12&#45;&gt;expert_12_7 -->
<g id="edge664" class="edge">
<title>gate_12&#45;&gt;expert_12_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2946.49,-6482.6C2922.15,-6465.09 2894.06,-6444.87 2870.2,-6427.7"/>
<polygon fill="black" stroke="black" points="2872.11,-6424.76 2861.94,-6421.76 2868.02,-6430.44 2872.11,-6424.76"/>
<text text-anchor="middle" x="2949.5" y="-6443.5" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_12 -->
<g id="node430" class="node">
<title>expert_agg_12</title>
<polygon fill="lightpink" stroke="black" points="3182.86,-6136.7 2837.88,-6136.7 2749.14,-6000.7 3094.12,-6000.7 3182.86,-6136.7"/>
<text text-anchor="middle" x="2966" y="-6087.5" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="2966" y="-6072.5" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="2966" y="-6057.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2966" y="-6042.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- gate_12&#45;&gt;expert_agg_12 -->
<g id="edge669" class="edge">
<title>gate_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3011.11,-6473.44C3013.64,-6447.99 3016,-6416.77 3016,-6388.7 3016,-6388.7 3016,-6388.7 3016,-6199.2 3016,-6181.57 3011.92,-6163.45 3006.09,-6146.54"/>
<polygon fill="black" stroke="black" points="3009.22,-6144.92 3002.47,-6136.75 3002.65,-6147.34 3009.22,-6144.92"/>
<text text-anchor="middle" x="3044.5" y="-6286.5" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_12_0 -->
<g id="node407" class="node">
<title>expert_gelu_12_0</title>
<polygon fill="lightcyan" stroke="black" points="2179.5,-6316.7 2000.5,-6316.7 2000.5,-6263.7 2179.5,-6263.7 2179.5,-6316.7"/>
<text text-anchor="middle" x="2090" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2090" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2090" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_0&#45;&gt;expert_gelu_12_0 -->
<g id="edge631" class="edge">
<title>expert_12_0&#45;&gt;expert_gelu_12_0</title>
<path fill="none" stroke="black" d="M2090,-6353.57C2090,-6344.99 2090,-6335.71 2090,-6327"/>
<polygon fill="black" stroke="black" points="2093.5,-6326.75 2090,-6316.75 2086.5,-6326.75 2093.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_0 -->
<g id="node408" class="node">
<title>expert_ffn2_12_0</title>
<polygon fill="lightcyan" stroke="black" points="2262.5,-6226.7 1917.5,-6226.7 1917.5,-6173.7 2262.5,-6173.7 2262.5,-6226.7"/>
<text text-anchor="middle" x="2090" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2090" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2090" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_0&#45;&gt;expert_ffn2_12_0 -->
<g id="edge632" class="edge">
<title>expert_gelu_12_0&#45;&gt;expert_ffn2_12_0</title>
<path fill="none" stroke="black" d="M2090,-6263.27C2090,-6255.04 2090,-6245.78 2090,-6236.98"/>
<polygon fill="black" stroke="black" points="2093.5,-6236.94 2090,-6226.94 2086.5,-6236.94 2093.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_0&#45;&gt;expert_agg_12 -->
<g id="edge633" class="edge">
<title>expert_ffn2_12_0&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M2262.55,-6173.69C2418.13,-6150.69 2645.48,-6117.08 2799.25,-6094.35"/>
<polygon fill="black" stroke="black" points="2799.89,-6097.8 2809.27,-6092.87 2798.86,-6090.87 2799.89,-6097.8"/>
</g>
<!-- expert_gelu_12_1 -->
<g id="node410" class="node">
<title>expert_gelu_12_1</title>
<polygon fill="lightcyan" stroke="black" points="3305.5,-6316.7 3126.5,-6316.7 3126.5,-6263.7 3305.5,-6263.7 3305.5,-6316.7"/>
<text text-anchor="middle" x="3216" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3216" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3216" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_1&#45;&gt;expert_gelu_12_1 -->
<g id="edge636" class="edge">
<title>expert_12_1&#45;&gt;expert_gelu_12_1</title>
<path fill="none" stroke="black" d="M3216,-6353.57C3216,-6344.99 3216,-6335.71 3216,-6327"/>
<polygon fill="black" stroke="black" points="3219.5,-6326.75 3216,-6316.75 3212.5,-6326.75 3219.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_1 -->
<g id="node411" class="node">
<title>expert_ffn2_12_1</title>
<polygon fill="lightcyan" stroke="black" points="3388.5,-6226.7 3043.5,-6226.7 3043.5,-6173.7 3388.5,-6173.7 3388.5,-6226.7"/>
<text text-anchor="middle" x="3216" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3216" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3216" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_1&#45;&gt;expert_ffn2_12_1 -->
<g id="edge637" class="edge">
<title>expert_gelu_12_1&#45;&gt;expert_ffn2_12_1</title>
<path fill="none" stroke="black" d="M3216,-6263.27C3216,-6255.04 3216,-6245.78 3216,-6236.98"/>
<polygon fill="black" stroke="black" points="3219.5,-6236.94 3216,-6226.94 3212.5,-6236.94 3219.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_1&#45;&gt;expert_agg_12 -->
<g id="edge638" class="edge">
<title>expert_ffn2_12_1&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3166.61,-6173.62C3148.33,-6164.15 3126.6,-6152.89 3104.29,-6141.34"/>
<polygon fill="black" stroke="black" points="3105.88,-6138.21 3095.39,-6136.72 3102.66,-6144.43 3105.88,-6138.21"/>
</g>
<!-- expert_gelu_12_2 -->
<g id="node413" class="node">
<title>expert_gelu_12_2</title>
<polygon fill="lightcyan" stroke="black" points="4031.5,-6316.7 3852.5,-6316.7 3852.5,-6263.7 4031.5,-6263.7 4031.5,-6316.7"/>
<text text-anchor="middle" x="3942" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="3942" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3942" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_2&#45;&gt;expert_gelu_12_2 -->
<g id="edge641" class="edge">
<title>expert_12_2&#45;&gt;expert_gelu_12_2</title>
<path fill="none" stroke="black" d="M3942,-6353.57C3942,-6344.99 3942,-6335.71 3942,-6327"/>
<polygon fill="black" stroke="black" points="3945.5,-6326.75 3942,-6316.75 3938.5,-6326.75 3945.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_2 -->
<g id="node414" class="node">
<title>expert_ffn2_12_2</title>
<polygon fill="lightcyan" stroke="black" points="4114.5,-6226.7 3769.5,-6226.7 3769.5,-6173.7 4114.5,-6173.7 4114.5,-6226.7"/>
<text text-anchor="middle" x="3942" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="3942" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3942" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_2&#45;&gt;expert_ffn2_12_2 -->
<g id="edge642" class="edge">
<title>expert_gelu_12_2&#45;&gt;expert_ffn2_12_2</title>
<path fill="none" stroke="black" d="M3942,-6263.27C3942,-6255.04 3942,-6245.78 3942,-6236.98"/>
<polygon fill="black" stroke="black" points="3945.5,-6236.94 3942,-6226.94 3938.5,-6236.94 3945.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_2&#45;&gt;expert_agg_12 -->
<g id="edge643" class="edge">
<title>expert_ffn2_12_2&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3769.08,-6174.8C3766.37,-6174.43 3763.67,-6174.06 3761,-6173.7 3558.18,-6146.15 3326.06,-6115.93 3165.22,-6095.21"/>
<polygon fill="black" stroke="black" points="3165.58,-6091.72 3155.21,-6093.92 3164.68,-6098.67 3165.58,-6091.72"/>
</g>
<!-- expert_gelu_12_3 -->
<g id="node416" class="node">
<title>expert_gelu_12_3</title>
<polygon fill="lightcyan" stroke="black" points="1816.5,-6316.7 1637.5,-6316.7 1637.5,-6263.7 1816.5,-6263.7 1816.5,-6316.7"/>
<text text-anchor="middle" x="1727" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1727" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1727" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_3&#45;&gt;expert_gelu_12_3 -->
<g id="edge646" class="edge">
<title>expert_12_3&#45;&gt;expert_gelu_12_3</title>
<path fill="none" stroke="black" d="M1727,-6353.57C1727,-6344.99 1727,-6335.71 1727,-6327"/>
<polygon fill="black" stroke="black" points="1730.5,-6326.75 1727,-6316.75 1723.5,-6326.75 1730.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_3 -->
<g id="node417" class="node">
<title>expert_ffn2_12_3</title>
<polygon fill="lightcyan" stroke="black" points="1899.5,-6226.7 1554.5,-6226.7 1554.5,-6173.7 1899.5,-6173.7 1899.5,-6226.7"/>
<text text-anchor="middle" x="1727" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1727" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1727" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_3&#45;&gt;expert_ffn2_12_3 -->
<g id="edge647" class="edge">
<title>expert_gelu_12_3&#45;&gt;expert_ffn2_12_3</title>
<path fill="none" stroke="black" d="M1727,-6263.27C1727,-6255.04 1727,-6245.78 1727,-6236.98"/>
<polygon fill="black" stroke="black" points="1730.5,-6236.94 1727,-6226.94 1723.5,-6236.94 1730.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_3&#45;&gt;expert_agg_12 -->
<g id="edge648" class="edge">
<title>expert_ffn2_12_3&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M1899.9,-6174.8C1902.95,-6174.43 1905.99,-6174.06 1909,-6173.7 2219.75,-6136.66 2583.05,-6103.02 2792.63,-6084.55"/>
<polygon fill="black" stroke="black" points="2793.15,-6088.02 2802.81,-6083.66 2792.54,-6081.05 2793.15,-6088.02"/>
</g>
<!-- expert_gelu_12_4 -->
<g id="node419" class="node">
<title>expert_gelu_12_4</title>
<polygon fill="lightcyan" stroke="black" points="3668.5,-6316.7 3489.5,-6316.7 3489.5,-6263.7 3668.5,-6263.7 3668.5,-6316.7"/>
<text text-anchor="middle" x="3579" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3579" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3579" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_4&#45;&gt;expert_gelu_12_4 -->
<g id="edge651" class="edge">
<title>expert_12_4&#45;&gt;expert_gelu_12_4</title>
<path fill="none" stroke="black" d="M3579,-6353.57C3579,-6344.99 3579,-6335.71 3579,-6327"/>
<polygon fill="black" stroke="black" points="3582.5,-6326.75 3579,-6316.75 3575.5,-6326.75 3582.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_4 -->
<g id="node420" class="node">
<title>expert_ffn2_12_4</title>
<polygon fill="lightcyan" stroke="black" points="3751.5,-6226.7 3406.5,-6226.7 3406.5,-6173.7 3751.5,-6173.7 3751.5,-6226.7"/>
<text text-anchor="middle" x="3579" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3579" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3579" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_4&#45;&gt;expert_ffn2_12_4 -->
<g id="edge652" class="edge">
<title>expert_gelu_12_4&#45;&gt;expert_ffn2_12_4</title>
<path fill="none" stroke="black" d="M3579,-6263.27C3579,-6255.04 3579,-6245.78 3579,-6236.98"/>
<polygon fill="black" stroke="black" points="3582.5,-6236.94 3579,-6226.94 3575.5,-6236.94 3582.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_4&#45;&gt;expert_agg_12 -->
<g id="edge653" class="edge">
<title>expert_ffn2_12_4&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M3458.26,-6173.69C3378.16,-6156.77 3270.9,-6134.11 3176.95,-6114.26"/>
<polygon fill="black" stroke="black" points="3177.53,-6110.81 3167.02,-6112.17 3176.08,-6117.66 3177.53,-6110.81"/>
</g>
<!-- expert_gelu_12_5 -->
<g id="node422" class="node">
<title>expert_gelu_12_5</title>
<polygon fill="lightcyan" stroke="black" points="4394.5,-6316.7 4215.5,-6316.7 4215.5,-6263.7 4394.5,-6263.7 4394.5,-6316.7"/>
<text text-anchor="middle" x="4305" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4305" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4305" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_5&#45;&gt;expert_gelu_12_5 -->
<g id="edge656" class="edge">
<title>expert_12_5&#45;&gt;expert_gelu_12_5</title>
<path fill="none" stroke="black" d="M4305,-6353.57C4305,-6344.99 4305,-6335.71 4305,-6327"/>
<polygon fill="black" stroke="black" points="4308.5,-6326.75 4305,-6316.75 4301.5,-6326.75 4308.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_5 -->
<g id="node423" class="node">
<title>expert_ffn2_12_5</title>
<polygon fill="lightcyan" stroke="black" points="4477.5,-6226.7 4132.5,-6226.7 4132.5,-6173.7 4477.5,-6173.7 4477.5,-6226.7"/>
<text text-anchor="middle" x="4305" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4305" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4305" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_5&#45;&gt;expert_ffn2_12_5 -->
<g id="edge657" class="edge">
<title>expert_gelu_12_5&#45;&gt;expert_ffn2_12_5</title>
<path fill="none" stroke="black" d="M4305,-6263.27C4305,-6255.04 4305,-6245.78 4305,-6236.98"/>
<polygon fill="black" stroke="black" points="4308.5,-6236.94 4305,-6226.94 4301.5,-6236.94 4308.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_5&#45;&gt;expert_agg_12 -->
<g id="edge658" class="edge">
<title>expert_ffn2_12_5&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M4132.1,-6174.65C4129.38,-6174.33 4126.68,-6174.01 4124,-6173.7 3784.89,-6134.61 3388.48,-6101.78 3158.45,-6084"/>
<polygon fill="black" stroke="black" points="3158.54,-6080.5 3148.3,-6083.22 3158.01,-6087.48 3158.54,-6080.5"/>
</g>
<!-- expert_gelu_12_6 -->
<g id="node425" class="node">
<title>expert_gelu_12_6</title>
<polygon fill="lightcyan" stroke="black" points="2542.5,-6316.7 2363.5,-6316.7 2363.5,-6263.7 2542.5,-6263.7 2542.5,-6316.7"/>
<text text-anchor="middle" x="2453" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2453" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2453" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_6&#45;&gt;expert_gelu_12_6 -->
<g id="edge661" class="edge">
<title>expert_12_6&#45;&gt;expert_gelu_12_6</title>
<path fill="none" stroke="black" d="M2453,-6353.57C2453,-6344.99 2453,-6335.71 2453,-6327"/>
<polygon fill="black" stroke="black" points="2456.5,-6326.75 2453,-6316.75 2449.5,-6326.75 2456.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_6 -->
<g id="node426" class="node">
<title>expert_ffn2_12_6</title>
<polygon fill="lightcyan" stroke="black" points="2625.5,-6226.7 2280.5,-6226.7 2280.5,-6173.7 2625.5,-6173.7 2625.5,-6226.7"/>
<text text-anchor="middle" x="2453" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2453" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2453" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_6&#45;&gt;expert_ffn2_12_6 -->
<g id="edge662" class="edge">
<title>expert_gelu_12_6&#45;&gt;expert_ffn2_12_6</title>
<path fill="none" stroke="black" d="M2453,-6263.27C2453,-6255.04 2453,-6245.78 2453,-6236.98"/>
<polygon fill="black" stroke="black" points="2456.5,-6236.94 2453,-6226.94 2449.5,-6236.94 2456.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_6&#45;&gt;expert_agg_12 -->
<g id="edge663" class="edge">
<title>expert_ffn2_12_6&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M2554.05,-6173.69C2626.49,-6155.41 2725.49,-6130.41 2808.28,-6109.51"/>
<polygon fill="black" stroke="black" points="2809.2,-6112.89 2818.04,-6107.05 2807.49,-6106.11 2809.2,-6112.89"/>
</g>
<!-- expert_gelu_12_7 -->
<g id="node428" class="node">
<title>expert_gelu_12_7</title>
<polygon fill="lightcyan" stroke="black" points="2905.5,-6316.7 2726.5,-6316.7 2726.5,-6263.7 2905.5,-6263.7 2905.5,-6316.7"/>
<text text-anchor="middle" x="2816" y="-6301.5" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2816" y="-6286.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2816" y="-6271.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_12_7&#45;&gt;expert_gelu_12_7 -->
<g id="edge666" class="edge">
<title>expert_12_7&#45;&gt;expert_gelu_12_7</title>
<path fill="none" stroke="black" d="M2816,-6353.57C2816,-6344.99 2816,-6335.71 2816,-6327"/>
<polygon fill="black" stroke="black" points="2819.5,-6326.75 2816,-6316.75 2812.5,-6326.75 2819.5,-6326.75"/>
</g>
<!-- expert_ffn2_12_7 -->
<g id="node429" class="node">
<title>expert_ffn2_12_7</title>
<polygon fill="lightcyan" stroke="black" points="2988.5,-6226.7 2643.5,-6226.7 2643.5,-6173.7 2988.5,-6173.7 2988.5,-6226.7"/>
<text text-anchor="middle" x="2816" y="-6211.5" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2816" y="-6196.5" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2816" y="-6181.5" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- expert_gelu_12_7&#45;&gt;expert_ffn2_12_7 -->
<g id="edge667" class="edge">
<title>expert_gelu_12_7&#45;&gt;expert_ffn2_12_7</title>
<path fill="none" stroke="black" d="M2816,-6263.27C2816,-6255.04 2816,-6245.78 2816,-6236.98"/>
<polygon fill="black" stroke="black" points="2819.5,-6236.94 2816,-6226.94 2812.5,-6236.94 2819.5,-6236.94"/>
</g>
<!-- expert_ffn2_12_7&#45;&gt;expert_agg_12 -->
<g id="edge668" class="edge">
<title>expert_ffn2_12_7&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="black" d="M2845.64,-6173.62C2855.89,-6164.76 2867.95,-6154.35 2880.41,-6143.59"/>
<polygon fill="black" stroke="black" points="2882.93,-6146.04 2888.21,-6136.86 2878.35,-6140.74 2882.93,-6146.04"/>
</g>
<!-- expert_agg_12&#45;&gt;residual2_12 -->
<g id="edge671" class="edge">
<title>expert_agg_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2779.44,-6047.31C2553.22,-6022.58 2167.3,-5980.39 1885.87,-5949.62"/>
<polygon fill="black" stroke="black" points="1886.23,-5946.14 1875.91,-5948.53 1885.47,-5953.1 1886.23,-5946.14"/>
</g>
<!-- comm_12_13 -->
<g id="node468" class="node">
<title>comm_12_13</title>
<ellipse fill="lightgreen" stroke="black" cx="1539" cy="-5793.83" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1539" y="-5797.63" font-family="Times,serif" font-size="14.00">GPU 11 → GPU 12</text>
<text text-anchor="middle" x="1539" y="-5782.63" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_12&#45;&gt;comm_12_13 -->
<g id="edge672" class="edge">
<title>residual2_12&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M1539,-5857.64C1539,-5848.71 1539,-5839.6 1539,-5831.2"/>
<polygon fill="black" stroke="black" points="1542.5,-5830.99 1539,-5820.99 1535.5,-5830.99 1542.5,-5830.99"/>
</g>
<!-- comm_11_12&#45;&gt;ln1_12 -->
<g id="edge617" class="edge">
<title>comm_11_12&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M1417.44,-7210.19C1400.35,-7199.92 1380.27,-7187.84 1362.18,-7176.97"/>
<polygon fill="black" stroke="black" points="1363.85,-7173.89 1353.48,-7171.74 1360.24,-7179.89 1363.85,-7173.89"/>
</g>
<!-- comm_11_12&#45;&gt;residual1_12 -->
<g id="edge625" class="edge">
<title>comm_11_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1545.31,-7217.01C1608.56,-7201.69 1683,-7177.1 1683,-7146.2 1683,-7146.2 1683,-7146.2 1683,-6874.2 1683,-6852.38 1672.74,-6834.05 1657.71,-6818.9"/>
<polygon fill="black" stroke="black" points="1659.68,-6815.96 1649.96,-6811.72 1654.92,-6821.09 1659.68,-6815.96"/>
</g>
<!-- ln1_13 -->
<g id="node433" class="node">
<title>ln1_13</title>
<polygon fill="lightyellow" stroke="black" points="1477,-5729.96 1307,-5729.96 1307,-5676.96 1477,-5676.96 1477,-5729.96"/>
<text text-anchor="middle" x="1392" y="-5714.76" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1392" y="-5699.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1392" y="-5684.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_q_13 -->
<g id="node434" class="node">
<title>mha_q_13</title>
<polygon fill="lightblue" stroke="black" points="1736,-5639.96 1400,-5639.96 1400,-5586.96 1736,-5586.96 1736,-5639.96"/>
<text text-anchor="middle" x="1568" y="-5624.76" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1568" y="-5609.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1568" y="-5594.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_q_13 -->
<g id="edge674" class="edge">
<title>ln1_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M1443.38,-5676.77C1463.53,-5666.69 1486.8,-5655.06 1507.74,-5644.59"/>
<polygon fill="black" stroke="black" points="1509.48,-5647.63 1516.86,-5640.03 1506.35,-5641.37 1509.48,-5647.63"/>
</g>
<!-- mha_k_13 -->
<g id="node435" class="node">
<title>mha_k_13</title>
<polygon fill="lightblue" stroke="black" points="1028,-5639.96 692,-5639.96 692,-5586.96 1028,-5586.96 1028,-5639.96"/>
<text text-anchor="middle" x="860" y="-5624.76" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="860" y="-5609.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="860" y="-5594.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_k_13 -->
<g id="edge675" class="edge">
<title>ln1_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M1306.82,-5688.37C1230.99,-5675.83 1117.93,-5657.13 1024.51,-5641.67"/>
<polygon fill="black" stroke="black" points="1024.82,-5638.18 1014.38,-5640 1023.68,-5645.08 1024.82,-5638.18"/>
</g>
<!-- mha_v_13 -->
<g id="node436" class="node">
<title>mha_v_13</title>
<polygon fill="lightblue" stroke="black" points="1382,-5639.96 1046,-5639.96 1046,-5586.96 1382,-5586.96 1382,-5639.96"/>
<text text-anchor="middle" x="1214" y="-5624.76" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1214" y="-5609.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1214" y="-5594.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_v_13 -->
<g id="edge676" class="edge">
<title>ln1_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M1340.04,-5676.77C1319.66,-5666.69 1296.12,-5655.06 1274.95,-5644.59"/>
<polygon fill="black" stroke="black" points="1276.24,-5641.32 1265.72,-5640.03 1273.13,-5647.6 1276.24,-5641.32"/>
</g>
<!-- mha_attn_13 -->
<g id="node437" class="node">
<title>mha_attn_13</title>
<polygon fill="lightblue" stroke="black" points="1385,-5549.96 1215,-5549.96 1215,-5496.96 1385,-5496.96 1385,-5549.96"/>
<text text-anchor="middle" x="1300" y="-5534.76" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1300" y="-5519.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1300" y="-5504.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge677" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1490.12,-5586.89C1458.05,-5576.36 1420.75,-5564.11 1387.72,-5553.26"/>
<polygon fill="black" stroke="black" points="1388.66,-5549.89 1378.07,-5550.1 1386.48,-5556.54 1388.66,-5549.89"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge678" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M987.56,-5586.95C1056.94,-5573.07 1141.3,-5556.2 1204.87,-5543.49"/>
<polygon fill="black" stroke="black" points="1205.77,-5546.88 1214.89,-5541.48 1204.39,-5540.01 1205.77,-5546.88"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge679" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1239.34,-5586.53C1248.26,-5577.4 1258.41,-5567.02 1267.82,-5557.39"/>
<polygon fill="black" stroke="black" points="1270.36,-5559.8 1274.84,-5550.2 1265.35,-5554.91 1270.36,-5559.8"/>
</g>
<!-- mha_out_13 -->
<g id="node438" class="node">
<title>mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="1730,-5459.96 1394,-5459.96 1394,-5406.96 1730,-5406.96 1730,-5459.96"/>
<text text-anchor="middle" x="1562" y="-5444.76" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1562" y="-5429.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1562" y="-5414.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge680" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M1376.13,-5496.89C1407.35,-5486.4 1443.64,-5474.21 1475.83,-5463.4"/>
<polygon fill="black" stroke="black" points="1477.31,-5466.6 1485.68,-5460.1 1475.08,-5459.96 1477.31,-5466.6"/>
</g>
<!-- residual1_13 -->
<g id="node439" class="node">
<title>residual1_13</title>
<polygon fill="lightcoral" stroke="black" points="2059.86,-5369.96 1490.58,-5369.96 1344.14,-5263.96 1913.42,-5263.96 2059.86,-5369.96"/>
<text text-anchor="middle" x="1702" y="-5328.26" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1702" y="-5313.26" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1702" y="-5298.26" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge682" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1593.42,-5406.76C1604.43,-5397.76 1617.3,-5387.23 1630.25,-5376.64"/>
<polygon fill="black" stroke="black" points="1632.79,-5379.09 1638.31,-5370.05 1628.35,-5373.67 1632.79,-5379.09"/>
</g>
<!-- ln2_13 -->
<g id="node440" class="node">
<title>ln2_13</title>
<polygon fill="lightyellow" stroke="black" points="3084,-5226.96 2914,-5226.96 2914,-5173.96 3084,-5173.96 3084,-5226.96"/>
<text text-anchor="middle" x="2999" y="-5211.76" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="2999" y="-5196.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2999" y="-5181.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge683" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M1954.77,-5293.65C2244.74,-5268.05 2705.62,-5227.36 2903.56,-5209.89"/>
<polygon fill="black" stroke="black" points="2903.99,-5213.36 2913.64,-5209 2903.37,-5206.39 2903.99,-5213.36"/>
</g>
<!-- residual2_13 -->
<g id="node467" class="node">
<title>residual2_13</title>
<polygon fill="lightcoral" stroke="black" points="2059.86,-4521.96 1490.58,-4521.96 1344.14,-4415.96 1913.42,-4415.96 2059.86,-4521.96"/>
<text text-anchor="middle" x="1702" y="-4480.26" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1702" y="-4465.26" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1702" y="-4450.26" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge726" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M1694.23,-5263.93C1691.92,-5244.38 1690,-5221.95 1690,-5201.46 1690,-5201.46 1690,-5201.46 1690,-4625.96 1690,-4595.12 1692.36,-4560.94 1694.99,-4532.46"/>
<polygon fill="black" stroke="black" points="1698.5,-4532.53 1695.96,-4522.24 1691.53,-4531.86 1698.5,-4532.53"/>
</g>
<!-- gate_13 -->
<g id="node441" class="node">
<title>gate_13</title>
<polygon fill="orange" stroke="black" points="3168,-5136.96 2859,-5083.96 3168,-5030.96 3477,-5083.96 3168,-5136.96"/>
<text text-anchor="middle" x="3168" y="-5095.26" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3168" y="-5080.26" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="3168" y="-5065.26" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;gate_13 -->
<g id="edge684" class="edge">
<title>ln2_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M3036.93,-5173.76C3055.05,-5161.48 3077.34,-5146.38 3098.36,-5132.14"/>
<polygon fill="black" stroke="black" points="3100.34,-5135.03 3106.65,-5126.52 3096.41,-5129.24 3100.34,-5135.03"/>
</g>
<!-- expert_13_0 -->
<g id="node442" class="node">
<title>expert_13_0</title>
<polygon fill="lightcyan" stroke="black" points="2425.5,-4979.96 2080.5,-4979.96 2080.5,-4911.96 2425.5,-4911.96 2425.5,-4979.96"/>
<text text-anchor="middle" x="2253" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2253" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2253" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2253" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_0 -->
<g id="edge686" class="edge">
<title>ln2_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" d="M2913.9,-5191.81C2778.44,-5176.36 2509.43,-5132.09 2317,-5012.96 2305.97,-5006.13 2295.49,-4996.99 2286.33,-4987.69"/>
<polygon fill="black" stroke="black" points="2288.69,-4985.09 2279.28,-4980.23 2283.61,-4989.9 2288.69,-4985.09"/>
</g>
<!-- expert_13_1 -->
<g id="node445" class="node">
<title>expert_13_1</title>
<polygon fill="lightcyan" stroke="black" points="3551.5,-4979.96 3206.5,-4979.96 3206.5,-4911.96 3551.5,-4911.96 3551.5,-4979.96"/>
<text text-anchor="middle" x="3379" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3379" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3379" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3379" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_1 -->
<g id="edge691" class="edge">
<title>ln2_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" d="M3084.19,-5194.43C3216.57,-5185.75 3459.35,-5166.05 3486,-5136.96 3527.76,-5091.38 3524.45,-5049.95 3491,-4997.96 3488.46,-4994.01 3485.53,-4990.37 3482.3,-4987"/>
<polygon fill="black" stroke="black" points="3484.5,-4984.27 3474.77,-4980.07 3479.76,-4989.42 3484.5,-4984.27"/>
</g>
<!-- expert_13_2 -->
<g id="node448" class="node">
<title>expert_13_2</title>
<polygon fill="lightcyan" stroke="black" points="4277.5,-4979.96 3932.5,-4979.96 3932.5,-4911.96 4277.5,-4911.96 4277.5,-4979.96"/>
<text text-anchor="middle" x="4105" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4105" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4105" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4105" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_2 -->
<g id="edge696" class="edge">
<title>ln2_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" d="M3084.15,-5193.43C3180.25,-5186.24 3341.15,-5173.01 3479,-5155.96 3747.63,-5122.73 3859.89,-5182.37 4071,-5012.96 4078.76,-5006.73 4084.93,-4998.26 4089.77,-4989.46"/>
<polygon fill="black" stroke="black" points="4093.02,-4990.77 4094.33,-4980.26 4086.75,-4987.66 4093.02,-4990.77"/>
</g>
<!-- expert_13_3 -->
<g id="node451" class="node">
<title>expert_13_3</title>
<polygon fill="lightcyan" stroke="black" points="2062.5,-4979.96 1717.5,-4979.96 1717.5,-4911.96 2062.5,-4911.96 2062.5,-4979.96"/>
<text text-anchor="middle" x="1890" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1890" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="1890" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1890" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_3 -->
<g id="edge701" class="edge">
<title>ln2_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" d="M2913.88,-5199.45C2787.59,-5197.62 2543.99,-5187.12 2344,-5136.96 2202.92,-5101.58 2048.73,-5029.24 1961.23,-4984.74"/>
<polygon fill="black" stroke="black" points="1962.7,-4981.56 1952.2,-4980.12 1959.51,-4987.79 1962.7,-4981.56"/>
</g>
<!-- expert_13_4 -->
<g id="node454" class="node">
<title>expert_13_4</title>
<polygon fill="lightcyan" stroke="black" points="3914.5,-4979.96 3569.5,-4979.96 3569.5,-4911.96 3914.5,-4911.96 3914.5,-4979.96"/>
<text text-anchor="middle" x="3742" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3742" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3742" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3742" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_4 -->
<g id="edge706" class="edge">
<title>ln2_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" d="M3084.24,-5196.6C3211.1,-5191.09 3442.45,-5175.91 3515,-5136.96 3589.26,-5097.09 3661.54,-5030.32 3703.9,-4987.48"/>
<polygon fill="black" stroke="black" points="3706.44,-4989.89 3710.95,-4980.3 3701.45,-4984.99 3706.44,-4989.89"/>
</g>
<!-- expert_13_5 -->
<g id="node457" class="node">
<title>expert_13_5</title>
<polygon fill="lightcyan" stroke="black" points="4640.5,-4979.96 4295.5,-4979.96 4295.5,-4911.96 4640.5,-4911.96 4640.5,-4979.96"/>
<text text-anchor="middle" x="4468" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4468" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4468" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4468" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_5 -->
<g id="edge711" class="edge">
<title>ln2_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" d="M3084.22,-5196.68C3282.12,-5189.74 3768.08,-5169.84 3928,-5136.96 4095.02,-5102.63 4280.72,-5028.97 4385.04,-4984.12"/>
<polygon fill="black" stroke="black" points="4386.46,-4987.32 4394.26,-4980.14 4383.69,-4980.89 4386.46,-4987.32"/>
</g>
<!-- expert_13_6 -->
<g id="node460" class="node">
<title>expert_13_6</title>
<polygon fill="lightcyan" stroke="black" points="2788.5,-4979.96 2443.5,-4979.96 2443.5,-4911.96 2788.5,-4911.96 2788.5,-4979.96"/>
<text text-anchor="middle" x="2616" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2616" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2616" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2616" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_6 -->
<g id="edge716" class="edge">
<title>ln2_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" d="M2913.67,-5175.13C2896.35,-5169.43 2878.42,-5162.95 2862,-5155.96 2762.2,-5113.48 2757.24,-5069.83 2676,-4997.96 2671.9,-4994.34 2667.62,-4990.6 2663.32,-4986.88"/>
<polygon fill="black" stroke="black" points="2665.43,-4984.08 2655.57,-4980.21 2660.86,-4989.38 2665.43,-4984.08"/>
</g>
<!-- expert_13_7 -->
<g id="node463" class="node">
<title>expert_13_7</title>
<polygon fill="lightcyan" stroke="black" points="3151.5,-4979.96 2806.5,-4979.96 2806.5,-4911.96 3151.5,-4911.96 3151.5,-4979.96"/>
<text text-anchor="middle" x="2979" y="-4964.76" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="2979" y="-4949.76" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2979" y="-4934.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2979" y="-4919.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;expert_13_7 -->
<g id="edge721" class="edge">
<title>ln2_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" d="M2913.84,-5182.72C2889.08,-5173.48 2864.76,-5159.15 2850,-5136.96 2823.91,-5097.73 2827.55,-5072.38 2850,-5030.96 2859.96,-5012.59 2875.87,-4997.6 2893.17,-4985.65"/>
<polygon fill="black" stroke="black" points="2895.31,-4988.43 2901.76,-4980.02 2891.48,-4982.57 2895.31,-4988.43"/>
</g>
<!-- gate_13&#45;&gt;expert_13_0 -->
<g id="edge685" class="edge">
<title>gate_13&#45;&gt;expert_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2994.8,-5060.6C2848.55,-5041.25 2633.39,-5011.7 2435.88,-4980.08"/>
<polygon fill="black" stroke="black" points="2436.32,-4976.61 2425.89,-4978.48 2435.21,-4983.52 2436.32,-4976.61"/>
<text text-anchor="middle" x="2680.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_1 -->
<g id="edge690" class="edge">
<title>gate_13&#45;&gt;expert_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3218.59,-5039.62C3236.19,-5025.52 3256.43,-5010.32 3276,-4997.96 3283.09,-4993.48 3290.64,-4989.1 3298.29,-4984.9"/>
<polygon fill="black" stroke="black" points="3300.15,-4987.87 3307.3,-4980.06 3296.83,-4981.71 3300.15,-4987.87"/>
<text text-anchor="middle" x="3321.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_2 -->
<g id="edge695" class="edge">
<title>gate_13&#45;&gt;expert_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3344.38,-5061.21C3495.34,-5042.06 3718.64,-5012.46 3922.12,-4980.24"/>
<polygon fill="black" stroke="black" points="3922.78,-4983.68 3932.1,-4978.66 3921.68,-4976.77 3922.78,-4983.68"/>
<text text-anchor="middle" x="3845.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_3 -->
<g id="edge700" class="edge">
<title>gate_13&#45;&gt;expert_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2951.35,-5068.1C2732.19,-5051.8 2383.59,-5022.37 2072.97,-4980.06"/>
<polygon fill="black" stroke="black" points="2073.24,-4976.56 2062.86,-4978.67 2072.29,-4983.5 2073.24,-4976.56"/>
<text text-anchor="middle" x="2386.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_4 -->
<g id="edge705" class="edge">
<title>gate_13&#45;&gt;expert_13_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3272.92,-5048.95C3327.43,-5032.08 3395.37,-5012.31 3457,-4997.96 3499.74,-4988.01 3513.11,-4988.11 3559.09,-4980.26"/>
<polygon fill="black" stroke="black" points="3559.83,-4983.69 3569.08,-4978.52 3558.63,-4976.79 3559.83,-4983.69"/>
<text text-anchor="middle" x="3502.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_5 -->
<g id="edge710" class="edge">
<title>gate_13&#45;&gt;expert_13_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3387.36,-5068.54C3611.02,-5052.49 3968.04,-5023.2 4284.82,-4980.23"/>
<polygon fill="black" stroke="black" points="4285.69,-4983.64 4295.13,-4978.82 4284.75,-4976.7 4285.69,-4983.64"/>
<text text-anchor="middle" x="4180.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_6 -->
<g id="edge715" class="edge">
<title>gate_13&#45;&gt;expert_13_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3043.43,-5052.27C2959.3,-5031.54 2847.98,-5004.11 2760.03,-4982.45"/>
<polygon fill="black" stroke="black" points="2760.79,-4979.03 2750.25,-4980.04 2759.12,-4985.83 2760.79,-4979.03"/>
<text text-anchor="middle" x="2920.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_13&#45;&gt;expert_13_7 -->
<g id="edge720" class="edge">
<title>gate_13&#45;&gt;expert_13_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3109.49,-5040.86C3085.15,-5023.34 3057.06,-5003.13 3033.2,-4985.96"/>
<polygon fill="black" stroke="black" points="3035.11,-4983.02 3024.94,-4980.02 3031.02,-4988.7 3035.11,-4983.02"/>
<text text-anchor="middle" x="3112.5" y="-5001.76" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_13 -->
<g id="node466" class="node">
<title>expert_agg_13</title>
<polygon fill="lightpink" stroke="black" points="3339.86,-4694.96 2994.88,-4694.96 2906.14,-4558.96 3251.12,-4558.96 3339.86,-4694.96"/>
<text text-anchor="middle" x="3123" y="-4645.76" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3123" y="-4630.76" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="3123" y="-4615.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3123" y="-4600.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- gate_13&#45;&gt;expert_agg_13 -->
<g id="edge725" class="edge">
<title>gate_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3174.11,-5031.7C3176.64,-5006.25 3179,-4975.03 3179,-4946.96 3179,-4946.96 3179,-4946.96 3179,-4757.46 3179,-4739.75 3174.53,-4721.71 3168.12,-4704.94"/>
<polygon fill="black" stroke="black" points="3171.17,-4703.16 3164.14,-4695.23 3164.69,-4705.81 3171.17,-4703.16"/>
<text text-anchor="middle" x="3207.5" y="-4844.76" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_13_0 -->
<g id="node443" class="node">
<title>expert_gelu_13_0</title>
<polygon fill="lightcyan" stroke="black" points="2342.5,-4874.96 2163.5,-4874.96 2163.5,-4821.96 2342.5,-4821.96 2342.5,-4874.96"/>
<text text-anchor="middle" x="2253" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2253" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2253" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_0&#45;&gt;expert_gelu_13_0 -->
<g id="edge687" class="edge">
<title>expert_13_0&#45;&gt;expert_gelu_13_0</title>
<path fill="none" stroke="black" d="M2253,-4911.83C2253,-4903.25 2253,-4893.97 2253,-4885.26"/>
<polygon fill="black" stroke="black" points="2256.5,-4885.01 2253,-4875.01 2249.5,-4885.01 2256.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_0 -->
<g id="node444" class="node">
<title>expert_ffn2_13_0</title>
<polygon fill="lightcyan" stroke="black" points="2425.5,-4784.96 2080.5,-4784.96 2080.5,-4731.96 2425.5,-4731.96 2425.5,-4784.96"/>
<text text-anchor="middle" x="2253" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2253" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2253" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_0&#45;&gt;expert_ffn2_13_0 -->
<g id="edge688" class="edge">
<title>expert_gelu_13_0&#45;&gt;expert_ffn2_13_0</title>
<path fill="none" stroke="black" d="M2253,-4821.53C2253,-4813.3 2253,-4804.04 2253,-4795.24"/>
<polygon fill="black" stroke="black" points="2256.5,-4795.2 2253,-4785.2 2249.5,-4795.2 2256.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_0&#45;&gt;expert_agg_13 -->
<g id="edge689" class="edge">
<title>expert_ffn2_13_0&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2424.36,-4731.95C2578.52,-4709.01 2803.61,-4675.5 2956.31,-4652.77"/>
<polygon fill="black" stroke="black" points="2956.89,-4656.22 2966.26,-4651.29 2955.86,-4649.3 2956.89,-4656.22"/>
</g>
<!-- expert_gelu_13_1 -->
<g id="node446" class="node">
<title>expert_gelu_13_1</title>
<polygon fill="lightcyan" stroke="black" points="3468.5,-4874.96 3289.5,-4874.96 3289.5,-4821.96 3468.5,-4821.96 3468.5,-4874.96"/>
<text text-anchor="middle" x="3379" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3379" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3379" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_1&#45;&gt;expert_gelu_13_1 -->
<g id="edge692" class="edge">
<title>expert_13_1&#45;&gt;expert_gelu_13_1</title>
<path fill="none" stroke="black" d="M3379,-4911.83C3379,-4903.25 3379,-4893.97 3379,-4885.26"/>
<polygon fill="black" stroke="black" points="3382.5,-4885.01 3379,-4875.01 3375.5,-4885.01 3382.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_1 -->
<g id="node447" class="node">
<title>expert_ffn2_13_1</title>
<polygon fill="lightcyan" stroke="black" points="3551.5,-4784.96 3206.5,-4784.96 3206.5,-4731.96 3551.5,-4731.96 3551.5,-4784.96"/>
<text text-anchor="middle" x="3379" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3379" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3379" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_1&#45;&gt;expert_ffn2_13_1 -->
<g id="edge693" class="edge">
<title>expert_gelu_13_1&#45;&gt;expert_ffn2_13_1</title>
<path fill="none" stroke="black" d="M3379,-4821.53C3379,-4813.3 3379,-4804.04 3379,-4795.24"/>
<polygon fill="black" stroke="black" points="3382.5,-4795.2 3379,-4785.2 3375.5,-4795.2 3382.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_1&#45;&gt;expert_agg_13 -->
<g id="edge694" class="edge">
<title>expert_ffn2_13_1&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3328.42,-4731.88C3309.71,-4722.41 3287.45,-4711.15 3264.61,-4699.6"/>
<polygon fill="black" stroke="black" points="3266,-4696.37 3255.49,-4694.98 3262.84,-4702.62 3266,-4696.37"/>
</g>
<!-- expert_gelu_13_2 -->
<g id="node449" class="node">
<title>expert_gelu_13_2</title>
<polygon fill="lightcyan" stroke="black" points="4194.5,-4874.96 4015.5,-4874.96 4015.5,-4821.96 4194.5,-4821.96 4194.5,-4874.96"/>
<text text-anchor="middle" x="4105" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4105" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4105" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_2&#45;&gt;expert_gelu_13_2 -->
<g id="edge697" class="edge">
<title>expert_13_2&#45;&gt;expert_gelu_13_2</title>
<path fill="none" stroke="black" d="M4105,-4911.83C4105,-4903.25 4105,-4893.97 4105,-4885.26"/>
<polygon fill="black" stroke="black" points="4108.5,-4885.01 4105,-4875.01 4101.5,-4885.01 4108.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_2 -->
<g id="node450" class="node">
<title>expert_ffn2_13_2</title>
<polygon fill="lightcyan" stroke="black" points="4277.5,-4784.96 3932.5,-4784.96 3932.5,-4731.96 4277.5,-4731.96 4277.5,-4784.96"/>
<text text-anchor="middle" x="4105" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="4105" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4105" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_2&#45;&gt;expert_ffn2_13_2 -->
<g id="edge698" class="edge">
<title>expert_gelu_13_2&#45;&gt;expert_ffn2_13_2</title>
<path fill="none" stroke="black" d="M4105,-4821.53C4105,-4813.3 4105,-4804.04 4105,-4795.24"/>
<polygon fill="black" stroke="black" points="4108.5,-4795.2 4105,-4785.2 4101.5,-4795.2 4108.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_2&#45;&gt;expert_agg_13 -->
<g id="edge699" class="edge">
<title>expert_ffn2_13_2&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3932.08,-4733.06C3929.37,-4732.69 3926.67,-4732.32 3924,-4731.96 3718.98,-4704.21 3484.23,-4673.9 3322.11,-4653.2"/>
<polygon fill="black" stroke="black" points="3322.39,-4649.71 3312.03,-4651.92 3321.5,-4656.65 3322.39,-4649.71"/>
</g>
<!-- expert_gelu_13_3 -->
<g id="node452" class="node">
<title>expert_gelu_13_3</title>
<polygon fill="lightcyan" stroke="black" points="1979.5,-4874.96 1800.5,-4874.96 1800.5,-4821.96 1979.5,-4821.96 1979.5,-4874.96"/>
<text text-anchor="middle" x="1890" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1890" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="1890" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_3&#45;&gt;expert_gelu_13_3 -->
<g id="edge702" class="edge">
<title>expert_13_3&#45;&gt;expert_gelu_13_3</title>
<path fill="none" stroke="black" d="M1890,-4911.83C1890,-4903.25 1890,-4893.97 1890,-4885.26"/>
<polygon fill="black" stroke="black" points="1893.5,-4885.01 1890,-4875.01 1886.5,-4885.01 1893.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_3 -->
<g id="node453" class="node">
<title>expert_ffn2_13_3</title>
<polygon fill="lightcyan" stroke="black" points="2062.5,-4784.96 1717.5,-4784.96 1717.5,-4731.96 2062.5,-4731.96 2062.5,-4784.96"/>
<text text-anchor="middle" x="1890" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="1890" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1890" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_3&#45;&gt;expert_ffn2_13_3 -->
<g id="edge703" class="edge">
<title>expert_gelu_13_3&#45;&gt;expert_ffn2_13_3</title>
<path fill="none" stroke="black" d="M1890,-4821.53C1890,-4813.3 1890,-4804.04 1890,-4795.24"/>
<polygon fill="black" stroke="black" points="1893.5,-4795.2 1890,-4785.2 1886.5,-4795.2 1893.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_3&#45;&gt;expert_agg_13 -->
<g id="edge704" class="edge">
<title>expert_ffn2_13_3&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2062.9,-4733.06C2065.95,-4732.69 2068.99,-4732.32 2072,-4731.96 2380.77,-4695.07 2741.7,-4661.41 2950.17,-4642.9"/>
<polygon fill="black" stroke="black" points="2950.63,-4646.37 2960.29,-4642 2950.02,-4639.4 2950.63,-4646.37"/>
</g>
<!-- expert_gelu_13_4 -->
<g id="node455" class="node">
<title>expert_gelu_13_4</title>
<polygon fill="lightcyan" stroke="black" points="3831.5,-4874.96 3652.5,-4874.96 3652.5,-4821.96 3831.5,-4821.96 3831.5,-4874.96"/>
<text text-anchor="middle" x="3742" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3742" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3742" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_4&#45;&gt;expert_gelu_13_4 -->
<g id="edge707" class="edge">
<title>expert_13_4&#45;&gt;expert_gelu_13_4</title>
<path fill="none" stroke="black" d="M3742,-4911.83C3742,-4903.25 3742,-4893.97 3742,-4885.26"/>
<polygon fill="black" stroke="black" points="3745.5,-4885.01 3742,-4875.01 3738.5,-4885.01 3745.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_4 -->
<g id="node456" class="node">
<title>expert_ffn2_13_4</title>
<polygon fill="lightcyan" stroke="black" points="3914.5,-4784.96 3569.5,-4784.96 3569.5,-4731.96 3914.5,-4731.96 3914.5,-4784.96"/>
<text text-anchor="middle" x="3742" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3742" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3742" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_4&#45;&gt;expert_ffn2_13_4 -->
<g id="edge708" class="edge">
<title>expert_gelu_13_4&#45;&gt;expert_ffn2_13_4</title>
<path fill="none" stroke="black" d="M3742,-4821.53C3742,-4813.3 3742,-4804.04 3742,-4795.24"/>
<polygon fill="black" stroke="black" points="3745.5,-4795.2 3742,-4785.2 3738.5,-4795.2 3745.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_4&#45;&gt;expert_agg_13 -->
<g id="edge709" class="edge">
<title>expert_ffn2_13_4&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3620.07,-4731.95C3538.44,-4714.87 3428.84,-4691.94 3333.33,-4671.96"/>
<polygon fill="black" stroke="black" points="3334.05,-4668.54 3323.54,-4669.92 3332.61,-4675.39 3334.05,-4668.54"/>
</g>
<!-- expert_gelu_13_5 -->
<g id="node458" class="node">
<title>expert_gelu_13_5</title>
<polygon fill="lightcyan" stroke="black" points="4557.5,-4874.96 4378.5,-4874.96 4378.5,-4821.96 4557.5,-4821.96 4557.5,-4874.96"/>
<text text-anchor="middle" x="4468" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4468" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4468" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_5&#45;&gt;expert_gelu_13_5 -->
<g id="edge712" class="edge">
<title>expert_13_5&#45;&gt;expert_gelu_13_5</title>
<path fill="none" stroke="black" d="M4468,-4911.83C4468,-4903.25 4468,-4893.97 4468,-4885.26"/>
<polygon fill="black" stroke="black" points="4471.5,-4885.01 4468,-4875.01 4464.5,-4885.01 4471.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_5 -->
<g id="node459" class="node">
<title>expert_ffn2_13_5</title>
<polygon fill="lightcyan" stroke="black" points="4640.5,-4784.96 4295.5,-4784.96 4295.5,-4731.96 4640.5,-4731.96 4640.5,-4784.96"/>
<text text-anchor="middle" x="4468" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4468" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4468" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_5&#45;&gt;expert_ffn2_13_5 -->
<g id="edge713" class="edge">
<title>expert_gelu_13_5&#45;&gt;expert_ffn2_13_5</title>
<path fill="none" stroke="black" d="M4468,-4821.53C4468,-4813.3 4468,-4804.04 4468,-4795.24"/>
<polygon fill="black" stroke="black" points="4471.5,-4795.2 4468,-4785.2 4464.5,-4795.2 4471.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_5&#45;&gt;expert_agg_13 -->
<g id="edge714" class="edge">
<title>expert_ffn2_13_5&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M4295.1,-4732.91C4292.38,-4732.58 4289.68,-4732.27 4287,-4731.96 3945.52,-4692.68 3546.22,-4659.84 3315.19,-4642.12"/>
<polygon fill="black" stroke="black" points="3315.24,-4638.61 3305,-4641.34 3314.7,-4645.59 3315.24,-4638.61"/>
</g>
<!-- expert_gelu_13_6 -->
<g id="node461" class="node">
<title>expert_gelu_13_6</title>
<polygon fill="lightcyan" stroke="black" points="2705.5,-4874.96 2526.5,-4874.96 2526.5,-4821.96 2705.5,-4821.96 2705.5,-4874.96"/>
<text text-anchor="middle" x="2616" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2616" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2616" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_6&#45;&gt;expert_gelu_13_6 -->
<g id="edge717" class="edge">
<title>expert_13_6&#45;&gt;expert_gelu_13_6</title>
<path fill="none" stroke="black" d="M2616,-4911.83C2616,-4903.25 2616,-4893.97 2616,-4885.26"/>
<polygon fill="black" stroke="black" points="2619.5,-4885.01 2616,-4875.01 2612.5,-4885.01 2619.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_6 -->
<g id="node462" class="node">
<title>expert_ffn2_13_6</title>
<polygon fill="lightcyan" stroke="black" points="2788.5,-4784.96 2443.5,-4784.96 2443.5,-4731.96 2788.5,-4731.96 2788.5,-4784.96"/>
<text text-anchor="middle" x="2616" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2616" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2616" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_6&#45;&gt;expert_ffn2_13_6 -->
<g id="edge718" class="edge">
<title>expert_gelu_13_6&#45;&gt;expert_ffn2_13_6</title>
<path fill="none" stroke="black" d="M2616,-4821.53C2616,-4813.3 2616,-4804.04 2616,-4795.24"/>
<polygon fill="black" stroke="black" points="2619.5,-4795.2 2616,-4785.2 2612.5,-4795.2 2619.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_6&#45;&gt;expert_agg_13 -->
<g id="edge719" class="edge">
<title>expert_ffn2_13_6&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M2715.86,-4731.95C2786.97,-4713.79 2883.97,-4689.01 2965.45,-4668.2"/>
<polygon fill="black" stroke="black" points="2966.49,-4671.55 2975.31,-4665.68 2964.75,-4664.77 2966.49,-4671.55"/>
</g>
<!-- expert_gelu_13_7 -->
<g id="node464" class="node">
<title>expert_gelu_13_7</title>
<polygon fill="lightcyan" stroke="black" points="3068.5,-4874.96 2889.5,-4874.96 2889.5,-4821.96 3068.5,-4821.96 3068.5,-4874.96"/>
<text text-anchor="middle" x="2979" y="-4859.76" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2979" y="-4844.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2979" y="-4829.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_13_7&#45;&gt;expert_gelu_13_7 -->
<g id="edge722" class="edge">
<title>expert_13_7&#45;&gt;expert_gelu_13_7</title>
<path fill="none" stroke="black" d="M2979,-4911.83C2979,-4903.25 2979,-4893.97 2979,-4885.26"/>
<polygon fill="black" stroke="black" points="2982.5,-4885.01 2979,-4875.01 2975.5,-4885.01 2982.5,-4885.01"/>
</g>
<!-- expert_ffn2_13_7 -->
<g id="node465" class="node">
<title>expert_ffn2_13_7</title>
<polygon fill="lightcyan" stroke="black" points="3151.5,-4784.96 2806.5,-4784.96 2806.5,-4731.96 3151.5,-4731.96 3151.5,-4784.96"/>
<text text-anchor="middle" x="2979" y="-4769.76" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="2979" y="-4754.76" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2979" y="-4739.76" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- expert_gelu_13_7&#45;&gt;expert_ffn2_13_7 -->
<g id="edge723" class="edge">
<title>expert_gelu_13_7&#45;&gt;expert_ffn2_13_7</title>
<path fill="none" stroke="black" d="M2979,-4821.53C2979,-4813.3 2979,-4804.04 2979,-4795.24"/>
<polygon fill="black" stroke="black" points="2982.5,-4795.2 2979,-4785.2 2975.5,-4795.2 2982.5,-4795.2"/>
</g>
<!-- expert_ffn2_13_7&#45;&gt;expert_agg_13 -->
<g id="edge724" class="edge">
<title>expert_ffn2_13_7&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="black" d="M3007.45,-4731.88C3017.29,-4723.02 3028.87,-4712.61 3040.84,-4701.85"/>
<polygon fill="black" stroke="black" points="3043.23,-4704.41 3048.32,-4695.12 3038.55,-4699.2 3043.23,-4704.41"/>
</g>
<!-- expert_agg_13&#45;&gt;residual2_13 -->
<g id="edge727" class="edge">
<title>expert_agg_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M2936.13,-4605.45C2711.32,-4580.77 2329.28,-4538.82 2049.69,-4508.13"/>
<polygon fill="black" stroke="black" points="2049.7,-4504.61 2039.37,-4507 2048.93,-4511.57 2049.7,-4504.61"/>
</g>
<!-- comm_13_14 -->
<g id="node504" class="node">
<title>comm_13_14</title>
<ellipse fill="lightgreen" stroke="black" cx="1702" cy="-4352.09" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1702" y="-4355.89" font-family="Times,serif" font-size="14.00">GPU 12 → GPU 13</text>
<text text-anchor="middle" x="1702" y="-4340.89" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_13&#45;&gt;comm_13_14 -->
<g id="edge728" class="edge">
<title>residual2_13&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M1702,-4415.9C1702,-4406.97 1702,-4397.86 1702,-4389.46"/>
<polygon fill="black" stroke="black" points="1705.5,-4389.25 1702,-4379.25 1698.5,-4389.25 1705.5,-4389.25"/>
</g>
<!-- comm_12_13&#45;&gt;ln1_13 -->
<g id="edge673" class="edge">
<title>comm_12_13&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M1498.44,-5768.45C1481.35,-5758.18 1461.27,-5746.1 1443.18,-5735.23"/>
<polygon fill="black" stroke="black" points="1444.85,-5732.15 1434.48,-5730 1441.24,-5738.15 1444.85,-5732.15"/>
</g>
<!-- comm_12_13&#45;&gt;residual1_13 -->
<g id="edge681" class="edge">
<title>comm_12_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1626.31,-5775.27C1689.56,-5759.95 1764,-5735.36 1764,-5704.46 1764,-5704.46 1764,-5704.46 1764,-5432.46 1764,-5413.96 1757.66,-5395.58 1749.04,-5379.15"/>
<polygon fill="black" stroke="black" points="1751.98,-5377.24 1744.04,-5370.23 1745.88,-5380.66 1751.98,-5377.24"/>
</g>
<!-- ln1_14 -->
<g id="node469" class="node">
<title>ln1_14</title>
<polygon fill="lightyellow" stroke="black" points="1640,-4288.22 1470,-4288.22 1470,-4235.22 1640,-4235.22 1640,-4288.22"/>
<text text-anchor="middle" x="1555" y="-4273.02" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1555" y="-4258.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1555" y="-4243.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_q_14 -->
<g id="node470" class="node">
<title>mha_q_14</title>
<polygon fill="lightblue" stroke="black" points="1899,-4198.22 1563,-4198.22 1563,-4145.22 1899,-4145.22 1899,-4198.22"/>
<text text-anchor="middle" x="1731" y="-4183.02" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1731" y="-4168.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1731" y="-4153.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_q_14 -->
<g id="edge730" class="edge">
<title>ln1_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M1606.38,-4235.03C1626.53,-4224.95 1649.8,-4213.32 1670.74,-4202.85"/>
<polygon fill="black" stroke="black" points="1672.48,-4205.89 1679.86,-4198.29 1669.35,-4199.63 1672.48,-4205.89"/>
</g>
<!-- mha_k_14 -->
<g id="node471" class="node">
<title>mha_k_14</title>
<polygon fill="lightblue" stroke="black" points="1191,-4198.22 855,-4198.22 855,-4145.22 1191,-4145.22 1191,-4198.22"/>
<text text-anchor="middle" x="1023" y="-4183.02" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="1023" y="-4168.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1023" y="-4153.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_k_14 -->
<g id="edge731" class="edge">
<title>ln1_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M1469.82,-4246.63C1393.99,-4234.09 1280.93,-4215.38 1187.51,-4199.93"/>
<polygon fill="black" stroke="black" points="1187.82,-4196.44 1177.38,-4198.26 1186.68,-4203.34 1187.82,-4196.44"/>
</g>
<!-- mha_v_14 -->
<g id="node472" class="node">
<title>mha_v_14</title>
<polygon fill="lightblue" stroke="black" points="1545,-4198.22 1209,-4198.22 1209,-4145.22 1545,-4145.22 1545,-4198.22"/>
<text text-anchor="middle" x="1377" y="-4183.02" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1377" y="-4168.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1377" y="-4153.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_v_14 -->
<g id="edge732" class="edge">
<title>ln1_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M1503.04,-4235.03C1482.66,-4224.95 1459.12,-4213.32 1437.95,-4202.85"/>
<polygon fill="black" stroke="black" points="1439.24,-4199.58 1428.72,-4198.29 1436.13,-4205.86 1439.24,-4199.58"/>
</g>
<!-- mha_attn_14 -->
<g id="node473" class="node">
<title>mha_attn_14</title>
<polygon fill="lightblue" stroke="black" points="1557,-4108.22 1387,-4108.22 1387,-4055.22 1557,-4055.22 1557,-4108.22"/>
<text text-anchor="middle" x="1472" y="-4093.02" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1472" y="-4078.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1472" y="-4063.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge733" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1655.74,-4145.15C1624.88,-4134.66 1589,-4122.47 1557.18,-4111.66"/>
<polygon fill="black" stroke="black" points="1558.04,-4108.26 1547.45,-4108.36 1555.79,-4114.89 1558.04,-4108.26"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge734" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1153.17,-4145.21C1224.73,-4131.18 1311.91,-4114.1 1377.01,-4101.34"/>
<polygon fill="black" stroke="black" points="1377.71,-4104.77 1386.85,-4099.41 1376.37,-4097.9 1377.71,-4104.77"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge735" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1404.73,-4145.03C1414.78,-4135.72 1426.27,-4125.08 1436.87,-4115.27"/>
<polygon fill="black" stroke="black" points="1439.44,-4117.65 1444.4,-4108.29 1434.68,-4112.52 1439.44,-4117.65"/>
</g>
<!-- mha_out_14 -->
<g id="node474" class="node">
<title>mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="1899,-4018.22 1563,-4018.22 1563,-3965.22 1899,-3965.22 1899,-4018.22"/>
<text text-anchor="middle" x="1731" y="-4003.02" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1731" y="-3988.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1731" y="-3973.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge736" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M1547.26,-4055.15C1578.12,-4044.66 1614,-4032.47 1645.82,-4021.66"/>
<polygon fill="black" stroke="black" points="1647.21,-4024.89 1655.55,-4018.36 1644.96,-4018.26 1647.21,-4024.89"/>
</g>
<!-- residual1_14 -->
<g id="node475" class="node">
<title>residual1_14</title>
<polygon fill="lightcoral" stroke="black" points="2186.86,-3928.22 1617.58,-3928.22 1471.14,-3822.22 2040.42,-3822.22 2186.86,-3928.22"/>
<text text-anchor="middle" x="1829" y="-3886.52" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1829" y="-3871.52" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1829" y="-3856.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge738" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1752.99,-3965.02C1760.37,-3956.41 1768.93,-3946.4 1777.59,-3936.28"/>
<polygon fill="black" stroke="black" points="1780.38,-3938.41 1784.22,-3928.54 1775.06,-3933.86 1780.38,-3938.41"/>
</g>
<!-- ln2_14 -->
<g id="node476" class="node">
<title>ln2_14</title>
<polygon fill="lightyellow" stroke="black" points="3211,-3785.22 3041,-3785.22 3041,-3732.22 3211,-3732.22 3211,-3785.22"/>
<text text-anchor="middle" x="3126" y="-3770.02" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3126" y="-3755.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3126" y="-3740.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge739" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M2081.77,-3851.91C2371.74,-3826.31 2832.62,-3785.62 3030.56,-3768.15"/>
<polygon fill="black" stroke="black" points="3030.99,-3771.62 3040.64,-3767.26 3030.37,-3764.65 3030.99,-3771.62"/>
</g>
<!-- residual2_14 -->
<g id="node503" class="node">
<title>residual2_14</title>
<polygon fill="lightcoral" stroke="black" points="2186.86,-3080.22 1617.58,-3080.22 1471.14,-2974.22 2040.42,-2974.22 2186.86,-3080.22"/>
<text text-anchor="middle" x="1829" y="-3038.52" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1829" y="-3023.52" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1829" y="-3008.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge782" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M1821.23,-3822.19C1818.92,-3802.64 1817,-3780.21 1817,-3759.72 1817,-3759.72 1817,-3759.72 1817,-3184.22 1817,-3153.38 1819.36,-3119.2 1821.99,-3090.72"/>
<polygon fill="black" stroke="black" points="1825.5,-3090.79 1822.96,-3080.5 1818.53,-3090.12 1825.5,-3090.79"/>
</g>
<!-- gate_14 -->
<g id="node477" class="node">
<title>gate_14</title>
<polygon fill="orange" stroke="black" points="3295,-3695.22 2986,-3642.22 3295,-3589.22 3604,-3642.22 3295,-3695.22"/>
<text text-anchor="middle" x="3295" y="-3653.52" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3295" y="-3638.52" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="3295" y="-3623.52" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;gate_14 -->
<g id="edge740" class="edge">
<title>ln2_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M3163.93,-3732.02C3182.05,-3719.74 3204.34,-3704.64 3225.36,-3690.4"/>
<polygon fill="black" stroke="black" points="3227.34,-3693.29 3233.65,-3684.78 3223.41,-3687.5 3227.34,-3693.29"/>
</g>
<!-- expert_14_0 -->
<g id="node478" class="node">
<title>expert_14_0</title>
<polygon fill="lightcyan" stroke="black" points="2552.5,-3538.22 2207.5,-3538.22 2207.5,-3470.22 2552.5,-3470.22 2552.5,-3538.22"/>
<text text-anchor="middle" x="2380" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2380" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2380" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2380" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_0 -->
<g id="edge742" class="edge">
<title>ln2_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" d="M3040.9,-3750.07C2905.44,-3734.62 2636.43,-3690.35 2444,-3571.22 2432.97,-3564.39 2422.49,-3555.25 2413.33,-3545.95"/>
<polygon fill="black" stroke="black" points="2415.69,-3543.35 2406.28,-3538.49 2410.61,-3548.16 2415.69,-3543.35"/>
</g>
<!-- expert_14_1 -->
<g id="node481" class="node">
<title>expert_14_1</title>
<polygon fill="lightcyan" stroke="black" points="3678.5,-3538.22 3333.5,-3538.22 3333.5,-3470.22 3678.5,-3470.22 3678.5,-3538.22"/>
<text text-anchor="middle" x="3506" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3506" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3506" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3506" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_1 -->
<g id="edge747" class="edge">
<title>ln2_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" d="M3211.19,-3752.69C3343.57,-3744.01 3586.35,-3724.31 3613,-3695.22 3654.76,-3649.64 3651.45,-3608.21 3618,-3556.22 3615.46,-3552.27 3612.53,-3548.63 3609.3,-3545.26"/>
<polygon fill="black" stroke="black" points="3611.5,-3542.53 3601.77,-3538.33 3606.76,-3547.68 3611.5,-3542.53"/>
</g>
<!-- expert_14_2 -->
<g id="node484" class="node">
<title>expert_14_2</title>
<polygon fill="lightcyan" stroke="black" points="4404.5,-3538.22 4059.5,-3538.22 4059.5,-3470.22 4404.5,-3470.22 4404.5,-3538.22"/>
<text text-anchor="middle" x="4232" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4232" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4232" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4232" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_2 -->
<g id="edge752" class="edge">
<title>ln2_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" d="M3211.15,-3751.69C3307.25,-3744.5 3468.15,-3731.27 3606,-3714.22 3874.63,-3680.99 3986.89,-3740.63 4198,-3571.22 4205.76,-3564.99 4211.93,-3556.52 4216.77,-3547.72"/>
<polygon fill="black" stroke="black" points="4220.02,-3549.03 4221.33,-3538.52 4213.75,-3545.92 4220.02,-3549.03"/>
</g>
<!-- expert_14_3 -->
<g id="node487" class="node">
<title>expert_14_3</title>
<polygon fill="lightcyan" stroke="black" points="2189.5,-3538.22 1844.5,-3538.22 1844.5,-3470.22 2189.5,-3470.22 2189.5,-3538.22"/>
<text text-anchor="middle" x="2017" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2017" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2017" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2017" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_3 -->
<g id="edge757" class="edge">
<title>ln2_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" d="M3040.88,-3757.71C2914.59,-3755.88 2670.99,-3745.38 2471,-3695.22 2329.92,-3659.84 2175.73,-3587.5 2088.23,-3543"/>
<polygon fill="black" stroke="black" points="2089.7,-3539.82 2079.2,-3538.38 2086.51,-3546.05 2089.7,-3539.82"/>
</g>
<!-- expert_14_4 -->
<g id="node490" class="node">
<title>expert_14_4</title>
<polygon fill="lightcyan" stroke="black" points="4041.5,-3538.22 3696.5,-3538.22 3696.5,-3470.22 4041.5,-3470.22 4041.5,-3538.22"/>
<text text-anchor="middle" x="3869" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3869" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3869" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3869" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_4 -->
<g id="edge762" class="edge">
<title>ln2_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" d="M3211.24,-3754.86C3338.1,-3749.35 3569.45,-3734.17 3642,-3695.22 3716.26,-3655.35 3788.54,-3588.58 3830.9,-3545.74"/>
<polygon fill="black" stroke="black" points="3833.44,-3548.15 3837.95,-3538.56 3828.45,-3543.25 3833.44,-3548.15"/>
</g>
<!-- expert_14_5 -->
<g id="node493" class="node">
<title>expert_14_5</title>
<polygon fill="lightcyan" stroke="black" points="4767.5,-3538.22 4422.5,-3538.22 4422.5,-3470.22 4767.5,-3470.22 4767.5,-3538.22"/>
<text text-anchor="middle" x="4595" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4595" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4595" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4595" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_5 -->
<g id="edge767" class="edge">
<title>ln2_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" d="M3211.22,-3754.94C3409.12,-3748 3895.08,-3728.1 4055,-3695.22 4222.02,-3660.88 4407.72,-3587.23 4512.04,-3542.38"/>
<polygon fill="black" stroke="black" points="4513.46,-3545.58 4521.26,-3538.4 4510.69,-3539.15 4513.46,-3545.58"/>
</g>
<!-- expert_14_6 -->
<g id="node496" class="node">
<title>expert_14_6</title>
<polygon fill="lightcyan" stroke="black" points="2915.5,-3538.22 2570.5,-3538.22 2570.5,-3470.22 2915.5,-3470.22 2915.5,-3538.22"/>
<text text-anchor="middle" x="2743" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2743" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2743" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2743" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_6 -->
<g id="edge772" class="edge">
<title>ln2_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" d="M3040.67,-3733.39C3023.35,-3727.69 3005.42,-3721.21 2989,-3714.22 2889.2,-3671.74 2884.24,-3628.09 2803,-3556.22 2798.9,-3552.6 2794.62,-3548.86 2790.32,-3545.14"/>
<polygon fill="black" stroke="black" points="2792.43,-3542.34 2782.57,-3538.47 2787.86,-3547.64 2792.43,-3542.34"/>
</g>
<!-- expert_14_7 -->
<g id="node499" class="node">
<title>expert_14_7</title>
<polygon fill="lightcyan" stroke="black" points="3278.5,-3538.22 2933.5,-3538.22 2933.5,-3470.22 3278.5,-3470.22 3278.5,-3538.22"/>
<text text-anchor="middle" x="3106" y="-3523.02" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3106" y="-3508.02" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3106" y="-3493.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3106" y="-3478.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;expert_14_7 -->
<g id="edge777" class="edge">
<title>ln2_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" d="M3040.84,-3740.98C3016.08,-3731.74 2991.76,-3717.41 2977,-3695.22 2950.91,-3655.99 2954.55,-3630.64 2977,-3589.22 2986.96,-3570.85 3002.87,-3555.86 3020.17,-3543.91"/>
<polygon fill="black" stroke="black" points="3022.31,-3546.69 3028.76,-3538.28 3018.48,-3540.83 3022.31,-3546.69"/>
</g>
<!-- gate_14&#45;&gt;expert_14_0 -->
<g id="edge741" class="edge">
<title>gate_14&#45;&gt;expert_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3121.8,-3618.86C2975.55,-3599.51 2760.39,-3569.96 2562.88,-3538.34"/>
<polygon fill="black" stroke="black" points="2563.32,-3534.87 2552.89,-3536.74 2562.21,-3541.78 2563.32,-3534.87"/>
<text text-anchor="middle" x="2807.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_1 -->
<g id="edge746" class="edge">
<title>gate_14&#45;&gt;expert_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3345.59,-3597.88C3363.19,-3583.78 3383.43,-3568.58 3403,-3556.22 3410.09,-3551.74 3417.64,-3547.36 3425.29,-3543.16"/>
<polygon fill="black" stroke="black" points="3427.15,-3546.13 3434.3,-3538.32 3423.83,-3539.97 3427.15,-3546.13"/>
<text text-anchor="middle" x="3448.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_2 -->
<g id="edge751" class="edge">
<title>gate_14&#45;&gt;expert_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.38,-3619.47C3622.34,-3600.32 3845.64,-3570.72 4049.12,-3538.5"/>
<polygon fill="black" stroke="black" points="4049.78,-3541.94 4059.1,-3536.92 4048.68,-3535.03 4049.78,-3541.94"/>
<text text-anchor="middle" x="3972.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_3 -->
<g id="edge756" class="edge">
<title>gate_14&#45;&gt;expert_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3078.35,-3626.36C2859.19,-3610.06 2510.59,-3580.63 2199.97,-3538.32"/>
<polygon fill="black" stroke="black" points="2200.24,-3534.82 2189.86,-3536.93 2199.29,-3541.76 2200.24,-3534.82"/>
<text text-anchor="middle" x="2513.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_4 -->
<g id="edge761" class="edge">
<title>gate_14&#45;&gt;expert_14_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3399.92,-3607.21C3454.43,-3590.34 3522.37,-3570.57 3584,-3556.22 3626.74,-3546.27 3640.11,-3546.37 3686.09,-3538.52"/>
<polygon fill="black" stroke="black" points="3686.83,-3541.95 3696.08,-3536.78 3685.63,-3535.05 3686.83,-3541.95"/>
<text text-anchor="middle" x="3629.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_5 -->
<g id="edge766" class="edge">
<title>gate_14&#45;&gt;expert_14_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3514.36,-3626.8C3738.02,-3610.75 4095.04,-3581.46 4411.82,-3538.49"/>
<polygon fill="black" stroke="black" points="4412.69,-3541.9 4422.13,-3537.08 4411.75,-3534.96 4412.69,-3541.9"/>
<text text-anchor="middle" x="4307.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_6 -->
<g id="edge771" class="edge">
<title>gate_14&#45;&gt;expert_14_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3170.43,-3610.53C3086.3,-3589.8 2974.98,-3562.37 2887.03,-3540.71"/>
<polygon fill="black" stroke="black" points="2887.79,-3537.29 2877.25,-3538.3 2886.12,-3544.09 2887.79,-3537.29"/>
<text text-anchor="middle" x="3047.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_14&#45;&gt;expert_14_7 -->
<g id="edge776" class="edge">
<title>gate_14&#45;&gt;expert_14_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3236.49,-3599.12C3212.15,-3581.6 3184.06,-3561.39 3160.2,-3544.22"/>
<polygon fill="black" stroke="black" points="3162.11,-3541.28 3151.94,-3538.28 3158.02,-3546.96 3162.11,-3541.28"/>
<text text-anchor="middle" x="3239.5" y="-3560.02" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_14 -->
<g id="node502" class="node">
<title>expert_agg_14</title>
<polygon fill="lightpink" stroke="black" points="3466.86,-3253.22 3121.88,-3253.22 3033.14,-3117.22 3378.12,-3117.22 3466.86,-3253.22"/>
<text text-anchor="middle" x="3250" y="-3204.02" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3250" y="-3189.02" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="3250" y="-3174.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3250" y="-3159.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- gate_14&#45;&gt;expert_agg_14 -->
<g id="edge781" class="edge">
<title>gate_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3301.11,-3589.96C3303.64,-3564.51 3306,-3533.29 3306,-3505.22 3306,-3505.22 3306,-3505.22 3306,-3315.72 3306,-3298.01 3301.53,-3279.97 3295.12,-3263.2"/>
<polygon fill="black" stroke="black" points="3298.17,-3261.42 3291.14,-3253.49 3291.69,-3264.07 3298.17,-3261.42"/>
<text text-anchor="middle" x="3334.5" y="-3403.02" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_14_0 -->
<g id="node479" class="node">
<title>expert_gelu_14_0</title>
<polygon fill="lightcyan" stroke="black" points="2469.5,-3433.22 2290.5,-3433.22 2290.5,-3380.22 2469.5,-3380.22 2469.5,-3433.22"/>
<text text-anchor="middle" x="2380" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2380" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2380" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_0&#45;&gt;expert_gelu_14_0 -->
<g id="edge743" class="edge">
<title>expert_14_0&#45;&gt;expert_gelu_14_0</title>
<path fill="none" stroke="black" d="M2380,-3470.09C2380,-3461.51 2380,-3452.23 2380,-3443.52"/>
<polygon fill="black" stroke="black" points="2383.5,-3443.27 2380,-3433.27 2376.5,-3443.27 2383.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_0 -->
<g id="node480" class="node">
<title>expert_ffn2_14_0</title>
<polygon fill="lightcyan" stroke="black" points="2552.5,-3343.22 2207.5,-3343.22 2207.5,-3290.22 2552.5,-3290.22 2552.5,-3343.22"/>
<text text-anchor="middle" x="2380" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2380" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2380" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_0&#45;&gt;expert_ffn2_14_0 -->
<g id="edge744" class="edge">
<title>expert_gelu_14_0&#45;&gt;expert_ffn2_14_0</title>
<path fill="none" stroke="black" d="M2380,-3379.79C2380,-3371.56 2380,-3362.3 2380,-3353.5"/>
<polygon fill="black" stroke="black" points="2383.5,-3353.46 2380,-3343.46 2376.5,-3353.46 2383.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_0&#45;&gt;expert_agg_14 -->
<g id="edge745" class="edge">
<title>expert_ffn2_14_0&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2551.36,-3290.21C2705.52,-3267.27 2930.61,-3233.76 3083.31,-3211.03"/>
<polygon fill="black" stroke="black" points="3083.89,-3214.48 3093.26,-3209.55 3082.86,-3207.56 3083.89,-3214.48"/>
</g>
<!-- expert_gelu_14_1 -->
<g id="node482" class="node">
<title>expert_gelu_14_1</title>
<polygon fill="lightcyan" stroke="black" points="3595.5,-3433.22 3416.5,-3433.22 3416.5,-3380.22 3595.5,-3380.22 3595.5,-3433.22"/>
<text text-anchor="middle" x="3506" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3506" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3506" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_1&#45;&gt;expert_gelu_14_1 -->
<g id="edge748" class="edge">
<title>expert_14_1&#45;&gt;expert_gelu_14_1</title>
<path fill="none" stroke="black" d="M3506,-3470.09C3506,-3461.51 3506,-3452.23 3506,-3443.52"/>
<polygon fill="black" stroke="black" points="3509.5,-3443.27 3506,-3433.27 3502.5,-3443.27 3509.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_1 -->
<g id="node483" class="node">
<title>expert_ffn2_14_1</title>
<polygon fill="lightcyan" stroke="black" points="3678.5,-3343.22 3333.5,-3343.22 3333.5,-3290.22 3678.5,-3290.22 3678.5,-3343.22"/>
<text text-anchor="middle" x="3506" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3506" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3506" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_1&#45;&gt;expert_ffn2_14_1 -->
<g id="edge749" class="edge">
<title>expert_gelu_14_1&#45;&gt;expert_ffn2_14_1</title>
<path fill="none" stroke="black" d="M3506,-3379.79C3506,-3371.56 3506,-3362.3 3506,-3353.5"/>
<polygon fill="black" stroke="black" points="3509.5,-3353.46 3506,-3343.46 3502.5,-3353.46 3509.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_1&#45;&gt;expert_agg_14 -->
<g id="edge750" class="edge">
<title>expert_ffn2_14_1&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M3455.42,-3290.14C3436.71,-3280.67 3414.45,-3269.41 3391.61,-3257.86"/>
<polygon fill="black" stroke="black" points="3393,-3254.63 3382.49,-3253.24 3389.84,-3260.88 3393,-3254.63"/>
</g>
<!-- expert_gelu_14_2 -->
<g id="node485" class="node">
<title>expert_gelu_14_2</title>
<polygon fill="lightcyan" stroke="black" points="4321.5,-3433.22 4142.5,-3433.22 4142.5,-3380.22 4321.5,-3380.22 4321.5,-3433.22"/>
<text text-anchor="middle" x="4232" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4232" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4232" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_2&#45;&gt;expert_gelu_14_2 -->
<g id="edge753" class="edge">
<title>expert_14_2&#45;&gt;expert_gelu_14_2</title>
<path fill="none" stroke="black" d="M4232,-3470.09C4232,-3461.51 4232,-3452.23 4232,-3443.52"/>
<polygon fill="black" stroke="black" points="4235.5,-3443.27 4232,-3433.27 4228.5,-3443.27 4235.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_2 -->
<g id="node486" class="node">
<title>expert_ffn2_14_2</title>
<polygon fill="lightcyan" stroke="black" points="4404.5,-3343.22 4059.5,-3343.22 4059.5,-3290.22 4404.5,-3290.22 4404.5,-3343.22"/>
<text text-anchor="middle" x="4232" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="4232" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4232" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_2&#45;&gt;expert_ffn2_14_2 -->
<g id="edge754" class="edge">
<title>expert_gelu_14_2&#45;&gt;expert_ffn2_14_2</title>
<path fill="none" stroke="black" d="M4232,-3379.79C4232,-3371.56 4232,-3362.3 4232,-3353.5"/>
<polygon fill="black" stroke="black" points="4235.5,-3353.46 4232,-3343.46 4228.5,-3353.46 4235.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_2&#45;&gt;expert_agg_14 -->
<g id="edge755" class="edge">
<title>expert_ffn2_14_2&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M4059.08,-3291.32C4056.37,-3290.95 4053.67,-3290.58 4051,-3290.22 3845.98,-3262.47 3611.23,-3232.16 3449.11,-3211.46"/>
<polygon fill="black" stroke="black" points="3449.39,-3207.97 3439.03,-3210.18 3448.5,-3214.91 3449.39,-3207.97"/>
</g>
<!-- expert_gelu_14_3 -->
<g id="node488" class="node">
<title>expert_gelu_14_3</title>
<polygon fill="lightcyan" stroke="black" points="2106.5,-3433.22 1927.5,-3433.22 1927.5,-3380.22 2106.5,-3380.22 2106.5,-3433.22"/>
<text text-anchor="middle" x="2017" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2017" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2017" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_3&#45;&gt;expert_gelu_14_3 -->
<g id="edge758" class="edge">
<title>expert_14_3&#45;&gt;expert_gelu_14_3</title>
<path fill="none" stroke="black" d="M2017,-3470.09C2017,-3461.51 2017,-3452.23 2017,-3443.52"/>
<polygon fill="black" stroke="black" points="2020.5,-3443.27 2017,-3433.27 2013.5,-3443.27 2020.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_3 -->
<g id="node489" class="node">
<title>expert_ffn2_14_3</title>
<polygon fill="lightcyan" stroke="black" points="2189.5,-3343.22 1844.5,-3343.22 1844.5,-3290.22 2189.5,-3290.22 2189.5,-3343.22"/>
<text text-anchor="middle" x="2017" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="2017" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2017" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_3&#45;&gt;expert_ffn2_14_3 -->
<g id="edge759" class="edge">
<title>expert_gelu_14_3&#45;&gt;expert_ffn2_14_3</title>
<path fill="none" stroke="black" d="M2017,-3379.79C2017,-3371.56 2017,-3362.3 2017,-3353.5"/>
<polygon fill="black" stroke="black" points="2020.5,-3353.46 2017,-3343.46 2013.5,-3353.46 2020.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_3&#45;&gt;expert_agg_14 -->
<g id="edge760" class="edge">
<title>expert_ffn2_14_3&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2189.9,-3291.32C2192.95,-3290.95 2195.99,-3290.58 2199,-3290.22 2507.77,-3253.33 2868.7,-3219.67 3077.17,-3201.16"/>
<polygon fill="black" stroke="black" points="3077.63,-3204.63 3087.29,-3200.26 3077.02,-3197.66 3077.63,-3204.63"/>
</g>
<!-- expert_gelu_14_4 -->
<g id="node491" class="node">
<title>expert_gelu_14_4</title>
<polygon fill="lightcyan" stroke="black" points="3958.5,-3433.22 3779.5,-3433.22 3779.5,-3380.22 3958.5,-3380.22 3958.5,-3433.22"/>
<text text-anchor="middle" x="3869" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3869" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3869" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_4&#45;&gt;expert_gelu_14_4 -->
<g id="edge763" class="edge">
<title>expert_14_4&#45;&gt;expert_gelu_14_4</title>
<path fill="none" stroke="black" d="M3869,-3470.09C3869,-3461.51 3869,-3452.23 3869,-3443.52"/>
<polygon fill="black" stroke="black" points="3872.5,-3443.27 3869,-3433.27 3865.5,-3443.27 3872.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_4 -->
<g id="node492" class="node">
<title>expert_ffn2_14_4</title>
<polygon fill="lightcyan" stroke="black" points="4041.5,-3343.22 3696.5,-3343.22 3696.5,-3290.22 4041.5,-3290.22 4041.5,-3343.22"/>
<text text-anchor="middle" x="3869" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3869" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3869" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_4&#45;&gt;expert_ffn2_14_4 -->
<g id="edge764" class="edge">
<title>expert_gelu_14_4&#45;&gt;expert_ffn2_14_4</title>
<path fill="none" stroke="black" d="M3869,-3379.79C3869,-3371.56 3869,-3362.3 3869,-3353.5"/>
<polygon fill="black" stroke="black" points="3872.5,-3353.46 3869,-3343.46 3865.5,-3353.46 3872.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_4&#45;&gt;expert_agg_14 -->
<g id="edge765" class="edge">
<title>expert_ffn2_14_4&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M3747.07,-3290.21C3665.44,-3273.13 3555.84,-3250.2 3460.33,-3230.22"/>
<polygon fill="black" stroke="black" points="3461.05,-3226.8 3450.54,-3228.18 3459.61,-3233.65 3461.05,-3226.8"/>
</g>
<!-- expert_gelu_14_5 -->
<g id="node494" class="node">
<title>expert_gelu_14_5</title>
<polygon fill="lightcyan" stroke="black" points="4684.5,-3433.22 4505.5,-3433.22 4505.5,-3380.22 4684.5,-3380.22 4684.5,-3433.22"/>
<text text-anchor="middle" x="4595" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4595" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4595" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_5&#45;&gt;expert_gelu_14_5 -->
<g id="edge768" class="edge">
<title>expert_14_5&#45;&gt;expert_gelu_14_5</title>
<path fill="none" stroke="black" d="M4595,-3470.09C4595,-3461.51 4595,-3452.23 4595,-3443.52"/>
<polygon fill="black" stroke="black" points="4598.5,-3443.27 4595,-3433.27 4591.5,-3443.27 4598.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_5 -->
<g id="node495" class="node">
<title>expert_ffn2_14_5</title>
<polygon fill="lightcyan" stroke="black" points="4767.5,-3343.22 4422.5,-3343.22 4422.5,-3290.22 4767.5,-3290.22 4767.5,-3343.22"/>
<text text-anchor="middle" x="4595" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4595" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4595" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_5&#45;&gt;expert_ffn2_14_5 -->
<g id="edge769" class="edge">
<title>expert_gelu_14_5&#45;&gt;expert_ffn2_14_5</title>
<path fill="none" stroke="black" d="M4595,-3379.79C4595,-3371.56 4595,-3362.3 4595,-3353.5"/>
<polygon fill="black" stroke="black" points="4598.5,-3353.46 4595,-3343.46 4591.5,-3353.46 4598.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_5&#45;&gt;expert_agg_14 -->
<g id="edge770" class="edge">
<title>expert_ffn2_14_5&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M4422.1,-3291.17C4419.38,-3290.84 4416.68,-3290.53 4414,-3290.22 4072.52,-3250.94 3673.22,-3218.1 3442.19,-3200.38"/>
<polygon fill="black" stroke="black" points="3442.24,-3196.87 3432,-3199.6 3441.7,-3203.85 3442.24,-3196.87"/>
</g>
<!-- expert_gelu_14_6 -->
<g id="node497" class="node">
<title>expert_gelu_14_6</title>
<polygon fill="lightcyan" stroke="black" points="2832.5,-3433.22 2653.5,-3433.22 2653.5,-3380.22 2832.5,-3380.22 2832.5,-3433.22"/>
<text text-anchor="middle" x="2743" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2743" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2743" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_6&#45;&gt;expert_gelu_14_6 -->
<g id="edge773" class="edge">
<title>expert_14_6&#45;&gt;expert_gelu_14_6</title>
<path fill="none" stroke="black" d="M2743,-3470.09C2743,-3461.51 2743,-3452.23 2743,-3443.52"/>
<polygon fill="black" stroke="black" points="2746.5,-3443.27 2743,-3433.27 2739.5,-3443.27 2746.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_6 -->
<g id="node498" class="node">
<title>expert_ffn2_14_6</title>
<polygon fill="lightcyan" stroke="black" points="2915.5,-3343.22 2570.5,-3343.22 2570.5,-3290.22 2915.5,-3290.22 2915.5,-3343.22"/>
<text text-anchor="middle" x="2743" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2743" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2743" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_6&#45;&gt;expert_ffn2_14_6 -->
<g id="edge774" class="edge">
<title>expert_gelu_14_6&#45;&gt;expert_ffn2_14_6</title>
<path fill="none" stroke="black" d="M2743,-3379.79C2743,-3371.56 2743,-3362.3 2743,-3353.5"/>
<polygon fill="black" stroke="black" points="2746.5,-3353.46 2743,-3343.46 2739.5,-3353.46 2746.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_6&#45;&gt;expert_agg_14 -->
<g id="edge775" class="edge">
<title>expert_ffn2_14_6&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M2842.86,-3290.21C2913.97,-3272.05 3010.97,-3247.27 3092.45,-3226.46"/>
<polygon fill="black" stroke="black" points="3093.49,-3229.81 3102.31,-3223.94 3091.75,-3223.03 3093.49,-3229.81"/>
</g>
<!-- expert_gelu_14_7 -->
<g id="node500" class="node">
<title>expert_gelu_14_7</title>
<polygon fill="lightcyan" stroke="black" points="3195.5,-3433.22 3016.5,-3433.22 3016.5,-3380.22 3195.5,-3380.22 3195.5,-3433.22"/>
<text text-anchor="middle" x="3106" y="-3418.02" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="3106" y="-3403.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3106" y="-3388.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_14_7&#45;&gt;expert_gelu_14_7 -->
<g id="edge778" class="edge">
<title>expert_14_7&#45;&gt;expert_gelu_14_7</title>
<path fill="none" stroke="black" d="M3106,-3470.09C3106,-3461.51 3106,-3452.23 3106,-3443.52"/>
<polygon fill="black" stroke="black" points="3109.5,-3443.27 3106,-3433.27 3102.5,-3443.27 3109.5,-3443.27"/>
</g>
<!-- expert_ffn2_14_7 -->
<g id="node501" class="node">
<title>expert_ffn2_14_7</title>
<polygon fill="lightcyan" stroke="black" points="3278.5,-3343.22 2933.5,-3343.22 2933.5,-3290.22 3278.5,-3290.22 3278.5,-3343.22"/>
<text text-anchor="middle" x="3106" y="-3328.02" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="3106" y="-3313.02" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3106" y="-3298.02" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- expert_gelu_14_7&#45;&gt;expert_ffn2_14_7 -->
<g id="edge779" class="edge">
<title>expert_gelu_14_7&#45;&gt;expert_ffn2_14_7</title>
<path fill="none" stroke="black" d="M3106,-3379.79C3106,-3371.56 3106,-3362.3 3106,-3353.5"/>
<polygon fill="black" stroke="black" points="3109.5,-3353.46 3106,-3343.46 3102.5,-3353.46 3109.5,-3353.46"/>
</g>
<!-- expert_ffn2_14_7&#45;&gt;expert_agg_14 -->
<g id="edge780" class="edge">
<title>expert_ffn2_14_7&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="black" d="M3134.45,-3290.14C3144.29,-3281.28 3155.87,-3270.87 3167.84,-3260.11"/>
<polygon fill="black" stroke="black" points="3170.23,-3262.67 3175.32,-3253.38 3165.55,-3257.46 3170.23,-3262.67"/>
</g>
<!-- expert_agg_14&#45;&gt;residual2_14 -->
<g id="edge783" class="edge">
<title>expert_agg_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M3063.13,-3163.71C2838.32,-3139.03 2456.28,-3097.08 2176.69,-3066.39"/>
<polygon fill="black" stroke="black" points="2176.7,-3062.87 2166.37,-3065.26 2175.93,-3069.83 2176.7,-3062.87"/>
</g>
<!-- comm_14_15 -->
<g id="node540" class="node">
<title>comm_14_15</title>
<ellipse fill="lightgreen" stroke="black" cx="1829" cy="-2910.35" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1829" y="-2914.15" font-family="Times,serif" font-size="14.00">GPU 13 → GPU 14</text>
<text text-anchor="middle" x="1829" y="-2899.15" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_14&#45;&gt;comm_14_15 -->
<g id="edge784" class="edge">
<title>residual2_14&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M1829,-2974.16C1829,-2965.23 1829,-2956.12 1829,-2947.72"/>
<polygon fill="black" stroke="black" points="1832.5,-2947.51 1829,-2937.51 1825.5,-2947.51 1832.5,-2947.51"/>
</g>
<!-- comm_13_14&#45;&gt;ln1_14 -->
<g id="edge729" class="edge">
<title>comm_13_14&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M1661.44,-4326.71C1644.35,-4316.44 1624.27,-4304.36 1606.18,-4293.49"/>
<polygon fill="black" stroke="black" points="1607.85,-4290.41 1597.48,-4288.26 1604.24,-4296.41 1607.85,-4290.41"/>
</g>
<!-- comm_13_14&#45;&gt;residual1_14 -->
<g id="edge737" class="edge">
<title>comm_13_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1789.31,-4333.53C1852.56,-4318.21 1927,-4293.62 1927,-4262.72 1927,-4262.72 1927,-4262.72 1927,-3990.72 1927,-3970.67 1918.22,-3952.36 1905.91,-3936.55"/>
<polygon fill="black" stroke="black" points="1908.28,-3933.93 1899.18,-3928.51 1902.92,-3938.42 1908.28,-3933.93"/>
</g>
<!-- ln1_15 -->
<g id="node505" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="1767,-2846.48 1597,-2846.48 1597,-2793.48 1767,-2793.48 1767,-2846.48"/>
<text text-anchor="middle" x="1682" y="-2831.28" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1682" y="-2816.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1682" y="-2801.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_q_15 -->
<g id="node506" class="node">
<title>mha_q_15</title>
<polygon fill="lightblue" stroke="black" points="2026,-2756.48 1690,-2756.48 1690,-2703.48 2026,-2703.48 2026,-2756.48"/>
<text text-anchor="middle" x="1858" y="-2741.28" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1858" y="-2726.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1858" y="-2711.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_q_15 -->
<g id="edge786" class="edge">
<title>ln1_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M1733.38,-2793.29C1753.53,-2783.21 1776.8,-2771.58 1797.74,-2761.11"/>
<polygon fill="black" stroke="black" points="1799.48,-2764.15 1806.86,-2756.55 1796.35,-2757.89 1799.48,-2764.15"/>
</g>
<!-- mha_k_15 -->
<g id="node507" class="node">
<title>mha_k_15</title>
<polygon fill="lightblue" stroke="black" points="1318,-2756.48 982,-2756.48 982,-2703.48 1318,-2703.48 1318,-2756.48"/>
<text text-anchor="middle" x="1150" y="-2741.28" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="1150" y="-2726.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1150" y="-2711.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_k_15 -->
<g id="edge787" class="edge">
<title>ln1_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M1596.82,-2804.89C1520.99,-2792.35 1407.93,-2773.64 1314.51,-2758.19"/>
<polygon fill="black" stroke="black" points="1314.82,-2754.7 1304.38,-2756.52 1313.68,-2761.6 1314.82,-2754.7"/>
</g>
<!-- mha_v_15 -->
<g id="node508" class="node">
<title>mha_v_15</title>
<polygon fill="lightblue" stroke="black" points="1672,-2756.48 1336,-2756.48 1336,-2703.48 1672,-2703.48 1672,-2756.48"/>
<text text-anchor="middle" x="1504" y="-2741.28" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1504" y="-2726.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1504" y="-2711.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_v_15 -->
<g id="edge788" class="edge">
<title>ln1_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M1630.04,-2793.29C1609.66,-2783.21 1586.12,-2771.58 1564.95,-2761.11"/>
<polygon fill="black" stroke="black" points="1566.24,-2757.84 1555.72,-2756.55 1563.13,-2764.12 1566.24,-2757.84"/>
</g>
<!-- mha_attn_15 -->
<g id="node509" class="node">
<title>mha_attn_15</title>
<polygon fill="lightblue" stroke="black" points="1639,-2666.48 1469,-2666.48 1469,-2613.48 1639,-2613.48 1639,-2666.48"/>
<text text-anchor="middle" x="1554" y="-2651.28" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1554" y="-2636.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1554" y="-2621.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge789" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1769.66,-2703.41C1731.76,-2692.44 1687.42,-2679.6 1648.83,-2668.43"/>
<polygon fill="black" stroke="black" points="1649.73,-2665.05 1639.16,-2665.63 1647.79,-2671.77 1649.73,-2665.05"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge790" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1267.12,-2703.47C1328.14,-2690.18 1401.78,-2674.14 1459.17,-2661.64"/>
<polygon fill="black" stroke="black" points="1459.94,-2665.05 1468.96,-2659.5 1458.45,-2658.21 1459.94,-2665.05"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge791" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1518.73,-2703.05C1523.61,-2694.46 1529.13,-2684.75 1534.32,-2675.61"/>
<polygon fill="black" stroke="black" points="1537.48,-2677.15 1539.37,-2666.72 1531.39,-2673.69 1537.48,-2677.15"/>
</g>
<!-- mha_out_15 -->
<g id="node510" class="node">
<title>mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="1938,-2576.48 1602,-2576.48 1602,-2523.48 1938,-2523.48 1938,-2576.48"/>
<text text-anchor="middle" x="1770" y="-2561.28" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1770" y="-2546.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1770" y="-2531.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge792" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M1616.77,-2613.41C1642.06,-2603.1 1671.39,-2591.15 1697.58,-2580.48"/>
<polygon fill="black" stroke="black" points="1699.14,-2583.63 1707.08,-2576.62 1696.5,-2577.15 1699.14,-2583.63"/>
</g>
<!-- residual1_15 -->
<g id="node511" class="node">
<title>residual1_15</title>
<polygon fill="lightcoral" stroke="black" points="2313.86,-2486.48 1744.58,-2486.48 1598.14,-2380.48 2167.42,-2380.48 2313.86,-2486.48"/>
<text text-anchor="middle" x="1956" y="-2444.78" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1956" y="-2429.78" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1956" y="-2414.78" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge794" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1811.74,-2523.28C1826.93,-2513.93 1844.77,-2502.95 1862.63,-2491.96"/>
<polygon fill="black" stroke="black" points="1864.7,-2494.79 1871.38,-2486.57 1861.03,-2488.83 1864.7,-2494.79"/>
</g>
<!-- ln2_15 -->
<g id="node512" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="3338,-2343.48 3168,-2343.48 3168,-2290.48 3338,-2290.48 3338,-2343.48"/>
<text text-anchor="middle" x="3253" y="-2328.28" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3253" y="-2313.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3253" y="-2298.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge795" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M2208.77,-2410.17C2498.74,-2384.57 2959.62,-2343.88 3157.56,-2326.41"/>
<polygon fill="black" stroke="black" points="3157.99,-2329.88 3167.64,-2325.52 3157.37,-2322.91 3157.99,-2329.88"/>
</g>
<!-- residual2_15 -->
<g id="node539" class="node">
<title>residual2_15</title>
<polygon fill="lightcoral" stroke="black" points="2313.86,-1638.48 1744.58,-1638.48 1598.14,-1532.48 2167.42,-1532.48 2313.86,-1638.48"/>
<text text-anchor="middle" x="1956" y="-1596.78" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1956" y="-1581.78" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1956" y="-1566.78" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge838" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1948.23,-2380.45C1945.92,-2360.9 1944,-2338.47 1944,-2317.98 1944,-2317.98 1944,-2317.98 1944,-1742.48 1944,-1711.63 1946.36,-1677.46 1948.99,-1648.98"/>
<polygon fill="black" stroke="black" points="1952.5,-1649.05 1949.96,-1638.76 1945.53,-1648.38 1952.5,-1649.05"/>
</g>
<!-- gate_15 -->
<g id="node513" class="node">
<title>gate_15</title>
<polygon fill="orange" stroke="black" points="3422,-2253.48 3113,-2200.48 3422,-2147.48 3731,-2200.48 3422,-2253.48"/>
<text text-anchor="middle" x="3422" y="-2211.78" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3422" y="-2196.78" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="3422" y="-2181.78" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;gate_15 -->
<g id="edge796" class="edge">
<title>ln2_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M3290.93,-2290.28C3309.05,-2278 3331.34,-2262.9 3352.36,-2248.66"/>
<polygon fill="black" stroke="black" points="3354.34,-2251.55 3360.65,-2243.04 3350.41,-2245.76 3354.34,-2251.55"/>
</g>
<!-- expert_15_0 -->
<g id="node514" class="node">
<title>expert_15_0</title>
<polygon fill="lightcyan" stroke="black" points="2679.5,-2096.48 2334.5,-2096.48 2334.5,-2028.48 2679.5,-2028.48 2679.5,-2096.48"/>
<text text-anchor="middle" x="2507" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2507" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2507" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2507" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_0 -->
<g id="edge798" class="edge">
<title>ln2_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" d="M3167.9,-2312.68C3027.15,-2303.3 2742.6,-2267.31 2553,-2129.48 2544,-2122.94 2536.15,-2114.08 2529.61,-2104.99"/>
<polygon fill="black" stroke="black" points="2532.46,-2102.95 2523.97,-2096.62 2526.66,-2106.87 2532.46,-2102.95"/>
</g>
<!-- expert_15_1 -->
<g id="node517" class="node">
<title>expert_15_1</title>
<polygon fill="lightcyan" stroke="black" points="3805.5,-2096.48 3460.5,-2096.48 3460.5,-2028.48 3805.5,-2028.48 3805.5,-2096.48"/>
<text text-anchor="middle" x="3633" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3633" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3633" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3633" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_1 -->
<g id="edge803" class="edge">
<title>ln2_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" d="M3338.19,-2310.95C3470.57,-2302.27 3713.35,-2282.57 3740,-2253.48 3781.76,-2207.9 3778.45,-2166.47 3745,-2114.48 3742.46,-2110.53 3739.53,-2106.89 3736.3,-2103.52"/>
<polygon fill="black" stroke="black" points="3738.5,-2100.79 3728.77,-2096.59 3733.76,-2105.94 3738.5,-2100.79"/>
</g>
<!-- expert_15_2 -->
<g id="node520" class="node">
<title>expert_15_2</title>
<polygon fill="lightcyan" stroke="black" points="4531.5,-2096.48 4186.5,-2096.48 4186.5,-2028.48 4531.5,-2028.48 4531.5,-2096.48"/>
<text text-anchor="middle" x="4359" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4359" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4359" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4359" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_2 -->
<g id="edge808" class="edge">
<title>ln2_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" d="M3338.15,-2309.95C3434.25,-2302.76 3595.15,-2289.53 3733,-2272.48 4001.63,-2239.25 4113.89,-2298.89 4325,-2129.48 4332.76,-2123.25 4338.93,-2114.78 4343.77,-2105.98"/>
<polygon fill="black" stroke="black" points="4347.02,-2107.29 4348.33,-2096.78 4340.75,-2104.18 4347.02,-2107.29"/>
</g>
<!-- expert_15_3 -->
<g id="node523" class="node">
<title>expert_15_3</title>
<polygon fill="lightcyan" stroke="black" points="2316.5,-2096.48 1971.5,-2096.48 1971.5,-2028.48 2316.5,-2028.48 2316.5,-2096.48"/>
<text text-anchor="middle" x="2144" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2144" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2144" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2144" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_3 -->
<g id="edge813" class="edge">
<title>ln2_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" d="M3167.73,-2316.86C3037.73,-2316.26 2783.12,-2307.41 2575,-2253.48 2440.2,-2218.55 2294.02,-2146.01 2211.25,-2101.36"/>
<polygon fill="black" stroke="black" points="2212.92,-2098.28 2202.46,-2096.59 2209.58,-2104.44 2212.92,-2098.28"/>
</g>
<!-- expert_15_4 -->
<g id="node526" class="node">
<title>expert_15_4</title>
<polygon fill="lightcyan" stroke="black" points="4168.5,-2096.48 3823.5,-2096.48 3823.5,-2028.48 4168.5,-2028.48 4168.5,-2096.48"/>
<text text-anchor="middle" x="3996" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3996" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3996" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3996" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_4 -->
<g id="edge818" class="edge">
<title>ln2_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" d="M3338.24,-2313.12C3465.1,-2307.61 3696.45,-2292.43 3769,-2253.48 3843.26,-2213.61 3915.54,-2146.84 3957.9,-2104"/>
<polygon fill="black" stroke="black" points="3960.44,-2106.41 3964.95,-2096.82 3955.45,-2101.51 3960.44,-2106.41"/>
</g>
<!-- expert_15_5 -->
<g id="node529" class="node">
<title>expert_15_5</title>
<polygon fill="lightcyan" stroke="black" points="4894.5,-2096.48 4549.5,-2096.48 4549.5,-2028.48 4894.5,-2028.48 4894.5,-2096.48"/>
<text text-anchor="middle" x="4722" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4722" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4722" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4722" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_5 -->
<g id="edge823" class="edge">
<title>ln2_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" d="M3338.22,-2313.2C3536.12,-2306.26 4022.08,-2286.36 4182,-2253.48 4349.02,-2219.14 4534.72,-2145.49 4639.04,-2100.64"/>
<polygon fill="black" stroke="black" points="4640.46,-2103.84 4648.26,-2096.66 4637.69,-2097.41 4640.46,-2103.84"/>
</g>
<!-- expert_15_6 -->
<g id="node532" class="node">
<title>expert_15_6</title>
<polygon fill="lightcyan" stroke="black" points="3042.5,-2096.48 2697.5,-2096.48 2697.5,-2028.48 3042.5,-2028.48 3042.5,-2096.48"/>
<text text-anchor="middle" x="2870" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="2870" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2870" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2870" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_6 -->
<g id="edge828" class="edge">
<title>ln2_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" d="M3167.67,-2291.65C3150.35,-2285.95 3132.42,-2279.47 3116,-2272.48 3016.2,-2230 3011.24,-2186.35 2930,-2114.48 2925.9,-2110.86 2921.62,-2107.12 2917.32,-2103.4"/>
<polygon fill="black" stroke="black" points="2919.43,-2100.6 2909.57,-2096.73 2914.86,-2105.9 2919.43,-2100.6"/>
</g>
<!-- expert_15_7 -->
<g id="node535" class="node">
<title>expert_15_7</title>
<polygon fill="lightcyan" stroke="black" points="3405.5,-2096.48 3060.5,-2096.48 3060.5,-2028.48 3405.5,-2028.48 3405.5,-2096.48"/>
<text text-anchor="middle" x="3233" y="-2081.28" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3233" y="-2066.28" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3233" y="-2051.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3233" y="-2036.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;expert_15_7 -->
<g id="edge833" class="edge">
<title>ln2_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" d="M3167.84,-2299.24C3143.08,-2290 3118.76,-2275.67 3104,-2253.48 3077.91,-2214.25 3081.55,-2188.9 3104,-2147.48 3113.96,-2129.11 3129.87,-2114.12 3147.17,-2102.17"/>
<polygon fill="black" stroke="black" points="3149.31,-2104.95 3155.76,-2096.54 3145.48,-2099.09 3149.31,-2104.95"/>
</g>
<!-- gate_15&#45;&gt;expert_15_0 -->
<g id="edge797" class="edge">
<title>gate_15&#45;&gt;expert_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3248.8,-2177.12C3102.55,-2157.77 2887.39,-2128.22 2689.88,-2096.6"/>
<polygon fill="black" stroke="black" points="2690.32,-2093.13 2679.89,-2095 2689.21,-2100.04 2690.32,-2093.13"/>
<text text-anchor="middle" x="2934.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_1 -->
<g id="edge802" class="edge">
<title>gate_15&#45;&gt;expert_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3472.59,-2156.14C3490.19,-2142.03 3510.43,-2126.84 3530,-2114.48 3537.09,-2110 3544.64,-2105.62 3552.29,-2101.42"/>
<polygon fill="black" stroke="black" points="3554.15,-2104.39 3561.3,-2096.58 3550.83,-2098.23 3554.15,-2104.39"/>
<text text-anchor="middle" x="3575.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_2 -->
<g id="edge807" class="edge">
<title>gate_15&#45;&gt;expert_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3598.38,-2177.73C3749.34,-2158.58 3972.64,-2128.98 4176.12,-2096.76"/>
<polygon fill="black" stroke="black" points="4176.78,-2100.2 4186.1,-2095.18 4175.68,-2093.29 4176.78,-2100.2"/>
<text text-anchor="middle" x="4099.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_3 -->
<g id="edge812" class="edge">
<title>gate_15&#45;&gt;expert_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3205.35,-2184.62C2986.19,-2168.32 2637.59,-2138.89 2326.97,-2096.58"/>
<polygon fill="black" stroke="black" points="2327.24,-2093.08 2316.86,-2095.19 2326.29,-2100.02 2327.24,-2093.08"/>
<text text-anchor="middle" x="2640.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_4 -->
<g id="edge817" class="edge">
<title>gate_15&#45;&gt;expert_15_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.92,-2165.47C3581.43,-2148.6 3649.37,-2128.83 3711,-2114.48 3753.74,-2104.53 3767.11,-2104.63 3813.09,-2096.78"/>
<polygon fill="black" stroke="black" points="3813.83,-2100.21 3823.08,-2095.04 3812.63,-2093.31 3813.83,-2100.21"/>
<text text-anchor="middle" x="3756.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_5 -->
<g id="edge822" class="edge">
<title>gate_15&#45;&gt;expert_15_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3641.36,-2185.06C3865.02,-2169.01 4222.04,-2139.72 4538.82,-2096.75"/>
<polygon fill="black" stroke="black" points="4539.69,-2100.16 4549.13,-2095.34 4538.75,-2093.22 4539.69,-2100.16"/>
<text text-anchor="middle" x="4434.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_6 -->
<g id="edge827" class="edge">
<title>gate_15&#45;&gt;expert_15_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3297.43,-2168.79C3213.3,-2148.06 3101.98,-2120.63 3014.03,-2098.97"/>
<polygon fill="black" stroke="black" points="3014.79,-2095.55 3004.25,-2096.56 3013.12,-2102.35 3014.79,-2095.55"/>
<text text-anchor="middle" x="3174.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_15&#45;&gt;expert_15_7 -->
<g id="edge832" class="edge">
<title>gate_15&#45;&gt;expert_15_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3363.49,-2157.38C3339.15,-2139.86 3311.06,-2119.65 3287.2,-2102.48"/>
<polygon fill="black" stroke="black" points="3289.11,-2099.54 3278.94,-2096.54 3285.02,-2105.22 3289.11,-2099.54"/>
<text text-anchor="middle" x="3366.5" y="-2118.28" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_15 -->
<g id="node538" class="node">
<title>expert_agg_15</title>
<polygon fill="lightpink" stroke="black" points="3593.86,-1811.48 3248.88,-1811.48 3160.14,-1675.48 3505.12,-1675.48 3593.86,-1811.48"/>
<text text-anchor="middle" x="3377" y="-1762.28" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3377" y="-1747.28" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="3377" y="-1732.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3377" y="-1717.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- gate_15&#45;&gt;expert_agg_15 -->
<g id="edge837" class="edge">
<title>gate_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3428.11,-2148.22C3430.64,-2122.77 3433,-2091.55 3433,-2063.48 3433,-2063.48 3433,-2063.48 3433,-1873.98 3433,-1856.27 3428.53,-1838.23 3422.12,-1821.46"/>
<polygon fill="black" stroke="black" points="3425.17,-1819.68 3418.14,-1811.75 3418.69,-1822.33 3425.17,-1819.68"/>
<text text-anchor="middle" x="3461.5" y="-1961.28" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_15_0 -->
<g id="node515" class="node">
<title>expert_gelu_15_0</title>
<polygon fill="lightcyan" stroke="black" points="2596.5,-1991.48 2417.5,-1991.48 2417.5,-1938.48 2596.5,-1938.48 2596.5,-1991.48"/>
<text text-anchor="middle" x="2507" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2507" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2507" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_0&#45;&gt;expert_gelu_15_0 -->
<g id="edge799" class="edge">
<title>expert_15_0&#45;&gt;expert_gelu_15_0</title>
<path fill="none" stroke="black" d="M2507,-2028.35C2507,-2019.77 2507,-2010.49 2507,-2001.78"/>
<polygon fill="black" stroke="black" points="2510.5,-2001.53 2507,-1991.53 2503.5,-2001.53 2510.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_0 -->
<g id="node516" class="node">
<title>expert_ffn2_15_0</title>
<polygon fill="lightcyan" stroke="black" points="2679.5,-1901.48 2334.5,-1901.48 2334.5,-1848.48 2679.5,-1848.48 2679.5,-1901.48"/>
<text text-anchor="middle" x="2507" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2507" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2507" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_0&#45;&gt;expert_ffn2_15_0 -->
<g id="edge800" class="edge">
<title>expert_gelu_15_0&#45;&gt;expert_ffn2_15_0</title>
<path fill="none" stroke="black" d="M2507,-1938.05C2507,-1929.82 2507,-1920.56 2507,-1911.76"/>
<polygon fill="black" stroke="black" points="2510.5,-1911.72 2507,-1901.72 2503.5,-1911.72 2510.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_0&#45;&gt;expert_agg_15 -->
<g id="edge801" class="edge">
<title>expert_ffn2_15_0&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2678.36,-1848.47C2832.52,-1825.53 3057.61,-1792.02 3210.31,-1769.29"/>
<polygon fill="black" stroke="black" points="3210.89,-1772.74 3220.26,-1767.81 3209.86,-1765.82 3210.89,-1772.74"/>
</g>
<!-- expert_gelu_15_1 -->
<g id="node518" class="node">
<title>expert_gelu_15_1</title>
<polygon fill="lightcyan" stroke="black" points="3722.5,-1991.48 3543.5,-1991.48 3543.5,-1938.48 3722.5,-1938.48 3722.5,-1991.48"/>
<text text-anchor="middle" x="3633" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3633" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3633" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_1&#45;&gt;expert_gelu_15_1 -->
<g id="edge804" class="edge">
<title>expert_15_1&#45;&gt;expert_gelu_15_1</title>
<path fill="none" stroke="black" d="M3633,-2028.35C3633,-2019.77 3633,-2010.49 3633,-2001.78"/>
<polygon fill="black" stroke="black" points="3636.5,-2001.53 3633,-1991.53 3629.5,-2001.53 3636.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_1 -->
<g id="node519" class="node">
<title>expert_ffn2_15_1</title>
<polygon fill="lightcyan" stroke="black" points="3805.5,-1901.48 3460.5,-1901.48 3460.5,-1848.48 3805.5,-1848.48 3805.5,-1901.48"/>
<text text-anchor="middle" x="3633" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3633" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3633" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_1&#45;&gt;expert_ffn2_15_1 -->
<g id="edge805" class="edge">
<title>expert_gelu_15_1&#45;&gt;expert_ffn2_15_1</title>
<path fill="none" stroke="black" d="M3633,-1938.05C3633,-1929.82 3633,-1920.56 3633,-1911.76"/>
<polygon fill="black" stroke="black" points="3636.5,-1911.72 3633,-1901.72 3629.5,-1911.72 3636.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_1&#45;&gt;expert_agg_15 -->
<g id="edge806" class="edge">
<title>expert_ffn2_15_1&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M3582.42,-1848.4C3563.71,-1838.93 3541.45,-1827.67 3518.61,-1816.12"/>
<polygon fill="black" stroke="black" points="3520,-1812.89 3509.49,-1811.5 3516.84,-1819.14 3520,-1812.89"/>
</g>
<!-- expert_gelu_15_2 -->
<g id="node521" class="node">
<title>expert_gelu_15_2</title>
<polygon fill="lightcyan" stroke="black" points="4448.5,-1991.48 4269.5,-1991.48 4269.5,-1938.48 4448.5,-1938.48 4448.5,-1991.48"/>
<text text-anchor="middle" x="4359" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4359" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4359" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_2&#45;&gt;expert_gelu_15_2 -->
<g id="edge809" class="edge">
<title>expert_15_2&#45;&gt;expert_gelu_15_2</title>
<path fill="none" stroke="black" d="M4359,-2028.35C4359,-2019.77 4359,-2010.49 4359,-2001.78"/>
<polygon fill="black" stroke="black" points="4362.5,-2001.53 4359,-1991.53 4355.5,-2001.53 4362.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_2 -->
<g id="node522" class="node">
<title>expert_ffn2_15_2</title>
<polygon fill="lightcyan" stroke="black" points="4531.5,-1901.48 4186.5,-1901.48 4186.5,-1848.48 4531.5,-1848.48 4531.5,-1901.48"/>
<text text-anchor="middle" x="4359" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="4359" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4359" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_2&#45;&gt;expert_ffn2_15_2 -->
<g id="edge810" class="edge">
<title>expert_gelu_15_2&#45;&gt;expert_ffn2_15_2</title>
<path fill="none" stroke="black" d="M4359,-1938.05C4359,-1929.82 4359,-1920.56 4359,-1911.76"/>
<polygon fill="black" stroke="black" points="4362.5,-1911.72 4359,-1901.72 4355.5,-1911.72 4362.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_2&#45;&gt;expert_agg_15 -->
<g id="edge811" class="edge">
<title>expert_ffn2_15_2&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M4186.08,-1849.58C4183.37,-1849.21 4180.67,-1848.84 4178,-1848.48 3972.98,-1820.73 3738.23,-1790.42 3576.11,-1769.72"/>
<polygon fill="black" stroke="black" points="3576.39,-1766.23 3566.03,-1768.44 3575.5,-1773.17 3576.39,-1766.23"/>
</g>
<!-- expert_gelu_15_3 -->
<g id="node524" class="node">
<title>expert_gelu_15_3</title>
<polygon fill="lightcyan" stroke="black" points="2233.5,-1991.48 2054.5,-1991.48 2054.5,-1938.48 2233.5,-1938.48 2233.5,-1991.48"/>
<text text-anchor="middle" x="2144" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2144" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2144" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_3&#45;&gt;expert_gelu_15_3 -->
<g id="edge814" class="edge">
<title>expert_15_3&#45;&gt;expert_gelu_15_3</title>
<path fill="none" stroke="black" d="M2144,-2028.35C2144,-2019.77 2144,-2010.49 2144,-2001.78"/>
<polygon fill="black" stroke="black" points="2147.5,-2001.53 2144,-1991.53 2140.5,-2001.53 2147.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_3 -->
<g id="node525" class="node">
<title>expert_ffn2_15_3</title>
<polygon fill="lightcyan" stroke="black" points="2316.5,-1901.48 1971.5,-1901.48 1971.5,-1848.48 2316.5,-1848.48 2316.5,-1901.48"/>
<text text-anchor="middle" x="2144" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="2144" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2144" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_3&#45;&gt;expert_ffn2_15_3 -->
<g id="edge815" class="edge">
<title>expert_gelu_15_3&#45;&gt;expert_ffn2_15_3</title>
<path fill="none" stroke="black" d="M2144,-1938.05C2144,-1929.82 2144,-1920.56 2144,-1911.76"/>
<polygon fill="black" stroke="black" points="2147.5,-1911.72 2144,-1901.72 2140.5,-1911.72 2147.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_3&#45;&gt;expert_agg_15 -->
<g id="edge816" class="edge">
<title>expert_ffn2_15_3&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2316.9,-1849.58C2319.95,-1849.21 2322.99,-1848.84 2326,-1848.48 2634.77,-1811.59 2995.7,-1777.93 3204.17,-1759.42"/>
<polygon fill="black" stroke="black" points="3204.63,-1762.89 3214.29,-1758.52 3204.02,-1755.92 3204.63,-1762.89"/>
</g>
<!-- expert_gelu_15_4 -->
<g id="node527" class="node">
<title>expert_gelu_15_4</title>
<polygon fill="lightcyan" stroke="black" points="4085.5,-1991.48 3906.5,-1991.48 3906.5,-1938.48 4085.5,-1938.48 4085.5,-1991.48"/>
<text text-anchor="middle" x="3996" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3996" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3996" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_4&#45;&gt;expert_gelu_15_4 -->
<g id="edge819" class="edge">
<title>expert_15_4&#45;&gt;expert_gelu_15_4</title>
<path fill="none" stroke="black" d="M3996,-2028.35C3996,-2019.77 3996,-2010.49 3996,-2001.78"/>
<polygon fill="black" stroke="black" points="3999.5,-2001.53 3996,-1991.53 3992.5,-2001.53 3999.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_4 -->
<g id="node528" class="node">
<title>expert_ffn2_15_4</title>
<polygon fill="lightcyan" stroke="black" points="4168.5,-1901.48 3823.5,-1901.48 3823.5,-1848.48 4168.5,-1848.48 4168.5,-1901.48"/>
<text text-anchor="middle" x="3996" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="3996" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3996" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_4&#45;&gt;expert_ffn2_15_4 -->
<g id="edge820" class="edge">
<title>expert_gelu_15_4&#45;&gt;expert_ffn2_15_4</title>
<path fill="none" stroke="black" d="M3996,-1938.05C3996,-1929.82 3996,-1920.56 3996,-1911.76"/>
<polygon fill="black" stroke="black" points="3999.5,-1911.72 3996,-1901.72 3992.5,-1911.72 3999.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_4&#45;&gt;expert_agg_15 -->
<g id="edge821" class="edge">
<title>expert_ffn2_15_4&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M3874.07,-1848.47C3792.44,-1831.39 3682.84,-1808.46 3587.33,-1788.48"/>
<polygon fill="black" stroke="black" points="3588.05,-1785.06 3577.54,-1786.44 3586.61,-1791.91 3588.05,-1785.06"/>
</g>
<!-- expert_gelu_15_5 -->
<g id="node530" class="node">
<title>expert_gelu_15_5</title>
<polygon fill="lightcyan" stroke="black" points="4811.5,-1991.48 4632.5,-1991.48 4632.5,-1938.48 4811.5,-1938.48 4811.5,-1991.48"/>
<text text-anchor="middle" x="4722" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4722" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4722" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_5&#45;&gt;expert_gelu_15_5 -->
<g id="edge824" class="edge">
<title>expert_15_5&#45;&gt;expert_gelu_15_5</title>
<path fill="none" stroke="black" d="M4722,-2028.35C4722,-2019.77 4722,-2010.49 4722,-2001.78"/>
<polygon fill="black" stroke="black" points="4725.5,-2001.53 4722,-1991.53 4718.5,-2001.53 4725.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_5 -->
<g id="node531" class="node">
<title>expert_ffn2_15_5</title>
<polygon fill="lightcyan" stroke="black" points="4894.5,-1901.48 4549.5,-1901.48 4549.5,-1848.48 4894.5,-1848.48 4894.5,-1901.48"/>
<text text-anchor="middle" x="4722" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4722" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4722" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_5&#45;&gt;expert_ffn2_15_5 -->
<g id="edge825" class="edge">
<title>expert_gelu_15_5&#45;&gt;expert_ffn2_15_5</title>
<path fill="none" stroke="black" d="M4722,-1938.05C4722,-1929.82 4722,-1920.56 4722,-1911.76"/>
<polygon fill="black" stroke="black" points="4725.5,-1911.72 4722,-1901.72 4718.5,-1911.72 4725.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_5&#45;&gt;expert_agg_15 -->
<g id="edge826" class="edge">
<title>expert_ffn2_15_5&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M4549.1,-1849.43C4546.38,-1849.1 4543.68,-1848.79 4541,-1848.48 4199.52,-1809.2 3800.22,-1776.36 3569.19,-1758.64"/>
<polygon fill="black" stroke="black" points="3569.24,-1755.13 3559,-1757.86 3568.7,-1762.11 3569.24,-1755.13"/>
</g>
<!-- expert_gelu_15_6 -->
<g id="node533" class="node">
<title>expert_gelu_15_6</title>
<polygon fill="lightcyan" stroke="black" points="2959.5,-1991.48 2780.5,-1991.48 2780.5,-1938.48 2959.5,-1938.48 2959.5,-1991.48"/>
<text text-anchor="middle" x="2870" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2870" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2870" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_6&#45;&gt;expert_gelu_15_6 -->
<g id="edge829" class="edge">
<title>expert_15_6&#45;&gt;expert_gelu_15_6</title>
<path fill="none" stroke="black" d="M2870,-2028.35C2870,-2019.77 2870,-2010.49 2870,-2001.78"/>
<polygon fill="black" stroke="black" points="2873.5,-2001.53 2870,-1991.53 2866.5,-2001.53 2873.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_6 -->
<g id="node534" class="node">
<title>expert_ffn2_15_6</title>
<polygon fill="lightcyan" stroke="black" points="3042.5,-1901.48 2697.5,-1901.48 2697.5,-1848.48 3042.5,-1848.48 3042.5,-1901.48"/>
<text text-anchor="middle" x="2870" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="2870" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2870" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_6&#45;&gt;expert_ffn2_15_6 -->
<g id="edge830" class="edge">
<title>expert_gelu_15_6&#45;&gt;expert_ffn2_15_6</title>
<path fill="none" stroke="black" d="M2870,-1938.05C2870,-1929.82 2870,-1920.56 2870,-1911.76"/>
<polygon fill="black" stroke="black" points="2873.5,-1911.72 2870,-1901.72 2866.5,-1911.72 2873.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_6&#45;&gt;expert_agg_15 -->
<g id="edge831" class="edge">
<title>expert_ffn2_15_6&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M2969.86,-1848.47C3040.97,-1830.31 3137.97,-1805.53 3219.45,-1784.72"/>
<polygon fill="black" stroke="black" points="3220.49,-1788.07 3229.31,-1782.2 3218.75,-1781.29 3220.49,-1788.07"/>
</g>
<!-- expert_gelu_15_7 -->
<g id="node536" class="node">
<title>expert_gelu_15_7</title>
<polygon fill="lightcyan" stroke="black" points="3322.5,-1991.48 3143.5,-1991.48 3143.5,-1938.48 3322.5,-1938.48 3322.5,-1991.48"/>
<text text-anchor="middle" x="3233" y="-1976.28" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="3233" y="-1961.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3233" y="-1946.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_15_7&#45;&gt;expert_gelu_15_7 -->
<g id="edge834" class="edge">
<title>expert_15_7&#45;&gt;expert_gelu_15_7</title>
<path fill="none" stroke="black" d="M3233,-2028.35C3233,-2019.77 3233,-2010.49 3233,-2001.78"/>
<polygon fill="black" stroke="black" points="3236.5,-2001.53 3233,-1991.53 3229.5,-2001.53 3236.5,-2001.53"/>
</g>
<!-- expert_ffn2_15_7 -->
<g id="node537" class="node">
<title>expert_ffn2_15_7</title>
<polygon fill="lightcyan" stroke="black" points="3405.5,-1901.48 3060.5,-1901.48 3060.5,-1848.48 3405.5,-1848.48 3405.5,-1901.48"/>
<text text-anchor="middle" x="3233" y="-1886.28" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="3233" y="-1871.28" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3233" y="-1856.28" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- expert_gelu_15_7&#45;&gt;expert_ffn2_15_7 -->
<g id="edge835" class="edge">
<title>expert_gelu_15_7&#45;&gt;expert_ffn2_15_7</title>
<path fill="none" stroke="black" d="M3233,-1938.05C3233,-1929.82 3233,-1920.56 3233,-1911.76"/>
<polygon fill="black" stroke="black" points="3236.5,-1911.72 3233,-1901.72 3229.5,-1911.72 3236.5,-1911.72"/>
</g>
<!-- expert_ffn2_15_7&#45;&gt;expert_agg_15 -->
<g id="edge836" class="edge">
<title>expert_ffn2_15_7&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="black" d="M3261.45,-1848.4C3271.29,-1839.54 3282.87,-1829.13 3294.84,-1818.37"/>
<polygon fill="black" stroke="black" points="3297.23,-1820.93 3302.32,-1811.64 3292.55,-1815.72 3297.23,-1820.93"/>
</g>
<!-- expert_agg_15&#45;&gt;residual2_15 -->
<g id="edge839" class="edge">
<title>expert_agg_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M3190.13,-1721.97C2965.32,-1697.29 2583.28,-1655.34 2303.69,-1624.65"/>
<polygon fill="black" stroke="black" points="2303.7,-1621.13 2293.37,-1623.52 2302.93,-1628.09 2303.7,-1621.13"/>
</g>
<!-- comm_15_16 -->
<g id="node576" class="node">
<title>comm_15_16</title>
<ellipse fill="lightgreen" stroke="black" cx="1956" cy="-1468.61" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="1956" y="-1472.41" font-family="Times,serif" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="1956" y="-1457.41" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_15&#45;&gt;comm_15_16 -->
<g id="edge840" class="edge">
<title>residual2_15&#45;&gt;comm_15_16</title>
<path fill="none" stroke="black" d="M1956,-1532.42C1956,-1523.49 1956,-1514.38 1956,-1505.98"/>
<polygon fill="black" stroke="black" points="1959.5,-1505.77 1956,-1495.77 1952.5,-1505.77 1959.5,-1505.77"/>
</g>
<!-- comm_14_15&#45;&gt;ln1_15 -->
<g id="edge785" class="edge">
<title>comm_14_15&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M1788.44,-2884.97C1771.35,-2874.7 1751.27,-2862.62 1733.18,-2851.75"/>
<polygon fill="black" stroke="black" points="1734.85,-2848.67 1724.48,-2846.52 1731.24,-2854.67 1734.85,-2848.67"/>
</g>
<!-- comm_14_15&#45;&gt;residual1_15 -->
<g id="edge793" class="edge">
<title>comm_14_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1916.31,-2891.79C1979.56,-2876.47 2054,-2851.88 2054,-2820.98 2054,-2820.98 2054,-2820.98 2054,-2548.98 2054,-2528.93 2045.22,-2510.62 2032.91,-2494.81"/>
<polygon fill="black" stroke="black" points="2035.28,-2492.19 2026.18,-2486.77 2029.92,-2496.68 2035.28,-2492.19"/>
</g>
<!-- ln1_16 -->
<g id="node541" class="node">
<title>ln1_16</title>
<polygon fill="lightyellow" stroke="black" points="1894,-1404.74 1724,-1404.74 1724,-1351.74 1894,-1351.74 1894,-1404.74"/>
<text text-anchor="middle" x="1809" y="-1389.54" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1809" y="-1374.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1809" y="-1359.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_q_16 -->
<g id="node542" class="node">
<title>mha_q_16</title>
<polygon fill="lightblue" stroke="black" points="2153,-1314.74 1817,-1314.74 1817,-1261.74 2153,-1261.74 2153,-1314.74"/>
<text text-anchor="middle" x="1985" y="-1299.54" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1985" y="-1284.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1985" y="-1269.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_q_16 -->
<g id="edge842" class="edge">
<title>ln1_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M1860.38,-1351.55C1880.53,-1341.47 1903.8,-1329.84 1924.74,-1319.37"/>
<polygon fill="black" stroke="black" points="1926.48,-1322.41 1933.86,-1314.81 1923.35,-1316.15 1926.48,-1322.41"/>
</g>
<!-- mha_k_16 -->
<g id="node543" class="node">
<title>mha_k_16</title>
<polygon fill="lightblue" stroke="black" points="1445,-1314.74 1109,-1314.74 1109,-1261.74 1445,-1261.74 1445,-1314.74"/>
<text text-anchor="middle" x="1277" y="-1299.54" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="1277" y="-1284.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1277" y="-1269.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_k_16 -->
<g id="edge843" class="edge">
<title>ln1_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M1723.82,-1363.15C1647.99,-1350.61 1534.93,-1331.9 1441.51,-1316.45"/>
<polygon fill="black" stroke="black" points="1441.82,-1312.96 1431.38,-1314.78 1440.68,-1319.86 1441.82,-1312.96"/>
</g>
<!-- mha_v_16 -->
<g id="node544" class="node">
<title>mha_v_16</title>
<polygon fill="lightblue" stroke="black" points="1799,-1314.74 1463,-1314.74 1463,-1261.74 1799,-1261.74 1799,-1314.74"/>
<text text-anchor="middle" x="1631" y="-1299.54" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1631" y="-1284.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1631" y="-1269.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_v_16 -->
<g id="edge844" class="edge">
<title>ln1_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M1757.04,-1351.55C1736.66,-1341.47 1713.12,-1329.84 1691.95,-1319.37"/>
<polygon fill="black" stroke="black" points="1693.24,-1316.1 1682.72,-1314.81 1690.13,-1322.38 1693.24,-1316.1"/>
</g>
<!-- mha_attn_16 -->
<g id="node545" class="node">
<title>mha_attn_16</title>
<polygon fill="lightblue" stroke="black" points="1802,-1224.74 1632,-1224.74 1632,-1171.74 1802,-1171.74 1802,-1224.74"/>
<text text-anchor="middle" x="1717" y="-1209.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1717" y="-1194.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1717" y="-1179.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge845" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1907.12,-1261.67C1875.05,-1251.14 1837.75,-1238.89 1804.72,-1228.04"/>
<polygon fill="black" stroke="black" points="1805.66,-1224.67 1795.07,-1224.88 1803.48,-1231.32 1805.66,-1224.67"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge846" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1404.56,-1261.73C1473.94,-1247.85 1558.3,-1230.98 1621.87,-1218.27"/>
<polygon fill="black" stroke="black" points="1622.77,-1221.66 1631.89,-1216.26 1621.39,-1214.79 1622.77,-1221.66"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge847" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1656.34,-1261.31C1665.26,-1252.18 1675.41,-1241.8 1684.82,-1232.17"/>
<polygon fill="black" stroke="black" points="1687.36,-1234.58 1691.84,-1224.98 1682.35,-1229.69 1687.36,-1234.58"/>
</g>
<!-- mha_out_16 -->
<g id="node546" class="node">
<title>mha_out_16</title>
<polygon fill="lightblue" stroke="black" points="2147,-1134.74 1811,-1134.74 1811,-1081.74 2147,-1081.74 2147,-1134.74"/>
<text text-anchor="middle" x="1979" y="-1119.54" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1979" y="-1104.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1979" y="-1089.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge848" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M1793.13,-1171.67C1824.35,-1161.18 1860.64,-1148.99 1892.83,-1138.18"/>
<polygon fill="black" stroke="black" points="1894.31,-1141.38 1902.68,-1134.88 1892.08,-1134.74 1894.31,-1141.38"/>
</g>
<!-- residual1_16 -->
<g id="node547" class="node">
<title>residual1_16</title>
<polygon fill="lightcoral" stroke="black" points="2476.86,-1044.74 1907.58,-1044.74 1761.14,-938.74 2330.42,-938.74 2476.86,-1044.74"/>
<text text-anchor="middle" x="2119" y="-1003.04" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="2119" y="-988.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2119" y="-973.04" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge850" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M2010.42,-1081.54C2021.43,-1072.53 2034.3,-1062.01 2047.25,-1051.42"/>
<polygon fill="black" stroke="black" points="2049.79,-1053.87 2055.31,-1044.83 2045.35,-1048.45 2049.79,-1053.87"/>
</g>
<!-- ln2_16 -->
<g id="node548" class="node">
<title>ln2_16</title>
<polygon fill="lightyellow" stroke="black" points="3501,-901.74 3331,-901.74 3331,-848.74 3501,-848.74 3501,-901.74"/>
<text text-anchor="middle" x="3416" y="-886.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="3416" y="-871.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3416" y="-856.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge851" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M2371.77,-968.43C2661.74,-942.83 3122.62,-902.14 3320.56,-884.67"/>
<polygon fill="black" stroke="black" points="3320.99,-888.14 3330.64,-883.78 3320.37,-881.17 3320.99,-888.14"/>
</g>
<!-- residual2_16 -->
<g id="node575" class="node">
<title>residual2_16</title>
<polygon fill="lightcoral" stroke="black" points="2476.86,-196.74 1907.58,-196.74 1761.14,-90.74 2330.42,-90.74 2476.86,-196.74"/>
<text text-anchor="middle" x="2119" y="-155.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="2119" y="-140.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2119" y="-125.04" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge894" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M2111.23,-938.71C2108.92,-919.16 2107,-896.73 2107,-876.24 2107,-876.24 2107,-876.24 2107,-300.74 2107,-269.89 2109.36,-235.72 2111.99,-207.24"/>
<polygon fill="black" stroke="black" points="2115.5,-207.31 2112.96,-197.02 2108.53,-206.64 2115.5,-207.31"/>
</g>
<!-- gate_16 -->
<g id="node549" class="node">
<title>gate_16</title>
<polygon fill="orange" stroke="black" points="3585,-811.74 3276,-758.74 3585,-705.74 3894,-758.74 3585,-811.74"/>
<text text-anchor="middle" x="3585" y="-770.04" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="3585" y="-755.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8]</text>
<text text-anchor="middle" x="3585" y="-740.04" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;gate_16 -->
<g id="edge852" class="edge">
<title>ln2_16&#45;&gt;gate_16</title>
<path fill="none" stroke="black" d="M3453.93,-848.54C3472.05,-836.26 3494.34,-821.16 3515.36,-806.92"/>
<polygon fill="black" stroke="black" points="3517.34,-809.81 3523.65,-801.3 3513.41,-804.02 3517.34,-809.81"/>
</g>
<!-- expert_16_0 -->
<g id="node550" class="node">
<title>expert_16_0</title>
<polygon fill="lightcyan" stroke="black" points="2842.5,-654.74 2497.5,-654.74 2497.5,-586.74 2842.5,-586.74 2842.5,-654.74"/>
<text text-anchor="middle" x="2670" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2670" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2670" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2670" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_0 -->
<g id="edge854" class="edge">
<title>ln2_16&#45;&gt;expert_16_0</title>
<path fill="none" stroke="black" d="M3330.9,-866.59C3195.44,-851.14 2926.43,-806.87 2734,-687.74 2722.97,-680.91 2712.49,-671.77 2703.33,-662.47"/>
<polygon fill="black" stroke="black" points="2705.69,-659.87 2696.28,-655.01 2700.61,-664.68 2705.69,-659.87"/>
</g>
<!-- expert_16_1 -->
<g id="node553" class="node">
<title>expert_16_1</title>
<polygon fill="lightcyan" stroke="black" points="3968.5,-654.74 3623.5,-654.74 3623.5,-586.74 3968.5,-586.74 3968.5,-654.74"/>
<text text-anchor="middle" x="3796" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3796" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3796" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3796" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_1 -->
<g id="edge859" class="edge">
<title>ln2_16&#45;&gt;expert_16_1</title>
<path fill="none" stroke="black" d="M3501.19,-869.21C3633.57,-860.53 3876.35,-840.83 3903,-811.74 3944.76,-766.16 3941.45,-724.73 3908,-672.74 3905.46,-668.79 3902.53,-665.15 3899.3,-661.78"/>
<polygon fill="black" stroke="black" points="3901.5,-659.05 3891.77,-654.85 3896.76,-664.2 3901.5,-659.05"/>
</g>
<!-- expert_16_2 -->
<g id="node556" class="node">
<title>expert_16_2</title>
<polygon fill="lightcyan" stroke="black" points="4694.5,-654.74 4349.5,-654.74 4349.5,-586.74 4694.5,-586.74 4694.5,-654.74"/>
<text text-anchor="middle" x="4522" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4522" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4522" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4522" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_2 -->
<g id="edge864" class="edge">
<title>ln2_16&#45;&gt;expert_16_2</title>
<path fill="none" stroke="black" d="M3501.15,-868.21C3597.25,-861.02 3758.15,-847.79 3896,-830.74 4164.63,-797.51 4276.89,-857.15 4488,-687.74 4495.76,-681.51 4501.93,-673.04 4506.77,-664.24"/>
<polygon fill="black" stroke="black" points="4510.02,-665.55 4511.33,-655.04 4503.75,-662.44 4510.02,-665.55"/>
</g>
<!-- expert_16_3 -->
<g id="node559" class="node">
<title>expert_16_3</title>
<polygon fill="lightcyan" stroke="black" points="2479.5,-654.74 2134.5,-654.74 2134.5,-586.74 2479.5,-586.74 2479.5,-654.74"/>
<text text-anchor="middle" x="2307" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2307" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="2307" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2307" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_3 -->
<g id="edge869" class="edge">
<title>ln2_16&#45;&gt;expert_16_3</title>
<path fill="none" stroke="black" d="M3330.88,-874.23C3204.59,-872.4 2960.99,-861.9 2761,-811.74 2619.92,-776.36 2465.73,-704.02 2378.23,-659.52"/>
<polygon fill="black" stroke="black" points="2379.7,-656.34 2369.2,-654.9 2376.51,-662.57 2379.7,-656.34"/>
</g>
<!-- expert_16_4 -->
<g id="node562" class="node">
<title>expert_16_4</title>
<polygon fill="lightcyan" stroke="black" points="4331.5,-654.74 3986.5,-654.74 3986.5,-586.74 4331.5,-586.74 4331.5,-654.74"/>
<text text-anchor="middle" x="4159" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4159" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4159" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4159" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_4 -->
<g id="edge874" class="edge">
<title>ln2_16&#45;&gt;expert_16_4</title>
<path fill="none" stroke="black" d="M3501.24,-871.38C3628.1,-865.87 3859.45,-850.69 3932,-811.74 4006.26,-771.87 4078.54,-705.1 4120.9,-662.26"/>
<polygon fill="black" stroke="black" points="4123.44,-664.67 4127.95,-655.08 4118.45,-659.77 4123.44,-664.67"/>
</g>
<!-- expert_16_5 -->
<g id="node565" class="node">
<title>expert_16_5</title>
<polygon fill="lightcyan" stroke="black" points="5057.5,-654.74 4712.5,-654.74 4712.5,-586.74 5057.5,-586.74 5057.5,-654.74"/>
<text text-anchor="middle" x="4885" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4885" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4885" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4885" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_5 -->
<g id="edge879" class="edge">
<title>ln2_16&#45;&gt;expert_16_5</title>
<path fill="none" stroke="black" d="M3501.22,-871.46C3699.12,-864.52 4185.08,-844.62 4345,-811.74 4512.02,-777.4 4697.72,-703.75 4802.04,-658.9"/>
<polygon fill="black" stroke="black" points="4803.46,-662.1 4811.26,-654.92 4800.69,-655.67 4803.46,-662.1"/>
</g>
<!-- expert_16_6 -->
<g id="node568" class="node">
<title>expert_16_6</title>
<polygon fill="lightcyan" stroke="black" points="3205.5,-654.74 2860.5,-654.74 2860.5,-586.74 3205.5,-586.74 3205.5,-654.74"/>
<text text-anchor="middle" x="3033" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="3033" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3033" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3033" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_6 -->
<g id="edge884" class="edge">
<title>ln2_16&#45;&gt;expert_16_6</title>
<path fill="none" stroke="black" d="M3330.67,-849.91C3313.35,-844.21 3295.42,-837.73 3279,-830.74 3179.2,-788.26 3174.24,-744.61 3093,-672.74 3088.9,-669.12 3084.62,-665.38 3080.32,-661.66"/>
<polygon fill="black" stroke="black" points="3082.43,-658.86 3072.57,-654.99 3077.86,-664.16 3082.43,-658.86"/>
</g>
<!-- expert_16_7 -->
<g id="node571" class="node">
<title>expert_16_7</title>
<polygon fill="lightcyan" stroke="black" points="3568.5,-654.74 3223.5,-654.74 3223.5,-586.74 3568.5,-586.74 3568.5,-654.74"/>
<text text-anchor="middle" x="3396" y="-639.54" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="3396" y="-624.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="3396" y="-609.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3396" y="-594.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;expert_16_7 -->
<g id="edge889" class="edge">
<title>ln2_16&#45;&gt;expert_16_7</title>
<path fill="none" stroke="black" d="M3330.84,-857.5C3306.08,-848.26 3281.76,-833.93 3267,-811.74 3240.91,-772.51 3244.55,-747.16 3267,-705.74 3276.96,-687.37 3292.87,-672.38 3310.17,-660.43"/>
<polygon fill="black" stroke="black" points="3312.31,-663.21 3318.76,-654.8 3308.48,-657.35 3312.31,-663.21"/>
</g>
<!-- gate_16&#45;&gt;expert_16_0 -->
<g id="edge853" class="edge">
<title>gate_16&#45;&gt;expert_16_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3411.8,-735.38C3265.55,-716.03 3050.39,-686.48 2852.88,-654.86"/>
<polygon fill="black" stroke="black" points="2853.32,-651.39 2842.89,-653.26 2852.21,-658.3 2853.32,-651.39"/>
<text text-anchor="middle" x="3097.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_1 -->
<g id="edge858" class="edge">
<title>gate_16&#45;&gt;expert_16_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3635.59,-714.4C3653.19,-700.29 3673.43,-685.1 3693,-672.74 3700.09,-668.26 3707.64,-663.88 3715.29,-659.68"/>
<polygon fill="black" stroke="black" points="3717.15,-662.65 3724.3,-654.84 3713.83,-656.49 3717.15,-662.65"/>
<text text-anchor="middle" x="3738.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_2 -->
<g id="edge863" class="edge">
<title>gate_16&#45;&gt;expert_16_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3761.38,-735.99C3912.34,-716.84 4135.64,-687.24 4339.12,-655.02"/>
<polygon fill="black" stroke="black" points="4339.78,-658.46 4349.1,-653.44 4338.68,-651.55 4339.78,-658.46"/>
<text text-anchor="middle" x="4262.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_3 -->
<g id="edge868" class="edge">
<title>gate_16&#45;&gt;expert_16_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3368.35,-742.88C3149.19,-726.58 2800.59,-697.15 2489.97,-654.84"/>
<polygon fill="black" stroke="black" points="2490.24,-651.34 2479.86,-653.45 2489.29,-658.28 2490.24,-651.34"/>
<text text-anchor="middle" x="2803.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_4 -->
<g id="edge873" class="edge">
<title>gate_16&#45;&gt;expert_16_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3689.92,-723.73C3744.43,-706.86 3812.37,-687.09 3874,-672.74 3916.74,-662.79 3930.11,-662.89 3976.09,-655.04"/>
<polygon fill="black" stroke="black" points="3976.83,-658.47 3986.08,-653.3 3975.63,-651.57 3976.83,-658.47"/>
<text text-anchor="middle" x="3919.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_5 -->
<g id="edge878" class="edge">
<title>gate_16&#45;&gt;expert_16_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3804.36,-743.32C4028.02,-727.27 4385.04,-697.98 4701.82,-655.01"/>
<polygon fill="black" stroke="black" points="4702.69,-658.42 4712.13,-653.6 4701.75,-651.48 4702.69,-658.42"/>
<text text-anchor="middle" x="4597.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_6 -->
<g id="edge883" class="edge">
<title>gate_16&#45;&gt;expert_16_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3460.43,-727.05C3376.3,-706.32 3264.98,-678.89 3177.03,-657.23"/>
<polygon fill="black" stroke="black" points="3177.79,-653.81 3167.25,-654.82 3176.12,-660.61 3177.79,-653.81"/>
<text text-anchor="middle" x="3337.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- gate_16&#45;&gt;expert_16_7 -->
<g id="edge888" class="edge">
<title>gate_16&#45;&gt;expert_16_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3526.49,-715.64C3502.15,-698.12 3474.06,-677.91 3450.2,-660.74"/>
<polygon fill="black" stroke="black" points="3452.11,-657.8 3441.94,-654.8 3448.02,-663.48 3452.11,-657.8"/>
<text text-anchor="middle" x="3529.5" y="-676.54" font-family="Times,serif" font-size="14.00">route tokens</text>
</g>
<!-- expert_agg_16 -->
<g id="node574" class="node">
<title>expert_agg_16</title>
<polygon fill="lightpink" stroke="black" points="3756.86,-369.74 3411.88,-369.74 3323.14,-233.74 3668.12,-233.74 3756.86,-369.74"/>
<text text-anchor="middle" x="3540" y="-320.54" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="3540" y="-305.54" font-family="Times,serif" font-size="14.00">Weighted sum of 8 experts</text>
<text text-anchor="middle" x="3540" y="-290.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3540" y="-275.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- gate_16&#45;&gt;expert_agg_16 -->
<g id="edge893" class="edge">
<title>gate_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3591.11,-706.48C3593.64,-681.03 3596,-649.81 3596,-621.74 3596,-621.74 3596,-621.74 3596,-432.24 3596,-414.53 3591.53,-396.49 3585.12,-379.72"/>
<polygon fill="black" stroke="black" points="3588.17,-377.94 3581.14,-370.01 3581.69,-380.59 3588.17,-377.94"/>
<text text-anchor="middle" x="3624.5" y="-519.54" font-family="Times,serif" font-size="14.00">weights</text>
</g>
<!-- expert_gelu_16_0 -->
<g id="node551" class="node">
<title>expert_gelu_16_0</title>
<polygon fill="lightcyan" stroke="black" points="2759.5,-549.74 2580.5,-549.74 2580.5,-496.74 2759.5,-496.74 2759.5,-549.74"/>
<text text-anchor="middle" x="2670" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="2670" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2670" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_0&#45;&gt;expert_gelu_16_0 -->
<g id="edge855" class="edge">
<title>expert_16_0&#45;&gt;expert_gelu_16_0</title>
<path fill="none" stroke="black" d="M2670,-586.61C2670,-578.03 2670,-568.75 2670,-560.04"/>
<polygon fill="black" stroke="black" points="2673.5,-559.79 2670,-549.79 2666.5,-559.79 2673.5,-559.79"/>
</g>
<!-- expert_ffn2_16_0 -->
<g id="node552" class="node">
<title>expert_ffn2_16_0</title>
<polygon fill="lightcyan" stroke="black" points="2842.5,-459.74 2497.5,-459.74 2497.5,-406.74 2842.5,-406.74 2842.5,-459.74"/>
<text text-anchor="middle" x="2670" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 0 FFN Linear2</text>
<text text-anchor="middle" x="2670" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2670" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_0&#45;&gt;expert_ffn2_16_0 -->
<g id="edge856" class="edge">
<title>expert_gelu_16_0&#45;&gt;expert_ffn2_16_0</title>
<path fill="none" stroke="black" d="M2670,-496.31C2670,-488.08 2670,-478.82 2670,-470.02"/>
<polygon fill="black" stroke="black" points="2673.5,-469.98 2670,-459.98 2666.5,-469.98 2673.5,-469.98"/>
</g>
<!-- expert_ffn2_16_0&#45;&gt;expert_agg_16 -->
<g id="edge857" class="edge">
<title>expert_ffn2_16_0&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M2841.36,-406.73C2995.52,-383.79 3220.61,-350.28 3373.31,-327.55"/>
<polygon fill="black" stroke="black" points="3373.89,-331 3383.26,-326.07 3372.86,-324.08 3373.89,-331"/>
</g>
<!-- expert_gelu_16_1 -->
<g id="node554" class="node">
<title>expert_gelu_16_1</title>
<polygon fill="lightcyan" stroke="black" points="3885.5,-549.74 3706.5,-549.74 3706.5,-496.74 3885.5,-496.74 3885.5,-549.74"/>
<text text-anchor="middle" x="3796" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="3796" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3796" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_1&#45;&gt;expert_gelu_16_1 -->
<g id="edge860" class="edge">
<title>expert_16_1&#45;&gt;expert_gelu_16_1</title>
<path fill="none" stroke="black" d="M3796,-586.61C3796,-578.03 3796,-568.75 3796,-560.04"/>
<polygon fill="black" stroke="black" points="3799.5,-559.79 3796,-549.79 3792.5,-559.79 3799.5,-559.79"/>
</g>
<!-- expert_ffn2_16_1 -->
<g id="node555" class="node">
<title>expert_ffn2_16_1</title>
<polygon fill="lightcyan" stroke="black" points="3968.5,-459.74 3623.5,-459.74 3623.5,-406.74 3968.5,-406.74 3968.5,-459.74"/>
<text text-anchor="middle" x="3796" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 1 FFN Linear2</text>
<text text-anchor="middle" x="3796" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3796" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_1&#45;&gt;expert_ffn2_16_1 -->
<g id="edge861" class="edge">
<title>expert_gelu_16_1&#45;&gt;expert_ffn2_16_1</title>
<path fill="none" stroke="black" d="M3796,-496.31C3796,-488.08 3796,-478.82 3796,-470.02"/>
<polygon fill="black" stroke="black" points="3799.5,-469.98 3796,-459.98 3792.5,-469.98 3799.5,-469.98"/>
</g>
<!-- expert_ffn2_16_1&#45;&gt;expert_agg_16 -->
<g id="edge862" class="edge">
<title>expert_ffn2_16_1&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M3745.42,-406.66C3726.71,-397.19 3704.45,-385.93 3681.61,-374.38"/>
<polygon fill="black" stroke="black" points="3683,-371.15 3672.49,-369.76 3679.84,-377.4 3683,-371.15"/>
</g>
<!-- expert_gelu_16_2 -->
<g id="node557" class="node">
<title>expert_gelu_16_2</title>
<polygon fill="lightcyan" stroke="black" points="4611.5,-549.74 4432.5,-549.74 4432.5,-496.74 4611.5,-496.74 4611.5,-549.74"/>
<text text-anchor="middle" x="4522" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="4522" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4522" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_2&#45;&gt;expert_gelu_16_2 -->
<g id="edge865" class="edge">
<title>expert_16_2&#45;&gt;expert_gelu_16_2</title>
<path fill="none" stroke="black" d="M4522,-586.61C4522,-578.03 4522,-568.75 4522,-560.04"/>
<polygon fill="black" stroke="black" points="4525.5,-559.79 4522,-549.79 4518.5,-559.79 4525.5,-559.79"/>
</g>
<!-- expert_ffn2_16_2 -->
<g id="node558" class="node">
<title>expert_ffn2_16_2</title>
<polygon fill="lightcyan" stroke="black" points="4694.5,-459.74 4349.5,-459.74 4349.5,-406.74 4694.5,-406.74 4694.5,-459.74"/>
<text text-anchor="middle" x="4522" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 2 FFN Linear2</text>
<text text-anchor="middle" x="4522" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4522" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_2&#45;&gt;expert_ffn2_16_2 -->
<g id="edge866" class="edge">
<title>expert_gelu_16_2&#45;&gt;expert_ffn2_16_2</title>
<path fill="none" stroke="black" d="M4522,-496.31C4522,-488.08 4522,-478.82 4522,-470.02"/>
<polygon fill="black" stroke="black" points="4525.5,-469.98 4522,-459.98 4518.5,-469.98 4525.5,-469.98"/>
</g>
<!-- expert_ffn2_16_2&#45;&gt;expert_agg_16 -->
<g id="edge867" class="edge">
<title>expert_ffn2_16_2&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M4349.08,-407.84C4346.37,-407.47 4343.67,-407.1 4341,-406.74 4135.98,-378.99 3901.23,-348.68 3739.11,-327.98"/>
<polygon fill="black" stroke="black" points="3739.39,-324.49 3729.03,-326.7 3738.5,-331.43 3739.39,-324.49"/>
</g>
<!-- expert_gelu_16_3 -->
<g id="node560" class="node">
<title>expert_gelu_16_3</title>
<polygon fill="lightcyan" stroke="black" points="2396.5,-549.74 2217.5,-549.74 2217.5,-496.74 2396.5,-496.74 2396.5,-549.74"/>
<text text-anchor="middle" x="2307" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2307" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="2307" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_3&#45;&gt;expert_gelu_16_3 -->
<g id="edge870" class="edge">
<title>expert_16_3&#45;&gt;expert_gelu_16_3</title>
<path fill="none" stroke="black" d="M2307,-586.61C2307,-578.03 2307,-568.75 2307,-560.04"/>
<polygon fill="black" stroke="black" points="2310.5,-559.79 2307,-549.79 2303.5,-559.79 2310.5,-559.79"/>
</g>
<!-- expert_ffn2_16_3 -->
<g id="node561" class="node">
<title>expert_ffn2_16_3</title>
<polygon fill="lightcyan" stroke="black" points="2479.5,-459.74 2134.5,-459.74 2134.5,-406.74 2479.5,-406.74 2479.5,-459.74"/>
<text text-anchor="middle" x="2307" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 3 FFN Linear2</text>
<text text-anchor="middle" x="2307" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2307" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_3&#45;&gt;expert_ffn2_16_3 -->
<g id="edge871" class="edge">
<title>expert_gelu_16_3&#45;&gt;expert_ffn2_16_3</title>
<path fill="none" stroke="black" d="M2307,-496.31C2307,-488.08 2307,-478.82 2307,-470.02"/>
<polygon fill="black" stroke="black" points="2310.5,-469.98 2307,-459.98 2303.5,-469.98 2310.5,-469.98"/>
</g>
<!-- expert_ffn2_16_3&#45;&gt;expert_agg_16 -->
<g id="edge872" class="edge">
<title>expert_ffn2_16_3&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M2479.9,-407.84C2482.95,-407.47 2485.99,-407.1 2489,-406.74 2797.77,-369.85 3158.7,-336.19 3367.17,-317.68"/>
<polygon fill="black" stroke="black" points="3367.63,-321.15 3377.29,-316.78 3367.02,-314.18 3367.63,-321.15"/>
</g>
<!-- expert_gelu_16_4 -->
<g id="node563" class="node">
<title>expert_gelu_16_4</title>
<polygon fill="lightcyan" stroke="black" points="4248.5,-549.74 4069.5,-549.74 4069.5,-496.74 4248.5,-496.74 4248.5,-549.74"/>
<text text-anchor="middle" x="4159" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="4159" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4159" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_4&#45;&gt;expert_gelu_16_4 -->
<g id="edge875" class="edge">
<title>expert_16_4&#45;&gt;expert_gelu_16_4</title>
<path fill="none" stroke="black" d="M4159,-586.61C4159,-578.03 4159,-568.75 4159,-560.04"/>
<polygon fill="black" stroke="black" points="4162.5,-559.79 4159,-549.79 4155.5,-559.79 4162.5,-559.79"/>
</g>
<!-- expert_ffn2_16_4 -->
<g id="node564" class="node">
<title>expert_ffn2_16_4</title>
<polygon fill="lightcyan" stroke="black" points="4331.5,-459.74 3986.5,-459.74 3986.5,-406.74 4331.5,-406.74 4331.5,-459.74"/>
<text text-anchor="middle" x="4159" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 4 FFN Linear2</text>
<text text-anchor="middle" x="4159" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4159" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_4&#45;&gt;expert_ffn2_16_4 -->
<g id="edge876" class="edge">
<title>expert_gelu_16_4&#45;&gt;expert_ffn2_16_4</title>
<path fill="none" stroke="black" d="M4159,-496.31C4159,-488.08 4159,-478.82 4159,-470.02"/>
<polygon fill="black" stroke="black" points="4162.5,-469.98 4159,-459.98 4155.5,-469.98 4162.5,-469.98"/>
</g>
<!-- expert_ffn2_16_4&#45;&gt;expert_agg_16 -->
<g id="edge877" class="edge">
<title>expert_ffn2_16_4&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M4037.07,-406.73C3955.44,-389.65 3845.84,-366.72 3750.33,-346.74"/>
<polygon fill="black" stroke="black" points="3751.05,-343.32 3740.54,-344.7 3749.61,-350.17 3751.05,-343.32"/>
</g>
<!-- expert_gelu_16_5 -->
<g id="node566" class="node">
<title>expert_gelu_16_5</title>
<polygon fill="lightcyan" stroke="black" points="4974.5,-549.74 4795.5,-549.74 4795.5,-496.74 4974.5,-496.74 4974.5,-549.74"/>
<text text-anchor="middle" x="4885" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="4885" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4885" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_5&#45;&gt;expert_gelu_16_5 -->
<g id="edge880" class="edge">
<title>expert_16_5&#45;&gt;expert_gelu_16_5</title>
<path fill="none" stroke="black" d="M4885,-586.61C4885,-578.03 4885,-568.75 4885,-560.04"/>
<polygon fill="black" stroke="black" points="4888.5,-559.79 4885,-549.79 4881.5,-559.79 4888.5,-559.79"/>
</g>
<!-- expert_ffn2_16_5 -->
<g id="node567" class="node">
<title>expert_ffn2_16_5</title>
<polygon fill="lightcyan" stroke="black" points="5057.5,-459.74 4712.5,-459.74 4712.5,-406.74 5057.5,-406.74 5057.5,-459.74"/>
<text text-anchor="middle" x="4885" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 5 FFN Linear2</text>
<text text-anchor="middle" x="4885" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4885" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_5&#45;&gt;expert_ffn2_16_5 -->
<g id="edge881" class="edge">
<title>expert_gelu_16_5&#45;&gt;expert_ffn2_16_5</title>
<path fill="none" stroke="black" d="M4885,-496.31C4885,-488.08 4885,-478.82 4885,-470.02"/>
<polygon fill="black" stroke="black" points="4888.5,-469.98 4885,-459.98 4881.5,-469.98 4888.5,-469.98"/>
</g>
<!-- expert_ffn2_16_5&#45;&gt;expert_agg_16 -->
<g id="edge882" class="edge">
<title>expert_ffn2_16_5&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M4712.1,-407.69C4709.38,-407.36 4706.68,-407.05 4704,-406.74 4362.52,-367.46 3963.22,-334.62 3732.19,-316.9"/>
<polygon fill="black" stroke="black" points="3732.24,-313.39 3722,-316.12 3731.7,-320.37 3732.24,-313.39"/>
</g>
<!-- expert_gelu_16_6 -->
<g id="node569" class="node">
<title>expert_gelu_16_6</title>
<polygon fill="lightcyan" stroke="black" points="3122.5,-549.74 2943.5,-549.74 2943.5,-496.74 3122.5,-496.74 3122.5,-549.74"/>
<text text-anchor="middle" x="3033" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="3033" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3033" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_6&#45;&gt;expert_gelu_16_6 -->
<g id="edge885" class="edge">
<title>expert_16_6&#45;&gt;expert_gelu_16_6</title>
<path fill="none" stroke="black" d="M3033,-586.61C3033,-578.03 3033,-568.75 3033,-560.04"/>
<polygon fill="black" stroke="black" points="3036.5,-559.79 3033,-549.79 3029.5,-559.79 3036.5,-559.79"/>
</g>
<!-- expert_ffn2_16_6 -->
<g id="node570" class="node">
<title>expert_ffn2_16_6</title>
<polygon fill="lightcyan" stroke="black" points="3205.5,-459.74 2860.5,-459.74 2860.5,-406.74 3205.5,-406.74 3205.5,-459.74"/>
<text text-anchor="middle" x="3033" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 6 FFN Linear2</text>
<text text-anchor="middle" x="3033" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3033" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_6&#45;&gt;expert_ffn2_16_6 -->
<g id="edge886" class="edge">
<title>expert_gelu_16_6&#45;&gt;expert_ffn2_16_6</title>
<path fill="none" stroke="black" d="M3033,-496.31C3033,-488.08 3033,-478.82 3033,-470.02"/>
<polygon fill="black" stroke="black" points="3036.5,-469.98 3033,-459.98 3029.5,-469.98 3036.5,-469.98"/>
</g>
<!-- expert_ffn2_16_6&#45;&gt;expert_agg_16 -->
<g id="edge887" class="edge">
<title>expert_ffn2_16_6&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M3132.86,-406.73C3203.97,-388.57 3300.97,-363.79 3382.45,-342.98"/>
<polygon fill="black" stroke="black" points="3383.49,-346.33 3392.31,-340.46 3381.75,-339.55 3383.49,-346.33"/>
</g>
<!-- expert_gelu_16_7 -->
<g id="node572" class="node">
<title>expert_gelu_16_7</title>
<polygon fill="lightcyan" stroke="black" points="3485.5,-549.74 3306.5,-549.74 3306.5,-496.74 3485.5,-496.74 3485.5,-549.74"/>
<text text-anchor="middle" x="3396" y="-534.54" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="3396" y="-519.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="3396" y="-504.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_16_7&#45;&gt;expert_gelu_16_7 -->
<g id="edge890" class="edge">
<title>expert_16_7&#45;&gt;expert_gelu_16_7</title>
<path fill="none" stroke="black" d="M3396,-586.61C3396,-578.03 3396,-568.75 3396,-560.04"/>
<polygon fill="black" stroke="black" points="3399.5,-559.79 3396,-549.79 3392.5,-559.79 3399.5,-559.79"/>
</g>
<!-- expert_ffn2_16_7 -->
<g id="node573" class="node">
<title>expert_ffn2_16_7</title>
<polygon fill="lightcyan" stroke="black" points="3568.5,-459.74 3223.5,-459.74 3223.5,-406.74 3568.5,-406.74 3568.5,-459.74"/>
<text text-anchor="middle" x="3396" y="-444.54" font-family="Times,serif" font-size="14.00">Expert 7 FFN Linear2</text>
<text text-anchor="middle" x="3396" y="-429.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3396" y="-414.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- expert_gelu_16_7&#45;&gt;expert_ffn2_16_7 -->
<g id="edge891" class="edge">
<title>expert_gelu_16_7&#45;&gt;expert_ffn2_16_7</title>
<path fill="none" stroke="black" d="M3396,-496.31C3396,-488.08 3396,-478.82 3396,-470.02"/>
<polygon fill="black" stroke="black" points="3399.5,-469.98 3396,-459.98 3392.5,-469.98 3399.5,-469.98"/>
</g>
<!-- expert_ffn2_16_7&#45;&gt;expert_agg_16 -->
<g id="edge892" class="edge">
<title>expert_ffn2_16_7&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="black" d="M3424.45,-406.66C3434.29,-397.8 3445.87,-387.39 3457.84,-376.63"/>
<polygon fill="black" stroke="black" points="3460.23,-379.19 3465.32,-369.9 3455.55,-373.98 3460.23,-379.19"/>
</g>
<!-- expert_agg_16&#45;&gt;residual2_16 -->
<g id="edge895" class="edge">
<title>expert_agg_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M3353.13,-280.23C3128.32,-255.55 2746.28,-213.6 2466.69,-182.91"/>
<polygon fill="black" stroke="black" points="2466.7,-179.39 2456.37,-181.78 2465.93,-186.35 2466.7,-179.39"/>
</g>
<!-- output -->
<g id="node577" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="2119" cy="-26.87" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="2119" y="-30.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2119" y="-15.67" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge896" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2119,-90.68C2119,-81.75 2119,-72.64 2119,-64.24"/>
<polygon fill="black" stroke="black" points="2122.5,-64.03 2119,-54.03 2115.5,-64.03 2122.5,-64.03"/>
</g>
<!-- comm_15_16&#45;&gt;ln1_16 -->
<g id="edge841" class="edge">
<title>comm_15_16&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M1915.44,-1443.23C1898.35,-1432.96 1878.27,-1420.88 1860.18,-1410.01"/>
<polygon fill="black" stroke="black" points="1861.85,-1406.93 1851.48,-1404.78 1858.24,-1412.93 1861.85,-1406.93"/>
</g>
<!-- comm_15_16&#45;&gt;residual1_16 -->
<g id="edge849" class="edge">
<title>comm_15_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M2043.31,-1450.05C2106.56,-1434.73 2181,-1410.14 2181,-1379.24 2181,-1379.24 2181,-1379.24 2181,-1107.24 2181,-1088.74 2174.66,-1070.36 2166.04,-1053.93"/>
<polygon fill="black" stroke="black" points="2168.98,-1052.02 2161.04,-1045.01 2162.88,-1055.44 2168.98,-1052.02"/>
</g>
</g>
</svg>
