<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="129pt" height="1800pt"
 viewBox="0.00 0.00 129.42 1800.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 27973.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-27973.91 2007.57,-27973.91 2007.57,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="279.57" cy="-27932.43" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="279.57" y="-27943.73" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="279.57" y="-27928.73" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="279.57" y="-27913.73" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- layer_0_ln1 -->
<g id="node2" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightcoral" stroke="black" points="547.57,-27846.98 341.57,-27846.98 341.57,-27793.98 547.57,-27793.98 547.57,-27846.98"/>
<text text-anchor="middle" x="444.57" y="-27831.78" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="444.57" y="-27816.78" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="444.57" y="-27801.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M330.87,-27897.24C352.24,-27883 376.89,-27866.58 397.76,-27852.67"/>
<polygon fill="black" stroke="black" points="399.77,-27855.54 406.15,-27847.08 395.89,-27849.71 399.77,-27855.54"/>
</g>
<!-- layer_0_add1 -->
<g id="node14" class="node">
<title>layer_0_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-27064 110.57,-27064 110.57,-27011 316.57,-27011 316.57,-27064"/>
<text text-anchor="middle" x="213.57" y="-27048.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-27033.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-27018.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_add1 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;layer_0_add1</title>
<path fill="none" stroke="black" d="M237.83,-27896.06C219.29,-27876.34 201.57,-27850.03 201.57,-27821.48 201.57,-27821.48 201.57,-27821.48 201.57,-27126.5 201.57,-27109.17 203.88,-27090.1 206.48,-27074.15"/>
<polygon fill="black" stroke="black" points="209.95,-27074.62 208.2,-27064.17 203.05,-27073.43 209.95,-27074.62"/>
</g>
<!-- layer_0_q_proj -->
<g id="node3" class="node">
<title>layer_0_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-27746 453.57,-27746 453.57,-27693 659.57,-27693 659.57,-27746"/>
<text text-anchor="middle" x="556.57" y="-27730.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-27715.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-27700.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_q_proj -->
<g id="edge2" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_q_proj</title>
<path fill="none" stroke="black" d="M473.71,-27793.73C487.84,-27781.24 504.96,-27766.11 519.96,-27752.86"/>
<polygon fill="black" stroke="black" points="522.41,-27755.36 527.58,-27746.12 517.77,-27750.12 522.41,-27755.36"/>
</g>
<!-- layer_0_k_proj -->
<g id="node4" class="node">
<title>layer_0_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-27746 677.57,-27746 677.57,-27693 883.57,-27693 883.57,-27746"/>
<text text-anchor="middle" x="780.57" y="-27730.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-27715.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-27700.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_k_proj -->
<g id="edge3" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_k_proj</title>
<path fill="none" stroke="black" d="M521.55,-27793.93C533.26,-27790.18 545.22,-27786.43 556.57,-27783 595.24,-27771.31 637.9,-27759.21 675.53,-27748.81"/>
<polygon fill="black" stroke="black" points="676.78,-27752.1 685.49,-27746.06 674.92,-27745.35 676.78,-27752.1"/>
</g>
<!-- layer_0_v_proj -->
<g id="node5" class="node">
<title>layer_0_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-27746 229.57,-27746 229.57,-27693 435.57,-27693 435.57,-27746"/>
<text text-anchor="middle" x="332.57" y="-27730.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-27715.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-27700.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_v_proj -->
<g id="edge4" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_v_proj</title>
<path fill="none" stroke="black" d="M415.44,-27793.73C401.31,-27781.24 384.19,-27766.11 369.18,-27752.86"/>
<polygon fill="black" stroke="black" points="371.37,-27750.12 361.56,-27746.12 366.74,-27755.36 371.37,-27750.12"/>
</g>
<!-- layer_0_q_reshape -->
<g id="node6" class="node">
<title>layer_0_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-27656 426.57,-27656 426.57,-27603 650.57,-27603 650.57,-27656"/>
<text text-anchor="middle" x="538.57" y="-27640.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-27625.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-27610.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_q_proj&#45;&gt;layer_0_q_reshape -->
<g id="edge5" class="edge">
<title>layer_0_q_proj&#45;&gt;layer_0_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-27692.57C549.58,-27684.34 547.69,-27675.08 545.89,-27666.28"/>
<polygon fill="black" stroke="black" points="549.27,-27665.34 543.84,-27656.24 542.41,-27666.74 549.27,-27665.34"/>
</g>
<!-- layer_0_k_reshape -->
<g id="node7" class="node">
<title>layer_0_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-27656 668.57,-27656 668.57,-27603 892.57,-27603 892.57,-27656"/>
<text text-anchor="middle" x="780.57" y="-27640.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-27625.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-27610.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_k_proj&#45;&gt;layer_0_k_reshape -->
<g id="edge6" class="edge">
<title>layer_0_k_proj&#45;&gt;layer_0_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-27692.57C780.57,-27684.34 780.57,-27675.08 780.57,-27666.28"/>
<polygon fill="black" stroke="black" points="784.07,-27666.24 780.57,-27656.24 777.07,-27666.24 784.07,-27666.24"/>
</g>
<!-- layer_0_v_reshape -->
<g id="node8" class="node">
<title>layer_0_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-27585 226.57,-27585 226.57,-27532 450.57,-27532 450.57,-27585"/>
<text text-anchor="middle" x="338.57" y="-27569.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-27554.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-27539.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_v_proj&#45;&gt;layer_0_v_reshape -->
<g id="edge7" class="edge">
<title>layer_0_v_proj&#45;&gt;layer_0_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-27692.95C334.53,-27666.61 336.09,-27625.29 337.21,-27595.61"/>
<polygon fill="black" stroke="black" points="340.72,-27595.37 337.6,-27585.25 333.72,-27595.11 340.72,-27595.37"/>
</g>
<!-- layer_0_attn_scores -->
<g id="node9" class="node">
<title>layer_0_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-27514 422.07,-27514 422.07,-27461 655.07,-27461 655.07,-27514"/>
<text text-anchor="middle" x="538.57" y="-27498.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-27483.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-27468.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_q_reshape&#45;&gt;layer_0_attn_scores -->
<g id="edge8" class="edge">
<title>layer_0_q_reshape&#45;&gt;layer_0_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-27602.82C538.57,-27580.72 538.57,-27548.6 538.57,-27524.03"/>
<polygon fill="black" stroke="black" points="542.07,-27524.02 538.57,-27514.02 535.07,-27524.02 542.07,-27524.02"/>
</g>
<!-- layer_0_k_reshape&#45;&gt;layer_0_attn_scores -->
<g id="edge9" class="edge">
<title>layer_0_k_reshape&#45;&gt;layer_0_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-27602.98C695.65,-27579.37 634.91,-27544.23 591.5,-27519.12"/>
<polygon fill="black" stroke="black" points="593.19,-27516.05 582.78,-27514.08 589.68,-27522.11 593.19,-27516.05"/>
</g>
<!-- layer_0_attn_output -->
<g id="node11" class="node">
<title>layer_0_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-27334 229.57,-27334 229.57,-27281 453.57,-27281 453.57,-27334"/>
<text text-anchor="middle" x="341.57" y="-27318.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-27303.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-27288.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_v_reshape&#45;&gt;layer_0_attn_output -->
<g id="edge12" class="edge">
<title>layer_0_v_reshape&#45;&gt;layer_0_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-27531.79C339.42,-27487.13 340.53,-27395.13 341.14,-27344.27"/>
<polygon fill="black" stroke="black" points="344.64,-27344.11 341.26,-27334.07 337.64,-27344.03 344.64,-27344.11"/>
</g>
<!-- layer_0_attn_weights -->
<g id="node10" class="node">
<title>layer_0_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="628.07,-27424 395.07,-27424 395.07,-27371 628.07,-27371 628.07,-27424"/>
<text text-anchor="middle" x="511.57" y="-27408.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="511.57" y="-27393.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="511.57" y="-27378.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_scores&#45;&gt;layer_0_attn_weights -->
<g id="edge10" class="edge">
<title>layer_0_attn_scores&#45;&gt;layer_0_attn_weights</title>
<path fill="none" stroke="black" d="M530.62,-27460.57C528.06,-27452.25 525.19,-27442.88 522.46,-27433.99"/>
<polygon fill="black" stroke="black" points="525.75,-27432.78 519.47,-27424.24 519.06,-27434.83 525.75,-27432.78"/>
</g>
<!-- layer_0_attn_weights&#45;&gt;layer_0_attn_output -->
<g id="edge11" class="edge">
<title>layer_0_attn_weights&#45;&gt;layer_0_attn_output</title>
<path fill="none" stroke="black" d="M461.94,-27370.81C442.57,-27360.78 420.2,-27349.2 400.05,-27338.77"/>
<polygon fill="black" stroke="black" points="401.46,-27335.56 390.97,-27334.07 398.24,-27341.77 401.46,-27335.56"/>
</g>
<!-- layer_0_attn_reshape -->
<g id="node12" class="node">
<title>layer_0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-27244 236.57,-27244 236.57,-27191 442.57,-27191 442.57,-27244"/>
<text text-anchor="middle" x="339.57" y="-27228.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-27213.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-27198.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_output&#45;&gt;layer_0_attn_reshape -->
<g id="edge13" class="edge">
<title>layer_0_attn_output&#45;&gt;layer_0_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-27280.57C340.79,-27272.34 340.58,-27263.08 340.38,-27254.28"/>
<polygon fill="black" stroke="black" points="343.88,-27254.16 340.16,-27244.24 336.88,-27254.32 343.88,-27254.16"/>
</g>
<!-- layer_0_attn_proj -->
<g id="node13" class="node">
<title>layer_0_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-27154 233.57,-27154 233.57,-27101 439.57,-27101 439.57,-27154"/>
<text text-anchor="middle" x="336.57" y="-27138.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-27123.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-27108.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_reshape&#45;&gt;layer_0_attn_proj -->
<g id="edge14" class="edge">
<title>layer_0_attn_reshape&#45;&gt;layer_0_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-27190.57C338.41,-27182.34 338.09,-27173.08 337.79,-27164.28"/>
<polygon fill="black" stroke="black" points="341.29,-27164.12 337.45,-27154.24 334.29,-27164.36 341.29,-27164.12"/>
</g>
<!-- layer_0_attn_proj&#45;&gt;layer_0_add1 -->
<g id="edge16" class="edge">
<title>layer_0_attn_proj&#45;&gt;layer_0_add1</title>
<path fill="none" stroke="black" d="M300.66,-27100.81C287.15,-27091.14 271.63,-27080.04 257.47,-27069.9"/>
<polygon fill="black" stroke="black" points="259.48,-27067.04 249.31,-27064.07 255.41,-27072.73 259.48,-27067.04"/>
</g>
<!-- layer_0_ln2 -->
<g id="node15" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1078.57,-26974 872.57,-26974 872.57,-26921 1078.57,-26921 1078.57,-26974"/>
<text text-anchor="middle" x="975.57" y="-26958.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="975.57" y="-26943.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="975.57" y="-26928.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_add1&#45;&gt;layer_0_ln2 -->
<g id="edge17" class="edge">
<title>layer_0_add1&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M316.73,-27024.59C459.12,-27008.14 714.96,-26978.6 862.43,-26961.57"/>
<polygon fill="black" stroke="black" points="862.89,-26965.04 872.42,-26960.41 862.09,-26958.08 862.89,-26965.04"/>
</g>
<!-- layer_0_add -->
<g id="node42" class="node">
<title>layer_0_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-26318 110.57,-26318 110.57,-26265 316.57,-26265 316.57,-26318"/>
<text text-anchor="middle" x="213.57" y="-26302.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-26287.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-26272.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_add1&#45;&gt;layer_0_add -->
<g id="edge59" class="edge">
<title>layer_0_add1&#45;&gt;layer_0_add</title>
<path fill="none" stroke="black" d="M208.2,-27010.83C205.01,-26993.34 201.57,-26969.62 201.57,-26948.5 201.57,-26948.5 201.57,-26948.5 201.57,-26407 201.57,-26380.6 204.77,-26350.96 207.86,-26328.46"/>
<polygon fill="black" stroke="black" points="211.35,-26328.73 209.31,-26318.34 204.42,-26327.74 211.35,-26328.73"/>
</g>
<!-- layer_0_gate -->
<g id="node16" class="node">
<title>layer_0_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-26884 900.57,-26831 1079.57,-26778 1258.57,-26831 1079.57,-26884"/>
<text text-anchor="middle" x="1079.57" y="-26842.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-26827.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-26812.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_gate -->
<g id="edge18" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_gate</title>
<path fill="none" stroke="black" d="M998.91,-26920.8C1009.62,-26909.01 1022.7,-26894.62 1035.17,-26880.88"/>
<polygon fill="black" stroke="black" points="1037.89,-26883.1 1042.02,-26873.34 1032.71,-26878.39 1037.89,-26883.1"/>
</g>
<!-- layer_0_expert_0_ffn1 -->
<g id="node17" class="node">
<title>layer_0_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-26731 677.57,-26731 677.57,-26678 883.57,-26678 883.57,-26731"/>
<text text-anchor="middle" x="780.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_0_ffn1 -->
<g id="edge20" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M912.87,-26920.85C894.49,-26911.23 875.37,-26898.93 860.57,-26884 820.76,-26843.84 798.89,-26780.41 788.47,-26740.97"/>
<polygon fill="black" stroke="black" points="791.86,-26740.08 786,-26731.25 785.07,-26741.8 791.86,-26740.08"/>
</g>
<!-- layer_0_expert_1_ffn1 -->
<g id="node20" class="node">
<title>layer_0_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-26731 229.57,-26731 229.57,-26678 435.57,-26678 435.57,-26731"/>
<text text-anchor="middle" x="332.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_1_ffn1 -->
<g id="edge24" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M872.52,-26938.67C800.38,-26930.71 702.78,-26914.94 621.57,-26884 525.58,-26847.43 426.43,-26777.99 372.85,-26737.34"/>
<polygon fill="black" stroke="black" points="374.72,-26734.36 364.65,-26731.07 370.47,-26739.92 374.72,-26734.36"/>
</g>
<!-- layer_0_expert_2_ffn1 -->
<g id="node23" class="node">
<title>layer_0_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-26731 1125.57,-26731 1125.57,-26678 1331.57,-26678 1331.57,-26731"/>
<text text-anchor="middle" x="1228.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_2_ffn1 -->
<g id="edge28" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1078.62,-26937.7C1152.58,-26929.03 1243.31,-26912.79 1267.57,-26884 1306.26,-26838.08 1295.71,-26804.4 1272.57,-26749 1271.12,-26745.52 1269.24,-26742.18 1267.08,-26739.01"/>
<polygon fill="black" stroke="black" points="1269.72,-26736.71 1260.79,-26731.01 1264.22,-26741.03 1269.72,-26736.71"/>
</g>
<!-- layer_0_expert_3_ffn1 -->
<g id="node26" class="node">
<title>layer_0_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-26731 1573.57,-26731 1573.57,-26678 1779.57,-26678 1779.57,-26731"/>
<text text-anchor="middle" x="1676.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_3_ffn1 -->
<g id="edge32" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-26932.51C1135.05,-26924.55 1205.76,-26914 1268.57,-26903 1436.52,-26873.58 1486.34,-26859.83 1624.57,-26760 1633.08,-26753.86 1641.36,-26746.21 1648.73,-26738.6"/>
<polygon fill="black" stroke="black" points="1651.49,-26740.77 1655.76,-26731.07 1646.38,-26735.99 1651.49,-26740.77"/>
</g>
<!-- layer_0_expert_4_ffn1 -->
<g id="node29" class="node">
<title>layer_0_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-26731 453.57,-26731 453.57,-26678 659.57,-26678 659.57,-26731"/>
<text text-anchor="middle" x="556.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_4_ffn1 -->
<g id="edge36" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M888.26,-26920.86C858.25,-26910.83 824.86,-26898.28 795.57,-26884 704.27,-26839.47 680.19,-26826.7 603.57,-26760 596.3,-26753.67 589.15,-26746.21 582.7,-26738.88"/>
<polygon fill="black" stroke="black" points="585.16,-26736.37 576.01,-26731.02 579.83,-26740.91 585.16,-26736.37"/>
</g>
<!-- layer_0_expert_5_ffn1 -->
<g id="node32" class="node">
<title>layer_0_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-26731 1349.57,-26731 1349.57,-26678 1555.57,-26678 1555.57,-26731"/>
<text text-anchor="middle" x="1452.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_5_ffn1 -->
<g id="edge40" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-26937.51C1131.89,-26931.1 1197.09,-26920.43 1253.57,-26903 1272.38,-26897.2 1277.44,-26895.28 1293.57,-26884 1357.95,-26838.96 1370.85,-26821.64 1419.57,-26760 1424.54,-26753.72 1429.34,-26746.63 1433.66,-26739.69"/>
<polygon fill="black" stroke="black" points="1436.7,-26741.43 1438.87,-26731.05 1430.71,-26737.81 1436.7,-26741.43"/>
</g>
<!-- layer_0_expert_6_ffn1 -->
<g id="node35" class="node">
<title>layer_0_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-26731 1797.57,-26731 1797.57,-26678 2003.57,-26678 2003.57,-26731"/>
<text text-anchor="middle" x="1900.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_6_ffn1 -->
<g id="edge44" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-26943.17C1185.41,-26937.65 1355.65,-26922.98 1497.57,-26884 1628.04,-26848.16 1770.53,-26776.68 1846.2,-26735.89"/>
<polygon fill="black" stroke="black" points="1847.96,-26738.91 1855.09,-26731.07 1844.63,-26732.75 1847.96,-26738.91"/>
</g>
<!-- layer_0_expert_7_ffn1 -->
<g id="node38" class="node">
<title>layer_0_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-26731 901.57,-26731 901.57,-26678 1107.57,-26678 1107.57,-26731"/>
<text text-anchor="middle" x="1004.57" y="-26715.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-26700.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-26685.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_expert_7_ffn1 -->
<g id="edge48" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M926.37,-26920.93C912.71,-26911.29 899.46,-26898.95 891.57,-26884 863.54,-26830.9 852.23,-26798.25 886.57,-26749 889.58,-26744.69 893.06,-26740.8 896.91,-26737.3"/>
<polygon fill="black" stroke="black" points="899.11,-26740.02 904.71,-26731.03 894.73,-26734.56 899.11,-26740.02"/>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_0_ffn1 -->
<g id="edge19" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-26799.54C959.2,-26779.88 898.07,-26754.43 851.32,-26734.96"/>
<polygon fill="black" stroke="black" points="852.45,-26731.64 841.87,-26731.03 849.76,-26738.1 852.45,-26731.64"/>
<text text-anchor="middle" x="924.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_1_ffn1 -->
<g id="edge23" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-26813.72C833.08,-26796.17 630.07,-26766.21 445.54,-26731.14"/>
<polygon fill="black" stroke="black" points="446.13,-26727.69 435.65,-26729.25 444.82,-26734.56 446.13,-26727.69"/>
<text text-anchor="middle" x="623.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_2_ffn1 -->
<g id="edge27" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-26788.47C1129.09,-26775.16 1143.87,-26760.81 1158.57,-26749 1163.82,-26744.78 1169.5,-26740.65 1175.28,-26736.71"/>
<polygon fill="black" stroke="black" points="1177.37,-26739.52 1183.77,-26731.09 1173.5,-26733.68 1177.37,-26739.52"/>
<text text-anchor="middle" x="1180.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_3_ffn1 -->
<g id="edge31" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-26808.7C1263.24,-26792.33 1376.38,-26769.18 1475.57,-26749 1512.26,-26741.54 1523.52,-26739.73 1563.55,-26731.2"/>
<polygon fill="black" stroke="black" points="1564.41,-26734.59 1573.46,-26729.08 1562.94,-26727.75 1564.41,-26734.59"/>
<text text-anchor="middle" x="1497.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_4_ffn1 -->
<g id="edge35" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-26806.8C893.49,-26785.7 762.7,-26754.57 669.53,-26732.39"/>
<polygon fill="black" stroke="black" points="670.33,-26728.98 659.79,-26730.07 668.7,-26735.79 670.33,-26728.98"/>
<text text-anchor="middle" x="792.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_5_ffn1 -->
<g id="edge39" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-26799.6C1193.35,-26783.52 1244.3,-26764.05 1290.57,-26749 1306.78,-26743.73 1324.04,-26738.6 1341.02,-26733.81"/>
<polygon fill="black" stroke="black" points="1342.29,-26737.09 1350.98,-26731.04 1340.41,-26730.35 1342.29,-26737.09"/>
<text text-anchor="middle" x="1312.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_6_ffn1 -->
<g id="edge43" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-26815.57C1346.62,-26798.91 1578.71,-26769.07 1787.57,-26731.13"/>
<polygon fill="black" stroke="black" points="1788.29,-26734.55 1797.5,-26729.31 1787.04,-26727.67 1788.29,-26734.55"/>
<text text-anchor="middle" x="1694.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_0_gate&#45;&gt;layer_0_expert_7_ffn1 -->
<g id="edge47" class="edge">
<title>layer_0_gate&#45;&gt;layer_0_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-26785.76C1043.87,-26770.73 1033.9,-26754.18 1025.37,-26740.03"/>
<polygon fill="black" stroke="black" points="1028.16,-26737.88 1020,-26731.12 1022.17,-26741.49 1028.16,-26737.88"/>
<text text-anchor="middle" x="1056.57" y="-26752" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_0_expert_0_gelu -->
<g id="node18" class="node">
<title>layer_0_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-26641 677.57,-26641 677.57,-26588 883.57,-26588 883.57,-26641"/>
<text text-anchor="middle" x="780.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_0_ffn1&#45;&gt;layer_0_expert_0_gelu -->
<g id="edge21" class="edge">
<title>layer_0_expert_0_ffn1&#45;&gt;layer_0_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-26677.57C780.57,-26669.34 780.57,-26660.08 780.57,-26651.28"/>
<polygon fill="black" stroke="black" points="784.07,-26651.24 780.57,-26641.24 777.07,-26651.24 784.07,-26651.24"/>
</g>
<!-- layer_0_expert_0_ffn2 -->
<g id="node19" class="node">
<title>layer_0_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-26551 677.57,-26551 677.57,-26498 883.57,-26498 883.57,-26551"/>
<text text-anchor="middle" x="780.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_0_gelu&#45;&gt;layer_0_expert_0_ffn2 -->
<g id="edge22" class="edge">
<title>layer_0_expert_0_gelu&#45;&gt;layer_0_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-26587.57C780.57,-26579.34 780.57,-26570.08 780.57,-26561.28"/>
<polygon fill="black" stroke="black" points="784.07,-26561.24 780.57,-26551.24 777.07,-26561.24 784.07,-26561.24"/>
</g>
<!-- layer_0_expert_agg -->
<g id="node41" class="node">
<title>layer_0_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-26461 878.36,-26461 790.93,-26355 1130.79,-26355 1218.21,-26461"/>
<text text-anchor="middle" x="1004.57" y="-26419.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-26404.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-26389.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_0_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge51" class="edge">
<title>layer_0_expert_0_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-26497.95C849.26,-26488.39 871.33,-26477.11 893.35,-26465.85"/>
<polygon fill="black" stroke="black" points="895.14,-26468.87 902.45,-26461.2 891.95,-26462.64 895.14,-26468.87"/>
</g>
<!-- layer_0_expert_1_gelu -->
<g id="node21" class="node">
<title>layer_0_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-26641 229.57,-26641 229.57,-26588 435.57,-26588 435.57,-26641"/>
<text text-anchor="middle" x="332.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_1_ffn1&#45;&gt;layer_0_expert_1_gelu -->
<g id="edge25" class="edge">
<title>layer_0_expert_1_ffn1&#45;&gt;layer_0_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-26677.57C332.57,-26669.34 332.57,-26660.08 332.57,-26651.28"/>
<polygon fill="black" stroke="black" points="336.07,-26651.24 332.57,-26641.24 329.07,-26651.24 336.07,-26651.24"/>
</g>
<!-- layer_0_expert_1_ffn2 -->
<g id="node22" class="node">
<title>layer_0_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-26551 229.57,-26551 229.57,-26498 435.57,-26498 435.57,-26551"/>
<text text-anchor="middle" x="332.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_1_gelu&#45;&gt;layer_0_expert_1_ffn2 -->
<g id="edge26" class="edge">
<title>layer_0_expert_1_gelu&#45;&gt;layer_0_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-26587.57C332.57,-26579.34 332.57,-26570.08 332.57,-26561.28"/>
<polygon fill="black" stroke="black" points="336.07,-26561.24 332.57,-26551.24 329.07,-26561.24 336.07,-26561.24"/>
</g>
<!-- layer_0_expert_1_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge52" class="edge">
<title>layer_0_expert_1_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-26499.76C438.66,-26499.16 441.63,-26498.57 444.57,-26498 578.16,-26472.21 730.72,-26448.32 842.83,-26431.81"/>
<polygon fill="black" stroke="black" points="843.49,-26435.25 852.87,-26430.33 842.47,-26428.32 843.49,-26435.25"/>
</g>
<!-- layer_0_expert_2_gelu -->
<g id="node24" class="node">
<title>layer_0_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-26641 1125.57,-26641 1125.57,-26588 1331.57,-26588 1331.57,-26641"/>
<text text-anchor="middle" x="1228.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_2_ffn1&#45;&gt;layer_0_expert_2_gelu -->
<g id="edge29" class="edge">
<title>layer_0_expert_2_ffn1&#45;&gt;layer_0_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-26677.57C1228.57,-26669.34 1228.57,-26660.08 1228.57,-26651.28"/>
<polygon fill="black" stroke="black" points="1232.07,-26651.24 1228.57,-26641.24 1225.07,-26651.24 1232.07,-26651.24"/>
</g>
<!-- layer_0_expert_2_ffn2 -->
<g id="node25" class="node">
<title>layer_0_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-26551 1125.57,-26551 1125.57,-26498 1331.57,-26498 1331.57,-26551"/>
<text text-anchor="middle" x="1228.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_2_gelu&#45;&gt;layer_0_expert_2_ffn2 -->
<g id="edge30" class="edge">
<title>layer_0_expert_2_gelu&#45;&gt;layer_0_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-26587.57C1228.57,-26579.34 1228.57,-26570.08 1228.57,-26561.28"/>
<polygon fill="black" stroke="black" points="1232.07,-26561.24 1228.57,-26551.24 1225.07,-26561.24 1232.07,-26561.24"/>
</g>
<!-- layer_0_expert_2_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge53" class="edge">
<title>layer_0_expert_2_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-26497.95C1159.88,-26488.39 1137.81,-26477.11 1115.79,-26465.85"/>
<polygon fill="black" stroke="black" points="1117.19,-26462.64 1106.7,-26461.2 1114.01,-26468.87 1117.19,-26462.64"/>
</g>
<!-- layer_0_expert_3_gelu -->
<g id="node27" class="node">
<title>layer_0_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-26641 1573.57,-26641 1573.57,-26588 1779.57,-26588 1779.57,-26641"/>
<text text-anchor="middle" x="1676.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_3_ffn1&#45;&gt;layer_0_expert_3_gelu -->
<g id="edge33" class="edge">
<title>layer_0_expert_3_ffn1&#45;&gt;layer_0_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-26677.57C1676.57,-26669.34 1676.57,-26660.08 1676.57,-26651.28"/>
<polygon fill="black" stroke="black" points="1680.07,-26651.24 1676.57,-26641.24 1673.07,-26651.24 1680.07,-26651.24"/>
</g>
<!-- layer_0_expert_3_ffn2 -->
<g id="node28" class="node">
<title>layer_0_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-26551 1573.57,-26551 1573.57,-26498 1779.57,-26498 1779.57,-26551"/>
<text text-anchor="middle" x="1676.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_3_gelu&#45;&gt;layer_0_expert_3_ffn2 -->
<g id="edge34" class="edge">
<title>layer_0_expert_3_gelu&#45;&gt;layer_0_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-26587.57C1676.57,-26579.34 1676.57,-26570.08 1676.57,-26561.28"/>
<polygon fill="black" stroke="black" points="1680.07,-26561.24 1676.57,-26551.24 1673.07,-26561.24 1680.07,-26561.24"/>
</g>
<!-- layer_0_expert_3_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge54" class="edge">
<title>layer_0_expert_3_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-26499.76C1570.49,-26499.16 1567.51,-26498.57 1564.57,-26498 1446.94,-26475.29 1314.59,-26454.06 1208.1,-26438.03"/>
<polygon fill="black" stroke="black" points="1208.61,-26434.57 1198.21,-26436.54 1207.58,-26441.49 1208.61,-26434.57"/>
</g>
<!-- layer_0_expert_4_gelu -->
<g id="node30" class="node">
<title>layer_0_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-26641 453.57,-26641 453.57,-26588 659.57,-26588 659.57,-26641"/>
<text text-anchor="middle" x="556.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_4_ffn1&#45;&gt;layer_0_expert_4_gelu -->
<g id="edge37" class="edge">
<title>layer_0_expert_4_ffn1&#45;&gt;layer_0_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-26677.57C556.57,-26669.34 556.57,-26660.08 556.57,-26651.28"/>
<polygon fill="black" stroke="black" points="560.07,-26651.24 556.57,-26641.24 553.07,-26651.24 560.07,-26651.24"/>
</g>
<!-- layer_0_expert_4_ffn2 -->
<g id="node31" class="node">
<title>layer_0_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-26551 453.57,-26551 453.57,-26498 659.57,-26498 659.57,-26551"/>
<text text-anchor="middle" x="556.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_4_gelu&#45;&gt;layer_0_expert_4_ffn2 -->
<g id="edge38" class="edge">
<title>layer_0_expert_4_gelu&#45;&gt;layer_0_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-26587.57C556.57,-26579.34 556.57,-26570.08 556.57,-26561.28"/>
<polygon fill="black" stroke="black" points="560.07,-26561.24 556.57,-26551.24 553.07,-26561.24 560.07,-26561.24"/>
</g>
<!-- layer_0_expert_4_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge55" class="edge">
<title>layer_0_expert_4_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-26497.95C714.81,-26483.06 789.41,-26463.99 854.59,-26447.33"/>
<polygon fill="black" stroke="black" points="855.73,-26450.65 864.55,-26444.79 853.99,-26443.87 855.73,-26450.65"/>
</g>
<!-- layer_0_expert_5_gelu -->
<g id="node33" class="node">
<title>layer_0_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-26641 1349.57,-26641 1349.57,-26588 1555.57,-26588 1555.57,-26641"/>
<text text-anchor="middle" x="1452.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_5_ffn1&#45;&gt;layer_0_expert_5_gelu -->
<g id="edge41" class="edge">
<title>layer_0_expert_5_ffn1&#45;&gt;layer_0_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-26677.57C1452.57,-26669.34 1452.57,-26660.08 1452.57,-26651.28"/>
<polygon fill="black" stroke="black" points="1456.07,-26651.24 1452.57,-26641.24 1449.07,-26651.24 1456.07,-26651.24"/>
</g>
<!-- layer_0_expert_5_ffn2 -->
<g id="node34" class="node">
<title>layer_0_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-26551 1349.57,-26551 1349.57,-26498 1555.57,-26498 1555.57,-26551"/>
<text text-anchor="middle" x="1452.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_5_gelu&#45;&gt;layer_0_expert_5_ffn2 -->
<g id="edge42" class="edge">
<title>layer_0_expert_5_gelu&#45;&gt;layer_0_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-26587.57C1452.57,-26579.34 1452.57,-26570.08 1452.57,-26561.28"/>
<polygon fill="black" stroke="black" points="1456.07,-26561.24 1452.57,-26551.24 1449.07,-26561.24 1456.07,-26561.24"/>
</g>
<!-- layer_0_expert_5_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge56" class="edge">
<title>layer_0_expert_5_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-26497.95C1312.66,-26487.74 1265.05,-26475.57 1218.07,-26463.57"/>
<polygon fill="black" stroke="black" points="1218.92,-26460.17 1208.37,-26461.09 1217.19,-26466.95 1218.92,-26460.17"/>
</g>
<!-- layer_0_expert_6_gelu -->
<g id="node36" class="node">
<title>layer_0_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-26641 1797.57,-26641 1797.57,-26588 2003.57,-26588 2003.57,-26641"/>
<text text-anchor="middle" x="1900.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_6_ffn1&#45;&gt;layer_0_expert_6_gelu -->
<g id="edge45" class="edge">
<title>layer_0_expert_6_ffn1&#45;&gt;layer_0_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-26677.57C1900.57,-26669.34 1900.57,-26660.08 1900.57,-26651.28"/>
<polygon fill="black" stroke="black" points="1904.07,-26651.24 1900.57,-26641.24 1897.07,-26651.24 1904.07,-26651.24"/>
</g>
<!-- layer_0_expert_6_ffn2 -->
<g id="node37" class="node">
<title>layer_0_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-26551 1797.57,-26551 1797.57,-26498 2003.57,-26498 2003.57,-26551"/>
<text text-anchor="middle" x="1900.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_6_gelu&#45;&gt;layer_0_expert_6_ffn2 -->
<g id="edge46" class="edge">
<title>layer_0_expert_6_gelu&#45;&gt;layer_0_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-26587.57C1900.57,-26579.34 1900.57,-26570.08 1900.57,-26561.28"/>
<polygon fill="black" stroke="black" points="1904.07,-26561.24 1900.57,-26551.24 1897.07,-26561.24 1904.07,-26561.24"/>
</g>
<!-- layer_0_expert_6_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge57" class="edge">
<title>layer_0_expert_6_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-26499.59C1794.51,-26499.03 1791.52,-26498.5 1788.57,-26498 1588.54,-26463.98 1357.51,-26439.53 1198.33,-26424.97"/>
<polygon fill="black" stroke="black" points="1198.23,-26421.45 1187.95,-26424.03 1197.59,-26428.42 1198.23,-26421.45"/>
</g>
<!-- layer_0_expert_7_gelu -->
<g id="node39" class="node">
<title>layer_0_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-26641 901.57,-26641 901.57,-26588 1107.57,-26588 1107.57,-26641"/>
<text text-anchor="middle" x="1004.57" y="-26625.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-26610.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-26595.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_7_ffn1&#45;&gt;layer_0_expert_7_gelu -->
<g id="edge49" class="edge">
<title>layer_0_expert_7_ffn1&#45;&gt;layer_0_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-26677.57C1004.57,-26669.34 1004.57,-26660.08 1004.57,-26651.28"/>
<polygon fill="black" stroke="black" points="1008.07,-26651.24 1004.57,-26641.24 1001.07,-26651.24 1008.07,-26651.24"/>
</g>
<!-- layer_0_expert_7_ffn2 -->
<g id="node40" class="node">
<title>layer_0_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-26551 901.57,-26551 901.57,-26498 1107.57,-26498 1107.57,-26551"/>
<text text-anchor="middle" x="1004.57" y="-26535.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-26520.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-26505.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_expert_7_gelu&#45;&gt;layer_0_expert_7_ffn2 -->
<g id="edge50" class="edge">
<title>layer_0_expert_7_gelu&#45;&gt;layer_0_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-26587.57C1004.57,-26579.34 1004.57,-26570.08 1004.57,-26561.28"/>
<polygon fill="black" stroke="black" points="1008.07,-26561.24 1004.57,-26551.24 1001.07,-26561.24 1008.07,-26561.24"/>
</g>
<!-- layer_0_expert_7_ffn2&#45;&gt;layer_0_expert_agg -->
<g id="edge58" class="edge">
<title>layer_0_expert_7_ffn2&#45;&gt;layer_0_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-26497.8C1004.57,-26489.86 1004.57,-26480.74 1004.57,-26471.44"/>
<polygon fill="black" stroke="black" points="1008.07,-26471.32 1004.57,-26461.32 1001.07,-26471.32 1008.07,-26471.32"/>
</g>
<!-- layer_0_expert_agg&#45;&gt;layer_0_add -->
<g id="edge60" class="edge">
<title>layer_0_expert_agg&#45;&gt;layer_0_add</title>
<path fill="none" stroke="black" d="M810.56,-26378.92C658.7,-26356.93 452.76,-26327.12 326.73,-26308.88"/>
<polygon fill="black" stroke="black" points="327.07,-26305.39 316.67,-26307.42 326.07,-26312.32 327.07,-26305.39"/>
</g>
<!-- comm_0_1 -->
<g id="node43" class="node">
<title>comm_0_1</title>
<polygon fill="yellow" stroke="black" points="427.21,-26228 87.36,-26228 -0.07,-26122 339.79,-26122 427.21,-26228"/>
<text text-anchor="middle" x="213.57" y="-26186.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-26171.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-26156.3" font-family="Times,serif" font-size="14.00">GPU 0  GPU 1</text>
</g>
<!-- layer_0_add&#45;&gt;comm_0_1 -->
<g id="edge61" class="edge">
<title>layer_0_add&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M213.57,-26264.8C213.57,-26256.86 213.57,-26247.74 213.57,-26238.44"/>
<polygon fill="black" stroke="black" points="217.07,-26238.32 213.57,-26228.32 210.07,-26238.32 217.07,-26238.32"/>
</g>
<!-- layer_1_ln1 -->
<g id="node44" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-26085 291.57,-26085 291.57,-26032 497.57,-26032 497.57,-26085"/>
<text text-anchor="middle" x="394.57" y="-26069.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-26054.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-26039.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- comm_0_1&#45;&gt;layer_1_ln1 -->
<g id="edge62" class="edge">
<title>comm_0_1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M295.86,-26121.94C312.72,-26111.28 329.97,-26100.37 345.23,-26090.71"/>
<polygon fill="black" stroke="black" points="347.39,-26093.49 353.97,-26085.18 343.65,-26087.57 347.39,-26093.49"/>
</g>
<!-- layer_1_add1 -->
<g id="node56" class="node">
<title>layer_1_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-25313 110.57,-25313 110.57,-25260 316.57,-25260 316.57,-25313"/>
<text text-anchor="middle" x="213.57" y="-25297.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-25282.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-25267.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- comm_0_1&#45;&gt;layer_1_add1 -->
<g id="edge76" class="edge">
<title>comm_0_1&#45;&gt;layer_1_add1</title>
<path fill="none" stroke="black" d="M205.8,-26121.97C203.49,-26102.42 201.57,-26079.99 201.57,-26059.5 201.57,-26059.5 201.57,-26059.5 201.57,-25375.5 201.57,-25358.17 203.88,-25339.1 206.48,-25323.15"/>
<polygon fill="black" stroke="black" points="209.95,-25323.62 208.2,-25313.17 203.05,-25322.43 209.95,-25323.62"/>
</g>
<!-- layer_1_q_proj -->
<g id="node45" class="node">
<title>layer_1_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-25995 453.57,-25995 453.57,-25942 659.57,-25942 659.57,-25995"/>
<text text-anchor="middle" x="556.57" y="-25979.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-25964.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-25949.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_q_proj -->
<g id="edge63" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-26031.81C460.25,-26021.82 481.45,-26010.31 500.58,-25999.91"/>
<polygon fill="black" stroke="black" points="502.38,-26002.92 509.5,-25995.07 499.04,-25996.77 502.38,-26002.92"/>
</g>
<!-- layer_1_k_proj -->
<g id="node46" class="node">
<title>layer_1_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-25995 677.57,-25995 677.57,-25942 883.57,-25942 883.57,-25995"/>
<text text-anchor="middle" x="780.57" y="-25979.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-25964.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-25949.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_k_proj -->
<g id="edge64" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-26033.98C550.11,-26022.04 613.8,-26007.52 667.48,-25995.28"/>
<polygon fill="black" stroke="black" points="668.41,-25998.66 677.38,-25993.02 666.86,-25991.83 668.41,-25998.66"/>
</g>
<!-- layer_1_v_proj -->
<g id="node47" class="node">
<title>layer_1_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-25995 229.57,-25995 229.57,-25942 435.57,-25942 435.57,-25995"/>
<text text-anchor="middle" x="332.57" y="-25979.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-25964.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-25949.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_v_proj -->
<g id="edge65" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-26031.57C370.12,-26022.8 363.13,-26012.87 356.57,-26003.56"/>
<polygon fill="black" stroke="black" points="359.33,-26001.4 350.71,-25995.24 353.61,-26005.43 359.33,-26001.4"/>
</g>
<!-- layer_1_q_reshape -->
<g id="node48" class="node">
<title>layer_1_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-25905 426.57,-25905 426.57,-25852 650.57,-25852 650.57,-25905"/>
<text text-anchor="middle" x="538.57" y="-25889.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-25874.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-25859.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_q_proj&#45;&gt;layer_1_q_reshape -->
<g id="edge66" class="edge">
<title>layer_1_q_proj&#45;&gt;layer_1_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-25941.57C549.58,-25933.34 547.69,-25924.08 545.89,-25915.28"/>
<polygon fill="black" stroke="black" points="549.27,-25914.34 543.84,-25905.24 542.41,-25915.74 549.27,-25914.34"/>
</g>
<!-- layer_1_k_reshape -->
<g id="node49" class="node">
<title>layer_1_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-25905 668.57,-25905 668.57,-25852 892.57,-25852 892.57,-25905"/>
<text text-anchor="middle" x="780.57" y="-25889.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-25874.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-25859.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_k_proj&#45;&gt;layer_1_k_reshape -->
<g id="edge67" class="edge">
<title>layer_1_k_proj&#45;&gt;layer_1_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-25941.57C780.57,-25933.34 780.57,-25924.08 780.57,-25915.28"/>
<polygon fill="black" stroke="black" points="784.07,-25915.24 780.57,-25905.24 777.07,-25915.24 784.07,-25915.24"/>
</g>
<!-- layer_1_v_reshape -->
<g id="node50" class="node">
<title>layer_1_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-25834 225.57,-25834 225.57,-25781 449.57,-25781 449.57,-25834"/>
<text text-anchor="middle" x="337.57" y="-25818.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-25803.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-25788.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_v_proj&#45;&gt;layer_1_v_reshape -->
<g id="edge68" class="edge">
<title>layer_1_v_proj&#45;&gt;layer_1_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-25941.95C334.2,-25915.61 335.5,-25874.29 336.44,-25844.61"/>
<polygon fill="black" stroke="black" points="339.95,-25844.35 336.76,-25834.25 332.95,-25844.13 339.95,-25844.35"/>
</g>
<!-- layer_1_attn_scores -->
<g id="node51" class="node">
<title>layer_1_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-25763 422.07,-25763 422.07,-25710 655.07,-25710 655.07,-25763"/>
<text text-anchor="middle" x="538.57" y="-25747.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-25732.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-25717.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_q_reshape&#45;&gt;layer_1_attn_scores -->
<g id="edge69" class="edge">
<title>layer_1_q_reshape&#45;&gt;layer_1_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-25851.82C538.57,-25829.72 538.57,-25797.6 538.57,-25773.03"/>
<polygon fill="black" stroke="black" points="542.07,-25773.02 538.57,-25763.02 535.07,-25773.02 542.07,-25773.02"/>
</g>
<!-- layer_1_k_reshape&#45;&gt;layer_1_attn_scores -->
<g id="edge70" class="edge">
<title>layer_1_k_reshape&#45;&gt;layer_1_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-25851.98C695.65,-25828.37 634.91,-25793.23 591.5,-25768.12"/>
<polygon fill="black" stroke="black" points="593.19,-25765.05 582.78,-25763.08 589.68,-25771.11 593.19,-25765.05"/>
</g>
<!-- layer_1_attn_output -->
<g id="node53" class="node">
<title>layer_1_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-25583 229.57,-25583 229.57,-25530 453.57,-25530 453.57,-25583"/>
<text text-anchor="middle" x="341.57" y="-25567.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-25552.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-25537.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_v_reshape&#45;&gt;layer_1_attn_output -->
<g id="edge73" class="edge">
<title>layer_1_v_reshape&#45;&gt;layer_1_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-25780.79C338.7,-25736.13 340.18,-25644.13 341,-25593.27"/>
<polygon fill="black" stroke="black" points="344.5,-25593.12 341.16,-25583.07 337.5,-25593.01 344.5,-25593.12"/>
</g>
<!-- layer_1_attn_weights -->
<g id="node52" class="node">
<title>layer_1_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="616.07,-25673 383.07,-25673 383.07,-25620 616.07,-25620 616.07,-25673"/>
<text text-anchor="middle" x="499.57" y="-25657.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="499.57" y="-25642.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="499.57" y="-25627.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_scores&#45;&gt;layer_1_attn_weights -->
<g id="edge71" class="edge">
<title>layer_1_attn_scores&#45;&gt;layer_1_attn_weights</title>
<path fill="none" stroke="black" d="M527.08,-25709.57C523.31,-25701.07 519.06,-25691.48 515.05,-25682.42"/>
<polygon fill="black" stroke="black" points="518.23,-25680.97 510.98,-25673.24 511.83,-25683.8 518.23,-25680.97"/>
</g>
<!-- layer_1_attn_weights&#45;&gt;layer_1_attn_output -->
<g id="edge72" class="edge">
<title>layer_1_attn_weights&#45;&gt;layer_1_attn_output</title>
<path fill="none" stroke="black" d="M453.45,-25619.81C435.6,-25609.87 415.03,-25598.41 396.43,-25588.05"/>
<polygon fill="black" stroke="black" points="397.92,-25584.88 387.48,-25583.07 394.51,-25590.99 397.92,-25584.88"/>
</g>
<!-- layer_1_attn_reshape -->
<g id="node54" class="node">
<title>layer_1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-25493 236.57,-25493 236.57,-25440 442.57,-25440 442.57,-25493"/>
<text text-anchor="middle" x="339.57" y="-25477.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-25462.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-25447.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_output&#45;&gt;layer_1_attn_reshape -->
<g id="edge74" class="edge">
<title>layer_1_attn_output&#45;&gt;layer_1_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-25529.57C340.79,-25521.34 340.58,-25512.08 340.38,-25503.28"/>
<polygon fill="black" stroke="black" points="343.88,-25503.16 340.16,-25493.24 336.88,-25503.32 343.88,-25503.16"/>
</g>
<!-- layer_1_attn_proj -->
<g id="node55" class="node">
<title>layer_1_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-25403 233.57,-25403 233.57,-25350 439.57,-25350 439.57,-25403"/>
<text text-anchor="middle" x="336.57" y="-25387.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-25372.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-25357.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_reshape&#45;&gt;layer_1_attn_proj -->
<g id="edge75" class="edge">
<title>layer_1_attn_reshape&#45;&gt;layer_1_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-25439.57C338.41,-25431.34 338.09,-25422.08 337.79,-25413.28"/>
<polygon fill="black" stroke="black" points="341.29,-25413.12 337.45,-25403.24 334.29,-25413.36 341.29,-25413.12"/>
</g>
<!-- layer_1_attn_proj&#45;&gt;layer_1_add1 -->
<g id="edge77" class="edge">
<title>layer_1_attn_proj&#45;&gt;layer_1_add1</title>
<path fill="none" stroke="black" d="M300.66,-25349.81C287.15,-25340.14 271.63,-25329.04 257.47,-25318.9"/>
<polygon fill="black" stroke="black" points="259.48,-25316.04 249.31,-25313.07 255.41,-25321.73 259.48,-25316.04"/>
</g>
<!-- layer_1_ln2 -->
<g id="node57" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1078.57,-25223 872.57,-25223 872.57,-25170 1078.57,-25170 1078.57,-25223"/>
<text text-anchor="middle" x="975.57" y="-25207.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="975.57" y="-25192.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="975.57" y="-25177.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_add1&#45;&gt;layer_1_ln2 -->
<g id="edge78" class="edge">
<title>layer_1_add1&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M316.73,-25273.59C459.12,-25257.14 714.96,-25227.6 862.43,-25210.57"/>
<polygon fill="black" stroke="black" points="862.89,-25214.04 872.42,-25209.41 862.09,-25207.08 862.89,-25214.04"/>
</g>
<!-- layer_1_add -->
<g id="node84" class="node">
<title>layer_1_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-24567 110.57,-24567 110.57,-24514 316.57,-24514 316.57,-24567"/>
<text text-anchor="middle" x="213.57" y="-24551.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-24536.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-24521.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_add1&#45;&gt;layer_1_add -->
<g id="edge120" class="edge">
<title>layer_1_add1&#45;&gt;layer_1_add</title>
<path fill="none" stroke="black" d="M208.2,-25259.83C205.01,-25242.34 201.57,-25218.62 201.57,-25197.5 201.57,-25197.5 201.57,-25197.5 201.57,-24656 201.57,-24629.6 204.77,-24599.96 207.86,-24577.46"/>
<polygon fill="black" stroke="black" points="211.35,-24577.73 209.31,-24567.34 204.42,-24576.74 211.35,-24577.73"/>
</g>
<!-- layer_1_gate -->
<g id="node58" class="node">
<title>layer_1_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-25133 900.57,-25080 1079.57,-25027 1258.57,-25080 1079.57,-25133"/>
<text text-anchor="middle" x="1079.57" y="-25091.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-25076.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-25061.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_gate -->
<g id="edge79" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_gate</title>
<path fill="none" stroke="black" d="M998.91,-25169.8C1009.62,-25158.01 1022.7,-25143.62 1035.17,-25129.88"/>
<polygon fill="black" stroke="black" points="1037.89,-25132.1 1042.02,-25122.34 1032.71,-25127.39 1037.89,-25132.1"/>
</g>
<!-- layer_1_expert_0_ffn1 -->
<g id="node59" class="node">
<title>layer_1_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-24980 677.57,-24980 677.57,-24927 883.57,-24927 883.57,-24980"/>
<text text-anchor="middle" x="780.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_0_ffn1 -->
<g id="edge81" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M912.87,-25169.85C894.49,-25160.23 875.37,-25147.93 860.57,-25133 820.76,-25092.84 798.89,-25029.41 788.47,-24989.97"/>
<polygon fill="black" stroke="black" points="791.86,-24989.08 786,-24980.25 785.07,-24990.8 791.86,-24989.08"/>
</g>
<!-- layer_1_expert_1_ffn1 -->
<g id="node62" class="node">
<title>layer_1_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-24980 229.57,-24980 229.57,-24927 435.57,-24927 435.57,-24980"/>
<text text-anchor="middle" x="332.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_1_ffn1 -->
<g id="edge85" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M872.52,-25187.67C800.38,-25179.71 702.78,-25163.94 621.57,-25133 525.58,-25096.43 426.43,-25026.99 372.85,-24986.34"/>
<polygon fill="black" stroke="black" points="374.72,-24983.36 364.65,-24980.07 370.47,-24988.92 374.72,-24983.36"/>
</g>
<!-- layer_1_expert_2_ffn1 -->
<g id="node65" class="node">
<title>layer_1_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-24980 1125.57,-24980 1125.57,-24927 1331.57,-24927 1331.57,-24980"/>
<text text-anchor="middle" x="1228.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_2_ffn1 -->
<g id="edge89" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1078.62,-25186.7C1152.58,-25178.03 1243.31,-25161.79 1267.57,-25133 1306.26,-25087.08 1295.71,-25053.4 1272.57,-24998 1271.12,-24994.52 1269.24,-24991.18 1267.08,-24988.01"/>
<polygon fill="black" stroke="black" points="1269.72,-24985.71 1260.79,-24980.01 1264.22,-24990.03 1269.72,-24985.71"/>
</g>
<!-- layer_1_expert_3_ffn1 -->
<g id="node68" class="node">
<title>layer_1_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-24980 1573.57,-24980 1573.57,-24927 1779.57,-24927 1779.57,-24980"/>
<text text-anchor="middle" x="1676.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_3_ffn1 -->
<g id="edge93" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-25181.51C1135.05,-25173.55 1205.76,-25163 1268.57,-25152 1436.52,-25122.58 1486.34,-25108.83 1624.57,-25009 1633.08,-25002.86 1641.36,-24995.21 1648.73,-24987.6"/>
<polygon fill="black" stroke="black" points="1651.49,-24989.77 1655.76,-24980.07 1646.38,-24984.99 1651.49,-24989.77"/>
</g>
<!-- layer_1_expert_4_ffn1 -->
<g id="node71" class="node">
<title>layer_1_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-24980 453.57,-24980 453.57,-24927 659.57,-24927 659.57,-24980"/>
<text text-anchor="middle" x="556.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_4_ffn1 -->
<g id="edge97" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M888.26,-25169.86C858.25,-25159.83 824.86,-25147.28 795.57,-25133 704.27,-25088.47 680.19,-25075.7 603.57,-25009 596.3,-25002.67 589.15,-24995.21 582.7,-24987.88"/>
<polygon fill="black" stroke="black" points="585.16,-24985.37 576.01,-24980.02 579.83,-24989.91 585.16,-24985.37"/>
</g>
<!-- layer_1_expert_5_ffn1 -->
<g id="node74" class="node">
<title>layer_1_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-24980 1349.57,-24980 1349.57,-24927 1555.57,-24927 1555.57,-24980"/>
<text text-anchor="middle" x="1452.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_5_ffn1 -->
<g id="edge101" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-25186.51C1131.89,-25180.1 1197.09,-25169.43 1253.57,-25152 1272.38,-25146.2 1277.44,-25144.28 1293.57,-25133 1357.95,-25087.96 1370.85,-25070.64 1419.57,-25009 1424.54,-25002.72 1429.34,-24995.63 1433.66,-24988.69"/>
<polygon fill="black" stroke="black" points="1436.7,-24990.43 1438.87,-24980.05 1430.71,-24986.81 1436.7,-24990.43"/>
</g>
<!-- layer_1_expert_6_ffn1 -->
<g id="node77" class="node">
<title>layer_1_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-24980 1797.57,-24980 1797.57,-24927 2003.57,-24927 2003.57,-24980"/>
<text text-anchor="middle" x="1900.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_6_ffn1 -->
<g id="edge105" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-25192.17C1185.41,-25186.65 1355.65,-25171.98 1497.57,-25133 1628.04,-25097.16 1770.53,-25025.68 1846.2,-24984.89"/>
<polygon fill="black" stroke="black" points="1847.96,-24987.91 1855.09,-24980.07 1844.63,-24981.75 1847.96,-24987.91"/>
</g>
<!-- layer_1_expert_7_ffn1 -->
<g id="node80" class="node">
<title>layer_1_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-24980 901.57,-24980 901.57,-24927 1107.57,-24927 1107.57,-24980"/>
<text text-anchor="middle" x="1004.57" y="-24964.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-24949.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-24934.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_expert_7_ffn1 -->
<g id="edge109" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M926.37,-25169.93C912.71,-25160.29 899.46,-25147.95 891.57,-25133 863.54,-25079.9 852.23,-25047.25 886.57,-24998 889.58,-24993.69 893.06,-24989.8 896.91,-24986.3"/>
<polygon fill="black" stroke="black" points="899.11,-24989.02 904.71,-24980.03 894.73,-24983.56 899.11,-24989.02"/>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_0_ffn1 -->
<g id="edge80" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-25048.54C959.2,-25028.88 898.07,-25003.43 851.32,-24983.96"/>
<polygon fill="black" stroke="black" points="852.45,-24980.64 841.87,-24980.03 849.76,-24987.1 852.45,-24980.64"/>
<text text-anchor="middle" x="924.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_1_ffn1 -->
<g id="edge84" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-25062.72C833.08,-25045.17 630.07,-25015.21 445.54,-24980.14"/>
<polygon fill="black" stroke="black" points="446.13,-24976.69 435.65,-24978.25 444.82,-24983.56 446.13,-24976.69"/>
<text text-anchor="middle" x="623.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_2_ffn1 -->
<g id="edge88" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-25037.47C1129.09,-25024.16 1143.87,-25009.81 1158.57,-24998 1163.82,-24993.78 1169.5,-24989.65 1175.28,-24985.71"/>
<polygon fill="black" stroke="black" points="1177.37,-24988.52 1183.77,-24980.09 1173.5,-24982.68 1177.37,-24988.52"/>
<text text-anchor="middle" x="1180.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_3_ffn1 -->
<g id="edge92" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-25057.7C1263.24,-25041.33 1376.38,-25018.18 1475.57,-24998 1512.26,-24990.54 1523.52,-24988.73 1563.55,-24980.2"/>
<polygon fill="black" stroke="black" points="1564.41,-24983.59 1573.46,-24978.08 1562.94,-24976.75 1564.41,-24983.59"/>
<text text-anchor="middle" x="1497.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_4_ffn1 -->
<g id="edge96" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-25055.8C893.49,-25034.7 762.7,-25003.57 669.53,-24981.39"/>
<polygon fill="black" stroke="black" points="670.33,-24977.98 659.79,-24979.07 668.7,-24984.79 670.33,-24977.98"/>
<text text-anchor="middle" x="792.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_5_ffn1 -->
<g id="edge100" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-25048.6C1193.35,-25032.52 1244.3,-25013.05 1290.57,-24998 1306.78,-24992.73 1324.04,-24987.6 1341.02,-24982.81"/>
<polygon fill="black" stroke="black" points="1342.29,-24986.09 1350.98,-24980.04 1340.41,-24979.35 1342.29,-24986.09"/>
<text text-anchor="middle" x="1312.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_6_ffn1 -->
<g id="edge104" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-25064.57C1346.62,-25047.91 1578.71,-25018.07 1787.57,-24980.13"/>
<polygon fill="black" stroke="black" points="1788.29,-24983.55 1797.5,-24978.31 1787.04,-24976.67 1788.29,-24983.55"/>
<text text-anchor="middle" x="1694.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_1_gate&#45;&gt;layer_1_expert_7_ffn1 -->
<g id="edge108" class="edge">
<title>layer_1_gate&#45;&gt;layer_1_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-25034.76C1043.87,-25019.73 1033.9,-25003.18 1025.37,-24989.03"/>
<polygon fill="black" stroke="black" points="1028.16,-24986.88 1020,-24980.12 1022.17,-24990.49 1028.16,-24986.88"/>
<text text-anchor="middle" x="1056.57" y="-25001" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_1_expert_0_gelu -->
<g id="node60" class="node">
<title>layer_1_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-24890 677.57,-24890 677.57,-24837 883.57,-24837 883.57,-24890"/>
<text text-anchor="middle" x="780.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_0_ffn1&#45;&gt;layer_1_expert_0_gelu -->
<g id="edge82" class="edge">
<title>layer_1_expert_0_ffn1&#45;&gt;layer_1_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-24926.57C780.57,-24918.34 780.57,-24909.08 780.57,-24900.28"/>
<polygon fill="black" stroke="black" points="784.07,-24900.24 780.57,-24890.24 777.07,-24900.24 784.07,-24900.24"/>
</g>
<!-- layer_1_expert_0_ffn2 -->
<g id="node61" class="node">
<title>layer_1_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-24800 677.57,-24800 677.57,-24747 883.57,-24747 883.57,-24800"/>
<text text-anchor="middle" x="780.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_0_gelu&#45;&gt;layer_1_expert_0_ffn2 -->
<g id="edge83" class="edge">
<title>layer_1_expert_0_gelu&#45;&gt;layer_1_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-24836.57C780.57,-24828.34 780.57,-24819.08 780.57,-24810.28"/>
<polygon fill="black" stroke="black" points="784.07,-24810.24 780.57,-24800.24 777.07,-24810.24 784.07,-24810.24"/>
</g>
<!-- layer_1_expert_agg -->
<g id="node83" class="node">
<title>layer_1_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-24710 878.36,-24710 790.93,-24604 1130.79,-24604 1218.21,-24710"/>
<text text-anchor="middle" x="1004.57" y="-24668.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-24653.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-24638.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_0_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge112" class="edge">
<title>layer_1_expert_0_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-24746.95C849.26,-24737.39 871.33,-24726.11 893.35,-24714.85"/>
<polygon fill="black" stroke="black" points="895.14,-24717.87 902.45,-24710.2 891.95,-24711.64 895.14,-24717.87"/>
</g>
<!-- layer_1_expert_1_gelu -->
<g id="node63" class="node">
<title>layer_1_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-24890 229.57,-24890 229.57,-24837 435.57,-24837 435.57,-24890"/>
<text text-anchor="middle" x="332.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_1_ffn1&#45;&gt;layer_1_expert_1_gelu -->
<g id="edge86" class="edge">
<title>layer_1_expert_1_ffn1&#45;&gt;layer_1_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-24926.57C332.57,-24918.34 332.57,-24909.08 332.57,-24900.28"/>
<polygon fill="black" stroke="black" points="336.07,-24900.24 332.57,-24890.24 329.07,-24900.24 336.07,-24900.24"/>
</g>
<!-- layer_1_expert_1_ffn2 -->
<g id="node64" class="node">
<title>layer_1_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-24800 229.57,-24800 229.57,-24747 435.57,-24747 435.57,-24800"/>
<text text-anchor="middle" x="332.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_1_gelu&#45;&gt;layer_1_expert_1_ffn2 -->
<g id="edge87" class="edge">
<title>layer_1_expert_1_gelu&#45;&gt;layer_1_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-24836.57C332.57,-24828.34 332.57,-24819.08 332.57,-24810.28"/>
<polygon fill="black" stroke="black" points="336.07,-24810.24 332.57,-24800.24 329.07,-24810.24 336.07,-24810.24"/>
</g>
<!-- layer_1_expert_1_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge113" class="edge">
<title>layer_1_expert_1_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-24748.76C438.66,-24748.16 441.63,-24747.57 444.57,-24747 578.16,-24721.21 730.72,-24697.32 842.83,-24680.81"/>
<polygon fill="black" stroke="black" points="843.49,-24684.25 852.87,-24679.33 842.47,-24677.32 843.49,-24684.25"/>
</g>
<!-- layer_1_expert_2_gelu -->
<g id="node66" class="node">
<title>layer_1_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-24890 1125.57,-24890 1125.57,-24837 1331.57,-24837 1331.57,-24890"/>
<text text-anchor="middle" x="1228.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_2_ffn1&#45;&gt;layer_1_expert_2_gelu -->
<g id="edge90" class="edge">
<title>layer_1_expert_2_ffn1&#45;&gt;layer_1_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-24926.57C1228.57,-24918.34 1228.57,-24909.08 1228.57,-24900.28"/>
<polygon fill="black" stroke="black" points="1232.07,-24900.24 1228.57,-24890.24 1225.07,-24900.24 1232.07,-24900.24"/>
</g>
<!-- layer_1_expert_2_ffn2 -->
<g id="node67" class="node">
<title>layer_1_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-24800 1125.57,-24800 1125.57,-24747 1331.57,-24747 1331.57,-24800"/>
<text text-anchor="middle" x="1228.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_2_gelu&#45;&gt;layer_1_expert_2_ffn2 -->
<g id="edge91" class="edge">
<title>layer_1_expert_2_gelu&#45;&gt;layer_1_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-24836.57C1228.57,-24828.34 1228.57,-24819.08 1228.57,-24810.28"/>
<polygon fill="black" stroke="black" points="1232.07,-24810.24 1228.57,-24800.24 1225.07,-24810.24 1232.07,-24810.24"/>
</g>
<!-- layer_1_expert_2_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge114" class="edge">
<title>layer_1_expert_2_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-24746.95C1159.88,-24737.39 1137.81,-24726.11 1115.79,-24714.85"/>
<polygon fill="black" stroke="black" points="1117.19,-24711.64 1106.7,-24710.2 1114.01,-24717.87 1117.19,-24711.64"/>
</g>
<!-- layer_1_expert_3_gelu -->
<g id="node69" class="node">
<title>layer_1_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-24890 1573.57,-24890 1573.57,-24837 1779.57,-24837 1779.57,-24890"/>
<text text-anchor="middle" x="1676.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_3_ffn1&#45;&gt;layer_1_expert_3_gelu -->
<g id="edge94" class="edge">
<title>layer_1_expert_3_ffn1&#45;&gt;layer_1_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-24926.57C1676.57,-24918.34 1676.57,-24909.08 1676.57,-24900.28"/>
<polygon fill="black" stroke="black" points="1680.07,-24900.24 1676.57,-24890.24 1673.07,-24900.24 1680.07,-24900.24"/>
</g>
<!-- layer_1_expert_3_ffn2 -->
<g id="node70" class="node">
<title>layer_1_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-24800 1573.57,-24800 1573.57,-24747 1779.57,-24747 1779.57,-24800"/>
<text text-anchor="middle" x="1676.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_3_gelu&#45;&gt;layer_1_expert_3_ffn2 -->
<g id="edge95" class="edge">
<title>layer_1_expert_3_gelu&#45;&gt;layer_1_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-24836.57C1676.57,-24828.34 1676.57,-24819.08 1676.57,-24810.28"/>
<polygon fill="black" stroke="black" points="1680.07,-24810.24 1676.57,-24800.24 1673.07,-24810.24 1680.07,-24810.24"/>
</g>
<!-- layer_1_expert_3_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge115" class="edge">
<title>layer_1_expert_3_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-24748.76C1570.49,-24748.16 1567.51,-24747.57 1564.57,-24747 1446.94,-24724.29 1314.59,-24703.06 1208.1,-24687.03"/>
<polygon fill="black" stroke="black" points="1208.61,-24683.57 1198.21,-24685.54 1207.58,-24690.49 1208.61,-24683.57"/>
</g>
<!-- layer_1_expert_4_gelu -->
<g id="node72" class="node">
<title>layer_1_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-24890 453.57,-24890 453.57,-24837 659.57,-24837 659.57,-24890"/>
<text text-anchor="middle" x="556.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_4_ffn1&#45;&gt;layer_1_expert_4_gelu -->
<g id="edge98" class="edge">
<title>layer_1_expert_4_ffn1&#45;&gt;layer_1_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-24926.57C556.57,-24918.34 556.57,-24909.08 556.57,-24900.28"/>
<polygon fill="black" stroke="black" points="560.07,-24900.24 556.57,-24890.24 553.07,-24900.24 560.07,-24900.24"/>
</g>
<!-- layer_1_expert_4_ffn2 -->
<g id="node73" class="node">
<title>layer_1_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-24800 453.57,-24800 453.57,-24747 659.57,-24747 659.57,-24800"/>
<text text-anchor="middle" x="556.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_4_gelu&#45;&gt;layer_1_expert_4_ffn2 -->
<g id="edge99" class="edge">
<title>layer_1_expert_4_gelu&#45;&gt;layer_1_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-24836.57C556.57,-24828.34 556.57,-24819.08 556.57,-24810.28"/>
<polygon fill="black" stroke="black" points="560.07,-24810.24 556.57,-24800.24 553.07,-24810.24 560.07,-24810.24"/>
</g>
<!-- layer_1_expert_4_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge116" class="edge">
<title>layer_1_expert_4_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-24746.95C714.81,-24732.06 789.41,-24712.99 854.59,-24696.33"/>
<polygon fill="black" stroke="black" points="855.73,-24699.65 864.55,-24693.79 853.99,-24692.87 855.73,-24699.65"/>
</g>
<!-- layer_1_expert_5_gelu -->
<g id="node75" class="node">
<title>layer_1_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-24890 1349.57,-24890 1349.57,-24837 1555.57,-24837 1555.57,-24890"/>
<text text-anchor="middle" x="1452.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_5_ffn1&#45;&gt;layer_1_expert_5_gelu -->
<g id="edge102" class="edge">
<title>layer_1_expert_5_ffn1&#45;&gt;layer_1_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-24926.57C1452.57,-24918.34 1452.57,-24909.08 1452.57,-24900.28"/>
<polygon fill="black" stroke="black" points="1456.07,-24900.24 1452.57,-24890.24 1449.07,-24900.24 1456.07,-24900.24"/>
</g>
<!-- layer_1_expert_5_ffn2 -->
<g id="node76" class="node">
<title>layer_1_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-24800 1349.57,-24800 1349.57,-24747 1555.57,-24747 1555.57,-24800"/>
<text text-anchor="middle" x="1452.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_5_gelu&#45;&gt;layer_1_expert_5_ffn2 -->
<g id="edge103" class="edge">
<title>layer_1_expert_5_gelu&#45;&gt;layer_1_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-24836.57C1452.57,-24828.34 1452.57,-24819.08 1452.57,-24810.28"/>
<polygon fill="black" stroke="black" points="1456.07,-24810.24 1452.57,-24800.24 1449.07,-24810.24 1456.07,-24810.24"/>
</g>
<!-- layer_1_expert_5_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge117" class="edge">
<title>layer_1_expert_5_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-24746.95C1312.66,-24736.74 1265.05,-24724.57 1218.07,-24712.57"/>
<polygon fill="black" stroke="black" points="1218.92,-24709.17 1208.37,-24710.09 1217.19,-24715.95 1218.92,-24709.17"/>
</g>
<!-- layer_1_expert_6_gelu -->
<g id="node78" class="node">
<title>layer_1_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-24890 1797.57,-24890 1797.57,-24837 2003.57,-24837 2003.57,-24890"/>
<text text-anchor="middle" x="1900.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_6_ffn1&#45;&gt;layer_1_expert_6_gelu -->
<g id="edge106" class="edge">
<title>layer_1_expert_6_ffn1&#45;&gt;layer_1_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-24926.57C1900.57,-24918.34 1900.57,-24909.08 1900.57,-24900.28"/>
<polygon fill="black" stroke="black" points="1904.07,-24900.24 1900.57,-24890.24 1897.07,-24900.24 1904.07,-24900.24"/>
</g>
<!-- layer_1_expert_6_ffn2 -->
<g id="node79" class="node">
<title>layer_1_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-24800 1797.57,-24800 1797.57,-24747 2003.57,-24747 2003.57,-24800"/>
<text text-anchor="middle" x="1900.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_6_gelu&#45;&gt;layer_1_expert_6_ffn2 -->
<g id="edge107" class="edge">
<title>layer_1_expert_6_gelu&#45;&gt;layer_1_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-24836.57C1900.57,-24828.34 1900.57,-24819.08 1900.57,-24810.28"/>
<polygon fill="black" stroke="black" points="1904.07,-24810.24 1900.57,-24800.24 1897.07,-24810.24 1904.07,-24810.24"/>
</g>
<!-- layer_1_expert_6_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge118" class="edge">
<title>layer_1_expert_6_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-24748.59C1794.51,-24748.03 1791.52,-24747.5 1788.57,-24747 1588.54,-24712.98 1357.51,-24688.53 1198.33,-24673.97"/>
<polygon fill="black" stroke="black" points="1198.23,-24670.45 1187.95,-24673.03 1197.59,-24677.42 1198.23,-24670.45"/>
</g>
<!-- layer_1_expert_7_gelu -->
<g id="node81" class="node">
<title>layer_1_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-24890 901.57,-24890 901.57,-24837 1107.57,-24837 1107.57,-24890"/>
<text text-anchor="middle" x="1004.57" y="-24874.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-24859.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-24844.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_7_ffn1&#45;&gt;layer_1_expert_7_gelu -->
<g id="edge110" class="edge">
<title>layer_1_expert_7_ffn1&#45;&gt;layer_1_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-24926.57C1004.57,-24918.34 1004.57,-24909.08 1004.57,-24900.28"/>
<polygon fill="black" stroke="black" points="1008.07,-24900.24 1004.57,-24890.24 1001.07,-24900.24 1008.07,-24900.24"/>
</g>
<!-- layer_1_expert_7_ffn2 -->
<g id="node82" class="node">
<title>layer_1_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-24800 901.57,-24800 901.57,-24747 1107.57,-24747 1107.57,-24800"/>
<text text-anchor="middle" x="1004.57" y="-24784.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-24769.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-24754.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_expert_7_gelu&#45;&gt;layer_1_expert_7_ffn2 -->
<g id="edge111" class="edge">
<title>layer_1_expert_7_gelu&#45;&gt;layer_1_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-24836.57C1004.57,-24828.34 1004.57,-24819.08 1004.57,-24810.28"/>
<polygon fill="black" stroke="black" points="1008.07,-24810.24 1004.57,-24800.24 1001.07,-24810.24 1008.07,-24810.24"/>
</g>
<!-- layer_1_expert_7_ffn2&#45;&gt;layer_1_expert_agg -->
<g id="edge119" class="edge">
<title>layer_1_expert_7_ffn2&#45;&gt;layer_1_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-24746.8C1004.57,-24738.86 1004.57,-24729.74 1004.57,-24720.44"/>
<polygon fill="black" stroke="black" points="1008.07,-24720.32 1004.57,-24710.32 1001.07,-24720.32 1008.07,-24720.32"/>
</g>
<!-- layer_1_expert_agg&#45;&gt;layer_1_add -->
<g id="edge121" class="edge">
<title>layer_1_expert_agg&#45;&gt;layer_1_add</title>
<path fill="none" stroke="black" d="M810.56,-24627.92C658.7,-24605.93 452.76,-24576.12 326.73,-24557.88"/>
<polygon fill="black" stroke="black" points="327.07,-24554.39 316.67,-24556.42 326.07,-24561.32 327.07,-24554.39"/>
</g>
<!-- comm_1_2 -->
<g id="node85" class="node">
<title>comm_1_2</title>
<polygon fill="yellow" stroke="black" points="427.21,-24477 87.36,-24477 -0.07,-24371 339.79,-24371 427.21,-24477"/>
<text text-anchor="middle" x="213.57" y="-24435.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-24420.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-24405.3" font-family="Times,serif" font-size="14.00">GPU 1  GPU 2</text>
</g>
<!-- layer_1_add&#45;&gt;comm_1_2 -->
<g id="edge122" class="edge">
<title>layer_1_add&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M213.57,-24513.8C213.57,-24505.86 213.57,-24496.74 213.57,-24487.44"/>
<polygon fill="black" stroke="black" points="217.07,-24487.32 213.57,-24477.32 210.07,-24487.32 217.07,-24487.32"/>
</g>
<!-- layer_2_ln1 -->
<g id="node86" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-24334 291.57,-24334 291.57,-24281 497.57,-24281 497.57,-24334"/>
<text text-anchor="middle" x="394.57" y="-24318.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-24303.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-24288.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- comm_1_2&#45;&gt;layer_2_ln1 -->
<g id="edge123" class="edge">
<title>comm_1_2&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M295.86,-24370.94C312.72,-24360.28 329.97,-24349.37 345.23,-24339.71"/>
<polygon fill="black" stroke="black" points="347.39,-24342.49 353.97,-24334.18 343.65,-24336.57 347.39,-24342.49"/>
</g>
<!-- layer_2_add1 -->
<g id="node98" class="node">
<title>layer_2_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-23562 110.57,-23562 110.57,-23509 316.57,-23509 316.57,-23562"/>
<text text-anchor="middle" x="213.57" y="-23546.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-23531.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-23516.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- comm_1_2&#45;&gt;layer_2_add1 -->
<g id="edge137" class="edge">
<title>comm_1_2&#45;&gt;layer_2_add1</title>
<path fill="none" stroke="black" d="M205.8,-24370.97C203.49,-24351.42 201.57,-24328.99 201.57,-24308.5 201.57,-24308.5 201.57,-24308.5 201.57,-23624.5 201.57,-23607.17 203.88,-23588.1 206.48,-23572.15"/>
<polygon fill="black" stroke="black" points="209.95,-23572.62 208.2,-23562.17 203.05,-23571.43 209.95,-23572.62"/>
</g>
<!-- layer_2_q_proj -->
<g id="node87" class="node">
<title>layer_2_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-24244 453.57,-24244 453.57,-24191 659.57,-24191 659.57,-24244"/>
<text text-anchor="middle" x="556.57" y="-24228.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-24213.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-24198.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_q_proj -->
<g id="edge124" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-24280.81C460.25,-24270.82 481.45,-24259.31 500.58,-24248.91"/>
<polygon fill="black" stroke="black" points="502.38,-24251.92 509.5,-24244.07 499.04,-24245.77 502.38,-24251.92"/>
</g>
<!-- layer_2_k_proj -->
<g id="node88" class="node">
<title>layer_2_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-24244 677.57,-24244 677.57,-24191 883.57,-24191 883.57,-24244"/>
<text text-anchor="middle" x="780.57" y="-24228.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-24213.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-24198.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_k_proj -->
<g id="edge125" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-24282.98C550.11,-24271.04 613.8,-24256.52 667.48,-24244.28"/>
<polygon fill="black" stroke="black" points="668.41,-24247.66 677.38,-24242.02 666.86,-24240.83 668.41,-24247.66"/>
</g>
<!-- layer_2_v_proj -->
<g id="node89" class="node">
<title>layer_2_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-24244 229.57,-24244 229.57,-24191 435.57,-24191 435.57,-24244"/>
<text text-anchor="middle" x="332.57" y="-24228.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-24213.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-24198.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_v_proj -->
<g id="edge126" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-24280.57C370.12,-24271.8 363.13,-24261.87 356.57,-24252.56"/>
<polygon fill="black" stroke="black" points="359.33,-24250.4 350.71,-24244.24 353.61,-24254.43 359.33,-24250.4"/>
</g>
<!-- layer_2_q_reshape -->
<g id="node90" class="node">
<title>layer_2_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-24154 426.57,-24154 426.57,-24101 650.57,-24101 650.57,-24154"/>
<text text-anchor="middle" x="538.57" y="-24138.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-24123.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-24108.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_q_proj&#45;&gt;layer_2_q_reshape -->
<g id="edge127" class="edge">
<title>layer_2_q_proj&#45;&gt;layer_2_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-24190.57C549.58,-24182.34 547.69,-24173.08 545.89,-24164.28"/>
<polygon fill="black" stroke="black" points="549.27,-24163.34 543.84,-24154.24 542.41,-24164.74 549.27,-24163.34"/>
</g>
<!-- layer_2_k_reshape -->
<g id="node91" class="node">
<title>layer_2_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-24154 668.57,-24154 668.57,-24101 892.57,-24101 892.57,-24154"/>
<text text-anchor="middle" x="780.57" y="-24138.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-24123.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-24108.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_k_proj&#45;&gt;layer_2_k_reshape -->
<g id="edge128" class="edge">
<title>layer_2_k_proj&#45;&gt;layer_2_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-24190.57C780.57,-24182.34 780.57,-24173.08 780.57,-24164.28"/>
<polygon fill="black" stroke="black" points="784.07,-24164.24 780.57,-24154.24 777.07,-24164.24 784.07,-24164.24"/>
</g>
<!-- layer_2_v_reshape -->
<g id="node92" class="node">
<title>layer_2_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-24083 225.57,-24083 225.57,-24030 449.57,-24030 449.57,-24083"/>
<text text-anchor="middle" x="337.57" y="-24067.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-24052.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-24037.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_v_proj&#45;&gt;layer_2_v_reshape -->
<g id="edge129" class="edge">
<title>layer_2_v_proj&#45;&gt;layer_2_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-24190.95C334.2,-24164.61 335.5,-24123.29 336.44,-24093.61"/>
<polygon fill="black" stroke="black" points="339.95,-24093.35 336.76,-24083.25 332.95,-24093.13 339.95,-24093.35"/>
</g>
<!-- layer_2_attn_scores -->
<g id="node93" class="node">
<title>layer_2_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-24012 422.07,-24012 422.07,-23959 655.07,-23959 655.07,-24012"/>
<text text-anchor="middle" x="538.57" y="-23996.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-23981.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-23966.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_q_reshape&#45;&gt;layer_2_attn_scores -->
<g id="edge130" class="edge">
<title>layer_2_q_reshape&#45;&gt;layer_2_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-24100.82C538.57,-24078.72 538.57,-24046.6 538.57,-24022.03"/>
<polygon fill="black" stroke="black" points="542.07,-24022.02 538.57,-24012.02 535.07,-24022.02 542.07,-24022.02"/>
</g>
<!-- layer_2_k_reshape&#45;&gt;layer_2_attn_scores -->
<g id="edge131" class="edge">
<title>layer_2_k_reshape&#45;&gt;layer_2_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-24100.98C695.65,-24077.37 634.91,-24042.23 591.5,-24017.12"/>
<polygon fill="black" stroke="black" points="593.19,-24014.05 582.78,-24012.08 589.68,-24020.11 593.19,-24014.05"/>
</g>
<!-- layer_2_attn_output -->
<g id="node95" class="node">
<title>layer_2_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-23832 229.57,-23832 229.57,-23779 453.57,-23779 453.57,-23832"/>
<text text-anchor="middle" x="341.57" y="-23816.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-23801.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-23786.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_v_reshape&#45;&gt;layer_2_attn_output -->
<g id="edge134" class="edge">
<title>layer_2_v_reshape&#45;&gt;layer_2_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-24029.79C338.7,-23985.13 340.18,-23893.13 341,-23842.27"/>
<polygon fill="black" stroke="black" points="344.5,-23842.12 341.16,-23832.07 337.5,-23842.01 344.5,-23842.12"/>
</g>
<!-- layer_2_attn_weights -->
<g id="node94" class="node">
<title>layer_2_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="631.07,-23922 398.07,-23922 398.07,-23869 631.07,-23869 631.07,-23922"/>
<text text-anchor="middle" x="514.57" y="-23906.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="514.57" y="-23891.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="514.57" y="-23876.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_scores&#45;&gt;layer_2_attn_weights -->
<g id="edge132" class="edge">
<title>layer_2_attn_scores&#45;&gt;layer_2_attn_weights</title>
<path fill="none" stroke="black" d="M531.5,-23958.57C529.23,-23950.25 526.67,-23940.88 524.25,-23931.99"/>
<polygon fill="black" stroke="black" points="527.6,-23930.97 521.59,-23922.24 520.85,-23932.81 527.6,-23930.97"/>
</g>
<!-- layer_2_attn_weights&#45;&gt;layer_2_attn_output -->
<g id="edge133" class="edge">
<title>layer_2_attn_weights&#45;&gt;layer_2_attn_output</title>
<path fill="none" stroke="black" d="M464.07,-23868.81C444.26,-23858.73 421.39,-23847.1 400.81,-23836.63"/>
<polygon fill="black" stroke="black" points="402.34,-23833.48 391.84,-23832.07 399.16,-23839.72 402.34,-23833.48"/>
</g>
<!-- layer_2_attn_reshape -->
<g id="node96" class="node">
<title>layer_2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-23742 236.57,-23742 236.57,-23689 442.57,-23689 442.57,-23742"/>
<text text-anchor="middle" x="339.57" y="-23726.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-23711.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-23696.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_output&#45;&gt;layer_2_attn_reshape -->
<g id="edge135" class="edge">
<title>layer_2_attn_output&#45;&gt;layer_2_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-23778.57C340.79,-23770.34 340.58,-23761.08 340.38,-23752.28"/>
<polygon fill="black" stroke="black" points="343.88,-23752.16 340.16,-23742.24 336.88,-23752.32 343.88,-23752.16"/>
</g>
<!-- layer_2_attn_proj -->
<g id="node97" class="node">
<title>layer_2_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-23652 233.57,-23652 233.57,-23599 439.57,-23599 439.57,-23652"/>
<text text-anchor="middle" x="336.57" y="-23636.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-23621.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-23606.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_reshape&#45;&gt;layer_2_attn_proj -->
<g id="edge136" class="edge">
<title>layer_2_attn_reshape&#45;&gt;layer_2_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-23688.57C338.41,-23680.34 338.09,-23671.08 337.79,-23662.28"/>
<polygon fill="black" stroke="black" points="341.29,-23662.12 337.45,-23652.24 334.29,-23662.36 341.29,-23662.12"/>
</g>
<!-- layer_2_attn_proj&#45;&gt;layer_2_add1 -->
<g id="edge138" class="edge">
<title>layer_2_attn_proj&#45;&gt;layer_2_add1</title>
<path fill="none" stroke="black" d="M300.66,-23598.81C287.15,-23589.14 271.63,-23578.04 257.47,-23567.9"/>
<polygon fill="black" stroke="black" points="259.48,-23565.04 249.31,-23562.07 255.41,-23570.73 259.48,-23565.04"/>
</g>
<!-- layer_2_ln2 -->
<g id="node99" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-23472 827.57,-23472 827.57,-23419 1033.57,-23419 1033.57,-23472"/>
<text text-anchor="middle" x="930.57" y="-23456.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-23441.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-23426.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_add1&#45;&gt;layer_2_ln2 -->
<g id="edge139" class="edge">
<title>layer_2_add1&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M316.68,-23521.84C449.47,-23505.55 679.5,-23477.31 817.13,-23460.42"/>
<polygon fill="black" stroke="black" points="817.78,-23463.87 827.28,-23459.18 816.93,-23456.92 817.78,-23463.87"/>
</g>
<!-- layer_2_add -->
<g id="node126" class="node">
<title>layer_2_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-22816 110.57,-22816 110.57,-22763 316.57,-22763 316.57,-22816"/>
<text text-anchor="middle" x="213.57" y="-22800.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-22785.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-22770.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_add1&#45;&gt;layer_2_add -->
<g id="edge181" class="edge">
<title>layer_2_add1&#45;&gt;layer_2_add</title>
<path fill="none" stroke="black" d="M208.2,-23508.83C205.01,-23491.34 201.57,-23467.62 201.57,-23446.5 201.57,-23446.5 201.57,-23446.5 201.57,-22905 201.57,-22878.6 204.77,-22848.96 207.86,-22826.46"/>
<polygon fill="black" stroke="black" points="211.35,-22826.73 209.31,-22816.34 204.42,-22825.74 211.35,-22826.73"/>
</g>
<!-- layer_2_gate -->
<g id="node100" class="node">
<title>layer_2_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-23382 900.57,-23329 1079.57,-23276 1258.57,-23329 1079.57,-23382"/>
<text text-anchor="middle" x="1079.57" y="-23340.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-23325.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-23310.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_gate -->
<g id="edge140" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_gate</title>
<path fill="none" stroke="black" d="M964.01,-23418.8C981.28,-23405.53 1002.83,-23388.97 1022.63,-23373.76"/>
<polygon fill="black" stroke="black" points="1024.9,-23376.43 1030.69,-23367.56 1020.63,-23370.88 1024.9,-23376.43"/>
</g>
<!-- layer_2_expert_0_ffn1 -->
<g id="node101" class="node">
<title>layer_2_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-23229 677.57,-23229 677.57,-23176 883.57,-23176 883.57,-23229"/>
<text text-anchor="middle" x="780.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_0_ffn1 -->
<g id="edge142" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-23418.95C887.23,-23408.28 873.96,-23395.28 863.57,-23382 824.71,-23332.33 817.94,-23316.58 794.57,-23258 792.17,-23251.99 790.08,-23245.43 788.29,-23239.02"/>
<polygon fill="black" stroke="black" points="791.63,-23237.97 785.73,-23229.17 784.85,-23239.72 791.63,-23237.97"/>
</g>
<!-- layer_2_expert_1_ffn1 -->
<g id="node104" class="node">
<title>layer_2_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-23229 229.57,-23229 229.57,-23176 435.57,-23176 435.57,-23229"/>
<text text-anchor="middle" x="332.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_1_ffn1 -->
<g id="edge146" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-23432.27C767.36,-23422.96 691.02,-23407.31 626.57,-23382 529.83,-23344.01 428.72,-23275.16 373.91,-23234.98"/>
<polygon fill="black" stroke="black" points="375.97,-23232.14 365.84,-23229.02 371.81,-23237.78 375.97,-23232.14"/>
</g>
<!-- layer_2_expert_2_ffn1 -->
<g id="node107" class="node">
<title>layer_2_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-23229 1125.57,-23229 1125.57,-23176 1331.57,-23176 1331.57,-23229"/>
<text text-anchor="middle" x="1228.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_2_ffn1 -->
<g id="edge150" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-23439.17C1121.34,-23432.26 1237.52,-23416.69 1267.57,-23382 1306.88,-23336.62 1295.71,-23302.4 1272.57,-23247 1271.12,-23243.52 1269.24,-23240.18 1267.08,-23237.01"/>
<polygon fill="black" stroke="black" points="1269.72,-23234.71 1260.79,-23229.01 1264.22,-23239.03 1269.72,-23234.71"/>
</g>
<!-- layer_2_expert_3_ffn1 -->
<g id="node110" class="node">
<title>layer_2_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-23229 1573.57,-23229 1573.57,-23176 1779.57,-23176 1779.57,-23229"/>
<text text-anchor="middle" x="1676.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_3_ffn1 -->
<g id="edge154" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-23439.82C1122.76,-23433.39 1253.8,-23418.14 1362.57,-23382 1484.83,-23341.38 1520.13,-23333.42 1624.57,-23258 1633.08,-23251.86 1641.36,-23244.21 1648.73,-23236.6"/>
<polygon fill="black" stroke="black" points="1651.49,-23238.77 1655.76,-23229.07 1646.38,-23233.99 1651.49,-23238.77"/>
</g>
<!-- layer_2_expert_4_ffn1 -->
<g id="node113" class="node">
<title>layer_2_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-23229 453.57,-23229 453.57,-23176 659.57,-23176 659.57,-23229"/>
<text text-anchor="middle" x="556.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_4_ffn1 -->
<g id="edge158" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-23418.89C801.11,-23387.58 686.43,-23329.79 603.57,-23258 596.29,-23251.69 589.13,-23244.24 582.68,-23236.9"/>
<polygon fill="black" stroke="black" points="585.14,-23234.39 575.99,-23229.05 579.81,-23238.93 585.14,-23234.39"/>
</g>
<!-- layer_2_expert_5_ffn1 -->
<g id="node116" class="node">
<title>layer_2_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-23229 1349.57,-23229 1349.57,-23176 1555.57,-23176 1555.57,-23229"/>
<text text-anchor="middle" x="1452.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_5_ffn1 -->
<g id="edge162" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-23438.77C1098.02,-23433.2 1181.84,-23422.3 1253.57,-23401 1272.44,-23395.4 1277.44,-23393.28 1293.57,-23382 1357.95,-23336.96 1370.85,-23319.64 1419.57,-23258 1424.54,-23251.72 1429.34,-23244.63 1433.66,-23237.69"/>
<polygon fill="black" stroke="black" points="1436.7,-23239.43 1438.87,-23229.05 1430.71,-23235.81 1436.7,-23239.43"/>
</g>
<!-- layer_2_expert_6_ffn1 -->
<g id="node119" class="node">
<title>layer_2_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-23229 1797.57,-23229 1797.57,-23176 2003.57,-23176 2003.57,-23229"/>
<text text-anchor="middle" x="1900.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_6_ffn1 -->
<g id="edge166" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-23442.36C1147.98,-23437.86 1336.72,-23424.05 1493.57,-23382 1625.52,-23346.63 1769.63,-23274.8 1845.97,-23233.86"/>
<polygon fill="black" stroke="black" points="1847.8,-23236.86 1854.94,-23229.03 1844.47,-23230.69 1847.8,-23236.86"/>
</g>
<!-- layer_2_expert_7_ffn1 -->
<g id="node122" class="node">
<title>layer_2_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-23229 901.57,-23229 901.57,-23176 1107.57,-23176 1107.57,-23229"/>
<text text-anchor="middle" x="1004.57" y="-23213.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-23198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-23183.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_expert_7_ffn1 -->
<g id="edge170" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-23418.92C903.08,-23408.14 895.6,-23395.08 891.57,-23382 873.88,-23324.62 852.23,-23296.25 886.57,-23247 889.58,-23242.69 893.06,-23238.8 896.91,-23235.3"/>
<polygon fill="black" stroke="black" points="899.11,-23238.02 904.71,-23229.03 894.73,-23232.56 899.11,-23238.02"/>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_0_ffn1 -->
<g id="edge141" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-23297.54C959.2,-23277.88 898.07,-23252.43 851.32,-23232.96"/>
<polygon fill="black" stroke="black" points="852.45,-23229.64 841.87,-23229.03 849.76,-23236.1 852.45,-23229.64"/>
<text text-anchor="middle" x="924.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_1_ffn1 -->
<g id="edge145" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-23311.72C833.08,-23294.17 630.07,-23264.21 445.54,-23229.14"/>
<polygon fill="black" stroke="black" points="446.13,-23225.69 435.65,-23227.25 444.82,-23232.56 446.13,-23225.69"/>
<text text-anchor="middle" x="623.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_2_ffn1 -->
<g id="edge149" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-23286.47C1129.09,-23273.16 1143.87,-23258.81 1158.57,-23247 1163.82,-23242.78 1169.5,-23238.65 1175.28,-23234.71"/>
<polygon fill="black" stroke="black" points="1177.37,-23237.52 1183.77,-23229.09 1173.5,-23231.68 1177.37,-23237.52"/>
<text text-anchor="middle" x="1180.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_3_ffn1 -->
<g id="edge153" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-23306.7C1263.24,-23290.33 1376.38,-23267.18 1475.57,-23247 1512.26,-23239.54 1523.52,-23237.73 1563.55,-23229.2"/>
<polygon fill="black" stroke="black" points="1564.41,-23232.59 1573.46,-23227.08 1562.94,-23225.75 1564.41,-23232.59"/>
<text text-anchor="middle" x="1497.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_4_ffn1 -->
<g id="edge157" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-23304.8C893.49,-23283.7 762.7,-23252.57 669.53,-23230.39"/>
<polygon fill="black" stroke="black" points="670.33,-23226.98 659.79,-23228.07 668.7,-23233.79 670.33,-23226.98"/>
<text text-anchor="middle" x="792.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_5_ffn1 -->
<g id="edge161" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-23297.6C1193.35,-23281.52 1244.3,-23262.05 1290.57,-23247 1306.78,-23241.73 1324.04,-23236.6 1341.02,-23231.81"/>
<polygon fill="black" stroke="black" points="1342.29,-23235.09 1350.98,-23229.04 1340.41,-23228.35 1342.29,-23235.09"/>
<text text-anchor="middle" x="1312.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_6_ffn1 -->
<g id="edge165" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-23313.57C1346.62,-23296.91 1578.71,-23267.07 1787.57,-23229.13"/>
<polygon fill="black" stroke="black" points="1788.29,-23232.55 1797.5,-23227.31 1787.04,-23225.67 1788.29,-23232.55"/>
<text text-anchor="middle" x="1694.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_2_gate&#45;&gt;layer_2_expert_7_ffn1 -->
<g id="edge169" class="edge">
<title>layer_2_gate&#45;&gt;layer_2_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-23283.76C1043.87,-23268.73 1033.9,-23252.18 1025.37,-23238.03"/>
<polygon fill="black" stroke="black" points="1028.16,-23235.88 1020,-23229.12 1022.17,-23239.49 1028.16,-23235.88"/>
<text text-anchor="middle" x="1056.57" y="-23250" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_2_expert_0_gelu -->
<g id="node102" class="node">
<title>layer_2_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-23139 677.57,-23139 677.57,-23086 883.57,-23086 883.57,-23139"/>
<text text-anchor="middle" x="780.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_0_ffn1&#45;&gt;layer_2_expert_0_gelu -->
<g id="edge143" class="edge">
<title>layer_2_expert_0_ffn1&#45;&gt;layer_2_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-23175.57C780.57,-23167.34 780.57,-23158.08 780.57,-23149.28"/>
<polygon fill="black" stroke="black" points="784.07,-23149.24 780.57,-23139.24 777.07,-23149.24 784.07,-23149.24"/>
</g>
<!-- layer_2_expert_0_ffn2 -->
<g id="node103" class="node">
<title>layer_2_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-23049 677.57,-23049 677.57,-22996 883.57,-22996 883.57,-23049"/>
<text text-anchor="middle" x="780.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_0_gelu&#45;&gt;layer_2_expert_0_ffn2 -->
<g id="edge144" class="edge">
<title>layer_2_expert_0_gelu&#45;&gt;layer_2_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-23085.57C780.57,-23077.34 780.57,-23068.08 780.57,-23059.28"/>
<polygon fill="black" stroke="black" points="784.07,-23059.24 780.57,-23049.24 777.07,-23059.24 784.07,-23059.24"/>
</g>
<!-- layer_2_expert_agg -->
<g id="node125" class="node">
<title>layer_2_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-22959 878.36,-22959 790.93,-22853 1130.79,-22853 1218.21,-22959"/>
<text text-anchor="middle" x="1004.57" y="-22917.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-22902.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-22887.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_0_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge173" class="edge">
<title>layer_2_expert_0_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-22995.95C849.26,-22986.39 871.33,-22975.11 893.35,-22963.85"/>
<polygon fill="black" stroke="black" points="895.14,-22966.87 902.45,-22959.2 891.95,-22960.64 895.14,-22966.87"/>
</g>
<!-- layer_2_expert_1_gelu -->
<g id="node105" class="node">
<title>layer_2_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-23139 229.57,-23139 229.57,-23086 435.57,-23086 435.57,-23139"/>
<text text-anchor="middle" x="332.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_1_ffn1&#45;&gt;layer_2_expert_1_gelu -->
<g id="edge147" class="edge">
<title>layer_2_expert_1_ffn1&#45;&gt;layer_2_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-23175.57C332.57,-23167.34 332.57,-23158.08 332.57,-23149.28"/>
<polygon fill="black" stroke="black" points="336.07,-23149.24 332.57,-23139.24 329.07,-23149.24 336.07,-23149.24"/>
</g>
<!-- layer_2_expert_1_ffn2 -->
<g id="node106" class="node">
<title>layer_2_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-23049 229.57,-23049 229.57,-22996 435.57,-22996 435.57,-23049"/>
<text text-anchor="middle" x="332.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_1_gelu&#45;&gt;layer_2_expert_1_ffn2 -->
<g id="edge148" class="edge">
<title>layer_2_expert_1_gelu&#45;&gt;layer_2_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-23085.57C332.57,-23077.34 332.57,-23068.08 332.57,-23059.28"/>
<polygon fill="black" stroke="black" points="336.07,-23059.24 332.57,-23049.24 329.07,-23059.24 336.07,-23059.24"/>
</g>
<!-- layer_2_expert_1_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge174" class="edge">
<title>layer_2_expert_1_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-22997.76C438.66,-22997.16 441.63,-22996.57 444.57,-22996 578.16,-22970.21 730.72,-22946.32 842.83,-22929.81"/>
<polygon fill="black" stroke="black" points="843.49,-22933.25 852.87,-22928.33 842.47,-22926.32 843.49,-22933.25"/>
</g>
<!-- layer_2_expert_2_gelu -->
<g id="node108" class="node">
<title>layer_2_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-23139 1125.57,-23139 1125.57,-23086 1331.57,-23086 1331.57,-23139"/>
<text text-anchor="middle" x="1228.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_2_ffn1&#45;&gt;layer_2_expert_2_gelu -->
<g id="edge151" class="edge">
<title>layer_2_expert_2_ffn1&#45;&gt;layer_2_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-23175.57C1228.57,-23167.34 1228.57,-23158.08 1228.57,-23149.28"/>
<polygon fill="black" stroke="black" points="1232.07,-23149.24 1228.57,-23139.24 1225.07,-23149.24 1232.07,-23149.24"/>
</g>
<!-- layer_2_expert_2_ffn2 -->
<g id="node109" class="node">
<title>layer_2_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-23049 1125.57,-23049 1125.57,-22996 1331.57,-22996 1331.57,-23049"/>
<text text-anchor="middle" x="1228.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_2_gelu&#45;&gt;layer_2_expert_2_ffn2 -->
<g id="edge152" class="edge">
<title>layer_2_expert_2_gelu&#45;&gt;layer_2_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-23085.57C1228.57,-23077.34 1228.57,-23068.08 1228.57,-23059.28"/>
<polygon fill="black" stroke="black" points="1232.07,-23059.24 1228.57,-23049.24 1225.07,-23059.24 1232.07,-23059.24"/>
</g>
<!-- layer_2_expert_2_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge175" class="edge">
<title>layer_2_expert_2_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-22995.95C1159.88,-22986.39 1137.81,-22975.11 1115.79,-22963.85"/>
<polygon fill="black" stroke="black" points="1117.19,-22960.64 1106.7,-22959.2 1114.01,-22966.87 1117.19,-22960.64"/>
</g>
<!-- layer_2_expert_3_gelu -->
<g id="node111" class="node">
<title>layer_2_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-23139 1573.57,-23139 1573.57,-23086 1779.57,-23086 1779.57,-23139"/>
<text text-anchor="middle" x="1676.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_3_ffn1&#45;&gt;layer_2_expert_3_gelu -->
<g id="edge155" class="edge">
<title>layer_2_expert_3_ffn1&#45;&gt;layer_2_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-23175.57C1676.57,-23167.34 1676.57,-23158.08 1676.57,-23149.28"/>
<polygon fill="black" stroke="black" points="1680.07,-23149.24 1676.57,-23139.24 1673.07,-23149.24 1680.07,-23149.24"/>
</g>
<!-- layer_2_expert_3_ffn2 -->
<g id="node112" class="node">
<title>layer_2_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-23049 1573.57,-23049 1573.57,-22996 1779.57,-22996 1779.57,-23049"/>
<text text-anchor="middle" x="1676.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_3_gelu&#45;&gt;layer_2_expert_3_ffn2 -->
<g id="edge156" class="edge">
<title>layer_2_expert_3_gelu&#45;&gt;layer_2_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-23085.57C1676.57,-23077.34 1676.57,-23068.08 1676.57,-23059.28"/>
<polygon fill="black" stroke="black" points="1680.07,-23059.24 1676.57,-23049.24 1673.07,-23059.24 1680.07,-23059.24"/>
</g>
<!-- layer_2_expert_3_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge176" class="edge">
<title>layer_2_expert_3_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-22997.76C1570.49,-22997.16 1567.51,-22996.57 1564.57,-22996 1446.94,-22973.29 1314.59,-22952.06 1208.1,-22936.03"/>
<polygon fill="black" stroke="black" points="1208.61,-22932.57 1198.21,-22934.54 1207.58,-22939.49 1208.61,-22932.57"/>
</g>
<!-- layer_2_expert_4_gelu -->
<g id="node114" class="node">
<title>layer_2_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-23139 453.57,-23139 453.57,-23086 659.57,-23086 659.57,-23139"/>
<text text-anchor="middle" x="556.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_4_ffn1&#45;&gt;layer_2_expert_4_gelu -->
<g id="edge159" class="edge">
<title>layer_2_expert_4_ffn1&#45;&gt;layer_2_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-23175.57C556.57,-23167.34 556.57,-23158.08 556.57,-23149.28"/>
<polygon fill="black" stroke="black" points="560.07,-23149.24 556.57,-23139.24 553.07,-23149.24 560.07,-23149.24"/>
</g>
<!-- layer_2_expert_4_ffn2 -->
<g id="node115" class="node">
<title>layer_2_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-23049 453.57,-23049 453.57,-22996 659.57,-22996 659.57,-23049"/>
<text text-anchor="middle" x="556.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_4_gelu&#45;&gt;layer_2_expert_4_ffn2 -->
<g id="edge160" class="edge">
<title>layer_2_expert_4_gelu&#45;&gt;layer_2_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-23085.57C556.57,-23077.34 556.57,-23068.08 556.57,-23059.28"/>
<polygon fill="black" stroke="black" points="560.07,-23059.24 556.57,-23049.24 553.07,-23059.24 560.07,-23059.24"/>
</g>
<!-- layer_2_expert_4_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge177" class="edge">
<title>layer_2_expert_4_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-22995.95C714.81,-22981.06 789.41,-22961.99 854.59,-22945.33"/>
<polygon fill="black" stroke="black" points="855.73,-22948.65 864.55,-22942.79 853.99,-22941.87 855.73,-22948.65"/>
</g>
<!-- layer_2_expert_5_gelu -->
<g id="node117" class="node">
<title>layer_2_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-23139 1349.57,-23139 1349.57,-23086 1555.57,-23086 1555.57,-23139"/>
<text text-anchor="middle" x="1452.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_5_ffn1&#45;&gt;layer_2_expert_5_gelu -->
<g id="edge163" class="edge">
<title>layer_2_expert_5_ffn1&#45;&gt;layer_2_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-23175.57C1452.57,-23167.34 1452.57,-23158.08 1452.57,-23149.28"/>
<polygon fill="black" stroke="black" points="1456.07,-23149.24 1452.57,-23139.24 1449.07,-23149.24 1456.07,-23149.24"/>
</g>
<!-- layer_2_expert_5_ffn2 -->
<g id="node118" class="node">
<title>layer_2_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-23049 1349.57,-23049 1349.57,-22996 1555.57,-22996 1555.57,-23049"/>
<text text-anchor="middle" x="1452.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_5_gelu&#45;&gt;layer_2_expert_5_ffn2 -->
<g id="edge164" class="edge">
<title>layer_2_expert_5_gelu&#45;&gt;layer_2_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-23085.57C1452.57,-23077.34 1452.57,-23068.08 1452.57,-23059.28"/>
<polygon fill="black" stroke="black" points="1456.07,-23059.24 1452.57,-23049.24 1449.07,-23059.24 1456.07,-23059.24"/>
</g>
<!-- layer_2_expert_5_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge178" class="edge">
<title>layer_2_expert_5_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-22995.95C1312.66,-22985.74 1265.05,-22973.57 1218.07,-22961.57"/>
<polygon fill="black" stroke="black" points="1218.92,-22958.17 1208.37,-22959.09 1217.19,-22964.95 1218.92,-22958.17"/>
</g>
<!-- layer_2_expert_6_gelu -->
<g id="node120" class="node">
<title>layer_2_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-23139 1797.57,-23139 1797.57,-23086 2003.57,-23086 2003.57,-23139"/>
<text text-anchor="middle" x="1900.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_6_ffn1&#45;&gt;layer_2_expert_6_gelu -->
<g id="edge167" class="edge">
<title>layer_2_expert_6_ffn1&#45;&gt;layer_2_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-23175.57C1900.57,-23167.34 1900.57,-23158.08 1900.57,-23149.28"/>
<polygon fill="black" stroke="black" points="1904.07,-23149.24 1900.57,-23139.24 1897.07,-23149.24 1904.07,-23149.24"/>
</g>
<!-- layer_2_expert_6_ffn2 -->
<g id="node121" class="node">
<title>layer_2_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-23049 1797.57,-23049 1797.57,-22996 2003.57,-22996 2003.57,-23049"/>
<text text-anchor="middle" x="1900.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_6_gelu&#45;&gt;layer_2_expert_6_ffn2 -->
<g id="edge168" class="edge">
<title>layer_2_expert_6_gelu&#45;&gt;layer_2_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-23085.57C1900.57,-23077.34 1900.57,-23068.08 1900.57,-23059.28"/>
<polygon fill="black" stroke="black" points="1904.07,-23059.24 1900.57,-23049.24 1897.07,-23059.24 1904.07,-23059.24"/>
</g>
<!-- layer_2_expert_6_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge179" class="edge">
<title>layer_2_expert_6_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-22997.59C1794.51,-22997.03 1791.52,-22996.5 1788.57,-22996 1588.54,-22961.98 1357.51,-22937.53 1198.33,-22922.97"/>
<polygon fill="black" stroke="black" points="1198.23,-22919.45 1187.95,-22922.03 1197.59,-22926.42 1198.23,-22919.45"/>
</g>
<!-- layer_2_expert_7_gelu -->
<g id="node123" class="node">
<title>layer_2_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-23139 901.57,-23139 901.57,-23086 1107.57,-23086 1107.57,-23139"/>
<text text-anchor="middle" x="1004.57" y="-23123.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-23108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-23093.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_7_ffn1&#45;&gt;layer_2_expert_7_gelu -->
<g id="edge171" class="edge">
<title>layer_2_expert_7_ffn1&#45;&gt;layer_2_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-23175.57C1004.57,-23167.34 1004.57,-23158.08 1004.57,-23149.28"/>
<polygon fill="black" stroke="black" points="1008.07,-23149.24 1004.57,-23139.24 1001.07,-23149.24 1008.07,-23149.24"/>
</g>
<!-- layer_2_expert_7_ffn2 -->
<g id="node124" class="node">
<title>layer_2_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-23049 901.57,-23049 901.57,-22996 1107.57,-22996 1107.57,-23049"/>
<text text-anchor="middle" x="1004.57" y="-23033.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-23018.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-23003.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_expert_7_gelu&#45;&gt;layer_2_expert_7_ffn2 -->
<g id="edge172" class="edge">
<title>layer_2_expert_7_gelu&#45;&gt;layer_2_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-23085.57C1004.57,-23077.34 1004.57,-23068.08 1004.57,-23059.28"/>
<polygon fill="black" stroke="black" points="1008.07,-23059.24 1004.57,-23049.24 1001.07,-23059.24 1008.07,-23059.24"/>
</g>
<!-- layer_2_expert_7_ffn2&#45;&gt;layer_2_expert_agg -->
<g id="edge180" class="edge">
<title>layer_2_expert_7_ffn2&#45;&gt;layer_2_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-22995.8C1004.57,-22987.86 1004.57,-22978.74 1004.57,-22969.44"/>
<polygon fill="black" stroke="black" points="1008.07,-22969.32 1004.57,-22959.32 1001.07,-22969.32 1008.07,-22969.32"/>
</g>
<!-- layer_2_expert_agg&#45;&gt;layer_2_add -->
<g id="edge182" class="edge">
<title>layer_2_expert_agg&#45;&gt;layer_2_add</title>
<path fill="none" stroke="black" d="M810.56,-22876.92C658.7,-22854.93 452.76,-22825.12 326.73,-22806.88"/>
<polygon fill="black" stroke="black" points="327.07,-22803.39 316.67,-22805.42 326.07,-22810.32 327.07,-22803.39"/>
</g>
<!-- comm_2_3 -->
<g id="node127" class="node">
<title>comm_2_3</title>
<polygon fill="yellow" stroke="black" points="427.21,-22726 87.36,-22726 -0.07,-22620 339.79,-22620 427.21,-22726"/>
<text text-anchor="middle" x="213.57" y="-22684.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-22669.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-22654.3" font-family="Times,serif" font-size="14.00">GPU 2  GPU 3</text>
</g>
<!-- layer_2_add&#45;&gt;comm_2_3 -->
<g id="edge183" class="edge">
<title>layer_2_add&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M213.57,-22762.8C213.57,-22754.86 213.57,-22745.74 213.57,-22736.44"/>
<polygon fill="black" stroke="black" points="217.07,-22736.32 213.57,-22726.32 210.07,-22736.32 217.07,-22736.32"/>
</g>
<!-- layer_3_ln1 -->
<g id="node128" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-22583 291.57,-22583 291.57,-22530 497.57,-22530 497.57,-22583"/>
<text text-anchor="middle" x="394.57" y="-22567.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-22552.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-22537.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- comm_2_3&#45;&gt;layer_3_ln1 -->
<g id="edge184" class="edge">
<title>comm_2_3&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M295.86,-22619.94C312.72,-22609.28 329.97,-22598.37 345.23,-22588.71"/>
<polygon fill="black" stroke="black" points="347.39,-22591.49 353.97,-22583.18 343.65,-22585.57 347.39,-22591.49"/>
</g>
<!-- layer_3_add1 -->
<g id="node140" class="node">
<title>layer_3_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-21811 110.57,-21811 110.57,-21758 316.57,-21758 316.57,-21811"/>
<text text-anchor="middle" x="213.57" y="-21795.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-21780.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-21765.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- comm_2_3&#45;&gt;layer_3_add1 -->
<g id="edge198" class="edge">
<title>comm_2_3&#45;&gt;layer_3_add1</title>
<path fill="none" stroke="black" d="M205.8,-22619.97C203.49,-22600.42 201.57,-22577.99 201.57,-22557.5 201.57,-22557.5 201.57,-22557.5 201.57,-21873.5 201.57,-21856.17 203.88,-21837.1 206.48,-21821.15"/>
<polygon fill="black" stroke="black" points="209.95,-21821.62 208.2,-21811.17 203.05,-21820.43 209.95,-21821.62"/>
</g>
<!-- layer_3_q_proj -->
<g id="node129" class="node">
<title>layer_3_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-22493 453.57,-22493 453.57,-22440 659.57,-22440 659.57,-22493"/>
<text text-anchor="middle" x="556.57" y="-22477.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-22462.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-22447.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_q_proj -->
<g id="edge185" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-22529.81C460.25,-22519.82 481.45,-22508.31 500.58,-22497.91"/>
<polygon fill="black" stroke="black" points="502.38,-22500.92 509.5,-22493.07 499.04,-22494.77 502.38,-22500.92"/>
</g>
<!-- layer_3_k_proj -->
<g id="node130" class="node">
<title>layer_3_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-22493 677.57,-22493 677.57,-22440 883.57,-22440 883.57,-22493"/>
<text text-anchor="middle" x="780.57" y="-22477.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-22462.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-22447.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_k_proj -->
<g id="edge186" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-22531.98C550.11,-22520.04 613.8,-22505.52 667.48,-22493.28"/>
<polygon fill="black" stroke="black" points="668.41,-22496.66 677.38,-22491.02 666.86,-22489.83 668.41,-22496.66"/>
</g>
<!-- layer_3_v_proj -->
<g id="node131" class="node">
<title>layer_3_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-22493 229.57,-22493 229.57,-22440 435.57,-22440 435.57,-22493"/>
<text text-anchor="middle" x="332.57" y="-22477.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-22462.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-22447.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_v_proj -->
<g id="edge187" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-22529.57C370.12,-22520.8 363.13,-22510.87 356.57,-22501.56"/>
<polygon fill="black" stroke="black" points="359.33,-22499.4 350.71,-22493.24 353.61,-22503.43 359.33,-22499.4"/>
</g>
<!-- layer_3_q_reshape -->
<g id="node132" class="node">
<title>layer_3_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-22403 426.57,-22403 426.57,-22350 650.57,-22350 650.57,-22403"/>
<text text-anchor="middle" x="538.57" y="-22387.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-22372.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-22357.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_q_proj&#45;&gt;layer_3_q_reshape -->
<g id="edge188" class="edge">
<title>layer_3_q_proj&#45;&gt;layer_3_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-22439.57C549.58,-22431.34 547.69,-22422.08 545.89,-22413.28"/>
<polygon fill="black" stroke="black" points="549.27,-22412.34 543.84,-22403.24 542.41,-22413.74 549.27,-22412.34"/>
</g>
<!-- layer_3_k_reshape -->
<g id="node133" class="node">
<title>layer_3_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-22403 668.57,-22403 668.57,-22350 892.57,-22350 892.57,-22403"/>
<text text-anchor="middle" x="780.57" y="-22387.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-22372.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-22357.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_k_proj&#45;&gt;layer_3_k_reshape -->
<g id="edge189" class="edge">
<title>layer_3_k_proj&#45;&gt;layer_3_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-22439.57C780.57,-22431.34 780.57,-22422.08 780.57,-22413.28"/>
<polygon fill="black" stroke="black" points="784.07,-22413.24 780.57,-22403.24 777.07,-22413.24 784.07,-22413.24"/>
</g>
<!-- layer_3_v_reshape -->
<g id="node134" class="node">
<title>layer_3_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-22332 225.57,-22332 225.57,-22279 449.57,-22279 449.57,-22332"/>
<text text-anchor="middle" x="337.57" y="-22316.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-22301.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-22286.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_v_proj&#45;&gt;layer_3_v_reshape -->
<g id="edge190" class="edge">
<title>layer_3_v_proj&#45;&gt;layer_3_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-22439.95C334.2,-22413.61 335.5,-22372.29 336.44,-22342.61"/>
<polygon fill="black" stroke="black" points="339.95,-22342.35 336.76,-22332.25 332.95,-22342.13 339.95,-22342.35"/>
</g>
<!-- layer_3_attn_scores -->
<g id="node135" class="node">
<title>layer_3_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-22261 422.07,-22261 422.07,-22208 655.07,-22208 655.07,-22261"/>
<text text-anchor="middle" x="538.57" y="-22245.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-22230.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-22215.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_q_reshape&#45;&gt;layer_3_attn_scores -->
<g id="edge191" class="edge">
<title>layer_3_q_reshape&#45;&gt;layer_3_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-22349.82C538.57,-22327.72 538.57,-22295.6 538.57,-22271.03"/>
<polygon fill="black" stroke="black" points="542.07,-22271.02 538.57,-22261.02 535.07,-22271.02 542.07,-22271.02"/>
</g>
<!-- layer_3_k_reshape&#45;&gt;layer_3_attn_scores -->
<g id="edge192" class="edge">
<title>layer_3_k_reshape&#45;&gt;layer_3_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-22349.98C695.65,-22326.37 634.91,-22291.23 591.5,-22266.12"/>
<polygon fill="black" stroke="black" points="593.19,-22263.05 582.78,-22261.08 589.68,-22269.11 593.19,-22263.05"/>
</g>
<!-- layer_3_attn_output -->
<g id="node137" class="node">
<title>layer_3_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-22081 229.57,-22081 229.57,-22028 453.57,-22028 453.57,-22081"/>
<text text-anchor="middle" x="341.57" y="-22065.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-22050.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-22035.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_v_reshape&#45;&gt;layer_3_attn_output -->
<g id="edge195" class="edge">
<title>layer_3_v_reshape&#45;&gt;layer_3_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-22278.79C338.7,-22234.13 340.18,-22142.13 341,-22091.27"/>
<polygon fill="black" stroke="black" points="344.5,-22091.12 341.16,-22081.07 337.5,-22091.01 344.5,-22091.12"/>
</g>
<!-- layer_3_attn_weights -->
<g id="node136" class="node">
<title>layer_3_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="631.07,-22171 398.07,-22171 398.07,-22118 631.07,-22118 631.07,-22171"/>
<text text-anchor="middle" x="514.57" y="-22155.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="514.57" y="-22140.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="514.57" y="-22125.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_scores&#45;&gt;layer_3_attn_weights -->
<g id="edge193" class="edge">
<title>layer_3_attn_scores&#45;&gt;layer_3_attn_weights</title>
<path fill="none" stroke="black" d="M531.5,-22207.57C529.23,-22199.25 526.67,-22189.88 524.25,-22180.99"/>
<polygon fill="black" stroke="black" points="527.6,-22179.97 521.59,-22171.24 520.85,-22181.81 527.6,-22179.97"/>
</g>
<!-- layer_3_attn_weights&#45;&gt;layer_3_attn_output -->
<g id="edge194" class="edge">
<title>layer_3_attn_weights&#45;&gt;layer_3_attn_output</title>
<path fill="none" stroke="black" d="M464.07,-22117.81C444.26,-22107.73 421.39,-22096.1 400.81,-22085.63"/>
<polygon fill="black" stroke="black" points="402.34,-22082.48 391.84,-22081.07 399.16,-22088.72 402.34,-22082.48"/>
</g>
<!-- layer_3_attn_reshape -->
<g id="node138" class="node">
<title>layer_3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-21991 236.57,-21991 236.57,-21938 442.57,-21938 442.57,-21991"/>
<text text-anchor="middle" x="339.57" y="-21975.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-21960.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-21945.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_output&#45;&gt;layer_3_attn_reshape -->
<g id="edge196" class="edge">
<title>layer_3_attn_output&#45;&gt;layer_3_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-22027.57C340.79,-22019.34 340.58,-22010.08 340.38,-22001.28"/>
<polygon fill="black" stroke="black" points="343.88,-22001.16 340.16,-21991.24 336.88,-22001.32 343.88,-22001.16"/>
</g>
<!-- layer_3_attn_proj -->
<g id="node139" class="node">
<title>layer_3_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-21901 233.57,-21901 233.57,-21848 439.57,-21848 439.57,-21901"/>
<text text-anchor="middle" x="336.57" y="-21885.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-21870.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-21855.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_reshape&#45;&gt;layer_3_attn_proj -->
<g id="edge197" class="edge">
<title>layer_3_attn_reshape&#45;&gt;layer_3_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-21937.57C338.41,-21929.34 338.09,-21920.08 337.79,-21911.28"/>
<polygon fill="black" stroke="black" points="341.29,-21911.12 337.45,-21901.24 334.29,-21911.36 341.29,-21911.12"/>
</g>
<!-- layer_3_attn_proj&#45;&gt;layer_3_add1 -->
<g id="edge199" class="edge">
<title>layer_3_attn_proj&#45;&gt;layer_3_add1</title>
<path fill="none" stroke="black" d="M300.66,-21847.81C287.15,-21838.14 271.63,-21827.04 257.47,-21816.9"/>
<polygon fill="black" stroke="black" points="259.48,-21814.04 249.31,-21811.07 255.41,-21819.73 259.48,-21814.04"/>
</g>
<!-- layer_3_ln2 -->
<g id="node141" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1078.57,-21721 872.57,-21721 872.57,-21668 1078.57,-21668 1078.57,-21721"/>
<text text-anchor="middle" x="975.57" y="-21705.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="975.57" y="-21690.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="975.57" y="-21675.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_add1&#45;&gt;layer_3_ln2 -->
<g id="edge200" class="edge">
<title>layer_3_add1&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M316.73,-21771.59C459.12,-21755.14 714.96,-21725.6 862.43,-21708.57"/>
<polygon fill="black" stroke="black" points="862.89,-21712.04 872.42,-21707.41 862.09,-21705.08 862.89,-21712.04"/>
</g>
<!-- layer_3_add -->
<g id="node168" class="node">
<title>layer_3_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-21065 110.57,-21065 110.57,-21012 316.57,-21012 316.57,-21065"/>
<text text-anchor="middle" x="213.57" y="-21049.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-21034.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-21019.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_add1&#45;&gt;layer_3_add -->
<g id="edge242" class="edge">
<title>layer_3_add1&#45;&gt;layer_3_add</title>
<path fill="none" stroke="black" d="M208.2,-21757.83C205.01,-21740.34 201.57,-21716.62 201.57,-21695.5 201.57,-21695.5 201.57,-21695.5 201.57,-21154 201.57,-21127.6 204.77,-21097.96 207.86,-21075.46"/>
<polygon fill="black" stroke="black" points="211.35,-21075.73 209.31,-21065.34 204.42,-21074.74 211.35,-21075.73"/>
</g>
<!-- layer_3_gate -->
<g id="node142" class="node">
<title>layer_3_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-21631 900.57,-21578 1079.57,-21525 1258.57,-21578 1079.57,-21631"/>
<text text-anchor="middle" x="1079.57" y="-21589.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-21574.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-21559.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_gate -->
<g id="edge201" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_gate</title>
<path fill="none" stroke="black" d="M998.91,-21667.8C1009.62,-21656.01 1022.7,-21641.62 1035.17,-21627.88"/>
<polygon fill="black" stroke="black" points="1037.89,-21630.1 1042.02,-21620.34 1032.71,-21625.39 1037.89,-21630.1"/>
</g>
<!-- layer_3_expert_0_ffn1 -->
<g id="node143" class="node">
<title>layer_3_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-21478 677.57,-21478 677.57,-21425 883.57,-21425 883.57,-21478"/>
<text text-anchor="middle" x="780.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_0_ffn1 -->
<g id="edge203" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M912.87,-21667.85C894.49,-21658.23 875.37,-21645.93 860.57,-21631 820.76,-21590.84 798.89,-21527.41 788.47,-21487.97"/>
<polygon fill="black" stroke="black" points="791.86,-21487.08 786,-21478.25 785.07,-21488.8 791.86,-21487.08"/>
</g>
<!-- layer_3_expert_1_ffn1 -->
<g id="node146" class="node">
<title>layer_3_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-21478 229.57,-21478 229.57,-21425 435.57,-21425 435.57,-21478"/>
<text text-anchor="middle" x="332.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_1_ffn1 -->
<g id="edge207" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M872.52,-21685.67C800.38,-21677.71 702.78,-21661.94 621.57,-21631 525.58,-21594.43 426.43,-21524.99 372.85,-21484.34"/>
<polygon fill="black" stroke="black" points="374.72,-21481.36 364.65,-21478.07 370.47,-21486.92 374.72,-21481.36"/>
</g>
<!-- layer_3_expert_2_ffn1 -->
<g id="node149" class="node">
<title>layer_3_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-21478 1125.57,-21478 1125.57,-21425 1331.57,-21425 1331.57,-21478"/>
<text text-anchor="middle" x="1228.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_2_ffn1 -->
<g id="edge211" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1078.62,-21684.7C1152.58,-21676.03 1243.31,-21659.79 1267.57,-21631 1306.26,-21585.08 1295.71,-21551.4 1272.57,-21496 1271.12,-21492.52 1269.24,-21489.18 1267.08,-21486.01"/>
<polygon fill="black" stroke="black" points="1269.72,-21483.71 1260.79,-21478.01 1264.22,-21488.03 1269.72,-21483.71"/>
</g>
<!-- layer_3_expert_3_ffn1 -->
<g id="node152" class="node">
<title>layer_3_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-21478 1573.57,-21478 1573.57,-21425 1779.57,-21425 1779.57,-21478"/>
<text text-anchor="middle" x="1676.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_3_ffn1 -->
<g id="edge215" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-21679.51C1135.05,-21671.55 1205.76,-21661 1268.57,-21650 1436.52,-21620.58 1486.34,-21606.83 1624.57,-21507 1633.08,-21500.86 1641.36,-21493.21 1648.73,-21485.6"/>
<polygon fill="black" stroke="black" points="1651.49,-21487.77 1655.76,-21478.07 1646.38,-21482.99 1651.49,-21487.77"/>
</g>
<!-- layer_3_expert_4_ffn1 -->
<g id="node155" class="node">
<title>layer_3_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-21478 453.57,-21478 453.57,-21425 659.57,-21425 659.57,-21478"/>
<text text-anchor="middle" x="556.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_4_ffn1 -->
<g id="edge219" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M888.26,-21667.86C858.25,-21657.83 824.86,-21645.28 795.57,-21631 704.27,-21586.47 680.19,-21573.7 603.57,-21507 596.3,-21500.67 589.15,-21493.21 582.7,-21485.88"/>
<polygon fill="black" stroke="black" points="585.16,-21483.37 576.01,-21478.02 579.83,-21487.91 585.16,-21483.37"/>
</g>
<!-- layer_3_expert_5_ffn1 -->
<g id="node158" class="node">
<title>layer_3_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-21478 1349.57,-21478 1349.57,-21425 1555.57,-21425 1555.57,-21478"/>
<text text-anchor="middle" x="1452.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_5_ffn1 -->
<g id="edge223" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-21684.51C1131.89,-21678.1 1197.09,-21667.43 1253.57,-21650 1272.38,-21644.2 1277.44,-21642.28 1293.57,-21631 1357.95,-21585.96 1370.85,-21568.64 1419.57,-21507 1424.54,-21500.72 1429.34,-21493.63 1433.66,-21486.69"/>
<polygon fill="black" stroke="black" points="1436.7,-21488.43 1438.87,-21478.05 1430.71,-21484.81 1436.7,-21488.43"/>
</g>
<!-- layer_3_expert_6_ffn1 -->
<g id="node161" class="node">
<title>layer_3_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-21478 1797.57,-21478 1797.57,-21425 2003.57,-21425 2003.57,-21478"/>
<text text-anchor="middle" x="1900.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_6_ffn1 -->
<g id="edge227" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1078.84,-21690.17C1185.41,-21684.65 1355.65,-21669.98 1497.57,-21631 1628.04,-21595.16 1770.53,-21523.68 1846.2,-21482.89"/>
<polygon fill="black" stroke="black" points="1847.96,-21485.91 1855.09,-21478.07 1844.63,-21479.75 1847.96,-21485.91"/>
</g>
<!-- layer_3_expert_7_ffn1 -->
<g id="node164" class="node">
<title>layer_3_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-21478 901.57,-21478 901.57,-21425 1107.57,-21425 1107.57,-21478"/>
<text text-anchor="middle" x="1004.57" y="-21462.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-21447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-21432.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_expert_7_ffn1 -->
<g id="edge231" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M926.37,-21667.93C912.71,-21658.29 899.46,-21645.95 891.57,-21631 863.54,-21577.9 852.23,-21545.25 886.57,-21496 889.58,-21491.69 893.06,-21487.8 896.91,-21484.3"/>
<polygon fill="black" stroke="black" points="899.11,-21487.02 904.71,-21478.03 894.73,-21481.56 899.11,-21487.02"/>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_0_ffn1 -->
<g id="edge202" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-21546.54C959.2,-21526.88 898.07,-21501.43 851.32,-21481.96"/>
<polygon fill="black" stroke="black" points="852.45,-21478.64 841.87,-21478.03 849.76,-21485.1 852.45,-21478.64"/>
<text text-anchor="middle" x="924.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_1_ffn1 -->
<g id="edge206" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-21560.72C833.08,-21543.17 630.07,-21513.21 445.54,-21478.14"/>
<polygon fill="black" stroke="black" points="446.13,-21474.69 435.65,-21476.25 444.82,-21481.56 446.13,-21474.69"/>
<text text-anchor="middle" x="623.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_2_ffn1 -->
<g id="edge210" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-21535.47C1129.09,-21522.16 1143.87,-21507.81 1158.57,-21496 1163.82,-21491.78 1169.5,-21487.65 1175.28,-21483.71"/>
<polygon fill="black" stroke="black" points="1177.37,-21486.52 1183.77,-21478.09 1173.5,-21480.68 1177.37,-21486.52"/>
<text text-anchor="middle" x="1180.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_3_ffn1 -->
<g id="edge214" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-21555.7C1263.24,-21539.33 1376.38,-21516.18 1475.57,-21496 1512.26,-21488.54 1523.52,-21486.73 1563.55,-21478.2"/>
<polygon fill="black" stroke="black" points="1564.41,-21481.59 1573.46,-21476.08 1562.94,-21474.75 1564.41,-21481.59"/>
<text text-anchor="middle" x="1497.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_4_ffn1 -->
<g id="edge218" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-21553.8C893.49,-21532.7 762.7,-21501.57 669.53,-21479.39"/>
<polygon fill="black" stroke="black" points="670.33,-21475.98 659.79,-21477.07 668.7,-21482.79 670.33,-21475.98"/>
<text text-anchor="middle" x="792.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_5_ffn1 -->
<g id="edge222" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-21546.6C1193.35,-21530.52 1244.3,-21511.05 1290.57,-21496 1306.78,-21490.73 1324.04,-21485.6 1341.02,-21480.81"/>
<polygon fill="black" stroke="black" points="1342.29,-21484.09 1350.98,-21478.04 1340.41,-21477.35 1342.29,-21484.09"/>
<text text-anchor="middle" x="1312.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_6_ffn1 -->
<g id="edge226" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-21562.57C1346.62,-21545.91 1578.71,-21516.07 1787.57,-21478.13"/>
<polygon fill="black" stroke="black" points="1788.29,-21481.55 1797.5,-21476.31 1787.04,-21474.67 1788.29,-21481.55"/>
<text text-anchor="middle" x="1694.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_3_gate&#45;&gt;layer_3_expert_7_ffn1 -->
<g id="edge230" class="edge">
<title>layer_3_gate&#45;&gt;layer_3_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-21532.76C1043.87,-21517.73 1033.9,-21501.18 1025.37,-21487.03"/>
<polygon fill="black" stroke="black" points="1028.16,-21484.88 1020,-21478.12 1022.17,-21488.49 1028.16,-21484.88"/>
<text text-anchor="middle" x="1056.57" y="-21499" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_3_expert_0_gelu -->
<g id="node144" class="node">
<title>layer_3_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-21388 677.57,-21388 677.57,-21335 883.57,-21335 883.57,-21388"/>
<text text-anchor="middle" x="780.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_0_ffn1&#45;&gt;layer_3_expert_0_gelu -->
<g id="edge204" class="edge">
<title>layer_3_expert_0_ffn1&#45;&gt;layer_3_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-21424.57C780.57,-21416.34 780.57,-21407.08 780.57,-21398.28"/>
<polygon fill="black" stroke="black" points="784.07,-21398.24 780.57,-21388.24 777.07,-21398.24 784.07,-21398.24"/>
</g>
<!-- layer_3_expert_0_ffn2 -->
<g id="node145" class="node">
<title>layer_3_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-21298 677.57,-21298 677.57,-21245 883.57,-21245 883.57,-21298"/>
<text text-anchor="middle" x="780.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_0_gelu&#45;&gt;layer_3_expert_0_ffn2 -->
<g id="edge205" class="edge">
<title>layer_3_expert_0_gelu&#45;&gt;layer_3_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-21334.57C780.57,-21326.34 780.57,-21317.08 780.57,-21308.28"/>
<polygon fill="black" stroke="black" points="784.07,-21308.24 780.57,-21298.24 777.07,-21308.24 784.07,-21308.24"/>
</g>
<!-- layer_3_expert_agg -->
<g id="node167" class="node">
<title>layer_3_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-21208 878.36,-21208 790.93,-21102 1130.79,-21102 1218.21,-21208"/>
<text text-anchor="middle" x="1004.57" y="-21166.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-21151.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-21136.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_0_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge234" class="edge">
<title>layer_3_expert_0_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-21244.95C849.26,-21235.39 871.33,-21224.11 893.35,-21212.85"/>
<polygon fill="black" stroke="black" points="895.14,-21215.87 902.45,-21208.2 891.95,-21209.64 895.14,-21215.87"/>
</g>
<!-- layer_3_expert_1_gelu -->
<g id="node147" class="node">
<title>layer_3_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-21388 229.57,-21388 229.57,-21335 435.57,-21335 435.57,-21388"/>
<text text-anchor="middle" x="332.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_1_ffn1&#45;&gt;layer_3_expert_1_gelu -->
<g id="edge208" class="edge">
<title>layer_3_expert_1_ffn1&#45;&gt;layer_3_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-21424.57C332.57,-21416.34 332.57,-21407.08 332.57,-21398.28"/>
<polygon fill="black" stroke="black" points="336.07,-21398.24 332.57,-21388.24 329.07,-21398.24 336.07,-21398.24"/>
</g>
<!-- layer_3_expert_1_ffn2 -->
<g id="node148" class="node">
<title>layer_3_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-21298 229.57,-21298 229.57,-21245 435.57,-21245 435.57,-21298"/>
<text text-anchor="middle" x="332.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_1_gelu&#45;&gt;layer_3_expert_1_ffn2 -->
<g id="edge209" class="edge">
<title>layer_3_expert_1_gelu&#45;&gt;layer_3_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-21334.57C332.57,-21326.34 332.57,-21317.08 332.57,-21308.28"/>
<polygon fill="black" stroke="black" points="336.07,-21308.24 332.57,-21298.24 329.07,-21308.24 336.07,-21308.24"/>
</g>
<!-- layer_3_expert_1_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge235" class="edge">
<title>layer_3_expert_1_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-21246.76C438.66,-21246.16 441.63,-21245.57 444.57,-21245 578.16,-21219.21 730.72,-21195.32 842.83,-21178.81"/>
<polygon fill="black" stroke="black" points="843.49,-21182.25 852.87,-21177.33 842.47,-21175.32 843.49,-21182.25"/>
</g>
<!-- layer_3_expert_2_gelu -->
<g id="node150" class="node">
<title>layer_3_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-21388 1125.57,-21388 1125.57,-21335 1331.57,-21335 1331.57,-21388"/>
<text text-anchor="middle" x="1228.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_2_ffn1&#45;&gt;layer_3_expert_2_gelu -->
<g id="edge212" class="edge">
<title>layer_3_expert_2_ffn1&#45;&gt;layer_3_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-21424.57C1228.57,-21416.34 1228.57,-21407.08 1228.57,-21398.28"/>
<polygon fill="black" stroke="black" points="1232.07,-21398.24 1228.57,-21388.24 1225.07,-21398.24 1232.07,-21398.24"/>
</g>
<!-- layer_3_expert_2_ffn2 -->
<g id="node151" class="node">
<title>layer_3_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-21298 1125.57,-21298 1125.57,-21245 1331.57,-21245 1331.57,-21298"/>
<text text-anchor="middle" x="1228.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_2_gelu&#45;&gt;layer_3_expert_2_ffn2 -->
<g id="edge213" class="edge">
<title>layer_3_expert_2_gelu&#45;&gt;layer_3_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-21334.57C1228.57,-21326.34 1228.57,-21317.08 1228.57,-21308.28"/>
<polygon fill="black" stroke="black" points="1232.07,-21308.24 1228.57,-21298.24 1225.07,-21308.24 1232.07,-21308.24"/>
</g>
<!-- layer_3_expert_2_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge236" class="edge">
<title>layer_3_expert_2_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-21244.95C1159.88,-21235.39 1137.81,-21224.11 1115.79,-21212.85"/>
<polygon fill="black" stroke="black" points="1117.19,-21209.64 1106.7,-21208.2 1114.01,-21215.87 1117.19,-21209.64"/>
</g>
<!-- layer_3_expert_3_gelu -->
<g id="node153" class="node">
<title>layer_3_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-21388 1573.57,-21388 1573.57,-21335 1779.57,-21335 1779.57,-21388"/>
<text text-anchor="middle" x="1676.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_3_ffn1&#45;&gt;layer_3_expert_3_gelu -->
<g id="edge216" class="edge">
<title>layer_3_expert_3_ffn1&#45;&gt;layer_3_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-21424.57C1676.57,-21416.34 1676.57,-21407.08 1676.57,-21398.28"/>
<polygon fill="black" stroke="black" points="1680.07,-21398.24 1676.57,-21388.24 1673.07,-21398.24 1680.07,-21398.24"/>
</g>
<!-- layer_3_expert_3_ffn2 -->
<g id="node154" class="node">
<title>layer_3_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-21298 1573.57,-21298 1573.57,-21245 1779.57,-21245 1779.57,-21298"/>
<text text-anchor="middle" x="1676.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_3_gelu&#45;&gt;layer_3_expert_3_ffn2 -->
<g id="edge217" class="edge">
<title>layer_3_expert_3_gelu&#45;&gt;layer_3_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-21334.57C1676.57,-21326.34 1676.57,-21317.08 1676.57,-21308.28"/>
<polygon fill="black" stroke="black" points="1680.07,-21308.24 1676.57,-21298.24 1673.07,-21308.24 1680.07,-21308.24"/>
</g>
<!-- layer_3_expert_3_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge237" class="edge">
<title>layer_3_expert_3_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-21246.76C1570.49,-21246.16 1567.51,-21245.57 1564.57,-21245 1446.94,-21222.29 1314.59,-21201.06 1208.1,-21185.03"/>
<polygon fill="black" stroke="black" points="1208.61,-21181.57 1198.21,-21183.54 1207.58,-21188.49 1208.61,-21181.57"/>
</g>
<!-- layer_3_expert_4_gelu -->
<g id="node156" class="node">
<title>layer_3_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-21388 453.57,-21388 453.57,-21335 659.57,-21335 659.57,-21388"/>
<text text-anchor="middle" x="556.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_4_ffn1&#45;&gt;layer_3_expert_4_gelu -->
<g id="edge220" class="edge">
<title>layer_3_expert_4_ffn1&#45;&gt;layer_3_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-21424.57C556.57,-21416.34 556.57,-21407.08 556.57,-21398.28"/>
<polygon fill="black" stroke="black" points="560.07,-21398.24 556.57,-21388.24 553.07,-21398.24 560.07,-21398.24"/>
</g>
<!-- layer_3_expert_4_ffn2 -->
<g id="node157" class="node">
<title>layer_3_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-21298 453.57,-21298 453.57,-21245 659.57,-21245 659.57,-21298"/>
<text text-anchor="middle" x="556.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_4_gelu&#45;&gt;layer_3_expert_4_ffn2 -->
<g id="edge221" class="edge">
<title>layer_3_expert_4_gelu&#45;&gt;layer_3_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-21334.57C556.57,-21326.34 556.57,-21317.08 556.57,-21308.28"/>
<polygon fill="black" stroke="black" points="560.07,-21308.24 556.57,-21298.24 553.07,-21308.24 560.07,-21308.24"/>
</g>
<!-- layer_3_expert_4_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge238" class="edge">
<title>layer_3_expert_4_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-21244.95C714.81,-21230.06 789.41,-21210.99 854.59,-21194.33"/>
<polygon fill="black" stroke="black" points="855.73,-21197.65 864.55,-21191.79 853.99,-21190.87 855.73,-21197.65"/>
</g>
<!-- layer_3_expert_5_gelu -->
<g id="node159" class="node">
<title>layer_3_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-21388 1349.57,-21388 1349.57,-21335 1555.57,-21335 1555.57,-21388"/>
<text text-anchor="middle" x="1452.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_5_ffn1&#45;&gt;layer_3_expert_5_gelu -->
<g id="edge224" class="edge">
<title>layer_3_expert_5_ffn1&#45;&gt;layer_3_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-21424.57C1452.57,-21416.34 1452.57,-21407.08 1452.57,-21398.28"/>
<polygon fill="black" stroke="black" points="1456.07,-21398.24 1452.57,-21388.24 1449.07,-21398.24 1456.07,-21398.24"/>
</g>
<!-- layer_3_expert_5_ffn2 -->
<g id="node160" class="node">
<title>layer_3_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-21298 1349.57,-21298 1349.57,-21245 1555.57,-21245 1555.57,-21298"/>
<text text-anchor="middle" x="1452.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_5_gelu&#45;&gt;layer_3_expert_5_ffn2 -->
<g id="edge225" class="edge">
<title>layer_3_expert_5_gelu&#45;&gt;layer_3_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-21334.57C1452.57,-21326.34 1452.57,-21317.08 1452.57,-21308.28"/>
<polygon fill="black" stroke="black" points="1456.07,-21308.24 1452.57,-21298.24 1449.07,-21308.24 1456.07,-21308.24"/>
</g>
<!-- layer_3_expert_5_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge239" class="edge">
<title>layer_3_expert_5_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-21244.95C1312.66,-21234.74 1265.05,-21222.57 1218.07,-21210.57"/>
<polygon fill="black" stroke="black" points="1218.92,-21207.17 1208.37,-21208.09 1217.19,-21213.95 1218.92,-21207.17"/>
</g>
<!-- layer_3_expert_6_gelu -->
<g id="node162" class="node">
<title>layer_3_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-21388 1797.57,-21388 1797.57,-21335 2003.57,-21335 2003.57,-21388"/>
<text text-anchor="middle" x="1900.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_6_ffn1&#45;&gt;layer_3_expert_6_gelu -->
<g id="edge228" class="edge">
<title>layer_3_expert_6_ffn1&#45;&gt;layer_3_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-21424.57C1900.57,-21416.34 1900.57,-21407.08 1900.57,-21398.28"/>
<polygon fill="black" stroke="black" points="1904.07,-21398.24 1900.57,-21388.24 1897.07,-21398.24 1904.07,-21398.24"/>
</g>
<!-- layer_3_expert_6_ffn2 -->
<g id="node163" class="node">
<title>layer_3_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-21298 1797.57,-21298 1797.57,-21245 2003.57,-21245 2003.57,-21298"/>
<text text-anchor="middle" x="1900.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_6_gelu&#45;&gt;layer_3_expert_6_ffn2 -->
<g id="edge229" class="edge">
<title>layer_3_expert_6_gelu&#45;&gt;layer_3_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-21334.57C1900.57,-21326.34 1900.57,-21317.08 1900.57,-21308.28"/>
<polygon fill="black" stroke="black" points="1904.07,-21308.24 1900.57,-21298.24 1897.07,-21308.24 1904.07,-21308.24"/>
</g>
<!-- layer_3_expert_6_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge240" class="edge">
<title>layer_3_expert_6_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-21246.59C1794.51,-21246.03 1791.52,-21245.5 1788.57,-21245 1588.54,-21210.98 1357.51,-21186.53 1198.33,-21171.97"/>
<polygon fill="black" stroke="black" points="1198.23,-21168.45 1187.95,-21171.03 1197.59,-21175.42 1198.23,-21168.45"/>
</g>
<!-- layer_3_expert_7_gelu -->
<g id="node165" class="node">
<title>layer_3_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-21388 901.57,-21388 901.57,-21335 1107.57,-21335 1107.57,-21388"/>
<text text-anchor="middle" x="1004.57" y="-21372.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-21357.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-21342.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_7_ffn1&#45;&gt;layer_3_expert_7_gelu -->
<g id="edge232" class="edge">
<title>layer_3_expert_7_ffn1&#45;&gt;layer_3_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-21424.57C1004.57,-21416.34 1004.57,-21407.08 1004.57,-21398.28"/>
<polygon fill="black" stroke="black" points="1008.07,-21398.24 1004.57,-21388.24 1001.07,-21398.24 1008.07,-21398.24"/>
</g>
<!-- layer_3_expert_7_ffn2 -->
<g id="node166" class="node">
<title>layer_3_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-21298 901.57,-21298 901.57,-21245 1107.57,-21245 1107.57,-21298"/>
<text text-anchor="middle" x="1004.57" y="-21282.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-21267.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-21252.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_expert_7_gelu&#45;&gt;layer_3_expert_7_ffn2 -->
<g id="edge233" class="edge">
<title>layer_3_expert_7_gelu&#45;&gt;layer_3_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-21334.57C1004.57,-21326.34 1004.57,-21317.08 1004.57,-21308.28"/>
<polygon fill="black" stroke="black" points="1008.07,-21308.24 1004.57,-21298.24 1001.07,-21308.24 1008.07,-21308.24"/>
</g>
<!-- layer_3_expert_7_ffn2&#45;&gt;layer_3_expert_agg -->
<g id="edge241" class="edge">
<title>layer_3_expert_7_ffn2&#45;&gt;layer_3_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-21244.8C1004.57,-21236.86 1004.57,-21227.74 1004.57,-21218.44"/>
<polygon fill="black" stroke="black" points="1008.07,-21218.32 1004.57,-21208.32 1001.07,-21218.32 1008.07,-21218.32"/>
</g>
<!-- layer_3_expert_agg&#45;&gt;layer_3_add -->
<g id="edge243" class="edge">
<title>layer_3_expert_agg&#45;&gt;layer_3_add</title>
<path fill="none" stroke="black" d="M810.56,-21125.92C658.7,-21103.93 452.76,-21074.12 326.73,-21055.88"/>
<polygon fill="black" stroke="black" points="327.07,-21052.39 316.67,-21054.42 326.07,-21059.32 327.07,-21052.39"/>
</g>
<!-- comm_3_4 -->
<g id="node169" class="node">
<title>comm_3_4</title>
<polygon fill="yellow" stroke="black" points="427.21,-20975 87.36,-20975 -0.07,-20869 339.79,-20869 427.21,-20975"/>
<text text-anchor="middle" x="213.57" y="-20933.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-20918.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-20903.3" font-family="Times,serif" font-size="14.00">GPU 3  GPU 4</text>
</g>
<!-- layer_3_add&#45;&gt;comm_3_4 -->
<g id="edge244" class="edge">
<title>layer_3_add&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M213.57,-21011.8C213.57,-21003.86 213.57,-20994.74 213.57,-20985.44"/>
<polygon fill="black" stroke="black" points="217.07,-20985.32 213.57,-20975.32 210.07,-20985.32 217.07,-20985.32"/>
</g>
<!-- layer_4_ln1 -->
<g id="node170" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-20832 291.57,-20832 291.57,-20779 497.57,-20779 497.57,-20832"/>
<text text-anchor="middle" x="394.57" y="-20816.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-20801.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-20786.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- comm_3_4&#45;&gt;layer_4_ln1 -->
<g id="edge245" class="edge">
<title>comm_3_4&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M295.86,-20868.94C312.72,-20858.28 329.97,-20847.37 345.23,-20837.71"/>
<polygon fill="black" stroke="black" points="347.39,-20840.49 353.97,-20832.18 343.65,-20834.57 347.39,-20840.49"/>
</g>
<!-- layer_4_add1 -->
<g id="node182" class="node">
<title>layer_4_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-20060 110.57,-20060 110.57,-20007 316.57,-20007 316.57,-20060"/>
<text text-anchor="middle" x="213.57" y="-20044.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-20029.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-20014.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- comm_3_4&#45;&gt;layer_4_add1 -->
<g id="edge259" class="edge">
<title>comm_3_4&#45;&gt;layer_4_add1</title>
<path fill="none" stroke="black" d="M205.8,-20868.97C203.49,-20849.42 201.57,-20826.99 201.57,-20806.5 201.57,-20806.5 201.57,-20806.5 201.57,-20122.5 201.57,-20105.17 203.88,-20086.1 206.48,-20070.15"/>
<polygon fill="black" stroke="black" points="209.95,-20070.62 208.2,-20060.17 203.05,-20069.43 209.95,-20070.62"/>
</g>
<!-- layer_4_q_proj -->
<g id="node171" class="node">
<title>layer_4_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-20742 453.57,-20742 453.57,-20689 659.57,-20689 659.57,-20742"/>
<text text-anchor="middle" x="556.57" y="-20726.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-20711.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-20696.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_q_proj -->
<g id="edge246" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-20778.81C460.25,-20768.82 481.45,-20757.31 500.58,-20746.91"/>
<polygon fill="black" stroke="black" points="502.38,-20749.92 509.5,-20742.07 499.04,-20743.77 502.38,-20749.92"/>
</g>
<!-- layer_4_k_proj -->
<g id="node172" class="node">
<title>layer_4_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-20742 677.57,-20742 677.57,-20689 883.57,-20689 883.57,-20742"/>
<text text-anchor="middle" x="780.57" y="-20726.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-20711.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-20696.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_k_proj -->
<g id="edge247" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-20780.98C550.11,-20769.04 613.8,-20754.52 667.48,-20742.28"/>
<polygon fill="black" stroke="black" points="668.41,-20745.66 677.38,-20740.02 666.86,-20738.83 668.41,-20745.66"/>
</g>
<!-- layer_4_v_proj -->
<g id="node173" class="node">
<title>layer_4_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-20742 229.57,-20742 229.57,-20689 435.57,-20689 435.57,-20742"/>
<text text-anchor="middle" x="332.57" y="-20726.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-20711.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-20696.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_v_proj -->
<g id="edge248" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-20778.57C370.12,-20769.8 363.13,-20759.87 356.57,-20750.56"/>
<polygon fill="black" stroke="black" points="359.33,-20748.4 350.71,-20742.24 353.61,-20752.43 359.33,-20748.4"/>
</g>
<!-- layer_4_q_reshape -->
<g id="node174" class="node">
<title>layer_4_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-20652 426.57,-20652 426.57,-20599 650.57,-20599 650.57,-20652"/>
<text text-anchor="middle" x="538.57" y="-20636.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-20621.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-20606.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_q_proj&#45;&gt;layer_4_q_reshape -->
<g id="edge249" class="edge">
<title>layer_4_q_proj&#45;&gt;layer_4_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-20688.57C549.58,-20680.34 547.69,-20671.08 545.89,-20662.28"/>
<polygon fill="black" stroke="black" points="549.27,-20661.34 543.84,-20652.24 542.41,-20662.74 549.27,-20661.34"/>
</g>
<!-- layer_4_k_reshape -->
<g id="node175" class="node">
<title>layer_4_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-20652 668.57,-20652 668.57,-20599 892.57,-20599 892.57,-20652"/>
<text text-anchor="middle" x="780.57" y="-20636.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-20621.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-20606.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_k_proj&#45;&gt;layer_4_k_reshape -->
<g id="edge250" class="edge">
<title>layer_4_k_proj&#45;&gt;layer_4_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-20688.57C780.57,-20680.34 780.57,-20671.08 780.57,-20662.28"/>
<polygon fill="black" stroke="black" points="784.07,-20662.24 780.57,-20652.24 777.07,-20662.24 784.07,-20662.24"/>
</g>
<!-- layer_4_v_reshape -->
<g id="node176" class="node">
<title>layer_4_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-20581 225.57,-20581 225.57,-20528 449.57,-20528 449.57,-20581"/>
<text text-anchor="middle" x="337.57" y="-20565.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-20550.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-20535.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_v_proj&#45;&gt;layer_4_v_reshape -->
<g id="edge251" class="edge">
<title>layer_4_v_proj&#45;&gt;layer_4_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-20688.95C334.2,-20662.61 335.5,-20621.29 336.44,-20591.61"/>
<polygon fill="black" stroke="black" points="339.95,-20591.35 336.76,-20581.25 332.95,-20591.13 339.95,-20591.35"/>
</g>
<!-- layer_4_attn_scores -->
<g id="node177" class="node">
<title>layer_4_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-20510 422.07,-20510 422.07,-20457 655.07,-20457 655.07,-20510"/>
<text text-anchor="middle" x="538.57" y="-20494.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-20479.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-20464.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_q_reshape&#45;&gt;layer_4_attn_scores -->
<g id="edge252" class="edge">
<title>layer_4_q_reshape&#45;&gt;layer_4_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-20598.82C538.57,-20576.72 538.57,-20544.6 538.57,-20520.03"/>
<polygon fill="black" stroke="black" points="542.07,-20520.02 538.57,-20510.02 535.07,-20520.02 542.07,-20520.02"/>
</g>
<!-- layer_4_k_reshape&#45;&gt;layer_4_attn_scores -->
<g id="edge253" class="edge">
<title>layer_4_k_reshape&#45;&gt;layer_4_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-20598.98C695.65,-20575.37 634.91,-20540.23 591.5,-20515.12"/>
<polygon fill="black" stroke="black" points="593.19,-20512.05 582.78,-20510.08 589.68,-20518.11 593.19,-20512.05"/>
</g>
<!-- layer_4_attn_output -->
<g id="node179" class="node">
<title>layer_4_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-20330 229.57,-20330 229.57,-20277 453.57,-20277 453.57,-20330"/>
<text text-anchor="middle" x="341.57" y="-20314.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-20299.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-20284.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_v_reshape&#45;&gt;layer_4_attn_output -->
<g id="edge256" class="edge">
<title>layer_4_v_reshape&#45;&gt;layer_4_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-20527.79C338.7,-20483.13 340.18,-20391.13 341,-20340.27"/>
<polygon fill="black" stroke="black" points="344.5,-20340.12 341.16,-20330.07 337.5,-20340.01 344.5,-20340.12"/>
</g>
<!-- layer_4_attn_weights -->
<g id="node178" class="node">
<title>layer_4_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="610.07,-20420 377.07,-20420 377.07,-20367 610.07,-20367 610.07,-20420"/>
<text text-anchor="middle" x="493.57" y="-20404.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="493.57" y="-20389.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="493.57" y="-20374.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_scores&#45;&gt;layer_4_attn_weights -->
<g id="edge254" class="edge">
<title>layer_4_attn_scores&#45;&gt;layer_4_attn_weights</title>
<path fill="none" stroke="black" d="M525.31,-20456.57C520.96,-20448.07 516.06,-20438.48 511.43,-20429.42"/>
<polygon fill="black" stroke="black" points="514.4,-20427.55 506.73,-20420.24 508.17,-20430.74 514.4,-20427.55"/>
</g>
<!-- layer_4_attn_weights&#45;&gt;layer_4_attn_output -->
<g id="edge255" class="edge">
<title>layer_4_attn_weights&#45;&gt;layer_4_attn_output</title>
<path fill="none" stroke="black" d="M449.2,-20366.81C432.18,-20356.96 412.6,-20345.62 394.84,-20335.34"/>
<polygon fill="black" stroke="black" points="396.14,-20332.05 385.74,-20330.07 392.64,-20338.11 396.14,-20332.05"/>
</g>
<!-- layer_4_attn_reshape -->
<g id="node180" class="node">
<title>layer_4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-20240 236.57,-20240 236.57,-20187 442.57,-20187 442.57,-20240"/>
<text text-anchor="middle" x="339.57" y="-20224.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-20209.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-20194.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_output&#45;&gt;layer_4_attn_reshape -->
<g id="edge257" class="edge">
<title>layer_4_attn_output&#45;&gt;layer_4_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-20276.57C340.79,-20268.34 340.58,-20259.08 340.38,-20250.28"/>
<polygon fill="black" stroke="black" points="343.88,-20250.16 340.16,-20240.24 336.88,-20250.32 343.88,-20250.16"/>
</g>
<!-- layer_4_attn_proj -->
<g id="node181" class="node">
<title>layer_4_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-20150 233.57,-20150 233.57,-20097 439.57,-20097 439.57,-20150"/>
<text text-anchor="middle" x="336.57" y="-20134.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-20119.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-20104.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_reshape&#45;&gt;layer_4_attn_proj -->
<g id="edge258" class="edge">
<title>layer_4_attn_reshape&#45;&gt;layer_4_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-20186.57C338.41,-20178.34 338.09,-20169.08 337.79,-20160.28"/>
<polygon fill="black" stroke="black" points="341.29,-20160.12 337.45,-20150.24 334.29,-20160.36 341.29,-20160.12"/>
</g>
<!-- layer_4_attn_proj&#45;&gt;layer_4_add1 -->
<g id="edge260" class="edge">
<title>layer_4_attn_proj&#45;&gt;layer_4_add1</title>
<path fill="none" stroke="black" d="M300.66,-20096.81C287.15,-20087.14 271.63,-20076.04 257.47,-20065.9"/>
<polygon fill="black" stroke="black" points="259.48,-20063.04 249.31,-20060.07 255.41,-20068.73 259.48,-20063.04"/>
</g>
<!-- layer_4_ln2 -->
<g id="node183" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-19970 827.57,-19970 827.57,-19917 1033.57,-19917 1033.57,-19970"/>
<text text-anchor="middle" x="930.57" y="-19954.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-19939.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-19924.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_add1&#45;&gt;layer_4_ln2 -->
<g id="edge261" class="edge">
<title>layer_4_add1&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M316.68,-20019.84C449.47,-20003.55 679.5,-19975.31 817.13,-19958.42"/>
<polygon fill="black" stroke="black" points="817.78,-19961.87 827.28,-19957.18 816.93,-19954.92 817.78,-19961.87"/>
</g>
<!-- layer_4_add -->
<g id="node210" class="node">
<title>layer_4_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-19314 110.57,-19314 110.57,-19261 316.57,-19261 316.57,-19314"/>
<text text-anchor="middle" x="213.57" y="-19298.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-19283.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-19268.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_add1&#45;&gt;layer_4_add -->
<g id="edge303" class="edge">
<title>layer_4_add1&#45;&gt;layer_4_add</title>
<path fill="none" stroke="black" d="M208.2,-20006.83C205.01,-19989.34 201.57,-19965.62 201.57,-19944.5 201.57,-19944.5 201.57,-19944.5 201.57,-19403 201.57,-19376.6 204.77,-19346.96 207.86,-19324.46"/>
<polygon fill="black" stroke="black" points="211.35,-19324.73 209.31,-19314.34 204.42,-19323.74 211.35,-19324.73"/>
</g>
<!-- layer_4_gate -->
<g id="node184" class="node">
<title>layer_4_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-19880 900.57,-19827 1079.57,-19774 1258.57,-19827 1079.57,-19880"/>
<text text-anchor="middle" x="1079.57" y="-19838.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-19823.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-19808.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_gate -->
<g id="edge262" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_gate</title>
<path fill="none" stroke="black" d="M964.01,-19916.8C981.28,-19903.53 1002.83,-19886.97 1022.63,-19871.76"/>
<polygon fill="black" stroke="black" points="1024.9,-19874.43 1030.69,-19865.56 1020.63,-19868.88 1024.9,-19874.43"/>
</g>
<!-- layer_4_expert_0_ffn1 -->
<g id="node185" class="node">
<title>layer_4_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-19727 677.57,-19727 677.57,-19674 883.57,-19674 883.57,-19727"/>
<text text-anchor="middle" x="780.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_0_ffn1 -->
<g id="edge264" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-19916.95C887.23,-19906.28 873.96,-19893.28 863.57,-19880 824.71,-19830.33 817.94,-19814.58 794.57,-19756 792.17,-19749.99 790.08,-19743.43 788.29,-19737.02"/>
<polygon fill="black" stroke="black" points="791.63,-19735.97 785.73,-19727.17 784.85,-19737.72 791.63,-19735.97"/>
</g>
<!-- layer_4_expert_1_ffn1 -->
<g id="node188" class="node">
<title>layer_4_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-19727 229.57,-19727 229.57,-19674 435.57,-19674 435.57,-19727"/>
<text text-anchor="middle" x="332.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_1_ffn1 -->
<g id="edge268" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-19930.27C767.36,-19920.96 691.02,-19905.31 626.57,-19880 529.83,-19842.01 428.72,-19773.16 373.91,-19732.98"/>
<polygon fill="black" stroke="black" points="375.97,-19730.14 365.84,-19727.02 371.81,-19735.78 375.97,-19730.14"/>
</g>
<!-- layer_4_expert_2_ffn1 -->
<g id="node191" class="node">
<title>layer_4_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-19727 1125.57,-19727 1125.57,-19674 1331.57,-19674 1331.57,-19727"/>
<text text-anchor="middle" x="1228.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_2_ffn1 -->
<g id="edge272" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-19937.17C1121.34,-19930.26 1237.52,-19914.69 1267.57,-19880 1306.88,-19834.62 1295.71,-19800.4 1272.57,-19745 1271.12,-19741.52 1269.24,-19738.18 1267.08,-19735.01"/>
<polygon fill="black" stroke="black" points="1269.72,-19732.71 1260.79,-19727.01 1264.22,-19737.03 1269.72,-19732.71"/>
</g>
<!-- layer_4_expert_3_ffn1 -->
<g id="node194" class="node">
<title>layer_4_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-19727 1573.57,-19727 1573.57,-19674 1779.57,-19674 1779.57,-19727"/>
<text text-anchor="middle" x="1676.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_3_ffn1 -->
<g id="edge276" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-19937.82C1122.76,-19931.39 1253.8,-19916.14 1362.57,-19880 1484.83,-19839.38 1520.13,-19831.42 1624.57,-19756 1633.08,-19749.86 1641.36,-19742.21 1648.73,-19734.6"/>
<polygon fill="black" stroke="black" points="1651.49,-19736.77 1655.76,-19727.07 1646.38,-19731.99 1651.49,-19736.77"/>
</g>
<!-- layer_4_expert_4_ffn1 -->
<g id="node197" class="node">
<title>layer_4_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-19727 453.57,-19727 453.57,-19674 659.57,-19674 659.57,-19727"/>
<text text-anchor="middle" x="556.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_4_ffn1 -->
<g id="edge280" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-19916.89C801.11,-19885.58 686.43,-19827.79 603.57,-19756 596.29,-19749.69 589.13,-19742.24 582.68,-19734.9"/>
<polygon fill="black" stroke="black" points="585.14,-19732.39 575.99,-19727.05 579.81,-19736.93 585.14,-19732.39"/>
</g>
<!-- layer_4_expert_5_ffn1 -->
<g id="node200" class="node">
<title>layer_4_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-19727 1349.57,-19727 1349.57,-19674 1555.57,-19674 1555.57,-19727"/>
<text text-anchor="middle" x="1452.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_5_ffn1 -->
<g id="edge284" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-19936.77C1098.02,-19931.2 1181.84,-19920.3 1253.57,-19899 1272.44,-19893.4 1277.44,-19891.28 1293.57,-19880 1357.95,-19834.96 1370.85,-19817.64 1419.57,-19756 1424.54,-19749.72 1429.34,-19742.63 1433.66,-19735.69"/>
<polygon fill="black" stroke="black" points="1436.7,-19737.43 1438.87,-19727.05 1430.71,-19733.81 1436.7,-19737.43"/>
</g>
<!-- layer_4_expert_6_ffn1 -->
<g id="node203" class="node">
<title>layer_4_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-19727 1797.57,-19727 1797.57,-19674 2003.57,-19674 2003.57,-19727"/>
<text text-anchor="middle" x="1900.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_6_ffn1 -->
<g id="edge288" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-19940.36C1147.98,-19935.86 1336.72,-19922.05 1493.57,-19880 1625.52,-19844.63 1769.63,-19772.8 1845.97,-19731.86"/>
<polygon fill="black" stroke="black" points="1847.8,-19734.86 1854.94,-19727.03 1844.47,-19728.69 1847.8,-19734.86"/>
</g>
<!-- layer_4_expert_7_ffn1 -->
<g id="node206" class="node">
<title>layer_4_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-19727 901.57,-19727 901.57,-19674 1107.57,-19674 1107.57,-19727"/>
<text text-anchor="middle" x="1004.57" y="-19711.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-19696.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-19681.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_expert_7_ffn1 -->
<g id="edge292" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-19916.92C903.08,-19906.14 895.6,-19893.08 891.57,-19880 873.88,-19822.62 852.23,-19794.25 886.57,-19745 889.58,-19740.69 893.06,-19736.8 896.91,-19733.3"/>
<polygon fill="black" stroke="black" points="899.11,-19736.02 904.71,-19727.03 894.73,-19730.56 899.11,-19736.02"/>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_0_ffn1 -->
<g id="edge263" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-19795.54C959.2,-19775.88 898.07,-19750.43 851.32,-19730.96"/>
<polygon fill="black" stroke="black" points="852.45,-19727.64 841.87,-19727.03 849.76,-19734.1 852.45,-19727.64"/>
<text text-anchor="middle" x="924.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_1_ffn1 -->
<g id="edge267" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-19809.72C833.08,-19792.17 630.07,-19762.21 445.54,-19727.14"/>
<polygon fill="black" stroke="black" points="446.13,-19723.69 435.65,-19725.25 444.82,-19730.56 446.13,-19723.69"/>
<text text-anchor="middle" x="623.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_2_ffn1 -->
<g id="edge271" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-19784.47C1129.09,-19771.16 1143.87,-19756.81 1158.57,-19745 1163.82,-19740.78 1169.5,-19736.65 1175.28,-19732.71"/>
<polygon fill="black" stroke="black" points="1177.37,-19735.52 1183.77,-19727.09 1173.5,-19729.68 1177.37,-19735.52"/>
<text text-anchor="middle" x="1180.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_3_ffn1 -->
<g id="edge275" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-19804.7C1263.24,-19788.33 1376.38,-19765.18 1475.57,-19745 1512.26,-19737.54 1523.52,-19735.73 1563.55,-19727.2"/>
<polygon fill="black" stroke="black" points="1564.41,-19730.59 1573.46,-19725.08 1562.94,-19723.75 1564.41,-19730.59"/>
<text text-anchor="middle" x="1497.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_4_ffn1 -->
<g id="edge279" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-19802.8C893.49,-19781.7 762.7,-19750.57 669.53,-19728.39"/>
<polygon fill="black" stroke="black" points="670.33,-19724.98 659.79,-19726.07 668.7,-19731.79 670.33,-19724.98"/>
<text text-anchor="middle" x="792.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_5_ffn1 -->
<g id="edge283" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-19795.6C1193.35,-19779.52 1244.3,-19760.05 1290.57,-19745 1306.78,-19739.73 1324.04,-19734.6 1341.02,-19729.81"/>
<polygon fill="black" stroke="black" points="1342.29,-19733.09 1350.98,-19727.04 1340.41,-19726.35 1342.29,-19733.09"/>
<text text-anchor="middle" x="1312.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_6_ffn1 -->
<g id="edge287" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-19811.57C1346.62,-19794.91 1578.71,-19765.07 1787.57,-19727.13"/>
<polygon fill="black" stroke="black" points="1788.29,-19730.55 1797.5,-19725.31 1787.04,-19723.67 1788.29,-19730.55"/>
<text text-anchor="middle" x="1694.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_4_gate&#45;&gt;layer_4_expert_7_ffn1 -->
<g id="edge291" class="edge">
<title>layer_4_gate&#45;&gt;layer_4_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-19781.76C1043.87,-19766.73 1033.9,-19750.18 1025.37,-19736.03"/>
<polygon fill="black" stroke="black" points="1028.16,-19733.88 1020,-19727.12 1022.17,-19737.49 1028.16,-19733.88"/>
<text text-anchor="middle" x="1056.57" y="-19748" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_4_expert_0_gelu -->
<g id="node186" class="node">
<title>layer_4_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-19637 677.57,-19637 677.57,-19584 883.57,-19584 883.57,-19637"/>
<text text-anchor="middle" x="780.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_0_ffn1&#45;&gt;layer_4_expert_0_gelu -->
<g id="edge265" class="edge">
<title>layer_4_expert_0_ffn1&#45;&gt;layer_4_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-19673.57C780.57,-19665.34 780.57,-19656.08 780.57,-19647.28"/>
<polygon fill="black" stroke="black" points="784.07,-19647.24 780.57,-19637.24 777.07,-19647.24 784.07,-19647.24"/>
</g>
<!-- layer_4_expert_0_ffn2 -->
<g id="node187" class="node">
<title>layer_4_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-19547 677.57,-19547 677.57,-19494 883.57,-19494 883.57,-19547"/>
<text text-anchor="middle" x="780.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_0_gelu&#45;&gt;layer_4_expert_0_ffn2 -->
<g id="edge266" class="edge">
<title>layer_4_expert_0_gelu&#45;&gt;layer_4_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-19583.57C780.57,-19575.34 780.57,-19566.08 780.57,-19557.28"/>
<polygon fill="black" stroke="black" points="784.07,-19557.24 780.57,-19547.24 777.07,-19557.24 784.07,-19557.24"/>
</g>
<!-- layer_4_expert_agg -->
<g id="node209" class="node">
<title>layer_4_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-19457 878.36,-19457 790.93,-19351 1130.79,-19351 1218.21,-19457"/>
<text text-anchor="middle" x="1004.57" y="-19415.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-19400.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-19385.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_0_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge295" class="edge">
<title>layer_4_expert_0_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-19493.95C849.26,-19484.39 871.33,-19473.11 893.35,-19461.85"/>
<polygon fill="black" stroke="black" points="895.14,-19464.87 902.45,-19457.2 891.95,-19458.64 895.14,-19464.87"/>
</g>
<!-- layer_4_expert_1_gelu -->
<g id="node189" class="node">
<title>layer_4_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-19637 229.57,-19637 229.57,-19584 435.57,-19584 435.57,-19637"/>
<text text-anchor="middle" x="332.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_1_ffn1&#45;&gt;layer_4_expert_1_gelu -->
<g id="edge269" class="edge">
<title>layer_4_expert_1_ffn1&#45;&gt;layer_4_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-19673.57C332.57,-19665.34 332.57,-19656.08 332.57,-19647.28"/>
<polygon fill="black" stroke="black" points="336.07,-19647.24 332.57,-19637.24 329.07,-19647.24 336.07,-19647.24"/>
</g>
<!-- layer_4_expert_1_ffn2 -->
<g id="node190" class="node">
<title>layer_4_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-19547 229.57,-19547 229.57,-19494 435.57,-19494 435.57,-19547"/>
<text text-anchor="middle" x="332.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_1_gelu&#45;&gt;layer_4_expert_1_ffn2 -->
<g id="edge270" class="edge">
<title>layer_4_expert_1_gelu&#45;&gt;layer_4_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-19583.57C332.57,-19575.34 332.57,-19566.08 332.57,-19557.28"/>
<polygon fill="black" stroke="black" points="336.07,-19557.24 332.57,-19547.24 329.07,-19557.24 336.07,-19557.24"/>
</g>
<!-- layer_4_expert_1_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge296" class="edge">
<title>layer_4_expert_1_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-19495.76C438.66,-19495.16 441.63,-19494.57 444.57,-19494 578.16,-19468.21 730.72,-19444.32 842.83,-19427.81"/>
<polygon fill="black" stroke="black" points="843.49,-19431.25 852.87,-19426.33 842.47,-19424.32 843.49,-19431.25"/>
</g>
<!-- layer_4_expert_2_gelu -->
<g id="node192" class="node">
<title>layer_4_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-19637 1125.57,-19637 1125.57,-19584 1331.57,-19584 1331.57,-19637"/>
<text text-anchor="middle" x="1228.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_2_ffn1&#45;&gt;layer_4_expert_2_gelu -->
<g id="edge273" class="edge">
<title>layer_4_expert_2_ffn1&#45;&gt;layer_4_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-19673.57C1228.57,-19665.34 1228.57,-19656.08 1228.57,-19647.28"/>
<polygon fill="black" stroke="black" points="1232.07,-19647.24 1228.57,-19637.24 1225.07,-19647.24 1232.07,-19647.24"/>
</g>
<!-- layer_4_expert_2_ffn2 -->
<g id="node193" class="node">
<title>layer_4_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-19547 1125.57,-19547 1125.57,-19494 1331.57,-19494 1331.57,-19547"/>
<text text-anchor="middle" x="1228.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_2_gelu&#45;&gt;layer_4_expert_2_ffn2 -->
<g id="edge274" class="edge">
<title>layer_4_expert_2_gelu&#45;&gt;layer_4_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-19583.57C1228.57,-19575.34 1228.57,-19566.08 1228.57,-19557.28"/>
<polygon fill="black" stroke="black" points="1232.07,-19557.24 1228.57,-19547.24 1225.07,-19557.24 1232.07,-19557.24"/>
</g>
<!-- layer_4_expert_2_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge297" class="edge">
<title>layer_4_expert_2_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-19493.95C1159.88,-19484.39 1137.81,-19473.11 1115.79,-19461.85"/>
<polygon fill="black" stroke="black" points="1117.19,-19458.64 1106.7,-19457.2 1114.01,-19464.87 1117.19,-19458.64"/>
</g>
<!-- layer_4_expert_3_gelu -->
<g id="node195" class="node">
<title>layer_4_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-19637 1573.57,-19637 1573.57,-19584 1779.57,-19584 1779.57,-19637"/>
<text text-anchor="middle" x="1676.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_3_ffn1&#45;&gt;layer_4_expert_3_gelu -->
<g id="edge277" class="edge">
<title>layer_4_expert_3_ffn1&#45;&gt;layer_4_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-19673.57C1676.57,-19665.34 1676.57,-19656.08 1676.57,-19647.28"/>
<polygon fill="black" stroke="black" points="1680.07,-19647.24 1676.57,-19637.24 1673.07,-19647.24 1680.07,-19647.24"/>
</g>
<!-- layer_4_expert_3_ffn2 -->
<g id="node196" class="node">
<title>layer_4_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-19547 1573.57,-19547 1573.57,-19494 1779.57,-19494 1779.57,-19547"/>
<text text-anchor="middle" x="1676.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_3_gelu&#45;&gt;layer_4_expert_3_ffn2 -->
<g id="edge278" class="edge">
<title>layer_4_expert_3_gelu&#45;&gt;layer_4_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-19583.57C1676.57,-19575.34 1676.57,-19566.08 1676.57,-19557.28"/>
<polygon fill="black" stroke="black" points="1680.07,-19557.24 1676.57,-19547.24 1673.07,-19557.24 1680.07,-19557.24"/>
</g>
<!-- layer_4_expert_3_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge298" class="edge">
<title>layer_4_expert_3_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-19495.76C1570.49,-19495.16 1567.51,-19494.57 1564.57,-19494 1446.94,-19471.29 1314.59,-19450.06 1208.1,-19434.03"/>
<polygon fill="black" stroke="black" points="1208.61,-19430.57 1198.21,-19432.54 1207.58,-19437.49 1208.61,-19430.57"/>
</g>
<!-- layer_4_expert_4_gelu -->
<g id="node198" class="node">
<title>layer_4_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-19637 453.57,-19637 453.57,-19584 659.57,-19584 659.57,-19637"/>
<text text-anchor="middle" x="556.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_4_ffn1&#45;&gt;layer_4_expert_4_gelu -->
<g id="edge281" class="edge">
<title>layer_4_expert_4_ffn1&#45;&gt;layer_4_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-19673.57C556.57,-19665.34 556.57,-19656.08 556.57,-19647.28"/>
<polygon fill="black" stroke="black" points="560.07,-19647.24 556.57,-19637.24 553.07,-19647.24 560.07,-19647.24"/>
</g>
<!-- layer_4_expert_4_ffn2 -->
<g id="node199" class="node">
<title>layer_4_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-19547 453.57,-19547 453.57,-19494 659.57,-19494 659.57,-19547"/>
<text text-anchor="middle" x="556.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_4_gelu&#45;&gt;layer_4_expert_4_ffn2 -->
<g id="edge282" class="edge">
<title>layer_4_expert_4_gelu&#45;&gt;layer_4_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-19583.57C556.57,-19575.34 556.57,-19566.08 556.57,-19557.28"/>
<polygon fill="black" stroke="black" points="560.07,-19557.24 556.57,-19547.24 553.07,-19557.24 560.07,-19557.24"/>
</g>
<!-- layer_4_expert_4_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge299" class="edge">
<title>layer_4_expert_4_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-19493.95C714.81,-19479.06 789.41,-19459.99 854.59,-19443.33"/>
<polygon fill="black" stroke="black" points="855.73,-19446.65 864.55,-19440.79 853.99,-19439.87 855.73,-19446.65"/>
</g>
<!-- layer_4_expert_5_gelu -->
<g id="node201" class="node">
<title>layer_4_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-19637 1349.57,-19637 1349.57,-19584 1555.57,-19584 1555.57,-19637"/>
<text text-anchor="middle" x="1452.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_5_ffn1&#45;&gt;layer_4_expert_5_gelu -->
<g id="edge285" class="edge">
<title>layer_4_expert_5_ffn1&#45;&gt;layer_4_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-19673.57C1452.57,-19665.34 1452.57,-19656.08 1452.57,-19647.28"/>
<polygon fill="black" stroke="black" points="1456.07,-19647.24 1452.57,-19637.24 1449.07,-19647.24 1456.07,-19647.24"/>
</g>
<!-- layer_4_expert_5_ffn2 -->
<g id="node202" class="node">
<title>layer_4_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-19547 1349.57,-19547 1349.57,-19494 1555.57,-19494 1555.57,-19547"/>
<text text-anchor="middle" x="1452.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_5_gelu&#45;&gt;layer_4_expert_5_ffn2 -->
<g id="edge286" class="edge">
<title>layer_4_expert_5_gelu&#45;&gt;layer_4_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-19583.57C1452.57,-19575.34 1452.57,-19566.08 1452.57,-19557.28"/>
<polygon fill="black" stroke="black" points="1456.07,-19557.24 1452.57,-19547.24 1449.07,-19557.24 1456.07,-19557.24"/>
</g>
<!-- layer_4_expert_5_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge300" class="edge">
<title>layer_4_expert_5_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-19493.95C1312.66,-19483.74 1265.05,-19471.57 1218.07,-19459.57"/>
<polygon fill="black" stroke="black" points="1218.92,-19456.17 1208.37,-19457.09 1217.19,-19462.95 1218.92,-19456.17"/>
</g>
<!-- layer_4_expert_6_gelu -->
<g id="node204" class="node">
<title>layer_4_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-19637 1797.57,-19637 1797.57,-19584 2003.57,-19584 2003.57,-19637"/>
<text text-anchor="middle" x="1900.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_6_ffn1&#45;&gt;layer_4_expert_6_gelu -->
<g id="edge289" class="edge">
<title>layer_4_expert_6_ffn1&#45;&gt;layer_4_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-19673.57C1900.57,-19665.34 1900.57,-19656.08 1900.57,-19647.28"/>
<polygon fill="black" stroke="black" points="1904.07,-19647.24 1900.57,-19637.24 1897.07,-19647.24 1904.07,-19647.24"/>
</g>
<!-- layer_4_expert_6_ffn2 -->
<g id="node205" class="node">
<title>layer_4_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-19547 1797.57,-19547 1797.57,-19494 2003.57,-19494 2003.57,-19547"/>
<text text-anchor="middle" x="1900.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_6_gelu&#45;&gt;layer_4_expert_6_ffn2 -->
<g id="edge290" class="edge">
<title>layer_4_expert_6_gelu&#45;&gt;layer_4_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-19583.57C1900.57,-19575.34 1900.57,-19566.08 1900.57,-19557.28"/>
<polygon fill="black" stroke="black" points="1904.07,-19557.24 1900.57,-19547.24 1897.07,-19557.24 1904.07,-19557.24"/>
</g>
<!-- layer_4_expert_6_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge301" class="edge">
<title>layer_4_expert_6_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-19495.59C1794.51,-19495.03 1791.52,-19494.5 1788.57,-19494 1588.54,-19459.98 1357.51,-19435.53 1198.33,-19420.97"/>
<polygon fill="black" stroke="black" points="1198.23,-19417.45 1187.95,-19420.03 1197.59,-19424.42 1198.23,-19417.45"/>
</g>
<!-- layer_4_expert_7_gelu -->
<g id="node207" class="node">
<title>layer_4_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-19637 901.57,-19637 901.57,-19584 1107.57,-19584 1107.57,-19637"/>
<text text-anchor="middle" x="1004.57" y="-19621.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-19606.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-19591.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_7_ffn1&#45;&gt;layer_4_expert_7_gelu -->
<g id="edge293" class="edge">
<title>layer_4_expert_7_ffn1&#45;&gt;layer_4_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-19673.57C1004.57,-19665.34 1004.57,-19656.08 1004.57,-19647.28"/>
<polygon fill="black" stroke="black" points="1008.07,-19647.24 1004.57,-19637.24 1001.07,-19647.24 1008.07,-19647.24"/>
</g>
<!-- layer_4_expert_7_ffn2 -->
<g id="node208" class="node">
<title>layer_4_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-19547 901.57,-19547 901.57,-19494 1107.57,-19494 1107.57,-19547"/>
<text text-anchor="middle" x="1004.57" y="-19531.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-19516.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-19501.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_expert_7_gelu&#45;&gt;layer_4_expert_7_ffn2 -->
<g id="edge294" class="edge">
<title>layer_4_expert_7_gelu&#45;&gt;layer_4_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-19583.57C1004.57,-19575.34 1004.57,-19566.08 1004.57,-19557.28"/>
<polygon fill="black" stroke="black" points="1008.07,-19557.24 1004.57,-19547.24 1001.07,-19557.24 1008.07,-19557.24"/>
</g>
<!-- layer_4_expert_7_ffn2&#45;&gt;layer_4_expert_agg -->
<g id="edge302" class="edge">
<title>layer_4_expert_7_ffn2&#45;&gt;layer_4_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-19493.8C1004.57,-19485.86 1004.57,-19476.74 1004.57,-19467.44"/>
<polygon fill="black" stroke="black" points="1008.07,-19467.32 1004.57,-19457.32 1001.07,-19467.32 1008.07,-19467.32"/>
</g>
<!-- layer_4_expert_agg&#45;&gt;layer_4_add -->
<g id="edge304" class="edge">
<title>layer_4_expert_agg&#45;&gt;layer_4_add</title>
<path fill="none" stroke="black" d="M810.56,-19374.92C658.7,-19352.93 452.76,-19323.12 326.73,-19304.88"/>
<polygon fill="black" stroke="black" points="327.07,-19301.39 316.67,-19303.42 326.07,-19308.32 327.07,-19301.39"/>
</g>
<!-- comm_4_5 -->
<g id="node211" class="node">
<title>comm_4_5</title>
<polygon fill="yellow" stroke="black" points="427.21,-19224 87.36,-19224 -0.07,-19118 339.79,-19118 427.21,-19224"/>
<text text-anchor="middle" x="213.57" y="-19182.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-19167.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-19152.3" font-family="Times,serif" font-size="14.00">GPU 4  GPU 5</text>
</g>
<!-- layer_4_add&#45;&gt;comm_4_5 -->
<g id="edge305" class="edge">
<title>layer_4_add&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M213.57,-19260.8C213.57,-19252.86 213.57,-19243.74 213.57,-19234.44"/>
<polygon fill="black" stroke="black" points="217.07,-19234.32 213.57,-19224.32 210.07,-19234.32 217.07,-19234.32"/>
</g>
<!-- layer_5_ln1 -->
<g id="node212" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-19081 291.57,-19081 291.57,-19028 497.57,-19028 497.57,-19081"/>
<text text-anchor="middle" x="394.57" y="-19065.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-19050.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-19035.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- comm_4_5&#45;&gt;layer_5_ln1 -->
<g id="edge306" class="edge">
<title>comm_4_5&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M295.86,-19117.94C312.72,-19107.28 329.97,-19096.37 345.23,-19086.71"/>
<polygon fill="black" stroke="black" points="347.39,-19089.49 353.97,-19081.18 343.65,-19083.57 347.39,-19089.49"/>
</g>
<!-- layer_5_add1 -->
<g id="node224" class="node">
<title>layer_5_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-18309 110.57,-18309 110.57,-18256 316.57,-18256 316.57,-18309"/>
<text text-anchor="middle" x="213.57" y="-18293.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-18278.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-18263.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- comm_4_5&#45;&gt;layer_5_add1 -->
<g id="edge320" class="edge">
<title>comm_4_5&#45;&gt;layer_5_add1</title>
<path fill="none" stroke="black" d="M205.8,-19117.97C203.49,-19098.42 201.57,-19075.99 201.57,-19055.5 201.57,-19055.5 201.57,-19055.5 201.57,-18371.5 201.57,-18354.17 203.88,-18335.1 206.48,-18319.15"/>
<polygon fill="black" stroke="black" points="209.95,-18319.62 208.2,-18309.17 203.05,-18318.43 209.95,-18319.62"/>
</g>
<!-- layer_5_q_proj -->
<g id="node213" class="node">
<title>layer_5_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-18991 453.57,-18991 453.57,-18938 659.57,-18938 659.57,-18991"/>
<text text-anchor="middle" x="556.57" y="-18975.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-18960.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-18945.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_q_proj -->
<g id="edge307" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-19027.81C460.25,-19017.82 481.45,-19006.31 500.58,-18995.91"/>
<polygon fill="black" stroke="black" points="502.38,-18998.92 509.5,-18991.07 499.04,-18992.77 502.38,-18998.92"/>
</g>
<!-- layer_5_k_proj -->
<g id="node214" class="node">
<title>layer_5_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-18991 677.57,-18991 677.57,-18938 883.57,-18938 883.57,-18991"/>
<text text-anchor="middle" x="780.57" y="-18975.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-18960.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-18945.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_k_proj -->
<g id="edge308" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-19029.98C550.11,-19018.04 613.8,-19003.52 667.48,-18991.28"/>
<polygon fill="black" stroke="black" points="668.41,-18994.66 677.38,-18989.02 666.86,-18987.83 668.41,-18994.66"/>
</g>
<!-- layer_5_v_proj -->
<g id="node215" class="node">
<title>layer_5_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-18991 229.57,-18991 229.57,-18938 435.57,-18938 435.57,-18991"/>
<text text-anchor="middle" x="332.57" y="-18975.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-18960.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-18945.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_v_proj -->
<g id="edge309" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-19027.57C370.12,-19018.8 363.13,-19008.87 356.57,-18999.56"/>
<polygon fill="black" stroke="black" points="359.33,-18997.4 350.71,-18991.24 353.61,-19001.43 359.33,-18997.4"/>
</g>
<!-- layer_5_q_reshape -->
<g id="node216" class="node">
<title>layer_5_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-18901 426.57,-18901 426.57,-18848 650.57,-18848 650.57,-18901"/>
<text text-anchor="middle" x="538.57" y="-18885.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-18870.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-18855.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_q_proj&#45;&gt;layer_5_q_reshape -->
<g id="edge310" class="edge">
<title>layer_5_q_proj&#45;&gt;layer_5_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-18937.57C549.58,-18929.34 547.69,-18920.08 545.89,-18911.28"/>
<polygon fill="black" stroke="black" points="549.27,-18910.34 543.84,-18901.24 542.41,-18911.74 549.27,-18910.34"/>
</g>
<!-- layer_5_k_reshape -->
<g id="node217" class="node">
<title>layer_5_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-18901 668.57,-18901 668.57,-18848 892.57,-18848 892.57,-18901"/>
<text text-anchor="middle" x="780.57" y="-18885.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-18870.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-18855.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_k_proj&#45;&gt;layer_5_k_reshape -->
<g id="edge311" class="edge">
<title>layer_5_k_proj&#45;&gt;layer_5_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-18937.57C780.57,-18929.34 780.57,-18920.08 780.57,-18911.28"/>
<polygon fill="black" stroke="black" points="784.07,-18911.24 780.57,-18901.24 777.07,-18911.24 784.07,-18911.24"/>
</g>
<!-- layer_5_v_reshape -->
<g id="node218" class="node">
<title>layer_5_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-18830 226.57,-18830 226.57,-18777 450.57,-18777 450.57,-18830"/>
<text text-anchor="middle" x="338.57" y="-18814.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-18799.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-18784.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_v_proj&#45;&gt;layer_5_v_reshape -->
<g id="edge312" class="edge">
<title>layer_5_v_proj&#45;&gt;layer_5_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-18937.95C334.53,-18911.61 336.09,-18870.29 337.21,-18840.61"/>
<polygon fill="black" stroke="black" points="340.72,-18840.37 337.6,-18830.25 333.72,-18840.11 340.72,-18840.37"/>
</g>
<!-- layer_5_attn_scores -->
<g id="node219" class="node">
<title>layer_5_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-18759 422.07,-18759 422.07,-18706 655.07,-18706 655.07,-18759"/>
<text text-anchor="middle" x="538.57" y="-18743.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-18728.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-18713.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_q_reshape&#45;&gt;layer_5_attn_scores -->
<g id="edge313" class="edge">
<title>layer_5_q_reshape&#45;&gt;layer_5_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-18847.82C538.57,-18825.72 538.57,-18793.6 538.57,-18769.03"/>
<polygon fill="black" stroke="black" points="542.07,-18769.02 538.57,-18759.02 535.07,-18769.02 542.07,-18769.02"/>
</g>
<!-- layer_5_k_reshape&#45;&gt;layer_5_attn_scores -->
<g id="edge314" class="edge">
<title>layer_5_k_reshape&#45;&gt;layer_5_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-18847.98C695.65,-18824.37 634.91,-18789.23 591.5,-18764.12"/>
<polygon fill="black" stroke="black" points="593.19,-18761.05 582.78,-18759.08 589.68,-18767.11 593.19,-18761.05"/>
</g>
<!-- layer_5_attn_output -->
<g id="node221" class="node">
<title>layer_5_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-18579 229.57,-18579 229.57,-18526 453.57,-18526 453.57,-18579"/>
<text text-anchor="middle" x="341.57" y="-18563.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-18548.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-18533.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_v_reshape&#45;&gt;layer_5_attn_output -->
<g id="edge317" class="edge">
<title>layer_5_v_reshape&#45;&gt;layer_5_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-18776.79C339.42,-18732.13 340.53,-18640.13 341.14,-18589.27"/>
<polygon fill="black" stroke="black" points="344.64,-18589.11 341.26,-18579.07 337.64,-18589.03 344.64,-18589.11"/>
</g>
<!-- layer_5_attn_weights -->
<g id="node220" class="node">
<title>layer_5_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="616.07,-18669 383.07,-18669 383.07,-18616 616.07,-18616 616.07,-18669"/>
<text text-anchor="middle" x="499.57" y="-18653.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="499.57" y="-18638.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="499.57" y="-18623.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_scores&#45;&gt;layer_5_attn_weights -->
<g id="edge315" class="edge">
<title>layer_5_attn_scores&#45;&gt;layer_5_attn_weights</title>
<path fill="none" stroke="black" d="M527.08,-18705.57C523.31,-18697.07 519.06,-18687.48 515.05,-18678.42"/>
<polygon fill="black" stroke="black" points="518.23,-18676.97 510.98,-18669.24 511.83,-18679.8 518.23,-18676.97"/>
</g>
<!-- layer_5_attn_weights&#45;&gt;layer_5_attn_output -->
<g id="edge316" class="edge">
<title>layer_5_attn_weights&#45;&gt;layer_5_attn_output</title>
<path fill="none" stroke="black" d="M453.45,-18615.81C435.6,-18605.87 415.03,-18594.41 396.43,-18584.05"/>
<polygon fill="black" stroke="black" points="397.92,-18580.88 387.48,-18579.07 394.51,-18586.99 397.92,-18580.88"/>
</g>
<!-- layer_5_attn_reshape -->
<g id="node222" class="node">
<title>layer_5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-18489 236.57,-18489 236.57,-18436 442.57,-18436 442.57,-18489"/>
<text text-anchor="middle" x="339.57" y="-18473.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-18458.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-18443.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_output&#45;&gt;layer_5_attn_reshape -->
<g id="edge318" class="edge">
<title>layer_5_attn_output&#45;&gt;layer_5_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-18525.57C340.79,-18517.34 340.58,-18508.08 340.38,-18499.28"/>
<polygon fill="black" stroke="black" points="343.88,-18499.16 340.16,-18489.24 336.88,-18499.32 343.88,-18499.16"/>
</g>
<!-- layer_5_attn_proj -->
<g id="node223" class="node">
<title>layer_5_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-18399 233.57,-18399 233.57,-18346 439.57,-18346 439.57,-18399"/>
<text text-anchor="middle" x="336.57" y="-18383.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-18368.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-18353.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_reshape&#45;&gt;layer_5_attn_proj -->
<g id="edge319" class="edge">
<title>layer_5_attn_reshape&#45;&gt;layer_5_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-18435.57C338.41,-18427.34 338.09,-18418.08 337.79,-18409.28"/>
<polygon fill="black" stroke="black" points="341.29,-18409.12 337.45,-18399.24 334.29,-18409.36 341.29,-18409.12"/>
</g>
<!-- layer_5_attn_proj&#45;&gt;layer_5_add1 -->
<g id="edge321" class="edge">
<title>layer_5_attn_proj&#45;&gt;layer_5_add1</title>
<path fill="none" stroke="black" d="M300.66,-18345.81C287.15,-18336.14 271.63,-18325.04 257.47,-18314.9"/>
<polygon fill="black" stroke="black" points="259.48,-18312.04 249.31,-18309.07 255.41,-18317.73 259.48,-18312.04"/>
</g>
<!-- layer_5_ln2 -->
<g id="node225" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-18219 827.57,-18219 827.57,-18166 1033.57,-18166 1033.57,-18219"/>
<text text-anchor="middle" x="930.57" y="-18203.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-18188.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-18173.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_add1&#45;&gt;layer_5_ln2 -->
<g id="edge322" class="edge">
<title>layer_5_add1&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M316.68,-18268.84C449.47,-18252.55 679.5,-18224.31 817.13,-18207.42"/>
<polygon fill="black" stroke="black" points="817.78,-18210.87 827.28,-18206.18 816.93,-18203.92 817.78,-18210.87"/>
</g>
<!-- layer_5_add -->
<g id="node252" class="node">
<title>layer_5_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-17563 110.57,-17563 110.57,-17510 316.57,-17510 316.57,-17563"/>
<text text-anchor="middle" x="213.57" y="-17547.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-17532.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-17517.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_add1&#45;&gt;layer_5_add -->
<g id="edge364" class="edge">
<title>layer_5_add1&#45;&gt;layer_5_add</title>
<path fill="none" stroke="black" d="M208.2,-18255.83C205.01,-18238.34 201.57,-18214.62 201.57,-18193.5 201.57,-18193.5 201.57,-18193.5 201.57,-17652 201.57,-17625.6 204.77,-17595.96 207.86,-17573.46"/>
<polygon fill="black" stroke="black" points="211.35,-17573.73 209.31,-17563.34 204.42,-17572.74 211.35,-17573.73"/>
</g>
<!-- layer_5_gate -->
<g id="node226" class="node">
<title>layer_5_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-18129 900.57,-18076 1079.57,-18023 1258.57,-18076 1079.57,-18129"/>
<text text-anchor="middle" x="1079.57" y="-18087.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-18072.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-18057.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_gate -->
<g id="edge323" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_gate</title>
<path fill="none" stroke="black" d="M964.01,-18165.8C981.28,-18152.53 1002.83,-18135.97 1022.63,-18120.76"/>
<polygon fill="black" stroke="black" points="1024.9,-18123.43 1030.69,-18114.56 1020.63,-18117.88 1024.9,-18123.43"/>
</g>
<!-- layer_5_expert_0_ffn1 -->
<g id="node227" class="node">
<title>layer_5_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-17976 677.57,-17976 677.57,-17923 883.57,-17923 883.57,-17976"/>
<text text-anchor="middle" x="780.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_0_ffn1 -->
<g id="edge325" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-18165.95C887.23,-18155.28 873.96,-18142.28 863.57,-18129 824.71,-18079.33 817.94,-18063.58 794.57,-18005 792.17,-17998.99 790.08,-17992.43 788.29,-17986.02"/>
<polygon fill="black" stroke="black" points="791.63,-17984.97 785.73,-17976.17 784.85,-17986.72 791.63,-17984.97"/>
</g>
<!-- layer_5_expert_1_ffn1 -->
<g id="node230" class="node">
<title>layer_5_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-17976 229.57,-17976 229.57,-17923 435.57,-17923 435.57,-17976"/>
<text text-anchor="middle" x="332.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_1_ffn1 -->
<g id="edge329" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-18179.27C767.36,-18169.96 691.02,-18154.31 626.57,-18129 529.83,-18091.01 428.72,-18022.16 373.91,-17981.98"/>
<polygon fill="black" stroke="black" points="375.97,-17979.14 365.84,-17976.02 371.81,-17984.78 375.97,-17979.14"/>
</g>
<!-- layer_5_expert_2_ffn1 -->
<g id="node233" class="node">
<title>layer_5_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-17976 1125.57,-17976 1125.57,-17923 1331.57,-17923 1331.57,-17976"/>
<text text-anchor="middle" x="1228.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_2_ffn1 -->
<g id="edge333" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-18186.17C1121.34,-18179.26 1237.52,-18163.69 1267.57,-18129 1306.88,-18083.62 1295.71,-18049.4 1272.57,-17994 1271.12,-17990.52 1269.24,-17987.18 1267.08,-17984.01"/>
<polygon fill="black" stroke="black" points="1269.72,-17981.71 1260.79,-17976.01 1264.22,-17986.03 1269.72,-17981.71"/>
</g>
<!-- layer_5_expert_3_ffn1 -->
<g id="node236" class="node">
<title>layer_5_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-17976 1573.57,-17976 1573.57,-17923 1779.57,-17923 1779.57,-17976"/>
<text text-anchor="middle" x="1676.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_3_ffn1 -->
<g id="edge337" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-18186.82C1122.76,-18180.39 1253.8,-18165.14 1362.57,-18129 1484.83,-18088.38 1520.13,-18080.42 1624.57,-18005 1633.08,-17998.86 1641.36,-17991.21 1648.73,-17983.6"/>
<polygon fill="black" stroke="black" points="1651.49,-17985.77 1655.76,-17976.07 1646.38,-17980.99 1651.49,-17985.77"/>
</g>
<!-- layer_5_expert_4_ffn1 -->
<g id="node239" class="node">
<title>layer_5_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-17976 453.57,-17976 453.57,-17923 659.57,-17923 659.57,-17976"/>
<text text-anchor="middle" x="556.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_4_ffn1 -->
<g id="edge341" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-18165.89C801.11,-18134.58 686.43,-18076.79 603.57,-18005 596.29,-17998.69 589.13,-17991.24 582.68,-17983.9"/>
<polygon fill="black" stroke="black" points="585.14,-17981.39 575.99,-17976.05 579.81,-17985.93 585.14,-17981.39"/>
</g>
<!-- layer_5_expert_5_ffn1 -->
<g id="node242" class="node">
<title>layer_5_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-17976 1349.57,-17976 1349.57,-17923 1555.57,-17923 1555.57,-17976"/>
<text text-anchor="middle" x="1452.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_5_ffn1 -->
<g id="edge345" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-18185.77C1098.02,-18180.2 1181.84,-18169.3 1253.57,-18148 1272.44,-18142.4 1277.44,-18140.28 1293.57,-18129 1357.95,-18083.96 1370.85,-18066.64 1419.57,-18005 1424.54,-17998.72 1429.34,-17991.63 1433.66,-17984.69"/>
<polygon fill="black" stroke="black" points="1436.7,-17986.43 1438.87,-17976.05 1430.71,-17982.81 1436.7,-17986.43"/>
</g>
<!-- layer_5_expert_6_ffn1 -->
<g id="node245" class="node">
<title>layer_5_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-17976 1797.57,-17976 1797.57,-17923 2003.57,-17923 2003.57,-17976"/>
<text text-anchor="middle" x="1900.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_6_ffn1 -->
<g id="edge349" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-18189.36C1147.98,-18184.86 1336.72,-18171.05 1493.57,-18129 1625.52,-18093.63 1769.63,-18021.8 1845.97,-17980.86"/>
<polygon fill="black" stroke="black" points="1847.8,-17983.86 1854.94,-17976.03 1844.47,-17977.69 1847.8,-17983.86"/>
</g>
<!-- layer_5_expert_7_ffn1 -->
<g id="node248" class="node">
<title>layer_5_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-17976 901.57,-17976 901.57,-17923 1107.57,-17923 1107.57,-17976"/>
<text text-anchor="middle" x="1004.57" y="-17960.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-17945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-17930.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_expert_7_ffn1 -->
<g id="edge353" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-18165.92C903.08,-18155.14 895.6,-18142.08 891.57,-18129 873.88,-18071.62 852.23,-18043.25 886.57,-17994 889.58,-17989.69 893.06,-17985.8 896.91,-17982.3"/>
<polygon fill="black" stroke="black" points="899.11,-17985.02 904.71,-17976.03 894.73,-17979.56 899.11,-17985.02"/>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_0_ffn1 -->
<g id="edge324" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-18044.54C959.2,-18024.88 898.07,-17999.43 851.32,-17979.96"/>
<polygon fill="black" stroke="black" points="852.45,-17976.64 841.87,-17976.03 849.76,-17983.1 852.45,-17976.64"/>
<text text-anchor="middle" x="924.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_1_ffn1 -->
<g id="edge328" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-18058.72C833.08,-18041.17 630.07,-18011.21 445.54,-17976.14"/>
<polygon fill="black" stroke="black" points="446.13,-17972.69 435.65,-17974.25 444.82,-17979.56 446.13,-17972.69"/>
<text text-anchor="middle" x="623.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_2_ffn1 -->
<g id="edge332" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-18033.47C1129.09,-18020.16 1143.87,-18005.81 1158.57,-17994 1163.82,-17989.78 1169.5,-17985.65 1175.28,-17981.71"/>
<polygon fill="black" stroke="black" points="1177.37,-17984.52 1183.77,-17976.09 1173.5,-17978.68 1177.37,-17984.52"/>
<text text-anchor="middle" x="1180.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_3_ffn1 -->
<g id="edge336" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-18053.7C1263.24,-18037.33 1376.38,-18014.18 1475.57,-17994 1512.26,-17986.54 1523.52,-17984.73 1563.55,-17976.2"/>
<polygon fill="black" stroke="black" points="1564.41,-17979.59 1573.46,-17974.08 1562.94,-17972.75 1564.41,-17979.59"/>
<text text-anchor="middle" x="1497.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_4_ffn1 -->
<g id="edge340" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-18051.8C893.49,-18030.7 762.7,-17999.57 669.53,-17977.39"/>
<polygon fill="black" stroke="black" points="670.33,-17973.98 659.79,-17975.07 668.7,-17980.79 670.33,-17973.98"/>
<text text-anchor="middle" x="792.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_5_ffn1 -->
<g id="edge344" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-18044.6C1193.35,-18028.52 1244.3,-18009.05 1290.57,-17994 1306.78,-17988.73 1324.04,-17983.6 1341.02,-17978.81"/>
<polygon fill="black" stroke="black" points="1342.29,-17982.09 1350.98,-17976.04 1340.41,-17975.35 1342.29,-17982.09"/>
<text text-anchor="middle" x="1312.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_6_ffn1 -->
<g id="edge348" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-18060.57C1346.62,-18043.91 1578.71,-18014.07 1787.57,-17976.13"/>
<polygon fill="black" stroke="black" points="1788.29,-17979.55 1797.5,-17974.31 1787.04,-17972.67 1788.29,-17979.55"/>
<text text-anchor="middle" x="1694.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_5_gate&#45;&gt;layer_5_expert_7_ffn1 -->
<g id="edge352" class="edge">
<title>layer_5_gate&#45;&gt;layer_5_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-18030.76C1043.87,-18015.73 1033.9,-17999.18 1025.37,-17985.03"/>
<polygon fill="black" stroke="black" points="1028.16,-17982.88 1020,-17976.12 1022.17,-17986.49 1028.16,-17982.88"/>
<text text-anchor="middle" x="1056.57" y="-17997" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_5_expert_0_gelu -->
<g id="node228" class="node">
<title>layer_5_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-17886 677.57,-17886 677.57,-17833 883.57,-17833 883.57,-17886"/>
<text text-anchor="middle" x="780.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_0_ffn1&#45;&gt;layer_5_expert_0_gelu -->
<g id="edge326" class="edge">
<title>layer_5_expert_0_ffn1&#45;&gt;layer_5_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-17922.57C780.57,-17914.34 780.57,-17905.08 780.57,-17896.28"/>
<polygon fill="black" stroke="black" points="784.07,-17896.24 780.57,-17886.24 777.07,-17896.24 784.07,-17896.24"/>
</g>
<!-- layer_5_expert_0_ffn2 -->
<g id="node229" class="node">
<title>layer_5_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-17796 677.57,-17796 677.57,-17743 883.57,-17743 883.57,-17796"/>
<text text-anchor="middle" x="780.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_0_gelu&#45;&gt;layer_5_expert_0_ffn2 -->
<g id="edge327" class="edge">
<title>layer_5_expert_0_gelu&#45;&gt;layer_5_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-17832.57C780.57,-17824.34 780.57,-17815.08 780.57,-17806.28"/>
<polygon fill="black" stroke="black" points="784.07,-17806.24 780.57,-17796.24 777.07,-17806.24 784.07,-17806.24"/>
</g>
<!-- layer_5_expert_agg -->
<g id="node251" class="node">
<title>layer_5_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-17706 878.36,-17706 790.93,-17600 1130.79,-17600 1218.21,-17706"/>
<text text-anchor="middle" x="1004.57" y="-17664.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-17649.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-17634.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_0_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge356" class="edge">
<title>layer_5_expert_0_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-17742.95C849.26,-17733.39 871.33,-17722.11 893.35,-17710.85"/>
<polygon fill="black" stroke="black" points="895.14,-17713.87 902.45,-17706.2 891.95,-17707.64 895.14,-17713.87"/>
</g>
<!-- layer_5_expert_1_gelu -->
<g id="node231" class="node">
<title>layer_5_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-17886 229.57,-17886 229.57,-17833 435.57,-17833 435.57,-17886"/>
<text text-anchor="middle" x="332.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_1_ffn1&#45;&gt;layer_5_expert_1_gelu -->
<g id="edge330" class="edge">
<title>layer_5_expert_1_ffn1&#45;&gt;layer_5_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-17922.57C332.57,-17914.34 332.57,-17905.08 332.57,-17896.28"/>
<polygon fill="black" stroke="black" points="336.07,-17896.24 332.57,-17886.24 329.07,-17896.24 336.07,-17896.24"/>
</g>
<!-- layer_5_expert_1_ffn2 -->
<g id="node232" class="node">
<title>layer_5_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-17796 229.57,-17796 229.57,-17743 435.57,-17743 435.57,-17796"/>
<text text-anchor="middle" x="332.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_1_gelu&#45;&gt;layer_5_expert_1_ffn2 -->
<g id="edge331" class="edge">
<title>layer_5_expert_1_gelu&#45;&gt;layer_5_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-17832.57C332.57,-17824.34 332.57,-17815.08 332.57,-17806.28"/>
<polygon fill="black" stroke="black" points="336.07,-17806.24 332.57,-17796.24 329.07,-17806.24 336.07,-17806.24"/>
</g>
<!-- layer_5_expert_1_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge357" class="edge">
<title>layer_5_expert_1_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-17744.76C438.66,-17744.16 441.63,-17743.57 444.57,-17743 578.16,-17717.21 730.72,-17693.32 842.83,-17676.81"/>
<polygon fill="black" stroke="black" points="843.49,-17680.25 852.87,-17675.33 842.47,-17673.32 843.49,-17680.25"/>
</g>
<!-- layer_5_expert_2_gelu -->
<g id="node234" class="node">
<title>layer_5_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-17886 1125.57,-17886 1125.57,-17833 1331.57,-17833 1331.57,-17886"/>
<text text-anchor="middle" x="1228.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_2_ffn1&#45;&gt;layer_5_expert_2_gelu -->
<g id="edge334" class="edge">
<title>layer_5_expert_2_ffn1&#45;&gt;layer_5_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-17922.57C1228.57,-17914.34 1228.57,-17905.08 1228.57,-17896.28"/>
<polygon fill="black" stroke="black" points="1232.07,-17896.24 1228.57,-17886.24 1225.07,-17896.24 1232.07,-17896.24"/>
</g>
<!-- layer_5_expert_2_ffn2 -->
<g id="node235" class="node">
<title>layer_5_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-17796 1125.57,-17796 1125.57,-17743 1331.57,-17743 1331.57,-17796"/>
<text text-anchor="middle" x="1228.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_2_gelu&#45;&gt;layer_5_expert_2_ffn2 -->
<g id="edge335" class="edge">
<title>layer_5_expert_2_gelu&#45;&gt;layer_5_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-17832.57C1228.57,-17824.34 1228.57,-17815.08 1228.57,-17806.28"/>
<polygon fill="black" stroke="black" points="1232.07,-17806.24 1228.57,-17796.24 1225.07,-17806.24 1232.07,-17806.24"/>
</g>
<!-- layer_5_expert_2_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge358" class="edge">
<title>layer_5_expert_2_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-17742.95C1159.88,-17733.39 1137.81,-17722.11 1115.79,-17710.85"/>
<polygon fill="black" stroke="black" points="1117.19,-17707.64 1106.7,-17706.2 1114.01,-17713.87 1117.19,-17707.64"/>
</g>
<!-- layer_5_expert_3_gelu -->
<g id="node237" class="node">
<title>layer_5_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-17886 1573.57,-17886 1573.57,-17833 1779.57,-17833 1779.57,-17886"/>
<text text-anchor="middle" x="1676.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_3_ffn1&#45;&gt;layer_5_expert_3_gelu -->
<g id="edge338" class="edge">
<title>layer_5_expert_3_ffn1&#45;&gt;layer_5_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-17922.57C1676.57,-17914.34 1676.57,-17905.08 1676.57,-17896.28"/>
<polygon fill="black" stroke="black" points="1680.07,-17896.24 1676.57,-17886.24 1673.07,-17896.24 1680.07,-17896.24"/>
</g>
<!-- layer_5_expert_3_ffn2 -->
<g id="node238" class="node">
<title>layer_5_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-17796 1573.57,-17796 1573.57,-17743 1779.57,-17743 1779.57,-17796"/>
<text text-anchor="middle" x="1676.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_3_gelu&#45;&gt;layer_5_expert_3_ffn2 -->
<g id="edge339" class="edge">
<title>layer_5_expert_3_gelu&#45;&gt;layer_5_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-17832.57C1676.57,-17824.34 1676.57,-17815.08 1676.57,-17806.28"/>
<polygon fill="black" stroke="black" points="1680.07,-17806.24 1676.57,-17796.24 1673.07,-17806.24 1680.07,-17806.24"/>
</g>
<!-- layer_5_expert_3_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge359" class="edge">
<title>layer_5_expert_3_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-17744.76C1570.49,-17744.16 1567.51,-17743.57 1564.57,-17743 1446.94,-17720.29 1314.59,-17699.06 1208.1,-17683.03"/>
<polygon fill="black" stroke="black" points="1208.61,-17679.57 1198.21,-17681.54 1207.58,-17686.49 1208.61,-17679.57"/>
</g>
<!-- layer_5_expert_4_gelu -->
<g id="node240" class="node">
<title>layer_5_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-17886 453.57,-17886 453.57,-17833 659.57,-17833 659.57,-17886"/>
<text text-anchor="middle" x="556.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_4_ffn1&#45;&gt;layer_5_expert_4_gelu -->
<g id="edge342" class="edge">
<title>layer_5_expert_4_ffn1&#45;&gt;layer_5_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-17922.57C556.57,-17914.34 556.57,-17905.08 556.57,-17896.28"/>
<polygon fill="black" stroke="black" points="560.07,-17896.24 556.57,-17886.24 553.07,-17896.24 560.07,-17896.24"/>
</g>
<!-- layer_5_expert_4_ffn2 -->
<g id="node241" class="node">
<title>layer_5_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-17796 453.57,-17796 453.57,-17743 659.57,-17743 659.57,-17796"/>
<text text-anchor="middle" x="556.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_4_gelu&#45;&gt;layer_5_expert_4_ffn2 -->
<g id="edge343" class="edge">
<title>layer_5_expert_4_gelu&#45;&gt;layer_5_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-17832.57C556.57,-17824.34 556.57,-17815.08 556.57,-17806.28"/>
<polygon fill="black" stroke="black" points="560.07,-17806.24 556.57,-17796.24 553.07,-17806.24 560.07,-17806.24"/>
</g>
<!-- layer_5_expert_4_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge360" class="edge">
<title>layer_5_expert_4_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-17742.95C714.81,-17728.06 789.41,-17708.99 854.59,-17692.33"/>
<polygon fill="black" stroke="black" points="855.73,-17695.65 864.55,-17689.79 853.99,-17688.87 855.73,-17695.65"/>
</g>
<!-- layer_5_expert_5_gelu -->
<g id="node243" class="node">
<title>layer_5_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-17886 1349.57,-17886 1349.57,-17833 1555.57,-17833 1555.57,-17886"/>
<text text-anchor="middle" x="1452.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_5_ffn1&#45;&gt;layer_5_expert_5_gelu -->
<g id="edge346" class="edge">
<title>layer_5_expert_5_ffn1&#45;&gt;layer_5_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-17922.57C1452.57,-17914.34 1452.57,-17905.08 1452.57,-17896.28"/>
<polygon fill="black" stroke="black" points="1456.07,-17896.24 1452.57,-17886.24 1449.07,-17896.24 1456.07,-17896.24"/>
</g>
<!-- layer_5_expert_5_ffn2 -->
<g id="node244" class="node">
<title>layer_5_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-17796 1349.57,-17796 1349.57,-17743 1555.57,-17743 1555.57,-17796"/>
<text text-anchor="middle" x="1452.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_5_gelu&#45;&gt;layer_5_expert_5_ffn2 -->
<g id="edge347" class="edge">
<title>layer_5_expert_5_gelu&#45;&gt;layer_5_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-17832.57C1452.57,-17824.34 1452.57,-17815.08 1452.57,-17806.28"/>
<polygon fill="black" stroke="black" points="1456.07,-17806.24 1452.57,-17796.24 1449.07,-17806.24 1456.07,-17806.24"/>
</g>
<!-- layer_5_expert_5_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge361" class="edge">
<title>layer_5_expert_5_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-17742.95C1312.66,-17732.74 1265.05,-17720.57 1218.07,-17708.57"/>
<polygon fill="black" stroke="black" points="1218.92,-17705.17 1208.37,-17706.09 1217.19,-17711.95 1218.92,-17705.17"/>
</g>
<!-- layer_5_expert_6_gelu -->
<g id="node246" class="node">
<title>layer_5_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-17886 1797.57,-17886 1797.57,-17833 2003.57,-17833 2003.57,-17886"/>
<text text-anchor="middle" x="1900.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_6_ffn1&#45;&gt;layer_5_expert_6_gelu -->
<g id="edge350" class="edge">
<title>layer_5_expert_6_ffn1&#45;&gt;layer_5_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-17922.57C1900.57,-17914.34 1900.57,-17905.08 1900.57,-17896.28"/>
<polygon fill="black" stroke="black" points="1904.07,-17896.24 1900.57,-17886.24 1897.07,-17896.24 1904.07,-17896.24"/>
</g>
<!-- layer_5_expert_6_ffn2 -->
<g id="node247" class="node">
<title>layer_5_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-17796 1797.57,-17796 1797.57,-17743 2003.57,-17743 2003.57,-17796"/>
<text text-anchor="middle" x="1900.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_6_gelu&#45;&gt;layer_5_expert_6_ffn2 -->
<g id="edge351" class="edge">
<title>layer_5_expert_6_gelu&#45;&gt;layer_5_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-17832.57C1900.57,-17824.34 1900.57,-17815.08 1900.57,-17806.28"/>
<polygon fill="black" stroke="black" points="1904.07,-17806.24 1900.57,-17796.24 1897.07,-17806.24 1904.07,-17806.24"/>
</g>
<!-- layer_5_expert_6_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge362" class="edge">
<title>layer_5_expert_6_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-17744.59C1794.51,-17744.03 1791.52,-17743.5 1788.57,-17743 1588.54,-17708.98 1357.51,-17684.53 1198.33,-17669.97"/>
<polygon fill="black" stroke="black" points="1198.23,-17666.45 1187.95,-17669.03 1197.59,-17673.42 1198.23,-17666.45"/>
</g>
<!-- layer_5_expert_7_gelu -->
<g id="node249" class="node">
<title>layer_5_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-17886 901.57,-17886 901.57,-17833 1107.57,-17833 1107.57,-17886"/>
<text text-anchor="middle" x="1004.57" y="-17870.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-17855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-17840.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_7_ffn1&#45;&gt;layer_5_expert_7_gelu -->
<g id="edge354" class="edge">
<title>layer_5_expert_7_ffn1&#45;&gt;layer_5_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-17922.57C1004.57,-17914.34 1004.57,-17905.08 1004.57,-17896.28"/>
<polygon fill="black" stroke="black" points="1008.07,-17896.24 1004.57,-17886.24 1001.07,-17896.24 1008.07,-17896.24"/>
</g>
<!-- layer_5_expert_7_ffn2 -->
<g id="node250" class="node">
<title>layer_5_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-17796 901.57,-17796 901.57,-17743 1107.57,-17743 1107.57,-17796"/>
<text text-anchor="middle" x="1004.57" y="-17780.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-17765.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-17750.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_expert_7_gelu&#45;&gt;layer_5_expert_7_ffn2 -->
<g id="edge355" class="edge">
<title>layer_5_expert_7_gelu&#45;&gt;layer_5_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-17832.57C1004.57,-17824.34 1004.57,-17815.08 1004.57,-17806.28"/>
<polygon fill="black" stroke="black" points="1008.07,-17806.24 1004.57,-17796.24 1001.07,-17806.24 1008.07,-17806.24"/>
</g>
<!-- layer_5_expert_7_ffn2&#45;&gt;layer_5_expert_agg -->
<g id="edge363" class="edge">
<title>layer_5_expert_7_ffn2&#45;&gt;layer_5_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-17742.8C1004.57,-17734.86 1004.57,-17725.74 1004.57,-17716.44"/>
<polygon fill="black" stroke="black" points="1008.07,-17716.32 1004.57,-17706.32 1001.07,-17716.32 1008.07,-17716.32"/>
</g>
<!-- layer_5_expert_agg&#45;&gt;layer_5_add -->
<g id="edge365" class="edge">
<title>layer_5_expert_agg&#45;&gt;layer_5_add</title>
<path fill="none" stroke="black" d="M810.56,-17623.92C658.7,-17601.93 452.76,-17572.12 326.73,-17553.88"/>
<polygon fill="black" stroke="black" points="327.07,-17550.39 316.67,-17552.42 326.07,-17557.32 327.07,-17550.39"/>
</g>
<!-- comm_5_6 -->
<g id="node253" class="node">
<title>comm_5_6</title>
<polygon fill="yellow" stroke="black" points="427.21,-17473 87.36,-17473 -0.07,-17367 339.79,-17367 427.21,-17473"/>
<text text-anchor="middle" x="213.57" y="-17431.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-17416.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-17401.3" font-family="Times,serif" font-size="14.00">GPU 5  GPU 6</text>
</g>
<!-- layer_5_add&#45;&gt;comm_5_6 -->
<g id="edge366" class="edge">
<title>layer_5_add&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M213.57,-17509.8C213.57,-17501.86 213.57,-17492.74 213.57,-17483.44"/>
<polygon fill="black" stroke="black" points="217.07,-17483.32 213.57,-17473.32 210.07,-17483.32 217.07,-17483.32"/>
</g>
<!-- layer_6_ln1 -->
<g id="node254" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightcoral" stroke="black" points="552.57,-17330 346.57,-17330 346.57,-17277 552.57,-17277 552.57,-17330"/>
<text text-anchor="middle" x="449.57" y="-17314.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="449.57" y="-17299.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="449.57" y="-17284.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- comm_5_6&#45;&gt;layer_6_ln1 -->
<g id="edge367" class="edge">
<title>comm_5_6&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M320.87,-17366.94C343.78,-17355.83 367.24,-17344.45 387.74,-17334.5"/>
<polygon fill="black" stroke="black" points="389.47,-17337.55 396.94,-17330.03 386.42,-17331.25 389.47,-17337.55"/>
</g>
<!-- layer_6_add1 -->
<g id="node266" class="node">
<title>layer_6_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-16558 110.57,-16558 110.57,-16505 316.57,-16505 316.57,-16558"/>
<text text-anchor="middle" x="213.57" y="-16542.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-16527.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-16512.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- comm_5_6&#45;&gt;layer_6_add1 -->
<g id="edge381" class="edge">
<title>comm_5_6&#45;&gt;layer_6_add1</title>
<path fill="none" stroke="black" d="M205.8,-17366.97C203.49,-17347.42 201.57,-17324.99 201.57,-17304.5 201.57,-17304.5 201.57,-17304.5 201.57,-16620.5 201.57,-16603.17 203.88,-16584.1 206.48,-16568.15"/>
<polygon fill="black" stroke="black" points="209.95,-16568.62 208.2,-16558.17 203.05,-16567.43 209.95,-16568.62"/>
</g>
<!-- layer_6_q_proj -->
<g id="node255" class="node">
<title>layer_6_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-17240 453.57,-17240 453.57,-17187 659.57,-17187 659.57,-17240"/>
<text text-anchor="middle" x="556.57" y="-17224.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-17209.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-17194.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_q_proj -->
<g id="edge368" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_q_proj</title>
<path fill="none" stroke="black" d="M480.81,-17276.81C492.34,-17267.32 505.56,-17256.45 517.69,-17246.47"/>
<polygon fill="black" stroke="black" points="519.98,-17249.12 525.48,-17240.07 515.53,-17243.72 519.98,-17249.12"/>
</g>
<!-- layer_6_k_proj -->
<g id="node256" class="node">
<title>layer_6_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-17240 677.57,-17240 677.57,-17187 883.57,-17187 883.57,-17240"/>
<text text-anchor="middle" x="780.57" y="-17224.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-17209.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-17194.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_k_proj -->
<g id="edge369" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_k_proj</title>
<path fill="none" stroke="black" d="M545.75,-17276.93C586.13,-17266.19 633.23,-17253.67 674.6,-17242.67"/>
<polygon fill="black" stroke="black" points="675.67,-17246.01 684.43,-17240.06 673.87,-17239.25 675.67,-17246.01"/>
</g>
<!-- layer_6_v_proj -->
<g id="node257" class="node">
<title>layer_6_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-17240 229.57,-17240 229.57,-17187 435.57,-17187 435.57,-17240"/>
<text text-anchor="middle" x="332.57" y="-17224.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-17209.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-17194.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_v_proj -->
<g id="edge370" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_v_proj</title>
<path fill="none" stroke="black" d="M415.42,-17276.81C402.68,-17267.23 388.07,-17256.24 374.7,-17246.19"/>
<polygon fill="black" stroke="black" points="376.66,-17243.28 366.57,-17240.07 372.46,-17248.88 376.66,-17243.28"/>
</g>
<!-- layer_6_q_reshape -->
<g id="node258" class="node">
<title>layer_6_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-17150 426.57,-17150 426.57,-17097 650.57,-17097 650.57,-17150"/>
<text text-anchor="middle" x="538.57" y="-17134.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-17119.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-17104.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_q_proj&#45;&gt;layer_6_q_reshape -->
<g id="edge371" class="edge">
<title>layer_6_q_proj&#45;&gt;layer_6_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-17186.57C549.58,-17178.34 547.69,-17169.08 545.89,-17160.28"/>
<polygon fill="black" stroke="black" points="549.27,-17159.34 543.84,-17150.24 542.41,-17160.74 549.27,-17159.34"/>
</g>
<!-- layer_6_k_reshape -->
<g id="node259" class="node">
<title>layer_6_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-17150 668.57,-17150 668.57,-17097 892.57,-17097 892.57,-17150"/>
<text text-anchor="middle" x="780.57" y="-17134.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-17119.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-17104.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_k_proj&#45;&gt;layer_6_k_reshape -->
<g id="edge372" class="edge">
<title>layer_6_k_proj&#45;&gt;layer_6_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-17186.57C780.57,-17178.34 780.57,-17169.08 780.57,-17160.28"/>
<polygon fill="black" stroke="black" points="784.07,-17160.24 780.57,-17150.24 777.07,-17160.24 784.07,-17160.24"/>
</g>
<!-- layer_6_v_reshape -->
<g id="node260" class="node">
<title>layer_6_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-17079 225.57,-17079 225.57,-17026 449.57,-17026 449.57,-17079"/>
<text text-anchor="middle" x="337.57" y="-17063.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-17048.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-17033.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_v_proj&#45;&gt;layer_6_v_reshape -->
<g id="edge373" class="edge">
<title>layer_6_v_proj&#45;&gt;layer_6_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-17186.95C334.2,-17160.61 335.5,-17119.29 336.44,-17089.61"/>
<polygon fill="black" stroke="black" points="339.95,-17089.35 336.76,-17079.25 332.95,-17089.13 339.95,-17089.35"/>
</g>
<!-- layer_6_attn_scores -->
<g id="node261" class="node">
<title>layer_6_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-17008 422.07,-17008 422.07,-16955 655.07,-16955 655.07,-17008"/>
<text text-anchor="middle" x="538.57" y="-16992.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-16977.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-16962.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_q_reshape&#45;&gt;layer_6_attn_scores -->
<g id="edge374" class="edge">
<title>layer_6_q_reshape&#45;&gt;layer_6_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-17096.82C538.57,-17074.72 538.57,-17042.6 538.57,-17018.03"/>
<polygon fill="black" stroke="black" points="542.07,-17018.02 538.57,-17008.02 535.07,-17018.02 542.07,-17018.02"/>
</g>
<!-- layer_6_k_reshape&#45;&gt;layer_6_attn_scores -->
<g id="edge375" class="edge">
<title>layer_6_k_reshape&#45;&gt;layer_6_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-17096.98C695.65,-17073.37 634.91,-17038.23 591.5,-17013.12"/>
<polygon fill="black" stroke="black" points="593.19,-17010.05 582.78,-17008.08 589.68,-17016.11 593.19,-17010.05"/>
</g>
<!-- layer_6_attn_output -->
<g id="node263" class="node">
<title>layer_6_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-16828 229.57,-16828 229.57,-16775 453.57,-16775 453.57,-16828"/>
<text text-anchor="middle" x="341.57" y="-16812.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-16797.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-16782.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_v_reshape&#45;&gt;layer_6_attn_output -->
<g id="edge378" class="edge">
<title>layer_6_v_reshape&#45;&gt;layer_6_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-17025.79C338.7,-16981.13 340.18,-16889.13 341,-16838.27"/>
<polygon fill="black" stroke="black" points="344.5,-16838.12 341.16,-16828.07 337.5,-16838.01 344.5,-16838.12"/>
</g>
<!-- layer_6_attn_weights -->
<g id="node262" class="node">
<title>layer_6_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="616.07,-16918 383.07,-16918 383.07,-16865 616.07,-16865 616.07,-16918"/>
<text text-anchor="middle" x="499.57" y="-16902.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="499.57" y="-16887.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="499.57" y="-16872.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_scores&#45;&gt;layer_6_attn_weights -->
<g id="edge376" class="edge">
<title>layer_6_attn_scores&#45;&gt;layer_6_attn_weights</title>
<path fill="none" stroke="black" d="M527.08,-16954.57C523.31,-16946.07 519.06,-16936.48 515.05,-16927.42"/>
<polygon fill="black" stroke="black" points="518.23,-16925.97 510.98,-16918.24 511.83,-16928.8 518.23,-16925.97"/>
</g>
<!-- layer_6_attn_weights&#45;&gt;layer_6_attn_output -->
<g id="edge377" class="edge">
<title>layer_6_attn_weights&#45;&gt;layer_6_attn_output</title>
<path fill="none" stroke="black" d="M453.45,-16864.81C435.6,-16854.87 415.03,-16843.41 396.43,-16833.05"/>
<polygon fill="black" stroke="black" points="397.92,-16829.88 387.48,-16828.07 394.51,-16835.99 397.92,-16829.88"/>
</g>
<!-- layer_6_attn_reshape -->
<g id="node264" class="node">
<title>layer_6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-16738 236.57,-16738 236.57,-16685 442.57,-16685 442.57,-16738"/>
<text text-anchor="middle" x="339.57" y="-16722.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-16707.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-16692.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_output&#45;&gt;layer_6_attn_reshape -->
<g id="edge379" class="edge">
<title>layer_6_attn_output&#45;&gt;layer_6_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-16774.57C340.79,-16766.34 340.58,-16757.08 340.38,-16748.28"/>
<polygon fill="black" stroke="black" points="343.88,-16748.16 340.16,-16738.24 336.88,-16748.32 343.88,-16748.16"/>
</g>
<!-- layer_6_attn_proj -->
<g id="node265" class="node">
<title>layer_6_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-16648 233.57,-16648 233.57,-16595 439.57,-16595 439.57,-16648"/>
<text text-anchor="middle" x="336.57" y="-16632.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-16617.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-16602.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_reshape&#45;&gt;layer_6_attn_proj -->
<g id="edge380" class="edge">
<title>layer_6_attn_reshape&#45;&gt;layer_6_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-16684.57C338.41,-16676.34 338.09,-16667.08 337.79,-16658.28"/>
<polygon fill="black" stroke="black" points="341.29,-16658.12 337.45,-16648.24 334.29,-16658.36 341.29,-16658.12"/>
</g>
<!-- layer_6_attn_proj&#45;&gt;layer_6_add1 -->
<g id="edge382" class="edge">
<title>layer_6_attn_proj&#45;&gt;layer_6_add1</title>
<path fill="none" stroke="black" d="M300.66,-16594.81C287.15,-16585.14 271.63,-16574.04 257.47,-16563.9"/>
<polygon fill="black" stroke="black" points="259.48,-16561.04 249.31,-16558.07 255.41,-16566.73 259.48,-16561.04"/>
</g>
<!-- layer_6_ln2 -->
<g id="node267" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-16468 827.57,-16468 827.57,-16415 1033.57,-16415 1033.57,-16468"/>
<text text-anchor="middle" x="930.57" y="-16452.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-16437.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-16422.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_add1&#45;&gt;layer_6_ln2 -->
<g id="edge383" class="edge">
<title>layer_6_add1&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M316.68,-16517.84C449.47,-16501.55 679.5,-16473.31 817.13,-16456.42"/>
<polygon fill="black" stroke="black" points="817.78,-16459.87 827.28,-16455.18 816.93,-16452.92 817.78,-16459.87"/>
</g>
<!-- layer_6_add -->
<g id="node294" class="node">
<title>layer_6_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-15812 110.57,-15812 110.57,-15759 316.57,-15759 316.57,-15812"/>
<text text-anchor="middle" x="213.57" y="-15796.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-15781.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-15766.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_add1&#45;&gt;layer_6_add -->
<g id="edge425" class="edge">
<title>layer_6_add1&#45;&gt;layer_6_add</title>
<path fill="none" stroke="black" d="M208.2,-16504.83C205.01,-16487.34 201.57,-16463.62 201.57,-16442.5 201.57,-16442.5 201.57,-16442.5 201.57,-15901 201.57,-15874.6 204.77,-15844.96 207.86,-15822.46"/>
<polygon fill="black" stroke="black" points="211.35,-15822.73 209.31,-15812.34 204.42,-15821.74 211.35,-15822.73"/>
</g>
<!-- layer_6_gate -->
<g id="node268" class="node">
<title>layer_6_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-16378 900.57,-16325 1079.57,-16272 1258.57,-16325 1079.57,-16378"/>
<text text-anchor="middle" x="1079.57" y="-16336.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-16321.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-16306.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_gate -->
<g id="edge384" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_gate</title>
<path fill="none" stroke="black" d="M964.01,-16414.8C981.28,-16401.53 1002.83,-16384.97 1022.63,-16369.76"/>
<polygon fill="black" stroke="black" points="1024.9,-16372.43 1030.69,-16363.56 1020.63,-16366.88 1024.9,-16372.43"/>
</g>
<!-- layer_6_expert_0_ffn1 -->
<g id="node269" class="node">
<title>layer_6_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-16225 677.57,-16225 677.57,-16172 883.57,-16172 883.57,-16225"/>
<text text-anchor="middle" x="780.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_0_ffn1 -->
<g id="edge386" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-16414.95C887.23,-16404.28 873.96,-16391.28 863.57,-16378 824.71,-16328.33 817.94,-16312.58 794.57,-16254 792.17,-16247.99 790.08,-16241.43 788.29,-16235.02"/>
<polygon fill="black" stroke="black" points="791.63,-16233.97 785.73,-16225.17 784.85,-16235.72 791.63,-16233.97"/>
</g>
<!-- layer_6_expert_1_ffn1 -->
<g id="node272" class="node">
<title>layer_6_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-16225 229.57,-16225 229.57,-16172 435.57,-16172 435.57,-16225"/>
<text text-anchor="middle" x="332.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_1_ffn1 -->
<g id="edge390" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-16428.27C767.36,-16418.96 691.02,-16403.31 626.57,-16378 529.83,-16340.01 428.72,-16271.16 373.91,-16230.98"/>
<polygon fill="black" stroke="black" points="375.97,-16228.14 365.84,-16225.02 371.81,-16233.78 375.97,-16228.14"/>
</g>
<!-- layer_6_expert_2_ffn1 -->
<g id="node275" class="node">
<title>layer_6_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-16225 1125.57,-16225 1125.57,-16172 1331.57,-16172 1331.57,-16225"/>
<text text-anchor="middle" x="1228.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_2_ffn1 -->
<g id="edge394" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-16435.17C1121.34,-16428.26 1237.52,-16412.69 1267.57,-16378 1306.88,-16332.62 1295.71,-16298.4 1272.57,-16243 1271.12,-16239.52 1269.24,-16236.18 1267.08,-16233.01"/>
<polygon fill="black" stroke="black" points="1269.72,-16230.71 1260.79,-16225.01 1264.22,-16235.03 1269.72,-16230.71"/>
</g>
<!-- layer_6_expert_3_ffn1 -->
<g id="node278" class="node">
<title>layer_6_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-16225 1573.57,-16225 1573.57,-16172 1779.57,-16172 1779.57,-16225"/>
<text text-anchor="middle" x="1676.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_3_ffn1 -->
<g id="edge398" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-16435.82C1122.76,-16429.39 1253.8,-16414.14 1362.57,-16378 1484.83,-16337.38 1520.13,-16329.42 1624.57,-16254 1633.08,-16247.86 1641.36,-16240.21 1648.73,-16232.6"/>
<polygon fill="black" stroke="black" points="1651.49,-16234.77 1655.76,-16225.07 1646.38,-16229.99 1651.49,-16234.77"/>
</g>
<!-- layer_6_expert_4_ffn1 -->
<g id="node281" class="node">
<title>layer_6_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-16225 453.57,-16225 453.57,-16172 659.57,-16172 659.57,-16225"/>
<text text-anchor="middle" x="556.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_4_ffn1 -->
<g id="edge402" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-16414.89C801.11,-16383.58 686.43,-16325.79 603.57,-16254 596.29,-16247.69 589.13,-16240.24 582.68,-16232.9"/>
<polygon fill="black" stroke="black" points="585.14,-16230.39 575.99,-16225.05 579.81,-16234.93 585.14,-16230.39"/>
</g>
<!-- layer_6_expert_5_ffn1 -->
<g id="node284" class="node">
<title>layer_6_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-16225 1349.57,-16225 1349.57,-16172 1555.57,-16172 1555.57,-16225"/>
<text text-anchor="middle" x="1452.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_5_ffn1 -->
<g id="edge406" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-16434.77C1098.02,-16429.2 1181.84,-16418.3 1253.57,-16397 1272.44,-16391.4 1277.44,-16389.28 1293.57,-16378 1357.95,-16332.96 1370.85,-16315.64 1419.57,-16254 1424.54,-16247.72 1429.34,-16240.63 1433.66,-16233.69"/>
<polygon fill="black" stroke="black" points="1436.7,-16235.43 1438.87,-16225.05 1430.71,-16231.81 1436.7,-16235.43"/>
</g>
<!-- layer_6_expert_6_ffn1 -->
<g id="node287" class="node">
<title>layer_6_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-16225 1797.57,-16225 1797.57,-16172 2003.57,-16172 2003.57,-16225"/>
<text text-anchor="middle" x="1900.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_6_ffn1 -->
<g id="edge410" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-16438.36C1147.98,-16433.86 1336.72,-16420.05 1493.57,-16378 1625.52,-16342.63 1769.63,-16270.8 1845.97,-16229.86"/>
<polygon fill="black" stroke="black" points="1847.8,-16232.86 1854.94,-16225.03 1844.47,-16226.69 1847.8,-16232.86"/>
</g>
<!-- layer_6_expert_7_ffn1 -->
<g id="node290" class="node">
<title>layer_6_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-16225 901.57,-16225 901.57,-16172 1107.57,-16172 1107.57,-16225"/>
<text text-anchor="middle" x="1004.57" y="-16209.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-16194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-16179.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_expert_7_ffn1 -->
<g id="edge414" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-16414.92C903.08,-16404.14 895.6,-16391.08 891.57,-16378 873.88,-16320.62 852.23,-16292.25 886.57,-16243 889.58,-16238.69 893.06,-16234.8 896.91,-16231.3"/>
<polygon fill="black" stroke="black" points="899.11,-16234.02 904.71,-16225.03 894.73,-16228.56 899.11,-16234.02"/>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_0_ffn1 -->
<g id="edge385" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-16293.54C959.2,-16273.88 898.07,-16248.43 851.32,-16228.96"/>
<polygon fill="black" stroke="black" points="852.45,-16225.64 841.87,-16225.03 849.76,-16232.1 852.45,-16225.64"/>
<text text-anchor="middle" x="924.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_1_ffn1 -->
<g id="edge389" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-16307.72C833.08,-16290.17 630.07,-16260.21 445.54,-16225.14"/>
<polygon fill="black" stroke="black" points="446.13,-16221.69 435.65,-16223.25 444.82,-16228.56 446.13,-16221.69"/>
<text text-anchor="middle" x="623.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_2_ffn1 -->
<g id="edge393" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-16282.47C1129.09,-16269.16 1143.87,-16254.81 1158.57,-16243 1163.82,-16238.78 1169.5,-16234.65 1175.28,-16230.71"/>
<polygon fill="black" stroke="black" points="1177.37,-16233.52 1183.77,-16225.09 1173.5,-16227.68 1177.37,-16233.52"/>
<text text-anchor="middle" x="1180.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_3_ffn1 -->
<g id="edge397" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-16302.7C1263.24,-16286.33 1376.38,-16263.18 1475.57,-16243 1512.26,-16235.54 1523.52,-16233.73 1563.55,-16225.2"/>
<polygon fill="black" stroke="black" points="1564.41,-16228.59 1573.46,-16223.08 1562.94,-16221.75 1564.41,-16228.59"/>
<text text-anchor="middle" x="1497.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_4_ffn1 -->
<g id="edge401" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-16300.8C893.49,-16279.7 762.7,-16248.57 669.53,-16226.39"/>
<polygon fill="black" stroke="black" points="670.33,-16222.98 659.79,-16224.07 668.7,-16229.79 670.33,-16222.98"/>
<text text-anchor="middle" x="792.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_5_ffn1 -->
<g id="edge405" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-16293.6C1193.35,-16277.52 1244.3,-16258.05 1290.57,-16243 1306.78,-16237.73 1324.04,-16232.6 1341.02,-16227.81"/>
<polygon fill="black" stroke="black" points="1342.29,-16231.09 1350.98,-16225.04 1340.41,-16224.35 1342.29,-16231.09"/>
<text text-anchor="middle" x="1312.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_6_ffn1 -->
<g id="edge409" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-16309.57C1346.62,-16292.91 1578.71,-16263.07 1787.57,-16225.13"/>
<polygon fill="black" stroke="black" points="1788.29,-16228.55 1797.5,-16223.31 1787.04,-16221.67 1788.29,-16228.55"/>
<text text-anchor="middle" x="1694.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_6_gate&#45;&gt;layer_6_expert_7_ffn1 -->
<g id="edge413" class="edge">
<title>layer_6_gate&#45;&gt;layer_6_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-16279.76C1043.87,-16264.73 1033.9,-16248.18 1025.37,-16234.03"/>
<polygon fill="black" stroke="black" points="1028.16,-16231.88 1020,-16225.12 1022.17,-16235.49 1028.16,-16231.88"/>
<text text-anchor="middle" x="1056.57" y="-16246" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_6_expert_0_gelu -->
<g id="node270" class="node">
<title>layer_6_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-16135 677.57,-16135 677.57,-16082 883.57,-16082 883.57,-16135"/>
<text text-anchor="middle" x="780.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_0_ffn1&#45;&gt;layer_6_expert_0_gelu -->
<g id="edge387" class="edge">
<title>layer_6_expert_0_ffn1&#45;&gt;layer_6_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-16171.57C780.57,-16163.34 780.57,-16154.08 780.57,-16145.28"/>
<polygon fill="black" stroke="black" points="784.07,-16145.24 780.57,-16135.24 777.07,-16145.24 784.07,-16145.24"/>
</g>
<!-- layer_6_expert_0_ffn2 -->
<g id="node271" class="node">
<title>layer_6_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-16045 677.57,-16045 677.57,-15992 883.57,-15992 883.57,-16045"/>
<text text-anchor="middle" x="780.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_0_gelu&#45;&gt;layer_6_expert_0_ffn2 -->
<g id="edge388" class="edge">
<title>layer_6_expert_0_gelu&#45;&gt;layer_6_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-16081.57C780.57,-16073.34 780.57,-16064.08 780.57,-16055.28"/>
<polygon fill="black" stroke="black" points="784.07,-16055.24 780.57,-16045.24 777.07,-16055.24 784.07,-16055.24"/>
</g>
<!-- layer_6_expert_agg -->
<g id="node293" class="node">
<title>layer_6_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-15955 878.36,-15955 790.93,-15849 1130.79,-15849 1218.21,-15955"/>
<text text-anchor="middle" x="1004.57" y="-15913.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-15898.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-15883.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_0_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge417" class="edge">
<title>layer_6_expert_0_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-15991.95C849.26,-15982.39 871.33,-15971.11 893.35,-15959.85"/>
<polygon fill="black" stroke="black" points="895.14,-15962.87 902.45,-15955.2 891.95,-15956.64 895.14,-15962.87"/>
</g>
<!-- layer_6_expert_1_gelu -->
<g id="node273" class="node">
<title>layer_6_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-16135 229.57,-16135 229.57,-16082 435.57,-16082 435.57,-16135"/>
<text text-anchor="middle" x="332.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_1_ffn1&#45;&gt;layer_6_expert_1_gelu -->
<g id="edge391" class="edge">
<title>layer_6_expert_1_ffn1&#45;&gt;layer_6_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-16171.57C332.57,-16163.34 332.57,-16154.08 332.57,-16145.28"/>
<polygon fill="black" stroke="black" points="336.07,-16145.24 332.57,-16135.24 329.07,-16145.24 336.07,-16145.24"/>
</g>
<!-- layer_6_expert_1_ffn2 -->
<g id="node274" class="node">
<title>layer_6_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-16045 229.57,-16045 229.57,-15992 435.57,-15992 435.57,-16045"/>
<text text-anchor="middle" x="332.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_1_gelu&#45;&gt;layer_6_expert_1_ffn2 -->
<g id="edge392" class="edge">
<title>layer_6_expert_1_gelu&#45;&gt;layer_6_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-16081.57C332.57,-16073.34 332.57,-16064.08 332.57,-16055.28"/>
<polygon fill="black" stroke="black" points="336.07,-16055.24 332.57,-16045.24 329.07,-16055.24 336.07,-16055.24"/>
</g>
<!-- layer_6_expert_1_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge418" class="edge">
<title>layer_6_expert_1_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-15993.76C438.66,-15993.16 441.63,-15992.57 444.57,-15992 578.16,-15966.21 730.72,-15942.32 842.83,-15925.81"/>
<polygon fill="black" stroke="black" points="843.49,-15929.25 852.87,-15924.33 842.47,-15922.32 843.49,-15929.25"/>
</g>
<!-- layer_6_expert_2_gelu -->
<g id="node276" class="node">
<title>layer_6_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-16135 1125.57,-16135 1125.57,-16082 1331.57,-16082 1331.57,-16135"/>
<text text-anchor="middle" x="1228.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_2_ffn1&#45;&gt;layer_6_expert_2_gelu -->
<g id="edge395" class="edge">
<title>layer_6_expert_2_ffn1&#45;&gt;layer_6_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-16171.57C1228.57,-16163.34 1228.57,-16154.08 1228.57,-16145.28"/>
<polygon fill="black" stroke="black" points="1232.07,-16145.24 1228.57,-16135.24 1225.07,-16145.24 1232.07,-16145.24"/>
</g>
<!-- layer_6_expert_2_ffn2 -->
<g id="node277" class="node">
<title>layer_6_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-16045 1125.57,-16045 1125.57,-15992 1331.57,-15992 1331.57,-16045"/>
<text text-anchor="middle" x="1228.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_2_gelu&#45;&gt;layer_6_expert_2_ffn2 -->
<g id="edge396" class="edge">
<title>layer_6_expert_2_gelu&#45;&gt;layer_6_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-16081.57C1228.57,-16073.34 1228.57,-16064.08 1228.57,-16055.28"/>
<polygon fill="black" stroke="black" points="1232.07,-16055.24 1228.57,-16045.24 1225.07,-16055.24 1232.07,-16055.24"/>
</g>
<!-- layer_6_expert_2_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge419" class="edge">
<title>layer_6_expert_2_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-15991.95C1159.88,-15982.39 1137.81,-15971.11 1115.79,-15959.85"/>
<polygon fill="black" stroke="black" points="1117.19,-15956.64 1106.7,-15955.2 1114.01,-15962.87 1117.19,-15956.64"/>
</g>
<!-- layer_6_expert_3_gelu -->
<g id="node279" class="node">
<title>layer_6_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-16135 1573.57,-16135 1573.57,-16082 1779.57,-16082 1779.57,-16135"/>
<text text-anchor="middle" x="1676.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_3_ffn1&#45;&gt;layer_6_expert_3_gelu -->
<g id="edge399" class="edge">
<title>layer_6_expert_3_ffn1&#45;&gt;layer_6_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-16171.57C1676.57,-16163.34 1676.57,-16154.08 1676.57,-16145.28"/>
<polygon fill="black" stroke="black" points="1680.07,-16145.24 1676.57,-16135.24 1673.07,-16145.24 1680.07,-16145.24"/>
</g>
<!-- layer_6_expert_3_ffn2 -->
<g id="node280" class="node">
<title>layer_6_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-16045 1573.57,-16045 1573.57,-15992 1779.57,-15992 1779.57,-16045"/>
<text text-anchor="middle" x="1676.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_3_gelu&#45;&gt;layer_6_expert_3_ffn2 -->
<g id="edge400" class="edge">
<title>layer_6_expert_3_gelu&#45;&gt;layer_6_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-16081.57C1676.57,-16073.34 1676.57,-16064.08 1676.57,-16055.28"/>
<polygon fill="black" stroke="black" points="1680.07,-16055.24 1676.57,-16045.24 1673.07,-16055.24 1680.07,-16055.24"/>
</g>
<!-- layer_6_expert_3_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge420" class="edge">
<title>layer_6_expert_3_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-15993.76C1570.49,-15993.16 1567.51,-15992.57 1564.57,-15992 1446.94,-15969.29 1314.59,-15948.06 1208.1,-15932.03"/>
<polygon fill="black" stroke="black" points="1208.61,-15928.57 1198.21,-15930.54 1207.58,-15935.49 1208.61,-15928.57"/>
</g>
<!-- layer_6_expert_4_gelu -->
<g id="node282" class="node">
<title>layer_6_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-16135 453.57,-16135 453.57,-16082 659.57,-16082 659.57,-16135"/>
<text text-anchor="middle" x="556.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_4_ffn1&#45;&gt;layer_6_expert_4_gelu -->
<g id="edge403" class="edge">
<title>layer_6_expert_4_ffn1&#45;&gt;layer_6_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-16171.57C556.57,-16163.34 556.57,-16154.08 556.57,-16145.28"/>
<polygon fill="black" stroke="black" points="560.07,-16145.24 556.57,-16135.24 553.07,-16145.24 560.07,-16145.24"/>
</g>
<!-- layer_6_expert_4_ffn2 -->
<g id="node283" class="node">
<title>layer_6_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-16045 453.57,-16045 453.57,-15992 659.57,-15992 659.57,-16045"/>
<text text-anchor="middle" x="556.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_4_gelu&#45;&gt;layer_6_expert_4_ffn2 -->
<g id="edge404" class="edge">
<title>layer_6_expert_4_gelu&#45;&gt;layer_6_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-16081.57C556.57,-16073.34 556.57,-16064.08 556.57,-16055.28"/>
<polygon fill="black" stroke="black" points="560.07,-16055.24 556.57,-16045.24 553.07,-16055.24 560.07,-16055.24"/>
</g>
<!-- layer_6_expert_4_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge421" class="edge">
<title>layer_6_expert_4_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-15991.95C714.81,-15977.06 789.41,-15957.99 854.59,-15941.33"/>
<polygon fill="black" stroke="black" points="855.73,-15944.65 864.55,-15938.79 853.99,-15937.87 855.73,-15944.65"/>
</g>
<!-- layer_6_expert_5_gelu -->
<g id="node285" class="node">
<title>layer_6_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-16135 1349.57,-16135 1349.57,-16082 1555.57,-16082 1555.57,-16135"/>
<text text-anchor="middle" x="1452.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_5_ffn1&#45;&gt;layer_6_expert_5_gelu -->
<g id="edge407" class="edge">
<title>layer_6_expert_5_ffn1&#45;&gt;layer_6_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-16171.57C1452.57,-16163.34 1452.57,-16154.08 1452.57,-16145.28"/>
<polygon fill="black" stroke="black" points="1456.07,-16145.24 1452.57,-16135.24 1449.07,-16145.24 1456.07,-16145.24"/>
</g>
<!-- layer_6_expert_5_ffn2 -->
<g id="node286" class="node">
<title>layer_6_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-16045 1349.57,-16045 1349.57,-15992 1555.57,-15992 1555.57,-16045"/>
<text text-anchor="middle" x="1452.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_5_gelu&#45;&gt;layer_6_expert_5_ffn2 -->
<g id="edge408" class="edge">
<title>layer_6_expert_5_gelu&#45;&gt;layer_6_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-16081.57C1452.57,-16073.34 1452.57,-16064.08 1452.57,-16055.28"/>
<polygon fill="black" stroke="black" points="1456.07,-16055.24 1452.57,-16045.24 1449.07,-16055.24 1456.07,-16055.24"/>
</g>
<!-- layer_6_expert_5_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge422" class="edge">
<title>layer_6_expert_5_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-15991.95C1312.66,-15981.74 1265.05,-15969.57 1218.07,-15957.57"/>
<polygon fill="black" stroke="black" points="1218.92,-15954.17 1208.37,-15955.09 1217.19,-15960.95 1218.92,-15954.17"/>
</g>
<!-- layer_6_expert_6_gelu -->
<g id="node288" class="node">
<title>layer_6_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-16135 1797.57,-16135 1797.57,-16082 2003.57,-16082 2003.57,-16135"/>
<text text-anchor="middle" x="1900.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_6_ffn1&#45;&gt;layer_6_expert_6_gelu -->
<g id="edge411" class="edge">
<title>layer_6_expert_6_ffn1&#45;&gt;layer_6_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-16171.57C1900.57,-16163.34 1900.57,-16154.08 1900.57,-16145.28"/>
<polygon fill="black" stroke="black" points="1904.07,-16145.24 1900.57,-16135.24 1897.07,-16145.24 1904.07,-16145.24"/>
</g>
<!-- layer_6_expert_6_ffn2 -->
<g id="node289" class="node">
<title>layer_6_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-16045 1797.57,-16045 1797.57,-15992 2003.57,-15992 2003.57,-16045"/>
<text text-anchor="middle" x="1900.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_6_gelu&#45;&gt;layer_6_expert_6_ffn2 -->
<g id="edge412" class="edge">
<title>layer_6_expert_6_gelu&#45;&gt;layer_6_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-16081.57C1900.57,-16073.34 1900.57,-16064.08 1900.57,-16055.28"/>
<polygon fill="black" stroke="black" points="1904.07,-16055.24 1900.57,-16045.24 1897.07,-16055.24 1904.07,-16055.24"/>
</g>
<!-- layer_6_expert_6_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge423" class="edge">
<title>layer_6_expert_6_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-15993.59C1794.51,-15993.03 1791.52,-15992.5 1788.57,-15992 1588.54,-15957.98 1357.51,-15933.53 1198.33,-15918.97"/>
<polygon fill="black" stroke="black" points="1198.23,-15915.45 1187.95,-15918.03 1197.59,-15922.42 1198.23,-15915.45"/>
</g>
<!-- layer_6_expert_7_gelu -->
<g id="node291" class="node">
<title>layer_6_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-16135 901.57,-16135 901.57,-16082 1107.57,-16082 1107.57,-16135"/>
<text text-anchor="middle" x="1004.57" y="-16119.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-16104.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-16089.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_7_ffn1&#45;&gt;layer_6_expert_7_gelu -->
<g id="edge415" class="edge">
<title>layer_6_expert_7_ffn1&#45;&gt;layer_6_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-16171.57C1004.57,-16163.34 1004.57,-16154.08 1004.57,-16145.28"/>
<polygon fill="black" stroke="black" points="1008.07,-16145.24 1004.57,-16135.24 1001.07,-16145.24 1008.07,-16145.24"/>
</g>
<!-- layer_6_expert_7_ffn2 -->
<g id="node292" class="node">
<title>layer_6_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-16045 901.57,-16045 901.57,-15992 1107.57,-15992 1107.57,-16045"/>
<text text-anchor="middle" x="1004.57" y="-16029.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-16014.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-15999.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_expert_7_gelu&#45;&gt;layer_6_expert_7_ffn2 -->
<g id="edge416" class="edge">
<title>layer_6_expert_7_gelu&#45;&gt;layer_6_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-16081.57C1004.57,-16073.34 1004.57,-16064.08 1004.57,-16055.28"/>
<polygon fill="black" stroke="black" points="1008.07,-16055.24 1004.57,-16045.24 1001.07,-16055.24 1008.07,-16055.24"/>
</g>
<!-- layer_6_expert_7_ffn2&#45;&gt;layer_6_expert_agg -->
<g id="edge424" class="edge">
<title>layer_6_expert_7_ffn2&#45;&gt;layer_6_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-15991.8C1004.57,-15983.86 1004.57,-15974.74 1004.57,-15965.44"/>
<polygon fill="black" stroke="black" points="1008.07,-15965.32 1004.57,-15955.32 1001.07,-15965.32 1008.07,-15965.32"/>
</g>
<!-- layer_6_expert_agg&#45;&gt;layer_6_add -->
<g id="edge426" class="edge">
<title>layer_6_expert_agg&#45;&gt;layer_6_add</title>
<path fill="none" stroke="black" d="M810.56,-15872.92C658.7,-15850.93 452.76,-15821.12 326.73,-15802.88"/>
<polygon fill="black" stroke="black" points="327.07,-15799.39 316.67,-15801.42 326.07,-15806.32 327.07,-15799.39"/>
</g>
<!-- comm_6_7 -->
<g id="node295" class="node">
<title>comm_6_7</title>
<polygon fill="yellow" stroke="black" points="427.21,-15722 87.36,-15722 -0.07,-15616 339.79,-15616 427.21,-15722"/>
<text text-anchor="middle" x="213.57" y="-15680.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-15665.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-15650.3" font-family="Times,serif" font-size="14.00">GPU 6  GPU 7</text>
</g>
<!-- layer_6_add&#45;&gt;comm_6_7 -->
<g id="edge427" class="edge">
<title>layer_6_add&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M213.57,-15758.8C213.57,-15750.86 213.57,-15741.74 213.57,-15732.44"/>
<polygon fill="black" stroke="black" points="217.07,-15732.32 213.57,-15722.32 210.07,-15732.32 217.07,-15732.32"/>
</g>
<!-- layer_7_ln1 -->
<g id="node296" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-15579 291.57,-15579 291.57,-15526 497.57,-15526 497.57,-15579"/>
<text text-anchor="middle" x="394.57" y="-15563.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-15548.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-15533.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- comm_6_7&#45;&gt;layer_7_ln1 -->
<g id="edge428" class="edge">
<title>comm_6_7&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M295.86,-15615.94C312.72,-15605.28 329.97,-15594.37 345.23,-15584.71"/>
<polygon fill="black" stroke="black" points="347.39,-15587.49 353.97,-15579.18 343.65,-15581.57 347.39,-15587.49"/>
</g>
<!-- layer_7_add1 -->
<g id="node308" class="node">
<title>layer_7_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-14807 110.57,-14807 110.57,-14754 316.57,-14754 316.57,-14807"/>
<text text-anchor="middle" x="213.57" y="-14791.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-14776.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-14761.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- comm_6_7&#45;&gt;layer_7_add1 -->
<g id="edge442" class="edge">
<title>comm_6_7&#45;&gt;layer_7_add1</title>
<path fill="none" stroke="black" d="M205.8,-15615.97C203.49,-15596.42 201.57,-15573.99 201.57,-15553.5 201.57,-15553.5 201.57,-15553.5 201.57,-14869.5 201.57,-14852.17 203.88,-14833.1 206.48,-14817.15"/>
<polygon fill="black" stroke="black" points="209.95,-14817.62 208.2,-14807.17 203.05,-14816.43 209.95,-14817.62"/>
</g>
<!-- layer_7_q_proj -->
<g id="node297" class="node">
<title>layer_7_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-15489 453.57,-15489 453.57,-15436 659.57,-15436 659.57,-15489"/>
<text text-anchor="middle" x="556.57" y="-15473.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-15458.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-15443.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_q_proj -->
<g id="edge429" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-15525.81C460.25,-15515.82 481.45,-15504.31 500.58,-15493.91"/>
<polygon fill="black" stroke="black" points="502.38,-15496.92 509.5,-15489.07 499.04,-15490.77 502.38,-15496.92"/>
</g>
<!-- layer_7_k_proj -->
<g id="node298" class="node">
<title>layer_7_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-15489 677.57,-15489 677.57,-15436 883.57,-15436 883.57,-15489"/>
<text text-anchor="middle" x="780.57" y="-15473.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-15458.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-15443.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_k_proj -->
<g id="edge430" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-15527.98C550.11,-15516.04 613.8,-15501.52 667.48,-15489.28"/>
<polygon fill="black" stroke="black" points="668.41,-15492.66 677.38,-15487.02 666.86,-15485.83 668.41,-15492.66"/>
</g>
<!-- layer_7_v_proj -->
<g id="node299" class="node">
<title>layer_7_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-15489 229.57,-15489 229.57,-15436 435.57,-15436 435.57,-15489"/>
<text text-anchor="middle" x="332.57" y="-15473.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-15458.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-15443.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_v_proj -->
<g id="edge431" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-15525.57C370.12,-15516.8 363.13,-15506.87 356.57,-15497.56"/>
<polygon fill="black" stroke="black" points="359.33,-15495.4 350.71,-15489.24 353.61,-15499.43 359.33,-15495.4"/>
</g>
<!-- layer_7_q_reshape -->
<g id="node300" class="node">
<title>layer_7_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-15399 426.57,-15399 426.57,-15346 650.57,-15346 650.57,-15399"/>
<text text-anchor="middle" x="538.57" y="-15383.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-15368.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-15353.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_q_proj&#45;&gt;layer_7_q_reshape -->
<g id="edge432" class="edge">
<title>layer_7_q_proj&#45;&gt;layer_7_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-15435.57C549.58,-15427.34 547.69,-15418.08 545.89,-15409.28"/>
<polygon fill="black" stroke="black" points="549.27,-15408.34 543.84,-15399.24 542.41,-15409.74 549.27,-15408.34"/>
</g>
<!-- layer_7_k_reshape -->
<g id="node301" class="node">
<title>layer_7_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-15399 668.57,-15399 668.57,-15346 892.57,-15346 892.57,-15399"/>
<text text-anchor="middle" x="780.57" y="-15383.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-15368.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-15353.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_k_proj&#45;&gt;layer_7_k_reshape -->
<g id="edge433" class="edge">
<title>layer_7_k_proj&#45;&gt;layer_7_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-15435.57C780.57,-15427.34 780.57,-15418.08 780.57,-15409.28"/>
<polygon fill="black" stroke="black" points="784.07,-15409.24 780.57,-15399.24 777.07,-15409.24 784.07,-15409.24"/>
</g>
<!-- layer_7_v_reshape -->
<g id="node302" class="node">
<title>layer_7_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-15328 226.57,-15328 226.57,-15275 450.57,-15275 450.57,-15328"/>
<text text-anchor="middle" x="338.57" y="-15312.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-15297.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-15282.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_v_proj&#45;&gt;layer_7_v_reshape -->
<g id="edge434" class="edge">
<title>layer_7_v_proj&#45;&gt;layer_7_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-15435.95C334.53,-15409.61 336.09,-15368.29 337.21,-15338.61"/>
<polygon fill="black" stroke="black" points="340.72,-15338.37 337.6,-15328.25 333.72,-15338.11 340.72,-15338.37"/>
</g>
<!-- layer_7_attn_scores -->
<g id="node303" class="node">
<title>layer_7_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-15257 422.07,-15257 422.07,-15204 655.07,-15204 655.07,-15257"/>
<text text-anchor="middle" x="538.57" y="-15241.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-15226.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-15211.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_q_reshape&#45;&gt;layer_7_attn_scores -->
<g id="edge435" class="edge">
<title>layer_7_q_reshape&#45;&gt;layer_7_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-15345.82C538.57,-15323.72 538.57,-15291.6 538.57,-15267.03"/>
<polygon fill="black" stroke="black" points="542.07,-15267.02 538.57,-15257.02 535.07,-15267.02 542.07,-15267.02"/>
</g>
<!-- layer_7_k_reshape&#45;&gt;layer_7_attn_scores -->
<g id="edge436" class="edge">
<title>layer_7_k_reshape&#45;&gt;layer_7_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-15345.98C695.65,-15322.37 634.91,-15287.23 591.5,-15262.12"/>
<polygon fill="black" stroke="black" points="593.19,-15259.05 582.78,-15257.08 589.68,-15265.11 593.19,-15259.05"/>
</g>
<!-- layer_7_attn_output -->
<g id="node305" class="node">
<title>layer_7_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-15077 229.57,-15077 229.57,-15024 453.57,-15024 453.57,-15077"/>
<text text-anchor="middle" x="341.57" y="-15061.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-15046.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-15031.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_v_reshape&#45;&gt;layer_7_attn_output -->
<g id="edge439" class="edge">
<title>layer_7_v_reshape&#45;&gt;layer_7_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-15274.79C339.42,-15230.13 340.53,-15138.13 341.14,-15087.27"/>
<polygon fill="black" stroke="black" points="344.64,-15087.11 341.26,-15077.07 337.64,-15087.03 344.64,-15087.11"/>
</g>
<!-- layer_7_attn_weights -->
<g id="node304" class="node">
<title>layer_7_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="628.07,-15167 395.07,-15167 395.07,-15114 628.07,-15114 628.07,-15167"/>
<text text-anchor="middle" x="511.57" y="-15151.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="511.57" y="-15136.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="511.57" y="-15121.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_scores&#45;&gt;layer_7_attn_weights -->
<g id="edge437" class="edge">
<title>layer_7_attn_scores&#45;&gt;layer_7_attn_weights</title>
<path fill="none" stroke="black" d="M530.62,-15203.57C528.06,-15195.25 525.19,-15185.88 522.46,-15176.99"/>
<polygon fill="black" stroke="black" points="525.75,-15175.78 519.47,-15167.24 519.06,-15177.83 525.75,-15175.78"/>
</g>
<!-- layer_7_attn_weights&#45;&gt;layer_7_attn_output -->
<g id="edge438" class="edge">
<title>layer_7_attn_weights&#45;&gt;layer_7_attn_output</title>
<path fill="none" stroke="black" d="M461.94,-15113.81C442.57,-15103.78 420.2,-15092.2 400.05,-15081.77"/>
<polygon fill="black" stroke="black" points="401.46,-15078.56 390.97,-15077.07 398.24,-15084.77 401.46,-15078.56"/>
</g>
<!-- layer_7_attn_reshape -->
<g id="node306" class="node">
<title>layer_7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-14987 236.57,-14987 236.57,-14934 442.57,-14934 442.57,-14987"/>
<text text-anchor="middle" x="339.57" y="-14971.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-14956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-14941.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_output&#45;&gt;layer_7_attn_reshape -->
<g id="edge440" class="edge">
<title>layer_7_attn_output&#45;&gt;layer_7_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-15023.57C340.79,-15015.34 340.58,-15006.08 340.38,-14997.28"/>
<polygon fill="black" stroke="black" points="343.88,-14997.16 340.16,-14987.24 336.88,-14997.32 343.88,-14997.16"/>
</g>
<!-- layer_7_attn_proj -->
<g id="node307" class="node">
<title>layer_7_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-14897 233.57,-14897 233.57,-14844 439.57,-14844 439.57,-14897"/>
<text text-anchor="middle" x="336.57" y="-14881.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-14866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-14851.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_reshape&#45;&gt;layer_7_attn_proj -->
<g id="edge441" class="edge">
<title>layer_7_attn_reshape&#45;&gt;layer_7_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-14933.57C338.41,-14925.34 338.09,-14916.08 337.79,-14907.28"/>
<polygon fill="black" stroke="black" points="341.29,-14907.12 337.45,-14897.24 334.29,-14907.36 341.29,-14907.12"/>
</g>
<!-- layer_7_attn_proj&#45;&gt;layer_7_add1 -->
<g id="edge443" class="edge">
<title>layer_7_attn_proj&#45;&gt;layer_7_add1</title>
<path fill="none" stroke="black" d="M300.66,-14843.81C287.15,-14834.14 271.63,-14823.04 257.47,-14812.9"/>
<polygon fill="black" stroke="black" points="259.48,-14810.04 249.31,-14807.07 255.41,-14815.73 259.48,-14810.04"/>
</g>
<!-- layer_7_ln2 -->
<g id="node309" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-14717 827.57,-14717 827.57,-14664 1033.57,-14664 1033.57,-14717"/>
<text text-anchor="middle" x="930.57" y="-14701.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-14686.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-14671.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_add1&#45;&gt;layer_7_ln2 -->
<g id="edge444" class="edge">
<title>layer_7_add1&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M316.68,-14766.84C449.47,-14750.55 679.5,-14722.31 817.13,-14705.42"/>
<polygon fill="black" stroke="black" points="817.78,-14708.87 827.28,-14704.18 816.93,-14701.92 817.78,-14708.87"/>
</g>
<!-- layer_7_add -->
<g id="node336" class="node">
<title>layer_7_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-14061 110.57,-14061 110.57,-14008 316.57,-14008 316.57,-14061"/>
<text text-anchor="middle" x="213.57" y="-14045.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-14030.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-14015.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_add1&#45;&gt;layer_7_add -->
<g id="edge486" class="edge">
<title>layer_7_add1&#45;&gt;layer_7_add</title>
<path fill="none" stroke="black" d="M208.2,-14753.83C205.01,-14736.34 201.57,-14712.62 201.57,-14691.5 201.57,-14691.5 201.57,-14691.5 201.57,-14150 201.57,-14123.6 204.77,-14093.96 207.86,-14071.46"/>
<polygon fill="black" stroke="black" points="211.35,-14071.73 209.31,-14061.34 204.42,-14070.74 211.35,-14071.73"/>
</g>
<!-- layer_7_gate -->
<g id="node310" class="node">
<title>layer_7_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-14627 900.57,-14574 1079.57,-14521 1258.57,-14574 1079.57,-14627"/>
<text text-anchor="middle" x="1079.57" y="-14585.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-14570.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-14555.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_gate -->
<g id="edge445" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_gate</title>
<path fill="none" stroke="black" d="M964.01,-14663.8C981.28,-14650.53 1002.83,-14633.97 1022.63,-14618.76"/>
<polygon fill="black" stroke="black" points="1024.9,-14621.43 1030.69,-14612.56 1020.63,-14615.88 1024.9,-14621.43"/>
</g>
<!-- layer_7_expert_0_ffn1 -->
<g id="node311" class="node">
<title>layer_7_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-14474 677.57,-14474 677.57,-14421 883.57,-14421 883.57,-14474"/>
<text text-anchor="middle" x="780.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_0_ffn1 -->
<g id="edge447" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-14663.95C887.23,-14653.28 873.96,-14640.28 863.57,-14627 824.71,-14577.33 817.94,-14561.58 794.57,-14503 792.17,-14496.99 790.08,-14490.43 788.29,-14484.02"/>
<polygon fill="black" stroke="black" points="791.63,-14482.97 785.73,-14474.17 784.85,-14484.72 791.63,-14482.97"/>
</g>
<!-- layer_7_expert_1_ffn1 -->
<g id="node314" class="node">
<title>layer_7_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-14474 229.57,-14474 229.57,-14421 435.57,-14421 435.57,-14474"/>
<text text-anchor="middle" x="332.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_1_ffn1 -->
<g id="edge451" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-14677.27C767.36,-14667.96 691.02,-14652.31 626.57,-14627 529.83,-14589.01 428.72,-14520.16 373.91,-14479.98"/>
<polygon fill="black" stroke="black" points="375.97,-14477.14 365.84,-14474.02 371.81,-14482.78 375.97,-14477.14"/>
</g>
<!-- layer_7_expert_2_ffn1 -->
<g id="node317" class="node">
<title>layer_7_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-14474 1125.57,-14474 1125.57,-14421 1331.57,-14421 1331.57,-14474"/>
<text text-anchor="middle" x="1228.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_2_ffn1 -->
<g id="edge455" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-14684.17C1121.34,-14677.26 1237.52,-14661.69 1267.57,-14627 1306.88,-14581.62 1295.71,-14547.4 1272.57,-14492 1271.12,-14488.52 1269.24,-14485.18 1267.08,-14482.01"/>
<polygon fill="black" stroke="black" points="1269.72,-14479.71 1260.79,-14474.01 1264.22,-14484.03 1269.72,-14479.71"/>
</g>
<!-- layer_7_expert_3_ffn1 -->
<g id="node320" class="node">
<title>layer_7_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-14474 1573.57,-14474 1573.57,-14421 1779.57,-14421 1779.57,-14474"/>
<text text-anchor="middle" x="1676.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_3_ffn1 -->
<g id="edge459" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-14684.82C1122.76,-14678.39 1253.8,-14663.14 1362.57,-14627 1484.83,-14586.38 1520.13,-14578.42 1624.57,-14503 1633.08,-14496.86 1641.36,-14489.21 1648.73,-14481.6"/>
<polygon fill="black" stroke="black" points="1651.49,-14483.77 1655.76,-14474.07 1646.38,-14478.99 1651.49,-14483.77"/>
</g>
<!-- layer_7_expert_4_ffn1 -->
<g id="node323" class="node">
<title>layer_7_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-14474 453.57,-14474 453.57,-14421 659.57,-14421 659.57,-14474"/>
<text text-anchor="middle" x="556.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_4_ffn1 -->
<g id="edge463" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-14663.89C801.11,-14632.58 686.43,-14574.79 603.57,-14503 596.29,-14496.69 589.13,-14489.24 582.68,-14481.9"/>
<polygon fill="black" stroke="black" points="585.14,-14479.39 575.99,-14474.05 579.81,-14483.93 585.14,-14479.39"/>
</g>
<!-- layer_7_expert_5_ffn1 -->
<g id="node326" class="node">
<title>layer_7_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-14474 1349.57,-14474 1349.57,-14421 1555.57,-14421 1555.57,-14474"/>
<text text-anchor="middle" x="1452.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_5_ffn1 -->
<g id="edge467" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-14683.77C1098.02,-14678.2 1181.84,-14667.3 1253.57,-14646 1272.44,-14640.4 1277.44,-14638.28 1293.57,-14627 1357.95,-14581.96 1370.85,-14564.64 1419.57,-14503 1424.54,-14496.72 1429.34,-14489.63 1433.66,-14482.69"/>
<polygon fill="black" stroke="black" points="1436.7,-14484.43 1438.87,-14474.05 1430.71,-14480.81 1436.7,-14484.43"/>
</g>
<!-- layer_7_expert_6_ffn1 -->
<g id="node329" class="node">
<title>layer_7_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-14474 1797.57,-14474 1797.57,-14421 2003.57,-14421 2003.57,-14474"/>
<text text-anchor="middle" x="1900.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_6_ffn1 -->
<g id="edge471" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-14687.36C1147.98,-14682.86 1336.72,-14669.05 1493.57,-14627 1625.52,-14591.63 1769.63,-14519.8 1845.97,-14478.86"/>
<polygon fill="black" stroke="black" points="1847.8,-14481.86 1854.94,-14474.03 1844.47,-14475.69 1847.8,-14481.86"/>
</g>
<!-- layer_7_expert_7_ffn1 -->
<g id="node332" class="node">
<title>layer_7_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-14474 901.57,-14474 901.57,-14421 1107.57,-14421 1107.57,-14474"/>
<text text-anchor="middle" x="1004.57" y="-14458.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-14443.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-14428.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_expert_7_ffn1 -->
<g id="edge475" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-14663.92C903.08,-14653.14 895.6,-14640.08 891.57,-14627 873.88,-14569.62 852.23,-14541.25 886.57,-14492 889.58,-14487.69 893.06,-14483.8 896.91,-14480.3"/>
<polygon fill="black" stroke="black" points="899.11,-14483.02 904.71,-14474.03 894.73,-14477.56 899.11,-14483.02"/>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_0_ffn1 -->
<g id="edge446" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-14542.54C959.2,-14522.88 898.07,-14497.43 851.32,-14477.96"/>
<polygon fill="black" stroke="black" points="852.45,-14474.64 841.87,-14474.03 849.76,-14481.1 852.45,-14474.64"/>
<text text-anchor="middle" x="924.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_1_ffn1 -->
<g id="edge450" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-14556.72C833.08,-14539.17 630.07,-14509.21 445.54,-14474.14"/>
<polygon fill="black" stroke="black" points="446.13,-14470.69 435.65,-14472.25 444.82,-14477.56 446.13,-14470.69"/>
<text text-anchor="middle" x="623.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_2_ffn1 -->
<g id="edge454" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-14531.47C1129.09,-14518.16 1143.87,-14503.81 1158.57,-14492 1163.82,-14487.78 1169.5,-14483.65 1175.28,-14479.71"/>
<polygon fill="black" stroke="black" points="1177.37,-14482.52 1183.77,-14474.09 1173.5,-14476.68 1177.37,-14482.52"/>
<text text-anchor="middle" x="1180.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_3_ffn1 -->
<g id="edge458" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-14551.7C1263.24,-14535.33 1376.38,-14512.18 1475.57,-14492 1512.26,-14484.54 1523.52,-14482.73 1563.55,-14474.2"/>
<polygon fill="black" stroke="black" points="1564.41,-14477.59 1573.46,-14472.08 1562.94,-14470.75 1564.41,-14477.59"/>
<text text-anchor="middle" x="1497.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_4_ffn1 -->
<g id="edge462" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-14549.8C893.49,-14528.7 762.7,-14497.57 669.53,-14475.39"/>
<polygon fill="black" stroke="black" points="670.33,-14471.98 659.79,-14473.07 668.7,-14478.79 670.33,-14471.98"/>
<text text-anchor="middle" x="792.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_5_ffn1 -->
<g id="edge466" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-14542.6C1193.35,-14526.52 1244.3,-14507.05 1290.57,-14492 1306.78,-14486.73 1324.04,-14481.6 1341.02,-14476.81"/>
<polygon fill="black" stroke="black" points="1342.29,-14480.09 1350.98,-14474.04 1340.41,-14473.35 1342.29,-14480.09"/>
<text text-anchor="middle" x="1312.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_6_ffn1 -->
<g id="edge470" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-14558.57C1346.62,-14541.91 1578.71,-14512.07 1787.57,-14474.13"/>
<polygon fill="black" stroke="black" points="1788.29,-14477.55 1797.5,-14472.31 1787.04,-14470.67 1788.29,-14477.55"/>
<text text-anchor="middle" x="1694.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_7_gate&#45;&gt;layer_7_expert_7_ffn1 -->
<g id="edge474" class="edge">
<title>layer_7_gate&#45;&gt;layer_7_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-14528.76C1043.87,-14513.73 1033.9,-14497.18 1025.37,-14483.03"/>
<polygon fill="black" stroke="black" points="1028.16,-14480.88 1020,-14474.12 1022.17,-14484.49 1028.16,-14480.88"/>
<text text-anchor="middle" x="1056.57" y="-14495" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_7_expert_0_gelu -->
<g id="node312" class="node">
<title>layer_7_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-14384 677.57,-14384 677.57,-14331 883.57,-14331 883.57,-14384"/>
<text text-anchor="middle" x="780.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_0_ffn1&#45;&gt;layer_7_expert_0_gelu -->
<g id="edge448" class="edge">
<title>layer_7_expert_0_ffn1&#45;&gt;layer_7_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-14420.57C780.57,-14412.34 780.57,-14403.08 780.57,-14394.28"/>
<polygon fill="black" stroke="black" points="784.07,-14394.24 780.57,-14384.24 777.07,-14394.24 784.07,-14394.24"/>
</g>
<!-- layer_7_expert_0_ffn2 -->
<g id="node313" class="node">
<title>layer_7_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-14294 677.57,-14294 677.57,-14241 883.57,-14241 883.57,-14294"/>
<text text-anchor="middle" x="780.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_0_gelu&#45;&gt;layer_7_expert_0_ffn2 -->
<g id="edge449" class="edge">
<title>layer_7_expert_0_gelu&#45;&gt;layer_7_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-14330.57C780.57,-14322.34 780.57,-14313.08 780.57,-14304.28"/>
<polygon fill="black" stroke="black" points="784.07,-14304.24 780.57,-14294.24 777.07,-14304.24 784.07,-14304.24"/>
</g>
<!-- layer_7_expert_agg -->
<g id="node335" class="node">
<title>layer_7_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-14204 878.36,-14204 790.93,-14098 1130.79,-14098 1218.21,-14204"/>
<text text-anchor="middle" x="1004.57" y="-14162.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-14147.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-14132.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_0_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge478" class="edge">
<title>layer_7_expert_0_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-14240.95C849.26,-14231.39 871.33,-14220.11 893.35,-14208.85"/>
<polygon fill="black" stroke="black" points="895.14,-14211.87 902.45,-14204.2 891.95,-14205.64 895.14,-14211.87"/>
</g>
<!-- layer_7_expert_1_gelu -->
<g id="node315" class="node">
<title>layer_7_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-14384 229.57,-14384 229.57,-14331 435.57,-14331 435.57,-14384"/>
<text text-anchor="middle" x="332.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_1_ffn1&#45;&gt;layer_7_expert_1_gelu -->
<g id="edge452" class="edge">
<title>layer_7_expert_1_ffn1&#45;&gt;layer_7_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-14420.57C332.57,-14412.34 332.57,-14403.08 332.57,-14394.28"/>
<polygon fill="black" stroke="black" points="336.07,-14394.24 332.57,-14384.24 329.07,-14394.24 336.07,-14394.24"/>
</g>
<!-- layer_7_expert_1_ffn2 -->
<g id="node316" class="node">
<title>layer_7_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-14294 229.57,-14294 229.57,-14241 435.57,-14241 435.57,-14294"/>
<text text-anchor="middle" x="332.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_1_gelu&#45;&gt;layer_7_expert_1_ffn2 -->
<g id="edge453" class="edge">
<title>layer_7_expert_1_gelu&#45;&gt;layer_7_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-14330.57C332.57,-14322.34 332.57,-14313.08 332.57,-14304.28"/>
<polygon fill="black" stroke="black" points="336.07,-14304.24 332.57,-14294.24 329.07,-14304.24 336.07,-14304.24"/>
</g>
<!-- layer_7_expert_1_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge479" class="edge">
<title>layer_7_expert_1_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-14242.76C438.66,-14242.16 441.63,-14241.57 444.57,-14241 578.16,-14215.21 730.72,-14191.32 842.83,-14174.81"/>
<polygon fill="black" stroke="black" points="843.49,-14178.25 852.87,-14173.33 842.47,-14171.32 843.49,-14178.25"/>
</g>
<!-- layer_7_expert_2_gelu -->
<g id="node318" class="node">
<title>layer_7_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-14384 1125.57,-14384 1125.57,-14331 1331.57,-14331 1331.57,-14384"/>
<text text-anchor="middle" x="1228.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_2_ffn1&#45;&gt;layer_7_expert_2_gelu -->
<g id="edge456" class="edge">
<title>layer_7_expert_2_ffn1&#45;&gt;layer_7_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-14420.57C1228.57,-14412.34 1228.57,-14403.08 1228.57,-14394.28"/>
<polygon fill="black" stroke="black" points="1232.07,-14394.24 1228.57,-14384.24 1225.07,-14394.24 1232.07,-14394.24"/>
</g>
<!-- layer_7_expert_2_ffn2 -->
<g id="node319" class="node">
<title>layer_7_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-14294 1125.57,-14294 1125.57,-14241 1331.57,-14241 1331.57,-14294"/>
<text text-anchor="middle" x="1228.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_2_gelu&#45;&gt;layer_7_expert_2_ffn2 -->
<g id="edge457" class="edge">
<title>layer_7_expert_2_gelu&#45;&gt;layer_7_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-14330.57C1228.57,-14322.34 1228.57,-14313.08 1228.57,-14304.28"/>
<polygon fill="black" stroke="black" points="1232.07,-14304.24 1228.57,-14294.24 1225.07,-14304.24 1232.07,-14304.24"/>
</g>
<!-- layer_7_expert_2_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge480" class="edge">
<title>layer_7_expert_2_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-14240.95C1159.88,-14231.39 1137.81,-14220.11 1115.79,-14208.85"/>
<polygon fill="black" stroke="black" points="1117.19,-14205.64 1106.7,-14204.2 1114.01,-14211.87 1117.19,-14205.64"/>
</g>
<!-- layer_7_expert_3_gelu -->
<g id="node321" class="node">
<title>layer_7_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-14384 1573.57,-14384 1573.57,-14331 1779.57,-14331 1779.57,-14384"/>
<text text-anchor="middle" x="1676.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_3_ffn1&#45;&gt;layer_7_expert_3_gelu -->
<g id="edge460" class="edge">
<title>layer_7_expert_3_ffn1&#45;&gt;layer_7_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-14420.57C1676.57,-14412.34 1676.57,-14403.08 1676.57,-14394.28"/>
<polygon fill="black" stroke="black" points="1680.07,-14394.24 1676.57,-14384.24 1673.07,-14394.24 1680.07,-14394.24"/>
</g>
<!-- layer_7_expert_3_ffn2 -->
<g id="node322" class="node">
<title>layer_7_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-14294 1573.57,-14294 1573.57,-14241 1779.57,-14241 1779.57,-14294"/>
<text text-anchor="middle" x="1676.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_3_gelu&#45;&gt;layer_7_expert_3_ffn2 -->
<g id="edge461" class="edge">
<title>layer_7_expert_3_gelu&#45;&gt;layer_7_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-14330.57C1676.57,-14322.34 1676.57,-14313.08 1676.57,-14304.28"/>
<polygon fill="black" stroke="black" points="1680.07,-14304.24 1676.57,-14294.24 1673.07,-14304.24 1680.07,-14304.24"/>
</g>
<!-- layer_7_expert_3_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge481" class="edge">
<title>layer_7_expert_3_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-14242.76C1570.49,-14242.16 1567.51,-14241.57 1564.57,-14241 1446.94,-14218.29 1314.59,-14197.06 1208.1,-14181.03"/>
<polygon fill="black" stroke="black" points="1208.61,-14177.57 1198.21,-14179.54 1207.58,-14184.49 1208.61,-14177.57"/>
</g>
<!-- layer_7_expert_4_gelu -->
<g id="node324" class="node">
<title>layer_7_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-14384 453.57,-14384 453.57,-14331 659.57,-14331 659.57,-14384"/>
<text text-anchor="middle" x="556.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_4_ffn1&#45;&gt;layer_7_expert_4_gelu -->
<g id="edge464" class="edge">
<title>layer_7_expert_4_ffn1&#45;&gt;layer_7_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-14420.57C556.57,-14412.34 556.57,-14403.08 556.57,-14394.28"/>
<polygon fill="black" stroke="black" points="560.07,-14394.24 556.57,-14384.24 553.07,-14394.24 560.07,-14394.24"/>
</g>
<!-- layer_7_expert_4_ffn2 -->
<g id="node325" class="node">
<title>layer_7_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-14294 453.57,-14294 453.57,-14241 659.57,-14241 659.57,-14294"/>
<text text-anchor="middle" x="556.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_4_gelu&#45;&gt;layer_7_expert_4_ffn2 -->
<g id="edge465" class="edge">
<title>layer_7_expert_4_gelu&#45;&gt;layer_7_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-14330.57C556.57,-14322.34 556.57,-14313.08 556.57,-14304.28"/>
<polygon fill="black" stroke="black" points="560.07,-14304.24 556.57,-14294.24 553.07,-14304.24 560.07,-14304.24"/>
</g>
<!-- layer_7_expert_4_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge482" class="edge">
<title>layer_7_expert_4_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-14240.95C714.81,-14226.06 789.41,-14206.99 854.59,-14190.33"/>
<polygon fill="black" stroke="black" points="855.73,-14193.65 864.55,-14187.79 853.99,-14186.87 855.73,-14193.65"/>
</g>
<!-- layer_7_expert_5_gelu -->
<g id="node327" class="node">
<title>layer_7_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-14384 1349.57,-14384 1349.57,-14331 1555.57,-14331 1555.57,-14384"/>
<text text-anchor="middle" x="1452.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_5_ffn1&#45;&gt;layer_7_expert_5_gelu -->
<g id="edge468" class="edge">
<title>layer_7_expert_5_ffn1&#45;&gt;layer_7_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-14420.57C1452.57,-14412.34 1452.57,-14403.08 1452.57,-14394.28"/>
<polygon fill="black" stroke="black" points="1456.07,-14394.24 1452.57,-14384.24 1449.07,-14394.24 1456.07,-14394.24"/>
</g>
<!-- layer_7_expert_5_ffn2 -->
<g id="node328" class="node">
<title>layer_7_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-14294 1349.57,-14294 1349.57,-14241 1555.57,-14241 1555.57,-14294"/>
<text text-anchor="middle" x="1452.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_5_gelu&#45;&gt;layer_7_expert_5_ffn2 -->
<g id="edge469" class="edge">
<title>layer_7_expert_5_gelu&#45;&gt;layer_7_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-14330.57C1452.57,-14322.34 1452.57,-14313.08 1452.57,-14304.28"/>
<polygon fill="black" stroke="black" points="1456.07,-14304.24 1452.57,-14294.24 1449.07,-14304.24 1456.07,-14304.24"/>
</g>
<!-- layer_7_expert_5_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge483" class="edge">
<title>layer_7_expert_5_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-14240.95C1312.66,-14230.74 1265.05,-14218.57 1218.07,-14206.57"/>
<polygon fill="black" stroke="black" points="1218.92,-14203.17 1208.37,-14204.09 1217.19,-14209.95 1218.92,-14203.17"/>
</g>
<!-- layer_7_expert_6_gelu -->
<g id="node330" class="node">
<title>layer_7_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-14384 1797.57,-14384 1797.57,-14331 2003.57,-14331 2003.57,-14384"/>
<text text-anchor="middle" x="1900.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_6_ffn1&#45;&gt;layer_7_expert_6_gelu -->
<g id="edge472" class="edge">
<title>layer_7_expert_6_ffn1&#45;&gt;layer_7_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-14420.57C1900.57,-14412.34 1900.57,-14403.08 1900.57,-14394.28"/>
<polygon fill="black" stroke="black" points="1904.07,-14394.24 1900.57,-14384.24 1897.07,-14394.24 1904.07,-14394.24"/>
</g>
<!-- layer_7_expert_6_ffn2 -->
<g id="node331" class="node">
<title>layer_7_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-14294 1797.57,-14294 1797.57,-14241 2003.57,-14241 2003.57,-14294"/>
<text text-anchor="middle" x="1900.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_6_gelu&#45;&gt;layer_7_expert_6_ffn2 -->
<g id="edge473" class="edge">
<title>layer_7_expert_6_gelu&#45;&gt;layer_7_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-14330.57C1900.57,-14322.34 1900.57,-14313.08 1900.57,-14304.28"/>
<polygon fill="black" stroke="black" points="1904.07,-14304.24 1900.57,-14294.24 1897.07,-14304.24 1904.07,-14304.24"/>
</g>
<!-- layer_7_expert_6_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge484" class="edge">
<title>layer_7_expert_6_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-14242.59C1794.51,-14242.03 1791.52,-14241.5 1788.57,-14241 1588.54,-14206.98 1357.51,-14182.53 1198.33,-14167.97"/>
<polygon fill="black" stroke="black" points="1198.23,-14164.45 1187.95,-14167.03 1197.59,-14171.42 1198.23,-14164.45"/>
</g>
<!-- layer_7_expert_7_gelu -->
<g id="node333" class="node">
<title>layer_7_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-14384 901.57,-14384 901.57,-14331 1107.57,-14331 1107.57,-14384"/>
<text text-anchor="middle" x="1004.57" y="-14368.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-14353.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-14338.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_7_ffn1&#45;&gt;layer_7_expert_7_gelu -->
<g id="edge476" class="edge">
<title>layer_7_expert_7_ffn1&#45;&gt;layer_7_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-14420.57C1004.57,-14412.34 1004.57,-14403.08 1004.57,-14394.28"/>
<polygon fill="black" stroke="black" points="1008.07,-14394.24 1004.57,-14384.24 1001.07,-14394.24 1008.07,-14394.24"/>
</g>
<!-- layer_7_expert_7_ffn2 -->
<g id="node334" class="node">
<title>layer_7_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-14294 901.57,-14294 901.57,-14241 1107.57,-14241 1107.57,-14294"/>
<text text-anchor="middle" x="1004.57" y="-14278.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-14263.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-14248.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_expert_7_gelu&#45;&gt;layer_7_expert_7_ffn2 -->
<g id="edge477" class="edge">
<title>layer_7_expert_7_gelu&#45;&gt;layer_7_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-14330.57C1004.57,-14322.34 1004.57,-14313.08 1004.57,-14304.28"/>
<polygon fill="black" stroke="black" points="1008.07,-14304.24 1004.57,-14294.24 1001.07,-14304.24 1008.07,-14304.24"/>
</g>
<!-- layer_7_expert_7_ffn2&#45;&gt;layer_7_expert_agg -->
<g id="edge485" class="edge">
<title>layer_7_expert_7_ffn2&#45;&gt;layer_7_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-14240.8C1004.57,-14232.86 1004.57,-14223.74 1004.57,-14214.44"/>
<polygon fill="black" stroke="black" points="1008.07,-14214.32 1004.57,-14204.32 1001.07,-14214.32 1008.07,-14214.32"/>
</g>
<!-- layer_7_expert_agg&#45;&gt;layer_7_add -->
<g id="edge487" class="edge">
<title>layer_7_expert_agg&#45;&gt;layer_7_add</title>
<path fill="none" stroke="black" d="M810.56,-14121.92C658.7,-14099.93 452.76,-14070.12 326.73,-14051.88"/>
<polygon fill="black" stroke="black" points="327.07,-14048.39 316.67,-14050.42 326.07,-14055.32 327.07,-14048.39"/>
</g>
<!-- comm_7_8 -->
<g id="node337" class="node">
<title>comm_7_8</title>
<polygon fill="yellow" stroke="black" points="427.21,-13971 87.36,-13971 -0.07,-13865 339.79,-13865 427.21,-13971"/>
<text text-anchor="middle" x="213.57" y="-13929.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-13914.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-13899.3" font-family="Times,serif" font-size="14.00">GPU 7  GPU 8</text>
</g>
<!-- layer_7_add&#45;&gt;comm_7_8 -->
<g id="edge488" class="edge">
<title>layer_7_add&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M213.57,-14007.8C213.57,-13999.86 213.57,-13990.74 213.57,-13981.44"/>
<polygon fill="black" stroke="black" points="217.07,-13981.32 213.57,-13971.32 210.07,-13981.32 217.07,-13981.32"/>
</g>
<!-- layer_8_ln1 -->
<g id="node338" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-13828 291.57,-13828 291.57,-13775 497.57,-13775 497.57,-13828"/>
<text text-anchor="middle" x="394.57" y="-13812.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-13797.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-13782.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- comm_7_8&#45;&gt;layer_8_ln1 -->
<g id="edge489" class="edge">
<title>comm_7_8&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M295.86,-13864.94C312.72,-13854.28 329.97,-13843.37 345.23,-13833.71"/>
<polygon fill="black" stroke="black" points="347.39,-13836.49 353.97,-13828.18 343.65,-13830.57 347.39,-13836.49"/>
</g>
<!-- layer_8_add1 -->
<g id="node350" class="node">
<title>layer_8_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-13056 110.57,-13056 110.57,-13003 316.57,-13003 316.57,-13056"/>
<text text-anchor="middle" x="213.57" y="-13040.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-13025.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-13010.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- comm_7_8&#45;&gt;layer_8_add1 -->
<g id="edge503" class="edge">
<title>comm_7_8&#45;&gt;layer_8_add1</title>
<path fill="none" stroke="black" d="M205.8,-13864.97C203.49,-13845.42 201.57,-13822.99 201.57,-13802.5 201.57,-13802.5 201.57,-13802.5 201.57,-13118.5 201.57,-13101.17 203.88,-13082.1 206.48,-13066.15"/>
<polygon fill="black" stroke="black" points="209.95,-13066.62 208.2,-13056.17 203.05,-13065.43 209.95,-13066.62"/>
</g>
<!-- layer_8_q_proj -->
<g id="node339" class="node">
<title>layer_8_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-13738 453.57,-13738 453.57,-13685 659.57,-13685 659.57,-13738"/>
<text text-anchor="middle" x="556.57" y="-13722.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-13707.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-13692.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_q_proj -->
<g id="edge490" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-13774.81C460.25,-13764.82 481.45,-13753.31 500.58,-13742.91"/>
<polygon fill="black" stroke="black" points="502.38,-13745.92 509.5,-13738.07 499.04,-13739.77 502.38,-13745.92"/>
</g>
<!-- layer_8_k_proj -->
<g id="node340" class="node">
<title>layer_8_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-13738 677.57,-13738 677.57,-13685 883.57,-13685 883.57,-13738"/>
<text text-anchor="middle" x="780.57" y="-13722.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-13707.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-13692.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_k_proj -->
<g id="edge491" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-13776.98C550.11,-13765.04 613.8,-13750.52 667.48,-13738.28"/>
<polygon fill="black" stroke="black" points="668.41,-13741.66 677.38,-13736.02 666.86,-13734.83 668.41,-13741.66"/>
</g>
<!-- layer_8_v_proj -->
<g id="node341" class="node">
<title>layer_8_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-13738 229.57,-13738 229.57,-13685 435.57,-13685 435.57,-13738"/>
<text text-anchor="middle" x="332.57" y="-13722.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-13707.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-13692.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_v_proj -->
<g id="edge492" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-13774.57C370.12,-13765.8 363.13,-13755.87 356.57,-13746.56"/>
<polygon fill="black" stroke="black" points="359.33,-13744.4 350.71,-13738.24 353.61,-13748.43 359.33,-13744.4"/>
</g>
<!-- layer_8_q_reshape -->
<g id="node342" class="node">
<title>layer_8_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-13648 426.57,-13648 426.57,-13595 650.57,-13595 650.57,-13648"/>
<text text-anchor="middle" x="538.57" y="-13632.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-13617.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-13602.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_q_proj&#45;&gt;layer_8_q_reshape -->
<g id="edge493" class="edge">
<title>layer_8_q_proj&#45;&gt;layer_8_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-13684.57C549.58,-13676.34 547.69,-13667.08 545.89,-13658.28"/>
<polygon fill="black" stroke="black" points="549.27,-13657.34 543.84,-13648.24 542.41,-13658.74 549.27,-13657.34"/>
</g>
<!-- layer_8_k_reshape -->
<g id="node343" class="node">
<title>layer_8_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-13648 668.57,-13648 668.57,-13595 892.57,-13595 892.57,-13648"/>
<text text-anchor="middle" x="780.57" y="-13632.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-13617.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-13602.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_k_proj&#45;&gt;layer_8_k_reshape -->
<g id="edge494" class="edge">
<title>layer_8_k_proj&#45;&gt;layer_8_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-13684.57C780.57,-13676.34 780.57,-13667.08 780.57,-13658.28"/>
<polygon fill="black" stroke="black" points="784.07,-13658.24 780.57,-13648.24 777.07,-13658.24 784.07,-13658.24"/>
</g>
<!-- layer_8_v_reshape -->
<g id="node344" class="node">
<title>layer_8_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-13577 225.57,-13577 225.57,-13524 449.57,-13524 449.57,-13577"/>
<text text-anchor="middle" x="337.57" y="-13561.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-13546.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-13531.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_v_proj&#45;&gt;layer_8_v_reshape -->
<g id="edge495" class="edge">
<title>layer_8_v_proj&#45;&gt;layer_8_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-13684.95C334.2,-13658.61 335.5,-13617.29 336.44,-13587.61"/>
<polygon fill="black" stroke="black" points="339.95,-13587.35 336.76,-13577.25 332.95,-13587.13 339.95,-13587.35"/>
</g>
<!-- layer_8_attn_scores -->
<g id="node345" class="node">
<title>layer_8_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-13506 422.07,-13506 422.07,-13453 655.07,-13453 655.07,-13506"/>
<text text-anchor="middle" x="538.57" y="-13490.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-13475.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-13460.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_q_reshape&#45;&gt;layer_8_attn_scores -->
<g id="edge496" class="edge">
<title>layer_8_q_reshape&#45;&gt;layer_8_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-13594.82C538.57,-13572.72 538.57,-13540.6 538.57,-13516.03"/>
<polygon fill="black" stroke="black" points="542.07,-13516.02 538.57,-13506.02 535.07,-13516.02 542.07,-13516.02"/>
</g>
<!-- layer_8_k_reshape&#45;&gt;layer_8_attn_scores -->
<g id="edge497" class="edge">
<title>layer_8_k_reshape&#45;&gt;layer_8_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-13594.98C695.65,-13571.37 634.91,-13536.23 591.5,-13511.12"/>
<polygon fill="black" stroke="black" points="593.19,-13508.05 582.78,-13506.08 589.68,-13514.11 593.19,-13508.05"/>
</g>
<!-- layer_8_attn_output -->
<g id="node347" class="node">
<title>layer_8_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-13326 229.57,-13326 229.57,-13273 453.57,-13273 453.57,-13326"/>
<text text-anchor="middle" x="341.57" y="-13310.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-13295.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-13280.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_v_reshape&#45;&gt;layer_8_attn_output -->
<g id="edge500" class="edge">
<title>layer_8_v_reshape&#45;&gt;layer_8_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-13523.79C338.7,-13479.13 340.18,-13387.13 341,-13336.27"/>
<polygon fill="black" stroke="black" points="344.5,-13336.12 341.16,-13326.07 337.5,-13336.01 344.5,-13336.12"/>
</g>
<!-- layer_8_attn_weights -->
<g id="node346" class="node">
<title>layer_8_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="627.07,-13416 394.07,-13416 394.07,-13363 627.07,-13363 627.07,-13416"/>
<text text-anchor="middle" x="510.57" y="-13400.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="510.57" y="-13385.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="510.57" y="-13370.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_scores&#45;&gt;layer_8_attn_weights -->
<g id="edge498" class="edge">
<title>layer_8_attn_scores&#45;&gt;layer_8_attn_weights</title>
<path fill="none" stroke="black" d="M530.32,-13452.57C527.67,-13444.25 524.69,-13434.88 521.86,-13425.99"/>
<polygon fill="black" stroke="black" points="525.13,-13424.71 518.76,-13416.24 518.46,-13426.83 525.13,-13424.71"/>
</g>
<!-- layer_8_attn_weights&#45;&gt;layer_8_attn_output -->
<g id="edge499" class="edge">
<title>layer_8_attn_weights&#45;&gt;layer_8_attn_output</title>
<path fill="none" stroke="black" d="M461.24,-13362.81C441.97,-13352.78 419.74,-13341.2 399.71,-13330.77"/>
<polygon fill="black" stroke="black" points="401.16,-13327.58 390.68,-13326.07 397.93,-13333.79 401.16,-13327.58"/>
</g>
<!-- layer_8_attn_reshape -->
<g id="node348" class="node">
<title>layer_8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-13236 236.57,-13236 236.57,-13183 442.57,-13183 442.57,-13236"/>
<text text-anchor="middle" x="339.57" y="-13220.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-13205.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-13190.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_output&#45;&gt;layer_8_attn_reshape -->
<g id="edge501" class="edge">
<title>layer_8_attn_output&#45;&gt;layer_8_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-13272.57C340.79,-13264.34 340.58,-13255.08 340.38,-13246.28"/>
<polygon fill="black" stroke="black" points="343.88,-13246.16 340.16,-13236.24 336.88,-13246.32 343.88,-13246.16"/>
</g>
<!-- layer_8_attn_proj -->
<g id="node349" class="node">
<title>layer_8_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-13146 233.57,-13146 233.57,-13093 439.57,-13093 439.57,-13146"/>
<text text-anchor="middle" x="336.57" y="-13130.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-13115.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-13100.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_reshape&#45;&gt;layer_8_attn_proj -->
<g id="edge502" class="edge">
<title>layer_8_attn_reshape&#45;&gt;layer_8_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-13182.57C338.41,-13174.34 338.09,-13165.08 337.79,-13156.28"/>
<polygon fill="black" stroke="black" points="341.29,-13156.12 337.45,-13146.24 334.29,-13156.36 341.29,-13156.12"/>
</g>
<!-- layer_8_attn_proj&#45;&gt;layer_8_add1 -->
<g id="edge504" class="edge">
<title>layer_8_attn_proj&#45;&gt;layer_8_add1</title>
<path fill="none" stroke="black" d="M300.66,-13092.81C287.15,-13083.14 271.63,-13072.04 257.47,-13061.9"/>
<polygon fill="black" stroke="black" points="259.48,-13059.04 249.31,-13056.07 255.41,-13064.73 259.48,-13059.04"/>
</g>
<!-- layer_8_ln2 -->
<g id="node351" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-12966 827.57,-12966 827.57,-12913 1033.57,-12913 1033.57,-12966"/>
<text text-anchor="middle" x="930.57" y="-12950.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-12935.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-12920.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_add1&#45;&gt;layer_8_ln2 -->
<g id="edge505" class="edge">
<title>layer_8_add1&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M316.68,-13015.84C449.47,-12999.55 679.5,-12971.31 817.13,-12954.42"/>
<polygon fill="black" stroke="black" points="817.78,-12957.87 827.28,-12953.18 816.93,-12950.92 817.78,-12957.87"/>
</g>
<!-- layer_8_add -->
<g id="node378" class="node">
<title>layer_8_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-12310 110.57,-12310 110.57,-12257 316.57,-12257 316.57,-12310"/>
<text text-anchor="middle" x="213.57" y="-12294.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-12279.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-12264.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_add1&#45;&gt;layer_8_add -->
<g id="edge547" class="edge">
<title>layer_8_add1&#45;&gt;layer_8_add</title>
<path fill="none" stroke="black" d="M208.2,-13002.83C205.01,-12985.34 201.57,-12961.62 201.57,-12940.5 201.57,-12940.5 201.57,-12940.5 201.57,-12399 201.57,-12372.6 204.77,-12342.96 207.86,-12320.46"/>
<polygon fill="black" stroke="black" points="211.35,-12320.73 209.31,-12310.34 204.42,-12319.74 211.35,-12320.73"/>
</g>
<!-- layer_8_gate -->
<g id="node352" class="node">
<title>layer_8_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-12876 900.57,-12823 1079.57,-12770 1258.57,-12823 1079.57,-12876"/>
<text text-anchor="middle" x="1079.57" y="-12834.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-12819.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-12804.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_gate -->
<g id="edge506" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_gate</title>
<path fill="none" stroke="black" d="M964.01,-12912.8C981.28,-12899.53 1002.83,-12882.97 1022.63,-12867.76"/>
<polygon fill="black" stroke="black" points="1024.9,-12870.43 1030.69,-12861.56 1020.63,-12864.88 1024.9,-12870.43"/>
</g>
<!-- layer_8_expert_0_ffn1 -->
<g id="node353" class="node">
<title>layer_8_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-12723 677.57,-12723 677.57,-12670 883.57,-12670 883.57,-12723"/>
<text text-anchor="middle" x="780.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_0_ffn1 -->
<g id="edge508" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-12912.95C887.23,-12902.28 873.96,-12889.28 863.57,-12876 824.71,-12826.33 817.94,-12810.58 794.57,-12752 792.17,-12745.99 790.08,-12739.43 788.29,-12733.02"/>
<polygon fill="black" stroke="black" points="791.63,-12731.97 785.73,-12723.17 784.85,-12733.72 791.63,-12731.97"/>
</g>
<!-- layer_8_expert_1_ffn1 -->
<g id="node356" class="node">
<title>layer_8_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-12723 229.57,-12723 229.57,-12670 435.57,-12670 435.57,-12723"/>
<text text-anchor="middle" x="332.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_1_ffn1 -->
<g id="edge512" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-12926.27C767.36,-12916.96 691.02,-12901.31 626.57,-12876 529.83,-12838.01 428.72,-12769.16 373.91,-12728.98"/>
<polygon fill="black" stroke="black" points="375.97,-12726.14 365.84,-12723.02 371.81,-12731.78 375.97,-12726.14"/>
</g>
<!-- layer_8_expert_2_ffn1 -->
<g id="node359" class="node">
<title>layer_8_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-12723 1125.57,-12723 1125.57,-12670 1331.57,-12670 1331.57,-12723"/>
<text text-anchor="middle" x="1228.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_2_ffn1 -->
<g id="edge516" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-12933.17C1121.34,-12926.26 1237.52,-12910.69 1267.57,-12876 1306.88,-12830.62 1295.71,-12796.4 1272.57,-12741 1271.12,-12737.52 1269.24,-12734.18 1267.08,-12731.01"/>
<polygon fill="black" stroke="black" points="1269.72,-12728.71 1260.79,-12723.01 1264.22,-12733.03 1269.72,-12728.71"/>
</g>
<!-- layer_8_expert_3_ffn1 -->
<g id="node362" class="node">
<title>layer_8_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-12723 1573.57,-12723 1573.57,-12670 1779.57,-12670 1779.57,-12723"/>
<text text-anchor="middle" x="1676.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_3_ffn1 -->
<g id="edge520" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-12933.82C1122.76,-12927.39 1253.8,-12912.14 1362.57,-12876 1484.83,-12835.38 1520.13,-12827.42 1624.57,-12752 1633.08,-12745.86 1641.36,-12738.21 1648.73,-12730.6"/>
<polygon fill="black" stroke="black" points="1651.49,-12732.77 1655.76,-12723.07 1646.38,-12727.99 1651.49,-12732.77"/>
</g>
<!-- layer_8_expert_4_ffn1 -->
<g id="node365" class="node">
<title>layer_8_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-12723 453.57,-12723 453.57,-12670 659.57,-12670 659.57,-12723"/>
<text text-anchor="middle" x="556.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_4_ffn1 -->
<g id="edge524" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-12912.89C801.11,-12881.58 686.43,-12823.79 603.57,-12752 596.29,-12745.69 589.13,-12738.24 582.68,-12730.9"/>
<polygon fill="black" stroke="black" points="585.14,-12728.39 575.99,-12723.05 579.81,-12732.93 585.14,-12728.39"/>
</g>
<!-- layer_8_expert_5_ffn1 -->
<g id="node368" class="node">
<title>layer_8_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-12723 1349.57,-12723 1349.57,-12670 1555.57,-12670 1555.57,-12723"/>
<text text-anchor="middle" x="1452.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_5_ffn1 -->
<g id="edge528" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-12932.77C1098.02,-12927.2 1181.84,-12916.3 1253.57,-12895 1272.44,-12889.4 1277.44,-12887.28 1293.57,-12876 1357.95,-12830.96 1370.85,-12813.64 1419.57,-12752 1424.54,-12745.72 1429.34,-12738.63 1433.66,-12731.69"/>
<polygon fill="black" stroke="black" points="1436.7,-12733.43 1438.87,-12723.05 1430.71,-12729.81 1436.7,-12733.43"/>
</g>
<!-- layer_8_expert_6_ffn1 -->
<g id="node371" class="node">
<title>layer_8_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-12723 1797.57,-12723 1797.57,-12670 2003.57,-12670 2003.57,-12723"/>
<text text-anchor="middle" x="1900.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_6_ffn1 -->
<g id="edge532" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-12936.36C1147.98,-12931.86 1336.72,-12918.05 1493.57,-12876 1625.52,-12840.63 1769.63,-12768.8 1845.97,-12727.86"/>
<polygon fill="black" stroke="black" points="1847.8,-12730.86 1854.94,-12723.03 1844.47,-12724.69 1847.8,-12730.86"/>
</g>
<!-- layer_8_expert_7_ffn1 -->
<g id="node374" class="node">
<title>layer_8_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-12723 901.57,-12723 901.57,-12670 1107.57,-12670 1107.57,-12723"/>
<text text-anchor="middle" x="1004.57" y="-12707.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_expert_7_ffn1 -->
<g id="edge536" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-12912.92C903.08,-12902.14 895.6,-12889.08 891.57,-12876 873.88,-12818.62 852.23,-12790.25 886.57,-12741 889.58,-12736.69 893.06,-12732.8 896.91,-12729.3"/>
<polygon fill="black" stroke="black" points="899.11,-12732.02 904.71,-12723.03 894.73,-12726.56 899.11,-12732.02"/>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_0_ffn1 -->
<g id="edge507" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-12791.54C959.2,-12771.88 898.07,-12746.43 851.32,-12726.96"/>
<polygon fill="black" stroke="black" points="852.45,-12723.64 841.87,-12723.03 849.76,-12730.1 852.45,-12723.64"/>
<text text-anchor="middle" x="924.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_1_ffn1 -->
<g id="edge511" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-12805.72C833.08,-12788.17 630.07,-12758.21 445.54,-12723.14"/>
<polygon fill="black" stroke="black" points="446.13,-12719.69 435.65,-12721.25 444.82,-12726.56 446.13,-12719.69"/>
<text text-anchor="middle" x="623.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_2_ffn1 -->
<g id="edge515" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-12780.47C1129.09,-12767.16 1143.87,-12752.81 1158.57,-12741 1163.82,-12736.78 1169.5,-12732.65 1175.28,-12728.71"/>
<polygon fill="black" stroke="black" points="1177.37,-12731.52 1183.77,-12723.09 1173.5,-12725.68 1177.37,-12731.52"/>
<text text-anchor="middle" x="1180.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_3_ffn1 -->
<g id="edge519" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-12800.7C1263.24,-12784.33 1376.38,-12761.18 1475.57,-12741 1512.26,-12733.54 1523.52,-12731.73 1563.55,-12723.2"/>
<polygon fill="black" stroke="black" points="1564.41,-12726.59 1573.46,-12721.08 1562.94,-12719.75 1564.41,-12726.59"/>
<text text-anchor="middle" x="1497.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_4_ffn1 -->
<g id="edge523" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-12798.8C893.49,-12777.7 762.7,-12746.57 669.53,-12724.39"/>
<polygon fill="black" stroke="black" points="670.33,-12720.98 659.79,-12722.07 668.7,-12727.79 670.33,-12720.98"/>
<text text-anchor="middle" x="792.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_5_ffn1 -->
<g id="edge527" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-12791.6C1193.35,-12775.52 1244.3,-12756.05 1290.57,-12741 1306.78,-12735.73 1324.04,-12730.6 1341.02,-12725.81"/>
<polygon fill="black" stroke="black" points="1342.29,-12729.09 1350.98,-12723.04 1340.41,-12722.35 1342.29,-12729.09"/>
<text text-anchor="middle" x="1312.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_6_ffn1 -->
<g id="edge531" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-12807.57C1346.62,-12790.91 1578.71,-12761.07 1787.57,-12723.13"/>
<polygon fill="black" stroke="black" points="1788.29,-12726.55 1797.5,-12721.31 1787.04,-12719.67 1788.29,-12726.55"/>
<text text-anchor="middle" x="1694.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_8_gate&#45;&gt;layer_8_expert_7_ffn1 -->
<g id="edge535" class="edge">
<title>layer_8_gate&#45;&gt;layer_8_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-12777.76C1043.87,-12762.73 1033.9,-12746.18 1025.37,-12732.03"/>
<polygon fill="black" stroke="black" points="1028.16,-12729.88 1020,-12723.12 1022.17,-12733.49 1028.16,-12729.88"/>
<text text-anchor="middle" x="1056.57" y="-12744" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_8_expert_0_gelu -->
<g id="node354" class="node">
<title>layer_8_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-12633 677.57,-12633 677.57,-12580 883.57,-12580 883.57,-12633"/>
<text text-anchor="middle" x="780.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_0_ffn1&#45;&gt;layer_8_expert_0_gelu -->
<g id="edge509" class="edge">
<title>layer_8_expert_0_ffn1&#45;&gt;layer_8_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-12669.57C780.57,-12661.34 780.57,-12652.08 780.57,-12643.28"/>
<polygon fill="black" stroke="black" points="784.07,-12643.24 780.57,-12633.24 777.07,-12643.24 784.07,-12643.24"/>
</g>
<!-- layer_8_expert_0_ffn2 -->
<g id="node355" class="node">
<title>layer_8_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-12543 677.57,-12543 677.57,-12490 883.57,-12490 883.57,-12543"/>
<text text-anchor="middle" x="780.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_0_gelu&#45;&gt;layer_8_expert_0_ffn2 -->
<g id="edge510" class="edge">
<title>layer_8_expert_0_gelu&#45;&gt;layer_8_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-12579.57C780.57,-12571.34 780.57,-12562.08 780.57,-12553.28"/>
<polygon fill="black" stroke="black" points="784.07,-12553.24 780.57,-12543.24 777.07,-12553.24 784.07,-12553.24"/>
</g>
<!-- layer_8_expert_agg -->
<g id="node377" class="node">
<title>layer_8_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-12453 878.36,-12453 790.93,-12347 1130.79,-12347 1218.21,-12453"/>
<text text-anchor="middle" x="1004.57" y="-12411.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-12396.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-12381.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_0_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge539" class="edge">
<title>layer_8_expert_0_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-12489.95C849.26,-12480.39 871.33,-12469.11 893.35,-12457.85"/>
<polygon fill="black" stroke="black" points="895.14,-12460.87 902.45,-12453.2 891.95,-12454.64 895.14,-12460.87"/>
</g>
<!-- layer_8_expert_1_gelu -->
<g id="node357" class="node">
<title>layer_8_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-12633 229.57,-12633 229.57,-12580 435.57,-12580 435.57,-12633"/>
<text text-anchor="middle" x="332.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_1_ffn1&#45;&gt;layer_8_expert_1_gelu -->
<g id="edge513" class="edge">
<title>layer_8_expert_1_ffn1&#45;&gt;layer_8_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-12669.57C332.57,-12661.34 332.57,-12652.08 332.57,-12643.28"/>
<polygon fill="black" stroke="black" points="336.07,-12643.24 332.57,-12633.24 329.07,-12643.24 336.07,-12643.24"/>
</g>
<!-- layer_8_expert_1_ffn2 -->
<g id="node358" class="node">
<title>layer_8_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-12543 229.57,-12543 229.57,-12490 435.57,-12490 435.57,-12543"/>
<text text-anchor="middle" x="332.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_1_gelu&#45;&gt;layer_8_expert_1_ffn2 -->
<g id="edge514" class="edge">
<title>layer_8_expert_1_gelu&#45;&gt;layer_8_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-12579.57C332.57,-12571.34 332.57,-12562.08 332.57,-12553.28"/>
<polygon fill="black" stroke="black" points="336.07,-12553.24 332.57,-12543.24 329.07,-12553.24 336.07,-12553.24"/>
</g>
<!-- layer_8_expert_1_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge540" class="edge">
<title>layer_8_expert_1_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-12491.76C438.66,-12491.16 441.63,-12490.57 444.57,-12490 578.16,-12464.21 730.72,-12440.32 842.83,-12423.81"/>
<polygon fill="black" stroke="black" points="843.49,-12427.25 852.87,-12422.33 842.47,-12420.32 843.49,-12427.25"/>
</g>
<!-- layer_8_expert_2_gelu -->
<g id="node360" class="node">
<title>layer_8_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-12633 1125.57,-12633 1125.57,-12580 1331.57,-12580 1331.57,-12633"/>
<text text-anchor="middle" x="1228.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_2_ffn1&#45;&gt;layer_8_expert_2_gelu -->
<g id="edge517" class="edge">
<title>layer_8_expert_2_ffn1&#45;&gt;layer_8_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-12669.57C1228.57,-12661.34 1228.57,-12652.08 1228.57,-12643.28"/>
<polygon fill="black" stroke="black" points="1232.07,-12643.24 1228.57,-12633.24 1225.07,-12643.24 1232.07,-12643.24"/>
</g>
<!-- layer_8_expert_2_ffn2 -->
<g id="node361" class="node">
<title>layer_8_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-12543 1125.57,-12543 1125.57,-12490 1331.57,-12490 1331.57,-12543"/>
<text text-anchor="middle" x="1228.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_2_gelu&#45;&gt;layer_8_expert_2_ffn2 -->
<g id="edge518" class="edge">
<title>layer_8_expert_2_gelu&#45;&gt;layer_8_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-12579.57C1228.57,-12571.34 1228.57,-12562.08 1228.57,-12553.28"/>
<polygon fill="black" stroke="black" points="1232.07,-12553.24 1228.57,-12543.24 1225.07,-12553.24 1232.07,-12553.24"/>
</g>
<!-- layer_8_expert_2_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge541" class="edge">
<title>layer_8_expert_2_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-12489.95C1159.88,-12480.39 1137.81,-12469.11 1115.79,-12457.85"/>
<polygon fill="black" stroke="black" points="1117.19,-12454.64 1106.7,-12453.2 1114.01,-12460.87 1117.19,-12454.64"/>
</g>
<!-- layer_8_expert_3_gelu -->
<g id="node363" class="node">
<title>layer_8_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-12633 1573.57,-12633 1573.57,-12580 1779.57,-12580 1779.57,-12633"/>
<text text-anchor="middle" x="1676.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_3_ffn1&#45;&gt;layer_8_expert_3_gelu -->
<g id="edge521" class="edge">
<title>layer_8_expert_3_ffn1&#45;&gt;layer_8_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-12669.57C1676.57,-12661.34 1676.57,-12652.08 1676.57,-12643.28"/>
<polygon fill="black" stroke="black" points="1680.07,-12643.24 1676.57,-12633.24 1673.07,-12643.24 1680.07,-12643.24"/>
</g>
<!-- layer_8_expert_3_ffn2 -->
<g id="node364" class="node">
<title>layer_8_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-12543 1573.57,-12543 1573.57,-12490 1779.57,-12490 1779.57,-12543"/>
<text text-anchor="middle" x="1676.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_3_gelu&#45;&gt;layer_8_expert_3_ffn2 -->
<g id="edge522" class="edge">
<title>layer_8_expert_3_gelu&#45;&gt;layer_8_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-12579.57C1676.57,-12571.34 1676.57,-12562.08 1676.57,-12553.28"/>
<polygon fill="black" stroke="black" points="1680.07,-12553.24 1676.57,-12543.24 1673.07,-12553.24 1680.07,-12553.24"/>
</g>
<!-- layer_8_expert_3_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge542" class="edge">
<title>layer_8_expert_3_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-12491.76C1570.49,-12491.16 1567.51,-12490.57 1564.57,-12490 1446.94,-12467.29 1314.59,-12446.06 1208.1,-12430.03"/>
<polygon fill="black" stroke="black" points="1208.61,-12426.57 1198.21,-12428.54 1207.58,-12433.49 1208.61,-12426.57"/>
</g>
<!-- layer_8_expert_4_gelu -->
<g id="node366" class="node">
<title>layer_8_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-12633 453.57,-12633 453.57,-12580 659.57,-12580 659.57,-12633"/>
<text text-anchor="middle" x="556.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_4_ffn1&#45;&gt;layer_8_expert_4_gelu -->
<g id="edge525" class="edge">
<title>layer_8_expert_4_ffn1&#45;&gt;layer_8_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-12669.57C556.57,-12661.34 556.57,-12652.08 556.57,-12643.28"/>
<polygon fill="black" stroke="black" points="560.07,-12643.24 556.57,-12633.24 553.07,-12643.24 560.07,-12643.24"/>
</g>
<!-- layer_8_expert_4_ffn2 -->
<g id="node367" class="node">
<title>layer_8_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-12543 453.57,-12543 453.57,-12490 659.57,-12490 659.57,-12543"/>
<text text-anchor="middle" x="556.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_4_gelu&#45;&gt;layer_8_expert_4_ffn2 -->
<g id="edge526" class="edge">
<title>layer_8_expert_4_gelu&#45;&gt;layer_8_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-12579.57C556.57,-12571.34 556.57,-12562.08 556.57,-12553.28"/>
<polygon fill="black" stroke="black" points="560.07,-12553.24 556.57,-12543.24 553.07,-12553.24 560.07,-12553.24"/>
</g>
<!-- layer_8_expert_4_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge543" class="edge">
<title>layer_8_expert_4_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-12489.95C714.81,-12475.06 789.41,-12455.99 854.59,-12439.33"/>
<polygon fill="black" stroke="black" points="855.73,-12442.65 864.55,-12436.79 853.99,-12435.87 855.73,-12442.65"/>
</g>
<!-- layer_8_expert_5_gelu -->
<g id="node369" class="node">
<title>layer_8_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-12633 1349.57,-12633 1349.57,-12580 1555.57,-12580 1555.57,-12633"/>
<text text-anchor="middle" x="1452.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_5_ffn1&#45;&gt;layer_8_expert_5_gelu -->
<g id="edge529" class="edge">
<title>layer_8_expert_5_ffn1&#45;&gt;layer_8_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-12669.57C1452.57,-12661.34 1452.57,-12652.08 1452.57,-12643.28"/>
<polygon fill="black" stroke="black" points="1456.07,-12643.24 1452.57,-12633.24 1449.07,-12643.24 1456.07,-12643.24"/>
</g>
<!-- layer_8_expert_5_ffn2 -->
<g id="node370" class="node">
<title>layer_8_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-12543 1349.57,-12543 1349.57,-12490 1555.57,-12490 1555.57,-12543"/>
<text text-anchor="middle" x="1452.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_5_gelu&#45;&gt;layer_8_expert_5_ffn2 -->
<g id="edge530" class="edge">
<title>layer_8_expert_5_gelu&#45;&gt;layer_8_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-12579.57C1452.57,-12571.34 1452.57,-12562.08 1452.57,-12553.28"/>
<polygon fill="black" stroke="black" points="1456.07,-12553.24 1452.57,-12543.24 1449.07,-12553.24 1456.07,-12553.24"/>
</g>
<!-- layer_8_expert_5_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge544" class="edge">
<title>layer_8_expert_5_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-12489.95C1312.66,-12479.74 1265.05,-12467.57 1218.07,-12455.57"/>
<polygon fill="black" stroke="black" points="1218.92,-12452.17 1208.37,-12453.09 1217.19,-12458.95 1218.92,-12452.17"/>
</g>
<!-- layer_8_expert_6_gelu -->
<g id="node372" class="node">
<title>layer_8_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-12633 1797.57,-12633 1797.57,-12580 2003.57,-12580 2003.57,-12633"/>
<text text-anchor="middle" x="1900.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_6_ffn1&#45;&gt;layer_8_expert_6_gelu -->
<g id="edge533" class="edge">
<title>layer_8_expert_6_ffn1&#45;&gt;layer_8_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-12669.57C1900.57,-12661.34 1900.57,-12652.08 1900.57,-12643.28"/>
<polygon fill="black" stroke="black" points="1904.07,-12643.24 1900.57,-12633.24 1897.07,-12643.24 1904.07,-12643.24"/>
</g>
<!-- layer_8_expert_6_ffn2 -->
<g id="node373" class="node">
<title>layer_8_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-12543 1797.57,-12543 1797.57,-12490 2003.57,-12490 2003.57,-12543"/>
<text text-anchor="middle" x="1900.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_6_gelu&#45;&gt;layer_8_expert_6_ffn2 -->
<g id="edge534" class="edge">
<title>layer_8_expert_6_gelu&#45;&gt;layer_8_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-12579.57C1900.57,-12571.34 1900.57,-12562.08 1900.57,-12553.28"/>
<polygon fill="black" stroke="black" points="1904.07,-12553.24 1900.57,-12543.24 1897.07,-12553.24 1904.07,-12553.24"/>
</g>
<!-- layer_8_expert_6_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge545" class="edge">
<title>layer_8_expert_6_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-12491.59C1794.51,-12491.03 1791.52,-12490.5 1788.57,-12490 1588.54,-12455.98 1357.51,-12431.53 1198.33,-12416.97"/>
<polygon fill="black" stroke="black" points="1198.23,-12413.45 1187.95,-12416.03 1197.59,-12420.42 1198.23,-12413.45"/>
</g>
<!-- layer_8_expert_7_gelu -->
<g id="node375" class="node">
<title>layer_8_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-12633 901.57,-12633 901.57,-12580 1107.57,-12580 1107.57,-12633"/>
<text text-anchor="middle" x="1004.57" y="-12617.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-12602.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-12587.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_7_ffn1&#45;&gt;layer_8_expert_7_gelu -->
<g id="edge537" class="edge">
<title>layer_8_expert_7_ffn1&#45;&gt;layer_8_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-12669.57C1004.57,-12661.34 1004.57,-12652.08 1004.57,-12643.28"/>
<polygon fill="black" stroke="black" points="1008.07,-12643.24 1004.57,-12633.24 1001.07,-12643.24 1008.07,-12643.24"/>
</g>
<!-- layer_8_expert_7_ffn2 -->
<g id="node376" class="node">
<title>layer_8_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-12543 901.57,-12543 901.57,-12490 1107.57,-12490 1107.57,-12543"/>
<text text-anchor="middle" x="1004.57" y="-12527.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-12512.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-12497.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_expert_7_gelu&#45;&gt;layer_8_expert_7_ffn2 -->
<g id="edge538" class="edge">
<title>layer_8_expert_7_gelu&#45;&gt;layer_8_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-12579.57C1004.57,-12571.34 1004.57,-12562.08 1004.57,-12553.28"/>
<polygon fill="black" stroke="black" points="1008.07,-12553.24 1004.57,-12543.24 1001.07,-12553.24 1008.07,-12553.24"/>
</g>
<!-- layer_8_expert_7_ffn2&#45;&gt;layer_8_expert_agg -->
<g id="edge546" class="edge">
<title>layer_8_expert_7_ffn2&#45;&gt;layer_8_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-12489.8C1004.57,-12481.86 1004.57,-12472.74 1004.57,-12463.44"/>
<polygon fill="black" stroke="black" points="1008.07,-12463.32 1004.57,-12453.32 1001.07,-12463.32 1008.07,-12463.32"/>
</g>
<!-- layer_8_expert_agg&#45;&gt;layer_8_add -->
<g id="edge548" class="edge">
<title>layer_8_expert_agg&#45;&gt;layer_8_add</title>
<path fill="none" stroke="black" d="M810.56,-12370.92C658.7,-12348.93 452.76,-12319.12 326.73,-12300.88"/>
<polygon fill="black" stroke="black" points="327.07,-12297.39 316.67,-12299.42 326.07,-12304.32 327.07,-12297.39"/>
</g>
<!-- comm_8_9 -->
<g id="node379" class="node">
<title>comm_8_9</title>
<polygon fill="yellow" stroke="black" points="427.21,-12220 87.36,-12220 -0.07,-12114 339.79,-12114 427.21,-12220"/>
<text text-anchor="middle" x="213.57" y="-12178.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-12163.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-12148.3" font-family="Times,serif" font-size="14.00">GPU 8  GPU 9</text>
</g>
<!-- layer_8_add&#45;&gt;comm_8_9 -->
<g id="edge549" class="edge">
<title>layer_8_add&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M213.57,-12256.8C213.57,-12248.86 213.57,-12239.74 213.57,-12230.44"/>
<polygon fill="black" stroke="black" points="217.07,-12230.32 213.57,-12220.32 210.07,-12230.32 217.07,-12230.32"/>
</g>
<!-- layer_9_ln1 -->
<g id="node380" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-12077 291.57,-12077 291.57,-12024 497.57,-12024 497.57,-12077"/>
<text text-anchor="middle" x="394.57" y="-12061.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-12046.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-12031.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- comm_8_9&#45;&gt;layer_9_ln1 -->
<g id="edge550" class="edge">
<title>comm_8_9&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M295.86,-12113.94C312.72,-12103.28 329.97,-12092.37 345.23,-12082.71"/>
<polygon fill="black" stroke="black" points="347.39,-12085.49 353.97,-12077.18 343.65,-12079.57 347.39,-12085.49"/>
</g>
<!-- layer_9_add1 -->
<g id="node392" class="node">
<title>layer_9_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-11305 110.57,-11305 110.57,-11252 316.57,-11252 316.57,-11305"/>
<text text-anchor="middle" x="213.57" y="-11289.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-11274.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-11259.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- comm_8_9&#45;&gt;layer_9_add1 -->
<g id="edge564" class="edge">
<title>comm_8_9&#45;&gt;layer_9_add1</title>
<path fill="none" stroke="black" d="M205.8,-12113.97C203.49,-12094.42 201.57,-12071.99 201.57,-12051.5 201.57,-12051.5 201.57,-12051.5 201.57,-11367.5 201.57,-11350.17 203.88,-11331.1 206.48,-11315.15"/>
<polygon fill="black" stroke="black" points="209.95,-11315.62 208.2,-11305.17 203.05,-11314.43 209.95,-11315.62"/>
</g>
<!-- layer_9_q_proj -->
<g id="node381" class="node">
<title>layer_9_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-11987 453.57,-11987 453.57,-11934 659.57,-11934 659.57,-11987"/>
<text text-anchor="middle" x="556.57" y="-11971.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-11956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-11941.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_q_proj -->
<g id="edge551" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-12023.81C460.25,-12013.82 481.45,-12002.31 500.58,-11991.91"/>
<polygon fill="black" stroke="black" points="502.38,-11994.92 509.5,-11987.07 499.04,-11988.77 502.38,-11994.92"/>
</g>
<!-- layer_9_k_proj -->
<g id="node382" class="node">
<title>layer_9_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-11987 677.57,-11987 677.57,-11934 883.57,-11934 883.57,-11987"/>
<text text-anchor="middle" x="780.57" y="-11971.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-11956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-11941.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_k_proj -->
<g id="edge552" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-12025.98C550.11,-12014.04 613.8,-11999.52 667.48,-11987.28"/>
<polygon fill="black" stroke="black" points="668.41,-11990.66 677.38,-11985.02 666.86,-11983.83 668.41,-11990.66"/>
</g>
<!-- layer_9_v_proj -->
<g id="node383" class="node">
<title>layer_9_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-11987 229.57,-11987 229.57,-11934 435.57,-11934 435.57,-11987"/>
<text text-anchor="middle" x="332.57" y="-11971.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-11956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-11941.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_v_proj -->
<g id="edge553" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-12023.57C370.12,-12014.8 363.13,-12004.87 356.57,-11995.56"/>
<polygon fill="black" stroke="black" points="359.33,-11993.4 350.71,-11987.24 353.61,-11997.43 359.33,-11993.4"/>
</g>
<!-- layer_9_q_reshape -->
<g id="node384" class="node">
<title>layer_9_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-11897 426.57,-11897 426.57,-11844 650.57,-11844 650.57,-11897"/>
<text text-anchor="middle" x="538.57" y="-11881.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-11866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-11851.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_q_proj&#45;&gt;layer_9_q_reshape -->
<g id="edge554" class="edge">
<title>layer_9_q_proj&#45;&gt;layer_9_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-11933.57C549.58,-11925.34 547.69,-11916.08 545.89,-11907.28"/>
<polygon fill="black" stroke="black" points="549.27,-11906.34 543.84,-11897.24 542.41,-11907.74 549.27,-11906.34"/>
</g>
<!-- layer_9_k_reshape -->
<g id="node385" class="node">
<title>layer_9_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-11897 668.57,-11897 668.57,-11844 892.57,-11844 892.57,-11897"/>
<text text-anchor="middle" x="780.57" y="-11881.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-11866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-11851.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_k_proj&#45;&gt;layer_9_k_reshape -->
<g id="edge555" class="edge">
<title>layer_9_k_proj&#45;&gt;layer_9_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-11933.57C780.57,-11925.34 780.57,-11916.08 780.57,-11907.28"/>
<polygon fill="black" stroke="black" points="784.07,-11907.24 780.57,-11897.24 777.07,-11907.24 784.07,-11907.24"/>
</g>
<!-- layer_9_v_reshape -->
<g id="node386" class="node">
<title>layer_9_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-11826 225.57,-11826 225.57,-11773 449.57,-11773 449.57,-11826"/>
<text text-anchor="middle" x="337.57" y="-11810.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-11795.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-11780.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_v_proj&#45;&gt;layer_9_v_reshape -->
<g id="edge556" class="edge">
<title>layer_9_v_proj&#45;&gt;layer_9_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-11933.95C334.2,-11907.61 335.5,-11866.29 336.44,-11836.61"/>
<polygon fill="black" stroke="black" points="339.95,-11836.35 336.76,-11826.25 332.95,-11836.13 339.95,-11836.35"/>
</g>
<!-- layer_9_attn_scores -->
<g id="node387" class="node">
<title>layer_9_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-11755 422.07,-11755 422.07,-11702 655.07,-11702 655.07,-11755"/>
<text text-anchor="middle" x="538.57" y="-11739.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-11724.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-11709.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_q_reshape&#45;&gt;layer_9_attn_scores -->
<g id="edge557" class="edge">
<title>layer_9_q_reshape&#45;&gt;layer_9_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-11843.82C538.57,-11821.72 538.57,-11789.6 538.57,-11765.03"/>
<polygon fill="black" stroke="black" points="542.07,-11765.02 538.57,-11755.02 535.07,-11765.02 542.07,-11765.02"/>
</g>
<!-- layer_9_k_reshape&#45;&gt;layer_9_attn_scores -->
<g id="edge558" class="edge">
<title>layer_9_k_reshape&#45;&gt;layer_9_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-11843.98C695.65,-11820.37 634.91,-11785.23 591.5,-11760.12"/>
<polygon fill="black" stroke="black" points="593.19,-11757.05 582.78,-11755.08 589.68,-11763.11 593.19,-11757.05"/>
</g>
<!-- layer_9_attn_output -->
<g id="node389" class="node">
<title>layer_9_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-11575 229.57,-11575 229.57,-11522 453.57,-11522 453.57,-11575"/>
<text text-anchor="middle" x="341.57" y="-11559.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-11544.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-11529.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_v_reshape&#45;&gt;layer_9_attn_output -->
<g id="edge561" class="edge">
<title>layer_9_v_reshape&#45;&gt;layer_9_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-11772.79C338.7,-11728.13 340.18,-11636.13 341,-11585.27"/>
<polygon fill="black" stroke="black" points="344.5,-11585.12 341.16,-11575.07 337.5,-11585.01 344.5,-11585.12"/>
</g>
<!-- layer_9_attn_weights -->
<g id="node388" class="node">
<title>layer_9_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="629.07,-11665 396.07,-11665 396.07,-11612 629.07,-11612 629.07,-11665"/>
<text text-anchor="middle" x="512.57" y="-11649.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="512.57" y="-11634.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="512.57" y="-11619.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_scores&#45;&gt;layer_9_attn_weights -->
<g id="edge559" class="edge">
<title>layer_9_attn_scores&#45;&gt;layer_9_attn_weights</title>
<path fill="none" stroke="black" d="M530.91,-11701.57C528.45,-11693.25 525.68,-11683.88 523.06,-11674.99"/>
<polygon fill="black" stroke="black" points="526.37,-11673.84 520.18,-11665.24 519.65,-11675.82 526.37,-11673.84"/>
</g>
<!-- layer_9_attn_weights&#45;&gt;layer_9_attn_output -->
<g id="edge560" class="edge">
<title>layer_9_attn_weights&#45;&gt;layer_9_attn_output</title>
<path fill="none" stroke="black" d="M462.65,-11611.81C443.16,-11601.78 420.67,-11590.2 400.4,-11579.77"/>
<polygon fill="black" stroke="black" points="401.75,-11576.53 391.26,-11575.07 398.55,-11582.76 401.75,-11576.53"/>
</g>
<!-- layer_9_attn_reshape -->
<g id="node390" class="node">
<title>layer_9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-11485 236.57,-11485 236.57,-11432 442.57,-11432 442.57,-11485"/>
<text text-anchor="middle" x="339.57" y="-11469.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-11454.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-11439.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_output&#45;&gt;layer_9_attn_reshape -->
<g id="edge562" class="edge">
<title>layer_9_attn_output&#45;&gt;layer_9_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-11521.57C340.79,-11513.34 340.58,-11504.08 340.38,-11495.28"/>
<polygon fill="black" stroke="black" points="343.88,-11495.16 340.16,-11485.24 336.88,-11495.32 343.88,-11495.16"/>
</g>
<!-- layer_9_attn_proj -->
<g id="node391" class="node">
<title>layer_9_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-11395 233.57,-11395 233.57,-11342 439.57,-11342 439.57,-11395"/>
<text text-anchor="middle" x="336.57" y="-11379.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-11364.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-11349.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_reshape&#45;&gt;layer_9_attn_proj -->
<g id="edge563" class="edge">
<title>layer_9_attn_reshape&#45;&gt;layer_9_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-11431.57C338.41,-11423.34 338.09,-11414.08 337.79,-11405.28"/>
<polygon fill="black" stroke="black" points="341.29,-11405.12 337.45,-11395.24 334.29,-11405.36 341.29,-11405.12"/>
</g>
<!-- layer_9_attn_proj&#45;&gt;layer_9_add1 -->
<g id="edge565" class="edge">
<title>layer_9_attn_proj&#45;&gt;layer_9_add1</title>
<path fill="none" stroke="black" d="M300.66,-11341.81C287.15,-11332.14 271.63,-11321.04 257.47,-11310.9"/>
<polygon fill="black" stroke="black" points="259.48,-11308.04 249.31,-11305.07 255.41,-11313.73 259.48,-11308.04"/>
</g>
<!-- layer_9_ln2 -->
<g id="node393" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-11215 827.57,-11215 827.57,-11162 1033.57,-11162 1033.57,-11215"/>
<text text-anchor="middle" x="930.57" y="-11199.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-11184.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-11169.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_add1&#45;&gt;layer_9_ln2 -->
<g id="edge566" class="edge">
<title>layer_9_add1&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M316.68,-11264.84C449.47,-11248.55 679.5,-11220.31 817.13,-11203.42"/>
<polygon fill="black" stroke="black" points="817.78,-11206.87 827.28,-11202.18 816.93,-11199.92 817.78,-11206.87"/>
</g>
<!-- layer_9_add -->
<g id="node420" class="node">
<title>layer_9_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-10559 110.57,-10559 110.57,-10506 316.57,-10506 316.57,-10559"/>
<text text-anchor="middle" x="213.57" y="-10543.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-10528.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-10513.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_add1&#45;&gt;layer_9_add -->
<g id="edge608" class="edge">
<title>layer_9_add1&#45;&gt;layer_9_add</title>
<path fill="none" stroke="black" d="M208.2,-11251.83C205.01,-11234.34 201.57,-11210.62 201.57,-11189.5 201.57,-11189.5 201.57,-11189.5 201.57,-10648 201.57,-10621.6 204.77,-10591.96 207.86,-10569.46"/>
<polygon fill="black" stroke="black" points="211.35,-10569.73 209.31,-10559.34 204.42,-10568.74 211.35,-10569.73"/>
</g>
<!-- layer_9_gate -->
<g id="node394" class="node">
<title>layer_9_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-11125 900.57,-11072 1079.57,-11019 1258.57,-11072 1079.57,-11125"/>
<text text-anchor="middle" x="1079.57" y="-11083.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-11068.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-11053.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_gate -->
<g id="edge567" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_gate</title>
<path fill="none" stroke="black" d="M964.01,-11161.8C981.28,-11148.53 1002.83,-11131.97 1022.63,-11116.76"/>
<polygon fill="black" stroke="black" points="1024.9,-11119.43 1030.69,-11110.56 1020.63,-11113.88 1024.9,-11119.43"/>
</g>
<!-- layer_9_expert_0_ffn1 -->
<g id="node395" class="node">
<title>layer_9_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-10972 677.57,-10972 677.57,-10919 883.57,-10919 883.57,-10972"/>
<text text-anchor="middle" x="780.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_0_ffn1 -->
<g id="edge569" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-11161.95C887.23,-11151.28 873.96,-11138.28 863.57,-11125 824.71,-11075.33 817.94,-11059.58 794.57,-11001 792.17,-10994.99 790.08,-10988.43 788.29,-10982.02"/>
<polygon fill="black" stroke="black" points="791.63,-10980.97 785.73,-10972.17 784.85,-10982.72 791.63,-10980.97"/>
</g>
<!-- layer_9_expert_1_ffn1 -->
<g id="node398" class="node">
<title>layer_9_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-10972 229.57,-10972 229.57,-10919 435.57,-10919 435.57,-10972"/>
<text text-anchor="middle" x="332.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_1_ffn1 -->
<g id="edge573" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-11175.27C767.36,-11165.96 691.02,-11150.31 626.57,-11125 529.83,-11087.01 428.72,-11018.16 373.91,-10977.98"/>
<polygon fill="black" stroke="black" points="375.97,-10975.14 365.84,-10972.02 371.81,-10980.78 375.97,-10975.14"/>
</g>
<!-- layer_9_expert_2_ffn1 -->
<g id="node401" class="node">
<title>layer_9_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-10972 1125.57,-10972 1125.57,-10919 1331.57,-10919 1331.57,-10972"/>
<text text-anchor="middle" x="1228.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_2_ffn1 -->
<g id="edge577" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-11182.17C1121.34,-11175.26 1237.52,-11159.69 1267.57,-11125 1306.88,-11079.62 1295.71,-11045.4 1272.57,-10990 1271.12,-10986.52 1269.24,-10983.18 1267.08,-10980.01"/>
<polygon fill="black" stroke="black" points="1269.72,-10977.71 1260.79,-10972.01 1264.22,-10982.03 1269.72,-10977.71"/>
</g>
<!-- layer_9_expert_3_ffn1 -->
<g id="node404" class="node">
<title>layer_9_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-10972 1573.57,-10972 1573.57,-10919 1779.57,-10919 1779.57,-10972"/>
<text text-anchor="middle" x="1676.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_3_ffn1 -->
<g id="edge581" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-11182.82C1122.76,-11176.39 1253.8,-11161.14 1362.57,-11125 1484.83,-11084.38 1520.13,-11076.42 1624.57,-11001 1633.08,-10994.86 1641.36,-10987.21 1648.73,-10979.6"/>
<polygon fill="black" stroke="black" points="1651.49,-10981.77 1655.76,-10972.07 1646.38,-10976.99 1651.49,-10981.77"/>
</g>
<!-- layer_9_expert_4_ffn1 -->
<g id="node407" class="node">
<title>layer_9_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-10972 453.57,-10972 453.57,-10919 659.57,-10919 659.57,-10972"/>
<text text-anchor="middle" x="556.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_4_ffn1 -->
<g id="edge585" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-11161.89C801.11,-11130.58 686.43,-11072.79 603.57,-11001 596.29,-10994.69 589.13,-10987.24 582.68,-10979.9"/>
<polygon fill="black" stroke="black" points="585.14,-10977.39 575.99,-10972.05 579.81,-10981.93 585.14,-10977.39"/>
</g>
<!-- layer_9_expert_5_ffn1 -->
<g id="node410" class="node">
<title>layer_9_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-10972 1349.57,-10972 1349.57,-10919 1555.57,-10919 1555.57,-10972"/>
<text text-anchor="middle" x="1452.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_5_ffn1 -->
<g id="edge589" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-11181.77C1098.02,-11176.2 1181.84,-11165.3 1253.57,-11144 1272.44,-11138.4 1277.44,-11136.28 1293.57,-11125 1357.95,-11079.96 1370.85,-11062.64 1419.57,-11001 1424.54,-10994.72 1429.34,-10987.63 1433.66,-10980.69"/>
<polygon fill="black" stroke="black" points="1436.7,-10982.43 1438.87,-10972.05 1430.71,-10978.81 1436.7,-10982.43"/>
</g>
<!-- layer_9_expert_6_ffn1 -->
<g id="node413" class="node">
<title>layer_9_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-10972 1797.57,-10972 1797.57,-10919 2003.57,-10919 2003.57,-10972"/>
<text text-anchor="middle" x="1900.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_6_ffn1 -->
<g id="edge593" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-11185.36C1147.98,-11180.86 1336.72,-11167.05 1493.57,-11125 1625.52,-11089.63 1769.63,-11017.8 1845.97,-10976.86"/>
<polygon fill="black" stroke="black" points="1847.8,-10979.86 1854.94,-10972.03 1844.47,-10973.69 1847.8,-10979.86"/>
</g>
<!-- layer_9_expert_7_ffn1 -->
<g id="node416" class="node">
<title>layer_9_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-10972 901.57,-10972 901.57,-10919 1107.57,-10919 1107.57,-10972"/>
<text text-anchor="middle" x="1004.57" y="-10956.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-10941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-10926.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_expert_7_ffn1 -->
<g id="edge597" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-11161.92C903.08,-11151.14 895.6,-11138.08 891.57,-11125 873.88,-11067.62 852.23,-11039.25 886.57,-10990 889.58,-10985.69 893.06,-10981.8 896.91,-10978.3"/>
<polygon fill="black" stroke="black" points="899.11,-10981.02 904.71,-10972.03 894.73,-10975.56 899.11,-10981.02"/>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_0_ffn1 -->
<g id="edge568" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-11040.54C959.2,-11020.88 898.07,-10995.43 851.32,-10975.96"/>
<polygon fill="black" stroke="black" points="852.45,-10972.64 841.87,-10972.03 849.76,-10979.1 852.45,-10972.64"/>
<text text-anchor="middle" x="924.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_1_ffn1 -->
<g id="edge572" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-11054.72C833.08,-11037.17 630.07,-11007.21 445.54,-10972.14"/>
<polygon fill="black" stroke="black" points="446.13,-10968.69 435.65,-10970.25 444.82,-10975.56 446.13,-10968.69"/>
<text text-anchor="middle" x="623.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_2_ffn1 -->
<g id="edge576" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1107.53,-11027.06C1117.22,-11014.05 1128.88,-11000.49 1141.57,-10990 1147.12,-10985.41 1153.23,-10981.15 1159.57,-10977.23"/>
<polygon fill="black" stroke="black" points="1161.46,-10980.17 1168.31,-10972.09 1157.92,-10974.14 1161.46,-10980.17"/>
<text text-anchor="middle" x="1163.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_3_ffn1 -->
<g id="edge580" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-11049.7C1263.24,-11033.33 1376.38,-11010.18 1475.57,-10990 1512.26,-10982.54 1523.52,-10980.73 1563.55,-10972.2"/>
<polygon fill="black" stroke="black" points="1564.41,-10975.59 1573.46,-10970.08 1562.94,-10968.75 1564.41,-10975.59"/>
<text text-anchor="middle" x="1497.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_4_ffn1 -->
<g id="edge584" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-11047.8C893.49,-11026.7 762.7,-10995.57 669.53,-10973.39"/>
<polygon fill="black" stroke="black" points="670.33,-10969.98 659.79,-10971.07 668.7,-10976.79 670.33,-10969.98"/>
<text text-anchor="middle" x="792.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_5_ffn1 -->
<g id="edge588" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-11040.6C1193.35,-11024.52 1244.3,-11005.05 1290.57,-10990 1306.78,-10984.73 1324.04,-10979.6 1341.02,-10974.81"/>
<polygon fill="black" stroke="black" points="1342.29,-10978.09 1350.98,-10972.04 1340.41,-10971.35 1342.29,-10978.09"/>
<text text-anchor="middle" x="1312.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_6_ffn1 -->
<g id="edge592" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-11056.57C1346.62,-11039.91 1578.71,-11010.07 1787.57,-10972.13"/>
<polygon fill="black" stroke="black" points="1788.29,-10975.55 1797.5,-10970.31 1787.04,-10968.67 1788.29,-10975.55"/>
<text text-anchor="middle" x="1694.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_9_gate&#45;&gt;layer_9_expert_7_ffn1 -->
<g id="edge596" class="edge">
<title>layer_9_gate&#45;&gt;layer_9_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1050.78,-11027.22C1045.29,-11018.6 1039.67,-11009.56 1034.57,-11001 1030.77,-10994.62 1026.85,-10987.74 1023.14,-10981.08"/>
<polygon fill="black" stroke="black" points="1026.15,-10979.28 1018.26,-10972.21 1020.02,-10982.66 1026.15,-10979.28"/>
<text text-anchor="middle" x="1056.57" y="-10993" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_9_expert_0_gelu -->
<g id="node396" class="node">
<title>layer_9_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-10882 677.57,-10882 677.57,-10829 883.57,-10829 883.57,-10882"/>
<text text-anchor="middle" x="780.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_0_ffn1&#45;&gt;layer_9_expert_0_gelu -->
<g id="edge570" class="edge">
<title>layer_9_expert_0_ffn1&#45;&gt;layer_9_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-10918.57C780.57,-10910.34 780.57,-10901.08 780.57,-10892.28"/>
<polygon fill="black" stroke="black" points="784.07,-10892.24 780.57,-10882.24 777.07,-10892.24 784.07,-10892.24"/>
</g>
<!-- layer_9_expert_0_ffn2 -->
<g id="node397" class="node">
<title>layer_9_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-10792 677.57,-10792 677.57,-10739 883.57,-10739 883.57,-10792"/>
<text text-anchor="middle" x="780.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_0_gelu&#45;&gt;layer_9_expert_0_ffn2 -->
<g id="edge571" class="edge">
<title>layer_9_expert_0_gelu&#45;&gt;layer_9_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-10828.57C780.57,-10820.34 780.57,-10811.08 780.57,-10802.28"/>
<polygon fill="black" stroke="black" points="784.07,-10802.24 780.57,-10792.24 777.07,-10802.24 784.07,-10802.24"/>
</g>
<!-- layer_9_expert_agg -->
<g id="node419" class="node">
<title>layer_9_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-10702 878.36,-10702 790.93,-10596 1130.79,-10596 1218.21,-10702"/>
<text text-anchor="middle" x="1004.57" y="-10660.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-10645.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-10630.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_0_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge600" class="edge">
<title>layer_9_expert_0_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-10738.95C849.26,-10729.39 871.33,-10718.11 893.35,-10706.85"/>
<polygon fill="black" stroke="black" points="895.14,-10709.87 902.45,-10702.2 891.95,-10703.64 895.14,-10709.87"/>
</g>
<!-- layer_9_expert_1_gelu -->
<g id="node399" class="node">
<title>layer_9_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-10882 229.57,-10882 229.57,-10829 435.57,-10829 435.57,-10882"/>
<text text-anchor="middle" x="332.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_1_ffn1&#45;&gt;layer_9_expert_1_gelu -->
<g id="edge574" class="edge">
<title>layer_9_expert_1_ffn1&#45;&gt;layer_9_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-10918.57C332.57,-10910.34 332.57,-10901.08 332.57,-10892.28"/>
<polygon fill="black" stroke="black" points="336.07,-10892.24 332.57,-10882.24 329.07,-10892.24 336.07,-10892.24"/>
</g>
<!-- layer_9_expert_1_ffn2 -->
<g id="node400" class="node">
<title>layer_9_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-10792 229.57,-10792 229.57,-10739 435.57,-10739 435.57,-10792"/>
<text text-anchor="middle" x="332.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_1_gelu&#45;&gt;layer_9_expert_1_ffn2 -->
<g id="edge575" class="edge">
<title>layer_9_expert_1_gelu&#45;&gt;layer_9_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-10828.57C332.57,-10820.34 332.57,-10811.08 332.57,-10802.28"/>
<polygon fill="black" stroke="black" points="336.07,-10802.24 332.57,-10792.24 329.07,-10802.24 336.07,-10802.24"/>
</g>
<!-- layer_9_expert_1_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge601" class="edge">
<title>layer_9_expert_1_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-10740.76C438.66,-10740.16 441.63,-10739.57 444.57,-10739 578.16,-10713.21 730.72,-10689.32 842.83,-10672.81"/>
<polygon fill="black" stroke="black" points="843.49,-10676.25 852.87,-10671.33 842.47,-10669.32 843.49,-10676.25"/>
</g>
<!-- layer_9_expert_2_gelu -->
<g id="node402" class="node">
<title>layer_9_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-10882 1125.57,-10882 1125.57,-10829 1331.57,-10829 1331.57,-10882"/>
<text text-anchor="middle" x="1228.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_2_ffn1&#45;&gt;layer_9_expert_2_gelu -->
<g id="edge578" class="edge">
<title>layer_9_expert_2_ffn1&#45;&gt;layer_9_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-10918.57C1228.57,-10910.34 1228.57,-10901.08 1228.57,-10892.28"/>
<polygon fill="black" stroke="black" points="1232.07,-10892.24 1228.57,-10882.24 1225.07,-10892.24 1232.07,-10892.24"/>
</g>
<!-- layer_9_expert_2_ffn2 -->
<g id="node403" class="node">
<title>layer_9_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-10792 1125.57,-10792 1125.57,-10739 1331.57,-10739 1331.57,-10792"/>
<text text-anchor="middle" x="1228.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_2_gelu&#45;&gt;layer_9_expert_2_ffn2 -->
<g id="edge579" class="edge">
<title>layer_9_expert_2_gelu&#45;&gt;layer_9_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-10828.57C1228.57,-10820.34 1228.57,-10811.08 1228.57,-10802.28"/>
<polygon fill="black" stroke="black" points="1232.07,-10802.24 1228.57,-10792.24 1225.07,-10802.24 1232.07,-10802.24"/>
</g>
<!-- layer_9_expert_2_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge602" class="edge">
<title>layer_9_expert_2_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-10738.95C1159.88,-10729.39 1137.81,-10718.11 1115.79,-10706.85"/>
<polygon fill="black" stroke="black" points="1117.19,-10703.64 1106.7,-10702.2 1114.01,-10709.87 1117.19,-10703.64"/>
</g>
<!-- layer_9_expert_3_gelu -->
<g id="node405" class="node">
<title>layer_9_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-10882 1573.57,-10882 1573.57,-10829 1779.57,-10829 1779.57,-10882"/>
<text text-anchor="middle" x="1676.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_3_ffn1&#45;&gt;layer_9_expert_3_gelu -->
<g id="edge582" class="edge">
<title>layer_9_expert_3_ffn1&#45;&gt;layer_9_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-10918.57C1676.57,-10910.34 1676.57,-10901.08 1676.57,-10892.28"/>
<polygon fill="black" stroke="black" points="1680.07,-10892.24 1676.57,-10882.24 1673.07,-10892.24 1680.07,-10892.24"/>
</g>
<!-- layer_9_expert_3_ffn2 -->
<g id="node406" class="node">
<title>layer_9_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-10792 1573.57,-10792 1573.57,-10739 1779.57,-10739 1779.57,-10792"/>
<text text-anchor="middle" x="1676.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_3_gelu&#45;&gt;layer_9_expert_3_ffn2 -->
<g id="edge583" class="edge">
<title>layer_9_expert_3_gelu&#45;&gt;layer_9_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-10828.57C1676.57,-10820.34 1676.57,-10811.08 1676.57,-10802.28"/>
<polygon fill="black" stroke="black" points="1680.07,-10802.24 1676.57,-10792.24 1673.07,-10802.24 1680.07,-10802.24"/>
</g>
<!-- layer_9_expert_3_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge603" class="edge">
<title>layer_9_expert_3_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-10740.76C1570.49,-10740.16 1567.51,-10739.57 1564.57,-10739 1446.94,-10716.29 1314.59,-10695.06 1208.1,-10679.03"/>
<polygon fill="black" stroke="black" points="1208.61,-10675.57 1198.21,-10677.54 1207.58,-10682.49 1208.61,-10675.57"/>
</g>
<!-- layer_9_expert_4_gelu -->
<g id="node408" class="node">
<title>layer_9_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-10882 453.57,-10882 453.57,-10829 659.57,-10829 659.57,-10882"/>
<text text-anchor="middle" x="556.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_4_ffn1&#45;&gt;layer_9_expert_4_gelu -->
<g id="edge586" class="edge">
<title>layer_9_expert_4_ffn1&#45;&gt;layer_9_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-10918.57C556.57,-10910.34 556.57,-10901.08 556.57,-10892.28"/>
<polygon fill="black" stroke="black" points="560.07,-10892.24 556.57,-10882.24 553.07,-10892.24 560.07,-10892.24"/>
</g>
<!-- layer_9_expert_4_ffn2 -->
<g id="node409" class="node">
<title>layer_9_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-10792 453.57,-10792 453.57,-10739 659.57,-10739 659.57,-10792"/>
<text text-anchor="middle" x="556.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_4_gelu&#45;&gt;layer_9_expert_4_ffn2 -->
<g id="edge587" class="edge">
<title>layer_9_expert_4_gelu&#45;&gt;layer_9_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-10828.57C556.57,-10820.34 556.57,-10811.08 556.57,-10802.28"/>
<polygon fill="black" stroke="black" points="560.07,-10802.24 556.57,-10792.24 553.07,-10802.24 560.07,-10802.24"/>
</g>
<!-- layer_9_expert_4_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge604" class="edge">
<title>layer_9_expert_4_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-10738.95C714.81,-10724.06 789.41,-10704.99 854.59,-10688.33"/>
<polygon fill="black" stroke="black" points="855.73,-10691.65 864.55,-10685.79 853.99,-10684.87 855.73,-10691.65"/>
</g>
<!-- layer_9_expert_5_gelu -->
<g id="node411" class="node">
<title>layer_9_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-10882 1349.57,-10882 1349.57,-10829 1555.57,-10829 1555.57,-10882"/>
<text text-anchor="middle" x="1452.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_5_ffn1&#45;&gt;layer_9_expert_5_gelu -->
<g id="edge590" class="edge">
<title>layer_9_expert_5_ffn1&#45;&gt;layer_9_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-10918.57C1452.57,-10910.34 1452.57,-10901.08 1452.57,-10892.28"/>
<polygon fill="black" stroke="black" points="1456.07,-10892.24 1452.57,-10882.24 1449.07,-10892.24 1456.07,-10892.24"/>
</g>
<!-- layer_9_expert_5_ffn2 -->
<g id="node412" class="node">
<title>layer_9_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-10792 1349.57,-10792 1349.57,-10739 1555.57,-10739 1555.57,-10792"/>
<text text-anchor="middle" x="1452.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_5_gelu&#45;&gt;layer_9_expert_5_ffn2 -->
<g id="edge591" class="edge">
<title>layer_9_expert_5_gelu&#45;&gt;layer_9_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-10828.57C1452.57,-10820.34 1452.57,-10811.08 1452.57,-10802.28"/>
<polygon fill="black" stroke="black" points="1456.07,-10802.24 1452.57,-10792.24 1449.07,-10802.24 1456.07,-10802.24"/>
</g>
<!-- layer_9_expert_5_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge605" class="edge">
<title>layer_9_expert_5_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-10738.95C1312.66,-10728.74 1265.05,-10716.57 1218.07,-10704.57"/>
<polygon fill="black" stroke="black" points="1218.92,-10701.17 1208.37,-10702.09 1217.19,-10707.95 1218.92,-10701.17"/>
</g>
<!-- layer_9_expert_6_gelu -->
<g id="node414" class="node">
<title>layer_9_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-10882 1797.57,-10882 1797.57,-10829 2003.57,-10829 2003.57,-10882"/>
<text text-anchor="middle" x="1900.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_6_ffn1&#45;&gt;layer_9_expert_6_gelu -->
<g id="edge594" class="edge">
<title>layer_9_expert_6_ffn1&#45;&gt;layer_9_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-10918.57C1900.57,-10910.34 1900.57,-10901.08 1900.57,-10892.28"/>
<polygon fill="black" stroke="black" points="1904.07,-10892.24 1900.57,-10882.24 1897.07,-10892.24 1904.07,-10892.24"/>
</g>
<!-- layer_9_expert_6_ffn2 -->
<g id="node415" class="node">
<title>layer_9_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-10792 1797.57,-10792 1797.57,-10739 2003.57,-10739 2003.57,-10792"/>
<text text-anchor="middle" x="1900.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_6_gelu&#45;&gt;layer_9_expert_6_ffn2 -->
<g id="edge595" class="edge">
<title>layer_9_expert_6_gelu&#45;&gt;layer_9_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-10828.57C1900.57,-10820.34 1900.57,-10811.08 1900.57,-10802.28"/>
<polygon fill="black" stroke="black" points="1904.07,-10802.24 1900.57,-10792.24 1897.07,-10802.24 1904.07,-10802.24"/>
</g>
<!-- layer_9_expert_6_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge606" class="edge">
<title>layer_9_expert_6_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-10740.59C1794.51,-10740.03 1791.52,-10739.5 1788.57,-10739 1588.54,-10704.98 1357.51,-10680.53 1198.33,-10665.97"/>
<polygon fill="black" stroke="black" points="1198.23,-10662.45 1187.95,-10665.03 1197.59,-10669.42 1198.23,-10662.45"/>
</g>
<!-- layer_9_expert_7_gelu -->
<g id="node417" class="node">
<title>layer_9_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-10882 901.57,-10882 901.57,-10829 1107.57,-10829 1107.57,-10882"/>
<text text-anchor="middle" x="1004.57" y="-10866.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-10851.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-10836.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_7_ffn1&#45;&gt;layer_9_expert_7_gelu -->
<g id="edge598" class="edge">
<title>layer_9_expert_7_ffn1&#45;&gt;layer_9_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-10918.57C1004.57,-10910.34 1004.57,-10901.08 1004.57,-10892.28"/>
<polygon fill="black" stroke="black" points="1008.07,-10892.24 1004.57,-10882.24 1001.07,-10892.24 1008.07,-10892.24"/>
</g>
<!-- layer_9_expert_7_ffn2 -->
<g id="node418" class="node">
<title>layer_9_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-10792 901.57,-10792 901.57,-10739 1107.57,-10739 1107.57,-10792"/>
<text text-anchor="middle" x="1004.57" y="-10776.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-10761.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-10746.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_expert_7_gelu&#45;&gt;layer_9_expert_7_ffn2 -->
<g id="edge599" class="edge">
<title>layer_9_expert_7_gelu&#45;&gt;layer_9_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-10828.57C1004.57,-10820.34 1004.57,-10811.08 1004.57,-10802.28"/>
<polygon fill="black" stroke="black" points="1008.07,-10802.24 1004.57,-10792.24 1001.07,-10802.24 1008.07,-10802.24"/>
</g>
<!-- layer_9_expert_7_ffn2&#45;&gt;layer_9_expert_agg -->
<g id="edge607" class="edge">
<title>layer_9_expert_7_ffn2&#45;&gt;layer_9_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-10738.8C1004.57,-10730.86 1004.57,-10721.74 1004.57,-10712.44"/>
<polygon fill="black" stroke="black" points="1008.07,-10712.32 1004.57,-10702.32 1001.07,-10712.32 1008.07,-10712.32"/>
</g>
<!-- layer_9_expert_agg&#45;&gt;layer_9_add -->
<g id="edge609" class="edge">
<title>layer_9_expert_agg&#45;&gt;layer_9_add</title>
<path fill="none" stroke="black" d="M810.56,-10619.92C658.7,-10597.93 452.76,-10568.12 326.73,-10549.88"/>
<polygon fill="black" stroke="black" points="327.07,-10546.39 316.67,-10548.42 326.07,-10553.32 327.07,-10546.39"/>
</g>
<!-- comm_9_10 -->
<g id="node421" class="node">
<title>comm_9_10</title>
<polygon fill="yellow" stroke="black" points="427.21,-10469 87.36,-10469 -0.07,-10363 339.79,-10363 427.21,-10469"/>
<text text-anchor="middle" x="213.57" y="-10427.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-10412.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-10397.3" font-family="Times,serif" font-size="14.00">GPU 9  GPU 10</text>
</g>
<!-- layer_9_add&#45;&gt;comm_9_10 -->
<g id="edge610" class="edge">
<title>layer_9_add&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M213.57,-10505.8C213.57,-10497.86 213.57,-10488.74 213.57,-10479.44"/>
<polygon fill="black" stroke="black" points="217.07,-10479.32 213.57,-10469.32 210.07,-10479.32 217.07,-10479.32"/>
</g>
<!-- layer_10_ln1 -->
<g id="node422" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-10326 291.57,-10326 291.57,-10273 497.57,-10273 497.57,-10326"/>
<text text-anchor="middle" x="394.57" y="-10310.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-10295.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-10280.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- comm_9_10&#45;&gt;layer_10_ln1 -->
<g id="edge611" class="edge">
<title>comm_9_10&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M295.86,-10362.94C312.72,-10352.28 329.97,-10341.37 345.23,-10331.71"/>
<polygon fill="black" stroke="black" points="347.39,-10334.49 353.97,-10326.18 343.65,-10328.57 347.39,-10334.49"/>
</g>
<!-- layer_10_add1 -->
<g id="node434" class="node">
<title>layer_10_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-9554 110.57,-9554 110.57,-9501 316.57,-9501 316.57,-9554"/>
<text text-anchor="middle" x="213.57" y="-9538.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-9523.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-9508.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- comm_9_10&#45;&gt;layer_10_add1 -->
<g id="edge625" class="edge">
<title>comm_9_10&#45;&gt;layer_10_add1</title>
<path fill="none" stroke="black" d="M205.8,-10362.97C203.49,-10343.42 201.57,-10320.99 201.57,-10300.5 201.57,-10300.5 201.57,-10300.5 201.57,-9616.5 201.57,-9599.17 203.88,-9580.1 206.48,-9564.15"/>
<polygon fill="black" stroke="black" points="209.95,-9564.62 208.2,-9554.17 203.05,-9563.43 209.95,-9564.62"/>
</g>
<!-- layer_10_q_proj -->
<g id="node423" class="node">
<title>layer_10_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-10236 453.57,-10236 453.57,-10183 659.57,-10183 659.57,-10236"/>
<text text-anchor="middle" x="556.57" y="-10220.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-10205.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-10190.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_q_proj -->
<g id="edge612" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-10272.81C460.25,-10262.82 481.45,-10251.31 500.58,-10240.91"/>
<polygon fill="black" stroke="black" points="502.38,-10243.92 509.5,-10236.07 499.04,-10237.77 502.38,-10243.92"/>
</g>
<!-- layer_10_k_proj -->
<g id="node424" class="node">
<title>layer_10_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-10236 677.57,-10236 677.57,-10183 883.57,-10183 883.57,-10236"/>
<text text-anchor="middle" x="780.57" y="-10220.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-10205.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-10190.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_k_proj -->
<g id="edge613" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-10274.98C550.11,-10263.04 613.8,-10248.52 667.48,-10236.28"/>
<polygon fill="black" stroke="black" points="668.41,-10239.66 677.38,-10234.02 666.86,-10232.83 668.41,-10239.66"/>
</g>
<!-- layer_10_v_proj -->
<g id="node425" class="node">
<title>layer_10_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-10236 229.57,-10236 229.57,-10183 435.57,-10183 435.57,-10236"/>
<text text-anchor="middle" x="332.57" y="-10220.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-10205.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-10190.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_v_proj -->
<g id="edge614" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-10272.57C370.12,-10263.8 363.13,-10253.87 356.57,-10244.56"/>
<polygon fill="black" stroke="black" points="359.33,-10242.4 350.71,-10236.24 353.61,-10246.43 359.33,-10242.4"/>
</g>
<!-- layer_10_q_reshape -->
<g id="node426" class="node">
<title>layer_10_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-10146 426.57,-10146 426.57,-10093 650.57,-10093 650.57,-10146"/>
<text text-anchor="middle" x="538.57" y="-10130.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-10115.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-10100.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_q_proj&#45;&gt;layer_10_q_reshape -->
<g id="edge615" class="edge">
<title>layer_10_q_proj&#45;&gt;layer_10_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-10182.57C549.58,-10174.34 547.69,-10165.08 545.89,-10156.28"/>
<polygon fill="black" stroke="black" points="549.27,-10155.34 543.84,-10146.24 542.41,-10156.74 549.27,-10155.34"/>
</g>
<!-- layer_10_k_reshape -->
<g id="node427" class="node">
<title>layer_10_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-10146 668.57,-10146 668.57,-10093 892.57,-10093 892.57,-10146"/>
<text text-anchor="middle" x="780.57" y="-10130.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-10115.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-10100.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_k_proj&#45;&gt;layer_10_k_reshape -->
<g id="edge616" class="edge">
<title>layer_10_k_proj&#45;&gt;layer_10_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-10182.57C780.57,-10174.34 780.57,-10165.08 780.57,-10156.28"/>
<polygon fill="black" stroke="black" points="784.07,-10156.24 780.57,-10146.24 777.07,-10156.24 784.07,-10156.24"/>
</g>
<!-- layer_10_v_reshape -->
<g id="node428" class="node">
<title>layer_10_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-10075 225.57,-10075 225.57,-10022 449.57,-10022 449.57,-10075"/>
<text text-anchor="middle" x="337.57" y="-10059.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-10044.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-10029.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_v_proj&#45;&gt;layer_10_v_reshape -->
<g id="edge617" class="edge">
<title>layer_10_v_proj&#45;&gt;layer_10_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-10182.95C334.2,-10156.61 335.5,-10115.29 336.44,-10085.61"/>
<polygon fill="black" stroke="black" points="339.95,-10085.35 336.76,-10075.25 332.95,-10085.13 339.95,-10085.35"/>
</g>
<!-- layer_10_attn_scores -->
<g id="node429" class="node">
<title>layer_10_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-10004 422.07,-10004 422.07,-9951 655.07,-9951 655.07,-10004"/>
<text text-anchor="middle" x="538.57" y="-9988.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-9973.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-9958.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_q_reshape&#45;&gt;layer_10_attn_scores -->
<g id="edge618" class="edge">
<title>layer_10_q_reshape&#45;&gt;layer_10_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-10092.82C538.57,-10070.72 538.57,-10038.6 538.57,-10014.03"/>
<polygon fill="black" stroke="black" points="542.07,-10014.02 538.57,-10004.02 535.07,-10014.02 542.07,-10014.02"/>
</g>
<!-- layer_10_k_reshape&#45;&gt;layer_10_attn_scores -->
<g id="edge619" class="edge">
<title>layer_10_k_reshape&#45;&gt;layer_10_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-10092.98C695.65,-10069.37 634.91,-10034.23 591.5,-10009.12"/>
<polygon fill="black" stroke="black" points="593.19,-10006.05 582.78,-10004.08 589.68,-10012.11 593.19,-10006.05"/>
</g>
<!-- layer_10_attn_output -->
<g id="node431" class="node">
<title>layer_10_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-9824 229.57,-9824 229.57,-9771 453.57,-9771 453.57,-9824"/>
<text text-anchor="middle" x="341.57" y="-9808.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-9793.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-9778.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_v_reshape&#45;&gt;layer_10_attn_output -->
<g id="edge622" class="edge">
<title>layer_10_v_reshape&#45;&gt;layer_10_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-10021.79C338.7,-9977.13 340.18,-9885.13 341,-9834.27"/>
<polygon fill="black" stroke="black" points="344.5,-9834.12 341.16,-9824.07 337.5,-9834.01 344.5,-9834.12"/>
</g>
<!-- layer_10_attn_weights -->
<g id="node430" class="node">
<title>layer_10_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="631.07,-9914 398.07,-9914 398.07,-9861 631.07,-9861 631.07,-9914"/>
<text text-anchor="middle" x="514.57" y="-9898.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="514.57" y="-9883.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="514.57" y="-9868.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_scores&#45;&gt;layer_10_attn_weights -->
<g id="edge620" class="edge">
<title>layer_10_attn_scores&#45;&gt;layer_10_attn_weights</title>
<path fill="none" stroke="black" d="M531.5,-9950.57C529.23,-9942.25 526.67,-9932.88 524.25,-9923.99"/>
<polygon fill="black" stroke="black" points="527.6,-9922.97 521.59,-9914.24 520.85,-9924.81 527.6,-9922.97"/>
</g>
<!-- layer_10_attn_weights&#45;&gt;layer_10_attn_output -->
<g id="edge621" class="edge">
<title>layer_10_attn_weights&#45;&gt;layer_10_attn_output</title>
<path fill="none" stroke="black" d="M464.07,-9860.81C444.26,-9850.73 421.39,-9839.1 400.81,-9828.63"/>
<polygon fill="black" stroke="black" points="402.34,-9825.48 391.84,-9824.07 399.16,-9831.72 402.34,-9825.48"/>
</g>
<!-- layer_10_attn_reshape -->
<g id="node432" class="node">
<title>layer_10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-9734 236.57,-9734 236.57,-9681 442.57,-9681 442.57,-9734"/>
<text text-anchor="middle" x="339.57" y="-9718.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-9703.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-9688.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_output&#45;&gt;layer_10_attn_reshape -->
<g id="edge623" class="edge">
<title>layer_10_attn_output&#45;&gt;layer_10_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-9770.57C340.79,-9762.34 340.58,-9753.08 340.38,-9744.28"/>
<polygon fill="black" stroke="black" points="343.88,-9744.16 340.16,-9734.24 336.88,-9744.32 343.88,-9744.16"/>
</g>
<!-- layer_10_attn_proj -->
<g id="node433" class="node">
<title>layer_10_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-9644 233.57,-9644 233.57,-9591 439.57,-9591 439.57,-9644"/>
<text text-anchor="middle" x="336.57" y="-9628.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-9613.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-9598.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_reshape&#45;&gt;layer_10_attn_proj -->
<g id="edge624" class="edge">
<title>layer_10_attn_reshape&#45;&gt;layer_10_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-9680.57C338.41,-9672.34 338.09,-9663.08 337.79,-9654.28"/>
<polygon fill="black" stroke="black" points="341.29,-9654.12 337.45,-9644.24 334.29,-9654.36 341.29,-9654.12"/>
</g>
<!-- layer_10_attn_proj&#45;&gt;layer_10_add1 -->
<g id="edge626" class="edge">
<title>layer_10_attn_proj&#45;&gt;layer_10_add1</title>
<path fill="none" stroke="black" d="M300.66,-9590.81C287.15,-9581.14 271.63,-9570.04 257.47,-9559.9"/>
<polygon fill="black" stroke="black" points="259.48,-9557.04 249.31,-9554.07 255.41,-9562.73 259.48,-9557.04"/>
</g>
<!-- layer_10_ln2 -->
<g id="node435" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-9464 827.57,-9464 827.57,-9411 1033.57,-9411 1033.57,-9464"/>
<text text-anchor="middle" x="930.57" y="-9448.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-9433.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-9418.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_add1&#45;&gt;layer_10_ln2 -->
<g id="edge627" class="edge">
<title>layer_10_add1&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M316.68,-9513.84C449.47,-9497.55 679.5,-9469.31 817.13,-9452.42"/>
<polygon fill="black" stroke="black" points="817.78,-9455.87 827.28,-9451.18 816.93,-9448.92 817.78,-9455.87"/>
</g>
<!-- layer_10_add -->
<g id="node462" class="node">
<title>layer_10_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-8808 110.57,-8808 110.57,-8755 316.57,-8755 316.57,-8808"/>
<text text-anchor="middle" x="213.57" y="-8792.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-8777.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-8762.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_add1&#45;&gt;layer_10_add -->
<g id="edge669" class="edge">
<title>layer_10_add1&#45;&gt;layer_10_add</title>
<path fill="none" stroke="black" d="M208.2,-9500.83C205.01,-9483.34 201.57,-9459.62 201.57,-9438.5 201.57,-9438.5 201.57,-9438.5 201.57,-8897 201.57,-8870.6 204.77,-8840.96 207.86,-8818.46"/>
<polygon fill="black" stroke="black" points="211.35,-8818.73 209.31,-8808.34 204.42,-8817.74 211.35,-8818.73"/>
</g>
<!-- layer_10_gate -->
<g id="node436" class="node">
<title>layer_10_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-9374 900.57,-9321 1079.57,-9268 1258.57,-9321 1079.57,-9374"/>
<text text-anchor="middle" x="1079.57" y="-9332.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-9317.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-9302.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_gate -->
<g id="edge628" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_gate</title>
<path fill="none" stroke="black" d="M964.01,-9410.8C981.28,-9397.53 1002.83,-9380.97 1022.63,-9365.76"/>
<polygon fill="black" stroke="black" points="1024.9,-9368.43 1030.69,-9359.56 1020.63,-9362.88 1024.9,-9368.43"/>
</g>
<!-- layer_10_expert_0_ffn1 -->
<g id="node437" class="node">
<title>layer_10_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-9221 677.57,-9221 677.57,-9168 883.57,-9168 883.57,-9221"/>
<text text-anchor="middle" x="780.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_0_ffn1 -->
<g id="edge630" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-9410.95C887.23,-9400.28 873.96,-9387.28 863.57,-9374 824.71,-9324.33 817.94,-9308.58 794.57,-9250 792.17,-9243.99 790.08,-9237.43 788.29,-9231.02"/>
<polygon fill="black" stroke="black" points="791.63,-9229.97 785.73,-9221.17 784.85,-9231.72 791.63,-9229.97"/>
</g>
<!-- layer_10_expert_1_ffn1 -->
<g id="node440" class="node">
<title>layer_10_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-9221 229.57,-9221 229.57,-9168 435.57,-9168 435.57,-9221"/>
<text text-anchor="middle" x="332.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_1_ffn1 -->
<g id="edge634" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-9424.27C767.36,-9414.96 691.02,-9399.31 626.57,-9374 529.83,-9336.01 428.72,-9267.16 373.91,-9226.98"/>
<polygon fill="black" stroke="black" points="375.97,-9224.14 365.84,-9221.02 371.81,-9229.78 375.97,-9224.14"/>
</g>
<!-- layer_10_expert_2_ffn1 -->
<g id="node443" class="node">
<title>layer_10_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-9221 1125.57,-9221 1125.57,-9168 1331.57,-9168 1331.57,-9221"/>
<text text-anchor="middle" x="1228.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_2_ffn1 -->
<g id="edge638" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-9431.17C1121.34,-9424.26 1237.52,-9408.69 1267.57,-9374 1306.88,-9328.62 1295.71,-9294.4 1272.57,-9239 1271.12,-9235.52 1269.24,-9232.18 1267.08,-9229.01"/>
<polygon fill="black" stroke="black" points="1269.72,-9226.71 1260.79,-9221.01 1264.22,-9231.03 1269.72,-9226.71"/>
</g>
<!-- layer_10_expert_3_ffn1 -->
<g id="node446" class="node">
<title>layer_10_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-9221 1573.57,-9221 1573.57,-9168 1779.57,-9168 1779.57,-9221"/>
<text text-anchor="middle" x="1676.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_3_ffn1 -->
<g id="edge642" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-9431.82C1122.76,-9425.39 1253.8,-9410.14 1362.57,-9374 1484.83,-9333.38 1520.13,-9325.42 1624.57,-9250 1633.08,-9243.86 1641.36,-9236.21 1648.73,-9228.6"/>
<polygon fill="black" stroke="black" points="1651.49,-9230.77 1655.76,-9221.07 1646.38,-9225.99 1651.49,-9230.77"/>
</g>
<!-- layer_10_expert_4_ffn1 -->
<g id="node449" class="node">
<title>layer_10_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-9221 453.57,-9221 453.57,-9168 659.57,-9168 659.57,-9221"/>
<text text-anchor="middle" x="556.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_4_ffn1 -->
<g id="edge646" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-9410.89C801.11,-9379.58 686.43,-9321.79 603.57,-9250 596.29,-9243.69 589.13,-9236.24 582.68,-9228.9"/>
<polygon fill="black" stroke="black" points="585.14,-9226.39 575.99,-9221.05 579.81,-9230.93 585.14,-9226.39"/>
</g>
<!-- layer_10_expert_5_ffn1 -->
<g id="node452" class="node">
<title>layer_10_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-9221 1349.57,-9221 1349.57,-9168 1555.57,-9168 1555.57,-9221"/>
<text text-anchor="middle" x="1452.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_5_ffn1 -->
<g id="edge650" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-9430.77C1098.02,-9425.2 1181.84,-9414.3 1253.57,-9393 1272.44,-9387.4 1277.44,-9385.28 1293.57,-9374 1357.95,-9328.96 1370.85,-9311.64 1419.57,-9250 1424.54,-9243.72 1429.34,-9236.63 1433.66,-9229.69"/>
<polygon fill="black" stroke="black" points="1436.7,-9231.43 1438.87,-9221.05 1430.71,-9227.81 1436.7,-9231.43"/>
</g>
<!-- layer_10_expert_6_ffn1 -->
<g id="node455" class="node">
<title>layer_10_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-9221 1797.57,-9221 1797.57,-9168 2003.57,-9168 2003.57,-9221"/>
<text text-anchor="middle" x="1900.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_6_ffn1 -->
<g id="edge654" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-9434.36C1147.98,-9429.86 1336.72,-9416.05 1493.57,-9374 1625.52,-9338.63 1769.63,-9266.8 1845.97,-9225.86"/>
<polygon fill="black" stroke="black" points="1847.8,-9228.86 1854.94,-9221.03 1844.47,-9222.69 1847.8,-9228.86"/>
</g>
<!-- layer_10_expert_7_ffn1 -->
<g id="node458" class="node">
<title>layer_10_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-9221 901.57,-9221 901.57,-9168 1107.57,-9168 1107.57,-9221"/>
<text text-anchor="middle" x="1004.57" y="-9205.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-9190.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-9175.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_expert_7_ffn1 -->
<g id="edge658" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-9410.92C903.08,-9400.14 895.6,-9387.08 891.57,-9374 873.88,-9316.62 852.23,-9288.25 886.57,-9239 889.58,-9234.69 893.06,-9230.8 896.91,-9227.3"/>
<polygon fill="black" stroke="black" points="899.11,-9230.02 904.71,-9221.03 894.73,-9224.56 899.11,-9230.02"/>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_0_ffn1 -->
<g id="edge629" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-9289.54C959.2,-9269.88 898.07,-9244.43 851.32,-9224.96"/>
<polygon fill="black" stroke="black" points="852.45,-9221.64 841.87,-9221.03 849.76,-9228.1 852.45,-9221.64"/>
<text text-anchor="middle" x="924.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_1_ffn1 -->
<g id="edge633" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-9303.72C833.08,-9286.17 630.07,-9256.21 445.54,-9221.14"/>
<polygon fill="black" stroke="black" points="446.13,-9217.69 435.65,-9219.25 444.82,-9224.56 446.13,-9217.69"/>
<text text-anchor="middle" x="623.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_2_ffn1 -->
<g id="edge637" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-9278.47C1129.09,-9265.16 1143.87,-9250.81 1158.57,-9239 1163.82,-9234.78 1169.5,-9230.65 1175.28,-9226.71"/>
<polygon fill="black" stroke="black" points="1177.37,-9229.52 1183.77,-9221.09 1173.5,-9223.68 1177.37,-9229.52"/>
<text text-anchor="middle" x="1180.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_3_ffn1 -->
<g id="edge641" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-9298.7C1263.24,-9282.33 1376.38,-9259.18 1475.57,-9239 1512.26,-9231.54 1523.52,-9229.73 1563.55,-9221.2"/>
<polygon fill="black" stroke="black" points="1564.41,-9224.59 1573.46,-9219.08 1562.94,-9217.75 1564.41,-9224.59"/>
<text text-anchor="middle" x="1497.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_4_ffn1 -->
<g id="edge645" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-9296.8C893.49,-9275.7 762.7,-9244.57 669.53,-9222.39"/>
<polygon fill="black" stroke="black" points="670.33,-9218.98 659.79,-9220.07 668.7,-9225.79 670.33,-9218.98"/>
<text text-anchor="middle" x="792.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_5_ffn1 -->
<g id="edge649" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-9289.6C1193.35,-9273.52 1244.3,-9254.05 1290.57,-9239 1306.78,-9233.73 1324.04,-9228.6 1341.02,-9223.81"/>
<polygon fill="black" stroke="black" points="1342.29,-9227.09 1350.98,-9221.04 1340.41,-9220.35 1342.29,-9227.09"/>
<text text-anchor="middle" x="1312.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_6_ffn1 -->
<g id="edge653" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-9305.57C1346.62,-9288.91 1578.71,-9259.07 1787.57,-9221.13"/>
<polygon fill="black" stroke="black" points="1788.29,-9224.55 1797.5,-9219.31 1787.04,-9217.67 1788.29,-9224.55"/>
<text text-anchor="middle" x="1694.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_10_gate&#45;&gt;layer_10_expert_7_ffn1 -->
<g id="edge657" class="edge">
<title>layer_10_gate&#45;&gt;layer_10_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-9275.76C1043.87,-9260.73 1033.9,-9244.18 1025.37,-9230.03"/>
<polygon fill="black" stroke="black" points="1028.16,-9227.88 1020,-9221.12 1022.17,-9231.49 1028.16,-9227.88"/>
<text text-anchor="middle" x="1056.57" y="-9242" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_10_expert_0_gelu -->
<g id="node438" class="node">
<title>layer_10_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-9131 677.57,-9131 677.57,-9078 883.57,-9078 883.57,-9131"/>
<text text-anchor="middle" x="780.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_0_ffn1&#45;&gt;layer_10_expert_0_gelu -->
<g id="edge631" class="edge">
<title>layer_10_expert_0_ffn1&#45;&gt;layer_10_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-9167.57C780.57,-9159.34 780.57,-9150.08 780.57,-9141.28"/>
<polygon fill="black" stroke="black" points="784.07,-9141.24 780.57,-9131.24 777.07,-9141.24 784.07,-9141.24"/>
</g>
<!-- layer_10_expert_0_ffn2 -->
<g id="node439" class="node">
<title>layer_10_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-9041 677.57,-9041 677.57,-8988 883.57,-8988 883.57,-9041"/>
<text text-anchor="middle" x="780.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_0_gelu&#45;&gt;layer_10_expert_0_ffn2 -->
<g id="edge632" class="edge">
<title>layer_10_expert_0_gelu&#45;&gt;layer_10_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-9077.57C780.57,-9069.34 780.57,-9060.08 780.57,-9051.28"/>
<polygon fill="black" stroke="black" points="784.07,-9051.24 780.57,-9041.24 777.07,-9051.24 784.07,-9051.24"/>
</g>
<!-- layer_10_expert_agg -->
<g id="node461" class="node">
<title>layer_10_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-8951 878.36,-8951 790.93,-8845 1130.79,-8845 1218.21,-8951"/>
<text text-anchor="middle" x="1004.57" y="-8909.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-8894.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-8879.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_0_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge661" class="edge">
<title>layer_10_expert_0_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-8987.95C849.26,-8978.39 871.33,-8967.11 893.35,-8955.85"/>
<polygon fill="black" stroke="black" points="895.14,-8958.87 902.45,-8951.2 891.95,-8952.64 895.14,-8958.87"/>
</g>
<!-- layer_10_expert_1_gelu -->
<g id="node441" class="node">
<title>layer_10_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-9131 229.57,-9131 229.57,-9078 435.57,-9078 435.57,-9131"/>
<text text-anchor="middle" x="332.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_1_ffn1&#45;&gt;layer_10_expert_1_gelu -->
<g id="edge635" class="edge">
<title>layer_10_expert_1_ffn1&#45;&gt;layer_10_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-9167.57C332.57,-9159.34 332.57,-9150.08 332.57,-9141.28"/>
<polygon fill="black" stroke="black" points="336.07,-9141.24 332.57,-9131.24 329.07,-9141.24 336.07,-9141.24"/>
</g>
<!-- layer_10_expert_1_ffn2 -->
<g id="node442" class="node">
<title>layer_10_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-9041 229.57,-9041 229.57,-8988 435.57,-8988 435.57,-9041"/>
<text text-anchor="middle" x="332.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_1_gelu&#45;&gt;layer_10_expert_1_ffn2 -->
<g id="edge636" class="edge">
<title>layer_10_expert_1_gelu&#45;&gt;layer_10_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-9077.57C332.57,-9069.34 332.57,-9060.08 332.57,-9051.28"/>
<polygon fill="black" stroke="black" points="336.07,-9051.24 332.57,-9041.24 329.07,-9051.24 336.07,-9051.24"/>
</g>
<!-- layer_10_expert_1_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge662" class="edge">
<title>layer_10_expert_1_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-8989.76C438.66,-8989.16 441.63,-8988.57 444.57,-8988 578.16,-8962.21 730.72,-8938.32 842.83,-8921.81"/>
<polygon fill="black" stroke="black" points="843.49,-8925.25 852.87,-8920.33 842.47,-8918.32 843.49,-8925.25"/>
</g>
<!-- layer_10_expert_2_gelu -->
<g id="node444" class="node">
<title>layer_10_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-9131 1125.57,-9131 1125.57,-9078 1331.57,-9078 1331.57,-9131"/>
<text text-anchor="middle" x="1228.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_2_ffn1&#45;&gt;layer_10_expert_2_gelu -->
<g id="edge639" class="edge">
<title>layer_10_expert_2_ffn1&#45;&gt;layer_10_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-9167.57C1228.57,-9159.34 1228.57,-9150.08 1228.57,-9141.28"/>
<polygon fill="black" stroke="black" points="1232.07,-9141.24 1228.57,-9131.24 1225.07,-9141.24 1232.07,-9141.24"/>
</g>
<!-- layer_10_expert_2_ffn2 -->
<g id="node445" class="node">
<title>layer_10_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-9041 1125.57,-9041 1125.57,-8988 1331.57,-8988 1331.57,-9041"/>
<text text-anchor="middle" x="1228.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_2_gelu&#45;&gt;layer_10_expert_2_ffn2 -->
<g id="edge640" class="edge">
<title>layer_10_expert_2_gelu&#45;&gt;layer_10_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-9077.57C1228.57,-9069.34 1228.57,-9060.08 1228.57,-9051.28"/>
<polygon fill="black" stroke="black" points="1232.07,-9051.24 1228.57,-9041.24 1225.07,-9051.24 1232.07,-9051.24"/>
</g>
<!-- layer_10_expert_2_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge663" class="edge">
<title>layer_10_expert_2_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-8987.95C1159.88,-8978.39 1137.81,-8967.11 1115.79,-8955.85"/>
<polygon fill="black" stroke="black" points="1117.19,-8952.64 1106.7,-8951.2 1114.01,-8958.87 1117.19,-8952.64"/>
</g>
<!-- layer_10_expert_3_gelu -->
<g id="node447" class="node">
<title>layer_10_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-9131 1573.57,-9131 1573.57,-9078 1779.57,-9078 1779.57,-9131"/>
<text text-anchor="middle" x="1676.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_3_ffn1&#45;&gt;layer_10_expert_3_gelu -->
<g id="edge643" class="edge">
<title>layer_10_expert_3_ffn1&#45;&gt;layer_10_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-9167.57C1676.57,-9159.34 1676.57,-9150.08 1676.57,-9141.28"/>
<polygon fill="black" stroke="black" points="1680.07,-9141.24 1676.57,-9131.24 1673.07,-9141.24 1680.07,-9141.24"/>
</g>
<!-- layer_10_expert_3_ffn2 -->
<g id="node448" class="node">
<title>layer_10_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-9041 1573.57,-9041 1573.57,-8988 1779.57,-8988 1779.57,-9041"/>
<text text-anchor="middle" x="1676.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_3_gelu&#45;&gt;layer_10_expert_3_ffn2 -->
<g id="edge644" class="edge">
<title>layer_10_expert_3_gelu&#45;&gt;layer_10_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-9077.57C1676.57,-9069.34 1676.57,-9060.08 1676.57,-9051.28"/>
<polygon fill="black" stroke="black" points="1680.07,-9051.24 1676.57,-9041.24 1673.07,-9051.24 1680.07,-9051.24"/>
</g>
<!-- layer_10_expert_3_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge664" class="edge">
<title>layer_10_expert_3_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-8989.76C1570.49,-8989.16 1567.51,-8988.57 1564.57,-8988 1446.94,-8965.29 1314.59,-8944.06 1208.1,-8928.03"/>
<polygon fill="black" stroke="black" points="1208.61,-8924.57 1198.21,-8926.54 1207.58,-8931.49 1208.61,-8924.57"/>
</g>
<!-- layer_10_expert_4_gelu -->
<g id="node450" class="node">
<title>layer_10_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-9131 453.57,-9131 453.57,-9078 659.57,-9078 659.57,-9131"/>
<text text-anchor="middle" x="556.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_4_ffn1&#45;&gt;layer_10_expert_4_gelu -->
<g id="edge647" class="edge">
<title>layer_10_expert_4_ffn1&#45;&gt;layer_10_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-9167.57C556.57,-9159.34 556.57,-9150.08 556.57,-9141.28"/>
<polygon fill="black" stroke="black" points="560.07,-9141.24 556.57,-9131.24 553.07,-9141.24 560.07,-9141.24"/>
</g>
<!-- layer_10_expert_4_ffn2 -->
<g id="node451" class="node">
<title>layer_10_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-9041 453.57,-9041 453.57,-8988 659.57,-8988 659.57,-9041"/>
<text text-anchor="middle" x="556.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_4_gelu&#45;&gt;layer_10_expert_4_ffn2 -->
<g id="edge648" class="edge">
<title>layer_10_expert_4_gelu&#45;&gt;layer_10_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-9077.57C556.57,-9069.34 556.57,-9060.08 556.57,-9051.28"/>
<polygon fill="black" stroke="black" points="560.07,-9051.24 556.57,-9041.24 553.07,-9051.24 560.07,-9051.24"/>
</g>
<!-- layer_10_expert_4_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge665" class="edge">
<title>layer_10_expert_4_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-8987.95C714.81,-8973.06 789.41,-8953.99 854.59,-8937.33"/>
<polygon fill="black" stroke="black" points="855.73,-8940.65 864.55,-8934.79 853.99,-8933.87 855.73,-8940.65"/>
</g>
<!-- layer_10_expert_5_gelu -->
<g id="node453" class="node">
<title>layer_10_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-9131 1349.57,-9131 1349.57,-9078 1555.57,-9078 1555.57,-9131"/>
<text text-anchor="middle" x="1452.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_5_ffn1&#45;&gt;layer_10_expert_5_gelu -->
<g id="edge651" class="edge">
<title>layer_10_expert_5_ffn1&#45;&gt;layer_10_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-9167.57C1452.57,-9159.34 1452.57,-9150.08 1452.57,-9141.28"/>
<polygon fill="black" stroke="black" points="1456.07,-9141.24 1452.57,-9131.24 1449.07,-9141.24 1456.07,-9141.24"/>
</g>
<!-- layer_10_expert_5_ffn2 -->
<g id="node454" class="node">
<title>layer_10_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-9041 1349.57,-9041 1349.57,-8988 1555.57,-8988 1555.57,-9041"/>
<text text-anchor="middle" x="1452.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_5_gelu&#45;&gt;layer_10_expert_5_ffn2 -->
<g id="edge652" class="edge">
<title>layer_10_expert_5_gelu&#45;&gt;layer_10_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-9077.57C1452.57,-9069.34 1452.57,-9060.08 1452.57,-9051.28"/>
<polygon fill="black" stroke="black" points="1456.07,-9051.24 1452.57,-9041.24 1449.07,-9051.24 1456.07,-9051.24"/>
</g>
<!-- layer_10_expert_5_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge666" class="edge">
<title>layer_10_expert_5_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-8987.95C1312.66,-8977.74 1265.05,-8965.57 1218.07,-8953.57"/>
<polygon fill="black" stroke="black" points="1218.92,-8950.17 1208.37,-8951.09 1217.19,-8956.95 1218.92,-8950.17"/>
</g>
<!-- layer_10_expert_6_gelu -->
<g id="node456" class="node">
<title>layer_10_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-9131 1797.57,-9131 1797.57,-9078 2003.57,-9078 2003.57,-9131"/>
<text text-anchor="middle" x="1900.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_6_ffn1&#45;&gt;layer_10_expert_6_gelu -->
<g id="edge655" class="edge">
<title>layer_10_expert_6_ffn1&#45;&gt;layer_10_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-9167.57C1900.57,-9159.34 1900.57,-9150.08 1900.57,-9141.28"/>
<polygon fill="black" stroke="black" points="1904.07,-9141.24 1900.57,-9131.24 1897.07,-9141.24 1904.07,-9141.24"/>
</g>
<!-- layer_10_expert_6_ffn2 -->
<g id="node457" class="node">
<title>layer_10_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-9041 1797.57,-9041 1797.57,-8988 2003.57,-8988 2003.57,-9041"/>
<text text-anchor="middle" x="1900.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_6_gelu&#45;&gt;layer_10_expert_6_ffn2 -->
<g id="edge656" class="edge">
<title>layer_10_expert_6_gelu&#45;&gt;layer_10_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-9077.57C1900.57,-9069.34 1900.57,-9060.08 1900.57,-9051.28"/>
<polygon fill="black" stroke="black" points="1904.07,-9051.24 1900.57,-9041.24 1897.07,-9051.24 1904.07,-9051.24"/>
</g>
<!-- layer_10_expert_6_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge667" class="edge">
<title>layer_10_expert_6_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-8989.59C1794.51,-8989.03 1791.52,-8988.5 1788.57,-8988 1588.54,-8953.98 1357.51,-8929.53 1198.33,-8914.97"/>
<polygon fill="black" stroke="black" points="1198.23,-8911.45 1187.95,-8914.03 1197.59,-8918.42 1198.23,-8911.45"/>
</g>
<!-- layer_10_expert_7_gelu -->
<g id="node459" class="node">
<title>layer_10_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-9131 901.57,-9131 901.57,-9078 1107.57,-9078 1107.57,-9131"/>
<text text-anchor="middle" x="1004.57" y="-9115.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-9100.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-9085.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_7_ffn1&#45;&gt;layer_10_expert_7_gelu -->
<g id="edge659" class="edge">
<title>layer_10_expert_7_ffn1&#45;&gt;layer_10_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-9167.57C1004.57,-9159.34 1004.57,-9150.08 1004.57,-9141.28"/>
<polygon fill="black" stroke="black" points="1008.07,-9141.24 1004.57,-9131.24 1001.07,-9141.24 1008.07,-9141.24"/>
</g>
<!-- layer_10_expert_7_ffn2 -->
<g id="node460" class="node">
<title>layer_10_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-9041 901.57,-9041 901.57,-8988 1107.57,-8988 1107.57,-9041"/>
<text text-anchor="middle" x="1004.57" y="-9025.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-9010.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-8995.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_expert_7_gelu&#45;&gt;layer_10_expert_7_ffn2 -->
<g id="edge660" class="edge">
<title>layer_10_expert_7_gelu&#45;&gt;layer_10_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-9077.57C1004.57,-9069.34 1004.57,-9060.08 1004.57,-9051.28"/>
<polygon fill="black" stroke="black" points="1008.07,-9051.24 1004.57,-9041.24 1001.07,-9051.24 1008.07,-9051.24"/>
</g>
<!-- layer_10_expert_7_ffn2&#45;&gt;layer_10_expert_agg -->
<g id="edge668" class="edge">
<title>layer_10_expert_7_ffn2&#45;&gt;layer_10_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-8987.8C1004.57,-8979.86 1004.57,-8970.74 1004.57,-8961.44"/>
<polygon fill="black" stroke="black" points="1008.07,-8961.32 1004.57,-8951.32 1001.07,-8961.32 1008.07,-8961.32"/>
</g>
<!-- layer_10_expert_agg&#45;&gt;layer_10_add -->
<g id="edge670" class="edge">
<title>layer_10_expert_agg&#45;&gt;layer_10_add</title>
<path fill="none" stroke="black" d="M810.56,-8868.92C658.7,-8846.93 452.76,-8817.12 326.73,-8798.88"/>
<polygon fill="black" stroke="black" points="327.07,-8795.39 316.67,-8797.42 326.07,-8802.32 327.07,-8795.39"/>
</g>
<!-- comm_10_11 -->
<g id="node463" class="node">
<title>comm_10_11</title>
<polygon fill="yellow" stroke="black" points="427.21,-8718 87.36,-8718 -0.07,-8612 339.79,-8612 427.21,-8718"/>
<text text-anchor="middle" x="213.57" y="-8676.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-8661.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-8646.3" font-family="Times,serif" font-size="14.00">GPU 10  GPU 11</text>
</g>
<!-- layer_10_add&#45;&gt;comm_10_11 -->
<g id="edge671" class="edge">
<title>layer_10_add&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M213.57,-8754.8C213.57,-8746.86 213.57,-8737.74 213.57,-8728.44"/>
<polygon fill="black" stroke="black" points="217.07,-8728.32 213.57,-8718.32 210.07,-8728.32 217.07,-8728.32"/>
</g>
<!-- layer_11_ln1 -->
<g id="node464" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-8575 291.57,-8575 291.57,-8522 497.57,-8522 497.57,-8575"/>
<text text-anchor="middle" x="394.57" y="-8559.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-8544.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-8529.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- comm_10_11&#45;&gt;layer_11_ln1 -->
<g id="edge672" class="edge">
<title>comm_10_11&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M295.86,-8611.94C312.72,-8601.28 329.97,-8590.37 345.23,-8580.71"/>
<polygon fill="black" stroke="black" points="347.39,-8583.49 353.97,-8575.18 343.65,-8577.57 347.39,-8583.49"/>
</g>
<!-- layer_11_add1 -->
<g id="node476" class="node">
<title>layer_11_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-7803 110.57,-7803 110.57,-7750 316.57,-7750 316.57,-7803"/>
<text text-anchor="middle" x="213.57" y="-7787.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-7772.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-7757.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- comm_10_11&#45;&gt;layer_11_add1 -->
<g id="edge686" class="edge">
<title>comm_10_11&#45;&gt;layer_11_add1</title>
<path fill="none" stroke="black" d="M205.8,-8611.97C203.49,-8592.42 201.57,-8569.99 201.57,-8549.5 201.57,-8549.5 201.57,-8549.5 201.57,-7865.5 201.57,-7848.17 203.88,-7829.1 206.48,-7813.15"/>
<polygon fill="black" stroke="black" points="209.95,-7813.62 208.2,-7803.17 203.05,-7812.43 209.95,-7813.62"/>
</g>
<!-- layer_11_q_proj -->
<g id="node465" class="node">
<title>layer_11_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-8485 453.57,-8485 453.57,-8432 659.57,-8432 659.57,-8485"/>
<text text-anchor="middle" x="556.57" y="-8469.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-8454.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-8439.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_q_proj -->
<g id="edge673" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-8521.81C460.25,-8511.82 481.45,-8500.31 500.58,-8489.91"/>
<polygon fill="black" stroke="black" points="502.38,-8492.92 509.5,-8485.07 499.04,-8486.77 502.38,-8492.92"/>
</g>
<!-- layer_11_k_proj -->
<g id="node466" class="node">
<title>layer_11_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-8485 677.57,-8485 677.57,-8432 883.57,-8432 883.57,-8485"/>
<text text-anchor="middle" x="780.57" y="-8469.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-8454.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-8439.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_k_proj -->
<g id="edge674" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-8523.98C550.11,-8512.04 613.8,-8497.52 667.48,-8485.28"/>
<polygon fill="black" stroke="black" points="668.41,-8488.66 677.38,-8483.02 666.86,-8481.83 668.41,-8488.66"/>
</g>
<!-- layer_11_v_proj -->
<g id="node467" class="node">
<title>layer_11_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-8485 229.57,-8485 229.57,-8432 435.57,-8432 435.57,-8485"/>
<text text-anchor="middle" x="332.57" y="-8469.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-8454.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-8439.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_v_proj -->
<g id="edge675" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-8521.57C370.12,-8512.8 363.13,-8502.87 356.57,-8493.56"/>
<polygon fill="black" stroke="black" points="359.33,-8491.4 350.71,-8485.24 353.61,-8495.43 359.33,-8491.4"/>
</g>
<!-- layer_11_q_reshape -->
<g id="node468" class="node">
<title>layer_11_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-8395 426.57,-8395 426.57,-8342 650.57,-8342 650.57,-8395"/>
<text text-anchor="middle" x="538.57" y="-8379.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-8364.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-8349.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_q_proj&#45;&gt;layer_11_q_reshape -->
<g id="edge676" class="edge">
<title>layer_11_q_proj&#45;&gt;layer_11_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-8431.57C549.58,-8423.34 547.69,-8414.08 545.89,-8405.28"/>
<polygon fill="black" stroke="black" points="549.27,-8404.34 543.84,-8395.24 542.41,-8405.74 549.27,-8404.34"/>
</g>
<!-- layer_11_k_reshape -->
<g id="node469" class="node">
<title>layer_11_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-8395 668.57,-8395 668.57,-8342 892.57,-8342 892.57,-8395"/>
<text text-anchor="middle" x="780.57" y="-8379.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-8364.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-8349.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_k_proj&#45;&gt;layer_11_k_reshape -->
<g id="edge677" class="edge">
<title>layer_11_k_proj&#45;&gt;layer_11_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-8431.57C780.57,-8423.34 780.57,-8414.08 780.57,-8405.28"/>
<polygon fill="black" stroke="black" points="784.07,-8405.24 780.57,-8395.24 777.07,-8405.24 784.07,-8405.24"/>
</g>
<!-- layer_11_v_reshape -->
<g id="node470" class="node">
<title>layer_11_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-8324 226.57,-8324 226.57,-8271 450.57,-8271 450.57,-8324"/>
<text text-anchor="middle" x="338.57" y="-8308.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-8293.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-8278.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_v_proj&#45;&gt;layer_11_v_reshape -->
<g id="edge678" class="edge">
<title>layer_11_v_proj&#45;&gt;layer_11_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-8431.95C334.53,-8405.61 336.09,-8364.29 337.21,-8334.61"/>
<polygon fill="black" stroke="black" points="340.72,-8334.37 337.6,-8324.25 333.72,-8334.11 340.72,-8334.37"/>
</g>
<!-- layer_11_attn_scores -->
<g id="node471" class="node">
<title>layer_11_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-8253 422.07,-8253 422.07,-8200 655.07,-8200 655.07,-8253"/>
<text text-anchor="middle" x="538.57" y="-8237.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-8222.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-8207.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_q_reshape&#45;&gt;layer_11_attn_scores -->
<g id="edge679" class="edge">
<title>layer_11_q_reshape&#45;&gt;layer_11_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-8341.82C538.57,-8319.72 538.57,-8287.6 538.57,-8263.03"/>
<polygon fill="black" stroke="black" points="542.07,-8263.02 538.57,-8253.02 535.07,-8263.02 542.07,-8263.02"/>
</g>
<!-- layer_11_k_reshape&#45;&gt;layer_11_attn_scores -->
<g id="edge680" class="edge">
<title>layer_11_k_reshape&#45;&gt;layer_11_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-8341.98C695.65,-8318.37 634.91,-8283.23 591.5,-8258.12"/>
<polygon fill="black" stroke="black" points="593.19,-8255.05 582.78,-8253.08 589.68,-8261.11 593.19,-8255.05"/>
</g>
<!-- layer_11_attn_output -->
<g id="node473" class="node">
<title>layer_11_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-8073 229.57,-8073 229.57,-8020 453.57,-8020 453.57,-8073"/>
<text text-anchor="middle" x="341.57" y="-8057.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-8042.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-8027.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_v_reshape&#45;&gt;layer_11_attn_output -->
<g id="edge683" class="edge">
<title>layer_11_v_reshape&#45;&gt;layer_11_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-8270.79C339.42,-8226.13 340.53,-8134.13 341.14,-8083.27"/>
<polygon fill="black" stroke="black" points="344.64,-8083.11 341.26,-8073.07 337.64,-8083.03 344.64,-8083.11"/>
</g>
<!-- layer_11_attn_weights -->
<g id="node472" class="node">
<title>layer_11_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="628.07,-8163 395.07,-8163 395.07,-8110 628.07,-8110 628.07,-8163"/>
<text text-anchor="middle" x="511.57" y="-8147.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="511.57" y="-8132.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="511.57" y="-8117.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_scores&#45;&gt;layer_11_attn_weights -->
<g id="edge681" class="edge">
<title>layer_11_attn_scores&#45;&gt;layer_11_attn_weights</title>
<path fill="none" stroke="black" d="M530.62,-8199.57C528.06,-8191.25 525.19,-8181.88 522.46,-8172.99"/>
<polygon fill="black" stroke="black" points="525.75,-8171.78 519.47,-8163.24 519.06,-8173.83 525.75,-8171.78"/>
</g>
<!-- layer_11_attn_weights&#45;&gt;layer_11_attn_output -->
<g id="edge682" class="edge">
<title>layer_11_attn_weights&#45;&gt;layer_11_attn_output</title>
<path fill="none" stroke="black" d="M461.94,-8109.81C442.57,-8099.78 420.2,-8088.2 400.05,-8077.77"/>
<polygon fill="black" stroke="black" points="401.46,-8074.56 390.97,-8073.07 398.24,-8080.77 401.46,-8074.56"/>
</g>
<!-- layer_11_attn_reshape -->
<g id="node474" class="node">
<title>layer_11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-7983 236.57,-7983 236.57,-7930 442.57,-7930 442.57,-7983"/>
<text text-anchor="middle" x="339.57" y="-7967.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-7952.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-7937.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_output&#45;&gt;layer_11_attn_reshape -->
<g id="edge684" class="edge">
<title>layer_11_attn_output&#45;&gt;layer_11_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-8019.57C340.79,-8011.34 340.58,-8002.08 340.38,-7993.28"/>
<polygon fill="black" stroke="black" points="343.88,-7993.16 340.16,-7983.24 336.88,-7993.32 343.88,-7993.16"/>
</g>
<!-- layer_11_attn_proj -->
<g id="node475" class="node">
<title>layer_11_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-7893 233.57,-7893 233.57,-7840 439.57,-7840 439.57,-7893"/>
<text text-anchor="middle" x="336.57" y="-7877.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-7862.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-7847.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_reshape&#45;&gt;layer_11_attn_proj -->
<g id="edge685" class="edge">
<title>layer_11_attn_reshape&#45;&gt;layer_11_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-7929.57C338.41,-7921.34 338.09,-7912.08 337.79,-7903.28"/>
<polygon fill="black" stroke="black" points="341.29,-7903.12 337.45,-7893.24 334.29,-7903.36 341.29,-7903.12"/>
</g>
<!-- layer_11_attn_proj&#45;&gt;layer_11_add1 -->
<g id="edge687" class="edge">
<title>layer_11_attn_proj&#45;&gt;layer_11_add1</title>
<path fill="none" stroke="black" d="M300.66,-7839.81C287.15,-7830.14 271.63,-7819.04 257.47,-7808.9"/>
<polygon fill="black" stroke="black" points="259.48,-7806.04 249.31,-7803.07 255.41,-7811.73 259.48,-7806.04"/>
</g>
<!-- layer_11_ln2 -->
<g id="node477" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-7713 827.57,-7713 827.57,-7660 1033.57,-7660 1033.57,-7713"/>
<text text-anchor="middle" x="930.57" y="-7697.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-7682.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-7667.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_add1&#45;&gt;layer_11_ln2 -->
<g id="edge688" class="edge">
<title>layer_11_add1&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M316.68,-7762.84C449.47,-7746.55 679.5,-7718.31 817.13,-7701.42"/>
<polygon fill="black" stroke="black" points="817.78,-7704.87 827.28,-7700.18 816.93,-7697.92 817.78,-7704.87"/>
</g>
<!-- layer_11_add -->
<g id="node504" class="node">
<title>layer_11_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-7057 110.57,-7057 110.57,-7004 316.57,-7004 316.57,-7057"/>
<text text-anchor="middle" x="213.57" y="-7041.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-7026.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-7011.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_add1&#45;&gt;layer_11_add -->
<g id="edge730" class="edge">
<title>layer_11_add1&#45;&gt;layer_11_add</title>
<path fill="none" stroke="black" d="M208.2,-7749.83C205.01,-7732.34 201.57,-7708.62 201.57,-7687.5 201.57,-7687.5 201.57,-7687.5 201.57,-7146 201.57,-7119.6 204.77,-7089.96 207.86,-7067.46"/>
<polygon fill="black" stroke="black" points="211.35,-7067.73 209.31,-7057.34 204.42,-7066.74 211.35,-7067.73"/>
</g>
<!-- layer_11_gate -->
<g id="node478" class="node">
<title>layer_11_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-7623 900.57,-7570 1079.57,-7517 1258.57,-7570 1079.57,-7623"/>
<text text-anchor="middle" x="1079.57" y="-7581.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-7566.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-7551.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_gate -->
<g id="edge689" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_gate</title>
<path fill="none" stroke="black" d="M964.01,-7659.8C981.28,-7646.53 1002.83,-7629.97 1022.63,-7614.76"/>
<polygon fill="black" stroke="black" points="1024.9,-7617.43 1030.69,-7608.56 1020.63,-7611.88 1024.9,-7617.43"/>
</g>
<!-- layer_11_expert_0_ffn1 -->
<g id="node479" class="node">
<title>layer_11_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-7470 677.57,-7470 677.57,-7417 883.57,-7417 883.57,-7470"/>
<text text-anchor="middle" x="780.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_0_ffn1 -->
<g id="edge691" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-7659.95C887.23,-7649.28 873.96,-7636.28 863.57,-7623 824.71,-7573.33 817.94,-7557.58 794.57,-7499 792.17,-7492.99 790.08,-7486.43 788.29,-7480.02"/>
<polygon fill="black" stroke="black" points="791.63,-7478.97 785.73,-7470.17 784.85,-7480.72 791.63,-7478.97"/>
</g>
<!-- layer_11_expert_1_ffn1 -->
<g id="node482" class="node">
<title>layer_11_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-7470 229.57,-7470 229.57,-7417 435.57,-7417 435.57,-7470"/>
<text text-anchor="middle" x="332.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_1_ffn1 -->
<g id="edge695" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-7673.27C767.36,-7663.96 691.02,-7648.31 626.57,-7623 529.83,-7585.01 428.72,-7516.16 373.91,-7475.98"/>
<polygon fill="black" stroke="black" points="375.97,-7473.14 365.84,-7470.02 371.81,-7478.78 375.97,-7473.14"/>
</g>
<!-- layer_11_expert_2_ffn1 -->
<g id="node485" class="node">
<title>layer_11_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-7470 1125.57,-7470 1125.57,-7417 1331.57,-7417 1331.57,-7470"/>
<text text-anchor="middle" x="1228.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_2_ffn1 -->
<g id="edge699" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-7680.17C1121.34,-7673.26 1237.52,-7657.69 1267.57,-7623 1306.88,-7577.62 1295.71,-7543.4 1272.57,-7488 1271.12,-7484.52 1269.24,-7481.18 1267.08,-7478.01"/>
<polygon fill="black" stroke="black" points="1269.72,-7475.71 1260.79,-7470.01 1264.22,-7480.03 1269.72,-7475.71"/>
</g>
<!-- layer_11_expert_3_ffn1 -->
<g id="node488" class="node">
<title>layer_11_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-7470 1573.57,-7470 1573.57,-7417 1779.57,-7417 1779.57,-7470"/>
<text text-anchor="middle" x="1676.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_3_ffn1 -->
<g id="edge703" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-7680.82C1122.76,-7674.39 1253.8,-7659.14 1362.57,-7623 1484.83,-7582.38 1520.13,-7574.42 1624.57,-7499 1633.08,-7492.86 1641.36,-7485.21 1648.73,-7477.6"/>
<polygon fill="black" stroke="black" points="1651.49,-7479.77 1655.76,-7470.07 1646.38,-7474.99 1651.49,-7479.77"/>
</g>
<!-- layer_11_expert_4_ffn1 -->
<g id="node491" class="node">
<title>layer_11_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-7470 453.57,-7470 453.57,-7417 659.57,-7417 659.57,-7470"/>
<text text-anchor="middle" x="556.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_4_ffn1 -->
<g id="edge707" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-7659.89C801.11,-7628.58 686.43,-7570.79 603.57,-7499 596.29,-7492.69 589.13,-7485.24 582.68,-7477.9"/>
<polygon fill="black" stroke="black" points="585.14,-7475.39 575.99,-7470.05 579.81,-7479.93 585.14,-7475.39"/>
</g>
<!-- layer_11_expert_5_ffn1 -->
<g id="node494" class="node">
<title>layer_11_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-7470 1349.57,-7470 1349.57,-7417 1555.57,-7417 1555.57,-7470"/>
<text text-anchor="middle" x="1452.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_5_ffn1 -->
<g id="edge711" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-7679.77C1098.02,-7674.2 1181.84,-7663.3 1253.57,-7642 1272.44,-7636.4 1277.44,-7634.28 1293.57,-7623 1357.95,-7577.96 1370.85,-7560.64 1419.57,-7499 1424.54,-7492.72 1429.34,-7485.63 1433.66,-7478.69"/>
<polygon fill="black" stroke="black" points="1436.7,-7480.43 1438.87,-7470.05 1430.71,-7476.81 1436.7,-7480.43"/>
</g>
<!-- layer_11_expert_6_ffn1 -->
<g id="node497" class="node">
<title>layer_11_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-7470 1797.57,-7470 1797.57,-7417 2003.57,-7417 2003.57,-7470"/>
<text text-anchor="middle" x="1900.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_6_ffn1 -->
<g id="edge715" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-7683.36C1147.98,-7678.86 1336.72,-7665.05 1493.57,-7623 1625.52,-7587.63 1769.63,-7515.8 1845.97,-7474.86"/>
<polygon fill="black" stroke="black" points="1847.8,-7477.86 1854.94,-7470.03 1844.47,-7471.69 1847.8,-7477.86"/>
</g>
<!-- layer_11_expert_7_ffn1 -->
<g id="node500" class="node">
<title>layer_11_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-7470 901.57,-7470 901.57,-7417 1107.57,-7417 1107.57,-7470"/>
<text text-anchor="middle" x="1004.57" y="-7454.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-7439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-7424.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_expert_7_ffn1 -->
<g id="edge719" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-7659.92C903.08,-7649.14 895.6,-7636.08 891.57,-7623 873.88,-7565.62 852.23,-7537.25 886.57,-7488 889.58,-7483.69 893.06,-7479.8 896.91,-7476.3"/>
<polygon fill="black" stroke="black" points="899.11,-7479.02 904.71,-7470.03 894.73,-7473.56 899.11,-7479.02"/>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_0_ffn1 -->
<g id="edge690" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-7538.54C959.2,-7518.88 898.07,-7493.43 851.32,-7473.96"/>
<polygon fill="black" stroke="black" points="852.45,-7470.64 841.87,-7470.03 849.76,-7477.1 852.45,-7470.64"/>
<text text-anchor="middle" x="924.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_1_ffn1 -->
<g id="edge694" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-7552.72C833.08,-7535.17 630.07,-7505.21 445.54,-7470.14"/>
<polygon fill="black" stroke="black" points="446.13,-7466.69 435.65,-7468.25 444.82,-7473.56 446.13,-7466.69"/>
<text text-anchor="middle" x="623.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_2_ffn1 -->
<g id="edge698" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-7527.47C1129.09,-7514.16 1143.87,-7499.81 1158.57,-7488 1163.82,-7483.78 1169.5,-7479.65 1175.28,-7475.71"/>
<polygon fill="black" stroke="black" points="1177.37,-7478.52 1183.77,-7470.09 1173.5,-7472.68 1177.37,-7478.52"/>
<text text-anchor="middle" x="1180.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_3_ffn1 -->
<g id="edge702" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-7547.7C1263.24,-7531.33 1376.38,-7508.18 1475.57,-7488 1512.26,-7480.54 1523.52,-7478.73 1563.55,-7470.2"/>
<polygon fill="black" stroke="black" points="1564.41,-7473.59 1573.46,-7468.08 1562.94,-7466.75 1564.41,-7473.59"/>
<text text-anchor="middle" x="1497.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_4_ffn1 -->
<g id="edge706" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-7545.8C893.49,-7524.7 762.7,-7493.57 669.53,-7471.39"/>
<polygon fill="black" stroke="black" points="670.33,-7467.98 659.79,-7469.07 668.7,-7474.79 670.33,-7467.98"/>
<text text-anchor="middle" x="792.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_5_ffn1 -->
<g id="edge710" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-7538.6C1193.35,-7522.52 1244.3,-7503.05 1290.57,-7488 1306.78,-7482.73 1324.04,-7477.6 1341.02,-7472.81"/>
<polygon fill="black" stroke="black" points="1342.29,-7476.09 1350.98,-7470.04 1340.41,-7469.35 1342.29,-7476.09"/>
<text text-anchor="middle" x="1312.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_6_ffn1 -->
<g id="edge714" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-7554.57C1346.62,-7537.91 1578.71,-7508.07 1787.57,-7470.13"/>
<polygon fill="black" stroke="black" points="1788.29,-7473.55 1797.5,-7468.31 1787.04,-7466.67 1788.29,-7473.55"/>
<text text-anchor="middle" x="1694.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_11_gate&#45;&gt;layer_11_expert_7_ffn1 -->
<g id="edge718" class="edge">
<title>layer_11_gate&#45;&gt;layer_11_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-7524.76C1043.87,-7509.73 1033.9,-7493.18 1025.37,-7479.03"/>
<polygon fill="black" stroke="black" points="1028.16,-7476.88 1020,-7470.12 1022.17,-7480.49 1028.16,-7476.88"/>
<text text-anchor="middle" x="1056.57" y="-7491" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_11_expert_0_gelu -->
<g id="node480" class="node">
<title>layer_11_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-7380 677.57,-7380 677.57,-7327 883.57,-7327 883.57,-7380"/>
<text text-anchor="middle" x="780.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_0_ffn1&#45;&gt;layer_11_expert_0_gelu -->
<g id="edge692" class="edge">
<title>layer_11_expert_0_ffn1&#45;&gt;layer_11_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-7416.57C780.57,-7408.34 780.57,-7399.08 780.57,-7390.28"/>
<polygon fill="black" stroke="black" points="784.07,-7390.24 780.57,-7380.24 777.07,-7390.24 784.07,-7390.24"/>
</g>
<!-- layer_11_expert_0_ffn2 -->
<g id="node481" class="node">
<title>layer_11_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-7290 677.57,-7290 677.57,-7237 883.57,-7237 883.57,-7290"/>
<text text-anchor="middle" x="780.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_0_gelu&#45;&gt;layer_11_expert_0_ffn2 -->
<g id="edge693" class="edge">
<title>layer_11_expert_0_gelu&#45;&gt;layer_11_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-7326.57C780.57,-7318.34 780.57,-7309.08 780.57,-7300.28"/>
<polygon fill="black" stroke="black" points="784.07,-7300.24 780.57,-7290.24 777.07,-7300.24 784.07,-7300.24"/>
</g>
<!-- layer_11_expert_agg -->
<g id="node503" class="node">
<title>layer_11_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-7200 878.36,-7200 790.93,-7094 1130.79,-7094 1218.21,-7200"/>
<text text-anchor="middle" x="1004.57" y="-7158.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-7143.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-7128.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_0_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge722" class="edge">
<title>layer_11_expert_0_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-7236.95C849.26,-7227.39 871.33,-7216.11 893.35,-7204.85"/>
<polygon fill="black" stroke="black" points="895.14,-7207.87 902.45,-7200.2 891.95,-7201.64 895.14,-7207.87"/>
</g>
<!-- layer_11_expert_1_gelu -->
<g id="node483" class="node">
<title>layer_11_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-7380 229.57,-7380 229.57,-7327 435.57,-7327 435.57,-7380"/>
<text text-anchor="middle" x="332.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_1_ffn1&#45;&gt;layer_11_expert_1_gelu -->
<g id="edge696" class="edge">
<title>layer_11_expert_1_ffn1&#45;&gt;layer_11_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-7416.57C332.57,-7408.34 332.57,-7399.08 332.57,-7390.28"/>
<polygon fill="black" stroke="black" points="336.07,-7390.24 332.57,-7380.24 329.07,-7390.24 336.07,-7390.24"/>
</g>
<!-- layer_11_expert_1_ffn2 -->
<g id="node484" class="node">
<title>layer_11_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-7290 229.57,-7290 229.57,-7237 435.57,-7237 435.57,-7290"/>
<text text-anchor="middle" x="332.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_1_gelu&#45;&gt;layer_11_expert_1_ffn2 -->
<g id="edge697" class="edge">
<title>layer_11_expert_1_gelu&#45;&gt;layer_11_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-7326.57C332.57,-7318.34 332.57,-7309.08 332.57,-7300.28"/>
<polygon fill="black" stroke="black" points="336.07,-7300.24 332.57,-7290.24 329.07,-7300.24 336.07,-7300.24"/>
</g>
<!-- layer_11_expert_1_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge723" class="edge">
<title>layer_11_expert_1_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-7238.76C438.66,-7238.16 441.63,-7237.57 444.57,-7237 578.16,-7211.21 730.72,-7187.32 842.83,-7170.81"/>
<polygon fill="black" stroke="black" points="843.49,-7174.25 852.87,-7169.33 842.47,-7167.32 843.49,-7174.25"/>
</g>
<!-- layer_11_expert_2_gelu -->
<g id="node486" class="node">
<title>layer_11_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-7380 1125.57,-7380 1125.57,-7327 1331.57,-7327 1331.57,-7380"/>
<text text-anchor="middle" x="1228.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_2_ffn1&#45;&gt;layer_11_expert_2_gelu -->
<g id="edge700" class="edge">
<title>layer_11_expert_2_ffn1&#45;&gt;layer_11_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-7416.57C1228.57,-7408.34 1228.57,-7399.08 1228.57,-7390.28"/>
<polygon fill="black" stroke="black" points="1232.07,-7390.24 1228.57,-7380.24 1225.07,-7390.24 1232.07,-7390.24"/>
</g>
<!-- layer_11_expert_2_ffn2 -->
<g id="node487" class="node">
<title>layer_11_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-7290 1125.57,-7290 1125.57,-7237 1331.57,-7237 1331.57,-7290"/>
<text text-anchor="middle" x="1228.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_2_gelu&#45;&gt;layer_11_expert_2_ffn2 -->
<g id="edge701" class="edge">
<title>layer_11_expert_2_gelu&#45;&gt;layer_11_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-7326.57C1228.57,-7318.34 1228.57,-7309.08 1228.57,-7300.28"/>
<polygon fill="black" stroke="black" points="1232.07,-7300.24 1228.57,-7290.24 1225.07,-7300.24 1232.07,-7300.24"/>
</g>
<!-- layer_11_expert_2_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge724" class="edge">
<title>layer_11_expert_2_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-7236.95C1159.88,-7227.39 1137.81,-7216.11 1115.79,-7204.85"/>
<polygon fill="black" stroke="black" points="1117.19,-7201.64 1106.7,-7200.2 1114.01,-7207.87 1117.19,-7201.64"/>
</g>
<!-- layer_11_expert_3_gelu -->
<g id="node489" class="node">
<title>layer_11_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-7380 1573.57,-7380 1573.57,-7327 1779.57,-7327 1779.57,-7380"/>
<text text-anchor="middle" x="1676.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_3_ffn1&#45;&gt;layer_11_expert_3_gelu -->
<g id="edge704" class="edge">
<title>layer_11_expert_3_ffn1&#45;&gt;layer_11_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-7416.57C1676.57,-7408.34 1676.57,-7399.08 1676.57,-7390.28"/>
<polygon fill="black" stroke="black" points="1680.07,-7390.24 1676.57,-7380.24 1673.07,-7390.24 1680.07,-7390.24"/>
</g>
<!-- layer_11_expert_3_ffn2 -->
<g id="node490" class="node">
<title>layer_11_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-7290 1573.57,-7290 1573.57,-7237 1779.57,-7237 1779.57,-7290"/>
<text text-anchor="middle" x="1676.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_3_gelu&#45;&gt;layer_11_expert_3_ffn2 -->
<g id="edge705" class="edge">
<title>layer_11_expert_3_gelu&#45;&gt;layer_11_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-7326.57C1676.57,-7318.34 1676.57,-7309.08 1676.57,-7300.28"/>
<polygon fill="black" stroke="black" points="1680.07,-7300.24 1676.57,-7290.24 1673.07,-7300.24 1680.07,-7300.24"/>
</g>
<!-- layer_11_expert_3_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge725" class="edge">
<title>layer_11_expert_3_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-7238.76C1570.49,-7238.16 1567.51,-7237.57 1564.57,-7237 1446.94,-7214.29 1314.59,-7193.06 1208.1,-7177.03"/>
<polygon fill="black" stroke="black" points="1208.61,-7173.57 1198.21,-7175.54 1207.58,-7180.49 1208.61,-7173.57"/>
</g>
<!-- layer_11_expert_4_gelu -->
<g id="node492" class="node">
<title>layer_11_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-7380 453.57,-7380 453.57,-7327 659.57,-7327 659.57,-7380"/>
<text text-anchor="middle" x="556.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_4_ffn1&#45;&gt;layer_11_expert_4_gelu -->
<g id="edge708" class="edge">
<title>layer_11_expert_4_ffn1&#45;&gt;layer_11_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-7416.57C556.57,-7408.34 556.57,-7399.08 556.57,-7390.28"/>
<polygon fill="black" stroke="black" points="560.07,-7390.24 556.57,-7380.24 553.07,-7390.24 560.07,-7390.24"/>
</g>
<!-- layer_11_expert_4_ffn2 -->
<g id="node493" class="node">
<title>layer_11_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-7290 453.57,-7290 453.57,-7237 659.57,-7237 659.57,-7290"/>
<text text-anchor="middle" x="556.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_4_gelu&#45;&gt;layer_11_expert_4_ffn2 -->
<g id="edge709" class="edge">
<title>layer_11_expert_4_gelu&#45;&gt;layer_11_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-7326.57C556.57,-7318.34 556.57,-7309.08 556.57,-7300.28"/>
<polygon fill="black" stroke="black" points="560.07,-7300.24 556.57,-7290.24 553.07,-7300.24 560.07,-7300.24"/>
</g>
<!-- layer_11_expert_4_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge726" class="edge">
<title>layer_11_expert_4_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-7236.95C714.81,-7222.06 789.41,-7202.99 854.59,-7186.33"/>
<polygon fill="black" stroke="black" points="855.73,-7189.65 864.55,-7183.79 853.99,-7182.87 855.73,-7189.65"/>
</g>
<!-- layer_11_expert_5_gelu -->
<g id="node495" class="node">
<title>layer_11_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-7380 1349.57,-7380 1349.57,-7327 1555.57,-7327 1555.57,-7380"/>
<text text-anchor="middle" x="1452.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_5_ffn1&#45;&gt;layer_11_expert_5_gelu -->
<g id="edge712" class="edge">
<title>layer_11_expert_5_ffn1&#45;&gt;layer_11_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-7416.57C1452.57,-7408.34 1452.57,-7399.08 1452.57,-7390.28"/>
<polygon fill="black" stroke="black" points="1456.07,-7390.24 1452.57,-7380.24 1449.07,-7390.24 1456.07,-7390.24"/>
</g>
<!-- layer_11_expert_5_ffn2 -->
<g id="node496" class="node">
<title>layer_11_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-7290 1349.57,-7290 1349.57,-7237 1555.57,-7237 1555.57,-7290"/>
<text text-anchor="middle" x="1452.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_5_gelu&#45;&gt;layer_11_expert_5_ffn2 -->
<g id="edge713" class="edge">
<title>layer_11_expert_5_gelu&#45;&gt;layer_11_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-7326.57C1452.57,-7318.34 1452.57,-7309.08 1452.57,-7300.28"/>
<polygon fill="black" stroke="black" points="1456.07,-7300.24 1452.57,-7290.24 1449.07,-7300.24 1456.07,-7300.24"/>
</g>
<!-- layer_11_expert_5_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge727" class="edge">
<title>layer_11_expert_5_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-7236.95C1312.66,-7226.74 1265.05,-7214.57 1218.07,-7202.57"/>
<polygon fill="black" stroke="black" points="1218.92,-7199.17 1208.37,-7200.09 1217.19,-7205.95 1218.92,-7199.17"/>
</g>
<!-- layer_11_expert_6_gelu -->
<g id="node498" class="node">
<title>layer_11_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-7380 1797.57,-7380 1797.57,-7327 2003.57,-7327 2003.57,-7380"/>
<text text-anchor="middle" x="1900.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_6_ffn1&#45;&gt;layer_11_expert_6_gelu -->
<g id="edge716" class="edge">
<title>layer_11_expert_6_ffn1&#45;&gt;layer_11_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-7416.57C1900.57,-7408.34 1900.57,-7399.08 1900.57,-7390.28"/>
<polygon fill="black" stroke="black" points="1904.07,-7390.24 1900.57,-7380.24 1897.07,-7390.24 1904.07,-7390.24"/>
</g>
<!-- layer_11_expert_6_ffn2 -->
<g id="node499" class="node">
<title>layer_11_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-7290 1797.57,-7290 1797.57,-7237 2003.57,-7237 2003.57,-7290"/>
<text text-anchor="middle" x="1900.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_6_gelu&#45;&gt;layer_11_expert_6_ffn2 -->
<g id="edge717" class="edge">
<title>layer_11_expert_6_gelu&#45;&gt;layer_11_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-7326.57C1900.57,-7318.34 1900.57,-7309.08 1900.57,-7300.28"/>
<polygon fill="black" stroke="black" points="1904.07,-7300.24 1900.57,-7290.24 1897.07,-7300.24 1904.07,-7300.24"/>
</g>
<!-- layer_11_expert_6_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge728" class="edge">
<title>layer_11_expert_6_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-7238.59C1794.51,-7238.03 1791.52,-7237.5 1788.57,-7237 1588.54,-7202.98 1357.51,-7178.53 1198.33,-7163.97"/>
<polygon fill="black" stroke="black" points="1198.23,-7160.45 1187.95,-7163.03 1197.59,-7167.42 1198.23,-7160.45"/>
</g>
<!-- layer_11_expert_7_gelu -->
<g id="node501" class="node">
<title>layer_11_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-7380 901.57,-7380 901.57,-7327 1107.57,-7327 1107.57,-7380"/>
<text text-anchor="middle" x="1004.57" y="-7364.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-7349.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-7334.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_7_ffn1&#45;&gt;layer_11_expert_7_gelu -->
<g id="edge720" class="edge">
<title>layer_11_expert_7_ffn1&#45;&gt;layer_11_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-7416.57C1004.57,-7408.34 1004.57,-7399.08 1004.57,-7390.28"/>
<polygon fill="black" stroke="black" points="1008.07,-7390.24 1004.57,-7380.24 1001.07,-7390.24 1008.07,-7390.24"/>
</g>
<!-- layer_11_expert_7_ffn2 -->
<g id="node502" class="node">
<title>layer_11_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-7290 901.57,-7290 901.57,-7237 1107.57,-7237 1107.57,-7290"/>
<text text-anchor="middle" x="1004.57" y="-7274.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-7259.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-7244.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_expert_7_gelu&#45;&gt;layer_11_expert_7_ffn2 -->
<g id="edge721" class="edge">
<title>layer_11_expert_7_gelu&#45;&gt;layer_11_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-7326.57C1004.57,-7318.34 1004.57,-7309.08 1004.57,-7300.28"/>
<polygon fill="black" stroke="black" points="1008.07,-7300.24 1004.57,-7290.24 1001.07,-7300.24 1008.07,-7300.24"/>
</g>
<!-- layer_11_expert_7_ffn2&#45;&gt;layer_11_expert_agg -->
<g id="edge729" class="edge">
<title>layer_11_expert_7_ffn2&#45;&gt;layer_11_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-7236.8C1004.57,-7228.86 1004.57,-7219.74 1004.57,-7210.44"/>
<polygon fill="black" stroke="black" points="1008.07,-7210.32 1004.57,-7200.32 1001.07,-7210.32 1008.07,-7210.32"/>
</g>
<!-- layer_11_expert_agg&#45;&gt;layer_11_add -->
<g id="edge731" class="edge">
<title>layer_11_expert_agg&#45;&gt;layer_11_add</title>
<path fill="none" stroke="black" d="M810.56,-7117.92C658.7,-7095.93 452.76,-7066.12 326.73,-7047.88"/>
<polygon fill="black" stroke="black" points="327.07,-7044.39 316.67,-7046.42 326.07,-7051.32 327.07,-7044.39"/>
</g>
<!-- comm_11_12 -->
<g id="node505" class="node">
<title>comm_11_12</title>
<polygon fill="yellow" stroke="black" points="427.21,-6967 87.36,-6967 -0.07,-6861 339.79,-6861 427.21,-6967"/>
<text text-anchor="middle" x="213.57" y="-6925.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-6910.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-6895.3" font-family="Times,serif" font-size="14.00">GPU 11  GPU 12</text>
</g>
<!-- layer_11_add&#45;&gt;comm_11_12 -->
<g id="edge732" class="edge">
<title>layer_11_add&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M213.57,-7003.8C213.57,-6995.86 213.57,-6986.74 213.57,-6977.44"/>
<polygon fill="black" stroke="black" points="217.07,-6977.32 213.57,-6967.32 210.07,-6977.32 217.07,-6977.32"/>
</g>
<!-- layer_12_ln1 -->
<g id="node506" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-6824 291.57,-6824 291.57,-6771 497.57,-6771 497.57,-6824"/>
<text text-anchor="middle" x="394.57" y="-6808.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-6793.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-6778.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- comm_11_12&#45;&gt;layer_12_ln1 -->
<g id="edge733" class="edge">
<title>comm_11_12&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M295.86,-6860.94C312.72,-6850.28 329.97,-6839.37 345.23,-6829.71"/>
<polygon fill="black" stroke="black" points="347.39,-6832.49 353.97,-6824.18 343.65,-6826.57 347.39,-6832.49"/>
</g>
<!-- layer_12_add1 -->
<g id="node518" class="node">
<title>layer_12_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-6052 110.57,-6052 110.57,-5999 316.57,-5999 316.57,-6052"/>
<text text-anchor="middle" x="213.57" y="-6036.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-6021.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-6006.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- comm_11_12&#45;&gt;layer_12_add1 -->
<g id="edge747" class="edge">
<title>comm_11_12&#45;&gt;layer_12_add1</title>
<path fill="none" stroke="black" d="M205.8,-6860.97C203.49,-6841.42 201.57,-6818.99 201.57,-6798.5 201.57,-6798.5 201.57,-6798.5 201.57,-6114.5 201.57,-6097.17 203.88,-6078.1 206.48,-6062.15"/>
<polygon fill="black" stroke="black" points="209.95,-6062.62 208.2,-6052.17 203.05,-6061.43 209.95,-6062.62"/>
</g>
<!-- layer_12_q_proj -->
<g id="node507" class="node">
<title>layer_12_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-6734 453.57,-6734 453.57,-6681 659.57,-6681 659.57,-6734"/>
<text text-anchor="middle" x="556.57" y="-6718.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-6703.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-6688.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_q_proj -->
<g id="edge734" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-6770.81C460.25,-6760.82 481.45,-6749.31 500.58,-6738.91"/>
<polygon fill="black" stroke="black" points="502.38,-6741.92 509.5,-6734.07 499.04,-6735.77 502.38,-6741.92"/>
</g>
<!-- layer_12_k_proj -->
<g id="node508" class="node">
<title>layer_12_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-6734 677.57,-6734 677.57,-6681 883.57,-6681 883.57,-6734"/>
<text text-anchor="middle" x="780.57" y="-6718.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-6703.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-6688.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_k_proj -->
<g id="edge735" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-6772.98C550.11,-6761.04 613.8,-6746.52 667.48,-6734.28"/>
<polygon fill="black" stroke="black" points="668.41,-6737.66 677.38,-6732.02 666.86,-6730.83 668.41,-6737.66"/>
</g>
<!-- layer_12_v_proj -->
<g id="node509" class="node">
<title>layer_12_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-6734 229.57,-6734 229.57,-6681 435.57,-6681 435.57,-6734"/>
<text text-anchor="middle" x="332.57" y="-6718.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-6703.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-6688.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_v_proj -->
<g id="edge736" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-6770.57C370.12,-6761.8 363.13,-6751.87 356.57,-6742.56"/>
<polygon fill="black" stroke="black" points="359.33,-6740.4 350.71,-6734.24 353.61,-6744.43 359.33,-6740.4"/>
</g>
<!-- layer_12_q_reshape -->
<g id="node510" class="node">
<title>layer_12_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-6644 426.57,-6644 426.57,-6591 650.57,-6591 650.57,-6644"/>
<text text-anchor="middle" x="538.57" y="-6628.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-6613.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-6598.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_q_proj&#45;&gt;layer_12_q_reshape -->
<g id="edge737" class="edge">
<title>layer_12_q_proj&#45;&gt;layer_12_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-6680.57C549.58,-6672.34 547.69,-6663.08 545.89,-6654.28"/>
<polygon fill="black" stroke="black" points="549.27,-6653.34 543.84,-6644.24 542.41,-6654.74 549.27,-6653.34"/>
</g>
<!-- layer_12_k_reshape -->
<g id="node511" class="node">
<title>layer_12_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-6644 668.57,-6644 668.57,-6591 892.57,-6591 892.57,-6644"/>
<text text-anchor="middle" x="780.57" y="-6628.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-6613.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-6598.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_k_proj&#45;&gt;layer_12_k_reshape -->
<g id="edge738" class="edge">
<title>layer_12_k_proj&#45;&gt;layer_12_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-6680.57C780.57,-6672.34 780.57,-6663.08 780.57,-6654.28"/>
<polygon fill="black" stroke="black" points="784.07,-6654.24 780.57,-6644.24 777.07,-6654.24 784.07,-6654.24"/>
</g>
<!-- layer_12_v_reshape -->
<g id="node512" class="node">
<title>layer_12_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-6573 226.57,-6573 226.57,-6520 450.57,-6520 450.57,-6573"/>
<text text-anchor="middle" x="338.57" y="-6557.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-6542.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-6527.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_v_proj&#45;&gt;layer_12_v_reshape -->
<g id="edge739" class="edge">
<title>layer_12_v_proj&#45;&gt;layer_12_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-6680.95C334.53,-6654.61 336.09,-6613.29 337.21,-6583.61"/>
<polygon fill="black" stroke="black" points="340.72,-6583.37 337.6,-6573.25 333.72,-6583.11 340.72,-6583.37"/>
</g>
<!-- layer_12_attn_scores -->
<g id="node513" class="node">
<title>layer_12_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-6502 422.07,-6502 422.07,-6449 655.07,-6449 655.07,-6502"/>
<text text-anchor="middle" x="538.57" y="-6486.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-6471.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-6456.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_q_reshape&#45;&gt;layer_12_attn_scores -->
<g id="edge740" class="edge">
<title>layer_12_q_reshape&#45;&gt;layer_12_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-6590.82C538.57,-6568.72 538.57,-6536.6 538.57,-6512.03"/>
<polygon fill="black" stroke="black" points="542.07,-6512.02 538.57,-6502.02 535.07,-6512.02 542.07,-6512.02"/>
</g>
<!-- layer_12_k_reshape&#45;&gt;layer_12_attn_scores -->
<g id="edge741" class="edge">
<title>layer_12_k_reshape&#45;&gt;layer_12_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-6590.98C695.65,-6567.37 634.91,-6532.23 591.5,-6507.12"/>
<polygon fill="black" stroke="black" points="593.19,-6504.05 582.78,-6502.08 589.68,-6510.11 593.19,-6504.05"/>
</g>
<!-- layer_12_attn_output -->
<g id="node515" class="node">
<title>layer_12_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-6322 229.57,-6322 229.57,-6269 453.57,-6269 453.57,-6322"/>
<text text-anchor="middle" x="341.57" y="-6306.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-6291.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-6276.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_v_reshape&#45;&gt;layer_12_attn_output -->
<g id="edge744" class="edge">
<title>layer_12_v_reshape&#45;&gt;layer_12_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-6519.79C339.42,-6475.13 340.53,-6383.13 341.14,-6332.27"/>
<polygon fill="black" stroke="black" points="344.64,-6332.11 341.26,-6322.07 337.64,-6332.03 344.64,-6332.11"/>
</g>
<!-- layer_12_attn_weights -->
<g id="node514" class="node">
<title>layer_12_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="616.07,-6412 383.07,-6412 383.07,-6359 616.07,-6359 616.07,-6412"/>
<text text-anchor="middle" x="499.57" y="-6396.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="499.57" y="-6381.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="499.57" y="-6366.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_scores&#45;&gt;layer_12_attn_weights -->
<g id="edge742" class="edge">
<title>layer_12_attn_scores&#45;&gt;layer_12_attn_weights</title>
<path fill="none" stroke="black" d="M527.08,-6448.57C523.31,-6440.07 519.06,-6430.48 515.05,-6421.42"/>
<polygon fill="black" stroke="black" points="518.23,-6419.97 510.98,-6412.24 511.83,-6422.8 518.23,-6419.97"/>
</g>
<!-- layer_12_attn_weights&#45;&gt;layer_12_attn_output -->
<g id="edge743" class="edge">
<title>layer_12_attn_weights&#45;&gt;layer_12_attn_output</title>
<path fill="none" stroke="black" d="M453.45,-6358.81C435.6,-6348.87 415.03,-6337.41 396.43,-6327.05"/>
<polygon fill="black" stroke="black" points="397.92,-6323.88 387.48,-6322.07 394.51,-6329.99 397.92,-6323.88"/>
</g>
<!-- layer_12_attn_reshape -->
<g id="node516" class="node">
<title>layer_12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-6232 236.57,-6232 236.57,-6179 442.57,-6179 442.57,-6232"/>
<text text-anchor="middle" x="339.57" y="-6216.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-6201.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-6186.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_output&#45;&gt;layer_12_attn_reshape -->
<g id="edge745" class="edge">
<title>layer_12_attn_output&#45;&gt;layer_12_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-6268.57C340.79,-6260.34 340.58,-6251.08 340.38,-6242.28"/>
<polygon fill="black" stroke="black" points="343.88,-6242.16 340.16,-6232.24 336.88,-6242.32 343.88,-6242.16"/>
</g>
<!-- layer_12_attn_proj -->
<g id="node517" class="node">
<title>layer_12_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-6142 233.57,-6142 233.57,-6089 439.57,-6089 439.57,-6142"/>
<text text-anchor="middle" x="336.57" y="-6126.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-6111.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-6096.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_reshape&#45;&gt;layer_12_attn_proj -->
<g id="edge746" class="edge">
<title>layer_12_attn_reshape&#45;&gt;layer_12_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-6178.57C338.41,-6170.34 338.09,-6161.08 337.79,-6152.28"/>
<polygon fill="black" stroke="black" points="341.29,-6152.12 337.45,-6142.24 334.29,-6152.36 341.29,-6152.12"/>
</g>
<!-- layer_12_attn_proj&#45;&gt;layer_12_add1 -->
<g id="edge748" class="edge">
<title>layer_12_attn_proj&#45;&gt;layer_12_add1</title>
<path fill="none" stroke="black" d="M300.66,-6088.81C287.15,-6079.14 271.63,-6068.04 257.47,-6057.9"/>
<polygon fill="black" stroke="black" points="259.48,-6055.04 249.31,-6052.07 255.41,-6060.73 259.48,-6055.04"/>
</g>
<!-- layer_12_ln2 -->
<g id="node519" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-5962 827.57,-5962 827.57,-5909 1033.57,-5909 1033.57,-5962"/>
<text text-anchor="middle" x="930.57" y="-5946.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-5931.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-5916.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_add1&#45;&gt;layer_12_ln2 -->
<g id="edge749" class="edge">
<title>layer_12_add1&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M316.68,-6011.84C449.47,-5995.55 679.5,-5967.31 817.13,-5950.42"/>
<polygon fill="black" stroke="black" points="817.78,-5953.87 827.28,-5949.18 816.93,-5946.92 817.78,-5953.87"/>
</g>
<!-- layer_12_add -->
<g id="node546" class="node">
<title>layer_12_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-5306 110.57,-5306 110.57,-5253 316.57,-5253 316.57,-5306"/>
<text text-anchor="middle" x="213.57" y="-5290.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-5275.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-5260.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_add1&#45;&gt;layer_12_add -->
<g id="edge791" class="edge">
<title>layer_12_add1&#45;&gt;layer_12_add</title>
<path fill="none" stroke="black" d="M208.2,-5998.83C205.01,-5981.34 201.57,-5957.62 201.57,-5936.5 201.57,-5936.5 201.57,-5936.5 201.57,-5395 201.57,-5368.6 204.77,-5338.96 207.86,-5316.46"/>
<polygon fill="black" stroke="black" points="211.35,-5316.73 209.31,-5306.34 204.42,-5315.74 211.35,-5316.73"/>
</g>
<!-- layer_12_gate -->
<g id="node520" class="node">
<title>layer_12_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-5872 900.57,-5819 1079.57,-5766 1258.57,-5819 1079.57,-5872"/>
<text text-anchor="middle" x="1079.57" y="-5830.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-5815.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-5800.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_gate -->
<g id="edge750" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_gate</title>
<path fill="none" stroke="black" d="M964.01,-5908.8C981.28,-5895.53 1002.83,-5878.97 1022.63,-5863.76"/>
<polygon fill="black" stroke="black" points="1024.9,-5866.43 1030.69,-5857.56 1020.63,-5860.88 1024.9,-5866.43"/>
</g>
<!-- layer_12_expert_0_ffn1 -->
<g id="node521" class="node">
<title>layer_12_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-5719 677.57,-5719 677.57,-5666 883.57,-5666 883.57,-5719"/>
<text text-anchor="middle" x="780.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_0_ffn1 -->
<g id="edge752" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-5908.95C887.23,-5898.28 873.96,-5885.28 863.57,-5872 824.71,-5822.33 817.94,-5806.58 794.57,-5748 792.17,-5741.99 790.08,-5735.43 788.29,-5729.02"/>
<polygon fill="black" stroke="black" points="791.63,-5727.97 785.73,-5719.17 784.85,-5729.72 791.63,-5727.97"/>
</g>
<!-- layer_12_expert_1_ffn1 -->
<g id="node524" class="node">
<title>layer_12_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-5719 229.57,-5719 229.57,-5666 435.57,-5666 435.57,-5719"/>
<text text-anchor="middle" x="332.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_1_ffn1 -->
<g id="edge756" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-5922.27C767.36,-5912.96 691.02,-5897.31 626.57,-5872 529.83,-5834.01 428.72,-5765.16 373.91,-5724.98"/>
<polygon fill="black" stroke="black" points="375.97,-5722.14 365.84,-5719.02 371.81,-5727.78 375.97,-5722.14"/>
</g>
<!-- layer_12_expert_2_ffn1 -->
<g id="node527" class="node">
<title>layer_12_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-5719 1125.57,-5719 1125.57,-5666 1331.57,-5666 1331.57,-5719"/>
<text text-anchor="middle" x="1228.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_2_ffn1 -->
<g id="edge760" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-5929.17C1121.34,-5922.26 1237.52,-5906.69 1267.57,-5872 1306.88,-5826.62 1295.71,-5792.4 1272.57,-5737 1271.12,-5733.52 1269.24,-5730.18 1267.08,-5727.01"/>
<polygon fill="black" stroke="black" points="1269.72,-5724.71 1260.79,-5719.01 1264.22,-5729.03 1269.72,-5724.71"/>
</g>
<!-- layer_12_expert_3_ffn1 -->
<g id="node530" class="node">
<title>layer_12_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-5719 1573.57,-5719 1573.57,-5666 1779.57,-5666 1779.57,-5719"/>
<text text-anchor="middle" x="1676.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_3_ffn1 -->
<g id="edge764" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-5929.82C1122.76,-5923.39 1253.8,-5908.14 1362.57,-5872 1484.83,-5831.38 1520.13,-5823.42 1624.57,-5748 1633.08,-5741.86 1641.36,-5734.21 1648.73,-5726.6"/>
<polygon fill="black" stroke="black" points="1651.49,-5728.77 1655.76,-5719.07 1646.38,-5723.99 1651.49,-5728.77"/>
</g>
<!-- layer_12_expert_4_ffn1 -->
<g id="node533" class="node">
<title>layer_12_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-5719 453.57,-5719 453.57,-5666 659.57,-5666 659.57,-5719"/>
<text text-anchor="middle" x="556.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_4_ffn1 -->
<g id="edge768" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-5908.89C801.11,-5877.58 686.43,-5819.79 603.57,-5748 596.29,-5741.69 589.13,-5734.24 582.68,-5726.9"/>
<polygon fill="black" stroke="black" points="585.14,-5724.39 575.99,-5719.05 579.81,-5728.93 585.14,-5724.39"/>
</g>
<!-- layer_12_expert_5_ffn1 -->
<g id="node536" class="node">
<title>layer_12_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-5719 1349.57,-5719 1349.57,-5666 1555.57,-5666 1555.57,-5719"/>
<text text-anchor="middle" x="1452.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_5_ffn1 -->
<g id="edge772" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-5928.77C1098.02,-5923.2 1181.84,-5912.3 1253.57,-5891 1272.44,-5885.4 1277.44,-5883.28 1293.57,-5872 1357.95,-5826.96 1370.85,-5809.64 1419.57,-5748 1424.54,-5741.72 1429.34,-5734.63 1433.66,-5727.69"/>
<polygon fill="black" stroke="black" points="1436.7,-5729.43 1438.87,-5719.05 1430.71,-5725.81 1436.7,-5729.43"/>
</g>
<!-- layer_12_expert_6_ffn1 -->
<g id="node539" class="node">
<title>layer_12_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-5719 1797.57,-5719 1797.57,-5666 2003.57,-5666 2003.57,-5719"/>
<text text-anchor="middle" x="1900.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_6_ffn1 -->
<g id="edge776" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-5932.36C1147.98,-5927.86 1336.72,-5914.05 1493.57,-5872 1625.52,-5836.63 1769.63,-5764.8 1845.97,-5723.86"/>
<polygon fill="black" stroke="black" points="1847.8,-5726.86 1854.94,-5719.03 1844.47,-5720.69 1847.8,-5726.86"/>
</g>
<!-- layer_12_expert_7_ffn1 -->
<g id="node542" class="node">
<title>layer_12_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-5719 901.57,-5719 901.57,-5666 1107.57,-5666 1107.57,-5719"/>
<text text-anchor="middle" x="1004.57" y="-5703.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-5688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-5673.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_expert_7_ffn1 -->
<g id="edge780" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-5908.92C903.08,-5898.14 895.6,-5885.08 891.57,-5872 873.88,-5814.62 852.23,-5786.25 886.57,-5737 889.58,-5732.69 893.06,-5728.8 896.91,-5725.3"/>
<polygon fill="black" stroke="black" points="899.11,-5728.02 904.71,-5719.03 894.73,-5722.56 899.11,-5728.02"/>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_0_ffn1 -->
<g id="edge751" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-5787.54C959.2,-5767.88 898.07,-5742.43 851.32,-5722.96"/>
<polygon fill="black" stroke="black" points="852.45,-5719.64 841.87,-5719.03 849.76,-5726.1 852.45,-5719.64"/>
<text text-anchor="middle" x="924.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_1_ffn1 -->
<g id="edge755" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-5801.72C833.08,-5784.17 630.07,-5754.21 445.54,-5719.14"/>
<polygon fill="black" stroke="black" points="446.13,-5715.69 435.65,-5717.25 444.82,-5722.56 446.13,-5715.69"/>
<text text-anchor="middle" x="623.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_2_ffn1 -->
<g id="edge759" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-5776.47C1129.09,-5763.16 1143.87,-5748.81 1158.57,-5737 1163.82,-5732.78 1169.5,-5728.65 1175.28,-5724.71"/>
<polygon fill="black" stroke="black" points="1177.37,-5727.52 1183.77,-5719.09 1173.5,-5721.68 1177.37,-5727.52"/>
<text text-anchor="middle" x="1180.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_3_ffn1 -->
<g id="edge763" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-5796.7C1263.24,-5780.33 1376.38,-5757.18 1475.57,-5737 1512.26,-5729.54 1523.52,-5727.73 1563.55,-5719.2"/>
<polygon fill="black" stroke="black" points="1564.41,-5722.59 1573.46,-5717.08 1562.94,-5715.75 1564.41,-5722.59"/>
<text text-anchor="middle" x="1497.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_4_ffn1 -->
<g id="edge767" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-5794.8C893.49,-5773.7 762.7,-5742.57 669.53,-5720.39"/>
<polygon fill="black" stroke="black" points="670.33,-5716.98 659.79,-5718.07 668.7,-5723.79 670.33,-5716.98"/>
<text text-anchor="middle" x="792.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_5_ffn1 -->
<g id="edge771" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-5787.6C1193.35,-5771.52 1244.3,-5752.05 1290.57,-5737 1306.78,-5731.73 1324.04,-5726.6 1341.02,-5721.81"/>
<polygon fill="black" stroke="black" points="1342.29,-5725.09 1350.98,-5719.04 1340.41,-5718.35 1342.29,-5725.09"/>
<text text-anchor="middle" x="1312.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_6_ffn1 -->
<g id="edge775" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-5803.57C1346.62,-5786.91 1578.71,-5757.07 1787.57,-5719.13"/>
<polygon fill="black" stroke="black" points="1788.29,-5722.55 1797.5,-5717.31 1787.04,-5715.67 1788.29,-5722.55"/>
<text text-anchor="middle" x="1694.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_12_gate&#45;&gt;layer_12_expert_7_ffn1 -->
<g id="edge779" class="edge">
<title>layer_12_gate&#45;&gt;layer_12_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-5773.76C1043.87,-5758.73 1033.9,-5742.18 1025.37,-5728.03"/>
<polygon fill="black" stroke="black" points="1028.16,-5725.88 1020,-5719.12 1022.17,-5729.49 1028.16,-5725.88"/>
<text text-anchor="middle" x="1056.57" y="-5740" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_12_expert_0_gelu -->
<g id="node522" class="node">
<title>layer_12_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-5629 677.57,-5629 677.57,-5576 883.57,-5576 883.57,-5629"/>
<text text-anchor="middle" x="780.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_0_ffn1&#45;&gt;layer_12_expert_0_gelu -->
<g id="edge753" class="edge">
<title>layer_12_expert_0_ffn1&#45;&gt;layer_12_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-5665.57C780.57,-5657.34 780.57,-5648.08 780.57,-5639.28"/>
<polygon fill="black" stroke="black" points="784.07,-5639.24 780.57,-5629.24 777.07,-5639.24 784.07,-5639.24"/>
</g>
<!-- layer_12_expert_0_ffn2 -->
<g id="node523" class="node">
<title>layer_12_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-5539 677.57,-5539 677.57,-5486 883.57,-5486 883.57,-5539"/>
<text text-anchor="middle" x="780.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_0_gelu&#45;&gt;layer_12_expert_0_ffn2 -->
<g id="edge754" class="edge">
<title>layer_12_expert_0_gelu&#45;&gt;layer_12_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-5575.57C780.57,-5567.34 780.57,-5558.08 780.57,-5549.28"/>
<polygon fill="black" stroke="black" points="784.07,-5549.24 780.57,-5539.24 777.07,-5549.24 784.07,-5549.24"/>
</g>
<!-- layer_12_expert_agg -->
<g id="node545" class="node">
<title>layer_12_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-5449 878.36,-5449 790.93,-5343 1130.79,-5343 1218.21,-5449"/>
<text text-anchor="middle" x="1004.57" y="-5407.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-5392.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-5377.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_0_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge783" class="edge">
<title>layer_12_expert_0_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-5485.95C849.26,-5476.39 871.33,-5465.11 893.35,-5453.85"/>
<polygon fill="black" stroke="black" points="895.14,-5456.87 902.45,-5449.2 891.95,-5450.64 895.14,-5456.87"/>
</g>
<!-- layer_12_expert_1_gelu -->
<g id="node525" class="node">
<title>layer_12_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-5629 229.57,-5629 229.57,-5576 435.57,-5576 435.57,-5629"/>
<text text-anchor="middle" x="332.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_1_ffn1&#45;&gt;layer_12_expert_1_gelu -->
<g id="edge757" class="edge">
<title>layer_12_expert_1_ffn1&#45;&gt;layer_12_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-5665.57C332.57,-5657.34 332.57,-5648.08 332.57,-5639.28"/>
<polygon fill="black" stroke="black" points="336.07,-5639.24 332.57,-5629.24 329.07,-5639.24 336.07,-5639.24"/>
</g>
<!-- layer_12_expert_1_ffn2 -->
<g id="node526" class="node">
<title>layer_12_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-5539 229.57,-5539 229.57,-5486 435.57,-5486 435.57,-5539"/>
<text text-anchor="middle" x="332.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_1_gelu&#45;&gt;layer_12_expert_1_ffn2 -->
<g id="edge758" class="edge">
<title>layer_12_expert_1_gelu&#45;&gt;layer_12_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-5575.57C332.57,-5567.34 332.57,-5558.08 332.57,-5549.28"/>
<polygon fill="black" stroke="black" points="336.07,-5549.24 332.57,-5539.24 329.07,-5549.24 336.07,-5549.24"/>
</g>
<!-- layer_12_expert_1_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge784" class="edge">
<title>layer_12_expert_1_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-5487.76C438.66,-5487.16 441.63,-5486.57 444.57,-5486 578.16,-5460.21 730.72,-5436.32 842.83,-5419.81"/>
<polygon fill="black" stroke="black" points="843.49,-5423.25 852.87,-5418.33 842.47,-5416.32 843.49,-5423.25"/>
</g>
<!-- layer_12_expert_2_gelu -->
<g id="node528" class="node">
<title>layer_12_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-5629 1125.57,-5629 1125.57,-5576 1331.57,-5576 1331.57,-5629"/>
<text text-anchor="middle" x="1228.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_2_ffn1&#45;&gt;layer_12_expert_2_gelu -->
<g id="edge761" class="edge">
<title>layer_12_expert_2_ffn1&#45;&gt;layer_12_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-5665.57C1228.57,-5657.34 1228.57,-5648.08 1228.57,-5639.28"/>
<polygon fill="black" stroke="black" points="1232.07,-5639.24 1228.57,-5629.24 1225.07,-5639.24 1232.07,-5639.24"/>
</g>
<!-- layer_12_expert_2_ffn2 -->
<g id="node529" class="node">
<title>layer_12_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-5539 1125.57,-5539 1125.57,-5486 1331.57,-5486 1331.57,-5539"/>
<text text-anchor="middle" x="1228.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_2_gelu&#45;&gt;layer_12_expert_2_ffn2 -->
<g id="edge762" class="edge">
<title>layer_12_expert_2_gelu&#45;&gt;layer_12_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-5575.57C1228.57,-5567.34 1228.57,-5558.08 1228.57,-5549.28"/>
<polygon fill="black" stroke="black" points="1232.07,-5549.24 1228.57,-5539.24 1225.07,-5549.24 1232.07,-5549.24"/>
</g>
<!-- layer_12_expert_2_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge785" class="edge">
<title>layer_12_expert_2_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-5485.95C1159.88,-5476.39 1137.81,-5465.11 1115.79,-5453.85"/>
<polygon fill="black" stroke="black" points="1117.19,-5450.64 1106.7,-5449.2 1114.01,-5456.87 1117.19,-5450.64"/>
</g>
<!-- layer_12_expert_3_gelu -->
<g id="node531" class="node">
<title>layer_12_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-5629 1573.57,-5629 1573.57,-5576 1779.57,-5576 1779.57,-5629"/>
<text text-anchor="middle" x="1676.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_3_ffn1&#45;&gt;layer_12_expert_3_gelu -->
<g id="edge765" class="edge">
<title>layer_12_expert_3_ffn1&#45;&gt;layer_12_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-5665.57C1676.57,-5657.34 1676.57,-5648.08 1676.57,-5639.28"/>
<polygon fill="black" stroke="black" points="1680.07,-5639.24 1676.57,-5629.24 1673.07,-5639.24 1680.07,-5639.24"/>
</g>
<!-- layer_12_expert_3_ffn2 -->
<g id="node532" class="node">
<title>layer_12_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-5539 1573.57,-5539 1573.57,-5486 1779.57,-5486 1779.57,-5539"/>
<text text-anchor="middle" x="1676.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_3_gelu&#45;&gt;layer_12_expert_3_ffn2 -->
<g id="edge766" class="edge">
<title>layer_12_expert_3_gelu&#45;&gt;layer_12_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-5575.57C1676.57,-5567.34 1676.57,-5558.08 1676.57,-5549.28"/>
<polygon fill="black" stroke="black" points="1680.07,-5549.24 1676.57,-5539.24 1673.07,-5549.24 1680.07,-5549.24"/>
</g>
<!-- layer_12_expert_3_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge786" class="edge">
<title>layer_12_expert_3_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-5487.76C1570.49,-5487.16 1567.51,-5486.57 1564.57,-5486 1446.94,-5463.29 1314.59,-5442.06 1208.1,-5426.03"/>
<polygon fill="black" stroke="black" points="1208.61,-5422.57 1198.21,-5424.54 1207.58,-5429.49 1208.61,-5422.57"/>
</g>
<!-- layer_12_expert_4_gelu -->
<g id="node534" class="node">
<title>layer_12_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-5629 453.57,-5629 453.57,-5576 659.57,-5576 659.57,-5629"/>
<text text-anchor="middle" x="556.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_4_ffn1&#45;&gt;layer_12_expert_4_gelu -->
<g id="edge769" class="edge">
<title>layer_12_expert_4_ffn1&#45;&gt;layer_12_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-5665.57C556.57,-5657.34 556.57,-5648.08 556.57,-5639.28"/>
<polygon fill="black" stroke="black" points="560.07,-5639.24 556.57,-5629.24 553.07,-5639.24 560.07,-5639.24"/>
</g>
<!-- layer_12_expert_4_ffn2 -->
<g id="node535" class="node">
<title>layer_12_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-5539 453.57,-5539 453.57,-5486 659.57,-5486 659.57,-5539"/>
<text text-anchor="middle" x="556.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_4_gelu&#45;&gt;layer_12_expert_4_ffn2 -->
<g id="edge770" class="edge">
<title>layer_12_expert_4_gelu&#45;&gt;layer_12_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-5575.57C556.57,-5567.34 556.57,-5558.08 556.57,-5549.28"/>
<polygon fill="black" stroke="black" points="560.07,-5549.24 556.57,-5539.24 553.07,-5549.24 560.07,-5549.24"/>
</g>
<!-- layer_12_expert_4_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge787" class="edge">
<title>layer_12_expert_4_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-5485.95C714.81,-5471.06 789.41,-5451.99 854.59,-5435.33"/>
<polygon fill="black" stroke="black" points="855.73,-5438.65 864.55,-5432.79 853.99,-5431.87 855.73,-5438.65"/>
</g>
<!-- layer_12_expert_5_gelu -->
<g id="node537" class="node">
<title>layer_12_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-5629 1349.57,-5629 1349.57,-5576 1555.57,-5576 1555.57,-5629"/>
<text text-anchor="middle" x="1452.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_5_ffn1&#45;&gt;layer_12_expert_5_gelu -->
<g id="edge773" class="edge">
<title>layer_12_expert_5_ffn1&#45;&gt;layer_12_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-5665.57C1452.57,-5657.34 1452.57,-5648.08 1452.57,-5639.28"/>
<polygon fill="black" stroke="black" points="1456.07,-5639.24 1452.57,-5629.24 1449.07,-5639.24 1456.07,-5639.24"/>
</g>
<!-- layer_12_expert_5_ffn2 -->
<g id="node538" class="node">
<title>layer_12_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-5539 1349.57,-5539 1349.57,-5486 1555.57,-5486 1555.57,-5539"/>
<text text-anchor="middle" x="1452.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_5_gelu&#45;&gt;layer_12_expert_5_ffn2 -->
<g id="edge774" class="edge">
<title>layer_12_expert_5_gelu&#45;&gt;layer_12_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-5575.57C1452.57,-5567.34 1452.57,-5558.08 1452.57,-5549.28"/>
<polygon fill="black" stroke="black" points="1456.07,-5549.24 1452.57,-5539.24 1449.07,-5549.24 1456.07,-5549.24"/>
</g>
<!-- layer_12_expert_5_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge788" class="edge">
<title>layer_12_expert_5_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-5485.95C1312.66,-5475.74 1265.05,-5463.57 1218.07,-5451.57"/>
<polygon fill="black" stroke="black" points="1218.92,-5448.17 1208.37,-5449.09 1217.19,-5454.95 1218.92,-5448.17"/>
</g>
<!-- layer_12_expert_6_gelu -->
<g id="node540" class="node">
<title>layer_12_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-5629 1797.57,-5629 1797.57,-5576 2003.57,-5576 2003.57,-5629"/>
<text text-anchor="middle" x="1900.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_6_ffn1&#45;&gt;layer_12_expert_6_gelu -->
<g id="edge777" class="edge">
<title>layer_12_expert_6_ffn1&#45;&gt;layer_12_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-5665.57C1900.57,-5657.34 1900.57,-5648.08 1900.57,-5639.28"/>
<polygon fill="black" stroke="black" points="1904.07,-5639.24 1900.57,-5629.24 1897.07,-5639.24 1904.07,-5639.24"/>
</g>
<!-- layer_12_expert_6_ffn2 -->
<g id="node541" class="node">
<title>layer_12_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-5539 1797.57,-5539 1797.57,-5486 2003.57,-5486 2003.57,-5539"/>
<text text-anchor="middle" x="1900.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_6_gelu&#45;&gt;layer_12_expert_6_ffn2 -->
<g id="edge778" class="edge">
<title>layer_12_expert_6_gelu&#45;&gt;layer_12_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-5575.57C1900.57,-5567.34 1900.57,-5558.08 1900.57,-5549.28"/>
<polygon fill="black" stroke="black" points="1904.07,-5549.24 1900.57,-5539.24 1897.07,-5549.24 1904.07,-5549.24"/>
</g>
<!-- layer_12_expert_6_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge789" class="edge">
<title>layer_12_expert_6_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-5487.59C1794.51,-5487.03 1791.52,-5486.5 1788.57,-5486 1588.54,-5451.98 1357.51,-5427.53 1198.33,-5412.97"/>
<polygon fill="black" stroke="black" points="1198.23,-5409.45 1187.95,-5412.03 1197.59,-5416.42 1198.23,-5409.45"/>
</g>
<!-- layer_12_expert_7_gelu -->
<g id="node543" class="node">
<title>layer_12_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-5629 901.57,-5629 901.57,-5576 1107.57,-5576 1107.57,-5629"/>
<text text-anchor="middle" x="1004.57" y="-5613.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-5598.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-5583.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_7_ffn1&#45;&gt;layer_12_expert_7_gelu -->
<g id="edge781" class="edge">
<title>layer_12_expert_7_ffn1&#45;&gt;layer_12_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-5665.57C1004.57,-5657.34 1004.57,-5648.08 1004.57,-5639.28"/>
<polygon fill="black" stroke="black" points="1008.07,-5639.24 1004.57,-5629.24 1001.07,-5639.24 1008.07,-5639.24"/>
</g>
<!-- layer_12_expert_7_ffn2 -->
<g id="node544" class="node">
<title>layer_12_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-5539 901.57,-5539 901.57,-5486 1107.57,-5486 1107.57,-5539"/>
<text text-anchor="middle" x="1004.57" y="-5523.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-5508.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-5493.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_expert_7_gelu&#45;&gt;layer_12_expert_7_ffn2 -->
<g id="edge782" class="edge">
<title>layer_12_expert_7_gelu&#45;&gt;layer_12_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-5575.57C1004.57,-5567.34 1004.57,-5558.08 1004.57,-5549.28"/>
<polygon fill="black" stroke="black" points="1008.07,-5549.24 1004.57,-5539.24 1001.07,-5549.24 1008.07,-5549.24"/>
</g>
<!-- layer_12_expert_7_ffn2&#45;&gt;layer_12_expert_agg -->
<g id="edge790" class="edge">
<title>layer_12_expert_7_ffn2&#45;&gt;layer_12_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-5485.8C1004.57,-5477.86 1004.57,-5468.74 1004.57,-5459.44"/>
<polygon fill="black" stroke="black" points="1008.07,-5459.32 1004.57,-5449.32 1001.07,-5459.32 1008.07,-5459.32"/>
</g>
<!-- layer_12_expert_agg&#45;&gt;layer_12_add -->
<g id="edge792" class="edge">
<title>layer_12_expert_agg&#45;&gt;layer_12_add</title>
<path fill="none" stroke="black" d="M810.56,-5366.92C658.7,-5344.93 452.76,-5315.12 326.73,-5296.88"/>
<polygon fill="black" stroke="black" points="327.07,-5293.39 316.67,-5295.42 326.07,-5300.32 327.07,-5293.39"/>
</g>
<!-- comm_12_13 -->
<g id="node547" class="node">
<title>comm_12_13</title>
<polygon fill="yellow" stroke="black" points="427.21,-5216 87.36,-5216 -0.07,-5110 339.79,-5110 427.21,-5216"/>
<text text-anchor="middle" x="213.57" y="-5174.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-5159.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-5144.3" font-family="Times,serif" font-size="14.00">GPU 12  GPU 13</text>
</g>
<!-- layer_12_add&#45;&gt;comm_12_13 -->
<g id="edge793" class="edge">
<title>layer_12_add&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M213.57,-5252.8C213.57,-5244.86 213.57,-5235.74 213.57,-5226.44"/>
<polygon fill="black" stroke="black" points="217.07,-5226.32 213.57,-5216.32 210.07,-5226.32 217.07,-5226.32"/>
</g>
<!-- layer_13_ln1 -->
<g id="node548" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightcoral" stroke="black" points="552.57,-5073 346.57,-5073 346.57,-5020 552.57,-5020 552.57,-5073"/>
<text text-anchor="middle" x="449.57" y="-5057.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="449.57" y="-5042.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="449.57" y="-5027.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- comm_12_13&#45;&gt;layer_13_ln1 -->
<g id="edge794" class="edge">
<title>comm_12_13&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M320.87,-5109.94C343.78,-5098.83 367.24,-5087.45 387.74,-5077.5"/>
<polygon fill="black" stroke="black" points="389.47,-5080.55 396.94,-5073.03 386.42,-5074.25 389.47,-5080.55"/>
</g>
<!-- layer_13_add1 -->
<g id="node560" class="node">
<title>layer_13_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-4301 110.57,-4301 110.57,-4248 316.57,-4248 316.57,-4301"/>
<text text-anchor="middle" x="213.57" y="-4285.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-4270.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-4255.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- comm_12_13&#45;&gt;layer_13_add1 -->
<g id="edge808" class="edge">
<title>comm_12_13&#45;&gt;layer_13_add1</title>
<path fill="none" stroke="black" d="M205.8,-5109.97C203.49,-5090.42 201.57,-5067.99 201.57,-5047.5 201.57,-5047.5 201.57,-5047.5 201.57,-4363.5 201.57,-4346.17 203.88,-4327.1 206.48,-4311.15"/>
<polygon fill="black" stroke="black" points="209.95,-4311.62 208.2,-4301.17 203.05,-4310.43 209.95,-4311.62"/>
</g>
<!-- layer_13_q_proj -->
<g id="node549" class="node">
<title>layer_13_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-4983 453.57,-4983 453.57,-4930 659.57,-4930 659.57,-4983"/>
<text text-anchor="middle" x="556.57" y="-4967.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-4952.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-4937.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_q_proj -->
<g id="edge795" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_q_proj</title>
<path fill="none" stroke="black" d="M480.81,-5019.81C492.34,-5010.32 505.56,-4999.45 517.69,-4989.47"/>
<polygon fill="black" stroke="black" points="519.98,-4992.12 525.48,-4983.07 515.53,-4986.72 519.98,-4992.12"/>
</g>
<!-- layer_13_k_proj -->
<g id="node550" class="node">
<title>layer_13_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-4983 677.57,-4983 677.57,-4930 883.57,-4930 883.57,-4983"/>
<text text-anchor="middle" x="780.57" y="-4967.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-4952.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-4937.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_k_proj -->
<g id="edge796" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_k_proj</title>
<path fill="none" stroke="black" d="M545.75,-5019.93C586.13,-5009.19 633.23,-4996.67 674.6,-4985.67"/>
<polygon fill="black" stroke="black" points="675.67,-4989.01 684.43,-4983.06 673.87,-4982.25 675.67,-4989.01"/>
</g>
<!-- layer_13_v_proj -->
<g id="node551" class="node">
<title>layer_13_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-4983 229.57,-4983 229.57,-4930 435.57,-4930 435.57,-4983"/>
<text text-anchor="middle" x="332.57" y="-4967.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-4952.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-4937.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_v_proj -->
<g id="edge797" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_v_proj</title>
<path fill="none" stroke="black" d="M415.42,-5019.81C402.68,-5010.23 388.07,-4999.24 374.7,-4989.19"/>
<polygon fill="black" stroke="black" points="376.66,-4986.28 366.57,-4983.07 372.46,-4991.88 376.66,-4986.28"/>
</g>
<!-- layer_13_q_reshape -->
<g id="node552" class="node">
<title>layer_13_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-4893 426.57,-4893 426.57,-4840 650.57,-4840 650.57,-4893"/>
<text text-anchor="middle" x="538.57" y="-4877.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-4862.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-4847.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_q_proj&#45;&gt;layer_13_q_reshape -->
<g id="edge798" class="edge">
<title>layer_13_q_proj&#45;&gt;layer_13_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-4929.57C549.58,-4921.34 547.69,-4912.08 545.89,-4903.28"/>
<polygon fill="black" stroke="black" points="549.27,-4902.34 543.84,-4893.24 542.41,-4903.74 549.27,-4902.34"/>
</g>
<!-- layer_13_k_reshape -->
<g id="node553" class="node">
<title>layer_13_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-4893 668.57,-4893 668.57,-4840 892.57,-4840 892.57,-4893"/>
<text text-anchor="middle" x="780.57" y="-4877.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-4862.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-4847.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_k_proj&#45;&gt;layer_13_k_reshape -->
<g id="edge799" class="edge">
<title>layer_13_k_proj&#45;&gt;layer_13_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-4929.57C780.57,-4921.34 780.57,-4912.08 780.57,-4903.28"/>
<polygon fill="black" stroke="black" points="784.07,-4903.24 780.57,-4893.24 777.07,-4903.24 784.07,-4903.24"/>
</g>
<!-- layer_13_v_reshape -->
<g id="node554" class="node">
<title>layer_13_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="450.57,-4822 226.57,-4822 226.57,-4769 450.57,-4769 450.57,-4822"/>
<text text-anchor="middle" x="338.57" y="-4806.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="338.57" y="-4791.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="338.57" y="-4776.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_v_proj&#45;&gt;layer_13_v_reshape -->
<g id="edge800" class="edge">
<title>layer_13_v_proj&#45;&gt;layer_13_v_reshape</title>
<path fill="none" stroke="black" d="M333.54,-4929.95C334.53,-4903.61 336.09,-4862.29 337.21,-4832.61"/>
<polygon fill="black" stroke="black" points="340.72,-4832.37 337.6,-4822.25 333.72,-4832.11 340.72,-4832.37"/>
</g>
<!-- layer_13_attn_scores -->
<g id="node555" class="node">
<title>layer_13_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-4751 422.07,-4751 422.07,-4698 655.07,-4698 655.07,-4751"/>
<text text-anchor="middle" x="538.57" y="-4735.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-4720.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-4705.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_q_reshape&#45;&gt;layer_13_attn_scores -->
<g id="edge801" class="edge">
<title>layer_13_q_reshape&#45;&gt;layer_13_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-4839.82C538.57,-4817.72 538.57,-4785.6 538.57,-4761.03"/>
<polygon fill="black" stroke="black" points="542.07,-4761.02 538.57,-4751.02 535.07,-4761.02 542.07,-4761.02"/>
</g>
<!-- layer_13_k_reshape&#45;&gt;layer_13_attn_scores -->
<g id="edge802" class="edge">
<title>layer_13_k_reshape&#45;&gt;layer_13_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-4839.98C695.65,-4816.37 634.91,-4781.23 591.5,-4756.12"/>
<polygon fill="black" stroke="black" points="593.19,-4753.05 582.78,-4751.08 589.68,-4759.11 593.19,-4753.05"/>
</g>
<!-- layer_13_attn_output -->
<g id="node557" class="node">
<title>layer_13_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-4571 229.57,-4571 229.57,-4518 453.57,-4518 453.57,-4571"/>
<text text-anchor="middle" x="341.57" y="-4555.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-4540.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-4525.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_v_reshape&#45;&gt;layer_13_attn_output -->
<g id="edge805" class="edge">
<title>layer_13_v_reshape&#45;&gt;layer_13_attn_output</title>
<path fill="none" stroke="black" d="M338.88,-4768.79C339.42,-4724.13 340.53,-4632.13 341.14,-4581.27"/>
<polygon fill="black" stroke="black" points="344.64,-4581.11 341.26,-4571.07 337.64,-4581.03 344.64,-4581.11"/>
</g>
<!-- layer_13_attn_weights -->
<g id="node556" class="node">
<title>layer_13_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="628.07,-4661 395.07,-4661 395.07,-4608 628.07,-4608 628.07,-4661"/>
<text text-anchor="middle" x="511.57" y="-4645.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="511.57" y="-4630.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="511.57" y="-4615.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_scores&#45;&gt;layer_13_attn_weights -->
<g id="edge803" class="edge">
<title>layer_13_attn_scores&#45;&gt;layer_13_attn_weights</title>
<path fill="none" stroke="black" d="M530.62,-4697.57C528.06,-4689.25 525.19,-4679.88 522.46,-4670.99"/>
<polygon fill="black" stroke="black" points="525.75,-4669.78 519.47,-4661.24 519.06,-4671.83 525.75,-4669.78"/>
</g>
<!-- layer_13_attn_weights&#45;&gt;layer_13_attn_output -->
<g id="edge804" class="edge">
<title>layer_13_attn_weights&#45;&gt;layer_13_attn_output</title>
<path fill="none" stroke="black" d="M461.94,-4607.81C442.57,-4597.78 420.2,-4586.2 400.05,-4575.77"/>
<polygon fill="black" stroke="black" points="401.46,-4572.56 390.97,-4571.07 398.24,-4578.77 401.46,-4572.56"/>
</g>
<!-- layer_13_attn_reshape -->
<g id="node558" class="node">
<title>layer_13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-4481 236.57,-4481 236.57,-4428 442.57,-4428 442.57,-4481"/>
<text text-anchor="middle" x="339.57" y="-4465.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-4450.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-4435.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_output&#45;&gt;layer_13_attn_reshape -->
<g id="edge806" class="edge">
<title>layer_13_attn_output&#45;&gt;layer_13_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-4517.57C340.79,-4509.34 340.58,-4500.08 340.38,-4491.28"/>
<polygon fill="black" stroke="black" points="343.88,-4491.16 340.16,-4481.24 336.88,-4491.32 343.88,-4491.16"/>
</g>
<!-- layer_13_attn_proj -->
<g id="node559" class="node">
<title>layer_13_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-4391 233.57,-4391 233.57,-4338 439.57,-4338 439.57,-4391"/>
<text text-anchor="middle" x="336.57" y="-4375.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-4360.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-4345.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_reshape&#45;&gt;layer_13_attn_proj -->
<g id="edge807" class="edge">
<title>layer_13_attn_reshape&#45;&gt;layer_13_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-4427.57C338.41,-4419.34 338.09,-4410.08 337.79,-4401.28"/>
<polygon fill="black" stroke="black" points="341.29,-4401.12 337.45,-4391.24 334.29,-4401.36 341.29,-4401.12"/>
</g>
<!-- layer_13_attn_proj&#45;&gt;layer_13_add1 -->
<g id="edge809" class="edge">
<title>layer_13_attn_proj&#45;&gt;layer_13_add1</title>
<path fill="none" stroke="black" d="M300.66,-4337.81C287.15,-4328.14 271.63,-4317.04 257.47,-4306.9"/>
<polygon fill="black" stroke="black" points="259.48,-4304.04 249.31,-4301.07 255.41,-4309.73 259.48,-4304.04"/>
</g>
<!-- layer_13_ln2 -->
<g id="node561" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-4211 827.57,-4211 827.57,-4158 1033.57,-4158 1033.57,-4211"/>
<text text-anchor="middle" x="930.57" y="-4195.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-4180.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-4165.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_add1&#45;&gt;layer_13_ln2 -->
<g id="edge810" class="edge">
<title>layer_13_add1&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M316.68,-4260.84C449.47,-4244.55 679.5,-4216.31 817.13,-4199.42"/>
<polygon fill="black" stroke="black" points="817.78,-4202.87 827.28,-4198.18 816.93,-4195.92 817.78,-4202.87"/>
</g>
<!-- layer_13_add -->
<g id="node588" class="node">
<title>layer_13_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-3555 110.57,-3555 110.57,-3502 316.57,-3502 316.57,-3555"/>
<text text-anchor="middle" x="213.57" y="-3539.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-3524.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-3509.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_add1&#45;&gt;layer_13_add -->
<g id="edge852" class="edge">
<title>layer_13_add1&#45;&gt;layer_13_add</title>
<path fill="none" stroke="black" d="M208.2,-4247.83C205.01,-4230.34 201.57,-4206.62 201.57,-4185.5 201.57,-4185.5 201.57,-4185.5 201.57,-3644 201.57,-3617.6 204.77,-3587.96 207.86,-3565.46"/>
<polygon fill="black" stroke="black" points="211.35,-3565.73 209.31,-3555.34 204.42,-3564.74 211.35,-3565.73"/>
</g>
<!-- layer_13_gate -->
<g id="node562" class="node">
<title>layer_13_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-4121 900.57,-4068 1079.57,-4015 1258.57,-4068 1079.57,-4121"/>
<text text-anchor="middle" x="1079.57" y="-4079.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-4064.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-4049.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_gate -->
<g id="edge811" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_gate</title>
<path fill="none" stroke="black" d="M964.01,-4157.8C981.28,-4144.53 1002.83,-4127.97 1022.63,-4112.76"/>
<polygon fill="black" stroke="black" points="1024.9,-4115.43 1030.69,-4106.56 1020.63,-4109.88 1024.9,-4115.43"/>
</g>
<!-- layer_13_expert_0_ffn1 -->
<g id="node563" class="node">
<title>layer_13_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-3968 677.57,-3968 677.57,-3915 883.57,-3915 883.57,-3968"/>
<text text-anchor="middle" x="780.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_0_ffn1 -->
<g id="edge813" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-4157.95C887.23,-4147.28 873.96,-4134.28 863.57,-4121 824.71,-4071.33 817.94,-4055.58 794.57,-3997 792.17,-3990.99 790.08,-3984.43 788.29,-3978.02"/>
<polygon fill="black" stroke="black" points="791.63,-3976.97 785.73,-3968.17 784.85,-3978.72 791.63,-3976.97"/>
</g>
<!-- layer_13_expert_1_ffn1 -->
<g id="node566" class="node">
<title>layer_13_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-3968 229.57,-3968 229.57,-3915 435.57,-3915 435.57,-3968"/>
<text text-anchor="middle" x="332.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_1_ffn1 -->
<g id="edge817" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-4171.27C767.36,-4161.96 691.02,-4146.31 626.57,-4121 529.83,-4083.01 428.72,-4014.16 373.91,-3973.98"/>
<polygon fill="black" stroke="black" points="375.97,-3971.14 365.84,-3968.02 371.81,-3976.78 375.97,-3971.14"/>
</g>
<!-- layer_13_expert_2_ffn1 -->
<g id="node569" class="node">
<title>layer_13_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-3968 1125.57,-3968 1125.57,-3915 1331.57,-3915 1331.57,-3968"/>
<text text-anchor="middle" x="1228.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_2_ffn1 -->
<g id="edge821" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-4178.17C1121.34,-4171.26 1237.52,-4155.69 1267.57,-4121 1306.88,-4075.62 1295.71,-4041.4 1272.57,-3986 1271.12,-3982.52 1269.24,-3979.18 1267.08,-3976.01"/>
<polygon fill="black" stroke="black" points="1269.72,-3973.71 1260.79,-3968.01 1264.22,-3978.03 1269.72,-3973.71"/>
</g>
<!-- layer_13_expert_3_ffn1 -->
<g id="node572" class="node">
<title>layer_13_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-3968 1573.57,-3968 1573.57,-3915 1779.57,-3915 1779.57,-3968"/>
<text text-anchor="middle" x="1676.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_3_ffn1 -->
<g id="edge825" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-4178.82C1122.76,-4172.39 1253.8,-4157.14 1362.57,-4121 1484.83,-4080.38 1520.13,-4072.42 1624.57,-3997 1633.08,-3990.86 1641.36,-3983.21 1648.73,-3975.6"/>
<polygon fill="black" stroke="black" points="1651.49,-3977.77 1655.76,-3968.07 1646.38,-3972.99 1651.49,-3977.77"/>
</g>
<!-- layer_13_expert_4_ffn1 -->
<g id="node575" class="node">
<title>layer_13_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-3968 453.57,-3968 453.57,-3915 659.57,-3915 659.57,-3968"/>
<text text-anchor="middle" x="556.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_4_ffn1 -->
<g id="edge829" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-4157.89C801.11,-4126.58 686.43,-4068.79 603.57,-3997 596.29,-3990.69 589.13,-3983.24 582.68,-3975.9"/>
<polygon fill="black" stroke="black" points="585.14,-3973.39 575.99,-3968.05 579.81,-3977.93 585.14,-3973.39"/>
</g>
<!-- layer_13_expert_5_ffn1 -->
<g id="node578" class="node">
<title>layer_13_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-3968 1349.57,-3968 1349.57,-3915 1555.57,-3915 1555.57,-3968"/>
<text text-anchor="middle" x="1452.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_5_ffn1 -->
<g id="edge833" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-4177.77C1098.02,-4172.2 1181.84,-4161.3 1253.57,-4140 1272.44,-4134.4 1277.44,-4132.28 1293.57,-4121 1357.95,-4075.96 1370.85,-4058.64 1419.57,-3997 1424.54,-3990.72 1429.34,-3983.63 1433.66,-3976.69"/>
<polygon fill="black" stroke="black" points="1436.7,-3978.43 1438.87,-3968.05 1430.71,-3974.81 1436.7,-3978.43"/>
</g>
<!-- layer_13_expert_6_ffn1 -->
<g id="node581" class="node">
<title>layer_13_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-3968 1797.57,-3968 1797.57,-3915 2003.57,-3915 2003.57,-3968"/>
<text text-anchor="middle" x="1900.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_6_ffn1 -->
<g id="edge837" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-4181.36C1147.98,-4176.86 1336.72,-4163.05 1493.57,-4121 1625.52,-4085.63 1769.63,-4013.8 1845.97,-3972.86"/>
<polygon fill="black" stroke="black" points="1847.8,-3975.86 1854.94,-3968.03 1844.47,-3969.69 1847.8,-3975.86"/>
</g>
<!-- layer_13_expert_7_ffn1 -->
<g id="node584" class="node">
<title>layer_13_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-3968 901.57,-3968 901.57,-3915 1107.57,-3915 1107.57,-3968"/>
<text text-anchor="middle" x="1004.57" y="-3952.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-3937.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-3922.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_expert_7_ffn1 -->
<g id="edge841" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-4157.92C903.08,-4147.14 895.6,-4134.08 891.57,-4121 873.88,-4063.62 852.23,-4035.25 886.57,-3986 889.58,-3981.69 893.06,-3977.8 896.91,-3974.3"/>
<polygon fill="black" stroke="black" points="899.11,-3977.02 904.71,-3968.03 894.73,-3971.56 899.11,-3977.02"/>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_0_ffn1 -->
<g id="edge812" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-4036.54C959.2,-4016.88 898.07,-3991.43 851.32,-3971.96"/>
<polygon fill="black" stroke="black" points="852.45,-3968.64 841.87,-3968.03 849.76,-3975.1 852.45,-3968.64"/>
<text text-anchor="middle" x="924.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_1_ffn1 -->
<g id="edge816" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-4050.72C833.08,-4033.17 630.07,-4003.21 445.54,-3968.14"/>
<polygon fill="black" stroke="black" points="446.13,-3964.69 435.65,-3966.25 444.82,-3971.56 446.13,-3964.69"/>
<text text-anchor="middle" x="623.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_2_ffn1 -->
<g id="edge820" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1107.53,-4023.06C1117.22,-4010.05 1128.88,-3996.49 1141.57,-3986 1147.12,-3981.41 1153.23,-3977.15 1159.57,-3973.23"/>
<polygon fill="black" stroke="black" points="1161.46,-3976.17 1168.31,-3968.09 1157.92,-3970.14 1161.46,-3976.17"/>
<text text-anchor="middle" x="1163.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_3_ffn1 -->
<g id="edge824" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-4045.7C1263.24,-4029.33 1376.38,-4006.18 1475.57,-3986 1512.26,-3978.54 1523.52,-3976.73 1563.55,-3968.2"/>
<polygon fill="black" stroke="black" points="1564.41,-3971.59 1573.46,-3966.08 1562.94,-3964.75 1564.41,-3971.59"/>
<text text-anchor="middle" x="1497.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_4_ffn1 -->
<g id="edge828" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-4043.8C893.49,-4022.7 762.7,-3991.57 669.53,-3969.39"/>
<polygon fill="black" stroke="black" points="670.33,-3965.98 659.79,-3967.07 668.7,-3972.79 670.33,-3965.98"/>
<text text-anchor="middle" x="792.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_5_ffn1 -->
<g id="edge832" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-4036.6C1193.35,-4020.52 1244.3,-4001.05 1290.57,-3986 1306.78,-3980.73 1324.04,-3975.6 1341.02,-3970.81"/>
<polygon fill="black" stroke="black" points="1342.29,-3974.09 1350.98,-3968.04 1340.41,-3967.35 1342.29,-3974.09"/>
<text text-anchor="middle" x="1312.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_6_ffn1 -->
<g id="edge836" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-4052.57C1346.62,-4035.91 1578.71,-4006.07 1787.57,-3968.13"/>
<polygon fill="black" stroke="black" points="1788.29,-3971.55 1797.5,-3966.31 1787.04,-3964.67 1788.29,-3971.55"/>
<text text-anchor="middle" x="1694.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_13_gate&#45;&gt;layer_13_expert_7_ffn1 -->
<g id="edge840" class="edge">
<title>layer_13_gate&#45;&gt;layer_13_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1050.78,-4023.22C1045.29,-4014.6 1039.67,-4005.56 1034.57,-3997 1030.77,-3990.62 1026.85,-3983.74 1023.14,-3977.08"/>
<polygon fill="black" stroke="black" points="1026.15,-3975.28 1018.26,-3968.21 1020.02,-3978.66 1026.15,-3975.28"/>
<text text-anchor="middle" x="1056.57" y="-3989" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_13_expert_0_gelu -->
<g id="node564" class="node">
<title>layer_13_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-3878 677.57,-3878 677.57,-3825 883.57,-3825 883.57,-3878"/>
<text text-anchor="middle" x="780.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_0_ffn1&#45;&gt;layer_13_expert_0_gelu -->
<g id="edge814" class="edge">
<title>layer_13_expert_0_ffn1&#45;&gt;layer_13_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-3914.57C780.57,-3906.34 780.57,-3897.08 780.57,-3888.28"/>
<polygon fill="black" stroke="black" points="784.07,-3888.24 780.57,-3878.24 777.07,-3888.24 784.07,-3888.24"/>
</g>
<!-- layer_13_expert_0_ffn2 -->
<g id="node565" class="node">
<title>layer_13_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-3788 677.57,-3788 677.57,-3735 883.57,-3735 883.57,-3788"/>
<text text-anchor="middle" x="780.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_0_gelu&#45;&gt;layer_13_expert_0_ffn2 -->
<g id="edge815" class="edge">
<title>layer_13_expert_0_gelu&#45;&gt;layer_13_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-3824.57C780.57,-3816.34 780.57,-3807.08 780.57,-3798.28"/>
<polygon fill="black" stroke="black" points="784.07,-3798.24 780.57,-3788.24 777.07,-3798.24 784.07,-3798.24"/>
</g>
<!-- layer_13_expert_agg -->
<g id="node587" class="node">
<title>layer_13_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-3698 878.36,-3698 790.93,-3592 1130.79,-3592 1218.21,-3698"/>
<text text-anchor="middle" x="1004.57" y="-3656.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-3641.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-3626.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_0_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge844" class="edge">
<title>layer_13_expert_0_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-3734.95C849.26,-3725.39 871.33,-3714.11 893.35,-3702.85"/>
<polygon fill="black" stroke="black" points="895.14,-3705.87 902.45,-3698.2 891.95,-3699.64 895.14,-3705.87"/>
</g>
<!-- layer_13_expert_1_gelu -->
<g id="node567" class="node">
<title>layer_13_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-3878 229.57,-3878 229.57,-3825 435.57,-3825 435.57,-3878"/>
<text text-anchor="middle" x="332.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_1_ffn1&#45;&gt;layer_13_expert_1_gelu -->
<g id="edge818" class="edge">
<title>layer_13_expert_1_ffn1&#45;&gt;layer_13_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-3914.57C332.57,-3906.34 332.57,-3897.08 332.57,-3888.28"/>
<polygon fill="black" stroke="black" points="336.07,-3888.24 332.57,-3878.24 329.07,-3888.24 336.07,-3888.24"/>
</g>
<!-- layer_13_expert_1_ffn2 -->
<g id="node568" class="node">
<title>layer_13_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-3788 229.57,-3788 229.57,-3735 435.57,-3735 435.57,-3788"/>
<text text-anchor="middle" x="332.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_1_gelu&#45;&gt;layer_13_expert_1_ffn2 -->
<g id="edge819" class="edge">
<title>layer_13_expert_1_gelu&#45;&gt;layer_13_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-3824.57C332.57,-3816.34 332.57,-3807.08 332.57,-3798.28"/>
<polygon fill="black" stroke="black" points="336.07,-3798.24 332.57,-3788.24 329.07,-3798.24 336.07,-3798.24"/>
</g>
<!-- layer_13_expert_1_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge845" class="edge">
<title>layer_13_expert_1_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-3736.76C438.66,-3736.16 441.63,-3735.57 444.57,-3735 578.16,-3709.21 730.72,-3685.32 842.83,-3668.81"/>
<polygon fill="black" stroke="black" points="843.49,-3672.25 852.87,-3667.33 842.47,-3665.32 843.49,-3672.25"/>
</g>
<!-- layer_13_expert_2_gelu -->
<g id="node570" class="node">
<title>layer_13_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-3878 1125.57,-3878 1125.57,-3825 1331.57,-3825 1331.57,-3878"/>
<text text-anchor="middle" x="1228.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_2_ffn1&#45;&gt;layer_13_expert_2_gelu -->
<g id="edge822" class="edge">
<title>layer_13_expert_2_ffn1&#45;&gt;layer_13_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-3914.57C1228.57,-3906.34 1228.57,-3897.08 1228.57,-3888.28"/>
<polygon fill="black" stroke="black" points="1232.07,-3888.24 1228.57,-3878.24 1225.07,-3888.24 1232.07,-3888.24"/>
</g>
<!-- layer_13_expert_2_ffn2 -->
<g id="node571" class="node">
<title>layer_13_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-3788 1125.57,-3788 1125.57,-3735 1331.57,-3735 1331.57,-3788"/>
<text text-anchor="middle" x="1228.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_2_gelu&#45;&gt;layer_13_expert_2_ffn2 -->
<g id="edge823" class="edge">
<title>layer_13_expert_2_gelu&#45;&gt;layer_13_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-3824.57C1228.57,-3816.34 1228.57,-3807.08 1228.57,-3798.28"/>
<polygon fill="black" stroke="black" points="1232.07,-3798.24 1228.57,-3788.24 1225.07,-3798.24 1232.07,-3798.24"/>
</g>
<!-- layer_13_expert_2_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge846" class="edge">
<title>layer_13_expert_2_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-3734.95C1159.88,-3725.39 1137.81,-3714.11 1115.79,-3702.85"/>
<polygon fill="black" stroke="black" points="1117.19,-3699.64 1106.7,-3698.2 1114.01,-3705.87 1117.19,-3699.64"/>
</g>
<!-- layer_13_expert_3_gelu -->
<g id="node573" class="node">
<title>layer_13_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-3878 1573.57,-3878 1573.57,-3825 1779.57,-3825 1779.57,-3878"/>
<text text-anchor="middle" x="1676.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_3_ffn1&#45;&gt;layer_13_expert_3_gelu -->
<g id="edge826" class="edge">
<title>layer_13_expert_3_ffn1&#45;&gt;layer_13_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-3914.57C1676.57,-3906.34 1676.57,-3897.08 1676.57,-3888.28"/>
<polygon fill="black" stroke="black" points="1680.07,-3888.24 1676.57,-3878.24 1673.07,-3888.24 1680.07,-3888.24"/>
</g>
<!-- layer_13_expert_3_ffn2 -->
<g id="node574" class="node">
<title>layer_13_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-3788 1573.57,-3788 1573.57,-3735 1779.57,-3735 1779.57,-3788"/>
<text text-anchor="middle" x="1676.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_3_gelu&#45;&gt;layer_13_expert_3_ffn2 -->
<g id="edge827" class="edge">
<title>layer_13_expert_3_gelu&#45;&gt;layer_13_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-3824.57C1676.57,-3816.34 1676.57,-3807.08 1676.57,-3798.28"/>
<polygon fill="black" stroke="black" points="1680.07,-3798.24 1676.57,-3788.24 1673.07,-3798.24 1680.07,-3798.24"/>
</g>
<!-- layer_13_expert_3_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge847" class="edge">
<title>layer_13_expert_3_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-3736.76C1570.49,-3736.16 1567.51,-3735.57 1564.57,-3735 1446.94,-3712.29 1314.59,-3691.06 1208.1,-3675.03"/>
<polygon fill="black" stroke="black" points="1208.61,-3671.57 1198.21,-3673.54 1207.58,-3678.49 1208.61,-3671.57"/>
</g>
<!-- layer_13_expert_4_gelu -->
<g id="node576" class="node">
<title>layer_13_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-3878 453.57,-3878 453.57,-3825 659.57,-3825 659.57,-3878"/>
<text text-anchor="middle" x="556.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_4_ffn1&#45;&gt;layer_13_expert_4_gelu -->
<g id="edge830" class="edge">
<title>layer_13_expert_4_ffn1&#45;&gt;layer_13_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-3914.57C556.57,-3906.34 556.57,-3897.08 556.57,-3888.28"/>
<polygon fill="black" stroke="black" points="560.07,-3888.24 556.57,-3878.24 553.07,-3888.24 560.07,-3888.24"/>
</g>
<!-- layer_13_expert_4_ffn2 -->
<g id="node577" class="node">
<title>layer_13_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-3788 453.57,-3788 453.57,-3735 659.57,-3735 659.57,-3788"/>
<text text-anchor="middle" x="556.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_4_gelu&#45;&gt;layer_13_expert_4_ffn2 -->
<g id="edge831" class="edge">
<title>layer_13_expert_4_gelu&#45;&gt;layer_13_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-3824.57C556.57,-3816.34 556.57,-3807.08 556.57,-3798.28"/>
<polygon fill="black" stroke="black" points="560.07,-3798.24 556.57,-3788.24 553.07,-3798.24 560.07,-3798.24"/>
</g>
<!-- layer_13_expert_4_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge848" class="edge">
<title>layer_13_expert_4_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-3734.95C714.81,-3720.06 789.41,-3700.99 854.59,-3684.33"/>
<polygon fill="black" stroke="black" points="855.73,-3687.65 864.55,-3681.79 853.99,-3680.87 855.73,-3687.65"/>
</g>
<!-- layer_13_expert_5_gelu -->
<g id="node579" class="node">
<title>layer_13_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-3878 1349.57,-3878 1349.57,-3825 1555.57,-3825 1555.57,-3878"/>
<text text-anchor="middle" x="1452.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_5_ffn1&#45;&gt;layer_13_expert_5_gelu -->
<g id="edge834" class="edge">
<title>layer_13_expert_5_ffn1&#45;&gt;layer_13_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-3914.57C1452.57,-3906.34 1452.57,-3897.08 1452.57,-3888.28"/>
<polygon fill="black" stroke="black" points="1456.07,-3888.24 1452.57,-3878.24 1449.07,-3888.24 1456.07,-3888.24"/>
</g>
<!-- layer_13_expert_5_ffn2 -->
<g id="node580" class="node">
<title>layer_13_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-3788 1349.57,-3788 1349.57,-3735 1555.57,-3735 1555.57,-3788"/>
<text text-anchor="middle" x="1452.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_5_gelu&#45;&gt;layer_13_expert_5_ffn2 -->
<g id="edge835" class="edge">
<title>layer_13_expert_5_gelu&#45;&gt;layer_13_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-3824.57C1452.57,-3816.34 1452.57,-3807.08 1452.57,-3798.28"/>
<polygon fill="black" stroke="black" points="1456.07,-3798.24 1452.57,-3788.24 1449.07,-3798.24 1456.07,-3798.24"/>
</g>
<!-- layer_13_expert_5_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge849" class="edge">
<title>layer_13_expert_5_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-3734.95C1312.66,-3724.74 1265.05,-3712.57 1218.07,-3700.57"/>
<polygon fill="black" stroke="black" points="1218.92,-3697.17 1208.37,-3698.09 1217.19,-3703.95 1218.92,-3697.17"/>
</g>
<!-- layer_13_expert_6_gelu -->
<g id="node582" class="node">
<title>layer_13_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-3878 1797.57,-3878 1797.57,-3825 2003.57,-3825 2003.57,-3878"/>
<text text-anchor="middle" x="1900.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_6_ffn1&#45;&gt;layer_13_expert_6_gelu -->
<g id="edge838" class="edge">
<title>layer_13_expert_6_ffn1&#45;&gt;layer_13_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-3914.57C1900.57,-3906.34 1900.57,-3897.08 1900.57,-3888.28"/>
<polygon fill="black" stroke="black" points="1904.07,-3888.24 1900.57,-3878.24 1897.07,-3888.24 1904.07,-3888.24"/>
</g>
<!-- layer_13_expert_6_ffn2 -->
<g id="node583" class="node">
<title>layer_13_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-3788 1797.57,-3788 1797.57,-3735 2003.57,-3735 2003.57,-3788"/>
<text text-anchor="middle" x="1900.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_6_gelu&#45;&gt;layer_13_expert_6_ffn2 -->
<g id="edge839" class="edge">
<title>layer_13_expert_6_gelu&#45;&gt;layer_13_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-3824.57C1900.57,-3816.34 1900.57,-3807.08 1900.57,-3798.28"/>
<polygon fill="black" stroke="black" points="1904.07,-3798.24 1900.57,-3788.24 1897.07,-3798.24 1904.07,-3798.24"/>
</g>
<!-- layer_13_expert_6_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge850" class="edge">
<title>layer_13_expert_6_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-3736.59C1794.51,-3736.03 1791.52,-3735.5 1788.57,-3735 1588.54,-3700.98 1357.51,-3676.53 1198.33,-3661.97"/>
<polygon fill="black" stroke="black" points="1198.23,-3658.45 1187.95,-3661.03 1197.59,-3665.42 1198.23,-3658.45"/>
</g>
<!-- layer_13_expert_7_gelu -->
<g id="node585" class="node">
<title>layer_13_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-3878 901.57,-3878 901.57,-3825 1107.57,-3825 1107.57,-3878"/>
<text text-anchor="middle" x="1004.57" y="-3862.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-3847.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-3832.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_7_ffn1&#45;&gt;layer_13_expert_7_gelu -->
<g id="edge842" class="edge">
<title>layer_13_expert_7_ffn1&#45;&gt;layer_13_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-3914.57C1004.57,-3906.34 1004.57,-3897.08 1004.57,-3888.28"/>
<polygon fill="black" stroke="black" points="1008.07,-3888.24 1004.57,-3878.24 1001.07,-3888.24 1008.07,-3888.24"/>
</g>
<!-- layer_13_expert_7_ffn2 -->
<g id="node586" class="node">
<title>layer_13_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-3788 901.57,-3788 901.57,-3735 1107.57,-3735 1107.57,-3788"/>
<text text-anchor="middle" x="1004.57" y="-3772.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-3757.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-3742.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_expert_7_gelu&#45;&gt;layer_13_expert_7_ffn2 -->
<g id="edge843" class="edge">
<title>layer_13_expert_7_gelu&#45;&gt;layer_13_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-3824.57C1004.57,-3816.34 1004.57,-3807.08 1004.57,-3798.28"/>
<polygon fill="black" stroke="black" points="1008.07,-3798.24 1004.57,-3788.24 1001.07,-3798.24 1008.07,-3798.24"/>
</g>
<!-- layer_13_expert_7_ffn2&#45;&gt;layer_13_expert_agg -->
<g id="edge851" class="edge">
<title>layer_13_expert_7_ffn2&#45;&gt;layer_13_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-3734.8C1004.57,-3726.86 1004.57,-3717.74 1004.57,-3708.44"/>
<polygon fill="black" stroke="black" points="1008.07,-3708.32 1004.57,-3698.32 1001.07,-3708.32 1008.07,-3708.32"/>
</g>
<!-- layer_13_expert_agg&#45;&gt;layer_13_add -->
<g id="edge853" class="edge">
<title>layer_13_expert_agg&#45;&gt;layer_13_add</title>
<path fill="none" stroke="black" d="M810.56,-3615.92C658.7,-3593.93 452.76,-3564.12 326.73,-3545.88"/>
<polygon fill="black" stroke="black" points="327.07,-3542.39 316.67,-3544.42 326.07,-3549.32 327.07,-3542.39"/>
</g>
<!-- comm_13_14 -->
<g id="node589" class="node">
<title>comm_13_14</title>
<polygon fill="yellow" stroke="black" points="427.21,-3465 87.36,-3465 -0.07,-3359 339.79,-3359 427.21,-3465"/>
<text text-anchor="middle" x="213.57" y="-3423.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-3408.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-3393.3" font-family="Times,serif" font-size="14.00">GPU 13  GPU 14</text>
</g>
<!-- layer_13_add&#45;&gt;comm_13_14 -->
<g id="edge854" class="edge">
<title>layer_13_add&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M213.57,-3501.8C213.57,-3493.86 213.57,-3484.74 213.57,-3475.44"/>
<polygon fill="black" stroke="black" points="217.07,-3475.32 213.57,-3465.32 210.07,-3475.32 217.07,-3475.32"/>
</g>
<!-- layer_14_ln1 -->
<g id="node590" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-3322 291.57,-3322 291.57,-3269 497.57,-3269 497.57,-3322"/>
<text text-anchor="middle" x="394.57" y="-3306.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-3291.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-3276.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- comm_13_14&#45;&gt;layer_14_ln1 -->
<g id="edge855" class="edge">
<title>comm_13_14&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M295.86,-3358.94C312.72,-3348.28 329.97,-3337.37 345.23,-3327.71"/>
<polygon fill="black" stroke="black" points="347.39,-3330.49 353.97,-3322.18 343.65,-3324.57 347.39,-3330.49"/>
</g>
<!-- layer_14_add1 -->
<g id="node602" class="node">
<title>layer_14_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-2550 110.57,-2550 110.57,-2497 316.57,-2497 316.57,-2550"/>
<text text-anchor="middle" x="213.57" y="-2534.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-2519.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-2504.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- comm_13_14&#45;&gt;layer_14_add1 -->
<g id="edge869" class="edge">
<title>comm_13_14&#45;&gt;layer_14_add1</title>
<path fill="none" stroke="black" d="M205.8,-3358.97C203.49,-3339.42 201.57,-3316.99 201.57,-3296.5 201.57,-3296.5 201.57,-3296.5 201.57,-2612.5 201.57,-2595.17 203.88,-2576.1 206.48,-2560.15"/>
<polygon fill="black" stroke="black" points="209.95,-2560.62 208.2,-2550.17 203.05,-2559.43 209.95,-2560.62"/>
</g>
<!-- layer_14_q_proj -->
<g id="node591" class="node">
<title>layer_14_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-3232 453.57,-3232 453.57,-3179 659.57,-3179 659.57,-3232"/>
<text text-anchor="middle" x="556.57" y="-3216.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-3201.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-3186.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_q_proj -->
<g id="edge856" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-3268.81C460.25,-3258.82 481.45,-3247.31 500.58,-3236.91"/>
<polygon fill="black" stroke="black" points="502.38,-3239.92 509.5,-3232.07 499.04,-3233.77 502.38,-3239.92"/>
</g>
<!-- layer_14_k_proj -->
<g id="node592" class="node">
<title>layer_14_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-3232 677.57,-3232 677.57,-3179 883.57,-3179 883.57,-3232"/>
<text text-anchor="middle" x="780.57" y="-3216.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-3201.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-3186.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_k_proj -->
<g id="edge857" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-3270.98C550.11,-3259.04 613.8,-3244.52 667.48,-3232.28"/>
<polygon fill="black" stroke="black" points="668.41,-3235.66 677.38,-3230.02 666.86,-3228.83 668.41,-3235.66"/>
</g>
<!-- layer_14_v_proj -->
<g id="node593" class="node">
<title>layer_14_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-3232 229.57,-3232 229.57,-3179 435.57,-3179 435.57,-3232"/>
<text text-anchor="middle" x="332.57" y="-3216.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-3201.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-3186.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_v_proj -->
<g id="edge858" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-3268.57C370.12,-3259.8 363.13,-3249.87 356.57,-3240.56"/>
<polygon fill="black" stroke="black" points="359.33,-3238.4 350.71,-3232.24 353.61,-3242.43 359.33,-3238.4"/>
</g>
<!-- layer_14_q_reshape -->
<g id="node594" class="node">
<title>layer_14_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-3142 426.57,-3142 426.57,-3089 650.57,-3089 650.57,-3142"/>
<text text-anchor="middle" x="538.57" y="-3126.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-3111.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-3096.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_q_proj&#45;&gt;layer_14_q_reshape -->
<g id="edge859" class="edge">
<title>layer_14_q_proj&#45;&gt;layer_14_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-3178.57C549.58,-3170.34 547.69,-3161.08 545.89,-3152.28"/>
<polygon fill="black" stroke="black" points="549.27,-3151.34 543.84,-3142.24 542.41,-3152.74 549.27,-3151.34"/>
</g>
<!-- layer_14_k_reshape -->
<g id="node595" class="node">
<title>layer_14_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-3142 668.57,-3142 668.57,-3089 892.57,-3089 892.57,-3142"/>
<text text-anchor="middle" x="780.57" y="-3126.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-3111.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-3096.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_k_proj&#45;&gt;layer_14_k_reshape -->
<g id="edge860" class="edge">
<title>layer_14_k_proj&#45;&gt;layer_14_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-3178.57C780.57,-3170.34 780.57,-3161.08 780.57,-3152.28"/>
<polygon fill="black" stroke="black" points="784.07,-3152.24 780.57,-3142.24 777.07,-3152.24 784.07,-3152.24"/>
</g>
<!-- layer_14_v_reshape -->
<g id="node596" class="node">
<title>layer_14_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-3071 225.57,-3071 225.57,-3018 449.57,-3018 449.57,-3071"/>
<text text-anchor="middle" x="337.57" y="-3055.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-3040.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-3025.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_v_proj&#45;&gt;layer_14_v_reshape -->
<g id="edge861" class="edge">
<title>layer_14_v_proj&#45;&gt;layer_14_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-3178.95C334.2,-3152.61 335.5,-3111.29 336.44,-3081.61"/>
<polygon fill="black" stroke="black" points="339.95,-3081.35 336.76,-3071.25 332.95,-3081.13 339.95,-3081.35"/>
</g>
<!-- layer_14_attn_scores -->
<g id="node597" class="node">
<title>layer_14_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-3000 422.07,-3000 422.07,-2947 655.07,-2947 655.07,-3000"/>
<text text-anchor="middle" x="538.57" y="-2984.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-2969.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-2954.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_q_reshape&#45;&gt;layer_14_attn_scores -->
<g id="edge862" class="edge">
<title>layer_14_q_reshape&#45;&gt;layer_14_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-3088.82C538.57,-3066.72 538.57,-3034.6 538.57,-3010.03"/>
<polygon fill="black" stroke="black" points="542.07,-3010.02 538.57,-3000.02 535.07,-3010.02 542.07,-3010.02"/>
</g>
<!-- layer_14_k_reshape&#45;&gt;layer_14_attn_scores -->
<g id="edge863" class="edge">
<title>layer_14_k_reshape&#45;&gt;layer_14_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-3088.98C695.65,-3065.37 634.91,-3030.23 591.5,-3005.12"/>
<polygon fill="black" stroke="black" points="593.19,-3002.05 582.78,-3000.08 589.68,-3008.11 593.19,-3002.05"/>
</g>
<!-- layer_14_attn_output -->
<g id="node599" class="node">
<title>layer_14_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-2820 229.57,-2820 229.57,-2767 453.57,-2767 453.57,-2820"/>
<text text-anchor="middle" x="341.57" y="-2804.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-2789.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-2774.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_v_reshape&#45;&gt;layer_14_attn_output -->
<g id="edge866" class="edge">
<title>layer_14_v_reshape&#45;&gt;layer_14_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-3017.79C338.7,-2973.13 340.18,-2881.13 341,-2830.27"/>
<polygon fill="black" stroke="black" points="344.5,-2830.12 341.16,-2820.07 337.5,-2830.01 344.5,-2830.12"/>
</g>
<!-- layer_14_attn_weights -->
<g id="node598" class="node">
<title>layer_14_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="629.07,-2910 396.07,-2910 396.07,-2857 629.07,-2857 629.07,-2910"/>
<text text-anchor="middle" x="512.57" y="-2894.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="512.57" y="-2879.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="512.57" y="-2864.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_scores&#45;&gt;layer_14_attn_weights -->
<g id="edge864" class="edge">
<title>layer_14_attn_scores&#45;&gt;layer_14_attn_weights</title>
<path fill="none" stroke="black" d="M530.91,-2946.57C528.45,-2938.25 525.68,-2928.88 523.06,-2919.99"/>
<polygon fill="black" stroke="black" points="526.37,-2918.84 520.18,-2910.24 519.65,-2920.82 526.37,-2918.84"/>
</g>
<!-- layer_14_attn_weights&#45;&gt;layer_14_attn_output -->
<g id="edge865" class="edge">
<title>layer_14_attn_weights&#45;&gt;layer_14_attn_output</title>
<path fill="none" stroke="black" d="M462.65,-2856.81C443.16,-2846.78 420.67,-2835.2 400.4,-2824.77"/>
<polygon fill="black" stroke="black" points="401.75,-2821.53 391.26,-2820.07 398.55,-2827.76 401.75,-2821.53"/>
</g>
<!-- layer_14_attn_reshape -->
<g id="node600" class="node">
<title>layer_14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-2730 236.57,-2730 236.57,-2677 442.57,-2677 442.57,-2730"/>
<text text-anchor="middle" x="339.57" y="-2714.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-2699.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-2684.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_output&#45;&gt;layer_14_attn_reshape -->
<g id="edge867" class="edge">
<title>layer_14_attn_output&#45;&gt;layer_14_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-2766.57C340.79,-2758.34 340.58,-2749.08 340.38,-2740.28"/>
<polygon fill="black" stroke="black" points="343.88,-2740.16 340.16,-2730.24 336.88,-2740.32 343.88,-2740.16"/>
</g>
<!-- layer_14_attn_proj -->
<g id="node601" class="node">
<title>layer_14_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-2640 233.57,-2640 233.57,-2587 439.57,-2587 439.57,-2640"/>
<text text-anchor="middle" x="336.57" y="-2624.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-2609.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-2594.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_reshape&#45;&gt;layer_14_attn_proj -->
<g id="edge868" class="edge">
<title>layer_14_attn_reshape&#45;&gt;layer_14_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-2676.57C338.41,-2668.34 338.09,-2659.08 337.79,-2650.28"/>
<polygon fill="black" stroke="black" points="341.29,-2650.12 337.45,-2640.24 334.29,-2650.36 341.29,-2650.12"/>
</g>
<!-- layer_14_attn_proj&#45;&gt;layer_14_add1 -->
<g id="edge870" class="edge">
<title>layer_14_attn_proj&#45;&gt;layer_14_add1</title>
<path fill="none" stroke="black" d="M300.66,-2586.81C287.15,-2577.14 271.63,-2566.04 257.47,-2555.9"/>
<polygon fill="black" stroke="black" points="259.48,-2553.04 249.31,-2550.07 255.41,-2558.73 259.48,-2553.04"/>
</g>
<!-- layer_14_ln2 -->
<g id="node603" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-2460 827.57,-2460 827.57,-2407 1033.57,-2407 1033.57,-2460"/>
<text text-anchor="middle" x="930.57" y="-2444.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-2429.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-2414.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_add1&#45;&gt;layer_14_ln2 -->
<g id="edge871" class="edge">
<title>layer_14_add1&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M316.68,-2509.84C449.47,-2493.55 679.5,-2465.31 817.13,-2448.42"/>
<polygon fill="black" stroke="black" points="817.78,-2451.87 827.28,-2447.18 816.93,-2444.92 817.78,-2451.87"/>
</g>
<!-- layer_14_add -->
<g id="node630" class="node">
<title>layer_14_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-1804 110.57,-1804 110.57,-1751 316.57,-1751 316.57,-1804"/>
<text text-anchor="middle" x="213.57" y="-1788.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-1773.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-1758.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_add1&#45;&gt;layer_14_add -->
<g id="edge913" class="edge">
<title>layer_14_add1&#45;&gt;layer_14_add</title>
<path fill="none" stroke="black" d="M208.2,-2496.83C205.01,-2479.34 201.57,-2455.62 201.57,-2434.5 201.57,-2434.5 201.57,-2434.5 201.57,-1893 201.57,-1866.6 204.77,-1836.96 207.86,-1814.46"/>
<polygon fill="black" stroke="black" points="211.35,-1814.73 209.31,-1804.34 204.42,-1813.74 211.35,-1814.73"/>
</g>
<!-- layer_14_gate -->
<g id="node604" class="node">
<title>layer_14_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-2370 900.57,-2317 1079.57,-2264 1258.57,-2317 1079.57,-2370"/>
<text text-anchor="middle" x="1079.57" y="-2328.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-2313.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-2298.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_gate -->
<g id="edge872" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_gate</title>
<path fill="none" stroke="black" d="M964.01,-2406.8C981.28,-2393.53 1002.83,-2376.97 1022.63,-2361.76"/>
<polygon fill="black" stroke="black" points="1024.9,-2364.43 1030.69,-2355.56 1020.63,-2358.88 1024.9,-2364.43"/>
</g>
<!-- layer_14_expert_0_ffn1 -->
<g id="node605" class="node">
<title>layer_14_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-2217 677.57,-2217 677.57,-2164 883.57,-2164 883.57,-2217"/>
<text text-anchor="middle" x="780.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_0_ffn1 -->
<g id="edge874" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-2406.95C887.23,-2396.28 873.96,-2383.28 863.57,-2370 824.71,-2320.33 817.94,-2304.58 794.57,-2246 792.17,-2239.99 790.08,-2233.43 788.29,-2227.02"/>
<polygon fill="black" stroke="black" points="791.63,-2225.97 785.73,-2217.17 784.85,-2227.72 791.63,-2225.97"/>
</g>
<!-- layer_14_expert_1_ffn1 -->
<g id="node608" class="node">
<title>layer_14_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-2217 229.57,-2217 229.57,-2164 435.57,-2164 435.57,-2217"/>
<text text-anchor="middle" x="332.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_1_ffn1 -->
<g id="edge878" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-2420.27C767.36,-2410.96 691.02,-2395.31 626.57,-2370 529.83,-2332.01 428.72,-2263.16 373.91,-2222.98"/>
<polygon fill="black" stroke="black" points="375.97,-2220.14 365.84,-2217.02 371.81,-2225.78 375.97,-2220.14"/>
</g>
<!-- layer_14_expert_2_ffn1 -->
<g id="node611" class="node">
<title>layer_14_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-2217 1125.57,-2217 1125.57,-2164 1331.57,-2164 1331.57,-2217"/>
<text text-anchor="middle" x="1228.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_2_ffn1 -->
<g id="edge882" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-2427.17C1121.34,-2420.26 1237.52,-2404.69 1267.57,-2370 1306.88,-2324.62 1295.71,-2290.4 1272.57,-2235 1271.12,-2231.52 1269.24,-2228.18 1267.08,-2225.01"/>
<polygon fill="black" stroke="black" points="1269.72,-2222.71 1260.79,-2217.01 1264.22,-2227.03 1269.72,-2222.71"/>
</g>
<!-- layer_14_expert_3_ffn1 -->
<g id="node614" class="node">
<title>layer_14_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-2217 1573.57,-2217 1573.57,-2164 1779.57,-2164 1779.57,-2217"/>
<text text-anchor="middle" x="1676.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_3_ffn1 -->
<g id="edge886" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-2427.82C1122.76,-2421.39 1253.8,-2406.14 1362.57,-2370 1484.83,-2329.38 1520.13,-2321.42 1624.57,-2246 1633.08,-2239.86 1641.36,-2232.21 1648.73,-2224.6"/>
<polygon fill="black" stroke="black" points="1651.49,-2226.77 1655.76,-2217.07 1646.38,-2221.99 1651.49,-2226.77"/>
</g>
<!-- layer_14_expert_4_ffn1 -->
<g id="node617" class="node">
<title>layer_14_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-2217 453.57,-2217 453.57,-2164 659.57,-2164 659.57,-2217"/>
<text text-anchor="middle" x="556.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_4_ffn1 -->
<g id="edge890" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-2406.89C801.11,-2375.58 686.43,-2317.79 603.57,-2246 596.29,-2239.69 589.13,-2232.24 582.68,-2224.9"/>
<polygon fill="black" stroke="black" points="585.14,-2222.39 575.99,-2217.05 579.81,-2226.93 585.14,-2222.39"/>
</g>
<!-- layer_14_expert_5_ffn1 -->
<g id="node620" class="node">
<title>layer_14_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-2217 1349.57,-2217 1349.57,-2164 1555.57,-2164 1555.57,-2217"/>
<text text-anchor="middle" x="1452.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_5_ffn1 -->
<g id="edge894" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-2426.77C1098.02,-2421.2 1181.84,-2410.3 1253.57,-2389 1272.44,-2383.4 1277.44,-2381.28 1293.57,-2370 1357.95,-2324.96 1370.85,-2307.64 1419.57,-2246 1424.54,-2239.72 1429.34,-2232.63 1433.66,-2225.69"/>
<polygon fill="black" stroke="black" points="1436.7,-2227.43 1438.87,-2217.05 1430.71,-2223.81 1436.7,-2227.43"/>
</g>
<!-- layer_14_expert_6_ffn1 -->
<g id="node623" class="node">
<title>layer_14_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-2217 1797.57,-2217 1797.57,-2164 2003.57,-2164 2003.57,-2217"/>
<text text-anchor="middle" x="1900.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_6_ffn1 -->
<g id="edge898" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-2430.36C1147.98,-2425.86 1336.72,-2412.05 1493.57,-2370 1625.52,-2334.63 1769.63,-2262.8 1845.97,-2221.86"/>
<polygon fill="black" stroke="black" points="1847.8,-2224.86 1854.94,-2217.03 1844.47,-2218.69 1847.8,-2224.86"/>
</g>
<!-- layer_14_expert_7_ffn1 -->
<g id="node626" class="node">
<title>layer_14_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-2217 901.57,-2217 901.57,-2164 1107.57,-2164 1107.57,-2217"/>
<text text-anchor="middle" x="1004.57" y="-2201.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-2186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-2171.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_expert_7_ffn1 -->
<g id="edge902" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-2406.92C903.08,-2396.14 895.6,-2383.08 891.57,-2370 873.88,-2312.62 852.23,-2284.25 886.57,-2235 889.58,-2230.69 893.06,-2226.8 896.91,-2223.3"/>
<polygon fill="black" stroke="black" points="899.11,-2226.02 904.71,-2217.03 894.73,-2220.56 899.11,-2226.02"/>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_0_ffn1 -->
<g id="edge873" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-2285.54C959.2,-2265.88 898.07,-2240.43 851.32,-2220.96"/>
<polygon fill="black" stroke="black" points="852.45,-2217.64 841.87,-2217.03 849.76,-2224.1 852.45,-2217.64"/>
<text text-anchor="middle" x="924.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_1_ffn1 -->
<g id="edge877" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-2299.72C833.08,-2282.17 630.07,-2252.21 445.54,-2217.14"/>
<polygon fill="black" stroke="black" points="446.13,-2213.69 435.65,-2215.25 444.82,-2220.56 446.13,-2213.69"/>
<text text-anchor="middle" x="623.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_2_ffn1 -->
<g id="edge881" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-2274.47C1129.09,-2261.16 1143.87,-2246.81 1158.57,-2235 1163.82,-2230.78 1169.5,-2226.65 1175.28,-2222.71"/>
<polygon fill="black" stroke="black" points="1177.37,-2225.52 1183.77,-2217.09 1173.5,-2219.68 1177.37,-2225.52"/>
<text text-anchor="middle" x="1180.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_3_ffn1 -->
<g id="edge885" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-2294.7C1263.24,-2278.33 1376.38,-2255.18 1475.57,-2235 1512.26,-2227.54 1523.52,-2225.73 1563.55,-2217.2"/>
<polygon fill="black" stroke="black" points="1564.41,-2220.59 1573.46,-2215.08 1562.94,-2213.75 1564.41,-2220.59"/>
<text text-anchor="middle" x="1497.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_4_ffn1 -->
<g id="edge889" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-2292.8C893.49,-2271.7 762.7,-2240.57 669.53,-2218.39"/>
<polygon fill="black" stroke="black" points="670.33,-2214.98 659.79,-2216.07 668.7,-2221.79 670.33,-2214.98"/>
<text text-anchor="middle" x="792.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_5_ffn1 -->
<g id="edge893" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-2285.6C1193.35,-2269.52 1244.3,-2250.05 1290.57,-2235 1306.78,-2229.73 1324.04,-2224.6 1341.02,-2219.81"/>
<polygon fill="black" stroke="black" points="1342.29,-2223.09 1350.98,-2217.04 1340.41,-2216.35 1342.29,-2223.09"/>
<text text-anchor="middle" x="1312.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_6_ffn1 -->
<g id="edge897" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-2301.57C1346.62,-2284.91 1578.71,-2255.07 1787.57,-2217.13"/>
<polygon fill="black" stroke="black" points="1788.29,-2220.55 1797.5,-2215.31 1787.04,-2213.67 1788.29,-2220.55"/>
<text text-anchor="middle" x="1694.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_14_gate&#45;&gt;layer_14_expert_7_ffn1 -->
<g id="edge901" class="edge">
<title>layer_14_gate&#45;&gt;layer_14_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-2271.76C1043.87,-2256.73 1033.9,-2240.18 1025.37,-2226.03"/>
<polygon fill="black" stroke="black" points="1028.16,-2223.88 1020,-2217.12 1022.17,-2227.49 1028.16,-2223.88"/>
<text text-anchor="middle" x="1056.57" y="-2238" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_14_expert_0_gelu -->
<g id="node606" class="node">
<title>layer_14_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-2127 677.57,-2127 677.57,-2074 883.57,-2074 883.57,-2127"/>
<text text-anchor="middle" x="780.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_0_ffn1&#45;&gt;layer_14_expert_0_gelu -->
<g id="edge875" class="edge">
<title>layer_14_expert_0_ffn1&#45;&gt;layer_14_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-2163.57C780.57,-2155.34 780.57,-2146.08 780.57,-2137.28"/>
<polygon fill="black" stroke="black" points="784.07,-2137.24 780.57,-2127.24 777.07,-2137.24 784.07,-2137.24"/>
</g>
<!-- layer_14_expert_0_ffn2 -->
<g id="node607" class="node">
<title>layer_14_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-2037 677.57,-2037 677.57,-1984 883.57,-1984 883.57,-2037"/>
<text text-anchor="middle" x="780.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_0_gelu&#45;&gt;layer_14_expert_0_ffn2 -->
<g id="edge876" class="edge">
<title>layer_14_expert_0_gelu&#45;&gt;layer_14_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-2073.57C780.57,-2065.34 780.57,-2056.08 780.57,-2047.28"/>
<polygon fill="black" stroke="black" points="784.07,-2047.24 780.57,-2037.24 777.07,-2047.24 784.07,-2047.24"/>
</g>
<!-- layer_14_expert_agg -->
<g id="node629" class="node">
<title>layer_14_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-1947 878.36,-1947 790.93,-1841 1130.79,-1841 1218.21,-1947"/>
<text text-anchor="middle" x="1004.57" y="-1905.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-1890.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-1875.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_0_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge905" class="edge">
<title>layer_14_expert_0_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-1983.95C849.26,-1974.39 871.33,-1963.11 893.35,-1951.85"/>
<polygon fill="black" stroke="black" points="895.14,-1954.87 902.45,-1947.2 891.95,-1948.64 895.14,-1954.87"/>
</g>
<!-- layer_14_expert_1_gelu -->
<g id="node609" class="node">
<title>layer_14_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-2127 229.57,-2127 229.57,-2074 435.57,-2074 435.57,-2127"/>
<text text-anchor="middle" x="332.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_1_ffn1&#45;&gt;layer_14_expert_1_gelu -->
<g id="edge879" class="edge">
<title>layer_14_expert_1_ffn1&#45;&gt;layer_14_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-2163.57C332.57,-2155.34 332.57,-2146.08 332.57,-2137.28"/>
<polygon fill="black" stroke="black" points="336.07,-2137.24 332.57,-2127.24 329.07,-2137.24 336.07,-2137.24"/>
</g>
<!-- layer_14_expert_1_ffn2 -->
<g id="node610" class="node">
<title>layer_14_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-2037 229.57,-2037 229.57,-1984 435.57,-1984 435.57,-2037"/>
<text text-anchor="middle" x="332.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_1_gelu&#45;&gt;layer_14_expert_1_ffn2 -->
<g id="edge880" class="edge">
<title>layer_14_expert_1_gelu&#45;&gt;layer_14_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-2073.57C332.57,-2065.34 332.57,-2056.08 332.57,-2047.28"/>
<polygon fill="black" stroke="black" points="336.07,-2047.24 332.57,-2037.24 329.07,-2047.24 336.07,-2047.24"/>
</g>
<!-- layer_14_expert_1_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge906" class="edge">
<title>layer_14_expert_1_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-1985.76C438.66,-1985.16 441.63,-1984.57 444.57,-1984 578.16,-1958.21 730.72,-1934.32 842.83,-1917.81"/>
<polygon fill="black" stroke="black" points="843.49,-1921.25 852.87,-1916.33 842.47,-1914.32 843.49,-1921.25"/>
</g>
<!-- layer_14_expert_2_gelu -->
<g id="node612" class="node">
<title>layer_14_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-2127 1125.57,-2127 1125.57,-2074 1331.57,-2074 1331.57,-2127"/>
<text text-anchor="middle" x="1228.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_2_ffn1&#45;&gt;layer_14_expert_2_gelu -->
<g id="edge883" class="edge">
<title>layer_14_expert_2_ffn1&#45;&gt;layer_14_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-2163.57C1228.57,-2155.34 1228.57,-2146.08 1228.57,-2137.28"/>
<polygon fill="black" stroke="black" points="1232.07,-2137.24 1228.57,-2127.24 1225.07,-2137.24 1232.07,-2137.24"/>
</g>
<!-- layer_14_expert_2_ffn2 -->
<g id="node613" class="node">
<title>layer_14_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-2037 1125.57,-2037 1125.57,-1984 1331.57,-1984 1331.57,-2037"/>
<text text-anchor="middle" x="1228.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_2_gelu&#45;&gt;layer_14_expert_2_ffn2 -->
<g id="edge884" class="edge">
<title>layer_14_expert_2_gelu&#45;&gt;layer_14_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-2073.57C1228.57,-2065.34 1228.57,-2056.08 1228.57,-2047.28"/>
<polygon fill="black" stroke="black" points="1232.07,-2047.24 1228.57,-2037.24 1225.07,-2047.24 1232.07,-2047.24"/>
</g>
<!-- layer_14_expert_2_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge907" class="edge">
<title>layer_14_expert_2_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-1983.95C1159.88,-1974.39 1137.81,-1963.11 1115.79,-1951.85"/>
<polygon fill="black" stroke="black" points="1117.19,-1948.64 1106.7,-1947.2 1114.01,-1954.87 1117.19,-1948.64"/>
</g>
<!-- layer_14_expert_3_gelu -->
<g id="node615" class="node">
<title>layer_14_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-2127 1573.57,-2127 1573.57,-2074 1779.57,-2074 1779.57,-2127"/>
<text text-anchor="middle" x="1676.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_3_ffn1&#45;&gt;layer_14_expert_3_gelu -->
<g id="edge887" class="edge">
<title>layer_14_expert_3_ffn1&#45;&gt;layer_14_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-2163.57C1676.57,-2155.34 1676.57,-2146.08 1676.57,-2137.28"/>
<polygon fill="black" stroke="black" points="1680.07,-2137.24 1676.57,-2127.24 1673.07,-2137.24 1680.07,-2137.24"/>
</g>
<!-- layer_14_expert_3_ffn2 -->
<g id="node616" class="node">
<title>layer_14_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-2037 1573.57,-2037 1573.57,-1984 1779.57,-1984 1779.57,-2037"/>
<text text-anchor="middle" x="1676.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_3_gelu&#45;&gt;layer_14_expert_3_ffn2 -->
<g id="edge888" class="edge">
<title>layer_14_expert_3_gelu&#45;&gt;layer_14_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-2073.57C1676.57,-2065.34 1676.57,-2056.08 1676.57,-2047.28"/>
<polygon fill="black" stroke="black" points="1680.07,-2047.24 1676.57,-2037.24 1673.07,-2047.24 1680.07,-2047.24"/>
</g>
<!-- layer_14_expert_3_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge908" class="edge">
<title>layer_14_expert_3_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-1985.76C1570.49,-1985.16 1567.51,-1984.57 1564.57,-1984 1446.94,-1961.29 1314.59,-1940.06 1208.1,-1924.03"/>
<polygon fill="black" stroke="black" points="1208.61,-1920.57 1198.21,-1922.54 1207.58,-1927.49 1208.61,-1920.57"/>
</g>
<!-- layer_14_expert_4_gelu -->
<g id="node618" class="node">
<title>layer_14_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-2127 453.57,-2127 453.57,-2074 659.57,-2074 659.57,-2127"/>
<text text-anchor="middle" x="556.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_4_ffn1&#45;&gt;layer_14_expert_4_gelu -->
<g id="edge891" class="edge">
<title>layer_14_expert_4_ffn1&#45;&gt;layer_14_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-2163.57C556.57,-2155.34 556.57,-2146.08 556.57,-2137.28"/>
<polygon fill="black" stroke="black" points="560.07,-2137.24 556.57,-2127.24 553.07,-2137.24 560.07,-2137.24"/>
</g>
<!-- layer_14_expert_4_ffn2 -->
<g id="node619" class="node">
<title>layer_14_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-2037 453.57,-2037 453.57,-1984 659.57,-1984 659.57,-2037"/>
<text text-anchor="middle" x="556.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_4_gelu&#45;&gt;layer_14_expert_4_ffn2 -->
<g id="edge892" class="edge">
<title>layer_14_expert_4_gelu&#45;&gt;layer_14_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-2073.57C556.57,-2065.34 556.57,-2056.08 556.57,-2047.28"/>
<polygon fill="black" stroke="black" points="560.07,-2047.24 556.57,-2037.24 553.07,-2047.24 560.07,-2047.24"/>
</g>
<!-- layer_14_expert_4_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge909" class="edge">
<title>layer_14_expert_4_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-1983.95C714.81,-1969.06 789.41,-1949.99 854.59,-1933.33"/>
<polygon fill="black" stroke="black" points="855.73,-1936.65 864.55,-1930.79 853.99,-1929.87 855.73,-1936.65"/>
</g>
<!-- layer_14_expert_5_gelu -->
<g id="node621" class="node">
<title>layer_14_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-2127 1349.57,-2127 1349.57,-2074 1555.57,-2074 1555.57,-2127"/>
<text text-anchor="middle" x="1452.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_5_ffn1&#45;&gt;layer_14_expert_5_gelu -->
<g id="edge895" class="edge">
<title>layer_14_expert_5_ffn1&#45;&gt;layer_14_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-2163.57C1452.57,-2155.34 1452.57,-2146.08 1452.57,-2137.28"/>
<polygon fill="black" stroke="black" points="1456.07,-2137.24 1452.57,-2127.24 1449.07,-2137.24 1456.07,-2137.24"/>
</g>
<!-- layer_14_expert_5_ffn2 -->
<g id="node622" class="node">
<title>layer_14_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-2037 1349.57,-2037 1349.57,-1984 1555.57,-1984 1555.57,-2037"/>
<text text-anchor="middle" x="1452.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_5_gelu&#45;&gt;layer_14_expert_5_ffn2 -->
<g id="edge896" class="edge">
<title>layer_14_expert_5_gelu&#45;&gt;layer_14_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-2073.57C1452.57,-2065.34 1452.57,-2056.08 1452.57,-2047.28"/>
<polygon fill="black" stroke="black" points="1456.07,-2047.24 1452.57,-2037.24 1449.07,-2047.24 1456.07,-2047.24"/>
</g>
<!-- layer_14_expert_5_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge910" class="edge">
<title>layer_14_expert_5_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-1983.95C1312.66,-1973.74 1265.05,-1961.57 1218.07,-1949.57"/>
<polygon fill="black" stroke="black" points="1218.92,-1946.17 1208.37,-1947.09 1217.19,-1952.95 1218.92,-1946.17"/>
</g>
<!-- layer_14_expert_6_gelu -->
<g id="node624" class="node">
<title>layer_14_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-2127 1797.57,-2127 1797.57,-2074 2003.57,-2074 2003.57,-2127"/>
<text text-anchor="middle" x="1900.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_6_ffn1&#45;&gt;layer_14_expert_6_gelu -->
<g id="edge899" class="edge">
<title>layer_14_expert_6_ffn1&#45;&gt;layer_14_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-2163.57C1900.57,-2155.34 1900.57,-2146.08 1900.57,-2137.28"/>
<polygon fill="black" stroke="black" points="1904.07,-2137.24 1900.57,-2127.24 1897.07,-2137.24 1904.07,-2137.24"/>
</g>
<!-- layer_14_expert_6_ffn2 -->
<g id="node625" class="node">
<title>layer_14_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-2037 1797.57,-2037 1797.57,-1984 2003.57,-1984 2003.57,-2037"/>
<text text-anchor="middle" x="1900.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_6_gelu&#45;&gt;layer_14_expert_6_ffn2 -->
<g id="edge900" class="edge">
<title>layer_14_expert_6_gelu&#45;&gt;layer_14_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-2073.57C1900.57,-2065.34 1900.57,-2056.08 1900.57,-2047.28"/>
<polygon fill="black" stroke="black" points="1904.07,-2047.24 1900.57,-2037.24 1897.07,-2047.24 1904.07,-2047.24"/>
</g>
<!-- layer_14_expert_6_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge911" class="edge">
<title>layer_14_expert_6_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-1985.59C1794.51,-1985.03 1791.52,-1984.5 1788.57,-1984 1588.54,-1949.98 1357.51,-1925.53 1198.33,-1910.97"/>
<polygon fill="black" stroke="black" points="1198.23,-1907.45 1187.95,-1910.03 1197.59,-1914.42 1198.23,-1907.45"/>
</g>
<!-- layer_14_expert_7_gelu -->
<g id="node627" class="node">
<title>layer_14_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-2127 901.57,-2127 901.57,-2074 1107.57,-2074 1107.57,-2127"/>
<text text-anchor="middle" x="1004.57" y="-2111.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-2096.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-2081.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_7_ffn1&#45;&gt;layer_14_expert_7_gelu -->
<g id="edge903" class="edge">
<title>layer_14_expert_7_ffn1&#45;&gt;layer_14_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-2163.57C1004.57,-2155.34 1004.57,-2146.08 1004.57,-2137.28"/>
<polygon fill="black" stroke="black" points="1008.07,-2137.24 1004.57,-2127.24 1001.07,-2137.24 1008.07,-2137.24"/>
</g>
<!-- layer_14_expert_7_ffn2 -->
<g id="node628" class="node">
<title>layer_14_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-2037 901.57,-2037 901.57,-1984 1107.57,-1984 1107.57,-2037"/>
<text text-anchor="middle" x="1004.57" y="-2021.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-2006.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-1991.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_expert_7_gelu&#45;&gt;layer_14_expert_7_ffn2 -->
<g id="edge904" class="edge">
<title>layer_14_expert_7_gelu&#45;&gt;layer_14_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-2073.57C1004.57,-2065.34 1004.57,-2056.08 1004.57,-2047.28"/>
<polygon fill="black" stroke="black" points="1008.07,-2047.24 1004.57,-2037.24 1001.07,-2047.24 1008.07,-2047.24"/>
</g>
<!-- layer_14_expert_7_ffn2&#45;&gt;layer_14_expert_agg -->
<g id="edge912" class="edge">
<title>layer_14_expert_7_ffn2&#45;&gt;layer_14_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-1983.8C1004.57,-1975.86 1004.57,-1966.74 1004.57,-1957.44"/>
<polygon fill="black" stroke="black" points="1008.07,-1957.32 1004.57,-1947.32 1001.07,-1957.32 1008.07,-1957.32"/>
</g>
<!-- layer_14_expert_agg&#45;&gt;layer_14_add -->
<g id="edge914" class="edge">
<title>layer_14_expert_agg&#45;&gt;layer_14_add</title>
<path fill="none" stroke="black" d="M810.56,-1864.92C658.7,-1842.93 452.76,-1813.12 326.73,-1794.88"/>
<polygon fill="black" stroke="black" points="327.07,-1791.39 316.67,-1793.42 326.07,-1798.32 327.07,-1791.39"/>
</g>
<!-- comm_14_15 -->
<g id="node631" class="node">
<title>comm_14_15</title>
<polygon fill="yellow" stroke="black" points="427.21,-1714 87.36,-1714 -0.07,-1608 339.79,-1608 427.21,-1714"/>
<text text-anchor="middle" x="213.57" y="-1672.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="213.57" y="-1657.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-1642.3" font-family="Times,serif" font-size="14.00">GPU 14  GPU 15</text>
</g>
<!-- layer_14_add&#45;&gt;comm_14_15 -->
<g id="edge915" class="edge">
<title>layer_14_add&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M213.57,-1750.8C213.57,-1742.86 213.57,-1733.74 213.57,-1724.44"/>
<polygon fill="black" stroke="black" points="217.07,-1724.32 213.57,-1714.32 210.07,-1724.32 217.07,-1724.32"/>
</g>
<!-- layer_15_ln1 -->
<g id="node632" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightcoral" stroke="black" points="497.57,-1571 291.57,-1571 291.57,-1518 497.57,-1518 497.57,-1571"/>
<text text-anchor="middle" x="394.57" y="-1555.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="394.57" y="-1540.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="394.57" y="-1525.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- comm_14_15&#45;&gt;layer_15_ln1 -->
<g id="edge916" class="edge">
<title>comm_14_15&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M295.86,-1607.94C312.72,-1597.28 329.97,-1586.37 345.23,-1576.71"/>
<polygon fill="black" stroke="black" points="347.39,-1579.49 353.97,-1571.18 343.65,-1573.57 347.39,-1579.49"/>
</g>
<!-- layer_15_add1 -->
<g id="node644" class="node">
<title>layer_15_add1</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-799 110.57,-799 110.57,-746 316.57,-746 316.57,-799"/>
<text text-anchor="middle" x="213.57" y="-783.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="213.57" y="-768.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-753.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- comm_14_15&#45;&gt;layer_15_add1 -->
<g id="edge930" class="edge">
<title>comm_14_15&#45;&gt;layer_15_add1</title>
<path fill="none" stroke="black" d="M205.8,-1607.97C203.49,-1588.42 201.57,-1565.99 201.57,-1545.5 201.57,-1545.5 201.57,-1545.5 201.57,-861.5 201.57,-844.17 203.88,-825.1 206.48,-809.15"/>
<polygon fill="black" stroke="black" points="209.95,-809.62 208.2,-799.17 203.05,-808.43 209.95,-809.62"/>
</g>
<!-- layer_15_q_proj -->
<g id="node633" class="node">
<title>layer_15_q_proj</title>
<polygon fill="lightblue" stroke="black" points="659.57,-1481 453.57,-1481 453.57,-1428 659.57,-1428 659.57,-1481"/>
<text text-anchor="middle" x="556.57" y="-1465.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="556.57" y="-1450.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-1435.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_q_proj -->
<g id="edge917" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_q_proj</title>
<path fill="none" stroke="black" d="M441.86,-1517.81C460.25,-1507.82 481.45,-1496.31 500.58,-1485.91"/>
<polygon fill="black" stroke="black" points="502.38,-1488.92 509.5,-1481.07 499.04,-1482.77 502.38,-1488.92"/>
</g>
<!-- layer_15_k_proj -->
<g id="node634" class="node">
<title>layer_15_k_proj</title>
<polygon fill="lightblue" stroke="black" points="883.57,-1481 677.57,-1481 677.57,-1428 883.57,-1428 883.57,-1481"/>
<text text-anchor="middle" x="780.57" y="-1465.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="780.57" y="-1450.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-1435.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_k_proj -->
<g id="edge918" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_k_proj</title>
<path fill="none" stroke="black" d="M497.76,-1519.98C550.11,-1508.04 613.8,-1493.52 667.48,-1481.28"/>
<polygon fill="black" stroke="black" points="668.41,-1484.66 677.38,-1479.02 666.86,-1477.83 668.41,-1484.66"/>
</g>
<!-- layer_15_v_proj -->
<g id="node635" class="node">
<title>layer_15_v_proj</title>
<polygon fill="lightblue" stroke="black" points="435.57,-1481 229.57,-1481 229.57,-1428 435.57,-1428 435.57,-1481"/>
<text text-anchor="middle" x="332.57" y="-1465.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="332.57" y="-1450.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-1435.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_v_proj -->
<g id="edge919" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_v_proj</title>
<path fill="none" stroke="black" d="M376.3,-1517.57C370.12,-1508.8 363.13,-1498.87 356.57,-1489.56"/>
<polygon fill="black" stroke="black" points="359.33,-1487.4 350.71,-1481.24 353.61,-1491.43 359.33,-1487.4"/>
</g>
<!-- layer_15_q_reshape -->
<g id="node636" class="node">
<title>layer_15_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="650.57,-1391 426.57,-1391 426.57,-1338 650.57,-1338 650.57,-1391"/>
<text text-anchor="middle" x="538.57" y="-1375.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="538.57" y="-1360.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538.57" y="-1345.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_q_proj&#45;&gt;layer_15_q_reshape -->
<g id="edge920" class="edge">
<title>layer_15_q_proj&#45;&gt;layer_15_q_reshape</title>
<path fill="none" stroke="black" d="M551.27,-1427.57C549.58,-1419.34 547.69,-1410.08 545.89,-1401.28"/>
<polygon fill="black" stroke="black" points="549.27,-1400.34 543.84,-1391.24 542.41,-1401.74 549.27,-1400.34"/>
</g>
<!-- layer_15_k_reshape -->
<g id="node637" class="node">
<title>layer_15_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="892.57,-1391 668.57,-1391 668.57,-1338 892.57,-1338 892.57,-1391"/>
<text text-anchor="middle" x="780.57" y="-1375.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="780.57" y="-1360.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="780.57" y="-1345.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_k_proj&#45;&gt;layer_15_k_reshape -->
<g id="edge921" class="edge">
<title>layer_15_k_proj&#45;&gt;layer_15_k_reshape</title>
<path fill="none" stroke="black" d="M780.57,-1427.57C780.57,-1419.34 780.57,-1410.08 780.57,-1401.28"/>
<polygon fill="black" stroke="black" points="784.07,-1401.24 780.57,-1391.24 777.07,-1401.24 784.07,-1401.24"/>
</g>
<!-- layer_15_v_reshape -->
<g id="node638" class="node">
<title>layer_15_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="449.57,-1320 225.57,-1320 225.57,-1267 449.57,-1267 449.57,-1320"/>
<text text-anchor="middle" x="337.57" y="-1304.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="337.57" y="-1289.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="337.57" y="-1274.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_v_proj&#45;&gt;layer_15_v_reshape -->
<g id="edge922" class="edge">
<title>layer_15_v_proj&#45;&gt;layer_15_v_reshape</title>
<path fill="none" stroke="black" d="M333.37,-1427.95C334.2,-1401.61 335.5,-1360.29 336.44,-1330.61"/>
<polygon fill="black" stroke="black" points="339.95,-1330.35 336.76,-1320.25 332.95,-1330.13 339.95,-1330.35"/>
</g>
<!-- layer_15_attn_scores -->
<g id="node639" class="node">
<title>layer_15_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="655.07,-1249 422.07,-1249 422.07,-1196 655.07,-1196 655.07,-1249"/>
<text text-anchor="middle" x="538.57" y="-1233.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="538.57" y="-1218.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="538.57" y="-1203.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_q_reshape&#45;&gt;layer_15_attn_scores -->
<g id="edge923" class="edge">
<title>layer_15_q_reshape&#45;&gt;layer_15_attn_scores</title>
<path fill="none" stroke="black" d="M538.57,-1337.82C538.57,-1315.72 538.57,-1283.6 538.57,-1259.03"/>
<polygon fill="black" stroke="black" points="542.07,-1259.02 538.57,-1249.02 535.07,-1259.02 542.07,-1259.02"/>
</g>
<!-- layer_15_k_reshape&#45;&gt;layer_15_attn_scores -->
<g id="edge924" class="edge">
<title>layer_15_k_reshape&#45;&gt;layer_15_attn_scores</title>
<path fill="none" stroke="black" d="M736.47,-1337.98C695.65,-1314.37 634.91,-1279.23 591.5,-1254.12"/>
<polygon fill="black" stroke="black" points="593.19,-1251.05 582.78,-1249.08 589.68,-1257.11 593.19,-1251.05"/>
</g>
<!-- layer_15_attn_output -->
<g id="node641" class="node">
<title>layer_15_attn_output</title>
<polygon fill="lightblue" stroke="black" points="453.57,-1069 229.57,-1069 229.57,-1016 453.57,-1016 453.57,-1069"/>
<text text-anchor="middle" x="341.57" y="-1053.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="341.57" y="-1038.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="341.57" y="-1023.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_v_reshape&#45;&gt;layer_15_attn_output -->
<g id="edge927" class="edge">
<title>layer_15_v_reshape&#45;&gt;layer_15_attn_output</title>
<path fill="none" stroke="black" d="M337.98,-1266.79C338.7,-1222.13 340.18,-1130.13 341,-1079.27"/>
<polygon fill="black" stroke="black" points="344.5,-1079.12 341.16,-1069.07 337.5,-1079.01 344.5,-1079.12"/>
</g>
<!-- layer_15_attn_weights -->
<g id="node640" class="node">
<title>layer_15_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="627.07,-1159 394.07,-1159 394.07,-1106 627.07,-1106 627.07,-1159"/>
<text text-anchor="middle" x="510.57" y="-1143.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="510.57" y="-1128.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="510.57" y="-1113.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_scores&#45;&gt;layer_15_attn_weights -->
<g id="edge925" class="edge">
<title>layer_15_attn_scores&#45;&gt;layer_15_attn_weights</title>
<path fill="none" stroke="black" d="M530.32,-1195.57C527.67,-1187.25 524.69,-1177.88 521.86,-1168.99"/>
<polygon fill="black" stroke="black" points="525.13,-1167.71 518.76,-1159.24 518.46,-1169.83 525.13,-1167.71"/>
</g>
<!-- layer_15_attn_weights&#45;&gt;layer_15_attn_output -->
<g id="edge926" class="edge">
<title>layer_15_attn_weights&#45;&gt;layer_15_attn_output</title>
<path fill="none" stroke="black" d="M461.24,-1105.81C441.97,-1095.78 419.74,-1084.2 399.71,-1073.77"/>
<polygon fill="black" stroke="black" points="401.16,-1070.58 390.68,-1069.07 397.93,-1076.79 401.16,-1070.58"/>
</g>
<!-- layer_15_attn_reshape -->
<g id="node642" class="node">
<title>layer_15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="442.57,-979 236.57,-979 236.57,-926 442.57,-926 442.57,-979"/>
<text text-anchor="middle" x="339.57" y="-963.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="339.57" y="-948.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="339.57" y="-933.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_output&#45;&gt;layer_15_attn_reshape -->
<g id="edge928" class="edge">
<title>layer_15_attn_output&#45;&gt;layer_15_attn_reshape</title>
<path fill="none" stroke="black" d="M340.98,-1015.57C340.79,-1007.34 340.58,-998.08 340.38,-989.28"/>
<polygon fill="black" stroke="black" points="343.88,-989.16 340.16,-979.24 336.88,-989.32 343.88,-989.16"/>
</g>
<!-- layer_15_attn_proj -->
<g id="node643" class="node">
<title>layer_15_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="439.57,-889 233.57,-889 233.57,-836 439.57,-836 439.57,-889"/>
<text text-anchor="middle" x="336.57" y="-873.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="336.57" y="-858.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="336.57" y="-843.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_reshape&#45;&gt;layer_15_attn_proj -->
<g id="edge929" class="edge">
<title>layer_15_attn_reshape&#45;&gt;layer_15_attn_proj</title>
<path fill="none" stroke="black" d="M338.69,-925.57C338.41,-917.34 338.09,-908.08 337.79,-899.28"/>
<polygon fill="black" stroke="black" points="341.29,-899.12 337.45,-889.24 334.29,-899.36 341.29,-899.12"/>
</g>
<!-- layer_15_attn_proj&#45;&gt;layer_15_add1 -->
<g id="edge931" class="edge">
<title>layer_15_attn_proj&#45;&gt;layer_15_add1</title>
<path fill="none" stroke="black" d="M300.66,-835.81C287.15,-826.14 271.63,-815.04 257.47,-804.9"/>
<polygon fill="black" stroke="black" points="259.48,-802.04 249.31,-799.07 255.41,-807.73 259.48,-802.04"/>
</g>
<!-- layer_15_ln2 -->
<g id="node645" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1033.57,-709 827.57,-709 827.57,-656 1033.57,-656 1033.57,-709"/>
<text text-anchor="middle" x="930.57" y="-693.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="930.57" y="-678.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="930.57" y="-663.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_add1&#45;&gt;layer_15_ln2 -->
<g id="edge932" class="edge">
<title>layer_15_add1&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M316.68,-758.84C449.47,-742.55 679.5,-714.31 817.13,-697.42"/>
<polygon fill="black" stroke="black" points="817.78,-700.87 827.28,-696.18 816.93,-693.92 817.78,-700.87"/>
</g>
<!-- layer_15_add -->
<g id="node672" class="node">
<title>layer_15_add</title>
<polygon fill="lightgreen" stroke="black" points="316.57,-53 110.57,-53 110.57,0 316.57,0 316.57,-53"/>
<text text-anchor="middle" x="213.57" y="-37.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="213.57" y="-22.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="213.57" y="-7.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_add1&#45;&gt;layer_15_add -->
<g id="edge974" class="edge">
<title>layer_15_add1&#45;&gt;layer_15_add</title>
<path fill="none" stroke="black" d="M208.2,-745.83C205.01,-728.34 201.57,-704.62 201.57,-683.5 201.57,-683.5 201.57,-683.5 201.57,-142 201.57,-115.6 204.77,-85.96 207.86,-63.46"/>
<polygon fill="black" stroke="black" points="211.35,-63.73 209.31,-53.34 204.42,-62.74 211.35,-63.73"/>
</g>
<!-- layer_15_gate -->
<g id="node646" class="node">
<title>layer_15_gate</title>
<polygon fill="orange" stroke="black" points="1079.57,-619 900.57,-566 1079.57,-513 1258.57,-566 1079.57,-619"/>
<text text-anchor="middle" x="1079.57" y="-577.3" font-family="Times,serif" font-size="14.00">MoE Gate</text>
<text text-anchor="middle" x="1079.57" y="-562.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8]</text>
<text text-anchor="middle" x="1079.57" y="-547.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_gate -->
<g id="edge933" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_gate</title>
<path fill="none" stroke="black" d="M964.01,-655.8C981.28,-642.53 1002.83,-625.97 1022.63,-610.76"/>
<polygon fill="black" stroke="black" points="1024.9,-613.43 1030.69,-604.56 1020.63,-607.88 1024.9,-613.43"/>
</g>
<!-- layer_15_expert_0_ffn1 -->
<g id="node647" class="node">
<title>layer_15_expert_0_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-466 677.57,-466 677.57,-413 883.57,-413 883.57,-466"/>
<text text-anchor="middle" x="780.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 1</text>
<text text-anchor="middle" x="780.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_0_ffn1 -->
<g id="edge935" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_0_ffn1</title>
<path fill="none" stroke="black" d="M899.22,-655.95C887.23,-645.28 873.96,-632.28 863.57,-619 824.71,-569.33 817.94,-553.58 794.57,-495 792.17,-488.99 790.08,-482.43 788.29,-476.02"/>
<polygon fill="black" stroke="black" points="791.63,-474.97 785.73,-466.17 784.85,-476.72 791.63,-474.97"/>
</g>
<!-- layer_15_expert_1_ffn1 -->
<g id="node650" class="node">
<title>layer_15_expert_1_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-466 229.57,-466 229.57,-413 435.57,-413 435.57,-466"/>
<text text-anchor="middle" x="332.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 1</text>
<text text-anchor="middle" x="332.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_1_ffn1 -->
<g id="edge939" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_1_ffn1</title>
<path fill="none" stroke="black" d="M827.42,-669.27C767.36,-659.96 691.02,-644.31 626.57,-619 529.83,-581.01 428.72,-512.16 373.91,-471.98"/>
<polygon fill="black" stroke="black" points="375.97,-469.14 365.84,-466.02 371.81,-474.78 375.97,-469.14"/>
</g>
<!-- layer_15_expert_2_ffn1 -->
<g id="node653" class="node">
<title>layer_15_expert_2_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-466 1125.57,-466 1125.57,-413 1331.57,-413 1331.57,-466"/>
<text text-anchor="middle" x="1228.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 1</text>
<text text-anchor="middle" x="1228.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_2_ffn1 -->
<g id="edge943" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_2_ffn1</title>
<path fill="none" stroke="black" d="M1033.72,-676.17C1121.34,-669.26 1237.52,-653.69 1267.57,-619 1306.88,-573.62 1295.71,-539.4 1272.57,-484 1271.12,-480.52 1269.24,-477.18 1267.08,-474.01"/>
<polygon fill="black" stroke="black" points="1269.72,-471.71 1260.79,-466.01 1264.22,-476.03 1269.72,-471.71"/>
</g>
<!-- layer_15_expert_3_ffn1 -->
<g id="node656" class="node">
<title>layer_15_expert_3_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-466 1573.57,-466 1573.57,-413 1779.57,-413 1779.57,-466"/>
<text text-anchor="middle" x="1676.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 1</text>
<text text-anchor="middle" x="1676.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_3_ffn1 -->
<g id="edge947" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_3_ffn1</title>
<path fill="none" stroke="black" d="M1033.73,-676.82C1122.76,-670.39 1253.8,-655.14 1362.57,-619 1484.83,-578.38 1520.13,-570.42 1624.57,-495 1633.08,-488.86 1641.36,-481.21 1648.73,-473.6"/>
<polygon fill="black" stroke="black" points="1651.49,-475.77 1655.76,-466.07 1646.38,-470.99 1651.49,-475.77"/>
</g>
<!-- layer_15_expert_4_ffn1 -->
<g id="node659" class="node">
<title>layer_15_expert_4_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-466 453.57,-466 453.57,-413 659.57,-413 659.57,-466"/>
<text text-anchor="middle" x="556.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 1</text>
<text text-anchor="middle" x="556.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_4_ffn1 -->
<g id="edge951" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_4_ffn1</title>
<path fill="none" stroke="black" d="M870.32,-655.89C801.11,-624.58 686.43,-566.79 603.57,-495 596.29,-488.69 589.13,-481.24 582.68,-473.9"/>
<polygon fill="black" stroke="black" points="585.14,-471.39 575.99,-466.05 579.81,-475.93 585.14,-471.39"/>
</g>
<!-- layer_15_expert_5_ffn1 -->
<g id="node662" class="node">
<title>layer_15_expert_5_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-466 1349.57,-466 1349.57,-413 1555.57,-413 1555.57,-466"/>
<text text-anchor="middle" x="1452.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 1</text>
<text text-anchor="middle" x="1452.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_5_ffn1 -->
<g id="edge955" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_5_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-675.77C1098.02,-670.2 1181.84,-659.3 1253.57,-638 1272.44,-632.4 1277.44,-630.28 1293.57,-619 1357.95,-573.96 1370.85,-556.64 1419.57,-495 1424.54,-488.72 1429.34,-481.63 1433.66,-474.69"/>
<polygon fill="black" stroke="black" points="1436.7,-476.43 1438.87,-466.05 1430.71,-472.81 1436.7,-476.43"/>
</g>
<!-- layer_15_expert_6_ffn1 -->
<g id="node665" class="node">
<title>layer_15_expert_6_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-466 1797.57,-466 1797.57,-413 2003.57,-413 2003.57,-466"/>
<text text-anchor="middle" x="1900.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 1</text>
<text text-anchor="middle" x="1900.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_6_ffn1 -->
<g id="edge959" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_6_ffn1</title>
<path fill="none" stroke="black" d="M1033.74,-679.36C1147.98,-674.86 1336.72,-661.05 1493.57,-619 1625.52,-583.63 1769.63,-511.8 1845.97,-470.86"/>
<polygon fill="black" stroke="black" points="1847.8,-473.86 1854.94,-466.03 1844.47,-467.69 1847.8,-473.86"/>
</g>
<!-- layer_15_expert_7_ffn1 -->
<g id="node668" class="node">
<title>layer_15_expert_7_ffn1</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-466 901.57,-466 901.57,-413 1107.57,-413 1107.57,-466"/>
<text text-anchor="middle" x="1004.57" y="-450.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 1</text>
<text text-anchor="middle" x="1004.57" y="-435.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-420.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_expert_7_ffn1 -->
<g id="edge963" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_expert_7_ffn1</title>
<path fill="none" stroke="black" d="M910.41,-655.92C903.08,-645.14 895.6,-632.08 891.57,-619 873.88,-561.62 852.23,-533.25 886.57,-484 889.58,-479.69 893.06,-475.8 896.91,-472.3"/>
<polygon fill="black" stroke="black" points="899.11,-475.02 904.71,-466.03 894.73,-469.56 899.11,-475.02"/>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_0_ffn1 -->
<g id="edge934" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_0_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1006.43,-534.54C959.2,-514.88 898.07,-489.43 851.32,-469.96"/>
<polygon fill="black" stroke="black" points="852.45,-466.64 841.87,-466.03 849.76,-473.1 852.45,-466.64"/>
<text text-anchor="middle" x="924.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 0</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_1_ffn1 -->
<g id="edge938" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_1_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M958.88,-548.72C833.08,-531.17 630.07,-501.21 445.54,-466.14"/>
<polygon fill="black" stroke="black" points="446.13,-462.69 435.65,-464.25 444.82,-469.56 446.13,-462.69"/>
<text text-anchor="middle" x="623.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 1</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_2_ffn1 -->
<g id="edge942" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_2_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1116.35,-523.47C1129.09,-510.16 1143.87,-495.81 1158.57,-484 1163.82,-479.78 1169.5,-475.65 1175.28,-471.71"/>
<polygon fill="black" stroke="black" points="1177.37,-474.52 1183.77,-466.09 1173.5,-468.68 1177.37,-474.52"/>
<text text-anchor="middle" x="1180.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 2</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_3_ffn1 -->
<g id="edge946" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_3_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1183.36,-543.7C1263.24,-527.33 1376.38,-504.18 1475.57,-484 1512.26,-476.54 1523.52,-474.73 1563.55,-466.2"/>
<polygon fill="black" stroke="black" points="1564.41,-469.59 1573.46,-464.08 1562.94,-462.75 1564.41,-469.59"/>
<text text-anchor="middle" x="1497.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 3</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_4_ffn1 -->
<g id="edge950" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_4_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M982.12,-541.8C893.49,-520.7 762.7,-489.57 669.53,-467.39"/>
<polygon fill="black" stroke="black" points="670.33,-463.98 659.79,-465.07 668.7,-470.79 670.33,-463.98"/>
<text text-anchor="middle" x="792.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 4</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_5_ffn1 -->
<g id="edge954" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_5_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1153.11,-534.6C1193.35,-518.52 1244.3,-499.05 1290.57,-484 1306.78,-478.73 1324.04,-473.6 1341.02,-468.81"/>
<polygon fill="black" stroke="black" points="1342.29,-472.09 1350.98,-466.04 1340.41,-465.35 1342.29,-472.09"/>
<text text-anchor="middle" x="1312.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 5</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_6_ffn1 -->
<g id="edge958" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_6_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1206.57,-550.57C1346.62,-533.91 1578.71,-504.07 1787.57,-466.13"/>
<polygon fill="black" stroke="black" points="1788.29,-469.55 1797.5,-464.31 1787.04,-462.67 1788.29,-469.55"/>
<text text-anchor="middle" x="1694.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 6</text>
</g>
<!-- layer_15_gate&#45;&gt;layer_15_expert_7_ffn1 -->
<g id="edge962" class="edge">
<title>layer_15_gate&#45;&gt;layer_15_expert_7_ffn1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1052.92,-520.76C1043.87,-505.73 1033.9,-489.18 1025.37,-475.03"/>
<polygon fill="black" stroke="black" points="1028.16,-472.88 1020,-466.12 1022.17,-476.49 1028.16,-472.88"/>
<text text-anchor="middle" x="1056.57" y="-487" font-family="Times,serif" font-size="10.00">Expert 7</text>
</g>
<!-- layer_15_expert_0_gelu -->
<g id="node648" class="node">
<title>layer_15_expert_0_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-376 677.57,-376 677.57,-323 883.57,-323 883.57,-376"/>
<text text-anchor="middle" x="780.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="780.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="780.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_0_ffn1&#45;&gt;layer_15_expert_0_gelu -->
<g id="edge936" class="edge">
<title>layer_15_expert_0_ffn1&#45;&gt;layer_15_expert_0_gelu</title>
<path fill="none" stroke="black" d="M780.57,-412.57C780.57,-404.34 780.57,-395.08 780.57,-386.28"/>
<polygon fill="black" stroke="black" points="784.07,-386.24 780.57,-376.24 777.07,-386.24 784.07,-386.24"/>
</g>
<!-- layer_15_expert_0_ffn2 -->
<g id="node649" class="node">
<title>layer_15_expert_0_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="883.57,-286 677.57,-286 677.57,-233 883.57,-233 883.57,-286"/>
<text text-anchor="middle" x="780.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 0 FFN 2</text>
<text text-anchor="middle" x="780.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_0_gelu&#45;&gt;layer_15_expert_0_ffn2 -->
<g id="edge937" class="edge">
<title>layer_15_expert_0_gelu&#45;&gt;layer_15_expert_0_ffn2</title>
<path fill="none" stroke="black" d="M780.57,-322.57C780.57,-314.34 780.57,-305.08 780.57,-296.28"/>
<polygon fill="black" stroke="black" points="784.07,-296.24 780.57,-286.24 777.07,-296.24 784.07,-296.24"/>
</g>
<!-- layer_15_expert_agg -->
<g id="node671" class="node">
<title>layer_15_expert_agg</title>
<polygon fill="yellow" stroke="black" points="1218.21,-196 878.36,-196 790.93,-90 1130.79,-90 1218.21,-196"/>
<text text-anchor="middle" x="1004.57" y="-154.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1004.57" y="-139.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-124.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_0_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge966" class="edge">
<title>layer_15_expert_0_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M830.56,-232.95C849.26,-223.39 871.33,-212.11 893.35,-200.85"/>
<polygon fill="black" stroke="black" points="895.14,-203.87 902.45,-196.2 891.95,-197.64 895.14,-203.87"/>
</g>
<!-- layer_15_expert_1_gelu -->
<g id="node651" class="node">
<title>layer_15_expert_1_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-376 229.57,-376 229.57,-323 435.57,-323 435.57,-376"/>
<text text-anchor="middle" x="332.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="332.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="332.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_1_ffn1&#45;&gt;layer_15_expert_1_gelu -->
<g id="edge940" class="edge">
<title>layer_15_expert_1_ffn1&#45;&gt;layer_15_expert_1_gelu</title>
<path fill="none" stroke="black" d="M332.57,-412.57C332.57,-404.34 332.57,-395.08 332.57,-386.28"/>
<polygon fill="black" stroke="black" points="336.07,-386.24 332.57,-376.24 329.07,-386.24 336.07,-386.24"/>
</g>
<!-- layer_15_expert_1_ffn2 -->
<g id="node652" class="node">
<title>layer_15_expert_1_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="435.57,-286 229.57,-286 229.57,-233 435.57,-233 435.57,-286"/>
<text text-anchor="middle" x="332.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 1 FFN 2</text>
<text text-anchor="middle" x="332.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="332.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_1_gelu&#45;&gt;layer_15_expert_1_ffn2 -->
<g id="edge941" class="edge">
<title>layer_15_expert_1_gelu&#45;&gt;layer_15_expert_1_ffn2</title>
<path fill="none" stroke="black" d="M332.57,-322.57C332.57,-314.34 332.57,-305.08 332.57,-296.28"/>
<polygon fill="black" stroke="black" points="336.07,-296.24 332.57,-286.24 329.07,-296.24 336.07,-296.24"/>
</g>
<!-- layer_15_expert_1_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge967" class="edge">
<title>layer_15_expert_1_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M435.65,-234.76C438.66,-234.16 441.63,-233.57 444.57,-233 578.16,-207.21 730.72,-183.32 842.83,-166.81"/>
<polygon fill="black" stroke="black" points="843.49,-170.25 852.87,-165.33 842.47,-163.32 843.49,-170.25"/>
</g>
<!-- layer_15_expert_2_gelu -->
<g id="node654" class="node">
<title>layer_15_expert_2_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-376 1125.57,-376 1125.57,-323 1331.57,-323 1331.57,-376"/>
<text text-anchor="middle" x="1228.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1228.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1228.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_2_ffn1&#45;&gt;layer_15_expert_2_gelu -->
<g id="edge944" class="edge">
<title>layer_15_expert_2_ffn1&#45;&gt;layer_15_expert_2_gelu</title>
<path fill="none" stroke="black" d="M1228.57,-412.57C1228.57,-404.34 1228.57,-395.08 1228.57,-386.28"/>
<polygon fill="black" stroke="black" points="1232.07,-386.24 1228.57,-376.24 1225.07,-386.24 1232.07,-386.24"/>
</g>
<!-- layer_15_expert_2_ffn2 -->
<g id="node655" class="node">
<title>layer_15_expert_2_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1331.57,-286 1125.57,-286 1125.57,-233 1331.57,-233 1331.57,-286"/>
<text text-anchor="middle" x="1228.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 2 FFN 2</text>
<text text-anchor="middle" x="1228.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1228.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_2_gelu&#45;&gt;layer_15_expert_2_ffn2 -->
<g id="edge945" class="edge">
<title>layer_15_expert_2_gelu&#45;&gt;layer_15_expert_2_ffn2</title>
<path fill="none" stroke="black" d="M1228.57,-322.57C1228.57,-314.34 1228.57,-305.08 1228.57,-296.28"/>
<polygon fill="black" stroke="black" points="1232.07,-296.24 1228.57,-286.24 1225.07,-296.24 1232.07,-296.24"/>
</g>
<!-- layer_15_expert_2_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge968" class="edge">
<title>layer_15_expert_2_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M1178.58,-232.95C1159.88,-223.39 1137.81,-212.11 1115.79,-200.85"/>
<polygon fill="black" stroke="black" points="1117.19,-197.64 1106.7,-196.2 1114.01,-203.87 1117.19,-197.64"/>
</g>
<!-- layer_15_expert_3_gelu -->
<g id="node657" class="node">
<title>layer_15_expert_3_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-376 1573.57,-376 1573.57,-323 1779.57,-323 1779.57,-376"/>
<text text-anchor="middle" x="1676.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1676.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1676.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_3_ffn1&#45;&gt;layer_15_expert_3_gelu -->
<g id="edge948" class="edge">
<title>layer_15_expert_3_ffn1&#45;&gt;layer_15_expert_3_gelu</title>
<path fill="none" stroke="black" d="M1676.57,-412.57C1676.57,-404.34 1676.57,-395.08 1676.57,-386.28"/>
<polygon fill="black" stroke="black" points="1680.07,-386.24 1676.57,-376.24 1673.07,-386.24 1680.07,-386.24"/>
</g>
<!-- layer_15_expert_3_ffn2 -->
<g id="node658" class="node">
<title>layer_15_expert_3_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1779.57,-286 1573.57,-286 1573.57,-233 1779.57,-233 1779.57,-286"/>
<text text-anchor="middle" x="1676.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 3 FFN 2</text>
<text text-anchor="middle" x="1676.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1676.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_3_gelu&#45;&gt;layer_15_expert_3_ffn2 -->
<g id="edge949" class="edge">
<title>layer_15_expert_3_gelu&#45;&gt;layer_15_expert_3_ffn2</title>
<path fill="none" stroke="black" d="M1676.57,-322.57C1676.57,-314.34 1676.57,-305.08 1676.57,-296.28"/>
<polygon fill="black" stroke="black" points="1680.07,-296.24 1676.57,-286.24 1673.07,-296.24 1680.07,-296.24"/>
</g>
<!-- layer_15_expert_3_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge969" class="edge">
<title>layer_15_expert_3_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M1573.49,-234.76C1570.49,-234.16 1567.51,-233.57 1564.57,-233 1446.94,-210.29 1314.59,-189.06 1208.1,-173.03"/>
<polygon fill="black" stroke="black" points="1208.61,-169.57 1198.21,-171.54 1207.58,-176.49 1208.61,-169.57"/>
</g>
<!-- layer_15_expert_4_gelu -->
<g id="node660" class="node">
<title>layer_15_expert_4_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-376 453.57,-376 453.57,-323 659.57,-323 659.57,-376"/>
<text text-anchor="middle" x="556.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="556.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="556.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_4_ffn1&#45;&gt;layer_15_expert_4_gelu -->
<g id="edge952" class="edge">
<title>layer_15_expert_4_ffn1&#45;&gt;layer_15_expert_4_gelu</title>
<path fill="none" stroke="black" d="M556.57,-412.57C556.57,-404.34 556.57,-395.08 556.57,-386.28"/>
<polygon fill="black" stroke="black" points="560.07,-386.24 556.57,-376.24 553.07,-386.24 560.07,-386.24"/>
</g>
<!-- layer_15_expert_4_ffn2 -->
<g id="node661" class="node">
<title>layer_15_expert_4_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="659.57,-286 453.57,-286 453.57,-233 659.57,-233 659.57,-286"/>
<text text-anchor="middle" x="556.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 4 FFN 2</text>
<text text-anchor="middle" x="556.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_4_gelu&#45;&gt;layer_15_expert_4_ffn2 -->
<g id="edge953" class="edge">
<title>layer_15_expert_4_gelu&#45;&gt;layer_15_expert_4_ffn2</title>
<path fill="none" stroke="black" d="M556.57,-322.57C556.57,-314.34 556.57,-305.08 556.57,-296.28"/>
<polygon fill="black" stroke="black" points="560.07,-296.24 556.57,-286.24 553.07,-296.24 560.07,-296.24"/>
</g>
<!-- layer_15_expert_4_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge970" class="edge">
<title>layer_15_expert_4_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M656.55,-232.95C714.81,-218.06 789.41,-198.99 854.59,-182.33"/>
<polygon fill="black" stroke="black" points="855.73,-185.65 864.55,-179.79 853.99,-178.87 855.73,-185.65"/>
</g>
<!-- layer_15_expert_5_gelu -->
<g id="node663" class="node">
<title>layer_15_expert_5_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-376 1349.57,-376 1349.57,-323 1555.57,-323 1555.57,-376"/>
<text text-anchor="middle" x="1452.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1452.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1452.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_5_ffn1&#45;&gt;layer_15_expert_5_gelu -->
<g id="edge956" class="edge">
<title>layer_15_expert_5_ffn1&#45;&gt;layer_15_expert_5_gelu</title>
<path fill="none" stroke="black" d="M1452.57,-412.57C1452.57,-404.34 1452.57,-395.08 1452.57,-386.28"/>
<polygon fill="black" stroke="black" points="1456.07,-386.24 1452.57,-376.24 1449.07,-386.24 1456.07,-386.24"/>
</g>
<!-- layer_15_expert_5_ffn2 -->
<g id="node664" class="node">
<title>layer_15_expert_5_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1555.57,-286 1349.57,-286 1349.57,-233 1555.57,-233 1555.57,-286"/>
<text text-anchor="middle" x="1452.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 5 FFN 2</text>
<text text-anchor="middle" x="1452.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1452.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_5_gelu&#45;&gt;layer_15_expert_5_ffn2 -->
<g id="edge957" class="edge">
<title>layer_15_expert_5_gelu&#45;&gt;layer_15_expert_5_ffn2</title>
<path fill="none" stroke="black" d="M1452.57,-322.57C1452.57,-314.34 1452.57,-305.08 1452.57,-296.28"/>
<polygon fill="black" stroke="black" points="1456.07,-296.24 1452.57,-286.24 1449.07,-296.24 1456.07,-296.24"/>
</g>
<!-- layer_15_expert_5_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge971" class="edge">
<title>layer_15_expert_5_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M1352.59,-232.95C1312.66,-222.74 1265.05,-210.57 1218.07,-198.57"/>
<polygon fill="black" stroke="black" points="1218.92,-195.17 1208.37,-196.09 1217.19,-201.95 1218.92,-195.17"/>
</g>
<!-- layer_15_expert_6_gelu -->
<g id="node666" class="node">
<title>layer_15_expert_6_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-376 1797.57,-376 1797.57,-323 2003.57,-323 2003.57,-376"/>
<text text-anchor="middle" x="1900.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="1900.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1900.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_6_ffn1&#45;&gt;layer_15_expert_6_gelu -->
<g id="edge960" class="edge">
<title>layer_15_expert_6_ffn1&#45;&gt;layer_15_expert_6_gelu</title>
<path fill="none" stroke="black" d="M1900.57,-412.57C1900.57,-404.34 1900.57,-395.08 1900.57,-386.28"/>
<polygon fill="black" stroke="black" points="1904.07,-386.24 1900.57,-376.24 1897.07,-386.24 1904.07,-386.24"/>
</g>
<!-- layer_15_expert_6_ffn2 -->
<g id="node667" class="node">
<title>layer_15_expert_6_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="2003.57,-286 1797.57,-286 1797.57,-233 2003.57,-233 2003.57,-286"/>
<text text-anchor="middle" x="1900.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 6 FFN 2</text>
<text text-anchor="middle" x="1900.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1900.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_6_gelu&#45;&gt;layer_15_expert_6_ffn2 -->
<g id="edge961" class="edge">
<title>layer_15_expert_6_gelu&#45;&gt;layer_15_expert_6_ffn2</title>
<path fill="none" stroke="black" d="M1900.57,-322.57C1900.57,-314.34 1900.57,-305.08 1900.57,-296.28"/>
<polygon fill="black" stroke="black" points="1904.07,-296.24 1900.57,-286.24 1897.07,-296.24 1904.07,-296.24"/>
</g>
<!-- layer_15_expert_6_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge972" class="edge">
<title>layer_15_expert_6_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M1797.52,-234.59C1794.51,-234.03 1791.52,-233.5 1788.57,-233 1588.54,-198.98 1357.51,-174.53 1198.33,-159.97"/>
<polygon fill="black" stroke="black" points="1198.23,-156.45 1187.95,-159.03 1197.59,-163.42 1198.23,-156.45"/>
</g>
<!-- layer_15_expert_7_gelu -->
<g id="node669" class="node">
<title>layer_15_expert_7_gelu</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-376 901.57,-376 901.57,-323 1107.57,-323 1107.57,-376"/>
<text text-anchor="middle" x="1004.57" y="-360.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="1004.57" y="-345.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 4096]</text>
<text text-anchor="middle" x="1004.57" y="-330.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_7_ffn1&#45;&gt;layer_15_expert_7_gelu -->
<g id="edge964" class="edge">
<title>layer_15_expert_7_ffn1&#45;&gt;layer_15_expert_7_gelu</title>
<path fill="none" stroke="black" d="M1004.57,-412.57C1004.57,-404.34 1004.57,-395.08 1004.57,-386.28"/>
<polygon fill="black" stroke="black" points="1008.07,-386.24 1004.57,-376.24 1001.07,-386.24 1008.07,-386.24"/>
</g>
<!-- layer_15_expert_7_ffn2 -->
<g id="node670" class="node">
<title>layer_15_expert_7_ffn2</title>
<polygon fill="lightsteelblue" stroke="black" points="1107.57,-286 901.57,-286 901.57,-233 1107.57,-233 1107.57,-286"/>
<text text-anchor="middle" x="1004.57" y="-270.8" font-family="Times,serif" font-size="14.00">Expert 7 FFN 2</text>
<text text-anchor="middle" x="1004.57" y="-255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1004.57" y="-240.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_expert_7_gelu&#45;&gt;layer_15_expert_7_ffn2 -->
<g id="edge965" class="edge">
<title>layer_15_expert_7_gelu&#45;&gt;layer_15_expert_7_ffn2</title>
<path fill="none" stroke="black" d="M1004.57,-322.57C1004.57,-314.34 1004.57,-305.08 1004.57,-296.28"/>
<polygon fill="black" stroke="black" points="1008.07,-296.24 1004.57,-286.24 1001.07,-296.24 1008.07,-296.24"/>
</g>
<!-- layer_15_expert_7_ffn2&#45;&gt;layer_15_expert_agg -->
<g id="edge973" class="edge">
<title>layer_15_expert_7_ffn2&#45;&gt;layer_15_expert_agg</title>
<path fill="none" stroke="black" d="M1004.57,-232.8C1004.57,-224.86 1004.57,-215.74 1004.57,-206.44"/>
<polygon fill="black" stroke="black" points="1008.07,-206.32 1004.57,-196.32 1001.07,-206.32 1008.07,-206.32"/>
</g>
<!-- layer_15_expert_agg&#45;&gt;layer_15_add -->
<g id="edge975" class="edge">
<title>layer_15_expert_agg&#45;&gt;layer_15_add</title>
<path fill="none" stroke="black" d="M810.56,-113.92C658.7,-91.93 452.76,-62.12 326.73,-43.88"/>
<polygon fill="black" stroke="black" points="327.07,-40.39 316.67,-42.42 326.07,-47.32 327.07,-40.39"/>
</g>
<!-- output -->
<g id="node673" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="711.57" cy="-27820.48" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="711.57" y="-27831.78" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="711.57" y="-27816.78" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="711.57" y="-27801.78" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- comm_15_16 -->
<g id="node674" class="node">
<title>comm_15_16</title>
<polygon fill="lightblue" stroke="black" points="766.07,-27950.43 657.07,-27950.43 657.07,-27914.43 766.07,-27914.43 766.07,-27950.43"/>
<text text-anchor="middle" x="711.57" y="-27928.73" font-family="Times,serif" font-size="14.00">comm_15_16</text>
</g>
<!-- comm_15_16&#45;&gt;output -->
<g id="edge976" class="edge">
<title>comm_15_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M711.57,-27914.25C711.57,-27901.85 711.57,-27884.47 711.57,-27868.1"/>
<polygon fill="black" stroke="black" points="715.07,-27868.09 711.57,-27858.09 708.07,-27868.09 715.07,-27868.09"/>
</g>
</g>
</svg>
