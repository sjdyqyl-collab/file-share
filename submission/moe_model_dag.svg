<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: MoE_Model_Layerwise_Deployment Pages: 1 -->
<svg width="211pt" height="2520pt"
 viewBox="0.00 0.00 210.67 2520.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.1 0.1) rotate(0) translate(4 26144.41)">
<title>MoE_Model_Layerwise_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-26144.41 2182,-26144.41 2182,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer_1</title>
<path fill="none" stroke="blue" d="M150,-24462.55C150,-24462.55 2087,-24462.55 2087,-24462.55 2093,-24462.55 2099,-24468.55 2099,-24474.55 2099,-24474.55 2099,-26026.46 2099,-26026.46 2099,-26032.46 2093,-26038.46 2087,-26038.46 2087,-26038.46 150,-26038.46 150,-26038.46 144,-26038.46 138,-26032.46 138,-26026.46 138,-26026.46 138,-24474.55 138,-24474.55 138,-24468.55 144,-24462.55 150,-24462.55"/>
<text text-anchor="middle" x="1118.5" y="-26023.26" font-family="Times,serif" font-size="14.00">Layer 1 (GPU&#45;0 to GPU&#45;7)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer_2</title>
<path fill="none" stroke="blue" d="M148,-22838.65C148,-22838.65 2085,-22838.65 2085,-22838.65 2091,-22838.65 2097,-22844.65 2097,-22850.65 2097,-22850.65 2097,-24402.55 2097,-24402.55 2097,-24408.55 2091,-24414.55 2085,-24414.55 2085,-24414.55 148,-24414.55 148,-24414.55 142,-24414.55 136,-24408.55 136,-24402.55 136,-24402.55 136,-22850.65 136,-22850.65 136,-22844.65 142,-22838.65 148,-22838.65"/>
<text text-anchor="middle" x="1116.5" y="-24399.35" font-family="Times,serif" font-size="14.00">Layer 2 (GPU&#45;1 to GPU&#45;8)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer_3</title>
<path fill="none" stroke="blue" d="M24,-21214.74C24,-21214.74 1961,-21214.74 1961,-21214.74 1967,-21214.74 1973,-21220.74 1973,-21226.74 1973,-21226.74 1973,-22778.65 1973,-22778.65 1973,-22784.65 1967,-22790.65 1961,-22790.65 1961,-22790.65 24,-22790.65 24,-22790.65 18,-22790.65 12,-22784.65 12,-22778.65 12,-22778.65 12,-21226.74 12,-21226.74 12,-21220.74 18,-21214.74 24,-21214.74"/>
<text text-anchor="middle" x="992.5" y="-22775.45" font-family="Times,serif" font-size="14.00">Layer 3 (GPU&#45;2 to GPU&#45;9)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer_4</title>
<path fill="none" stroke="blue" d="M195,-19590.83C195,-19590.83 2132,-19590.83 2132,-19590.83 2138,-19590.83 2144,-19596.83 2144,-19602.83 2144,-19602.83 2144,-21154.74 2144,-21154.74 2144,-21160.74 2138,-21166.74 2132,-21166.74 2132,-21166.74 195,-21166.74 195,-21166.74 189,-21166.74 183,-21160.74 183,-21154.74 183,-21154.74 183,-19602.83 183,-19602.83 183,-19596.83 189,-19590.83 195,-19590.83"/>
<text text-anchor="middle" x="1163.5" y="-21151.54" font-family="Times,serif" font-size="14.00">Layer 4 (GPU&#45;3 to GPU&#45;10)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer_5</title>
<path fill="none" stroke="blue" d="M72,-17966.93C72,-17966.93 2009,-17966.93 2009,-17966.93 2015,-17966.93 2021,-17972.93 2021,-17978.93 2021,-17978.93 2021,-19530.83 2021,-19530.83 2021,-19536.83 2015,-19542.83 2009,-19542.83 2009,-19542.83 72,-19542.83 72,-19542.83 66,-19542.83 60,-19536.83 60,-19530.83 60,-19530.83 60,-17978.93 60,-17978.93 60,-17972.93 66,-17966.93 72,-17966.93"/>
<text text-anchor="middle" x="1040.5" y="-19527.63" font-family="Times,serif" font-size="14.00">Layer 5 (GPU&#45;4 to GPU&#45;11)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer_6</title>
<path fill="none" stroke="blue" d="M155,-16343.02C155,-16343.02 2092,-16343.02 2092,-16343.02 2098,-16343.02 2104,-16349.02 2104,-16355.02 2104,-16355.02 2104,-17906.93 2104,-17906.93 2104,-17912.93 2098,-17918.93 2092,-17918.93 2092,-17918.93 155,-17918.93 155,-17918.93 149,-17918.93 143,-17912.93 143,-17906.93 143,-17906.93 143,-16355.02 143,-16355.02 143,-16349.02 149,-16343.02 155,-16343.02"/>
<text text-anchor="middle" x="1123.5" y="-17903.73" font-family="Times,serif" font-size="14.00">Layer 6 (GPU&#45;5 to GPU&#45;12)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer_7</title>
<path fill="none" stroke="blue" d="M221,-14719.11C221,-14719.11 2158,-14719.11 2158,-14719.11 2164,-14719.11 2170,-14725.11 2170,-14731.11 2170,-14731.11 2170,-16283.02 2170,-16283.02 2170,-16289.02 2164,-16295.02 2158,-16295.02 2158,-16295.02 221,-16295.02 221,-16295.02 215,-16295.02 209,-16289.02 209,-16283.02 209,-16283.02 209,-14731.11 209,-14731.11 209,-14725.11 215,-14719.11 221,-14719.11"/>
<text text-anchor="middle" x="1189.5" y="-16279.82" font-family="Times,serif" font-size="14.00">Layer 7 (GPU&#45;6 to GPU&#45;13)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer_8</title>
<path fill="none" stroke="blue" d="M72,-13095.21C72,-13095.21 2009,-13095.21 2009,-13095.21 2015,-13095.21 2021,-13101.21 2021,-13107.21 2021,-13107.21 2021,-14659.11 2021,-14659.11 2021,-14665.11 2015,-14671.11 2009,-14671.11 2009,-14671.11 72,-14671.11 72,-14671.11 66,-14671.11 60,-14665.11 60,-14659.11 60,-14659.11 60,-13107.21 60,-13107.21 60,-13101.21 66,-13095.21 72,-13095.21"/>
<text text-anchor="middle" x="1040.5" y="-14655.91" font-family="Times,serif" font-size="14.00">Layer 8 (GPU&#45;7 to GPU&#45;14)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer_9</title>
<path fill="none" stroke="blue" d="M72,-11471.3C72,-11471.3 2009,-11471.3 2009,-11471.3 2015,-11471.3 2021,-11477.3 2021,-11483.3 2021,-11483.3 2021,-13035.21 2021,-13035.21 2021,-13041.21 2015,-13047.21 2009,-13047.21 2009,-13047.21 72,-13047.21 72,-13047.21 66,-13047.21 60,-13041.21 60,-13035.21 60,-13035.21 60,-11483.3 60,-11483.3 60,-11477.3 66,-11471.3 72,-11471.3"/>
<text text-anchor="middle" x="1040.5" y="-13032.01" font-family="Times,serif" font-size="14.00">Layer 9 (GPU&#45;8 to GPU&#45;15)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer_10</title>
<path fill="none" stroke="blue" d="M189,-9847.39C189,-9847.39 2126,-9847.39 2126,-9847.39 2132,-9847.39 2138,-9853.39 2138,-9859.39 2138,-9859.39 2138,-11411.3 2138,-11411.3 2138,-11417.3 2132,-11423.3 2126,-11423.3 2126,-11423.3 189,-11423.3 189,-11423.3 183,-11423.3 177,-11417.3 177,-11411.3 177,-11411.3 177,-9859.39 177,-9859.39 177,-9853.39 183,-9847.39 189,-9847.39"/>
<text text-anchor="middle" x="1157.5" y="-11408.1" font-family="Times,serif" font-size="14.00">Layer 10 (GPU&#45;9 to GPU&#45;16)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer_11</title>
<path fill="none" stroke="blue" d="M195,-8223.49C195,-8223.49 2132,-8223.49 2132,-8223.49 2138,-8223.49 2144,-8229.49 2144,-8235.49 2144,-8235.49 2144,-9787.39 2144,-9787.39 2144,-9793.39 2138,-9799.39 2132,-9799.39 2132,-9799.39 195,-9799.39 195,-9799.39 189,-9799.39 183,-9793.39 183,-9787.39 183,-9787.39 183,-8235.49 183,-8235.49 183,-8229.49 189,-8223.49 195,-8223.49"/>
<text text-anchor="middle" x="1163.5" y="-9784.19" font-family="Times,serif" font-size="14.00">Layer 11 (GPU&#45;10 to GPU&#45;17)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer_12</title>
<path fill="none" stroke="blue" d="M213,-6599.58C213,-6599.58 2150,-6599.58 2150,-6599.58 2156,-6599.58 2162,-6605.58 2162,-6611.58 2162,-6611.58 2162,-8163.49 2162,-8163.49 2162,-8169.49 2156,-8175.49 2150,-8175.49 2150,-8175.49 213,-8175.49 213,-8175.49 207,-8175.49 201,-8169.49 201,-8163.49 201,-8163.49 201,-6611.58 201,-6611.58 201,-6605.58 207,-6599.58 213,-6599.58"/>
<text text-anchor="middle" x="1181.5" y="-8160.29" font-family="Times,serif" font-size="14.00">Layer 12 (GPU&#45;11 to GPU&#45;18)</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer_13</title>
<path fill="none" stroke="blue" d="M69,-4975.67C69,-4975.67 2006,-4975.67 2006,-4975.67 2012,-4975.67 2018,-4981.67 2018,-4987.67 2018,-4987.67 2018,-6539.58 2018,-6539.58 2018,-6545.58 2012,-6551.58 2006,-6551.58 2006,-6551.58 69,-6551.58 69,-6551.58 63,-6551.58 57,-6545.58 57,-6539.58 57,-6539.58 57,-4987.67 57,-4987.67 57,-4981.67 63,-4975.67 69,-4975.67"/>
<text text-anchor="middle" x="1037.5" y="-6536.38" font-family="Times,serif" font-size="14.00">Layer 13 (GPU&#45;12 to GPU&#45;19)</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_layer_14</title>
<path fill="none" stroke="blue" d="M20,-3351.77C20,-3351.77 1957,-3351.77 1957,-3351.77 1963,-3351.77 1969,-3357.77 1969,-3363.77 1969,-3363.77 1969,-4915.67 1969,-4915.67 1969,-4921.67 1963,-4927.67 1957,-4927.67 1957,-4927.67 20,-4927.67 20,-4927.67 14,-4927.67 8,-4921.67 8,-4915.67 8,-4915.67 8,-3363.77 8,-3363.77 8,-3357.77 14,-3351.77 20,-3351.77"/>
<text text-anchor="middle" x="988.5" y="-4912.47" font-family="Times,serif" font-size="14.00">Layer 14 (GPU&#45;13 to GPU&#45;20)</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_layer_15</title>
<path fill="none" stroke="blue" d="M84,-1727.86C84,-1727.86 2021,-1727.86 2021,-1727.86 2027,-1727.86 2033,-1733.86 2033,-1739.86 2033,-1739.86 2033,-3291.77 2033,-3291.77 2033,-3297.77 2027,-3303.77 2021,-3303.77 2021,-3303.77 84,-3303.77 84,-3303.77 78,-3303.77 72,-3297.77 72,-3291.77 72,-3291.77 72,-1739.86 72,-1739.86 72,-1733.86 78,-1727.86 84,-1727.86"/>
<text text-anchor="middle" x="1052.5" y="-3288.57" font-family="Times,serif" font-size="14.00">Layer 15 (GPU&#45;14 to GPU&#45;21)</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_layer_16</title>
<path fill="none" stroke="blue" d="M89,-103.95C89,-103.95 2026,-103.95 2026,-103.95 2032,-103.95 2038,-109.95 2038,-115.95 2038,-115.95 2038,-1667.86 2038,-1667.86 2038,-1673.86 2032,-1679.86 2026,-1679.86 2026,-1679.86 89,-1679.86 89,-1679.86 83,-1679.86 77,-1673.86 77,-1667.86 77,-1667.86 77,-115.95 77,-115.95 77,-109.95 83,-103.95 89,-103.95"/>
<text text-anchor="middle" x="1057.5" y="-1664.66" font-family="Times,serif" font-size="14.00">Layer 16 (GPU&#45;15 to GPU&#45;22)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="1717" cy="-26102.94" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="1717" y="-26114.24" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1717" y="-26099.24" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=4096]</text>
<text text-anchor="middle" x="1717" y="-26084.24" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightyellow" stroke="black" points="1609.5,-26007.46 1450.5,-26007.46 1450.5,-25954.46 1609.5,-25954.46 1609.5,-26007.46"/>
<text text-anchor="middle" x="1530" y="-25992.26" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1530" y="-25977.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1530" y="-25962.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M1661.91,-26066.59C1635.38,-26049.57 1603.87,-26029.36 1578.3,-26012.95"/>
<polygon fill="black" stroke="black" points="1580.18,-26010 1569.87,-26007.54 1576.4,-26015.89 1580.18,-26010"/>
</g>
<!-- residual1_1 -->
<g id="node8" class="node">
<title>residual1_1</title>
<polygon fill="lightpink" stroke="black" points="1916.69,-25647.46 1654.71,-25647.46 1587.31,-25541.46 1849.29,-25541.46 1916.69,-25647.46"/>
<text text-anchor="middle" x="1752" y="-25605.76" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1752" y="-25590.76" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1752" y="-25575.76" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M1750.89,-26065.8C1768.34,-26043.41 1786,-26013.08 1786,-25981.96 1786,-25981.96 1786,-25981.96 1786,-25709.96 1786,-25692.45 1782.3,-25674.04 1777.34,-25657.22"/>
<polygon fill="black" stroke="black" points="1780.63,-25656.01 1774.3,-25647.52 1773.96,-25658.11 1780.63,-25656.01"/>
</g>
<!-- mha_q_1 -->
<g id="node3" class="node">
<title>mha_q_1</title>
<polygon fill="lightcoral" stroke="black" points="1283.5,-25917.46 1064.5,-25917.46 1064.5,-25864.46 1283.5,-25864.46 1283.5,-25917.46"/>
<text text-anchor="middle" x="1174" y="-25902.26" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1174" y="-25887.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1174" y="-25872.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_q_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M1450.11,-25960.21C1402.05,-25948.33 1340.12,-25933.02 1287.1,-25919.92"/>
<polygon fill="black" stroke="black" points="1287.86,-25916.5 1277.31,-25917.5 1286.18,-25923.29 1287.86,-25916.5"/>
</g>
<!-- mha_k_1 -->
<g id="node4" class="node">
<title>mha_k_1</title>
<polygon fill="lightcoral" stroke="black" points="1520.5,-25917.46 1301.5,-25917.46 1301.5,-25864.46 1520.5,-25864.46 1520.5,-25917.46"/>
<text text-anchor="middle" x="1411" y="-25902.26" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1411" y="-25887.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1411" y="-25872.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_k_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M1495.26,-25954.27C1482.31,-25944.69 1467.45,-25933.7 1453.85,-25923.65"/>
<polygon fill="black" stroke="black" points="1455.7,-25920.66 1445.58,-25917.53 1451.54,-25926.29 1455.7,-25920.66"/>
</g>
<!-- mha_v_1 -->
<g id="node5" class="node">
<title>mha_v_1</title>
<polygon fill="lightcoral" stroke="black" points="1757.5,-25917.46 1538.5,-25917.46 1538.5,-25864.46 1757.5,-25864.46 1757.5,-25917.46"/>
<text text-anchor="middle" x="1648" y="-25902.26" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1648" y="-25887.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1648" y="-25872.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_v_1 -->
<g id="edge4" class="edge">
<title>ln1_1&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M1564.45,-25954.27C1577.29,-25944.69 1592.03,-25933.7 1605.51,-25923.65"/>
<polygon fill="black" stroke="black" points="1607.79,-25926.31 1613.71,-25917.53 1603.6,-25920.7 1607.79,-25926.31"/>
</g>
<!-- mha_attn_1 -->
<g id="node6" class="node">
<title>mha_attn_1</title>
<polygon fill="lightcoral" stroke="black" points="1615.5,-25827.46 1444.5,-25827.46 1444.5,-25774.46 1615.5,-25774.46 1615.5,-25827.46"/>
<text text-anchor="middle" x="1530" y="-25812.26" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1530" y="-25797.26" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1530" y="-25782.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1277.45,-25864.39C1327,-25852.14 1385.96,-25837.56 1434.44,-25825.58"/>
<polygon fill="black" stroke="black" points="1435.44,-25828.94 1444.31,-25823.14 1433.76,-25822.14 1435.44,-25828.94"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1445.74,-25864.27C1458.69,-25854.69 1473.55,-25843.7 1487.15,-25833.65"/>
<polygon fill="black" stroke="black" points="1489.46,-25836.29 1495.42,-25827.53 1485.3,-25830.66 1489.46,-25836.29"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge7" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1613.55,-25864.27C1600.71,-25854.69 1585.97,-25843.7 1572.49,-25833.65"/>
<polygon fill="black" stroke="black" points="1574.4,-25830.7 1564.29,-25827.53 1570.21,-25836.31 1574.4,-25830.7"/>
</g>
<!-- mha_out_1 -->
<g id="node7" class="node">
<title>mha_out_1</title>
<polygon fill="lightcoral" stroke="black" points="1743.5,-25737.46 1584.5,-25737.46 1584.5,-25684.46 1743.5,-25684.46 1743.5,-25737.46"/>
<text text-anchor="middle" x="1664" y="-25722.26" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1664" y="-25707.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1664" y="-25692.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge8" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M1569.12,-25774.27C1583.98,-25764.51 1601.07,-25753.29 1616.61,-25743.08"/>
<polygon fill="black" stroke="black" points="1618.63,-25745.94 1625.06,-25737.53 1614.78,-25740.09 1618.63,-25745.94"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge10" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M1683.75,-25684.26C1690.31,-25675.73 1697.91,-25665.84 1705.61,-25655.82"/>
<polygon fill="black" stroke="black" points="1708.47,-25657.84 1711.79,-25647.78 1702.92,-25653.58 1708.47,-25657.84"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="lightyellow" stroke="black" points="1744.5,-25504.46 1585.5,-25504.46 1585.5,-25451.46 1744.5,-25451.46 1744.5,-25504.46"/>
<text text-anchor="middle" x="1665" y="-25489.26" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1665" y="-25474.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1665" y="-25459.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge11" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M1712.32,-25541.24C1704.91,-25531.48 1697.35,-25521.53 1690.51,-25512.53"/>
<polygon fill="black" stroke="black" points="1693.29,-25510.41 1684.45,-25504.56 1687.72,-25514.64 1693.29,-25510.41"/>
</g>
<!-- residual2_1 -->
<g id="node44" class="node">
<title>residual2_1</title>
<polygon fill="lightpink" stroke="black" points="1927.69,-24688.51 1665.71,-24688.51 1598.31,-24582.51 1860.29,-24582.51 1927.69,-24688.51"/>
<text text-anchor="middle" x="1763" y="-24646.81" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1763" y="-24631.81" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1763" y="-24616.81" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge54" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M1871.64,-25575.87C1968.87,-25558.1 2090,-25526.43 2090,-25478.96 2090,-25478.96 2090,-25478.96 2090,-24777.51 2090,-24692.68 1996.06,-24658.28 1908.88,-24644.61"/>
<polygon fill="black" stroke="black" points="1909.24,-24641.13 1898.84,-24643.13 1908.22,-24648.05 1909.24,-24641.13"/>
</g>
<!-- gate_1 -->
<g id="node10" class="node">
<title>gate_1</title>
<polygon fill="orange" stroke="black" points="1230,-25414.46 1050,-25361.46 1230,-25308.46 1410,-25361.46 1230,-25414.46"/>
<text text-anchor="middle" x="1230" y="-25372.76" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1230" y="-25357.76" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1230" y="-25342.76" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln2_1&#45;&gt;gate_1 -->
<g id="edge12" class="edge">
<title>ln2_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M1585.47,-25456.03C1514.58,-25437.37 1410.4,-25409.94 1333.13,-25389.6"/>
<polygon fill="black" stroke="black" points="1333.93,-25386.2 1323.37,-25387.04 1332.15,-25392.97 1333.93,-25386.2"/>
</g>
<!-- expert0_up_1 -->
<g id="node11" class="node">
<title>expert0_up_1</title>
<polygon fill="lightgreen" stroke="black" points="384,-25242.46 168,-25242.46 168,-25189.46 384,-25189.46 384,-25242.46"/>
<text text-anchor="middle" x="276" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="276" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="276" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- gate_1&#45;&gt;expert0_up_1 -->
<g id="edge13" class="edge">
<title>gate_1&#45;&gt;expert0_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1081.12,-25352.2C942.09,-25342.84 729.24,-25324.28 547,-25290.46 485.86,-25279.11 418.36,-25260.83 366.03,-25245.33"/>
<polygon fill="blue" stroke="blue" points="367.02,-25241.97 356.44,-25242.47 365.02,-25248.68 367.02,-25241.97"/>
<text text-anchor="middle" x="598.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="598.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;0</text>
</g>
<!-- expert1_up_1 -->
<g id="node15" class="node">
<title>expert1_up_1</title>
<polygon fill="lightgreen" stroke="black" points="622,-25242.46 406,-25242.46 406,-25189.46 622,-25189.46 622,-25242.46"/>
<text text-anchor="middle" x="514" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="514" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="514" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- gate_1&#45;&gt;expert1_up_1 -->
<g id="edge18" class="edge">
<title>gate_1&#45;&gt;expert1_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1102.63,-25345.92C1008.92,-25334.09 878.78,-25315.3 766,-25290.46 710.62,-25278.26 649.54,-25260.56 601.39,-25245.58"/>
<polygon fill="blue" stroke="blue" points="602.22,-25242.17 591.63,-25242.53 600.13,-25248.86 602.22,-25242.17"/>
<text text-anchor="middle" x="817.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="817.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;1</text>
</g>
<!-- expert2_up_1 -->
<g id="node19" class="node">
<title>expert2_up_1</title>
<polygon fill="lightgreen" stroke="black" points="857,-25242.46 641,-25242.46 641,-25189.46 857,-25189.46 857,-25242.46"/>
<text text-anchor="middle" x="749" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="749" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="749" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- gate_1&#45;&gt;expert2_up_1 -->
<g id="edge23" class="edge">
<title>gate_1&#45;&gt;expert2_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1132.68,-25337.11C1081.34,-25324.29 1017.46,-25307.56 961,-25290.46 916.57,-25277 867.56,-25260.14 827.87,-25245.97"/>
<polygon fill="blue" stroke="blue" points="828.84,-25242.6 818.25,-25242.52 826.48,-25249.19 828.84,-25242.6"/>
<text text-anchor="middle" x="1012.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1012.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;2</text>
</g>
<!-- expert3_up_1 -->
<g id="node23" class="node">
<title>expert3_up_1</title>
<polygon fill="lightgreen" stroke="black" points="1100,-25242.46 884,-25242.46 884,-25189.46 1100,-25189.46 1100,-25242.46"/>
<text text-anchor="middle" x="992" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="992" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="992" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- gate_1&#45;&gt;expert3_up_1 -->
<g id="edge28" class="edge">
<title>gate_1&#45;&gt;expert3_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1171.78,-25325.36C1132.41,-25301.62 1080.91,-25270.57 1043.13,-25247.79"/>
<polygon fill="blue" stroke="blue" points="1044.69,-25244.64 1034.32,-25242.48 1041.08,-25250.64 1044.69,-25244.64"/>
<text text-anchor="middle" x="1162.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1162.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;3</text>
</g>
<!-- expert4_up_1 -->
<g id="node27" class="node">
<title>expert4_up_1</title>
<polygon fill="lightgreen" stroke="black" points="1338,-25242.46 1122,-25242.46 1122,-25189.46 1338,-25189.46 1338,-25242.46"/>
<text text-anchor="middle" x="1230" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1230" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1230" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- gate_1&#45;&gt;expert4_up_1 -->
<g id="edge33" class="edge">
<title>gate_1&#45;&gt;expert4_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1230,-25308.25C1230,-25289.97 1230,-25269.87 1230,-25253.19"/>
<polygon fill="blue" stroke="blue" points="1233.5,-25252.77 1230,-25242.77 1226.5,-25252.77 1233.5,-25252.77"/>
<text text-anchor="middle" x="1281.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1281.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;4</text>
</g>
<!-- expert5_up_1 -->
<g id="node31" class="node">
<title>expert5_up_1</title>
<polygon fill="lightgreen" stroke="black" points="1573,-25242.46 1357,-25242.46 1357,-25189.46 1573,-25189.46 1573,-25242.46"/>
<text text-anchor="middle" x="1465" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1465" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1465" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_1&#45;&gt;expert5_up_1 -->
<g id="edge38" class="edge">
<title>gate_1&#45;&gt;expert5_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1287.49,-25325.36C1326.36,-25301.62 1377.21,-25270.57 1414.52,-25247.79"/>
<polygon fill="blue" stroke="blue" points="1416.5,-25250.67 1423.21,-25242.48 1412.86,-25244.7 1416.5,-25250.67"/>
<text text-anchor="middle" x="1439.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1439.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;5</text>
</g>
<!-- expert6_up_1 -->
<g id="node35" class="node">
<title>expert6_up_1</title>
<polygon fill="lightgreen" stroke="black" points="1808,-25242.46 1592,-25242.46 1592,-25189.46 1808,-25189.46 1808,-25242.46"/>
<text text-anchor="middle" x="1700" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1700" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1700" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_1&#45;&gt;expert6_up_1 -->
<g id="edge43" class="edge">
<title>gate_1&#45;&gt;expert6_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1327.17,-25336.92C1377.55,-25324.19 1439.9,-25307.58 1495,-25290.46 1537.94,-25277.12 1585.22,-25260.31 1623.55,-25246.14"/>
<polygon fill="blue" stroke="blue" points="1624.93,-25249.36 1633.09,-25242.59 1622.5,-25242.79 1624.93,-25249.36"/>
<text text-anchor="middle" x="1631.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1631.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;6</text>
</g>
<!-- expert7_up_1 -->
<g id="node39" class="node">
<title>expert7_up_1</title>
<polygon fill="lightgreen" stroke="black" points="2045,-25242.46 1829,-25242.46 1829,-25189.46 2045,-25189.46 2045,-25242.46"/>
<text text-anchor="middle" x="1937" y="-25227.26" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1937" y="-25212.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1937" y="-25197.26" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_1&#45;&gt;expert7_up_1 -->
<g id="edge48" class="edge">
<title>gate_1&#45;&gt;expert7_up_1</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1356.93,-25345.66C1449.11,-25333.78 1576.53,-25315.04 1687,-25290.46 1741.95,-25278.23 1802.54,-25260.53 1850.31,-25245.56"/>
<polygon fill="blue" stroke="blue" points="1851.51,-25248.85 1860,-25242.51 1849.41,-25242.17 1851.51,-25248.85"/>
<text text-anchor="middle" x="1848.5" y="-25279.26" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1848.5" y="-25264.26" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;7</text>
</g>
<!-- expert0_act_1 -->
<g id="node12" class="node">
<title>expert0_act_1</title>
<polygon fill="lightgreen" stroke="black" points="358,-25152.46 190,-25152.46 190,-25099.46 358,-25099.46 358,-25152.46"/>
<text text-anchor="middle" x="274" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="274" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="274" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- expert0_up_1&#45;&gt;expert0_act_1 -->
<g id="edge14" class="edge">
<title>expert0_up_1&#45;&gt;expert0_act_1</title>
<path fill="none" stroke="black" d="M275.41,-25189.03C275.22,-25180.8 275.01,-25171.54 274.81,-25162.74"/>
<polygon fill="black" stroke="black" points="278.31,-25162.62 274.59,-25152.7 271.31,-25162.78 278.31,-25162.62"/>
</g>
<!-- expert0_down_1 -->
<g id="node13" class="node">
<title>expert0_down_1</title>
<polygon fill="lightgreen" stroke="black" points="374,-25062.46 158,-25062.46 158,-25009.46 374,-25009.46 374,-25062.46"/>
<text text-anchor="middle" x="266" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="266" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="266" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- expert0_act_1&#45;&gt;expert0_down_1 -->
<g id="edge15" class="edge">
<title>expert0_act_1&#45;&gt;expert0_down_1</title>
<path fill="none" stroke="black" d="M271.64,-25099.03C270.89,-25090.8 270.05,-25081.54 269.25,-25072.74"/>
<polygon fill="black" stroke="black" points="272.73,-25072.34 268.34,-25062.7 265.76,-25072.98 272.73,-25072.34"/>
</g>
<!-- expert0_agg_1 -->
<g id="node14" class="node">
<title>expert0_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="258" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="258" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="258" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="258" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- expert0_down_1&#45;&gt;expert0_agg_1 -->
<g id="edge16" class="edge">
<title>expert0_down_1&#45;&gt;expert0_agg_1</title>
<path fill="none" stroke="black" d="M263.92,-25009.21C263.27,-25001.14 262.52,-24991.96 261.79,-24982.9"/>
<polygon fill="black" stroke="black" points="265.27,-24982.47 260.97,-24972.78 258.29,-24983.03 265.27,-24982.47"/>
</g>
<!-- expert_agg_1 -->
<g id="node43" class="node">
<title>expert_agg_1</title>
<polygon fill="gold" stroke="black" points="1394.69,-24831.51 1132.71,-24831.51 1065.31,-24725.51 1327.29,-24725.51 1394.69,-24831.51"/>
<text text-anchor="middle" x="1230" y="-24789.81" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1230" y="-24774.81" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1230" y="-24759.81" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert0_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge17" class="edge">
<title>expert0_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M318.1,-24903.29C357.66,-24884.53 411.16,-24861.84 461,-24849.51 675.88,-24796.34 933.5,-24782.63 1089.32,-24779.61"/>
<polygon fill="purple" stroke="purple" points="1089.5,-24783.1 1099.44,-24779.42 1089.37,-24776.1 1089.5,-24783.1"/>
<text text-anchor="middle" x="532.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;7</text>
<text text-anchor="middle" x="532.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_1 -->
<g id="node16" class="node">
<title>expert1_act_1</title>
<polygon fill="lightgreen" stroke="black" points="591,-25152.46 423,-25152.46 423,-25099.46 591,-25099.46 591,-25152.46"/>
<text text-anchor="middle" x="507" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="507" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="507" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert1_up_1&#45;&gt;expert1_act_1 -->
<g id="edge19" class="edge">
<title>expert1_up_1&#45;&gt;expert1_act_1</title>
<path fill="none" stroke="black" d="M511.94,-25189.03C511.28,-25180.8 510.55,-25171.54 509.85,-25162.74"/>
<polygon fill="black" stroke="black" points="513.33,-25162.39 509.05,-25152.7 506.35,-25162.95 513.33,-25162.39"/>
</g>
<!-- expert1_down_1 -->
<g id="node17" class="node">
<title>expert1_down_1</title>
<polygon fill="lightgreen" stroke="black" points="612,-25062.46 396,-25062.46 396,-25009.46 612,-25009.46 612,-25062.46"/>
<text text-anchor="middle" x="504" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="504" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="504" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert1_act_1&#45;&gt;expert1_down_1 -->
<g id="edge20" class="edge">
<title>expert1_act_1&#45;&gt;expert1_down_1</title>
<path fill="none" stroke="black" d="M506.12,-25099.03C505.84,-25090.8 505.52,-25081.54 505.22,-25072.74"/>
<polygon fill="black" stroke="black" points="508.72,-25072.58 504.88,-25062.7 501.72,-25072.81 508.72,-25072.58"/>
</g>
<!-- expert1_agg_1 -->
<g id="node18" class="node">
<title>expert1_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="501" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="501" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="501" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="501" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert1_down_1&#45;&gt;expert1_agg_1 -->
<g id="edge21" class="edge">
<title>expert1_down_1&#45;&gt;expert1_agg_1</title>
<path fill="none" stroke="black" d="M503.22,-25009.21C502.97,-25001.14 502.7,-24991.96 502.42,-24982.9"/>
<polygon fill="black" stroke="black" points="505.92,-24982.67 502.12,-24972.78 498.92,-24982.88 505.92,-24982.67"/>
</g>
<!-- expert1_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge22" class="edge">
<title>expert1_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M558.69,-24902.55C594.82,-24884.23 642.93,-24862.29 688,-24849.51 822.65,-24811.31 982.1,-24793.89 1093.05,-24785.99"/>
<polygon fill="purple" stroke="purple" points="1093.56,-24789.46 1103.29,-24785.28 1093.07,-24782.48 1093.56,-24789.46"/>
<text text-anchor="middle" x="759.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;7</text>
<text text-anchor="middle" x="759.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_1 -->
<g id="node20" class="node">
<title>expert2_act_1</title>
<polygon fill="lightgreen" stroke="black" points="831,-25152.46 663,-25152.46 663,-25099.46 831,-25099.46 831,-25152.46"/>
<text text-anchor="middle" x="747" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="747" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="747" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert2_up_1&#45;&gt;expert2_act_1 -->
<g id="edge24" class="edge">
<title>expert2_up_1&#45;&gt;expert2_act_1</title>
<path fill="none" stroke="black" d="M748.41,-25189.03C748.22,-25180.8 748.01,-25171.54 747.81,-25162.74"/>
<polygon fill="black" stroke="black" points="751.31,-25162.62 747.59,-25152.7 744.31,-25162.78 751.31,-25162.62"/>
</g>
<!-- expert2_down_1 -->
<g id="node21" class="node">
<title>expert2_down_1</title>
<polygon fill="lightgreen" stroke="black" points="853,-25062.46 637,-25062.46 637,-25009.46 853,-25009.46 853,-25062.46"/>
<text text-anchor="middle" x="745" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="745" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="745" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert2_act_1&#45;&gt;expert2_down_1 -->
<g id="edge25" class="edge">
<title>expert2_act_1&#45;&gt;expert2_down_1</title>
<path fill="none" stroke="black" d="M746.41,-25099.03C746.22,-25090.8 746.01,-25081.54 745.81,-25072.74"/>
<polygon fill="black" stroke="black" points="749.31,-25072.62 745.59,-25062.7 742.31,-25072.78 749.31,-25072.62"/>
</g>
<!-- expert2_agg_1 -->
<g id="node22" class="node">
<title>expert2_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="744" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="744" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="744" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="744" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert2_down_1&#45;&gt;expert2_agg_1 -->
<g id="edge26" class="edge">
<title>expert2_down_1&#45;&gt;expert2_agg_1</title>
<path fill="none" stroke="black" d="M744.74,-25009.21C744.66,-25001.14 744.57,-24991.96 744.47,-24982.9"/>
<polygon fill="black" stroke="black" points="747.97,-24982.74 744.37,-24972.78 740.97,-24982.81 747.97,-24982.74"/>
</g>
<!-- expert2_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge27" class="edge">
<title>expert2_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M793.87,-24901.25C822.68,-24883.63 860.22,-24862.85 896,-24849.51 961.21,-24825.19 1036.9,-24808.45 1099.72,-24797.46"/>
<polygon fill="purple" stroke="purple" points="1100.42,-24800.88 1109.69,-24795.74 1099.24,-24793.99 1100.42,-24800.88"/>
<text text-anchor="middle" x="967.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;7</text>
<text text-anchor="middle" x="967.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_1 -->
<g id="node24" class="node">
<title>expert3_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1075,-25152.46 907,-25152.46 907,-25099.46 1075,-25099.46 1075,-25152.46"/>
<text text-anchor="middle" x="991" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="991" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="991" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert3_up_1&#45;&gt;expert3_act_1 -->
<g id="edge29" class="edge">
<title>expert3_up_1&#45;&gt;expert3_act_1</title>
<path fill="none" stroke="black" d="M991.71,-25189.03C991.61,-25180.8 991.51,-25171.54 991.41,-25162.74"/>
<polygon fill="black" stroke="black" points="994.91,-25162.66 991.29,-25152.7 987.91,-25162.74 994.91,-25162.66"/>
</g>
<!-- expert3_down_1 -->
<g id="node25" class="node">
<title>expert3_down_1</title>
<polygon fill="lightgreen" stroke="black" points="1097,-25062.46 881,-25062.46 881,-25009.46 1097,-25009.46 1097,-25062.46"/>
<text text-anchor="middle" x="989" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="989" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="989" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert3_act_1&#45;&gt;expert3_down_1 -->
<g id="edge30" class="edge">
<title>expert3_act_1&#45;&gt;expert3_down_1</title>
<path fill="none" stroke="black" d="M990.41,-25099.03C990.22,-25090.8 990.01,-25081.54 989.81,-25072.74"/>
<polygon fill="black" stroke="black" points="993.31,-25072.62 989.59,-25062.7 986.31,-25072.78 993.31,-25072.62"/>
</g>
<!-- expert3_agg_1 -->
<g id="node26" class="node">
<title>expert3_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="987" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="987" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="987" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="987" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert3_down_1&#45;&gt;expert3_agg_1 -->
<g id="edge31" class="edge">
<title>expert3_down_1&#45;&gt;expert3_agg_1</title>
<path fill="none" stroke="black" d="M988.48,-25009.21C988.32,-25001.14 988.13,-24991.96 987.95,-24982.9"/>
<polygon fill="black" stroke="black" points="991.44,-24982.71 987.74,-24972.78 984.45,-24982.85 991.44,-24982.71"/>
</g>
<!-- expert3_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge32" class="edge">
<title>expert3_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1021.99,-24898.96C1039.4,-24882.68 1061.32,-24863.81 1083,-24849.51 1094.2,-24842.12 1106.31,-24835.06 1118.59,-24828.47"/>
<polygon fill="purple" stroke="purple" points="1120.34,-24831.51 1127.56,-24823.75 1117.08,-24825.31 1120.34,-24831.51"/>
<text text-anchor="middle" x="1154.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;7</text>
<text text-anchor="middle" x="1154.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_1 -->
<g id="node28" class="node">
<title>expert4_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1314,-25152.46 1146,-25152.46 1146,-25099.46 1314,-25099.46 1314,-25152.46"/>
<text text-anchor="middle" x="1230" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1230" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1230" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert4_up_1&#45;&gt;expert4_act_1 -->
<g id="edge34" class="edge">
<title>expert4_up_1&#45;&gt;expert4_act_1</title>
<path fill="none" stroke="black" d="M1230,-25189.03C1230,-25180.8 1230,-25171.54 1230,-25162.74"/>
<polygon fill="black" stroke="black" points="1233.5,-25162.7 1230,-25152.7 1226.5,-25162.7 1233.5,-25162.7"/>
</g>
<!-- expert4_down_1 -->
<g id="node29" class="node">
<title>expert4_down_1</title>
<polygon fill="lightgreen" stroke="black" points="1338,-25062.46 1122,-25062.46 1122,-25009.46 1338,-25009.46 1338,-25062.46"/>
<text text-anchor="middle" x="1230" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1230" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1230" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert4_act_1&#45;&gt;expert4_down_1 -->
<g id="edge35" class="edge">
<title>expert4_act_1&#45;&gt;expert4_down_1</title>
<path fill="none" stroke="black" d="M1230,-25099.03C1230,-25090.8 1230,-25081.54 1230,-25072.74"/>
<polygon fill="black" stroke="black" points="1233.5,-25072.7 1230,-25062.7 1226.5,-25072.7 1233.5,-25072.7"/>
</g>
<!-- expert4_agg_1 -->
<g id="node30" class="node">
<title>expert4_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="1230" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1230" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1230" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1230" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert4_down_1&#45;&gt;expert4_agg_1 -->
<g id="edge36" class="edge">
<title>expert4_down_1&#45;&gt;expert4_agg_1</title>
<path fill="none" stroke="black" d="M1230,-25009.21C1230,-25001.14 1230,-24991.96 1230,-24982.9"/>
<polygon fill="black" stroke="black" points="1233.5,-24982.78 1230,-24972.78 1226.5,-24982.78 1233.5,-24982.78"/>
</g>
<!-- expert4_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge37" class="edge">
<title>expert4_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1230,-24897.37C1230,-24880.74 1230,-24860.58 1230,-24841.68"/>
<polygon fill="purple" stroke="purple" points="1233.5,-24841.64 1230,-24831.64 1226.5,-24841.64 1233.5,-24841.64"/>
<text text-anchor="middle" x="1301.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;7</text>
<text text-anchor="middle" x="1301.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_1 -->
<g id="node32" class="node">
<title>expert5_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1550,-25152.46 1382,-25152.46 1382,-25099.46 1550,-25099.46 1550,-25152.46"/>
<text text-anchor="middle" x="1466" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1466" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1466" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert5_up_1&#45;&gt;expert5_act_1 -->
<g id="edge39" class="edge">
<title>expert5_up_1&#45;&gt;expert5_act_1</title>
<path fill="none" stroke="black" d="M1465.29,-25189.03C1465.39,-25180.8 1465.49,-25171.54 1465.59,-25162.74"/>
<polygon fill="black" stroke="black" points="1469.09,-25162.74 1465.71,-25152.7 1462.09,-25162.66 1469.09,-25162.74"/>
</g>
<!-- expert5_down_1 -->
<g id="node33" class="node">
<title>expert5_down_1</title>
<polygon fill="lightgreen" stroke="black" points="1576,-25062.46 1360,-25062.46 1360,-25009.46 1576,-25009.46 1576,-25062.46"/>
<text text-anchor="middle" x="1468" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1468" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1468" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert5_act_1&#45;&gt;expert5_down_1 -->
<g id="edge40" class="edge">
<title>expert5_act_1&#45;&gt;expert5_down_1</title>
<path fill="none" stroke="black" d="M1466.59,-25099.03C1466.78,-25090.8 1466.99,-25081.54 1467.19,-25072.74"/>
<polygon fill="black" stroke="black" points="1470.69,-25072.78 1467.41,-25062.7 1463.69,-25072.62 1470.69,-25072.78"/>
</g>
<!-- expert5_agg_1 -->
<g id="node34" class="node">
<title>expert5_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="1473" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1473" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1473" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1473" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert5_down_1&#45;&gt;expert5_agg_1 -->
<g id="edge41" class="edge">
<title>expert5_down_1&#45;&gt;expert5_agg_1</title>
<path fill="none" stroke="black" d="M1469.3,-25009.21C1469.71,-25001.14 1470.17,-24991.96 1470.63,-24982.9"/>
<polygon fill="black" stroke="black" points="1474.13,-24982.94 1471.14,-24972.78 1467.14,-24982.59 1474.13,-24982.94"/>
</g>
<!-- expert5_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge42" class="edge">
<title>expert5_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1438.01,-24898.96C1420.6,-24882.68 1398.68,-24863.81 1377,-24849.51 1370.36,-24845.13 1363.41,-24840.87 1356.29,-24836.75"/>
<polygon fill="purple" stroke="purple" points="1357.62,-24833.49 1347.2,-24831.62 1354.18,-24839.58 1357.62,-24833.49"/>
<text text-anchor="middle" x="1487.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;7</text>
<text text-anchor="middle" x="1487.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_1 -->
<g id="node36" class="node">
<title>expert6_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1788,-25152.46 1620,-25152.46 1620,-25099.46 1788,-25099.46 1788,-25152.46"/>
<text text-anchor="middle" x="1704" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1704" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1704" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert6_up_1&#45;&gt;expert6_act_1 -->
<g id="edge44" class="edge">
<title>expert6_up_1&#45;&gt;expert6_act_1</title>
<path fill="none" stroke="black" d="M1701.18,-25189.03C1701.55,-25180.8 1701.97,-25171.54 1702.37,-25162.74"/>
<polygon fill="black" stroke="black" points="1705.87,-25162.85 1702.83,-25152.7 1698.88,-25162.53 1705.87,-25162.85"/>
</g>
<!-- expert6_down_1 -->
<g id="node37" class="node">
<title>expert6_down_1</title>
<polygon fill="lightgreen" stroke="black" points="1817,-25062.46 1601,-25062.46 1601,-25009.46 1817,-25009.46 1817,-25062.46"/>
<text text-anchor="middle" x="1709" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1709" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1709" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert6_act_1&#45;&gt;expert6_down_1 -->
<g id="edge45" class="edge">
<title>expert6_act_1&#45;&gt;expert6_down_1</title>
<path fill="none" stroke="black" d="M1705.47,-25099.03C1705.94,-25090.8 1706.47,-25081.54 1706.97,-25072.74"/>
<polygon fill="black" stroke="black" points="1710.46,-25072.88 1707.54,-25062.7 1703.48,-25072.49 1710.46,-25072.88"/>
</g>
<!-- expert6_agg_1 -->
<g id="node38" class="node">
<title>expert6_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="1716" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1716" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1716" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1716" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert6_down_1&#45;&gt;expert6_agg_1 -->
<g id="edge46" class="edge">
<title>expert6_down_1&#45;&gt;expert6_agg_1</title>
<path fill="none" stroke="black" d="M1710.82,-25009.21C1711.39,-25001.14 1712.04,-24991.96 1712.68,-24982.9"/>
<polygon fill="black" stroke="black" points="1716.18,-24983 1713.4,-24972.78 1709.2,-24982.51 1716.18,-24983"/>
</g>
<!-- expert6_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge47" class="edge">
<title>expert6_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1665.78,-24901.27C1636.76,-24883.66 1598.98,-24862.88 1563,-24849.51 1506.58,-24828.54 1442.33,-24813.17 1385.41,-24802.27"/>
<polygon fill="purple" stroke="purple" points="1385.72,-24798.77 1375.24,-24800.36 1384.42,-24805.65 1385.72,-24798.77"/>
<text text-anchor="middle" x="1694.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;7</text>
<text text-anchor="middle" x="1694.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_1 -->
<g id="node40" class="node">
<title>expert7_act_1</title>
<polygon fill="lightgreen" stroke="black" points="2026,-25152.46 1858,-25152.46 1858,-25099.46 2026,-25099.46 2026,-25152.46"/>
<text text-anchor="middle" x="1942" y="-25137.26" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1942" y="-25122.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1942" y="-25107.26" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert7_up_1&#45;&gt;expert7_act_1 -->
<g id="edge49" class="edge">
<title>expert7_up_1&#45;&gt;expert7_act_1</title>
<path fill="none" stroke="black" d="M1938.47,-25189.03C1938.94,-25180.8 1939.47,-25171.54 1939.97,-25162.74"/>
<polygon fill="black" stroke="black" points="1943.46,-25162.88 1940.54,-25152.7 1936.48,-25162.49 1943.46,-25162.88"/>
</g>
<!-- expert7_down_1 -->
<g id="node41" class="node">
<title>expert7_down_1</title>
<polygon fill="lightgreen" stroke="black" points="2058,-25062.46 1842,-25062.46 1842,-25009.46 2058,-25009.46 2058,-25062.46"/>
<text text-anchor="middle" x="1950" y="-25047.26" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1950" y="-25032.26" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1950" y="-25017.26" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert7_act_1&#45;&gt;expert7_down_1 -->
<g id="edge50" class="edge">
<title>expert7_act_1&#45;&gt;expert7_down_1</title>
<path fill="none" stroke="black" d="M1944.36,-25099.03C1945.11,-25090.8 1945.95,-25081.54 1946.75,-25072.74"/>
<polygon fill="black" stroke="black" points="1950.24,-25072.98 1947.66,-25062.7 1943.27,-25072.34 1950.24,-25072.98"/>
</g>
<!-- expert7_agg_1 -->
<g id="node42" class="node">
<title>expert7_agg_1</title>
<ellipse fill="lightgray" stroke="black" cx="1959" cy="-24934.98" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1959" y="-24946.28" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1959" y="-24931.28" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1959" y="-24916.28" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert7_down_1&#45;&gt;expert7_agg_1 -->
<g id="edge51" class="edge">
<title>expert7_down_1&#45;&gt;expert7_agg_1</title>
<path fill="none" stroke="black" d="M1952.34,-25009.21C1953.08,-25001.14 1953.91,-24991.96 1954.73,-24982.9"/>
<polygon fill="black" stroke="black" points="1958.23,-24983.06 1955.65,-24972.78 1951.26,-24982.42 1958.23,-24983.06"/>
</g>
<!-- expert7_agg_1&#45;&gt;expert_agg_1 -->
<g id="edge52" class="edge">
<title>expert7_agg_1&#45;&gt;expert_agg_1</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1901.07,-24902.78C1864.49,-24884.43 1815.66,-24862.37 1770,-24849.51 1639.63,-24812.78 1486.04,-24795.23 1376.06,-24786.91"/>
<polygon fill="purple" stroke="purple" points="1376.12,-24783.4 1365.89,-24786.15 1375.6,-24790.38 1376.12,-24783.4"/>
<text text-anchor="middle" x="1920.5" y="-24868.31" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;7</text>
<text text-anchor="middle" x="1920.5" y="-24853.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_1&#45;&gt;residual2_1 -->
<g id="edge53" class="edge">
<title>expert_agg_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M1341.73,-24747.95C1429.5,-24724.73 1551.55,-24692.44 1641.69,-24668.6"/>
<polygon fill="black" stroke="black" points="1642.64,-24671.97 1651.41,-24666.03 1640.85,-24665.2 1642.64,-24671.97"/>
</g>
<!-- layer_out_1 -->
<g id="node45" class="node">
<title>layer_out_1</title>
<ellipse fill="lightgray" stroke="black" cx="1763" cy="-24508.03" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1763" y="-24519.33" font-family="Times,serif" font-size="14.00">Layer1_Output</text>
<text text-anchor="middle" x="1763" y="-24504.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1763" y="-24489.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual2_1&#45;&gt;layer_out_1 -->
<g id="edge55" class="edge">
<title>residual2_1&#45;&gt;layer_out_1</title>
<path fill="none" stroke="black" d="M1763,-24582.38C1763,-24573.48 1763,-24564.28 1763,-24555.53"/>
<polygon fill="black" stroke="black" points="1766.5,-24555.52 1763,-24545.52 1759.5,-24555.52 1766.5,-24555.52"/>
</g>
<!-- ln1_2 -->
<g id="node46" class="node">
<title>ln1_2</title>
<polygon fill="lightyellow" stroke="black" points="1582.5,-24383.55 1423.5,-24383.55 1423.5,-24330.55 1582.5,-24330.55 1582.5,-24383.55"/>
<text text-anchor="middle" x="1503" y="-24368.35" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1503" y="-24353.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1503" y="-24338.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- layer_out_1&#45;&gt;ln1_2 -->
<g id="edge56" class="edge">
<title>layer_out_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1692.93,-24478.71C1675.34,-24470.86 1656.71,-24461.91 1640,-24452.55 1606.56,-24433.83 1570.99,-24409.14 1544.48,-24389.69"/>
<polygon fill="red" stroke="red" points="1546.33,-24386.7 1536.2,-24383.57 1542.17,-24392.33 1546.33,-24386.7"/>
<text text-anchor="middle" x="1711.5" y="-24441.35" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;1</text>
<text text-anchor="middle" x="1711.5" y="-24426.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_2 -->
<g id="node52" class="node">
<title>residual1_2</title>
<polygon fill="lightpink" stroke="black" points="1914.69,-24023.55 1652.71,-24023.55 1585.31,-23917.55 1847.29,-23917.55 1914.69,-24023.55"/>
<text text-anchor="middle" x="1750" y="-23981.85" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1750" y="-23966.85" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1750" y="-23951.85" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- layer_out_1&#45;&gt;residual1_2 -->
<g id="edge64" class="edge">
<title>layer_out_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M1777.49,-24470.72C1779.55,-24464.72 1781.48,-24458.51 1783,-24452.55 1793.48,-24411.41 1797,-24400.51 1797,-24358.05 1797,-24358.05 1797,-24358.05 1797,-24086.05 1797,-24068.18 1792.04,-24049.83 1785.34,-24033.21"/>
<polygon fill="black" stroke="black" points="1788.39,-24031.44 1781.22,-24023.64 1781.96,-24034.21 1788.39,-24031.44"/>
</g>
<!-- mha_q_2 -->
<g id="node47" class="node">
<title>mha_q_2</title>
<polygon fill="lightcoral" stroke="black" points="1294.5,-24293.55 1075.5,-24293.55 1075.5,-24240.55 1294.5,-24240.55 1294.5,-24293.55"/>
<text text-anchor="middle" x="1185" y="-24278.35" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1185" y="-24263.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1185" y="-24248.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_q_2 -->
<g id="edge57" class="edge">
<title>ln1_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M1423.17,-24333.96C1381.94,-24322.55 1331.19,-24308.51 1287.14,-24296.32"/>
<polygon fill="black" stroke="black" points="1287.84,-24292.88 1277.27,-24293.59 1285.98,-24299.63 1287.84,-24292.88"/>
</g>
<!-- mha_k_2 -->
<g id="node48" class="node">
<title>mha_k_2</title>
<polygon fill="lightcoral" stroke="black" points="1531.5,-24293.55 1312.5,-24293.55 1312.5,-24240.55 1531.5,-24240.55 1531.5,-24293.55"/>
<text text-anchor="middle" x="1422" y="-24278.35" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1422" y="-24263.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1422" y="-24248.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_k_2 -->
<g id="edge58" class="edge">
<title>ln1_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M1479.14,-24330.13C1470.81,-24321.08 1461.36,-24310.81 1452.57,-24301.26"/>
<polygon fill="black" stroke="black" points="1455.04,-24298.78 1445.69,-24293.79 1449.89,-24303.52 1455.04,-24298.78"/>
</g>
<!-- mha_v_2 -->
<g id="node49" class="node">
<title>mha_v_2</title>
<polygon fill="lightcoral" stroke="black" points="1768.5,-24293.55 1549.5,-24293.55 1549.5,-24240.55 1768.5,-24240.55 1768.5,-24293.55"/>
<text text-anchor="middle" x="1659" y="-24278.35" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1659" y="-24263.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1659" y="-24248.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_v_2 -->
<g id="edge59" class="edge">
<title>ln1_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M1548.54,-24330.36C1566.16,-24320.42 1586.47,-24308.97 1604.84,-24298.61"/>
<polygon fill="black" stroke="black" points="1606.68,-24301.58 1613.67,-24293.62 1603.24,-24295.49 1606.68,-24301.58"/>
</g>
<!-- mha_attn_2 -->
<g id="node50" class="node">
<title>mha_attn_2</title>
<polygon fill="lightcoral" stroke="black" points="1557.5,-24203.55 1386.5,-24203.55 1386.5,-24150.55 1557.5,-24150.55 1557.5,-24203.55"/>
<text text-anchor="middle" x="1472" y="-24188.35" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1472" y="-24173.35" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1472" y="-24158.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge60" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M1268.4,-24240.48C1302.89,-24229.91 1343.04,-24217.6 1378.52,-24206.72"/>
<polygon fill="black" stroke="black" points="1379.86,-24209.97 1388.39,-24203.69 1377.81,-24203.27 1379.86,-24209.97"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge61" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M1436.73,-24240.13C1441.61,-24231.53 1447.13,-24221.83 1452.32,-24212.68"/>
<polygon fill="black" stroke="black" points="1455.48,-24214.22 1457.37,-24203.79 1449.39,-24210.76 1455.48,-24214.22"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge62" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M1604.66,-24240.48C1583.05,-24230.31 1558.04,-24218.54 1535.59,-24207.98"/>
<polygon fill="black" stroke="black" points="1537.01,-24204.78 1526.47,-24203.69 1534.03,-24211.11 1537.01,-24204.78"/>
</g>
<!-- mha_out_2 -->
<g id="node51" class="node">
<title>mha_out_2</title>
<polygon fill="lightcoral" stroke="black" points="1702.5,-24113.55 1543.5,-24113.55 1543.5,-24060.55 1702.5,-24060.55 1702.5,-24113.55"/>
<text text-anchor="middle" x="1623" y="-24098.35" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1623" y="-24083.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1623" y="-24068.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge63" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M1516.08,-24150.36C1532.98,-24140.51 1552.44,-24129.17 1570.09,-24118.89"/>
<polygon fill="black" stroke="black" points="1572.25,-24121.68 1579.12,-24113.62 1568.72,-24115.63 1572.25,-24121.68"/>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge65" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M1651.5,-24060.36C1661.4,-24051.43 1672.95,-24041.02 1684.58,-24030.53"/>
<polygon fill="black" stroke="black" points="1687.14,-24032.94 1692.22,-24023.64 1682.45,-24027.74 1687.14,-24032.94"/>
</g>
<!-- ln2_2 -->
<g id="node53" class="node">
<title>ln2_2</title>
<polygon fill="lightyellow" stroke="black" points="1699.5,-23880.55 1540.5,-23880.55 1540.5,-23827.55 1699.5,-23827.55 1699.5,-23880.55"/>
<text text-anchor="middle" x="1620" y="-23865.35" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1620" y="-23850.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1620" y="-23835.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge66" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M1690.71,-23917.33C1679.18,-23907.18 1667.41,-23896.81 1656.87,-23887.53"/>
<polygon fill="black" stroke="black" points="1658.89,-23884.64 1649.07,-23880.66 1654.26,-23889.89 1658.89,-23884.64"/>
</g>
<!-- residual2_2 -->
<g id="node88" class="node">
<title>residual2_2</title>
<polygon fill="lightpink" stroke="black" points="1907.69,-23064.6 1645.71,-23064.6 1578.31,-22958.6 1840.29,-22958.6 1907.69,-23064.6"/>
<text text-anchor="middle" x="1743" y="-23022.9" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1743" y="-23007.9" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1743" y="-22992.9" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge109" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M1869.64,-23951.97C1966.87,-23934.19 2088,-23902.53 2088,-23855.05 2088,-23855.05 2088,-23855.05 2088,-23153.6 2088,-23110.68 1995.35,-23074.38 1906.07,-23049.36"/>
<polygon fill="black" stroke="black" points="1906.9,-23045.96 1896.33,-23046.67 1905.04,-23052.71 1906.9,-23045.96"/>
</g>
<!-- gate_2 -->
<g id="node54" class="node">
<title>gate_2</title>
<polygon fill="orange" stroke="black" points="1228,-23790.55 1048,-23737.55 1228,-23684.55 1408,-23737.55 1228,-23790.55"/>
<text text-anchor="middle" x="1228" y="-23748.85" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1228" y="-23733.85" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1228" y="-23718.85" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln2_2&#45;&gt;gate_2 -->
<g id="edge67" class="edge">
<title>ln2_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M1540.2,-23829.74C1478.56,-23811.74 1392.92,-23786.72 1326.92,-23767.45"/>
<polygon fill="black" stroke="black" points="1327.5,-23763.97 1316.92,-23764.53 1325.54,-23770.69 1327.5,-23763.97"/>
</g>
<!-- expert0_up_2 -->
<g id="node55" class="node">
<title>expert0_up_2</title>
<polygon fill="lightgreen" stroke="black" points="369,-23618.55 153,-23618.55 153,-23565.55 369,-23565.55 369,-23618.55"/>
<text text-anchor="middle" x="261" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="261" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="261" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- gate_2&#45;&gt;expert0_up_2 -->
<g id="edge68" class="edge">
<title>gate_2&#45;&gt;expert0_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1080.55,-23727.9C941.61,-23718.22 728.02,-23699.42 545,-23666.55 481.04,-23655.07 410.29,-23636.77 355.41,-23621.31"/>
<polygon fill="blue" stroke="blue" points="356.27,-23617.92 345.7,-23618.56 354.36,-23624.65 356.27,-23617.92"/>
<text text-anchor="middle" x="596.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="596.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;1</text>
</g>
<!-- expert1_up_2 -->
<g id="node59" class="node">
<title>expert1_up_2</title>
<polygon fill="lightgreen" stroke="black" points="621,-23618.55 405,-23618.55 405,-23565.55 621,-23565.55 621,-23618.55"/>
<text text-anchor="middle" x="513" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="513" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="513" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- gate_2&#45;&gt;expert1_up_2 -->
<g id="edge73" class="edge">
<title>gate_2&#45;&gt;expert1_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1100.62,-23722.05C1006.91,-23710.24 876.76,-23691.45 764,-23666.55 708.83,-23654.37 647.99,-23636.67 600.03,-23621.69"/>
<polygon fill="blue" stroke="blue" points="600.9,-23618.29 590.31,-23618.63 598.8,-23624.97 600.9,-23618.29"/>
<text text-anchor="middle" x="815.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="815.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;2</text>
</g>
<!-- expert2_up_2 -->
<g id="node63" class="node">
<title>expert2_up_2</title>
<polygon fill="lightgreen" stroke="black" points="855,-23618.55 639,-23618.55 639,-23565.55 855,-23565.55 855,-23618.55"/>
<text text-anchor="middle" x="747" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="747" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="747" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- gate_2&#45;&gt;expert2_up_2 -->
<g id="edge78" class="edge">
<title>gate_2&#45;&gt;expert2_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1130.68,-23713.2C1079.34,-23700.39 1015.46,-23683.66 959,-23666.55 914.57,-23653.09 865.56,-23636.24 825.87,-23622.06"/>
<polygon fill="blue" stroke="blue" points="826.84,-23618.69 816.25,-23618.62 824.48,-23625.28 826.84,-23618.69"/>
<text text-anchor="middle" x="1010.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1010.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;3</text>
</g>
<!-- expert3_up_2 -->
<g id="node67" class="node">
<title>expert3_up_2</title>
<polygon fill="lightgreen" stroke="black" points="1098,-23618.55 882,-23618.55 882,-23565.55 1098,-23565.55 1098,-23618.55"/>
<text text-anchor="middle" x="990" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="990" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="990" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- gate_2&#45;&gt;expert3_up_2 -->
<g id="edge83" class="edge">
<title>gate_2&#45;&gt;expert3_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1169.78,-23701.45C1130.41,-23677.71 1078.91,-23646.66 1041.13,-23623.88"/>
<polygon fill="blue" stroke="blue" points="1042.69,-23620.74 1032.32,-23618.57 1039.08,-23626.73 1042.69,-23620.74"/>
<text text-anchor="middle" x="1160.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1160.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;4</text>
</g>
<!-- expert4_up_2 -->
<g id="node71" class="node">
<title>expert4_up_2</title>
<polygon fill="lightgreen" stroke="black" points="1336,-23618.55 1120,-23618.55 1120,-23565.55 1336,-23565.55 1336,-23618.55"/>
<text text-anchor="middle" x="1228" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1228" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1228" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_2&#45;&gt;expert4_up_2 -->
<g id="edge88" class="edge">
<title>gate_2&#45;&gt;expert4_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1228,-23684.34C1228,-23666.07 1228,-23645.96 1228,-23629.28"/>
<polygon fill="blue" stroke="blue" points="1231.5,-23628.87 1228,-23618.87 1224.5,-23628.87 1231.5,-23628.87"/>
<text text-anchor="middle" x="1279.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1279.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;5</text>
</g>
<!-- expert5_up_2 -->
<g id="node75" class="node">
<title>expert5_up_2</title>
<polygon fill="lightgreen" stroke="black" points="1570,-23618.55 1354,-23618.55 1354,-23565.55 1570,-23565.55 1570,-23618.55"/>
<text text-anchor="middle" x="1462" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1462" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1462" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_2&#45;&gt;expert5_up_2 -->
<g id="edge93" class="edge">
<title>gate_2&#45;&gt;expert5_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1285.54,-23701.27C1324.13,-23677.6 1374.47,-23646.73 1411.5,-23624.02"/>
<polygon fill="blue" stroke="blue" points="1413.44,-23626.94 1420.13,-23618.73 1409.78,-23620.97 1413.44,-23626.94"/>
<text text-anchor="middle" x="1437.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1437.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;6</text>
</g>
<!-- expert6_up_2 -->
<g id="node79" class="node">
<title>expert6_up_2</title>
<polygon fill="lightgreen" stroke="black" points="1804,-23618.55 1588,-23618.55 1588,-23565.55 1804,-23565.55 1804,-23618.55"/>
<text text-anchor="middle" x="1696" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1696" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1696" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_2&#45;&gt;expert6_up_2 -->
<g id="edge98" class="edge">
<title>gate_2&#45;&gt;expert6_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1325.2,-23713.09C1375.58,-23700.37 1437.93,-23683.76 1493,-23666.55 1535.71,-23653.21 1582.73,-23636.33 1620.76,-23622.11"/>
<polygon fill="blue" stroke="blue" points="1622.09,-23625.35 1630.22,-23618.55 1619.63,-23618.79 1622.09,-23625.35"/>
<text text-anchor="middle" x="1628.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1628.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;7</text>
</g>
<!-- expert7_up_2 -->
<g id="node83" class="node">
<title>expert7_up_2</title>
<polygon fill="lightgreen" stroke="black" points="2039,-23618.55 1823,-23618.55 1823,-23565.55 2039,-23565.55 2039,-23618.55"/>
<text text-anchor="middle" x="1931" y="-23603.35" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1931" y="-23588.35" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1931" y="-23573.35" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_2&#45;&gt;expert7_up_2 -->
<g id="edge103" class="edge">
<title>gate_2&#45;&gt;expert7_up_2</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1354.68,-23721.84C1446.67,-23710.01 1573.81,-23691.28 1684,-23666.55 1738.32,-23654.36 1798.19,-23636.66 1845.38,-23621.68"/>
<polygon fill="blue" stroke="blue" points="1846.48,-23625 1854.94,-23618.63 1844.35,-23618.33 1846.48,-23625"/>
<text text-anchor="middle" x="1844.5" y="-23655.35" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1844.5" y="-23640.35" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;8</text>
</g>
<!-- expert0_act_2 -->
<g id="node56" class="node">
<title>expert0_act_2</title>
<polygon fill="lightgreen" stroke="black" points="343,-23528.55 175,-23528.55 175,-23475.55 343,-23475.55 343,-23528.55"/>
<text text-anchor="middle" x="259" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="259" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="259" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert0_up_2&#45;&gt;expert0_act_2 -->
<g id="edge69" class="edge">
<title>expert0_up_2&#45;&gt;expert0_act_2</title>
<path fill="none" stroke="black" d="M260.41,-23565.13C260.22,-23556.89 260.01,-23547.63 259.81,-23538.83"/>
<polygon fill="black" stroke="black" points="263.31,-23538.71 259.59,-23528.79 256.31,-23538.87 263.31,-23538.71"/>
</g>
<!-- expert0_down_2 -->
<g id="node57" class="node">
<title>expert0_down_2</title>
<polygon fill="lightgreen" stroke="black" points="365,-23438.55 149,-23438.55 149,-23385.55 365,-23385.55 365,-23438.55"/>
<text text-anchor="middle" x="257" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="257" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="257" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert0_act_2&#45;&gt;expert0_down_2 -->
<g id="edge70" class="edge">
<title>expert0_act_2&#45;&gt;expert0_down_2</title>
<path fill="none" stroke="black" d="M258.41,-23475.13C258.22,-23466.89 258.01,-23457.63 257.81,-23448.83"/>
<polygon fill="black" stroke="black" points="261.31,-23448.71 257.59,-23438.79 254.31,-23448.87 261.31,-23448.71"/>
</g>
<!-- expert0_agg_2 -->
<g id="node58" class="node">
<title>expert0_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="256" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="256" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="256" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="256" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- expert0_down_2&#45;&gt;expert0_agg_2 -->
<g id="edge71" class="edge">
<title>expert0_down_2&#45;&gt;expert0_agg_2</title>
<path fill="none" stroke="black" d="M256.74,-23385.31C256.66,-23377.23 256.57,-23368.05 256.47,-23358.99"/>
<polygon fill="black" stroke="black" points="259.97,-23358.84 256.37,-23348.87 252.97,-23358.91 259.97,-23358.84"/>
</g>
<!-- expert_agg_2 -->
<g id="node87" class="node">
<title>expert_agg_2</title>
<polygon fill="gold" stroke="black" points="1392.69,-23207.6 1130.71,-23207.6 1063.31,-23101.6 1325.29,-23101.6 1392.69,-23207.6"/>
<text text-anchor="middle" x="1228" y="-23165.9" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1228" y="-23150.9" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1228" y="-23135.9" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert0_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge72" class="edge">
<title>expert0_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M316.1,-23279.39C355.66,-23260.62 409.16,-23237.93 459,-23225.6 673.88,-23172.43 931.5,-23158.73 1087.32,-23155.7"/>
<polygon fill="purple" stroke="purple" points="1087.5,-23159.2 1097.44,-23155.52 1087.37,-23152.2 1087.5,-23159.2"/>
<text text-anchor="middle" x="530.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;8</text>
<text text-anchor="middle" x="530.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_2 -->
<g id="node60" class="node">
<title>expert1_act_2</title>
<polygon fill="lightgreen" stroke="black" points="590,-23528.55 422,-23528.55 422,-23475.55 590,-23475.55 590,-23528.55"/>
<text text-anchor="middle" x="506" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="506" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="506" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert1_up_2&#45;&gt;expert1_act_2 -->
<g id="edge74" class="edge">
<title>expert1_up_2&#45;&gt;expert1_act_2</title>
<path fill="none" stroke="black" d="M510.94,-23565.13C510.28,-23556.89 509.55,-23547.63 508.85,-23538.83"/>
<polygon fill="black" stroke="black" points="512.33,-23538.49 508.05,-23528.79 505.35,-23539.04 512.33,-23538.49"/>
</g>
<!-- expert1_down_2 -->
<g id="node61" class="node">
<title>expert1_down_2</title>
<polygon fill="lightgreen" stroke="black" points="610,-23438.55 394,-23438.55 394,-23385.55 610,-23385.55 610,-23438.55"/>
<text text-anchor="middle" x="502" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="502" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="502" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert1_act_2&#45;&gt;expert1_down_2 -->
<g id="edge75" class="edge">
<title>expert1_act_2&#45;&gt;expert1_down_2</title>
<path fill="none" stroke="black" d="M504.82,-23475.13C504.45,-23466.89 504.03,-23457.63 503.63,-23448.83"/>
<polygon fill="black" stroke="black" points="507.12,-23448.63 503.17,-23438.79 500.13,-23448.94 507.12,-23448.63"/>
</g>
<!-- expert1_agg_2 -->
<g id="node62" class="node">
<title>expert1_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="499" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="499" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="499" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="499" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert1_down_2&#45;&gt;expert1_agg_2 -->
<g id="edge76" class="edge">
<title>expert1_down_2&#45;&gt;expert1_agg_2</title>
<path fill="none" stroke="black" d="M501.22,-23385.31C500.97,-23377.23 500.7,-23368.05 500.42,-23358.99"/>
<polygon fill="black" stroke="black" points="503.92,-23358.76 500.12,-23348.87 496.92,-23358.97 503.92,-23358.76"/>
</g>
<!-- expert1_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge77" class="edge">
<title>expert1_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M556.69,-23278.64C592.82,-23260.32 640.93,-23238.38 686,-23225.6 820.65,-23187.41 980.1,-23169.99 1091.05,-23162.08"/>
<polygon fill="purple" stroke="purple" points="1091.56,-23165.55 1101.29,-23161.37 1091.07,-23158.57 1091.56,-23165.55"/>
<text text-anchor="middle" x="757.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;8</text>
<text text-anchor="middle" x="757.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_2 -->
<g id="node64" class="node">
<title>expert2_act_2</title>
<polygon fill="lightgreen" stroke="black" points="829,-23528.55 661,-23528.55 661,-23475.55 829,-23475.55 829,-23528.55"/>
<text text-anchor="middle" x="745" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="745" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="745" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert2_up_2&#45;&gt;expert2_act_2 -->
<g id="edge79" class="edge">
<title>expert2_up_2&#45;&gt;expert2_act_2</title>
<path fill="none" stroke="black" d="M746.41,-23565.13C746.22,-23556.89 746.01,-23547.63 745.81,-23538.83"/>
<polygon fill="black" stroke="black" points="749.31,-23538.71 745.59,-23528.79 742.31,-23538.87 749.31,-23538.71"/>
</g>
<!-- expert2_down_2 -->
<g id="node65" class="node">
<title>expert2_down_2</title>
<polygon fill="lightgreen" stroke="black" points="851,-23438.55 635,-23438.55 635,-23385.55 851,-23385.55 851,-23438.55"/>
<text text-anchor="middle" x="743" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="743" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="743" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert2_act_2&#45;&gt;expert2_down_2 -->
<g id="edge80" class="edge">
<title>expert2_act_2&#45;&gt;expert2_down_2</title>
<path fill="none" stroke="black" d="M744.41,-23475.13C744.22,-23466.89 744.01,-23457.63 743.81,-23448.83"/>
<polygon fill="black" stroke="black" points="747.31,-23448.71 743.59,-23438.79 740.31,-23448.87 747.31,-23448.71"/>
</g>
<!-- expert2_agg_2 -->
<g id="node66" class="node">
<title>expert2_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="742" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="742" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="742" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="742" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert2_down_2&#45;&gt;expert2_agg_2 -->
<g id="edge81" class="edge">
<title>expert2_down_2&#45;&gt;expert2_agg_2</title>
<path fill="none" stroke="black" d="M742.74,-23385.31C742.66,-23377.23 742.57,-23368.05 742.47,-23358.99"/>
<polygon fill="black" stroke="black" points="745.97,-23358.84 742.37,-23348.87 738.97,-23358.91 745.97,-23358.84"/>
</g>
<!-- expert2_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge82" class="edge">
<title>expert2_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M791.87,-23277.34C820.68,-23259.73 858.22,-23238.94 894,-23225.6 959.21,-23201.28 1034.9,-23184.54 1097.72,-23173.55"/>
<polygon fill="purple" stroke="purple" points="1098.42,-23176.98 1107.69,-23171.83 1097.24,-23170.08 1098.42,-23176.98"/>
<text text-anchor="middle" x="965.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;8</text>
<text text-anchor="middle" x="965.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_2 -->
<g id="node68" class="node">
<title>expert3_act_2</title>
<polygon fill="lightgreen" stroke="black" points="1072,-23528.55 904,-23528.55 904,-23475.55 1072,-23475.55 1072,-23528.55"/>
<text text-anchor="middle" x="988" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="988" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="988" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert3_up_2&#45;&gt;expert3_act_2 -->
<g id="edge84" class="edge">
<title>expert3_up_2&#45;&gt;expert3_act_2</title>
<path fill="none" stroke="black" d="M989.41,-23565.13C989.22,-23556.89 989.01,-23547.63 988.81,-23538.83"/>
<polygon fill="black" stroke="black" points="992.31,-23538.71 988.59,-23528.79 985.31,-23538.87 992.31,-23538.71"/>
</g>
<!-- expert3_down_2 -->
<g id="node69" class="node">
<title>expert3_down_2</title>
<polygon fill="lightgreen" stroke="black" points="1094,-23438.55 878,-23438.55 878,-23385.55 1094,-23385.55 1094,-23438.55"/>
<text text-anchor="middle" x="986" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="986" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="986" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert3_act_2&#45;&gt;expert3_down_2 -->
<g id="edge85" class="edge">
<title>expert3_act_2&#45;&gt;expert3_down_2</title>
<path fill="none" stroke="black" d="M987.41,-23475.13C987.22,-23466.89 987.01,-23457.63 986.81,-23448.83"/>
<polygon fill="black" stroke="black" points="990.31,-23448.71 986.59,-23438.79 983.31,-23448.87 990.31,-23448.71"/>
</g>
<!-- expert3_agg_2 -->
<g id="node70" class="node">
<title>expert3_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="985" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="985" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="985" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="985" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert3_down_2&#45;&gt;expert3_agg_2 -->
<g id="edge86" class="edge">
<title>expert3_down_2&#45;&gt;expert3_agg_2</title>
<path fill="none" stroke="black" d="M985.74,-23385.31C985.66,-23377.23 985.57,-23368.05 985.47,-23358.99"/>
<polygon fill="black" stroke="black" points="988.97,-23358.84 985.37,-23348.87 981.97,-23358.91 988.97,-23358.84"/>
</g>
<!-- expert3_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge87" class="edge">
<title>expert3_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1019.99,-23275.05C1037.4,-23258.77 1059.32,-23239.9 1081,-23225.6 1092.2,-23218.21 1104.31,-23211.16 1116.59,-23204.56"/>
<polygon fill="purple" stroke="purple" points="1118.34,-23207.6 1125.56,-23199.85 1115.08,-23201.4 1118.34,-23207.6"/>
<text text-anchor="middle" x="1152.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;8</text>
<text text-anchor="middle" x="1152.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_2 -->
<g id="node72" class="node">
<title>expert4_act_2</title>
<polygon fill="lightgreen" stroke="black" points="1312,-23528.55 1144,-23528.55 1144,-23475.55 1312,-23475.55 1312,-23528.55"/>
<text text-anchor="middle" x="1228" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1228" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1228" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert4_up_2&#45;&gt;expert4_act_2 -->
<g id="edge89" class="edge">
<title>expert4_up_2&#45;&gt;expert4_act_2</title>
<path fill="none" stroke="black" d="M1228,-23565.13C1228,-23556.89 1228,-23547.63 1228,-23538.83"/>
<polygon fill="black" stroke="black" points="1231.5,-23538.79 1228,-23528.79 1224.5,-23538.79 1231.5,-23538.79"/>
</g>
<!-- expert4_down_2 -->
<g id="node73" class="node">
<title>expert4_down_2</title>
<polygon fill="lightgreen" stroke="black" points="1336,-23438.55 1120,-23438.55 1120,-23385.55 1336,-23385.55 1336,-23438.55"/>
<text text-anchor="middle" x="1228" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1228" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1228" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert4_act_2&#45;&gt;expert4_down_2 -->
<g id="edge90" class="edge">
<title>expert4_act_2&#45;&gt;expert4_down_2</title>
<path fill="none" stroke="black" d="M1228,-23475.13C1228,-23466.89 1228,-23457.63 1228,-23448.83"/>
<polygon fill="black" stroke="black" points="1231.5,-23448.79 1228,-23438.79 1224.5,-23448.79 1231.5,-23448.79"/>
</g>
<!-- expert4_agg_2 -->
<g id="node74" class="node">
<title>expert4_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="1228" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1228" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1228" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1228" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert4_down_2&#45;&gt;expert4_agg_2 -->
<g id="edge91" class="edge">
<title>expert4_down_2&#45;&gt;expert4_agg_2</title>
<path fill="none" stroke="black" d="M1228,-23385.31C1228,-23377.23 1228,-23368.05 1228,-23358.99"/>
<polygon fill="black" stroke="black" points="1231.5,-23358.87 1228,-23348.87 1224.5,-23358.87 1231.5,-23358.87"/>
</g>
<!-- expert4_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge92" class="edge">
<title>expert4_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1228,-23273.47C1228,-23256.83 1228,-23236.67 1228,-23217.77"/>
<polygon fill="purple" stroke="purple" points="1231.5,-23217.73 1228,-23207.73 1224.5,-23217.73 1231.5,-23217.73"/>
<text text-anchor="middle" x="1299.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;8</text>
<text text-anchor="middle" x="1299.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_2 -->
<g id="node76" class="node">
<title>expert5_act_2</title>
<polygon fill="lightgreen" stroke="black" points="1547,-23528.55 1379,-23528.55 1379,-23475.55 1547,-23475.55 1547,-23528.55"/>
<text text-anchor="middle" x="1463" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1463" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1463" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert5_up_2&#45;&gt;expert5_act_2 -->
<g id="edge94" class="edge">
<title>expert5_up_2&#45;&gt;expert5_act_2</title>
<path fill="none" stroke="black" d="M1462.29,-23565.13C1462.39,-23556.89 1462.49,-23547.63 1462.59,-23538.83"/>
<polygon fill="black" stroke="black" points="1466.09,-23538.83 1462.71,-23528.79 1459.09,-23538.75 1466.09,-23538.83"/>
</g>
<!-- expert5_down_2 -->
<g id="node77" class="node">
<title>expert5_down_2</title>
<polygon fill="lightgreen" stroke="black" points="1572,-23438.55 1356,-23438.55 1356,-23385.55 1572,-23385.55 1572,-23438.55"/>
<text text-anchor="middle" x="1464" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1464" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1464" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert5_act_2&#45;&gt;expert5_down_2 -->
<g id="edge95" class="edge">
<title>expert5_act_2&#45;&gt;expert5_down_2</title>
<path fill="none" stroke="black" d="M1463.29,-23475.13C1463.39,-23466.89 1463.49,-23457.63 1463.59,-23448.83"/>
<polygon fill="black" stroke="black" points="1467.09,-23448.83 1463.71,-23438.79 1460.09,-23448.75 1467.09,-23448.83"/>
</g>
<!-- expert5_agg_2 -->
<g id="node78" class="node">
<title>expert5_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="1471" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1471" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1471" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1471" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert5_down_2&#45;&gt;expert5_agg_2 -->
<g id="edge96" class="edge">
<title>expert5_down_2&#45;&gt;expert5_agg_2</title>
<path fill="none" stroke="black" d="M1465.82,-23385.31C1466.39,-23377.23 1467.04,-23368.05 1467.68,-23358.99"/>
<polygon fill="black" stroke="black" points="1471.18,-23359.1 1468.4,-23348.87 1464.2,-23358.6 1471.18,-23359.1"/>
</g>
<!-- expert5_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge97" class="edge">
<title>expert5_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1436.01,-23275.05C1418.6,-23258.77 1396.68,-23239.9 1375,-23225.6 1368.36,-23221.22 1361.41,-23216.96 1354.29,-23212.85"/>
<polygon fill="purple" stroke="purple" points="1355.62,-23209.58 1345.2,-23207.71 1352.18,-23215.68 1355.62,-23209.58"/>
<text text-anchor="middle" x="1485.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;8</text>
<text text-anchor="middle" x="1485.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_2 -->
<g id="node80" class="node">
<title>expert6_act_2</title>
<polygon fill="lightgreen" stroke="black" points="1786,-23528.55 1618,-23528.55 1618,-23475.55 1786,-23475.55 1786,-23528.55"/>
<text text-anchor="middle" x="1702" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1702" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1702" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert6_up_2&#45;&gt;expert6_act_2 -->
<g id="edge99" class="edge">
<title>expert6_up_2&#45;&gt;expert6_act_2</title>
<path fill="none" stroke="black" d="M1697.77,-23565.13C1698.33,-23556.89 1698.96,-23547.63 1699.56,-23538.83"/>
<polygon fill="black" stroke="black" points="1703.06,-23539.01 1700.24,-23528.79 1696.07,-23538.53 1703.06,-23539.01"/>
</g>
<!-- expert6_down_2 -->
<g id="node81" class="node">
<title>expert6_down_2</title>
<polygon fill="lightgreen" stroke="black" points="1813,-23438.55 1597,-23438.55 1597,-23385.55 1813,-23385.55 1813,-23438.55"/>
<text text-anchor="middle" x="1705" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1705" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1705" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert6_act_2&#45;&gt;expert6_down_2 -->
<g id="edge100" class="edge">
<title>expert6_act_2&#45;&gt;expert6_down_2</title>
<path fill="none" stroke="black" d="M1702.88,-23475.13C1703.16,-23466.89 1703.48,-23457.63 1703.78,-23448.83"/>
<polygon fill="black" stroke="black" points="1707.28,-23448.91 1704.12,-23438.79 1700.28,-23448.67 1707.28,-23448.91"/>
</g>
<!-- expert6_agg_2 -->
<g id="node82" class="node">
<title>expert6_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="1714" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1714" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1714" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1714" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert6_down_2&#45;&gt;expert6_agg_2 -->
<g id="edge101" class="edge">
<title>expert6_down_2&#45;&gt;expert6_agg_2</title>
<path fill="none" stroke="black" d="M1707.34,-23385.31C1708.08,-23377.23 1708.91,-23368.05 1709.73,-23358.99"/>
<polygon fill="black" stroke="black" points="1713.23,-23359.15 1710.65,-23348.87 1706.26,-23358.52 1713.23,-23359.15"/>
</g>
<!-- expert6_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge102" class="edge">
<title>expert6_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1663.78,-23277.36C1634.76,-23259.76 1596.98,-23238.97 1561,-23225.6 1504.58,-23204.63 1440.33,-23189.27 1383.41,-23178.36"/>
<polygon fill="purple" stroke="purple" points="1383.72,-23174.86 1373.24,-23176.45 1382.42,-23181.74 1383.72,-23174.86"/>
<text text-anchor="middle" x="1692.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;8</text>
<text text-anchor="middle" x="1692.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_2 -->
<g id="node84" class="node">
<title>expert7_act_2</title>
<polygon fill="lightgreen" stroke="black" points="2022,-23528.55 1854,-23528.55 1854,-23475.55 2022,-23475.55 2022,-23528.55"/>
<text text-anchor="middle" x="1938" y="-23513.35" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1938" y="-23498.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1938" y="-23483.35" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert7_up_2&#45;&gt;expert7_act_2 -->
<g id="edge104" class="edge">
<title>expert7_up_2&#45;&gt;expert7_act_2</title>
<path fill="none" stroke="black" d="M1933.06,-23565.13C1933.72,-23556.89 1934.45,-23547.63 1935.15,-23538.83"/>
<polygon fill="black" stroke="black" points="1938.65,-23539.04 1935.95,-23528.79 1931.67,-23538.49 1938.65,-23539.04"/>
</g>
<!-- expert7_down_2 -->
<g id="node85" class="node">
<title>expert7_down_2</title>
<polygon fill="lightgreen" stroke="black" points="2050,-23438.55 1834,-23438.55 1834,-23385.55 2050,-23385.55 2050,-23438.55"/>
<text text-anchor="middle" x="1942" y="-23423.35" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1942" y="-23408.35" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1942" y="-23393.35" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert7_act_2&#45;&gt;expert7_down_2 -->
<g id="edge105" class="edge">
<title>expert7_act_2&#45;&gt;expert7_down_2</title>
<path fill="none" stroke="black" d="M1939.18,-23475.13C1939.55,-23466.89 1939.97,-23457.63 1940.37,-23448.83"/>
<polygon fill="black" stroke="black" points="1943.87,-23448.94 1940.83,-23438.79 1936.88,-23448.63 1943.87,-23448.94"/>
</g>
<!-- expert7_agg_2 -->
<g id="node86" class="node">
<title>expert7_agg_2</title>
<ellipse fill="lightgray" stroke="black" cx="1957" cy="-23311.08" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1957" y="-23322.38" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1957" y="-23307.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1957" y="-23292.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert7_down_2&#45;&gt;expert7_agg_2 -->
<g id="edge106" class="edge">
<title>expert7_down_2&#45;&gt;expert7_agg_2</title>
<path fill="none" stroke="black" d="M1945.9,-23385.31C1947.13,-23377.23 1948.52,-23368.05 1949.89,-23358.99"/>
<polygon fill="black" stroke="black" points="1953.39,-23359.28 1951.42,-23348.87 1946.46,-23358.24 1953.39,-23359.28"/>
</g>
<!-- expert7_agg_2&#45;&gt;expert_agg_2 -->
<g id="edge107" class="edge">
<title>expert7_agg_2&#45;&gt;expert_agg_2</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1899.07,-23278.87C1862.49,-23260.52 1813.66,-23238.46 1768,-23225.6 1637.63,-23188.87 1484.04,-23171.33 1374.06,-23163"/>
<polygon fill="purple" stroke="purple" points="1374.12,-23159.49 1363.89,-23162.25 1373.6,-23166.47 1374.12,-23159.49"/>
<text text-anchor="middle" x="1918.5" y="-23244.4" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;8</text>
<text text-anchor="middle" x="1918.5" y="-23229.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_2&#45;&gt;residual2_2 -->
<g id="edge108" class="edge">
<title>expert_agg_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M1339.11,-23123.18C1422.39,-23100.38 1536.27,-23069.2 1621.87,-23045.76"/>
<polygon fill="black" stroke="black" points="1622.92,-23049.1 1631.64,-23043.09 1621.07,-23042.35 1622.92,-23049.1"/>
</g>
<!-- layer_out_2 -->
<g id="node89" class="node">
<title>layer_out_2</title>
<ellipse fill="lightgray" stroke="black" cx="1743" cy="-22884.12" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1743" y="-22895.42" font-family="Times,serif" font-size="14.00">Layer2_Output</text>
<text text-anchor="middle" x="1743" y="-22880.42" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1743" y="-22865.42" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual2_2&#45;&gt;layer_out_2 -->
<g id="edge110" class="edge">
<title>residual2_2&#45;&gt;layer_out_2</title>
<path fill="none" stroke="black" d="M1743,-22958.48C1743,-22949.57 1743,-22940.37 1743,-22931.63"/>
<polygon fill="black" stroke="black" points="1746.5,-22931.61 1743,-22921.61 1739.5,-22931.61 1746.5,-22931.61"/>
</g>
<!-- ln1_3 -->
<g id="node90" class="node">
<title>ln1_3</title>
<polygon fill="lightyellow" stroke="black" points="1541.5,-22759.65 1382.5,-22759.65 1382.5,-22706.65 1541.5,-22706.65 1541.5,-22759.65"/>
<text text-anchor="middle" x="1462" y="-22744.45" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1462" y="-22729.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1462" y="-22714.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- layer_out_2&#45;&gt;ln1_3 -->
<g id="edge111" class="edge">
<title>layer_out_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1669.45,-22855.75C1649.81,-22847.7 1628.83,-22838.41 1610,-22828.65 1573.95,-22809.95 1535.34,-22785.12 1506.6,-22765.6"/>
<polygon fill="red" stroke="red" points="1508.24,-22762.49 1498.01,-22759.73 1504.29,-22768.26 1508.24,-22762.49"/>
<text text-anchor="middle" x="1681.5" y="-22817.45" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;2</text>
<text text-anchor="middle" x="1681.5" y="-22802.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_3 -->
<g id="node96" class="node">
<title>residual1_3</title>
<polygon fill="lightpink" stroke="black" points="1867.69,-22399.65 1605.71,-22399.65 1538.31,-22293.65 1800.29,-22293.65 1867.69,-22399.65"/>
<text text-anchor="middle" x="1703" y="-22357.95" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1703" y="-22342.95" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1703" y="-22327.95" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- layer_out_2&#45;&gt;residual1_3 -->
<g id="edge119" class="edge">
<title>layer_out_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1752.21,-22846.65C1758.98,-22816.65 1767,-22772.92 1767,-22734.15 1767,-22734.15 1767,-22734.15 1767,-22462.15 1767,-22443.51 1760.46,-22425.08 1751.56,-22408.64"/>
<polygon fill="black" stroke="black" points="1754.44,-22406.63 1746.4,-22399.72 1748.38,-22410.13 1754.44,-22406.63"/>
</g>
<!-- mha_q_3 -->
<g id="node91" class="node">
<title>mha_q_3</title>
<polygon fill="lightcoral" stroke="black" points="1264.5,-22669.65 1045.5,-22669.65 1045.5,-22616.65 1264.5,-22616.65 1264.5,-22669.65"/>
<text text-anchor="middle" x="1155" y="-22654.45" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1155" y="-22639.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1155" y="-22624.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_q_3 -->
<g id="edge112" class="edge">
<title>ln1_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M1382.14,-22709.26C1343,-22698.03 1295.48,-22684.41 1254.04,-22672.54"/>
<polygon fill="black" stroke="black" points="1254.78,-22669.11 1244.2,-22669.71 1252.85,-22675.83 1254.78,-22669.11"/>
</g>
<!-- mha_k_3 -->
<g id="node92" class="node">
<title>mha_k_3</title>
<polygon fill="lightcoral" stroke="black" points="1501.5,-22669.65 1282.5,-22669.65 1282.5,-22616.65 1501.5,-22616.65 1501.5,-22669.65"/>
<text text-anchor="middle" x="1392" y="-22654.45" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1392" y="-22639.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1392" y="-22624.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_k_3 -->
<g id="edge113" class="edge">
<title>ln1_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M1441.38,-22706.22C1434.33,-22697.36 1426.34,-22687.31 1418.87,-22677.92"/>
<polygon fill="black" stroke="black" points="1421.44,-22675.54 1412.48,-22669.89 1415.96,-22679.89 1421.44,-22675.54"/>
</g>
<!-- mha_v_3 -->
<g id="node93" class="node">
<title>mha_v_3</title>
<polygon fill="lightcoral" stroke="black" points="1738.5,-22669.65 1519.5,-22669.65 1519.5,-22616.65 1738.5,-22616.65 1738.5,-22669.65"/>
<text text-anchor="middle" x="1629" y="-22654.45" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1629" y="-22639.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1629" y="-22624.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_v_3 -->
<g id="edge114" class="edge">
<title>ln1_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M1510.75,-22706.46C1529.79,-22696.43 1551.75,-22684.85 1571.55,-22674.42"/>
<polygon fill="black" stroke="black" points="1573.26,-22677.47 1580.48,-22669.72 1570,-22671.28 1573.26,-22677.47"/>
</g>
<!-- mha_attn_3 -->
<g id="node94" class="node">
<title>mha_attn_3</title>
<polygon fill="lightcoral" stroke="black" points="1527.5,-22579.65 1356.5,-22579.65 1356.5,-22526.65 1527.5,-22526.65 1527.5,-22579.65"/>
<text text-anchor="middle" x="1442" y="-22564.45" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1442" y="-22549.45" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1442" y="-22534.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge115" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1238.4,-22616.57C1272.89,-22606 1313.04,-22593.69 1348.52,-22582.81"/>
<polygon fill="black" stroke="black" points="1349.86,-22586.06 1358.39,-22579.78 1347.81,-22579.37 1349.86,-22586.06"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge116" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1406.73,-22616.22C1411.61,-22607.63 1417.13,-22597.92 1422.32,-22588.78"/>
<polygon fill="black" stroke="black" points="1425.48,-22590.31 1427.37,-22579.89 1419.39,-22586.85 1425.48,-22590.31"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge117" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1574.66,-22616.57C1553.05,-22606.41 1528.04,-22594.63 1505.59,-22584.07"/>
<polygon fill="black" stroke="black" points="1507.01,-22580.87 1496.47,-22579.78 1504.03,-22587.21 1507.01,-22580.87"/>
</g>
<!-- mha_out_3 -->
<g id="node95" class="node">
<title>mha_out_3</title>
<polygon fill="lightcoral" stroke="black" points="1605.5,-22489.65 1446.5,-22489.65 1446.5,-22436.65 1605.5,-22436.65 1605.5,-22489.65"/>
<text text-anchor="middle" x="1526" y="-22474.45" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1526" y="-22459.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1526" y="-22444.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge118" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M1466.75,-22526.22C1475.38,-22517.18 1485.18,-22506.91 1494.3,-22497.35"/>
<polygon fill="black" stroke="black" points="1497.06,-22499.54 1501.43,-22489.89 1491.99,-22494.7 1497.06,-22499.54"/>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge120" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1565.72,-22436.45C1580.04,-22427.19 1596.84,-22416.32 1613.68,-22405.43"/>
<polygon fill="black" stroke="black" points="1615.98,-22408.11 1622.48,-22399.74 1612.18,-22402.23 1615.98,-22408.11"/>
</g>
<!-- ln2_3 -->
<g id="node97" class="node">
<title>ln2_3</title>
<polygon fill="lightyellow" stroke="black" points="1656.5,-22256.65 1497.5,-22256.65 1497.5,-22203.65 1656.5,-22203.65 1656.5,-22256.65"/>
<text text-anchor="middle" x="1577" y="-22241.45" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1577" y="-22226.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1577" y="-22211.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge121" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M1645.53,-22293.42C1634.36,-22283.27 1622.95,-22272.91 1612.73,-22263.62"/>
<polygon fill="black" stroke="black" points="1614.93,-22260.88 1605.17,-22256.75 1610.22,-22266.06 1614.93,-22260.88"/>
</g>
<!-- residual2_3 -->
<g id="node132" class="node">
<title>residual2_3</title>
<polygon fill="lightpink" stroke="black" points="1943.69,-21440.69 1681.71,-21440.69 1614.31,-21334.69 1876.29,-21334.69 1943.69,-21440.69"/>
<text text-anchor="middle" x="1779" y="-21398.99" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1779" y="-21383.99" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1779" y="-21368.99" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge164" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M1828.15,-22336.91C1895.13,-22324.65 1964,-22296.21 1964,-22231.15 1964,-22231.15 1964,-22231.15 1964,-21529.69 1964,-21495.05 1943.23,-21467.79 1915.6,-21446.86"/>
<polygon fill="black" stroke="black" points="1917.4,-21443.84 1907.24,-21440.85 1913.31,-21449.53 1917.4,-21443.84"/>
</g>
<!-- gate_3 -->
<g id="node98" class="node">
<title>gate_3</title>
<polygon fill="orange" stroke="black" points="1104,-22166.65 924,-22113.65 1104,-22060.65 1284,-22113.65 1104,-22166.65"/>
<text text-anchor="middle" x="1104" y="-22124.95" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1104" y="-22109.95" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1104" y="-22094.95" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln2_3&#45;&gt;gate_3 -->
<g id="edge122" class="edge">
<title>ln2_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M1497.3,-22209.85C1418.71,-22190.83 1298.08,-22161.63 1211.14,-22140.58"/>
<polygon fill="black" stroke="black" points="1211.78,-22137.14 1201.24,-22138.18 1210.13,-22143.94 1211.78,-22137.14"/>
</g>
<!-- expert0_up_3 -->
<g id="node99" class="node">
<title>expert0_up_3</title>
<polygon fill="lightgreen" stroke="black" points="268,-21994.65 52,-21994.65 52,-21941.65 268,-21941.65 268,-21994.65"/>
<text text-anchor="middle" x="160" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="160" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="160" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- gate_3&#45;&gt;expert0_up_3 -->
<g id="edge123" class="edge">
<title>gate_3&#45;&gt;expert0_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M955.98,-22104.13C818.96,-22094.63 610,-22076 431,-22042.65 369.98,-22031.28 302.62,-22013.03 250.32,-21997.57"/>
<polygon fill="blue" stroke="blue" points="251.32,-21994.21 240.74,-21994.72 249.32,-22000.92 251.32,-21994.21"/>
<text text-anchor="middle" x="482.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="482.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;2</text>
</g>
<!-- expert1_up_3 -->
<g id="node103" class="node">
<title>expert1_up_3</title>
<polygon fill="lightgreen" stroke="black" points="510,-21994.65 294,-21994.65 294,-21941.65 510,-21941.65 510,-21994.65"/>
<text text-anchor="middle" x="402" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="402" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="402" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- gate_3&#45;&gt;expert1_up_3 -->
<g id="edge128" class="edge">
<title>gate_3&#45;&gt;expert1_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M977.03,-22098.03C884.83,-22086.24 757.4,-22067.53 647,-22042.65 593.11,-22030.5 533.74,-22012.8 486.94,-21997.81"/>
<polygon fill="blue" stroke="blue" points="487.74,-21994.4 477.15,-21994.66 485.6,-22001.06 487.74,-21994.4"/>
<text text-anchor="middle" x="698.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="698.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;3</text>
</g>
<!-- expert2_up_3 -->
<g id="node107" class="node">
<title>expert2_up_3</title>
<polygon fill="lightgreen" stroke="black" points="744,-21994.65 528,-21994.65 528,-21941.65 744,-21941.65 744,-21994.65"/>
<text text-anchor="middle" x="636" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="636" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="636" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- gate_3&#45;&gt;expert2_up_3 -->
<g id="edge133" class="edge">
<title>gate_3&#45;&gt;expert2_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1006.42,-22089.25C955.85,-22076.55 893.26,-22059.93 838,-22042.65 795.48,-22029.35 748.69,-22012.47 710.85,-21998.24"/>
<polygon fill="blue" stroke="blue" points="712.03,-21994.94 701.44,-21994.68 709.56,-22001.49 712.03,-21994.94"/>
<text text-anchor="middle" x="889.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="889.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;4</text>
</g>
<!-- expert3_up_3 -->
<g id="node111" class="node">
<title>expert3_up_3</title>
<polygon fill="lightgreen" stroke="black" points="978,-21994.65 762,-21994.65 762,-21941.65 978,-21941.65 978,-21994.65"/>
<text text-anchor="middle" x="870" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="870" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="870" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_3&#45;&gt;expert3_up_3 -->
<g id="edge138" class="edge">
<title>gate_3&#45;&gt;expert3_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1046.46,-22077.36C1007.87,-22053.7 957.53,-22022.83 920.5,-22000.12"/>
<polygon fill="blue" stroke="blue" points="922.22,-21997.06 911.87,-21994.82 918.56,-22003.03 922.22,-21997.06"/>
<text text-anchor="middle" x="1038.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1038.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;5</text>
</g>
<!-- expert4_up_3 -->
<g id="node115" class="node">
<title>expert4_up_3</title>
<polygon fill="lightgreen" stroke="black" points="1212,-21994.65 996,-21994.65 996,-21941.65 1212,-21941.65 1212,-21994.65"/>
<text text-anchor="middle" x="1104" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1104" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1104" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_3&#45;&gt;expert4_up_3 -->
<g id="edge143" class="edge">
<title>gate_3&#45;&gt;expert4_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1104,-22060.43C1104,-22042.16 1104,-22022.05 1104,-22005.37"/>
<polygon fill="blue" stroke="blue" points="1107.5,-22004.96 1104,-21994.96 1100.5,-22004.96 1107.5,-22004.96"/>
<text text-anchor="middle" x="1155.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1155.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;6</text>
</g>
<!-- expert5_up_3 -->
<g id="node119" class="node">
<title>expert5_up_3</title>
<polygon fill="lightgreen" stroke="black" points="1450,-21994.65 1234,-21994.65 1234,-21941.65 1450,-21941.65 1450,-21994.65"/>
<text text-anchor="middle" x="1342" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1342" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1342" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_3&#45;&gt;expert5_up_3 -->
<g id="edge148" class="edge">
<title>gate_3&#45;&gt;expert5_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1162.22,-22077.54C1201.59,-22053.81 1253.09,-22022.76 1290.87,-21999.97"/>
<polygon fill="blue" stroke="blue" points="1292.92,-22002.82 1299.68,-21994.66 1289.31,-21996.83 1292.92,-22002.82"/>
<text text-anchor="middle" x="1316.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1316.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;7</text>
</g>
<!-- expert6_up_3 -->
<g id="node123" class="node">
<title>expert6_up_3</title>
<polygon fill="lightgreen" stroke="black" points="1685,-21994.65 1469,-21994.65 1469,-21941.65 1685,-21941.65 1685,-21994.65"/>
<text text-anchor="middle" x="1577" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1577" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1577" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_3&#45;&gt;expert6_up_3 -->
<g id="edge153" class="edge">
<title>gate_3&#45;&gt;expert6_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1201.66,-22089.35C1252.72,-22076.62 1316.06,-22059.94 1372,-22042.65 1415.12,-22029.31 1462.61,-22012.43 1501.01,-21998.21"/>
<polygon fill="blue" stroke="blue" points="1502.41,-22001.42 1510.57,-21994.66 1499.97,-21994.86 1502.41,-22001.42"/>
<text text-anchor="middle" x="1508.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1508.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;8</text>
</g>
<!-- expert7_up_3 -->
<g id="node127" class="node">
<title>expert7_up_3</title>
<polygon fill="lightgreen" stroke="black" points="1920,-21994.65 1704,-21994.65 1704,-21941.65 1920,-21941.65 1920,-21994.65"/>
<text text-anchor="middle" x="1812" y="-21979.45" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1812" y="-21964.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1812" y="-21949.45" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_3&#45;&gt;expert7_up_3 -->
<g id="edge158" class="edge">
<title>gate_3&#45;&gt;expert7_up_3</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1231.29,-22098.04C1324.12,-22086.24 1452.64,-22067.5 1564,-22042.65 1618.64,-22030.45 1678.87,-22012.71 1726.29,-21997.71"/>
<polygon fill="blue" stroke="blue" points="1727.44,-22001.01 1735.91,-21994.65 1725.32,-21994.34 1727.44,-22001.01"/>
<text text-anchor="middle" x="1724.5" y="-22031.45" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1724.5" y="-22016.45" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;9</text>
</g>
<!-- expert0_act_3 -->
<g id="node100" class="node">
<title>expert0_act_3</title>
<polygon fill="lightgreen" stroke="black" points="240,-21904.65 72,-21904.65 72,-21851.65 240,-21851.65 240,-21904.65"/>
<text text-anchor="middle" x="156" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="156" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="156" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert0_up_3&#45;&gt;expert0_act_3 -->
<g id="edge124" class="edge">
<title>expert0_up_3&#45;&gt;expert0_act_3</title>
<path fill="none" stroke="black" d="M158.82,-21941.22C158.45,-21932.98 158.03,-21923.73 157.63,-21914.92"/>
<polygon fill="black" stroke="black" points="161.12,-21914.72 157.17,-21904.89 154.13,-21915.04 161.12,-21914.72"/>
</g>
<!-- expert0_down_3 -->
<g id="node101" class="node">
<title>expert0_down_3</title>
<polygon fill="lightgreen" stroke="black" points="255,-21814.65 39,-21814.65 39,-21761.65 255,-21761.65 255,-21814.65"/>
<text text-anchor="middle" x="147" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="147" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="147" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert0_act_3&#45;&gt;expert0_down_3 -->
<g id="edge125" class="edge">
<title>expert0_act_3&#45;&gt;expert0_down_3</title>
<path fill="none" stroke="black" d="M153.35,-21851.22C152.51,-21842.98 151.56,-21833.73 150.66,-21824.92"/>
<polygon fill="black" stroke="black" points="154.13,-21824.48 149.63,-21814.89 147.17,-21825.19 154.13,-21824.48"/>
</g>
<!-- expert0_agg_3 -->
<g id="node102" class="node">
<title>expert0_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="132" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="132" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="132" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="132" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- expert0_down_3&#45;&gt;expert0_agg_3 -->
<g id="edge126" class="edge">
<title>expert0_down_3&#45;&gt;expert0_agg_3</title>
<path fill="none" stroke="black" d="M143.1,-21761.4C141.87,-21753.33 140.48,-21744.15 139.11,-21735.08"/>
<polygon fill="black" stroke="black" points="142.54,-21734.33 137.58,-21724.97 135.61,-21735.38 142.54,-21734.33"/>
</g>
<!-- expert_agg_3 -->
<g id="node131" class="node">
<title>expert_agg_3</title>
<polygon fill="gold" stroke="black" points="1268.69,-21583.69 1006.71,-21583.69 939.31,-21477.69 1201.29,-21477.69 1268.69,-21583.69"/>
<text text-anchor="middle" x="1104" y="-21541.99" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1104" y="-21526.99" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1104" y="-21511.99" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert0_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge127" class="edge">
<title>expert0_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M192.1,-21655.48C231.66,-21636.72 285.16,-21614.02 335,-21601.69 549.88,-21548.52 807.5,-21534.82 963.32,-21531.79"/>
<polygon fill="purple" stroke="purple" points="963.5,-21535.29 973.44,-21531.61 963.37,-21528.29 963.5,-21535.29"/>
<text text-anchor="middle" x="406.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;9</text>
<text text-anchor="middle" x="406.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_3 -->
<g id="node104" class="node">
<title>expert1_act_3</title>
<polygon fill="lightgreen" stroke="black" points="477,-21904.65 309,-21904.65 309,-21851.65 477,-21851.65 477,-21904.65"/>
<text text-anchor="middle" x="393" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="393" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="393" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert1_up_3&#45;&gt;expert1_act_3 -->
<g id="edge129" class="edge">
<title>expert1_up_3&#45;&gt;expert1_act_3</title>
<path fill="none" stroke="black" d="M399.35,-21941.22C398.51,-21932.98 397.56,-21923.73 396.66,-21914.92"/>
<polygon fill="black" stroke="black" points="400.13,-21914.48 395.63,-21904.89 393.17,-21915.19 400.13,-21914.48"/>
</g>
<!-- expert1_down_3 -->
<g id="node105" class="node">
<title>expert1_down_3</title>
<polygon fill="lightgreen" stroke="black" points="492,-21814.65 276,-21814.65 276,-21761.65 492,-21761.65 492,-21814.65"/>
<text text-anchor="middle" x="384" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="384" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="384" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert1_act_3&#45;&gt;expert1_down_3 -->
<g id="edge130" class="edge">
<title>expert1_act_3&#45;&gt;expert1_down_3</title>
<path fill="none" stroke="black" d="M390.35,-21851.22C389.51,-21842.98 388.56,-21833.73 387.66,-21824.92"/>
<polygon fill="black" stroke="black" points="391.13,-21824.48 386.63,-21814.89 384.17,-21825.19 391.13,-21824.48"/>
</g>
<!-- expert1_agg_3 -->
<g id="node106" class="node">
<title>expert1_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="375" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="375" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="375" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="375" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert1_down_3&#45;&gt;expert1_agg_3 -->
<g id="edge131" class="edge">
<title>expert1_down_3&#45;&gt;expert1_agg_3</title>
<path fill="none" stroke="black" d="M381.66,-21761.4C380.92,-21753.33 380.09,-21744.15 379.27,-21735.08"/>
<polygon fill="black" stroke="black" points="382.74,-21734.61 378.35,-21724.97 375.77,-21735.24 382.74,-21734.61"/>
</g>
<!-- expert1_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge132" class="edge">
<title>expert1_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M432.69,-21654.73C468.82,-21636.42 516.93,-21614.48 562,-21601.69 696.65,-21563.5 856.1,-21546.08 967.05,-21538.18"/>
<polygon fill="purple" stroke="purple" points="967.56,-21541.65 977.29,-21537.46 967.07,-21534.66 967.56,-21541.65"/>
<text text-anchor="middle" x="633.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;9</text>
<text text-anchor="middle" x="633.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_3 -->
<g id="node108" class="node">
<title>expert2_act_3</title>
<polygon fill="lightgreen" stroke="black" points="719,-21904.65 551,-21904.65 551,-21851.65 719,-21851.65 719,-21904.65"/>
<text text-anchor="middle" x="635" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="635" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="635" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert2_up_3&#45;&gt;expert2_act_3 -->
<g id="edge134" class="edge">
<title>expert2_up_3&#45;&gt;expert2_act_3</title>
<path fill="none" stroke="black" d="M635.71,-21941.22C635.61,-21932.98 635.51,-21923.73 635.41,-21914.92"/>
<polygon fill="black" stroke="black" points="638.91,-21914.85 635.29,-21904.89 631.91,-21914.93 638.91,-21914.85"/>
</g>
<!-- expert2_down_3 -->
<g id="node109" class="node">
<title>expert2_down_3</title>
<polygon fill="lightgreen" stroke="black" points="739,-21814.65 523,-21814.65 523,-21761.65 739,-21761.65 739,-21814.65"/>
<text text-anchor="middle" x="631" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="631" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="631" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert2_act_3&#45;&gt;expert2_down_3 -->
<g id="edge135" class="edge">
<title>expert2_act_3&#45;&gt;expert2_down_3</title>
<path fill="none" stroke="black" d="M633.82,-21851.22C633.45,-21842.98 633.03,-21833.73 632.63,-21824.92"/>
<polygon fill="black" stroke="black" points="636.12,-21824.72 632.17,-21814.89 629.13,-21825.04 636.12,-21824.72"/>
</g>
<!-- expert2_agg_3 -->
<g id="node110" class="node">
<title>expert2_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="618" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="618" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="618" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="618" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert2_down_3&#45;&gt;expert2_agg_3 -->
<g id="edge136" class="edge">
<title>expert2_down_3&#45;&gt;expert2_agg_3</title>
<path fill="none" stroke="black" d="M627.62,-21761.4C626.56,-21753.33 625.35,-21744.15 624.16,-21735.08"/>
<polygon fill="black" stroke="black" points="627.61,-21734.43 622.83,-21724.97 620.67,-21735.34 627.61,-21734.43"/>
</g>
<!-- expert2_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge137" class="edge">
<title>expert2_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M667.87,-21653.43C696.68,-21635.82 734.22,-21615.04 770,-21601.69 835.21,-21577.38 910.9,-21560.64 973.72,-21549.64"/>
<polygon fill="purple" stroke="purple" points="974.42,-21553.07 983.69,-21547.93 973.24,-21546.17 974.42,-21553.07"/>
<text text-anchor="middle" x="841.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;9</text>
<text text-anchor="middle" x="841.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_3 -->
<g id="node112" class="node">
<title>expert3_act_3</title>
<polygon fill="lightgreen" stroke="black" points="953,-21904.65 785,-21904.65 785,-21851.65 953,-21851.65 953,-21904.65"/>
<text text-anchor="middle" x="869" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="869" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="869" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert3_up_3&#45;&gt;expert3_act_3 -->
<g id="edge139" class="edge">
<title>expert3_up_3&#45;&gt;expert3_act_3</title>
<path fill="none" stroke="black" d="M869.71,-21941.22C869.61,-21932.98 869.51,-21923.73 869.41,-21914.92"/>
<polygon fill="black" stroke="black" points="872.91,-21914.85 869.29,-21904.89 865.91,-21914.93 872.91,-21914.85"/>
</g>
<!-- expert3_down_3 -->
<g id="node113" class="node">
<title>expert3_down_3</title>
<polygon fill="lightgreen" stroke="black" points="976,-21814.65 760,-21814.65 760,-21761.65 976,-21761.65 976,-21814.65"/>
<text text-anchor="middle" x="868" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="868" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="868" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert3_act_3&#45;&gt;expert3_down_3 -->
<g id="edge140" class="edge">
<title>expert3_act_3&#45;&gt;expert3_down_3</title>
<path fill="none" stroke="black" d="M868.71,-21851.22C868.61,-21842.98 868.51,-21833.73 868.41,-21824.92"/>
<polygon fill="black" stroke="black" points="871.91,-21824.85 868.29,-21814.89 864.91,-21824.93 871.91,-21824.85"/>
</g>
<!-- expert3_agg_3 -->
<g id="node114" class="node">
<title>expert3_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="861" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="861" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="861" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="861" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert3_down_3&#45;&gt;expert3_agg_3 -->
<g id="edge141" class="edge">
<title>expert3_down_3&#45;&gt;expert3_agg_3</title>
<path fill="none" stroke="black" d="M866.18,-21761.4C865.61,-21753.33 864.96,-21744.15 864.32,-21735.08"/>
<polygon fill="black" stroke="black" points="867.8,-21734.69 863.6,-21724.97 860.82,-21735.19 867.8,-21734.69"/>
</g>
<!-- expert3_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge142" class="edge">
<title>expert3_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M895.99,-21651.15C913.4,-21634.87 935.32,-21615.99 957,-21601.69 968.2,-21594.3 980.31,-21587.25 992.59,-21580.66"/>
<polygon fill="purple" stroke="purple" points="994.34,-21583.69 1001.56,-21575.94 991.08,-21577.5 994.34,-21583.69"/>
<text text-anchor="middle" x="1028.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;9</text>
<text text-anchor="middle" x="1028.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_3 -->
<g id="node116" class="node">
<title>expert4_act_3</title>
<polygon fill="lightgreen" stroke="black" points="1188,-21904.65 1020,-21904.65 1020,-21851.65 1188,-21851.65 1188,-21904.65"/>
<text text-anchor="middle" x="1104" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1104" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1104" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert4_up_3&#45;&gt;expert4_act_3 -->
<g id="edge144" class="edge">
<title>expert4_up_3&#45;&gt;expert4_act_3</title>
<path fill="none" stroke="black" d="M1104,-21941.22C1104,-21932.98 1104,-21923.73 1104,-21914.92"/>
<polygon fill="black" stroke="black" points="1107.5,-21914.89 1104,-21904.89 1100.5,-21914.89 1107.5,-21914.89"/>
</g>
<!-- expert4_down_3 -->
<g id="node117" class="node">
<title>expert4_down_3</title>
<polygon fill="lightgreen" stroke="black" points="1212,-21814.65 996,-21814.65 996,-21761.65 1212,-21761.65 1212,-21814.65"/>
<text text-anchor="middle" x="1104" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1104" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1104" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert4_act_3&#45;&gt;expert4_down_3 -->
<g id="edge145" class="edge">
<title>expert4_act_3&#45;&gt;expert4_down_3</title>
<path fill="none" stroke="black" d="M1104,-21851.22C1104,-21842.98 1104,-21833.73 1104,-21824.92"/>
<polygon fill="black" stroke="black" points="1107.5,-21824.89 1104,-21814.89 1100.5,-21824.89 1107.5,-21824.89"/>
</g>
<!-- expert4_agg_3 -->
<g id="node118" class="node">
<title>expert4_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="1104" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1104" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1104" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1104" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert4_down_3&#45;&gt;expert4_agg_3 -->
<g id="edge146" class="edge">
<title>expert4_down_3&#45;&gt;expert4_agg_3</title>
<path fill="none" stroke="black" d="M1104,-21761.4C1104,-21753.33 1104,-21744.15 1104,-21735.08"/>
<polygon fill="black" stroke="black" points="1107.5,-21734.97 1104,-21724.97 1100.5,-21734.97 1107.5,-21734.97"/>
</g>
<!-- expert4_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge147" class="edge">
<title>expert4_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1104,-21649.56C1104,-21632.92 1104,-21612.77 1104,-21593.87"/>
<polygon fill="purple" stroke="purple" points="1107.5,-21593.82 1104,-21583.82 1100.5,-21593.82 1107.5,-21593.82"/>
<text text-anchor="middle" x="1175.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;9</text>
<text text-anchor="middle" x="1175.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_3 -->
<g id="node120" class="node">
<title>expert5_act_3</title>
<polygon fill="lightgreen" stroke="black" points="1427,-21904.65 1259,-21904.65 1259,-21851.65 1427,-21851.65 1427,-21904.65"/>
<text text-anchor="middle" x="1343" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1343" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1343" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert5_up_3&#45;&gt;expert5_act_3 -->
<g id="edge149" class="edge">
<title>expert5_up_3&#45;&gt;expert5_act_3</title>
<path fill="none" stroke="black" d="M1342.29,-21941.22C1342.39,-21932.98 1342.49,-21923.73 1342.59,-21914.92"/>
<polygon fill="black" stroke="black" points="1346.09,-21914.93 1342.71,-21904.89 1339.09,-21914.85 1346.09,-21914.93"/>
</g>
<!-- expert5_down_3 -->
<g id="node121" class="node">
<title>expert5_down_3</title>
<polygon fill="lightgreen" stroke="black" points="1453,-21814.65 1237,-21814.65 1237,-21761.65 1453,-21761.65 1453,-21814.65"/>
<text text-anchor="middle" x="1345" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1345" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1345" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert5_act_3&#45;&gt;expert5_down_3 -->
<g id="edge150" class="edge">
<title>expert5_act_3&#45;&gt;expert5_down_3</title>
<path fill="none" stroke="black" d="M1343.59,-21851.22C1343.78,-21842.98 1343.99,-21833.73 1344.19,-21824.92"/>
<polygon fill="black" stroke="black" points="1347.69,-21824.96 1344.41,-21814.89 1340.69,-21824.81 1347.69,-21824.96"/>
</g>
<!-- expert5_agg_3 -->
<g id="node122" class="node">
<title>expert5_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="1347" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1347" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1347" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1347" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert5_down_3&#45;&gt;expert5_agg_3 -->
<g id="edge151" class="edge">
<title>expert5_down_3&#45;&gt;expert5_agg_3</title>
<path fill="none" stroke="black" d="M1345.52,-21761.4C1345.68,-21753.33 1345.87,-21744.15 1346.05,-21735.08"/>
<polygon fill="black" stroke="black" points="1349.55,-21735.04 1346.26,-21724.97 1342.56,-21734.89 1349.55,-21735.04"/>
</g>
<!-- expert5_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge152" class="edge">
<title>expert5_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1312.01,-21651.15C1294.6,-21634.87 1272.68,-21615.99 1251,-21601.69 1244.36,-21597.32 1237.41,-21593.06 1230.29,-21588.94"/>
<polygon fill="purple" stroke="purple" points="1231.62,-21585.67 1221.2,-21583.81 1228.18,-21591.77 1231.62,-21585.67"/>
<text text-anchor="middle" x="1361.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;9</text>
<text text-anchor="middle" x="1361.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_3 -->
<g id="node124" class="node">
<title>expert6_act_3</title>
<polygon fill="lightgreen" stroke="black" points="1663,-21904.65 1495,-21904.65 1495,-21851.65 1663,-21851.65 1663,-21904.65"/>
<text text-anchor="middle" x="1579" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1579" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1579" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert6_up_3&#45;&gt;expert6_act_3 -->
<g id="edge154" class="edge">
<title>expert6_up_3&#45;&gt;expert6_act_3</title>
<path fill="none" stroke="black" d="M1577.59,-21941.22C1577.78,-21932.98 1577.99,-21923.73 1578.19,-21914.92"/>
<polygon fill="black" stroke="black" points="1581.69,-21914.96 1578.41,-21904.89 1574.69,-21914.81 1581.69,-21914.96"/>
</g>
<!-- expert6_down_3 -->
<g id="node125" class="node">
<title>expert6_down_3</title>
<polygon fill="lightgreen" stroke="black" points="1694,-21814.65 1478,-21814.65 1478,-21761.65 1694,-21761.65 1694,-21814.65"/>
<text text-anchor="middle" x="1586" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1586" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1586" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert6_act_3&#45;&gt;expert6_down_3 -->
<g id="edge155" class="edge">
<title>expert6_act_3&#45;&gt;expert6_down_3</title>
<path fill="none" stroke="black" d="M1581.06,-21851.22C1581.72,-21842.98 1582.45,-21833.73 1583.15,-21824.92"/>
<polygon fill="black" stroke="black" points="1586.65,-21825.13 1583.95,-21814.89 1579.67,-21824.58 1586.65,-21825.13"/>
</g>
<!-- expert6_agg_3 -->
<g id="node126" class="node">
<title>expert6_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="1590" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1590" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1590" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1590" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert6_down_3&#45;&gt;expert6_agg_3 -->
<g id="edge156" class="edge">
<title>expert6_down_3&#45;&gt;expert6_agg_3</title>
<path fill="none" stroke="black" d="M1587.04,-21761.4C1587.37,-21753.33 1587.74,-21744.15 1588.1,-21735.08"/>
<polygon fill="black" stroke="black" points="1591.61,-21735.1 1588.51,-21724.97 1584.61,-21734.82 1591.61,-21735.1"/>
</g>
<!-- expert6_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge157" class="edge">
<title>expert6_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1539.78,-21653.45C1510.76,-21635.85 1472.98,-21615.06 1437,-21601.69 1380.58,-21580.72 1316.33,-21565.36 1259.41,-21554.46"/>
<polygon fill="purple" stroke="purple" points="1259.72,-21550.95 1249.24,-21552.54 1258.42,-21557.83 1259.72,-21550.95"/>
<text text-anchor="middle" x="1568.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;9</text>
<text text-anchor="middle" x="1568.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_3 -->
<g id="node128" class="node">
<title>expert7_act_3</title>
<polygon fill="lightgreen" stroke="black" points="1901,-21904.65 1733,-21904.65 1733,-21851.65 1901,-21851.65 1901,-21904.65"/>
<text text-anchor="middle" x="1817" y="-21889.45" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1817" y="-21874.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1817" y="-21859.45" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert7_up_3&#45;&gt;expert7_act_3 -->
<g id="edge159" class="edge">
<title>expert7_up_3&#45;&gt;expert7_act_3</title>
<path fill="none" stroke="black" d="M1813.47,-21941.22C1813.94,-21932.98 1814.47,-21923.73 1814.97,-21914.92"/>
<polygon fill="black" stroke="black" points="1818.46,-21915.07 1815.54,-21904.89 1811.48,-21914.67 1818.46,-21915.07"/>
</g>
<!-- expert7_down_3 -->
<g id="node129" class="node">
<title>expert7_down_3</title>
<polygon fill="lightgreen" stroke="black" points="1935,-21814.65 1719,-21814.65 1719,-21761.65 1935,-21761.65 1935,-21814.65"/>
<text text-anchor="middle" x="1827" y="-21799.45" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1827" y="-21784.45" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1827" y="-21769.45" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert7_act_3&#45;&gt;expert7_down_3 -->
<g id="edge160" class="edge">
<title>expert7_act_3&#45;&gt;expert7_down_3</title>
<path fill="none" stroke="black" d="M1819.95,-21851.22C1820.88,-21842.98 1821.93,-21833.73 1822.93,-21824.92"/>
<polygon fill="black" stroke="black" points="1826.42,-21825.22 1824.07,-21814.89 1819.47,-21824.43 1826.42,-21825.22"/>
</g>
<!-- expert7_agg_3 -->
<g id="node130" class="node">
<title>expert7_agg_3</title>
<ellipse fill="lightgray" stroke="black" cx="1833" cy="-21687.17" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1833" y="-21698.47" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1833" y="-21683.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1833" y="-21668.47" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert7_down_3&#45;&gt;expert7_agg_3 -->
<g id="edge161" class="edge">
<title>expert7_down_3&#45;&gt;expert7_agg_3</title>
<path fill="none" stroke="black" d="M1828.56,-21761.4C1829.05,-21753.33 1829.61,-21744.15 1830.16,-21735.08"/>
<polygon fill="black" stroke="black" points="1833.66,-21735.16 1830.77,-21724.97 1826.67,-21734.74 1833.66,-21735.16"/>
</g>
<!-- expert7_agg_3&#45;&gt;expert_agg_3 -->
<g id="edge162" class="edge">
<title>expert7_agg_3&#45;&gt;expert_agg_3</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1775.07,-21654.97C1738.49,-21636.62 1689.66,-21614.56 1644,-21601.69 1513.63,-21564.96 1360.04,-21547.42 1250.06,-21539.09"/>
<polygon fill="purple" stroke="purple" points="1250.12,-21535.59 1239.89,-21538.34 1249.6,-21542.57 1250.12,-21535.59"/>
<text text-anchor="middle" x="1794.5" y="-21620.49" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;9</text>
<text text-anchor="middle" x="1794.5" y="-21605.49" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_3&#45;&gt;residual2_3 -->
<g id="edge163" class="edge">
<title>expert_agg_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M1219.27,-21505.61C1340.16,-21480.36 1529.53,-21440.8 1653.96,-21414.81"/>
<polygon fill="black" stroke="black" points="1654.85,-21418.2 1663.92,-21412.73 1653.42,-21411.35 1654.85,-21418.2"/>
</g>
<!-- layer_out_3 -->
<g id="node133" class="node">
<title>layer_out_3</title>
<ellipse fill="lightgray" stroke="black" cx="1779" cy="-21260.22" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1779" y="-21271.52" font-family="Times,serif" font-size="14.00">Layer3_Output</text>
<text text-anchor="middle" x="1779" y="-21256.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1779" y="-21241.52" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual2_3&#45;&gt;layer_out_3 -->
<g id="edge165" class="edge">
<title>residual2_3&#45;&gt;layer_out_3</title>
<path fill="none" stroke="black" d="M1779,-21334.57C1779,-21325.66 1779,-21316.47 1779,-21307.72"/>
<polygon fill="black" stroke="black" points="1782.5,-21307.7 1779,-21297.7 1775.5,-21307.7 1782.5,-21307.7"/>
</g>
<!-- ln1_4 -->
<g id="node134" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="1801.5,-21135.74 1642.5,-21135.74 1642.5,-21082.74 1801.5,-21082.74 1801.5,-21135.74"/>
<text text-anchor="middle" x="1722" y="-21120.54" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1722" y="-21105.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1722" y="-21090.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- layer_out_3&#45;&gt;ln1_4 -->
<g id="edge166" class="edge">
<title>layer_out_3&#45;&gt;ln1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1765.06,-21222.77C1756.06,-21199.26 1744.41,-21168.82 1735.51,-21145.54"/>
<polygon fill="red" stroke="red" points="1738.71,-21144.12 1731.87,-21136.04 1732.17,-21146.63 1738.71,-21144.12"/>
<text text-anchor="middle" x="1828.5" y="-21193.54" font-family="Times,serif" font-size="14.00">GPU&#45;23→GPU&#45;3</text>
<text text-anchor="middle" x="1828.5" y="-21178.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_4 -->
<g id="node140" class="node">
<title>residual1_4</title>
<polygon fill="lightpink" stroke="black" points="2112.69,-20775.74 1850.71,-20775.74 1783.31,-20669.74 2045.29,-20669.74 2112.69,-20775.74"/>
<text text-anchor="middle" x="1948" y="-20734.04" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1948" y="-20719.04" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1948" y="-20704.04" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- layer_out_3&#45;&gt;residual1_4 -->
<g id="edge174" class="edge">
<title>layer_out_3&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M1858.54,-21233.58C1874.73,-21225.98 1890.83,-21216.47 1904,-21204.74 1940.3,-21172.43 1959,-21158.84 1959,-21110.24 1959,-21110.24 1959,-21110.24 1959,-20838.24 1959,-20821.29 1957.79,-20802.99 1956.17,-20786.1"/>
<polygon fill="black" stroke="black" points="1959.62,-20785.39 1955.12,-20775.79 1952.66,-20786.1 1959.62,-20785.39"/>
</g>
<!-- mha_q_4 -->
<g id="node135" class="node">
<title>mha_q_4</title>
<polygon fill="lightcoral" stroke="black" points="1456.5,-21045.74 1237.5,-21045.74 1237.5,-20992.74 1456.5,-20992.74 1456.5,-21045.74"/>
<text text-anchor="middle" x="1347" y="-21030.54" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1347" y="-21015.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1347" y="-21000.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_q_4 -->
<g id="edge167" class="edge">
<title>ln1_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M1642.47,-21089.58C1591.15,-21077.53 1523.47,-21061.65 1465.83,-21048.12"/>
<polygon fill="black" stroke="black" points="1466.47,-21044.68 1455.93,-21045.8 1464.87,-21051.49 1466.47,-21044.68"/>
</g>
<!-- mha_k_4 -->
<g id="node136" class="node">
<title>mha_k_4</title>
<polygon fill="lightcoral" stroke="black" points="1693.5,-21045.74 1474.5,-21045.74 1474.5,-20992.74 1693.5,-20992.74 1693.5,-21045.74"/>
<text text-anchor="middle" x="1584" y="-21030.54" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1584" y="-21015.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1584" y="-21000.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_k_4 -->
<g id="edge168" class="edge">
<title>ln1_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M1681.71,-21082.55C1666.41,-21072.79 1648.81,-21061.57 1632.8,-21051.36"/>
<polygon fill="black" stroke="black" points="1634.41,-21048.23 1624.1,-21045.81 1630.65,-21054.14 1634.41,-21048.23"/>
</g>
<!-- mha_v_4 -->
<g id="node137" class="node">
<title>mha_v_4</title>
<polygon fill="lightcoral" stroke="black" points="1930.5,-21045.74 1711.5,-21045.74 1711.5,-20992.74 1930.5,-20992.74 1930.5,-21045.74"/>
<text text-anchor="middle" x="1821" y="-21030.54" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1821" y="-21015.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1821" y="-21000.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_v_4 -->
<g id="edge169" class="edge">
<title>ln1_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M1750.9,-21082.55C1761.47,-21073.15 1773.57,-21062.4 1784.71,-21052.5"/>
<polygon fill="black" stroke="black" points="1787.09,-21055.07 1792.23,-21045.81 1782.43,-21049.84 1787.09,-21055.07"/>
</g>
<!-- mha_attn_4 -->
<g id="node138" class="node">
<title>mha_attn_4</title>
<polygon fill="lightcoral" stroke="black" points="1729.5,-20955.74 1558.5,-20955.74 1558.5,-20902.74 1729.5,-20902.74 1729.5,-20955.74"/>
<text text-anchor="middle" x="1644" y="-20940.54" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1644" y="-20925.54" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1644" y="-20910.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge170" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M1433.3,-20992.67C1469.39,-20981.98 1511.45,-20969.51 1548.46,-20958.55"/>
<polygon fill="black" stroke="black" points="1549.66,-20961.84 1558.25,-20955.65 1547.67,-20955.13 1549.66,-20961.84"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge171" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M1601.68,-20992.31C1607.66,-20983.54 1614.43,-20973.61 1620.78,-20964.3"/>
<polygon fill="black" stroke="black" points="1623.71,-20966.22 1626.45,-20955.98 1617.92,-20962.27 1623.71,-20966.22"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge172" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M1769.33,-20992.55C1749.06,-20982.47 1725.66,-20970.84 1704.61,-20960.37"/>
<polygon fill="black" stroke="black" points="1705.94,-20957.13 1695.43,-20955.81 1702.83,-20963.4 1705.94,-20957.13"/>
</g>
<!-- mha_out_4 -->
<g id="node139" class="node">
<title>mha_out_4</title>
<polygon fill="lightcoral" stroke="black" points="1857.5,-20865.74 1698.5,-20865.74 1698.5,-20812.74 1857.5,-20812.74 1857.5,-20865.74"/>
<text text-anchor="middle" x="1778" y="-20850.54" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1778" y="-20835.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1778" y="-20820.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge173" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M1683.12,-20902.55C1697.98,-20892.79 1715.07,-20881.57 1730.61,-20871.36"/>
<polygon fill="black" stroke="black" points="1732.63,-20874.22 1739.06,-20865.81 1728.78,-20868.37 1732.63,-20874.22"/>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge175" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M1816.15,-20812.54C1829.91,-20803.28 1846.04,-20792.41 1862.21,-20781.52"/>
<polygon fill="black" stroke="black" points="1864.32,-20784.32 1870.66,-20775.83 1860.41,-20778.51 1864.32,-20784.32"/>
</g>
<!-- ln2_4 -->
<g id="node141" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="1784.5,-20632.74 1625.5,-20632.74 1625.5,-20579.74 1784.5,-20579.74 1784.5,-20632.74"/>
<text text-anchor="middle" x="1705" y="-20617.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1705" y="-20602.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1705" y="-20587.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge176" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M1837.52,-20669.68C1813.82,-20658.52 1789.56,-20647.08 1768.38,-20637.1"/>
<polygon fill="black" stroke="black" points="1769.73,-20633.87 1759.19,-20632.77 1766.74,-20640.2 1769.73,-20633.87"/>
</g>
<!-- residual2_4 -->
<g id="node176" class="node">
<title>residual2_4</title>
<polygon fill="lightpink" stroke="black" points="1861.69,-19816.79 1599.71,-19816.79 1532.31,-19710.79 1794.29,-19710.79 1861.69,-19816.79"/>
<text text-anchor="middle" x="1697" y="-19775.09" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1697" y="-19760.09" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1697" y="-19745.09" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge219" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M2060.56,-20693.59C2100.16,-20676.39 2135,-20649.3 2135,-20607.24 2135,-20607.24 2135,-20607.24 2135,-19905.79 2135,-19844.34 1976.84,-19805.83 1850.6,-19784.87"/>
<polygon fill="black" stroke="black" points="1850.85,-19781.37 1840.42,-19783.21 1849.72,-19788.28 1850.85,-19781.37"/>
</g>
<!-- gate_4 -->
<g id="node142" class="node">
<title>gate_4</title>
<polygon fill="orange" stroke="black" points="1275,-20542.74 1095,-20489.74 1275,-20436.74 1455,-20489.74 1275,-20542.74"/>
<text text-anchor="middle" x="1275" y="-20501.04" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1275" y="-20486.04" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1275" y="-20471.04" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln2_4&#45;&gt;gate_4 -->
<g id="edge177" class="edge">
<title>ln2_4&#45;&gt;gate_4</title>
<path fill="none" stroke="black" d="M1625.38,-20584.04C1555.68,-20565.48 1453.97,-20538.4 1378.07,-20518.18"/>
<polygon fill="black" stroke="black" points="1378.57,-20514.7 1368.01,-20515.51 1376.77,-20521.46 1378.57,-20514.7"/>
</g>
<!-- expert0_up_4 -->
<g id="node143" class="node">
<title>expert0_up_4</title>
<polygon fill="lightgreen" stroke="black" points="438,-20370.74 222,-20370.74 222,-20317.74 438,-20317.74 438,-20370.74"/>
<text text-anchor="middle" x="330" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="330" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="330" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- gate_4&#45;&gt;expert0_up_4 -->
<g id="edge178" class="edge">
<title>gate_4&#45;&gt;expert0_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1125.95,-20480.55C987.69,-20471.26 776.66,-20452.76 596,-20418.74 536.06,-20407.45 469.96,-20389.22 418.65,-20373.73"/>
<polygon fill="blue" stroke="blue" points="419.5,-20370.33 408.92,-20370.78 417.47,-20377.03 419.5,-20370.33"/>
<text text-anchor="middle" x="647.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="647.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;3</text>
</g>
<!-- expert1_up_4 -->
<g id="node147" class="node">
<title>expert1_up_4</title>
<polygon fill="lightgreen" stroke="black" points="672,-20370.74 456,-20370.74 456,-20317.74 672,-20317.74 672,-20370.74"/>
<text text-anchor="middle" x="564" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="564" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="564" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- gate_4&#45;&gt;expert1_up_4 -->
<g id="edge183" class="edge">
<title>gate_4&#45;&gt;expert1_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1147.94,-20474.15C1054.88,-20462.32 925.83,-20443.55 814,-20418.74 759.05,-20406.55 698.45,-20388.84 650.68,-20373.87"/>
<polygon fill="blue" stroke="blue" points="651.59,-20370.48 641,-20370.81 649.48,-20377.16 651.59,-20370.48"/>
<text text-anchor="middle" x="865.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="865.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;4</text>
</g>
<!-- expert2_up_4 -->
<g id="node151" class="node">
<title>expert2_up_4</title>
<polygon fill="lightgreen" stroke="black" points="906,-20370.74 690,-20370.74 690,-20317.74 906,-20317.74 906,-20370.74"/>
<text text-anchor="middle" x="798" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="798" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="798" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_4&#45;&gt;expert2_up_4 -->
<g id="edge188" class="edge">
<title>gate_4&#45;&gt;expert2_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1178.14,-20465.18C1127.49,-20452.37 1064.61,-20435.71 1009,-20418.74 964.79,-20405.24 916.01,-20388.38 876.5,-20374.22"/>
<polygon fill="blue" stroke="blue" points="877.52,-20370.87 866.93,-20370.77 875.15,-20377.45 877.52,-20370.87"/>
<text text-anchor="middle" x="1060.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1060.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;5</text>
</g>
<!-- expert3_up_4 -->
<g id="node155" class="node">
<title>expert3_up_4</title>
<polygon fill="lightgreen" stroke="black" points="1149,-20370.74 933,-20370.74 933,-20317.74 1149,-20317.74 1149,-20370.74"/>
<text text-anchor="middle" x="1041" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="1041" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1041" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_4&#45;&gt;expert3_up_4 -->
<g id="edge193" class="edge">
<title>gate_4&#45;&gt;expert3_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1217.46,-20453.45C1178.87,-20429.79 1128.53,-20398.92 1091.5,-20376.21"/>
<polygon fill="blue" stroke="blue" points="1093.22,-20373.16 1082.87,-20370.91 1089.56,-20379.13 1093.22,-20373.16"/>
<text text-anchor="middle" x="1209.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1209.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;6</text>
</g>
<!-- expert4_up_4 -->
<g id="node159" class="node">
<title>expert4_up_4</title>
<polygon fill="lightgreen" stroke="black" points="1383,-20370.74 1167,-20370.74 1167,-20317.74 1383,-20317.74 1383,-20370.74"/>
<text text-anchor="middle" x="1275" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1275" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1275" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_4&#45;&gt;expert4_up_4 -->
<g id="edge198" class="edge">
<title>gate_4&#45;&gt;expert4_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1275,-20436.53C1275,-20418.25 1275,-20398.15 1275,-20381.47"/>
<polygon fill="blue" stroke="blue" points="1278.5,-20381.05 1275,-20371.05 1271.5,-20381.05 1278.5,-20381.05"/>
<text text-anchor="middle" x="1326.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1326.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;7</text>
</g>
<!-- expert5_up_4 -->
<g id="node163" class="node">
<title>expert5_up_4</title>
<polygon fill="lightgreen" stroke="black" points="1619,-20370.74 1403,-20370.74 1403,-20317.74 1619,-20317.74 1619,-20370.74"/>
<text text-anchor="middle" x="1511" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1511" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1511" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_4&#45;&gt;expert5_up_4 -->
<g id="edge203" class="edge">
<title>gate_4&#45;&gt;expert5_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1332.73,-20453.64C1371.77,-20429.9 1422.83,-20398.85 1460.3,-20376.07"/>
<polygon fill="blue" stroke="blue" points="1462.31,-20378.94 1469.04,-20370.76 1458.67,-20372.96 1462.31,-20378.94"/>
<text text-anchor="middle" x="1485.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1485.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;8</text>
</g>
<!-- expert6_up_4 -->
<g id="node167" class="node">
<title>expert6_up_4</title>
<polygon fill="lightgreen" stroke="black" points="1854,-20370.74 1638,-20370.74 1638,-20317.74 1854,-20317.74 1854,-20370.74"/>
<text text-anchor="middle" x="1746" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1746" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1746" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_4&#45;&gt;expert6_up_4 -->
<g id="edge208" class="edge">
<title>gate_4&#45;&gt;expert6_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1372.23,-20465.31C1422.85,-20452.57 1485.59,-20435.93 1541,-20418.74 1583.94,-20405.42 1631.23,-20388.61 1669.55,-20374.43"/>
<polygon fill="blue" stroke="blue" points="1670.94,-20377.65 1679.09,-20370.89 1668.5,-20371.09 1670.94,-20377.65"/>
<text text-anchor="middle" x="1677.5" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1677.5" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;9</text>
</g>
<!-- expert7_up_4 -->
<g id="node171" class="node">
<title>expert7_up_4</title>
<polygon fill="lightgreen" stroke="black" points="2090,-20370.74 1874,-20370.74 1874,-20317.74 2090,-20317.74 2090,-20370.74"/>
<text text-anchor="middle" x="1982" y="-20355.54" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1982" y="-20340.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1982" y="-20325.54" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_4&#45;&gt;expert7_up_4 -->
<g id="edge213" class="edge">
<title>gate_4&#45;&gt;expert7_up_4</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1402.22,-20473.99C1494.6,-20462.15 1622.3,-20443.42 1733,-20418.74 1787.74,-20406.54 1848.09,-20388.83 1895.67,-20373.86"/>
<polygon fill="blue" stroke="blue" points="1896.84,-20377.16 1905.31,-20370.8 1894.72,-20370.49 1896.84,-20377.16"/>
<text text-anchor="middle" x="1899" y="-20407.54" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1899" y="-20392.54" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;10</text>
</g>
<!-- expert0_act_4 -->
<g id="node144" class="node">
<title>expert0_act_4</title>
<polygon fill="lightgreen" stroke="black" points="404,-20280.74 236,-20280.74 236,-20227.74 404,-20227.74 404,-20280.74"/>
<text text-anchor="middle" x="320" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="320" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="320" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert0_up_4&#45;&gt;expert0_act_4 -->
<g id="edge179" class="edge">
<title>expert0_up_4&#45;&gt;expert0_act_4</title>
<path fill="none" stroke="black" d="M327.05,-20317.31C326.12,-20309.08 325.07,-20299.82 324.07,-20291.02"/>
<polygon fill="black" stroke="black" points="327.53,-20290.52 322.93,-20280.98 320.58,-20291.31 327.53,-20290.52"/>
</g>
<!-- expert0_down_4 -->
<g id="node145" class="node">
<title>expert0_down_4</title>
<polygon fill="lightgreen" stroke="black" points="416,-20190.74 200,-20190.74 200,-20137.74 416,-20137.74 416,-20190.74"/>
<text text-anchor="middle" x="308" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="308" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="308" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert0_act_4&#45;&gt;expert0_down_4 -->
<g id="edge180" class="edge">
<title>expert0_act_4&#45;&gt;expert0_down_4</title>
<path fill="none" stroke="black" d="M316.46,-20227.31C315.34,-20219.08 314.08,-20209.82 312.88,-20201.02"/>
<polygon fill="black" stroke="black" points="316.33,-20200.42 311.51,-20190.98 309.39,-20201.36 316.33,-20200.42"/>
</g>
<!-- expert0_agg_4 -->
<g id="node146" class="node">
<title>expert0_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="303" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="303" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="303" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="303" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- expert0_down_4&#45;&gt;expert0_agg_4 -->
<g id="edge181" class="edge">
<title>expert0_down_4&#45;&gt;expert0_agg_4</title>
<path fill="none" stroke="black" d="M306.7,-20137.49C306.29,-20129.42 305.83,-20120.24 305.37,-20111.18"/>
<polygon fill="black" stroke="black" points="308.86,-20110.87 304.86,-20101.06 301.87,-20111.22 308.86,-20110.87"/>
</g>
<!-- expert_agg_4 -->
<g id="node175" class="node">
<title>expert_agg_4</title>
<polygon fill="gold" stroke="black" points="1439.69,-19959.79 1177.71,-19959.79 1110.31,-19853.79 1372.29,-19853.79 1439.69,-19959.79"/>
<text text-anchor="middle" x="1275" y="-19918.09" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1275" y="-19903.09" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1275" y="-19888.09" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert0_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge182" class="edge">
<title>expert0_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M363.1,-20031.57C402.66,-20012.81 456.16,-19990.12 506,-19977.79 720.88,-19924.62 978.5,-19910.91 1134.32,-19907.89"/>
<polygon fill="purple" stroke="purple" points="1134.5,-19911.38 1144.44,-19907.7 1134.37,-19904.39 1134.5,-19911.38"/>
<text text-anchor="middle" x="577.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;10</text>
<text text-anchor="middle" x="577.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_4 -->
<g id="node148" class="node">
<title>expert1_act_4</title>
<polygon fill="lightgreen" stroke="black" points="643,-20280.74 475,-20280.74 475,-20227.74 643,-20227.74 643,-20280.74"/>
<text text-anchor="middle" x="559" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="559" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="559" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert1_up_4&#45;&gt;expert1_act_4 -->
<g id="edge184" class="edge">
<title>expert1_up_4&#45;&gt;expert1_act_4</title>
<path fill="none" stroke="black" d="M562.53,-20317.31C562.06,-20309.08 561.53,-20299.82 561.03,-20291.02"/>
<polygon fill="black" stroke="black" points="564.52,-20290.77 560.46,-20280.98 557.54,-20291.16 564.52,-20290.77"/>
</g>
<!-- expert1_down_4 -->
<g id="node149" class="node">
<title>expert1_down_4</title>
<polygon fill="lightgreen" stroke="black" points="660,-20190.74 444,-20190.74 444,-20137.74 660,-20137.74 660,-20190.74"/>
<text text-anchor="middle" x="552" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="552" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="552" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert1_act_4&#45;&gt;expert1_down_4 -->
<g id="edge185" class="edge">
<title>expert1_act_4&#45;&gt;expert1_down_4</title>
<path fill="none" stroke="black" d="M556.94,-20227.31C556.28,-20219.08 555.55,-20209.82 554.85,-20201.02"/>
<polygon fill="black" stroke="black" points="558.33,-20200.67 554.05,-20190.98 551.35,-20201.23 558.33,-20200.67"/>
</g>
<!-- expert1_agg_4 -->
<g id="node150" class="node">
<title>expert1_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="546" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="546" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="546" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="546" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert1_down_4&#45;&gt;expert1_agg_4 -->
<g id="edge186" class="edge">
<title>expert1_down_4&#45;&gt;expert1_agg_4</title>
<path fill="none" stroke="black" d="M550.44,-20137.49C549.95,-20129.42 549.39,-20120.24 548.84,-20111.18"/>
<polygon fill="black" stroke="black" points="552.33,-20110.83 548.23,-20101.06 545.34,-20111.25 552.33,-20110.83"/>
</g>
<!-- expert1_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge187" class="edge">
<title>expert1_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M603.69,-20030.83C639.82,-20012.51 687.93,-19990.57 733,-19977.79 867.65,-19939.59 1027.1,-19922.17 1138.05,-19914.27"/>
<polygon fill="purple" stroke="purple" points="1138.56,-19917.74 1148.29,-19913.56 1138.07,-19910.76 1138.56,-19917.74"/>
<text text-anchor="middle" x="804.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;10</text>
<text text-anchor="middle" x="804.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_4 -->
<g id="node152" class="node">
<title>expert2_act_4</title>
<polygon fill="lightgreen" stroke="black" points="878,-20280.74 710,-20280.74 710,-20227.74 878,-20227.74 878,-20280.74"/>
<text text-anchor="middle" x="794" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="794" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="794" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert2_up_4&#45;&gt;expert2_act_4 -->
<g id="edge189" class="edge">
<title>expert2_up_4&#45;&gt;expert2_act_4</title>
<path fill="none" stroke="black" d="M796.82,-20317.31C796.45,-20309.08 796.03,-20299.82 795.63,-20291.02"/>
<polygon fill="black" stroke="black" points="799.12,-20290.81 795.17,-20280.98 792.13,-20291.13 799.12,-20290.81"/>
</g>
<!-- expert2_down_4 -->
<g id="node153" class="node">
<title>expert2_down_4</title>
<polygon fill="lightgreen" stroke="black" points="899,-20190.74 683,-20190.74 683,-20137.74 899,-20137.74 899,-20190.74"/>
<text text-anchor="middle" x="791" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="791" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="791" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert2_act_4&#45;&gt;expert2_down_4 -->
<g id="edge190" class="edge">
<title>expert2_act_4&#45;&gt;expert2_down_4</title>
<path fill="none" stroke="black" d="M793.12,-20227.31C792.84,-20219.08 792.52,-20209.82 792.22,-20201.02"/>
<polygon fill="black" stroke="black" points="795.72,-20200.86 791.88,-20190.98 788.72,-20201.09 795.72,-20200.86"/>
</g>
<!-- expert2_agg_4 -->
<g id="node154" class="node">
<title>expert2_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="789" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="789" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="789" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="789" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert2_down_4&#45;&gt;expert2_agg_4 -->
<g id="edge191" class="edge">
<title>expert2_down_4&#45;&gt;expert2_agg_4</title>
<path fill="none" stroke="black" d="M790.48,-20137.49C790.32,-20129.42 790.13,-20120.24 789.95,-20111.18"/>
<polygon fill="black" stroke="black" points="793.44,-20110.99 789.74,-20101.06 786.45,-20111.13 793.44,-20110.99"/>
</g>
<!-- expert2_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge192" class="edge">
<title>expert2_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M838.87,-20029.53C867.68,-20011.91 905.22,-19991.13 941,-19977.79 1006.21,-19953.47 1081.9,-19936.73 1144.72,-19925.74"/>
<polygon fill="purple" stroke="purple" points="1145.42,-19929.17 1154.69,-19924.02 1144.24,-19922.27 1145.42,-19929.17"/>
<text text-anchor="middle" x="1012.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;10</text>
<text text-anchor="middle" x="1012.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_4 -->
<g id="node156" class="node">
<title>expert3_act_4</title>
<polygon fill="lightgreen" stroke="black" points="1124,-20280.74 956,-20280.74 956,-20227.74 1124,-20227.74 1124,-20280.74"/>
<text text-anchor="middle" x="1040" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="1040" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1040" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert3_up_4&#45;&gt;expert3_act_4 -->
<g id="edge194" class="edge">
<title>expert3_up_4&#45;&gt;expert3_act_4</title>
<path fill="none" stroke="black" d="M1040.71,-20317.31C1040.61,-20309.08 1040.51,-20299.82 1040.41,-20291.02"/>
<polygon fill="black" stroke="black" points="1043.91,-20290.94 1040.29,-20280.98 1036.91,-20291.02 1043.91,-20290.94"/>
</g>
<!-- expert3_down_4 -->
<g id="node157" class="node">
<title>expert3_down_4</title>
<polygon fill="lightgreen" stroke="black" points="1147,-20190.74 931,-20190.74 931,-20137.74 1147,-20137.74 1147,-20190.74"/>
<text text-anchor="middle" x="1039" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="1039" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1039" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert3_act_4&#45;&gt;expert3_down_4 -->
<g id="edge195" class="edge">
<title>expert3_act_4&#45;&gt;expert3_down_4</title>
<path fill="none" stroke="black" d="M1039.71,-20227.31C1039.61,-20219.08 1039.51,-20209.82 1039.41,-20201.02"/>
<polygon fill="black" stroke="black" points="1042.91,-20200.94 1039.29,-20190.98 1035.91,-20201.02 1042.91,-20200.94"/>
</g>
<!-- expert3_agg_4 -->
<g id="node158" class="node">
<title>expert3_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="1032" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1032" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="1032" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1032" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert3_down_4&#45;&gt;expert3_agg_4 -->
<g id="edge196" class="edge">
<title>expert3_down_4&#45;&gt;expert3_agg_4</title>
<path fill="none" stroke="black" d="M1037.18,-20137.49C1036.61,-20129.42 1035.96,-20120.24 1035.32,-20111.18"/>
<polygon fill="black" stroke="black" points="1038.8,-20110.79 1034.6,-20101.06 1031.82,-20111.28 1038.8,-20110.79"/>
</g>
<!-- expert3_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge197" class="edge">
<title>expert3_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1066.99,-20027.24C1084.4,-20010.96 1106.32,-19992.09 1128,-19977.79 1139.2,-19970.4 1151.31,-19963.34 1163.59,-19956.75"/>
<polygon fill="purple" stroke="purple" points="1165.34,-19959.79 1172.56,-19952.03 1162.08,-19953.59 1165.34,-19959.79"/>
<text text-anchor="middle" x="1199.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;10</text>
<text text-anchor="middle" x="1199.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_4 -->
<g id="node160" class="node">
<title>expert4_act_4</title>
<polygon fill="lightgreen" stroke="black" points="1359,-20280.74 1191,-20280.74 1191,-20227.74 1359,-20227.74 1359,-20280.74"/>
<text text-anchor="middle" x="1275" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1275" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1275" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert4_up_4&#45;&gt;expert4_act_4 -->
<g id="edge199" class="edge">
<title>expert4_up_4&#45;&gt;expert4_act_4</title>
<path fill="none" stroke="black" d="M1275,-20317.31C1275,-20309.08 1275,-20299.82 1275,-20291.02"/>
<polygon fill="black" stroke="black" points="1278.5,-20290.98 1275,-20280.98 1271.5,-20290.98 1278.5,-20290.98"/>
</g>
<!-- expert4_down_4 -->
<g id="node161" class="node">
<title>expert4_down_4</title>
<polygon fill="lightgreen" stroke="black" points="1383,-20190.74 1167,-20190.74 1167,-20137.74 1383,-20137.74 1383,-20190.74"/>
<text text-anchor="middle" x="1275" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1275" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1275" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert4_act_4&#45;&gt;expert4_down_4 -->
<g id="edge200" class="edge">
<title>expert4_act_4&#45;&gt;expert4_down_4</title>
<path fill="none" stroke="black" d="M1275,-20227.31C1275,-20219.08 1275,-20209.82 1275,-20201.02"/>
<polygon fill="black" stroke="black" points="1278.5,-20200.98 1275,-20190.98 1271.5,-20200.98 1278.5,-20200.98"/>
</g>
<!-- expert4_agg_4 -->
<g id="node162" class="node">
<title>expert4_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="1275" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1275" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1275" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1275" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert4_down_4&#45;&gt;expert4_agg_4 -->
<g id="edge201" class="edge">
<title>expert4_down_4&#45;&gt;expert4_agg_4</title>
<path fill="none" stroke="black" d="M1275,-20137.49C1275,-20129.42 1275,-20120.24 1275,-20111.18"/>
<polygon fill="black" stroke="black" points="1278.5,-20111.06 1275,-20101.06 1271.5,-20111.06 1278.5,-20111.06"/>
</g>
<!-- expert4_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge202" class="edge">
<title>expert4_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1275,-20025.65C1275,-20009.02 1275,-19988.86 1275,-19969.96"/>
<polygon fill="purple" stroke="purple" points="1278.5,-19969.92 1275,-19959.92 1271.5,-19969.92 1278.5,-19969.92"/>
<text text-anchor="middle" x="1346.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;10</text>
<text text-anchor="middle" x="1346.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_4 -->
<g id="node164" class="node">
<title>expert5_act_4</title>
<polygon fill="lightgreen" stroke="black" points="1599,-20280.74 1431,-20280.74 1431,-20227.74 1599,-20227.74 1599,-20280.74"/>
<text text-anchor="middle" x="1515" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1515" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1515" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert5_up_4&#45;&gt;expert5_act_4 -->
<g id="edge204" class="edge">
<title>expert5_up_4&#45;&gt;expert5_act_4</title>
<path fill="none" stroke="black" d="M1512.18,-20317.31C1512.55,-20309.08 1512.97,-20299.82 1513.37,-20291.02"/>
<polygon fill="black" stroke="black" points="1516.87,-20291.13 1513.83,-20280.98 1509.88,-20290.81 1516.87,-20291.13"/>
</g>
<!-- expert5_down_4 -->
<g id="node165" class="node">
<title>expert5_down_4</title>
<polygon fill="lightgreen" stroke="black" points="1624,-20190.74 1408,-20190.74 1408,-20137.74 1624,-20137.74 1624,-20190.74"/>
<text text-anchor="middle" x="1516" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1516" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1516" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert5_act_4&#45;&gt;expert5_down_4 -->
<g id="edge205" class="edge">
<title>expert5_act_4&#45;&gt;expert5_down_4</title>
<path fill="none" stroke="black" d="M1515.29,-20227.31C1515.39,-20219.08 1515.49,-20209.82 1515.59,-20201.02"/>
<polygon fill="black" stroke="black" points="1519.09,-20201.02 1515.71,-20190.98 1512.09,-20200.94 1519.09,-20201.02"/>
</g>
<!-- expert5_agg_4 -->
<g id="node166" class="node">
<title>expert5_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="1518" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1518" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1518" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1518" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert5_down_4&#45;&gt;expert5_agg_4 -->
<g id="edge206" class="edge">
<title>expert5_down_4&#45;&gt;expert5_agg_4</title>
<path fill="none" stroke="black" d="M1516.52,-20137.49C1516.68,-20129.42 1516.87,-20120.24 1517.05,-20111.18"/>
<polygon fill="black" stroke="black" points="1520.55,-20111.13 1517.26,-20101.06 1513.56,-20110.99 1520.55,-20111.13"/>
</g>
<!-- expert5_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge207" class="edge">
<title>expert5_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1483.01,-20027.24C1465.6,-20010.96 1443.68,-19992.09 1422,-19977.79 1415.36,-19973.41 1408.41,-19969.15 1401.29,-19965.03"/>
<polygon fill="purple" stroke="purple" points="1402.62,-19961.77 1392.2,-19959.9 1399.18,-19967.86 1402.62,-19961.77"/>
<text text-anchor="middle" x="1532.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;10</text>
<text text-anchor="middle" x="1532.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_4 -->
<g id="node168" class="node">
<title>expert6_act_4</title>
<polygon fill="lightgreen" stroke="black" points="1833,-20280.74 1665,-20280.74 1665,-20227.74 1833,-20227.74 1833,-20280.74"/>
<text text-anchor="middle" x="1749" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1749" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1749" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert6_up_4&#45;&gt;expert6_act_4 -->
<g id="edge209" class="edge">
<title>expert6_up_4&#45;&gt;expert6_act_4</title>
<path fill="none" stroke="black" d="M1746.88,-20317.31C1747.16,-20309.08 1747.48,-20299.82 1747.78,-20291.02"/>
<polygon fill="black" stroke="black" points="1751.28,-20291.09 1748.12,-20280.98 1744.28,-20290.86 1751.28,-20291.09"/>
</g>
<!-- expert6_down_4 -->
<g id="node169" class="node">
<title>expert6_down_4</title>
<polygon fill="lightgreen" stroke="black" points="1863,-20190.74 1647,-20190.74 1647,-20137.74 1863,-20137.74 1863,-20190.74"/>
<text text-anchor="middle" x="1755" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1755" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1755" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert6_act_4&#45;&gt;expert6_down_4 -->
<g id="edge210" class="edge">
<title>expert6_act_4&#45;&gt;expert6_down_4</title>
<path fill="none" stroke="black" d="M1750.77,-20227.31C1751.33,-20219.08 1751.96,-20209.82 1752.56,-20201.02"/>
<polygon fill="black" stroke="black" points="1756.06,-20201.2 1753.24,-20190.98 1749.07,-20200.72 1756.06,-20201.2"/>
</g>
<!-- expert6_agg_4 -->
<g id="node170" class="node">
<title>expert6_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="1761" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1761" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1761" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1761" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert6_down_4&#45;&gt;expert6_agg_4 -->
<g id="edge211" class="edge">
<title>expert6_down_4&#45;&gt;expert6_agg_4</title>
<path fill="none" stroke="black" d="M1756.56,-20137.49C1757.05,-20129.42 1757.61,-20120.24 1758.16,-20111.18"/>
<polygon fill="black" stroke="black" points="1761.66,-20111.25 1758.77,-20101.06 1754.67,-20110.83 1761.66,-20111.25"/>
</g>
<!-- expert6_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge212" class="edge">
<title>expert6_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1710.78,-20029.55C1681.76,-20011.94 1643.98,-19991.16 1608,-19977.79 1551.58,-19956.82 1487.33,-19941.45 1430.41,-19930.55"/>
<polygon fill="purple" stroke="purple" points="1430.72,-19927.05 1420.24,-19928.64 1429.42,-19933.93 1430.72,-19927.05"/>
<text text-anchor="middle" x="1739.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;10</text>
<text text-anchor="middle" x="1739.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_4 -->
<g id="node172" class="node">
<title>expert7_act_4</title>
<polygon fill="lightgreen" stroke="black" points="2071,-20280.74 1903,-20280.74 1903,-20227.74 2071,-20227.74 2071,-20280.74"/>
<text text-anchor="middle" x="1987" y="-20265.54" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1987" y="-20250.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1987" y="-20235.54" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert7_up_4&#45;&gt;expert7_act_4 -->
<g id="edge214" class="edge">
<title>expert7_up_4&#45;&gt;expert7_act_4</title>
<path fill="none" stroke="black" d="M1983.47,-20317.31C1983.94,-20309.08 1984.47,-20299.82 1984.97,-20291.02"/>
<polygon fill="black" stroke="black" points="1988.46,-20291.16 1985.54,-20280.98 1981.48,-20290.77 1988.46,-20291.16"/>
</g>
<!-- expert7_down_4 -->
<g id="node173" class="node">
<title>expert7_down_4</title>
<polygon fill="lightgreen" stroke="black" points="2106,-20190.74 1890,-20190.74 1890,-20137.74 2106,-20137.74 2106,-20190.74"/>
<text text-anchor="middle" x="1998" y="-20175.54" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1998" y="-20160.54" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1998" y="-20145.54" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert7_act_4&#45;&gt;expert7_down_4 -->
<g id="edge215" class="edge">
<title>expert7_act_4&#45;&gt;expert7_down_4</title>
<path fill="none" stroke="black" d="M1990.24,-20227.31C1991.27,-20219.08 1992.43,-20209.82 1993.53,-20201.02"/>
<polygon fill="black" stroke="black" points="1997.01,-20201.34 1994.78,-20190.98 1990.07,-20200.47 1997.01,-20201.34"/>
</g>
<!-- expert7_agg_4 -->
<g id="node174" class="node">
<title>expert7_agg_4</title>
<ellipse fill="lightgray" stroke="black" cx="2004" cy="-20063.26" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="2004" y="-20074.56" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="2004" y="-20059.56" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="2004" y="-20044.56" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert7_down_4&#45;&gt;expert7_agg_4 -->
<g id="edge216" class="edge">
<title>expert7_down_4&#45;&gt;expert7_agg_4</title>
<path fill="none" stroke="black" d="M1999.56,-20137.49C2000.05,-20129.42 2000.61,-20120.24 2001.16,-20111.18"/>
<polygon fill="black" stroke="black" points="2004.66,-20111.25 2001.77,-20101.06 1997.67,-20110.83 2004.66,-20111.25"/>
</g>
<!-- expert7_agg_4&#45;&gt;expert_agg_4 -->
<g id="edge217" class="edge">
<title>expert7_agg_4&#45;&gt;expert_agg_4</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1946.07,-20031.06C1909.49,-20012.71 1860.66,-19990.65 1815,-19977.79 1684.63,-19941.06 1531.04,-19923.51 1421.06,-19915.19"/>
<polygon fill="purple" stroke="purple" points="1421.12,-19911.68 1410.89,-19914.43 1420.6,-19918.66 1421.12,-19911.68"/>
<text text-anchor="middle" x="1965.5" y="-19996.59" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;10</text>
<text text-anchor="middle" x="1965.5" y="-19981.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_4&#45;&gt;residual2_4 -->
<g id="edge218" class="edge">
<title>expert_agg_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M1382.58,-19869.84C1442.73,-19849.74 1517.78,-19824.67 1579.47,-19804.06"/>
<polygon fill="black" stroke="black" points="1580.87,-19807.28 1589.25,-19800.79 1578.66,-19800.64 1580.87,-19807.28"/>
</g>
<!-- layer_out_4 -->
<g id="node177" class="node">
<title>layer_out_4</title>
<ellipse fill="lightgray" stroke="black" cx="1697" cy="-19636.31" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1697" y="-19647.61" font-family="Times,serif" font-size="14.00">Layer4_Output</text>
<text text-anchor="middle" x="1697" y="-19632.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1697" y="-19617.61" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual2_4&#45;&gt;layer_out_4 -->
<g id="edge220" class="edge">
<title>residual2_4&#45;&gt;layer_out_4</title>
<path fill="none" stroke="black" d="M1697,-19710.66C1697,-19701.76 1697,-19692.56 1697,-19683.81"/>
<polygon fill="black" stroke="black" points="1700.5,-19683.8 1697,-19673.8 1693.5,-19683.8 1700.5,-19683.8"/>
</g>
<!-- ln1_5 -->
<g id="node178" class="node">
<title>ln1_5</title>
<polygon fill="lightyellow" stroke="black" points="1495.5,-19511.83 1336.5,-19511.83 1336.5,-19458.83 1495.5,-19458.83 1495.5,-19511.83"/>
<text text-anchor="middle" x="1416" y="-19496.63" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1416" y="-19481.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1416" y="-19466.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- layer_out_4&#45;&gt;ln1_5 -->
<g id="edge221" class="edge">
<title>layer_out_4&#45;&gt;ln1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1623.45,-19607.93C1603.81,-19599.89 1582.83,-19590.6 1564,-19580.83 1527.95,-19562.13 1489.34,-19537.3 1460.6,-19517.79"/>
<polygon fill="red" stroke="red" points="1462.24,-19514.67 1452.01,-19511.92 1458.29,-19520.45 1462.24,-19514.67"/>
<text text-anchor="middle" x="1635.5" y="-19569.63" font-family="Times,serif" font-size="14.00">GPU&#45;31→GPU&#45;4</text>
<text text-anchor="middle" x="1635.5" y="-19554.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_5 -->
<g id="node184" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="1838.69,-19151.83 1576.71,-19151.83 1509.31,-19045.83 1771.29,-19045.83 1838.69,-19151.83"/>
<text text-anchor="middle" x="1674" y="-19110.13" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1674" y="-19095.13" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1674" y="-19080.13" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- layer_out_4&#45;&gt;residual1_5 -->
<g id="edge229" class="edge">
<title>layer_out_4&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1706.21,-19598.84C1712.98,-19568.84 1721,-19525.11 1721,-19486.33 1721,-19486.33 1721,-19486.33 1721,-19214.33 1721,-19196.46 1716.04,-19178.11 1709.34,-19161.49"/>
<polygon fill="black" stroke="black" points="1712.39,-19159.72 1705.22,-19151.92 1705.96,-19162.49 1712.39,-19159.72"/>
</g>
<!-- mha_q_5 -->
<g id="node179" class="node">
<title>mha_q_5</title>
<polygon fill="lightcoral" stroke="black" points="1218.5,-19421.83 999.5,-19421.83 999.5,-19368.83 1218.5,-19368.83 1218.5,-19421.83"/>
<text text-anchor="middle" x="1109" y="-19406.63" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1109" y="-19391.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1109" y="-19376.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_q_5 -->
<g id="edge222" class="edge">
<title>ln1_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M1336.14,-19461.44C1297,-19450.22 1249.48,-19436.6 1208.04,-19424.72"/>
<polygon fill="black" stroke="black" points="1208.78,-19421.29 1198.2,-19421.9 1206.85,-19428.02 1208.78,-19421.29"/>
</g>
<!-- mha_k_5 -->
<g id="node180" class="node">
<title>mha_k_5</title>
<polygon fill="lightcoral" stroke="black" points="1455.5,-19421.83 1236.5,-19421.83 1236.5,-19368.83 1455.5,-19368.83 1455.5,-19421.83"/>
<text text-anchor="middle" x="1346" y="-19406.63" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1346" y="-19391.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1346" y="-19376.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_k_5 -->
<g id="edge223" class="edge">
<title>ln1_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M1395.38,-19458.41C1388.33,-19449.54 1380.34,-19439.5 1372.87,-19430.11"/>
<polygon fill="black" stroke="black" points="1375.44,-19427.72 1366.48,-19422.07 1369.96,-19432.08 1375.44,-19427.72"/>
</g>
<!-- mha_v_5 -->
<g id="node181" class="node">
<title>mha_v_5</title>
<polygon fill="lightcoral" stroke="black" points="1692.5,-19421.83 1473.5,-19421.83 1473.5,-19368.83 1692.5,-19368.83 1692.5,-19421.83"/>
<text text-anchor="middle" x="1583" y="-19406.63" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1583" y="-19391.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1583" y="-19376.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_v_5 -->
<g id="edge224" class="edge">
<title>ln1_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M1464.75,-19458.64C1483.79,-19448.61 1505.75,-19437.04 1525.55,-19426.61"/>
<polygon fill="black" stroke="black" points="1527.26,-19429.66 1534.48,-19421.9 1524,-19423.47 1527.26,-19429.66"/>
</g>
<!-- mha_attn_5 -->
<g id="node182" class="node">
<title>mha_attn_5</title>
<polygon fill="lightcoral" stroke="black" points="1481.5,-19331.83 1310.5,-19331.83 1310.5,-19278.83 1481.5,-19278.83 1481.5,-19331.83"/>
<text text-anchor="middle" x="1396" y="-19316.63" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1396" y="-19301.63" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1396" y="-19286.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge225" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M1192.4,-19368.76C1226.89,-19358.19 1267.04,-19345.88 1302.52,-19335"/>
<polygon fill="black" stroke="black" points="1303.86,-19338.25 1312.39,-19331.97 1301.81,-19331.55 1303.86,-19338.25"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge226" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M1360.73,-19368.41C1365.61,-19359.81 1371.13,-19350.11 1376.32,-19340.96"/>
<polygon fill="black" stroke="black" points="1379.48,-19342.5 1381.37,-19332.07 1373.39,-19339.04 1379.48,-19342.5"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge227" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M1528.66,-19368.76C1507.05,-19358.59 1482.04,-19346.82 1459.59,-19336.26"/>
<polygon fill="black" stroke="black" points="1461.01,-19333.06 1450.47,-19331.97 1458.03,-19339.39 1461.01,-19333.06"/>
</g>
<!-- mha_out_5 -->
<g id="node183" class="node">
<title>mha_out_5</title>
<polygon fill="lightcoral" stroke="black" points="1626.5,-19241.83 1467.5,-19241.83 1467.5,-19188.83 1626.5,-19188.83 1626.5,-19241.83"/>
<text text-anchor="middle" x="1547" y="-19226.63" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1547" y="-19211.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1547" y="-19196.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge228" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M1440.08,-19278.64C1456.98,-19268.79 1476.44,-19257.45 1494.09,-19247.17"/>
<polygon fill="black" stroke="black" points="1496.25,-19249.96 1503.12,-19241.9 1492.72,-19243.91 1496.25,-19249.96"/>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge230" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M1575.5,-19188.64C1585.4,-19179.71 1596.95,-19169.3 1608.58,-19158.81"/>
<polygon fill="black" stroke="black" points="1611.14,-19161.22 1616.22,-19151.92 1606.45,-19156.02 1611.14,-19161.22"/>
</g>
<!-- ln2_5 -->
<g id="node185" class="node">
<title>ln2_5</title>
<polygon fill="lightyellow" stroke="black" points="1623.5,-19008.83 1464.5,-19008.83 1464.5,-18955.83 1623.5,-18955.83 1623.5,-19008.83"/>
<text text-anchor="middle" x="1544" y="-18993.63" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1544" y="-18978.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1544" y="-18963.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge231" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M1614.71,-19045.61C1603.18,-19035.46 1591.41,-19025.09 1580.87,-19015.81"/>
<polygon fill="black" stroke="black" points="1582.89,-19012.92 1573.07,-19008.94 1578.26,-19018.17 1582.89,-19012.92"/>
</g>
<!-- residual2_5 -->
<g id="node220" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="1990.69,-18192.88 1728.71,-18192.88 1661.31,-18086.88 1923.29,-18086.88 1990.69,-18192.88"/>
<text text-anchor="middle" x="1826" y="-18151.18" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1826" y="-18136.18" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1826" y="-18121.18" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge274" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1793.64,-19080.25C1890.87,-19062.47 2012,-19030.81 2012,-18983.33 2012,-18983.33 2012,-18983.33 2012,-18281.88 2012,-18247.21 1991.23,-18219.97 1963.56,-18199.06"/>
<polygon fill="black" stroke="black" points="1965.35,-18196.03 1955.18,-18193.05 1961.27,-18201.72 1965.35,-18196.03"/>
</g>
<!-- gate_5 -->
<g id="node186" class="node">
<title>gate_5</title>
<polygon fill="orange" stroke="black" points="1152,-18918.83 972,-18865.83 1152,-18812.83 1332,-18865.83 1152,-18918.83"/>
<text text-anchor="middle" x="1152" y="-18877.13" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1152" y="-18862.13" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1152" y="-18847.13" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln2_5&#45;&gt;gate_5 -->
<g id="edge232" class="edge">
<title>ln2_5&#45;&gt;gate_5</title>
<path fill="none" stroke="black" d="M1464.2,-18958.02C1402.56,-18940.02 1316.92,-18915 1250.92,-18895.73"/>
<polygon fill="black" stroke="black" points="1251.5,-18892.25 1240.92,-18892.81 1249.54,-18898.97 1251.5,-18892.25"/>
</g>
<!-- expert0_up_5 -->
<g id="node187" class="node">
<title>expert0_up_5</title>
<polygon fill="lightgreen" stroke="black" points="309,-18746.83 93,-18746.83 93,-18693.83 309,-18693.83 309,-18746.83"/>
<text text-anchor="middle" x="201" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="201" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="201" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- gate_5&#45;&gt;expert0_up_5 -->
<g id="edge233" class="edge">
<title>gate_5&#45;&gt;expert0_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1003.21,-18856.56C864.58,-18847.2 652.55,-18828.64 471,-18794.83 410.2,-18783.51 343.11,-18765.28 291.01,-18749.8"/>
<polygon fill="blue" stroke="blue" points="291.72,-18746.36 281.13,-18746.85 289.71,-18753.07 291.72,-18746.36"/>
<text text-anchor="middle" x="522.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="522.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;4</text>
</g>
<!-- expert1_up_5 -->
<g id="node191" class="node">
<title>expert1_up_5</title>
<polygon fill="lightgreen" stroke="black" points="543,-18746.83 327,-18746.83 327,-18693.83 543,-18693.83 543,-18746.83"/>
<text text-anchor="middle" x="435" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="435" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="435" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_5&#45;&gt;expert1_up_5 -->
<g id="edge238" class="edge">
<title>gate_5&#45;&gt;expert1_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1025.27,-18849.97C932.44,-18838.01 803.68,-18819.2 692,-18794.83 635.57,-18782.52 573.27,-18764.81 524.14,-18749.86"/>
<polygon fill="blue" stroke="blue" points="525.08,-18746.49 514.5,-18746.91 523.03,-18753.18 525.08,-18746.49"/>
<text text-anchor="middle" x="743.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="743.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;5</text>
</g>
<!-- expert2_up_5 -->
<g id="node195" class="node">
<title>expert2_up_5</title>
<polygon fill="lightgreen" stroke="black" points="786,-18746.83 570,-18746.83 570,-18693.83 786,-18693.83 786,-18746.83"/>
<text text-anchor="middle" x="678" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="678" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="678" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_5&#45;&gt;expert2_up_5 -->
<g id="edge243" class="edge">
<title>gate_5&#45;&gt;expert2_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1054.73,-18841.44C1003.87,-18828.68 940.76,-18812.01 885,-18794.83 841.66,-18781.48 793.91,-18764.68 755.21,-18750.5"/>
<polygon fill="blue" stroke="blue" points="756.17,-18747.13 745.57,-18746.96 753.75,-18753.7 756.17,-18747.13"/>
<text text-anchor="middle" x="936.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="936.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;6</text>
</g>
<!-- expert3_up_5 -->
<g id="node199" class="node">
<title>expert3_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1024,-18746.83 808,-18746.83 808,-18693.83 1024,-18693.83 1024,-18746.83"/>
<text text-anchor="middle" x="916" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="916" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="916" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_5&#45;&gt;expert3_up_5 -->
<g id="edge248" class="edge">
<title>gate_5&#45;&gt;expert3_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1094.27,-18829.73C1055.23,-18805.99 1004.17,-18774.94 966.7,-18752.16"/>
<polygon fill="blue" stroke="blue" points="968.33,-18749.05 957.96,-18746.85 964.69,-18755.04 968.33,-18749.05"/>
<text text-anchor="middle" x="1085.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1085.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;7</text>
</g>
<!-- expert4_up_5 -->
<g id="node203" class="node">
<title>expert4_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1260,-18746.83 1044,-18746.83 1044,-18693.83 1260,-18693.83 1260,-18746.83"/>
<text text-anchor="middle" x="1152" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1152" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1152" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_5&#45;&gt;expert4_up_5 -->
<g id="edge253" class="edge">
<title>gate_5&#45;&gt;expert4_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1152,-18812.62C1152,-18794.35 1152,-18774.24 1152,-18757.56"/>
<polygon fill="blue" stroke="blue" points="1155.5,-18757.15 1152,-18747.15 1148.5,-18757.15 1155.5,-18757.15"/>
<text text-anchor="middle" x="1203.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1203.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;8</text>
</g>
<!-- expert5_up_5 -->
<g id="node207" class="node">
<title>expert5_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1494,-18746.83 1278,-18746.83 1278,-18693.83 1494,-18693.83 1494,-18746.83"/>
<text text-anchor="middle" x="1386" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1386" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1386" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_5&#45;&gt;expert5_up_5 -->
<g id="edge258" class="edge">
<title>gate_5&#45;&gt;expert5_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1209.54,-18829.55C1248.13,-18805.88 1298.47,-18775.01 1335.5,-18752.3"/>
<polygon fill="blue" stroke="blue" points="1337.44,-18755.22 1344.13,-18747.01 1333.78,-18749.25 1337.44,-18755.22"/>
<text text-anchor="middle" x="1361.5" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1361.5" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;9</text>
</g>
<!-- expert6_up_5 -->
<g id="node211" class="node">
<title>expert6_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1728,-18746.83 1512,-18746.83 1512,-18693.83 1728,-18693.83 1728,-18746.83"/>
<text text-anchor="middle" x="1620" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1620" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1620" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_5&#45;&gt;expert6_up_5 -->
<g id="edge263" class="edge">
<title>gate_5&#45;&gt;expert6_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1249.2,-18841.37C1299.58,-18828.65 1361.93,-18812.04 1417,-18794.83 1459.71,-18781.49 1506.73,-18764.61 1544.76,-18750.39"/>
<polygon fill="blue" stroke="blue" points="1546.09,-18753.63 1554.22,-18746.83 1543.63,-18747.07 1546.09,-18753.63"/>
<text text-anchor="middle" x="1557" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1557" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;10</text>
</g>
<!-- expert7_up_5 -->
<g id="node215" class="node">
<title>expert7_up_5</title>
<polygon fill="lightgreen" stroke="black" points="1963,-18746.83 1747,-18746.83 1747,-18693.83 1963,-18693.83 1963,-18746.83"/>
<text text-anchor="middle" x="1855" y="-18731.63" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1855" y="-18716.63" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1855" y="-18701.63" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_5&#45;&gt;expert7_up_5 -->
<g id="edge268" class="edge">
<title>gate_5&#45;&gt;expert7_up_5</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1280.76,-18850.72C1374.65,-18839.15 1504.58,-18820.5 1617,-18794.83 1669.55,-18782.84 1727.34,-18765.1 1772.82,-18750.05"/>
<polygon fill="blue" stroke="blue" points="1773.95,-18753.37 1782.33,-18746.89 1771.73,-18746.73 1773.95,-18753.37"/>
<text text-anchor="middle" x="1778" y="-18783.63" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1778" y="-18768.63" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;11</text>
</g>
<!-- expert0_act_5 -->
<g id="node188" class="node">
<title>expert0_act_5</title>
<polygon fill="lightgreen" stroke="black" points="284,-18656.83 116,-18656.83 116,-18603.83 284,-18603.83 284,-18656.83"/>
<text text-anchor="middle" x="200" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="200" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="200" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert0_up_5&#45;&gt;expert0_act_5 -->
<g id="edge234" class="edge">
<title>expert0_up_5&#45;&gt;expert0_act_5</title>
<path fill="none" stroke="black" d="M200.71,-18693.41C200.61,-18685.17 200.51,-18675.91 200.41,-18667.11"/>
<polygon fill="black" stroke="black" points="203.91,-18667.03 200.29,-18657.07 196.91,-18667.11 203.91,-18667.03"/>
</g>
<!-- expert0_down_5 -->
<g id="node189" class="node">
<title>expert0_down_5</title>
<polygon fill="lightgreen" stroke="black" points="306,-18566.83 90,-18566.83 90,-18513.83 306,-18513.83 306,-18566.83"/>
<text text-anchor="middle" x="198" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="198" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="198" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert0_act_5&#45;&gt;expert0_down_5 -->
<g id="edge235" class="edge">
<title>expert0_act_5&#45;&gt;expert0_down_5</title>
<path fill="none" stroke="black" d="M199.41,-18603.41C199.22,-18595.17 199.01,-18585.91 198.81,-18577.11"/>
<polygon fill="black" stroke="black" points="202.31,-18576.99 198.59,-18567.07 195.31,-18577.15 202.31,-18576.99"/>
</g>
<!-- expert0_agg_5 -->
<g id="node190" class="node">
<title>expert0_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="180" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="180" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="180" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="180" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- expert0_down_5&#45;&gt;expert0_agg_5 -->
<g id="edge236" class="edge">
<title>expert0_down_5&#45;&gt;expert0_agg_5</title>
<path fill="none" stroke="black" d="M193.32,-18513.59C191.82,-18505.34 190.11,-18495.95 188.43,-18486.7"/>
<polygon fill="black" stroke="black" points="191.86,-18485.99 186.62,-18476.78 184.97,-18487.24 191.86,-18485.99"/>
</g>
<!-- expert_agg_5 -->
<g id="node219" class="node">
<title>expert_agg_5</title>
<polygon fill="gold" stroke="black" points="1316.69,-18335.88 1054.71,-18335.88 987.31,-18229.88 1249.29,-18229.88 1316.69,-18335.88"/>
<text text-anchor="middle" x="1152" y="-18294.18" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1152" y="-18279.18" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-18264.18" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert0_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge237" class="edge">
<title>expert0_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M240.1,-18407.67C279.66,-18388.9 333.16,-18366.21 383,-18353.88 597.88,-18300.71 855.5,-18287.01 1011.32,-18283.98"/>
<polygon fill="purple" stroke="purple" points="1011.5,-18287.48 1021.44,-18283.8 1011.37,-18280.48 1011.5,-18287.48"/>
<text text-anchor="middle" x="454.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;11</text>
<text text-anchor="middle" x="454.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_5 -->
<g id="node192" class="node">
<title>expert1_act_5</title>
<polygon fill="lightgreen" stroke="black" points="517,-18656.83 349,-18656.83 349,-18603.83 517,-18603.83 517,-18656.83"/>
<text text-anchor="middle" x="433" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="433" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="433" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert1_up_5&#45;&gt;expert1_act_5 -->
<g id="edge239" class="edge">
<title>expert1_up_5&#45;&gt;expert1_act_5</title>
<path fill="none" stroke="black" d="M434.41,-18693.41C434.22,-18685.17 434.01,-18675.91 433.81,-18667.11"/>
<polygon fill="black" stroke="black" points="437.31,-18666.99 433.59,-18657.07 430.31,-18667.15 437.31,-18666.99"/>
</g>
<!-- expert1_down_5 -->
<g id="node193" class="node">
<title>expert1_down_5</title>
<polygon fill="lightgreen" stroke="black" points="540,-18566.83 324,-18566.83 324,-18513.83 540,-18513.83 540,-18566.83"/>
<text text-anchor="middle" x="432" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="432" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="432" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert1_act_5&#45;&gt;expert1_down_5 -->
<g id="edge240" class="edge">
<title>expert1_act_5&#45;&gt;expert1_down_5</title>
<path fill="none" stroke="black" d="M432.71,-18603.41C432.61,-18595.17 432.51,-18585.91 432.41,-18577.11"/>
<polygon fill="black" stroke="black" points="435.91,-18577.03 432.29,-18567.07 428.91,-18577.11 435.91,-18577.03"/>
</g>
<!-- expert1_agg_5 -->
<g id="node194" class="node">
<title>expert1_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="423" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="423" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="423" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="423" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert1_down_5&#45;&gt;expert1_agg_5 -->
<g id="edge241" class="edge">
<title>expert1_down_5&#45;&gt;expert1_agg_5</title>
<path fill="none" stroke="black" d="M429.66,-18513.59C428.92,-18505.51 428.09,-18496.33 427.27,-18487.27"/>
<polygon fill="black" stroke="black" points="430.74,-18486.8 426.35,-18477.15 423.77,-18487.43 430.74,-18486.8"/>
</g>
<!-- expert1_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge242" class="edge">
<title>expert1_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M480.69,-18406.92C516.82,-18388.6 564.93,-18366.66 610,-18353.88 744.65,-18315.69 904.1,-18298.27 1015.05,-18290.36"/>
<polygon fill="purple" stroke="purple" points="1015.56,-18293.83 1025.29,-18289.65 1015.07,-18286.85 1015.56,-18293.83"/>
<text text-anchor="middle" x="681.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;11</text>
<text text-anchor="middle" x="681.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_5 -->
<g id="node196" class="node">
<title>expert2_act_5</title>
<polygon fill="lightgreen" stroke="black" points="756,-18656.83 588,-18656.83 588,-18603.83 756,-18603.83 756,-18656.83"/>
<text text-anchor="middle" x="672" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="672" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="672" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert2_up_5&#45;&gt;expert2_act_5 -->
<g id="edge244" class="edge">
<title>expert2_up_5&#45;&gt;expert2_act_5</title>
<path fill="none" stroke="black" d="M676.23,-18693.41C675.67,-18685.17 675.04,-18675.91 674.44,-18667.11"/>
<polygon fill="black" stroke="black" points="677.93,-18666.81 673.76,-18657.07 670.94,-18667.29 677.93,-18666.81"/>
</g>
<!-- expert2_down_5 -->
<g id="node197" class="node">
<title>expert2_down_5</title>
<polygon fill="lightgreen" stroke="black" points="775,-18566.83 559,-18566.83 559,-18513.83 775,-18513.83 775,-18566.83"/>
<text text-anchor="middle" x="667" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="667" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="667" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert2_act_5&#45;&gt;expert2_down_5 -->
<g id="edge245" class="edge">
<title>expert2_act_5&#45;&gt;expert2_down_5</title>
<path fill="none" stroke="black" d="M670.53,-18603.41C670.06,-18595.17 669.53,-18585.91 669.03,-18577.11"/>
<polygon fill="black" stroke="black" points="672.52,-18576.86 668.46,-18567.07 665.54,-18577.26 672.52,-18576.86"/>
</g>
<!-- expert2_agg_5 -->
<g id="node198" class="node">
<title>expert2_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="666" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="666" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="666" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="666" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert2_down_5&#45;&gt;expert2_agg_5 -->
<g id="edge246" class="edge">
<title>expert2_down_5&#45;&gt;expert2_agg_5</title>
<path fill="none" stroke="black" d="M666.74,-18513.59C666.66,-18505.51 666.57,-18496.33 666.47,-18487.27"/>
<polygon fill="black" stroke="black" points="669.97,-18487.12 666.37,-18477.15 662.97,-18487.19 669.97,-18487.12"/>
</g>
<!-- expert2_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge247" class="edge">
<title>expert2_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M715.87,-18405.62C744.68,-18388.01 782.22,-18367.22 818,-18353.88 883.21,-18329.56 958.9,-18312.82 1021.72,-18301.83"/>
<polygon fill="purple" stroke="purple" points="1022.42,-18305.26 1031.69,-18300.11 1021.24,-18298.36 1022.42,-18305.26"/>
<text text-anchor="middle" x="889.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;11</text>
<text text-anchor="middle" x="889.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_5 -->
<g id="node200" class="node">
<title>expert3_act_5</title>
<polygon fill="lightgreen" stroke="black" points="997,-18656.83 829,-18656.83 829,-18603.83 997,-18603.83 997,-18656.83"/>
<text text-anchor="middle" x="913" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="913" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="913" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert3_up_5&#45;&gt;expert3_act_5 -->
<g id="edge249" class="edge">
<title>expert3_up_5&#45;&gt;expert3_act_5</title>
<path fill="none" stroke="black" d="M915.12,-18693.41C914.84,-18685.17 914.52,-18675.91 914.22,-18667.11"/>
<polygon fill="black" stroke="black" points="917.72,-18666.95 913.88,-18657.07 910.72,-18667.19 917.72,-18666.95"/>
</g>
<!-- expert3_down_5 -->
<g id="node201" class="node">
<title>expert3_down_5</title>
<polygon fill="lightgreen" stroke="black" points="1019,-18566.83 803,-18566.83 803,-18513.83 1019,-18513.83 1019,-18566.83"/>
<text text-anchor="middle" x="911" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="911" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="911" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert3_act_5&#45;&gt;expert3_down_5 -->
<g id="edge250" class="edge">
<title>expert3_act_5&#45;&gt;expert3_down_5</title>
<path fill="none" stroke="black" d="M912.41,-18603.41C912.22,-18595.17 912.01,-18585.91 911.81,-18577.11"/>
<polygon fill="black" stroke="black" points="915.31,-18576.99 911.59,-18567.07 908.31,-18577.15 915.31,-18576.99"/>
</g>
<!-- expert3_agg_5 -->
<g id="node202" class="node">
<title>expert3_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="909" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="909" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="909" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="909" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert3_down_5&#45;&gt;expert3_agg_5 -->
<g id="edge251" class="edge">
<title>expert3_down_5&#45;&gt;expert3_agg_5</title>
<path fill="none" stroke="black" d="M910.48,-18513.59C910.32,-18505.51 910.13,-18496.33 909.95,-18487.27"/>
<polygon fill="black" stroke="black" points="913.44,-18487.08 909.74,-18477.15 906.45,-18487.22 913.44,-18487.08"/>
</g>
<!-- expert3_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge252" class="edge">
<title>expert3_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M943.99,-18403.33C961.4,-18387.05 983.32,-18368.18 1005,-18353.88 1016.2,-18346.49 1028.31,-18339.44 1040.59,-18332.84"/>
<polygon fill="purple" stroke="purple" points="1042.34,-18335.88 1049.56,-18328.13 1039.08,-18329.68 1042.34,-18335.88"/>
<text text-anchor="middle" x="1076.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;11</text>
<text text-anchor="middle" x="1076.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_5 -->
<g id="node204" class="node">
<title>expert4_act_5</title>
<polygon fill="lightgreen" stroke="black" points="1236,-18656.83 1068,-18656.83 1068,-18603.83 1236,-18603.83 1236,-18656.83"/>
<text text-anchor="middle" x="1152" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1152" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1152" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert4_up_5&#45;&gt;expert4_act_5 -->
<g id="edge254" class="edge">
<title>expert4_up_5&#45;&gt;expert4_act_5</title>
<path fill="none" stroke="black" d="M1152,-18693.41C1152,-18685.17 1152,-18675.91 1152,-18667.11"/>
<polygon fill="black" stroke="black" points="1155.5,-18667.07 1152,-18657.07 1148.5,-18667.07 1155.5,-18667.07"/>
</g>
<!-- expert4_down_5 -->
<g id="node205" class="node">
<title>expert4_down_5</title>
<polygon fill="lightgreen" stroke="black" points="1260,-18566.83 1044,-18566.83 1044,-18513.83 1260,-18513.83 1260,-18566.83"/>
<text text-anchor="middle" x="1152" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1152" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1152" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert4_act_5&#45;&gt;expert4_down_5 -->
<g id="edge255" class="edge">
<title>expert4_act_5&#45;&gt;expert4_down_5</title>
<path fill="none" stroke="black" d="M1152,-18603.41C1152,-18595.17 1152,-18585.91 1152,-18577.11"/>
<polygon fill="black" stroke="black" points="1155.5,-18577.07 1152,-18567.07 1148.5,-18577.07 1155.5,-18577.07"/>
</g>
<!-- expert4_agg_5 -->
<g id="node206" class="node">
<title>expert4_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="1152" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1152" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1152" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert4_down_5&#45;&gt;expert4_agg_5 -->
<g id="edge256" class="edge">
<title>expert4_down_5&#45;&gt;expert4_agg_5</title>
<path fill="none" stroke="black" d="M1152,-18513.59C1152,-18505.51 1152,-18496.33 1152,-18487.27"/>
<polygon fill="black" stroke="black" points="1155.5,-18487.15 1152,-18477.15 1148.5,-18487.15 1155.5,-18487.15"/>
</g>
<!-- expert4_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge257" class="edge">
<title>expert4_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1152,-18401.75C1152,-18385.11 1152,-18364.95 1152,-18346.05"/>
<polygon fill="purple" stroke="purple" points="1155.5,-18346.01 1152,-18336.01 1148.5,-18346.01 1155.5,-18346.01"/>
<text text-anchor="middle" x="1223.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;11</text>
<text text-anchor="middle" x="1223.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_5 -->
<g id="node208" class="node">
<title>expert5_act_5</title>
<polygon fill="lightgreen" stroke="black" points="1472,-18656.83 1304,-18656.83 1304,-18603.83 1472,-18603.83 1472,-18656.83"/>
<text text-anchor="middle" x="1388" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1388" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1388" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert5_up_5&#45;&gt;expert5_act_5 -->
<g id="edge259" class="edge">
<title>expert5_up_5&#45;&gt;expert5_act_5</title>
<path fill="none" stroke="black" d="M1386.59,-18693.41C1386.78,-18685.17 1386.99,-18675.91 1387.19,-18667.11"/>
<polygon fill="black" stroke="black" points="1390.69,-18667.15 1387.41,-18657.07 1383.69,-18666.99 1390.69,-18667.15"/>
</g>
<!-- expert5_down_5 -->
<g id="node209" class="node">
<title>expert5_down_5</title>
<polygon fill="lightgreen" stroke="black" points="1498,-18566.83 1282,-18566.83 1282,-18513.83 1498,-18513.83 1498,-18566.83"/>
<text text-anchor="middle" x="1390" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1390" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1390" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert5_act_5&#45;&gt;expert5_down_5 -->
<g id="edge260" class="edge">
<title>expert5_act_5&#45;&gt;expert5_down_5</title>
<path fill="none" stroke="black" d="M1388.59,-18603.41C1388.78,-18595.17 1388.99,-18585.91 1389.19,-18577.11"/>
<polygon fill="black" stroke="black" points="1392.69,-18577.15 1389.41,-18567.07 1385.69,-18576.99 1392.69,-18577.15"/>
</g>
<!-- expert5_agg_5 -->
<g id="node210" class="node">
<title>expert5_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="1395" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1395" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1395" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1395" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert5_down_5&#45;&gt;expert5_agg_5 -->
<g id="edge261" class="edge">
<title>expert5_down_5&#45;&gt;expert5_agg_5</title>
<path fill="none" stroke="black" d="M1391.3,-18513.59C1391.71,-18505.51 1392.17,-18496.33 1392.63,-18487.27"/>
<polygon fill="black" stroke="black" points="1396.13,-18487.32 1393.14,-18477.15 1389.14,-18486.96 1396.13,-18487.32"/>
</g>
<!-- expert5_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge262" class="edge">
<title>expert5_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1360.01,-18403.33C1342.6,-18387.05 1320.68,-18368.18 1299,-18353.88 1292.36,-18349.5 1285.41,-18345.24 1278.29,-18341.13"/>
<polygon fill="purple" stroke="purple" points="1279.62,-18337.86 1269.2,-18335.99 1276.18,-18343.96 1279.62,-18337.86"/>
<text text-anchor="middle" x="1409.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;11</text>
<text text-anchor="middle" x="1409.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_5 -->
<g id="node212" class="node">
<title>expert6_act_5</title>
<polygon fill="lightgreen" stroke="black" points="1712,-18656.83 1544,-18656.83 1544,-18603.83 1712,-18603.83 1712,-18656.83"/>
<text text-anchor="middle" x="1628" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1628" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1628" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert6_up_5&#45;&gt;expert6_act_5 -->
<g id="edge264" class="edge">
<title>expert6_up_5&#45;&gt;expert6_act_5</title>
<path fill="none" stroke="black" d="M1622.36,-18693.41C1623.11,-18685.17 1623.95,-18675.91 1624.75,-18667.11"/>
<polygon fill="black" stroke="black" points="1628.24,-18667.35 1625.66,-18657.07 1621.27,-18666.72 1628.24,-18667.35"/>
</g>
<!-- expert6_down_5 -->
<g id="node213" class="node">
<title>expert6_down_5</title>
<polygon fill="lightgreen" stroke="black" points="1739,-18566.83 1523,-18566.83 1523,-18513.83 1739,-18513.83 1739,-18566.83"/>
<text text-anchor="middle" x="1631" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1631" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1631" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert6_act_5&#45;&gt;expert6_down_5 -->
<g id="edge265" class="edge">
<title>expert6_act_5&#45;&gt;expert6_down_5</title>
<path fill="none" stroke="black" d="M1628.88,-18603.41C1629.16,-18595.17 1629.48,-18585.91 1629.78,-18577.11"/>
<polygon fill="black" stroke="black" points="1633.28,-18577.19 1630.12,-18567.07 1626.28,-18576.95 1633.28,-18577.19"/>
</g>
<!-- expert6_agg_5 -->
<g id="node214" class="node">
<title>expert6_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="1638" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1638" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1638" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1638" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert6_down_5&#45;&gt;expert6_agg_5 -->
<g id="edge266" class="edge">
<title>expert6_down_5&#45;&gt;expert6_agg_5</title>
<path fill="none" stroke="black" d="M1632.82,-18513.59C1633.39,-18505.51 1634.04,-18496.33 1634.68,-18487.27"/>
<polygon fill="black" stroke="black" points="1638.18,-18487.38 1635.4,-18477.15 1631.2,-18486.88 1638.18,-18487.38"/>
</g>
<!-- expert6_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge267" class="edge">
<title>expert6_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1587.78,-18405.64C1558.76,-18388.04 1520.98,-18367.25 1485,-18353.88 1428.58,-18332.91 1364.33,-18317.55 1307.41,-18306.64"/>
<polygon fill="purple" stroke="purple" points="1307.72,-18303.14 1297.24,-18304.73 1306.42,-18310.02 1307.72,-18303.14"/>
<text text-anchor="middle" x="1616.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;11</text>
<text text-anchor="middle" x="1616.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_5 -->
<g id="node216" class="node">
<title>expert7_act_5</title>
<polygon fill="lightgreen" stroke="black" points="1942,-18656.83 1774,-18656.83 1774,-18603.83 1942,-18603.83 1942,-18656.83"/>
<text text-anchor="middle" x="1858" y="-18641.63" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1858" y="-18626.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1858" y="-18611.63" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert7_up_5&#45;&gt;expert7_act_5 -->
<g id="edge269" class="edge">
<title>expert7_up_5&#45;&gt;expert7_act_5</title>
<path fill="none" stroke="black" d="M1855.88,-18693.41C1856.16,-18685.17 1856.48,-18675.91 1856.78,-18667.11"/>
<polygon fill="black" stroke="black" points="1860.28,-18667.19 1857.12,-18657.07 1853.28,-18666.95 1860.28,-18667.19"/>
</g>
<!-- expert7_down_5 -->
<g id="node217" class="node">
<title>expert7_down_5</title>
<polygon fill="lightgreen" stroke="black" points="1980,-18566.83 1764,-18566.83 1764,-18513.83 1980,-18513.83 1980,-18566.83"/>
<text text-anchor="middle" x="1872" y="-18551.63" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1872" y="-18536.63" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1872" y="-18521.63" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert7_act_5&#45;&gt;expert7_down_5 -->
<g id="edge270" class="edge">
<title>expert7_act_5&#45;&gt;expert7_down_5</title>
<path fill="none" stroke="black" d="M1862.12,-18603.41C1863.43,-18595.17 1864.91,-18585.91 1866.31,-18577.11"/>
<polygon fill="black" stroke="black" points="1869.79,-18577.5 1867.9,-18567.07 1862.88,-18576.4 1869.79,-18577.5"/>
</g>
<!-- expert7_agg_5 -->
<g id="node218" class="node">
<title>expert7_agg_5</title>
<ellipse fill="lightgray" stroke="black" cx="1881" cy="-18439.36" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1881" y="-18450.66" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1881" y="-18435.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1881" y="-18420.66" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert7_down_5&#45;&gt;expert7_agg_5 -->
<g id="edge271" class="edge">
<title>expert7_down_5&#45;&gt;expert7_agg_5</title>
<path fill="none" stroke="black" d="M1874.34,-18513.59C1875.08,-18505.51 1875.91,-18496.33 1876.73,-18487.27"/>
<polygon fill="black" stroke="black" points="1880.23,-18487.43 1877.65,-18477.15 1873.26,-18486.8 1880.23,-18487.43"/>
</g>
<!-- expert7_agg_5&#45;&gt;expert_agg_5 -->
<g id="edge272" class="edge">
<title>expert7_agg_5&#45;&gt;expert_agg_5</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1823.07,-18407.15C1786.49,-18388.8 1737.66,-18366.75 1692,-18353.88 1561.63,-18317.15 1408.04,-18299.61 1298.06,-18291.28"/>
<polygon fill="purple" stroke="purple" points="1298.12,-18287.77 1287.89,-18290.53 1297.6,-18294.75 1298.12,-18287.77"/>
<text text-anchor="middle" x="1842.5" y="-18372.68" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;11</text>
<text text-anchor="middle" x="1842.5" y="-18357.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_5&#45;&gt;residual2_5 -->
<g id="edge273" class="edge">
<title>expert_agg_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M1267.1,-18257.8C1387.72,-18232.57 1576.61,-18193.05 1700.86,-18167.06"/>
<polygon fill="black" stroke="black" points="1701.74,-18170.45 1710.81,-18164.98 1700.31,-18163.6 1701.74,-18170.45"/>
</g>
<!-- layer_out_5 -->
<g id="node221" class="node">
<title>layer_out_5</title>
<ellipse fill="lightgray" stroke="black" cx="1826" cy="-18012.4" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1826" y="-18023.7" font-family="Times,serif" font-size="14.00">Layer5_Output</text>
<text text-anchor="middle" x="1826" y="-18008.7" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1826" y="-17993.7" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual2_5&#45;&gt;layer_out_5 -->
<g id="edge275" class="edge">
<title>residual2_5&#45;&gt;layer_out_5</title>
<path fill="none" stroke="black" d="M1826,-18086.76C1826,-18077.85 1826,-18068.65 1826,-18059.91"/>
<polygon fill="black" stroke="black" points="1829.5,-18059.89 1826,-18049.89 1822.5,-18059.89 1829.5,-18059.89"/>
</g>
<!-- ln1_6 -->
<g id="node222" class="node">
<title>ln1_6</title>
<polygon fill="lightyellow" stroke="black" points="1698.5,-17887.93 1539.5,-17887.93 1539.5,-17834.93 1698.5,-17834.93 1698.5,-17887.93"/>
<text text-anchor="middle" x="1619" y="-17872.73" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1619" y="-17857.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1619" y="-17842.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- layer_out_5&#45;&gt;ln1_6 -->
<g id="edge276" class="edge">
<title>layer_out_5&#45;&gt;ln1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1779.8,-17978.16C1744.87,-17953.02 1697.22,-17918.72 1662.87,-17894"/>
<polygon fill="red" stroke="red" points="1664.6,-17890.94 1654.44,-17887.94 1660.52,-17896.62 1664.6,-17890.94"/>
<text text-anchor="middle" x="1818.5" y="-17945.73" font-family="Times,serif" font-size="14.00">GPU&#45;39→GPU&#45;5</text>
<text text-anchor="middle" x="1818.5" y="-17930.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_6 -->
<g id="node228" class="node">
<title>residual1_6</title>
<polygon fill="lightpink" stroke="black" points="2056.69,-17527.93 1794.71,-17527.93 1727.31,-17421.93 1989.29,-17421.93 2056.69,-17527.93"/>
<text text-anchor="middle" x="1892" y="-17486.23" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1892" y="-17471.23" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1892" y="-17456.23" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- layer_out_5&#45;&gt;residual1_6 -->
<g id="edge284" class="edge">
<title>layer_out_5&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1873.23,-17978.24C1880.73,-17971.71 1887.99,-17964.52 1894,-17956.93 1922.88,-17920.46 1939,-17908.95 1939,-17862.43 1939,-17862.43 1939,-17862.43 1939,-17590.43 1939,-17572.55 1934.04,-17554.21 1927.34,-17537.58"/>
<polygon fill="black" stroke="black" points="1930.39,-17535.81 1923.22,-17528.01 1923.96,-17538.58 1930.39,-17535.81"/>
</g>
<!-- mha_q_6 -->
<g id="node223" class="node">
<title>mha_q_6</title>
<polygon fill="lightcoral" stroke="black" points="1436.5,-17797.93 1217.5,-17797.93 1217.5,-17744.93 1436.5,-17744.93 1436.5,-17797.93"/>
<text text-anchor="middle" x="1327" y="-17782.73" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1327" y="-17767.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1327" y="-17752.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_q_6 -->
<g id="edge277" class="edge">
<title>ln1_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M1539.21,-17836.38C1502.94,-17825.45 1459.75,-17812.43 1421.83,-17801.01"/>
<polygon fill="black" stroke="black" points="1422.39,-17797.52 1411.8,-17797.98 1420.37,-17804.22 1422.39,-17797.52"/>
</g>
<!-- mha_k_6 -->
<g id="node224" class="node">
<title>mha_k_6</title>
<polygon fill="lightcoral" stroke="black" points="1673.5,-17797.93 1454.5,-17797.93 1454.5,-17744.93 1673.5,-17744.93 1673.5,-17797.93"/>
<text text-anchor="middle" x="1564" y="-17782.73" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1564" y="-17767.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1564" y="-17752.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_k_6 -->
<g id="edge278" class="edge">
<title>ln1_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M1602.8,-17834.5C1597.37,-17825.82 1591.23,-17816 1585.47,-17806.77"/>
<polygon fill="black" stroke="black" points="1588.36,-17804.79 1580.09,-17798.17 1582.42,-17808.5 1588.36,-17804.79"/>
</g>
<!-- mha_v_6 -->
<g id="node225" class="node">
<title>mha_v_6</title>
<polygon fill="lightcoral" stroke="black" points="1910.5,-17797.93 1691.5,-17797.93 1691.5,-17744.93 1910.5,-17744.93 1910.5,-17797.93"/>
<text text-anchor="middle" x="1801" y="-17782.73" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1801" y="-17767.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1801" y="-17752.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_v_6 -->
<g id="edge279" class="edge">
<title>ln1_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M1672.13,-17834.74C1693.06,-17824.62 1717.25,-17812.92 1738.97,-17802.42"/>
<polygon fill="black" stroke="black" points="1740.64,-17805.5 1748.12,-17798 1737.59,-17799.2 1740.64,-17805.5"/>
</g>
<!-- mha_attn_6 -->
<g id="node226" class="node">
<title>mha_attn_6</title>
<polygon fill="lightcoral" stroke="black" points="1699.5,-17707.93 1528.5,-17707.93 1528.5,-17654.93 1699.5,-17654.93 1699.5,-17707.93"/>
<text text-anchor="middle" x="1614" y="-17692.73" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1614" y="-17677.73" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1614" y="-17662.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge280" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M1410.4,-17744.85C1444.89,-17734.28 1485.04,-17721.97 1520.52,-17711.09"/>
<polygon fill="black" stroke="black" points="1521.86,-17714.34 1530.39,-17708.06 1519.81,-17707.65 1521.86,-17714.34"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge281" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M1578.73,-17744.5C1583.61,-17735.91 1589.13,-17726.2 1594.32,-17717.06"/>
<polygon fill="black" stroke="black" points="1597.48,-17718.59 1599.37,-17708.17 1591.39,-17715.13 1597.48,-17718.59"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge282" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M1746.66,-17744.85C1725.05,-17734.69 1700.04,-17722.91 1677.59,-17712.35"/>
<polygon fill="black" stroke="black" points="1679.01,-17709.15 1668.47,-17708.06 1676.03,-17715.49 1679.01,-17709.15"/>
</g>
<!-- mha_out_6 -->
<g id="node227" class="node">
<title>mha_out_6</title>
<polygon fill="lightcoral" stroke="black" points="1844.5,-17617.93 1685.5,-17617.93 1685.5,-17564.93 1844.5,-17564.93 1844.5,-17617.93"/>
<text text-anchor="middle" x="1765" y="-17602.73" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1765" y="-17587.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1765" y="-17572.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge283" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M1658.08,-17654.74C1674.98,-17644.89 1694.44,-17633.55 1712.09,-17623.26"/>
<polygon fill="black" stroke="black" points="1714.25,-17626.06 1721.12,-17618 1710.72,-17620.01 1714.25,-17626.06"/>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge285" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M1793.5,-17564.73C1803.4,-17555.81 1814.95,-17545.39 1826.58,-17534.9"/>
<polygon fill="black" stroke="black" points="1829.14,-17537.31 1834.22,-17528.02 1824.45,-17532.11 1829.14,-17537.31"/>
</g>
<!-- ln2_6 -->
<g id="node229" class="node">
<title>ln2_6</title>
<polygon fill="lightyellow" stroke="black" points="1740.5,-17384.93 1581.5,-17384.93 1581.5,-17331.93 1740.5,-17331.93 1740.5,-17384.93"/>
<text text-anchor="middle" x="1661" y="-17369.73" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1661" y="-17354.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1661" y="-17339.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge286" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M1786.98,-17421.87C1764.55,-17410.75 1741.59,-17399.37 1721.52,-17389.42"/>
<polygon fill="black" stroke="black" points="1723.03,-17386.27 1712.51,-17384.96 1719.92,-17392.54 1723.03,-17386.27"/>
</g>
<!-- residual2_6 -->
<g id="node264" class="node">
<title>residual2_6</title>
<polygon fill="lightpink" stroke="black" points="2045.69,-16568.97 1783.71,-16568.97 1716.31,-16462.97 1978.29,-16462.97 2045.69,-16568.97"/>
<text text-anchor="middle" x="1881" y="-16527.27" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1881" y="-16512.27" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1881" y="-16497.27" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge329" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M2007.73,-17450.76C2053.32,-17434.27 2095,-17406.36 2095,-17359.43 2095,-17359.43 2095,-17359.43 2095,-16657.97 2095,-16622.29 2073.99,-16595.12 2045.14,-16574.64"/>
<polygon fill="black" stroke="black" points="2047.06,-16571.71 2036.81,-16569.04 2043.15,-16577.52 2047.06,-16571.71"/>
</g>
<!-- gate_6 -->
<g id="node230" class="node">
<title>gate_6</title>
<polygon fill="orange" stroke="black" points="1235,-17294.93 1055,-17241.93 1235,-17188.93 1415,-17241.93 1235,-17294.93"/>
<text text-anchor="middle" x="1235" y="-17253.23" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1235" y="-17238.23" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1235" y="-17223.23" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln2_6&#45;&gt;gate_6 -->
<g id="edge287" class="edge">
<title>ln2_6&#45;&gt;gate_6</title>
<path fill="none" stroke="black" d="M1581.37,-17336.02C1512.46,-17317.5 1412.39,-17290.6 1337.5,-17270.48"/>
<polygon fill="black" stroke="black" points="1338.14,-17267.02 1327.58,-17267.81 1336.32,-17273.78 1338.14,-17267.02"/>
</g>
<!-- expert0_up_6 -->
<g id="node231" class="node">
<title>expert0_up_6</title>
<polygon fill="lightgreen" stroke="black" points="388,-17122.93 172,-17122.93 172,-17069.93 388,-17069.93 388,-17122.93"/>
<text text-anchor="middle" x="280" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="280" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="280" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- gate_6&#45;&gt;expert0_up_6 -->
<g id="edge288" class="edge">
<title>gate_6&#45;&gt;expert0_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1086.46,-17232.65C947.44,-17223.27 734.4,-17204.69 552,-17170.93 490.64,-17159.57 422.9,-17141.28 370.37,-17125.79"/>
<polygon fill="blue" stroke="blue" points="371.32,-17122.42 360.74,-17122.93 369.33,-17129.13 371.32,-17122.42"/>
<text text-anchor="middle" x="603.5" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="603.5" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;5</text>
</g>
<!-- expert1_up_6 -->
<g id="node235" class="node">
<title>expert1_up_6</title>
<polygon fill="lightgreen" stroke="black" points="626,-17122.93 410,-17122.93 410,-17069.93 626,-17069.93 626,-17122.93"/>
<text text-anchor="middle" x="518" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="518" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="518" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_6&#45;&gt;expert1_up_6 -->
<g id="edge293" class="edge">
<title>gate_6&#45;&gt;expert1_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1107.63,-17226.35C1013.93,-17214.5 883.79,-17195.7 771,-17170.93 715.41,-17158.72 654.09,-17141.01 605.74,-17126.04"/>
<polygon fill="blue" stroke="blue" points="606.53,-17122.62 595.94,-17122.98 604.45,-17129.3 606.53,-17122.62"/>
<text text-anchor="middle" x="822.5" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="822.5" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;6</text>
</g>
<!-- expert2_up_6 -->
<g id="node239" class="node">
<title>expert2_up_6</title>
<polygon fill="lightgreen" stroke="black" points="862,-17122.93 646,-17122.93 646,-17069.93 862,-17069.93 862,-17122.93"/>
<text text-anchor="middle" x="754" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="754" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="754" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_6&#45;&gt;expert2_up_6 -->
<g id="edge298" class="edge">
<title>gate_6&#45;&gt;expert2_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1137.68,-17217.58C1086.34,-17204.76 1022.46,-17188.03 966,-17170.93 921.57,-17157.47 872.56,-17140.61 832.87,-17126.44"/>
<polygon fill="blue" stroke="blue" points="833.84,-17123.07 823.25,-17122.99 831.48,-17129.66 833.84,-17123.07"/>
<text text-anchor="middle" x="1017.5" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1017.5" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;7</text>
</g>
<!-- expert3_up_6 -->
<g id="node243" class="node">
<title>expert3_up_6</title>
<polygon fill="lightgreen" stroke="black" points="1105,-17122.93 889,-17122.93 889,-17069.93 1105,-17069.93 1105,-17122.93"/>
<text text-anchor="middle" x="997" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="997" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="997" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_6&#45;&gt;expert3_up_6 -->
<g id="edge303" class="edge">
<title>gate_6&#45;&gt;expert3_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1176.78,-17205.82C1137.41,-17182.09 1085.91,-17151.04 1048.13,-17128.25"/>
<polygon fill="blue" stroke="blue" points="1049.69,-17125.11 1039.32,-17122.94 1046.08,-17131.1 1049.69,-17125.11"/>
<text text-anchor="middle" x="1167.5" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1167.5" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;8</text>
</g>
<!-- expert4_up_6 -->
<g id="node247" class="node">
<title>expert4_up_6</title>
<polygon fill="lightgreen" stroke="black" points="1343,-17122.93 1127,-17122.93 1127,-17069.93 1343,-17069.93 1343,-17122.93"/>
<text text-anchor="middle" x="1235" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1235" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1235" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_6&#45;&gt;expert4_up_6 -->
<g id="edge308" class="edge">
<title>gate_6&#45;&gt;expert4_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1235,-17188.71C1235,-17170.44 1235,-17150.33 1235,-17133.65"/>
<polygon fill="blue" stroke="blue" points="1238.5,-17133.24 1235,-17123.24 1231.5,-17133.24 1238.5,-17133.24"/>
<text text-anchor="middle" x="1286.5" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1286.5" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;9</text>
</g>
<!-- expert5_up_6 -->
<g id="node251" class="node">
<title>expert5_up_6</title>
<polygon fill="lightgreen" stroke="black" points="1581,-17122.93 1365,-17122.93 1365,-17069.93 1581,-17069.93 1581,-17122.93"/>
<text text-anchor="middle" x="1473" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1473" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1473" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_6&#45;&gt;expert5_up_6 -->
<g id="edge313" class="edge">
<title>gate_6&#45;&gt;expert5_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1293.22,-17205.82C1332.59,-17182.09 1384.09,-17151.04 1421.87,-17128.25"/>
<polygon fill="blue" stroke="blue" points="1423.92,-17131.1 1430.68,-17122.94 1420.31,-17125.11 1423.92,-17131.1"/>
<text text-anchor="middle" x="1452" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1452" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;10</text>
</g>
<!-- expert6_up_6 -->
<g id="node255" class="node">
<title>expert6_up_6</title>
<polygon fill="lightgreen" stroke="black" points="1816,-17122.93 1600,-17122.93 1600,-17069.93 1816,-17069.93 1816,-17122.93"/>
<text text-anchor="middle" x="1708" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1708" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1708" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_6&#45;&gt;expert6_up_6 -->
<g id="edge318" class="edge">
<title>gate_6&#45;&gt;expert6_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1335.43,-17218.39C1388.36,-17205.8 1454.13,-17189.03 1512,-17170.93 1553.39,-17157.98 1598.78,-17141.13 1635.45,-17126.83"/>
<polygon fill="blue" stroke="blue" points="1637.03,-17129.97 1645.07,-17123.07 1634.48,-17123.46 1637.03,-17129.97"/>
<text text-anchor="middle" x="1649" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1649" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;11</text>
</g>
<!-- expert7_up_6 -->
<g id="node259" class="node">
<title>expert7_up_6</title>
<polygon fill="lightgreen" stroke="black" points="2052,-17122.93 1836,-17122.93 1836,-17069.93 2052,-17069.93 2052,-17122.93"/>
<text text-anchor="middle" x="1944" y="-17107.73" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1944" y="-17092.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1944" y="-17077.73" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_6&#45;&gt;expert7_up_6 -->
<g id="edge323" class="edge">
<title>gate_6&#45;&gt;expert7_up_6</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1365.28,-17227.25C1461.08,-17215.86 1594.06,-17197.22 1709,-17170.93 1760.93,-17159.05 1817.98,-17141.32 1862.87,-17126.25"/>
<polygon fill="blue" stroke="blue" points="1864.19,-17129.5 1872.54,-17122.98 1861.95,-17122.87 1864.19,-17129.5"/>
<text text-anchor="middle" x="1869" y="-17159.73" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1869" y="-17144.73" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;12</text>
</g>
<!-- expert0_act_6 -->
<g id="node232" class="node">
<title>expert0_act_6</title>
<polygon fill="lightgreen" stroke="black" points="360,-17032.93 192,-17032.93 192,-16979.93 360,-16979.93 360,-17032.93"/>
<text text-anchor="middle" x="276" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="276" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="276" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert0_up_6&#45;&gt;expert0_act_6 -->
<g id="edge289" class="edge">
<title>expert0_up_6&#45;&gt;expert0_act_6</title>
<path fill="none" stroke="black" d="M278.82,-17069.5C278.45,-17061.26 278.03,-17052.01 277.63,-17043.2"/>
<polygon fill="black" stroke="black" points="281.12,-17043 277.17,-17033.17 274.13,-17043.32 281.12,-17043"/>
</g>
<!-- expert0_down_6 -->
<g id="node233" class="node">
<title>expert0_down_6</title>
<polygon fill="lightgreen" stroke="black" points="377,-16942.93 161,-16942.93 161,-16889.93 377,-16889.93 377,-16942.93"/>
<text text-anchor="middle" x="269" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="269" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="269" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert0_act_6&#45;&gt;expert0_down_6 -->
<g id="edge290" class="edge">
<title>expert0_act_6&#45;&gt;expert0_down_6</title>
<path fill="none" stroke="black" d="M273.94,-16979.5C273.28,-16971.26 272.55,-16962.01 271.85,-16953.2"/>
<polygon fill="black" stroke="black" points="275.33,-16952.86 271.05,-16943.17 268.35,-16953.41 275.33,-16952.86"/>
</g>
<!-- expert0_agg_6 -->
<g id="node234" class="node">
<title>expert0_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="263" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="263" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="263" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="263" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- expert0_down_6&#45;&gt;expert0_agg_6 -->
<g id="edge291" class="edge">
<title>expert0_down_6&#45;&gt;expert0_agg_6</title>
<path fill="none" stroke="black" d="M267.44,-16889.68C266.95,-16881.61 266.39,-16872.43 265.84,-16863.36"/>
<polygon fill="black" stroke="black" points="269.33,-16863.02 265.23,-16853.25 262.34,-16863.44 269.33,-16863.02"/>
</g>
<!-- expert_agg_6 -->
<g id="node263" class="node">
<title>expert_agg_6</title>
<polygon fill="gold" stroke="black" points="1399.69,-16711.97 1137.71,-16711.97 1070.31,-16605.97 1332.29,-16605.97 1399.69,-16711.97"/>
<text text-anchor="middle" x="1235" y="-16670.27" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1235" y="-16655.27" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1235" y="-16640.27" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert0_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge292" class="edge">
<title>expert0_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M323.1,-16783.76C362.66,-16765 416.16,-16742.3 466,-16729.97 680.88,-16676.8 938.5,-16663.1 1094.32,-16660.07"/>
<polygon fill="purple" stroke="purple" points="1094.5,-16663.57 1104.44,-16659.89 1094.37,-16656.57 1094.5,-16663.57"/>
<text text-anchor="middle" x="537.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;12</text>
<text text-anchor="middle" x="537.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_6 -->
<g id="node236" class="node">
<title>expert1_act_6</title>
<polygon fill="lightgreen" stroke="black" points="599,-17032.93 431,-17032.93 431,-16979.93 599,-16979.93 599,-17032.93"/>
<text text-anchor="middle" x="515" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="515" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="515" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert1_up_6&#45;&gt;expert1_act_6 -->
<g id="edge294" class="edge">
<title>expert1_up_6&#45;&gt;expert1_act_6</title>
<path fill="none" stroke="black" d="M517.12,-17069.5C516.84,-17061.26 516.52,-17052.01 516.22,-17043.2"/>
<polygon fill="black" stroke="black" points="519.72,-17043.04 515.88,-17033.17 512.72,-17043.28 519.72,-17043.04"/>
</g>
<!-- expert1_down_6 -->
<g id="node237" class="node">
<title>expert1_down_6</title>
<polygon fill="lightgreen" stroke="black" points="620,-16942.93 404,-16942.93 404,-16889.93 620,-16889.93 620,-16942.93"/>
<text text-anchor="middle" x="512" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="512" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="512" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert1_act_6&#45;&gt;expert1_down_6 -->
<g id="edge295" class="edge">
<title>expert1_act_6&#45;&gt;expert1_down_6</title>
<path fill="none" stroke="black" d="M514.12,-16979.5C513.84,-16971.26 513.52,-16962.01 513.22,-16953.2"/>
<polygon fill="black" stroke="black" points="516.72,-16953.04 512.88,-16943.17 509.72,-16953.28 516.72,-16953.04"/>
</g>
<!-- expert1_agg_6 -->
<g id="node238" class="node">
<title>expert1_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="506" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="506" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="506" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="506" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert1_down_6&#45;&gt;expert1_agg_6 -->
<g id="edge296" class="edge">
<title>expert1_down_6&#45;&gt;expert1_agg_6</title>
<path fill="none" stroke="black" d="M510.44,-16889.68C509.95,-16881.61 509.39,-16872.43 508.84,-16863.36"/>
<polygon fill="black" stroke="black" points="512.33,-16863.02 508.23,-16853.25 505.34,-16863.44 512.33,-16863.02"/>
</g>
<!-- expert1_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge297" class="edge">
<title>expert1_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M563.69,-16783.01C599.82,-16764.7 647.93,-16742.76 693,-16729.97 827.65,-16691.78 987.1,-16674.36 1098.05,-16666.46"/>
<polygon fill="purple" stroke="purple" points="1098.56,-16669.93 1108.29,-16665.74 1098.07,-16662.94 1098.56,-16669.93"/>
<text text-anchor="middle" x="764.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;12</text>
<text text-anchor="middle" x="764.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_6 -->
<g id="node240" class="node">
<title>expert2_act_6</title>
<polygon fill="lightgreen" stroke="black" points="836,-17032.93 668,-17032.93 668,-16979.93 836,-16979.93 836,-17032.93"/>
<text text-anchor="middle" x="752" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="752" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="752" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert2_up_6&#45;&gt;expert2_act_6 -->
<g id="edge299" class="edge">
<title>expert2_up_6&#45;&gt;expert2_act_6</title>
<path fill="none" stroke="black" d="M753.41,-17069.5C753.22,-17061.26 753.01,-17052.01 752.81,-17043.2"/>
<polygon fill="black" stroke="black" points="756.31,-17043.09 752.59,-17033.17 749.31,-17043.24 756.31,-17043.09"/>
</g>
<!-- expert2_down_6 -->
<g id="node241" class="node">
<title>expert2_down_6</title>
<polygon fill="lightgreen" stroke="black" points="858,-16942.93 642,-16942.93 642,-16889.93 858,-16889.93 858,-16942.93"/>
<text text-anchor="middle" x="750" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="750" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="750" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert2_act_6&#45;&gt;expert2_down_6 -->
<g id="edge300" class="edge">
<title>expert2_act_6&#45;&gt;expert2_down_6</title>
<path fill="none" stroke="black" d="M751.41,-16979.5C751.22,-16971.26 751.01,-16962.01 750.81,-16953.2"/>
<polygon fill="black" stroke="black" points="754.31,-16953.09 750.59,-16943.17 747.31,-16953.24 754.31,-16953.09"/>
</g>
<!-- expert2_agg_6 -->
<g id="node242" class="node">
<title>expert2_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="749" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="749" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="749" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="749" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert2_down_6&#45;&gt;expert2_agg_6 -->
<g id="edge301" class="edge">
<title>expert2_down_6&#45;&gt;expert2_agg_6</title>
<path fill="none" stroke="black" d="M749.74,-16889.68C749.66,-16881.61 749.57,-16872.43 749.47,-16863.36"/>
<polygon fill="black" stroke="black" points="752.97,-16863.21 749.37,-16853.25 745.97,-16863.28 752.97,-16863.21"/>
</g>
<!-- expert2_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge302" class="edge">
<title>expert2_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M798.87,-16781.71C827.68,-16764.1 865.22,-16743.32 901,-16729.97 966.21,-16705.66 1041.9,-16688.92 1104.72,-16677.92"/>
<polygon fill="purple" stroke="purple" points="1105.42,-16681.35 1114.69,-16676.21 1104.24,-16674.45 1105.42,-16681.35"/>
<text text-anchor="middle" x="972.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;12</text>
<text text-anchor="middle" x="972.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_6 -->
<g id="node244" class="node">
<title>expert3_act_6</title>
<polygon fill="lightgreen" stroke="black" points="1079,-17032.93 911,-17032.93 911,-16979.93 1079,-16979.93 1079,-17032.93"/>
<text text-anchor="middle" x="995" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="995" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="995" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert3_up_6&#45;&gt;expert3_act_6 -->
<g id="edge304" class="edge">
<title>expert3_up_6&#45;&gt;expert3_act_6</title>
<path fill="none" stroke="black" d="M996.41,-17069.5C996.22,-17061.26 996.01,-17052.01 995.81,-17043.2"/>
<polygon fill="black" stroke="black" points="999.31,-17043.09 995.59,-17033.17 992.31,-17043.24 999.31,-17043.09"/>
</g>
<!-- expert3_down_6 -->
<g id="node245" class="node">
<title>expert3_down_6</title>
<polygon fill="lightgreen" stroke="black" points="1102,-16942.93 886,-16942.93 886,-16889.93 1102,-16889.93 1102,-16942.93"/>
<text text-anchor="middle" x="994" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="994" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="994" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert3_act_6&#45;&gt;expert3_down_6 -->
<g id="edge305" class="edge">
<title>expert3_act_6&#45;&gt;expert3_down_6</title>
<path fill="none" stroke="black" d="M994.71,-16979.5C994.61,-16971.26 994.51,-16962.01 994.41,-16953.2"/>
<polygon fill="black" stroke="black" points="997.91,-16953.13 994.29,-16943.17 990.91,-16953.21 997.91,-16953.13"/>
</g>
<!-- expert3_agg_6 -->
<g id="node246" class="node">
<title>expert3_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="992" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="992" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="992" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="992" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert3_down_6&#45;&gt;expert3_agg_6 -->
<g id="edge306" class="edge">
<title>expert3_down_6&#45;&gt;expert3_agg_6</title>
<path fill="none" stroke="black" d="M993.48,-16889.68C993.32,-16881.61 993.13,-16872.43 992.95,-16863.36"/>
<polygon fill="black" stroke="black" points="996.44,-16863.17 992.74,-16853.25 989.45,-16863.32 996.44,-16863.17"/>
</g>
<!-- expert3_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge307" class="edge">
<title>expert3_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1026.99,-16779.43C1044.4,-16763.15 1066.32,-16744.27 1088,-16729.97 1099.2,-16722.58 1111.31,-16715.53 1123.59,-16708.94"/>
<polygon fill="purple" stroke="purple" points="1125.34,-16711.97 1132.56,-16704.22 1122.08,-16705.78 1125.34,-16711.97"/>
<text text-anchor="middle" x="1159.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;12</text>
<text text-anchor="middle" x="1159.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_6 -->
<g id="node248" class="node">
<title>expert4_act_6</title>
<polygon fill="lightgreen" stroke="black" points="1319,-17032.93 1151,-17032.93 1151,-16979.93 1319,-16979.93 1319,-17032.93"/>
<text text-anchor="middle" x="1235" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1235" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1235" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert4_up_6&#45;&gt;expert4_act_6 -->
<g id="edge309" class="edge">
<title>expert4_up_6&#45;&gt;expert4_act_6</title>
<path fill="none" stroke="black" d="M1235,-17069.5C1235,-17061.26 1235,-17052.01 1235,-17043.2"/>
<polygon fill="black" stroke="black" points="1238.5,-17043.17 1235,-17033.17 1231.5,-17043.17 1238.5,-17043.17"/>
</g>
<!-- expert4_down_6 -->
<g id="node249" class="node">
<title>expert4_down_6</title>
<polygon fill="lightgreen" stroke="black" points="1343,-16942.93 1127,-16942.93 1127,-16889.93 1343,-16889.93 1343,-16942.93"/>
<text text-anchor="middle" x="1235" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1235" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1235" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert4_act_6&#45;&gt;expert4_down_6 -->
<g id="edge310" class="edge">
<title>expert4_act_6&#45;&gt;expert4_down_6</title>
<path fill="none" stroke="black" d="M1235,-16979.5C1235,-16971.26 1235,-16962.01 1235,-16953.2"/>
<polygon fill="black" stroke="black" points="1238.5,-16953.17 1235,-16943.17 1231.5,-16953.17 1238.5,-16953.17"/>
</g>
<!-- expert4_agg_6 -->
<g id="node250" class="node">
<title>expert4_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="1235" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1235" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1235" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1235" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert4_down_6&#45;&gt;expert4_agg_6 -->
<g id="edge311" class="edge">
<title>expert4_down_6&#45;&gt;expert4_agg_6</title>
<path fill="none" stroke="black" d="M1235,-16889.68C1235,-16881.61 1235,-16872.43 1235,-16863.36"/>
<polygon fill="black" stroke="black" points="1238.5,-16863.25 1235,-16853.25 1231.5,-16863.25 1238.5,-16863.25"/>
</g>
<!-- expert4_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge312" class="edge">
<title>expert4_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1235,-16777.84C1235,-16761.2 1235,-16741.05 1235,-16722.15"/>
<polygon fill="purple" stroke="purple" points="1238.5,-16722.1 1235,-16712.1 1231.5,-16722.1 1238.5,-16722.1"/>
<text text-anchor="middle" x="1306.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;12</text>
<text text-anchor="middle" x="1306.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_6 -->
<g id="node252" class="node">
<title>expert5_act_6</title>
<polygon fill="lightgreen" stroke="black" points="1559,-17032.93 1391,-17032.93 1391,-16979.93 1559,-16979.93 1559,-17032.93"/>
<text text-anchor="middle" x="1475" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1475" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1475" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert5_up_6&#45;&gt;expert5_act_6 -->
<g id="edge314" class="edge">
<title>expert5_up_6&#45;&gt;expert5_act_6</title>
<path fill="none" stroke="black" d="M1473.59,-17069.5C1473.78,-17061.26 1473.99,-17052.01 1474.19,-17043.2"/>
<polygon fill="black" stroke="black" points="1477.69,-17043.24 1474.41,-17033.17 1470.69,-17043.09 1477.69,-17043.24"/>
</g>
<!-- expert5_down_6 -->
<g id="node253" class="node">
<title>expert5_down_6</title>
<polygon fill="lightgreen" stroke="black" points="1585,-16942.93 1369,-16942.93 1369,-16889.93 1585,-16889.93 1585,-16942.93"/>
<text text-anchor="middle" x="1477" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1477" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1477" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert5_act_6&#45;&gt;expert5_down_6 -->
<g id="edge315" class="edge">
<title>expert5_act_6&#45;&gt;expert5_down_6</title>
<path fill="none" stroke="black" d="M1475.59,-16979.5C1475.78,-16971.26 1475.99,-16962.01 1476.19,-16953.2"/>
<polygon fill="black" stroke="black" points="1479.69,-16953.24 1476.41,-16943.17 1472.69,-16953.09 1479.69,-16953.24"/>
</g>
<!-- expert5_agg_6 -->
<g id="node254" class="node">
<title>expert5_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="1478" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1478" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1478" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1478" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert5_down_6&#45;&gt;expert5_agg_6 -->
<g id="edge316" class="edge">
<title>expert5_down_6&#45;&gt;expert5_agg_6</title>
<path fill="none" stroke="black" d="M1477.26,-16889.68C1477.34,-16881.61 1477.43,-16872.43 1477.53,-16863.36"/>
<polygon fill="black" stroke="black" points="1481.03,-16863.28 1477.63,-16853.25 1474.03,-16863.21 1481.03,-16863.28"/>
</g>
<!-- expert5_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge317" class="edge">
<title>expert5_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1443.01,-16779.43C1425.6,-16763.15 1403.68,-16744.27 1382,-16729.97 1375.36,-16725.6 1368.41,-16721.34 1361.29,-16717.22"/>
<polygon fill="purple" stroke="purple" points="1362.62,-16713.95 1352.2,-16712.09 1359.18,-16720.05 1362.62,-16713.95"/>
<text text-anchor="middle" x="1492.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;12</text>
<text text-anchor="middle" x="1492.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_6 -->
<g id="node256" class="node">
<title>expert6_act_6</title>
<polygon fill="lightgreen" stroke="black" points="1794,-17032.93 1626,-17032.93 1626,-16979.93 1794,-16979.93 1794,-17032.93"/>
<text text-anchor="middle" x="1710" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1710" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1710" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert6_up_6&#45;&gt;expert6_act_6 -->
<g id="edge319" class="edge">
<title>expert6_up_6&#45;&gt;expert6_act_6</title>
<path fill="none" stroke="black" d="M1708.59,-17069.5C1708.78,-17061.26 1708.99,-17052.01 1709.19,-17043.2"/>
<polygon fill="black" stroke="black" points="1712.69,-17043.24 1709.41,-17033.17 1705.69,-17043.09 1712.69,-17043.24"/>
</g>
<!-- expert6_down_6 -->
<g id="node257" class="node">
<title>expert6_down_6</title>
<polygon fill="lightgreen" stroke="black" points="1824,-16942.93 1608,-16942.93 1608,-16889.93 1824,-16889.93 1824,-16942.93"/>
<text text-anchor="middle" x="1716" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1716" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1716" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert6_act_6&#45;&gt;expert6_down_6 -->
<g id="edge320" class="edge">
<title>expert6_act_6&#45;&gt;expert6_down_6</title>
<path fill="none" stroke="black" d="M1711.77,-16979.5C1712.33,-16971.26 1712.96,-16962.01 1713.56,-16953.2"/>
<polygon fill="black" stroke="black" points="1717.06,-16953.38 1714.24,-16943.17 1710.07,-16952.91 1717.06,-16953.38"/>
</g>
<!-- expert6_agg_6 -->
<g id="node258" class="node">
<title>expert6_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="1721" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1721" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1721" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1721" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert6_down_6&#45;&gt;expert6_agg_6 -->
<g id="edge321" class="edge">
<title>expert6_down_6&#45;&gt;expert6_agg_6</title>
<path fill="none" stroke="black" d="M1717.3,-16889.68C1717.71,-16881.61 1718.17,-16872.43 1718.63,-16863.36"/>
<polygon fill="black" stroke="black" points="1722.13,-16863.41 1719.14,-16853.25 1715.14,-16863.06 1722.13,-16863.41"/>
</g>
<!-- expert6_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge322" class="edge">
<title>expert6_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1670.78,-16781.73C1641.76,-16764.13 1603.98,-16743.34 1568,-16729.97 1511.58,-16709 1447.33,-16693.64 1390.41,-16682.74"/>
<polygon fill="purple" stroke="purple" points="1390.72,-16679.23 1380.24,-16680.82 1389.42,-16686.11 1390.72,-16679.23"/>
<text text-anchor="middle" x="1699.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;12</text>
<text text-anchor="middle" x="1699.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_6 -->
<g id="node260" class="node">
<title>expert7_act_6</title>
<polygon fill="lightgreen" stroke="black" points="2033,-17032.93 1865,-17032.93 1865,-16979.93 2033,-16979.93 2033,-17032.93"/>
<text text-anchor="middle" x="1949" y="-17017.73" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1949" y="-17002.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1949" y="-16987.73" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert7_up_6&#45;&gt;expert7_act_6 -->
<g id="edge324" class="edge">
<title>expert7_up_6&#45;&gt;expert7_act_6</title>
<path fill="none" stroke="black" d="M1945.47,-17069.5C1945.94,-17061.26 1946.47,-17052.01 1946.97,-17043.2"/>
<polygon fill="black" stroke="black" points="1950.46,-17043.35 1947.54,-17033.17 1943.48,-17042.95 1950.46,-17043.35"/>
</g>
<!-- expert7_down_6 -->
<g id="node261" class="node">
<title>expert7_down_6</title>
<polygon fill="lightgreen" stroke="black" points="2064,-16942.93 1848,-16942.93 1848,-16889.93 2064,-16889.93 2064,-16942.93"/>
<text text-anchor="middle" x="1956" y="-16927.73" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1956" y="-16912.73" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1956" y="-16897.73" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert7_act_6&#45;&gt;expert7_down_6 -->
<g id="edge325" class="edge">
<title>expert7_act_6&#45;&gt;expert7_down_6</title>
<path fill="none" stroke="black" d="M1951.06,-16979.5C1951.72,-16971.26 1952.45,-16962.01 1953.15,-16953.2"/>
<polygon fill="black" stroke="black" points="1956.65,-16953.41 1953.95,-16943.17 1949.67,-16952.86 1956.65,-16953.41"/>
</g>
<!-- expert7_agg_6 -->
<g id="node262" class="node">
<title>expert7_agg_6</title>
<ellipse fill="lightgray" stroke="black" cx="1964" cy="-16815.45" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1964" y="-16826.75" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1964" y="-16811.75" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1964" y="-16796.75" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert7_down_6&#45;&gt;expert7_agg_6 -->
<g id="edge326" class="edge">
<title>expert7_down_6&#45;&gt;expert7_agg_6</title>
<path fill="none" stroke="black" d="M1958.08,-16889.68C1958.73,-16881.61 1959.48,-16872.43 1960.21,-16863.36"/>
<polygon fill="black" stroke="black" points="1963.71,-16863.5 1961.03,-16853.25 1956.73,-16862.93 1963.71,-16863.5"/>
</g>
<!-- expert7_agg_6&#45;&gt;expert_agg_6 -->
<g id="edge327" class="edge">
<title>expert7_agg_6&#45;&gt;expert_agg_6</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1906.07,-16783.25C1869.49,-16764.9 1820.66,-16742.84 1775,-16729.97 1644.63,-16693.24 1491.04,-16675.7 1381.06,-16667.37"/>
<polygon fill="purple" stroke="purple" points="1381.12,-16663.87 1370.89,-16666.62 1380.6,-16670.85 1381.12,-16663.87"/>
<text text-anchor="middle" x="1925.5" y="-16748.77" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;12</text>
<text text-anchor="middle" x="1925.5" y="-16733.77" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_6&#45;&gt;residual2_6 -->
<g id="edge328" class="edge">
<title>expert_agg_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M1349.75,-16632.93C1464.1,-16607.97 1639.15,-16569.76 1756.73,-16544.1"/>
<polygon fill="black" stroke="black" points="1757.48,-16547.52 1766.51,-16541.96 1755.99,-16540.68 1757.48,-16547.52"/>
</g>
<!-- layer_out_6 -->
<g id="node265" class="node">
<title>layer_out_6</title>
<ellipse fill="lightgray" stroke="black" cx="1881" cy="-16388.5" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1881" y="-16399.8" font-family="Times,serif" font-size="14.00">Layer6_Output</text>
<text text-anchor="middle" x="1881" y="-16384.8" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1881" y="-16369.8" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual2_6&#45;&gt;layer_out_6 -->
<g id="edge330" class="edge">
<title>residual2_6&#45;&gt;layer_out_6</title>
<path fill="none" stroke="black" d="M1881,-16462.85C1881,-16453.94 1881,-16444.75 1881,-16436"/>
<polygon fill="black" stroke="black" points="1884.5,-16435.98 1881,-16425.98 1877.5,-16435.98 1884.5,-16435.98"/>
</g>
<!-- ln1_7 -->
<g id="node266" class="node">
<title>ln1_7</title>
<polygon fill="lightyellow" stroke="black" points="1802.5,-16264.02 1643.5,-16264.02 1643.5,-16211.02 1802.5,-16211.02 1802.5,-16264.02"/>
<text text-anchor="middle" x="1723" y="-16248.82" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1723" y="-16233.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1723" y="-16218.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- layer_out_6&#45;&gt;ln1_7 -->
<g id="edge331" class="edge">
<title>layer_out_6&#45;&gt;ln1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1844.35,-16352.94C1818.14,-16328.22 1783.08,-16295.17 1757.39,-16270.94"/>
<polygon fill="red" stroke="red" points="1759.75,-16268.36 1750.07,-16264.05 1754.95,-16273.45 1759.75,-16268.36"/>
<text text-anchor="middle" x="1891.5" y="-16321.82" font-family="Times,serif" font-size="14.00">GPU&#45;47→GPU&#45;6</text>
<text text-anchor="middle" x="1891.5" y="-16306.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_7 -->
<g id="node272" class="node">
<title>residual1_7</title>
<polygon fill="lightpink" stroke="black" points="2161.69,-15904.02 1899.71,-15904.02 1832.31,-15798.02 2094.29,-15798.02 2161.69,-15904.02"/>
<text text-anchor="middle" x="1997" y="-15862.32" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1997" y="-15847.32" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1997" y="-15832.32" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- layer_out_6&#45;&gt;residual1_7 -->
<g id="edge339" class="edge">
<title>layer_out_6&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1947.36,-16358.24C1992.1,-16333.52 2043,-16293.35 2043,-16238.52 2043,-16238.52 2043,-16238.52 2043,-15966.52 2043,-15948.7 2038.14,-15930.37 2031.59,-15913.75"/>
<polygon fill="black" stroke="black" points="2034.66,-15912.03 2027.55,-15904.18 2028.21,-15914.75 2034.66,-15912.03"/>
</g>
<!-- mha_q_7 -->
<g id="node267" class="node">
<title>mha_q_7</title>
<polygon fill="lightcoral" stroke="black" points="1540.5,-16174.02 1321.5,-16174.02 1321.5,-16121.02 1540.5,-16121.02 1540.5,-16174.02"/>
<text text-anchor="middle" x="1431" y="-16158.82" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1431" y="-16143.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1431" y="-16128.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_q_7 -->
<g id="edge332" class="edge">
<title>ln1_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M1643.21,-16212.47C1606.94,-16201.54 1563.75,-16188.53 1525.83,-16177.1"/>
<polygon fill="black" stroke="black" points="1526.39,-16173.61 1515.8,-16174.08 1524.37,-16180.31 1526.39,-16173.61"/>
</g>
<!-- mha_k_7 -->
<g id="node268" class="node">
<title>mha_k_7</title>
<polygon fill="lightcoral" stroke="black" points="1777.5,-16174.02 1558.5,-16174.02 1558.5,-16121.02 1777.5,-16121.02 1777.5,-16174.02"/>
<text text-anchor="middle" x="1668" y="-16158.82" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1668" y="-16143.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1668" y="-16128.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_k_7 -->
<g id="edge333" class="edge">
<title>ln1_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M1706.8,-16210.59C1701.37,-16201.91 1695.23,-16192.09 1689.47,-16182.87"/>
<polygon fill="black" stroke="black" points="1692.36,-16180.89 1684.09,-16174.26 1686.42,-16184.6 1692.36,-16180.89"/>
</g>
<!-- mha_v_7 -->
<g id="node269" class="node">
<title>mha_v_7</title>
<polygon fill="lightcoral" stroke="black" points="2014.5,-16174.02 1795.5,-16174.02 1795.5,-16121.02 2014.5,-16121.02 2014.5,-16174.02"/>
<text text-anchor="middle" x="1905" y="-16158.82" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1905" y="-16143.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1905" y="-16128.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_v_7 -->
<g id="edge334" class="edge">
<title>ln1_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M1776.13,-16210.83C1797.06,-16200.71 1821.25,-16189.01 1842.97,-16178.51"/>
<polygon fill="black" stroke="black" points="1844.64,-16181.59 1852.12,-16174.09 1841.59,-16175.29 1844.64,-16181.59"/>
</g>
<!-- mha_attn_7 -->
<g id="node270" class="node">
<title>mha_attn_7</title>
<polygon fill="lightcoral" stroke="black" points="1803.5,-16084.02 1632.5,-16084.02 1632.5,-16031.02 1803.5,-16031.02 1803.5,-16084.02"/>
<text text-anchor="middle" x="1718" y="-16068.82" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1718" y="-16053.82" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1718" y="-16038.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge335" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M1514.4,-16120.95C1548.89,-16110.37 1589.04,-16098.06 1624.52,-16087.18"/>
<polygon fill="black" stroke="black" points="1625.86,-16090.43 1634.39,-16084.15 1623.81,-16083.74 1625.86,-16090.43"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge336" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M1682.73,-16120.59C1687.61,-16112 1693.13,-16102.29 1698.32,-16093.15"/>
<polygon fill="black" stroke="black" points="1701.48,-16094.68 1703.37,-16084.26 1695.39,-16091.23 1701.48,-16094.68"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge337" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M1850.66,-16120.95C1829.05,-16110.78 1804.04,-16099.01 1781.59,-16088.44"/>
<polygon fill="black" stroke="black" points="1783.01,-16085.25 1772.47,-16084.15 1780.03,-16091.58 1783.01,-16085.25"/>
</g>
<!-- mha_out_7 -->
<g id="node271" class="node">
<title>mha_out_7</title>
<polygon fill="lightcoral" stroke="black" points="1948.5,-15994.02 1789.5,-15994.02 1789.5,-15941.02 1948.5,-15941.02 1948.5,-15994.02"/>
<text text-anchor="middle" x="1869" y="-15978.82" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1869" y="-15963.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1869" y="-15948.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge338" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M1762.08,-16030.83C1778.98,-16020.98 1798.44,-16009.64 1816.09,-15999.36"/>
<polygon fill="black" stroke="black" points="1818.25,-16002.15 1825.12,-15994.09 1814.72,-15996.1 1818.25,-16002.15"/>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge340" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M1897.73,-15940.82C1907.7,-15931.9 1919.34,-15921.49 1931.07,-15911"/>
<polygon fill="black" stroke="black" points="1933.65,-15913.38 1938.77,-15904.11 1928.98,-15908.17 1933.65,-15913.38"/>
</g>
<!-- ln2_7 -->
<g id="node273" class="node">
<title>ln2_7</title>
<polygon fill="lightyellow" stroke="black" points="1641.5,-15761.02 1482.5,-15761.02 1482.5,-15708.02 1641.5,-15708.02 1641.5,-15761.02"/>
<text text-anchor="middle" x="1562" y="-15745.82" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1562" y="-15730.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1562" y="-15715.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge341" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M1838.72,-15808.36C1775.72,-15791.77 1705.54,-15773.3 1651.62,-15759.11"/>
<polygon fill="black" stroke="black" points="1652.31,-15755.67 1641.75,-15756.51 1650.52,-15762.44 1652.31,-15755.67"/>
</g>
<!-- residual2_7 -->
<g id="node308" class="node">
<title>residual2_7</title>
<polygon fill="lightpink" stroke="black" points="1747.69,-14945.07 1485.71,-14945.07 1418.31,-14839.07 1680.29,-14839.07 1747.69,-14945.07"/>
<text text-anchor="middle" x="1583" y="-14903.37" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1583" y="-14888.37" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1583" y="-14873.37" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge384" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M2104.56,-15813.5C2135.47,-15795.81 2161,-15770.59 2161,-15735.52 2161,-15735.52 2161,-15735.52 2161,-15034.07 2161,-14945.26 1900.23,-14912.14 1729,-14899.97"/>
<polygon fill="black" stroke="black" points="1729.1,-14896.46 1718.88,-14899.26 1728.61,-14903.45 1729.1,-14896.46"/>
</g>
<!-- gate_7 -->
<g id="node274" class="node">
<title>gate_7</title>
<polygon fill="orange" stroke="black" points="1301,-15671.02 1121,-15618.02 1301,-15565.02 1481,-15618.02 1301,-15671.02"/>
<text text-anchor="middle" x="1301" y="-15629.32" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1301" y="-15614.32" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1301" y="-15599.32" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln2_7&#45;&gt;gate_7 -->
<g id="edge342" class="edge">
<title>ln2_7&#45;&gt;gate_7</title>
<path fill="none" stroke="black" d="M1503.75,-15707.97C1467.73,-15692.16 1420.98,-15671.65 1381.45,-15654.31"/>
<polygon fill="black" stroke="black" points="1382.65,-15651.02 1372.09,-15650.21 1379.84,-15657.43 1382.65,-15651.02"/>
</g>
<!-- expert0_up_7 -->
<g id="node275" class="node">
<title>expert0_up_7</title>
<polygon fill="lightgreen" stroke="black" points="457,-15499.02 241,-15499.02 241,-15446.02 457,-15446.02 457,-15499.02"/>
<text text-anchor="middle" x="349" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="349" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="349" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- gate_7&#45;&gt;expert0_up_7 -->
<g id="edge343" class="edge">
<title>gate_7&#45;&gt;expert0_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1153.12,-15608.49C1015.33,-15598.94 804.56,-15580.27 624,-15547.02 562.12,-15535.62 493.76,-15517.38 440.68,-15501.92"/>
<polygon fill="blue" stroke="blue" points="441.54,-15498.53 430.96,-15499.07 439.57,-15505.24 441.54,-15498.53"/>
<text text-anchor="middle" x="675.5" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="675.5" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;6</text>
</g>
<!-- expert1_up_7 -->
<g id="node279" class="node">
<title>expert1_up_7</title>
<polygon fill="lightgreen" stroke="black" points="700,-15499.02 484,-15499.02 484,-15446.02 700,-15446.02 700,-15499.02"/>
<text text-anchor="middle" x="592" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="592" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="592" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_7&#45;&gt;expert1_up_7 -->
<g id="edge348" class="edge">
<title>gate_7&#45;&gt;expert1_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1174,-15602.32C1081.38,-15590.47 953.15,-15571.72 842,-15547.02 787.05,-15534.81 726.46,-15517.11 678.69,-15502.13"/>
<polygon fill="blue" stroke="blue" points="679.59,-15498.75 669,-15499.08 677.49,-15505.42 679.59,-15498.75"/>
<text text-anchor="middle" x="893.5" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="893.5" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;7</text>
</g>
<!-- expert2_up_7 -->
<g id="node283" class="node">
<title>expert2_up_7</title>
<polygon fill="lightgreen" stroke="black" points="938,-15499.02 722,-15499.02 722,-15446.02 938,-15446.02 938,-15499.02"/>
<text text-anchor="middle" x="830" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="830" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="830" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_7&#45;&gt;expert2_up_7 -->
<g id="edge353" class="edge">
<title>gate_7&#45;&gt;expert2_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1203.77,-15593.59C1153.15,-15580.85 1090.41,-15564.21 1035,-15547.02 992.06,-15533.7 944.77,-15516.89 906.45,-15502.71"/>
<polygon fill="blue" stroke="blue" points="907.5,-15499.37 896.91,-15499.17 905.06,-15505.93 907.5,-15499.37"/>
<text text-anchor="middle" x="1086.5" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1086.5" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;8</text>
</g>
<!-- expert3_up_7 -->
<g id="node287" class="node">
<title>expert3_up_7</title>
<polygon fill="lightgreen" stroke="black" points="1174,-15499.02 958,-15499.02 958,-15446.02 1174,-15446.02 1174,-15499.02"/>
<text text-anchor="middle" x="1066" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="1066" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1066" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_7&#45;&gt;expert3_up_7 -->
<g id="edge358" class="edge">
<title>gate_7&#45;&gt;expert3_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1243.51,-15581.92C1204.64,-15558.18 1153.79,-15527.13 1116.48,-15504.35"/>
<polygon fill="blue" stroke="blue" points="1118.14,-15501.26 1107.79,-15499.04 1114.5,-15507.23 1118.14,-15501.26"/>
<text text-anchor="middle" x="1234.5" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1234.5" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;9</text>
</g>
<!-- expert4_up_7 -->
<g id="node291" class="node">
<title>expert4_up_7</title>
<polygon fill="lightgreen" stroke="black" points="1409,-15499.02 1193,-15499.02 1193,-15446.02 1409,-15446.02 1409,-15499.02"/>
<text text-anchor="middle" x="1301" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1301" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1301" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_7&#45;&gt;expert4_up_7 -->
<g id="edge363" class="edge">
<title>gate_7&#45;&gt;expert4_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1301,-15564.81C1301,-15546.53 1301,-15526.43 1301,-15509.75"/>
<polygon fill="blue" stroke="blue" points="1304.5,-15509.33 1301,-15499.33 1297.5,-15509.33 1304.5,-15509.33"/>
<text text-anchor="middle" x="1357" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1357" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;10</text>
</g>
<!-- expert5_up_7 -->
<g id="node295" class="node">
<title>expert5_up_7</title>
<polygon fill="lightgreen" stroke="black" points="1644,-15499.02 1428,-15499.02 1428,-15446.02 1644,-15446.02 1644,-15499.02"/>
<text text-anchor="middle" x="1536" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1536" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1536" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_7&#45;&gt;expert5_up_7 -->
<g id="edge368" class="edge">
<title>gate_7&#45;&gt;expert5_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1359.19,-15582.06C1377.7,-15570.91 1398.23,-15558.48 1417,-15547.02 1439.77,-15533.12 1464.91,-15517.61 1486.2,-15504.44"/>
<polygon fill="blue" stroke="blue" points="1488.1,-15507.38 1494.76,-15499.14 1484.42,-15501.43 1488.1,-15507.38"/>
<text text-anchor="middle" x="1518" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1518" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;11</text>
</g>
<!-- expert6_up_7 -->
<g id="node299" class="node">
<title>expert6_up_7</title>
<polygon fill="lightgreen" stroke="black" points="1879,-15499.02 1663,-15499.02 1663,-15446.02 1879,-15446.02 1879,-15499.02"/>
<text text-anchor="middle" x="1771" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1771" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1771" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_7&#45;&gt;expert6_up_7 -->
<g id="edge373" class="edge">
<title>gate_7&#45;&gt;expert6_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1401.8,-15594.53C1454.68,-15581.98 1520.29,-15565.23 1578,-15547.02 1618.96,-15534.09 1663.85,-15517.17 1700.02,-15502.82"/>
<polygon fill="blue" stroke="blue" points="1701.51,-15506 1709.5,-15499.04 1698.91,-15499.49 1701.51,-15506"/>
<text text-anchor="middle" x="1714" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1714" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;12</text>
</g>
<!-- expert7_up_7 -->
<g id="node303" class="node">
<title>expert7_up_7</title>
<polygon fill="lightgreen" stroke="black" points="2118,-15499.02 1902,-15499.02 1902,-15446.02 2118,-15446.02 2118,-15499.02"/>
<text text-anchor="middle" x="2010" y="-15483.82" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="2010" y="-15468.82" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="2010" y="-15453.82" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_7&#45;&gt;expert7_up_7 -->
<g id="edge378" class="edge">
<title>gate_7&#45;&gt;expert7_up_7</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1430.99,-15603.28C1526.58,-15591.86 1659.28,-15573.21 1774,-15547.02 1826.13,-15535.12 1883.43,-15517.39 1928.51,-15502.33"/>
<polygon fill="blue" stroke="blue" points="1929.87,-15505.56 1938.23,-15499.06 1927.63,-15498.93 1929.87,-15505.56"/>
<text text-anchor="middle" x="1934" y="-15535.82" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1934" y="-15520.82" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;13</text>
</g>
<!-- expert0_act_7 -->
<g id="node276" class="node">
<title>expert0_act_7</title>
<polygon fill="lightgreen" stroke="black" points="428,-15409.02 260,-15409.02 260,-15356.02 428,-15356.02 428,-15409.02"/>
<text text-anchor="middle" x="344" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="344" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="344" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert0_up_7&#45;&gt;expert0_act_7 -->
<g id="edge344" class="edge">
<title>expert0_up_7&#45;&gt;expert0_act_7</title>
<path fill="none" stroke="black" d="M347.53,-15445.59C347.06,-15437.36 346.53,-15428.1 346.03,-15419.3"/>
<polygon fill="black" stroke="black" points="349.52,-15419.05 345.46,-15409.26 342.54,-15419.44 349.52,-15419.05"/>
</g>
<!-- expert0_down_7 -->
<g id="node277" class="node">
<title>expert0_down_7</title>
<polygon fill="lightgreen" stroke="black" points="447,-15319.02 231,-15319.02 231,-15266.02 447,-15266.02 447,-15319.02"/>
<text text-anchor="middle" x="339" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="339" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="339" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert0_act_7&#45;&gt;expert0_down_7 -->
<g id="edge345" class="edge">
<title>expert0_act_7&#45;&gt;expert0_down_7</title>
<path fill="none" stroke="black" d="M342.53,-15355.59C342.06,-15347.36 341.53,-15338.1 341.03,-15329.3"/>
<polygon fill="black" stroke="black" points="344.52,-15329.05 340.46,-15319.26 337.54,-15329.44 344.52,-15329.05"/>
</g>
<!-- expert0_agg_7 -->
<g id="node278" class="node">
<title>expert0_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="329" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="329" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="329" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="329" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- expert0_down_7&#45;&gt;expert0_agg_7 -->
<g id="edge346" class="edge">
<title>expert0_down_7&#45;&gt;expert0_agg_7</title>
<path fill="none" stroke="black" d="M336.4,-15265.77C335.58,-15257.7 334.66,-15248.52 333.74,-15239.46"/>
<polygon fill="black" stroke="black" points="337.21,-15238.94 332.72,-15229.34 330.24,-15239.64 337.21,-15238.94"/>
</g>
<!-- expert_agg_7 -->
<g id="node307" class="node">
<title>expert_agg_7</title>
<polygon fill="gold" stroke="black" points="1465.69,-15088.07 1203.71,-15088.07 1136.31,-14982.07 1398.29,-14982.07 1465.69,-15088.07"/>
<text text-anchor="middle" x="1301" y="-15046.37" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1301" y="-15031.37" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1301" y="-15016.37" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert0_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge347" class="edge">
<title>expert0_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M389.1,-15159.85C428.66,-15141.09 482.16,-15118.4 532,-15106.07 746.88,-15052.9 1004.5,-15039.19 1160.32,-15036.17"/>
<polygon fill="purple" stroke="purple" points="1160.5,-15039.66 1170.44,-15035.98 1160.37,-15032.67 1160.5,-15039.66"/>
<text text-anchor="middle" x="603.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;13</text>
<text text-anchor="middle" x="603.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_7 -->
<g id="node280" class="node">
<title>expert1_act_7</title>
<polygon fill="lightgreen" stroke="black" points="670,-15409.02 502,-15409.02 502,-15356.02 670,-15356.02 670,-15409.02"/>
<text text-anchor="middle" x="586" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="586" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="586" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert1_up_7&#45;&gt;expert1_act_7 -->
<g id="edge349" class="edge">
<title>expert1_up_7&#45;&gt;expert1_act_7</title>
<path fill="none" stroke="black" d="M590.23,-15445.59C589.67,-15437.36 589.04,-15428.1 588.44,-15419.3"/>
<polygon fill="black" stroke="black" points="591.93,-15419 587.76,-15409.26 584.94,-15419.48 591.93,-15419"/>
</g>
<!-- expert1_down_7 -->
<g id="node281" class="node">
<title>expert1_down_7</title>
<polygon fill="lightgreen" stroke="black" points="690,-15319.02 474,-15319.02 474,-15266.02 690,-15266.02 690,-15319.02"/>
<text text-anchor="middle" x="582" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="582" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="582" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert1_act_7&#45;&gt;expert1_down_7 -->
<g id="edge350" class="edge">
<title>expert1_act_7&#45;&gt;expert1_down_7</title>
<path fill="none" stroke="black" d="M584.82,-15355.59C584.45,-15347.36 584.03,-15338.1 583.63,-15329.3"/>
<polygon fill="black" stroke="black" points="587.12,-15329.09 583.17,-15319.26 580.13,-15329.41 587.12,-15329.09"/>
</g>
<!-- expert1_agg_7 -->
<g id="node282" class="node">
<title>expert1_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="572" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="572" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="572" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="572" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert1_down_7&#45;&gt;expert1_agg_7 -->
<g id="edge351" class="edge">
<title>expert1_down_7&#45;&gt;expert1_agg_7</title>
<path fill="none" stroke="black" d="M579.4,-15265.77C578.58,-15257.7 577.66,-15248.52 576.74,-15239.46"/>
<polygon fill="black" stroke="black" points="580.21,-15238.94 575.72,-15229.34 573.24,-15239.64 580.21,-15238.94"/>
</g>
<!-- expert1_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge352" class="edge">
<title>expert1_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M629.69,-15159.11C665.82,-15140.79 713.93,-15118.85 759,-15106.07 893.65,-15067.87 1053.1,-15050.45 1164.05,-15042.55"/>
<polygon fill="purple" stroke="purple" points="1164.56,-15046.02 1174.29,-15041.84 1164.07,-15039.04 1164.56,-15046.02"/>
<text text-anchor="middle" x="830.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;13</text>
<text text-anchor="middle" x="830.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_7 -->
<g id="node284" class="node">
<title>expert2_act_7</title>
<polygon fill="lightgreen" stroke="black" points="912,-15409.02 744,-15409.02 744,-15356.02 912,-15356.02 912,-15409.02"/>
<text text-anchor="middle" x="828" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="828" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="828" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert2_up_7&#45;&gt;expert2_act_7 -->
<g id="edge354" class="edge">
<title>expert2_up_7&#45;&gt;expert2_act_7</title>
<path fill="none" stroke="black" d="M829.41,-15445.59C829.22,-15437.36 829.01,-15428.1 828.81,-15419.3"/>
<polygon fill="black" stroke="black" points="832.31,-15419.18 828.59,-15409.26 825.31,-15419.34 832.31,-15419.18"/>
</g>
<!-- expert2_down_7 -->
<g id="node285" class="node">
<title>expert2_down_7</title>
<polygon fill="lightgreen" stroke="black" points="928,-15319.02 712,-15319.02 712,-15266.02 928,-15266.02 928,-15319.02"/>
<text text-anchor="middle" x="820" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="820" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="820" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert2_act_7&#45;&gt;expert2_down_7 -->
<g id="edge355" class="edge">
<title>expert2_act_7&#45;&gt;expert2_down_7</title>
<path fill="none" stroke="black" d="M825.64,-15355.59C824.89,-15347.36 824.05,-15338.1 823.25,-15329.3"/>
<polygon fill="black" stroke="black" points="826.73,-15328.9 822.34,-15319.26 819.76,-15329.54 826.73,-15328.9"/>
</g>
<!-- expert2_agg_7 -->
<g id="node286" class="node">
<title>expert2_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="815" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="815" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="815" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="815" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert2_down_7&#45;&gt;expert2_agg_7 -->
<g id="edge356" class="edge">
<title>expert2_down_7&#45;&gt;expert2_agg_7</title>
<path fill="none" stroke="black" d="M818.7,-15265.77C818.29,-15257.7 817.83,-15248.52 817.37,-15239.46"/>
<polygon fill="black" stroke="black" points="820.86,-15239.15 816.86,-15229.34 813.87,-15239.5 820.86,-15239.15"/>
</g>
<!-- expert2_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge357" class="edge">
<title>expert2_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M864.87,-15157.81C893.68,-15140.19 931.22,-15119.41 967,-15106.07 1032.21,-15081.75 1107.9,-15065.01 1170.72,-15054.02"/>
<polygon fill="purple" stroke="purple" points="1171.42,-15057.45 1180.69,-15052.3 1170.24,-15050.55 1171.42,-15057.45"/>
<text text-anchor="middle" x="1038.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;13</text>
<text text-anchor="middle" x="1038.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_7 -->
<g id="node288" class="node">
<title>expert3_act_7</title>
<polygon fill="lightgreen" stroke="black" points="1145,-15409.02 977,-15409.02 977,-15356.02 1145,-15356.02 1145,-15409.02"/>
<text text-anchor="middle" x="1061" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="1061" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1061" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert3_up_7&#45;&gt;expert3_act_7 -->
<g id="edge359" class="edge">
<title>expert3_up_7&#45;&gt;expert3_act_7</title>
<path fill="none" stroke="black" d="M1064.53,-15445.59C1064.06,-15437.36 1063.53,-15428.1 1063.03,-15419.3"/>
<polygon fill="black" stroke="black" points="1066.52,-15419.05 1062.46,-15409.26 1059.54,-15419.44 1066.52,-15419.05"/>
</g>
<!-- expert3_down_7 -->
<g id="node289" class="node">
<title>expert3_down_7</title>
<polygon fill="lightgreen" stroke="black" points="1167,-15319.02 951,-15319.02 951,-15266.02 1167,-15266.02 1167,-15319.02"/>
<text text-anchor="middle" x="1059" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="1059" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1059" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert3_act_7&#45;&gt;expert3_down_7 -->
<g id="edge360" class="edge">
<title>expert3_act_7&#45;&gt;expert3_down_7</title>
<path fill="none" stroke="black" d="M1060.41,-15355.59C1060.22,-15347.36 1060.01,-15338.1 1059.81,-15329.3"/>
<polygon fill="black" stroke="black" points="1063.31,-15329.18 1059.59,-15319.26 1056.31,-15329.34 1063.31,-15329.18"/>
</g>
<!-- expert3_agg_7 -->
<g id="node290" class="node">
<title>expert3_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="1058" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1058" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="1058" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1058" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert3_down_7&#45;&gt;expert3_agg_7 -->
<g id="edge361" class="edge">
<title>expert3_down_7&#45;&gt;expert3_agg_7</title>
<path fill="none" stroke="black" d="M1058.74,-15265.77C1058.66,-15257.7 1058.57,-15248.52 1058.47,-15239.46"/>
<polygon fill="black" stroke="black" points="1061.97,-15239.3 1058.37,-15229.34 1054.97,-15239.37 1061.97,-15239.3"/>
</g>
<!-- expert3_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge362" class="edge">
<title>expert3_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1092.99,-15155.52C1110.4,-15139.24 1132.32,-15120.37 1154,-15106.07 1165.2,-15098.68 1177.31,-15091.62 1189.59,-15085.03"/>
<polygon fill="purple" stroke="purple" points="1191.34,-15088.07 1198.56,-15080.31 1188.08,-15081.87 1191.34,-15088.07"/>
<text text-anchor="middle" x="1225.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;13</text>
<text text-anchor="middle" x="1225.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_7 -->
<g id="node292" class="node">
<title>expert4_act_7</title>
<polygon fill="lightgreen" stroke="black" points="1385,-15409.02 1217,-15409.02 1217,-15356.02 1385,-15356.02 1385,-15409.02"/>
<text text-anchor="middle" x="1301" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1301" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1301" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert4_up_7&#45;&gt;expert4_act_7 -->
<g id="edge364" class="edge">
<title>expert4_up_7&#45;&gt;expert4_act_7</title>
<path fill="none" stroke="black" d="M1301,-15445.59C1301,-15437.36 1301,-15428.1 1301,-15419.3"/>
<polygon fill="black" stroke="black" points="1304.5,-15419.26 1301,-15409.26 1297.5,-15419.26 1304.5,-15419.26"/>
</g>
<!-- expert4_down_7 -->
<g id="node293" class="node">
<title>expert4_down_7</title>
<polygon fill="lightgreen" stroke="black" points="1409,-15319.02 1193,-15319.02 1193,-15266.02 1409,-15266.02 1409,-15319.02"/>
<text text-anchor="middle" x="1301" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1301" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1301" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert4_act_7&#45;&gt;expert4_down_7 -->
<g id="edge365" class="edge">
<title>expert4_act_7&#45;&gt;expert4_down_7</title>
<path fill="none" stroke="black" d="M1301,-15355.59C1301,-15347.36 1301,-15338.1 1301,-15329.3"/>
<polygon fill="black" stroke="black" points="1304.5,-15329.26 1301,-15319.26 1297.5,-15329.26 1304.5,-15329.26"/>
</g>
<!-- expert4_agg_7 -->
<g id="node294" class="node">
<title>expert4_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="1301" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1301" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1301" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1301" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert4_down_7&#45;&gt;expert4_agg_7 -->
<g id="edge366" class="edge">
<title>expert4_down_7&#45;&gt;expert4_agg_7</title>
<path fill="none" stroke="black" d="M1301,-15265.77C1301,-15257.7 1301,-15248.52 1301,-15239.46"/>
<polygon fill="black" stroke="black" points="1304.5,-15239.34 1301,-15229.34 1297.5,-15239.34 1304.5,-15239.34"/>
</g>
<!-- expert4_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge367" class="edge">
<title>expert4_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1301,-15153.93C1301,-15137.3 1301,-15117.14 1301,-15098.24"/>
<polygon fill="purple" stroke="purple" points="1304.5,-15098.2 1301,-15088.2 1297.5,-15098.2 1304.5,-15098.2"/>
<text text-anchor="middle" x="1372.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;13</text>
<text text-anchor="middle" x="1372.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_7 -->
<g id="node296" class="node">
<title>expert5_act_7</title>
<polygon fill="lightgreen" stroke="black" points="1621,-15409.02 1453,-15409.02 1453,-15356.02 1621,-15356.02 1621,-15409.02"/>
<text text-anchor="middle" x="1537" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1537" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1537" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert5_up_7&#45;&gt;expert5_act_7 -->
<g id="edge369" class="edge">
<title>expert5_up_7&#45;&gt;expert5_act_7</title>
<path fill="none" stroke="black" d="M1536.29,-15445.59C1536.39,-15437.36 1536.49,-15428.1 1536.59,-15419.3"/>
<polygon fill="black" stroke="black" points="1540.09,-15419.3 1536.71,-15409.26 1533.09,-15419.22 1540.09,-15419.3"/>
</g>
<!-- expert5_down_7 -->
<g id="node297" class="node">
<title>expert5_down_7</title>
<polygon fill="lightgreen" stroke="black" points="1647,-15319.02 1431,-15319.02 1431,-15266.02 1647,-15266.02 1647,-15319.02"/>
<text text-anchor="middle" x="1539" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1539" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1539" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert5_act_7&#45;&gt;expert5_down_7 -->
<g id="edge370" class="edge">
<title>expert5_act_7&#45;&gt;expert5_down_7</title>
<path fill="none" stroke="black" d="M1537.59,-15355.59C1537.78,-15347.36 1537.99,-15338.1 1538.19,-15329.3"/>
<polygon fill="black" stroke="black" points="1541.69,-15329.34 1538.41,-15319.26 1534.69,-15329.18 1541.69,-15329.34"/>
</g>
<!-- expert5_agg_7 -->
<g id="node298" class="node">
<title>expert5_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="1544" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1544" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1544" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1544" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert5_down_7&#45;&gt;expert5_agg_7 -->
<g id="edge371" class="edge">
<title>expert5_down_7&#45;&gt;expert5_agg_7</title>
<path fill="none" stroke="black" d="M1540.3,-15265.77C1540.71,-15257.7 1541.17,-15248.52 1541.63,-15239.46"/>
<polygon fill="black" stroke="black" points="1545.13,-15239.5 1542.14,-15229.34 1538.14,-15239.15 1545.13,-15239.5"/>
</g>
<!-- expert5_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge372" class="edge">
<title>expert5_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1509.01,-15155.52C1491.6,-15139.24 1469.68,-15120.37 1448,-15106.07 1441.36,-15101.69 1434.41,-15097.43 1427.29,-15093.31"/>
<polygon fill="purple" stroke="purple" points="1428.62,-15090.05 1418.2,-15088.18 1425.18,-15096.14 1428.62,-15090.05"/>
<text text-anchor="middle" x="1558.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;13</text>
<text text-anchor="middle" x="1558.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_7 -->
<g id="node300" class="node">
<title>expert6_act_7</title>
<polygon fill="lightgreen" stroke="black" points="1860,-15409.02 1692,-15409.02 1692,-15356.02 1860,-15356.02 1860,-15409.02"/>
<text text-anchor="middle" x="1776" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1776" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1776" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert6_up_7&#45;&gt;expert6_act_7 -->
<g id="edge374" class="edge">
<title>expert6_up_7&#45;&gt;expert6_act_7</title>
<path fill="none" stroke="black" d="M1772.47,-15445.59C1772.94,-15437.36 1773.47,-15428.1 1773.97,-15419.3"/>
<polygon fill="black" stroke="black" points="1777.46,-15419.44 1774.54,-15409.26 1770.48,-15419.05 1777.46,-15419.44"/>
</g>
<!-- expert6_down_7 -->
<g id="node301" class="node">
<title>expert6_down_7</title>
<polygon fill="lightgreen" stroke="black" points="1887,-15319.02 1671,-15319.02 1671,-15266.02 1887,-15266.02 1887,-15319.02"/>
<text text-anchor="middle" x="1779" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1779" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1779" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert6_act_7&#45;&gt;expert6_down_7 -->
<g id="edge375" class="edge">
<title>expert6_act_7&#45;&gt;expert6_down_7</title>
<path fill="none" stroke="black" d="M1776.88,-15355.59C1777.16,-15347.36 1777.48,-15338.1 1777.78,-15329.3"/>
<polygon fill="black" stroke="black" points="1781.28,-15329.37 1778.12,-15319.26 1774.28,-15329.14 1781.28,-15329.37"/>
</g>
<!-- expert6_agg_7 -->
<g id="node302" class="node">
<title>expert6_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="1787" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1787" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1787" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1787" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert6_down_7&#45;&gt;expert6_agg_7 -->
<g id="edge376" class="edge">
<title>expert6_down_7&#45;&gt;expert6_agg_7</title>
<path fill="none" stroke="black" d="M1781.08,-15265.77C1781.73,-15257.7 1782.48,-15248.52 1783.21,-15239.46"/>
<polygon fill="black" stroke="black" points="1786.71,-15239.59 1784.03,-15229.34 1779.73,-15239.03 1786.71,-15239.59"/>
</g>
<!-- expert6_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge377" class="edge">
<title>expert6_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1736.78,-15157.83C1707.76,-15140.22 1669.98,-15119.44 1634,-15106.07 1577.58,-15085.1 1513.33,-15069.73 1456.41,-15058.83"/>
<polygon fill="purple" stroke="purple" points="1456.72,-15055.33 1446.24,-15056.92 1455.42,-15062.21 1456.72,-15055.33"/>
<text text-anchor="middle" x="1765.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;13</text>
<text text-anchor="middle" x="1765.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_7 -->
<g id="node304" class="node">
<title>expert7_act_7</title>
<polygon fill="lightgreen" stroke="black" points="2099,-15409.02 1931,-15409.02 1931,-15356.02 2099,-15356.02 2099,-15409.02"/>
<text text-anchor="middle" x="2015" y="-15393.82" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="2015" y="-15378.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="2015" y="-15363.82" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert7_up_7&#45;&gt;expert7_act_7 -->
<g id="edge379" class="edge">
<title>expert7_up_7&#45;&gt;expert7_act_7</title>
<path fill="none" stroke="black" d="M2011.47,-15445.59C2011.94,-15437.36 2012.47,-15428.1 2012.97,-15419.3"/>
<polygon fill="black" stroke="black" points="2016.46,-15419.44 2013.54,-15409.26 2009.48,-15419.05 2016.46,-15419.44"/>
</g>
<!-- expert7_down_7 -->
<g id="node305" class="node">
<title>expert7_down_7</title>
<polygon fill="lightgreen" stroke="black" points="2129,-15319.02 1913,-15319.02 1913,-15266.02 2129,-15266.02 2129,-15319.02"/>
<text text-anchor="middle" x="2021" y="-15303.82" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="2021" y="-15288.82" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="2021" y="-15273.82" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert7_act_7&#45;&gt;expert7_down_7 -->
<g id="edge380" class="edge">
<title>expert7_act_7&#45;&gt;expert7_down_7</title>
<path fill="none" stroke="black" d="M2016.77,-15355.59C2017.33,-15347.36 2017.96,-15338.1 2018.56,-15329.3"/>
<polygon fill="black" stroke="black" points="2022.06,-15329.48 2019.24,-15319.26 2015.07,-15329 2022.06,-15329.48"/>
</g>
<!-- expert7_agg_7 -->
<g id="node306" class="node">
<title>expert7_agg_7</title>
<ellipse fill="lightgray" stroke="black" cx="2030" cy="-15191.54" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="2030" y="-15202.84" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="2030" y="-15187.84" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="2030" y="-15172.84" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert7_down_7&#45;&gt;expert7_agg_7 -->
<g id="edge381" class="edge">
<title>expert7_down_7&#45;&gt;expert7_agg_7</title>
<path fill="none" stroke="black" d="M2023.34,-15265.77C2024.08,-15257.7 2024.91,-15248.52 2025.73,-15239.46"/>
<polygon fill="black" stroke="black" points="2029.23,-15239.62 2026.65,-15229.34 2022.26,-15238.98 2029.23,-15239.62"/>
</g>
<!-- expert7_agg_7&#45;&gt;expert_agg_7 -->
<g id="edge382" class="edge">
<title>expert7_agg_7&#45;&gt;expert_agg_7</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1972.07,-15159.34C1935.49,-15140.99 1886.66,-15118.93 1841,-15106.07 1710.63,-15069.34 1557.04,-15051.79 1447.06,-15043.47"/>
<polygon fill="purple" stroke="purple" points="1447.12,-15039.96 1436.89,-15042.71 1446.6,-15046.94 1447.12,-15039.96"/>
<text text-anchor="middle" x="1991.5" y="-15124.87" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;13</text>
<text text-anchor="middle" x="1991.5" y="-15109.87" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_7&#45;&gt;residual2_7 -->
<g id="edge383" class="edge">
<title>expert_agg_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M1400.03,-14984.55C1424.2,-14972.47 1450.18,-14959.48 1474.75,-14947.19"/>
<polygon fill="black" stroke="black" points="1476.36,-14950.3 1483.74,-14942.7 1473.23,-14944.04 1476.36,-14950.3"/>
</g>
<!-- layer_out_7 -->
<g id="node309" class="node">
<title>layer_out_7</title>
<ellipse fill="lightgray" stroke="black" cx="1583" cy="-14764.59" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1583" y="-14775.89" font-family="Times,serif" font-size="14.00">Layer7_Output</text>
<text text-anchor="middle" x="1583" y="-14760.89" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1583" y="-14745.89" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual2_7&#45;&gt;layer_out_7 -->
<g id="edge385" class="edge">
<title>residual2_7&#45;&gt;layer_out_7</title>
<path fill="none" stroke="black" d="M1583,-14838.94C1583,-14830.04 1583,-14820.84 1583,-14812.09"/>
<polygon fill="black" stroke="black" points="1586.5,-14812.08 1583,-14802.08 1579.5,-14812.08 1586.5,-14812.08"/>
</g>
<!-- ln1_8 -->
<g id="node310" class="node">
<title>ln1_8</title>
<polygon fill="lightyellow" stroke="black" points="1481.5,-14640.11 1322.5,-14640.11 1322.5,-14587.11 1481.5,-14587.11 1481.5,-14640.11"/>
<text text-anchor="middle" x="1402" y="-14624.91" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1402" y="-14609.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1402" y="-14594.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- layer_out_7&#45;&gt;ln1_8 -->
<g id="edge386" class="edge">
<title>layer_out_7&#45;&gt;ln1_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1541.47,-14729.41C1511.33,-14704.6 1470.81,-14671.25 1441.21,-14646.89"/>
<polygon fill="red" stroke="red" points="1443.12,-14643.92 1433.17,-14640.27 1438.67,-14649.33 1443.12,-14643.92"/>
<text text-anchor="middle" x="1585.5" y="-14697.91" font-family="Times,serif" font-size="14.00">GPU&#45;55→GPU&#45;7</text>
<text text-anchor="middle" x="1585.5" y="-14682.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_8 -->
<g id="node316" class="node">
<title>residual1_8</title>
<polygon fill="lightpink" stroke="black" points="1883.69,-14280.11 1621.71,-14280.11 1554.31,-14174.11 1816.29,-14174.11 1883.69,-14280.11"/>
<text text-anchor="middle" x="1719" y="-14238.41" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1719" y="-14223.41" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1719" y="-14208.41" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- layer_out_7&#45;&gt;residual1_8 -->
<g id="edge394" class="edge">
<title>layer_out_7&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1653.13,-14734.94C1699.96,-14710.64 1753,-14670.73 1753,-14614.61 1753,-14614.61 1753,-14614.61 1753,-14342.61 1753,-14325.11 1749.3,-14306.69 1744.34,-14289.87"/>
<polygon fill="black" stroke="black" points="1747.63,-14288.67 1741.3,-14280.18 1740.96,-14290.76 1747.63,-14288.67"/>
</g>
<!-- mha_q_8 -->
<g id="node311" class="node">
<title>mha_q_8</title>
<polygon fill="lightcoral" stroke="black" points="1250.5,-14550.11 1031.5,-14550.11 1031.5,-14497.11 1250.5,-14497.11 1250.5,-14550.11"/>
<text text-anchor="middle" x="1141" y="-14534.91" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1141" y="-14519.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1141" y="-14504.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_q_8 -->
<g id="edge387" class="edge">
<title>ln1_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M1326.16,-14587.04C1295.06,-14576.56 1258.9,-14564.37 1226.84,-14553.56"/>
<polygon fill="black" stroke="black" points="1227.63,-14550.13 1217.03,-14550.25 1225.39,-14556.76 1227.63,-14550.13"/>
</g>
<!-- mha_k_8 -->
<g id="node312" class="node">
<title>mha_k_8</title>
<polygon fill="lightcoral" stroke="black" points="1487.5,-14550.11 1268.5,-14550.11 1268.5,-14497.11 1487.5,-14497.11 1487.5,-14550.11"/>
<text text-anchor="middle" x="1378" y="-14534.91" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1378" y="-14519.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1378" y="-14504.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_k_8 -->
<g id="edge388" class="edge">
<title>ln1_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M1394.93,-14586.69C1392.66,-14578.36 1390.1,-14568.99 1387.68,-14560.1"/>
<polygon fill="black" stroke="black" points="1391.03,-14559.08 1385.02,-14550.35 1384.28,-14560.92 1391.03,-14559.08"/>
</g>
<!-- mha_v_8 -->
<g id="node313" class="node">
<title>mha_v_8</title>
<polygon fill="lightcoral" stroke="black" points="1724.5,-14550.11 1505.5,-14550.11 1505.5,-14497.11 1724.5,-14497.11 1724.5,-14550.11"/>
<text text-anchor="middle" x="1615" y="-14534.91" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1615" y="-14519.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1615" y="-14504.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_v_8 -->
<g id="edge389" class="edge">
<title>ln1_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M1463.89,-14587.04C1488.84,-14576.74 1517.76,-14564.79 1543.59,-14554.12"/>
<polygon fill="black" stroke="black" points="1545.05,-14557.3 1552.95,-14550.25 1542.37,-14550.83 1545.05,-14557.3"/>
</g>
<!-- mha_attn_8 -->
<g id="node314" class="node">
<title>mha_attn_8</title>
<polygon fill="lightcoral" stroke="black" points="1524.5,-14460.11 1353.5,-14460.11 1353.5,-14407.11 1524.5,-14407.11 1524.5,-14460.11"/>
<text text-anchor="middle" x="1439" y="-14444.91" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1439" y="-14429.91" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1439" y="-14414.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge390" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M1227.59,-14497.04C1263.96,-14486.3 1306.37,-14473.78 1343.62,-14462.78"/>
<polygon fill="black" stroke="black" points="1344.88,-14466.06 1353.48,-14459.87 1342.9,-14459.34 1344.88,-14466.06"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge391" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M1395.97,-14496.69C1402.05,-14487.91 1408.94,-14477.98 1415.39,-14468.67"/>
<polygon fill="black" stroke="black" points="1418.34,-14470.57 1421.16,-14460.35 1412.58,-14466.58 1418.34,-14470.57"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge392" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M1563.62,-14496.92C1543.47,-14486.85 1520.2,-14475.21 1499.26,-14464.74"/>
<polygon fill="black" stroke="black" points="1500.65,-14461.52 1490.14,-14460.18 1497.52,-14467.79 1500.65,-14461.52"/>
</g>
<!-- mha_out_8 -->
<g id="node315" class="node">
<title>mha_out_8</title>
<polygon fill="lightcoral" stroke="black" points="1710.5,-14370.11 1551.5,-14370.11 1551.5,-14317.11 1710.5,-14317.11 1710.5,-14370.11"/>
<text text-anchor="middle" x="1631" y="-14354.91" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1631" y="-14339.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1631" y="-14324.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge393" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M1494.79,-14407.04C1516.98,-14396.87 1542.66,-14385.1 1565.71,-14374.54"/>
<polygon fill="black" stroke="black" points="1567.44,-14377.6 1575.07,-14370.25 1564.52,-14371.23 1567.44,-14377.6"/>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge395" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1650.75,-14316.92C1657.31,-14308.38 1664.91,-14298.49 1672.61,-14288.47"/>
<polygon fill="black" stroke="black" points="1675.47,-14290.5 1678.79,-14280.43 1669.92,-14286.23 1675.47,-14290.5"/>
</g>
<!-- ln2_8 -->
<g id="node317" class="node">
<title>ln2_8</title>
<polygon fill="lightyellow" stroke="black" points="1510.5,-14137.11 1351.5,-14137.11 1351.5,-14084.11 1510.5,-14084.11 1510.5,-14137.11"/>
<text text-anchor="middle" x="1431" y="-14121.91" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1431" y="-14106.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1431" y="-14091.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge396" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1588.06,-14174.06C1559.47,-14162.69 1530.19,-14151.05 1504.77,-14140.94"/>
<polygon fill="black" stroke="black" points="1505.81,-14137.59 1495.22,-14137.15 1503.22,-14144.09 1505.81,-14137.59"/>
</g>
<!-- residual2_8 -->
<g id="node352" class="node">
<title>residual2_8</title>
<polygon fill="lightpink" stroke="black" points="1726.69,-13321.16 1464.71,-13321.16 1397.31,-13215.16 1659.29,-13215.16 1726.69,-13321.16"/>
<text text-anchor="middle" x="1562" y="-13279.46" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1562" y="-13264.46" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1562" y="-13249.46" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge439" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1834.8,-14202.94C1916.7,-14183.12 2012,-14151.48 2012,-14111.61 2012,-14111.61 2012,-14111.61 2012,-13410.16 2012,-13346.38 1845.29,-13308 1714.81,-13287.74"/>
<polygon fill="black" stroke="black" points="1715.11,-13284.24 1704.69,-13286.19 1714.05,-13291.16 1715.11,-13284.24"/>
</g>
<!-- gate_8 -->
<g id="node318" class="node">
<title>gate_8</title>
<polygon fill="orange" stroke="black" points="1152,-14047.11 972,-13994.11 1152,-13941.11 1332,-13994.11 1152,-14047.11"/>
<text text-anchor="middle" x="1152" y="-14005.41" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1152" y="-13990.41" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1152" y="-13975.41" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln2_8&#45;&gt;gate_8 -->
<g id="edge397" class="edge">
<title>ln2_8&#45;&gt;gate_8</title>
<path fill="none" stroke="black" d="M1368.73,-14084.06C1329.38,-14067.91 1278.06,-14046.85 1235.24,-14029.27"/>
<polygon fill="black" stroke="black" points="1236.53,-14026.02 1225.95,-14025.46 1233.88,-14032.5 1236.53,-14026.02"/>
</g>
<!-- expert0_up_8 -->
<g id="node319" class="node">
<title>expert0_up_8</title>
<polygon fill="lightgreen" stroke="black" points="324,-13875.11 108,-13875.11 108,-13822.11 324,-13822.11 324,-13875.11"/>
<text text-anchor="middle" x="216" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="216" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="216" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- gate_8&#45;&gt;expert0_up_8 -->
<g id="edge398" class="edge">
<title>gate_8&#45;&gt;expert0_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1003.02,-13984.93C865.74,-13975.68 656.83,-13957.23 478,-13923.11 418.93,-13911.84 353.82,-13893.61 303.29,-13878.12"/>
<polygon fill="blue" stroke="blue" points="304.29,-13874.77 293.7,-13875.16 302.23,-13881.46 304.29,-13874.77"/>
<text text-anchor="middle" x="529.5" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="529.5" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;7</text>
</g>
<!-- expert1_up_8 -->
<g id="node323" class="node">
<title>expert1_up_8</title>
<polygon fill="lightgreen" stroke="black" points="558,-13875.11 342,-13875.11 342,-13822.11 558,-13822.11 558,-13875.11"/>
<text text-anchor="middle" x="450" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="450" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="450" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_8&#45;&gt;expert1_up_8 -->
<g id="edge403" class="edge">
<title>gate_8&#45;&gt;expert1_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1024.45,-13978.61C931.84,-13966.88 803.86,-13948.2 693,-13923.11 639.52,-13911.01 580.64,-13893.32 534.23,-13878.32"/>
<polygon fill="blue" stroke="blue" points="535.11,-13874.93 524.52,-13875.16 532.95,-13881.58 535.11,-13874.93"/>
<text text-anchor="middle" x="744.5" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="744.5" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;8</text>
</g>
<!-- expert2_up_8 -->
<g id="node327" class="node">
<title>expert2_up_8</title>
<polygon fill="lightgreen" stroke="black" points="792,-13875.11 576,-13875.11 576,-13822.11 792,-13822.11 792,-13875.11"/>
<text text-anchor="middle" x="684" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="684" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="684" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_8&#45;&gt;expert2_up_8 -->
<g id="edge408" class="edge">
<title>gate_8&#45;&gt;expert2_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1053.59,-13969.99C1002.37,-13957.33 938.94,-13940.67 883,-13923.11 841.23,-13910 795.34,-13893.22 758.17,-13879"/>
<polygon fill="blue" stroke="blue" points="759.01,-13875.57 748.42,-13875.25 756.5,-13882.11 759.01,-13875.57"/>
<text text-anchor="middle" x="934.5" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="934.5" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;9</text>
</g>
<!-- expert3_up_8 -->
<g id="node331" class="node">
<title>expert3_up_8</title>
<polygon fill="lightgreen" stroke="black" points="1026,-13875.11 810,-13875.11 810,-13822.11 1026,-13822.11 1026,-13875.11"/>
<text text-anchor="middle" x="918" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="918" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="918" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_8&#45;&gt;expert3_up_8 -->
<g id="edge413" class="edge">
<title>gate_8&#45;&gt;expert3_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1093.78,-13958.2C1075.28,-13947.04 1054.75,-13934.61 1036,-13923.11 1013.39,-13909.25 988.46,-13893.75 967.36,-13880.57"/>
<polygon fill="blue" stroke="blue" points="969.2,-13877.6 958.87,-13875.27 965.49,-13883.54 969.2,-13877.6"/>
<text text-anchor="middle" x="1092" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1092" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;10</text>
</g>
<!-- expert4_up_8 -->
<g id="node335" class="node">
<title>expert4_up_8</title>
<polygon fill="lightgreen" stroke="black" points="1260,-13875.11 1044,-13875.11 1044,-13822.11 1260,-13822.11 1260,-13875.11"/>
<text text-anchor="middle" x="1152" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1152" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1152" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_8&#45;&gt;expert4_up_8 -->
<g id="edge418" class="edge">
<title>gate_8&#45;&gt;expert4_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1152,-13940.9C1152,-13922.63 1152,-13902.52 1152,-13885.84"/>
<polygon fill="blue" stroke="blue" points="1155.5,-13885.43 1152,-13875.43 1148.5,-13885.43 1155.5,-13885.43"/>
<text text-anchor="middle" x="1208" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1208" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;11</text>
</g>
<!-- expert5_up_8 -->
<g id="node339" class="node">
<title>expert5_up_8</title>
<polygon fill="lightgreen" stroke="black" points="1498,-13875.11 1282,-13875.11 1282,-13822.11 1498,-13822.11 1498,-13875.11"/>
<text text-anchor="middle" x="1390" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1390" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1390" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_8&#45;&gt;expert5_up_8 -->
<g id="edge423" class="edge">
<title>gate_8&#45;&gt;expert5_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1210.22,-13958.01C1249.59,-13934.27 1301.09,-13903.22 1338.87,-13880.44"/>
<polygon fill="blue" stroke="blue" points="1340.92,-13883.29 1347.68,-13875.13 1337.31,-13877.3 1340.92,-13883.29"/>
<text text-anchor="middle" x="1369" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1369" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;12</text>
</g>
<!-- expert6_up_8 -->
<g id="node343" class="node">
<title>expert6_up_8</title>
<polygon fill="lightgreen" stroke="black" points="1734,-13875.11 1518,-13875.11 1518,-13822.11 1734,-13822.11 1734,-13875.11"/>
<text text-anchor="middle" x="1626" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1626" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1626" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_8&#45;&gt;expert6_up_8 -->
<g id="edge428" class="edge">
<title>gate_8&#45;&gt;expert6_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1252.42,-13970.54C1305.34,-13957.94 1371.11,-13941.17 1429,-13923.11 1470.59,-13910.14 1516.21,-13893.29 1553.07,-13879"/>
<polygon fill="blue" stroke="blue" points="1554.69,-13882.13 1562.73,-13875.23 1552.14,-13875.6 1554.69,-13882.13"/>
<text text-anchor="middle" x="1566" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1566" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;13</text>
</g>
<!-- expert7_up_8 -->
<g id="node347" class="node">
<title>expert7_up_8</title>
<polygon fill="lightgreen" stroke="black" points="1969,-13875.11 1753,-13875.11 1753,-13822.11 1969,-13822.11 1969,-13875.11"/>
<text text-anchor="middle" x="1861" y="-13859.91" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1861" y="-13844.91" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1861" y="-13829.91" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_8&#45;&gt;expert7_up_8 -->
<g id="edge433" class="edge">
<title>gate_8&#45;&gt;expert7_up_8</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1282.28,-13979.44C1378.08,-13968.04 1511.06,-13949.41 1626,-13923.11 1677.93,-13911.24 1734.98,-13893.51 1779.87,-13878.44"/>
<polygon fill="blue" stroke="blue" points="1781.19,-13881.68 1789.54,-13875.17 1778.95,-13875.05 1781.19,-13881.68"/>
<text text-anchor="middle" x="1786" y="-13911.91" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1786" y="-13896.91" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;14</text>
</g>
<!-- expert0_act_8 -->
<g id="node320" class="node">
<title>expert0_act_8</title>
<polygon fill="lightgreen" stroke="black" points="285,-13785.11 117,-13785.11 117,-13732.11 285,-13732.11 285,-13785.11"/>
<text text-anchor="middle" x="201" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="201" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="201" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert0_up_8&#45;&gt;expert0_act_8 -->
<g id="edge399" class="edge">
<title>expert0_up_8&#45;&gt;expert0_act_8</title>
<path fill="none" stroke="black" d="M211.58,-13821.69C210.18,-13813.45 208.6,-13804.19 207.1,-13795.39"/>
<polygon fill="black" stroke="black" points="210.52,-13794.62 205.39,-13785.35 203.62,-13795.8 210.52,-13794.62"/>
</g>
<!-- expert0_down_8 -->
<g id="node321" class="node">
<title>expert0_down_8</title>
<polygon fill="lightgreen" stroke="black" points="292,-13695.11 76,-13695.11 76,-13642.11 292,-13642.11 292,-13695.11"/>
<text text-anchor="middle" x="184" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="184" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="184" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert0_act_8&#45;&gt;expert0_down_8 -->
<g id="edge400" class="edge">
<title>expert0_act_8&#45;&gt;expert0_down_8</title>
<path fill="none" stroke="black" d="M195.99,-13731.69C194.4,-13723.45 192.61,-13714.19 190.91,-13705.39"/>
<polygon fill="black" stroke="black" points="194.31,-13704.51 188.97,-13695.35 187.43,-13705.84 194.31,-13704.51"/>
</g>
<!-- expert0_agg_8 -->
<g id="node322" class="node">
<title>expert0_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="180" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="180" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="180" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="180" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- expert0_down_8&#45;&gt;expert0_agg_8 -->
<g id="edge401" class="edge">
<title>expert0_down_8&#45;&gt;expert0_agg_8</title>
<path fill="none" stroke="black" d="M182.96,-13641.87C182.63,-13633.79 182.26,-13624.61 181.9,-13615.55"/>
<polygon fill="black" stroke="black" points="185.39,-13615.28 181.49,-13605.43 178.39,-13615.57 185.39,-13615.28"/>
</g>
<!-- expert_agg_8 -->
<g id="node351" class="node">
<title>expert_agg_8</title>
<polygon fill="gold" stroke="black" points="1316.69,-13464.16 1054.71,-13464.16 987.31,-13358.16 1249.29,-13358.16 1316.69,-13464.16"/>
<text text-anchor="middle" x="1152" y="-13422.46" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1152" y="-13407.46" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-13392.46" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert0_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge402" class="edge">
<title>expert0_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M240.1,-13535.95C279.66,-13517.18 333.16,-13494.49 383,-13482.16 597.88,-13428.99 855.5,-13415.29 1011.32,-13412.26"/>
<polygon fill="purple" stroke="purple" points="1011.5,-13415.76 1021.44,-13412.08 1011.37,-13408.76 1011.5,-13415.76"/>
<text text-anchor="middle" x="454.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;14</text>
<text text-anchor="middle" x="454.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_8 -->
<g id="node324" class="node">
<title>expert1_act_8</title>
<polygon fill="lightgreen" stroke="black" points="528,-13785.11 360,-13785.11 360,-13732.11 528,-13732.11 528,-13785.11"/>
<text text-anchor="middle" x="444" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="444" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="444" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert1_up_8&#45;&gt;expert1_act_8 -->
<g id="edge404" class="edge">
<title>expert1_up_8&#45;&gt;expert1_act_8</title>
<path fill="none" stroke="black" d="M448.23,-13821.69C447.67,-13813.45 447.04,-13804.19 446.44,-13795.39"/>
<polygon fill="black" stroke="black" points="449.93,-13795.09 445.76,-13785.35 442.94,-13795.57 449.93,-13795.09"/>
</g>
<!-- expert1_down_8 -->
<g id="node325" class="node">
<title>expert1_down_8</title>
<polygon fill="lightgreen" stroke="black" points="544,-13695.11 328,-13695.11 328,-13642.11 544,-13642.11 544,-13695.11"/>
<text text-anchor="middle" x="436" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="436" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="436" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert1_act_8&#45;&gt;expert1_down_8 -->
<g id="edge405" class="edge">
<title>expert1_act_8&#45;&gt;expert1_down_8</title>
<path fill="none" stroke="black" d="M441.64,-13731.69C440.89,-13723.45 440.05,-13714.19 439.25,-13705.39"/>
<polygon fill="black" stroke="black" points="442.73,-13705 438.34,-13695.35 435.76,-13705.63 442.73,-13705"/>
</g>
<!-- expert1_agg_8 -->
<g id="node326" class="node">
<title>expert1_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="423" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="423" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="423" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="423" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert1_down_8&#45;&gt;expert1_agg_8 -->
<g id="edge406" class="edge">
<title>expert1_down_8&#45;&gt;expert1_agg_8</title>
<path fill="none" stroke="black" d="M432.62,-13641.87C431.56,-13633.79 430.35,-13624.61 429.16,-13615.55"/>
<polygon fill="black" stroke="black" points="432.61,-13614.89 427.83,-13605.43 425.67,-13615.8 432.61,-13614.89"/>
</g>
<!-- expert1_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge407" class="edge">
<title>expert1_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M480.69,-13535.2C516.82,-13516.88 564.93,-13494.94 610,-13482.16 744.65,-13443.97 904.1,-13426.55 1015.05,-13418.64"/>
<polygon fill="purple" stroke="purple" points="1015.56,-13422.11 1025.29,-13417.93 1015.07,-13415.13 1015.56,-13422.11"/>
<text text-anchor="middle" x="681.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;14</text>
<text text-anchor="middle" x="681.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_8 -->
<g id="node328" class="node">
<title>expert2_act_8</title>
<polygon fill="lightgreen" stroke="black" points="764,-13785.11 596,-13785.11 596,-13732.11 764,-13732.11 764,-13785.11"/>
<text text-anchor="middle" x="680" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="680" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="680" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert2_up_8&#45;&gt;expert2_act_8 -->
<g id="edge409" class="edge">
<title>expert2_up_8&#45;&gt;expert2_act_8</title>
<path fill="none" stroke="black" d="M682.82,-13821.69C682.45,-13813.45 682.03,-13804.19 681.63,-13795.39"/>
<polygon fill="black" stroke="black" points="685.12,-13795.19 681.17,-13785.35 678.13,-13795.5 685.12,-13795.19"/>
</g>
<!-- expert2_down_8 -->
<g id="node329" class="node">
<title>expert2_down_8</title>
<polygon fill="lightgreen" stroke="black" points="782,-13695.11 566,-13695.11 566,-13642.11 782,-13642.11 782,-13695.11"/>
<text text-anchor="middle" x="674" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="674" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="674" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert2_act_8&#45;&gt;expert2_down_8 -->
<g id="edge410" class="edge">
<title>expert2_act_8&#45;&gt;expert2_down_8</title>
<path fill="none" stroke="black" d="M678.23,-13731.69C677.67,-13723.45 677.04,-13714.19 676.44,-13705.39"/>
<polygon fill="black" stroke="black" points="679.93,-13705.09 675.76,-13695.35 672.94,-13705.57 679.93,-13705.09"/>
</g>
<!-- expert2_agg_8 -->
<g id="node330" class="node">
<title>expert2_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="666" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="666" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="666" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="666" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert2_down_8&#45;&gt;expert2_agg_8 -->
<g id="edge411" class="edge">
<title>expert2_down_8&#45;&gt;expert2_agg_8</title>
<path fill="none" stroke="black" d="M671.92,-13641.87C671.27,-13633.79 670.52,-13624.61 669.79,-13615.55"/>
<polygon fill="black" stroke="black" points="673.27,-13615.12 668.97,-13605.43 666.29,-13615.68 673.27,-13615.12"/>
</g>
<!-- expert2_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge412" class="edge">
<title>expert2_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M715.87,-13533.9C744.68,-13516.29 782.22,-13495.5 818,-13482.16 883.21,-13457.84 958.9,-13441.1 1021.72,-13430.11"/>
<polygon fill="purple" stroke="purple" points="1022.42,-13433.54 1031.69,-13428.39 1021.24,-13426.64 1022.42,-13433.54"/>
<text text-anchor="middle" x="889.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;14</text>
<text text-anchor="middle" x="889.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_8 -->
<g id="node332" class="node">
<title>expert3_act_8</title>
<polygon fill="lightgreen" stroke="black" points="1002,-13785.11 834,-13785.11 834,-13732.11 1002,-13732.11 1002,-13785.11"/>
<text text-anchor="middle" x="918" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="918" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="918" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert3_up_8&#45;&gt;expert3_act_8 -->
<g id="edge414" class="edge">
<title>expert3_up_8&#45;&gt;expert3_act_8</title>
<path fill="none" stroke="black" d="M918,-13821.69C918,-13813.45 918,-13804.19 918,-13795.39"/>
<polygon fill="black" stroke="black" points="921.5,-13795.35 918,-13785.35 914.5,-13795.35 921.5,-13795.35"/>
</g>
<!-- expert3_down_8 -->
<g id="node333" class="node">
<title>expert3_down_8</title>
<polygon fill="lightgreen" stroke="black" points="1025,-13695.11 809,-13695.11 809,-13642.11 1025,-13642.11 1025,-13695.11"/>
<text text-anchor="middle" x="917" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="917" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="917" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert3_act_8&#45;&gt;expert3_down_8 -->
<g id="edge415" class="edge">
<title>expert3_act_8&#45;&gt;expert3_down_8</title>
<path fill="none" stroke="black" d="M917.71,-13731.69C917.61,-13723.45 917.51,-13714.19 917.41,-13705.39"/>
<polygon fill="black" stroke="black" points="920.91,-13705.31 917.29,-13695.35 913.91,-13705.39 920.91,-13705.31"/>
</g>
<!-- expert3_agg_8 -->
<g id="node334" class="node">
<title>expert3_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="909" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="909" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="909" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="909" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert3_down_8&#45;&gt;expert3_agg_8 -->
<g id="edge416" class="edge">
<title>expert3_down_8&#45;&gt;expert3_agg_8</title>
<path fill="none" stroke="black" d="M914.92,-13641.87C914.27,-13633.79 913.52,-13624.61 912.79,-13615.55"/>
<polygon fill="black" stroke="black" points="916.27,-13615.12 911.97,-13605.43 909.29,-13615.68 916.27,-13615.12"/>
</g>
<!-- expert3_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge417" class="edge">
<title>expert3_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M943.99,-13531.61C961.4,-13515.33 983.32,-13496.46 1005,-13482.16 1016.2,-13474.77 1028.31,-13467.72 1040.59,-13461.12"/>
<polygon fill="purple" stroke="purple" points="1042.34,-13464.16 1049.56,-13456.41 1039.08,-13457.96 1042.34,-13464.16"/>
<text text-anchor="middle" x="1076.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;14</text>
<text text-anchor="middle" x="1076.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_8 -->
<g id="node336" class="node">
<title>expert4_act_8</title>
<polygon fill="lightgreen" stroke="black" points="1236,-13785.11 1068,-13785.11 1068,-13732.11 1236,-13732.11 1236,-13785.11"/>
<text text-anchor="middle" x="1152" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1152" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1152" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert4_up_8&#45;&gt;expert4_act_8 -->
<g id="edge419" class="edge">
<title>expert4_up_8&#45;&gt;expert4_act_8</title>
<path fill="none" stroke="black" d="M1152,-13821.69C1152,-13813.45 1152,-13804.19 1152,-13795.39"/>
<polygon fill="black" stroke="black" points="1155.5,-13795.35 1152,-13785.35 1148.5,-13795.35 1155.5,-13795.35"/>
</g>
<!-- expert4_down_8 -->
<g id="node337" class="node">
<title>expert4_down_8</title>
<polygon fill="lightgreen" stroke="black" points="1260,-13695.11 1044,-13695.11 1044,-13642.11 1260,-13642.11 1260,-13695.11"/>
<text text-anchor="middle" x="1152" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1152" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1152" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert4_act_8&#45;&gt;expert4_down_8 -->
<g id="edge420" class="edge">
<title>expert4_act_8&#45;&gt;expert4_down_8</title>
<path fill="none" stroke="black" d="M1152,-13731.69C1152,-13723.45 1152,-13714.19 1152,-13705.39"/>
<polygon fill="black" stroke="black" points="1155.5,-13705.35 1152,-13695.35 1148.5,-13705.35 1155.5,-13705.35"/>
</g>
<!-- expert4_agg_8 -->
<g id="node338" class="node">
<title>expert4_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="1152" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1152" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1152" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert4_down_8&#45;&gt;expert4_agg_8 -->
<g id="edge421" class="edge">
<title>expert4_down_8&#45;&gt;expert4_agg_8</title>
<path fill="none" stroke="black" d="M1152,-13641.87C1152,-13633.79 1152,-13624.61 1152,-13615.55"/>
<polygon fill="black" stroke="black" points="1155.5,-13615.43 1152,-13605.43 1148.5,-13615.43 1155.5,-13615.43"/>
</g>
<!-- expert4_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge422" class="edge">
<title>expert4_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1152,-13530.03C1152,-13513.39 1152,-13493.23 1152,-13474.33"/>
<polygon fill="purple" stroke="purple" points="1155.5,-13474.29 1152,-13464.29 1148.5,-13474.29 1155.5,-13474.29"/>
<text text-anchor="middle" x="1223.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;14</text>
<text text-anchor="middle" x="1223.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_8 -->
<g id="node340" class="node">
<title>expert5_act_8</title>
<polygon fill="lightgreen" stroke="black" points="1475,-13785.11 1307,-13785.11 1307,-13732.11 1475,-13732.11 1475,-13785.11"/>
<text text-anchor="middle" x="1391" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1391" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1391" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert5_up_8&#45;&gt;expert5_act_8 -->
<g id="edge424" class="edge">
<title>expert5_up_8&#45;&gt;expert5_act_8</title>
<path fill="none" stroke="black" d="M1390.29,-13821.69C1390.39,-13813.45 1390.49,-13804.19 1390.59,-13795.39"/>
<polygon fill="black" stroke="black" points="1394.09,-13795.39 1390.71,-13785.35 1387.09,-13795.31 1394.09,-13795.39"/>
</g>
<!-- expert5_down_8 -->
<g id="node341" class="node">
<title>expert5_down_8</title>
<polygon fill="lightgreen" stroke="black" points="1501,-13695.11 1285,-13695.11 1285,-13642.11 1501,-13642.11 1501,-13695.11"/>
<text text-anchor="middle" x="1393" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1393" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1393" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert5_act_8&#45;&gt;expert5_down_8 -->
<g id="edge425" class="edge">
<title>expert5_act_8&#45;&gt;expert5_down_8</title>
<path fill="none" stroke="black" d="M1391.59,-13731.69C1391.78,-13723.45 1391.99,-13714.19 1392.19,-13705.39"/>
<polygon fill="black" stroke="black" points="1395.69,-13705.43 1392.41,-13695.35 1388.69,-13705.27 1395.69,-13705.43"/>
</g>
<!-- expert5_agg_8 -->
<g id="node342" class="node">
<title>expert5_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="1395" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1395" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1395" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1395" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert5_down_8&#45;&gt;expert5_agg_8 -->
<g id="edge426" class="edge">
<title>expert5_down_8&#45;&gt;expert5_agg_8</title>
<path fill="none" stroke="black" d="M1393.52,-13641.87C1393.68,-13633.79 1393.87,-13624.61 1394.05,-13615.55"/>
<polygon fill="black" stroke="black" points="1397.55,-13615.5 1394.26,-13605.43 1390.56,-13615.36 1397.55,-13615.5"/>
</g>
<!-- expert5_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge427" class="edge">
<title>expert5_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1360.01,-13531.61C1342.6,-13515.33 1320.68,-13496.46 1299,-13482.16 1292.36,-13477.78 1285.41,-13473.52 1278.29,-13469.41"/>
<polygon fill="purple" stroke="purple" points="1279.62,-13466.14 1269.2,-13464.27 1276.18,-13472.24 1279.62,-13466.14"/>
<text text-anchor="middle" x="1409.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;14</text>
<text text-anchor="middle" x="1409.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_8 -->
<g id="node344" class="node">
<title>expert6_act_8</title>
<polygon fill="lightgreen" stroke="black" points="1711,-13785.11 1543,-13785.11 1543,-13732.11 1711,-13732.11 1711,-13785.11"/>
<text text-anchor="middle" x="1627" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1627" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1627" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert6_up_8&#45;&gt;expert6_act_8 -->
<g id="edge429" class="edge">
<title>expert6_up_8&#45;&gt;expert6_act_8</title>
<path fill="none" stroke="black" d="M1626.29,-13821.69C1626.39,-13813.45 1626.49,-13804.19 1626.59,-13795.39"/>
<polygon fill="black" stroke="black" points="1630.09,-13795.39 1626.71,-13785.35 1623.09,-13795.31 1630.09,-13795.39"/>
</g>
<!-- expert6_down_8 -->
<g id="node345" class="node">
<title>expert6_down_8</title>
<polygon fill="lightgreen" stroke="black" points="1736,-13695.11 1520,-13695.11 1520,-13642.11 1736,-13642.11 1736,-13695.11"/>
<text text-anchor="middle" x="1628" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1628" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1628" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert6_act_8&#45;&gt;expert6_down_8 -->
<g id="edge430" class="edge">
<title>expert6_act_8&#45;&gt;expert6_down_8</title>
<path fill="none" stroke="black" d="M1627.29,-13731.69C1627.39,-13723.45 1627.49,-13714.19 1627.59,-13705.39"/>
<polygon fill="black" stroke="black" points="1631.09,-13705.39 1627.71,-13695.35 1624.09,-13705.31 1631.09,-13705.39"/>
</g>
<!-- expert6_agg_8 -->
<g id="node346" class="node">
<title>expert6_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="1638" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1638" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1638" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1638" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert6_down_8&#45;&gt;expert6_agg_8 -->
<g id="edge431" class="edge">
<title>expert6_down_8&#45;&gt;expert6_agg_8</title>
<path fill="none" stroke="black" d="M1630.6,-13641.87C1631.42,-13633.79 1632.34,-13624.61 1633.26,-13615.55"/>
<polygon fill="black" stroke="black" points="1636.76,-13615.73 1634.28,-13605.43 1629.79,-13615.03 1636.76,-13615.73"/>
</g>
<!-- expert6_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge432" class="edge">
<title>expert6_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1587.78,-13533.92C1558.76,-13516.32 1520.98,-13495.53 1485,-13482.16 1428.58,-13461.19 1364.33,-13445.83 1307.41,-13434.92"/>
<polygon fill="purple" stroke="purple" points="1307.72,-13431.42 1297.24,-13433.01 1306.42,-13438.3 1307.72,-13431.42"/>
<text text-anchor="middle" x="1616.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;14</text>
<text text-anchor="middle" x="1616.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_8 -->
<g id="node348" class="node">
<title>expert7_act_8</title>
<polygon fill="lightgreen" stroke="black" points="1946,-13785.11 1778,-13785.11 1778,-13732.11 1946,-13732.11 1946,-13785.11"/>
<text text-anchor="middle" x="1862" y="-13769.91" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1862" y="-13754.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1862" y="-13739.91" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert7_up_8&#45;&gt;expert7_act_8 -->
<g id="edge434" class="edge">
<title>expert7_up_8&#45;&gt;expert7_act_8</title>
<path fill="none" stroke="black" d="M1861.29,-13821.69C1861.39,-13813.45 1861.49,-13804.19 1861.59,-13795.39"/>
<polygon fill="black" stroke="black" points="1865.09,-13795.39 1861.71,-13785.35 1858.09,-13795.31 1865.09,-13795.39"/>
</g>
<!-- expert7_down_8 -->
<g id="node349" class="node">
<title>expert7_down_8</title>
<polygon fill="lightgreen" stroke="black" points="1971,-13695.11 1755,-13695.11 1755,-13642.11 1971,-13642.11 1971,-13695.11"/>
<text text-anchor="middle" x="1863" y="-13679.91" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1863" y="-13664.91" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1863" y="-13649.91" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert7_act_8&#45;&gt;expert7_down_8 -->
<g id="edge435" class="edge">
<title>expert7_act_8&#45;&gt;expert7_down_8</title>
<path fill="none" stroke="black" d="M1862.29,-13731.69C1862.39,-13723.45 1862.49,-13714.19 1862.59,-13705.39"/>
<polygon fill="black" stroke="black" points="1866.09,-13705.39 1862.71,-13695.35 1859.09,-13705.31 1866.09,-13705.39"/>
</g>
<!-- expert7_agg_8 -->
<g id="node350" class="node">
<title>expert7_agg_8</title>
<ellipse fill="lightgray" stroke="black" cx="1881" cy="-13567.64" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1881" y="-13578.94" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1881" y="-13563.94" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1881" y="-13548.94" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert7_down_8&#45;&gt;expert7_agg_8 -->
<g id="edge436" class="edge">
<title>expert7_down_8&#45;&gt;expert7_agg_8</title>
<path fill="none" stroke="black" d="M1867.68,-13641.87C1869.18,-13633.62 1870.89,-13624.23 1872.57,-13614.98"/>
<polygon fill="black" stroke="black" points="1876.03,-13615.52 1874.38,-13605.06 1869.14,-13614.27 1876.03,-13615.52"/>
</g>
<!-- expert7_agg_8&#45;&gt;expert_agg_8 -->
<g id="edge437" class="edge">
<title>expert7_agg_8&#45;&gt;expert_agg_8</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1823.07,-13535.43C1786.49,-13517.08 1737.66,-13495.03 1692,-13482.16 1561.63,-13445.43 1408.04,-13427.89 1298.06,-13419.56"/>
<polygon fill="purple" stroke="purple" points="1298.12,-13416.05 1287.89,-13418.81 1297.6,-13423.03 1298.12,-13416.05"/>
<text text-anchor="middle" x="1842.5" y="-13500.96" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;14</text>
<text text-anchor="middle" x="1842.5" y="-13485.96" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_8&#45;&gt;residual2_8 -->
<g id="edge438" class="edge">
<title>expert_agg_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1259.19,-13373.3C1316.27,-13353.67 1386.58,-13329.49 1445.07,-13309.37"/>
<polygon fill="black" stroke="black" points="1446.41,-13312.61 1454.73,-13306.05 1444.13,-13305.99 1446.41,-13312.61"/>
</g>
<!-- layer_out_8 -->
<g id="node353" class="node">
<title>layer_out_8</title>
<ellipse fill="lightgray" stroke="black" cx="1562" cy="-13140.68" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1562" y="-13151.98" font-family="Times,serif" font-size="14.00">Layer8_Output</text>
<text text-anchor="middle" x="1562" y="-13136.98" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1562" y="-13121.98" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual2_8&#45;&gt;layer_out_8 -->
<g id="edge440" class="edge">
<title>residual2_8&#45;&gt;layer_out_8</title>
<path fill="none" stroke="black" d="M1562,-13215.04C1562,-13206.13 1562,-13196.93 1562,-13188.19"/>
<polygon fill="black" stroke="black" points="1565.5,-13188.17 1562,-13178.17 1558.5,-13188.17 1565.5,-13188.17"/>
</g>
<!-- ln1_9 -->
<g id="node354" class="node">
<title>ln1_9</title>
<polygon fill="lightyellow" stroke="black" points="1431.5,-13016.21 1272.5,-13016.21 1272.5,-12963.21 1431.5,-12963.21 1431.5,-13016.21"/>
<text text-anchor="middle" x="1352" y="-13001.01" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1352" y="-12986.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1352" y="-12971.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- layer_out_8&#45;&gt;ln1_9 -->
<g id="edge441" class="edge">
<title>layer_out_8&#45;&gt;ln1_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1515.13,-13106.44C1479.7,-13081.3 1431.36,-13047 1396.51,-13022.28"/>
<polygon fill="red" stroke="red" points="1398.14,-13019.15 1387.96,-13016.22 1394.09,-13024.86 1398.14,-13019.15"/>
<text text-anchor="middle" x="1552.5" y="-13074.01" font-family="Times,serif" font-size="14.00">GPU&#45;63→GPU&#45;8</text>
<text text-anchor="middle" x="1552.5" y="-13059.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_9 -->
<g id="node360" class="node">
<title>residual1_9</title>
<polygon fill="lightpink" stroke="black" points="1875.69,-12656.21 1613.71,-12656.21 1546.31,-12550.21 1808.29,-12550.21 1875.69,-12656.21"/>
<text text-anchor="middle" x="1711" y="-12614.51" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1711" y="-12599.51" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1711" y="-12584.51" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- layer_out_8&#45;&gt;residual1_9 -->
<g id="edge449" class="edge">
<title>layer_out_8&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1627.95,-13110.32C1672.41,-13085.55 1723,-13045.35 1723,-12990.71 1723,-12990.71 1723,-12990.71 1723,-12718.71 1723,-12701.74 1721.68,-12683.44 1719.92,-12666.55"/>
<polygon fill="black" stroke="black" points="1723.35,-12665.79 1718.77,-12656.24 1716.4,-12666.57 1723.35,-12665.79"/>
</g>
<!-- mha_q_9 -->
<g id="node355" class="node">
<title>mha_q_9</title>
<polygon fill="lightcoral" stroke="black" points="1220.5,-12926.21 1001.5,-12926.21 1001.5,-12873.21 1220.5,-12873.21 1220.5,-12926.21"/>
<text text-anchor="middle" x="1111" y="-12911.01" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1111" y="-12896.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1111" y="-12881.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_q_9 -->
<g id="edge442" class="edge">
<title>ln1_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M1281.97,-12963.13C1253.38,-12952.69 1220.16,-12940.56 1190.65,-12929.79"/>
<polygon fill="black" stroke="black" points="1191.8,-12926.48 1181.21,-12926.34 1189.4,-12933.06 1191.8,-12926.48"/>
</g>
<!-- mha_k_9 -->
<g id="node356" class="node">
<title>mha_k_9</title>
<polygon fill="lightcoral" stroke="black" points="1457.5,-12926.21 1238.5,-12926.21 1238.5,-12873.21 1457.5,-12873.21 1457.5,-12926.21"/>
<text text-anchor="middle" x="1348" y="-12911.01" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1348" y="-12896.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1348" y="-12881.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_k_9 -->
<g id="edge443" class="edge">
<title>ln1_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M1350.82,-12962.78C1350.45,-12954.54 1350.03,-12945.29 1349.63,-12936.48"/>
<polygon fill="black" stroke="black" points="1353.12,-12936.28 1349.17,-12926.45 1346.13,-12936.6 1353.12,-12936.28"/>
</g>
<!-- mha_v_9 -->
<g id="node357" class="node">
<title>mha_v_9</title>
<polygon fill="lightcoral" stroke="black" points="1694.5,-12926.21 1475.5,-12926.21 1475.5,-12873.21 1694.5,-12873.21 1694.5,-12926.21"/>
<text text-anchor="middle" x="1585" y="-12911.01" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1585" y="-12896.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1585" y="-12881.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_v_9 -->
<g id="edge444" class="edge">
<title>ln1_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M1419.71,-12963.13C1447.23,-12952.74 1479.19,-12940.67 1507.63,-12929.93"/>
<polygon fill="black" stroke="black" points="1509.01,-12933.15 1517.12,-12926.34 1506.53,-12926.6 1509.01,-12933.15"/>
</g>
<!-- mha_attn_9 -->
<g id="node358" class="node">
<title>mha_attn_9</title>
<polygon fill="lightcoral" stroke="black" points="1494.5,-12836.21 1323.5,-12836.21 1323.5,-12783.21 1494.5,-12783.21 1494.5,-12836.21"/>
<text text-anchor="middle" x="1409" y="-12821.01" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1409" y="-12806.01" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1409" y="-12791.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge445" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1197.59,-12873.13C1233.96,-12862.4 1276.37,-12849.87 1313.62,-12838.87"/>
<polygon fill="black" stroke="black" points="1314.88,-12842.15 1323.48,-12835.96 1312.9,-12835.44 1314.88,-12842.15"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge446" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1365.97,-12872.78C1372.05,-12864.01 1378.94,-12854.07 1385.39,-12844.77"/>
<polygon fill="black" stroke="black" points="1388.34,-12846.66 1391.16,-12836.45 1382.58,-12842.67 1388.34,-12846.66"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge447" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1533.62,-12873.02C1513.47,-12862.94 1490.2,-12851.31 1469.26,-12840.84"/>
<polygon fill="black" stroke="black" points="1470.65,-12837.62 1460.14,-12836.28 1467.52,-12843.88 1470.65,-12837.62"/>
</g>
<!-- mha_out_9 -->
<g id="node359" class="node">
<title>mha_out_9</title>
<polygon fill="lightcoral" stroke="black" points="1687.5,-12746.21 1528.5,-12746.21 1528.5,-12693.21 1687.5,-12693.21 1687.5,-12746.21"/>
<text text-anchor="middle" x="1608" y="-12731.01" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1608" y="-12716.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1608" y="-12701.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge448" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M1466.83,-12783.13C1489.92,-12772.92 1516.68,-12761.09 1540.65,-12750.49"/>
<polygon fill="black" stroke="black" points="1542.3,-12753.59 1550.03,-12746.34 1539.47,-12747.19 1542.3,-12753.59"/>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge450" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1631.12,-12693.01C1638.94,-12684.31 1648.04,-12674.19 1657.24,-12663.97"/>
<polygon fill="black" stroke="black" points="1659.85,-12666.3 1663.93,-12656.53 1654.64,-12661.62 1659.85,-12666.3"/>
</g>
<!-- ln2_9 -->
<g id="node361" class="node">
<title>ln2_9</title>
<polygon fill="lightyellow" stroke="black" points="1331.5,-12513.21 1172.5,-12513.21 1172.5,-12460.21 1331.5,-12460.21 1331.5,-12513.21"/>
<text text-anchor="middle" x="1252" y="-12498.01" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1252" y="-12483.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1252" y="-12468.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge451" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M1554.32,-12563.12C1483.35,-12545.42 1402.01,-12525.13 1341.59,-12510.05"/>
<polygon fill="black" stroke="black" points="1342.25,-12506.61 1331.7,-12507.59 1340.55,-12513.4 1342.25,-12506.61"/>
</g>
<!-- residual2_9 -->
<g id="node396" class="node">
<title>residual2_9</title>
<polygon fill="lightpink" stroke="black" points="1967.69,-11697.25 1705.71,-11697.25 1638.31,-11591.25 1900.29,-11591.25 1967.69,-11697.25"/>
<text text-anchor="middle" x="1803" y="-11655.55" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1803" y="-11640.55" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1803" y="-11625.55" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge494" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1827.37,-12580.16C1912.08,-12560.67 2012,-12528.94 2012,-12487.71 2012,-12487.71 2012,-12487.71 2012,-11786.25 2012,-11750.75 1991.01,-11723.58 1962.34,-11703.04"/>
<polygon fill="black" stroke="black" points="1964.3,-11700.14 1954.06,-11697.42 1960.37,-11705.93 1964.3,-11700.14"/>
</g>
<!-- gate_9 -->
<g id="node362" class="node">
<title>gate_9</title>
<polygon fill="orange" stroke="black" points="1152,-12423.21 972,-12370.21 1152,-12317.21 1332,-12370.21 1152,-12423.21"/>
<text text-anchor="middle" x="1152" y="-12381.51" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1152" y="-12366.51" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1152" y="-12351.51" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln2_9&#45;&gt;gate_9 -->
<g id="edge452" class="edge">
<title>ln2_9&#45;&gt;gate_9</title>
<path fill="none" stroke="black" d="M1229.56,-12460.01C1219.45,-12448.44 1207.15,-12434.36 1195.36,-12420.86"/>
<polygon fill="black" stroke="black" points="1197.71,-12418.22 1188.5,-12413 1192.44,-12422.83 1197.71,-12418.22"/>
</g>
<!-- expert0_up_9 -->
<g id="node363" class="node">
<title>expert0_up_9</title>
<polygon fill="lightgreen" stroke="black" points="309,-12251.21 93,-12251.21 93,-12198.21 309,-12198.21 309,-12251.21"/>
<text text-anchor="middle" x="201" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="201" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="201" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- gate_9&#45;&gt;expert0_up_9 -->
<g id="edge453" class="edge">
<title>gate_9&#45;&gt;expert0_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1002.54,-12361.1C863.27,-12351.86 650.3,-12333.38 468,-12299.21 407.85,-12287.93 341.5,-12269.69 289.99,-12254.21"/>
<polygon fill="blue" stroke="blue" points="290.8,-12250.8 280.22,-12251.25 288.78,-12257.5 290.8,-12250.8"/>
<text text-anchor="middle" x="519.5" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="519.5" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;8</text>
</g>
<!-- expert1_up_9 -->
<g id="node367" class="node">
<title>expert1_up_9</title>
<polygon fill="lightgreen" stroke="black" points="552,-12251.21 336,-12251.21 336,-12198.21 552,-12198.21 552,-12251.21"/>
<text text-anchor="middle" x="444" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="444" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="444" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_9&#45;&gt;expert1_up_9 -->
<g id="edge458" class="edge">
<title>gate_9&#45;&gt;expert1_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1022.32,-12355.36C927.15,-12343.88 795.15,-12325.23 681,-12299.21 628.66,-12287.28 571.13,-12269.55 525.85,-12254.49"/>
<polygon fill="blue" stroke="blue" points="526.68,-12251.08 516.09,-12251.22 524.46,-12257.71 526.68,-12251.08"/>
<text text-anchor="middle" x="732.5" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="732.5" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;9</text>
</g>
<!-- expert2_up_9 -->
<g id="node371" class="node">
<title>expert2_up_9</title>
<polygon fill="lightgreen" stroke="black" points="790,-12251.21 574,-12251.21 574,-12198.21 790,-12198.21 790,-12251.21"/>
<text text-anchor="middle" x="682" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="682" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="682" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_9&#45;&gt;expert2_up_9 -->
<g id="edge463" class="edge">
<title>gate_9&#45;&gt;expert2_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1051.15,-12346.87C998.02,-12334.33 932.02,-12317.54 874,-12299.21 833.23,-12286.32 788.57,-12269.4 752.6,-12255.04"/>
<polygon fill="blue" stroke="blue" points="753.75,-12251.73 743.17,-12251.26 751.14,-12258.23 753.75,-12251.73"/>
<text text-anchor="middle" x="930" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="930" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;10</text>
</g>
<!-- expert3_up_9 -->
<g id="node375" class="node">
<title>expert3_up_9</title>
<polygon fill="lightgreen" stroke="black" points="1026,-12251.21 810,-12251.21 810,-12198.21 1026,-12198.21 1026,-12251.21"/>
<text text-anchor="middle" x="918" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="918" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="918" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_9&#45;&gt;expert3_up_9 -->
<g id="edge468" class="edge">
<title>gate_9&#45;&gt;expert3_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1093.78,-12334.29C1075.28,-12323.14 1054.75,-12310.7 1036,-12299.21 1013.39,-12285.35 988.46,-12269.85 967.36,-12256.67"/>
<polygon fill="blue" stroke="blue" points="969.2,-12253.69 958.87,-12251.36 965.49,-12259.63 969.2,-12253.69"/>
<text text-anchor="middle" x="1092" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1092" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;11</text>
</g>
<!-- expert4_up_9 -->
<g id="node379" class="node">
<title>expert4_up_9</title>
<polygon fill="lightgreen" stroke="black" points="1260,-12251.21 1044,-12251.21 1044,-12198.21 1260,-12198.21 1260,-12251.21"/>
<text text-anchor="middle" x="1152" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1152" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1152" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_9&#45;&gt;expert4_up_9 -->
<g id="edge473" class="edge">
<title>gate_9&#45;&gt;expert4_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1152,-12316.99C1152,-12298.72 1152,-12278.61 1152,-12261.93"/>
<polygon fill="blue" stroke="blue" points="1155.5,-12261.52 1152,-12251.52 1148.5,-12261.52 1155.5,-12261.52"/>
<text text-anchor="middle" x="1208" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1208" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;12</text>
</g>
<!-- expert5_up_9 -->
<g id="node383" class="node">
<title>expert5_up_9</title>
<polygon fill="lightgreen" stroke="black" points="1495,-12251.21 1279,-12251.21 1279,-12198.21 1495,-12198.21 1495,-12251.21"/>
<text text-anchor="middle" x="1387" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1387" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1387" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_9&#45;&gt;expert5_up_9 -->
<g id="edge478" class="edge">
<title>gate_9&#45;&gt;expert5_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1210.19,-12334.25C1228.7,-12323.09 1249.23,-12310.67 1268,-12299.21 1290.77,-12285.3 1315.91,-12269.8 1337.2,-12256.62"/>
<polygon fill="blue" stroke="blue" points="1339.1,-12259.56 1345.76,-12251.32 1335.42,-12253.61 1339.1,-12259.56"/>
<text text-anchor="middle" x="1369" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1369" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;13</text>
</g>
<!-- expert6_up_9 -->
<g id="node387" class="node">
<title>expert6_up_9</title>
<polygon fill="lightgreen" stroke="black" points="1730,-12251.21 1514,-12251.21 1514,-12198.21 1730,-12198.21 1730,-12251.21"/>
<text text-anchor="middle" x="1622" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1622" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1622" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_9&#45;&gt;expert6_up_9 -->
<g id="edge483" class="edge">
<title>gate_9&#45;&gt;expert6_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1252.8,-12346.72C1305.68,-12334.17 1371.29,-12317.42 1429,-12299.21 1469.96,-12286.28 1514.85,-12269.36 1551.02,-12255.01"/>
<polygon fill="blue" stroke="blue" points="1552.51,-12258.18 1560.5,-12251.23 1549.91,-12251.68 1552.51,-12258.18"/>
<text text-anchor="middle" x="1565" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1565" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;14</text>
</g>
<!-- expert7_up_9 -->
<g id="node391" class="node">
<title>expert7_up_9</title>
<polygon fill="lightgreen" stroke="black" points="1967,-12251.21 1751,-12251.21 1751,-12198.21 1967,-12198.21 1967,-12251.21"/>
<text text-anchor="middle" x="1859" y="-12236.01" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1859" y="-12221.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1859" y="-12206.01" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_9&#45;&gt;expert7_up_9 -->
<g id="edge488" class="edge">
<title>gate_9&#45;&gt;expert7_up_9</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1282.26,-12355.52C1377.85,-12344.13 1510.41,-12325.51 1625,-12299.21 1676.72,-12287.34 1733.53,-12269.61 1778.22,-12254.54"/>
<polygon fill="blue" stroke="blue" points="1779.51,-12257.79 1787.85,-12251.26 1777.26,-12251.17 1779.51,-12257.79"/>
<text text-anchor="middle" x="1784" y="-12288.01" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1784" y="-12273.01" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;15</text>
</g>
<!-- expert0_act_9 -->
<g id="node364" class="node">
<title>expert0_act_9</title>
<polygon fill="lightgreen" stroke="black" points="280,-12161.21 112,-12161.21 112,-12108.21 280,-12108.21 280,-12161.21"/>
<text text-anchor="middle" x="196" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="196" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="196" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert0_up_9&#45;&gt;expert0_act_9 -->
<g id="edge454" class="edge">
<title>expert0_up_9&#45;&gt;expert0_act_9</title>
<path fill="none" stroke="black" d="M199.53,-12197.78C199.06,-12189.54 198.53,-12180.29 198.03,-12171.48"/>
<polygon fill="black" stroke="black" points="201.52,-12171.23 197.46,-12161.45 194.54,-12171.63 201.52,-12171.23"/>
</g>
<!-- expert0_down_9 -->
<g id="node365" class="node">
<title>expert0_down_9</title>
<polygon fill="lightgreen" stroke="black" points="298,-12071.21 82,-12071.21 82,-12018.21 298,-12018.21 298,-12071.21"/>
<text text-anchor="middle" x="190" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="190" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="190" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert0_act_9&#45;&gt;expert0_down_9 -->
<g id="edge455" class="edge">
<title>expert0_act_9&#45;&gt;expert0_down_9</title>
<path fill="none" stroke="black" d="M194.23,-12107.78C193.67,-12099.54 193.04,-12090.29 192.44,-12081.48"/>
<polygon fill="black" stroke="black" points="195.93,-12081.19 191.76,-12071.45 188.94,-12081.66 195.93,-12081.19"/>
</g>
<!-- expert0_agg_9 -->
<g id="node366" class="node">
<title>expert0_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="180" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="180" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="180" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="180" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- expert0_down_9&#45;&gt;expert0_agg_9 -->
<g id="edge456" class="edge">
<title>expert0_down_9&#45;&gt;expert0_agg_9</title>
<path fill="none" stroke="black" d="M187.4,-12017.96C186.58,-12009.89 185.66,-12000.71 184.74,-11991.65"/>
<polygon fill="black" stroke="black" points="188.21,-11991.12 183.72,-11981.53 181.24,-11991.83 188.21,-11991.12"/>
</g>
<!-- expert_agg_9 -->
<g id="node395" class="node">
<title>expert_agg_9</title>
<polygon fill="gold" stroke="black" points="1316.69,-11840.25 1054.71,-11840.25 987.31,-11734.25 1249.29,-11734.25 1316.69,-11840.25"/>
<text text-anchor="middle" x="1152" y="-11798.55" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1152" y="-11783.55" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-11768.55" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert0_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge457" class="edge">
<title>expert0_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M240.1,-11912.04C279.66,-11893.28 333.16,-11870.58 383,-11858.25 597.88,-11805.08 855.5,-11791.38 1011.32,-11788.35"/>
<polygon fill="purple" stroke="purple" points="1011.5,-11791.85 1021.44,-11788.17 1011.37,-11784.85 1011.5,-11791.85"/>
<text text-anchor="middle" x="454.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;15</text>
<text text-anchor="middle" x="454.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_9 -->
<g id="node368" class="node">
<title>expert1_act_9</title>
<polygon fill="lightgreen" stroke="black" points="521,-12161.21 353,-12161.21 353,-12108.21 521,-12108.21 521,-12161.21"/>
<text text-anchor="middle" x="437" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="437" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="437" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert1_up_9&#45;&gt;expert1_act_9 -->
<g id="edge459" class="edge">
<title>expert1_up_9&#45;&gt;expert1_act_9</title>
<path fill="none" stroke="black" d="M441.94,-12197.78C441.28,-12189.54 440.55,-12180.29 439.85,-12171.48"/>
<polygon fill="black" stroke="black" points="443.33,-12171.14 439.05,-12161.45 436.35,-12171.69 443.33,-12171.14"/>
</g>
<!-- expert1_down_9 -->
<g id="node369" class="node">
<title>expert1_down_9</title>
<polygon fill="lightgreen" stroke="black" points="541,-12071.21 325,-12071.21 325,-12018.21 541,-12018.21 541,-12071.21"/>
<text text-anchor="middle" x="433" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="433" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="433" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert1_act_9&#45;&gt;expert1_down_9 -->
<g id="edge460" class="edge">
<title>expert1_act_9&#45;&gt;expert1_down_9</title>
<path fill="none" stroke="black" d="M435.82,-12107.78C435.45,-12099.54 435.03,-12090.29 434.63,-12081.48"/>
<polygon fill="black" stroke="black" points="438.12,-12081.28 434.17,-12071.45 431.13,-12081.6 438.12,-12081.28"/>
</g>
<!-- expert1_agg_9 -->
<g id="node370" class="node">
<title>expert1_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="423" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="423" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="423" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="423" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert1_down_9&#45;&gt;expert1_agg_9 -->
<g id="edge461" class="edge">
<title>expert1_down_9&#45;&gt;expert1_agg_9</title>
<path fill="none" stroke="black" d="M430.4,-12017.96C429.58,-12009.89 428.66,-12000.71 427.74,-11991.65"/>
<polygon fill="black" stroke="black" points="431.21,-11991.12 426.72,-11981.53 424.24,-11991.83 431.21,-11991.12"/>
</g>
<!-- expert1_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge462" class="edge">
<title>expert1_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M480.69,-11911.29C516.82,-11892.98 564.93,-11871.04 610,-11858.25 744.65,-11820.06 904.1,-11802.64 1015.05,-11794.74"/>
<polygon fill="purple" stroke="purple" points="1015.56,-11798.21 1025.29,-11794.02 1015.07,-11791.22 1015.56,-11798.21"/>
<text text-anchor="middle" x="681.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;15</text>
<text text-anchor="middle" x="681.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_9 -->
<g id="node372" class="node">
<title>expert2_act_9</title>
<polygon fill="lightgreen" stroke="black" points="764,-12161.21 596,-12161.21 596,-12108.21 764,-12108.21 764,-12161.21"/>
<text text-anchor="middle" x="680" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="680" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="680" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert2_up_9&#45;&gt;expert2_act_9 -->
<g id="edge464" class="edge">
<title>expert2_up_9&#45;&gt;expert2_act_9</title>
<path fill="none" stroke="black" d="M681.41,-12197.78C681.22,-12189.54 681.01,-12180.29 680.81,-12171.48"/>
<polygon fill="black" stroke="black" points="684.31,-12171.37 680.59,-12161.45 677.31,-12171.53 684.31,-12171.37"/>
</g>
<!-- expert2_down_9 -->
<g id="node373" class="node">
<title>expert2_down_9</title>
<polygon fill="lightgreen" stroke="black" points="779,-12071.21 563,-12071.21 563,-12018.21 779,-12018.21 779,-12071.21"/>
<text text-anchor="middle" x="671" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="671" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="671" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert2_act_9&#45;&gt;expert2_down_9 -->
<g id="edge465" class="edge">
<title>expert2_act_9&#45;&gt;expert2_down_9</title>
<path fill="none" stroke="black" d="M677.35,-12107.78C676.51,-12099.54 675.56,-12090.29 674.66,-12081.48"/>
<polygon fill="black" stroke="black" points="678.13,-12081.04 673.63,-12071.45 671.17,-12081.75 678.13,-12081.04"/>
</g>
<!-- expert2_agg_9 -->
<g id="node374" class="node">
<title>expert2_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="666" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="666" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="666" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="666" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert2_down_9&#45;&gt;expert2_agg_9 -->
<g id="edge466" class="edge">
<title>expert2_down_9&#45;&gt;expert2_agg_9</title>
<path fill="none" stroke="black" d="M669.7,-12017.96C669.29,-12009.89 668.83,-12000.71 668.37,-11991.65"/>
<polygon fill="black" stroke="black" points="671.86,-11991.34 667.86,-11981.53 664.87,-11991.69 671.86,-11991.34"/>
</g>
<!-- expert2_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge467" class="edge">
<title>expert2_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M715.87,-11909.99C744.68,-11892.38 782.22,-11871.6 818,-11858.25 883.21,-11833.94 958.9,-11817.2 1021.72,-11806.2"/>
<polygon fill="purple" stroke="purple" points="1022.42,-11809.63 1031.69,-11804.49 1021.24,-11802.73 1022.42,-11809.63"/>
<text text-anchor="middle" x="889.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;15</text>
<text text-anchor="middle" x="889.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_9 -->
<g id="node376" class="node">
<title>expert3_act_9</title>
<polygon fill="lightgreen" stroke="black" points="1001,-12161.21 833,-12161.21 833,-12108.21 1001,-12108.21 1001,-12161.21"/>
<text text-anchor="middle" x="917" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="917" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="917" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert3_up_9&#45;&gt;expert3_act_9 -->
<g id="edge469" class="edge">
<title>expert3_up_9&#45;&gt;expert3_act_9</title>
<path fill="none" stroke="black" d="M917.71,-12197.78C917.61,-12189.54 917.51,-12180.29 917.41,-12171.48"/>
<polygon fill="black" stroke="black" points="920.91,-12171.41 917.29,-12161.45 913.91,-12171.49 920.91,-12171.41"/>
</g>
<!-- expert3_down_9 -->
<g id="node377" class="node">
<title>expert3_down_9</title>
<polygon fill="lightgreen" stroke="black" points="1024,-12071.21 808,-12071.21 808,-12018.21 1024,-12018.21 1024,-12071.21"/>
<text text-anchor="middle" x="916" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="916" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="916" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert3_act_9&#45;&gt;expert3_down_9 -->
<g id="edge470" class="edge">
<title>expert3_act_9&#45;&gt;expert3_down_9</title>
<path fill="none" stroke="black" d="M916.71,-12107.78C916.61,-12099.54 916.51,-12090.29 916.41,-12081.48"/>
<polygon fill="black" stroke="black" points="919.91,-12081.41 916.29,-12071.45 912.91,-12081.49 919.91,-12081.41"/>
</g>
<!-- expert3_agg_9 -->
<g id="node378" class="node">
<title>expert3_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="909" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="909" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="909" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="909" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert3_down_9&#45;&gt;expert3_agg_9 -->
<g id="edge471" class="edge">
<title>expert3_down_9&#45;&gt;expert3_agg_9</title>
<path fill="none" stroke="black" d="M914.18,-12017.96C913.61,-12009.89 912.96,-12000.71 912.32,-11991.65"/>
<polygon fill="black" stroke="black" points="915.8,-11991.25 911.6,-11981.53 908.82,-11991.75 915.8,-11991.25"/>
</g>
<!-- expert3_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge472" class="edge">
<title>expert3_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M943.99,-11907.71C961.4,-11891.43 983.32,-11872.55 1005,-11858.25 1016.2,-11850.86 1028.31,-11843.81 1040.59,-11837.22"/>
<polygon fill="purple" stroke="purple" points="1042.34,-11840.25 1049.56,-11832.5 1039.08,-11834.06 1042.34,-11840.25"/>
<text text-anchor="middle" x="1076.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;15</text>
<text text-anchor="middle" x="1076.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_9 -->
<g id="node380" class="node">
<title>expert4_act_9</title>
<polygon fill="lightgreen" stroke="black" points="1236,-12161.21 1068,-12161.21 1068,-12108.21 1236,-12108.21 1236,-12161.21"/>
<text text-anchor="middle" x="1152" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1152" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1152" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert4_up_9&#45;&gt;expert4_act_9 -->
<g id="edge474" class="edge">
<title>expert4_up_9&#45;&gt;expert4_act_9</title>
<path fill="none" stroke="black" d="M1152,-12197.78C1152,-12189.54 1152,-12180.29 1152,-12171.48"/>
<polygon fill="black" stroke="black" points="1155.5,-12171.45 1152,-12161.45 1148.5,-12171.45 1155.5,-12171.45"/>
</g>
<!-- expert4_down_9 -->
<g id="node381" class="node">
<title>expert4_down_9</title>
<polygon fill="lightgreen" stroke="black" points="1260,-12071.21 1044,-12071.21 1044,-12018.21 1260,-12018.21 1260,-12071.21"/>
<text text-anchor="middle" x="1152" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1152" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1152" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert4_act_9&#45;&gt;expert4_down_9 -->
<g id="edge475" class="edge">
<title>expert4_act_9&#45;&gt;expert4_down_9</title>
<path fill="none" stroke="black" d="M1152,-12107.78C1152,-12099.54 1152,-12090.29 1152,-12081.48"/>
<polygon fill="black" stroke="black" points="1155.5,-12081.45 1152,-12071.45 1148.5,-12081.45 1155.5,-12081.45"/>
</g>
<!-- expert4_agg_9 -->
<g id="node382" class="node">
<title>expert4_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="1152" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1152" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1152" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1152" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert4_down_9&#45;&gt;expert4_agg_9 -->
<g id="edge476" class="edge">
<title>expert4_down_9&#45;&gt;expert4_agg_9</title>
<path fill="none" stroke="black" d="M1152,-12017.96C1152,-12009.89 1152,-12000.71 1152,-11991.65"/>
<polygon fill="black" stroke="black" points="1155.5,-11991.53 1152,-11981.53 1148.5,-11991.53 1155.5,-11991.53"/>
</g>
<!-- expert4_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge477" class="edge">
<title>expert4_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1152,-11906.12C1152,-11889.48 1152,-11869.33 1152,-11850.43"/>
<polygon fill="purple" stroke="purple" points="1155.5,-11850.38 1152,-11840.38 1148.5,-11850.38 1155.5,-11850.38"/>
<text text-anchor="middle" x="1223.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;15</text>
<text text-anchor="middle" x="1223.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_9 -->
<g id="node384" class="node">
<title>expert5_act_9</title>
<polygon fill="lightgreen" stroke="black" points="1472,-12161.21 1304,-12161.21 1304,-12108.21 1472,-12108.21 1472,-12161.21"/>
<text text-anchor="middle" x="1388" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1388" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1388" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert5_up_9&#45;&gt;expert5_act_9 -->
<g id="edge479" class="edge">
<title>expert5_up_9&#45;&gt;expert5_act_9</title>
<path fill="none" stroke="black" d="M1387.29,-12197.78C1387.39,-12189.54 1387.49,-12180.29 1387.59,-12171.48"/>
<polygon fill="black" stroke="black" points="1391.09,-12171.49 1387.71,-12161.45 1384.09,-12171.41 1391.09,-12171.49"/>
</g>
<!-- expert5_down_9 -->
<g id="node385" class="node">
<title>expert5_down_9</title>
<polygon fill="lightgreen" stroke="black" points="1498,-12071.21 1282,-12071.21 1282,-12018.21 1498,-12018.21 1498,-12071.21"/>
<text text-anchor="middle" x="1390" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1390" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1390" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert5_act_9&#45;&gt;expert5_down_9 -->
<g id="edge480" class="edge">
<title>expert5_act_9&#45;&gt;expert5_down_9</title>
<path fill="none" stroke="black" d="M1388.59,-12107.78C1388.78,-12099.54 1388.99,-12090.29 1389.19,-12081.48"/>
<polygon fill="black" stroke="black" points="1392.69,-12081.53 1389.41,-12071.45 1385.69,-12081.37 1392.69,-12081.53"/>
</g>
<!-- expert5_agg_9 -->
<g id="node386" class="node">
<title>expert5_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="1395" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1395" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1395" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1395" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert5_down_9&#45;&gt;expert5_agg_9 -->
<g id="edge481" class="edge">
<title>expert5_down_9&#45;&gt;expert5_agg_9</title>
<path fill="none" stroke="black" d="M1391.3,-12017.96C1391.71,-12009.89 1392.17,-12000.71 1392.63,-11991.65"/>
<polygon fill="black" stroke="black" points="1396.13,-11991.69 1393.14,-11981.53 1389.14,-11991.34 1396.13,-11991.69"/>
</g>
<!-- expert5_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge482" class="edge">
<title>expert5_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1360.01,-11907.71C1342.6,-11891.43 1320.68,-11872.55 1299,-11858.25 1292.36,-11853.88 1285.41,-11849.62 1278.29,-11845.5"/>
<polygon fill="purple" stroke="purple" points="1279.62,-11842.23 1269.2,-11840.37 1276.18,-11848.33 1279.62,-11842.23"/>
<text text-anchor="middle" x="1409.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;15</text>
<text text-anchor="middle" x="1409.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_9 -->
<g id="node388" class="node">
<title>expert6_act_9</title>
<polygon fill="lightgreen" stroke="black" points="1710,-12161.21 1542,-12161.21 1542,-12108.21 1710,-12108.21 1710,-12161.21"/>
<text text-anchor="middle" x="1626" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1626" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1626" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert6_up_9&#45;&gt;expert6_act_9 -->
<g id="edge484" class="edge">
<title>expert6_up_9&#45;&gt;expert6_act_9</title>
<path fill="none" stroke="black" d="M1623.18,-12197.78C1623.55,-12189.54 1623.97,-12180.29 1624.37,-12171.48"/>
<polygon fill="black" stroke="black" points="1627.87,-12171.6 1624.83,-12161.45 1620.88,-12171.28 1627.87,-12171.6"/>
</g>
<!-- expert6_down_9 -->
<g id="node389" class="node">
<title>expert6_down_9</title>
<polygon fill="lightgreen" stroke="black" points="1739,-12071.21 1523,-12071.21 1523,-12018.21 1739,-12018.21 1739,-12071.21"/>
<text text-anchor="middle" x="1631" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1631" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1631" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert6_act_9&#45;&gt;expert6_down_9 -->
<g id="edge485" class="edge">
<title>expert6_act_9&#45;&gt;expert6_down_9</title>
<path fill="none" stroke="black" d="M1627.47,-12107.78C1627.94,-12099.54 1628.47,-12090.29 1628.97,-12081.48"/>
<polygon fill="black" stroke="black" points="1632.46,-12081.63 1629.54,-12071.45 1625.48,-12081.23 1632.46,-12081.63"/>
</g>
<!-- expert6_agg_9 -->
<g id="node390" class="node">
<title>expert6_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="1638" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1638" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1638" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1638" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert6_down_9&#45;&gt;expert6_agg_9 -->
<g id="edge486" class="edge">
<title>expert6_down_9&#45;&gt;expert6_agg_9</title>
<path fill="none" stroke="black" d="M1632.82,-12017.96C1633.39,-12009.89 1634.04,-12000.71 1634.68,-11991.65"/>
<polygon fill="black" stroke="black" points="1638.18,-11991.75 1635.4,-11981.53 1631.2,-11991.25 1638.18,-11991.75"/>
</g>
<!-- expert6_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge487" class="edge">
<title>expert6_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1587.78,-11910.01C1558.76,-11892.41 1520.98,-11871.62 1485,-11858.25 1428.58,-11837.28 1364.33,-11821.92 1307.41,-11811.02"/>
<polygon fill="purple" stroke="purple" points="1307.72,-11807.51 1297.24,-11809.1 1306.42,-11814.39 1307.72,-11807.51"/>
<text text-anchor="middle" x="1616.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;15</text>
<text text-anchor="middle" x="1616.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_9 -->
<g id="node392" class="node">
<title>expert7_act_9</title>
<polygon fill="lightgreen" stroke="black" points="1948,-12161.21 1780,-12161.21 1780,-12108.21 1948,-12108.21 1948,-12161.21"/>
<text text-anchor="middle" x="1864" y="-12146.01" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1864" y="-12131.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1864" y="-12116.01" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert7_up_9&#45;&gt;expert7_act_9 -->
<g id="edge489" class="edge">
<title>expert7_up_9&#45;&gt;expert7_act_9</title>
<path fill="none" stroke="black" d="M1860.47,-12197.78C1860.94,-12189.54 1861.47,-12180.29 1861.97,-12171.48"/>
<polygon fill="black" stroke="black" points="1865.46,-12171.63 1862.54,-12161.45 1858.48,-12171.23 1865.46,-12171.63"/>
</g>
<!-- expert7_down_9 -->
<g id="node393" class="node">
<title>expert7_down_9</title>
<polygon fill="lightgreen" stroke="black" points="1980,-12071.21 1764,-12071.21 1764,-12018.21 1980,-12018.21 1980,-12071.21"/>
<text text-anchor="middle" x="1872" y="-12056.01" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1872" y="-12041.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1872" y="-12026.01" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert7_act_9&#45;&gt;expert7_down_9 -->
<g id="edge490" class="edge">
<title>expert7_act_9&#45;&gt;expert7_down_9</title>
<path fill="none" stroke="black" d="M1866.36,-12107.78C1867.11,-12099.54 1867.95,-12090.29 1868.75,-12081.48"/>
<polygon fill="black" stroke="black" points="1872.24,-12081.72 1869.66,-12071.45 1865.27,-12081.09 1872.24,-12081.72"/>
</g>
<!-- expert7_agg_9 -->
<g id="node394" class="node">
<title>expert7_agg_9</title>
<ellipse fill="lightgray" stroke="black" cx="1881" cy="-11943.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1881" y="-11955.03" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1881" y="-11940.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1881" y="-11925.03" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert7_down_9&#45;&gt;expert7_agg_9 -->
<g id="edge491" class="edge">
<title>expert7_down_9&#45;&gt;expert7_agg_9</title>
<path fill="none" stroke="black" d="M1874.34,-12017.96C1875.08,-12009.89 1875.91,-12000.71 1876.73,-11991.65"/>
<polygon fill="black" stroke="black" points="1880.23,-11991.8 1877.65,-11981.53 1873.26,-11991.17 1880.23,-11991.8"/>
</g>
<!-- expert7_agg_9&#45;&gt;expert_agg_9 -->
<g id="edge492" class="edge">
<title>expert7_agg_9&#45;&gt;expert_agg_9</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1823.07,-11911.53C1786.49,-11893.18 1737.66,-11871.12 1692,-11858.25 1561.63,-11821.52 1408.04,-11803.98 1298.06,-11795.65"/>
<polygon fill="purple" stroke="purple" points="1298.12,-11792.15 1287.89,-11794.9 1297.6,-11799.13 1298.12,-11792.15"/>
<text text-anchor="middle" x="1842.5" y="-11877.05" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;15</text>
<text text-anchor="middle" x="1842.5" y="-11862.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_9&#45;&gt;residual2_9 -->
<g id="edge493" class="edge">
<title>expert_agg_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1266.89,-11761.37C1382.27,-11736.38 1559.54,-11697.98 1678.29,-11672.26"/>
<polygon fill="black" stroke="black" points="1679.14,-11675.66 1688.17,-11670.12 1677.65,-11668.82 1679.14,-11675.66"/>
</g>
<!-- layer_out_9 -->
<g id="node397" class="node">
<title>layer_out_9</title>
<ellipse fill="lightgray" stroke="black" cx="1803" cy="-11516.78" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1803" y="-11528.08" font-family="Times,serif" font-size="14.00">Layer9_Output</text>
<text text-anchor="middle" x="1803" y="-11513.08" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1803" y="-11498.08" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual2_9&#45;&gt;layer_out_9 -->
<g id="edge495" class="edge">
<title>residual2_9&#45;&gt;layer_out_9</title>
<path fill="none" stroke="black" d="M1803,-11591.13C1803,-11582.22 1803,-11573.03 1803,-11564.28"/>
<polygon fill="black" stroke="black" points="1806.5,-11564.26 1803,-11554.26 1799.5,-11564.26 1806.5,-11564.26"/>
</g>
<!-- ln1_10 -->
<g id="node398" class="node">
<title>ln1_10</title>
<polygon fill="lightyellow" stroke="black" points="1703.5,-11392.3 1544.5,-11392.3 1544.5,-11339.3 1703.5,-11339.3 1703.5,-11392.3"/>
<text text-anchor="middle" x="1624" y="-11377.1" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1624" y="-11362.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1624" y="-11347.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- layer_out_9&#45;&gt;ln1_10 -->
<g id="edge496" class="edge">
<title>layer_out_9&#45;&gt;ln1_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1761.93,-11481.6C1732.12,-11456.79 1692.05,-11423.43 1662.78,-11399.07"/>
<polygon fill="red" stroke="red" points="1664.75,-11396.16 1654.83,-11392.45 1660.27,-11401.54 1664.75,-11396.16"/>
<text text-anchor="middle" x="1805.5" y="-11450.1" font-family="Times,serif" font-size="14.00">GPU&#45;71→GPU&#45;9</text>
<text text-anchor="middle" x="1805.5" y="-11435.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_10 -->
<g id="node404" class="node">
<title>residual1_10</title>
<polygon fill="lightpink" stroke="black" points="2086.69,-11032.3 1824.71,-11032.3 1757.31,-10926.3 2019.29,-10926.3 2086.69,-11032.3"/>
<text text-anchor="middle" x="1922" y="-10990.6" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1922" y="-10975.6" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1922" y="-10960.6" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- layer_out_9&#45;&gt;residual1_10 -->
<g id="edge504" class="edge">
<title>layer_out_9&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1859.53,-11484.06C1897.64,-11458.08 1941,-11417.39 1941,-11366.8 1941,-11366.8 1941,-11366.8 1941,-11094.8 1941,-11077.78 1938.93,-11059.52 1936.16,-11042.7"/>
<polygon fill="black" stroke="black" points="1939.53,-11041.68 1934.35,-11032.44 1932.64,-11042.89 1939.53,-11041.68"/>
</g>
<!-- mha_q_10 -->
<g id="node399" class="node">
<title>mha_q_10</title>
<polygon fill="lightcoral" stroke="black" points="1438.5,-11302.3 1219.5,-11302.3 1219.5,-11249.3 1438.5,-11249.3 1438.5,-11302.3"/>
<text text-anchor="middle" x="1329" y="-11287.1" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1329" y="-11272.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1329" y="-11257.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_q_10 -->
<g id="edge497" class="edge">
<title>ln1_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M1544.17,-11340.99C1507.2,-11329.96 1463,-11316.77 1424.29,-11305.23"/>
<polygon fill="black" stroke="black" points="1425.16,-11301.83 1414.58,-11302.33 1423.16,-11308.54 1425.16,-11301.83"/>
</g>
<!-- mha_k_10 -->
<g id="node400" class="node">
<title>mha_k_10</title>
<polygon fill="lightcoral" stroke="black" points="1675.5,-11302.3 1456.5,-11302.3 1456.5,-11249.3 1675.5,-11249.3 1675.5,-11302.3"/>
<text text-anchor="middle" x="1566" y="-11287.1" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1566" y="-11272.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1566" y="-11257.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_k_10 -->
<g id="edge498" class="edge">
<title>ln1_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M1606.91,-11338.87C1601.19,-11330.19 1594.72,-11320.37 1588.64,-11311.15"/>
<polygon fill="black" stroke="black" points="1591.39,-11308.96 1582.97,-11302.54 1585.55,-11312.82 1591.39,-11308.96"/>
</g>
<!-- mha_v_10 -->
<g id="node401" class="node">
<title>mha_v_10</title>
<polygon fill="lightcoral" stroke="black" points="1912.5,-11302.3 1693.5,-11302.3 1693.5,-11249.3 1912.5,-11249.3 1912.5,-11302.3"/>
<text text-anchor="middle" x="1803" y="-11287.1" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1803" y="-11272.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1803" y="-11257.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_v_10 -->
<g id="edge499" class="edge">
<title>ln1_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M1676.26,-11339.11C1696.84,-11328.99 1720.63,-11317.3 1742,-11306.79"/>
<polygon fill="black" stroke="black" points="1743.56,-11309.92 1750.99,-11302.37 1740.47,-11303.64 1743.56,-11309.92"/>
</g>
<!-- mha_attn_10 -->
<g id="node402" class="node">
<title>mha_attn_10</title>
<polygon fill="lightcoral" stroke="black" points="1701.5,-11212.3 1530.5,-11212.3 1530.5,-11159.3 1701.5,-11159.3 1701.5,-11212.3"/>
<text text-anchor="middle" x="1616" y="-11197.1" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1616" y="-11182.1" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1616" y="-11167.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge500" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1412.4,-11249.23C1446.89,-11238.65 1487.04,-11226.34 1522.52,-11215.46"/>
<polygon fill="black" stroke="black" points="1523.86,-11218.71 1532.39,-11212.44 1521.81,-11212.02 1523.86,-11218.71"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge501" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1580.73,-11248.87C1585.61,-11240.28 1591.13,-11230.57 1596.32,-11221.43"/>
<polygon fill="black" stroke="black" points="1599.48,-11222.97 1601.37,-11212.54 1593.39,-11219.51 1599.48,-11222.97"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge502" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1748.66,-11249.23C1727.05,-11239.06 1702.04,-11227.29 1679.59,-11216.72"/>
<polygon fill="black" stroke="black" points="1681.01,-11213.53 1670.47,-11212.44 1678.03,-11219.86 1681.01,-11213.53"/>
</g>
<!-- mha_out_10 -->
<g id="node403" class="node">
<title>mha_out_10</title>
<polygon fill="lightcoral" stroke="black" points="1846.5,-11122.3 1687.5,-11122.3 1687.5,-11069.3 1846.5,-11069.3 1846.5,-11122.3"/>
<text text-anchor="middle" x="1767" y="-11107.1" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1767" y="-11092.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1767" y="-11077.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge503" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M1660.08,-11159.11C1676.98,-11149.26 1696.44,-11137.92 1714.09,-11127.64"/>
<polygon fill="black" stroke="black" points="1716.25,-11130.43 1723.12,-11122.37 1712.72,-11124.38 1716.25,-11130.43"/>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge505" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1801.79,-11069.1C1814.21,-11059.92 1828.77,-11049.17 1843.38,-11038.38"/>
<polygon fill="black" stroke="black" points="1845.52,-11041.15 1851.49,-11032.39 1841.36,-11035.52 1845.52,-11041.15"/>
</g>
<!-- ln2_10 -->
<g id="node405" class="node">
<title>ln2_10</title>
<polygon fill="lightyellow" stroke="black" points="1566.5,-10889.3 1407.5,-10889.3 1407.5,-10836.3 1566.5,-10836.3 1566.5,-10889.3"/>
<text text-anchor="middle" x="1487" y="-10874.1" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1487" y="-10859.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1487" y="-10844.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge506" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M1763.72,-10936.64C1700.72,-10920.05 1630.54,-10901.58 1576.62,-10887.39"/>
<polygon fill="black" stroke="black" points="1577.31,-10883.95 1566.75,-10884.79 1575.52,-10890.72 1577.31,-10883.95"/>
</g>
<!-- residual2_10 -->
<g id="node440" class="node">
<title>residual2_10</title>
<polygon fill="lightpink" stroke="black" points="1523.69,-10073.35 1261.71,-10073.35 1194.31,-9967.35 1456.29,-9967.35 1523.69,-10073.35"/>
<text text-anchor="middle" x="1359" y="-10031.65" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1359" y="-10016.65" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1359" y="-10001.65" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge549" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M2038.51,-10956.29C2085.58,-10940.02 2129,-10911.95 2129,-10863.8 2129,-10863.8 2129,-10863.8 2129,-10162.35 2129,-10099.9 1732.08,-10054.44 1508.19,-10033.76"/>
<polygon fill="black" stroke="black" points="1508.27,-10030.26 1498,-10032.83 1507.63,-10037.23 1508.27,-10030.26"/>
</g>
<!-- gate_10 -->
<g id="node406" class="node">
<title>gate_10</title>
<polygon fill="orange" stroke="black" points="1269,-10799.3 1089,-10746.3 1269,-10693.3 1449,-10746.3 1269,-10799.3"/>
<text text-anchor="middle" x="1269" y="-10757.6" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1269" y="-10742.6" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1269" y="-10727.6" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln2_10&#45;&gt;gate_10 -->
<g id="edge507" class="edge">
<title>ln2_10&#45;&gt;gate_10</title>
<path fill="none" stroke="black" d="M1438.35,-10836.25C1410.02,-10821.37 1373.76,-10802.32 1342.06,-10785.67"/>
<polygon fill="black" stroke="black" points="1343.3,-10782.37 1332.82,-10780.82 1340.05,-10788.57 1343.3,-10782.37"/>
</g>
<!-- expert0_up_10 -->
<g id="node407" class="node">
<title>expert0_up_10</title>
<polygon fill="lightgreen" stroke="black" points="433,-10627.3 217,-10627.3 217,-10574.3 433,-10574.3 433,-10627.3"/>
<text text-anchor="middle" x="325" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="325" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="325" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- gate_10&#45;&gt;expert0_up_10 -->
<g id="edge508" class="edge">
<title>gate_10&#45;&gt;expert0_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1117.9,-10737.69C977.74,-10728.79 763.88,-10710.56 581,-10675.3 523.22,-10664.16 459.62,-10645.93 410.27,-10630.41"/>
<polygon fill="blue" stroke="blue" points="411.18,-10627.03 400.59,-10627.35 409.07,-10633.71 411.18,-10627.03"/>
<text text-anchor="middle" x="632.5" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="632.5" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;9</text>
</g>
<!-- expert1_up_10 -->
<g id="node411" class="node">
<title>expert1_up_10</title>
<polygon fill="lightgreen" stroke="black" points="671,-10627.3 455,-10627.3 455,-10574.3 671,-10574.3 671,-10627.3"/>
<text text-anchor="middle" x="563" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="563" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="563" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_10&#45;&gt;expert1_up_10 -->
<g id="edge513" class="edge">
<title>gate_10&#45;&gt;expert1_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1136.98,-10732.15C1039.92,-10721.01 905.24,-10702.47 789,-10675.3 738.95,-10663.6 684.09,-10645.88 640.96,-10630.77"/>
<polygon fill="blue" stroke="blue" points="641.98,-10627.42 631.38,-10627.39 639.65,-10634.02 641.98,-10627.42"/>
<text text-anchor="middle" x="845" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="845" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;10</text>
</g>
<!-- expert2_up_10 -->
<g id="node415" class="node">
<title>expert2_up_10</title>
<polygon fill="lightgreen" stroke="black" points="907,-10627.3 691,-10627.3 691,-10574.3 907,-10574.3 907,-10627.3"/>
<text text-anchor="middle" x="799" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="799" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="799" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_10&#45;&gt;expert2_up_10 -->
<g id="edge518" class="edge">
<title>gate_10&#45;&gt;expert2_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1168.15,-10722.96C1115.02,-10710.42 1049.02,-10693.64 991,-10675.3 950.23,-10662.41 905.57,-10645.49 869.6,-10631.14"/>
<polygon fill="blue" stroke="blue" points="870.75,-10627.83 860.17,-10627.35 868.14,-10634.32 870.75,-10627.83"/>
<text text-anchor="middle" x="1047" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1047" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;11</text>
</g>
<!-- expert3_up_10 -->
<g id="node419" class="node">
<title>expert3_up_10</title>
<polygon fill="lightgreen" stroke="black" points="1142,-10627.3 926,-10627.3 926,-10574.3 1142,-10574.3 1142,-10627.3"/>
<text text-anchor="middle" x="1034" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="1034" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1034" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_10&#45;&gt;expert3_up_10 -->
<g id="edge523" class="edge">
<title>gate_10&#45;&gt;expert3_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1210.81,-10710.34C1192.3,-10699.19 1171.77,-10686.76 1153,-10675.3 1130.23,-10661.4 1105.09,-10645.89 1083.8,-10632.72"/>
<polygon fill="blue" stroke="blue" points="1085.58,-10629.71 1075.24,-10627.42 1081.9,-10635.66 1085.58,-10629.71"/>
<text text-anchor="middle" x="1209" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1209" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;12</text>
</g>
<!-- expert4_up_10 -->
<g id="node423" class="node">
<title>expert4_up_10</title>
<polygon fill="lightgreen" stroke="black" points="1377,-10627.3 1161,-10627.3 1161,-10574.3 1377,-10574.3 1377,-10627.3"/>
<text text-anchor="middle" x="1269" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1269" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1269" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_10&#45;&gt;expert4_up_10 -->
<g id="edge528" class="edge">
<title>gate_10&#45;&gt;expert4_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1269,-10693.09C1269,-10674.81 1269,-10654.71 1269,-10638.03"/>
<polygon fill="blue" stroke="blue" points="1272.5,-10637.61 1269,-10627.61 1265.5,-10637.61 1272.5,-10637.61"/>
<text text-anchor="middle" x="1325" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1325" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;13</text>
</g>
<!-- expert5_up_10 -->
<g id="node427" class="node">
<title>expert5_up_10</title>
<polygon fill="lightgreen" stroke="black" points="1612,-10627.3 1396,-10627.3 1396,-10574.3 1612,-10574.3 1612,-10627.3"/>
<text text-anchor="middle" x="1504" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1504" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1504" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_10&#45;&gt;expert5_up_10 -->
<g id="edge533" class="edge">
<title>gate_10&#45;&gt;expert5_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1327.19,-10710.34C1345.7,-10699.19 1366.23,-10686.76 1385,-10675.3 1407.77,-10661.4 1432.91,-10645.89 1454.2,-10632.72"/>
<polygon fill="blue" stroke="blue" points="1456.1,-10635.66 1462.76,-10627.42 1452.42,-10629.71 1456.1,-10635.66"/>
<text text-anchor="middle" x="1486" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1486" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;14</text>
</g>
<!-- expert6_up_10 -->
<g id="node431" class="node">
<title>expert6_up_10</title>
<polygon fill="lightgreen" stroke="black" points="1849,-10627.3 1633,-10627.3 1633,-10574.3 1849,-10574.3 1849,-10627.3"/>
<text text-anchor="middle" x="1741" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1741" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1741" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_10&#45;&gt;expert6_up_10 -->
<g id="edge538" class="edge">
<title>gate_10&#45;&gt;expert6_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1369.45,-10722.81C1422.37,-10710.23 1488.14,-10693.45 1546,-10675.3 1587.2,-10662.38 1632.36,-10645.53 1668.84,-10631.23"/>
<polygon fill="blue" stroke="blue" points="1670.38,-10634.38 1678.4,-10627.46 1667.81,-10627.87 1670.38,-10634.38"/>
<text text-anchor="middle" x="1683" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1683" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;15</text>
</g>
<!-- expert7_up_10 -->
<g id="node435" class="node">
<title>expert7_up_10</title>
<polygon fill="lightgreen" stroke="black" points="2087,-10627.3 1871,-10627.3 1871,-10574.3 2087,-10574.3 2087,-10627.3"/>
<text text-anchor="middle" x="1979" y="-10612.1" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1979" y="-10597.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1979" y="-10582.1" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_10&#45;&gt;expert7_up_10 -->
<g id="edge543" class="edge">
<title>gate_10&#45;&gt;expert7_up_10</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1399.27,-10731.59C1495.06,-10720.17 1628.04,-10701.52 1743,-10675.3 1795.13,-10663.41 1852.43,-10645.68 1897.51,-10630.61"/>
<polygon fill="blue" stroke="blue" points="1898.87,-10633.85 1907.23,-10627.34 1896.64,-10627.21 1898.87,-10633.85"/>
<text text-anchor="middle" x="1903" y="-10664.1" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1903" y="-10649.1" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;16</text>
</g>
<!-- expert0_act_10 -->
<g id="node408" class="node">
<title>expert0_act_10</title>
<polygon fill="lightgreen" stroke="black" points="409,-10537.3 241,-10537.3 241,-10484.3 409,-10484.3 409,-10537.3"/>
<text text-anchor="middle" x="325" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="325" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="325" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert0_up_10&#45;&gt;expert0_act_10 -->
<g id="edge509" class="edge">
<title>expert0_up_10&#45;&gt;expert0_act_10</title>
<path fill="none" stroke="black" d="M325,-10573.87C325,-10565.64 325,-10556.38 325,-10547.58"/>
<polygon fill="black" stroke="black" points="328.5,-10547.54 325,-10537.54 321.5,-10547.54 328.5,-10547.54"/>
</g>
<!-- expert0_down_10 -->
<g id="node409" class="node">
<title>expert0_down_10</title>
<polygon fill="lightgreen" stroke="black" points="432,-10447.3 216,-10447.3 216,-10394.3 432,-10394.3 432,-10447.3"/>
<text text-anchor="middle" x="324" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="324" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="324" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert0_act_10&#45;&gt;expert0_down_10 -->
<g id="edge510" class="edge">
<title>expert0_act_10&#45;&gt;expert0_down_10</title>
<path fill="none" stroke="black" d="M324.71,-10483.87C324.61,-10475.64 324.51,-10466.38 324.41,-10457.58"/>
<polygon fill="black" stroke="black" points="327.91,-10457.5 324.29,-10447.54 320.91,-10457.58 327.91,-10457.5"/>
</g>
<!-- expert0_agg_10 -->
<g id="node410" class="node">
<title>expert0_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="297" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="297" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="297" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="297" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- expert0_down_10&#45;&gt;expert0_agg_10 -->
<g id="edge511" class="edge">
<title>expert0_down_10&#45;&gt;expert0_agg_10</title>
<path fill="none" stroke="black" d="M316.98,-10394.05C314.73,-10385.81 312.16,-10376.41 309.64,-10367.16"/>
<polygon fill="black" stroke="black" points="312.94,-10365.97 306.94,-10357.25 306.19,-10367.81 312.94,-10365.97"/>
</g>
<!-- expert_agg_10 -->
<g id="node439" class="node">
<title>expert_agg_10</title>
<polygon fill="gold" stroke="black" points="1433.69,-10216.35 1171.71,-10216.35 1104.31,-10110.35 1366.29,-10110.35 1433.69,-10216.35"/>
<text text-anchor="middle" x="1269" y="-10174.65" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1269" y="-10159.65" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1269" y="-10144.65" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert0_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge512" class="edge">
<title>expert0_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M357.1,-10288.13C396.66,-10269.37 450.16,-10246.68 500,-10234.35 714.88,-10181.18 972.5,-10167.47 1128.32,-10164.45"/>
<polygon fill="purple" stroke="purple" points="1128.5,-10167.94 1138.44,-10164.26 1128.37,-10160.95 1128.5,-10167.94"/>
<text text-anchor="middle" x="571.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;16</text>
<text text-anchor="middle" x="571.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_10 -->
<g id="node412" class="node">
<title>expert1_act_10</title>
<polygon fill="lightgreen" stroke="black" points="644,-10537.3 476,-10537.3 476,-10484.3 644,-10484.3 644,-10537.3"/>
<text text-anchor="middle" x="560" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="560" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="560" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert1_up_10&#45;&gt;expert1_act_10 -->
<g id="edge514" class="edge">
<title>expert1_up_10&#45;&gt;expert1_act_10</title>
<path fill="none" stroke="black" d="M562.12,-10573.87C561.84,-10565.64 561.52,-10556.38 561.22,-10547.58"/>
<polygon fill="black" stroke="black" points="564.72,-10547.42 560.88,-10537.54 557.72,-10547.65 564.72,-10547.42"/>
</g>
<!-- expert1_down_10 -->
<g id="node413" class="node">
<title>expert1_down_10</title>
<polygon fill="lightgreen" stroke="black" points="666,-10447.3 450,-10447.3 450,-10394.3 666,-10394.3 666,-10447.3"/>
<text text-anchor="middle" x="558" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="558" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="558" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert1_act_10&#45;&gt;expert1_down_10 -->
<g id="edge515" class="edge">
<title>expert1_act_10&#45;&gt;expert1_down_10</title>
<path fill="none" stroke="black" d="M559.41,-10483.87C559.22,-10475.64 559.01,-10466.38 558.81,-10457.58"/>
<polygon fill="black" stroke="black" points="562.31,-10457.46 558.59,-10447.54 555.31,-10457.62 562.31,-10457.46"/>
</g>
<!-- expert1_agg_10 -->
<g id="node414" class="node">
<title>expert1_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="540" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="540" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="540" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="540" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert1_down_10&#45;&gt;expert1_agg_10 -->
<g id="edge516" class="edge">
<title>expert1_down_10&#45;&gt;expert1_agg_10</title>
<path fill="none" stroke="black" d="M553.32,-10394.05C551.82,-10385.81 550.11,-10376.41 548.43,-10367.16"/>
<polygon fill="black" stroke="black" points="551.86,-10366.46 546.62,-10357.25 544.97,-10367.71 551.86,-10366.46"/>
</g>
<!-- expert1_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge517" class="edge">
<title>expert1_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M597.69,-10287.39C633.82,-10269.07 681.93,-10247.13 727,-10234.35 861.65,-10196.15 1021.1,-10178.73 1132.05,-10170.83"/>
<polygon fill="purple" stroke="purple" points="1132.56,-10174.3 1142.29,-10170.12 1132.07,-10167.32 1132.56,-10174.3"/>
<text text-anchor="middle" x="798.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;16</text>
<text text-anchor="middle" x="798.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_10 -->
<g id="node416" class="node">
<title>expert2_act_10</title>
<polygon fill="lightgreen" stroke="black" points="879,-10537.3 711,-10537.3 711,-10484.3 879,-10484.3 879,-10537.3"/>
<text text-anchor="middle" x="795" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="795" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="795" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert2_up_10&#45;&gt;expert2_act_10 -->
<g id="edge519" class="edge">
<title>expert2_up_10&#45;&gt;expert2_act_10</title>
<path fill="none" stroke="black" d="M797.82,-10573.87C797.45,-10565.64 797.03,-10556.38 796.63,-10547.58"/>
<polygon fill="black" stroke="black" points="800.12,-10547.37 796.17,-10537.54 793.13,-10547.69 800.12,-10547.37"/>
</g>
<!-- expert2_down_10 -->
<g id="node417" class="node">
<title>expert2_down_10</title>
<polygon fill="lightgreen" stroke="black" points="900,-10447.3 684,-10447.3 684,-10394.3 900,-10394.3 900,-10447.3"/>
<text text-anchor="middle" x="792" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="792" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="792" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert2_act_10&#45;&gt;expert2_down_10 -->
<g id="edge520" class="edge">
<title>expert2_act_10&#45;&gt;expert2_down_10</title>
<path fill="none" stroke="black" d="M794.12,-10483.87C793.84,-10475.64 793.52,-10466.38 793.22,-10457.58"/>
<polygon fill="black" stroke="black" points="796.72,-10457.42 792.88,-10447.54 789.72,-10457.65 796.72,-10457.42"/>
</g>
<!-- expert2_agg_10 -->
<g id="node418" class="node">
<title>expert2_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="783" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="783" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="783" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="783" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert2_down_10&#45;&gt;expert2_agg_10 -->
<g id="edge521" class="edge">
<title>expert2_down_10&#45;&gt;expert2_agg_10</title>
<path fill="none" stroke="black" d="M789.66,-10394.05C788.92,-10385.98 788.09,-10376.8 787.27,-10367.74"/>
<polygon fill="black" stroke="black" points="790.74,-10367.26 786.35,-10357.62 783.77,-10367.9 790.74,-10367.26"/>
</g>
<!-- expert2_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge522" class="edge">
<title>expert2_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M832.87,-10286.09C861.68,-10268.47 899.22,-10247.69 935,-10234.35 1000.21,-10210.03 1075.9,-10193.29 1138.72,-10182.3"/>
<polygon fill="purple" stroke="purple" points="1139.42,-10185.73 1148.69,-10180.58 1138.24,-10178.83 1139.42,-10185.73"/>
<text text-anchor="middle" x="1006.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;16</text>
<text text-anchor="middle" x="1006.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_10 -->
<g id="node420" class="node">
<title>expert3_act_10</title>
<polygon fill="lightgreen" stroke="black" points="1114,-10537.3 946,-10537.3 946,-10484.3 1114,-10484.3 1114,-10537.3"/>
<text text-anchor="middle" x="1030" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="1030" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1030" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert3_up_10&#45;&gt;expert3_act_10 -->
<g id="edge524" class="edge">
<title>expert3_up_10&#45;&gt;expert3_act_10</title>
<path fill="none" stroke="black" d="M1032.82,-10573.87C1032.45,-10565.64 1032.03,-10556.38 1031.63,-10547.58"/>
<polygon fill="black" stroke="black" points="1035.12,-10547.37 1031.17,-10537.54 1028.13,-10547.69 1035.12,-10547.37"/>
</g>
<!-- expert3_down_10 -->
<g id="node421" class="node">
<title>expert3_down_10</title>
<polygon fill="lightgreen" stroke="black" points="1136,-10447.3 920,-10447.3 920,-10394.3 1136,-10394.3 1136,-10447.3"/>
<text text-anchor="middle" x="1028" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="1028" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1028" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert3_act_10&#45;&gt;expert3_down_10 -->
<g id="edge525" class="edge">
<title>expert3_act_10&#45;&gt;expert3_down_10</title>
<path fill="none" stroke="black" d="M1029.41,-10483.87C1029.22,-10475.64 1029.01,-10466.38 1028.81,-10457.58"/>
<polygon fill="black" stroke="black" points="1032.31,-10457.46 1028.59,-10447.54 1025.31,-10457.62 1032.31,-10457.46"/>
</g>
<!-- expert3_agg_10 -->
<g id="node422" class="node">
<title>expert3_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="1026" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1026" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="1026" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1026" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert3_down_10&#45;&gt;expert3_agg_10 -->
<g id="edge526" class="edge">
<title>expert3_down_10&#45;&gt;expert3_agg_10</title>
<path fill="none" stroke="black" d="M1027.48,-10394.05C1027.32,-10385.98 1027.13,-10376.8 1026.95,-10367.74"/>
<polygon fill="black" stroke="black" points="1030.44,-10367.55 1026.74,-10357.62 1023.45,-10367.69 1030.44,-10367.55"/>
</g>
<!-- expert3_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge527" class="edge">
<title>expert3_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1060.99,-10283.8C1078.4,-10267.52 1100.32,-10248.65 1122,-10234.35 1133.2,-10226.96 1145.31,-10219.9 1157.59,-10213.31"/>
<polygon fill="purple" stroke="purple" points="1159.34,-10216.35 1166.56,-10208.59 1156.08,-10210.15 1159.34,-10216.35"/>
<text text-anchor="middle" x="1193.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;16</text>
<text text-anchor="middle" x="1193.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_10 -->
<g id="node424" class="node">
<title>expert4_act_10</title>
<polygon fill="lightgreen" stroke="black" points="1353,-10537.3 1185,-10537.3 1185,-10484.3 1353,-10484.3 1353,-10537.3"/>
<text text-anchor="middle" x="1269" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1269" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1269" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert4_up_10&#45;&gt;expert4_act_10 -->
<g id="edge529" class="edge">
<title>expert4_up_10&#45;&gt;expert4_act_10</title>
<path fill="none" stroke="black" d="M1269,-10573.87C1269,-10565.64 1269,-10556.38 1269,-10547.58"/>
<polygon fill="black" stroke="black" points="1272.5,-10547.54 1269,-10537.54 1265.5,-10547.54 1272.5,-10547.54"/>
</g>
<!-- expert4_down_10 -->
<g id="node425" class="node">
<title>expert4_down_10</title>
<polygon fill="lightgreen" stroke="black" points="1377,-10447.3 1161,-10447.3 1161,-10394.3 1377,-10394.3 1377,-10447.3"/>
<text text-anchor="middle" x="1269" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1269" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1269" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert4_act_10&#45;&gt;expert4_down_10 -->
<g id="edge530" class="edge">
<title>expert4_act_10&#45;&gt;expert4_down_10</title>
<path fill="none" stroke="black" d="M1269,-10483.87C1269,-10475.64 1269,-10466.38 1269,-10457.58"/>
<polygon fill="black" stroke="black" points="1272.5,-10457.54 1269,-10447.54 1265.5,-10457.54 1272.5,-10457.54"/>
</g>
<!-- expert4_agg_10 -->
<g id="node426" class="node">
<title>expert4_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="1269" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1269" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1269" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1269" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert4_down_10&#45;&gt;expert4_agg_10 -->
<g id="edge531" class="edge">
<title>expert4_down_10&#45;&gt;expert4_agg_10</title>
<path fill="none" stroke="black" d="M1269,-10394.05C1269,-10385.98 1269,-10376.8 1269,-10367.74"/>
<polygon fill="black" stroke="black" points="1272.5,-10367.62 1269,-10357.62 1265.5,-10367.62 1272.5,-10367.62"/>
</g>
<!-- expert4_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge532" class="edge">
<title>expert4_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1269,-10282.21C1269,-10265.58 1269,-10245.42 1269,-10226.52"/>
<polygon fill="purple" stroke="purple" points="1272.5,-10226.48 1269,-10216.48 1265.5,-10226.48 1272.5,-10226.48"/>
<text text-anchor="middle" x="1340.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;16</text>
<text text-anchor="middle" x="1340.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_10 -->
<g id="node428" class="node">
<title>expert5_act_10</title>
<polygon fill="lightgreen" stroke="black" points="1590,-10537.3 1422,-10537.3 1422,-10484.3 1590,-10484.3 1590,-10537.3"/>
<text text-anchor="middle" x="1506" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1506" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1506" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert5_up_10&#45;&gt;expert5_act_10 -->
<g id="edge534" class="edge">
<title>expert5_up_10&#45;&gt;expert5_act_10</title>
<path fill="none" stroke="black" d="M1504.59,-10573.87C1504.78,-10565.64 1504.99,-10556.38 1505.19,-10547.58"/>
<polygon fill="black" stroke="black" points="1508.69,-10547.62 1505.41,-10537.54 1501.69,-10547.46 1508.69,-10547.62"/>
</g>
<!-- expert5_down_10 -->
<g id="node429" class="node">
<title>expert5_down_10</title>
<polygon fill="lightgreen" stroke="black" points="1615,-10447.3 1399,-10447.3 1399,-10394.3 1615,-10394.3 1615,-10447.3"/>
<text text-anchor="middle" x="1507" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1507" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1507" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert5_act_10&#45;&gt;expert5_down_10 -->
<g id="edge535" class="edge">
<title>expert5_act_10&#45;&gt;expert5_down_10</title>
<path fill="none" stroke="black" d="M1506.29,-10483.87C1506.39,-10475.64 1506.49,-10466.38 1506.59,-10457.58"/>
<polygon fill="black" stroke="black" points="1510.09,-10457.58 1506.71,-10447.54 1503.09,-10457.5 1510.09,-10457.58"/>
</g>
<!-- expert5_agg_10 -->
<g id="node430" class="node">
<title>expert5_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="1512" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1512" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1512" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1512" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert5_down_10&#45;&gt;expert5_agg_10 -->
<g id="edge536" class="edge">
<title>expert5_down_10&#45;&gt;expert5_agg_10</title>
<path fill="none" stroke="black" d="M1508.3,-10394.05C1508.71,-10385.98 1509.17,-10376.8 1509.63,-10367.74"/>
<polygon fill="black" stroke="black" points="1513.13,-10367.78 1510.14,-10357.62 1506.14,-10367.43 1513.13,-10367.78"/>
</g>
<!-- expert5_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge537" class="edge">
<title>expert5_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1477.01,-10283.8C1459.6,-10267.52 1437.68,-10248.65 1416,-10234.35 1409.36,-10229.97 1402.41,-10225.71 1395.29,-10221.59"/>
<polygon fill="purple" stroke="purple" points="1396.62,-10218.33 1386.2,-10216.46 1393.18,-10224.42 1396.62,-10218.33"/>
<text text-anchor="middle" x="1526.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;16</text>
<text text-anchor="middle" x="1526.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_10 -->
<g id="node432" class="node">
<title>expert6_act_10</title>
<polygon fill="lightgreen" stroke="black" points="1827,-10537.3 1659,-10537.3 1659,-10484.3 1827,-10484.3 1827,-10537.3"/>
<text text-anchor="middle" x="1743" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1743" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1743" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert6_up_10&#45;&gt;expert6_act_10 -->
<g id="edge539" class="edge">
<title>expert6_up_10&#45;&gt;expert6_act_10</title>
<path fill="none" stroke="black" d="M1741.59,-10573.87C1741.78,-10565.64 1741.99,-10556.38 1742.19,-10547.58"/>
<polygon fill="black" stroke="black" points="1745.69,-10547.62 1742.41,-10537.54 1738.69,-10547.46 1745.69,-10547.62"/>
</g>
<!-- expert6_down_10 -->
<g id="node433" class="node">
<title>expert6_down_10</title>
<polygon fill="lightgreen" stroke="black" points="1854,-10447.3 1638,-10447.3 1638,-10394.3 1854,-10394.3 1854,-10447.3"/>
<text text-anchor="middle" x="1746" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1746" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1746" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert6_act_10&#45;&gt;expert6_down_10 -->
<g id="edge540" class="edge">
<title>expert6_act_10&#45;&gt;expert6_down_10</title>
<path fill="none" stroke="black" d="M1743.88,-10483.87C1744.16,-10475.64 1744.48,-10466.38 1744.78,-10457.58"/>
<polygon fill="black" stroke="black" points="1748.28,-10457.65 1745.12,-10447.54 1741.28,-10457.42 1748.28,-10457.65"/>
</g>
<!-- expert6_agg_10 -->
<g id="node434" class="node">
<title>expert6_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="1755" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1755" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1755" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1755" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert6_down_10&#45;&gt;expert6_agg_10 -->
<g id="edge541" class="edge">
<title>expert6_down_10&#45;&gt;expert6_agg_10</title>
<path fill="none" stroke="black" d="M1748.34,-10394.05C1749.08,-10385.98 1749.91,-10376.8 1750.73,-10367.74"/>
<polygon fill="black" stroke="black" points="1754.23,-10367.9 1751.65,-10357.62 1747.26,-10367.26 1754.23,-10367.9"/>
</g>
<!-- expert6_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge542" class="edge">
<title>expert6_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1704.78,-10286.11C1675.76,-10268.5 1637.98,-10247.72 1602,-10234.35 1545.58,-10213.38 1481.33,-10198.01 1424.41,-10187.11"/>
<polygon fill="purple" stroke="purple" points="1424.72,-10183.61 1414.24,-10185.2 1423.42,-10190.49 1424.72,-10183.61"/>
<text text-anchor="middle" x="1733.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;16</text>
<text text-anchor="middle" x="1733.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_10 -->
<g id="node436" class="node">
<title>expert7_act_10</title>
<polygon fill="lightgreen" stroke="black" points="2067,-10537.3 1899,-10537.3 1899,-10484.3 2067,-10484.3 2067,-10537.3"/>
<text text-anchor="middle" x="1983" y="-10522.1" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1983" y="-10507.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1983" y="-10492.1" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert7_up_10&#45;&gt;expert7_act_10 -->
<g id="edge544" class="edge">
<title>expert7_up_10&#45;&gt;expert7_act_10</title>
<path fill="none" stroke="black" d="M1980.18,-10573.87C1980.55,-10565.64 1980.97,-10556.38 1981.37,-10547.58"/>
<polygon fill="black" stroke="black" points="1984.87,-10547.69 1981.83,-10537.54 1977.88,-10547.37 1984.87,-10547.69"/>
</g>
<!-- expert7_down_10 -->
<g id="node437" class="node">
<title>expert7_down_10</title>
<polygon fill="lightgreen" stroke="black" points="2092,-10447.3 1876,-10447.3 1876,-10394.3 2092,-10394.3 2092,-10447.3"/>
<text text-anchor="middle" x="1984" y="-10432.1" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1984" y="-10417.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1984" y="-10402.1" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert7_act_10&#45;&gt;expert7_down_10 -->
<g id="edge545" class="edge">
<title>expert7_act_10&#45;&gt;expert7_down_10</title>
<path fill="none" stroke="black" d="M1983.29,-10483.87C1983.39,-10475.64 1983.49,-10466.38 1983.59,-10457.58"/>
<polygon fill="black" stroke="black" points="1987.09,-10457.58 1983.71,-10447.54 1980.09,-10457.5 1987.09,-10457.58"/>
</g>
<!-- expert7_agg_10 -->
<g id="node438" class="node">
<title>expert7_agg_10</title>
<ellipse fill="lightgray" stroke="black" cx="1998" cy="-10319.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1998" y="-10331.12" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1998" y="-10316.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1998" y="-10301.12" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert7_down_10&#45;&gt;expert7_agg_10 -->
<g id="edge546" class="edge">
<title>expert7_down_10&#45;&gt;expert7_agg_10</title>
<path fill="none" stroke="black" d="M1987.64,-10394.05C1988.78,-10385.98 1990.08,-10376.8 1991.36,-10367.74"/>
<polygon fill="black" stroke="black" points="1994.86,-10368.01 1992.8,-10357.62 1987.93,-10367.03 1994.86,-10368.01"/>
</g>
<!-- expert7_agg_10&#45;&gt;expert_agg_10 -->
<g id="edge547" class="edge">
<title>expert7_agg_10&#45;&gt;expert_agg_10</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1940.07,-10287.62C1903.49,-10269.27 1854.66,-10247.21 1809,-10234.35 1678.63,-10197.62 1525.04,-10180.07 1415.06,-10171.75"/>
<polygon fill="purple" stroke="purple" points="1415.12,-10168.24 1404.89,-10170.99 1414.6,-10175.22 1415.12,-10168.24"/>
<text text-anchor="middle" x="1959.5" y="-10253.15" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;16</text>
<text text-anchor="middle" x="1959.5" y="-10238.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_10&#45;&gt;residual2_10 -->
<g id="edge548" class="edge">
<title>expert_agg_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1302.26,-10110.24C1308.08,-10101.11 1314.19,-10091.54 1320.16,-10082.2"/>
<polygon fill="black" stroke="black" points="1323.15,-10084.02 1325.58,-10073.71 1317.25,-10080.25 1323.15,-10084.02"/>
</g>
<!-- layer_out_10 -->
<g id="node441" class="node">
<title>layer_out_10</title>
<ellipse fill="lightgray" stroke="black" cx="1359" cy="-9892.87" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1359" y="-9904.17" font-family="Times,serif" font-size="14.00">Layer10_Output</text>
<text text-anchor="middle" x="1359" y="-9889.17" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1359" y="-9874.17" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- residual2_10&#45;&gt;layer_out_10 -->
<g id="edge550" class="edge">
<title>residual2_10&#45;&gt;layer_out_10</title>
<path fill="none" stroke="black" d="M1359,-9967.22C1359,-9958.32 1359,-9949.12 1359,-9940.37"/>
<polygon fill="black" stroke="black" points="1362.5,-9940.36 1359,-9930.36 1355.5,-9940.36 1362.5,-9940.36"/>
</g>
<!-- ln1_11 -->
<g id="node442" class="node">
<title>ln1_11</title>
<polygon fill="lightyellow" stroke="black" points="1229.5,-9768.39 1070.5,-9768.39 1070.5,-9715.39 1229.5,-9715.39 1229.5,-9768.39"/>
<text text-anchor="middle" x="1150" y="-9753.19" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1150" y="-9738.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1150" y="-9723.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- layer_out_10&#45;&gt;ln1_11 -->
<g id="edge551" class="edge">
<title>layer_out_10&#45;&gt;ln1_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1312.36,-9858.62C1277.09,-9833.48 1228.98,-9799.19 1194.3,-9774.47"/>
<polygon fill="red" stroke="red" points="1195.96,-9771.36 1185.79,-9768.4 1191.9,-9777.06 1195.96,-9771.36"/>
<text text-anchor="middle" x="1350.5" y="-9826.19" font-family="Times,serif" font-size="14.00">GPU&#45;79→GPU&#45;10</text>
<text text-anchor="middle" x="1350.5" y="-9811.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_11 -->
<g id="node448" class="node">
<title>residual1_11</title>
<polygon fill="lightpink" stroke="black" points="1587.69,-9408.39 1325.71,-9408.39 1258.31,-9302.39 1520.29,-9302.39 1587.69,-9408.39"/>
<text text-anchor="middle" x="1423" y="-9366.69" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1423" y="-9351.69" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1423" y="-9336.69" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- layer_out_10&#45;&gt;residual1_11 -->
<g id="edge559" class="edge">
<title>layer_out_10&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1405.58,-9858.68C1412.97,-9852.15 1420.1,-9844.96 1426,-9837.39 1454.48,-9800.85 1470,-9789.22 1470,-9742.89 1470,-9742.89 1470,-9742.89 1470,-9470.89 1470,-9453.02 1465.04,-9434.67 1458.34,-9418.05"/>
<polygon fill="black" stroke="black" points="1461.39,-9416.28 1454.22,-9408.48 1454.96,-9419.05 1461.39,-9416.28"/>
</g>
<!-- mha_q_11 -->
<g id="node443" class="node">
<title>mha_q_11</title>
<polygon fill="lightcoral" stroke="black" points="967.5,-9678.39 748.5,-9678.39 748.5,-9625.39 967.5,-9625.39 967.5,-9678.39"/>
<text text-anchor="middle" x="858" y="-9663.19" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="858" y="-9648.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="858" y="-9633.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_q_11 -->
<g id="edge552" class="edge">
<title>ln1_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M1070.21,-9716.85C1033.94,-9705.92 990.75,-9692.9 952.83,-9681.47"/>
<polygon fill="black" stroke="black" points="953.39,-9677.98 942.8,-9678.45 951.37,-9684.69 953.39,-9677.98"/>
</g>
<!-- mha_k_11 -->
<g id="node444" class="node">
<title>mha_k_11</title>
<polygon fill="lightcoral" stroke="black" points="1204.5,-9678.39 985.5,-9678.39 985.5,-9625.39 1204.5,-9625.39 1204.5,-9678.39"/>
<text text-anchor="middle" x="1095" y="-9663.19" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1095" y="-9648.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1095" y="-9633.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_k_11 -->
<g id="edge553" class="edge">
<title>ln1_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M1133.8,-9714.97C1128.37,-9706.28 1122.23,-9696.46 1116.47,-9687.24"/>
<polygon fill="black" stroke="black" points="1119.36,-9685.26 1111.09,-9678.63 1113.42,-9688.97 1119.36,-9685.26"/>
</g>
<!-- mha_v_11 -->
<g id="node445" class="node">
<title>mha_v_11</title>
<polygon fill="lightcoral" stroke="black" points="1441.5,-9678.39 1222.5,-9678.39 1222.5,-9625.39 1441.5,-9625.39 1441.5,-9678.39"/>
<text text-anchor="middle" x="1332" y="-9663.19" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1332" y="-9648.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1332" y="-9633.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_v_11 -->
<g id="edge554" class="edge">
<title>ln1_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M1203.13,-9715.2C1224.06,-9705.08 1248.25,-9693.39 1269.97,-9682.88"/>
<polygon fill="black" stroke="black" points="1271.64,-9685.97 1279.12,-9678.46 1268.59,-9679.66 1271.64,-9685.97"/>
</g>
<!-- mha_attn_11 -->
<g id="node446" class="node">
<title>mha_attn_11</title>
<polygon fill="lightcoral" stroke="black" points="1230.5,-9588.39 1059.5,-9588.39 1059.5,-9535.39 1230.5,-9535.39 1230.5,-9588.39"/>
<text text-anchor="middle" x="1145" y="-9573.19" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1145" y="-9558.19" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1145" y="-9543.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge555" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M941.4,-9625.32C975.89,-9614.75 1016.04,-9602.44 1051.52,-9591.56"/>
<polygon fill="black" stroke="black" points="1052.86,-9594.81 1061.39,-9588.53 1050.81,-9588.11 1052.86,-9594.81"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge556" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1109.73,-9624.97C1114.61,-9616.37 1120.13,-9606.67 1125.32,-9597.53"/>
<polygon fill="black" stroke="black" points="1128.48,-9599.06 1130.37,-9588.63 1122.39,-9595.6 1128.48,-9599.06"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge557" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1277.66,-9625.32C1256.05,-9615.15 1231.04,-9603.38 1208.59,-9592.82"/>
<polygon fill="black" stroke="black" points="1210.01,-9589.62 1199.47,-9588.53 1207.03,-9595.95 1210.01,-9589.62"/>
</g>
<!-- mha_out_11 -->
<g id="node447" class="node">
<title>mha_out_11</title>
<polygon fill="lightcoral" stroke="black" points="1375.5,-9498.39 1216.5,-9498.39 1216.5,-9445.39 1375.5,-9445.39 1375.5,-9498.39"/>
<text text-anchor="middle" x="1296" y="-9483.19" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1296" y="-9468.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1296" y="-9453.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge558" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M1189.08,-9535.2C1205.98,-9525.35 1225.44,-9514.01 1243.09,-9503.73"/>
<polygon fill="black" stroke="black" points="1245.25,-9506.52 1252.12,-9498.46 1241.72,-9500.47 1245.25,-9506.52"/>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge560" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1324.5,-9445.2C1334.4,-9436.27 1345.95,-9425.86 1357.58,-9415.37"/>
<polygon fill="black" stroke="black" points="1360.14,-9417.78 1365.22,-9408.48 1355.45,-9412.58 1360.14,-9417.78"/>
</g>
<!-- ln2_11 -->
<g id="node449" class="node">
<title>ln2_11</title>
<polygon fill="lightyellow" stroke="black" points="1453.5,-9265.39 1294.5,-9265.39 1294.5,-9212.39 1453.5,-9212.39 1453.5,-9265.39"/>
<text text-anchor="middle" x="1374" y="-9250.19" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1374" y="-9235.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1374" y="-9220.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge561" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M1400.65,-9302.17C1396.69,-9292.91 1392.65,-9283.48 1388.96,-9274.85"/>
<polygon fill="black" stroke="black" points="1392.11,-9273.31 1384.96,-9265.5 1385.67,-9276.07 1392.11,-9273.31"/>
</g>
<!-- residual2_11 -->
<g id="node484" class="node">
<title>residual2_11</title>
<polygon fill="lightpink" stroke="black" points="2122.69,-8449.44 1860.71,-8449.44 1793.31,-8343.44 2055.29,-8343.44 2122.69,-8449.44"/>
<text text-anchor="middle" x="1958" y="-8407.74" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1958" y="-8392.74" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1958" y="-8377.74" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge604" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1548.65,-9346.79C1753.05,-9332.72 2135,-9298.58 2135,-9239.89 2135,-9239.89 2135,-9239.89 2135,-8538.44 2135,-8504.11 2114.38,-8476.79 2087.22,-8455.69"/>
<polygon fill="black" stroke="black" points="2089.12,-8452.75 2079,-8449.63 2084.96,-8458.38 2089.12,-8452.75"/>
</g>
<!-- gate_11 -->
<g id="node450" class="node">
<title>gate_11</title>
<polygon fill="orange" stroke="black" points="1275,-9175.39 1095,-9122.39 1275,-9069.39 1455,-9122.39 1275,-9175.39"/>
<text text-anchor="middle" x="1275" y="-9133.69" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1275" y="-9118.69" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1275" y="-9103.69" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln2_11&#45;&gt;gate_11 -->
<g id="edge562" class="edge">
<title>ln2_11&#45;&gt;gate_11</title>
<path fill="none" stroke="black" d="M1351.78,-9212.2C1341.77,-9200.62 1329.6,-9186.55 1317.93,-9173.04"/>
<polygon fill="black" stroke="black" points="1320.32,-9170.46 1311.13,-9165.18 1315.02,-9175.04 1320.32,-9170.46"/>
</g>
<!-- expert0_up_11 -->
<g id="node451" class="node">
<title>expert0_up_11</title>
<polygon fill="lightgreen" stroke="black" points="437,-9003.39 221,-9003.39 221,-8950.39 437,-8950.39 437,-9003.39"/>
<text text-anchor="middle" x="329" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="329" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="329" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- gate_11&#45;&gt;expert0_up_11 -->
<g id="edge563" class="edge">
<title>gate_11&#45;&gt;expert0_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1117.14,-9115.83C970.48,-9108.35 746.63,-9091.05 556,-9051.39 504.53,-9040.69 448.31,-9022.53 404.7,-9006.95"/>
<polygon fill="blue" stroke="blue" points="405.62,-9003.56 395.02,-9003.46 403.24,-9010.14 405.62,-9003.56"/>
<text text-anchor="middle" x="616.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="616.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;10</text>
</g>
<!-- expert1_up_11 -->
<g id="node455" class="node">
<title>expert1_up_11</title>
<polygon fill="lightgreen" stroke="black" points="675,-9003.39 459,-9003.39 459,-8950.39 675,-8950.39 675,-9003.39"/>
<text text-anchor="middle" x="567" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="567" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="567" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_11&#45;&gt;expert1_up_11 -->
<g id="edge568" class="edge">
<title>gate_11&#45;&gt;expert1_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1137.77,-9109.78C1036.28,-9099.36 895.24,-9081.06 774,-9051.39 727.9,-9040.11 677.7,-9022.43 638.28,-9007.23"/>
<polygon fill="blue" stroke="blue" points="639.09,-9003.79 628.5,-9003.43 636.55,-9010.32 639.09,-9003.79"/>
<text text-anchor="middle" x="834.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="834.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;11</text>
</g>
<!-- expert2_up_11 -->
<g id="node459" class="node">
<title>expert2_up_11</title>
<polygon fill="lightgreen" stroke="black" points="910,-9003.39 694,-9003.39 694,-8950.39 910,-8950.39 910,-9003.39"/>
<text text-anchor="middle" x="802" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="802" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="802" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_11&#45;&gt;expert2_up_11 -->
<g id="edge573" class="edge">
<title>gate_11&#45;&gt;expert2_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1167.96,-9100.77C1110.68,-9088.61 1039.29,-9071.63 977,-9051.39 939.35,-9039.16 898.49,-9022.22 865.74,-9007.69"/>
<polygon fill="blue" stroke="blue" points="866.84,-9004.35 856.28,-9003.46 863.98,-9010.74 866.84,-9004.35"/>
<text text-anchor="middle" x="1037.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1037.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;12</text>
</g>
<!-- expert3_up_11 -->
<g id="node463" class="node">
<title>expert3_up_11</title>
<polygon fill="lightgreen" stroke="black" points="1145,-9003.39 929,-9003.39 929,-8950.39 1145,-8950.39 1145,-9003.39"/>
<text text-anchor="middle" x="1037" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="1037" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1037" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_11&#45;&gt;expert3_up_11 -->
<g id="edge578" class="edge">
<title>gate_11&#45;&gt;expert3_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1212.86,-9087.66C1192.65,-9076.4 1170.22,-9063.61 1150,-9051.39 1127.83,-9038 1103.71,-9022.44 1083.46,-9009.1"/>
<polygon fill="blue" stroke="blue" points="1085.31,-9006.13 1075.04,-9003.53 1081.45,-9011.97 1085.31,-9006.13"/>
<text text-anchor="middle" x="1210.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1210.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;13</text>
</g>
<!-- expert4_up_11 -->
<g id="node467" class="node">
<title>expert4_up_11</title>
<polygon fill="lightgreen" stroke="black" points="1383,-9003.39 1167,-9003.39 1167,-8950.39 1383,-8950.39 1383,-9003.39"/>
<text text-anchor="middle" x="1275" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1275" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1275" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_11&#45;&gt;expert4_up_11 -->
<g id="edge583" class="edge">
<title>gate_11&#45;&gt;expert4_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1275,-9069.18C1275,-9050.91 1275,-9030.8 1275,-9014.12"/>
<polygon fill="blue" stroke="blue" points="1278.5,-9013.71 1275,-9003.71 1271.5,-9013.71 1278.5,-9013.71"/>
<text text-anchor="middle" x="1335.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1335.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;14</text>
</g>
<!-- expert5_up_11 -->
<g id="node471" class="node">
<title>expert5_up_11</title>
<polygon fill="lightgreen" stroke="black" points="1619,-9003.39 1403,-9003.39 1403,-8950.39 1619,-8950.39 1619,-9003.39"/>
<text text-anchor="middle" x="1511" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1511" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1511" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_11&#45;&gt;expert5_up_11 -->
<g id="edge588" class="edge">
<title>gate_11&#45;&gt;expert5_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1337.52,-9087.58C1357.65,-9076.37 1379.93,-9063.63 1400,-9051.39 1421.83,-9038.08 1445.52,-9022.55 1465.39,-9009.2"/>
<polygon fill="blue" stroke="blue" points="1467.61,-9011.92 1473.94,-9003.43 1463.69,-9006.12 1467.61,-9011.92"/>
<text text-anchor="middle" x="1506.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1506.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;15</text>
</g>
<!-- expert6_up_11 -->
<g id="node475" class="node">
<title>expert6_up_11</title>
<polygon fill="lightgreen" stroke="black" points="1854,-9003.39 1638,-9003.39 1638,-8950.39 1854,-8950.39 1854,-9003.39"/>
<text text-anchor="middle" x="1746" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1746" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1746" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_11&#45;&gt;expert6_up_11 -->
<g id="edge593" class="edge">
<title>gate_11&#45;&gt;expert6_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1381.66,-9100.63C1438.5,-9088.46 1509.24,-9071.51 1571,-9051.39 1608.64,-9039.13 1649.5,-9022.19 1682.26,-9007.66"/>
<polygon fill="blue" stroke="blue" points="1684.01,-9010.71 1691.71,-9003.44 1681.15,-9004.32 1684.01,-9010.71"/>
<text text-anchor="middle" x="1708.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1708.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;16</text>
</g>
<!-- expert7_up_11 -->
<g id="node479" class="node">
<title>expert7_up_11</title>
<polygon fill="lightgreen" stroke="black" points="2090,-9003.39 1874,-9003.39 1874,-8950.39 2090,-8950.39 2090,-9003.39"/>
<text text-anchor="middle" x="1982" y="-8988.19" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1982" y="-8973.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1982" y="-8958.19" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_11&#45;&gt;expert7_up_11 -->
<g id="edge598" class="edge">
<title>gate_11&#45;&gt;expert7_up_11</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1411.65,-9109.57C1512.49,-9099.06 1652.54,-9080.73 1773,-9051.39 1819.71,-9040.02 1870.62,-9022.23 1910.5,-9007"/>
<polygon fill="blue" stroke="blue" points="1911.8,-9010.26 1919.88,-9003.4 1909.29,-9003.72 1911.8,-9010.26"/>
<text text-anchor="middle" x="1925.5" y="-9040.19" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1925.5" y="-9025.19" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;17</text>
</g>
<!-- expert0_act_11 -->
<g id="node452" class="node">
<title>expert0_act_11</title>
<polygon fill="lightgreen" stroke="black" points="409,-8913.39 241,-8913.39 241,-8860.39 409,-8860.39 409,-8913.39"/>
<text text-anchor="middle" x="325" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="325" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="325" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert0_up_11&#45;&gt;expert0_act_11 -->
<g id="edge564" class="edge">
<title>expert0_up_11&#45;&gt;expert0_act_11</title>
<path fill="none" stroke="black" d="M327.82,-8949.97C327.45,-8941.73 327.03,-8932.47 326.63,-8923.67"/>
<polygon fill="black" stroke="black" points="330.12,-8923.47 326.17,-8913.63 323.13,-8923.78 330.12,-8923.47"/>
</g>
<!-- expert0_down_11 -->
<g id="node453" class="node">
<title>expert0_down_11</title>
<polygon fill="lightgreen" stroke="black" points="422,-8823.39 206,-8823.39 206,-8770.39 422,-8770.39 422,-8823.39"/>
<text text-anchor="middle" x="314" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="314" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="314" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert0_act_11&#45;&gt;expert0_down_11 -->
<g id="edge565" class="edge">
<title>expert0_act_11&#45;&gt;expert0_down_11</title>
<path fill="none" stroke="black" d="M321.76,-8859.97C320.73,-8851.73 319.57,-8842.47 318.47,-8833.67"/>
<polygon fill="black" stroke="black" points="321.93,-8833.12 317.22,-8823.63 314.99,-8833.99 321.93,-8833.12"/>
</g>
<!-- expert0_agg_11 -->
<g id="node454" class="node">
<title>expert0_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="303" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="303" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="303" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="303" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- expert0_down_11&#45;&gt;expert0_agg_11 -->
<g id="edge566" class="edge">
<title>expert0_down_11&#45;&gt;expert0_agg_11</title>
<path fill="none" stroke="black" d="M311.14,-8770.15C310.24,-8762.07 309.22,-8752.89 308.21,-8743.83"/>
<polygon fill="black" stroke="black" points="311.67,-8743.27 307.09,-8733.71 304.72,-8744.04 311.67,-8743.27"/>
</g>
<!-- expert_agg_11 -->
<g id="node483" class="node">
<title>expert_agg_11</title>
<polygon fill="gold" stroke="black" points="1439.69,-8592.44 1177.71,-8592.44 1110.31,-8486.44 1372.29,-8486.44 1439.69,-8592.44"/>
<text text-anchor="middle" x="1275" y="-8550.74" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1275" y="-8535.74" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1275" y="-8520.74" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert0_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge567" class="edge">
<title>expert0_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M363.1,-8664.23C402.66,-8645.46 456.16,-8622.77 506,-8610.44 720.88,-8557.27 978.5,-8543.57 1134.32,-8540.54"/>
<polygon fill="purple" stroke="purple" points="1134.5,-8544.04 1144.44,-8540.36 1134.37,-8537.04 1134.5,-8544.04"/>
<text text-anchor="middle" x="577.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;17</text>
<text text-anchor="middle" x="577.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_11 -->
<g id="node456" class="node">
<title>expert1_act_11</title>
<polygon fill="lightgreen" stroke="black" points="641,-8913.39 473,-8913.39 473,-8860.39 641,-8860.39 641,-8913.39"/>
<text text-anchor="middle" x="557" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="557" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="557" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert1_up_11&#45;&gt;expert1_act_11 -->
<g id="edge569" class="edge">
<title>expert1_up_11&#45;&gt;expert1_act_11</title>
<path fill="none" stroke="black" d="M564.05,-8949.97C563.12,-8941.73 562.07,-8932.47 561.07,-8923.67"/>
<polygon fill="black" stroke="black" points="564.53,-8923.18 559.93,-8913.63 557.58,-8923.97 564.53,-8923.18"/>
</g>
<!-- expert1_down_11 -->
<g id="node457" class="node">
<title>expert1_down_11</title>
<polygon fill="lightgreen" stroke="black" points="660,-8823.39 444,-8823.39 444,-8770.39 660,-8770.39 660,-8823.39"/>
<text text-anchor="middle" x="552" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="552" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="552" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert1_act_11&#45;&gt;expert1_down_11 -->
<g id="edge570" class="edge">
<title>expert1_act_11&#45;&gt;expert1_down_11</title>
<path fill="none" stroke="black" d="M555.53,-8859.97C555.06,-8851.73 554.53,-8842.47 554.03,-8833.67"/>
<polygon fill="black" stroke="black" points="557.52,-8833.42 553.46,-8823.63 550.54,-8833.82 557.52,-8833.42"/>
</g>
<!-- expert1_agg_11 -->
<g id="node458" class="node">
<title>expert1_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="546" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="546" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="546" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="546" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert1_down_11&#45;&gt;expert1_agg_11 -->
<g id="edge571" class="edge">
<title>expert1_down_11&#45;&gt;expert1_agg_11</title>
<path fill="none" stroke="black" d="M550.44,-8770.15C549.95,-8762.07 549.39,-8752.89 548.84,-8743.83"/>
<polygon fill="black" stroke="black" points="552.33,-8743.48 548.23,-8733.71 545.34,-8743.91 552.33,-8743.48"/>
</g>
<!-- expert1_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge572" class="edge">
<title>expert1_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M603.69,-8663.48C639.82,-8645.16 687.93,-8623.22 733,-8610.44 867.65,-8572.25 1027.1,-8554.83 1138.05,-8546.92"/>
<polygon fill="purple" stroke="purple" points="1138.56,-8550.39 1148.29,-8546.21 1138.07,-8543.41 1138.56,-8550.39"/>
<text text-anchor="middle" x="804.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;17</text>
<text text-anchor="middle" x="804.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_11 -->
<g id="node460" class="node">
<title>expert2_act_11</title>
<polygon fill="lightgreen" stroke="black" points="886,-8913.39 718,-8913.39 718,-8860.39 886,-8860.39 886,-8913.39"/>
<text text-anchor="middle" x="802" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="802" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="802" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert2_up_11&#45;&gt;expert2_act_11 -->
<g id="edge574" class="edge">
<title>expert2_up_11&#45;&gt;expert2_act_11</title>
<path fill="none" stroke="black" d="M802,-8949.97C802,-8941.73 802,-8932.47 802,-8923.67"/>
<polygon fill="black" stroke="black" points="805.5,-8923.63 802,-8913.63 798.5,-8923.63 805.5,-8923.63"/>
</g>
<!-- expert2_down_11 -->
<g id="node461" class="node">
<title>expert2_down_11</title>
<polygon fill="lightgreen" stroke="black" points="907,-8823.39 691,-8823.39 691,-8770.39 907,-8770.39 907,-8823.39"/>
<text text-anchor="middle" x="799" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="799" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="799" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert2_act_11&#45;&gt;expert2_down_11 -->
<g id="edge575" class="edge">
<title>expert2_act_11&#45;&gt;expert2_down_11</title>
<path fill="none" stroke="black" d="M801.12,-8859.97C800.84,-8851.73 800.52,-8842.47 800.22,-8833.67"/>
<polygon fill="black" stroke="black" points="803.72,-8833.51 799.88,-8823.63 796.72,-8833.75 803.72,-8833.51"/>
</g>
<!-- expert2_agg_11 -->
<g id="node462" class="node">
<title>expert2_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="789" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="789" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="789" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="789" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert2_down_11&#45;&gt;expert2_agg_11 -->
<g id="edge576" class="edge">
<title>expert2_down_11&#45;&gt;expert2_agg_11</title>
<path fill="none" stroke="black" d="M796.4,-8770.15C795.58,-8762.07 794.66,-8752.89 793.74,-8743.83"/>
<polygon fill="black" stroke="black" points="797.21,-8743.31 792.72,-8733.71 790.24,-8744.01 797.21,-8743.31"/>
</g>
<!-- expert2_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge577" class="edge">
<title>expert2_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M838.87,-8662.18C867.68,-8644.57 905.22,-8623.78 941,-8610.44 1006.21,-8586.12 1081.9,-8569.38 1144.72,-8558.39"/>
<polygon fill="purple" stroke="purple" points="1145.42,-8561.82 1154.69,-8556.67 1144.24,-8554.92 1145.42,-8561.82"/>
<text text-anchor="middle" x="1012.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;17</text>
<text text-anchor="middle" x="1012.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_11 -->
<g id="node464" class="node">
<title>expert3_act_11</title>
<polygon fill="lightgreen" stroke="black" points="1120,-8913.39 952,-8913.39 952,-8860.39 1120,-8860.39 1120,-8913.39"/>
<text text-anchor="middle" x="1036" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="1036" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1036" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert3_up_11&#45;&gt;expert3_act_11 -->
<g id="edge579" class="edge">
<title>expert3_up_11&#45;&gt;expert3_act_11</title>
<path fill="none" stroke="black" d="M1036.71,-8949.97C1036.61,-8941.73 1036.51,-8932.47 1036.41,-8923.67"/>
<polygon fill="black" stroke="black" points="1039.91,-8923.59 1036.29,-8913.63 1032.91,-8923.67 1039.91,-8923.59"/>
</g>
<!-- expert3_down_11 -->
<g id="node465" class="node">
<title>expert3_down_11</title>
<polygon fill="lightgreen" stroke="black" points="1142,-8823.39 926,-8823.39 926,-8770.39 1142,-8770.39 1142,-8823.39"/>
<text text-anchor="middle" x="1034" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="1034" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1034" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert3_act_11&#45;&gt;expert3_down_11 -->
<g id="edge580" class="edge">
<title>expert3_act_11&#45;&gt;expert3_down_11</title>
<path fill="none" stroke="black" d="M1035.41,-8859.97C1035.22,-8851.73 1035.01,-8842.47 1034.81,-8833.67"/>
<polygon fill="black" stroke="black" points="1038.31,-8833.55 1034.59,-8823.63 1031.31,-8833.71 1038.31,-8833.55"/>
</g>
<!-- expert3_agg_11 -->
<g id="node466" class="node">
<title>expert3_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="1032" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1032" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="1032" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1032" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert3_down_11&#45;&gt;expert3_agg_11 -->
<g id="edge581" class="edge">
<title>expert3_down_11&#45;&gt;expert3_agg_11</title>
<path fill="none" stroke="black" d="M1033.48,-8770.15C1033.32,-8762.07 1033.13,-8752.89 1032.95,-8743.83"/>
<polygon fill="black" stroke="black" points="1036.44,-8743.64 1032.74,-8733.71 1029.45,-8743.78 1036.44,-8743.64"/>
</g>
<!-- expert3_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge582" class="edge">
<title>expert3_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1066.99,-8659.89C1084.4,-8643.61 1106.32,-8624.74 1128,-8610.44 1139.2,-8603.05 1151.31,-8596 1163.59,-8589.4"/>
<polygon fill="purple" stroke="purple" points="1165.34,-8592.44 1172.56,-8584.69 1162.08,-8586.24 1165.34,-8592.44"/>
<text text-anchor="middle" x="1199.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;17</text>
<text text-anchor="middle" x="1199.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_11 -->
<g id="node468" class="node">
<title>expert4_act_11</title>
<polygon fill="lightgreen" stroke="black" points="1359,-8913.39 1191,-8913.39 1191,-8860.39 1359,-8860.39 1359,-8913.39"/>
<text text-anchor="middle" x="1275" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1275" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1275" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert4_up_11&#45;&gt;expert4_act_11 -->
<g id="edge584" class="edge">
<title>expert4_up_11&#45;&gt;expert4_act_11</title>
<path fill="none" stroke="black" d="M1275,-8949.97C1275,-8941.73 1275,-8932.47 1275,-8923.67"/>
<polygon fill="black" stroke="black" points="1278.5,-8923.63 1275,-8913.63 1271.5,-8923.63 1278.5,-8923.63"/>
</g>
<!-- expert4_down_11 -->
<g id="node469" class="node">
<title>expert4_down_11</title>
<polygon fill="lightgreen" stroke="black" points="1383,-8823.39 1167,-8823.39 1167,-8770.39 1383,-8770.39 1383,-8823.39"/>
<text text-anchor="middle" x="1275" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1275" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1275" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert4_act_11&#45;&gt;expert4_down_11 -->
<g id="edge585" class="edge">
<title>expert4_act_11&#45;&gt;expert4_down_11</title>
<path fill="none" stroke="black" d="M1275,-8859.97C1275,-8851.73 1275,-8842.47 1275,-8833.67"/>
<polygon fill="black" stroke="black" points="1278.5,-8833.63 1275,-8823.63 1271.5,-8833.63 1278.5,-8833.63"/>
</g>
<!-- expert4_agg_11 -->
<g id="node470" class="node">
<title>expert4_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="1275" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1275" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1275" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1275" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert4_down_11&#45;&gt;expert4_agg_11 -->
<g id="edge586" class="edge">
<title>expert4_down_11&#45;&gt;expert4_agg_11</title>
<path fill="none" stroke="black" d="M1275,-8770.15C1275,-8762.07 1275,-8752.89 1275,-8743.83"/>
<polygon fill="black" stroke="black" points="1278.5,-8743.71 1275,-8733.71 1271.5,-8743.71 1278.5,-8743.71"/>
</g>
<!-- expert4_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge587" class="edge">
<title>expert4_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1275,-8658.31C1275,-8641.67 1275,-8621.51 1275,-8602.61"/>
<polygon fill="purple" stroke="purple" points="1278.5,-8602.57 1275,-8592.57 1271.5,-8602.57 1278.5,-8602.57"/>
<text text-anchor="middle" x="1346.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;17</text>
<text text-anchor="middle" x="1346.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_11 -->
<g id="node472" class="node">
<title>expert5_act_11</title>
<polygon fill="lightgreen" stroke="black" points="1599,-8913.39 1431,-8913.39 1431,-8860.39 1599,-8860.39 1599,-8913.39"/>
<text text-anchor="middle" x="1515" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1515" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1515" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert5_up_11&#45;&gt;expert5_act_11 -->
<g id="edge589" class="edge">
<title>expert5_up_11&#45;&gt;expert5_act_11</title>
<path fill="none" stroke="black" d="M1512.18,-8949.97C1512.55,-8941.73 1512.97,-8932.47 1513.37,-8923.67"/>
<polygon fill="black" stroke="black" points="1516.87,-8923.78 1513.83,-8913.63 1509.88,-8923.47 1516.87,-8923.78"/>
</g>
<!-- expert5_down_11 -->
<g id="node473" class="node">
<title>expert5_down_11</title>
<polygon fill="lightgreen" stroke="black" points="1624,-8823.39 1408,-8823.39 1408,-8770.39 1624,-8770.39 1624,-8823.39"/>
<text text-anchor="middle" x="1516" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1516" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1516" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert5_act_11&#45;&gt;expert5_down_11 -->
<g id="edge590" class="edge">
<title>expert5_act_11&#45;&gt;expert5_down_11</title>
<path fill="none" stroke="black" d="M1515.29,-8859.97C1515.39,-8851.73 1515.49,-8842.47 1515.59,-8833.67"/>
<polygon fill="black" stroke="black" points="1519.09,-8833.67 1515.71,-8823.63 1512.09,-8833.59 1519.09,-8833.67"/>
</g>
<!-- expert5_agg_11 -->
<g id="node474" class="node">
<title>expert5_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="1518" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1518" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1518" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1518" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert5_down_11&#45;&gt;expert5_agg_11 -->
<g id="edge591" class="edge">
<title>expert5_down_11&#45;&gt;expert5_agg_11</title>
<path fill="none" stroke="black" d="M1516.52,-8770.15C1516.68,-8762.07 1516.87,-8752.89 1517.05,-8743.83"/>
<polygon fill="black" stroke="black" points="1520.55,-8743.78 1517.26,-8733.71 1513.56,-8743.64 1520.55,-8743.78"/>
</g>
<!-- expert5_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge592" class="edge">
<title>expert5_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1483.01,-8659.89C1465.6,-8643.61 1443.68,-8624.74 1422,-8610.44 1415.36,-8606.06 1408.41,-8601.8 1401.29,-8597.69"/>
<polygon fill="purple" stroke="purple" points="1402.62,-8594.42 1392.2,-8592.55 1399.18,-8600.52 1402.62,-8594.42"/>
<text text-anchor="middle" x="1532.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;17</text>
<text text-anchor="middle" x="1532.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_11 -->
<g id="node476" class="node">
<title>expert6_act_11</title>
<polygon fill="lightgreen" stroke="black" points="1832,-8913.39 1664,-8913.39 1664,-8860.39 1832,-8860.39 1832,-8913.39"/>
<text text-anchor="middle" x="1748" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1748" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1748" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert6_up_11&#45;&gt;expert6_act_11 -->
<g id="edge594" class="edge">
<title>expert6_up_11&#45;&gt;expert6_act_11</title>
<path fill="none" stroke="black" d="M1746.59,-8949.97C1746.78,-8941.73 1746.99,-8932.47 1747.19,-8923.67"/>
<polygon fill="black" stroke="black" points="1750.69,-8923.71 1747.41,-8913.63 1743.69,-8923.55 1750.69,-8923.71"/>
</g>
<!-- expert6_down_11 -->
<g id="node477" class="node">
<title>expert6_down_11</title>
<polygon fill="lightgreen" stroke="black" points="1864,-8823.39 1648,-8823.39 1648,-8770.39 1864,-8770.39 1864,-8823.39"/>
<text text-anchor="middle" x="1756" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1756" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1756" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert6_act_11&#45;&gt;expert6_down_11 -->
<g id="edge595" class="edge">
<title>expert6_act_11&#45;&gt;expert6_down_11</title>
<path fill="none" stroke="black" d="M1750.36,-8859.97C1751.11,-8851.73 1751.95,-8842.47 1752.75,-8833.67"/>
<polygon fill="black" stroke="black" points="1756.24,-8833.91 1753.66,-8823.63 1749.27,-8833.28 1756.24,-8833.91"/>
</g>
<!-- expert6_agg_11 -->
<g id="node478" class="node">
<title>expert6_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="1761" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1761" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1761" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1761" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert6_down_11&#45;&gt;expert6_agg_11 -->
<g id="edge596" class="edge">
<title>expert6_down_11&#45;&gt;expert6_agg_11</title>
<path fill="none" stroke="black" d="M1757.3,-8770.15C1757.71,-8762.07 1758.17,-8752.89 1758.63,-8743.83"/>
<polygon fill="black" stroke="black" points="1762.13,-8743.88 1759.14,-8733.71 1755.14,-8743.52 1762.13,-8743.88"/>
</g>
<!-- expert6_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge597" class="edge">
<title>expert6_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1710.78,-8662.2C1681.76,-8644.6 1643.98,-8623.81 1608,-8610.44 1551.58,-8589.47 1487.33,-8574.11 1430.41,-8563.2"/>
<polygon fill="purple" stroke="purple" points="1430.72,-8559.7 1420.24,-8561.29 1429.42,-8566.58 1430.72,-8559.7"/>
<text text-anchor="middle" x="1739.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;17</text>
<text text-anchor="middle" x="1739.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_11 -->
<g id="node480" class="node">
<title>expert7_act_11</title>
<polygon fill="lightgreen" stroke="black" points="2073,-8913.39 1905,-8913.39 1905,-8860.39 2073,-8860.39 2073,-8913.39"/>
<text text-anchor="middle" x="1989" y="-8898.19" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1989" y="-8883.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1989" y="-8868.19" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert7_up_11&#45;&gt;expert7_act_11 -->
<g id="edge599" class="edge">
<title>expert7_up_11&#45;&gt;expert7_act_11</title>
<path fill="none" stroke="black" d="M1984.06,-8949.97C1984.72,-8941.73 1985.45,-8932.47 1986.15,-8923.67"/>
<polygon fill="black" stroke="black" points="1989.65,-8923.88 1986.95,-8913.63 1982.67,-8923.33 1989.65,-8923.88"/>
</g>
<!-- expert7_down_11 -->
<g id="node481" class="node">
<title>expert7_down_11</title>
<polygon fill="lightgreen" stroke="black" points="2103,-8823.39 1887,-8823.39 1887,-8770.39 2103,-8770.39 2103,-8823.39"/>
<text text-anchor="middle" x="1995" y="-8808.19" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1995" y="-8793.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1995" y="-8778.19" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert7_act_11&#45;&gt;expert7_down_11 -->
<g id="edge600" class="edge">
<title>expert7_act_11&#45;&gt;expert7_down_11</title>
<path fill="none" stroke="black" d="M1990.77,-8859.97C1991.33,-8851.73 1991.96,-8842.47 1992.56,-8833.67"/>
<polygon fill="black" stroke="black" points="1996.06,-8833.85 1993.24,-8823.63 1989.07,-8833.37 1996.06,-8833.85"/>
</g>
<!-- expert7_agg_11 -->
<g id="node482" class="node">
<title>expert7_agg_11</title>
<ellipse fill="lightgray" stroke="black" cx="2004" cy="-8695.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="2004" y="-8707.22" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="2004" y="-8692.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="2004" y="-8677.22" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert7_down_11&#45;&gt;expert7_agg_11 -->
<g id="edge601" class="edge">
<title>expert7_down_11&#45;&gt;expert7_agg_11</title>
<path fill="none" stroke="black" d="M1997.34,-8770.15C1998.08,-8762.07 1998.91,-8752.89 1999.73,-8743.83"/>
<polygon fill="black" stroke="black" points="2003.23,-8743.99 2000.65,-8733.71 1996.26,-8743.36 2003.23,-8743.99"/>
</g>
<!-- expert7_agg_11&#45;&gt;expert_agg_11 -->
<g id="edge602" class="edge">
<title>expert7_agg_11&#45;&gt;expert_agg_11</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1946.07,-8663.71C1909.49,-8645.36 1860.66,-8623.31 1815,-8610.44 1684.63,-8573.71 1531.04,-8556.17 1421.06,-8547.84"/>
<polygon fill="purple" stroke="purple" points="1421.12,-8544.33 1410.89,-8547.09 1420.6,-8551.32 1421.12,-8544.33"/>
<text text-anchor="middle" x="1965.5" y="-8629.24" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;17</text>
<text text-anchor="middle" x="1965.5" y="-8614.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_11&#45;&gt;residual2_11 -->
<g id="edge603" class="edge">
<title>expert_agg_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1390.48,-8514.6C1513.06,-8489.29 1706.18,-8449.43 1832.46,-8423.36"/>
<polygon fill="black" stroke="black" points="1833.49,-8426.72 1842.58,-8421.27 1832.07,-8419.86 1833.49,-8426.72"/>
</g>
<!-- layer_out_11 -->
<g id="node485" class="node">
<title>layer_out_11</title>
<ellipse fill="lightgray" stroke="black" cx="1958" cy="-8268.96" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1958" y="-8280.26" font-family="Times,serif" font-size="14.00">Layer11_Output</text>
<text text-anchor="middle" x="1958" y="-8265.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1958" y="-8250.26" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- residual2_11&#45;&gt;layer_out_11 -->
<g id="edge605" class="edge">
<title>residual2_11&#45;&gt;layer_out_11</title>
<path fill="none" stroke="black" d="M1958,-8343.32C1958,-8334.41 1958,-8325.21 1958,-8316.47"/>
<polygon fill="black" stroke="black" points="1961.5,-8316.45 1958,-8306.45 1954.5,-8316.45 1961.5,-8316.45"/>
</g>
<!-- ln1_12 -->
<g id="node486" class="node">
<title>ln1_12</title>
<polygon fill="lightyellow" stroke="black" points="1751.5,-8144.49 1592.5,-8144.49 1592.5,-8091.49 1751.5,-8091.49 1751.5,-8144.49"/>
<text text-anchor="middle" x="1672" y="-8129.29" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1672" y="-8114.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1672" y="-8099.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- layer_out_11&#45;&gt;ln1_12 -->
<g id="edge606" class="edge">
<title>layer_out_11&#45;&gt;ln1_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1873.76,-8243.89C1849.64,-8235.63 1823.74,-8225.41 1801,-8213.49 1768.09,-8196.22 1734.32,-8171.17 1709.6,-8151.2"/>
<polygon fill="red" stroke="red" points="1711.53,-8148.26 1701.57,-8144.64 1707.1,-8153.68 1711.53,-8148.26"/>
<text text-anchor="middle" x="1872.5" y="-8202.29" font-family="Times,serif" font-size="14.00">GPU&#45;87→GPU&#45;11</text>
<text text-anchor="middle" x="1872.5" y="-8187.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_12 -->
<g id="node492" class="node">
<title>residual1_12</title>
<polygon fill="lightpink" stroke="black" points="2109.69,-7784.49 1847.71,-7784.49 1780.31,-7678.49 2042.29,-7678.49 2109.69,-7784.49"/>
<text text-anchor="middle" x="1945" y="-7742.79" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1945" y="-7727.79" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1945" y="-7712.79" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- layer_out_11&#45;&gt;residual1_12 -->
<g id="edge614" class="edge">
<title>layer_out_11&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1958,-8231.23C1958,-8201.08 1958,-8157.27 1958,-8118.99 1958,-8118.99 1958,-8118.99 1958,-7846.99 1958,-7830 1956.57,-7811.7 1954.66,-7794.81"/>
<polygon fill="black" stroke="black" points="1958.09,-7794.01 1953.42,-7784.5 1951.14,-7794.85 1958.09,-7794.01"/>
</g>
<!-- mha_q_12 -->
<g id="node487" class="node">
<title>mha_q_12</title>
<polygon fill="lightcoral" stroke="black" points="1455.5,-8054.49 1236.5,-8054.49 1236.5,-8001.49 1455.5,-8001.49 1455.5,-8054.49"/>
<text text-anchor="middle" x="1346" y="-8039.29" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1346" y="-8024.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1346" y="-8009.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_q_12 -->
<g id="edge607" class="edge">
<title>ln1_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M1592.25,-8095.46C1549.49,-8083.92 1496.27,-8069.55 1450.27,-8057.13"/>
<polygon fill="black" stroke="black" points="1451.13,-8053.74 1440.56,-8054.51 1449.31,-8060.5 1451.13,-8053.74"/>
</g>
<!-- mha_k_12 -->
<g id="node488" class="node">
<title>mha_k_12</title>
<polygon fill="lightcoral" stroke="black" points="1692.5,-8054.49 1473.5,-8054.49 1473.5,-8001.49 1692.5,-8001.49 1692.5,-8054.49"/>
<text text-anchor="middle" x="1583" y="-8039.29" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1583" y="-8024.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1583" y="-8009.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_k_12 -->
<g id="edge608" class="edge">
<title>ln1_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M1645.78,-8091.06C1636.54,-8081.93 1626.04,-8071.54 1616.3,-8061.91"/>
<polygon fill="black" stroke="black" points="1618.61,-8059.27 1609.03,-8054.73 1613.68,-8064.25 1618.61,-8059.27"/>
</g>
<!-- mha_v_12 -->
<g id="node489" class="node">
<title>mha_v_12</title>
<polygon fill="lightcoral" stroke="black" points="1929.5,-8054.49 1710.5,-8054.49 1710.5,-8001.49 1929.5,-8001.49 1929.5,-8054.49"/>
<text text-anchor="middle" x="1820" y="-8039.29" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1820" y="-8024.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1820" y="-8009.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_v_12 -->
<g id="edge609" class="edge">
<title>ln1_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M1715.21,-8091.3C1731.77,-8081.45 1750.84,-8070.11 1768.14,-8059.82"/>
<polygon fill="black" stroke="black" points="1770.19,-8062.68 1777,-8054.56 1766.61,-8056.66 1770.19,-8062.68"/>
</g>
<!-- mha_attn_12 -->
<g id="node490" class="node">
<title>mha_attn_12</title>
<polygon fill="lightcoral" stroke="black" points="1729.5,-7964.49 1558.5,-7964.49 1558.5,-7911.49 1729.5,-7911.49 1729.5,-7964.49"/>
<text text-anchor="middle" x="1644" y="-7949.29" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1644" y="-7934.29" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1644" y="-7919.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge610" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1432.59,-8001.42C1468.96,-7990.68 1511.37,-7978.15 1548.62,-7967.15"/>
<polygon fill="black" stroke="black" points="1549.88,-7970.43 1558.48,-7964.24 1547.9,-7963.72 1549.88,-7970.43"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge611" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1600.97,-8001.06C1607.05,-7992.29 1613.94,-7982.35 1620.39,-7973.05"/>
<polygon fill="black" stroke="black" points="1623.34,-7974.94 1626.16,-7964.73 1617.58,-7970.95 1623.34,-7974.94"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge612" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1768.62,-8001.3C1748.47,-7991.22 1725.2,-7979.59 1704.26,-7969.12"/>
<polygon fill="black" stroke="black" points="1705.65,-7965.9 1695.14,-7964.56 1702.52,-7972.16 1705.65,-7965.9"/>
</g>
<!-- mha_out_12 -->
<g id="node491" class="node">
<title>mha_out_12</title>
<polygon fill="lightcoral" stroke="black" points="1915.5,-7874.49 1756.5,-7874.49 1756.5,-7821.49 1915.5,-7821.49 1915.5,-7874.49"/>
<text text-anchor="middle" x="1836" y="-7859.29" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1836" y="-7844.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1836" y="-7829.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge613" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M1699.79,-7911.42C1721.98,-7901.25 1747.66,-7889.47 1770.71,-7878.91"/>
<polygon fill="black" stroke="black" points="1772.44,-7881.97 1780.07,-7874.62 1769.52,-7875.61 1772.44,-7881.97"/>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge615" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1860.46,-7821.29C1868.75,-7812.59 1878.37,-7802.47 1888.11,-7792.25"/>
<polygon fill="black" stroke="black" points="1890.83,-7794.46 1895.19,-7784.81 1885.76,-7789.64 1890.83,-7794.46"/>
</g>
<!-- ln2_12 -->
<g id="node493" class="node">
<title>ln2_12</title>
<polygon fill="lightyellow" stroke="black" points="1894.5,-7641.49 1735.5,-7641.49 1735.5,-7588.49 1894.5,-7588.49 1894.5,-7641.49"/>
<text text-anchor="middle" x="1815" y="-7626.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1815" y="-7611.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1815" y="-7596.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge616" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M1885.71,-7678.26C1874.18,-7668.11 1862.41,-7657.75 1851.87,-7648.46"/>
<polygon fill="black" stroke="black" points="1853.89,-7645.57 1844.07,-7641.59 1849.26,-7650.83 1853.89,-7645.57"/>
</g>
<!-- residual2_12 -->
<g id="node528" class="node">
<title>residual2_12</title>
<polygon fill="lightpink" stroke="black" points="1863.69,-6825.53 1601.71,-6825.53 1534.31,-6719.53 1796.29,-6719.53 1863.69,-6825.53"/>
<text text-anchor="middle" x="1699" y="-6783.83" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1699" y="-6768.83" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1699" y="-6753.83" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge659" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M2061.77,-7708.74C2109.18,-7692.52 2153,-7664.42 2153,-7615.99 2153,-7615.99 2153,-7615.99 2153,-6914.53 2153,-6849.98 1983.49,-6811.67 1851.63,-6791.64"/>
<polygon fill="black" stroke="black" points="1851.81,-6788.13 1841.4,-6790.11 1850.78,-6795.05 1851.81,-6788.13"/>
</g>
<!-- gate_12 -->
<g id="node494" class="node">
<title>gate_12</title>
<polygon fill="orange" stroke="black" points="1293,-7551.49 1113,-7498.49 1293,-7445.49 1473,-7498.49 1293,-7551.49"/>
<text text-anchor="middle" x="1293" y="-7509.79" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1293" y="-7494.79" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1293" y="-7479.79" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln2_12&#45;&gt;gate_12 -->
<g id="edge617" class="edge">
<title>ln2_12&#45;&gt;gate_12</title>
<path fill="none" stroke="black" d="M1735.44,-7596.53C1647.05,-7577.15 1503.72,-7545.71 1404.25,-7523.89"/>
<polygon fill="black" stroke="black" points="1404.98,-7520.47 1394.46,-7521.74 1403.48,-7527.3 1404.98,-7520.47"/>
</g>
<!-- expert0_up_12 -->
<g id="node495" class="node">
<title>expert0_up_12</title>
<polygon fill="lightgreen" stroke="black" points="460,-7379.49 244,-7379.49 244,-7326.49 460,-7326.49 460,-7379.49"/>
<text text-anchor="middle" x="352" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="352" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="352" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- gate_12&#45;&gt;expert0_up_12 -->
<g id="edge618" class="edge">
<title>gate_12&#45;&gt;expert0_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1134.84,-7492.02C988.54,-7484.61 765.71,-7467.37 576,-7427.49 525.17,-7416.8 469.69,-7398.65 426.66,-7383.06"/>
<polygon fill="blue" stroke="blue" points="427.71,-7379.72 417.12,-7379.57 425.31,-7386.29 427.71,-7379.72"/>
<text text-anchor="middle" x="636.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="636.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;11</text>
</g>
<!-- expert1_up_12 -->
<g id="node499" class="node">
<title>expert1_up_12</title>
<polygon fill="lightgreen" stroke="black" points="694,-7379.49 478,-7379.49 478,-7326.49 694,-7326.49 694,-7379.49"/>
<text text-anchor="middle" x="586" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="586" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="586" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_12&#45;&gt;expert1_up_12 -->
<g id="edge623" class="edge">
<title>gate_12&#45;&gt;expert1_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1156.06,-7485.74C1055.01,-7475.27 914.68,-7456.96 794,-7427.49 747.6,-7416.15 697.04,-7398.42 657.39,-7383.21"/>
<polygon fill="blue" stroke="blue" points="658.4,-7379.85 647.81,-7379.5 655.88,-7386.38 658.4,-7379.85"/>
<text text-anchor="middle" x="854.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="854.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;12</text>
</g>
<!-- expert2_up_12 -->
<g id="node503" class="node">
<title>expert2_up_12</title>
<polygon fill="lightgreen" stroke="black" points="932,-7379.49 716,-7379.49 716,-7326.49 932,-7326.49 932,-7379.49"/>
<text text-anchor="middle" x="824" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="824" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="824" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_12&#45;&gt;expert2_up_12 -->
<g id="edge628" class="edge">
<title>gate_12&#45;&gt;expert2_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1186.31,-7476.83C1129.46,-7464.68 1058.72,-7447.73 997,-7427.49 959.75,-7415.27 919.36,-7398.33 886.98,-7383.79"/>
<polygon fill="blue" stroke="blue" points="888.19,-7380.5 877.64,-7379.56 885.31,-7386.88 888.19,-7380.5"/>
<text text-anchor="middle" x="1057.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1057.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;13</text>
</g>
<!-- expert3_up_12 -->
<g id="node507" class="node">
<title>expert3_up_12</title>
<polygon fill="lightgreen" stroke="black" points="1167,-7379.49 951,-7379.49 951,-7326.49 1167,-7326.49 1167,-7379.49"/>
<text text-anchor="middle" x="1059" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="1059" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1059" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_12&#45;&gt;expert3_up_12 -->
<g id="edge633" class="edge">
<title>gate_12&#45;&gt;expert3_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1230.42,-7463.77C1210.29,-7452.57 1188.01,-7439.81 1168,-7427.49 1146.5,-7414.25 1123.23,-7398.73 1103.73,-7385.37"/>
<polygon fill="blue" stroke="blue" points="1105.56,-7382.38 1095.34,-7379.59 1101.59,-7388.14 1105.56,-7382.38"/>
<text text-anchor="middle" x="1228.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1228.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;14</text>
</g>
<!-- expert4_up_12 -->
<g id="node511" class="node">
<title>expert4_up_12</title>
<polygon fill="lightgreen" stroke="black" points="1401,-7379.49 1185,-7379.49 1185,-7326.49 1401,-7326.49 1401,-7379.49"/>
<text text-anchor="middle" x="1293" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1293" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1293" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_12&#45;&gt;expert4_up_12 -->
<g id="edge638" class="edge">
<title>gate_12&#45;&gt;expert4_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1293,-7445.27C1293,-7427 1293,-7406.89 1293,-7390.21"/>
<polygon fill="blue" stroke="blue" points="1296.5,-7389.8 1293,-7379.8 1289.5,-7389.8 1296.5,-7389.8"/>
<text text-anchor="middle" x="1353.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1353.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;15</text>
</g>
<!-- expert5_up_12 -->
<g id="node515" class="node">
<title>expert5_up_12</title>
<polygon fill="lightgreen" stroke="black" points="1635,-7379.49 1419,-7379.49 1419,-7326.49 1635,-7326.49 1635,-7379.49"/>
<text text-anchor="middle" x="1527" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1527" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1527" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_12&#45;&gt;expert5_up_12 -->
<g id="edge643" class="edge">
<title>gate_12&#45;&gt;expert5_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1355.58,-7463.77C1375.71,-7452.57 1397.99,-7439.81 1418,-7427.49 1439.5,-7414.25 1462.77,-7398.73 1482.27,-7385.37"/>
<polygon fill="blue" stroke="blue" points="1484.41,-7388.14 1490.66,-7379.59 1480.44,-7382.38 1484.41,-7388.14"/>
<text text-anchor="middle" x="1523.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1523.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;16</text>
</g>
<!-- expert6_up_12 -->
<g id="node519" class="node">
<title>expert6_up_12</title>
<polygon fill="lightgreen" stroke="black" points="1870,-7379.49 1654,-7379.49 1654,-7326.49 1870,-7326.49 1870,-7379.49"/>
<text text-anchor="middle" x="1762" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1762" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1762" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_12&#45;&gt;expert6_up_12 -->
<g id="edge648" class="edge">
<title>gate_12&#45;&gt;expert6_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1399.31,-7476.75C1455.96,-7464.57 1526.47,-7447.63 1588,-7427.49 1625.44,-7415.23 1666.06,-7398.29 1698.63,-7383.76"/>
<polygon fill="blue" stroke="blue" points="1700.35,-7386.83 1708.03,-7379.54 1697.48,-7380.44 1700.35,-7386.83"/>
<text text-anchor="middle" x="1725.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1725.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;17</text>
</g>
<!-- expert7_up_12 -->
<g id="node523" class="node">
<title>expert7_up_12</title>
<polygon fill="lightgreen" stroke="black" points="2106,-7379.49 1890,-7379.49 1890,-7326.49 2106,-7326.49 2106,-7379.49"/>
<text text-anchor="middle" x="1998" y="-7364.29" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1998" y="-7349.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1998" y="-7334.29" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- gate_12&#45;&gt;expert7_up_12 -->
<g id="edge653" class="edge">
<title>gate_12&#45;&gt;expert7_up_12</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1429.65,-7485.66C1530.28,-7475.16 1669.91,-7456.85 1790,-7427.49 1836.4,-7416.14 1886.96,-7398.41 1926.61,-7383.2"/>
<polygon fill="blue" stroke="blue" points="1928.12,-7386.37 1936.18,-7379.49 1925.59,-7379.84 1928.12,-7386.37"/>
<text text-anchor="middle" x="1942.5" y="-7416.29" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1942.5" y="-7401.29" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;18</text>
</g>
<!-- expert0_act_12 -->
<g id="node496" class="node">
<title>expert0_act_12</title>
<polygon fill="lightgreen" stroke="black" points="423,-7289.49 255,-7289.49 255,-7236.49 423,-7236.49 423,-7289.49"/>
<text text-anchor="middle" x="339" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="339" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="339" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert0_up_12&#45;&gt;expert0_act_12 -->
<g id="edge619" class="edge">
<title>expert0_up_12&#45;&gt;expert0_act_12</title>
<path fill="none" stroke="black" d="M348.17,-7326.06C346.95,-7317.82 345.59,-7308.57 344.29,-7299.76"/>
<polygon fill="black" stroke="black" points="347.73,-7299.11 342.8,-7289.73 340.8,-7300.13 347.73,-7299.11"/>
</g>
<!-- expert0_down_12 -->
<g id="node497" class="node">
<title>expert0_down_12</title>
<polygon fill="lightgreen" stroke="black" points="433,-7199.49 217,-7199.49 217,-7146.49 433,-7146.49 433,-7199.49"/>
<text text-anchor="middle" x="325" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="325" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="325" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert0_act_12&#45;&gt;expert0_down_12 -->
<g id="edge620" class="edge">
<title>expert0_act_12&#45;&gt;expert0_down_12</title>
<path fill="none" stroke="black" d="M334.88,-7236.06C333.57,-7227.82 332.09,-7218.57 330.69,-7209.76"/>
<polygon fill="black" stroke="black" points="334.12,-7209.05 329.1,-7199.73 327.21,-7210.15 334.12,-7209.05"/>
</g>
<!-- expert0_agg_12 -->
<g id="node498" class="node">
<title>expert0_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="321" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="321" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="321" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="321" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- expert0_down_12&#45;&gt;expert0_agg_12 -->
<g id="edge621" class="edge">
<title>expert0_down_12&#45;&gt;expert0_agg_12</title>
<path fill="none" stroke="black" d="M323.96,-7146.24C323.63,-7138.17 323.26,-7128.99 322.9,-7119.93"/>
<polygon fill="black" stroke="black" points="326.39,-7119.66 322.49,-7109.81 319.39,-7119.94 326.39,-7119.66"/>
</g>
<!-- expert_agg_12 -->
<g id="node527" class="node">
<title>expert_agg_12</title>
<polygon fill="gold" stroke="black" points="1457.69,-6968.53 1195.71,-6968.53 1128.31,-6862.53 1390.29,-6862.53 1457.69,-6968.53"/>
<text text-anchor="middle" x="1293" y="-6926.83" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1293" y="-6911.83" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1293" y="-6896.83" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert0_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge622" class="edge">
<title>expert0_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M381.1,-7040.32C420.66,-7021.56 474.16,-6998.87 524,-6986.53 738.88,-6933.36 996.5,-6919.66 1152.32,-6916.63"/>
<polygon fill="purple" stroke="purple" points="1152.5,-6920.13 1162.44,-6916.45 1152.37,-6913.13 1152.5,-6920.13"/>
<text text-anchor="middle" x="595.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;18</text>
<text text-anchor="middle" x="595.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_12 -->
<g id="node500" class="node">
<title>expert1_act_12</title>
<polygon fill="lightgreen" stroke="black" points="666,-7289.49 498,-7289.49 498,-7236.49 666,-7236.49 666,-7289.49"/>
<text text-anchor="middle" x="582" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="582" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="582" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert1_up_12&#45;&gt;expert1_act_12 -->
<g id="edge624" class="edge">
<title>expert1_up_12&#45;&gt;expert1_act_12</title>
<path fill="none" stroke="black" d="M584.82,-7326.06C584.45,-7317.82 584.03,-7308.57 583.63,-7299.76"/>
<polygon fill="black" stroke="black" points="587.12,-7299.56 583.17,-7289.73 580.13,-7299.88 587.12,-7299.56"/>
</g>
<!-- expert1_down_12 -->
<g id="node501" class="node">
<title>expert1_down_12</title>
<polygon fill="lightgreen" stroke="black" points="678,-7199.49 462,-7199.49 462,-7146.49 678,-7146.49 678,-7199.49"/>
<text text-anchor="middle" x="570" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="570" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="570" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert1_act_12&#45;&gt;expert1_down_12 -->
<g id="edge625" class="edge">
<title>expert1_act_12&#45;&gt;expert1_down_12</title>
<path fill="none" stroke="black" d="M578.46,-7236.06C577.34,-7227.82 576.08,-7218.57 574.88,-7209.76"/>
<polygon fill="black" stroke="black" points="578.33,-7209.16 573.51,-7199.73 571.39,-7210.11 578.33,-7209.16"/>
</g>
<!-- expert1_agg_12 -->
<g id="node502" class="node">
<title>expert1_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="564" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="564" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="564" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="564" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert1_down_12&#45;&gt;expert1_agg_12 -->
<g id="edge626" class="edge">
<title>expert1_down_12&#45;&gt;expert1_agg_12</title>
<path fill="none" stroke="black" d="M568.44,-7146.24C567.95,-7138.17 567.39,-7128.99 566.84,-7119.93"/>
<polygon fill="black" stroke="black" points="570.33,-7119.58 566.23,-7109.81 563.34,-7120 570.33,-7119.58"/>
</g>
<!-- expert1_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge627" class="edge">
<title>expert1_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M621.69,-7039.57C657.82,-7021.26 705.93,-6999.32 751,-6986.53 885.65,-6948.34 1045.1,-6930.92 1156.05,-6923.02"/>
<polygon fill="purple" stroke="purple" points="1156.56,-6926.49 1166.29,-6922.3 1156.07,-6919.5 1156.56,-6926.49"/>
<text text-anchor="middle" x="822.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;18</text>
<text text-anchor="middle" x="822.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_12 -->
<g id="node504" class="node">
<title>expert2_act_12</title>
<polygon fill="lightgreen" stroke="black" points="899,-7289.49 731,-7289.49 731,-7236.49 899,-7236.49 899,-7289.49"/>
<text text-anchor="middle" x="815" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="815" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="815" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert2_up_12&#45;&gt;expert2_act_12 -->
<g id="edge629" class="edge">
<title>expert2_up_12&#45;&gt;expert2_act_12</title>
<path fill="none" stroke="black" d="M821.35,-7326.06C820.51,-7317.82 819.56,-7308.57 818.66,-7299.76"/>
<polygon fill="black" stroke="black" points="822.13,-7299.32 817.63,-7289.73 815.17,-7300.03 822.13,-7299.32"/>
</g>
<!-- expert2_down_12 -->
<g id="node505" class="node">
<title>expert2_down_12</title>
<polygon fill="lightgreen" stroke="black" points="918,-7199.49 702,-7199.49 702,-7146.49 918,-7146.49 918,-7199.49"/>
<text text-anchor="middle" x="810" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="810" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="810" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert2_act_12&#45;&gt;expert2_down_12 -->
<g id="edge630" class="edge">
<title>expert2_act_12&#45;&gt;expert2_down_12</title>
<path fill="none" stroke="black" d="M813.53,-7236.06C813.06,-7227.82 812.53,-7218.57 812.03,-7209.76"/>
<polygon fill="black" stroke="black" points="815.52,-7209.51 811.46,-7199.73 808.54,-7209.91 815.52,-7209.51"/>
</g>
<!-- expert2_agg_12 -->
<g id="node506" class="node">
<title>expert2_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="807" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="807" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="807" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="807" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert2_down_12&#45;&gt;expert2_agg_12 -->
<g id="edge631" class="edge">
<title>expert2_down_12&#45;&gt;expert2_agg_12</title>
<path fill="none" stroke="black" d="M809.22,-7146.24C808.97,-7138.17 808.7,-7128.99 808.42,-7119.93"/>
<polygon fill="black" stroke="black" points="811.92,-7119.7 808.12,-7109.81 804.92,-7119.91 811.92,-7119.7"/>
</g>
<!-- expert2_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge632" class="edge">
<title>expert2_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M856.87,-7038.27C885.68,-7020.66 923.22,-6999.88 959,-6986.53 1024.21,-6962.22 1099.9,-6945.48 1162.72,-6934.48"/>
<polygon fill="purple" stroke="purple" points="1163.42,-6937.91 1172.69,-6932.77 1162.24,-6931.01 1163.42,-6937.91"/>
<text text-anchor="middle" x="1030.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;18</text>
<text text-anchor="middle" x="1030.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_12 -->
<g id="node508" class="node">
<title>expert3_act_12</title>
<polygon fill="lightgreen" stroke="black" points="1141,-7289.49 973,-7289.49 973,-7236.49 1141,-7236.49 1141,-7289.49"/>
<text text-anchor="middle" x="1057" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="1057" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1057" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert3_up_12&#45;&gt;expert3_act_12 -->
<g id="edge634" class="edge">
<title>expert3_up_12&#45;&gt;expert3_act_12</title>
<path fill="none" stroke="black" d="M1058.41,-7326.06C1058.22,-7317.82 1058.01,-7308.57 1057.81,-7299.76"/>
<polygon fill="black" stroke="black" points="1061.31,-7299.65 1057.59,-7289.73 1054.31,-7299.81 1061.31,-7299.65"/>
</g>
<!-- expert3_down_12 -->
<g id="node509" class="node">
<title>expert3_down_12</title>
<polygon fill="lightgreen" stroke="black" points="1163,-7199.49 947,-7199.49 947,-7146.49 1163,-7146.49 1163,-7199.49"/>
<text text-anchor="middle" x="1055" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="1055" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1055" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert3_act_12&#45;&gt;expert3_down_12 -->
<g id="edge635" class="edge">
<title>expert3_act_12&#45;&gt;expert3_down_12</title>
<path fill="none" stroke="black" d="M1056.41,-7236.06C1056.22,-7227.82 1056.01,-7218.57 1055.81,-7209.76"/>
<polygon fill="black" stroke="black" points="1059.31,-7209.65 1055.59,-7199.73 1052.31,-7209.81 1059.31,-7209.65"/>
</g>
<!-- expert3_agg_12 -->
<g id="node510" class="node">
<title>expert3_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="1050" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1050" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="1050" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1050" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert3_down_12&#45;&gt;expert3_agg_12 -->
<g id="edge636" class="edge">
<title>expert3_down_12&#45;&gt;expert3_agg_12</title>
<path fill="none" stroke="black" d="M1053.7,-7146.24C1053.29,-7138.17 1052.83,-7128.99 1052.37,-7119.93"/>
<polygon fill="black" stroke="black" points="1055.86,-7119.62 1051.86,-7109.81 1048.87,-7119.97 1055.86,-7119.62"/>
</g>
<!-- expert3_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge637" class="edge">
<title>expert3_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1084.99,-7035.99C1102.4,-7019.71 1124.32,-7000.83 1146,-6986.53 1157.2,-6979.14 1169.31,-6972.09 1181.59,-6965.5"/>
<polygon fill="purple" stroke="purple" points="1183.34,-6968.53 1190.56,-6960.78 1180.08,-6962.34 1183.34,-6968.53"/>
<text text-anchor="middle" x="1217.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;18</text>
<text text-anchor="middle" x="1217.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_12 -->
<g id="node512" class="node">
<title>expert4_act_12</title>
<polygon fill="lightgreen" stroke="black" points="1377,-7289.49 1209,-7289.49 1209,-7236.49 1377,-7236.49 1377,-7289.49"/>
<text text-anchor="middle" x="1293" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1293" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1293" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert4_up_12&#45;&gt;expert4_act_12 -->
<g id="edge639" class="edge">
<title>expert4_up_12&#45;&gt;expert4_act_12</title>
<path fill="none" stroke="black" d="M1293,-7326.06C1293,-7317.82 1293,-7308.57 1293,-7299.76"/>
<polygon fill="black" stroke="black" points="1296.5,-7299.73 1293,-7289.73 1289.5,-7299.73 1296.5,-7299.73"/>
</g>
<!-- expert4_down_12 -->
<g id="node513" class="node">
<title>expert4_down_12</title>
<polygon fill="lightgreen" stroke="black" points="1401,-7199.49 1185,-7199.49 1185,-7146.49 1401,-7146.49 1401,-7199.49"/>
<text text-anchor="middle" x="1293" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1293" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1293" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert4_act_12&#45;&gt;expert4_down_12 -->
<g id="edge640" class="edge">
<title>expert4_act_12&#45;&gt;expert4_down_12</title>
<path fill="none" stroke="black" d="M1293,-7236.06C1293,-7227.82 1293,-7218.57 1293,-7209.76"/>
<polygon fill="black" stroke="black" points="1296.5,-7209.73 1293,-7199.73 1289.5,-7209.73 1296.5,-7209.73"/>
</g>
<!-- expert4_agg_12 -->
<g id="node514" class="node">
<title>expert4_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="1293" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1293" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1293" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1293" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert4_down_12&#45;&gt;expert4_agg_12 -->
<g id="edge641" class="edge">
<title>expert4_down_12&#45;&gt;expert4_agg_12</title>
<path fill="none" stroke="black" d="M1293,-7146.24C1293,-7138.17 1293,-7128.99 1293,-7119.93"/>
<polygon fill="black" stroke="black" points="1296.5,-7119.81 1293,-7109.81 1289.5,-7119.81 1296.5,-7119.81"/>
</g>
<!-- expert4_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge642" class="edge">
<title>expert4_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1293,-7034.4C1293,-7017.76 1293,-6997.61 1293,-6978.71"/>
<polygon fill="purple" stroke="purple" points="1296.5,-6978.66 1293,-6968.66 1289.5,-6978.66 1296.5,-6978.66"/>
<text text-anchor="middle" x="1364.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;18</text>
<text text-anchor="middle" x="1364.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_12 -->
<g id="node516" class="node">
<title>expert5_act_12</title>
<polygon fill="lightgreen" stroke="black" points="1613,-7289.49 1445,-7289.49 1445,-7236.49 1613,-7236.49 1613,-7289.49"/>
<text text-anchor="middle" x="1529" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1529" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1529" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert5_up_12&#45;&gt;expert5_act_12 -->
<g id="edge644" class="edge">
<title>expert5_up_12&#45;&gt;expert5_act_12</title>
<path fill="none" stroke="black" d="M1527.59,-7326.06C1527.78,-7317.82 1527.99,-7308.57 1528.19,-7299.76"/>
<polygon fill="black" stroke="black" points="1531.69,-7299.81 1528.41,-7289.73 1524.69,-7299.65 1531.69,-7299.81"/>
</g>
<!-- expert5_down_12 -->
<g id="node517" class="node">
<title>expert5_down_12</title>
<polygon fill="lightgreen" stroke="black" points="1639,-7199.49 1423,-7199.49 1423,-7146.49 1639,-7146.49 1639,-7199.49"/>
<text text-anchor="middle" x="1531" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1531" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1531" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert5_act_12&#45;&gt;expert5_down_12 -->
<g id="edge645" class="edge">
<title>expert5_act_12&#45;&gt;expert5_down_12</title>
<path fill="none" stroke="black" d="M1529.59,-7236.06C1529.78,-7227.82 1529.99,-7218.57 1530.19,-7209.76"/>
<polygon fill="black" stroke="black" points="1533.69,-7209.81 1530.41,-7199.73 1526.69,-7209.65 1533.69,-7209.81"/>
</g>
<!-- expert5_agg_12 -->
<g id="node518" class="node">
<title>expert5_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="1536" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1536" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1536" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1536" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert5_down_12&#45;&gt;expert5_agg_12 -->
<g id="edge646" class="edge">
<title>expert5_down_12&#45;&gt;expert5_agg_12</title>
<path fill="none" stroke="black" d="M1532.3,-7146.24C1532.71,-7138.17 1533.17,-7128.99 1533.63,-7119.93"/>
<polygon fill="black" stroke="black" points="1537.13,-7119.97 1534.14,-7109.81 1530.14,-7119.62 1537.13,-7119.97"/>
</g>
<!-- expert5_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge647" class="edge">
<title>expert5_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1501.01,-7035.99C1483.6,-7019.71 1461.68,-7000.83 1440,-6986.53 1433.36,-6982.16 1426.41,-6977.9 1419.29,-6973.78"/>
<polygon fill="purple" stroke="purple" points="1420.62,-6970.51 1410.2,-6968.65 1417.18,-6976.61 1420.62,-6970.51"/>
<text text-anchor="middle" x="1550.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;18</text>
<text text-anchor="middle" x="1550.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_12 -->
<g id="node520" class="node">
<title>expert6_act_12</title>
<polygon fill="lightgreen" stroke="black" points="1848,-7289.49 1680,-7289.49 1680,-7236.49 1848,-7236.49 1848,-7289.49"/>
<text text-anchor="middle" x="1764" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1764" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1764" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert6_up_12&#45;&gt;expert6_act_12 -->
<g id="edge649" class="edge">
<title>expert6_up_12&#45;&gt;expert6_act_12</title>
<path fill="none" stroke="black" d="M1762.59,-7326.06C1762.78,-7317.82 1762.99,-7308.57 1763.19,-7299.76"/>
<polygon fill="black" stroke="black" points="1766.69,-7299.81 1763.41,-7289.73 1759.69,-7299.65 1766.69,-7299.81"/>
</g>
<!-- expert6_down_12 -->
<g id="node521" class="node">
<title>expert6_down_12</title>
<polygon fill="lightgreen" stroke="black" points="1882,-7199.49 1666,-7199.49 1666,-7146.49 1882,-7146.49 1882,-7199.49"/>
<text text-anchor="middle" x="1774" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1774" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1774" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert6_act_12&#45;&gt;expert6_down_12 -->
<g id="edge650" class="edge">
<title>expert6_act_12&#45;&gt;expert6_down_12</title>
<path fill="none" stroke="black" d="M1766.95,-7236.06C1767.88,-7227.82 1768.93,-7218.57 1769.93,-7209.76"/>
<polygon fill="black" stroke="black" points="1773.42,-7210.06 1771.07,-7199.73 1766.47,-7209.27 1773.42,-7210.06"/>
</g>
<!-- expert6_agg_12 -->
<g id="node522" class="node">
<title>expert6_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="1779" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1779" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1779" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1779" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert6_down_12&#45;&gt;expert6_agg_12 -->
<g id="edge651" class="edge">
<title>expert6_down_12&#45;&gt;expert6_agg_12</title>
<path fill="none" stroke="black" d="M1775.3,-7146.24C1775.71,-7138.17 1776.17,-7128.99 1776.63,-7119.93"/>
<polygon fill="black" stroke="black" points="1780.13,-7119.97 1777.14,-7109.81 1773.14,-7119.62 1780.13,-7119.97"/>
</g>
<!-- expert6_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge652" class="edge">
<title>expert6_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1728.78,-7038.29C1699.76,-7020.69 1661.98,-6999.9 1626,-6986.53 1569.58,-6965.57 1505.33,-6950.2 1448.41,-6939.3"/>
<polygon fill="purple" stroke="purple" points="1448.72,-6935.79 1438.24,-6937.38 1447.42,-6942.67 1448.72,-6935.79"/>
<text text-anchor="middle" x="1757.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;18</text>
<text text-anchor="middle" x="1757.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_12 -->
<g id="node524" class="node">
<title>expert7_act_12</title>
<polygon fill="lightgreen" stroke="black" points="2093,-7289.49 1925,-7289.49 1925,-7236.49 2093,-7236.49 2093,-7289.49"/>
<text text-anchor="middle" x="2009" y="-7274.29" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="2009" y="-7259.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="2009" y="-7244.29" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert7_up_12&#45;&gt;expert7_act_12 -->
<g id="edge654" class="edge">
<title>expert7_up_12&#45;&gt;expert7_act_12</title>
<path fill="none" stroke="black" d="M2001.24,-7326.06C2002.27,-7317.82 2003.43,-7308.57 2004.53,-7299.76"/>
<polygon fill="black" stroke="black" points="2008.01,-7300.09 2005.78,-7289.73 2001.07,-7299.22 2008.01,-7300.09"/>
</g>
<!-- expert7_down_12 -->
<g id="node525" class="node">
<title>expert7_down_12</title>
<polygon fill="lightgreen" stroke="black" points="2124,-7199.49 1908,-7199.49 1908,-7146.49 2124,-7146.49 2124,-7199.49"/>
<text text-anchor="middle" x="2016" y="-7184.29" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="2016" y="-7169.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="2016" y="-7154.29" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert7_act_12&#45;&gt;expert7_down_12 -->
<g id="edge655" class="edge">
<title>expert7_act_12&#45;&gt;expert7_down_12</title>
<path fill="none" stroke="black" d="M2011.06,-7236.06C2011.72,-7227.82 2012.45,-7218.57 2013.15,-7209.76"/>
<polygon fill="black" stroke="black" points="2016.65,-7209.97 2013.95,-7199.73 2009.67,-7209.42 2016.65,-7209.97"/>
</g>
<!-- expert7_agg_12 -->
<g id="node526" class="node">
<title>expert7_agg_12</title>
<ellipse fill="lightgray" stroke="black" cx="2022" cy="-7072.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="2022" y="-7083.31" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="2022" y="-7068.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="2022" y="-7053.31" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert7_down_12&#45;&gt;expert7_agg_12 -->
<g id="edge656" class="edge">
<title>expert7_down_12&#45;&gt;expert7_agg_12</title>
<path fill="none" stroke="black" d="M2017.56,-7146.24C2018.05,-7138.17 2018.61,-7128.99 2019.16,-7119.93"/>
<polygon fill="black" stroke="black" points="2022.66,-7120 2019.77,-7109.81 2015.67,-7119.58 2022.66,-7120"/>
</g>
<!-- expert7_agg_12&#45;&gt;expert_agg_12 -->
<g id="edge657" class="edge">
<title>expert7_agg_12&#45;&gt;expert_agg_12</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1964.07,-7039.81C1927.49,-7021.46 1878.66,-6999.4 1833,-6986.53 1702.63,-6949.8 1549.04,-6932.26 1439.06,-6923.93"/>
<polygon fill="purple" stroke="purple" points="1439.12,-6920.43 1428.89,-6923.18 1438.6,-6927.41 1439.12,-6920.43"/>
<text text-anchor="middle" x="1983.5" y="-7005.33" font-family="Times,serif" font-size="14.00">GPU&#45;18→GPU&#45;18</text>
<text text-anchor="middle" x="1983.5" y="-6990.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_12&#45;&gt;residual2_12 -->
<g id="edge658" class="edge">
<title>expert_agg_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M1399.94,-6877.39C1456.13,-6857.88 1525.09,-6833.93 1582.62,-6813.95"/>
<polygon fill="black" stroke="black" points="1583.82,-6817.24 1592.12,-6810.65 1581.52,-6810.63 1583.82,-6817.24"/>
</g>
<!-- layer_out_12 -->
<g id="node529" class="node">
<title>layer_out_12</title>
<ellipse fill="lightgray" stroke="black" cx="1699" cy="-6645.06" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1699" y="-6656.36" font-family="Times,serif" font-size="14.00">Layer12_Output</text>
<text text-anchor="middle" x="1699" y="-6641.36" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1699" y="-6626.36" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- residual2_12&#45;&gt;layer_out_12 -->
<g id="edge660" class="edge">
<title>residual2_12&#45;&gt;layer_out_12</title>
<path fill="none" stroke="black" d="M1699,-6719.41C1699,-6710.51 1699,-6701.31 1699,-6692.56"/>
<polygon fill="black" stroke="black" points="1702.5,-6692.54 1699,-6682.54 1695.5,-6692.54 1702.5,-6692.54"/>
</g>
<!-- ln1_13 -->
<g id="node530" class="node">
<title>ln1_13</title>
<polygon fill="lightyellow" stroke="black" points="1577.5,-6520.58 1418.5,-6520.58 1418.5,-6467.58 1577.5,-6467.58 1577.5,-6520.58"/>
<text text-anchor="middle" x="1498" y="-6505.38" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1498" y="-6490.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1498" y="-6475.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- layer_out_12&#45;&gt;ln1_13 -->
<g id="edge661" class="edge">
<title>layer_out_12&#45;&gt;ln1_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1653.89,-6610.62C1620.07,-6585.55 1574.07,-6551.46 1540.81,-6526.81"/>
<polygon fill="red" stroke="red" points="1542.76,-6523.9 1532.65,-6520.76 1538.6,-6529.53 1542.76,-6523.9"/>
<text text-anchor="middle" x="1693.5" y="-6578.38" font-family="Times,serif" font-size="14.00">GPU&#45;95→GPU&#45;12</text>
<text text-anchor="middle" x="1693.5" y="-6563.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_13 -->
<g id="node536" class="node">
<title>residual1_13</title>
<polygon fill="lightpink" stroke="black" points="1920.69,-6160.58 1658.71,-6160.58 1591.31,-6054.58 1853.29,-6054.58 1920.69,-6160.58"/>
<text text-anchor="middle" x="1756" y="-6118.88" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1756" y="-6103.88" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1756" y="-6088.88" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- layer_out_12&#45;&gt;residual1_13 -->
<g id="edge669" class="edge">
<title>layer_out_12&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1749.74,-6611.43C1757.04,-6604.93 1763.81,-6597.6 1769,-6589.58 1792.48,-6553.28 1792,-6538.31 1792,-6495.08 1792,-6495.08 1792,-6495.08 1792,-6223.08 1792,-6205.57 1788.12,-6187.23 1782.91,-6170.48"/>
<polygon fill="black" stroke="black" points="1786.18,-6169.21 1779.71,-6160.82 1779.54,-6171.41 1786.18,-6169.21"/>
</g>
<!-- mha_q_13 -->
<g id="node531" class="node">
<title>mha_q_13</title>
<polygon fill="lightcoral" stroke="black" points="1289.5,-6430.58 1070.5,-6430.58 1070.5,-6377.58 1289.5,-6377.58 1289.5,-6430.58"/>
<text text-anchor="middle" x="1180" y="-6415.38" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1180" y="-6400.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1180" y="-6385.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_q_13 -->
<g id="edge662" class="edge">
<title>ln1_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M1418.17,-6470.99C1376.94,-6459.58 1326.19,-6445.54 1282.14,-6433.35"/>
<polygon fill="black" stroke="black" points="1282.84,-6429.91 1272.27,-6430.61 1280.98,-6436.65 1282.84,-6429.91"/>
</g>
<!-- mha_k_13 -->
<g id="node532" class="node">
<title>mha_k_13</title>
<polygon fill="lightcoral" stroke="black" points="1526.5,-6430.58 1307.5,-6430.58 1307.5,-6377.58 1526.5,-6377.58 1526.5,-6430.58"/>
<text text-anchor="middle" x="1417" y="-6415.38" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1417" y="-6400.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1417" y="-6385.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_k_13 -->
<g id="edge663" class="edge">
<title>ln1_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M1474.14,-6467.15C1465.81,-6458.11 1456.36,-6447.84 1447.57,-6438.29"/>
<polygon fill="black" stroke="black" points="1450.04,-6435.81 1440.69,-6430.82 1444.89,-6440.55 1450.04,-6435.81"/>
</g>
<!-- mha_v_13 -->
<g id="node533" class="node">
<title>mha_v_13</title>
<polygon fill="lightcoral" stroke="black" points="1763.5,-6430.58 1544.5,-6430.58 1544.5,-6377.58 1763.5,-6377.58 1763.5,-6430.58"/>
<text text-anchor="middle" x="1654" y="-6415.38" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1654" y="-6400.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1654" y="-6385.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_v_13 -->
<g id="edge664" class="edge">
<title>ln1_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M1543.54,-6467.39C1561.16,-6457.45 1581.47,-6445.99 1599.84,-6435.63"/>
<polygon fill="black" stroke="black" points="1601.68,-6438.61 1608.67,-6430.65 1598.24,-6432.51 1601.68,-6438.61"/>
</g>
<!-- mha_attn_13 -->
<g id="node534" class="node">
<title>mha_attn_13</title>
<polygon fill="lightcoral" stroke="black" points="1586.5,-6340.58 1415.5,-6340.58 1415.5,-6287.58 1586.5,-6287.58 1586.5,-6340.58"/>
<text text-anchor="middle" x="1501" y="-6325.38" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1501" y="-6310.38" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1501" y="-6295.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge665" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1273.28,-6377.51C1314.92,-6366.09 1363.94,-6352.65 1405.81,-6341.18"/>
<polygon fill="black" stroke="black" points="1406.73,-6344.55 1415.45,-6338.53 1404.88,-6337.8 1406.73,-6344.55"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge666" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1441.75,-6377.15C1450.38,-6368.11 1460.18,-6357.84 1469.3,-6348.29"/>
<polygon fill="black" stroke="black" points="1472.06,-6350.47 1476.43,-6340.82 1466.99,-6345.64 1472.06,-6350.47"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge667" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1609.33,-6377.39C1592.21,-6367.54 1572.49,-6356.2 1554.61,-6345.92"/>
<polygon fill="black" stroke="black" points="1555.87,-6342.6 1545.46,-6340.65 1552.38,-6348.67 1555.87,-6342.6"/>
</g>
<!-- mha_out_13 -->
<g id="node535" class="node">
<title>mha_out_13</title>
<polygon fill="lightcoral" stroke="black" points="1743.5,-6250.58 1584.5,-6250.58 1584.5,-6197.58 1743.5,-6197.58 1743.5,-6250.58"/>
<text text-anchor="middle" x="1664" y="-6235.38" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1664" y="-6220.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1664" y="-6205.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge668" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M1548.58,-6287.39C1567.08,-6277.4 1588.41,-6265.89 1607.67,-6255.49"/>
<polygon fill="black" stroke="black" points="1609.5,-6258.48 1616.64,-6250.65 1606.18,-6252.32 1609.5,-6258.48"/>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge670" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1684.65,-6197.38C1691.5,-6188.85 1699.45,-6178.96 1707.5,-6168.94"/>
<polygon fill="black" stroke="black" points="1710.43,-6170.89 1713.96,-6160.9 1704.97,-6166.5 1710.43,-6170.89"/>
</g>
<!-- ln2_13 -->
<g id="node537" class="node">
<title>ln2_13</title>
<polygon fill="lightyellow" stroke="black" points="1819.5,-6017.58 1660.5,-6017.58 1660.5,-5964.58 1819.5,-5964.58 1819.5,-6017.58"/>
<text text-anchor="middle" x="1740" y="-6002.38" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1740" y="-5987.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1740" y="-5972.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge671" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M1748.7,-6054.36C1747.44,-6045.3 1746.15,-6036.07 1744.96,-6027.59"/>
<polygon fill="black" stroke="black" points="1748.43,-6027.1 1743.58,-6017.68 1741.5,-6028.07 1748.43,-6027.1"/>
</g>
<!-- residual2_13 -->
<g id="node572" class="node">
<title>residual2_13</title>
<polygon fill="lightpink" stroke="black" points="2001.69,-5201.63 1739.71,-5201.63 1672.31,-5095.63 1934.29,-5095.63 2001.69,-5201.63"/>
<text text-anchor="middle" x="1837" y="-5159.93" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1837" y="-5144.93" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1837" y="-5129.93" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge714" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M1879.91,-6096.15C1944.01,-6083.19 2009,-6054.64 2009,-5992.08 2009,-5992.08 2009,-5992.08 2009,-5290.63 2009,-5256.54 1988.54,-5229.19 1961.74,-5207.99"/>
<polygon fill="black" stroke="black" points="1963.73,-5205.11 1953.63,-5201.89 1959.52,-5210.7 1963.73,-5205.11"/>
</g>
<!-- gate_13 -->
<g id="node538" class="node">
<title>gate_13</title>
<polygon fill="orange" stroke="black" points="1149,-5927.58 969,-5874.58 1149,-5821.58 1329,-5874.58 1149,-5927.58"/>
<text text-anchor="middle" x="1149" y="-5885.88" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1149" y="-5870.88" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1149" y="-5855.88" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln2_13&#45;&gt;gate_13 -->
<g id="edge672" class="edge">
<title>ln2_13&#45;&gt;gate_13</title>
<path fill="none" stroke="black" d="M1660.3,-5974.64C1558.73,-5954.96 1382.38,-5920.79 1265.68,-5898.18"/>
<polygon fill="black" stroke="black" points="1266.11,-5894.7 1255.63,-5896.24 1264.78,-5901.58 1266.11,-5894.7"/>
</g>
<!-- expert0_up_13 -->
<g id="node539" class="node">
<title>expert0_up_13</title>
<polygon fill="lightgreen" stroke="black" points="309,-5755.58 93,-5755.58 93,-5702.58 309,-5702.58 309,-5755.58"/>
<text text-anchor="middle" x="201" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="201" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="201" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- gate_13&#45;&gt;expert0_up_13 -->
<g id="edge673" class="edge">
<title>gate_13&#45;&gt;expert0_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M992.21,-5867.69C846.2,-5859.99 623.11,-5842.54 433,-5803.58 380.36,-5792.79 322.77,-5774.59 278.14,-5758.99"/>
<polygon fill="blue" stroke="blue" points="279.12,-5755.63 268.53,-5755.61 276.8,-5762.23 279.12,-5755.63"/>
<text text-anchor="middle" x="493.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="493.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;12</text>
</g>
<!-- expert1_up_13 -->
<g id="node543" class="node">
<title>expert1_up_13</title>
<polygon fill="lightgreen" stroke="black" points="551,-5755.58 335,-5755.58 335,-5702.58 551,-5702.58 551,-5755.58"/>
<text text-anchor="middle" x="443" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="443" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="443" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_13&#45;&gt;expert1_up_13 -->
<g id="edge678" class="edge">
<title>gate_13&#45;&gt;expert1_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1012.34,-5861.81C911.49,-5851.33 771.43,-5833.01 651,-5803.58 604.6,-5792.24 554.04,-5774.51 514.39,-5759.3"/>
<polygon fill="blue" stroke="blue" points="515.4,-5755.94 504.81,-5755.59 512.88,-5762.47 515.4,-5755.94"/>
<text text-anchor="middle" x="711.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="711.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;13</text>
</g>
<!-- expert2_up_13 -->
<g id="node547" class="node">
<title>expert2_up_13</title>
<polygon fill="lightgreen" stroke="black" points="789,-5755.58 573,-5755.58 573,-5702.58 789,-5702.58 789,-5755.58"/>
<text text-anchor="middle" x="681" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="681" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="681" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_13&#45;&gt;expert2_up_13 -->
<g id="edge683" class="edge">
<title>gate_13&#45;&gt;expert2_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1042.29,-5852.98C985.44,-5840.84 914.69,-5823.89 853,-5803.58 815.94,-5791.38 775.79,-5774.44 743.6,-5759.9"/>
<polygon fill="blue" stroke="blue" points="744.86,-5756.63 734.31,-5755.67 741.96,-5763 744.86,-5756.63"/>
<text text-anchor="middle" x="913.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="913.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;14</text>
</g>
<!-- expert3_up_13 -->
<g id="node551" class="node">
<title>expert3_up_13</title>
<polygon fill="lightgreen" stroke="black" points="1023,-5755.58 807,-5755.58 807,-5702.58 1023,-5702.58 1023,-5755.58"/>
<text text-anchor="middle" x="915" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="915" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="915" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_13&#45;&gt;expert3_up_13 -->
<g id="edge688" class="edge">
<title>gate_13&#45;&gt;expert3_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1086.42,-5839.87C1066.29,-5828.67 1044.01,-5815.9 1024,-5803.58 1002.5,-5790.34 979.23,-5774.82 959.73,-5761.46"/>
<polygon fill="blue" stroke="blue" points="961.56,-5758.47 951.34,-5755.68 957.59,-5764.24 961.56,-5758.47"/>
<text text-anchor="middle" x="1084.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1084.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;15</text>
</g>
<!-- expert4_up_13 -->
<g id="node555" class="node">
<title>expert4_up_13</title>
<polygon fill="lightgreen" stroke="black" points="1257,-5755.58 1041,-5755.58 1041,-5702.58 1257,-5702.58 1257,-5755.58"/>
<text text-anchor="middle" x="1149" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1149" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1149" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_13&#45;&gt;expert4_up_13 -->
<g id="edge693" class="edge">
<title>gate_13&#45;&gt;expert4_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1149,-5821.37C1149,-5803.09 1149,-5782.99 1149,-5766.31"/>
<polygon fill="blue" stroke="blue" points="1152.5,-5765.89 1149,-5755.89 1145.5,-5765.89 1152.5,-5765.89"/>
<text text-anchor="middle" x="1209.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1209.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;16</text>
</g>
<!-- expert5_up_13 -->
<g id="node559" class="node">
<title>expert5_up_13</title>
<polygon fill="lightgreen" stroke="black" points="1492,-5755.58 1276,-5755.58 1276,-5702.58 1492,-5702.58 1492,-5755.58"/>
<text text-anchor="middle" x="1384" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1384" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1384" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_13&#45;&gt;expert5_up_13 -->
<g id="edge698" class="edge">
<title>gate_13&#45;&gt;expert5_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1211.55,-5839.82C1231.68,-5828.61 1253.96,-5815.86 1274,-5803.58 1295.67,-5790.3 1319.15,-5774.78 1338.83,-5761.42"/>
<polygon fill="blue" stroke="blue" points="1341.01,-5764.17 1347.3,-5755.65 1337.07,-5758.39 1341.01,-5764.17"/>
<text text-anchor="middle" x="1379.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1379.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;17</text>
</g>
<!-- expert6_up_13 -->
<g id="node563" class="node">
<title>expert6_up_13</title>
<polygon fill="lightgreen" stroke="black" points="1727,-5755.58 1511,-5755.58 1511,-5702.58 1727,-5702.58 1727,-5755.58"/>
<text text-anchor="middle" x="1619" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1619" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1619" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- gate_13&#45;&gt;expert6_up_13 -->
<g id="edge703" class="edge">
<title>gate_13&#45;&gt;expert6_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1255.3,-5852.79C1311.94,-5840.6 1382.45,-5823.66 1444,-5803.58 1481.64,-5791.3 1522.49,-5774.36 1555.25,-5759.84"/>
<polygon fill="blue" stroke="blue" points="1557,-5762.89 1564.71,-5755.61 1554.15,-5756.5 1557,-5762.89"/>
<text text-anchor="middle" x="1581.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1581.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;18</text>
</g>
<!-- expert7_up_13 -->
<g id="node567" class="node">
<title>expert7_up_13</title>
<polygon fill="lightgreen" stroke="black" points="1964,-5755.58 1748,-5755.58 1748,-5702.58 1964,-5702.58 1964,-5755.58"/>
<text text-anchor="middle" x="1856" y="-5740.38" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1856" y="-5725.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1856" y="-5710.38" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- gate_13&#45;&gt;expert7_up_13 -->
<g id="edge708" class="edge">
<title>gate_13&#45;&gt;expert7_up_13</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1285.36,-5861.67C1386,-5851.13 1525.76,-5832.79 1646,-5803.58 1692.74,-5792.23 1743.69,-5774.53 1783.7,-5759.34"/>
<polygon fill="blue" stroke="blue" points="1785.02,-5762.59 1793.11,-5755.75 1782.52,-5756.05 1785.02,-5762.59"/>
<text text-anchor="middle" x="1799.5" y="-5792.38" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1799.5" y="-5777.38" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;19</text>
</g>
<!-- expert0_act_13 -->
<g id="node540" class="node">
<title>expert0_act_13</title>
<polygon fill="lightgreen" stroke="black" points="277,-5665.58 109,-5665.58 109,-5612.58 277,-5612.58 277,-5665.58"/>
<text text-anchor="middle" x="193" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="193" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="193" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert0_up_13&#45;&gt;expert0_act_13 -->
<g id="edge674" class="edge">
<title>expert0_up_13&#45;&gt;expert0_act_13</title>
<path fill="none" stroke="black" d="M198.64,-5702.15C197.89,-5693.92 197.05,-5684.66 196.25,-5675.86"/>
<polygon fill="black" stroke="black" points="199.73,-5675.46 195.34,-5665.82 192.76,-5676.1 199.73,-5675.46"/>
</g>
<!-- expert0_down_13 -->
<g id="node541" class="node">
<title>expert0_down_13</title>
<polygon fill="lightgreen" stroke="black" points="289,-5575.58 73,-5575.58 73,-5522.58 289,-5522.58 289,-5575.58"/>
<text text-anchor="middle" x="181" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="181" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="181" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert0_act_13&#45;&gt;expert0_down_13 -->
<g id="edge675" class="edge">
<title>expert0_act_13&#45;&gt;expert0_down_13</title>
<path fill="none" stroke="black" d="M189.46,-5612.15C188.34,-5603.92 187.08,-5594.66 185.88,-5585.86"/>
<polygon fill="black" stroke="black" points="189.33,-5585.26 184.51,-5575.82 182.39,-5586.2 189.33,-5585.26"/>
</g>
<!-- expert0_agg_13 -->
<g id="node542" class="node">
<title>expert0_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="177" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="177" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="177" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="177" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- expert0_down_13&#45;&gt;expert0_agg_13 -->
<g id="edge676" class="edge">
<title>expert0_down_13&#45;&gt;expert0_agg_13</title>
<path fill="none" stroke="black" d="M179.96,-5522.33C179.63,-5514.26 179.26,-5505.08 178.9,-5496.02"/>
<polygon fill="black" stroke="black" points="182.39,-5495.75 178.49,-5485.9 175.39,-5496.03 182.39,-5495.75"/>
</g>
<!-- expert_agg_13 -->
<g id="node571" class="node">
<title>expert_agg_13</title>
<polygon fill="gold" stroke="black" points="1313.69,-5344.63 1051.71,-5344.63 984.31,-5238.63 1246.29,-5238.63 1313.69,-5344.63"/>
<text text-anchor="middle" x="1149" y="-5302.93" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1149" y="-5287.93" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1149" y="-5272.93" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert0_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge677" class="edge">
<title>expert0_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M237.1,-5416.41C276.66,-5397.65 330.16,-5374.96 380,-5362.63 594.88,-5309.46 852.5,-5295.75 1008.32,-5292.73"/>
<polygon fill="purple" stroke="purple" points="1008.5,-5296.22 1018.44,-5292.54 1008.37,-5289.23 1008.5,-5296.22"/>
<text text-anchor="middle" x="451.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;19</text>
<text text-anchor="middle" x="451.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_13 -->
<g id="node544" class="node">
<title>expert1_act_13</title>
<polygon fill="lightgreen" stroke="black" points="524,-5665.58 356,-5665.58 356,-5612.58 524,-5612.58 524,-5665.58"/>
<text text-anchor="middle" x="440" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="440" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="440" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert1_up_13&#45;&gt;expert1_act_13 -->
<g id="edge679" class="edge">
<title>expert1_up_13&#45;&gt;expert1_act_13</title>
<path fill="none" stroke="black" d="M442.12,-5702.15C441.84,-5693.92 441.52,-5684.66 441.22,-5675.86"/>
<polygon fill="black" stroke="black" points="444.72,-5675.7 440.88,-5665.82 437.72,-5675.93 444.72,-5675.7"/>
</g>
<!-- expert1_down_13 -->
<g id="node545" class="node">
<title>expert1_down_13</title>
<polygon fill="lightgreen" stroke="black" points="541,-5575.58 325,-5575.58 325,-5522.58 541,-5522.58 541,-5575.58"/>
<text text-anchor="middle" x="433" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="433" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="433" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert1_act_13&#45;&gt;expert1_down_13 -->
<g id="edge680" class="edge">
<title>expert1_act_13&#45;&gt;expert1_down_13</title>
<path fill="none" stroke="black" d="M437.94,-5612.15C437.28,-5603.92 436.55,-5594.66 435.85,-5585.86"/>
<polygon fill="black" stroke="black" points="439.33,-5585.51 435.05,-5575.82 432.35,-5586.07 439.33,-5585.51"/>
</g>
<!-- expert1_agg_13 -->
<g id="node546" class="node">
<title>expert1_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="420" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="420" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="420" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="420" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert1_down_13&#45;&gt;expert1_agg_13 -->
<g id="edge681" class="edge">
<title>expert1_down_13&#45;&gt;expert1_agg_13</title>
<path fill="none" stroke="black" d="M429.62,-5522.33C428.56,-5514.26 427.35,-5505.08 426.16,-5496.02"/>
<polygon fill="black" stroke="black" points="429.61,-5495.36 424.83,-5485.9 422.67,-5496.27 429.61,-5495.36"/>
</g>
<!-- expert1_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge682" class="edge">
<title>expert1_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M477.69,-5415.67C513.82,-5397.35 561.93,-5375.41 607,-5362.63 741.65,-5324.43 901.1,-5307.01 1012.05,-5299.11"/>
<polygon fill="purple" stroke="purple" points="1012.56,-5302.58 1022.29,-5298.4 1012.07,-5295.6 1012.56,-5302.58"/>
<text text-anchor="middle" x="678.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;19</text>
<text text-anchor="middle" x="678.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_13 -->
<g id="node548" class="node">
<title>expert2_act_13</title>
<polygon fill="lightgreen" stroke="black" points="762,-5665.58 594,-5665.58 594,-5612.58 762,-5612.58 762,-5665.58"/>
<text text-anchor="middle" x="678" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="678" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="678" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert2_up_13&#45;&gt;expert2_act_13 -->
<g id="edge684" class="edge">
<title>expert2_up_13&#45;&gt;expert2_act_13</title>
<path fill="none" stroke="black" d="M680.12,-5702.15C679.84,-5693.92 679.52,-5684.66 679.22,-5675.86"/>
<polygon fill="black" stroke="black" points="682.72,-5675.7 678.88,-5665.82 675.72,-5675.93 682.72,-5675.7"/>
</g>
<!-- expert2_down_13 -->
<g id="node549" class="node">
<title>expert2_down_13</title>
<polygon fill="lightgreen" stroke="black" points="784,-5575.58 568,-5575.58 568,-5522.58 784,-5522.58 784,-5575.58"/>
<text text-anchor="middle" x="676" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="676" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="676" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert2_act_13&#45;&gt;expert2_down_13 -->
<g id="edge685" class="edge">
<title>expert2_act_13&#45;&gt;expert2_down_13</title>
<path fill="none" stroke="black" d="M677.41,-5612.15C677.22,-5603.92 677.01,-5594.66 676.81,-5585.86"/>
<polygon fill="black" stroke="black" points="680.31,-5585.74 676.59,-5575.82 673.31,-5585.9 680.31,-5585.74"/>
</g>
<!-- expert2_agg_13 -->
<g id="node550" class="node">
<title>expert2_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="663" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="663" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="663" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="663" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert2_down_13&#45;&gt;expert2_agg_13 -->
<g id="edge686" class="edge">
<title>expert2_down_13&#45;&gt;expert2_agg_13</title>
<path fill="none" stroke="black" d="M672.62,-5522.33C671.56,-5514.26 670.35,-5505.08 669.16,-5496.02"/>
<polygon fill="black" stroke="black" points="672.61,-5495.36 667.83,-5485.9 665.67,-5496.27 672.61,-5495.36"/>
</g>
<!-- expert2_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge687" class="edge">
<title>expert2_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M712.87,-5414.37C741.68,-5396.75 779.22,-5375.97 815,-5362.63 880.21,-5338.31 955.9,-5321.57 1018.72,-5310.58"/>
<polygon fill="purple" stroke="purple" points="1019.42,-5314.01 1028.69,-5308.86 1018.24,-5307.11 1019.42,-5314.01"/>
<text text-anchor="middle" x="886.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;19</text>
<text text-anchor="middle" x="886.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_13 -->
<g id="node552" class="node">
<title>expert3_act_13</title>
<polygon fill="lightgreen" stroke="black" points="999,-5665.58 831,-5665.58 831,-5612.58 999,-5612.58 999,-5665.58"/>
<text text-anchor="middle" x="915" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="915" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="915" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert3_up_13&#45;&gt;expert3_act_13 -->
<g id="edge689" class="edge">
<title>expert3_up_13&#45;&gt;expert3_act_13</title>
<path fill="none" stroke="black" d="M915,-5702.15C915,-5693.92 915,-5684.66 915,-5675.86"/>
<polygon fill="black" stroke="black" points="918.5,-5675.82 915,-5665.82 911.5,-5675.82 918.5,-5675.82"/>
</g>
<!-- expert3_down_13 -->
<g id="node553" class="node">
<title>expert3_down_13</title>
<polygon fill="lightgreen" stroke="black" points="1022,-5575.58 806,-5575.58 806,-5522.58 1022,-5522.58 1022,-5575.58"/>
<text text-anchor="middle" x="914" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="914" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="914" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert3_act_13&#45;&gt;expert3_down_13 -->
<g id="edge690" class="edge">
<title>expert3_act_13&#45;&gt;expert3_down_13</title>
<path fill="none" stroke="black" d="M914.71,-5612.15C914.61,-5603.92 914.51,-5594.66 914.41,-5585.86"/>
<polygon fill="black" stroke="black" points="917.91,-5585.78 914.29,-5575.82 910.91,-5585.86 917.91,-5585.78"/>
</g>
<!-- expert3_agg_13 -->
<g id="node554" class="node">
<title>expert3_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="906" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="906" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="906" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="906" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert3_down_13&#45;&gt;expert3_agg_13 -->
<g id="edge691" class="edge">
<title>expert3_down_13&#45;&gt;expert3_agg_13</title>
<path fill="none" stroke="black" d="M911.92,-5522.33C911.27,-5514.26 910.52,-5505.08 909.79,-5496.02"/>
<polygon fill="black" stroke="black" points="913.27,-5495.59 908.97,-5485.9 906.29,-5496.15 913.27,-5495.59"/>
</g>
<!-- expert3_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge692" class="edge">
<title>expert3_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M940.99,-5412.08C958.4,-5395.8 980.32,-5376.93 1002,-5362.63 1013.2,-5355.24 1025.31,-5348.18 1037.59,-5341.59"/>
<polygon fill="purple" stroke="purple" points="1039.34,-5344.63 1046.56,-5336.87 1036.08,-5338.43 1039.34,-5344.63"/>
<text text-anchor="middle" x="1073.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;19</text>
<text text-anchor="middle" x="1073.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_13 -->
<g id="node556" class="node">
<title>expert4_act_13</title>
<polygon fill="lightgreen" stroke="black" points="1233,-5665.58 1065,-5665.58 1065,-5612.58 1233,-5612.58 1233,-5665.58"/>
<text text-anchor="middle" x="1149" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1149" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1149" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert4_up_13&#45;&gt;expert4_act_13 -->
<g id="edge694" class="edge">
<title>expert4_up_13&#45;&gt;expert4_act_13</title>
<path fill="none" stroke="black" d="M1149,-5702.15C1149,-5693.92 1149,-5684.66 1149,-5675.86"/>
<polygon fill="black" stroke="black" points="1152.5,-5675.82 1149,-5665.82 1145.5,-5675.82 1152.5,-5675.82"/>
</g>
<!-- expert4_down_13 -->
<g id="node557" class="node">
<title>expert4_down_13</title>
<polygon fill="lightgreen" stroke="black" points="1257,-5575.58 1041,-5575.58 1041,-5522.58 1257,-5522.58 1257,-5575.58"/>
<text text-anchor="middle" x="1149" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1149" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1149" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert4_act_13&#45;&gt;expert4_down_13 -->
<g id="edge695" class="edge">
<title>expert4_act_13&#45;&gt;expert4_down_13</title>
<path fill="none" stroke="black" d="M1149,-5612.15C1149,-5603.92 1149,-5594.66 1149,-5585.86"/>
<polygon fill="black" stroke="black" points="1152.5,-5585.82 1149,-5575.82 1145.5,-5585.82 1152.5,-5585.82"/>
</g>
<!-- expert4_agg_13 -->
<g id="node558" class="node">
<title>expert4_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="1149" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1149" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1149" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1149" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert4_down_13&#45;&gt;expert4_agg_13 -->
<g id="edge696" class="edge">
<title>expert4_down_13&#45;&gt;expert4_agg_13</title>
<path fill="none" stroke="black" d="M1149,-5522.33C1149,-5514.26 1149,-5505.08 1149,-5496.02"/>
<polygon fill="black" stroke="black" points="1152.5,-5495.9 1149,-5485.9 1145.5,-5495.9 1152.5,-5495.9"/>
</g>
<!-- expert4_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge697" class="edge">
<title>expert4_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1149,-5410.49C1149,-5393.86 1149,-5373.7 1149,-5354.8"/>
<polygon fill="purple" stroke="purple" points="1152.5,-5354.76 1149,-5344.76 1145.5,-5354.76 1152.5,-5354.76"/>
<text text-anchor="middle" x="1220.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;19</text>
<text text-anchor="middle" x="1220.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_13 -->
<g id="node560" class="node">
<title>expert5_act_13</title>
<polygon fill="lightgreen" stroke="black" points="1472,-5665.58 1304,-5665.58 1304,-5612.58 1472,-5612.58 1472,-5665.58"/>
<text text-anchor="middle" x="1388" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1388" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1388" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert5_up_13&#45;&gt;expert5_act_13 -->
<g id="edge699" class="edge">
<title>expert5_up_13&#45;&gt;expert5_act_13</title>
<path fill="none" stroke="black" d="M1385.18,-5702.15C1385.55,-5693.92 1385.97,-5684.66 1386.37,-5675.86"/>
<polygon fill="black" stroke="black" points="1389.87,-5675.97 1386.83,-5665.82 1382.88,-5675.65 1389.87,-5675.97"/>
</g>
<!-- expert5_down_13 -->
<g id="node561" class="node">
<title>expert5_down_13</title>
<polygon fill="lightgreen" stroke="black" points="1498,-5575.58 1282,-5575.58 1282,-5522.58 1498,-5522.58 1498,-5575.58"/>
<text text-anchor="middle" x="1390" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1390" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1390" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert5_act_13&#45;&gt;expert5_down_13 -->
<g id="edge700" class="edge">
<title>expert5_act_13&#45;&gt;expert5_down_13</title>
<path fill="none" stroke="black" d="M1388.59,-5612.15C1388.78,-5603.92 1388.99,-5594.66 1389.19,-5585.86"/>
<polygon fill="black" stroke="black" points="1392.69,-5585.9 1389.41,-5575.82 1385.69,-5585.74 1392.69,-5585.9"/>
</g>
<!-- expert5_agg_13 -->
<g id="node562" class="node">
<title>expert5_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="1392" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1392" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1392" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1392" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert5_down_13&#45;&gt;expert5_agg_13 -->
<g id="edge701" class="edge">
<title>expert5_down_13&#45;&gt;expert5_agg_13</title>
<path fill="none" stroke="black" d="M1390.52,-5522.33C1390.68,-5514.26 1390.87,-5505.08 1391.05,-5496.02"/>
<polygon fill="black" stroke="black" points="1394.55,-5495.97 1391.26,-5485.9 1387.56,-5495.83 1394.55,-5495.97"/>
</g>
<!-- expert5_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge702" class="edge">
<title>expert5_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1357.01,-5412.08C1339.6,-5395.8 1317.68,-5376.93 1296,-5362.63 1289.36,-5358.25 1282.41,-5353.99 1275.29,-5349.87"/>
<polygon fill="purple" stroke="purple" points="1276.62,-5346.61 1266.2,-5344.74 1273.18,-5352.7 1276.62,-5346.61"/>
<text text-anchor="middle" x="1406.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;19</text>
<text text-anchor="middle" x="1406.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_13 -->
<g id="node564" class="node">
<title>expert6_act_13</title>
<polygon fill="lightgreen" stroke="black" points="1707,-5665.58 1539,-5665.58 1539,-5612.58 1707,-5612.58 1707,-5665.58"/>
<text text-anchor="middle" x="1623" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1623" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1623" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert6_up_13&#45;&gt;expert6_act_13 -->
<g id="edge704" class="edge">
<title>expert6_up_13&#45;&gt;expert6_act_13</title>
<path fill="none" stroke="black" d="M1620.18,-5702.15C1620.55,-5693.92 1620.97,-5684.66 1621.37,-5675.86"/>
<polygon fill="black" stroke="black" points="1624.87,-5675.97 1621.83,-5665.82 1617.88,-5675.65 1624.87,-5675.97"/>
</g>
<!-- expert6_down_13 -->
<g id="node565" class="node">
<title>expert6_down_13</title>
<polygon fill="lightgreen" stroke="black" points="1737,-5575.58 1521,-5575.58 1521,-5522.58 1737,-5522.58 1737,-5575.58"/>
<text text-anchor="middle" x="1629" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1629" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1629" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert6_act_13&#45;&gt;expert6_down_13 -->
<g id="edge705" class="edge">
<title>expert6_act_13&#45;&gt;expert6_down_13</title>
<path fill="none" stroke="black" d="M1624.77,-5612.15C1625.33,-5603.92 1625.96,-5594.66 1626.56,-5585.86"/>
<polygon fill="black" stroke="black" points="1630.06,-5586.04 1627.24,-5575.82 1623.07,-5585.56 1630.06,-5586.04"/>
</g>
<!-- expert6_agg_13 -->
<g id="node566" class="node">
<title>expert6_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="1635" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1635" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1635" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1635" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert6_down_13&#45;&gt;expert6_agg_13 -->
<g id="edge706" class="edge">
<title>expert6_down_13&#45;&gt;expert6_agg_13</title>
<path fill="none" stroke="black" d="M1630.56,-5522.33C1631.05,-5514.26 1631.61,-5505.08 1632.16,-5496.02"/>
<polygon fill="black" stroke="black" points="1635.66,-5496.09 1632.77,-5485.9 1628.67,-5495.67 1635.66,-5496.09"/>
</g>
<!-- expert6_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge707" class="edge">
<title>expert6_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1584.78,-5414.39C1555.76,-5396.78 1517.98,-5376 1482,-5362.63 1425.58,-5341.66 1361.33,-5326.29 1304.41,-5315.39"/>
<polygon fill="purple" stroke="purple" points="1304.72,-5311.89 1294.24,-5313.48 1303.42,-5318.77 1304.72,-5311.89"/>
<text text-anchor="middle" x="1613.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;18→GPU&#45;19</text>
<text text-anchor="middle" x="1613.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_13 -->
<g id="node568" class="node">
<title>expert7_act_13</title>
<polygon fill="lightgreen" stroke="black" points="1949,-5665.58 1781,-5665.58 1781,-5612.58 1949,-5612.58 1949,-5665.58"/>
<text text-anchor="middle" x="1865" y="-5650.38" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1865" y="-5635.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1865" y="-5620.38" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert7_up_13&#45;&gt;expert7_act_13 -->
<g id="edge709" class="edge">
<title>expert7_up_13&#45;&gt;expert7_act_13</title>
<path fill="none" stroke="black" d="M1858.65,-5702.15C1859.49,-5693.92 1860.44,-5684.66 1861.34,-5675.86"/>
<polygon fill="black" stroke="black" points="1864.83,-5676.13 1862.37,-5665.82 1857.87,-5675.41 1864.83,-5676.13"/>
</g>
<!-- expert7_down_13 -->
<g id="node569" class="node">
<title>expert7_down_13</title>
<polygon fill="lightgreen" stroke="black" points="1978,-5575.58 1762,-5575.58 1762,-5522.58 1978,-5522.58 1978,-5575.58"/>
<text text-anchor="middle" x="1870" y="-5560.38" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1870" y="-5545.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1870" y="-5530.38" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert7_act_13&#45;&gt;expert7_down_13 -->
<g id="edge710" class="edge">
<title>expert7_act_13&#45;&gt;expert7_down_13</title>
<path fill="none" stroke="black" d="M1866.47,-5612.15C1866.94,-5603.92 1867.47,-5594.66 1867.97,-5585.86"/>
<polygon fill="black" stroke="black" points="1871.46,-5586 1868.54,-5575.82 1864.48,-5585.61 1871.46,-5586"/>
</g>
<!-- expert7_agg_13 -->
<g id="node570" class="node">
<title>expert7_agg_13</title>
<ellipse fill="lightgray" stroke="black" cx="1878" cy="-5448.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1878" y="-5459.4" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1878" y="-5444.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1878" y="-5429.4" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert7_down_13&#45;&gt;expert7_agg_13 -->
<g id="edge711" class="edge">
<title>expert7_down_13&#45;&gt;expert7_agg_13</title>
<path fill="none" stroke="black" d="M1872.08,-5522.33C1872.73,-5514.26 1873.48,-5505.08 1874.21,-5496.02"/>
<polygon fill="black" stroke="black" points="1877.71,-5496.15 1875.03,-5485.9 1870.73,-5495.59 1877.71,-5496.15"/>
</g>
<!-- expert7_agg_13&#45;&gt;expert_agg_13 -->
<g id="edge712" class="edge">
<title>expert7_agg_13&#45;&gt;expert_agg_13</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1820.07,-5415.9C1783.49,-5397.55 1734.66,-5375.49 1689,-5362.63 1558.63,-5325.9 1405.04,-5308.35 1295.06,-5300.03"/>
<polygon fill="purple" stroke="purple" points="1295.12,-5296.52 1284.89,-5299.27 1294.6,-5303.5 1295.12,-5296.52"/>
<text text-anchor="middle" x="1839.5" y="-5381.43" font-family="Times,serif" font-size="14.00">GPU&#45;19→GPU&#45;19</text>
<text text-anchor="middle" x="1839.5" y="-5366.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_13&#45;&gt;residual2_13 -->
<g id="edge713" class="edge">
<title>expert_agg_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M1264.54,-5266.95C1388.39,-5241.57 1584.33,-5201.41 1711.79,-5175.29"/>
<polygon fill="black" stroke="black" points="1712.51,-5178.71 1721.6,-5173.28 1711.11,-5171.85 1712.51,-5178.71"/>
</g>
<!-- layer_out_13 -->
<g id="node573" class="node">
<title>layer_out_13</title>
<ellipse fill="lightgray" stroke="black" cx="1837" cy="-5021.15" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1837" y="-5032.45" font-family="Times,serif" font-size="14.00">Layer13_Output</text>
<text text-anchor="middle" x="1837" y="-5017.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1837" y="-5002.45" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- residual2_13&#45;&gt;layer_out_13 -->
<g id="edge715" class="edge">
<title>residual2_13&#45;&gt;layer_out_13</title>
<path fill="none" stroke="black" d="M1837,-5095.5C1837,-5086.6 1837,-5077.4 1837,-5068.65"/>
<polygon fill="black" stroke="black" points="1840.5,-5068.64 1837,-5058.64 1833.5,-5068.64 1840.5,-5068.64"/>
</g>
<!-- ln1_14 -->
<g id="node574" class="node">
<title>ln1_14</title>
<polygon fill="lightyellow" stroke="black" points="1623.5,-4896.67 1464.5,-4896.67 1464.5,-4843.67 1623.5,-4843.67 1623.5,-4896.67"/>
<text text-anchor="middle" x="1544" y="-4881.47" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1544" y="-4866.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1544" y="-4851.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- layer_out_13&#45;&gt;ln1_14 -->
<g id="edge716" class="edge">
<title>layer_out_13&#45;&gt;ln1_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1753.36,-4995.85C1729.13,-4987.56 1703.01,-4977.38 1680,-4965.67 1645.55,-4948.14 1609.77,-4922.96 1583.56,-4903"/>
<polygon fill="red" stroke="red" points="1585.46,-4900.05 1575.4,-4896.72 1581.19,-4905.59 1585.46,-4900.05"/>
<text text-anchor="middle" x="1751.5" y="-4954.47" font-family="Times,serif" font-size="14.00">GPU&#45;103→GPU&#45;13</text>
<text text-anchor="middle" x="1751.5" y="-4939.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_14 -->
<g id="node580" class="node">
<title>residual1_14</title>
<polygon fill="lightpink" stroke="black" points="1954.69,-4536.67 1692.71,-4536.67 1625.31,-4430.67 1887.29,-4430.67 1954.69,-4536.67"/>
<text text-anchor="middle" x="1790" y="-4494.97" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1790" y="-4479.97" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1790" y="-4464.97" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- layer_out_13&#45;&gt;residual1_14 -->
<g id="edge724" class="edge">
<title>layer_out_13&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1837,-4983.42C1837,-4953.26 1837,-4909.45 1837,-4871.17 1837,-4871.17 1837,-4871.17 1837,-4599.17 1837,-4581.3 1832.04,-4562.95 1825.34,-4546.33"/>
<polygon fill="black" stroke="black" points="1828.39,-4544.56 1821.22,-4536.76 1821.96,-4547.33 1828.39,-4544.56"/>
</g>
<!-- mha_q_14 -->
<g id="node575" class="node">
<title>mha_q_14</title>
<polygon fill="lightcoral" stroke="black" points="1334.5,-4806.67 1115.5,-4806.67 1115.5,-4753.67 1334.5,-4753.67 1334.5,-4806.67"/>
<text text-anchor="middle" x="1225" y="-4791.47" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1225" y="-4776.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1225" y="-4761.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_q_14 -->
<g id="edge717" class="edge">
<title>ln1_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M1464.33,-4847.19C1422.81,-4835.74 1371.56,-4821.6 1327.16,-4809.35"/>
<polygon fill="black" stroke="black" points="1328.07,-4805.98 1317.5,-4806.69 1326.21,-4812.72 1328.07,-4805.98"/>
</g>
<!-- mha_k_14 -->
<g id="node576" class="node">
<title>mha_k_14</title>
<polygon fill="lightcoral" stroke="black" points="1571.5,-4806.67 1352.5,-4806.67 1352.5,-4753.67 1571.5,-4753.67 1571.5,-4806.67"/>
<text text-anchor="middle" x="1462" y="-4791.47" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1462" y="-4776.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1462" y="-4761.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_k_14 -->
<g id="edge718" class="edge">
<title>ln1_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M1519.84,-4843.25C1511.42,-4834.21 1501.84,-4823.93 1492.94,-4814.38"/>
<polygon fill="black" stroke="black" points="1495.36,-4811.84 1485.99,-4806.91 1490.24,-4816.62 1495.36,-4811.84"/>
</g>
<!-- mha_v_14 -->
<g id="node577" class="node">
<title>mha_v_14</title>
<polygon fill="lightcoral" stroke="black" points="1808.5,-4806.67 1589.5,-4806.67 1589.5,-4753.67 1808.5,-4753.67 1808.5,-4806.67"/>
<text text-anchor="middle" x="1699" y="-4791.47" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1699" y="-4776.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1699" y="-4761.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_v_14 -->
<g id="edge719" class="edge">
<title>ln1_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M1589.25,-4843.48C1606.76,-4833.54 1626.94,-4822.09 1645.18,-4811.73"/>
<polygon fill="black" stroke="black" points="1646.99,-4814.72 1653.96,-4806.74 1643.54,-4808.64 1646.99,-4814.72"/>
</g>
<!-- mha_attn_14 -->
<g id="node578" class="node">
<title>mha_attn_14</title>
<polygon fill="lightcoral" stroke="black" points="1597.5,-4716.67 1426.5,-4716.67 1426.5,-4663.67 1597.5,-4663.67 1597.5,-4716.67"/>
<text text-anchor="middle" x="1512" y="-4701.47" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1512" y="-4686.47" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1512" y="-4671.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge720" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1308.4,-4753.6C1342.89,-4743.03 1383.04,-4730.72 1418.52,-4719.84"/>
<polygon fill="black" stroke="black" points="1419.86,-4723.09 1428.39,-4716.81 1417.81,-4716.39 1419.86,-4723.09"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge721" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1476.73,-4753.25C1481.61,-4744.65 1487.13,-4734.95 1492.32,-4725.81"/>
<polygon fill="black" stroke="black" points="1495.48,-4727.34 1497.37,-4716.91 1489.39,-4723.88 1495.48,-4727.34"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge722" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1644.66,-4753.6C1623.05,-4743.43 1598.04,-4731.66 1575.59,-4721.1"/>
<polygon fill="black" stroke="black" points="1577.01,-4717.9 1566.47,-4716.81 1574.03,-4724.23 1577.01,-4717.9"/>
</g>
<!-- mha_out_14 -->
<g id="node579" class="node">
<title>mha_out_14</title>
<polygon fill="lightcoral" stroke="black" points="1742.5,-4626.67 1583.5,-4626.67 1583.5,-4573.67 1742.5,-4573.67 1742.5,-4626.67"/>
<text text-anchor="middle" x="1663" y="-4611.47" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1663" y="-4596.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1663" y="-4581.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge723" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M1556.08,-4663.48C1572.98,-4653.63 1592.44,-4642.29 1610.09,-4632.01"/>
<polygon fill="black" stroke="black" points="1612.25,-4634.8 1619.12,-4626.74 1608.72,-4628.75 1612.25,-4634.8"/>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge725" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1691.5,-4573.48C1701.4,-4564.55 1712.95,-4554.14 1724.58,-4543.65"/>
<polygon fill="black" stroke="black" points="1727.14,-4546.06 1732.22,-4536.76 1722.45,-4540.86 1727.14,-4546.06"/>
</g>
<!-- ln2_14 -->
<g id="node581" class="node">
<title>ln2_14</title>
<polygon fill="lightyellow" stroke="black" points="1701.5,-4393.67 1542.5,-4393.67 1542.5,-4340.67 1701.5,-4340.67 1701.5,-4393.67"/>
<text text-anchor="middle" x="1622" y="-4378.47" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1622" y="-4363.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1622" y="-4348.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge726" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M1713.37,-4430.45C1697.89,-4419.9 1682.08,-4409.12 1668.05,-4399.56"/>
<polygon fill="black" stroke="black" points="1669.8,-4396.52 1659.57,-4393.78 1665.86,-4402.3 1669.8,-4396.52"/>
</g>
<!-- residual2_14 -->
<g id="node616" class="node">
<title>residual2_14</title>
<polygon fill="lightpink" stroke="black" points="1663.69,-3577.72 1401.71,-3577.72 1334.31,-3471.72 1596.29,-3471.72 1663.69,-3577.72"/>
<text text-anchor="middle" x="1499" y="-3536.02" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1499" y="-3521.02" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1499" y="-3506.02" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge769" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M1899.11,-4448.4C1932.21,-4430.77 1960,-4405 1960,-4368.17 1960,-4368.17 1960,-4368.17 1960,-3666.72 1960,-3600.74 1785.11,-3562.54 1650.77,-3542.94"/>
<polygon fill="black" stroke="black" points="1651.16,-3539.46 1640.76,-3541.5 1650.16,-3546.39 1651.16,-3539.46"/>
</g>
<!-- gate_14 -->
<g id="node582" class="node">
<title>gate_14</title>
<polygon fill="orange" stroke="black" points="1100,-4303.67 920,-4250.67 1100,-4197.67 1280,-4250.67 1100,-4303.67"/>
<text text-anchor="middle" x="1100" y="-4261.97" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1100" y="-4246.97" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1100" y="-4231.97" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln2_14&#45;&gt;gate_14 -->
<g id="edge727" class="edge">
<title>ln2_14&#45;&gt;gate_14</title>
<path fill="none" stroke="black" d="M1542.44,-4348.72C1454.05,-4329.33 1310.72,-4297.89 1211.25,-4276.08"/>
<polygon fill="black" stroke="black" points="1211.98,-4272.65 1201.46,-4273.93 1210.48,-4279.49 1211.98,-4272.65"/>
</g>
<!-- expert0_up_14 -->
<g id="node583" class="node">
<title>expert0_up_14</title>
<polygon fill="lightgreen" stroke="black" points="259,-4131.67 43,-4131.67 43,-4078.67 259,-4078.67 259,-4131.67"/>
<text text-anchor="middle" x="151" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="151" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="151" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- gate_14&#45;&gt;expert0_up_14 -->
<g id="edge728" class="edge">
<title>gate_14&#45;&gt;expert0_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M943.22,-4243.73C797.22,-4235.99 574.13,-4218.51 384,-4179.67 331.15,-4168.88 273.31,-4150.67 228.48,-4135.08"/>
<polygon fill="blue" stroke="blue" points="229.43,-4131.7 218.83,-4131.69 227.11,-4138.31 229.43,-4131.7"/>
<text text-anchor="middle" x="444.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="444.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;13</text>
</g>
<!-- expert1_up_14 -->
<g id="node587" class="node">
<title>expert1_up_14</title>
<polygon fill="lightgreen" stroke="black" points="502,-4131.67 286,-4131.67 286,-4078.67 502,-4078.67 502,-4131.67"/>
<text text-anchor="middle" x="394" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="394" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="394" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_14&#45;&gt;expert1_up_14 -->
<g id="edge733" class="edge">
<title>gate_14&#45;&gt;expert1_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M963.34,-4237.9C862.49,-4227.42 722.43,-4209.1 602,-4179.67 555.6,-4168.34 505.04,-4150.6 465.39,-4135.39"/>
<polygon fill="blue" stroke="blue" points="466.4,-4132.03 455.81,-4131.69 463.88,-4138.56 466.4,-4132.03"/>
<text text-anchor="middle" x="662.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="662.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;14</text>
</g>
<!-- expert2_up_14 -->
<g id="node591" class="node">
<title>expert2_up_14</title>
<polygon fill="lightgreen" stroke="black" points="740,-4131.67 524,-4131.67 524,-4078.67 740,-4078.67 740,-4131.67"/>
<text text-anchor="middle" x="632" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="632" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="632" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_14&#45;&gt;expert2_up_14 -->
<g id="edge738" class="edge">
<title>gate_14&#45;&gt;expert2_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M993.29,-4229.07C936.44,-4216.94 865.69,-4199.98 804,-4179.67 766.94,-4167.47 726.79,-4150.54 694.6,-4136"/>
<polygon fill="blue" stroke="blue" points="695.86,-4132.73 685.31,-4131.77 692.96,-4139.1 695.86,-4132.73"/>
<text text-anchor="middle" x="864.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="864.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;15</text>
</g>
<!-- expert3_up_14 -->
<g id="node595" class="node">
<title>expert3_up_14</title>
<polygon fill="lightgreen" stroke="black" points="974,-4131.67 758,-4131.67 758,-4078.67 974,-4078.67 974,-4131.67"/>
<text text-anchor="middle" x="866" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="866" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="866" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_14&#45;&gt;expert3_up_14 -->
<g id="edge743" class="edge">
<title>gate_14&#45;&gt;expert3_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1037.42,-4215.96C1017.29,-4204.76 995.01,-4192 975,-4179.67 953.5,-4166.43 930.23,-4150.91 910.73,-4137.55"/>
<polygon fill="blue" stroke="blue" points="912.56,-4134.56 902.34,-4131.78 908.59,-4140.33 912.56,-4134.56"/>
<text text-anchor="middle" x="1035.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1035.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;16</text>
</g>
<!-- expert4_up_14 -->
<g id="node599" class="node">
<title>expert4_up_14</title>
<polygon fill="lightgreen" stroke="black" points="1208,-4131.67 992,-4131.67 992,-4078.67 1208,-4078.67 1208,-4131.67"/>
<text text-anchor="middle" x="1100" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1100" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1100" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_14&#45;&gt;expert4_up_14 -->
<g id="edge748" class="edge">
<title>gate_14&#45;&gt;expert4_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1100,-4197.46C1100,-4179.19 1100,-4159.08 1100,-4142.4"/>
<polygon fill="blue" stroke="blue" points="1103.5,-4141.99 1100,-4131.99 1096.5,-4141.99 1103.5,-4141.99"/>
<text text-anchor="middle" x="1160.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1160.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;17</text>
</g>
<!-- expert5_up_14 -->
<g id="node603" class="node">
<title>expert5_up_14</title>
<polygon fill="lightgreen" stroke="black" points="1443,-4131.67 1227,-4131.67 1227,-4078.67 1443,-4078.67 1443,-4131.67"/>
<text text-anchor="middle" x="1335" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1335" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1335" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- gate_14&#45;&gt;expert5_up_14 -->
<g id="edge753" class="edge">
<title>gate_14&#45;&gt;expert5_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1162.55,-4215.91C1182.68,-4204.71 1204.96,-4191.95 1225,-4179.67 1246.67,-4166.4 1270.15,-4150.87 1289.83,-4137.52"/>
<polygon fill="blue" stroke="blue" points="1292.01,-4140.27 1298.3,-4131.74 1288.07,-4134.48 1292.01,-4140.27"/>
<text text-anchor="middle" x="1330.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1330.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;18</text>
</g>
<!-- expert6_up_14 -->
<g id="node607" class="node">
<title>expert6_up_14</title>
<polygon fill="lightgreen" stroke="black" points="1678,-4131.67 1462,-4131.67 1462,-4078.67 1678,-4078.67 1678,-4131.67"/>
<text text-anchor="middle" x="1570" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1570" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1570" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- gate_14&#45;&gt;expert6_up_14 -->
<g id="edge758" class="edge">
<title>gate_14&#45;&gt;expert6_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1206.3,-4228.88C1262.94,-4216.69 1333.45,-4199.75 1395,-4179.67 1432.64,-4167.4 1473.49,-4150.45 1506.25,-4135.93"/>
<polygon fill="blue" stroke="blue" points="1508,-4138.98 1515.71,-4131.71 1505.15,-4132.59 1508,-4138.98"/>
<text text-anchor="middle" x="1532.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1532.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;19</text>
</g>
<!-- expert7_up_14 -->
<g id="node611" class="node">
<title>expert7_up_14</title>
<polygon fill="lightgreen" stroke="black" points="1915,-4131.67 1699,-4131.67 1699,-4078.67 1915,-4078.67 1915,-4131.67"/>
<text text-anchor="middle" x="1807" y="-4116.47" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1807" y="-4101.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1807" y="-4086.47" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- gate_14&#45;&gt;expert7_up_14 -->
<g id="edge763" class="edge">
<title>gate_14&#45;&gt;expert7_up_14</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1236.36,-4237.77C1337,-4227.22 1476.76,-4208.88 1597,-4179.67 1643.74,-4168.32 1694.69,-4150.62 1734.7,-4135.44"/>
<polygon fill="blue" stroke="blue" points="1736.02,-4138.68 1744.11,-4131.84 1733.52,-4132.14 1736.02,-4138.68"/>
<text text-anchor="middle" x="1750.5" y="-4168.47" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1750.5" y="-4153.47" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;20</text>
</g>
<!-- expert0_act_14 -->
<g id="node584" class="node">
<title>expert0_act_14</title>
<polygon fill="lightgreen" stroke="black" points="227,-4041.67 59,-4041.67 59,-3988.67 227,-3988.67 227,-4041.67"/>
<text text-anchor="middle" x="143" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="143" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="143" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert0_up_14&#45;&gt;expert0_act_14 -->
<g id="edge729" class="edge">
<title>expert0_up_14&#45;&gt;expert0_act_14</title>
<path fill="none" stroke="black" d="M148.64,-4078.25C147.89,-4070.01 147.05,-4060.75 146.25,-4051.95"/>
<polygon fill="black" stroke="black" points="149.73,-4051.56 145.34,-4041.91 142.76,-4052.19 149.73,-4051.56"/>
</g>
<!-- expert0_down_14 -->
<g id="node585" class="node">
<title>expert0_down_14</title>
<polygon fill="lightgreen" stroke="black" points="239,-3951.67 23,-3951.67 23,-3898.67 239,-3898.67 239,-3951.67"/>
<text text-anchor="middle" x="131" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="131" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="131" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert0_act_14&#45;&gt;expert0_down_14 -->
<g id="edge730" class="edge">
<title>expert0_act_14&#45;&gt;expert0_down_14</title>
<path fill="none" stroke="black" d="M139.46,-3988.25C138.34,-3980.01 137.08,-3970.75 135.88,-3961.95"/>
<polygon fill="black" stroke="black" points="139.33,-3961.35 134.51,-3951.91 132.39,-3962.3 139.33,-3961.35"/>
</g>
<!-- expert0_agg_14 -->
<g id="node586" class="node">
<title>expert0_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="128" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="128" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="128" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="128" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- expert0_down_14&#45;&gt;expert0_agg_14 -->
<g id="edge731" class="edge">
<title>expert0_down_14&#45;&gt;expert0_agg_14</title>
<path fill="none" stroke="black" d="M130.22,-3898.43C129.97,-3890.35 129.7,-3881.17 129.42,-3872.11"/>
<polygon fill="black" stroke="black" points="132.92,-3871.88 129.12,-3861.99 125.92,-3872.1 132.92,-3871.88"/>
</g>
<!-- expert_agg_14 -->
<g id="node615" class="node">
<title>expert_agg_14</title>
<polygon fill="gold" stroke="black" points="1264.69,-3720.72 1002.71,-3720.72 935.31,-3614.72 1197.29,-3614.72 1264.69,-3720.72"/>
<text text-anchor="middle" x="1100" y="-3679.02" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1100" y="-3664.02" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1100" y="-3649.02" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert0_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge732" class="edge">
<title>expert0_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M188.1,-3792.51C227.66,-3773.74 281.16,-3751.05 331,-3738.72 545.88,-3685.55 803.5,-3671.85 959.32,-3668.82"/>
<polygon fill="purple" stroke="purple" points="959.5,-3672.32 969.44,-3668.64 959.37,-3665.32 959.5,-3672.32"/>
<text text-anchor="middle" x="402.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;20</text>
<text text-anchor="middle" x="402.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_14 -->
<g id="node588" class="node">
<title>expert1_act_14</title>
<polygon fill="lightgreen" stroke="black" points="474,-4041.67 306,-4041.67 306,-3988.67 474,-3988.67 474,-4041.67"/>
<text text-anchor="middle" x="390" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="390" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="390" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert1_up_14&#45;&gt;expert1_act_14 -->
<g id="edge734" class="edge">
<title>expert1_up_14&#45;&gt;expert1_act_14</title>
<path fill="none" stroke="black" d="M392.82,-4078.25C392.45,-4070.01 392.03,-4060.75 391.63,-4051.95"/>
<polygon fill="black" stroke="black" points="395.12,-4051.75 391.17,-4041.91 388.13,-4052.06 395.12,-4051.75"/>
</g>
<!-- expert1_down_14 -->
<g id="node589" class="node">
<title>expert1_down_14</title>
<polygon fill="lightgreen" stroke="black" points="491,-3951.67 275,-3951.67 275,-3898.67 491,-3898.67 491,-3951.67"/>
<text text-anchor="middle" x="383" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="383" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="383" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert1_act_14&#45;&gt;expert1_down_14 -->
<g id="edge735" class="edge">
<title>expert1_act_14&#45;&gt;expert1_down_14</title>
<path fill="none" stroke="black" d="M387.94,-3988.25C387.28,-3980.01 386.55,-3970.75 385.85,-3961.95"/>
<polygon fill="black" stroke="black" points="389.33,-3961.61 385.05,-3951.91 382.35,-3962.16 389.33,-3961.61"/>
</g>
<!-- expert1_agg_14 -->
<g id="node590" class="node">
<title>expert1_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="371" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="371" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="371" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="371" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert1_down_14&#45;&gt;expert1_agg_14 -->
<g id="edge736" class="edge">
<title>expert1_down_14&#45;&gt;expert1_agg_14</title>
<path fill="none" stroke="black" d="M379.88,-3898.43C378.9,-3890.35 377.79,-3881.17 376.69,-3872.11"/>
<polygon fill="black" stroke="black" points="380.14,-3871.5 375.46,-3861.99 373.19,-3872.34 380.14,-3871.5"/>
</g>
<!-- expert1_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge737" class="edge">
<title>expert1_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M428.69,-3791.76C464.82,-3773.44 512.93,-3751.5 558,-3738.72 692.65,-3700.53 852.1,-3683.11 963.05,-3675.2"/>
<polygon fill="purple" stroke="purple" points="963.56,-3678.67 973.29,-3674.49 963.07,-3671.69 963.56,-3678.67"/>
<text text-anchor="middle" x="629.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;20</text>
<text text-anchor="middle" x="629.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_14 -->
<g id="node592" class="node">
<title>expert2_act_14</title>
<polygon fill="lightgreen" stroke="black" points="713,-4041.67 545,-4041.67 545,-3988.67 713,-3988.67 713,-4041.67"/>
<text text-anchor="middle" x="629" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="629" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="629" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert2_up_14&#45;&gt;expert2_act_14 -->
<g id="edge739" class="edge">
<title>expert2_up_14&#45;&gt;expert2_act_14</title>
<path fill="none" stroke="black" d="M631.12,-4078.25C630.84,-4070.01 630.52,-4060.75 630.22,-4051.95"/>
<polygon fill="black" stroke="black" points="633.72,-4051.79 629.88,-4041.91 626.72,-4052.03 633.72,-4051.79"/>
</g>
<!-- expert2_down_14 -->
<g id="node593" class="node">
<title>expert2_down_14</title>
<polygon fill="lightgreen" stroke="black" points="734,-3951.67 518,-3951.67 518,-3898.67 734,-3898.67 734,-3951.67"/>
<text text-anchor="middle" x="626" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="626" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="626" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert2_act_14&#45;&gt;expert2_down_14 -->
<g id="edge740" class="edge">
<title>expert2_act_14&#45;&gt;expert2_down_14</title>
<path fill="none" stroke="black" d="M628.12,-3988.25C627.84,-3980.01 627.52,-3970.75 627.22,-3961.95"/>
<polygon fill="black" stroke="black" points="630.72,-3961.79 626.88,-3951.91 623.72,-3962.03 630.72,-3961.79"/>
</g>
<!-- expert2_agg_14 -->
<g id="node594" class="node">
<title>expert2_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="614" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="614" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="614" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="614" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert2_down_14&#45;&gt;expert2_agg_14 -->
<g id="edge741" class="edge">
<title>expert2_down_14&#45;&gt;expert2_agg_14</title>
<path fill="none" stroke="black" d="M622.88,-3898.43C621.9,-3890.35 620.79,-3881.17 619.69,-3872.11"/>
<polygon fill="black" stroke="black" points="623.14,-3871.5 618.46,-3861.99 616.19,-3872.34 623.14,-3871.5"/>
</g>
<!-- expert2_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge742" class="edge">
<title>expert2_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M663.87,-3790.46C692.68,-3772.85 730.22,-3752.06 766,-3738.72 831.21,-3714.4 906.9,-3697.66 969.72,-3686.67"/>
<polygon fill="purple" stroke="purple" points="970.42,-3690.1 979.69,-3684.95 969.24,-3683.2 970.42,-3690.1"/>
<text text-anchor="middle" x="837.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;20</text>
<text text-anchor="middle" x="837.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_14 -->
<g id="node596" class="node">
<title>expert3_act_14</title>
<polygon fill="lightgreen" stroke="black" points="948,-4041.67 780,-4041.67 780,-3988.67 948,-3988.67 948,-4041.67"/>
<text text-anchor="middle" x="864" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="864" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="864" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert3_up_14&#45;&gt;expert3_act_14 -->
<g id="edge744" class="edge">
<title>expert3_up_14&#45;&gt;expert3_act_14</title>
<path fill="none" stroke="black" d="M865.41,-4078.25C865.22,-4070.01 865.01,-4060.75 864.81,-4051.95"/>
<polygon fill="black" stroke="black" points="868.31,-4051.83 864.59,-4041.91 861.31,-4051.99 868.31,-4051.83"/>
</g>
<!-- expert3_down_14 -->
<g id="node597" class="node">
<title>expert3_down_14</title>
<polygon fill="lightgreen" stroke="black" points="970,-3951.67 754,-3951.67 754,-3898.67 970,-3898.67 970,-3951.67"/>
<text text-anchor="middle" x="862" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="862" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="862" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert3_act_14&#45;&gt;expert3_down_14 -->
<g id="edge745" class="edge">
<title>expert3_act_14&#45;&gt;expert3_down_14</title>
<path fill="none" stroke="black" d="M863.41,-3988.25C863.22,-3980.01 863.01,-3970.75 862.81,-3961.95"/>
<polygon fill="black" stroke="black" points="866.31,-3961.83 862.59,-3951.91 859.31,-3961.99 866.31,-3961.83"/>
</g>
<!-- expert3_agg_14 -->
<g id="node598" class="node">
<title>expert3_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="857" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="857" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="857" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="857" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert3_down_14&#45;&gt;expert3_agg_14 -->
<g id="edge746" class="edge">
<title>expert3_down_14&#45;&gt;expert3_agg_14</title>
<path fill="none" stroke="black" d="M860.7,-3898.43C860.29,-3890.35 859.83,-3881.17 859.37,-3872.11"/>
<polygon fill="black" stroke="black" points="862.86,-3871.8 858.86,-3861.99 855.87,-3872.16 862.86,-3871.8"/>
</g>
<!-- expert3_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge747" class="edge">
<title>expert3_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M891.99,-3788.17C909.4,-3771.89 931.32,-3753.02 953,-3738.72 964.2,-3731.33 976.31,-3724.28 988.59,-3717.68"/>
<polygon fill="purple" stroke="purple" points="990.34,-3720.72 997.56,-3712.97 987.08,-3714.53 990.34,-3720.72"/>
<text text-anchor="middle" x="1024.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;20</text>
<text text-anchor="middle" x="1024.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_14 -->
<g id="node600" class="node">
<title>expert4_act_14</title>
<polygon fill="lightgreen" stroke="black" points="1184,-4041.67 1016,-4041.67 1016,-3988.67 1184,-3988.67 1184,-4041.67"/>
<text text-anchor="middle" x="1100" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1100" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1100" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert4_up_14&#45;&gt;expert4_act_14 -->
<g id="edge749" class="edge">
<title>expert4_up_14&#45;&gt;expert4_act_14</title>
<path fill="none" stroke="black" d="M1100,-4078.25C1100,-4070.01 1100,-4060.75 1100,-4051.95"/>
<polygon fill="black" stroke="black" points="1103.5,-4051.91 1100,-4041.91 1096.5,-4051.91 1103.5,-4051.91"/>
</g>
<!-- expert4_down_14 -->
<g id="node601" class="node">
<title>expert4_down_14</title>
<polygon fill="lightgreen" stroke="black" points="1208,-3951.67 992,-3951.67 992,-3898.67 1208,-3898.67 1208,-3951.67"/>
<text text-anchor="middle" x="1100" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1100" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1100" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert4_act_14&#45;&gt;expert4_down_14 -->
<g id="edge750" class="edge">
<title>expert4_act_14&#45;&gt;expert4_down_14</title>
<path fill="none" stroke="black" d="M1100,-3988.25C1100,-3980.01 1100,-3970.75 1100,-3961.95"/>
<polygon fill="black" stroke="black" points="1103.5,-3961.91 1100,-3951.91 1096.5,-3961.91 1103.5,-3961.91"/>
</g>
<!-- expert4_agg_14 -->
<g id="node602" class="node">
<title>expert4_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="1100" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1100" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1100" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1100" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert4_down_14&#45;&gt;expert4_agg_14 -->
<g id="edge751" class="edge">
<title>expert4_down_14&#45;&gt;expert4_agg_14</title>
<path fill="none" stroke="black" d="M1100,-3898.43C1100,-3890.35 1100,-3881.17 1100,-3872.11"/>
<polygon fill="black" stroke="black" points="1103.5,-3871.99 1100,-3861.99 1096.5,-3871.99 1103.5,-3871.99"/>
</g>
<!-- expert4_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge752" class="edge">
<title>expert4_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1100,-3786.59C1100,-3769.95 1100,-3749.79 1100,-3730.89"/>
<polygon fill="purple" stroke="purple" points="1103.5,-3730.85 1100,-3720.85 1096.5,-3730.85 1103.5,-3730.85"/>
<text text-anchor="middle" x="1171.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;20</text>
<text text-anchor="middle" x="1171.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_14 -->
<g id="node604" class="node">
<title>expert5_act_14</title>
<polygon fill="lightgreen" stroke="black" points="1422,-4041.67 1254,-4041.67 1254,-3988.67 1422,-3988.67 1422,-4041.67"/>
<text text-anchor="middle" x="1338" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1338" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1338" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert5_up_14&#45;&gt;expert5_act_14 -->
<g id="edge754" class="edge">
<title>expert5_up_14&#45;&gt;expert5_act_14</title>
<path fill="none" stroke="black" d="M1335.88,-4078.25C1336.16,-4070.01 1336.48,-4060.75 1336.78,-4051.95"/>
<polygon fill="black" stroke="black" points="1340.28,-4052.03 1337.12,-4041.91 1333.28,-4051.79 1340.28,-4052.03"/>
</g>
<!-- expert5_down_14 -->
<g id="node605" class="node">
<title>expert5_down_14</title>
<polygon fill="lightgreen" stroke="black" points="1446,-3951.67 1230,-3951.67 1230,-3898.67 1446,-3898.67 1446,-3951.67"/>
<text text-anchor="middle" x="1338" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1338" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1338" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert5_act_14&#45;&gt;expert5_down_14 -->
<g id="edge755" class="edge">
<title>expert5_act_14&#45;&gt;expert5_down_14</title>
<path fill="none" stroke="black" d="M1338,-3988.25C1338,-3980.01 1338,-3970.75 1338,-3961.95"/>
<polygon fill="black" stroke="black" points="1341.5,-3961.91 1338,-3951.91 1334.5,-3961.91 1341.5,-3961.91"/>
</g>
<!-- expert5_agg_14 -->
<g id="node606" class="node">
<title>expert5_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="1343" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1343" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1343" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1343" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert5_down_14&#45;&gt;expert5_agg_14 -->
<g id="edge756" class="edge">
<title>expert5_down_14&#45;&gt;expert5_agg_14</title>
<path fill="none" stroke="black" d="M1339.3,-3898.43C1339.71,-3890.35 1340.17,-3881.17 1340.63,-3872.11"/>
<polygon fill="black" stroke="black" points="1344.13,-3872.16 1341.14,-3861.99 1337.14,-3871.8 1344.13,-3872.16"/>
</g>
<!-- expert5_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge757" class="edge">
<title>expert5_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1308.01,-3788.17C1290.6,-3771.89 1268.68,-3753.02 1247,-3738.72 1240.36,-3734.34 1233.41,-3730.08 1226.29,-3725.97"/>
<polygon fill="purple" stroke="purple" points="1227.62,-3722.7 1217.2,-3720.83 1224.18,-3728.8 1227.62,-3722.7"/>
<text text-anchor="middle" x="1357.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;18→GPU&#45;20</text>
<text text-anchor="middle" x="1357.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_14 -->
<g id="node608" class="node">
<title>expert6_act_14</title>
<polygon fill="lightgreen" stroke="black" points="1661,-4041.67 1493,-4041.67 1493,-3988.67 1661,-3988.67 1661,-4041.67"/>
<text text-anchor="middle" x="1577" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1577" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1577" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert6_up_14&#45;&gt;expert6_act_14 -->
<g id="edge759" class="edge">
<title>expert6_up_14&#45;&gt;expert6_act_14</title>
<path fill="none" stroke="black" d="M1572.06,-4078.25C1572.72,-4070.01 1573.45,-4060.75 1574.15,-4051.95"/>
<polygon fill="black" stroke="black" points="1577.65,-4052.16 1574.95,-4041.91 1570.67,-4051.61 1577.65,-4052.16"/>
</g>
<!-- expert6_down_14 -->
<g id="node609" class="node">
<title>expert6_down_14</title>
<polygon fill="lightgreen" stroke="black" points="1690,-3951.67 1474,-3951.67 1474,-3898.67 1690,-3898.67 1690,-3951.67"/>
<text text-anchor="middle" x="1582" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1582" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1582" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert6_act_14&#45;&gt;expert6_down_14 -->
<g id="edge760" class="edge">
<title>expert6_act_14&#45;&gt;expert6_down_14</title>
<path fill="none" stroke="black" d="M1578.47,-3988.25C1578.94,-3980.01 1579.47,-3970.75 1579.97,-3961.95"/>
<polygon fill="black" stroke="black" points="1583.46,-3962.1 1580.54,-3951.91 1576.48,-3961.7 1583.46,-3962.1"/>
</g>
<!-- expert6_agg_14 -->
<g id="node610" class="node">
<title>expert6_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="1586" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1586" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1586" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1586" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert6_down_14&#45;&gt;expert6_agg_14 -->
<g id="edge761" class="edge">
<title>expert6_down_14&#45;&gt;expert6_agg_14</title>
<path fill="none" stroke="black" d="M1583.04,-3898.43C1583.37,-3890.35 1583.74,-3881.17 1584.1,-3872.11"/>
<polygon fill="black" stroke="black" points="1587.61,-3872.13 1584.51,-3861.99 1580.61,-3871.84 1587.61,-3872.13"/>
</g>
<!-- expert6_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge762" class="edge">
<title>expert6_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1535.78,-3790.48C1506.76,-3772.88 1468.98,-3752.09 1433,-3738.72 1376.58,-3717.75 1312.33,-3702.39 1255.41,-3691.49"/>
<polygon fill="purple" stroke="purple" points="1255.72,-3687.98 1245.24,-3689.57 1254.42,-3694.86 1255.72,-3687.98"/>
<text text-anchor="middle" x="1564.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;19→GPU&#45;20</text>
<text text-anchor="middle" x="1564.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_14 -->
<g id="node612" class="node">
<title>expert7_act_14</title>
<polygon fill="lightgreen" stroke="black" points="1901,-4041.67 1733,-4041.67 1733,-3988.67 1901,-3988.67 1901,-4041.67"/>
<text text-anchor="middle" x="1817" y="-4026.47" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1817" y="-4011.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1817" y="-3996.47" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert7_up_14&#45;&gt;expert7_act_14 -->
<g id="edge764" class="edge">
<title>expert7_up_14&#45;&gt;expert7_act_14</title>
<path fill="none" stroke="black" d="M1809.95,-4078.25C1810.88,-4070.01 1811.93,-4060.75 1812.93,-4051.95"/>
<polygon fill="black" stroke="black" points="1816.42,-4052.25 1814.07,-4041.91 1809.47,-4051.46 1816.42,-4052.25"/>
</g>
<!-- expert7_down_14 -->
<g id="node613" class="node">
<title>expert7_down_14</title>
<polygon fill="lightgreen" stroke="black" points="1931,-3951.67 1715,-3951.67 1715,-3898.67 1931,-3898.67 1931,-3951.67"/>
<text text-anchor="middle" x="1823" y="-3936.47" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1823" y="-3921.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1823" y="-3906.47" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert7_act_14&#45;&gt;expert7_down_14 -->
<g id="edge765" class="edge">
<title>expert7_act_14&#45;&gt;expert7_down_14</title>
<path fill="none" stroke="black" d="M1818.77,-3988.25C1819.33,-3980.01 1819.96,-3970.75 1820.56,-3961.95"/>
<polygon fill="black" stroke="black" points="1824.06,-3962.13 1821.24,-3951.91 1817.07,-3961.65 1824.06,-3962.13"/>
</g>
<!-- expert7_agg_14 -->
<g id="node614" class="node">
<title>expert7_agg_14</title>
<ellipse fill="lightgray" stroke="black" cx="1829" cy="-3824.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1829" y="-3835.5" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1829" y="-3820.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1829" y="-3805.5" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert7_down_14&#45;&gt;expert7_agg_14 -->
<g id="edge766" class="edge">
<title>expert7_down_14&#45;&gt;expert7_agg_14</title>
<path fill="none" stroke="black" d="M1824.56,-3898.43C1825.05,-3890.35 1825.61,-3881.17 1826.16,-3872.11"/>
<polygon fill="black" stroke="black" points="1829.66,-3872.19 1826.77,-3861.99 1822.67,-3871.76 1829.66,-3872.19"/>
</g>
<!-- expert7_agg_14&#45;&gt;expert_agg_14 -->
<g id="edge767" class="edge">
<title>expert7_agg_14&#45;&gt;expert_agg_14</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1771.07,-3791.99C1734.49,-3773.64 1685.66,-3751.59 1640,-3738.72 1509.63,-3701.99 1356.04,-3684.45 1246.06,-3676.12"/>
<polygon fill="purple" stroke="purple" points="1246.12,-3672.61 1235.89,-3675.37 1245.6,-3679.6 1246.12,-3672.61"/>
<text text-anchor="middle" x="1790.5" y="-3757.52" font-family="Times,serif" font-size="14.00">GPU&#45;20→GPU&#45;20</text>
<text text-anchor="middle" x="1790.5" y="-3742.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_14&#45;&gt;residual2_14 -->
<g id="edge768" class="edge">
<title>expert_agg_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M1206.66,-3629.03C1261,-3609.83 1327.16,-3586.44 1382.79,-3566.79"/>
<polygon fill="black" stroke="black" points="1384.08,-3570.04 1392.34,-3563.41 1381.74,-3563.44 1384.08,-3570.04"/>
</g>
<!-- layer_out_14 -->
<g id="node617" class="node">
<title>layer_out_14</title>
<ellipse fill="lightgray" stroke="black" cx="1499" cy="-3397.24" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1499" y="-3408.54" font-family="Times,serif" font-size="14.00">Layer14_Output</text>
<text text-anchor="middle" x="1499" y="-3393.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1499" y="-3378.54" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- residual2_14&#45;&gt;layer_out_14 -->
<g id="edge770" class="edge">
<title>residual2_14&#45;&gt;layer_out_14</title>
<path fill="none" stroke="black" d="M1499,-3471.6C1499,-3462.69 1499,-3453.49 1499,-3444.75"/>
<polygon fill="black" stroke="black" points="1502.5,-3444.73 1499,-3434.73 1495.5,-3444.73 1502.5,-3444.73"/>
</g>
<!-- ln1_15 -->
<g id="node618" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="1436.5,-3272.77 1277.5,-3272.77 1277.5,-3219.77 1436.5,-3219.77 1436.5,-3272.77"/>
<text text-anchor="middle" x="1357" y="-3257.57" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1357" y="-3242.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1357" y="-3227.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- layer_out_14&#45;&gt;ln1_15 -->
<g id="edge771" class="edge">
<title>layer_out_14&#45;&gt;ln1_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1465.71,-3361.31C1442.48,-3336.95 1411.67,-3304.62 1388.78,-3280.61"/>
<polygon fill="red" stroke="red" points="1391.08,-3277.95 1381.65,-3273.13 1386.02,-3282.78 1391.08,-3277.95"/>
<text text-anchor="middle" x="1515.5" y="-3330.57" font-family="Times,serif" font-size="14.00">GPU&#45;111→GPU&#45;14</text>
<text text-anchor="middle" x="1515.5" y="-3315.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_15 -->
<g id="node624" class="node">
<title>residual1_15</title>
<polygon fill="lightpink" stroke="black" points="1843.69,-2912.77 1581.71,-2912.77 1514.31,-2806.77 1776.29,-2806.77 1843.69,-2912.77"/>
<text text-anchor="middle" x="1679" y="-2871.07" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1679" y="-2856.07" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1679" y="-2841.07" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- layer_out_14&#45;&gt;residual1_15 -->
<g id="edge779" class="edge">
<title>layer_out_14&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1590.02,-3375.06C1653.17,-3354.33 1726,-3315.62 1726,-3247.27 1726,-3247.27 1726,-3247.27 1726,-2975.27 1726,-2957.39 1721.04,-2939.05 1714.34,-2922.42"/>
<polygon fill="black" stroke="black" points="1717.39,-2920.65 1710.22,-2912.85 1710.96,-2923.42 1717.39,-2920.65"/>
</g>
<!-- mha_q_15 -->
<g id="node619" class="node">
<title>mha_q_15</title>
<polygon fill="lightcoral" stroke="black" points="1223.5,-3182.77 1004.5,-3182.77 1004.5,-3129.77 1223.5,-3129.77 1223.5,-3182.77"/>
<text text-anchor="middle" x="1114" y="-3167.57" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1114" y="-3152.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1114" y="-3137.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_q_15 -->
<g id="edge772" class="edge">
<title>ln1_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M1286.39,-3219.7C1257.56,-3209.25 1224.06,-3197.12 1194.31,-3186.35"/>
<polygon fill="black" stroke="black" points="1195.38,-3183.02 1184.79,-3182.9 1193,-3189.6 1195.38,-3183.02"/>
</g>
<!-- mha_k_15 -->
<g id="node620" class="node">
<title>mha_k_15</title>
<polygon fill="lightcoral" stroke="black" points="1460.5,-3182.77 1241.5,-3182.77 1241.5,-3129.77 1460.5,-3129.77 1460.5,-3182.77"/>
<text text-anchor="middle" x="1351" y="-3167.57" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1351" y="-3152.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1351" y="-3137.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_k_15 -->
<g id="edge773" class="edge">
<title>ln1_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M1355.23,-3219.34C1354.67,-3211.1 1354.04,-3201.85 1353.44,-3193.04"/>
<polygon fill="black" stroke="black" points="1356.93,-3192.75 1352.76,-3183.01 1349.94,-3193.22 1356.93,-3192.75"/>
</g>
<!-- mha_v_15 -->
<g id="node621" class="node">
<title>mha_v_15</title>
<polygon fill="lightcoral" stroke="black" points="1697.5,-3182.77 1478.5,-3182.77 1478.5,-3129.77 1697.5,-3129.77 1697.5,-3182.77"/>
<text text-anchor="middle" x="1588" y="-3167.57" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1588" y="-3152.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1588" y="-3137.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_v_15 -->
<g id="edge774" class="edge">
<title>ln1_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M1424.13,-3219.7C1451.41,-3209.3 1483.1,-3197.23 1511.29,-3186.49"/>
<polygon fill="black" stroke="black" points="1512.61,-3189.73 1520.71,-3182.9 1510.12,-3183.19 1512.61,-3189.73"/>
</g>
<!-- mha_attn_15 -->
<g id="node622" class="node">
<title>mha_attn_15</title>
<polygon fill="lightcoral" stroke="black" points="1486.5,-3092.77 1315.5,-3092.77 1315.5,-3039.77 1486.5,-3039.77 1486.5,-3092.77"/>
<text text-anchor="middle" x="1401" y="-3077.57" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1401" y="-3062.57" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1401" y="-3047.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge775" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1197.4,-3129.7C1231.89,-3119.12 1272.04,-3106.81 1307.52,-3095.93"/>
<polygon fill="black" stroke="black" points="1308.86,-3099.18 1317.39,-3092.9 1306.81,-3092.49 1308.86,-3099.18"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge776" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1365.73,-3129.34C1370.61,-3120.75 1376.13,-3111.04 1381.32,-3101.9"/>
<polygon fill="black" stroke="black" points="1384.48,-3103.43 1386.37,-3093.01 1378.39,-3099.97 1384.48,-3103.43"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge777" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1533.66,-3129.7C1512.05,-3119.53 1487.04,-3107.75 1464.59,-3097.19"/>
<polygon fill="black" stroke="black" points="1466.01,-3093.99 1455.47,-3092.9 1463.03,-3100.33 1466.01,-3093.99"/>
</g>
<!-- mha_out_15 -->
<g id="node623" class="node">
<title>mha_out_15</title>
<polygon fill="lightcoral" stroke="black" points="1631.5,-3002.77 1472.5,-3002.77 1472.5,-2949.77 1631.5,-2949.77 1631.5,-3002.77"/>
<text text-anchor="middle" x="1552" y="-2987.57" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1552" y="-2972.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1552" y="-2957.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge778" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M1445.08,-3039.58C1461.98,-3029.73 1481.44,-3018.39 1499.09,-3008.1"/>
<polygon fill="black" stroke="black" points="1501.25,-3010.9 1508.12,-3002.84 1497.72,-3004.85 1501.25,-3010.9"/>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge780" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1580.5,-2949.57C1590.4,-2940.65 1601.95,-2930.23 1613.58,-2919.74"/>
<polygon fill="black" stroke="black" points="1616.14,-2922.15 1621.22,-2912.86 1611.45,-2916.95 1616.14,-2922.15"/>
</g>
<!-- ln2_15 -->
<g id="node625" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="1395.5,-2769.77 1236.5,-2769.77 1236.5,-2716.77 1395.5,-2716.77 1395.5,-2769.77"/>
<text text-anchor="middle" x="1316" y="-2754.57" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1316" y="-2739.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1316" y="-2724.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge781" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M1514.23,-2806.79C1476.7,-2794.95 1438.2,-2782.81 1405.24,-2772.42"/>
<polygon fill="black" stroke="black" points="1406.24,-2769.06 1395.65,-2769.39 1404.13,-2775.74 1406.24,-2769.06"/>
</g>
<!-- residual2_15 -->
<g id="node660" class="node">
<title>residual2_15</title>
<polygon fill="lightpink" stroke="black" points="1715.69,-1953.81 1453.71,-1953.81 1386.31,-1847.81 1648.29,-1847.81 1715.69,-1953.81"/>
<text text-anchor="middle" x="1551" y="-1912.11" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1551" y="-1897.11" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1551" y="-1882.11" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge824" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1799.18,-2841.95C1898.75,-2824.53 2024,-2792.94 2024,-2744.27 2024,-2744.27 2024,-2744.27 2024,-2042.81 2024,-1974.52 1840.65,-1936.61 1702.26,-1917.72"/>
<polygon fill="black" stroke="black" points="1702.33,-1914.2 1691.95,-1916.34 1701.4,-1921.14 1702.33,-1914.2"/>
</g>
<!-- gate_15 -->
<g id="node626" class="node">
<title>gate_15</title>
<polygon fill="orange" stroke="black" points="1164,-2679.77 984,-2626.77 1164,-2573.77 1344,-2626.77 1164,-2679.77"/>
<text text-anchor="middle" x="1164" y="-2638.07" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1164" y="-2623.07" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1164" y="-2608.07" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln2_15&#45;&gt;gate_15 -->
<g id="edge782" class="edge">
<title>ln2_15&#45;&gt;gate_15</title>
<path fill="none" stroke="black" d="M1281.89,-2716.57C1264.27,-2703.3 1242.29,-2686.74 1222.09,-2671.53"/>
<polygon fill="black" stroke="black" points="1223.96,-2668.55 1213.86,-2665.33 1219.74,-2674.14 1223.96,-2668.55"/>
</g>
<!-- expert0_up_15 -->
<g id="node627" class="node">
<title>expert0_up_15</title>
<polygon fill="lightgreen" stroke="black" points="318,-2507.77 102,-2507.77 102,-2454.77 318,-2454.77 318,-2507.77"/>
<text text-anchor="middle" x="210" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="210" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="210" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- gate_15&#45;&gt;expert0_up_15 -->
<g id="edge783" class="edge">
<title>gate_15&#45;&gt;expert0_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1006.61,-2620.03C859.39,-2612.43 634.01,-2595.04 442,-2555.77 389.36,-2545 331.77,-2526.79 287.14,-2511.2"/>
<polygon fill="blue" stroke="blue" points="288.12,-2507.83 277.53,-2507.81 285.79,-2514.43 288.12,-2507.83"/>
<text text-anchor="middle" x="502.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="502.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;14</text>
</g>
<!-- expert1_up_15 -->
<g id="node631" class="node">
<title>expert1_up_15</title>
<polygon fill="lightgreen" stroke="black" points="555,-2507.77 339,-2507.77 339,-2454.77 555,-2454.77 555,-2507.77"/>
<text text-anchor="middle" x="447" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="447" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="447" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_15&#45;&gt;expert1_up_15 -->
<g id="edge788" class="edge">
<title>gate_15&#45;&gt;expert1_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1027.95,-2613.79C926.45,-2603.16 784.86,-2584.74 663,-2555.77 614.91,-2544.33 562.39,-2526.58 521.17,-2511.39"/>
<polygon fill="blue" stroke="blue" points="522.35,-2508.09 511.75,-2507.89 519.91,-2514.66 522.35,-2508.09"/>
<text text-anchor="middle" x="723.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="723.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;15</text>
</g>
<!-- expert2_up_15 -->
<g id="node635" class="node">
<title>expert2_up_15</title>
<polygon fill="lightgreen" stroke="black" points="798,-2507.77 582,-2507.77 582,-2454.77 798,-2454.77 798,-2507.77"/>
<text text-anchor="middle" x="690" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="690" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="690" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_15&#45;&gt;expert2_up_15 -->
<g id="edge793" class="edge">
<title>gate_15&#45;&gt;expert2_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1057.36,-2605.01C1000.28,-2592.81 929.13,-2575.84 867,-2555.77 828.96,-2543.48 787.64,-2526.53 754.5,-2512.01"/>
<polygon fill="blue" stroke="blue" points="755.5,-2508.63 744.94,-2507.79 752.67,-2515.03 755.5,-2508.63"/>
<text text-anchor="middle" x="927.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="927.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;16</text>
</g>
<!-- expert3_up_15 -->
<g id="node639" class="node">
<title>expert3_up_15</title>
<polygon fill="lightgreen" stroke="black" points="1036,-2507.77 820,-2507.77 820,-2454.77 1036,-2454.77 1036,-2507.77"/>
<text text-anchor="middle" x="928" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="928" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="928" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_15&#45;&gt;expert3_up_15 -->
<g id="edge798" class="edge">
<title>gate_15&#45;&gt;expert3_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1101.48,-2591.95C1081.35,-2580.75 1059.07,-2568.01 1039,-2555.77 1017.17,-2542.45 993.48,-2526.92 973.61,-2513.57"/>
<polygon fill="blue" stroke="blue" points="975.31,-2510.49 965.06,-2507.8 971.39,-2516.3 975.31,-2510.49"/>
<text text-anchor="middle" x="1099.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1099.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;17</text>
</g>
<!-- expert4_up_15 -->
<g id="node643" class="node">
<title>expert4_up_15</title>
<polygon fill="lightgreen" stroke="black" points="1272,-2507.77 1056,-2507.77 1056,-2454.77 1272,-2454.77 1272,-2507.77"/>
<text text-anchor="middle" x="1164" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1164" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1164" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- gate_15&#45;&gt;expert4_up_15 -->
<g id="edge803" class="edge">
<title>gate_15&#45;&gt;expert4_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1164,-2573.55C1164,-2555.28 1164,-2535.17 1164,-2518.49"/>
<polygon fill="blue" stroke="blue" points="1167.5,-2518.08 1164,-2508.08 1160.5,-2518.08 1167.5,-2518.08"/>
<text text-anchor="middle" x="1224.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1224.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;18</text>
</g>
<!-- expert5_up_15 -->
<g id="node647" class="node">
<title>expert5_up_15</title>
<polygon fill="lightgreen" stroke="black" points="1506,-2507.77 1290,-2507.77 1290,-2454.77 1506,-2454.77 1506,-2507.77"/>
<text text-anchor="middle" x="1398" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1398" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1398" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- gate_15&#45;&gt;expert5_up_15 -->
<g id="edge808" class="edge">
<title>gate_15&#45;&gt;expert5_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1226.58,-2592.05C1246.71,-2580.85 1268.99,-2568.09 1289,-2555.77 1310.5,-2542.53 1333.77,-2527.01 1353.27,-2513.65"/>
<polygon fill="blue" stroke="blue" points="1355.41,-2516.42 1361.66,-2507.87 1351.44,-2510.66 1355.41,-2516.42"/>
<text text-anchor="middle" x="1394.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1394.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;19</text>
</g>
<!-- expert6_up_15 -->
<g id="node651" class="node">
<title>expert6_up_15</title>
<polygon fill="lightgreen" stroke="black" points="1741,-2507.77 1525,-2507.77 1525,-2454.77 1741,-2454.77 1741,-2507.77"/>
<text text-anchor="middle" x="1633" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1633" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1633" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- gate_15&#45;&gt;expert6_up_15 -->
<g id="edge813" class="edge">
<title>gate_15&#45;&gt;expert6_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1270.31,-2605.03C1326.96,-2592.85 1397.47,-2575.91 1459,-2555.77 1496.44,-2543.51 1537.06,-2526.57 1569.63,-2512.04"/>
<polygon fill="blue" stroke="blue" points="1571.35,-2515.11 1579.03,-2507.82 1568.48,-2508.72 1571.35,-2515.11"/>
<text text-anchor="middle" x="1596.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1596.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;20</text>
</g>
<!-- expert7_up_15 -->
<g id="node655" class="node">
<title>expert7_up_15</title>
<polygon fill="lightgreen" stroke="black" points="1977,-2507.77 1761,-2507.77 1761,-2454.77 1977,-2454.77 1977,-2507.77"/>
<text text-anchor="middle" x="1869" y="-2492.57" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1869" y="-2477.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1869" y="-2462.57" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- gate_15&#45;&gt;expert7_up_15 -->
<g id="edge818" class="edge">
<title>gate_15&#45;&gt;expert7_up_15</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1300.65,-2613.94C1401.28,-2603.44 1540.91,-2585.13 1661,-2555.77 1707.4,-2544.42 1757.96,-2526.69 1797.61,-2511.48"/>
<polygon fill="blue" stroke="blue" points="1799.12,-2514.65 1807.18,-2507.77 1796.59,-2508.12 1799.12,-2514.65"/>
<text text-anchor="middle" x="1813.5" y="-2544.57" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1813.5" y="-2529.57" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;21</text>
</g>
<!-- expert0_act_15 -->
<g id="node628" class="node">
<title>expert0_act_15</title>
<polygon fill="lightgreen" stroke="black" points="290,-2417.77 122,-2417.77 122,-2364.77 290,-2364.77 290,-2417.77"/>
<text text-anchor="middle" x="206" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="206" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="206" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert0_up_15&#45;&gt;expert0_act_15 -->
<g id="edge784" class="edge">
<title>expert0_up_15&#45;&gt;expert0_act_15</title>
<path fill="none" stroke="black" d="M208.82,-2454.34C208.45,-2446.1 208.03,-2436.85 207.63,-2428.04"/>
<polygon fill="black" stroke="black" points="211.12,-2427.84 207.17,-2418.01 204.13,-2428.16 211.12,-2427.84"/>
</g>
<!-- expert0_down_15 -->
<g id="node629" class="node">
<title>expert0_down_15</title>
<polygon fill="lightgreen" stroke="black" points="307,-2327.77 91,-2327.77 91,-2274.77 307,-2274.77 307,-2327.77"/>
<text text-anchor="middle" x="199" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="199" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="199" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert0_act_15&#45;&gt;expert0_down_15 -->
<g id="edge785" class="edge">
<title>expert0_act_15&#45;&gt;expert0_down_15</title>
<path fill="none" stroke="black" d="M203.94,-2364.34C203.28,-2356.1 202.55,-2346.85 201.85,-2338.04"/>
<polygon fill="black" stroke="black" points="205.33,-2337.7 201.05,-2328.01 198.35,-2338.25 205.33,-2337.7"/>
</g>
<!-- expert0_agg_15 -->
<g id="node630" class="node">
<title>expert0_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="192" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="192" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="192" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="192" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- expert0_down_15&#45;&gt;expert0_agg_15 -->
<g id="edge786" class="edge">
<title>expert0_down_15&#45;&gt;expert0_agg_15</title>
<path fill="none" stroke="black" d="M197.18,-2274.52C196.61,-2266.45 195.96,-2257.27 195.32,-2248.21"/>
<polygon fill="black" stroke="black" points="198.8,-2247.82 194.6,-2238.09 191.82,-2248.31 198.8,-2247.82"/>
</g>
<!-- expert_agg_15 -->
<g id="node659" class="node">
<title>expert_agg_15</title>
<polygon fill="gold" stroke="black" points="1328.69,-2096.81 1066.71,-2096.81 999.31,-1990.81 1261.29,-1990.81 1328.69,-2096.81"/>
<text text-anchor="middle" x="1164" y="-2055.11" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1164" y="-2040.11" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1164" y="-2025.11" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert0_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge787" class="edge">
<title>expert0_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M252.1,-2168.6C291.66,-2149.84 345.16,-2127.15 395,-2114.81 609.88,-2061.64 867.5,-2047.94 1023.32,-2044.91"/>
<polygon fill="purple" stroke="purple" points="1023.5,-2048.41 1033.44,-2044.73 1023.37,-2041.41 1023.5,-2048.41"/>
<text text-anchor="middle" x="466.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;21</text>
<text text-anchor="middle" x="466.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_15 -->
<g id="node632" class="node">
<title>expert1_act_15</title>
<polygon fill="lightgreen" stroke="black" points="529,-2417.77 361,-2417.77 361,-2364.77 529,-2364.77 529,-2417.77"/>
<text text-anchor="middle" x="445" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="445" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="445" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert1_up_15&#45;&gt;expert1_act_15 -->
<g id="edge789" class="edge">
<title>expert1_up_15&#45;&gt;expert1_act_15</title>
<path fill="none" stroke="black" d="M446.41,-2454.34C446.22,-2446.1 446.01,-2436.85 445.81,-2428.04"/>
<polygon fill="black" stroke="black" points="449.31,-2427.93 445.59,-2418.01 442.31,-2428.09 449.31,-2427.93"/>
</g>
<!-- expert1_down_15 -->
<g id="node633" class="node">
<title>expert1_down_15</title>
<polygon fill="lightgreen" stroke="black" points="550,-2327.77 334,-2327.77 334,-2274.77 550,-2274.77 550,-2327.77"/>
<text text-anchor="middle" x="442" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="442" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="442" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert1_act_15&#45;&gt;expert1_down_15 -->
<g id="edge790" class="edge">
<title>expert1_act_15&#45;&gt;expert1_down_15</title>
<path fill="none" stroke="black" d="M444.12,-2364.34C443.84,-2356.1 443.52,-2346.85 443.22,-2338.04"/>
<polygon fill="black" stroke="black" points="446.72,-2337.88 442.88,-2328.01 439.72,-2338.12 446.72,-2337.88"/>
</g>
<!-- expert1_agg_15 -->
<g id="node634" class="node">
<title>expert1_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="435" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="435" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="435" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="435" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert1_down_15&#45;&gt;expert1_agg_15 -->
<g id="edge791" class="edge">
<title>expert1_down_15&#45;&gt;expert1_agg_15</title>
<path fill="none" stroke="black" d="M440.18,-2274.52C439.61,-2266.45 438.96,-2257.27 438.32,-2248.21"/>
<polygon fill="black" stroke="black" points="441.8,-2247.82 437.6,-2238.09 434.82,-2248.31 441.8,-2247.82"/>
</g>
<!-- expert1_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge792" class="edge">
<title>expert1_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M492.69,-2167.85C528.82,-2149.54 576.93,-2127.6 622,-2114.81 756.65,-2076.62 916.1,-2059.2 1027.05,-2051.3"/>
<polygon fill="purple" stroke="purple" points="1027.56,-2054.77 1037.29,-2050.58 1027.07,-2047.79 1027.56,-2054.77"/>
<text text-anchor="middle" x="693.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;21</text>
<text text-anchor="middle" x="693.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_15 -->
<g id="node636" class="node">
<title>expert2_act_15</title>
<polygon fill="lightgreen" stroke="black" points="768,-2417.77 600,-2417.77 600,-2364.77 768,-2364.77 768,-2417.77"/>
<text text-anchor="middle" x="684" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="684" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="684" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert2_up_15&#45;&gt;expert2_act_15 -->
<g id="edge794" class="edge">
<title>expert2_up_15&#45;&gt;expert2_act_15</title>
<path fill="none" stroke="black" d="M688.23,-2454.34C687.67,-2446.1 687.04,-2436.85 686.44,-2428.04"/>
<polygon fill="black" stroke="black" points="689.93,-2427.75 685.76,-2418.01 682.94,-2428.22 689.93,-2427.75"/>
</g>
<!-- expert2_down_15 -->
<g id="node637" class="node">
<title>expert2_down_15</title>
<polygon fill="lightgreen" stroke="black" points="788,-2327.77 572,-2327.77 572,-2274.77 788,-2274.77 788,-2327.77"/>
<text text-anchor="middle" x="680" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="680" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="680" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert2_act_15&#45;&gt;expert2_down_15 -->
<g id="edge795" class="edge">
<title>expert2_act_15&#45;&gt;expert2_down_15</title>
<path fill="none" stroke="black" d="M682.82,-2364.34C682.45,-2356.1 682.03,-2346.85 681.63,-2338.04"/>
<polygon fill="black" stroke="black" points="685.12,-2337.84 681.17,-2328.01 678.13,-2338.16 685.12,-2337.84"/>
</g>
<!-- expert2_agg_15 -->
<g id="node638" class="node">
<title>expert2_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="678" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="678" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="678" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="678" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert2_down_15&#45;&gt;expert2_agg_15 -->
<g id="edge796" class="edge">
<title>expert2_down_15&#45;&gt;expert2_agg_15</title>
<path fill="none" stroke="black" d="M679.48,-2274.52C679.32,-2266.45 679.13,-2257.27 678.95,-2248.21"/>
<polygon fill="black" stroke="black" points="682.44,-2248.01 678.74,-2238.09 675.45,-2248.16 682.44,-2248.01"/>
</g>
<!-- expert2_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge797" class="edge">
<title>expert2_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M727.87,-2166.55C756.68,-2148.94 794.22,-2128.16 830,-2114.81 895.21,-2090.5 970.9,-2073.76 1033.72,-2062.76"/>
<polygon fill="purple" stroke="purple" points="1034.42,-2066.19 1043.69,-2061.05 1033.24,-2059.29 1034.42,-2066.19"/>
<text text-anchor="middle" x="901.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;21</text>
<text text-anchor="middle" x="901.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_15 -->
<g id="node640" class="node">
<title>expert3_act_15</title>
<polygon fill="lightgreen" stroke="black" points="1009,-2417.77 841,-2417.77 841,-2364.77 1009,-2364.77 1009,-2417.77"/>
<text text-anchor="middle" x="925" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="925" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="925" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert3_up_15&#45;&gt;expert3_act_15 -->
<g id="edge799" class="edge">
<title>expert3_up_15&#45;&gt;expert3_act_15</title>
<path fill="none" stroke="black" d="M927.12,-2454.34C926.84,-2446.1 926.52,-2436.85 926.22,-2428.04"/>
<polygon fill="black" stroke="black" points="929.72,-2427.88 925.88,-2418.01 922.72,-2428.12 929.72,-2427.88"/>
</g>
<!-- expert3_down_15 -->
<g id="node641" class="node">
<title>expert3_down_15</title>
<polygon fill="lightgreen" stroke="black" points="1032,-2327.77 816,-2327.77 816,-2274.77 1032,-2274.77 1032,-2327.77"/>
<text text-anchor="middle" x="924" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="924" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="924" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert3_act_15&#45;&gt;expert3_down_15 -->
<g id="edge800" class="edge">
<title>expert3_act_15&#45;&gt;expert3_down_15</title>
<path fill="none" stroke="black" d="M924.71,-2364.34C924.61,-2356.1 924.51,-2346.85 924.41,-2338.04"/>
<polygon fill="black" stroke="black" points="927.91,-2337.97 924.29,-2328.01 920.91,-2338.05 927.91,-2337.97"/>
</g>
<!-- expert3_agg_15 -->
<g id="node642" class="node">
<title>expert3_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="921" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="921" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="921" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="921" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert3_down_15&#45;&gt;expert3_agg_15 -->
<g id="edge801" class="edge">
<title>expert3_down_15&#45;&gt;expert3_agg_15</title>
<path fill="none" stroke="black" d="M923.22,-2274.52C922.97,-2266.45 922.7,-2257.27 922.42,-2248.21"/>
<polygon fill="black" stroke="black" points="925.92,-2247.98 922.12,-2238.09 918.92,-2248.19 925.92,-2247.98"/>
</g>
<!-- expert3_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge802" class="edge">
<title>expert3_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M955.99,-2164.27C973.4,-2147.99 995.32,-2129.11 1017,-2114.81 1028.2,-2107.42 1040.31,-2100.37 1052.59,-2093.78"/>
<polygon fill="purple" stroke="purple" points="1054.34,-2096.81 1061.56,-2089.06 1051.08,-2090.62 1054.34,-2096.81"/>
<text text-anchor="middle" x="1088.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;21</text>
<text text-anchor="middle" x="1088.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_15 -->
<g id="node644" class="node">
<title>expert4_act_15</title>
<polygon fill="lightgreen" stroke="black" points="1248,-2417.77 1080,-2417.77 1080,-2364.77 1248,-2364.77 1248,-2417.77"/>
<text text-anchor="middle" x="1164" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1164" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1164" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert4_up_15&#45;&gt;expert4_act_15 -->
<g id="edge804" class="edge">
<title>expert4_up_15&#45;&gt;expert4_act_15</title>
<path fill="none" stroke="black" d="M1164,-2454.34C1164,-2446.1 1164,-2436.85 1164,-2428.04"/>
<polygon fill="black" stroke="black" points="1167.5,-2428.01 1164,-2418.01 1160.5,-2428.01 1167.5,-2428.01"/>
</g>
<!-- expert4_down_15 -->
<g id="node645" class="node">
<title>expert4_down_15</title>
<polygon fill="lightgreen" stroke="black" points="1272,-2327.77 1056,-2327.77 1056,-2274.77 1272,-2274.77 1272,-2327.77"/>
<text text-anchor="middle" x="1164" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1164" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1164" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert4_act_15&#45;&gt;expert4_down_15 -->
<g id="edge805" class="edge">
<title>expert4_act_15&#45;&gt;expert4_down_15</title>
<path fill="none" stroke="black" d="M1164,-2364.34C1164,-2356.1 1164,-2346.85 1164,-2338.04"/>
<polygon fill="black" stroke="black" points="1167.5,-2338.01 1164,-2328.01 1160.5,-2338.01 1167.5,-2338.01"/>
</g>
<!-- expert4_agg_15 -->
<g id="node646" class="node">
<title>expert4_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="1164" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1164" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1164" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1164" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert4_down_15&#45;&gt;expert4_agg_15 -->
<g id="edge806" class="edge">
<title>expert4_down_15&#45;&gt;expert4_agg_15</title>
<path fill="none" stroke="black" d="M1164,-2274.52C1164,-2266.45 1164,-2257.27 1164,-2248.21"/>
<polygon fill="black" stroke="black" points="1167.5,-2248.09 1164,-2238.09 1160.5,-2248.09 1167.5,-2248.09"/>
</g>
<!-- expert4_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge807" class="edge">
<title>expert4_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1164,-2162.68C1164,-2146.04 1164,-2125.89 1164,-2106.99"/>
<polygon fill="purple" stroke="purple" points="1167.5,-2106.94 1164,-2096.94 1160.5,-2106.94 1167.5,-2106.94"/>
<text text-anchor="middle" x="1235.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;18→GPU&#45;21</text>
<text text-anchor="middle" x="1235.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_15 -->
<g id="node648" class="node">
<title>expert5_act_15</title>
<polygon fill="lightgreen" stroke="black" points="1484,-2417.77 1316,-2417.77 1316,-2364.77 1484,-2364.77 1484,-2417.77"/>
<text text-anchor="middle" x="1400" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1400" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1400" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert5_up_15&#45;&gt;expert5_act_15 -->
<g id="edge809" class="edge">
<title>expert5_up_15&#45;&gt;expert5_act_15</title>
<path fill="none" stroke="black" d="M1398.59,-2454.34C1398.78,-2446.1 1398.99,-2436.85 1399.19,-2428.04"/>
<polygon fill="black" stroke="black" points="1402.69,-2428.09 1399.41,-2418.01 1395.69,-2427.93 1402.69,-2428.09"/>
</g>
<!-- expert5_down_15 -->
<g id="node649" class="node">
<title>expert5_down_15</title>
<polygon fill="lightgreen" stroke="black" points="1510,-2327.77 1294,-2327.77 1294,-2274.77 1510,-2274.77 1510,-2327.77"/>
<text text-anchor="middle" x="1402" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1402" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1402" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert5_act_15&#45;&gt;expert5_down_15 -->
<g id="edge810" class="edge">
<title>expert5_act_15&#45;&gt;expert5_down_15</title>
<path fill="none" stroke="black" d="M1400.59,-2364.34C1400.78,-2356.1 1400.99,-2346.85 1401.19,-2338.04"/>
<polygon fill="black" stroke="black" points="1404.69,-2338.09 1401.41,-2328.01 1397.69,-2337.93 1404.69,-2338.09"/>
</g>
<!-- expert5_agg_15 -->
<g id="node650" class="node">
<title>expert5_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="1407" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1407" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1407" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1407" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert5_down_15&#45;&gt;expert5_agg_15 -->
<g id="edge811" class="edge">
<title>expert5_down_15&#45;&gt;expert5_agg_15</title>
<path fill="none" stroke="black" d="M1403.3,-2274.52C1403.71,-2266.45 1404.17,-2257.27 1404.63,-2248.21"/>
<polygon fill="black" stroke="black" points="1408.13,-2248.25 1405.14,-2238.09 1401.14,-2247.9 1408.13,-2248.25"/>
</g>
<!-- expert5_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge812" class="edge">
<title>expert5_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1372.01,-2164.27C1354.6,-2147.99 1332.68,-2129.11 1311,-2114.81 1304.36,-2110.44 1297.41,-2106.18 1290.29,-2102.06"/>
<polygon fill="purple" stroke="purple" points="1291.62,-2098.79 1281.2,-2096.93 1288.18,-2104.89 1291.62,-2098.79"/>
<text text-anchor="middle" x="1421.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;19→GPU&#45;21</text>
<text text-anchor="middle" x="1421.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_15 -->
<g id="node652" class="node">
<title>expert6_act_15</title>
<polygon fill="lightgreen" stroke="black" points="1723,-2417.77 1555,-2417.77 1555,-2364.77 1723,-2364.77 1723,-2417.77"/>
<text text-anchor="middle" x="1639" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1639" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1639" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert6_up_15&#45;&gt;expert6_act_15 -->
<g id="edge814" class="edge">
<title>expert6_up_15&#45;&gt;expert6_act_15</title>
<path fill="none" stroke="black" d="M1634.77,-2454.34C1635.33,-2446.1 1635.96,-2436.85 1636.56,-2428.04"/>
<polygon fill="black" stroke="black" points="1640.06,-2428.22 1637.24,-2418.01 1633.07,-2427.75 1640.06,-2428.22"/>
</g>
<!-- expert6_down_15 -->
<g id="node653" class="node">
<title>expert6_down_15</title>
<polygon fill="lightgreen" stroke="black" points="1748,-2327.77 1532,-2327.77 1532,-2274.77 1748,-2274.77 1748,-2327.77"/>
<text text-anchor="middle" x="1640" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1640" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1640" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert6_act_15&#45;&gt;expert6_down_15 -->
<g id="edge815" class="edge">
<title>expert6_act_15&#45;&gt;expert6_down_15</title>
<path fill="none" stroke="black" d="M1639.29,-2364.34C1639.39,-2356.1 1639.49,-2346.85 1639.59,-2338.04"/>
<polygon fill="black" stroke="black" points="1643.09,-2338.05 1639.71,-2328.01 1636.09,-2337.97 1643.09,-2338.05"/>
</g>
<!-- expert6_agg_15 -->
<g id="node654" class="node">
<title>expert6_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="1650" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1650" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1650" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1650" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert6_down_15&#45;&gt;expert6_agg_15 -->
<g id="edge816" class="edge">
<title>expert6_down_15&#45;&gt;expert6_agg_15</title>
<path fill="none" stroke="black" d="M1642.6,-2274.52C1643.42,-2266.45 1644.34,-2257.27 1645.26,-2248.21"/>
<polygon fill="black" stroke="black" points="1648.76,-2248.39 1646.28,-2238.09 1641.79,-2247.68 1648.76,-2248.39"/>
</g>
<!-- expert6_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge817" class="edge">
<title>expert6_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1599.78,-2166.57C1570.76,-2148.97 1532.98,-2128.19 1497,-2114.81 1440.58,-2093.85 1376.33,-2078.48 1319.41,-2067.58"/>
<polygon fill="purple" stroke="purple" points="1319.72,-2064.07 1309.24,-2065.66 1318.42,-2070.95 1319.72,-2064.07"/>
<text text-anchor="middle" x="1628.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;20→GPU&#45;21</text>
<text text-anchor="middle" x="1628.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_15 -->
<g id="node656" class="node">
<title>expert7_act_15</title>
<polygon fill="lightgreen" stroke="black" points="1963,-2417.77 1795,-2417.77 1795,-2364.77 1963,-2364.77 1963,-2417.77"/>
<text text-anchor="middle" x="1879" y="-2402.57" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1879" y="-2387.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1879" y="-2372.57" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert7_up_15&#45;&gt;expert7_act_15 -->
<g id="edge819" class="edge">
<title>expert7_up_15&#45;&gt;expert7_act_15</title>
<path fill="none" stroke="black" d="M1871.95,-2454.34C1872.88,-2446.1 1873.93,-2436.85 1874.93,-2428.04"/>
<polygon fill="black" stroke="black" points="1878.42,-2428.34 1876.07,-2418.01 1871.47,-2427.55 1878.42,-2428.34"/>
</g>
<!-- expert7_down_15 -->
<g id="node657" class="node">
<title>expert7_down_15</title>
<polygon fill="lightgreen" stroke="black" points="1990,-2327.77 1774,-2327.77 1774,-2274.77 1990,-2274.77 1990,-2327.77"/>
<text text-anchor="middle" x="1882" y="-2312.57" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1882" y="-2297.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1882" y="-2282.57" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert7_act_15&#45;&gt;expert7_down_15 -->
<g id="edge820" class="edge">
<title>expert7_act_15&#45;&gt;expert7_down_15</title>
<path fill="none" stroke="black" d="M1879.88,-2364.34C1880.16,-2356.1 1880.48,-2346.85 1880.78,-2338.04"/>
<polygon fill="black" stroke="black" points="1884.28,-2338.12 1881.12,-2328.01 1877.28,-2337.88 1884.28,-2338.12"/>
</g>
<!-- expert7_agg_15 -->
<g id="node658" class="node">
<title>expert7_agg_15</title>
<ellipse fill="lightgray" stroke="black" cx="1893" cy="-2200.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1893" y="-2211.59" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1893" y="-2196.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1893" y="-2181.59" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert7_down_15&#45;&gt;expert7_agg_15 -->
<g id="edge821" class="edge">
<title>expert7_down_15&#45;&gt;expert7_agg_15</title>
<path fill="none" stroke="black" d="M1884.86,-2274.52C1885.76,-2266.45 1886.78,-2257.27 1887.79,-2248.21"/>
<polygon fill="black" stroke="black" points="1891.28,-2248.41 1888.91,-2238.09 1884.33,-2247.64 1891.28,-2248.41"/>
</g>
<!-- expert7_agg_15&#45;&gt;expert_agg_15 -->
<g id="edge822" class="edge">
<title>expert7_agg_15&#45;&gt;expert_agg_15</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1835.07,-2168.09C1798.49,-2149.74 1749.66,-2127.68 1704,-2114.81 1573.63,-2078.08 1420.04,-2060.54 1310.06,-2052.21"/>
<polygon fill="purple" stroke="purple" points="1310.12,-2048.71 1299.89,-2051.46 1309.6,-2055.69 1310.12,-2048.71"/>
<text text-anchor="middle" x="1854.5" y="-2133.61" font-family="Times,serif" font-size="14.00">GPU&#45;21→GPU&#45;21</text>
<text text-anchor="middle" x="1854.5" y="-2118.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_15&#45;&gt;residual2_15 -->
<g id="edge823" class="edge">
<title>expert_agg_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1270.01,-2004.19C1321.2,-1985.54 1382.74,-1963.12 1435.16,-1944.02"/>
<polygon fill="black" stroke="black" points="1436.64,-1947.2 1444.84,-1940.49 1434.25,-1940.63 1436.64,-1947.2"/>
</g>
<!-- layer_out_15 -->
<g id="node661" class="node">
<title>layer_out_15</title>
<ellipse fill="lightgray" stroke="black" cx="1551" cy="-1773.34" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1551" y="-1784.64" font-family="Times,serif" font-size="14.00">Layer15_Output</text>
<text text-anchor="middle" x="1551" y="-1769.64" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1551" y="-1754.64" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- residual2_15&#45;&gt;layer_out_15 -->
<g id="edge825" class="edge">
<title>residual2_15&#45;&gt;layer_out_15</title>
<path fill="none" stroke="black" d="M1551,-1847.69C1551,-1838.79 1551,-1829.59 1551,-1820.84"/>
<polygon fill="black" stroke="black" points="1554.5,-1820.82 1551,-1810.82 1547.5,-1820.82 1554.5,-1820.82"/>
</g>
<!-- ln1_16 -->
<g id="node662" class="node">
<title>ln1_16</title>
<polygon fill="lightyellow" stroke="black" points="1357.5,-1648.86 1198.5,-1648.86 1198.5,-1595.86 1357.5,-1595.86 1357.5,-1648.86"/>
<text text-anchor="middle" x="1278" y="-1633.66" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1278" y="-1618.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1278" y="-1603.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- layer_out_15&#45;&gt;ln1_16 -->
<g id="edge826" class="edge">
<title>layer_out_15&#45;&gt;ln1_16</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1493.44,-1740.92C1446.51,-1715.31 1380.61,-1679.35 1334.08,-1653.96"/>
<polygon fill="red" stroke="red" points="1335.5,-1650.75 1325.05,-1649.03 1332.15,-1656.9 1335.5,-1650.75"/>
<text text-anchor="middle" x="1517.5" y="-1706.66" font-family="Times,serif" font-size="14.00">GPU&#45;119→GPU&#45;15</text>
<text text-anchor="middle" x="1517.5" y="-1691.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_16 -->
<g id="node668" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="1754.69,-1288.86 1492.71,-1288.86 1425.31,-1182.86 1687.29,-1182.86 1754.69,-1288.86"/>
<text text-anchor="middle" x="1590" y="-1247.16" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1590" y="-1232.16" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1590" y="-1217.16" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- layer_out_15&#45;&gt;residual1_16 -->
<g id="edge834" class="edge">
<title>layer_out_15&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M1584.99,-1737.61C1609.03,-1709.29 1637,-1666.96 1637,-1623.36 1637,-1623.36 1637,-1623.36 1637,-1351.36 1637,-1333.49 1632.04,-1315.14 1625.34,-1298.52"/>
<polygon fill="black" stroke="black" points="1628.39,-1296.74 1621.22,-1288.94 1621.96,-1299.51 1628.39,-1296.74"/>
</g>
<!-- mha_q_16 -->
<g id="node663" class="node">
<title>mha_q_16</title>
<polygon fill="lightcoral" stroke="black" points="1134.5,-1558.86 915.5,-1558.86 915.5,-1505.86 1134.5,-1505.86 1134.5,-1558.86"/>
<text text-anchor="middle" x="1025" y="-1543.66" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="1025" y="-1528.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1025" y="-1513.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_q_16 -->
<g id="edge827" class="edge">
<title>ln1_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M1204.48,-1595.79C1174.34,-1585.3 1139.29,-1573.11 1108.21,-1562.3"/>
<polygon fill="black" stroke="black" points="1109.3,-1558.97 1098.7,-1559 1107,-1565.59 1109.3,-1558.97"/>
</g>
<!-- mha_k_16 -->
<g id="node664" class="node">
<title>mha_k_16</title>
<polygon fill="lightcoral" stroke="black" points="1371.5,-1558.86 1152.5,-1558.86 1152.5,-1505.86 1371.5,-1505.86 1371.5,-1558.86"/>
<text text-anchor="middle" x="1262" y="-1543.66" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1262" y="-1528.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1262" y="-1513.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_k_16 -->
<g id="edge828" class="edge">
<title>ln1_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M1273.29,-1595.43C1271.79,-1587.2 1270.11,-1577.94 1268.5,-1569.14"/>
<polygon fill="black" stroke="black" points="1271.91,-1568.31 1266.68,-1559.1 1265.03,-1569.57 1271.91,-1568.31"/>
</g>
<!-- mha_v_16 -->
<g id="node665" class="node">
<title>mha_v_16</title>
<polygon fill="lightcoral" stroke="black" points="1608.5,-1558.86 1389.5,-1558.86 1389.5,-1505.86 1608.5,-1505.86 1608.5,-1558.86"/>
<text text-anchor="middle" x="1499" y="-1543.66" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1499" y="-1528.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1499" y="-1513.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_v_16 -->
<g id="edge829" class="edge">
<title>ln1_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M1342.22,-1595.79C1368.21,-1585.44 1398.37,-1573.43 1425.26,-1562.72"/>
<polygon fill="black" stroke="black" points="1426.62,-1565.95 1434.62,-1559 1424.04,-1559.44 1426.62,-1565.95"/>
</g>
<!-- mha_attn_16 -->
<g id="node666" class="node">
<title>mha_attn_16</title>
<polygon fill="lightcoral" stroke="black" points="1397.5,-1468.86 1226.5,-1468.86 1226.5,-1415.86 1397.5,-1415.86 1397.5,-1468.86"/>
<text text-anchor="middle" x="1312" y="-1453.66" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1312" y="-1438.66" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1312" y="-1423.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge830" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1108.4,-1505.79C1142.89,-1495.21 1183.04,-1482.9 1218.52,-1472.02"/>
<polygon fill="black" stroke="black" points="1219.86,-1475.27 1228.39,-1469 1217.81,-1468.58 1219.86,-1475.27"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge831" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1276.73,-1505.43C1281.61,-1496.84 1287.13,-1487.13 1292.32,-1477.99"/>
<polygon fill="black" stroke="black" points="1295.48,-1479.53 1297.37,-1469.1 1289.39,-1476.07 1295.48,-1479.53"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge832" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1444.66,-1505.79C1423.05,-1495.62 1398.04,-1483.85 1375.59,-1473.28"/>
<polygon fill="black" stroke="black" points="1377.01,-1470.09 1366.47,-1469 1374.03,-1476.42 1377.01,-1470.09"/>
</g>
<!-- mha_out_16 -->
<g id="node667" class="node">
<title>mha_out_16</title>
<polygon fill="lightcoral" stroke="black" points="1542.5,-1378.86 1383.5,-1378.86 1383.5,-1325.86 1542.5,-1325.86 1542.5,-1378.86"/>
<text text-anchor="middle" x="1463" y="-1363.66" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1463" y="-1348.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1463" y="-1333.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge833" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M1356.08,-1415.67C1372.98,-1405.82 1392.44,-1394.48 1410.09,-1384.2"/>
<polygon fill="black" stroke="black" points="1412.25,-1386.99 1419.12,-1378.93 1408.72,-1380.94 1412.25,-1386.99"/>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge835" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M1491.5,-1325.66C1501.4,-1316.74 1512.95,-1306.33 1524.58,-1295.84"/>
<polygon fill="black" stroke="black" points="1527.14,-1298.24 1532.22,-1288.95 1522.45,-1293.05 1527.14,-1298.24"/>
</g>
<!-- ln2_16 -->
<g id="node669" class="node">
<title>ln2_16</title>
<polygon fill="lightyellow" stroke="black" points="1605.5,-1145.86 1446.5,-1145.86 1446.5,-1092.86 1605.5,-1092.86 1605.5,-1145.86"/>
<text text-anchor="middle" x="1526" y="-1130.66" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1526" y="-1115.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1526" y="-1100.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge836" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M1560.81,-1182.64C1555.52,-1173.18 1550.14,-1163.54 1545.23,-1154.76"/>
<polygon fill="black" stroke="black" points="1548.24,-1152.98 1540.31,-1145.96 1542.13,-1156.4 1548.24,-1152.98"/>
</g>
<!-- residual2_16 -->
<g id="node704" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="1855.69,-329.91 1593.71,-329.91 1526.31,-223.91 1788.29,-223.91 1855.69,-329.91"/>
<text text-anchor="middle" x="1691" y="-288.21" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1691" y="-273.21" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1691" y="-258.21" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge879" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M1715.21,-1226.54C1844.97,-1214.38 2029,-1185.64 2029,-1120.36 2029,-1120.36 2029,-1120.36 2029,-418.91 2029,-329.65 1927.36,-295.88 1835.55,-283.59"/>
<polygon fill="black" stroke="black" points="1835.92,-280.11 1825.56,-282.33 1835.04,-287.05 1835.92,-280.11"/>
</g>
<!-- gate_16 -->
<g id="node670" class="node">
<title>gate_16</title>
<polygon fill="orange" stroke="black" points="1169,-1055.86 989,-1002.86 1169,-949.86 1349,-1002.86 1169,-1055.86"/>
<text text-anchor="middle" x="1169" y="-1014.16" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="1169" y="-999.16" font-family="Times,serif" font-size="14.00">[1024×2048×4096→8]</text>
<text text-anchor="middle" x="1169" y="-984.16" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln2_16&#45;&gt;gate_16 -->
<g id="edge837" class="edge">
<title>ln2_16&#45;&gt;gate_16</title>
<path fill="none" stroke="black" d="M1446.33,-1092.81C1392.22,-1075.45 1320.44,-1052.43 1263.45,-1034.15"/>
<polygon fill="black" stroke="black" points="1264.31,-1030.75 1253.72,-1031.03 1262.17,-1037.42 1264.31,-1030.75"/>
</g>
<!-- expert0_up_16 -->
<g id="node671" class="node">
<title>expert0_up_16</title>
<polygon fill="lightgreen" stroke="black" points="317,-883.86 101,-883.86 101,-830.86 317,-830.86 317,-883.86"/>
<text text-anchor="middle" x="209" y="-868.66" font-family="Times,serif" font-size="14.00">Expert0 Up</text>
<text text-anchor="middle" x="209" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="209" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- gate_16&#45;&gt;expert0_up_16 -->
<g id="edge838" class="edge">
<title>gate_16&#45;&gt;expert0_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1011.24,-996.2C863.03,-988.65 635.68,-971.28 442,-931.86 389.14,-921.1 331.3,-902.9 286.48,-887.29"/>
<polygon fill="blue" stroke="blue" points="287.42,-883.92 276.82,-883.91 285.1,-890.52 287.42,-883.92"/>
<text text-anchor="middle" x="502.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="502.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;15</text>
</g>
<!-- expert1_up_16 -->
<g id="node675" class="node">
<title>expert1_up_16</title>
<polygon fill="lightgreen" stroke="black" points="552,-883.86 336,-883.86 336,-830.86 552,-830.86 552,-883.86"/>
<text text-anchor="middle" x="444" y="-868.66" font-family="Times,serif" font-size="14.00">Expert1 Up</text>
<text text-anchor="middle" x="444" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="444" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- gate_16&#45;&gt;expert1_up_16 -->
<g id="edge843" class="edge">
<title>gate_16&#45;&gt;expert1_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1033.55,-989.74C931.6,-979 788.9,-960.51 666,-931.86 616.56,-920.34 562.45,-902.53 520.03,-887.34"/>
<polygon fill="blue" stroke="blue" points="521.21,-884.04 510.61,-883.94 518.83,-890.62 521.21,-884.04"/>
<text text-anchor="middle" x="726.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="726.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;16</text>
</g>
<!-- expert2_up_16 -->
<g id="node679" class="node">
<title>expert2_up_16</title>
<polygon fill="lightgreen" stroke="black" points="799,-883.86 583,-883.86 583,-830.86 799,-830.86 799,-883.86"/>
<text text-anchor="middle" x="691" y="-868.66" font-family="Times,serif" font-size="14.00">Expert2 Up</text>
<text text-anchor="middle" x="691" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="691" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- gate_16&#45;&gt;expert2_up_16 -->
<g id="edge848" class="edge">
<title>gate_16&#45;&gt;expert2_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1062.77,-980.98C1005.65,-968.72 934.33,-951.73 872,-931.86 833.16,-919.48 790.89,-902.52 756.97,-888.01"/>
<polygon fill="blue" stroke="blue" points="758.21,-884.73 747.64,-883.99 755.44,-891.16 758.21,-884.73"/>
<text text-anchor="middle" x="932.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="932.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;17</text>
</g>
<!-- expert3_up_16 -->
<g id="node683" class="node">
<title>expert3_up_16</title>
<polygon fill="lightgreen" stroke="black" points="1040,-883.86 824,-883.86 824,-830.86 1040,-830.86 1040,-883.86"/>
<text text-anchor="middle" x="932" y="-868.66" font-family="Times,serif" font-size="14.00">Expert3 Up</text>
<text text-anchor="middle" x="932" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="932" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- gate_16&#45;&gt;expert3_up_16 -->
<g id="edge853" class="edge">
<title>gate_16&#45;&gt;expert3_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1106.51,-968C1086.38,-956.79 1064.09,-944.06 1044,-931.86 1021.91,-918.45 997.89,-902.83 977.78,-889.45"/>
<polygon fill="blue" stroke="blue" points="979.68,-886.51 969.42,-883.86 975.79,-892.33 979.68,-886.51"/>
<text text-anchor="middle" x="1104.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1104.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;18</text>
</g>
<!-- expert4_up_16 -->
<g id="node687" class="node">
<title>expert4_up_16</title>
<polygon fill="lightgreen" stroke="black" points="1277,-883.86 1061,-883.86 1061,-830.86 1277,-830.86 1277,-883.86"/>
<text text-anchor="middle" x="1169" y="-868.66" font-family="Times,serif" font-size="14.00">Expert4 Up</text>
<text text-anchor="middle" x="1169" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1169" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- gate_16&#45;&gt;expert4_up_16 -->
<g id="edge858" class="edge">
<title>gate_16&#45;&gt;expert4_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1169,-949.65C1169,-931.37 1169,-911.27 1169,-894.59"/>
<polygon fill="blue" stroke="blue" points="1172.5,-894.17 1169,-884.17 1165.5,-894.17 1172.5,-894.17"/>
<text text-anchor="middle" x="1229.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1229.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;19</text>
</g>
<!-- expert5_up_16 -->
<g id="node691" class="node">
<title>expert5_up_16</title>
<polygon fill="lightgreen" stroke="black" points="1511,-883.86 1295,-883.86 1295,-830.86 1511,-830.86 1511,-883.86"/>
<text text-anchor="middle" x="1403" y="-868.66" font-family="Times,serif" font-size="14.00">Expert5 Up</text>
<text text-anchor="middle" x="1403" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1403" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- gate_16&#45;&gt;expert5_up_16 -->
<g id="edge863" class="edge">
<title>gate_16&#45;&gt;expert5_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1231.58,-968.15C1251.71,-956.95 1273.99,-944.18 1294,-931.86 1315.5,-918.62 1338.77,-903.1 1358.27,-889.74"/>
<polygon fill="blue" stroke="blue" points="1360.41,-892.52 1366.66,-883.96 1356.44,-886.75 1360.41,-892.52"/>
<text text-anchor="middle" x="1399.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1399.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;20</text>
</g>
<!-- expert6_up_16 -->
<g id="node695" class="node">
<title>expert6_up_16</title>
<polygon fill="lightgreen" stroke="black" points="1746,-883.86 1530,-883.86 1530,-830.86 1746,-830.86 1746,-883.86"/>
<text text-anchor="middle" x="1638" y="-868.66" font-family="Times,serif" font-size="14.00">Expert6 Up</text>
<text text-anchor="middle" x="1638" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1638" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- gate_16&#45;&gt;expert6_up_16 -->
<g id="edge868" class="edge">
<title>gate_16&#45;&gt;expert6_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1275.31,-981.12C1331.96,-968.95 1402.47,-952 1464,-931.86 1501.44,-919.6 1542.06,-902.66 1574.63,-888.14"/>
<polygon fill="blue" stroke="blue" points="1576.35,-891.2 1584.03,-883.91 1573.48,-884.82 1576.35,-891.2"/>
<text text-anchor="middle" x="1601.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1601.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;21</text>
</g>
<!-- expert7_up_16 -->
<g id="node699" class="node">
<title>expert7_up_16</title>
<polygon fill="lightgreen" stroke="black" points="1982,-883.86 1766,-883.86 1766,-830.86 1982,-830.86 1982,-883.86"/>
<text text-anchor="middle" x="1874" y="-868.66" font-family="Times,serif" font-size="14.00">Expert7 Up</text>
<text text-anchor="middle" x="1874" y="-853.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1874" y="-838.66" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- gate_16&#45;&gt;expert7_up_16 -->
<g id="edge873" class="edge">
<title>gate_16&#45;&gt;expert7_up_16</title>
<path fill="none" stroke="blue" stroke-dasharray="5,2" d="M1305.65,-990.03C1406.28,-979.54 1545.91,-961.22 1666,-931.86 1712.4,-920.52 1762.96,-902.78 1802.61,-887.57"/>
<polygon fill="blue" stroke="blue" points="1804.12,-890.74 1812.18,-883.87 1801.59,-884.21 1804.12,-890.74"/>
<text text-anchor="middle" x="1818.5" y="-920.66" font-family="Times,serif" font-size="14.00">Route tokens</text>
<text text-anchor="middle" x="1818.5" y="-905.66" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;22</text>
</g>
<!-- expert0_act_16 -->
<g id="node672" class="node">
<title>expert0_act_16</title>
<polygon fill="lightgreen" stroke="black" points="290,-793.86 122,-793.86 122,-740.86 290,-740.86 290,-793.86"/>
<text text-anchor="middle" x="206" y="-778.66" font-family="Times,serif" font-size="14.00">Expert0 GELU</text>
<text text-anchor="middle" x="206" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="206" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert0_up_16&#45;&gt;expert0_act_16 -->
<g id="edge839" class="edge">
<title>expert0_up_16&#45;&gt;expert0_act_16</title>
<path fill="none" stroke="black" d="M208.12,-830.43C207.84,-822.2 207.52,-812.94 207.22,-804.14"/>
<polygon fill="black" stroke="black" points="210.72,-803.98 206.88,-794.1 203.72,-804.22 210.72,-803.98"/>
</g>
<!-- expert0_down_16 -->
<g id="node673" class="node">
<title>expert0_down_16</title>
<polygon fill="lightgreen" stroke="black" points="312,-703.86 96,-703.86 96,-650.86 312,-650.86 312,-703.86"/>
<text text-anchor="middle" x="204" y="-688.66" font-family="Times,serif" font-size="14.00">Expert0 Down</text>
<text text-anchor="middle" x="204" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="204" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert0_act_16&#45;&gt;expert0_down_16 -->
<g id="edge840" class="edge">
<title>expert0_act_16&#45;&gt;expert0_down_16</title>
<path fill="none" stroke="black" d="M205.41,-740.43C205.22,-732.2 205.01,-722.94 204.81,-714.14"/>
<polygon fill="black" stroke="black" points="208.31,-714.02 204.59,-704.1 201.31,-714.18 208.31,-714.02"/>
</g>
<!-- expert0_agg_16 -->
<g id="node674" class="node">
<title>expert0_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="197" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="197" y="-587.68" font-family="Times,serif" font-size="14.00">Expert0 Output</text>
<text text-anchor="middle" x="197" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="197" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- expert0_down_16&#45;&gt;expert0_agg_16 -->
<g id="edge841" class="edge">
<title>expert0_down_16&#45;&gt;expert0_agg_16</title>
<path fill="none" stroke="black" d="M202.18,-650.61C201.61,-642.54 200.96,-633.36 200.32,-624.3"/>
<polygon fill="black" stroke="black" points="203.8,-623.91 199.6,-614.18 196.82,-624.4 203.8,-623.91"/>
</g>
<!-- expert_agg_16 -->
<g id="node703" class="node">
<title>expert_agg_16</title>
<polygon fill="gold" stroke="black" points="1333.69,-472.91 1071.71,-472.91 1004.31,-366.91 1266.29,-366.91 1333.69,-472.91"/>
<text text-anchor="middle" x="1169" y="-431.21" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="1169" y="-416.21" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1169" y="-401.21" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- expert0_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge842" class="edge">
<title>expert0_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M257.1,-544.69C296.66,-525.93 350.16,-503.24 400,-490.91 614.88,-437.74 872.5,-424.04 1028.32,-421.01"/>
<polygon fill="purple" stroke="purple" points="1028.5,-424.5 1038.44,-420.82 1028.37,-417.51 1028.5,-424.5"/>
<text text-anchor="middle" x="471.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;15→GPU&#45;22</text>
<text text-anchor="middle" x="471.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert1_act_16 -->
<g id="node676" class="node">
<title>expert1_act_16</title>
<polygon fill="lightgreen" stroke="black" points="527,-793.86 359,-793.86 359,-740.86 527,-740.86 527,-793.86"/>
<text text-anchor="middle" x="443" y="-778.66" font-family="Times,serif" font-size="14.00">Expert1 GELU</text>
<text text-anchor="middle" x="443" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="443" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert1_up_16&#45;&gt;expert1_act_16 -->
<g id="edge844" class="edge">
<title>expert1_up_16&#45;&gt;expert1_act_16</title>
<path fill="none" stroke="black" d="M443.71,-830.43C443.61,-822.2 443.51,-812.94 443.41,-804.14"/>
<polygon fill="black" stroke="black" points="446.91,-804.06 443.29,-794.1 439.91,-804.14 446.91,-804.06"/>
</g>
<!-- expert1_down_16 -->
<g id="node677" class="node">
<title>expert1_down_16</title>
<polygon fill="lightgreen" stroke="black" points="548,-703.86 332,-703.86 332,-650.86 548,-650.86 548,-703.86"/>
<text text-anchor="middle" x="440" y="-688.66" font-family="Times,serif" font-size="14.00">Expert1 Down</text>
<text text-anchor="middle" x="440" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="440" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert1_act_16&#45;&gt;expert1_down_16 -->
<g id="edge845" class="edge">
<title>expert1_act_16&#45;&gt;expert1_down_16</title>
<path fill="none" stroke="black" d="M442.12,-740.43C441.84,-732.2 441.52,-722.94 441.22,-714.14"/>
<polygon fill="black" stroke="black" points="444.72,-713.98 440.88,-704.1 437.72,-714.22 444.72,-713.98"/>
</g>
<!-- expert1_agg_16 -->
<g id="node678" class="node">
<title>expert1_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="440" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="440" y="-587.68" font-family="Times,serif" font-size="14.00">Expert1 Output</text>
<text text-anchor="middle" x="440" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="440" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;16</text>
</g>
<!-- expert1_down_16&#45;&gt;expert1_agg_16 -->
<g id="edge846" class="edge">
<title>expert1_down_16&#45;&gt;expert1_agg_16</title>
<path fill="none" stroke="black" d="M440,-650.61C440,-642.54 440,-633.36 440,-624.3"/>
<polygon fill="black" stroke="black" points="443.5,-624.18 440,-614.18 436.5,-624.18 443.5,-624.18"/>
</g>
<!-- expert1_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge847" class="edge">
<title>expert1_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M497.69,-543.95C533.82,-525.63 581.93,-503.69 627,-490.91 761.65,-452.71 921.1,-435.29 1032.05,-427.39"/>
<polygon fill="purple" stroke="purple" points="1032.56,-430.86 1042.29,-426.68 1032.07,-423.88 1032.56,-430.86"/>
<text text-anchor="middle" x="698.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;16→GPU&#45;22</text>
<text text-anchor="middle" x="698.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert2_act_16 -->
<g id="node680" class="node">
<title>expert2_act_16</title>
<polygon fill="lightgreen" stroke="black" points="771,-793.86 603,-793.86 603,-740.86 771,-740.86 771,-793.86"/>
<text text-anchor="middle" x="687" y="-778.66" font-family="Times,serif" font-size="14.00">Expert2 GELU</text>
<text text-anchor="middle" x="687" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="687" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert2_up_16&#45;&gt;expert2_act_16 -->
<g id="edge849" class="edge">
<title>expert2_up_16&#45;&gt;expert2_act_16</title>
<path fill="none" stroke="black" d="M689.82,-830.43C689.45,-822.2 689.03,-812.94 688.63,-804.14"/>
<polygon fill="black" stroke="black" points="692.12,-803.93 688.17,-794.1 685.13,-804.25 692.12,-803.93"/>
</g>
<!-- expert2_down_16 -->
<g id="node681" class="node">
<title>expert2_down_16</title>
<polygon fill="lightgreen" stroke="black" points="793,-703.86 577,-703.86 577,-650.86 793,-650.86 793,-703.86"/>
<text text-anchor="middle" x="685" y="-688.66" font-family="Times,serif" font-size="14.00">Expert2 Down</text>
<text text-anchor="middle" x="685" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="685" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert2_act_16&#45;&gt;expert2_down_16 -->
<g id="edge850" class="edge">
<title>expert2_act_16&#45;&gt;expert2_down_16</title>
<path fill="none" stroke="black" d="M686.41,-740.43C686.22,-732.2 686.01,-722.94 685.81,-714.14"/>
<polygon fill="black" stroke="black" points="689.31,-714.02 685.59,-704.1 682.31,-714.18 689.31,-714.02"/>
</g>
<!-- expert2_agg_16 -->
<g id="node682" class="node">
<title>expert2_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="683" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="683" y="-587.68" font-family="Times,serif" font-size="14.00">Expert2 Output</text>
<text text-anchor="middle" x="683" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="683" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;17</text>
</g>
<!-- expert2_down_16&#45;&gt;expert2_agg_16 -->
<g id="edge851" class="edge">
<title>expert2_down_16&#45;&gt;expert2_agg_16</title>
<path fill="none" stroke="black" d="M684.48,-650.61C684.32,-642.54 684.13,-633.36 683.95,-624.3"/>
<polygon fill="black" stroke="black" points="687.44,-624.11 683.74,-614.18 680.45,-624.25 687.44,-624.11"/>
</g>
<!-- expert2_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge852" class="edge">
<title>expert2_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M732.87,-542.65C761.68,-525.03 799.22,-504.25 835,-490.91 900.21,-466.59 975.9,-449.85 1038.72,-438.86"/>
<polygon fill="purple" stroke="purple" points="1039.42,-442.29 1048.69,-437.14 1038.24,-435.39 1039.42,-442.29"/>
<text text-anchor="middle" x="906.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;17→GPU&#45;22</text>
<text text-anchor="middle" x="906.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert3_act_16 -->
<g id="node684" class="node">
<title>expert3_act_16</title>
<polygon fill="lightgreen" stroke="black" points="1013,-793.86 845,-793.86 845,-740.86 1013,-740.86 1013,-793.86"/>
<text text-anchor="middle" x="929" y="-778.66" font-family="Times,serif" font-size="14.00">Expert3 GELU</text>
<text text-anchor="middle" x="929" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="929" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert3_up_16&#45;&gt;expert3_act_16 -->
<g id="edge854" class="edge">
<title>expert3_up_16&#45;&gt;expert3_act_16</title>
<path fill="none" stroke="black" d="M931.12,-830.43C930.84,-822.2 930.52,-812.94 930.22,-804.14"/>
<polygon fill="black" stroke="black" points="933.72,-803.98 929.88,-794.1 926.72,-804.22 933.72,-803.98"/>
</g>
<!-- expert3_down_16 -->
<g id="node685" class="node">
<title>expert3_down_16</title>
<polygon fill="lightgreen" stroke="black" points="1036,-703.86 820,-703.86 820,-650.86 1036,-650.86 1036,-703.86"/>
<text text-anchor="middle" x="928" y="-688.66" font-family="Times,serif" font-size="14.00">Expert3 Down</text>
<text text-anchor="middle" x="928" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="928" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert3_act_16&#45;&gt;expert3_down_16 -->
<g id="edge855" class="edge">
<title>expert3_act_16&#45;&gt;expert3_down_16</title>
<path fill="none" stroke="black" d="M928.71,-740.43C928.61,-732.2 928.51,-722.94 928.41,-714.14"/>
<polygon fill="black" stroke="black" points="931.91,-714.06 928.29,-704.1 924.91,-714.14 931.91,-714.06"/>
</g>
<!-- expert3_agg_16 -->
<g id="node686" class="node">
<title>expert3_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="926" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="926" y="-587.68" font-family="Times,serif" font-size="14.00">Expert3 Output</text>
<text text-anchor="middle" x="926" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="926" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;18</text>
</g>
<!-- expert3_down_16&#45;&gt;expert3_agg_16 -->
<g id="edge856" class="edge">
<title>expert3_down_16&#45;&gt;expert3_agg_16</title>
<path fill="none" stroke="black" d="M927.48,-650.61C927.32,-642.54 927.13,-633.36 926.95,-624.3"/>
<polygon fill="black" stroke="black" points="930.44,-624.11 926.74,-614.18 923.45,-624.25 930.44,-624.11"/>
</g>
<!-- expert3_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge857" class="edge">
<title>expert3_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M960.99,-540.36C978.4,-524.08 1000.32,-505.21 1022,-490.91 1033.2,-483.52 1045.31,-476.46 1057.59,-469.87"/>
<polygon fill="purple" stroke="purple" points="1059.34,-472.91 1066.56,-465.15 1056.08,-466.71 1059.34,-472.91"/>
<text text-anchor="middle" x="1093.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;18→GPU&#45;22</text>
<text text-anchor="middle" x="1093.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert4_act_16 -->
<g id="node688" class="node">
<title>expert4_act_16</title>
<polygon fill="lightgreen" stroke="black" points="1253,-793.86 1085,-793.86 1085,-740.86 1253,-740.86 1253,-793.86"/>
<text text-anchor="middle" x="1169" y="-778.66" font-family="Times,serif" font-size="14.00">Expert4 GELU</text>
<text text-anchor="middle" x="1169" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1169" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert4_up_16&#45;&gt;expert4_act_16 -->
<g id="edge859" class="edge">
<title>expert4_up_16&#45;&gt;expert4_act_16</title>
<path fill="none" stroke="black" d="M1169,-830.43C1169,-822.2 1169,-812.94 1169,-804.14"/>
<polygon fill="black" stroke="black" points="1172.5,-804.1 1169,-794.1 1165.5,-804.1 1172.5,-804.1"/>
</g>
<!-- expert4_down_16 -->
<g id="node689" class="node">
<title>expert4_down_16</title>
<polygon fill="lightgreen" stroke="black" points="1277,-703.86 1061,-703.86 1061,-650.86 1277,-650.86 1277,-703.86"/>
<text text-anchor="middle" x="1169" y="-688.66" font-family="Times,serif" font-size="14.00">Expert4 Down</text>
<text text-anchor="middle" x="1169" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1169" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert4_act_16&#45;&gt;expert4_down_16 -->
<g id="edge860" class="edge">
<title>expert4_act_16&#45;&gt;expert4_down_16</title>
<path fill="none" stroke="black" d="M1169,-740.43C1169,-732.2 1169,-722.94 1169,-714.14"/>
<polygon fill="black" stroke="black" points="1172.5,-714.1 1169,-704.1 1165.5,-714.1 1172.5,-714.1"/>
</g>
<!-- expert4_agg_16 -->
<g id="node690" class="node">
<title>expert4_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="1169" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1169" y="-587.68" font-family="Times,serif" font-size="14.00">Expert4 Output</text>
<text text-anchor="middle" x="1169" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1169" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;19</text>
</g>
<!-- expert4_down_16&#45;&gt;expert4_agg_16 -->
<g id="edge861" class="edge">
<title>expert4_down_16&#45;&gt;expert4_agg_16</title>
<path fill="none" stroke="black" d="M1169,-650.61C1169,-642.54 1169,-633.36 1169,-624.3"/>
<polygon fill="black" stroke="black" points="1172.5,-624.18 1169,-614.18 1165.5,-624.18 1172.5,-624.18"/>
</g>
<!-- expert4_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge862" class="edge">
<title>expert4_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1169,-538.77C1169,-522.14 1169,-501.98 1169,-483.08"/>
<polygon fill="purple" stroke="purple" points="1172.5,-483.04 1169,-473.04 1165.5,-483.04 1172.5,-483.04"/>
<text text-anchor="middle" x="1240.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;19→GPU&#45;22</text>
<text text-anchor="middle" x="1240.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert5_act_16 -->
<g id="node692" class="node">
<title>expert5_act_16</title>
<polygon fill="lightgreen" stroke="black" points="1488,-793.86 1320,-793.86 1320,-740.86 1488,-740.86 1488,-793.86"/>
<text text-anchor="middle" x="1404" y="-778.66" font-family="Times,serif" font-size="14.00">Expert5 GELU</text>
<text text-anchor="middle" x="1404" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1404" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert5_up_16&#45;&gt;expert5_act_16 -->
<g id="edge864" class="edge">
<title>expert5_up_16&#45;&gt;expert5_act_16</title>
<path fill="none" stroke="black" d="M1403.29,-830.43C1403.39,-822.2 1403.49,-812.94 1403.59,-804.14"/>
<polygon fill="black" stroke="black" points="1407.09,-804.14 1403.71,-794.1 1400.09,-804.06 1407.09,-804.14"/>
</g>
<!-- expert5_down_16 -->
<g id="node693" class="node">
<title>expert5_down_16</title>
<polygon fill="lightgreen" stroke="black" points="1513,-703.86 1297,-703.86 1297,-650.86 1513,-650.86 1513,-703.86"/>
<text text-anchor="middle" x="1405" y="-688.66" font-family="Times,serif" font-size="14.00">Expert5 Down</text>
<text text-anchor="middle" x="1405" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1405" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert5_act_16&#45;&gt;expert5_down_16 -->
<g id="edge865" class="edge">
<title>expert5_act_16&#45;&gt;expert5_down_16</title>
<path fill="none" stroke="black" d="M1404.29,-740.43C1404.39,-732.2 1404.49,-722.94 1404.59,-714.14"/>
<polygon fill="black" stroke="black" points="1408.09,-714.14 1404.71,-704.1 1401.09,-714.06 1408.09,-714.14"/>
</g>
<!-- expert5_agg_16 -->
<g id="node694" class="node">
<title>expert5_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="1412" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1412" y="-587.68" font-family="Times,serif" font-size="14.00">Expert5 Output</text>
<text text-anchor="middle" x="1412" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1412" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;20</text>
</g>
<!-- expert5_down_16&#45;&gt;expert5_agg_16 -->
<g id="edge866" class="edge">
<title>expert5_down_16&#45;&gt;expert5_agg_16</title>
<path fill="none" stroke="black" d="M1406.82,-650.61C1407.39,-642.54 1408.04,-633.36 1408.68,-624.3"/>
<polygon fill="black" stroke="black" points="1412.18,-624.4 1409.4,-614.18 1405.2,-623.91 1412.18,-624.4"/>
</g>
<!-- expert5_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge867" class="edge">
<title>expert5_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1377.01,-540.36C1359.6,-524.08 1337.68,-505.21 1316,-490.91 1309.36,-486.53 1302.41,-482.27 1295.29,-478.15"/>
<polygon fill="purple" stroke="purple" points="1296.62,-474.89 1286.2,-473.02 1293.18,-480.98 1296.62,-474.89"/>
<text text-anchor="middle" x="1426.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;20→GPU&#45;22</text>
<text text-anchor="middle" x="1426.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert6_act_16 -->
<g id="node696" class="node">
<title>expert6_act_16</title>
<polygon fill="lightgreen" stroke="black" points="1735,-793.86 1567,-793.86 1567,-740.86 1735,-740.86 1735,-793.86"/>
<text text-anchor="middle" x="1651" y="-778.66" font-family="Times,serif" font-size="14.00">Expert6 GELU</text>
<text text-anchor="middle" x="1651" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1651" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert6_up_16&#45;&gt;expert6_act_16 -->
<g id="edge869" class="edge">
<title>expert6_up_16&#45;&gt;expert6_act_16</title>
<path fill="none" stroke="black" d="M1641.83,-830.43C1643.05,-822.2 1644.41,-812.94 1645.71,-804.14"/>
<polygon fill="black" stroke="black" points="1649.2,-804.51 1647.2,-794.1 1642.27,-803.48 1649.2,-804.51"/>
</g>
<!-- expert6_down_16 -->
<g id="node697" class="node">
<title>expert6_down_16</title>
<polygon fill="lightgreen" stroke="black" points="1760,-703.86 1544,-703.86 1544,-650.86 1760,-650.86 1760,-703.86"/>
<text text-anchor="middle" x="1652" y="-688.66" font-family="Times,serif" font-size="14.00">Expert6 Down</text>
<text text-anchor="middle" x="1652" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1652" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert6_act_16&#45;&gt;expert6_down_16 -->
<g id="edge870" class="edge">
<title>expert6_act_16&#45;&gt;expert6_down_16</title>
<path fill="none" stroke="black" d="M1651.29,-740.43C1651.39,-732.2 1651.49,-722.94 1651.59,-714.14"/>
<polygon fill="black" stroke="black" points="1655.09,-714.14 1651.71,-704.1 1648.09,-714.06 1655.09,-714.14"/>
</g>
<!-- expert6_agg_16 -->
<g id="node698" class="node">
<title>expert6_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="1655" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1655" y="-587.68" font-family="Times,serif" font-size="14.00">Expert6 Output</text>
<text text-anchor="middle" x="1655" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1655" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;21</text>
</g>
<!-- expert6_down_16&#45;&gt;expert6_agg_16 -->
<g id="edge871" class="edge">
<title>expert6_down_16&#45;&gt;expert6_agg_16</title>
<path fill="none" stroke="black" d="M1652.78,-650.61C1653.03,-642.54 1653.3,-633.36 1653.58,-624.3"/>
<polygon fill="black" stroke="black" points="1657.08,-624.28 1653.88,-614.18 1650.08,-624.07 1657.08,-624.28"/>
</g>
<!-- expert6_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge872" class="edge">
<title>expert6_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1604.78,-542.67C1575.76,-525.06 1537.98,-504.28 1502,-490.91 1445.58,-469.94 1381.33,-454.57 1324.41,-443.67"/>
<polygon fill="purple" stroke="purple" points="1324.72,-440.17 1314.24,-441.76 1323.42,-447.05 1324.72,-440.17"/>
<text text-anchor="middle" x="1633.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;21→GPU&#45;22</text>
<text text-anchor="middle" x="1633.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert7_act_16 -->
<g id="node700" class="node">
<title>expert7_act_16</title>
<polygon fill="lightgreen" stroke="black" points="1970,-793.86 1802,-793.86 1802,-740.86 1970,-740.86 1970,-793.86"/>
<text text-anchor="middle" x="1886" y="-778.66" font-family="Times,serif" font-size="14.00">Expert7 GELU</text>
<text text-anchor="middle" x="1886" y="-763.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1886" y="-748.66" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- expert7_up_16&#45;&gt;expert7_act_16 -->
<g id="edge874" class="edge">
<title>expert7_up_16&#45;&gt;expert7_act_16</title>
<path fill="none" stroke="black" d="M1877.54,-830.43C1878.66,-822.2 1879.92,-812.94 1881.12,-804.14"/>
<polygon fill="black" stroke="black" points="1884.61,-804.48 1882.49,-794.1 1877.67,-803.54 1884.61,-804.48"/>
</g>
<!-- expert7_down_16 -->
<g id="node701" class="node">
<title>expert7_down_16</title>
<polygon fill="lightgreen" stroke="black" points="1999,-703.86 1783,-703.86 1783,-650.86 1999,-650.86 1999,-703.86"/>
<text text-anchor="middle" x="1891" y="-688.66" font-family="Times,serif" font-size="14.00">Expert7 Down</text>
<text text-anchor="middle" x="1891" y="-673.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1891" y="-658.66" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- expert7_act_16&#45;&gt;expert7_down_16 -->
<g id="edge875" class="edge">
<title>expert7_act_16&#45;&gt;expert7_down_16</title>
<path fill="none" stroke="black" d="M1887.47,-740.43C1887.94,-732.2 1888.47,-722.94 1888.97,-714.14"/>
<polygon fill="black" stroke="black" points="1892.46,-714.28 1889.54,-704.1 1885.48,-713.89 1892.46,-714.28"/>
</g>
<!-- expert7_agg_16 -->
<g id="node702" class="node">
<title>expert7_agg_16</title>
<ellipse fill="lightgray" stroke="black" cx="1898" cy="-576.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1898" y="-587.68" font-family="Times,serif" font-size="14.00">Expert7 Output</text>
<text text-anchor="middle" x="1898" y="-572.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1898" y="-557.68" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- expert7_down_16&#45;&gt;expert7_agg_16 -->
<g id="edge876" class="edge">
<title>expert7_down_16&#45;&gt;expert7_agg_16</title>
<path fill="none" stroke="black" d="M1892.82,-650.61C1893.39,-642.54 1894.04,-633.36 1894.68,-624.3"/>
<polygon fill="black" stroke="black" points="1898.18,-624.4 1895.4,-614.18 1891.2,-623.91 1898.18,-624.4"/>
</g>
<!-- expert7_agg_16&#45;&gt;expert_agg_16 -->
<g id="edge877" class="edge">
<title>expert7_agg_16&#45;&gt;expert_agg_16</title>
<path fill="none" stroke="purple" stroke-dasharray="5,2" d="M1840.07,-544.18C1803.49,-525.83 1754.66,-503.77 1709,-490.91 1578.63,-454.18 1425.04,-436.63 1315.06,-428.31"/>
<polygon fill="purple" stroke="purple" points="1315.12,-424.8 1304.89,-427.55 1314.6,-431.78 1315.12,-424.8"/>
<text text-anchor="middle" x="1859.5" y="-509.71" font-family="Times,serif" font-size="14.00">GPU&#45;22→GPU&#45;22</text>
<text text-anchor="middle" x="1859.5" y="-494.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- expert_agg_16&#45;&gt;residual2_16 -->
<g id="edge878" class="edge">
<title>expert_agg_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M1280.34,-388.83C1365.34,-365.87 1482.31,-334.28 1569.68,-310.68"/>
<polygon fill="black" stroke="black" points="1570.64,-314.04 1579.38,-308.06 1568.81,-307.29 1570.64,-314.04"/>
</g>
<!-- layer_out_16 -->
<g id="node705" class="node">
<title>layer_out_16</title>
<ellipse fill="lightgray" stroke="black" cx="1691" cy="-149.43" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1691" y="-160.73" font-family="Times,serif" font-size="14.00">Layer16_Output</text>
<text text-anchor="middle" x="1691" y="-145.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1691" y="-130.73" font-family="Times,serif" font-size="14.00">GPU&#45;22</text>
</g>
<!-- residual2_16&#45;&gt;layer_out_16 -->
<g id="edge880" class="edge">
<title>residual2_16&#45;&gt;layer_out_16</title>
<path fill="none" stroke="black" d="M1691,-223.78C1691,-214.88 1691,-205.68 1691,-196.93"/>
<polygon fill="black" stroke="black" points="1694.5,-196.92 1691,-186.92 1687.5,-196.92 1694.5,-196.92"/>
</g>
<!-- final_output -->
<g id="node706" class="node">
<title>final_output</title>
<ellipse fill="gold" stroke="black" cx="1691" cy="-37.48" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1691" y="-48.78" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="1691" y="-33.78" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1691" y="-18.78" font-family="Times,serif" font-size="14.00">GPU&#45;127</text>
</g>
<!-- layer_out_16&#45;&gt;final_output -->
<g id="edge881" class="edge">
<title>layer_out_16&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M1691,-111.82C1691,-103.38 1691,-94.28 1691,-85.47"/>
<polygon fill="black" stroke="black" points="1694.5,-85.3 1691,-75.3 1687.5,-85.3 1694.5,-85.3"/>
</g>
</g>
</svg>
