<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: dense_model_16_gpu Pages: 1 -->
<svg width="326pt" height="2160pt"
 viewBox="0.00 0.00 325.62 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.15 0.15) rotate(0) translate(4 14092.85)">
<title>dense_model_16_gpu</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-14092.85 2121.11,-14092.85 2121.11,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightblue" stroke="black" cx="211" cy="-14067.64" rx="130.22" ry="21.43"/>
<text text-anchor="middle" x="211" y="-14070.64" font-family="Arial" font-size="10.00">Input</text>
<text text-anchor="middle" x="211" y="-14059.64" font-family="Arial" font-size="10.00">[Batch: 1024, Seq: 512, Hidden: 8192]</text>
</g>
<!-- mha_q_1 -->
<g id="node2" class="node">
<title>mha_q_1</title>
<polygon fill="lightgreen" stroke="black" points="92,-14010.43 0,-14010.43 0,-13969.43 92,-13969.43 92,-14010.43"/>
<text text-anchor="middle" x="46" y="-13998.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="46" y="-13987.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="46" y="-13976.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_q_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M169.36,-14047.53C147.72,-14037.6 121.04,-14025.36 98.05,-14014.81"/>
<polygon fill="black" stroke="black" points="99.32,-14011.54 88.77,-14010.55 96.4,-14017.91 99.32,-14011.54"/>
</g>
<!-- mha_k_1 -->
<g id="node3" class="node">
<title>mha_k_1</title>
<polygon fill="lightgreen" stroke="black" points="202,-14010.43 110,-14010.43 110,-13969.43 202,-13969.43 202,-14010.43"/>
<text text-anchor="middle" x="156" y="-13998.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="156" y="-13987.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="156" y="-13976.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_k_1 -->
<g id="edge2" class="edge">
<title>input&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M196.26,-14046.35C190.07,-14037.83 182.78,-14027.79 176.11,-14018.61"/>
<polygon fill="black" stroke="black" points="178.92,-14016.52 170.21,-14010.49 173.26,-14020.64 178.92,-14016.52"/>
</g>
<!-- mha_v_1 -->
<g id="node4" class="node">
<title>mha_v_1</title>
<polygon fill="lightgreen" stroke="black" points="312,-14010.43 220,-14010.43 220,-13969.43 312,-13969.43 312,-14010.43"/>
<text text-anchor="middle" x="266" y="-13998.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="266" y="-13987.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="266" y="-13976.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;mha_v_1 -->
<g id="edge3" class="edge">
<title>input&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M225.74,-14046.35C231.93,-14037.83 239.22,-14027.79 245.89,-14018.61"/>
<polygon fill="black" stroke="black" points="248.74,-14020.64 251.79,-14010.49 243.08,-14016.52 248.74,-14020.64"/>
</g>
<!-- residual1_1 -->
<g id="node7" class="node">
<title>residual1_1</title>
<polygon fill="lightpink" stroke="black" points="346,-13779.43 254,-13779.43 254,-13738.43 346,-13738.43 346,-13779.43"/>
<text text-anchor="middle" x="300" y="-13767.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="300" y="-13756.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="300" y="-13745.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge8" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M273.31,-14048.92C291.91,-14040.41 310.2,-14028.08 321,-14010.43 363.73,-13940.6 332.57,-13838.61 312.86,-13789.08"/>
<polygon fill="black" stroke="black" points="316.01,-13787.54 308.97,-13779.62 309.53,-13790.2 316.01,-13787.54"/>
</g>
<!-- mha_attn_1 -->
<g id="node5" class="node">
<title>mha_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="260,-13933.43 156,-13933.43 156,-13892.43 260,-13892.43 260,-13933.43"/>
<text text-anchor="middle" x="208" y="-13921.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="208" y="-13910.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="208" y="-13899.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge4" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M88.14,-13969.42C109.06,-13959.73 134.51,-13947.95 156.57,-13937.74"/>
<polygon fill="black" stroke="black" points="158.18,-13940.85 165.79,-13933.47 155.24,-13934.49 158.18,-13940.85"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M169.66,-13969.22C175.45,-13960.87 182.31,-13950.98 188.61,-13941.89"/>
<polygon fill="black" stroke="black" points="191.61,-13943.71 194.43,-13933.5 185.85,-13939.72 191.61,-13943.71"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M250.76,-13969.22C244.23,-13960.78 236.5,-13950.78 229.41,-13941.61"/>
<polygon fill="black" stroke="black" points="232.02,-13939.27 223.14,-13933.5 226.49,-13943.55 232.02,-13939.27"/>
</g>
<!-- mha_out_1 -->
<g id="node6" class="node">
<title>mha_out_1</title>
<polygon fill="lightgreen" stroke="black" points="309,-13856.43 217,-13856.43 217,-13815.43 309,-13815.43 309,-13856.43"/>
<text text-anchor="middle" x="263" y="-13844.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="263" y="-13833.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="263" y="-13822.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge7" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M222.45,-13892.22C228.64,-13883.78 235.98,-13873.78 242.7,-13864.61"/>
<polygon fill="black" stroke="black" points="245.55,-13866.63 248.65,-13856.5 239.91,-13862.49 245.55,-13866.63"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M272.72,-13815.22C276.72,-13807.13 281.42,-13797.59 285.79,-13788.74"/>
<polygon fill="black" stroke="black" points="289.06,-13790.02 290.34,-13779.5 282.78,-13786.92 289.06,-13790.02"/>
</g>
<!-- ln1_1 -->
<g id="node8" class="node">
<title>ln1_1</title>
<polygon fill="lightpink" stroke="black" points="346,-13702.43 254,-13702.43 254,-13661.43 346,-13661.43 346,-13702.43"/>
<text text-anchor="middle" x="300" y="-13690.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="300" y="-13679.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="300" y="-13668.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;ln1_1 -->
<g id="edge10" class="edge">
<title>residual1_1&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M300,-13738.22C300,-13730.38 300,-13721.2 300,-13712.59"/>
<polygon fill="black" stroke="black" points="303.5,-13712.5 300,-13702.5 296.5,-13712.5 303.5,-13712.5"/>
</g>
<!-- ffn_up_1 -->
<g id="node9" class="node">
<title>ffn_up_1</title>
<polygon fill="lightcoral" stroke="black" points="233,-13625.43 135,-13625.43 135,-13584.43 233,-13584.43 233,-13625.43"/>
<text text-anchor="middle" x="184" y="-13613.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="184" y="-13602.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="184" y="-13591.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;ffn_up_1 -->
<g id="edge11" class="edge">
<title>ln1_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M269.83,-13661.42C255.57,-13652.2 238.38,-13641.09 223.14,-13631.23"/>
<polygon fill="black" stroke="black" points="224.72,-13628.09 214.43,-13625.6 220.92,-13633.97 224.72,-13628.09"/>
</g>
<!-- ffn_gate_1 -->
<g id="node10" class="node">
<title>ffn_gate_1</title>
<polygon fill="lightcoral" stroke="black" points="349,-13625.43 251,-13625.43 251,-13584.43 349,-13584.43 349,-13625.43"/>
<text text-anchor="middle" x="300" y="-13613.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="300" y="-13602.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="300" y="-13591.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;ffn_gate_1 -->
<g id="edge12" class="edge">
<title>ln1_1&#45;&gt;ffn_gate_1</title>
<path fill="none" stroke="black" d="M300,-13661.22C300,-13653.38 300,-13644.2 300,-13635.59"/>
<polygon fill="black" stroke="black" points="303.5,-13635.5 300,-13625.5 296.5,-13635.5 303.5,-13635.5"/>
</g>
<!-- residual2_1 -->
<g id="node12" class="node">
<title>residual2_1</title>
<polygon fill="lightpink" stroke="black" points="384,-13471.43 292,-13471.43 292,-13430.43 384,-13430.43 384,-13471.43"/>
<text text-anchor="middle" x="338" y="-13459.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="338" y="-13448.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="338" y="-13437.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;residual2_1 -->
<g id="edge16" class="edge">
<title>ln1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M328.89,-13661.37C340.21,-13651.98 351.92,-13639.65 358,-13625.43 378.27,-13577.97 362.75,-13516.93 350.07,-13481.34"/>
<polygon fill="black" stroke="black" points="353.2,-13479.73 346.43,-13471.58 346.64,-13482.17 353.2,-13479.73"/>
</g>
<!-- ffn_down_1 -->
<g id="node11" class="node">
<title>ffn_down_1</title>
<polygon fill="lightcoral" stroke="black" points="346,-13548.43 254,-13548.43 254,-13507.43 346,-13507.43 346,-13548.43"/>
<text text-anchor="middle" x="300" y="-13536.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="300" y="-13525.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="300" y="-13514.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_down_1 -->
<g id="edge13" class="edge">
<title>ffn_up_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M214.17,-13584.42C228.43,-13575.2 245.62,-13564.09 260.86,-13554.23"/>
<polygon fill="black" stroke="black" points="263.08,-13556.97 269.57,-13548.6 259.28,-13551.09 263.08,-13556.97"/>
</g>
<!-- ffn_gate_1&#45;&gt;ffn_down_1 -->
<g id="edge14" class="edge">
<title>ffn_gate_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M300,-13584.22C300,-13576.38 300,-13567.2 300,-13558.59"/>
<polygon fill="black" stroke="black" points="303.5,-13558.5 300,-13548.5 296.5,-13558.5 303.5,-13558.5"/>
</g>
<!-- ffn_down_1&#45;&gt;residual2_1 -->
<g id="edge15" class="edge">
<title>ffn_down_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M309.98,-13507.22C314.13,-13499.04 319.02,-13489.39 323.55,-13480.45"/>
<polygon fill="black" stroke="black" points="326.69,-13482 328.08,-13471.5 320.44,-13478.84 326.69,-13482"/>
</g>
<!-- ln2_1 -->
<g id="node13" class="node">
<title>ln2_1</title>
<polygon fill="lightpink" stroke="black" points="384,-13394.43 292,-13394.43 292,-13353.43 384,-13353.43 384,-13394.43"/>
<text text-anchor="middle" x="338" y="-13382.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="338" y="-13371.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="338" y="-13360.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- residual2_1&#45;&gt;ln2_1 -->
<g id="edge17" class="edge">
<title>residual2_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M338,-13430.22C338,-13422.38 338,-13413.2 338,-13404.59"/>
<polygon fill="black" stroke="black" points="341.5,-13404.5 338,-13394.5 334.5,-13404.5 341.5,-13404.5"/>
</g>
<!-- split_1 -->
<g id="node14" class="node">
<title>split_1</title>
<polygon fill="lightyellow" stroke="black" points="356.06,-13317.43 254.16,-13317.43 227.94,-13257.43 329.84,-13257.43 356.06,-13317.43"/>
<text text-anchor="middle" x="292" y="-13290.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="292" y="-13279.43" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- ln2_1&#45;&gt;split_1 -->
<g id="edge18" class="edge">
<title>ln2_1&#45;&gt;split_1</title>
<path fill="none" stroke="black" d="M327.33,-13353.33C322.95,-13345.27 317.71,-13335.66 312.63,-13326.33"/>
<polygon fill="black" stroke="black" points="315.7,-13324.65 307.85,-13317.54 309.55,-13327.99 315.7,-13324.65"/>
</g>
<!-- agg_2 -->
<g id="node15" class="node">
<title>agg_2</title>
<polygon fill="lightyellow" stroke="black" points="402.06,-13221.43 300.16,-13221.43 273.94,-13161.43 375.84,-13161.43 402.06,-13221.43"/>
<text text-anchor="middle" x="338" y="-13194.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="338" y="-13183.43" font-family="Arial" font-size="10.00">GPU 0→1</text>
</g>
<!-- ln2_1&#45;&gt;agg_2 -->
<g id="edge24" class="edge">
<title>ln2_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M350.32,-13353.19C356,-13342.93 362.11,-13329.96 365,-13317.43 370.99,-13291.44 370.22,-13283.58 365,-13257.43 363.25,-13248.63 360.28,-13239.54 356.94,-13231.04"/>
<polygon fill="black" stroke="black" points="360.14,-13229.62 353.05,-13221.75 353.68,-13232.32 360.14,-13229.62"/>
</g>
<!-- split_1&#45;&gt;agg_2 -->
<g id="edge19" class="edge">
<title>split_1&#45;&gt;agg_2</title>
<path fill="none" stroke="black" d="M306.3,-13257.2C310.41,-13248.8 314.96,-13239.51 319.29,-13230.65"/>
<polygon fill="black" stroke="black" points="322.45,-13232.16 323.71,-13221.64 316.17,-13229.08 322.45,-13232.16"/>
</g>
<!-- mha_q_2 -->
<g id="node16" class="node">
<title>mha_q_2</title>
<polygon fill="lightgreen" stroke="black" points="219,-13125.43 127,-13125.43 127,-13084.43 219,-13084.43 219,-13125.43"/>
<text text-anchor="middle" x="173" y="-13113.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="173" y="-13102.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="173" y="-13091.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_q_2 -->
<g id="edge25" class="edge">
<title>agg_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M281.22,-13161.35C261.35,-13151.17 239.27,-13139.86 220.26,-13130.13"/>
<polygon fill="black" stroke="black" points="221.7,-13126.93 211.2,-13125.49 218.51,-13133.17 221.7,-13126.93"/>
</g>
<!-- mha_k_2 -->
<g id="node17" class="node">
<title>mha_k_2</title>
<polygon fill="lightgreen" stroke="black" points="329,-13125.43 237,-13125.43 237,-13084.43 329,-13084.43 329,-13125.43"/>
<text text-anchor="middle" x="283" y="-13113.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="283" y="-13102.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="283" y="-13091.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_k_2 -->
<g id="edge26" class="edge">
<title>agg_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M319.07,-13161.35C313.29,-13152.47 306.95,-13142.72 301.22,-13133.92"/>
<polygon fill="black" stroke="black" points="304.12,-13131.96 295.73,-13125.49 298.26,-13135.78 304.12,-13131.96"/>
</g>
<!-- mha_v_2 -->
<g id="node18" class="node">
<title>mha_v_2</title>
<polygon fill="lightgreen" stroke="black" points="439,-13125.43 347,-13125.43 347,-13084.43 439,-13084.43 439,-13125.43"/>
<text text-anchor="middle" x="393" y="-13113.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="393" y="-13102.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="393" y="-13091.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;mha_v_2 -->
<g id="edge27" class="edge">
<title>agg_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M356.93,-13161.35C362.71,-13152.47 369.05,-13142.72 374.78,-13133.92"/>
<polygon fill="black" stroke="black" points="377.74,-13135.78 380.27,-13125.49 371.88,-13131.96 377.74,-13135.78"/>
</g>
<!-- residual1_2 -->
<g id="node21" class="node">
<title>residual1_2</title>
<polygon fill="lightpink" stroke="black" points="422,-12894.43 330,-12894.43 330,-12853.43 422,-12853.43 422,-12894.43"/>
<text text-anchor="middle" x="376" y="-12882.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="376" y="-12871.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="376" y="-12860.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- agg_2&#45;&gt;residual1_2 -->
<g id="edge28" class="edge">
<title>agg_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M382.45,-13176.42C406.43,-13166.34 433.93,-13150.09 448,-13125.43 490.12,-13051.61 431.69,-12951.28 397.57,-12903.07"/>
<polygon fill="black" stroke="black" points="400.21,-12900.74 391.51,-12894.69 394.53,-12904.84 400.21,-12900.74"/>
</g>
<!-- mha_attn_2 -->
<g id="node19" class="node">
<title>mha_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="387,-13048.43 283,-13048.43 283,-13007.43 387,-13007.43 387,-13048.43"/>
<text text-anchor="middle" x="335" y="-13036.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="335" y="-13025.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="335" y="-13014.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge20" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M215.14,-13084.42C236.06,-13074.73 261.51,-13062.95 283.57,-13052.74"/>
<polygon fill="black" stroke="black" points="285.18,-13055.85 292.79,-13048.47 282.24,-13049.49 285.18,-13055.85"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge21" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M296.66,-13084.22C302.45,-13075.87 309.31,-13065.98 315.61,-13056.89"/>
<polygon fill="black" stroke="black" points="318.61,-13058.71 321.43,-13048.5 312.85,-13054.72 318.61,-13058.71"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge22" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M377.76,-13084.22C371.23,-13075.78 363.5,-13065.78 356.41,-13056.61"/>
<polygon fill="black" stroke="black" points="359.02,-13054.27 350.14,-13048.5 353.49,-13058.55 359.02,-13054.27"/>
</g>
<!-- mha_out_2 -->
<g id="node20" class="node">
<title>mha_out_2</title>
<polygon fill="lightgreen" stroke="black" points="384,-12971.43 292,-12971.43 292,-12930.43 384,-12930.43 384,-12971.43"/>
<text text-anchor="middle" x="338" y="-12959.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="338" y="-12948.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="338" y="-12937.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge23" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M335.79,-13007.22C336.1,-12999.38 336.47,-12990.2 336.81,-12981.59"/>
<polygon fill="black" stroke="black" points="340.31,-12981.63 337.22,-12971.5 333.32,-12981.35 340.31,-12981.63"/>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge29" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M347.98,-12930.22C352.13,-12922.04 357.02,-12912.39 361.55,-12903.45"/>
<polygon fill="black" stroke="black" points="364.69,-12905 366.08,-12894.5 358.44,-12901.84 364.69,-12905"/>
</g>
<!-- ln1_2 -->
<g id="node22" class="node">
<title>ln1_2</title>
<polygon fill="lightpink" stroke="black" points="422,-12817.43 330,-12817.43 330,-12776.43 422,-12776.43 422,-12817.43"/>
<text text-anchor="middle" x="376" y="-12805.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="376" y="-12794.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="376" y="-12783.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- residual1_2&#45;&gt;ln1_2 -->
<g id="edge30" class="edge">
<title>residual1_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M376,-12853.22C376,-12845.38 376,-12836.2 376,-12827.59"/>
<polygon fill="black" stroke="black" points="379.5,-12827.5 376,-12817.5 372.5,-12827.5 379.5,-12827.5"/>
</g>
<!-- ffn_up_2 -->
<g id="node23" class="node">
<title>ffn_up_2</title>
<polygon fill="lightcoral" stroke="black" points="309,-12740.43 211,-12740.43 211,-12699.43 309,-12699.43 309,-12740.43"/>
<text text-anchor="middle" x="260" y="-12728.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="260" y="-12717.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="260" y="-12706.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;ffn_up_2 -->
<g id="edge31" class="edge">
<title>ln1_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M345.83,-12776.42C331.57,-12767.2 314.38,-12756.09 299.14,-12746.23"/>
<polygon fill="black" stroke="black" points="300.72,-12743.09 290.43,-12740.6 296.92,-12748.97 300.72,-12743.09"/>
</g>
<!-- ffn_gate_2 -->
<g id="node24" class="node">
<title>ffn_gate_2</title>
<polygon fill="lightcoral" stroke="black" points="425,-12740.43 327,-12740.43 327,-12699.43 425,-12699.43 425,-12740.43"/>
<text text-anchor="middle" x="376" y="-12728.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="376" y="-12717.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="376" y="-12706.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;ffn_gate_2 -->
<g id="edge32" class="edge">
<title>ln1_2&#45;&gt;ffn_gate_2</title>
<path fill="none" stroke="black" d="M376,-12776.22C376,-12768.38 376,-12759.2 376,-12750.59"/>
<polygon fill="black" stroke="black" points="379.5,-12750.5 376,-12740.5 372.5,-12750.5 379.5,-12750.5"/>
</g>
<!-- residual2_2 -->
<g id="node26" class="node">
<title>residual2_2</title>
<polygon fill="lightpink" stroke="black" points="460,-12586.43 368,-12586.43 368,-12545.43 460,-12545.43 460,-12586.43"/>
<text text-anchor="middle" x="414" y="-12574.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="414" y="-12563.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="414" y="-12552.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;residual2_2 -->
<g id="edge36" class="edge">
<title>ln1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M404.89,-12776.37C416.21,-12766.98 427.92,-12754.65 434,-12740.43 454.27,-12692.97 438.75,-12631.93 426.07,-12596.34"/>
<polygon fill="black" stroke="black" points="429.2,-12594.73 422.43,-12586.58 422.64,-12597.17 429.2,-12594.73"/>
</g>
<!-- ffn_down_2 -->
<g id="node25" class="node">
<title>ffn_down_2</title>
<polygon fill="lightcoral" stroke="black" points="422,-12663.43 330,-12663.43 330,-12622.43 422,-12622.43 422,-12663.43"/>
<text text-anchor="middle" x="376" y="-12651.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="376" y="-12640.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="376" y="-12629.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_down_2 -->
<g id="edge33" class="edge">
<title>ffn_up_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M290.17,-12699.42C304.43,-12690.2 321.62,-12679.09 336.86,-12669.23"/>
<polygon fill="black" stroke="black" points="339.08,-12671.97 345.57,-12663.6 335.28,-12666.09 339.08,-12671.97"/>
</g>
<!-- ffn_gate_2&#45;&gt;ffn_down_2 -->
<g id="edge34" class="edge">
<title>ffn_gate_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M376,-12699.22C376,-12691.38 376,-12682.2 376,-12673.59"/>
<polygon fill="black" stroke="black" points="379.5,-12673.5 376,-12663.5 372.5,-12673.5 379.5,-12673.5"/>
</g>
<!-- ffn_down_2&#45;&gt;residual2_2 -->
<g id="edge35" class="edge">
<title>ffn_down_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M385.98,-12622.22C390.13,-12614.04 395.02,-12604.39 399.55,-12595.45"/>
<polygon fill="black" stroke="black" points="402.69,-12597 404.08,-12586.5 396.44,-12593.84 402.69,-12597"/>
</g>
<!-- ln2_2 -->
<g id="node27" class="node">
<title>ln2_2</title>
<polygon fill="lightpink" stroke="black" points="460,-12509.43 368,-12509.43 368,-12468.43 460,-12468.43 460,-12509.43"/>
<text text-anchor="middle" x="414" y="-12497.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="414" y="-12486.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="414" y="-12475.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- residual2_2&#45;&gt;ln2_2 -->
<g id="edge37" class="edge">
<title>residual2_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M414,-12545.22C414,-12537.38 414,-12528.2 414,-12519.59"/>
<polygon fill="black" stroke="black" points="417.5,-12519.5 414,-12509.5 410.5,-12519.5 417.5,-12519.5"/>
</g>
<!-- split_2 -->
<g id="node28" class="node">
<title>split_2</title>
<polygon fill="lightyellow" stroke="black" points="432.06,-12432.43 330.16,-12432.43 303.94,-12372.43 405.84,-12372.43 432.06,-12432.43"/>
<text text-anchor="middle" x="368" y="-12405.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="368" y="-12394.43" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- ln2_2&#45;&gt;split_2 -->
<g id="edge38" class="edge">
<title>ln2_2&#45;&gt;split_2</title>
<path fill="none" stroke="black" d="M403.33,-12468.33C398.95,-12460.27 393.71,-12450.66 388.63,-12441.33"/>
<polygon fill="black" stroke="black" points="391.7,-12439.65 383.85,-12432.54 385.55,-12442.99 391.7,-12439.65"/>
</g>
<!-- agg_3 -->
<g id="node29" class="node">
<title>agg_3</title>
<polygon fill="lightyellow" stroke="black" points="478.06,-12336.43 376.16,-12336.43 349.94,-12276.43 451.84,-12276.43 478.06,-12336.43"/>
<text text-anchor="middle" x="414" y="-12309.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="414" y="-12298.43" font-family="Arial" font-size="10.00">GPU 1→2</text>
</g>
<!-- ln2_2&#45;&gt;agg_3 -->
<g id="edge44" class="edge">
<title>ln2_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M426.32,-12468.19C432,-12457.93 438.11,-12444.96 441,-12432.43 446.99,-12406.44 446.22,-12398.58 441,-12372.43 439.25,-12363.63 436.28,-12354.54 432.94,-12346.04"/>
<polygon fill="black" stroke="black" points="436.14,-12344.62 429.05,-12336.75 429.68,-12347.32 436.14,-12344.62"/>
</g>
<!-- split_2&#45;&gt;agg_3 -->
<g id="edge39" class="edge">
<title>split_2&#45;&gt;agg_3</title>
<path fill="none" stroke="black" d="M382.3,-12372.2C386.41,-12363.8 390.96,-12354.51 395.29,-12345.65"/>
<polygon fill="black" stroke="black" points="398.45,-12347.16 399.71,-12336.64 392.17,-12344.08 398.45,-12347.16"/>
</g>
<!-- mha_q_3 -->
<g id="node30" class="node">
<title>mha_q_3</title>
<polygon fill="lightgreen" stroke="black" points="295,-12240.43 203,-12240.43 203,-12199.43 295,-12199.43 295,-12240.43"/>
<text text-anchor="middle" x="249" y="-12228.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="249" y="-12217.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="249" y="-12206.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_q_3 -->
<g id="edge45" class="edge">
<title>agg_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M357.22,-12276.35C337.35,-12266.17 315.27,-12254.86 296.26,-12245.13"/>
<polygon fill="black" stroke="black" points="297.7,-12241.93 287.2,-12240.49 294.51,-12248.17 297.7,-12241.93"/>
</g>
<!-- mha_k_3 -->
<g id="node31" class="node">
<title>mha_k_3</title>
<polygon fill="lightgreen" stroke="black" points="405,-12240.43 313,-12240.43 313,-12199.43 405,-12199.43 405,-12240.43"/>
<text text-anchor="middle" x="359" y="-12228.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="359" y="-12217.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="359" y="-12206.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_k_3 -->
<g id="edge46" class="edge">
<title>agg_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M395.07,-12276.35C389.29,-12267.47 382.95,-12257.72 377.22,-12248.92"/>
<polygon fill="black" stroke="black" points="380.12,-12246.96 371.73,-12240.49 374.26,-12250.78 380.12,-12246.96"/>
</g>
<!-- mha_v_3 -->
<g id="node32" class="node">
<title>mha_v_3</title>
<polygon fill="lightgreen" stroke="black" points="515,-12240.43 423,-12240.43 423,-12199.43 515,-12199.43 515,-12240.43"/>
<text text-anchor="middle" x="469" y="-12228.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="469" y="-12217.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="469" y="-12206.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;mha_v_3 -->
<g id="edge47" class="edge">
<title>agg_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M432.93,-12276.35C438.71,-12267.47 445.05,-12257.72 450.78,-12248.92"/>
<polygon fill="black" stroke="black" points="453.74,-12250.78 456.27,-12240.49 447.88,-12246.96 453.74,-12250.78"/>
</g>
<!-- residual1_3 -->
<g id="node35" class="node">
<title>residual1_3</title>
<polygon fill="lightpink" stroke="black" points="549,-12009.43 457,-12009.43 457,-11968.43 549,-11968.43 549,-12009.43"/>
<text text-anchor="middle" x="503" y="-11997.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="503" y="-11986.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="503" y="-11975.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- agg_3&#45;&gt;residual1_3 -->
<g id="edge48" class="edge">
<title>agg_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M458.45,-12291.42C482.43,-12281.34 509.93,-12265.09 524,-12240.43 564.57,-12169.33 534.41,-12067.93 515.39,-12018.81"/>
<polygon fill="black" stroke="black" points="518.61,-12017.42 511.65,-12009.43 512.11,-12020.01 518.61,-12017.42"/>
</g>
<!-- mha_attn_3 -->
<g id="node33" class="node">
<title>mha_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="463,-12163.43 359,-12163.43 359,-12122.43 463,-12122.43 463,-12163.43"/>
<text text-anchor="middle" x="411" y="-12151.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="411" y="-12140.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="411" y="-12129.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge40" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M291.14,-12199.42C312.06,-12189.73 337.51,-12177.95 359.57,-12167.74"/>
<polygon fill="black" stroke="black" points="361.18,-12170.85 368.79,-12163.47 358.24,-12164.49 361.18,-12170.85"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge41" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M372.66,-12199.22C378.45,-12190.87 385.31,-12180.98 391.61,-12171.89"/>
<polygon fill="black" stroke="black" points="394.61,-12173.71 397.43,-12163.5 388.85,-12169.72 394.61,-12173.71"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge42" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M453.76,-12199.22C447.23,-12190.78 439.5,-12180.78 432.41,-12171.61"/>
<polygon fill="black" stroke="black" points="435.02,-12169.27 426.14,-12163.5 429.49,-12173.55 435.02,-12169.27"/>
</g>
<!-- mha_out_3 -->
<g id="node34" class="node">
<title>mha_out_3</title>
<polygon fill="lightgreen" stroke="black" points="512,-12086.43 420,-12086.43 420,-12045.43 512,-12045.43 512,-12086.43"/>
<text text-anchor="middle" x="466" y="-12074.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="466" y="-12063.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="466" y="-12052.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge43" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M425.45,-12122.22C431.64,-12113.78 438.98,-12103.78 445.7,-12094.61"/>
<polygon fill="black" stroke="black" points="448.55,-12096.63 451.65,-12086.5 442.91,-12092.49 448.55,-12096.63"/>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge49" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M475.72,-12045.22C479.72,-12037.13 484.42,-12027.59 488.79,-12018.74"/>
<polygon fill="black" stroke="black" points="492.06,-12020.02 493.34,-12009.5 485.78,-12016.92 492.06,-12020.02"/>
</g>
<!-- ln1_3 -->
<g id="node36" class="node">
<title>ln1_3</title>
<polygon fill="lightpink" stroke="black" points="549,-11932.43 457,-11932.43 457,-11891.43 549,-11891.43 549,-11932.43"/>
<text text-anchor="middle" x="503" y="-11920.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="503" y="-11909.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="503" y="-11898.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- residual1_3&#45;&gt;ln1_3 -->
<g id="edge50" class="edge">
<title>residual1_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M503,-11968.22C503,-11960.38 503,-11951.2 503,-11942.59"/>
<polygon fill="black" stroke="black" points="506.5,-11942.5 503,-11932.5 499.5,-11942.5 506.5,-11942.5"/>
</g>
<!-- ffn_up_3 -->
<g id="node37" class="node">
<title>ffn_up_3</title>
<polygon fill="lightcoral" stroke="black" points="436,-11855.43 338,-11855.43 338,-11814.43 436,-11814.43 436,-11855.43"/>
<text text-anchor="middle" x="387" y="-11843.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="387" y="-11832.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="387" y="-11821.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;ffn_up_3 -->
<g id="edge51" class="edge">
<title>ln1_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M472.83,-11891.42C458.57,-11882.2 441.38,-11871.09 426.14,-11861.23"/>
<polygon fill="black" stroke="black" points="427.72,-11858.09 417.43,-11855.6 423.92,-11863.97 427.72,-11858.09"/>
</g>
<!-- ffn_gate_3 -->
<g id="node38" class="node">
<title>ffn_gate_3</title>
<polygon fill="lightcoral" stroke="black" points="552,-11855.43 454,-11855.43 454,-11814.43 552,-11814.43 552,-11855.43"/>
<text text-anchor="middle" x="503" y="-11843.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="503" y="-11832.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="503" y="-11821.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;ffn_gate_3 -->
<g id="edge52" class="edge">
<title>ln1_3&#45;&gt;ffn_gate_3</title>
<path fill="none" stroke="black" d="M503,-11891.22C503,-11883.38 503,-11874.2 503,-11865.59"/>
<polygon fill="black" stroke="black" points="506.5,-11865.5 503,-11855.5 499.5,-11865.5 506.5,-11865.5"/>
</g>
<!-- residual2_3 -->
<g id="node40" class="node">
<title>residual2_3</title>
<polygon fill="lightpink" stroke="black" points="587,-11701.43 495,-11701.43 495,-11660.43 587,-11660.43 587,-11701.43"/>
<text text-anchor="middle" x="541" y="-11689.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="541" y="-11678.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="541" y="-11667.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;residual2_3 -->
<g id="edge56" class="edge">
<title>ln1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M531.89,-11891.37C543.21,-11881.98 554.92,-11869.65 561,-11855.43 581.27,-11807.97 565.75,-11746.93 553.07,-11711.34"/>
<polygon fill="black" stroke="black" points="556.2,-11709.73 549.43,-11701.58 549.64,-11712.17 556.2,-11709.73"/>
</g>
<!-- ffn_down_3 -->
<g id="node39" class="node">
<title>ffn_down_3</title>
<polygon fill="lightcoral" stroke="black" points="549,-11778.43 457,-11778.43 457,-11737.43 549,-11737.43 549,-11778.43"/>
<text text-anchor="middle" x="503" y="-11766.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="503" y="-11755.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="503" y="-11744.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_down_3 -->
<g id="edge53" class="edge">
<title>ffn_up_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M417.17,-11814.42C431.43,-11805.2 448.62,-11794.09 463.86,-11784.23"/>
<polygon fill="black" stroke="black" points="466.08,-11786.97 472.57,-11778.6 462.28,-11781.09 466.08,-11786.97"/>
</g>
<!-- ffn_gate_3&#45;&gt;ffn_down_3 -->
<g id="edge54" class="edge">
<title>ffn_gate_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M503,-11814.22C503,-11806.38 503,-11797.2 503,-11788.59"/>
<polygon fill="black" stroke="black" points="506.5,-11788.5 503,-11778.5 499.5,-11788.5 506.5,-11788.5"/>
</g>
<!-- ffn_down_3&#45;&gt;residual2_3 -->
<g id="edge55" class="edge">
<title>ffn_down_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M512.98,-11737.22C517.13,-11729.04 522.02,-11719.39 526.55,-11710.45"/>
<polygon fill="black" stroke="black" points="529.69,-11712 531.08,-11701.5 523.44,-11708.84 529.69,-11712"/>
</g>
<!-- ln2_3 -->
<g id="node41" class="node">
<title>ln2_3</title>
<polygon fill="lightpink" stroke="black" points="587,-11624.43 495,-11624.43 495,-11583.43 587,-11583.43 587,-11624.43"/>
<text text-anchor="middle" x="541" y="-11612.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="541" y="-11601.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="541" y="-11590.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- residual2_3&#45;&gt;ln2_3 -->
<g id="edge57" class="edge">
<title>residual2_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M541,-11660.22C541,-11652.38 541,-11643.2 541,-11634.59"/>
<polygon fill="black" stroke="black" points="544.5,-11634.5 541,-11624.5 537.5,-11634.5 544.5,-11634.5"/>
</g>
<!-- split_3 -->
<g id="node42" class="node">
<title>split_3</title>
<polygon fill="lightyellow" stroke="black" points="559.06,-11547.43 457.16,-11547.43 430.94,-11487.43 532.84,-11487.43 559.06,-11547.43"/>
<text text-anchor="middle" x="495" y="-11520.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="495" y="-11509.43" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- ln2_3&#45;&gt;split_3 -->
<g id="edge58" class="edge">
<title>ln2_3&#45;&gt;split_3</title>
<path fill="none" stroke="black" d="M530.33,-11583.33C525.95,-11575.27 520.71,-11565.66 515.63,-11556.33"/>
<polygon fill="black" stroke="black" points="518.7,-11554.65 510.85,-11547.54 512.55,-11557.99 518.7,-11554.65"/>
</g>
<!-- agg_4 -->
<g id="node43" class="node">
<title>agg_4</title>
<polygon fill="lightyellow" stroke="black" points="605.06,-11451.43 503.16,-11451.43 476.94,-11391.43 578.84,-11391.43 605.06,-11451.43"/>
<text text-anchor="middle" x="541" y="-11424.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="541" y="-11413.43" font-family="Arial" font-size="10.00">GPU 2→3</text>
</g>
<!-- ln2_3&#45;&gt;agg_4 -->
<g id="edge64" class="edge">
<title>ln2_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M553.32,-11583.19C559,-11572.93 565.11,-11559.96 568,-11547.43 573.99,-11521.44 573.22,-11513.58 568,-11487.43 566.25,-11478.63 563.28,-11469.54 559.94,-11461.04"/>
<polygon fill="black" stroke="black" points="563.14,-11459.62 556.05,-11451.75 556.68,-11462.32 563.14,-11459.62"/>
</g>
<!-- split_3&#45;&gt;agg_4 -->
<g id="edge59" class="edge">
<title>split_3&#45;&gt;agg_4</title>
<path fill="none" stroke="black" d="M509.3,-11487.2C513.41,-11478.8 517.96,-11469.51 522.29,-11460.65"/>
<polygon fill="black" stroke="black" points="525.45,-11462.16 526.71,-11451.64 519.17,-11459.08 525.45,-11462.16"/>
</g>
<!-- mha_q_4 -->
<g id="node44" class="node">
<title>mha_q_4</title>
<polygon fill="lightgreen" stroke="black" points="422,-11355.43 330,-11355.43 330,-11314.43 422,-11314.43 422,-11355.43"/>
<text text-anchor="middle" x="376" y="-11343.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="376" y="-11332.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="376" y="-11321.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_q_4 -->
<g id="edge65" class="edge">
<title>agg_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M484.22,-11391.35C464.35,-11381.17 442.27,-11369.86 423.26,-11360.13"/>
<polygon fill="black" stroke="black" points="424.7,-11356.93 414.2,-11355.49 421.51,-11363.17 424.7,-11356.93"/>
</g>
<!-- mha_k_4 -->
<g id="node45" class="node">
<title>mha_k_4</title>
<polygon fill="lightgreen" stroke="black" points="532,-11355.43 440,-11355.43 440,-11314.43 532,-11314.43 532,-11355.43"/>
<text text-anchor="middle" x="486" y="-11343.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="486" y="-11332.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="486" y="-11321.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_k_4 -->
<g id="edge66" class="edge">
<title>agg_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M522.07,-11391.35C516.29,-11382.47 509.95,-11372.72 504.22,-11363.92"/>
<polygon fill="black" stroke="black" points="507.12,-11361.96 498.73,-11355.49 501.26,-11365.78 507.12,-11361.96"/>
</g>
<!-- mha_v_4 -->
<g id="node46" class="node">
<title>mha_v_4</title>
<polygon fill="lightgreen" stroke="black" points="642,-11355.43 550,-11355.43 550,-11314.43 642,-11314.43 642,-11355.43"/>
<text text-anchor="middle" x="596" y="-11343.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="596" y="-11332.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="596" y="-11321.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;mha_v_4 -->
<g id="edge67" class="edge">
<title>agg_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M559.93,-11391.35C565.71,-11382.47 572.05,-11372.72 577.78,-11363.92"/>
<polygon fill="black" stroke="black" points="580.74,-11365.78 583.27,-11355.49 574.88,-11361.96 580.74,-11365.78"/>
</g>
<!-- residual1_4 -->
<g id="node49" class="node">
<title>residual1_4</title>
<polygon fill="lightpink" stroke="black" points="676,-11124.43 584,-11124.43 584,-11083.43 676,-11083.43 676,-11124.43"/>
<text text-anchor="middle" x="630" y="-11112.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="630" y="-11101.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="630" y="-11090.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- agg_4&#45;&gt;residual1_4 -->
<g id="edge68" class="edge">
<title>agg_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M585.45,-11406.42C609.43,-11396.34 636.93,-11380.09 651,-11355.43 691.57,-11284.33 661.41,-11182.93 642.39,-11133.81"/>
<polygon fill="black" stroke="black" points="645.61,-11132.42 638.65,-11124.43 639.11,-11135.01 645.61,-11132.42"/>
</g>
<!-- mha_attn_4 -->
<g id="node47" class="node">
<title>mha_attn_4</title>
<polygon fill="lightgreen" stroke="black" points="590,-11278.43 486,-11278.43 486,-11237.43 590,-11237.43 590,-11278.43"/>
<text text-anchor="middle" x="538" y="-11266.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="538" y="-11255.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="538" y="-11244.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge60" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M418.14,-11314.42C439.06,-11304.73 464.51,-11292.95 486.57,-11282.74"/>
<polygon fill="black" stroke="black" points="488.18,-11285.85 495.79,-11278.47 485.24,-11279.49 488.18,-11285.85"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge61" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M499.66,-11314.22C505.45,-11305.87 512.31,-11295.98 518.61,-11286.89"/>
<polygon fill="black" stroke="black" points="521.61,-11288.71 524.43,-11278.5 515.85,-11284.72 521.61,-11288.71"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge62" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M580.76,-11314.22C574.23,-11305.78 566.5,-11295.78 559.41,-11286.61"/>
<polygon fill="black" stroke="black" points="562.02,-11284.27 553.14,-11278.5 556.49,-11288.55 562.02,-11284.27"/>
</g>
<!-- mha_out_4 -->
<g id="node48" class="node">
<title>mha_out_4</title>
<polygon fill="lightgreen" stroke="black" points="639,-11201.43 547,-11201.43 547,-11160.43 639,-11160.43 639,-11201.43"/>
<text text-anchor="middle" x="593" y="-11189.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="593" y="-11178.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="593" y="-11167.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge63" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M552.45,-11237.22C558.64,-11228.78 565.98,-11218.78 572.7,-11209.61"/>
<polygon fill="black" stroke="black" points="575.55,-11211.63 578.65,-11201.5 569.91,-11207.49 575.55,-11211.63"/>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge69" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M602.72,-11160.22C606.72,-11152.13 611.42,-11142.59 615.79,-11133.74"/>
<polygon fill="black" stroke="black" points="619.06,-11135.02 620.34,-11124.5 612.78,-11131.92 619.06,-11135.02"/>
</g>
<!-- ln1_4 -->
<g id="node50" class="node">
<title>ln1_4</title>
<polygon fill="lightpink" stroke="black" points="676,-11047.43 584,-11047.43 584,-11006.43 676,-11006.43 676,-11047.43"/>
<text text-anchor="middle" x="630" y="-11035.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="630" y="-11024.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="630" y="-11013.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- residual1_4&#45;&gt;ln1_4 -->
<g id="edge70" class="edge">
<title>residual1_4&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M630,-11083.22C630,-11075.38 630,-11066.2 630,-11057.59"/>
<polygon fill="black" stroke="black" points="633.5,-11057.5 630,-11047.5 626.5,-11057.5 633.5,-11057.5"/>
</g>
<!-- ffn_up_4 -->
<g id="node51" class="node">
<title>ffn_up_4</title>
<polygon fill="lightcoral" stroke="black" points="563,-10970.43 465,-10970.43 465,-10929.43 563,-10929.43 563,-10970.43"/>
<text text-anchor="middle" x="514" y="-10958.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="514" y="-10947.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="514" y="-10936.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;ffn_up_4 -->
<g id="edge71" class="edge">
<title>ln1_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M599.83,-11006.42C585.57,-10997.2 568.38,-10986.09 553.14,-10976.23"/>
<polygon fill="black" stroke="black" points="554.72,-10973.09 544.43,-10970.6 550.92,-10978.97 554.72,-10973.09"/>
</g>
<!-- ffn_gate_4 -->
<g id="node52" class="node">
<title>ffn_gate_4</title>
<polygon fill="lightcoral" stroke="black" points="679,-10970.43 581,-10970.43 581,-10929.43 679,-10929.43 679,-10970.43"/>
<text text-anchor="middle" x="630" y="-10958.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="630" y="-10947.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="630" y="-10936.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;ffn_gate_4 -->
<g id="edge72" class="edge">
<title>ln1_4&#45;&gt;ffn_gate_4</title>
<path fill="none" stroke="black" d="M630,-11006.22C630,-10998.38 630,-10989.2 630,-10980.59"/>
<polygon fill="black" stroke="black" points="633.5,-10980.5 630,-10970.5 626.5,-10980.5 633.5,-10980.5"/>
</g>
<!-- residual2_4 -->
<g id="node54" class="node">
<title>residual2_4</title>
<polygon fill="lightpink" stroke="black" points="714,-10816.43 622,-10816.43 622,-10775.43 714,-10775.43 714,-10816.43"/>
<text text-anchor="middle" x="668" y="-10804.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="668" y="-10793.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="668" y="-10782.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;residual2_4 -->
<g id="edge76" class="edge">
<title>ln1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M658.89,-11006.37C670.21,-10996.98 681.92,-10984.65 688,-10970.43 708.27,-10922.97 692.75,-10861.93 680.07,-10826.34"/>
<polygon fill="black" stroke="black" points="683.2,-10824.73 676.43,-10816.58 676.64,-10827.17 683.2,-10824.73"/>
</g>
<!-- ffn_down_4 -->
<g id="node53" class="node">
<title>ffn_down_4</title>
<polygon fill="lightcoral" stroke="black" points="676,-10893.43 584,-10893.43 584,-10852.43 676,-10852.43 676,-10893.43"/>
<text text-anchor="middle" x="630" y="-10881.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="630" y="-10870.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="630" y="-10859.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_down_4 -->
<g id="edge73" class="edge">
<title>ffn_up_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M544.17,-10929.42C558.43,-10920.2 575.62,-10909.09 590.86,-10899.23"/>
<polygon fill="black" stroke="black" points="593.08,-10901.97 599.57,-10893.6 589.28,-10896.09 593.08,-10901.97"/>
</g>
<!-- ffn_gate_4&#45;&gt;ffn_down_4 -->
<g id="edge74" class="edge">
<title>ffn_gate_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M630,-10929.22C630,-10921.38 630,-10912.2 630,-10903.59"/>
<polygon fill="black" stroke="black" points="633.5,-10903.5 630,-10893.5 626.5,-10903.5 633.5,-10903.5"/>
</g>
<!-- ffn_down_4&#45;&gt;residual2_4 -->
<g id="edge75" class="edge">
<title>ffn_down_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M639.98,-10852.22C644.13,-10844.04 649.02,-10834.39 653.55,-10825.45"/>
<polygon fill="black" stroke="black" points="656.69,-10827 658.08,-10816.5 650.44,-10823.84 656.69,-10827"/>
</g>
<!-- ln2_4 -->
<g id="node55" class="node">
<title>ln2_4</title>
<polygon fill="lightpink" stroke="black" points="714,-10739.43 622,-10739.43 622,-10698.43 714,-10698.43 714,-10739.43"/>
<text text-anchor="middle" x="668" y="-10727.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="668" y="-10716.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="668" y="-10705.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- residual2_4&#45;&gt;ln2_4 -->
<g id="edge77" class="edge">
<title>residual2_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M668,-10775.22C668,-10767.38 668,-10758.2 668,-10749.59"/>
<polygon fill="black" stroke="black" points="671.5,-10749.5 668,-10739.5 664.5,-10749.5 671.5,-10749.5"/>
</g>
<!-- split_4 -->
<g id="node56" class="node">
<title>split_4</title>
<polygon fill="lightyellow" stroke="black" points="686.06,-10662.43 584.16,-10662.43 557.94,-10602.43 659.84,-10602.43 686.06,-10662.43"/>
<text text-anchor="middle" x="622" y="-10635.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="622" y="-10624.43" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- ln2_4&#45;&gt;split_4 -->
<g id="edge78" class="edge">
<title>ln2_4&#45;&gt;split_4</title>
<path fill="none" stroke="black" d="M657.33,-10698.33C652.95,-10690.27 647.71,-10680.66 642.63,-10671.33"/>
<polygon fill="black" stroke="black" points="645.7,-10669.65 637.85,-10662.54 639.55,-10672.99 645.7,-10669.65"/>
</g>
<!-- agg_5 -->
<g id="node57" class="node">
<title>agg_5</title>
<polygon fill="lightyellow" stroke="black" points="732.06,-10566.43 630.16,-10566.43 603.94,-10506.43 705.84,-10506.43 732.06,-10566.43"/>
<text text-anchor="middle" x="668" y="-10539.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="668" y="-10528.43" font-family="Arial" font-size="10.00">GPU 3→4</text>
</g>
<!-- ln2_4&#45;&gt;agg_5 -->
<g id="edge84" class="edge">
<title>ln2_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M680.32,-10698.19C686,-10687.93 692.11,-10674.96 695,-10662.43 700.99,-10636.44 700.22,-10628.58 695,-10602.43 693.25,-10593.63 690.28,-10584.54 686.94,-10576.04"/>
<polygon fill="black" stroke="black" points="690.14,-10574.62 683.05,-10566.75 683.68,-10577.32 690.14,-10574.62"/>
</g>
<!-- split_4&#45;&gt;agg_5 -->
<g id="edge79" class="edge">
<title>split_4&#45;&gt;agg_5</title>
<path fill="none" stroke="black" d="M636.3,-10602.2C640.41,-10593.8 644.96,-10584.51 649.29,-10575.65"/>
<polygon fill="black" stroke="black" points="652.45,-10577.16 653.71,-10566.64 646.17,-10574.08 652.45,-10577.16"/>
</g>
<!-- mha_q_5 -->
<g id="node58" class="node">
<title>mha_q_5</title>
<polygon fill="lightgreen" stroke="black" points="549,-10470.43 457,-10470.43 457,-10429.43 549,-10429.43 549,-10470.43"/>
<text text-anchor="middle" x="503" y="-10458.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="503" y="-10447.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="503" y="-10436.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_q_5 -->
<g id="edge85" class="edge">
<title>agg_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M611.22,-10506.35C591.35,-10496.17 569.27,-10484.86 550.26,-10475.13"/>
<polygon fill="black" stroke="black" points="551.7,-10471.93 541.2,-10470.49 548.51,-10478.17 551.7,-10471.93"/>
</g>
<!-- mha_k_5 -->
<g id="node59" class="node">
<title>mha_k_5</title>
<polygon fill="lightgreen" stroke="black" points="659,-10470.43 567,-10470.43 567,-10429.43 659,-10429.43 659,-10470.43"/>
<text text-anchor="middle" x="613" y="-10458.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="613" y="-10447.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="613" y="-10436.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_k_5 -->
<g id="edge86" class="edge">
<title>agg_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M649.07,-10506.35C643.29,-10497.47 636.95,-10487.72 631.22,-10478.92"/>
<polygon fill="black" stroke="black" points="634.12,-10476.96 625.73,-10470.49 628.26,-10480.78 634.12,-10476.96"/>
</g>
<!-- mha_v_5 -->
<g id="node60" class="node">
<title>mha_v_5</title>
<polygon fill="lightgreen" stroke="black" points="769,-10470.43 677,-10470.43 677,-10429.43 769,-10429.43 769,-10470.43"/>
<text text-anchor="middle" x="723" y="-10458.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="723" y="-10447.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="723" y="-10436.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;mha_v_5 -->
<g id="edge87" class="edge">
<title>agg_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M686.93,-10506.35C692.71,-10497.47 699.05,-10487.72 704.78,-10478.92"/>
<polygon fill="black" stroke="black" points="707.74,-10480.78 710.27,-10470.49 701.88,-10476.96 707.74,-10480.78"/>
</g>
<!-- residual1_5 -->
<g id="node63" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="751,-10239.43 659,-10239.43 659,-10198.43 751,-10198.43 751,-10239.43"/>
<text text-anchor="middle" x="705" y="-10227.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="705" y="-10216.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="705" y="-10205.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- agg_5&#45;&gt;residual1_5 -->
<g id="edge88" class="edge">
<title>agg_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M712.45,-10521.42C736.43,-10511.34 763.93,-10495.09 778,-10470.43 820.16,-10396.53 761.17,-10296.24 726.75,-10248.05"/>
<polygon fill="black" stroke="black" points="729.37,-10245.69 720.64,-10239.68 723.71,-10249.82 729.37,-10245.69"/>
</g>
<!-- mha_attn_5 -->
<g id="node61" class="node">
<title>mha_attn_5</title>
<polygon fill="lightgreen" stroke="black" points="692,-10393.43 588,-10393.43 588,-10352.43 692,-10352.43 692,-10393.43"/>
<text text-anchor="middle" x="640" y="-10381.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="640" y="-10370.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="640" y="-10359.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge80" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M538.64,-10429.42C555.94,-10419.94 576.92,-10408.46 595.28,-10398.41"/>
<polygon fill="black" stroke="black" points="596.97,-10401.47 604.07,-10393.6 593.61,-10395.33 596.97,-10401.47"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge81" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M620.09,-10429.22C622.98,-10421.21 626.37,-10411.79 629.53,-10403.02"/>
<polygon fill="black" stroke="black" points="632.86,-10404.09 632.95,-10393.5 626.27,-10401.72 632.86,-10404.09"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge82" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M701.19,-10429.22C691.38,-10420.35 679.64,-10409.75 669.09,-10400.22"/>
<polygon fill="black" stroke="black" points="671.43,-10397.61 661.66,-10393.5 666.73,-10402.8 671.43,-10397.61"/>
</g>
<!-- mha_out_5 -->
<g id="node62" class="node">
<title>mha_out_5</title>
<polygon fill="lightgreen" stroke="black" points="714,-10316.43 622,-10316.43 622,-10275.43 714,-10275.43 714,-10316.43"/>
<text text-anchor="middle" x="668" y="-10304.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="668" y="-10293.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="668" y="-10282.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge83" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M647.36,-10352.22C650.35,-10344.21 653.86,-10334.79 657.14,-10326.02"/>
<polygon fill="black" stroke="black" points="660.47,-10327.09 660.69,-10316.5 653.92,-10324.64 660.47,-10327.09"/>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge89" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M677.72,-10275.22C681.72,-10267.13 686.42,-10257.59 690.79,-10248.74"/>
<polygon fill="black" stroke="black" points="694.06,-10250.02 695.34,-10239.5 687.78,-10246.92 694.06,-10250.02"/>
</g>
<!-- ln1_5 -->
<g id="node64" class="node">
<title>ln1_5</title>
<polygon fill="lightpink" stroke="black" points="751,-10162.43 659,-10162.43 659,-10121.43 751,-10121.43 751,-10162.43"/>
<text text-anchor="middle" x="705" y="-10150.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="705" y="-10139.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="705" y="-10128.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- residual1_5&#45;&gt;ln1_5 -->
<g id="edge90" class="edge">
<title>residual1_5&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M705,-10198.22C705,-10190.38 705,-10181.2 705,-10172.59"/>
<polygon fill="black" stroke="black" points="708.5,-10172.5 705,-10162.5 701.5,-10172.5 708.5,-10172.5"/>
</g>
<!-- ffn_up_5 -->
<g id="node65" class="node">
<title>ffn_up_5</title>
<polygon fill="lightcoral" stroke="black" points="638,-10085.43 540,-10085.43 540,-10044.43 638,-10044.43 638,-10085.43"/>
<text text-anchor="middle" x="589" y="-10073.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="589" y="-10062.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="589" y="-10051.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;ffn_up_5 -->
<g id="edge91" class="edge">
<title>ln1_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M674.83,-10121.42C660.57,-10112.2 643.38,-10101.09 628.14,-10091.23"/>
<polygon fill="black" stroke="black" points="629.72,-10088.09 619.43,-10085.6 625.92,-10093.97 629.72,-10088.09"/>
</g>
<!-- ffn_gate_5 -->
<g id="node66" class="node">
<title>ffn_gate_5</title>
<polygon fill="lightcoral" stroke="black" points="754,-10085.43 656,-10085.43 656,-10044.43 754,-10044.43 754,-10085.43"/>
<text text-anchor="middle" x="705" y="-10073.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="705" y="-10062.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="705" y="-10051.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;ffn_gate_5 -->
<g id="edge92" class="edge">
<title>ln1_5&#45;&gt;ffn_gate_5</title>
<path fill="none" stroke="black" d="M705,-10121.22C705,-10113.38 705,-10104.2 705,-10095.59"/>
<polygon fill="black" stroke="black" points="708.5,-10095.5 705,-10085.5 701.5,-10095.5 708.5,-10095.5"/>
</g>
<!-- residual2_5 -->
<g id="node68" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="789,-9931.43 697,-9931.43 697,-9890.43 789,-9890.43 789,-9931.43"/>
<text text-anchor="middle" x="743" y="-9919.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="743" y="-9908.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="743" y="-9897.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;residual2_5 -->
<g id="edge96" class="edge">
<title>ln1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M733.89,-10121.37C745.21,-10111.98 756.92,-10099.65 763,-10085.43 783.27,-10037.97 767.75,-9976.93 755.07,-9941.34"/>
<polygon fill="black" stroke="black" points="758.2,-9939.73 751.43,-9931.58 751.64,-9942.17 758.2,-9939.73"/>
</g>
<!-- ffn_down_5 -->
<g id="node67" class="node">
<title>ffn_down_5</title>
<polygon fill="lightcoral" stroke="black" points="751,-10008.43 659,-10008.43 659,-9967.43 751,-9967.43 751,-10008.43"/>
<text text-anchor="middle" x="705" y="-9996.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="705" y="-9985.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="705" y="-9974.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_down_5 -->
<g id="edge93" class="edge">
<title>ffn_up_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M619.17,-10044.42C633.43,-10035.2 650.62,-10024.09 665.86,-10014.23"/>
<polygon fill="black" stroke="black" points="668.08,-10016.97 674.57,-10008.6 664.28,-10011.09 668.08,-10016.97"/>
</g>
<!-- ffn_gate_5&#45;&gt;ffn_down_5 -->
<g id="edge94" class="edge">
<title>ffn_gate_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M705,-10044.22C705,-10036.38 705,-10027.2 705,-10018.59"/>
<polygon fill="black" stroke="black" points="708.5,-10018.5 705,-10008.5 701.5,-10018.5 708.5,-10018.5"/>
</g>
<!-- ffn_down_5&#45;&gt;residual2_5 -->
<g id="edge95" class="edge">
<title>ffn_down_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M714.98,-9967.22C719.13,-9959.04 724.02,-9949.39 728.55,-9940.45"/>
<polygon fill="black" stroke="black" points="731.69,-9942 733.08,-9931.5 725.44,-9938.84 731.69,-9942"/>
</g>
<!-- ln2_5 -->
<g id="node69" class="node">
<title>ln2_5</title>
<polygon fill="lightpink" stroke="black" points="789,-9854.43 697,-9854.43 697,-9813.43 789,-9813.43 789,-9854.43"/>
<text text-anchor="middle" x="743" y="-9842.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="743" y="-9831.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="743" y="-9820.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- residual2_5&#45;&gt;ln2_5 -->
<g id="edge97" class="edge">
<title>residual2_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M743,-9890.22C743,-9882.38 743,-9873.2 743,-9864.59"/>
<polygon fill="black" stroke="black" points="746.5,-9864.5 743,-9854.5 739.5,-9864.5 746.5,-9864.5"/>
</g>
<!-- split_5 -->
<g id="node70" class="node">
<title>split_5</title>
<polygon fill="lightyellow" stroke="black" points="761.06,-9777.43 659.16,-9777.43 632.94,-9717.43 734.84,-9717.43 761.06,-9777.43"/>
<text text-anchor="middle" x="697" y="-9750.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="697" y="-9739.43" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- ln2_5&#45;&gt;split_5 -->
<g id="edge98" class="edge">
<title>ln2_5&#45;&gt;split_5</title>
<path fill="none" stroke="black" d="M732.33,-9813.33C727.95,-9805.27 722.71,-9795.66 717.63,-9786.33"/>
<polygon fill="black" stroke="black" points="720.7,-9784.65 712.85,-9777.54 714.55,-9787.99 720.7,-9784.65"/>
</g>
<!-- agg_6 -->
<g id="node71" class="node">
<title>agg_6</title>
<polygon fill="lightyellow" stroke="black" points="807.06,-9681.43 705.16,-9681.43 678.94,-9621.43 780.84,-9621.43 807.06,-9681.43"/>
<text text-anchor="middle" x="743" y="-9654.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="743" y="-9643.43" font-family="Arial" font-size="10.00">GPU 4→5</text>
</g>
<!-- ln2_5&#45;&gt;agg_6 -->
<g id="edge104" class="edge">
<title>ln2_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M755.32,-9813.19C761,-9802.93 767.11,-9789.96 770,-9777.43 775.99,-9751.44 775.22,-9743.58 770,-9717.43 768.25,-9708.63 765.28,-9699.54 761.94,-9691.04"/>
<polygon fill="black" stroke="black" points="765.14,-9689.62 758.05,-9681.75 758.68,-9692.32 765.14,-9689.62"/>
</g>
<!-- split_5&#45;&gt;agg_6 -->
<g id="edge99" class="edge">
<title>split_5&#45;&gt;agg_6</title>
<path fill="none" stroke="black" d="M711.3,-9717.2C715.41,-9708.8 719.96,-9699.51 724.29,-9690.65"/>
<polygon fill="black" stroke="black" points="727.45,-9692.16 728.71,-9681.64 721.17,-9689.08 727.45,-9692.16"/>
</g>
<!-- mha_q_6 -->
<g id="node72" class="node">
<title>mha_q_6</title>
<polygon fill="lightgreen" stroke="black" points="624,-9585.43 532,-9585.43 532,-9544.43 624,-9544.43 624,-9585.43"/>
<text text-anchor="middle" x="578" y="-9573.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="578" y="-9562.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="578" y="-9551.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_q_6 -->
<g id="edge105" class="edge">
<title>agg_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M686.22,-9621.35C666.35,-9611.17 644.27,-9599.86 625.26,-9590.13"/>
<polygon fill="black" stroke="black" points="626.7,-9586.93 616.2,-9585.49 623.51,-9593.17 626.7,-9586.93"/>
</g>
<!-- mha_k_6 -->
<g id="node73" class="node">
<title>mha_k_6</title>
<polygon fill="lightgreen" stroke="black" points="734,-9585.43 642,-9585.43 642,-9544.43 734,-9544.43 734,-9585.43"/>
<text text-anchor="middle" x="688" y="-9573.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="688" y="-9562.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="688" y="-9551.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_k_6 -->
<g id="edge106" class="edge">
<title>agg_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M724.07,-9621.35C718.29,-9612.47 711.95,-9602.72 706.22,-9593.92"/>
<polygon fill="black" stroke="black" points="709.12,-9591.96 700.73,-9585.49 703.26,-9595.78 709.12,-9591.96"/>
</g>
<!-- mha_v_6 -->
<g id="node74" class="node">
<title>mha_v_6</title>
<polygon fill="lightgreen" stroke="black" points="844,-9585.43 752,-9585.43 752,-9544.43 844,-9544.43 844,-9585.43"/>
<text text-anchor="middle" x="798" y="-9573.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="798" y="-9562.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="798" y="-9551.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;mha_v_6 -->
<g id="edge107" class="edge">
<title>agg_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M761.93,-9621.35C767.71,-9612.47 774.05,-9602.72 779.78,-9593.92"/>
<polygon fill="black" stroke="black" points="782.74,-9595.78 785.27,-9585.49 776.88,-9591.96 782.74,-9595.78"/>
</g>
<!-- residual1_6 -->
<g id="node77" class="node">
<title>residual1_6</title>
<polygon fill="lightpink" stroke="black" points="878,-9354.43 786,-9354.43 786,-9313.43 878,-9313.43 878,-9354.43"/>
<text text-anchor="middle" x="832" y="-9342.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="832" y="-9331.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="832" y="-9320.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- agg_6&#45;&gt;residual1_6 -->
<g id="edge108" class="edge">
<title>agg_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M787.45,-9636.42C811.43,-9626.34 838.93,-9610.09 853,-9585.43 893.57,-9514.33 863.41,-9412.93 844.39,-9363.81"/>
<polygon fill="black" stroke="black" points="847.61,-9362.42 840.65,-9354.43 841.11,-9365.01 847.61,-9362.42"/>
</g>
<!-- mha_attn_6 -->
<g id="node75" class="node">
<title>mha_attn_6</title>
<polygon fill="lightgreen" stroke="black" points="792,-9508.43 688,-9508.43 688,-9467.43 792,-9467.43 792,-9508.43"/>
<text text-anchor="middle" x="740" y="-9496.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="740" y="-9485.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="740" y="-9474.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge100" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M620.14,-9544.42C641.06,-9534.73 666.51,-9522.95 688.57,-9512.74"/>
<polygon fill="black" stroke="black" points="690.18,-9515.85 697.79,-9508.47 687.24,-9509.49 690.18,-9515.85"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge101" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M701.66,-9544.22C707.45,-9535.87 714.31,-9525.98 720.61,-9516.89"/>
<polygon fill="black" stroke="black" points="723.61,-9518.71 726.43,-9508.5 717.85,-9514.72 723.61,-9518.71"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge102" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M782.76,-9544.22C776.23,-9535.78 768.5,-9525.78 761.41,-9516.61"/>
<polygon fill="black" stroke="black" points="764.02,-9514.27 755.14,-9508.5 758.49,-9518.55 764.02,-9514.27"/>
</g>
<!-- mha_out_6 -->
<g id="node76" class="node">
<title>mha_out_6</title>
<polygon fill="lightgreen" stroke="black" points="841,-9431.43 749,-9431.43 749,-9390.43 841,-9390.43 841,-9431.43"/>
<text text-anchor="middle" x="795" y="-9419.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="795" y="-9408.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="795" y="-9397.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge103" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M754.45,-9467.22C760.64,-9458.78 767.98,-9448.78 774.7,-9439.61"/>
<polygon fill="black" stroke="black" points="777.55,-9441.63 780.65,-9431.5 771.91,-9437.49 777.55,-9441.63"/>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge109" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M804.72,-9390.22C808.72,-9382.13 813.42,-9372.59 817.79,-9363.74"/>
<polygon fill="black" stroke="black" points="821.06,-9365.02 822.34,-9354.5 814.78,-9361.92 821.06,-9365.02"/>
</g>
<!-- ln1_6 -->
<g id="node78" class="node">
<title>ln1_6</title>
<polygon fill="lightpink" stroke="black" points="878,-9277.43 786,-9277.43 786,-9236.43 878,-9236.43 878,-9277.43"/>
<text text-anchor="middle" x="832" y="-9265.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="832" y="-9254.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="832" y="-9243.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- residual1_6&#45;&gt;ln1_6 -->
<g id="edge110" class="edge">
<title>residual1_6&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M832,-9313.22C832,-9305.38 832,-9296.2 832,-9287.59"/>
<polygon fill="black" stroke="black" points="835.5,-9287.5 832,-9277.5 828.5,-9287.5 835.5,-9287.5"/>
</g>
<!-- ffn_up_6 -->
<g id="node79" class="node">
<title>ffn_up_6</title>
<polygon fill="lightcoral" stroke="black" points="765,-9200.43 667,-9200.43 667,-9159.43 765,-9159.43 765,-9200.43"/>
<text text-anchor="middle" x="716" y="-9188.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="716" y="-9177.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="716" y="-9166.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;ffn_up_6 -->
<g id="edge111" class="edge">
<title>ln1_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M801.83,-9236.42C787.57,-9227.2 770.38,-9216.09 755.14,-9206.23"/>
<polygon fill="black" stroke="black" points="756.72,-9203.09 746.43,-9200.6 752.92,-9208.97 756.72,-9203.09"/>
</g>
<!-- ffn_gate_6 -->
<g id="node80" class="node">
<title>ffn_gate_6</title>
<polygon fill="lightcoral" stroke="black" points="881,-9200.43 783,-9200.43 783,-9159.43 881,-9159.43 881,-9200.43"/>
<text text-anchor="middle" x="832" y="-9188.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="832" y="-9177.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="832" y="-9166.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;ffn_gate_6 -->
<g id="edge112" class="edge">
<title>ln1_6&#45;&gt;ffn_gate_6</title>
<path fill="none" stroke="black" d="M832,-9236.22C832,-9228.38 832,-9219.2 832,-9210.59"/>
<polygon fill="black" stroke="black" points="835.5,-9210.5 832,-9200.5 828.5,-9210.5 835.5,-9210.5"/>
</g>
<!-- residual2_6 -->
<g id="node82" class="node">
<title>residual2_6</title>
<polygon fill="lightpink" stroke="black" points="916,-9046.43 824,-9046.43 824,-9005.43 916,-9005.43 916,-9046.43"/>
<text text-anchor="middle" x="870" y="-9034.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="870" y="-9023.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="870" y="-9012.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;residual2_6 -->
<g id="edge116" class="edge">
<title>ln1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M860.89,-9236.37C872.21,-9226.98 883.92,-9214.65 890,-9200.43 910.27,-9152.97 894.75,-9091.93 882.07,-9056.34"/>
<polygon fill="black" stroke="black" points="885.2,-9054.73 878.43,-9046.58 878.64,-9057.17 885.2,-9054.73"/>
</g>
<!-- ffn_down_6 -->
<g id="node81" class="node">
<title>ffn_down_6</title>
<polygon fill="lightcoral" stroke="black" points="878,-9123.43 786,-9123.43 786,-9082.43 878,-9082.43 878,-9123.43"/>
<text text-anchor="middle" x="832" y="-9111.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="832" y="-9100.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="832" y="-9089.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_down_6 -->
<g id="edge113" class="edge">
<title>ffn_up_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M746.17,-9159.42C760.43,-9150.2 777.62,-9139.09 792.86,-9129.23"/>
<polygon fill="black" stroke="black" points="795.08,-9131.97 801.57,-9123.6 791.28,-9126.09 795.08,-9131.97"/>
</g>
<!-- ffn_gate_6&#45;&gt;ffn_down_6 -->
<g id="edge114" class="edge">
<title>ffn_gate_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M832,-9159.22C832,-9151.38 832,-9142.2 832,-9133.59"/>
<polygon fill="black" stroke="black" points="835.5,-9133.5 832,-9123.5 828.5,-9133.5 835.5,-9133.5"/>
</g>
<!-- ffn_down_6&#45;&gt;residual2_6 -->
<g id="edge115" class="edge">
<title>ffn_down_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M841.98,-9082.22C846.13,-9074.04 851.02,-9064.39 855.55,-9055.45"/>
<polygon fill="black" stroke="black" points="858.69,-9057 860.08,-9046.5 852.44,-9053.84 858.69,-9057"/>
</g>
<!-- ln2_6 -->
<g id="node83" class="node">
<title>ln2_6</title>
<polygon fill="lightpink" stroke="black" points="916,-8969.43 824,-8969.43 824,-8928.43 916,-8928.43 916,-8969.43"/>
<text text-anchor="middle" x="870" y="-8957.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="870" y="-8946.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="870" y="-8935.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- residual2_6&#45;&gt;ln2_6 -->
<g id="edge117" class="edge">
<title>residual2_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M870,-9005.22C870,-8997.38 870,-8988.2 870,-8979.59"/>
<polygon fill="black" stroke="black" points="873.5,-8979.5 870,-8969.5 866.5,-8979.5 873.5,-8979.5"/>
</g>
<!-- split_6 -->
<g id="node84" class="node">
<title>split_6</title>
<polygon fill="lightyellow" stroke="black" points="888.06,-8892.43 786.16,-8892.43 759.94,-8832.43 861.84,-8832.43 888.06,-8892.43"/>
<text text-anchor="middle" x="824" y="-8865.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="824" y="-8854.43" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- ln2_6&#45;&gt;split_6 -->
<g id="edge118" class="edge">
<title>ln2_6&#45;&gt;split_6</title>
<path fill="none" stroke="black" d="M859.33,-8928.33C854.95,-8920.27 849.71,-8910.66 844.63,-8901.33"/>
<polygon fill="black" stroke="black" points="847.7,-8899.65 839.85,-8892.54 841.55,-8902.99 847.7,-8899.65"/>
</g>
<!-- agg_7 -->
<g id="node85" class="node">
<title>agg_7</title>
<polygon fill="lightyellow" stroke="black" points="934.06,-8796.43 832.16,-8796.43 805.94,-8736.43 907.84,-8736.43 934.06,-8796.43"/>
<text text-anchor="middle" x="870" y="-8769.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="870" y="-8758.43" font-family="Arial" font-size="10.00">GPU 5→6</text>
</g>
<!-- ln2_6&#45;&gt;agg_7 -->
<g id="edge124" class="edge">
<title>ln2_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M882.32,-8928.19C888,-8917.93 894.11,-8904.96 897,-8892.43 902.99,-8866.44 902.22,-8858.58 897,-8832.43 895.25,-8823.63 892.28,-8814.54 888.94,-8806.04"/>
<polygon fill="black" stroke="black" points="892.14,-8804.62 885.05,-8796.75 885.68,-8807.32 892.14,-8804.62"/>
</g>
<!-- split_6&#45;&gt;agg_7 -->
<g id="edge119" class="edge">
<title>split_6&#45;&gt;agg_7</title>
<path fill="none" stroke="black" d="M838.3,-8832.2C842.41,-8823.8 846.96,-8814.51 851.29,-8805.65"/>
<polygon fill="black" stroke="black" points="854.45,-8807.16 855.71,-8796.64 848.17,-8804.08 854.45,-8807.16"/>
</g>
<!-- mha_q_7 -->
<g id="node86" class="node">
<title>mha_q_7</title>
<polygon fill="lightgreen" stroke="black" points="751,-8700.43 659,-8700.43 659,-8659.43 751,-8659.43 751,-8700.43"/>
<text text-anchor="middle" x="705" y="-8688.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="705" y="-8677.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="705" y="-8666.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_q_7 -->
<g id="edge125" class="edge">
<title>agg_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M813.22,-8736.35C793.35,-8726.17 771.27,-8714.86 752.26,-8705.13"/>
<polygon fill="black" stroke="black" points="753.7,-8701.93 743.2,-8700.49 750.51,-8708.17 753.7,-8701.93"/>
</g>
<!-- mha_k_7 -->
<g id="node87" class="node">
<title>mha_k_7</title>
<polygon fill="lightgreen" stroke="black" points="861,-8700.43 769,-8700.43 769,-8659.43 861,-8659.43 861,-8700.43"/>
<text text-anchor="middle" x="815" y="-8688.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="815" y="-8677.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="815" y="-8666.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_k_7 -->
<g id="edge126" class="edge">
<title>agg_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M851.07,-8736.35C845.29,-8727.47 838.95,-8717.72 833.22,-8708.92"/>
<polygon fill="black" stroke="black" points="836.12,-8706.96 827.73,-8700.49 830.26,-8710.78 836.12,-8706.96"/>
</g>
<!-- mha_v_7 -->
<g id="node88" class="node">
<title>mha_v_7</title>
<polygon fill="lightgreen" stroke="black" points="971,-8700.43 879,-8700.43 879,-8659.43 971,-8659.43 971,-8700.43"/>
<text text-anchor="middle" x="925" y="-8688.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="925" y="-8677.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="925" y="-8666.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;mha_v_7 -->
<g id="edge127" class="edge">
<title>agg_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M888.93,-8736.35C894.71,-8727.47 901.05,-8717.72 906.78,-8708.92"/>
<polygon fill="black" stroke="black" points="909.74,-8710.78 912.27,-8700.49 903.88,-8706.96 909.74,-8710.78"/>
</g>
<!-- residual1_7 -->
<g id="node91" class="node">
<title>residual1_7</title>
<polygon fill="lightpink" stroke="black" points="1005,-8469.43 913,-8469.43 913,-8428.43 1005,-8428.43 1005,-8469.43"/>
<text text-anchor="middle" x="959" y="-8457.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="959" y="-8446.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="959" y="-8435.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- agg_7&#45;&gt;residual1_7 -->
<g id="edge128" class="edge">
<title>agg_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M914.45,-8751.42C938.43,-8741.34 965.93,-8725.09 980,-8700.43 1020.57,-8629.33 990.41,-8527.93 971.39,-8478.81"/>
<polygon fill="black" stroke="black" points="974.61,-8477.42 967.65,-8469.43 968.11,-8480.01 974.61,-8477.42"/>
</g>
<!-- mha_attn_7 -->
<g id="node89" class="node">
<title>mha_attn_7</title>
<polygon fill="lightgreen" stroke="black" points="919,-8623.43 815,-8623.43 815,-8582.43 919,-8582.43 919,-8623.43"/>
<text text-anchor="middle" x="867" y="-8611.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="867" y="-8600.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="867" y="-8589.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge120" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M747.14,-8659.42C768.06,-8649.73 793.51,-8637.95 815.57,-8627.74"/>
<polygon fill="black" stroke="black" points="817.18,-8630.85 824.79,-8623.47 814.24,-8624.49 817.18,-8630.85"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge121" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M828.66,-8659.22C834.45,-8650.87 841.31,-8640.98 847.61,-8631.89"/>
<polygon fill="black" stroke="black" points="850.61,-8633.71 853.43,-8623.5 844.85,-8629.72 850.61,-8633.71"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge122" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M909.76,-8659.22C903.23,-8650.78 895.5,-8640.78 888.41,-8631.61"/>
<polygon fill="black" stroke="black" points="891.02,-8629.27 882.14,-8623.5 885.49,-8633.55 891.02,-8629.27"/>
</g>
<!-- mha_out_7 -->
<g id="node90" class="node">
<title>mha_out_7</title>
<polygon fill="lightgreen" stroke="black" points="968,-8546.43 876,-8546.43 876,-8505.43 968,-8505.43 968,-8546.43"/>
<text text-anchor="middle" x="922" y="-8534.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="922" y="-8523.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="922" y="-8512.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge123" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M881.45,-8582.22C887.64,-8573.78 894.98,-8563.78 901.7,-8554.61"/>
<polygon fill="black" stroke="black" points="904.55,-8556.63 907.65,-8546.5 898.91,-8552.49 904.55,-8556.63"/>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge129" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M931.72,-8505.22C935.72,-8497.13 940.42,-8487.59 944.79,-8478.74"/>
<polygon fill="black" stroke="black" points="948.06,-8480.02 949.34,-8469.5 941.78,-8476.92 948.06,-8480.02"/>
</g>
<!-- ln1_7 -->
<g id="node92" class="node">
<title>ln1_7</title>
<polygon fill="lightpink" stroke="black" points="1005,-8392.43 913,-8392.43 913,-8351.43 1005,-8351.43 1005,-8392.43"/>
<text text-anchor="middle" x="959" y="-8380.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="959" y="-8369.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="959" y="-8358.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- residual1_7&#45;&gt;ln1_7 -->
<g id="edge130" class="edge">
<title>residual1_7&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M959,-8428.22C959,-8420.38 959,-8411.2 959,-8402.59"/>
<polygon fill="black" stroke="black" points="962.5,-8402.5 959,-8392.5 955.5,-8402.5 962.5,-8402.5"/>
</g>
<!-- ffn_up_7 -->
<g id="node93" class="node">
<title>ffn_up_7</title>
<polygon fill="lightcoral" stroke="black" points="892,-8315.43 794,-8315.43 794,-8274.43 892,-8274.43 892,-8315.43"/>
<text text-anchor="middle" x="843" y="-8303.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="843" y="-8292.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="843" y="-8281.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;ffn_up_7 -->
<g id="edge131" class="edge">
<title>ln1_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M928.83,-8351.42C914.57,-8342.2 897.38,-8331.09 882.14,-8321.23"/>
<polygon fill="black" stroke="black" points="883.72,-8318.09 873.43,-8315.6 879.92,-8323.97 883.72,-8318.09"/>
</g>
<!-- ffn_gate_7 -->
<g id="node94" class="node">
<title>ffn_gate_7</title>
<polygon fill="lightcoral" stroke="black" points="1008,-8315.43 910,-8315.43 910,-8274.43 1008,-8274.43 1008,-8315.43"/>
<text text-anchor="middle" x="959" y="-8303.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="959" y="-8292.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="959" y="-8281.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;ffn_gate_7 -->
<g id="edge132" class="edge">
<title>ln1_7&#45;&gt;ffn_gate_7</title>
<path fill="none" stroke="black" d="M959,-8351.22C959,-8343.38 959,-8334.2 959,-8325.59"/>
<polygon fill="black" stroke="black" points="962.5,-8325.5 959,-8315.5 955.5,-8325.5 962.5,-8325.5"/>
</g>
<!-- residual2_7 -->
<g id="node96" class="node">
<title>residual2_7</title>
<polygon fill="lightpink" stroke="black" points="1043,-8161.43 951,-8161.43 951,-8120.43 1043,-8120.43 1043,-8161.43"/>
<text text-anchor="middle" x="997" y="-8149.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="997" y="-8138.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="997" y="-8127.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;residual2_7 -->
<g id="edge136" class="edge">
<title>ln1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M987.89,-8351.37C999.21,-8341.98 1010.92,-8329.65 1017,-8315.43 1037.27,-8267.97 1021.75,-8206.93 1009.07,-8171.34"/>
<polygon fill="black" stroke="black" points="1012.2,-8169.73 1005.43,-8161.58 1005.64,-8172.17 1012.2,-8169.73"/>
</g>
<!-- ffn_down_7 -->
<g id="node95" class="node">
<title>ffn_down_7</title>
<polygon fill="lightcoral" stroke="black" points="1005,-8238.43 913,-8238.43 913,-8197.43 1005,-8197.43 1005,-8238.43"/>
<text text-anchor="middle" x="959" y="-8226.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="959" y="-8215.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="959" y="-8204.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_down_7 -->
<g id="edge133" class="edge">
<title>ffn_up_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M873.17,-8274.42C887.43,-8265.2 904.62,-8254.09 919.86,-8244.23"/>
<polygon fill="black" stroke="black" points="922.08,-8246.97 928.57,-8238.6 918.28,-8241.09 922.08,-8246.97"/>
</g>
<!-- ffn_gate_7&#45;&gt;ffn_down_7 -->
<g id="edge134" class="edge">
<title>ffn_gate_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M959,-8274.22C959,-8266.38 959,-8257.2 959,-8248.59"/>
<polygon fill="black" stroke="black" points="962.5,-8248.5 959,-8238.5 955.5,-8248.5 962.5,-8248.5"/>
</g>
<!-- ffn_down_7&#45;&gt;residual2_7 -->
<g id="edge135" class="edge">
<title>ffn_down_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M968.98,-8197.22C973.13,-8189.04 978.02,-8179.39 982.55,-8170.45"/>
<polygon fill="black" stroke="black" points="985.69,-8172 987.08,-8161.5 979.44,-8168.84 985.69,-8172"/>
</g>
<!-- ln2_7 -->
<g id="node97" class="node">
<title>ln2_7</title>
<polygon fill="lightpink" stroke="black" points="1043,-8084.43 951,-8084.43 951,-8043.43 1043,-8043.43 1043,-8084.43"/>
<text text-anchor="middle" x="997" y="-8072.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="997" y="-8061.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="997" y="-8050.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- residual2_7&#45;&gt;ln2_7 -->
<g id="edge137" class="edge">
<title>residual2_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M997,-8120.22C997,-8112.38 997,-8103.2 997,-8094.59"/>
<polygon fill="black" stroke="black" points="1000.5,-8094.5 997,-8084.5 993.5,-8094.5 1000.5,-8094.5"/>
</g>
<!-- split_7 -->
<g id="node98" class="node">
<title>split_7</title>
<polygon fill="lightyellow" stroke="black" points="1015.06,-8007.43 913.16,-8007.43 886.94,-7947.43 988.84,-7947.43 1015.06,-8007.43"/>
<text text-anchor="middle" x="951" y="-7980.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="951" y="-7969.43" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- ln2_7&#45;&gt;split_7 -->
<g id="edge138" class="edge">
<title>ln2_7&#45;&gt;split_7</title>
<path fill="none" stroke="black" d="M986.33,-8043.33C981.95,-8035.27 976.71,-8025.66 971.63,-8016.33"/>
<polygon fill="black" stroke="black" points="974.7,-8014.65 966.85,-8007.54 968.55,-8017.99 974.7,-8014.65"/>
</g>
<!-- agg_8 -->
<g id="node99" class="node">
<title>agg_8</title>
<polygon fill="lightyellow" stroke="black" points="1061.06,-7911.43 959.16,-7911.43 932.94,-7851.43 1034.84,-7851.43 1061.06,-7911.43"/>
<text text-anchor="middle" x="997" y="-7884.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="997" y="-7873.43" font-family="Arial" font-size="10.00">GPU 6→7</text>
</g>
<!-- ln2_7&#45;&gt;agg_8 -->
<g id="edge144" class="edge">
<title>ln2_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M1009.32,-8043.19C1015,-8032.93 1021.11,-8019.96 1024,-8007.43 1029.99,-7981.44 1029.22,-7973.58 1024,-7947.43 1022.25,-7938.63 1019.28,-7929.54 1015.94,-7921.04"/>
<polygon fill="black" stroke="black" points="1019.14,-7919.62 1012.05,-7911.75 1012.68,-7922.32 1019.14,-7919.62"/>
</g>
<!-- split_7&#45;&gt;agg_8 -->
<g id="edge139" class="edge">
<title>split_7&#45;&gt;agg_8</title>
<path fill="none" stroke="black" d="M965.3,-7947.2C969.41,-7938.8 973.96,-7929.51 978.29,-7920.65"/>
<polygon fill="black" stroke="black" points="981.45,-7922.16 982.71,-7911.64 975.17,-7919.08 981.45,-7922.16"/>
</g>
<!-- mha_q_8 -->
<g id="node100" class="node">
<title>mha_q_8</title>
<polygon fill="lightgreen" stroke="black" points="878,-7815.43 786,-7815.43 786,-7774.43 878,-7774.43 878,-7815.43"/>
<text text-anchor="middle" x="832" y="-7803.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="832" y="-7792.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="832" y="-7781.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_q_8 -->
<g id="edge145" class="edge">
<title>agg_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M940.22,-7851.35C920.35,-7841.17 898.27,-7829.86 879.26,-7820.13"/>
<polygon fill="black" stroke="black" points="880.7,-7816.93 870.2,-7815.49 877.51,-7823.17 880.7,-7816.93"/>
</g>
<!-- mha_k_8 -->
<g id="node101" class="node">
<title>mha_k_8</title>
<polygon fill="lightgreen" stroke="black" points="988,-7815.43 896,-7815.43 896,-7774.43 988,-7774.43 988,-7815.43"/>
<text text-anchor="middle" x="942" y="-7803.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="942" y="-7792.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="942" y="-7781.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_k_8 -->
<g id="edge146" class="edge">
<title>agg_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M978.07,-7851.35C972.29,-7842.47 965.95,-7832.72 960.22,-7823.92"/>
<polygon fill="black" stroke="black" points="963.12,-7821.96 954.73,-7815.49 957.26,-7825.78 963.12,-7821.96"/>
</g>
<!-- mha_v_8 -->
<g id="node102" class="node">
<title>mha_v_8</title>
<polygon fill="lightgreen" stroke="black" points="1098,-7815.43 1006,-7815.43 1006,-7774.43 1098,-7774.43 1098,-7815.43"/>
<text text-anchor="middle" x="1052" y="-7803.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1052" y="-7792.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1052" y="-7781.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;mha_v_8 -->
<g id="edge147" class="edge">
<title>agg_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M1015.93,-7851.35C1021.71,-7842.47 1028.05,-7832.72 1033.78,-7823.92"/>
<polygon fill="black" stroke="black" points="1036.74,-7825.78 1039.27,-7815.49 1030.88,-7821.96 1036.74,-7825.78"/>
</g>
<!-- residual1_8 -->
<g id="node105" class="node">
<title>residual1_8</title>
<polygon fill="lightpink" stroke="black" points="1132,-7584.43 1040,-7584.43 1040,-7543.43 1132,-7543.43 1132,-7584.43"/>
<text text-anchor="middle" x="1086" y="-7572.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1086" y="-7561.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1086" y="-7550.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- agg_8&#45;&gt;residual1_8 -->
<g id="edge148" class="edge">
<title>agg_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1041.45,-7866.42C1065.43,-7856.34 1092.93,-7840.09 1107,-7815.43 1147.57,-7744.33 1117.41,-7642.93 1098.39,-7593.81"/>
<polygon fill="black" stroke="black" points="1101.61,-7592.42 1094.65,-7584.43 1095.11,-7595.01 1101.61,-7592.42"/>
</g>
<!-- mha_attn_8 -->
<g id="node103" class="node">
<title>mha_attn_8</title>
<polygon fill="lightgreen" stroke="black" points="1046,-7738.43 942,-7738.43 942,-7697.43 1046,-7697.43 1046,-7738.43"/>
<text text-anchor="middle" x="994" y="-7726.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="994" y="-7715.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="994" y="-7704.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge140" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M874.14,-7774.42C895.06,-7764.73 920.51,-7752.95 942.57,-7742.74"/>
<polygon fill="black" stroke="black" points="944.18,-7745.85 951.79,-7738.47 941.24,-7739.49 944.18,-7745.85"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge141" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M955.66,-7774.22C961.45,-7765.87 968.31,-7755.98 974.61,-7746.89"/>
<polygon fill="black" stroke="black" points="977.61,-7748.71 980.43,-7738.5 971.85,-7744.72 977.61,-7748.71"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge142" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M1036.76,-7774.22C1030.23,-7765.78 1022.5,-7755.78 1015.41,-7746.61"/>
<polygon fill="black" stroke="black" points="1018.02,-7744.27 1009.14,-7738.5 1012.49,-7748.55 1018.02,-7744.27"/>
</g>
<!-- mha_out_8 -->
<g id="node104" class="node">
<title>mha_out_8</title>
<polygon fill="lightgreen" stroke="black" points="1095,-7661.43 1003,-7661.43 1003,-7620.43 1095,-7620.43 1095,-7661.43"/>
<text text-anchor="middle" x="1049" y="-7649.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1049" y="-7638.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1049" y="-7627.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge143" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M1008.45,-7697.22C1014.64,-7688.78 1021.98,-7678.78 1028.7,-7669.61"/>
<polygon fill="black" stroke="black" points="1031.55,-7671.63 1034.65,-7661.5 1025.91,-7667.49 1031.55,-7671.63"/>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge149" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M1058.72,-7620.22C1062.72,-7612.13 1067.42,-7602.59 1071.79,-7593.74"/>
<polygon fill="black" stroke="black" points="1075.06,-7595.02 1076.34,-7584.5 1068.78,-7591.92 1075.06,-7595.02"/>
</g>
<!-- ln1_8 -->
<g id="node106" class="node">
<title>ln1_8</title>
<polygon fill="lightpink" stroke="black" points="1132,-7507.43 1040,-7507.43 1040,-7466.43 1132,-7466.43 1132,-7507.43"/>
<text text-anchor="middle" x="1086" y="-7495.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1086" y="-7484.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1086" y="-7473.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- residual1_8&#45;&gt;ln1_8 -->
<g id="edge150" class="edge">
<title>residual1_8&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M1086,-7543.22C1086,-7535.38 1086,-7526.2 1086,-7517.59"/>
<polygon fill="black" stroke="black" points="1089.5,-7517.5 1086,-7507.5 1082.5,-7517.5 1089.5,-7517.5"/>
</g>
<!-- ffn_up_8 -->
<g id="node107" class="node">
<title>ffn_up_8</title>
<polygon fill="lightcoral" stroke="black" points="1019,-7430.43 921,-7430.43 921,-7389.43 1019,-7389.43 1019,-7430.43"/>
<text text-anchor="middle" x="970" y="-7418.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="970" y="-7407.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="970" y="-7396.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;ffn_up_8 -->
<g id="edge151" class="edge">
<title>ln1_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M1055.83,-7466.42C1041.57,-7457.2 1024.38,-7446.09 1009.14,-7436.23"/>
<polygon fill="black" stroke="black" points="1010.72,-7433.09 1000.43,-7430.6 1006.92,-7438.97 1010.72,-7433.09"/>
</g>
<!-- ffn_gate_8 -->
<g id="node108" class="node">
<title>ffn_gate_8</title>
<polygon fill="lightcoral" stroke="black" points="1135,-7430.43 1037,-7430.43 1037,-7389.43 1135,-7389.43 1135,-7430.43"/>
<text text-anchor="middle" x="1086" y="-7418.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1086" y="-7407.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1086" y="-7396.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;ffn_gate_8 -->
<g id="edge152" class="edge">
<title>ln1_8&#45;&gt;ffn_gate_8</title>
<path fill="none" stroke="black" d="M1086,-7466.22C1086,-7458.38 1086,-7449.2 1086,-7440.59"/>
<polygon fill="black" stroke="black" points="1089.5,-7440.5 1086,-7430.5 1082.5,-7440.5 1089.5,-7440.5"/>
</g>
<!-- residual2_8 -->
<g id="node110" class="node">
<title>residual2_8</title>
<polygon fill="lightpink" stroke="black" points="1170,-7276.43 1078,-7276.43 1078,-7235.43 1170,-7235.43 1170,-7276.43"/>
<text text-anchor="middle" x="1124" y="-7264.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1124" y="-7253.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1124" y="-7242.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;residual2_8 -->
<g id="edge156" class="edge">
<title>ln1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1114.89,-7466.37C1126.21,-7456.98 1137.92,-7444.65 1144,-7430.43 1164.27,-7382.97 1148.75,-7321.93 1136.07,-7286.34"/>
<polygon fill="black" stroke="black" points="1139.2,-7284.73 1132.43,-7276.58 1132.64,-7287.17 1139.2,-7284.73"/>
</g>
<!-- ffn_down_8 -->
<g id="node109" class="node">
<title>ffn_down_8</title>
<polygon fill="lightcoral" stroke="black" points="1132,-7353.43 1040,-7353.43 1040,-7312.43 1132,-7312.43 1132,-7353.43"/>
<text text-anchor="middle" x="1086" y="-7341.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1086" y="-7330.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1086" y="-7319.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_down_8 -->
<g id="edge153" class="edge">
<title>ffn_up_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1000.17,-7389.42C1014.43,-7380.2 1031.62,-7369.09 1046.86,-7359.23"/>
<polygon fill="black" stroke="black" points="1049.08,-7361.97 1055.57,-7353.6 1045.28,-7356.09 1049.08,-7361.97"/>
</g>
<!-- ffn_gate_8&#45;&gt;ffn_down_8 -->
<g id="edge154" class="edge">
<title>ffn_gate_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M1086,-7389.22C1086,-7381.38 1086,-7372.2 1086,-7363.59"/>
<polygon fill="black" stroke="black" points="1089.5,-7363.5 1086,-7353.5 1082.5,-7363.5 1089.5,-7363.5"/>
</g>
<!-- ffn_down_8&#45;&gt;residual2_8 -->
<g id="edge155" class="edge">
<title>ffn_down_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M1095.98,-7312.22C1100.13,-7304.04 1105.02,-7294.39 1109.55,-7285.45"/>
<polygon fill="black" stroke="black" points="1112.69,-7287 1114.08,-7276.5 1106.44,-7283.84 1112.69,-7287"/>
</g>
<!-- ln2_8 -->
<g id="node111" class="node">
<title>ln2_8</title>
<polygon fill="lightpink" stroke="black" points="1170,-7199.43 1078,-7199.43 1078,-7158.43 1170,-7158.43 1170,-7199.43"/>
<text text-anchor="middle" x="1124" y="-7187.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1124" y="-7176.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1124" y="-7165.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- residual2_8&#45;&gt;ln2_8 -->
<g id="edge157" class="edge">
<title>residual2_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M1124,-7235.22C1124,-7227.38 1124,-7218.2 1124,-7209.59"/>
<polygon fill="black" stroke="black" points="1127.5,-7209.5 1124,-7199.5 1120.5,-7209.5 1127.5,-7209.5"/>
</g>
<!-- split_8 -->
<g id="node112" class="node">
<title>split_8</title>
<polygon fill="lightyellow" stroke="black" points="1142.06,-7122.43 1040.16,-7122.43 1013.94,-7062.43 1115.84,-7062.43 1142.06,-7122.43"/>
<text text-anchor="middle" x="1078" y="-7095.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1078" y="-7084.43" font-family="Arial" font-size="10.00">GPU 7→8</text>
</g>
<!-- ln2_8&#45;&gt;split_8 -->
<g id="edge158" class="edge">
<title>ln2_8&#45;&gt;split_8</title>
<path fill="none" stroke="black" d="M1113.33,-7158.33C1108.95,-7150.27 1103.71,-7140.66 1098.63,-7131.33"/>
<polygon fill="black" stroke="black" points="1101.7,-7129.65 1093.85,-7122.54 1095.55,-7132.99 1101.7,-7129.65"/>
</g>
<!-- agg_9 -->
<g id="node113" class="node">
<title>agg_9</title>
<polygon fill="lightyellow" stroke="black" points="1188.06,-7026.43 1086.16,-7026.43 1059.94,-6966.43 1161.84,-6966.43 1188.06,-7026.43"/>
<text text-anchor="middle" x="1124" y="-6999.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1124" y="-6988.43" font-family="Arial" font-size="10.00">GPU 7→8</text>
</g>
<!-- ln2_8&#45;&gt;agg_9 -->
<g id="edge164" class="edge">
<title>ln2_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1136.32,-7158.19C1142,-7147.93 1148.11,-7134.96 1151,-7122.43 1156.99,-7096.44 1156.22,-7088.58 1151,-7062.43 1149.25,-7053.63 1146.28,-7044.54 1142.94,-7036.04"/>
<polygon fill="black" stroke="black" points="1146.14,-7034.62 1139.05,-7026.75 1139.68,-7037.32 1146.14,-7034.62"/>
</g>
<!-- split_8&#45;&gt;agg_9 -->
<g id="edge159" class="edge">
<title>split_8&#45;&gt;agg_9</title>
<path fill="none" stroke="black" d="M1092.3,-7062.2C1096.41,-7053.8 1100.96,-7044.51 1105.29,-7035.65"/>
<polygon fill="black" stroke="black" points="1108.45,-7037.16 1109.71,-7026.64 1102.17,-7034.08 1108.45,-7037.16"/>
</g>
<!-- mha_q_9 -->
<g id="node114" class="node">
<title>mha_q_9</title>
<polygon fill="lightgreen" stroke="black" points="1005,-6930.43 913,-6930.43 913,-6889.43 1005,-6889.43 1005,-6930.43"/>
<text text-anchor="middle" x="959" y="-6918.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="959" y="-6907.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="959" y="-6896.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_q_9 -->
<g id="edge165" class="edge">
<title>agg_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M1067.22,-6966.35C1047.35,-6956.17 1025.27,-6944.86 1006.26,-6935.13"/>
<polygon fill="black" stroke="black" points="1007.7,-6931.93 997.2,-6930.49 1004.51,-6938.17 1007.7,-6931.93"/>
</g>
<!-- mha_k_9 -->
<g id="node115" class="node">
<title>mha_k_9</title>
<polygon fill="lightgreen" stroke="black" points="1115,-6930.43 1023,-6930.43 1023,-6889.43 1115,-6889.43 1115,-6930.43"/>
<text text-anchor="middle" x="1069" y="-6918.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1069" y="-6907.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1069" y="-6896.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_k_9 -->
<g id="edge166" class="edge">
<title>agg_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M1105.07,-6966.35C1099.29,-6957.47 1092.95,-6947.72 1087.22,-6938.92"/>
<polygon fill="black" stroke="black" points="1090.12,-6936.96 1081.73,-6930.49 1084.26,-6940.78 1090.12,-6936.96"/>
</g>
<!-- mha_v_9 -->
<g id="node116" class="node">
<title>mha_v_9</title>
<polygon fill="lightgreen" stroke="black" points="1225,-6930.43 1133,-6930.43 1133,-6889.43 1225,-6889.43 1225,-6930.43"/>
<text text-anchor="middle" x="1179" y="-6918.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1179" y="-6907.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1179" y="-6896.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;mha_v_9 -->
<g id="edge167" class="edge">
<title>agg_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M1142.93,-6966.35C1148.71,-6957.47 1155.05,-6947.72 1160.78,-6938.92"/>
<polygon fill="black" stroke="black" points="1163.74,-6940.78 1166.27,-6930.49 1157.88,-6936.96 1163.74,-6940.78"/>
</g>
<!-- residual1_9 -->
<g id="node119" class="node">
<title>residual1_9</title>
<polygon fill="lightpink" stroke="black" points="1259,-6699.43 1167,-6699.43 1167,-6658.43 1259,-6658.43 1259,-6699.43"/>
<text text-anchor="middle" x="1213" y="-6687.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1213" y="-6676.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1213" y="-6665.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- agg_9&#45;&gt;residual1_9 -->
<g id="edge168" class="edge">
<title>agg_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1168.45,-6981.42C1192.43,-6971.34 1219.93,-6955.09 1234,-6930.43 1274.57,-6859.33 1244.41,-6757.93 1225.39,-6708.81"/>
<polygon fill="black" stroke="black" points="1228.61,-6707.42 1221.65,-6699.43 1222.11,-6710.01 1228.61,-6707.42"/>
</g>
<!-- mha_attn_9 -->
<g id="node117" class="node">
<title>mha_attn_9</title>
<polygon fill="lightgreen" stroke="black" points="1173,-6853.43 1069,-6853.43 1069,-6812.43 1173,-6812.43 1173,-6853.43"/>
<text text-anchor="middle" x="1121" y="-6841.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1121" y="-6830.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1121" y="-6819.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge160" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1001.14,-6889.42C1022.06,-6879.73 1047.51,-6867.95 1069.57,-6857.74"/>
<polygon fill="black" stroke="black" points="1071.18,-6860.85 1078.79,-6853.47 1068.24,-6854.49 1071.18,-6860.85"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge161" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1082.66,-6889.22C1088.45,-6880.87 1095.31,-6870.98 1101.61,-6861.89"/>
<polygon fill="black" stroke="black" points="1104.61,-6863.71 1107.43,-6853.5 1098.85,-6859.72 1104.61,-6863.71"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge162" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M1163.76,-6889.22C1157.23,-6880.78 1149.5,-6870.78 1142.41,-6861.61"/>
<polygon fill="black" stroke="black" points="1145.02,-6859.27 1136.14,-6853.5 1139.49,-6863.55 1145.02,-6859.27"/>
</g>
<!-- mha_out_9 -->
<g id="node118" class="node">
<title>mha_out_9</title>
<polygon fill="lightgreen" stroke="black" points="1222,-6776.43 1130,-6776.43 1130,-6735.43 1222,-6735.43 1222,-6776.43"/>
<text text-anchor="middle" x="1176" y="-6764.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1176" y="-6753.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1176" y="-6742.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge163" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M1135.45,-6812.22C1141.64,-6803.78 1148.98,-6793.78 1155.7,-6784.61"/>
<polygon fill="black" stroke="black" points="1158.55,-6786.63 1161.65,-6776.5 1152.91,-6782.49 1158.55,-6786.63"/>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge169" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M1185.72,-6735.22C1189.72,-6727.13 1194.42,-6717.59 1198.79,-6708.74"/>
<polygon fill="black" stroke="black" points="1202.06,-6710.02 1203.34,-6699.5 1195.78,-6706.92 1202.06,-6710.02"/>
</g>
<!-- ln1_9 -->
<g id="node120" class="node">
<title>ln1_9</title>
<polygon fill="lightpink" stroke="black" points="1259,-6622.43 1167,-6622.43 1167,-6581.43 1259,-6581.43 1259,-6622.43"/>
<text text-anchor="middle" x="1213" y="-6610.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1213" y="-6599.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1213" y="-6588.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- residual1_9&#45;&gt;ln1_9 -->
<g id="edge170" class="edge">
<title>residual1_9&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M1213,-6658.22C1213,-6650.38 1213,-6641.2 1213,-6632.59"/>
<polygon fill="black" stroke="black" points="1216.5,-6632.5 1213,-6622.5 1209.5,-6632.5 1216.5,-6632.5"/>
</g>
<!-- ffn_up_9 -->
<g id="node121" class="node">
<title>ffn_up_9</title>
<polygon fill="lightcoral" stroke="black" points="1146,-6545.43 1048,-6545.43 1048,-6504.43 1146,-6504.43 1146,-6545.43"/>
<text text-anchor="middle" x="1097" y="-6533.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1097" y="-6522.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1097" y="-6511.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;ffn_up_9 -->
<g id="edge171" class="edge">
<title>ln1_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M1182.83,-6581.42C1168.57,-6572.2 1151.38,-6561.09 1136.14,-6551.23"/>
<polygon fill="black" stroke="black" points="1137.72,-6548.09 1127.43,-6545.6 1133.92,-6553.97 1137.72,-6548.09"/>
</g>
<!-- ffn_gate_9 -->
<g id="node122" class="node">
<title>ffn_gate_9</title>
<polygon fill="lightcoral" stroke="black" points="1262,-6545.43 1164,-6545.43 1164,-6504.43 1262,-6504.43 1262,-6545.43"/>
<text text-anchor="middle" x="1213" y="-6533.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1213" y="-6522.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1213" y="-6511.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;ffn_gate_9 -->
<g id="edge172" class="edge">
<title>ln1_9&#45;&gt;ffn_gate_9</title>
<path fill="none" stroke="black" d="M1213,-6581.22C1213,-6573.38 1213,-6564.2 1213,-6555.59"/>
<polygon fill="black" stroke="black" points="1216.5,-6555.5 1213,-6545.5 1209.5,-6555.5 1216.5,-6555.5"/>
</g>
<!-- residual2_9 -->
<g id="node124" class="node">
<title>residual2_9</title>
<polygon fill="lightpink" stroke="black" points="1297,-6391.43 1205,-6391.43 1205,-6350.43 1297,-6350.43 1297,-6391.43"/>
<text text-anchor="middle" x="1251" y="-6379.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1251" y="-6368.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1251" y="-6357.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;residual2_9 -->
<g id="edge176" class="edge">
<title>ln1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1241.89,-6581.37C1253.21,-6571.98 1264.92,-6559.65 1271,-6545.43 1291.27,-6497.97 1275.75,-6436.93 1263.07,-6401.34"/>
<polygon fill="black" stroke="black" points="1266.2,-6399.73 1259.43,-6391.58 1259.64,-6402.17 1266.2,-6399.73"/>
</g>
<!-- ffn_down_9 -->
<g id="node123" class="node">
<title>ffn_down_9</title>
<polygon fill="lightcoral" stroke="black" points="1259,-6468.43 1167,-6468.43 1167,-6427.43 1259,-6427.43 1259,-6468.43"/>
<text text-anchor="middle" x="1213" y="-6456.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1213" y="-6445.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1213" y="-6434.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_down_9 -->
<g id="edge173" class="edge">
<title>ffn_up_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1127.17,-6504.42C1141.43,-6495.2 1158.62,-6484.09 1173.86,-6474.23"/>
<polygon fill="black" stroke="black" points="1176.08,-6476.97 1182.57,-6468.6 1172.28,-6471.09 1176.08,-6476.97"/>
</g>
<!-- ffn_gate_9&#45;&gt;ffn_down_9 -->
<g id="edge174" class="edge">
<title>ffn_gate_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M1213,-6504.22C1213,-6496.38 1213,-6487.2 1213,-6478.59"/>
<polygon fill="black" stroke="black" points="1216.5,-6478.5 1213,-6468.5 1209.5,-6478.5 1216.5,-6478.5"/>
</g>
<!-- ffn_down_9&#45;&gt;residual2_9 -->
<g id="edge175" class="edge">
<title>ffn_down_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M1222.98,-6427.22C1227.13,-6419.04 1232.02,-6409.39 1236.55,-6400.45"/>
<polygon fill="black" stroke="black" points="1239.69,-6402 1241.08,-6391.5 1233.44,-6398.84 1239.69,-6402"/>
</g>
<!-- ln2_9 -->
<g id="node125" class="node">
<title>ln2_9</title>
<polygon fill="lightpink" stroke="black" points="1297,-6314.43 1205,-6314.43 1205,-6273.43 1297,-6273.43 1297,-6314.43"/>
<text text-anchor="middle" x="1251" y="-6302.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1251" y="-6291.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1251" y="-6280.43" font-family="Arial" font-size="10.00">GPU 8</text>
</g>
<!-- residual2_9&#45;&gt;ln2_9 -->
<g id="edge177" class="edge">
<title>residual2_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M1251,-6350.22C1251,-6342.38 1251,-6333.2 1251,-6324.59"/>
<polygon fill="black" stroke="black" points="1254.5,-6324.5 1251,-6314.5 1247.5,-6324.5 1254.5,-6324.5"/>
</g>
<!-- split_9 -->
<g id="node126" class="node">
<title>split_9</title>
<polygon fill="lightyellow" stroke="black" points="1269.06,-6237.43 1167.16,-6237.43 1140.94,-6177.43 1242.84,-6177.43 1269.06,-6237.43"/>
<text text-anchor="middle" x="1205" y="-6210.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1205" y="-6199.43" font-family="Arial" font-size="10.00">GPU 8→9</text>
</g>
<!-- ln2_9&#45;&gt;split_9 -->
<g id="edge178" class="edge">
<title>ln2_9&#45;&gt;split_9</title>
<path fill="none" stroke="black" d="M1240.33,-6273.33C1235.95,-6265.27 1230.71,-6255.66 1225.63,-6246.33"/>
<polygon fill="black" stroke="black" points="1228.7,-6244.65 1220.85,-6237.54 1222.55,-6247.99 1228.7,-6244.65"/>
</g>
<!-- agg_10 -->
<g id="node127" class="node">
<title>agg_10</title>
<polygon fill="lightyellow" stroke="black" points="1315.06,-6141.43 1213.16,-6141.43 1186.94,-6081.43 1288.84,-6081.43 1315.06,-6141.43"/>
<text text-anchor="middle" x="1251" y="-6114.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1251" y="-6103.43" font-family="Arial" font-size="10.00">GPU 8→9</text>
</g>
<!-- ln2_9&#45;&gt;agg_10 -->
<g id="edge184" class="edge">
<title>ln2_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1263.32,-6273.19C1269,-6262.93 1275.11,-6249.96 1278,-6237.43 1283.99,-6211.44 1283.22,-6203.58 1278,-6177.43 1276.25,-6168.63 1273.28,-6159.54 1269.94,-6151.04"/>
<polygon fill="black" stroke="black" points="1273.14,-6149.62 1266.05,-6141.75 1266.68,-6152.32 1273.14,-6149.62"/>
</g>
<!-- split_9&#45;&gt;agg_10 -->
<g id="edge179" class="edge">
<title>split_9&#45;&gt;agg_10</title>
<path fill="none" stroke="black" d="M1219.3,-6177.2C1223.41,-6168.8 1227.96,-6159.51 1232.29,-6150.65"/>
<polygon fill="black" stroke="black" points="1235.45,-6152.16 1236.71,-6141.64 1229.17,-6149.08 1235.45,-6152.16"/>
</g>
<!-- mha_q_10 -->
<g id="node128" class="node">
<title>mha_q_10</title>
<polygon fill="lightgreen" stroke="black" points="1132,-6045.43 1040,-6045.43 1040,-6004.43 1132,-6004.43 1132,-6045.43"/>
<text text-anchor="middle" x="1086" y="-6033.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1086" y="-6022.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1086" y="-6011.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_q_10 -->
<g id="edge185" class="edge">
<title>agg_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M1194.22,-6081.35C1174.35,-6071.17 1152.27,-6059.86 1133.26,-6050.13"/>
<polygon fill="black" stroke="black" points="1134.7,-6046.93 1124.2,-6045.49 1131.51,-6053.17 1134.7,-6046.93"/>
</g>
<!-- mha_k_10 -->
<g id="node129" class="node">
<title>mha_k_10</title>
<polygon fill="lightgreen" stroke="black" points="1242,-6045.43 1150,-6045.43 1150,-6004.43 1242,-6004.43 1242,-6045.43"/>
<text text-anchor="middle" x="1196" y="-6033.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1196" y="-6022.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1196" y="-6011.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_k_10 -->
<g id="edge186" class="edge">
<title>agg_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M1232.07,-6081.35C1226.29,-6072.47 1219.95,-6062.72 1214.22,-6053.92"/>
<polygon fill="black" stroke="black" points="1217.12,-6051.96 1208.73,-6045.49 1211.26,-6055.78 1217.12,-6051.96"/>
</g>
<!-- mha_v_10 -->
<g id="node130" class="node">
<title>mha_v_10</title>
<polygon fill="lightgreen" stroke="black" points="1352,-6045.43 1260,-6045.43 1260,-6004.43 1352,-6004.43 1352,-6045.43"/>
<text text-anchor="middle" x="1306" y="-6033.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1306" y="-6022.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1306" y="-6011.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;mha_v_10 -->
<g id="edge187" class="edge">
<title>agg_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M1269.93,-6081.35C1275.71,-6072.47 1282.05,-6062.72 1287.78,-6053.92"/>
<polygon fill="black" stroke="black" points="1290.74,-6055.78 1293.27,-6045.49 1284.88,-6051.96 1290.74,-6055.78"/>
</g>
<!-- residual1_10 -->
<g id="node133" class="node">
<title>residual1_10</title>
<polygon fill="lightpink" stroke="black" points="1335,-5814.43 1243,-5814.43 1243,-5773.43 1335,-5773.43 1335,-5814.43"/>
<text text-anchor="middle" x="1289" y="-5802.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1289" y="-5791.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1289" y="-5780.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- agg_10&#45;&gt;residual1_10 -->
<g id="edge188" class="edge">
<title>agg_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1295.45,-6096.42C1319.43,-6086.34 1346.93,-6070.09 1361,-6045.43 1403.12,-5971.61 1344.69,-5871.28 1310.57,-5823.07"/>
<polygon fill="black" stroke="black" points="1313.21,-5820.74 1304.51,-5814.69 1307.53,-5824.84 1313.21,-5820.74"/>
</g>
<!-- mha_attn_10 -->
<g id="node131" class="node">
<title>mha_attn_10</title>
<polygon fill="lightgreen" stroke="black" points="1300,-5968.43 1196,-5968.43 1196,-5927.43 1300,-5927.43 1300,-5968.43"/>
<text text-anchor="middle" x="1248" y="-5956.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1248" y="-5945.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1248" y="-5934.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge180" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1128.14,-6004.42C1149.06,-5994.73 1174.51,-5982.95 1196.57,-5972.74"/>
<polygon fill="black" stroke="black" points="1198.18,-5975.85 1205.79,-5968.47 1195.24,-5969.49 1198.18,-5975.85"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge181" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1209.66,-6004.22C1215.45,-5995.87 1222.31,-5985.98 1228.61,-5976.89"/>
<polygon fill="black" stroke="black" points="1231.61,-5978.71 1234.43,-5968.5 1225.85,-5974.72 1231.61,-5978.71"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge182" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M1290.76,-6004.22C1284.23,-5995.78 1276.5,-5985.78 1269.41,-5976.61"/>
<polygon fill="black" stroke="black" points="1272.02,-5974.27 1263.14,-5968.5 1266.49,-5978.55 1272.02,-5974.27"/>
</g>
<!-- mha_out_10 -->
<g id="node132" class="node">
<title>mha_out_10</title>
<polygon fill="lightgreen" stroke="black" points="1297,-5891.43 1205,-5891.43 1205,-5850.43 1297,-5850.43 1297,-5891.43"/>
<text text-anchor="middle" x="1251" y="-5879.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1251" y="-5868.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1251" y="-5857.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge183" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M1248.79,-5927.22C1249.1,-5919.38 1249.47,-5910.2 1249.81,-5901.59"/>
<polygon fill="black" stroke="black" points="1253.31,-5901.63 1250.22,-5891.5 1246.32,-5901.35 1253.31,-5901.63"/>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge189" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M1260.98,-5850.22C1265.13,-5842.04 1270.02,-5832.39 1274.55,-5823.45"/>
<polygon fill="black" stroke="black" points="1277.69,-5825 1279.08,-5814.5 1271.44,-5821.84 1277.69,-5825"/>
</g>
<!-- ln1_10 -->
<g id="node134" class="node">
<title>ln1_10</title>
<polygon fill="lightpink" stroke="black" points="1335,-5737.43 1243,-5737.43 1243,-5696.43 1335,-5696.43 1335,-5737.43"/>
<text text-anchor="middle" x="1289" y="-5725.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1289" y="-5714.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1289" y="-5703.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- residual1_10&#45;&gt;ln1_10 -->
<g id="edge190" class="edge">
<title>residual1_10&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M1289,-5773.22C1289,-5765.38 1289,-5756.2 1289,-5747.59"/>
<polygon fill="black" stroke="black" points="1292.5,-5747.5 1289,-5737.5 1285.5,-5747.5 1292.5,-5747.5"/>
</g>
<!-- ffn_up_10 -->
<g id="node135" class="node">
<title>ffn_up_10</title>
<polygon fill="lightcoral" stroke="black" points="1222,-5660.43 1124,-5660.43 1124,-5619.43 1222,-5619.43 1222,-5660.43"/>
<text text-anchor="middle" x="1173" y="-5648.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1173" y="-5637.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1173" y="-5626.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;ffn_up_10 -->
<g id="edge191" class="edge">
<title>ln1_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M1258.83,-5696.42C1244.57,-5687.2 1227.38,-5676.09 1212.14,-5666.23"/>
<polygon fill="black" stroke="black" points="1213.72,-5663.09 1203.43,-5660.6 1209.92,-5668.97 1213.72,-5663.09"/>
</g>
<!-- ffn_gate_10 -->
<g id="node136" class="node">
<title>ffn_gate_10</title>
<polygon fill="lightcoral" stroke="black" points="1338,-5660.43 1240,-5660.43 1240,-5619.43 1338,-5619.43 1338,-5660.43"/>
<text text-anchor="middle" x="1289" y="-5648.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1289" y="-5637.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1289" y="-5626.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;ffn_gate_10 -->
<g id="edge192" class="edge">
<title>ln1_10&#45;&gt;ffn_gate_10</title>
<path fill="none" stroke="black" d="M1289,-5696.22C1289,-5688.38 1289,-5679.2 1289,-5670.59"/>
<polygon fill="black" stroke="black" points="1292.5,-5670.5 1289,-5660.5 1285.5,-5670.5 1292.5,-5670.5"/>
</g>
<!-- residual2_10 -->
<g id="node138" class="node">
<title>residual2_10</title>
<polygon fill="lightpink" stroke="black" points="1373,-5506.43 1281,-5506.43 1281,-5465.43 1373,-5465.43 1373,-5506.43"/>
<text text-anchor="middle" x="1327" y="-5494.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1327" y="-5483.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1327" y="-5472.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;residual2_10 -->
<g id="edge196" class="edge">
<title>ln1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1317.89,-5696.37C1329.21,-5686.98 1340.92,-5674.65 1347,-5660.43 1367.27,-5612.97 1351.75,-5551.93 1339.07,-5516.34"/>
<polygon fill="black" stroke="black" points="1342.2,-5514.73 1335.43,-5506.58 1335.64,-5517.17 1342.2,-5514.73"/>
</g>
<!-- ffn_down_10 -->
<g id="node137" class="node">
<title>ffn_down_10</title>
<polygon fill="lightcoral" stroke="black" points="1335,-5583.43 1243,-5583.43 1243,-5542.43 1335,-5542.43 1335,-5583.43"/>
<text text-anchor="middle" x="1289" y="-5571.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1289" y="-5560.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1289" y="-5549.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_down_10 -->
<g id="edge193" class="edge">
<title>ffn_up_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1203.17,-5619.42C1217.43,-5610.2 1234.62,-5599.09 1249.86,-5589.23"/>
<polygon fill="black" stroke="black" points="1252.08,-5591.97 1258.57,-5583.6 1248.28,-5586.09 1252.08,-5591.97"/>
</g>
<!-- ffn_gate_10&#45;&gt;ffn_down_10 -->
<g id="edge194" class="edge">
<title>ffn_gate_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M1289,-5619.22C1289,-5611.38 1289,-5602.2 1289,-5593.59"/>
<polygon fill="black" stroke="black" points="1292.5,-5593.5 1289,-5583.5 1285.5,-5593.5 1292.5,-5593.5"/>
</g>
<!-- ffn_down_10&#45;&gt;residual2_10 -->
<g id="edge195" class="edge">
<title>ffn_down_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M1298.98,-5542.22C1303.13,-5534.04 1308.02,-5524.39 1312.55,-5515.45"/>
<polygon fill="black" stroke="black" points="1315.69,-5517 1317.08,-5506.5 1309.44,-5513.84 1315.69,-5517"/>
</g>
<!-- ln2_10 -->
<g id="node139" class="node">
<title>ln2_10</title>
<polygon fill="lightpink" stroke="black" points="1373,-5429.43 1281,-5429.43 1281,-5388.43 1373,-5388.43 1373,-5429.43"/>
<text text-anchor="middle" x="1327" y="-5417.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1327" y="-5406.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1327" y="-5395.43" font-family="Arial" font-size="10.00">GPU 9</text>
</g>
<!-- residual2_10&#45;&gt;ln2_10 -->
<g id="edge197" class="edge">
<title>residual2_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M1327,-5465.22C1327,-5457.38 1327,-5448.2 1327,-5439.59"/>
<polygon fill="black" stroke="black" points="1330.5,-5439.5 1327,-5429.5 1323.5,-5439.5 1330.5,-5439.5"/>
</g>
<!-- split_10 -->
<g id="node140" class="node">
<title>split_10</title>
<polygon fill="lightyellow" stroke="black" points="1348.42,-5352.43 1237.99,-5352.43 1209.58,-5292.43 1320.01,-5292.43 1348.42,-5352.43"/>
<text text-anchor="middle" x="1279" y="-5325.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1279" y="-5314.43" font-family="Arial" font-size="10.00">GPU 9→10</text>
</g>
<!-- ln2_10&#45;&gt;split_10 -->
<g id="edge198" class="edge">
<title>ln2_10&#45;&gt;split_10</title>
<path fill="none" stroke="black" d="M1315.87,-5388.33C1311.29,-5380.27 1305.83,-5370.66 1300.53,-5361.33"/>
<polygon fill="black" stroke="black" points="1303.52,-5359.5 1295.54,-5352.54 1297.43,-5362.96 1303.52,-5359.5"/>
</g>
<!-- agg_11 -->
<g id="node141" class="node">
<title>agg_11</title>
<polygon fill="lightyellow" stroke="black" points="1396.42,-5256.43 1285.99,-5256.43 1257.58,-5196.43 1368.01,-5196.43 1396.42,-5256.43"/>
<text text-anchor="middle" x="1327" y="-5229.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1327" y="-5218.43" font-family="Arial" font-size="10.00">GPU 9→10</text>
</g>
<!-- ln2_10&#45;&gt;agg_11 -->
<g id="edge204" class="edge">
<title>ln2_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1340.68,-5388.37C1346.98,-5378.16 1353.78,-5365.17 1357,-5352.43 1363.54,-5326.57 1362.72,-5318.47 1357,-5292.43 1355.04,-5283.52 1351.74,-5274.38 1348.03,-5265.87"/>
<polygon fill="black" stroke="black" points="1351.1,-5264.17 1343.71,-5256.57 1344.75,-5267.12 1351.1,-5264.17"/>
</g>
<!-- split_10&#45;&gt;agg_11 -->
<g id="edge199" class="edge">
<title>split_10&#45;&gt;agg_11</title>
<path fill="none" stroke="black" d="M1293.92,-5292.2C1298.21,-5283.8 1302.96,-5274.51 1307.48,-5265.65"/>
<polygon fill="black" stroke="black" points="1310.65,-5267.13 1312.08,-5256.64 1304.42,-5263.95 1310.65,-5267.13"/>
</g>
<!-- mha_q_11 -->
<g id="node142" class="node">
<title>mha_q_11</title>
<polygon fill="lightgreen" stroke="black" points="1208,-5160.43 1116,-5160.43 1116,-5119.43 1208,-5119.43 1208,-5160.43"/>
<text text-anchor="middle" x="1162" y="-5148.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1162" y="-5137.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1162" y="-5126.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_q_11 -->
<g id="edge205" class="edge">
<title>agg_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M1270.22,-5196.35C1250.35,-5186.17 1228.27,-5174.86 1209.26,-5165.13"/>
<polygon fill="black" stroke="black" points="1210.7,-5161.93 1200.2,-5160.49 1207.51,-5168.17 1210.7,-5161.93"/>
</g>
<!-- mha_k_11 -->
<g id="node143" class="node">
<title>mha_k_11</title>
<polygon fill="lightgreen" stroke="black" points="1318,-5160.43 1226,-5160.43 1226,-5119.43 1318,-5119.43 1318,-5160.43"/>
<text text-anchor="middle" x="1272" y="-5148.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1272" y="-5137.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1272" y="-5126.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_k_11 -->
<g id="edge206" class="edge">
<title>agg_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M1308.07,-5196.35C1302.29,-5187.47 1295.95,-5177.72 1290.22,-5168.92"/>
<polygon fill="black" stroke="black" points="1293.12,-5166.96 1284.73,-5160.49 1287.26,-5170.78 1293.12,-5166.96"/>
</g>
<!-- mha_v_11 -->
<g id="node144" class="node">
<title>mha_v_11</title>
<polygon fill="lightgreen" stroke="black" points="1428,-5160.43 1336,-5160.43 1336,-5119.43 1428,-5119.43 1428,-5160.43"/>
<text text-anchor="middle" x="1382" y="-5148.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1382" y="-5137.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1382" y="-5126.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;mha_v_11 -->
<g id="edge207" class="edge">
<title>agg_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M1345.93,-5196.35C1351.71,-5187.47 1358.05,-5177.72 1363.78,-5168.92"/>
<polygon fill="black" stroke="black" points="1366.74,-5170.78 1369.27,-5160.49 1360.88,-5166.96 1366.74,-5170.78"/>
</g>
<!-- residual1_11 -->
<g id="node147" class="node">
<title>residual1_11</title>
<polygon fill="lightpink" stroke="black" points="1411,-4929.43 1319,-4929.43 1319,-4888.43 1411,-4888.43 1411,-4929.43"/>
<text text-anchor="middle" x="1365" y="-4917.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1365" y="-4906.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1365" y="-4895.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- agg_11&#45;&gt;residual1_11 -->
<g id="edge208" class="edge">
<title>agg_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1374.56,-5210.09C1397.77,-5199.93 1423.53,-5184.03 1437,-5160.43 1479.12,-5086.61 1420.69,-4986.28 1386.57,-4938.07"/>
<polygon fill="black" stroke="black" points="1389.21,-4935.74 1380.51,-4929.69 1383.53,-4939.84 1389.21,-4935.74"/>
</g>
<!-- mha_attn_11 -->
<g id="node145" class="node">
<title>mha_attn_11</title>
<polygon fill="lightgreen" stroke="black" points="1376,-5083.43 1272,-5083.43 1272,-5042.43 1376,-5042.43 1376,-5083.43"/>
<text text-anchor="middle" x="1324" y="-5071.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1324" y="-5060.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1324" y="-5049.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge200" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1204.14,-5119.42C1225.06,-5109.73 1250.51,-5097.95 1272.57,-5087.74"/>
<polygon fill="black" stroke="black" points="1274.18,-5090.85 1281.79,-5083.47 1271.24,-5084.49 1274.18,-5090.85"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge201" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1285.66,-5119.22C1291.45,-5110.87 1298.31,-5100.98 1304.61,-5091.89"/>
<polygon fill="black" stroke="black" points="1307.61,-5093.71 1310.43,-5083.5 1301.85,-5089.72 1307.61,-5093.71"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge202" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M1366.76,-5119.22C1360.23,-5110.78 1352.5,-5100.78 1345.41,-5091.61"/>
<polygon fill="black" stroke="black" points="1348.02,-5089.27 1339.14,-5083.5 1342.49,-5093.55 1348.02,-5089.27"/>
</g>
<!-- mha_out_11 -->
<g id="node146" class="node">
<title>mha_out_11</title>
<polygon fill="lightgreen" stroke="black" points="1373,-5006.43 1281,-5006.43 1281,-4965.43 1373,-4965.43 1373,-5006.43"/>
<text text-anchor="middle" x="1327" y="-4994.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1327" y="-4983.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1327" y="-4972.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge203" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M1324.79,-5042.22C1325.1,-5034.38 1325.47,-5025.2 1325.81,-5016.59"/>
<polygon fill="black" stroke="black" points="1329.31,-5016.63 1326.22,-5006.5 1322.32,-5016.35 1329.31,-5016.63"/>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge209" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M1336.98,-4965.22C1341.13,-4957.04 1346.02,-4947.39 1350.55,-4938.45"/>
<polygon fill="black" stroke="black" points="1353.69,-4940 1355.08,-4929.5 1347.44,-4936.84 1353.69,-4940"/>
</g>
<!-- ln1_11 -->
<g id="node148" class="node">
<title>ln1_11</title>
<polygon fill="lightpink" stroke="black" points="1411,-4852.43 1319,-4852.43 1319,-4811.43 1411,-4811.43 1411,-4852.43"/>
<text text-anchor="middle" x="1365" y="-4840.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1365" y="-4829.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1365" y="-4818.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- residual1_11&#45;&gt;ln1_11 -->
<g id="edge210" class="edge">
<title>residual1_11&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M1365,-4888.22C1365,-4880.38 1365,-4871.2 1365,-4862.59"/>
<polygon fill="black" stroke="black" points="1368.5,-4862.5 1365,-4852.5 1361.5,-4862.5 1368.5,-4862.5"/>
</g>
<!-- ffn_up_11 -->
<g id="node149" class="node">
<title>ffn_up_11</title>
<polygon fill="lightcoral" stroke="black" points="1298,-4775.43 1200,-4775.43 1200,-4734.43 1298,-4734.43 1298,-4775.43"/>
<text text-anchor="middle" x="1249" y="-4763.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1249" y="-4752.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1249" y="-4741.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;ffn_up_11 -->
<g id="edge211" class="edge">
<title>ln1_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M1334.83,-4811.42C1320.57,-4802.2 1303.38,-4791.09 1288.14,-4781.23"/>
<polygon fill="black" stroke="black" points="1289.72,-4778.09 1279.43,-4775.6 1285.92,-4783.97 1289.72,-4778.09"/>
</g>
<!-- ffn_gate_11 -->
<g id="node150" class="node">
<title>ffn_gate_11</title>
<polygon fill="lightcoral" stroke="black" points="1414,-4775.43 1316,-4775.43 1316,-4734.43 1414,-4734.43 1414,-4775.43"/>
<text text-anchor="middle" x="1365" y="-4763.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1365" y="-4752.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1365" y="-4741.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;ffn_gate_11 -->
<g id="edge212" class="edge">
<title>ln1_11&#45;&gt;ffn_gate_11</title>
<path fill="none" stroke="black" d="M1365,-4811.22C1365,-4803.38 1365,-4794.2 1365,-4785.59"/>
<polygon fill="black" stroke="black" points="1368.5,-4785.5 1365,-4775.5 1361.5,-4785.5 1368.5,-4785.5"/>
</g>
<!-- residual2_11 -->
<g id="node152" class="node">
<title>residual2_11</title>
<polygon fill="lightpink" stroke="black" points="1449,-4621.43 1357,-4621.43 1357,-4580.43 1449,-4580.43 1449,-4621.43"/>
<text text-anchor="middle" x="1403" y="-4609.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1403" y="-4598.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1403" y="-4587.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;residual2_11 -->
<g id="edge216" class="edge">
<title>ln1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1393.89,-4811.37C1405.21,-4801.98 1416.92,-4789.65 1423,-4775.43 1443.27,-4727.97 1427.75,-4666.93 1415.07,-4631.34"/>
<polygon fill="black" stroke="black" points="1418.2,-4629.73 1411.43,-4621.58 1411.64,-4632.17 1418.2,-4629.73"/>
</g>
<!-- ffn_down_11 -->
<g id="node151" class="node">
<title>ffn_down_11</title>
<polygon fill="lightcoral" stroke="black" points="1411,-4698.43 1319,-4698.43 1319,-4657.43 1411,-4657.43 1411,-4698.43"/>
<text text-anchor="middle" x="1365" y="-4686.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1365" y="-4675.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1365" y="-4664.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_down_11 -->
<g id="edge213" class="edge">
<title>ffn_up_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1279.17,-4734.42C1293.43,-4725.2 1310.62,-4714.09 1325.86,-4704.23"/>
<polygon fill="black" stroke="black" points="1328.08,-4706.97 1334.57,-4698.6 1324.28,-4701.09 1328.08,-4706.97"/>
</g>
<!-- ffn_gate_11&#45;&gt;ffn_down_11 -->
<g id="edge214" class="edge">
<title>ffn_gate_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M1365,-4734.22C1365,-4726.38 1365,-4717.2 1365,-4708.59"/>
<polygon fill="black" stroke="black" points="1368.5,-4708.5 1365,-4698.5 1361.5,-4708.5 1368.5,-4708.5"/>
</g>
<!-- ffn_down_11&#45;&gt;residual2_11 -->
<g id="edge215" class="edge">
<title>ffn_down_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M1374.98,-4657.22C1379.13,-4649.04 1384.02,-4639.39 1388.55,-4630.45"/>
<polygon fill="black" stroke="black" points="1391.69,-4632 1393.08,-4621.5 1385.44,-4628.84 1391.69,-4632"/>
</g>
<!-- ln2_11 -->
<g id="node153" class="node">
<title>ln2_11</title>
<polygon fill="lightpink" stroke="black" points="1449,-4544.43 1357,-4544.43 1357,-4503.43 1449,-4503.43 1449,-4544.43"/>
<text text-anchor="middle" x="1403" y="-4532.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1403" y="-4521.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1403" y="-4510.43" font-family="Arial" font-size="10.00">GPU 10</text>
</g>
<!-- residual2_11&#45;&gt;ln2_11 -->
<g id="edge217" class="edge">
<title>residual2_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M1403,-4580.22C1403,-4572.38 1403,-4563.2 1403,-4554.59"/>
<polygon fill="black" stroke="black" points="1406.5,-4554.5 1403,-4544.5 1399.5,-4554.5 1406.5,-4554.5"/>
</g>
<!-- split_11 -->
<g id="node154" class="node">
<title>split_11</title>
<polygon fill="lightyellow" stroke="black" points="1426.79,-4467.43 1307.81,-4467.43 1277.21,-4407.43 1396.19,-4407.43 1426.79,-4467.43"/>
<text text-anchor="middle" x="1352" y="-4440.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1352" y="-4429.43" font-family="Arial" font-size="10.00">GPU 10→11</text>
</g>
<!-- ln2_11&#45;&gt;split_11 -->
<g id="edge218" class="edge">
<title>ln2_11&#45;&gt;split_11</title>
<path fill="none" stroke="black" d="M1391.17,-4503.33C1386.31,-4495.27 1380.51,-4485.66 1374.88,-4476.33"/>
<polygon fill="black" stroke="black" points="1377.73,-4474.29 1369.57,-4467.54 1371.74,-4477.91 1377.73,-4474.29"/>
</g>
<!-- agg_12 -->
<g id="node155" class="node">
<title>agg_12</title>
<polygon fill="lightyellow" stroke="black" points="1477.79,-4371.43 1358.81,-4371.43 1328.21,-4311.43 1447.19,-4311.43 1477.79,-4371.43"/>
<text text-anchor="middle" x="1403" y="-4344.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1403" y="-4333.43" font-family="Arial" font-size="10.00">GPU 10→11</text>
</g>
<!-- ln2_11&#45;&gt;agg_12 -->
<g id="edge224" class="edge">
<title>ln2_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1418.2,-4503.31C1425.09,-4493.19 1432.46,-4480.29 1436,-4467.43 1443.07,-4441.71 1442.21,-4433.36 1436,-4407.43 1433.84,-4398.39 1430.2,-4389.19 1426.11,-4380.66"/>
<polygon fill="black" stroke="black" points="1429.21,-4379.03 1421.55,-4371.71 1422.97,-4382.21 1429.21,-4379.03"/>
</g>
<!-- split_11&#45;&gt;agg_12 -->
<g id="edge219" class="edge">
<title>split_11&#45;&gt;agg_12</title>
<path fill="none" stroke="black" d="M1367.86,-4407.2C1372.41,-4398.8 1377.45,-4389.51 1382.26,-4380.65"/>
<polygon fill="black" stroke="black" points="1385.46,-4382.09 1387.15,-4371.64 1379.31,-4378.76 1385.46,-4382.09"/>
</g>
<!-- mha_q_12 -->
<g id="node156" class="node">
<title>mha_q_12</title>
<polygon fill="lightgreen" stroke="black" points="1284,-4275.43 1192,-4275.43 1192,-4234.43 1284,-4234.43 1284,-4275.43"/>
<text text-anchor="middle" x="1238" y="-4263.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1238" y="-4252.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1238" y="-4241.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_q_12 -->
<g id="edge225" class="edge">
<title>agg_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M1346.22,-4311.35C1326.35,-4301.17 1304.27,-4289.86 1285.26,-4280.13"/>
<polygon fill="black" stroke="black" points="1286.7,-4276.93 1276.2,-4275.49 1283.51,-4283.17 1286.7,-4276.93"/>
</g>
<!-- mha_k_12 -->
<g id="node157" class="node">
<title>mha_k_12</title>
<polygon fill="lightgreen" stroke="black" points="1394,-4275.43 1302,-4275.43 1302,-4234.43 1394,-4234.43 1394,-4275.43"/>
<text text-anchor="middle" x="1348" y="-4263.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1348" y="-4252.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1348" y="-4241.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_k_12 -->
<g id="edge226" class="edge">
<title>agg_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M1384.07,-4311.35C1378.29,-4302.47 1371.95,-4292.72 1366.22,-4283.92"/>
<polygon fill="black" stroke="black" points="1369.12,-4281.96 1360.73,-4275.49 1363.26,-4285.78 1369.12,-4281.96"/>
</g>
<!-- mha_v_12 -->
<g id="node158" class="node">
<title>mha_v_12</title>
<polygon fill="lightgreen" stroke="black" points="1504,-4275.43 1412,-4275.43 1412,-4234.43 1504,-4234.43 1504,-4275.43"/>
<text text-anchor="middle" x="1458" y="-4263.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1458" y="-4252.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1458" y="-4241.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;mha_v_12 -->
<g id="edge227" class="edge">
<title>agg_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M1421.93,-4311.35C1427.71,-4302.47 1434.05,-4292.72 1439.78,-4283.92"/>
<polygon fill="black" stroke="black" points="1442.74,-4285.78 1445.27,-4275.49 1436.88,-4281.96 1442.74,-4285.78"/>
</g>
<!-- residual1_12 -->
<g id="node161" class="node">
<title>residual1_12</title>
<polygon fill="lightpink" stroke="black" points="1538,-4044.43 1446,-4044.43 1446,-4003.43 1538,-4003.43 1538,-4044.43"/>
<text text-anchor="middle" x="1492" y="-4032.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1492" y="-4021.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1492" y="-4010.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- agg_12&#45;&gt;residual1_12 -->
<g id="edge228" class="edge">
<title>agg_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1453.7,-4323.68C1476.06,-4313.48 1500.14,-4297.97 1513,-4275.43 1553.57,-4204.33 1523.41,-4102.93 1504.39,-4053.81"/>
<polygon fill="black" stroke="black" points="1507.61,-4052.42 1500.65,-4044.43 1501.11,-4055.01 1507.61,-4052.42"/>
</g>
<!-- mha_attn_12 -->
<g id="node159" class="node">
<title>mha_attn_12</title>
<polygon fill="lightgreen" stroke="black" points="1452,-4198.43 1348,-4198.43 1348,-4157.43 1452,-4157.43 1452,-4198.43"/>
<text text-anchor="middle" x="1400" y="-4186.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1400" y="-4175.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1400" y="-4164.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge220" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1280.14,-4234.42C1301.06,-4224.73 1326.51,-4212.95 1348.57,-4202.74"/>
<polygon fill="black" stroke="black" points="1350.18,-4205.85 1357.79,-4198.47 1347.24,-4199.49 1350.18,-4205.85"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge221" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1361.66,-4234.22C1367.45,-4225.87 1374.31,-4215.98 1380.61,-4206.89"/>
<polygon fill="black" stroke="black" points="1383.61,-4208.71 1386.43,-4198.5 1377.85,-4204.72 1383.61,-4208.71"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge222" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M1442.76,-4234.22C1436.23,-4225.78 1428.5,-4215.78 1421.41,-4206.61"/>
<polygon fill="black" stroke="black" points="1424.02,-4204.27 1415.14,-4198.5 1418.49,-4208.55 1424.02,-4204.27"/>
</g>
<!-- mha_out_12 -->
<g id="node160" class="node">
<title>mha_out_12</title>
<polygon fill="lightgreen" stroke="black" points="1501,-4121.43 1409,-4121.43 1409,-4080.43 1501,-4080.43 1501,-4121.43"/>
<text text-anchor="middle" x="1455" y="-4109.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1455" y="-4098.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1455" y="-4087.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge223" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M1414.45,-4157.22C1420.64,-4148.78 1427.98,-4138.78 1434.7,-4129.61"/>
<polygon fill="black" stroke="black" points="1437.55,-4131.63 1440.65,-4121.5 1431.91,-4127.49 1437.55,-4131.63"/>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge229" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M1464.72,-4080.22C1468.72,-4072.13 1473.42,-4062.59 1477.79,-4053.74"/>
<polygon fill="black" stroke="black" points="1481.06,-4055.02 1482.34,-4044.5 1474.78,-4051.92 1481.06,-4055.02"/>
</g>
<!-- ln1_12 -->
<g id="node162" class="node">
<title>ln1_12</title>
<polygon fill="lightpink" stroke="black" points="1538,-3967.43 1446,-3967.43 1446,-3926.43 1538,-3926.43 1538,-3967.43"/>
<text text-anchor="middle" x="1492" y="-3955.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1492" y="-3944.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1492" y="-3933.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- residual1_12&#45;&gt;ln1_12 -->
<g id="edge230" class="edge">
<title>residual1_12&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M1492,-4003.22C1492,-3995.38 1492,-3986.2 1492,-3977.59"/>
<polygon fill="black" stroke="black" points="1495.5,-3977.5 1492,-3967.5 1488.5,-3977.5 1495.5,-3977.5"/>
</g>
<!-- ffn_up_12 -->
<g id="node163" class="node">
<title>ffn_up_12</title>
<polygon fill="lightcoral" stroke="black" points="1425,-3890.43 1327,-3890.43 1327,-3849.43 1425,-3849.43 1425,-3890.43"/>
<text text-anchor="middle" x="1376" y="-3878.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1376" y="-3867.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1376" y="-3856.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;ffn_up_12 -->
<g id="edge231" class="edge">
<title>ln1_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M1461.83,-3926.42C1447.57,-3917.2 1430.38,-3906.09 1415.14,-3896.23"/>
<polygon fill="black" stroke="black" points="1416.72,-3893.09 1406.43,-3890.6 1412.92,-3898.97 1416.72,-3893.09"/>
</g>
<!-- ffn_gate_12 -->
<g id="node164" class="node">
<title>ffn_gate_12</title>
<polygon fill="lightcoral" stroke="black" points="1541,-3890.43 1443,-3890.43 1443,-3849.43 1541,-3849.43 1541,-3890.43"/>
<text text-anchor="middle" x="1492" y="-3878.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1492" y="-3867.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1492" y="-3856.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;ffn_gate_12 -->
<g id="edge232" class="edge">
<title>ln1_12&#45;&gt;ffn_gate_12</title>
<path fill="none" stroke="black" d="M1492,-3926.22C1492,-3918.38 1492,-3909.2 1492,-3900.59"/>
<polygon fill="black" stroke="black" points="1495.5,-3900.5 1492,-3890.5 1488.5,-3900.5 1495.5,-3900.5"/>
</g>
<!-- residual2_12 -->
<g id="node166" class="node">
<title>residual2_12</title>
<polygon fill="lightpink" stroke="black" points="1576,-3736.43 1484,-3736.43 1484,-3695.43 1576,-3695.43 1576,-3736.43"/>
<text text-anchor="middle" x="1530" y="-3724.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1530" y="-3713.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1530" y="-3702.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;residual2_12 -->
<g id="edge236" class="edge">
<title>ln1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M1520.89,-3926.37C1532.21,-3916.98 1543.92,-3904.65 1550,-3890.43 1570.27,-3842.97 1554.75,-3781.93 1542.07,-3746.34"/>
<polygon fill="black" stroke="black" points="1545.2,-3744.73 1538.43,-3736.58 1538.64,-3747.17 1545.2,-3744.73"/>
</g>
<!-- ffn_down_12 -->
<g id="node165" class="node">
<title>ffn_down_12</title>
<polygon fill="lightcoral" stroke="black" points="1538,-3813.43 1446,-3813.43 1446,-3772.43 1538,-3772.43 1538,-3813.43"/>
<text text-anchor="middle" x="1492" y="-3801.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1492" y="-3790.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1492" y="-3779.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_down_12 -->
<g id="edge233" class="edge">
<title>ffn_up_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M1406.17,-3849.42C1420.43,-3840.2 1437.62,-3829.09 1452.86,-3819.23"/>
<polygon fill="black" stroke="black" points="1455.08,-3821.97 1461.57,-3813.6 1451.28,-3816.09 1455.08,-3821.97"/>
</g>
<!-- ffn_gate_12&#45;&gt;ffn_down_12 -->
<g id="edge234" class="edge">
<title>ffn_gate_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M1492,-3849.22C1492,-3841.38 1492,-3832.2 1492,-3823.59"/>
<polygon fill="black" stroke="black" points="1495.5,-3823.5 1492,-3813.5 1488.5,-3823.5 1495.5,-3823.5"/>
</g>
<!-- ffn_down_12&#45;&gt;residual2_12 -->
<g id="edge235" class="edge">
<title>ffn_down_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M1501.98,-3772.22C1506.13,-3764.04 1511.02,-3754.39 1515.55,-3745.45"/>
<polygon fill="black" stroke="black" points="1518.69,-3747 1520.08,-3736.5 1512.44,-3743.84 1518.69,-3747"/>
</g>
<!-- ln2_12 -->
<g id="node167" class="node">
<title>ln2_12</title>
<polygon fill="lightpink" stroke="black" points="1576,-3659.43 1484,-3659.43 1484,-3618.43 1576,-3618.43 1576,-3659.43"/>
<text text-anchor="middle" x="1530" y="-3647.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1530" y="-3636.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1530" y="-3625.43" font-family="Arial" font-size="10.00">GPU 11</text>
</g>
<!-- residual2_12&#45;&gt;ln2_12 -->
<g id="edge237" class="edge">
<title>residual2_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M1530,-3695.22C1530,-3687.38 1530,-3678.2 1530,-3669.59"/>
<polygon fill="black" stroke="black" points="1533.5,-3669.5 1530,-3659.5 1526.5,-3669.5 1533.5,-3669.5"/>
</g>
<!-- split_12 -->
<g id="node168" class="node">
<title>split_12</title>
<polygon fill="lightyellow" stroke="black" points="1553.79,-3582.43 1434.81,-3582.43 1404.21,-3522.43 1523.19,-3522.43 1553.79,-3582.43"/>
<text text-anchor="middle" x="1479" y="-3555.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1479" y="-3544.43" font-family="Arial" font-size="10.00">GPU 11→12</text>
</g>
<!-- ln2_12&#45;&gt;split_12 -->
<g id="edge238" class="edge">
<title>ln2_12&#45;&gt;split_12</title>
<path fill="none" stroke="black" d="M1518.17,-3618.33C1513.31,-3610.27 1507.51,-3600.66 1501.88,-3591.33"/>
<polygon fill="black" stroke="black" points="1504.73,-3589.29 1496.57,-3582.54 1498.74,-3592.91 1504.73,-3589.29"/>
</g>
<!-- agg_13 -->
<g id="node169" class="node">
<title>agg_13</title>
<polygon fill="lightyellow" stroke="black" points="1604.79,-3486.43 1485.81,-3486.43 1455.21,-3426.43 1574.19,-3426.43 1604.79,-3486.43"/>
<text text-anchor="middle" x="1530" y="-3459.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1530" y="-3448.43" font-family="Arial" font-size="10.00">GPU 11→12</text>
</g>
<!-- ln2_12&#45;&gt;agg_13 -->
<g id="edge244" class="edge">
<title>ln2_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1545.2,-3618.31C1552.09,-3608.19 1559.46,-3595.29 1563,-3582.43 1570.07,-3556.71 1569.21,-3548.36 1563,-3522.43 1560.84,-3513.39 1557.2,-3504.19 1553.11,-3495.66"/>
<polygon fill="black" stroke="black" points="1556.21,-3494.03 1548.55,-3486.71 1549.97,-3497.21 1556.21,-3494.03"/>
</g>
<!-- split_12&#45;&gt;agg_13 -->
<g id="edge239" class="edge">
<title>split_12&#45;&gt;agg_13</title>
<path fill="none" stroke="black" d="M1494.86,-3522.2C1499.41,-3513.8 1504.45,-3504.51 1509.26,-3495.65"/>
<polygon fill="black" stroke="black" points="1512.46,-3497.09 1514.15,-3486.64 1506.31,-3493.76 1512.46,-3497.09"/>
</g>
<!-- mha_q_13 -->
<g id="node170" class="node">
<title>mha_q_13</title>
<polygon fill="lightgreen" stroke="black" points="1411,-3390.43 1319,-3390.43 1319,-3349.43 1411,-3349.43 1411,-3390.43"/>
<text text-anchor="middle" x="1365" y="-3378.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1365" y="-3367.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1365" y="-3356.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_q_13 -->
<g id="edge245" class="edge">
<title>agg_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M1473.22,-3426.35C1453.35,-3416.17 1431.27,-3404.86 1412.26,-3395.13"/>
<polygon fill="black" stroke="black" points="1413.7,-3391.93 1403.2,-3390.49 1410.51,-3398.17 1413.7,-3391.93"/>
</g>
<!-- mha_k_13 -->
<g id="node171" class="node">
<title>mha_k_13</title>
<polygon fill="lightgreen" stroke="black" points="1521,-3390.43 1429,-3390.43 1429,-3349.43 1521,-3349.43 1521,-3390.43"/>
<text text-anchor="middle" x="1475" y="-3378.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1475" y="-3367.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1475" y="-3356.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_k_13 -->
<g id="edge246" class="edge">
<title>agg_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M1511.07,-3426.35C1505.29,-3417.47 1498.95,-3407.72 1493.22,-3398.92"/>
<polygon fill="black" stroke="black" points="1496.12,-3396.96 1487.73,-3390.49 1490.26,-3400.78 1496.12,-3396.96"/>
</g>
<!-- mha_v_13 -->
<g id="node172" class="node">
<title>mha_v_13</title>
<polygon fill="lightgreen" stroke="black" points="1631,-3390.43 1539,-3390.43 1539,-3349.43 1631,-3349.43 1631,-3390.43"/>
<text text-anchor="middle" x="1585" y="-3378.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1585" y="-3367.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1585" y="-3356.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;mha_v_13 -->
<g id="edge247" class="edge">
<title>agg_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M1548.93,-3426.35C1554.71,-3417.47 1561.05,-3407.72 1566.78,-3398.92"/>
<polygon fill="black" stroke="black" points="1569.74,-3400.78 1572.27,-3390.49 1563.88,-3396.96 1569.74,-3400.78"/>
</g>
<!-- residual1_13 -->
<g id="node175" class="node">
<title>residual1_13</title>
<polygon fill="lightpink" stroke="black" points="1614,-3159.43 1522,-3159.43 1522,-3118.43 1614,-3118.43 1614,-3159.43"/>
<text text-anchor="middle" x="1568" y="-3147.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1568" y="-3136.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1568" y="-3125.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- agg_13&#45;&gt;residual1_13 -->
<g id="edge248" class="edge">
<title>agg_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1580.7,-3438.68C1603.06,-3428.48 1627.14,-3412.97 1640,-3390.43 1682.12,-3316.61 1623.69,-3216.28 1589.57,-3168.07"/>
<polygon fill="black" stroke="black" points="1592.21,-3165.74 1583.51,-3159.69 1586.53,-3169.84 1592.21,-3165.74"/>
</g>
<!-- mha_attn_13 -->
<g id="node173" class="node">
<title>mha_attn_13</title>
<polygon fill="lightgreen" stroke="black" points="1579,-3313.43 1475,-3313.43 1475,-3272.43 1579,-3272.43 1579,-3313.43"/>
<text text-anchor="middle" x="1527" y="-3301.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1527" y="-3290.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1527" y="-3279.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge240" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1407.14,-3349.42C1428.06,-3339.73 1453.51,-3327.95 1475.57,-3317.74"/>
<polygon fill="black" stroke="black" points="1477.18,-3320.85 1484.79,-3313.47 1474.24,-3314.49 1477.18,-3320.85"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge241" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1488.66,-3349.22C1494.45,-3340.87 1501.31,-3330.98 1507.61,-3321.89"/>
<polygon fill="black" stroke="black" points="1510.61,-3323.71 1513.43,-3313.5 1504.85,-3319.72 1510.61,-3323.71"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge242" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M1569.76,-3349.22C1563.23,-3340.78 1555.5,-3330.78 1548.41,-3321.61"/>
<polygon fill="black" stroke="black" points="1551.02,-3319.27 1542.14,-3313.5 1545.49,-3323.55 1551.02,-3319.27"/>
</g>
<!-- mha_out_13 -->
<g id="node174" class="node">
<title>mha_out_13</title>
<polygon fill="lightgreen" stroke="black" points="1576,-3236.43 1484,-3236.43 1484,-3195.43 1576,-3195.43 1576,-3236.43"/>
<text text-anchor="middle" x="1530" y="-3224.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1530" y="-3213.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1530" y="-3202.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge243" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M1527.79,-3272.22C1528.1,-3264.38 1528.47,-3255.2 1528.81,-3246.59"/>
<polygon fill="black" stroke="black" points="1532.31,-3246.63 1529.22,-3236.5 1525.32,-3246.35 1532.31,-3246.63"/>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge249" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M1539.98,-3195.22C1544.13,-3187.04 1549.02,-3177.39 1553.55,-3168.45"/>
<polygon fill="black" stroke="black" points="1556.69,-3170 1558.08,-3159.5 1550.44,-3166.84 1556.69,-3170"/>
</g>
<!-- ln1_13 -->
<g id="node176" class="node">
<title>ln1_13</title>
<polygon fill="lightpink" stroke="black" points="1614,-3082.43 1522,-3082.43 1522,-3041.43 1614,-3041.43 1614,-3082.43"/>
<text text-anchor="middle" x="1568" y="-3070.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1568" y="-3059.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1568" y="-3048.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- residual1_13&#45;&gt;ln1_13 -->
<g id="edge250" class="edge">
<title>residual1_13&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M1568,-3118.22C1568,-3110.38 1568,-3101.2 1568,-3092.59"/>
<polygon fill="black" stroke="black" points="1571.5,-3092.5 1568,-3082.5 1564.5,-3092.5 1571.5,-3092.5"/>
</g>
<!-- ffn_up_13 -->
<g id="node177" class="node">
<title>ffn_up_13</title>
<polygon fill="lightcoral" stroke="black" points="1501,-3005.43 1403,-3005.43 1403,-2964.43 1501,-2964.43 1501,-3005.43"/>
<text text-anchor="middle" x="1452" y="-2993.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1452" y="-2982.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1452" y="-2971.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;ffn_up_13 -->
<g id="edge251" class="edge">
<title>ln1_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M1537.83,-3041.42C1523.57,-3032.2 1506.38,-3021.09 1491.14,-3011.23"/>
<polygon fill="black" stroke="black" points="1492.72,-3008.09 1482.43,-3005.6 1488.92,-3013.97 1492.72,-3008.09"/>
</g>
<!-- ffn_gate_13 -->
<g id="node178" class="node">
<title>ffn_gate_13</title>
<polygon fill="lightcoral" stroke="black" points="1617,-3005.43 1519,-3005.43 1519,-2964.43 1617,-2964.43 1617,-3005.43"/>
<text text-anchor="middle" x="1568" y="-2993.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1568" y="-2982.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1568" y="-2971.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;ffn_gate_13 -->
<g id="edge252" class="edge">
<title>ln1_13&#45;&gt;ffn_gate_13</title>
<path fill="none" stroke="black" d="M1568,-3041.22C1568,-3033.38 1568,-3024.2 1568,-3015.59"/>
<polygon fill="black" stroke="black" points="1571.5,-3015.5 1568,-3005.5 1564.5,-3015.5 1571.5,-3015.5"/>
</g>
<!-- residual2_13 -->
<g id="node180" class="node">
<title>residual2_13</title>
<polygon fill="lightpink" stroke="black" points="1652,-2851.43 1560,-2851.43 1560,-2810.43 1652,-2810.43 1652,-2851.43"/>
<text text-anchor="middle" x="1606" y="-2839.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1606" y="-2828.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1606" y="-2817.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;residual2_13 -->
<g id="edge256" class="edge">
<title>ln1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M1596.89,-3041.37C1608.21,-3031.98 1619.92,-3019.65 1626,-3005.43 1646.27,-2957.97 1630.75,-2896.93 1618.07,-2861.34"/>
<polygon fill="black" stroke="black" points="1621.2,-2859.73 1614.43,-2851.58 1614.64,-2862.17 1621.2,-2859.73"/>
</g>
<!-- ffn_down_13 -->
<g id="node179" class="node">
<title>ffn_down_13</title>
<polygon fill="lightcoral" stroke="black" points="1614,-2928.43 1522,-2928.43 1522,-2887.43 1614,-2887.43 1614,-2928.43"/>
<text text-anchor="middle" x="1568" y="-2916.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1568" y="-2905.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1568" y="-2894.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_down_13 -->
<g id="edge253" class="edge">
<title>ffn_up_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M1482.17,-2964.42C1496.43,-2955.2 1513.62,-2944.09 1528.86,-2934.23"/>
<polygon fill="black" stroke="black" points="1531.08,-2936.97 1537.57,-2928.6 1527.28,-2931.09 1531.08,-2936.97"/>
</g>
<!-- ffn_gate_13&#45;&gt;ffn_down_13 -->
<g id="edge254" class="edge">
<title>ffn_gate_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M1568,-2964.22C1568,-2956.38 1568,-2947.2 1568,-2938.59"/>
<polygon fill="black" stroke="black" points="1571.5,-2938.5 1568,-2928.5 1564.5,-2938.5 1571.5,-2938.5"/>
</g>
<!-- ffn_down_13&#45;&gt;residual2_13 -->
<g id="edge255" class="edge">
<title>ffn_down_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M1577.98,-2887.22C1582.13,-2879.04 1587.02,-2869.39 1591.55,-2860.45"/>
<polygon fill="black" stroke="black" points="1594.69,-2862 1596.08,-2851.5 1588.44,-2858.84 1594.69,-2862"/>
</g>
<!-- ln2_13 -->
<g id="node181" class="node">
<title>ln2_13</title>
<polygon fill="lightpink" stroke="black" points="1652,-2774.43 1560,-2774.43 1560,-2733.43 1652,-2733.43 1652,-2774.43"/>
<text text-anchor="middle" x="1606" y="-2762.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1606" y="-2751.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1606" y="-2740.43" font-family="Arial" font-size="10.00">GPU 12</text>
</g>
<!-- residual2_13&#45;&gt;ln2_13 -->
<g id="edge257" class="edge">
<title>residual2_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M1606,-2810.22C1606,-2802.38 1606,-2793.2 1606,-2784.59"/>
<polygon fill="black" stroke="black" points="1609.5,-2784.5 1606,-2774.5 1602.5,-2784.5 1609.5,-2784.5"/>
</g>
<!-- split_13 -->
<g id="node182" class="node">
<title>split_13</title>
<polygon fill="lightyellow" stroke="black" points="1629.79,-2697.43 1510.81,-2697.43 1480.21,-2637.43 1599.19,-2637.43 1629.79,-2697.43"/>
<text text-anchor="middle" x="1555" y="-2670.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1555" y="-2659.43" font-family="Arial" font-size="10.00">GPU 12→13</text>
</g>
<!-- ln2_13&#45;&gt;split_13 -->
<g id="edge258" class="edge">
<title>ln2_13&#45;&gt;split_13</title>
<path fill="none" stroke="black" d="M1594.17,-2733.33C1589.31,-2725.27 1583.51,-2715.66 1577.88,-2706.33"/>
<polygon fill="black" stroke="black" points="1580.73,-2704.29 1572.57,-2697.54 1574.74,-2707.91 1580.73,-2704.29"/>
</g>
<!-- agg_14 -->
<g id="node183" class="node">
<title>agg_14</title>
<polygon fill="lightyellow" stroke="black" points="1680.79,-2601.43 1561.81,-2601.43 1531.21,-2541.43 1650.19,-2541.43 1680.79,-2601.43"/>
<text text-anchor="middle" x="1606" y="-2574.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1606" y="-2563.43" font-family="Arial" font-size="10.00">GPU 12→13</text>
</g>
<!-- ln2_13&#45;&gt;agg_14 -->
<g id="edge264" class="edge">
<title>ln2_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1621.2,-2733.31C1628.09,-2723.19 1635.46,-2710.29 1639,-2697.43 1646.07,-2671.71 1645.21,-2663.36 1639,-2637.43 1636.84,-2628.39 1633.2,-2619.19 1629.11,-2610.66"/>
<polygon fill="black" stroke="black" points="1632.21,-2609.03 1624.55,-2601.71 1625.97,-2612.21 1632.21,-2609.03"/>
</g>
<!-- split_13&#45;&gt;agg_14 -->
<g id="edge259" class="edge">
<title>split_13&#45;&gt;agg_14</title>
<path fill="none" stroke="black" d="M1570.86,-2637.2C1575.41,-2628.8 1580.45,-2619.51 1585.26,-2610.65"/>
<polygon fill="black" stroke="black" points="1588.46,-2612.09 1590.15,-2601.64 1582.31,-2608.76 1588.46,-2612.09"/>
</g>
<!-- mha_q_14 -->
<g id="node184" class="node">
<title>mha_q_14</title>
<polygon fill="lightgreen" stroke="black" points="1487,-2505.43 1395,-2505.43 1395,-2464.43 1487,-2464.43 1487,-2505.43"/>
<text text-anchor="middle" x="1441" y="-2493.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1441" y="-2482.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1441" y="-2471.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_q_14 -->
<g id="edge265" class="edge">
<title>agg_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M1549.22,-2541.35C1529.35,-2531.17 1507.27,-2519.86 1488.26,-2510.13"/>
<polygon fill="black" stroke="black" points="1489.7,-2506.93 1479.2,-2505.49 1486.51,-2513.17 1489.7,-2506.93"/>
</g>
<!-- mha_k_14 -->
<g id="node185" class="node">
<title>mha_k_14</title>
<polygon fill="lightgreen" stroke="black" points="1597,-2505.43 1505,-2505.43 1505,-2464.43 1597,-2464.43 1597,-2505.43"/>
<text text-anchor="middle" x="1551" y="-2493.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1551" y="-2482.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1551" y="-2471.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_k_14 -->
<g id="edge266" class="edge">
<title>agg_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M1587.07,-2541.35C1581.29,-2532.47 1574.95,-2522.72 1569.22,-2513.92"/>
<polygon fill="black" stroke="black" points="1572.12,-2511.96 1563.73,-2505.49 1566.26,-2515.78 1572.12,-2511.96"/>
</g>
<!-- mha_v_14 -->
<g id="node186" class="node">
<title>mha_v_14</title>
<polygon fill="lightgreen" stroke="black" points="1707,-2505.43 1615,-2505.43 1615,-2464.43 1707,-2464.43 1707,-2505.43"/>
<text text-anchor="middle" x="1661" y="-2493.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1661" y="-2482.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1661" y="-2471.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;mha_v_14 -->
<g id="edge267" class="edge">
<title>agg_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M1624.93,-2541.35C1630.71,-2532.47 1637.05,-2522.72 1642.78,-2513.92"/>
<polygon fill="black" stroke="black" points="1645.74,-2515.78 1648.27,-2505.49 1639.88,-2511.96 1645.74,-2515.78"/>
</g>
<!-- residual1_14 -->
<g id="node189" class="node">
<title>residual1_14</title>
<polygon fill="lightpink" stroke="black" points="1741,-2274.43 1649,-2274.43 1649,-2233.43 1741,-2233.43 1741,-2274.43"/>
<text text-anchor="middle" x="1695" y="-2262.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1695" y="-2251.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1695" y="-2240.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- agg_14&#45;&gt;residual1_14 -->
<g id="edge268" class="edge">
<title>agg_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1656.7,-2553.68C1679.06,-2543.48 1703.14,-2527.97 1716,-2505.43 1756.57,-2434.33 1726.41,-2332.93 1707.39,-2283.81"/>
<polygon fill="black" stroke="black" points="1710.61,-2282.42 1703.65,-2274.43 1704.11,-2285.01 1710.61,-2282.42"/>
</g>
<!-- mha_attn_14 -->
<g id="node187" class="node">
<title>mha_attn_14</title>
<polygon fill="lightgreen" stroke="black" points="1655,-2428.43 1551,-2428.43 1551,-2387.43 1655,-2387.43 1655,-2428.43"/>
<text text-anchor="middle" x="1603" y="-2416.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1603" y="-2405.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1603" y="-2394.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge260" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1483.14,-2464.42C1504.06,-2454.73 1529.51,-2442.95 1551.57,-2432.74"/>
<polygon fill="black" stroke="black" points="1553.18,-2435.85 1560.79,-2428.47 1550.24,-2429.49 1553.18,-2435.85"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge261" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1564.66,-2464.22C1570.45,-2455.87 1577.31,-2445.98 1583.61,-2436.89"/>
<polygon fill="black" stroke="black" points="1586.61,-2438.71 1589.43,-2428.5 1580.85,-2434.72 1586.61,-2438.71"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge262" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M1645.76,-2464.22C1639.23,-2455.78 1631.5,-2445.78 1624.41,-2436.61"/>
<polygon fill="black" stroke="black" points="1627.02,-2434.27 1618.14,-2428.5 1621.49,-2438.55 1627.02,-2434.27"/>
</g>
<!-- mha_out_14 -->
<g id="node188" class="node">
<title>mha_out_14</title>
<polygon fill="lightgreen" stroke="black" points="1704,-2351.43 1612,-2351.43 1612,-2310.43 1704,-2310.43 1704,-2351.43"/>
<text text-anchor="middle" x="1658" y="-2339.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1658" y="-2328.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1658" y="-2317.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge263" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M1617.45,-2387.22C1623.64,-2378.78 1630.98,-2368.78 1637.7,-2359.61"/>
<polygon fill="black" stroke="black" points="1640.55,-2361.63 1643.65,-2351.5 1634.91,-2357.49 1640.55,-2361.63"/>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge269" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M1667.72,-2310.22C1671.72,-2302.13 1676.42,-2292.59 1680.79,-2283.74"/>
<polygon fill="black" stroke="black" points="1684.06,-2285.02 1685.34,-2274.5 1677.78,-2281.92 1684.06,-2285.02"/>
</g>
<!-- ln1_14 -->
<g id="node190" class="node">
<title>ln1_14</title>
<polygon fill="lightpink" stroke="black" points="1741,-2197.43 1649,-2197.43 1649,-2156.43 1741,-2156.43 1741,-2197.43"/>
<text text-anchor="middle" x="1695" y="-2185.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1695" y="-2174.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1695" y="-2163.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- residual1_14&#45;&gt;ln1_14 -->
<g id="edge270" class="edge">
<title>residual1_14&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M1695,-2233.22C1695,-2225.38 1695,-2216.2 1695,-2207.59"/>
<polygon fill="black" stroke="black" points="1698.5,-2207.5 1695,-2197.5 1691.5,-2207.5 1698.5,-2207.5"/>
</g>
<!-- ffn_up_14 -->
<g id="node191" class="node">
<title>ffn_up_14</title>
<polygon fill="lightcoral" stroke="black" points="1628,-2120.43 1530,-2120.43 1530,-2079.43 1628,-2079.43 1628,-2120.43"/>
<text text-anchor="middle" x="1579" y="-2108.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1579" y="-2097.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1579" y="-2086.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;ffn_up_14 -->
<g id="edge271" class="edge">
<title>ln1_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M1664.83,-2156.42C1650.57,-2147.2 1633.38,-2136.09 1618.14,-2126.23"/>
<polygon fill="black" stroke="black" points="1619.72,-2123.09 1609.43,-2120.6 1615.92,-2128.97 1619.72,-2123.09"/>
</g>
<!-- ffn_gate_14 -->
<g id="node192" class="node">
<title>ffn_gate_14</title>
<polygon fill="lightcoral" stroke="black" points="1744,-2120.43 1646,-2120.43 1646,-2079.43 1744,-2079.43 1744,-2120.43"/>
<text text-anchor="middle" x="1695" y="-2108.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1695" y="-2097.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1695" y="-2086.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;ffn_gate_14 -->
<g id="edge272" class="edge">
<title>ln1_14&#45;&gt;ffn_gate_14</title>
<path fill="none" stroke="black" d="M1695,-2156.22C1695,-2148.38 1695,-2139.2 1695,-2130.59"/>
<polygon fill="black" stroke="black" points="1698.5,-2130.5 1695,-2120.5 1691.5,-2130.5 1698.5,-2130.5"/>
</g>
<!-- residual2_14 -->
<g id="node194" class="node">
<title>residual2_14</title>
<polygon fill="lightpink" stroke="black" points="1779,-1966.43 1687,-1966.43 1687,-1925.43 1779,-1925.43 1779,-1966.43"/>
<text text-anchor="middle" x="1733" y="-1954.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1733" y="-1943.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1733" y="-1932.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;residual2_14 -->
<g id="edge276" class="edge">
<title>ln1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M1723.89,-2156.37C1735.21,-2146.98 1746.92,-2134.65 1753,-2120.43 1773.27,-2072.97 1757.75,-2011.93 1745.07,-1976.34"/>
<polygon fill="black" stroke="black" points="1748.2,-1974.73 1741.43,-1966.58 1741.64,-1977.17 1748.2,-1974.73"/>
</g>
<!-- ffn_down_14 -->
<g id="node193" class="node">
<title>ffn_down_14</title>
<polygon fill="lightcoral" stroke="black" points="1741,-2043.43 1649,-2043.43 1649,-2002.43 1741,-2002.43 1741,-2043.43"/>
<text text-anchor="middle" x="1695" y="-2031.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1695" y="-2020.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1695" y="-2009.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_down_14 -->
<g id="edge273" class="edge">
<title>ffn_up_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M1609.17,-2079.42C1623.43,-2070.2 1640.62,-2059.09 1655.86,-2049.23"/>
<polygon fill="black" stroke="black" points="1658.08,-2051.97 1664.57,-2043.6 1654.28,-2046.09 1658.08,-2051.97"/>
</g>
<!-- ffn_gate_14&#45;&gt;ffn_down_14 -->
<g id="edge274" class="edge">
<title>ffn_gate_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M1695,-2079.22C1695,-2071.38 1695,-2062.2 1695,-2053.59"/>
<polygon fill="black" stroke="black" points="1698.5,-2053.5 1695,-2043.5 1691.5,-2053.5 1698.5,-2053.5"/>
</g>
<!-- ffn_down_14&#45;&gt;residual2_14 -->
<g id="edge275" class="edge">
<title>ffn_down_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M1704.98,-2002.22C1709.13,-1994.04 1714.02,-1984.39 1718.55,-1975.45"/>
<polygon fill="black" stroke="black" points="1721.69,-1977 1723.08,-1966.5 1715.44,-1973.84 1721.69,-1977"/>
</g>
<!-- ln2_14 -->
<g id="node195" class="node">
<title>ln2_14</title>
<polygon fill="lightpink" stroke="black" points="1779,-1889.43 1687,-1889.43 1687,-1848.43 1779,-1848.43 1779,-1889.43"/>
<text text-anchor="middle" x="1733" y="-1877.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1733" y="-1866.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1733" y="-1855.43" font-family="Arial" font-size="10.00">GPU 13</text>
</g>
<!-- residual2_14&#45;&gt;ln2_14 -->
<g id="edge277" class="edge">
<title>residual2_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M1733,-1925.22C1733,-1917.38 1733,-1908.2 1733,-1899.59"/>
<polygon fill="black" stroke="black" points="1736.5,-1899.5 1733,-1889.5 1729.5,-1899.5 1736.5,-1899.5"/>
</g>
<!-- split_14 -->
<g id="node196" class="node">
<title>split_14</title>
<polygon fill="lightyellow" stroke="black" points="1756.79,-1812.43 1637.81,-1812.43 1607.21,-1752.43 1726.19,-1752.43 1756.79,-1812.43"/>
<text text-anchor="middle" x="1682" y="-1785.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1682" y="-1774.43" font-family="Arial" font-size="10.00">GPU 13→14</text>
</g>
<!-- ln2_14&#45;&gt;split_14 -->
<g id="edge278" class="edge">
<title>ln2_14&#45;&gt;split_14</title>
<path fill="none" stroke="black" d="M1721.17,-1848.33C1716.31,-1840.27 1710.51,-1830.66 1704.88,-1821.33"/>
<polygon fill="black" stroke="black" points="1707.73,-1819.29 1699.57,-1812.54 1701.74,-1822.91 1707.73,-1819.29"/>
</g>
<!-- agg_15 -->
<g id="node197" class="node">
<title>agg_15</title>
<polygon fill="lightyellow" stroke="black" points="1807.79,-1716.43 1688.81,-1716.43 1658.21,-1656.43 1777.19,-1656.43 1807.79,-1716.43"/>
<text text-anchor="middle" x="1733" y="-1689.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1733" y="-1678.43" font-family="Arial" font-size="10.00">GPU 13→14</text>
</g>
<!-- ln2_14&#45;&gt;agg_15 -->
<g id="edge284" class="edge">
<title>ln2_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1748.2,-1848.31C1755.09,-1838.19 1762.46,-1825.29 1766,-1812.43 1773.07,-1786.71 1772.21,-1778.36 1766,-1752.43 1763.84,-1743.39 1760.2,-1734.19 1756.11,-1725.66"/>
<polygon fill="black" stroke="black" points="1759.21,-1724.03 1751.55,-1716.71 1752.97,-1727.21 1759.21,-1724.03"/>
</g>
<!-- split_14&#45;&gt;agg_15 -->
<g id="edge279" class="edge">
<title>split_14&#45;&gt;agg_15</title>
<path fill="none" stroke="black" d="M1697.86,-1752.2C1702.41,-1743.8 1707.45,-1734.51 1712.26,-1725.65"/>
<polygon fill="black" stroke="black" points="1715.46,-1727.09 1717.15,-1716.64 1709.31,-1723.76 1715.46,-1727.09"/>
</g>
<!-- mha_q_15 -->
<g id="node198" class="node">
<title>mha_q_15</title>
<polygon fill="lightgreen" stroke="black" points="1614,-1620.43 1522,-1620.43 1522,-1579.43 1614,-1579.43 1614,-1620.43"/>
<text text-anchor="middle" x="1568" y="-1608.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1568" y="-1597.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1568" y="-1586.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_q_15 -->
<g id="edge285" class="edge">
<title>agg_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M1676.22,-1656.35C1656.35,-1646.17 1634.27,-1634.86 1615.26,-1625.13"/>
<polygon fill="black" stroke="black" points="1616.7,-1621.93 1606.2,-1620.49 1613.51,-1628.17 1616.7,-1621.93"/>
</g>
<!-- mha_k_15 -->
<g id="node199" class="node">
<title>mha_k_15</title>
<polygon fill="lightgreen" stroke="black" points="1724,-1620.43 1632,-1620.43 1632,-1579.43 1724,-1579.43 1724,-1620.43"/>
<text text-anchor="middle" x="1678" y="-1608.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1678" y="-1597.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1678" y="-1586.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_k_15 -->
<g id="edge286" class="edge">
<title>agg_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M1714.07,-1656.35C1708.29,-1647.47 1701.95,-1637.72 1696.22,-1628.92"/>
<polygon fill="black" stroke="black" points="1699.12,-1626.96 1690.73,-1620.49 1693.26,-1630.78 1699.12,-1626.96"/>
</g>
<!-- mha_v_15 -->
<g id="node200" class="node">
<title>mha_v_15</title>
<polygon fill="lightgreen" stroke="black" points="1834,-1620.43 1742,-1620.43 1742,-1579.43 1834,-1579.43 1834,-1620.43"/>
<text text-anchor="middle" x="1788" y="-1608.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1788" y="-1597.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1788" y="-1586.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;mha_v_15 -->
<g id="edge287" class="edge">
<title>agg_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M1751.93,-1656.35C1757.71,-1647.47 1764.05,-1637.72 1769.78,-1628.92"/>
<polygon fill="black" stroke="black" points="1772.74,-1630.78 1775.27,-1620.49 1766.88,-1626.96 1772.74,-1630.78"/>
</g>
<!-- residual1_15 -->
<g id="node203" class="node">
<title>residual1_15</title>
<polygon fill="lightpink" stroke="black" points="1868,-1389.43 1776,-1389.43 1776,-1348.43 1868,-1348.43 1868,-1389.43"/>
<text text-anchor="middle" x="1822" y="-1377.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1822" y="-1366.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1822" y="-1355.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- agg_15&#45;&gt;residual1_15 -->
<g id="edge288" class="edge">
<title>agg_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1783.7,-1668.68C1806.06,-1658.48 1830.14,-1642.97 1843,-1620.43 1883.57,-1549.33 1853.41,-1447.93 1834.39,-1398.81"/>
<polygon fill="black" stroke="black" points="1837.61,-1397.42 1830.65,-1389.43 1831.11,-1400.01 1837.61,-1397.42"/>
</g>
<!-- mha_attn_15 -->
<g id="node201" class="node">
<title>mha_attn_15</title>
<polygon fill="lightgreen" stroke="black" points="1782,-1543.43 1678,-1543.43 1678,-1502.43 1782,-1502.43 1782,-1543.43"/>
<text text-anchor="middle" x="1730" y="-1531.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1730" y="-1520.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1730" y="-1509.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge280" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1610.14,-1579.42C1631.06,-1569.73 1656.51,-1557.95 1678.57,-1547.74"/>
<polygon fill="black" stroke="black" points="1680.18,-1550.85 1687.79,-1543.47 1677.24,-1544.49 1680.18,-1550.85"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge281" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1691.66,-1579.22C1697.45,-1570.87 1704.31,-1560.98 1710.61,-1551.89"/>
<polygon fill="black" stroke="black" points="1713.61,-1553.71 1716.43,-1543.5 1707.85,-1549.72 1713.61,-1553.71"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge282" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M1772.76,-1579.22C1766.23,-1570.78 1758.5,-1560.78 1751.41,-1551.61"/>
<polygon fill="black" stroke="black" points="1754.02,-1549.27 1745.14,-1543.5 1748.49,-1553.55 1754.02,-1549.27"/>
</g>
<!-- mha_out_15 -->
<g id="node202" class="node">
<title>mha_out_15</title>
<polygon fill="lightgreen" stroke="black" points="1831,-1466.43 1739,-1466.43 1739,-1425.43 1831,-1425.43 1831,-1466.43"/>
<text text-anchor="middle" x="1785" y="-1454.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1785" y="-1443.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1785" y="-1432.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge283" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M1744.45,-1502.22C1750.64,-1493.78 1757.98,-1483.78 1764.7,-1474.61"/>
<polygon fill="black" stroke="black" points="1767.55,-1476.63 1770.65,-1466.5 1761.91,-1472.49 1767.55,-1476.63"/>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge289" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M1794.72,-1425.22C1798.72,-1417.13 1803.42,-1407.59 1807.79,-1398.74"/>
<polygon fill="black" stroke="black" points="1811.06,-1400.02 1812.34,-1389.5 1804.78,-1396.92 1811.06,-1400.02"/>
</g>
<!-- ln1_15 -->
<g id="node204" class="node">
<title>ln1_15</title>
<polygon fill="lightpink" stroke="black" points="1868,-1312.43 1776,-1312.43 1776,-1271.43 1868,-1271.43 1868,-1312.43"/>
<text text-anchor="middle" x="1822" y="-1300.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1822" y="-1289.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1822" y="-1278.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- residual1_15&#45;&gt;ln1_15 -->
<g id="edge290" class="edge">
<title>residual1_15&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M1822,-1348.22C1822,-1340.38 1822,-1331.2 1822,-1322.59"/>
<polygon fill="black" stroke="black" points="1825.5,-1322.5 1822,-1312.5 1818.5,-1322.5 1825.5,-1322.5"/>
</g>
<!-- ffn_up_15 -->
<g id="node205" class="node">
<title>ffn_up_15</title>
<polygon fill="lightcoral" stroke="black" points="1755,-1235.43 1657,-1235.43 1657,-1194.43 1755,-1194.43 1755,-1235.43"/>
<text text-anchor="middle" x="1706" y="-1223.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1706" y="-1212.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1706" y="-1201.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;ffn_up_15 -->
<g id="edge291" class="edge">
<title>ln1_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M1791.83,-1271.42C1777.57,-1262.2 1760.38,-1251.09 1745.14,-1241.23"/>
<polygon fill="black" stroke="black" points="1746.72,-1238.09 1736.43,-1235.6 1742.92,-1243.97 1746.72,-1238.09"/>
</g>
<!-- ffn_gate_15 -->
<g id="node206" class="node">
<title>ffn_gate_15</title>
<polygon fill="lightcoral" stroke="black" points="1871,-1235.43 1773,-1235.43 1773,-1194.43 1871,-1194.43 1871,-1235.43"/>
<text text-anchor="middle" x="1822" y="-1223.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1822" y="-1212.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1822" y="-1201.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;ffn_gate_15 -->
<g id="edge292" class="edge">
<title>ln1_15&#45;&gt;ffn_gate_15</title>
<path fill="none" stroke="black" d="M1822,-1271.22C1822,-1263.38 1822,-1254.2 1822,-1245.59"/>
<polygon fill="black" stroke="black" points="1825.5,-1245.5 1822,-1235.5 1818.5,-1245.5 1825.5,-1245.5"/>
</g>
<!-- residual2_15 -->
<g id="node208" class="node">
<title>residual2_15</title>
<polygon fill="lightpink" stroke="black" points="1906,-1081.43 1814,-1081.43 1814,-1040.43 1906,-1040.43 1906,-1081.43"/>
<text text-anchor="middle" x="1860" y="-1069.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1860" y="-1058.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1860" y="-1047.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;residual2_15 -->
<g id="edge296" class="edge">
<title>ln1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1850.89,-1271.37C1862.21,-1261.98 1873.92,-1249.65 1880,-1235.43 1900.27,-1187.97 1884.75,-1126.93 1872.07,-1091.34"/>
<polygon fill="black" stroke="black" points="1875.2,-1089.73 1868.43,-1081.58 1868.64,-1092.17 1875.2,-1089.73"/>
</g>
<!-- ffn_down_15 -->
<g id="node207" class="node">
<title>ffn_down_15</title>
<polygon fill="lightcoral" stroke="black" points="1868,-1158.43 1776,-1158.43 1776,-1117.43 1868,-1117.43 1868,-1158.43"/>
<text text-anchor="middle" x="1822" y="-1146.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1822" y="-1135.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1822" y="-1124.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_down_15 -->
<g id="edge293" class="edge">
<title>ffn_up_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M1736.17,-1194.42C1750.43,-1185.2 1767.62,-1174.09 1782.86,-1164.23"/>
<polygon fill="black" stroke="black" points="1785.08,-1166.97 1791.57,-1158.6 1781.28,-1161.09 1785.08,-1166.97"/>
</g>
<!-- ffn_gate_15&#45;&gt;ffn_down_15 -->
<g id="edge294" class="edge">
<title>ffn_gate_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M1822,-1194.22C1822,-1186.38 1822,-1177.2 1822,-1168.59"/>
<polygon fill="black" stroke="black" points="1825.5,-1168.5 1822,-1158.5 1818.5,-1168.5 1825.5,-1168.5"/>
</g>
<!-- ffn_down_15&#45;&gt;residual2_15 -->
<g id="edge295" class="edge">
<title>ffn_down_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M1831.98,-1117.22C1836.13,-1109.04 1841.02,-1099.39 1845.55,-1090.45"/>
<polygon fill="black" stroke="black" points="1848.69,-1092 1850.08,-1081.5 1842.44,-1088.84 1848.69,-1092"/>
</g>
<!-- ln2_15 -->
<g id="node209" class="node">
<title>ln2_15</title>
<polygon fill="lightpink" stroke="black" points="1906,-1004.43 1814,-1004.43 1814,-963.43 1906,-963.43 1906,-1004.43"/>
<text text-anchor="middle" x="1860" y="-992.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1860" y="-981.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1860" y="-970.43" font-family="Arial" font-size="10.00">GPU 14</text>
</g>
<!-- residual2_15&#45;&gt;ln2_15 -->
<g id="edge297" class="edge">
<title>residual2_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M1860,-1040.22C1860,-1032.38 1860,-1023.2 1860,-1014.59"/>
<polygon fill="black" stroke="black" points="1863.5,-1014.5 1860,-1004.5 1856.5,-1014.5 1863.5,-1014.5"/>
</g>
<!-- split_15 -->
<g id="node210" class="node">
<title>split_15</title>
<polygon fill="lightyellow" stroke="black" points="1883.79,-927.43 1764.81,-927.43 1734.21,-867.43 1853.19,-867.43 1883.79,-927.43"/>
<text text-anchor="middle" x="1809" y="-900.43" font-family="Arial" font-size="10.00">Split</text>
<text text-anchor="middle" x="1809" y="-889.43" font-family="Arial" font-size="10.00">GPU 14→15</text>
</g>
<!-- ln2_15&#45;&gt;split_15 -->
<g id="edge298" class="edge">
<title>ln2_15&#45;&gt;split_15</title>
<path fill="none" stroke="black" d="M1848.17,-963.33C1843.31,-955.27 1837.51,-945.66 1831.88,-936.33"/>
<polygon fill="black" stroke="black" points="1834.73,-934.29 1826.57,-927.54 1828.74,-937.91 1834.73,-934.29"/>
</g>
<!-- agg_16 -->
<g id="node211" class="node">
<title>agg_16</title>
<polygon fill="lightyellow" stroke="black" points="1934.79,-831.43 1815.81,-831.43 1785.21,-771.43 1904.19,-771.43 1934.79,-831.43"/>
<text text-anchor="middle" x="1860" y="-804.43" font-family="Arial" font-size="10.00">Aggregate</text>
<text text-anchor="middle" x="1860" y="-793.43" font-family="Arial" font-size="10.00">GPU 14→15</text>
</g>
<!-- ln2_15&#45;&gt;agg_16 -->
<g id="edge304" class="edge">
<title>ln2_15&#45;&gt;agg_16</title>
<path fill="none" stroke="black" d="M1875.2,-963.31C1882.09,-953.19 1889.46,-940.29 1893,-927.43 1900.07,-901.71 1899.21,-893.36 1893,-867.43 1890.84,-858.39 1887.2,-849.19 1883.11,-840.66"/>
<polygon fill="black" stroke="black" points="1886.21,-839.03 1878.55,-831.71 1879.97,-842.21 1886.21,-839.03"/>
</g>
<!-- split_15&#45;&gt;agg_16 -->
<g id="edge299" class="edge">
<title>split_15&#45;&gt;agg_16</title>
<path fill="none" stroke="black" d="M1824.86,-867.2C1829.41,-858.8 1834.45,-849.51 1839.26,-840.65"/>
<polygon fill="black" stroke="black" points="1842.46,-842.09 1844.15,-831.64 1836.31,-838.76 1842.46,-842.09"/>
</g>
<!-- mha_q_16 -->
<g id="node212" class="node">
<title>mha_q_16</title>
<polygon fill="lightgreen" stroke="black" points="1741,-735.43 1649,-735.43 1649,-694.43 1741,-694.43 1741,-735.43"/>
<text text-anchor="middle" x="1695" y="-723.43" font-family="Arial" font-size="10.00">MHA Query</text>
<text text-anchor="middle" x="1695" y="-712.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1695" y="-701.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_q_16 -->
<g id="edge305" class="edge">
<title>agg_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M1803.22,-771.35C1783.35,-761.17 1761.27,-749.86 1742.26,-740.13"/>
<polygon fill="black" stroke="black" points="1743.7,-736.93 1733.2,-735.49 1740.51,-743.17 1743.7,-736.93"/>
</g>
<!-- mha_k_16 -->
<g id="node213" class="node">
<title>mha_k_16</title>
<polygon fill="lightgreen" stroke="black" points="1851,-735.43 1759,-735.43 1759,-694.43 1851,-694.43 1851,-735.43"/>
<text text-anchor="middle" x="1805" y="-723.43" font-family="Arial" font-size="10.00">MHA Key</text>
<text text-anchor="middle" x="1805" y="-712.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1805" y="-701.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_k_16 -->
<g id="edge306" class="edge">
<title>agg_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M1841.07,-771.35C1835.29,-762.47 1828.95,-752.72 1823.22,-743.92"/>
<polygon fill="black" stroke="black" points="1826.12,-741.96 1817.73,-735.49 1820.26,-745.78 1826.12,-741.96"/>
</g>
<!-- mha_v_16 -->
<g id="node214" class="node">
<title>mha_v_16</title>
<polygon fill="lightgreen" stroke="black" points="1961,-735.43 1869,-735.43 1869,-694.43 1961,-694.43 1961,-735.43"/>
<text text-anchor="middle" x="1915" y="-723.43" font-family="Arial" font-size="10.00">MHA Value</text>
<text text-anchor="middle" x="1915" y="-712.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1915" y="-701.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;mha_v_16 -->
<g id="edge307" class="edge">
<title>agg_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M1878.93,-771.35C1884.71,-762.47 1891.05,-752.72 1896.78,-743.92"/>
<polygon fill="black" stroke="black" points="1899.74,-745.78 1902.27,-735.49 1893.88,-741.96 1899.74,-745.78"/>
</g>
<!-- residual1_16 -->
<g id="node217" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="1995,-504.43 1903,-504.43 1903,-463.43 1995,-463.43 1995,-504.43"/>
<text text-anchor="middle" x="1949" y="-492.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1949" y="-481.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1949" y="-470.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- agg_16&#45;&gt;residual1_16 -->
<g id="edge308" class="edge">
<title>agg_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M1910.7,-783.68C1933.06,-773.48 1957.14,-757.97 1970,-735.43 2010.57,-664.33 1980.41,-562.93 1961.39,-513.81"/>
<polygon fill="black" stroke="black" points="1964.61,-512.42 1957.65,-504.43 1958.11,-515.01 1964.61,-512.42"/>
</g>
<!-- mha_attn_16 -->
<g id="node215" class="node">
<title>mha_attn_16</title>
<polygon fill="lightgreen" stroke="black" points="1909,-658.43 1805,-658.43 1805,-617.43 1909,-617.43 1909,-658.43"/>
<text text-anchor="middle" x="1857" y="-646.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1857" y="-635.43" font-family="Arial" font-size="10.00">[1024×16×512×512]</text>
<text text-anchor="middle" x="1857" y="-624.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge300" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1737.14,-694.42C1758.06,-684.73 1783.51,-672.95 1805.57,-662.74"/>
<polygon fill="black" stroke="black" points="1807.18,-665.85 1814.79,-658.47 1804.24,-659.49 1807.18,-665.85"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge301" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1818.66,-694.22C1824.45,-685.87 1831.31,-675.98 1837.61,-666.89"/>
<polygon fill="black" stroke="black" points="1840.61,-668.71 1843.43,-658.5 1834.85,-664.72 1840.61,-668.71"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge302" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M1899.76,-694.22C1893.23,-685.78 1885.5,-675.78 1878.41,-666.61"/>
<polygon fill="black" stroke="black" points="1881.02,-664.27 1872.14,-658.5 1875.49,-668.55 1881.02,-664.27"/>
</g>
<!-- mha_out_16 -->
<g id="node216" class="node">
<title>mha_out_16</title>
<polygon fill="lightgreen" stroke="black" points="1958,-581.43 1866,-581.43 1866,-540.43 1958,-540.43 1958,-581.43"/>
<text text-anchor="middle" x="1912" y="-569.43" font-family="Arial" font-size="10.00">MHA Output</text>
<text text-anchor="middle" x="1912" y="-558.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1912" y="-547.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge303" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M1871.45,-617.22C1877.64,-608.78 1884.98,-598.78 1891.7,-589.61"/>
<polygon fill="black" stroke="black" points="1894.55,-591.63 1897.65,-581.5 1888.91,-587.49 1894.55,-591.63"/>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge309" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M1921.72,-540.22C1925.72,-532.13 1930.42,-522.59 1934.79,-513.74"/>
<polygon fill="black" stroke="black" points="1938.06,-515.02 1939.34,-504.5 1931.78,-511.92 1938.06,-515.02"/>
</g>
<!-- ln1_16 -->
<g id="node218" class="node">
<title>ln1_16</title>
<polygon fill="lightpink" stroke="black" points="1995,-427.43 1903,-427.43 1903,-386.43 1995,-386.43 1995,-427.43"/>
<text text-anchor="middle" x="1949" y="-415.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1949" y="-404.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1949" y="-393.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- residual1_16&#45;&gt;ln1_16 -->
<g id="edge310" class="edge">
<title>residual1_16&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M1949,-463.22C1949,-455.38 1949,-446.2 1949,-437.59"/>
<polygon fill="black" stroke="black" points="1952.5,-437.5 1949,-427.5 1945.5,-437.5 1952.5,-437.5"/>
</g>
<!-- ffn_up_16 -->
<g id="node219" class="node">
<title>ffn_up_16</title>
<polygon fill="lightcoral" stroke="black" points="1882,-350.43 1784,-350.43 1784,-309.43 1882,-309.43 1882,-350.43"/>
<text text-anchor="middle" x="1833" y="-338.43" font-family="Arial" font-size="10.00">FFN Up</text>
<text text-anchor="middle" x="1833" y="-327.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1833" y="-316.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;ffn_up_16 -->
<g id="edge311" class="edge">
<title>ln1_16&#45;&gt;ffn_up_16</title>
<path fill="none" stroke="black" d="M1918.83,-386.42C1904.57,-377.2 1887.38,-366.09 1872.14,-356.23"/>
<polygon fill="black" stroke="black" points="1873.72,-353.09 1863.43,-350.6 1869.92,-358.97 1873.72,-353.09"/>
</g>
<!-- ffn_gate_16 -->
<g id="node220" class="node">
<title>ffn_gate_16</title>
<polygon fill="lightcoral" stroke="black" points="1998,-350.43 1900,-350.43 1900,-309.43 1998,-309.43 1998,-350.43"/>
<text text-anchor="middle" x="1949" y="-338.43" font-family="Arial" font-size="10.00">FFN Gate</text>
<text text-anchor="middle" x="1949" y="-327.43" font-family="Arial" font-size="10.00">[1024×512×32768]</text>
<text text-anchor="middle" x="1949" y="-316.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;ffn_gate_16 -->
<g id="edge312" class="edge">
<title>ln1_16&#45;&gt;ffn_gate_16</title>
<path fill="none" stroke="black" d="M1949,-386.22C1949,-378.38 1949,-369.2 1949,-360.59"/>
<polygon fill="black" stroke="black" points="1952.5,-360.5 1949,-350.5 1945.5,-360.5 1952.5,-360.5"/>
</g>
<!-- residual2_16 -->
<g id="node222" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="2033,-196.43 1941,-196.43 1941,-155.43 2033,-155.43 2033,-196.43"/>
<text text-anchor="middle" x="1987" y="-184.43" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1987" y="-173.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1987" y="-162.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;residual2_16 -->
<g id="edge316" class="edge">
<title>ln1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M1977.89,-386.37C1989.21,-376.98 2000.92,-364.65 2007,-350.43 2027.27,-302.97 2011.75,-241.93 1999.07,-206.34"/>
<polygon fill="black" stroke="black" points="2002.2,-204.73 1995.43,-196.58 1995.64,-207.17 2002.2,-204.73"/>
</g>
<!-- ffn_down_16 -->
<g id="node221" class="node">
<title>ffn_down_16</title>
<polygon fill="lightcoral" stroke="black" points="1995,-273.43 1903,-273.43 1903,-232.43 1995,-232.43 1995,-273.43"/>
<text text-anchor="middle" x="1949" y="-261.43" font-family="Arial" font-size="10.00">FFN Down</text>
<text text-anchor="middle" x="1949" y="-250.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1949" y="-239.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- ffn_up_16&#45;&gt;ffn_down_16 -->
<g id="edge313" class="edge">
<title>ffn_up_16&#45;&gt;ffn_down_16</title>
<path fill="none" stroke="black" d="M1863.17,-309.42C1877.43,-300.2 1894.62,-289.09 1909.86,-279.23"/>
<polygon fill="black" stroke="black" points="1912.08,-281.97 1918.57,-273.6 1908.28,-276.09 1912.08,-281.97"/>
</g>
<!-- ffn_gate_16&#45;&gt;ffn_down_16 -->
<g id="edge314" class="edge">
<title>ffn_gate_16&#45;&gt;ffn_down_16</title>
<path fill="none" stroke="black" d="M1949,-309.22C1949,-301.38 1949,-292.2 1949,-283.59"/>
<polygon fill="black" stroke="black" points="1952.5,-283.5 1949,-273.5 1945.5,-283.5 1952.5,-283.5"/>
</g>
<!-- ffn_down_16&#45;&gt;residual2_16 -->
<g id="edge315" class="edge">
<title>ffn_down_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M1958.98,-232.22C1963.13,-224.04 1968.02,-214.39 1972.55,-205.45"/>
<polygon fill="black" stroke="black" points="1975.69,-207 1977.08,-196.5 1969.44,-203.84 1975.69,-207"/>
</g>
<!-- ln2_16 -->
<g id="node223" class="node">
<title>ln2_16</title>
<polygon fill="lightpink" stroke="black" points="2033,-119.43 1941,-119.43 1941,-78.43 2033,-78.43 2033,-119.43"/>
<text text-anchor="middle" x="1987" y="-107.43" font-family="Arial" font-size="10.00">LayerNorm</text>
<text text-anchor="middle" x="1987" y="-96.43" font-family="Arial" font-size="10.00">[1024×512×8192]</text>
<text text-anchor="middle" x="1987" y="-85.43" font-family="Arial" font-size="10.00">GPU 15</text>
</g>
<!-- residual2_16&#45;&gt;ln2_16 -->
<g id="edge317" class="edge">
<title>residual2_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M1987,-155.22C1987,-147.38 1987,-138.2 1987,-129.59"/>
<polygon fill="black" stroke="black" points="1990.5,-129.5 1987,-119.5 1983.5,-129.5 1990.5,-129.5"/>
</g>
<!-- output -->
<g id="node224" class="node">
<title>output</title>
<ellipse fill="lightblue" stroke="black" cx="1987" cy="-21.21" rx="130.22" ry="21.43"/>
<text text-anchor="middle" x="1987" y="-24.21" font-family="Arial" font-size="10.00">Output</text>
<text text-anchor="middle" x="1987" y="-13.21" font-family="Arial" font-size="10.00">[Batch: 1024, Seq: 512, Hidden: 8192]</text>
</g>
<!-- ln2_16&#45;&gt;output -->
<g id="edge318" class="edge">
<title>ln2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M1987,-78.03C1987,-70.25 1987,-61.14 1987,-52.57"/>
<polygon fill="black" stroke="black" points="1990.5,-52.5 1987,-42.5 1983.5,-52.5 1990.5,-52.5"/>
</g>
</g>
</svg>
