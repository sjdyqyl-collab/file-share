<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="197pt"
 viewBox="0.00 0.00 1440.00 197.14" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.14 0.14) rotate(0) translate(4 1439.22)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1439.22 10538.11,-1439.22 10538.11,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-773.48 8,-988.48 7271,-988.48 7271,-773.48 8,-773.48"/>
<text text-anchor="middle" x="3639.5" y="-973.28" font-family="Times,serif" font-size="14.00">Pipeline Stage 1</text>
<text text-anchor="middle" x="3639.5" y="-958.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage2</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="1636,-82.74 1636,-297.74 8899,-297.74 8899,-82.74 1636,-82.74"/>
<text text-anchor="middle" x="5267.5" y="-282.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 2</text>
<text text-anchor="middle" x="5267.5" y="-267.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgray" stroke="black" cx="7016" cy="-1408.35" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="7016" y="-1412.15" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="7016" y="-1397.15" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- mha0 -->
<g id="node86" class="node">
<title>mha0</title>
<polygon fill="lightcyan" stroke="black" points="7129.5,-1344.48 6902.5,-1344.48 6902.5,-1291.48 7129.5,-1291.48 7129.5,-1344.48"/>
<text text-anchor="middle" x="7016" y="-1329.28" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention Layer 0</text>
<text text-anchor="middle" x="7016" y="-1314.28" font-family="Times,serif" font-size="14.00">[16 heads, 512 dim/head]</text>
<text text-anchor="middle" x="7016" y="-1299.28" font-family="Times,serif" font-size="14.00">TP=8</text>
</g>
<!-- input&#45;&gt;mha0 -->
<g id="edge65" class="edge">
<title>input&#45;&gt;mha0</title>
<path fill="none" stroke="black" d="M7016,-1381.31C7016,-1372.97 7016,-1363.58 7016,-1354.67"/>
<polygon fill="black" stroke="black" points="7019.5,-1354.53 7016,-1344.53 7012.5,-1354.53 7019.5,-1354.53"/>
</g>
<!-- gpu0_stage1 -->
<g id="node2" class="node">
<title>gpu0_stage1</title>
<polygon fill="lightblue" stroke="black" points="513,-942.48 411,-942.48 411,-904.48 513,-904.48 513,-942.48"/>
<text text-anchor="middle" x="462" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="462" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu0_stage1 -->
<g id="node3" class="node">
<title>expert0_gpu0_stage1</title>
<polygon fill="white" stroke="black" points="225.5,-834.48 16.5,-834.48 16.5,-781.48 225.5,-781.48 225.5,-834.48"/>
<text text-anchor="middle" x="121" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="121" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="121" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu0_stage1&#45;&gt;expert0_gpu0_stage1 -->
<g id="edge1" class="edge">
<title>gpu0_stage1&#45;&gt;expert0_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M410.95,-905.49C357.22,-887.61 271.7,-859.14 207.44,-837.75"/>
<polygon fill="black" stroke="black" points="208.31,-834.35 197.71,-834.51 206.1,-840.99 208.31,-834.35"/>
</g>
<!-- expert1_gpu0_stage1 -->
<g id="node4" class="node">
<title>expert1_gpu0_stage1</title>
<polygon fill="white" stroke="black" points="452.5,-834.48 243.5,-834.48 243.5,-781.48 452.5,-781.48 452.5,-834.48"/>
<text text-anchor="middle" x="348" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="348" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="348" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu0_stage1&#45;&gt;expert1_gpu0_stage1 -->
<g id="edge2" class="edge">
<title>gpu0_stage1&#45;&gt;expert1_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M443.68,-904.24C426.87,-887.5 401.54,-862.29 381.17,-842.01"/>
<polygon fill="black" stroke="black" points="383.47,-839.36 373.92,-834.78 378.53,-844.32 383.47,-839.36"/>
</g>
<!-- expert2_gpu0_stage1 -->
<g id="node5" class="node">
<title>expert2_gpu0_stage1</title>
<polygon fill="white" stroke="black" points="679.5,-834.48 470.5,-834.48 470.5,-781.48 679.5,-781.48 679.5,-834.48"/>
<text text-anchor="middle" x="575" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="575" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="575" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu0_stage1&#45;&gt;expert2_gpu0_stage1 -->
<g id="edge3" class="edge">
<title>gpu0_stage1&#45;&gt;expert2_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M480.16,-904.24C496.82,-887.5 521.92,-862.29 542.12,-842.01"/>
<polygon fill="black" stroke="black" points="544.73,-844.34 549.31,-834.78 539.77,-839.4 544.73,-844.34"/>
</g>
<!-- expert3_gpu0_stage1 -->
<g id="node6" class="node">
<title>expert3_gpu0_stage1</title>
<polygon fill="white" stroke="black" points="906.5,-834.48 697.5,-834.48 697.5,-781.48 906.5,-781.48 906.5,-834.48"/>
<text text-anchor="middle" x="802" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="802" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="802" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu0_stage1&#45;&gt;expert3_gpu0_stage1 -->
<g id="edge4" class="edge">
<title>gpu0_stage1&#45;&gt;expert3_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M513.27,-905.37C566.82,-887.49 651.78,-859.13 715.69,-837.79"/>
<polygon fill="black" stroke="black" points="716.99,-841.05 725.36,-834.56 714.77,-834.41 716.99,-841.05"/>
</g>
<!-- gpu1_stage1 -->
<g id="node7" class="node">
<title>gpu1_stage1</title>
<polygon fill="lightgreen" stroke="black" points="1421,-942.48 1319,-942.48 1319,-904.48 1421,-904.48 1421,-942.48"/>
<text text-anchor="middle" x="1370" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1370" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu1_stage1 -->
<g id="node8" class="node">
<title>expert0_gpu1_stage1</title>
<polygon fill="white" stroke="black" points="1133.5,-834.48 924.5,-834.48 924.5,-781.48 1133.5,-781.48 1133.5,-834.48"/>
<text text-anchor="middle" x="1029" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1029" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1029" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu1_stage1&#45;&gt;expert0_gpu1_stage1 -->
<g id="edge5" class="edge">
<title>gpu1_stage1&#45;&gt;expert0_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1318.95,-905.49C1265.22,-887.61 1179.7,-859.14 1115.44,-837.75"/>
<polygon fill="black" stroke="black" points="1116.31,-834.35 1105.71,-834.51 1114.1,-840.99 1116.31,-834.35"/>
</g>
<!-- expert1_gpu1_stage1 -->
<g id="node9" class="node">
<title>expert1_gpu1_stage1</title>
<polygon fill="white" stroke="black" points="1360.5,-834.48 1151.5,-834.48 1151.5,-781.48 1360.5,-781.48 1360.5,-834.48"/>
<text text-anchor="middle" x="1256" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1256" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1256" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu1_stage1&#45;&gt;expert1_gpu1_stage1 -->
<g id="edge6" class="edge">
<title>gpu1_stage1&#45;&gt;expert1_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1351.68,-904.24C1334.87,-887.5 1309.54,-862.29 1289.17,-842.01"/>
<polygon fill="black" stroke="black" points="1291.47,-839.36 1281.92,-834.78 1286.53,-844.32 1291.47,-839.36"/>
</g>
<!-- expert2_gpu1_stage1 -->
<g id="node10" class="node">
<title>expert2_gpu1_stage1</title>
<polygon fill="white" stroke="black" points="1587.5,-834.48 1378.5,-834.48 1378.5,-781.48 1587.5,-781.48 1587.5,-834.48"/>
<text text-anchor="middle" x="1483" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1483" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1483" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu1_stage1&#45;&gt;expert2_gpu1_stage1 -->
<g id="edge7" class="edge">
<title>gpu1_stage1&#45;&gt;expert2_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1388.16,-904.24C1404.82,-887.5 1429.92,-862.29 1450.12,-842.01"/>
<polygon fill="black" stroke="black" points="1452.73,-844.34 1457.31,-834.78 1447.77,-839.4 1452.73,-844.34"/>
</g>
<!-- expert3_gpu1_stage1 -->
<g id="node11" class="node">
<title>expert3_gpu1_stage1</title>
<polygon fill="white" stroke="black" points="1814.5,-834.48 1605.5,-834.48 1605.5,-781.48 1814.5,-781.48 1814.5,-834.48"/>
<text text-anchor="middle" x="1710" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1710" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1710" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu1_stage1&#45;&gt;expert3_gpu1_stage1 -->
<g id="edge8" class="edge">
<title>gpu1_stage1&#45;&gt;expert3_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1421.27,-905.37C1474.82,-887.49 1559.78,-859.13 1623.69,-837.79"/>
<polygon fill="black" stroke="black" points="1624.99,-841.05 1633.36,-834.56 1622.77,-834.41 1624.99,-841.05"/>
</g>
<!-- gpu2_stage1 -->
<g id="node12" class="node">
<title>gpu2_stage1</title>
<polygon fill="lightyellow" stroke="black" points="2329,-942.48 2227,-942.48 2227,-904.48 2329,-904.48 2329,-942.48"/>
<text text-anchor="middle" x="2278" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="2278" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu2_stage1 -->
<g id="node13" class="node">
<title>expert0_gpu2_stage1</title>
<polygon fill="white" stroke="black" points="2041.5,-834.48 1832.5,-834.48 1832.5,-781.48 2041.5,-781.48 2041.5,-834.48"/>
<text text-anchor="middle" x="1937" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1937" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1937" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu2_stage1&#45;&gt;expert0_gpu2_stage1 -->
<g id="edge9" class="edge">
<title>gpu2_stage1&#45;&gt;expert0_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2226.95,-905.49C2173.22,-887.61 2087.7,-859.14 2023.44,-837.75"/>
<polygon fill="black" stroke="black" points="2024.31,-834.35 2013.71,-834.51 2022.1,-840.99 2024.31,-834.35"/>
</g>
<!-- expert1_gpu2_stage1 -->
<g id="node14" class="node">
<title>expert1_gpu2_stage1</title>
<polygon fill="white" stroke="black" points="2268.5,-834.48 2059.5,-834.48 2059.5,-781.48 2268.5,-781.48 2268.5,-834.48"/>
<text text-anchor="middle" x="2164" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2164" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2164" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu2_stage1&#45;&gt;expert1_gpu2_stage1 -->
<g id="edge10" class="edge">
<title>gpu2_stage1&#45;&gt;expert1_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2259.68,-904.24C2242.87,-887.5 2217.54,-862.29 2197.17,-842.01"/>
<polygon fill="black" stroke="black" points="2199.47,-839.36 2189.92,-834.78 2194.53,-844.32 2199.47,-839.36"/>
</g>
<!-- expert2_gpu2_stage1 -->
<g id="node15" class="node">
<title>expert2_gpu2_stage1</title>
<polygon fill="white" stroke="black" points="2495.5,-834.48 2286.5,-834.48 2286.5,-781.48 2495.5,-781.48 2495.5,-834.48"/>
<text text-anchor="middle" x="2391" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2391" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2391" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu2_stage1&#45;&gt;expert2_gpu2_stage1 -->
<g id="edge11" class="edge">
<title>gpu2_stage1&#45;&gt;expert2_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2296.16,-904.24C2312.82,-887.5 2337.92,-862.29 2358.12,-842.01"/>
<polygon fill="black" stroke="black" points="2360.73,-844.34 2365.31,-834.78 2355.77,-839.4 2360.73,-844.34"/>
</g>
<!-- expert3_gpu2_stage1 -->
<g id="node16" class="node">
<title>expert3_gpu2_stage1</title>
<polygon fill="white" stroke="black" points="2722.5,-834.48 2513.5,-834.48 2513.5,-781.48 2722.5,-781.48 2722.5,-834.48"/>
<text text-anchor="middle" x="2618" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2618" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2618" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu2_stage1&#45;&gt;expert3_gpu2_stage1 -->
<g id="edge12" class="edge">
<title>gpu2_stage1&#45;&gt;expert3_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2329.27,-905.37C2382.82,-887.49 2467.78,-859.13 2531.69,-837.79"/>
<polygon fill="black" stroke="black" points="2532.99,-841.05 2541.36,-834.56 2530.77,-834.41 2532.99,-841.05"/>
</g>
<!-- gpu3_stage1 -->
<g id="node17" class="node">
<title>gpu3_stage1</title>
<polygon fill="lightpink" stroke="black" points="3237,-942.48 3135,-942.48 3135,-904.48 3237,-904.48 3237,-942.48"/>
<text text-anchor="middle" x="3186" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="3186" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu3_stage1 -->
<g id="node18" class="node">
<title>expert0_gpu3_stage1</title>
<polygon fill="white" stroke="black" points="2949.5,-834.48 2740.5,-834.48 2740.5,-781.48 2949.5,-781.48 2949.5,-834.48"/>
<text text-anchor="middle" x="2845" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2845" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2845" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu3_stage1&#45;&gt;expert0_gpu3_stage1 -->
<g id="edge13" class="edge">
<title>gpu3_stage1&#45;&gt;expert0_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3134.95,-905.49C3081.22,-887.61 2995.7,-859.14 2931.44,-837.75"/>
<polygon fill="black" stroke="black" points="2932.31,-834.35 2921.71,-834.51 2930.1,-840.99 2932.31,-834.35"/>
</g>
<!-- expert1_gpu3_stage1 -->
<g id="node19" class="node">
<title>expert1_gpu3_stage1</title>
<polygon fill="white" stroke="black" points="3176.5,-834.48 2967.5,-834.48 2967.5,-781.48 3176.5,-781.48 3176.5,-834.48"/>
<text text-anchor="middle" x="3072" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3072" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3072" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu3_stage1&#45;&gt;expert1_gpu3_stage1 -->
<g id="edge14" class="edge">
<title>gpu3_stage1&#45;&gt;expert1_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3167.68,-904.24C3150.87,-887.5 3125.54,-862.29 3105.17,-842.01"/>
<polygon fill="black" stroke="black" points="3107.47,-839.36 3097.92,-834.78 3102.53,-844.32 3107.47,-839.36"/>
</g>
<!-- expert2_gpu3_stage1 -->
<g id="node20" class="node">
<title>expert2_gpu3_stage1</title>
<polygon fill="white" stroke="black" points="3403.5,-834.48 3194.5,-834.48 3194.5,-781.48 3403.5,-781.48 3403.5,-834.48"/>
<text text-anchor="middle" x="3299" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3299" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3299" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu3_stage1&#45;&gt;expert2_gpu3_stage1 -->
<g id="edge15" class="edge">
<title>gpu3_stage1&#45;&gt;expert2_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3204.16,-904.24C3220.82,-887.5 3245.92,-862.29 3266.12,-842.01"/>
<polygon fill="black" stroke="black" points="3268.73,-844.34 3273.31,-834.78 3263.77,-839.4 3268.73,-844.34"/>
</g>
<!-- expert3_gpu3_stage1 -->
<g id="node21" class="node">
<title>expert3_gpu3_stage1</title>
<polygon fill="white" stroke="black" points="3630.5,-834.48 3421.5,-834.48 3421.5,-781.48 3630.5,-781.48 3630.5,-834.48"/>
<text text-anchor="middle" x="3526" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3526" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3526" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu3_stage1&#45;&gt;expert3_gpu3_stage1 -->
<g id="edge16" class="edge">
<title>gpu3_stage1&#45;&gt;expert3_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3237.27,-905.37C3290.82,-887.49 3375.78,-859.13 3439.69,-837.79"/>
<polygon fill="black" stroke="black" points="3440.99,-841.05 3449.36,-834.56 3438.77,-834.41 3440.99,-841.05"/>
</g>
<!-- gpu4_stage1 -->
<g id="node22" class="node">
<title>gpu4_stage1</title>
<polygon fill="lightblue" stroke="black" points="4171,-942.48 4069,-942.48 4069,-904.48 4171,-904.48 4171,-942.48"/>
<text text-anchor="middle" x="4120" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="4120" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu4_stage1 -->
<g id="node23" class="node">
<title>expert0_gpu4_stage1</title>
<polygon fill="white" stroke="black" points="3857.5,-834.48 3648.5,-834.48 3648.5,-781.48 3857.5,-781.48 3857.5,-834.48"/>
<text text-anchor="middle" x="3753" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3753" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3753" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu4_stage1&#45;&gt;expert0_gpu4_stage1 -->
<g id="edge17" class="edge">
<title>gpu4_stage1&#45;&gt;expert0_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4068.97,-906.7C4011.31,-888.87 3916.3,-859.48 3845.49,-837.59"/>
<polygon fill="black" stroke="black" points="3846.26,-834.16 3835.67,-834.55 3844.19,-840.85 3846.26,-834.16"/>
</g>
<!-- expert1_gpu4_stage1 -->
<g id="node24" class="node">
<title>expert1_gpu4_stage1</title>
<polygon fill="white" stroke="black" points="4084.5,-834.48 3875.5,-834.48 3875.5,-781.48 4084.5,-781.48 4084.5,-834.48"/>
<text text-anchor="middle" x="3980" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3980" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3980" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu4_stage1&#45;&gt;expert1_gpu4_stage1 -->
<g id="edge18" class="edge">
<title>gpu4_stage1&#45;&gt;expert1_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4097.51,-904.24C4076.51,-887.22 4044.73,-861.45 4019.5,-841.01"/>
<polygon fill="black" stroke="black" points="4021.54,-838.15 4011.57,-834.57 4017.13,-843.59 4021.54,-838.15"/>
</g>
<!-- expert2_gpu4_stage1 -->
<g id="node25" class="node">
<title>expert2_gpu4_stage1</title>
<polygon fill="white" stroke="black" points="4311.5,-834.48 4102.5,-834.48 4102.5,-781.48 4311.5,-781.48 4311.5,-834.48"/>
<text text-anchor="middle" x="4207" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4207" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4207" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu4_stage1&#45;&gt;expert2_gpu4_stage1 -->
<g id="edge19" class="edge">
<title>gpu4_stage1&#45;&gt;expert2_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4133.98,-904.24C4146.64,-887.72 4165.63,-862.95 4181.07,-842.81"/>
<polygon fill="black" stroke="black" points="4183.92,-844.85 4187.22,-834.78 4178.36,-840.59 4183.92,-844.85"/>
</g>
<!-- expert3_gpu4_stage1 -->
<g id="node26" class="node">
<title>expert3_gpu4_stage1</title>
<polygon fill="white" stroke="black" points="4538.5,-834.48 4329.5,-834.48 4329.5,-781.48 4538.5,-781.48 4538.5,-834.48"/>
<text text-anchor="middle" x="4434" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4434" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4434" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu4_stage1&#45;&gt;expert3_gpu4_stage1 -->
<g id="edge20" class="edge">
<title>gpu4_stage1&#45;&gt;expert3_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4170.1,-904.37C4219.55,-886.5 4295.95,-858.88 4353.84,-837.95"/>
<polygon fill="black" stroke="black" points="4355.12,-841.22 4363.33,-834.52 4352.74,-834.63 4355.12,-841.22"/>
</g>
<!-- gpu5_stage1 -->
<g id="node27" class="node">
<title>gpu5_stage1</title>
<polygon fill="lightgreen" stroke="black" points="5033,-942.48 4931,-942.48 4931,-904.48 5033,-904.48 5033,-942.48"/>
<text text-anchor="middle" x="4982" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="4982" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu5_stage1 -->
<g id="node28" class="node">
<title>expert0_gpu5_stage1</title>
<polygon fill="white" stroke="black" points="4765.5,-834.48 4556.5,-834.48 4556.5,-781.48 4765.5,-781.48 4765.5,-834.48"/>
<text text-anchor="middle" x="4661" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4661" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4661" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu5_stage1&#45;&gt;expert0_gpu5_stage1 -->
<g id="edge21" class="edge">
<title>gpu5_stage1&#45;&gt;expert0_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4930.78,-904.37C4880.23,-886.5 4802.13,-858.88 4742.95,-837.95"/>
<polygon fill="black" stroke="black" points="4743.84,-834.56 4733.25,-834.52 4741.51,-841.16 4743.84,-834.56"/>
</g>
<!-- expert1_gpu5_stage1 -->
<g id="node29" class="node">
<title>expert1_gpu5_stage1</title>
<polygon fill="white" stroke="black" points="4992.5,-834.48 4783.5,-834.48 4783.5,-781.48 4992.5,-781.48 4992.5,-834.48"/>
<text text-anchor="middle" x="4888" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4888" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4888" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu5_stage1&#45;&gt;expert1_gpu5_stage1 -->
<g id="edge22" class="edge">
<title>gpu5_stage1&#45;&gt;expert1_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4966.9,-904.24C4953.15,-887.65 4932.52,-862.73 4915.8,-842.54"/>
<polygon fill="black" stroke="black" points="4918.44,-840.25 4909.37,-834.78 4913.05,-844.72 4918.44,-840.25"/>
</g>
<!-- expert2_gpu5_stage1 -->
<g id="node30" class="node">
<title>expert2_gpu5_stage1</title>
<polygon fill="white" stroke="black" points="5219.5,-834.48 5010.5,-834.48 5010.5,-781.48 5219.5,-781.48 5219.5,-834.48"/>
<text text-anchor="middle" x="5115" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5115" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5115" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu5_stage1&#45;&gt;expert2_gpu5_stage1 -->
<g id="edge23" class="edge">
<title>gpu5_stage1&#45;&gt;expert2_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5003.37,-904.24C5023.16,-887.35 5053.05,-861.85 5076.92,-841.48"/>
<polygon fill="black" stroke="black" points="5079.43,-843.94 5084.76,-834.78 5074.88,-838.61 5079.43,-843.94"/>
</g>
<!-- expert3_gpu5_stage1 -->
<g id="node31" class="node">
<title>expert3_gpu5_stage1</title>
<polygon fill="white" stroke="black" points="5446.5,-834.48 5237.5,-834.48 5237.5,-781.48 5446.5,-781.48 5446.5,-834.48"/>
<text text-anchor="middle" x="5342" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5342" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5342" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu5_stage1&#45;&gt;expert3_gpu5_stage1 -->
<g id="edge24" class="edge">
<title>gpu5_stage1&#45;&gt;expert3_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5033.2,-906.34C5089.93,-888.45 5182.51,-859.26 5251.53,-837.5"/>
<polygon fill="black" stroke="black" points="5252.62,-840.83 5261.11,-834.48 5250.52,-834.15 5252.62,-840.83"/>
</g>
<!-- gpu6_stage1 -->
<g id="node32" class="node">
<title>gpu6_stage1</title>
<polygon fill="lightyellow" stroke="black" points="5266,-942.48 5164,-942.48 5164,-904.48 5266,-904.48 5266,-942.48"/>
<text text-anchor="middle" x="5215" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="5215" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu6_stage1 -->
<g id="node33" class="node">
<title>expert0_gpu6_stage1</title>
<polygon fill="white" stroke="black" points="6354.5,-834.48 6145.5,-834.48 6145.5,-781.48 6354.5,-781.48 6354.5,-834.48"/>
<text text-anchor="middle" x="6250" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6250" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6250" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu6_stage1&#45;&gt;expert0_gpu6_stage1 -->
<g id="edge25" class="edge">
<title>gpu6_stage1&#45;&gt;expert0_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5243.42,-904.33C5253.31,-898.18 5264.56,-891.37 5275,-885.48 5290.23,-876.88 5295.17,-876.76 5310,-867.48 5319.42,-861.59 5319.5,-856.11 5330,-852.48 5412.2,-824.06 6010.14,-844.11 6135.17,-834.34"/>
<polygon fill="black" stroke="black" points="6135.86,-837.79 6145.47,-833.34 6135.18,-830.83 6135.86,-837.79"/>
</g>
<!-- expert1_gpu6_stage1 -->
<g id="node34" class="node">
<title>expert1_gpu6_stage1</title>
<polygon fill="white" stroke="black" points="5673.5,-834.48 5464.5,-834.48 5464.5,-781.48 5673.5,-781.48 5673.5,-834.48"/>
<text text-anchor="middle" x="5569" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5569" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5569" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu6_stage1&#45;&gt;expert1_gpu6_stage1 -->
<g id="edge26" class="edge">
<title>gpu6_stage1&#45;&gt;expert1_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5223.52,-904.4C5232.38,-887.82 5247.91,-864.14 5269,-852.48 5303.26,-833.55 5401.41,-840.1 5454.45,-834.38"/>
<polygon fill="black" stroke="black" points="5454.97,-837.85 5464.43,-833.07 5454.06,-830.91 5454.97,-837.85"/>
</g>
<!-- expert2_gpu6_stage1 -->
<g id="node35" class="node">
<title>expert2_gpu6_stage1</title>
<polygon fill="white" stroke="black" points="5900.5,-834.48 5691.5,-834.48 5691.5,-781.48 5900.5,-781.48 5900.5,-834.48"/>
<text text-anchor="middle" x="5796" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5796" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5796" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu6_stage1&#45;&gt;expert2_gpu6_stage1 -->
<g id="edge27" class="edge">
<title>gpu6_stage1&#45;&gt;expert2_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5230.21,-904.34C5245.6,-887.47 5271.04,-863.35 5299,-852.48 5375.9,-822.58 5583.49,-844.32 5681.48,-834.42"/>
<polygon fill="black" stroke="black" points="5681.93,-837.89 5691.46,-833.25 5681.12,-830.94 5681.93,-837.89"/>
</g>
<!-- expert3_gpu6_stage1 -->
<g id="node36" class="node">
<title>expert3_gpu6_stage1</title>
<polygon fill="white" stroke="black" points="6127.5,-834.48 5918.5,-834.48 5918.5,-781.48 6127.5,-781.48 6127.5,-834.48"/>
<text text-anchor="middle" x="6023" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6023" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6023" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu6_stage1&#45;&gt;expert3_gpu6_stage1 -->
<g id="edge28" class="edge">
<title>gpu6_stage1&#45;&gt;expert3_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5239.83,-904.35C5267.18,-884.55 5308.43,-855.28 5317,-852.48 5377.27,-832.78 5809.77,-842 5908.37,-834.31"/>
<polygon fill="black" stroke="black" points="5908.86,-837.78 5918.47,-833.31 5908.17,-830.81 5908.86,-837.78"/>
</g>
<!-- gpu7_stage1 -->
<g id="node37" class="node">
<title>gpu7_stage1</title>
<polygon fill="lightpink" stroke="black" points="5386,-942.48 5284,-942.48 5284,-904.48 5386,-904.48 5386,-942.48"/>
<text text-anchor="middle" x="5335" y="-927.28" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="5335" y="-912.28" font-family="Times,serif" font-size="14.00">(Layers 0&#45;1)</text>
</g>
<!-- expert0_gpu7_stage1 -->
<g id="node38" class="node">
<title>expert0_gpu7_stage1</title>
<polygon fill="white" stroke="black" points="6581.5,-834.48 6372.5,-834.48 6372.5,-781.48 6581.5,-781.48 6581.5,-834.48"/>
<text text-anchor="middle" x="6477" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6477" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6477" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu7_stage1&#45;&gt;expert0_gpu7_stage1 -->
<g id="edge29" class="edge">
<title>gpu7_stage1&#45;&gt;expert0_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5330.61,-904.42C5327.9,-888.33 5327.19,-865.39 5341,-852.48 5360.85,-833.93 6252.02,-837.5 6362.36,-833.9"/>
<polygon fill="black" stroke="black" points="6362.67,-837.39 6372.47,-833.36 6362.3,-830.4 6362.67,-837.39"/>
</g>
<!-- expert1_gpu7_stage1 -->
<g id="node39" class="node">
<title>expert1_gpu7_stage1</title>
<polygon fill="white" stroke="black" points="6808.5,-834.48 6599.5,-834.48 6599.5,-781.48 6808.5,-781.48 6808.5,-834.48"/>
<text text-anchor="middle" x="6704" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6704" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6704" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu7_stage1&#45;&gt;expert1_gpu7_stage1 -->
<g id="edge30" class="edge">
<title>gpu7_stage1&#45;&gt;expert1_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5336.64,-904.35C5338.72,-885.83 5343.05,-858.91 5351,-852.48 5376.73,-831.66 6466.44,-837.98 6589.41,-833.92"/>
<polygon fill="black" stroke="black" points="6589.68,-837.41 6599.47,-833.37 6589.3,-830.42 6589.68,-837.41"/>
</g>
<!-- expert2_gpu7_stage1 -->
<g id="node40" class="node">
<title>expert2_gpu7_stage1</title>
<polygon fill="white" stroke="black" points="7035.5,-834.48 6826.5,-834.48 6826.5,-781.48 7035.5,-781.48 7035.5,-834.48"/>
<text text-anchor="middle" x="6931" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6931" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6931" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu7_stage1&#45;&gt;expert2_gpu7_stage1 -->
<g id="edge31" class="edge">
<title>gpu7_stage1&#45;&gt;expert2_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5339.03,-904.24C5343.55,-885.63 5351.39,-858.63 5360,-852.48 5391.77,-829.79 6679.47,-838.52 6816.09,-833.95"/>
<polygon fill="black" stroke="black" points="6816.68,-837.42 6826.47,-833.38 6816.3,-830.43 6816.68,-837.42"/>
</g>
<!-- expert3_gpu7_stage1 -->
<g id="node41" class="node">
<title>expert3_gpu7_stage1</title>
<polygon fill="white" stroke="black" points="7262.5,-834.48 7053.5,-834.48 7053.5,-781.48 7262.5,-781.48 7262.5,-834.48"/>
<text text-anchor="middle" x="7158" y="-819.28" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7158" y="-804.28" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="7158" y="-789.28" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu7_stage1&#45;&gt;expert3_gpu7_stage1 -->
<g id="edge32" class="edge">
<title>gpu7_stage1&#45;&gt;expert3_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5343.62,-904.3C5352.74,-887.39 5368.9,-863.25 5391,-852.48 5430.93,-833.02 6896.98,-839.35 7043.19,-833.98"/>
<polygon fill="black" stroke="black" points="7043.69,-837.46 7053.47,-833.38 7043.29,-830.47 7043.69,-837.46"/>
</g>
<!-- gpu8_stage2 -->
<g id="node42" class="node">
<title>gpu8_stage2</title>
<polygon fill="lightblue" stroke="black" points="2167,-251.74 2065,-251.74 2065,-213.74 2167,-213.74 2167,-251.74"/>
<text text-anchor="middle" x="2116" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2116" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu8_stage2 -->
<g id="node43" class="node">
<title>expert0_gpu8_stage2</title>
<polygon fill="white" stroke="black" points="1853.5,-143.74 1644.5,-143.74 1644.5,-90.74 1853.5,-90.74 1853.5,-143.74"/>
<text text-anchor="middle" x="1749" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1749" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1749" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu8_stage2&#45;&gt;expert0_gpu8_stage2 -->
<g id="edge33" class="edge">
<title>gpu8_stage2&#45;&gt;expert0_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2064.97,-215.96C2007.31,-198.13 1912.3,-168.74 1841.49,-146.85"/>
<polygon fill="black" stroke="black" points="1842.26,-143.42 1831.67,-143.81 1840.19,-150.11 1842.26,-143.42"/>
</g>
<!-- expert1_gpu8_stage2 -->
<g id="node44" class="node">
<title>expert1_gpu8_stage2</title>
<polygon fill="white" stroke="black" points="2080.5,-143.74 1871.5,-143.74 1871.5,-90.74 2080.5,-90.74 2080.5,-143.74"/>
<text text-anchor="middle" x="1976" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1976" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="1976" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu8_stage2&#45;&gt;expert1_gpu8_stage2 -->
<g id="edge34" class="edge">
<title>gpu8_stage2&#45;&gt;expert1_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2093.51,-213.5C2072.51,-196.48 2040.73,-170.71 2015.5,-150.27"/>
<polygon fill="black" stroke="black" points="2017.54,-147.41 2007.57,-143.83 2013.13,-152.85 2017.54,-147.41"/>
</g>
<!-- expert2_gpu8_stage2 -->
<g id="node45" class="node">
<title>expert2_gpu8_stage2</title>
<polygon fill="white" stroke="black" points="2307.5,-143.74 2098.5,-143.74 2098.5,-90.74 2307.5,-90.74 2307.5,-143.74"/>
<text text-anchor="middle" x="2203" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2203" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2203" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu8_stage2&#45;&gt;expert2_gpu8_stage2 -->
<g id="edge35" class="edge">
<title>gpu8_stage2&#45;&gt;expert2_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2129.98,-213.5C2142.64,-196.98 2161.63,-172.21 2177.07,-152.07"/>
<polygon fill="black" stroke="black" points="2179.92,-154.11 2183.22,-144.04 2174.36,-149.85 2179.92,-154.11"/>
</g>
<!-- expert3_gpu8_stage2 -->
<g id="node46" class="node">
<title>expert3_gpu8_stage2</title>
<polygon fill="white" stroke="black" points="2534.5,-143.74 2325.5,-143.74 2325.5,-90.74 2534.5,-90.74 2534.5,-143.74"/>
<text text-anchor="middle" x="2430" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2430" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2430" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu8_stage2&#45;&gt;expert3_gpu8_stage2 -->
<g id="edge36" class="edge">
<title>gpu8_stage2&#45;&gt;expert3_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2166.1,-213.63C2215.55,-195.76 2291.95,-168.14 2349.84,-147.21"/>
<polygon fill="black" stroke="black" points="2351.12,-150.48 2359.33,-143.78 2348.74,-143.89 2351.12,-150.48"/>
</g>
<!-- gpu9_stage2 -->
<g id="node47" class="node">
<title>gpu9_stage2</title>
<polygon fill="lightgreen" stroke="black" points="3049,-251.74 2947,-251.74 2947,-213.74 3049,-213.74 3049,-251.74"/>
<text text-anchor="middle" x="2998" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="2998" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu9_stage2 -->
<g id="node48" class="node">
<title>expert0_gpu9_stage2</title>
<polygon fill="white" stroke="black" points="2761.5,-143.74 2552.5,-143.74 2552.5,-90.74 2761.5,-90.74 2761.5,-143.74"/>
<text text-anchor="middle" x="2657" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="2657" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2657" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu9_stage2&#45;&gt;expert0_gpu9_stage2 -->
<g id="edge37" class="edge">
<title>gpu9_stage2&#45;&gt;expert0_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2946.95,-214.75C2893.22,-196.87 2807.7,-168.4 2743.44,-147.01"/>
<polygon fill="black" stroke="black" points="2744.31,-143.61 2733.71,-143.77 2742.1,-150.25 2744.31,-143.61"/>
</g>
<!-- expert1_gpu9_stage2 -->
<g id="node49" class="node">
<title>expert1_gpu9_stage2</title>
<polygon fill="white" stroke="black" points="2988.5,-143.74 2779.5,-143.74 2779.5,-90.74 2988.5,-90.74 2988.5,-143.74"/>
<text text-anchor="middle" x="2884" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2884" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="2884" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu9_stage2&#45;&gt;expert1_gpu9_stage2 -->
<g id="edge38" class="edge">
<title>gpu9_stage2&#45;&gt;expert1_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2979.68,-213.5C2962.87,-196.76 2937.54,-171.55 2917.17,-151.27"/>
<polygon fill="black" stroke="black" points="2919.47,-148.62 2909.92,-144.04 2914.53,-153.58 2919.47,-148.62"/>
</g>
<!-- expert2_gpu9_stage2 -->
<g id="node50" class="node">
<title>expert2_gpu9_stage2</title>
<polygon fill="white" stroke="black" points="3215.5,-143.74 3006.5,-143.74 3006.5,-90.74 3215.5,-90.74 3215.5,-143.74"/>
<text text-anchor="middle" x="3111" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3111" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3111" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu9_stage2&#45;&gt;expert2_gpu9_stage2 -->
<g id="edge39" class="edge">
<title>gpu9_stage2&#45;&gt;expert2_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3016.16,-213.5C3032.82,-196.76 3057.92,-171.55 3078.12,-151.27"/>
<polygon fill="black" stroke="black" points="3080.73,-153.6 3085.31,-144.04 3075.77,-148.66 3080.73,-153.6"/>
</g>
<!-- expert3_gpu9_stage2 -->
<g id="node51" class="node">
<title>expert3_gpu9_stage2</title>
<polygon fill="white" stroke="black" points="3442.5,-143.74 3233.5,-143.74 3233.5,-90.74 3442.5,-90.74 3442.5,-143.74"/>
<text text-anchor="middle" x="3338" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3338" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3338" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu9_stage2&#45;&gt;expert3_gpu9_stage2 -->
<g id="edge40" class="edge">
<title>gpu9_stage2&#45;&gt;expert3_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3049.27,-214.63C3102.82,-196.75 3187.78,-168.39 3251.69,-147.05"/>
<polygon fill="black" stroke="black" points="3252.99,-150.31 3261.36,-143.82 3250.77,-143.67 3252.99,-150.31"/>
</g>
<!-- gpu10_stage2 -->
<g id="node52" class="node">
<title>gpu10_stage2</title>
<polygon fill="lightyellow" stroke="black" points="3957,-251.74 3855,-251.74 3855,-213.74 3957,-213.74 3957,-251.74"/>
<text text-anchor="middle" x="3906" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="3906" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu10_stage2 -->
<g id="node53" class="node">
<title>expert0_gpu10_stage2</title>
<polygon fill="white" stroke="black" points="3669.5,-143.74 3460.5,-143.74 3460.5,-90.74 3669.5,-90.74 3669.5,-143.74"/>
<text text-anchor="middle" x="3565" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3565" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3565" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu10_stage2&#45;&gt;expert0_gpu10_stage2 -->
<g id="edge41" class="edge">
<title>gpu10_stage2&#45;&gt;expert0_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3854.95,-214.75C3801.22,-196.87 3715.7,-168.4 3651.44,-147.01"/>
<polygon fill="black" stroke="black" points="3652.31,-143.61 3641.71,-143.77 3650.1,-150.25 3652.31,-143.61"/>
</g>
<!-- expert1_gpu10_stage2 -->
<g id="node54" class="node">
<title>expert1_gpu10_stage2</title>
<polygon fill="white" stroke="black" points="3896.5,-143.74 3687.5,-143.74 3687.5,-90.74 3896.5,-90.74 3896.5,-143.74"/>
<text text-anchor="middle" x="3792" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3792" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="3792" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu10_stage2&#45;&gt;expert1_gpu10_stage2 -->
<g id="edge42" class="edge">
<title>gpu10_stage2&#45;&gt;expert1_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3887.68,-213.5C3870.87,-196.76 3845.54,-171.55 3825.17,-151.27"/>
<polygon fill="black" stroke="black" points="3827.47,-148.62 3817.92,-144.04 3822.53,-153.58 3827.47,-148.62"/>
</g>
<!-- expert2_gpu10_stage2 -->
<g id="node55" class="node">
<title>expert2_gpu10_stage2</title>
<polygon fill="white" stroke="black" points="4123.5,-143.74 3914.5,-143.74 3914.5,-90.74 4123.5,-90.74 4123.5,-143.74"/>
<text text-anchor="middle" x="4019" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4019" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4019" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu10_stage2&#45;&gt;expert2_gpu10_stage2 -->
<g id="edge43" class="edge">
<title>gpu10_stage2&#45;&gt;expert2_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3924.16,-213.5C3940.82,-196.76 3965.92,-171.55 3986.12,-151.27"/>
<polygon fill="black" stroke="black" points="3988.73,-153.6 3993.31,-144.04 3983.77,-148.66 3988.73,-153.6"/>
</g>
<!-- expert3_gpu10_stage2 -->
<g id="node56" class="node">
<title>expert3_gpu10_stage2</title>
<polygon fill="white" stroke="black" points="4350.5,-143.74 4141.5,-143.74 4141.5,-90.74 4350.5,-90.74 4350.5,-143.74"/>
<text text-anchor="middle" x="4246" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4246" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4246" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu10_stage2&#45;&gt;expert3_gpu10_stage2 -->
<g id="edge44" class="edge">
<title>gpu10_stage2&#45;&gt;expert3_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3957.27,-214.63C4010.82,-196.75 4095.78,-168.39 4159.69,-147.05"/>
<polygon fill="black" stroke="black" points="4160.99,-150.31 4169.36,-143.82 4158.77,-143.67 4160.99,-150.31"/>
</g>
<!-- gpu11_stage2 -->
<g id="node57" class="node">
<title>gpu11_stage2</title>
<polygon fill="lightpink" stroke="black" points="4865,-251.74 4763,-251.74 4763,-213.74 4865,-213.74 4865,-251.74"/>
<text text-anchor="middle" x="4814" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="4814" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu11_stage2 -->
<g id="node58" class="node">
<title>expert0_gpu11_stage2</title>
<polygon fill="white" stroke="black" points="4577.5,-143.74 4368.5,-143.74 4368.5,-90.74 4577.5,-90.74 4577.5,-143.74"/>
<text text-anchor="middle" x="4473" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4473" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4473" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu11_stage2&#45;&gt;expert0_gpu11_stage2 -->
<g id="edge45" class="edge">
<title>gpu11_stage2&#45;&gt;expert0_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4762.95,-214.75C4709.22,-196.87 4623.7,-168.4 4559.44,-147.01"/>
<polygon fill="black" stroke="black" points="4560.31,-143.61 4549.71,-143.77 4558.1,-150.25 4560.31,-143.61"/>
</g>
<!-- expert1_gpu11_stage2 -->
<g id="node59" class="node">
<title>expert1_gpu11_stage2</title>
<polygon fill="white" stroke="black" points="4804.5,-143.74 4595.5,-143.74 4595.5,-90.74 4804.5,-90.74 4804.5,-143.74"/>
<text text-anchor="middle" x="4700" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4700" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4700" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu11_stage2&#45;&gt;expert1_gpu11_stage2 -->
<g id="edge46" class="edge">
<title>gpu11_stage2&#45;&gt;expert1_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4795.68,-213.5C4778.87,-196.76 4753.54,-171.55 4733.17,-151.27"/>
<polygon fill="black" stroke="black" points="4735.47,-148.62 4725.92,-144.04 4730.53,-153.58 4735.47,-148.62"/>
</g>
<!-- expert2_gpu11_stage2 -->
<g id="node60" class="node">
<title>expert2_gpu11_stage2</title>
<polygon fill="white" stroke="black" points="5031.5,-143.74 4822.5,-143.74 4822.5,-90.74 5031.5,-90.74 5031.5,-143.74"/>
<text text-anchor="middle" x="4927" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4927" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="4927" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu11_stage2&#45;&gt;expert2_gpu11_stage2 -->
<g id="edge47" class="edge">
<title>gpu11_stage2&#45;&gt;expert2_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4832.16,-213.5C4848.82,-196.76 4873.92,-171.55 4894.12,-151.27"/>
<polygon fill="black" stroke="black" points="4896.73,-153.6 4901.31,-144.04 4891.77,-148.66 4896.73,-153.6"/>
</g>
<!-- expert3_gpu11_stage2 -->
<g id="node61" class="node">
<title>expert3_gpu11_stage2</title>
<polygon fill="white" stroke="black" points="5258.5,-143.74 5049.5,-143.74 5049.5,-90.74 5258.5,-90.74 5258.5,-143.74"/>
<text text-anchor="middle" x="5154" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="5154" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5154" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu11_stage2&#45;&gt;expert3_gpu11_stage2 -->
<g id="edge48" class="edge">
<title>gpu11_stage2&#45;&gt;expert3_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4865.27,-214.63C4918.82,-196.75 5003.78,-168.39 5067.69,-147.05"/>
<polygon fill="black" stroke="black" points="5068.99,-150.31 5077.36,-143.82 5066.77,-143.67 5068.99,-150.31"/>
</g>
<!-- gpu12_stage2 -->
<g id="node62" class="node">
<title>gpu12_stage2</title>
<polygon fill="lightblue" stroke="black" points="5773,-251.74 5671,-251.74 5671,-213.74 5773,-213.74 5773,-251.74"/>
<text text-anchor="middle" x="5722" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="5722" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu12_stage2 -->
<g id="node63" class="node">
<title>expert0_gpu12_stage2</title>
<polygon fill="white" stroke="black" points="5485.5,-143.74 5276.5,-143.74 5276.5,-90.74 5485.5,-90.74 5485.5,-143.74"/>
<text text-anchor="middle" x="5381" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5381" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5381" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu12_stage2&#45;&gt;expert0_gpu12_stage2 -->
<g id="edge49" class="edge">
<title>gpu12_stage2&#45;&gt;expert0_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5670.95,-214.75C5617.22,-196.87 5531.7,-168.4 5467.44,-147.01"/>
<polygon fill="black" stroke="black" points="5468.31,-143.61 5457.71,-143.77 5466.1,-150.25 5468.31,-143.61"/>
</g>
<!-- expert1_gpu12_stage2 -->
<g id="node64" class="node">
<title>expert1_gpu12_stage2</title>
<polygon fill="white" stroke="black" points="5712.5,-143.74 5503.5,-143.74 5503.5,-90.74 5712.5,-90.74 5712.5,-143.74"/>
<text text-anchor="middle" x="5608" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5608" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5608" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu12_stage2&#45;&gt;expert1_gpu12_stage2 -->
<g id="edge50" class="edge">
<title>gpu12_stage2&#45;&gt;expert1_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5703.68,-213.5C5686.87,-196.76 5661.54,-171.55 5641.17,-151.27"/>
<polygon fill="black" stroke="black" points="5643.47,-148.62 5633.92,-144.04 5638.53,-153.58 5643.47,-148.62"/>
</g>
<!-- expert2_gpu12_stage2 -->
<g id="node65" class="node">
<title>expert2_gpu12_stage2</title>
<polygon fill="white" stroke="black" points="5939.5,-143.74 5730.5,-143.74 5730.5,-90.74 5939.5,-90.74 5939.5,-143.74"/>
<text text-anchor="middle" x="5835" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5835" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="5835" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu12_stage2&#45;&gt;expert2_gpu12_stage2 -->
<g id="edge51" class="edge">
<title>gpu12_stage2&#45;&gt;expert2_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5740.16,-213.5C5756.82,-196.76 5781.92,-171.55 5802.12,-151.27"/>
<polygon fill="black" stroke="black" points="5804.73,-153.6 5809.31,-144.04 5799.77,-148.66 5804.73,-153.6"/>
</g>
<!-- expert3_gpu12_stage2 -->
<g id="node66" class="node">
<title>expert3_gpu12_stage2</title>
<polygon fill="white" stroke="black" points="6166.5,-143.74 5957.5,-143.74 5957.5,-90.74 6166.5,-90.74 6166.5,-143.74"/>
<text text-anchor="middle" x="6062" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6062" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6062" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu12_stage2&#45;&gt;expert3_gpu12_stage2 -->
<g id="edge52" class="edge">
<title>gpu12_stage2&#45;&gt;expert3_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5773.27,-214.63C5826.82,-196.75 5911.78,-168.39 5975.69,-147.05"/>
<polygon fill="black" stroke="black" points="5976.99,-150.31 5985.36,-143.82 5974.77,-143.67 5976.99,-150.31"/>
</g>
<!-- gpu13_stage2 -->
<g id="node67" class="node">
<title>gpu13_stage2</title>
<polygon fill="lightgreen" stroke="black" points="6673,-251.74 6571,-251.74 6571,-213.74 6673,-213.74 6673,-251.74"/>
<text text-anchor="middle" x="6622" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6622" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu13_stage2 -->
<g id="node68" class="node">
<title>expert0_gpu13_stage2</title>
<polygon fill="white" stroke="black" points="6393.5,-143.74 6184.5,-143.74 6184.5,-90.74 6393.5,-90.74 6393.5,-143.74"/>
<text text-anchor="middle" x="6289" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6289" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6289" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu13_stage2&#45;&gt;expert0_gpu13_stage2 -->
<g id="edge53" class="edge">
<title>gpu13_stage2&#45;&gt;expert0_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6570.7,-214.25C6518.23,-196.37 6435.81,-168.28 6373.66,-147.09"/>
<polygon fill="black" stroke="black" points="6374.46,-143.67 6363.86,-143.76 6372.2,-150.3 6374.46,-143.67"/>
</g>
<!-- expert1_gpu13_stage2 -->
<g id="node69" class="node">
<title>expert1_gpu13_stage2</title>
<polygon fill="white" stroke="black" points="6620.5,-143.74 6411.5,-143.74 6411.5,-90.74 6620.5,-90.74 6620.5,-143.74"/>
<text text-anchor="middle" x="6516" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6516" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6516" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu13_stage2&#45;&gt;expert1_gpu13_stage2 -->
<g id="edge54" class="edge">
<title>gpu13_stage2&#45;&gt;expert1_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6604.97,-213.5C6589.4,-196.83 6565.99,-171.77 6547.1,-151.54"/>
<polygon fill="black" stroke="black" points="6549.48,-148.96 6540.1,-144.04 6544.37,-153.74 6549.48,-148.96"/>
</g>
<!-- expert2_gpu13_stage2 -->
<g id="node70" class="node">
<title>expert2_gpu13_stage2</title>
<polygon fill="white" stroke="black" points="6847.5,-143.74 6638.5,-143.74 6638.5,-90.74 6847.5,-90.74 6847.5,-143.74"/>
<text text-anchor="middle" x="6743" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6743" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6743" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu13_stage2&#45;&gt;expert2_gpu13_stage2 -->
<g id="edge55" class="edge">
<title>gpu13_stage2&#45;&gt;expert2_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6641.44,-213.5C6659.37,-196.69 6686.4,-171.33 6708.07,-151"/>
<polygon fill="black" stroke="black" points="6710.59,-153.44 6715.49,-144.04 6705.8,-148.33 6710.59,-153.44"/>
</g>
<!-- expert3_gpu13_stage2 -->
<g id="node71" class="node">
<title>expert3_gpu13_stage2</title>
<polygon fill="white" stroke="black" points="7074.5,-143.74 6865.5,-143.74 6865.5,-90.74 7074.5,-90.74 7074.5,-143.74"/>
<text text-anchor="middle" x="6970" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6970" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="6970" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu13_stage2&#45;&gt;expert3_gpu13_stage2 -->
<g id="edge56" class="edge">
<title>gpu13_stage2&#45;&gt;expert3_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6673.35,-214.99C6728.22,-197.1 6816.2,-168.4 6882.13,-146.9"/>
<polygon fill="black" stroke="black" points="6883.27,-150.21 6891.69,-143.78 6881.1,-143.55 6883.27,-150.21"/>
</g>
<!-- gpu14_stage2 -->
<g id="node72" class="node">
<title>gpu14_stage2</title>
<polygon fill="lightyellow" stroke="black" points="6901,-251.74 6799,-251.74 6799,-213.74 6901,-213.74 6901,-251.74"/>
<text text-anchor="middle" x="6850" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="6850" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu14_stage2 -->
<g id="node73" class="node">
<title>expert0_gpu14_stage2</title>
<polygon fill="white" stroke="black" points="7982.5,-143.74 7773.5,-143.74 7773.5,-90.74 7982.5,-90.74 7982.5,-143.74"/>
<text text-anchor="middle" x="7878" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7878" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="7878" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu14_stage2&#45;&gt;expert0_gpu14_stage2 -->
<g id="edge57" class="edge">
<title>gpu14_stage2&#45;&gt;expert0_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6878.42,-213.59C6888.31,-207.44 6899.56,-200.63 6910,-194.74 6925.23,-186.14 6930.07,-185.85 6945,-176.74 6954.79,-170.77 6955.12,-165.36 6966,-161.74 7047.7,-134.54 7639.42,-153.35 7763.27,-143.6"/>
<polygon fill="black" stroke="black" points="7763.86,-147.06 7773.47,-142.6 7763.18,-140.09 7763.86,-147.06"/>
</g>
<!-- expert1_gpu14_stage2 -->
<g id="node74" class="node">
<title>expert1_gpu14_stage2</title>
<polygon fill="white" stroke="black" points="7301.5,-143.74 7092.5,-143.74 7092.5,-90.74 7301.5,-90.74 7301.5,-143.74"/>
<text text-anchor="middle" x="7197" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7197" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="7197" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu14_stage2&#45;&gt;expert1_gpu14_stage2 -->
<g id="edge58" class="edge">
<title>gpu14_stage2&#45;&gt;expert1_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6858.53,-213.68C6867.39,-197.11 6882.93,-173.43 6904,-161.74 6936.88,-143.49 7031.05,-149.27 7082.45,-143.65"/>
<polygon fill="black" stroke="black" points="7082.98,-147.11 7092.43,-142.31 7082.05,-140.17 7082.98,-147.11"/>
</g>
<!-- expert2_gpu14_stage2 -->
<g id="node75" class="node">
<title>expert2_gpu14_stage2</title>
<polygon fill="white" stroke="black" points="7528.5,-143.74 7319.5,-143.74 7319.5,-90.74 7528.5,-90.74 7528.5,-143.74"/>
<text text-anchor="middle" x="7424" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7424" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="7424" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu14_stage2&#45;&gt;expert2_gpu14_stage2 -->
<g id="edge59" class="edge">
<title>gpu14_stage2&#45;&gt;expert2_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6865.22,-213.6C6880.6,-196.73 6906.05,-172.62 6934,-161.74 7009.41,-132.38 7212.89,-153.41 7309.35,-143.69"/>
<polygon fill="black" stroke="black" points="7309.93,-147.15 7319.46,-142.51 7309.12,-140.2 7309.93,-147.15"/>
</g>
<!-- expert3_gpu14_stage2 -->
<g id="node76" class="node">
<title>expert3_gpu14_stage2</title>
<polygon fill="white" stroke="black" points="7755.5,-143.74 7546.5,-143.74 7546.5,-90.74 7755.5,-90.74 7755.5,-143.74"/>
<text text-anchor="middle" x="7651" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7651" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="7651" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu14_stage2&#45;&gt;expert3_gpu14_stage2 -->
<g id="edge60" class="edge">
<title>gpu14_stage2&#45;&gt;expert3_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6874.83,-213.61C6902.18,-193.81 6943.43,-164.54 6952,-161.74 7011.56,-142.26 7438.96,-151.2 7536.48,-143.56"/>
<polygon fill="black" stroke="black" points="7536.86,-147.04 7546.46,-142.57 7536.17,-140.07 7536.86,-147.04"/>
</g>
<!-- gpu15_stage2 -->
<g id="node77" class="node">
<title>gpu15_stage2</title>
<polygon fill="lightpink" stroke="black" points="7021,-251.74 6919,-251.74 6919,-213.74 7021,-213.74 7021,-251.74"/>
<text text-anchor="middle" x="6970" y="-236.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="6970" y="-221.54" font-family="Times,serif" font-size="14.00">(Layers 2&#45;3)</text>
</g>
<!-- expert0_gpu15_stage2 -->
<g id="node78" class="node">
<title>expert0_gpu15_stage2</title>
<polygon fill="white" stroke="black" points="8209.5,-143.74 8000.5,-143.74 8000.5,-90.74 8209.5,-90.74 8209.5,-143.74"/>
<text text-anchor="middle" x="8105" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8105" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="8105" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu15_stage2&#45;&gt;expert0_gpu15_stage2 -->
<g id="edge61" class="edge">
<title>gpu15_stage2&#45;&gt;expert0_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6967.07,-213.5C6965.62,-197.28 6966.62,-174.26 6981,-161.74 7001.25,-144.11 7881.39,-146.81 7990.47,-143.16"/>
<polygon fill="black" stroke="black" points="7990.68,-146.66 8000.47,-142.62 7990.3,-139.67 7990.68,-146.66"/>
</g>
<!-- expert1_gpu15_stage2 -->
<g id="node79" class="node">
<title>expert1_gpu15_stage2</title>
<polygon fill="white" stroke="black" points="8436.5,-143.74 8227.5,-143.74 8227.5,-90.74 8436.5,-90.74 8436.5,-143.74"/>
<text text-anchor="middle" x="8332" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8332" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="8332" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu15_stage2&#45;&gt;expert1_gpu15_stage2 -->
<g id="edge62" class="edge">
<title>gpu15_stage2&#45;&gt;expert1_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6973.24,-213.53C6976.95,-194.95 6983.62,-167.98 6992,-161.74 7018.24,-142.19 8093.62,-147.29 8217.13,-143.19"/>
<polygon fill="black" stroke="black" points="8217.68,-146.67 8227.47,-142.63 8217.3,-139.68 8217.68,-146.67"/>
</g>
<!-- expert2_gpu15_stage2 -->
<g id="node80" class="node">
<title>expert2_gpu15_stage2</title>
<polygon fill="white" stroke="black" points="8663.5,-143.74 8454.5,-143.74 8454.5,-90.74 8663.5,-90.74 8663.5,-143.74"/>
<text text-anchor="middle" x="8559" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8559" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="8559" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu15_stage2&#45;&gt;expert2_gpu15_stage2 -->
<g id="edge63" class="edge">
<title>gpu15_stage2&#45;&gt;expert2_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6977.08,-213.7C6984.99,-193.99 6997.3,-164.8 7002,-161.74 7034.4,-140.64 8308.86,-147.85 8444.18,-143.21"/>
<polygon fill="black" stroke="black" points="8444.68,-146.69 8454.47,-142.64 8444.29,-139.7 8444.68,-146.69"/>
</g>
<!-- expert3_gpu15_stage2 -->
<g id="node81" class="node">
<title>expert3_gpu15_stage2</title>
<polygon fill="white" stroke="black" points="8890.5,-143.74 8681.5,-143.74 8681.5,-90.74 8890.5,-90.74 8890.5,-143.74"/>
<text text-anchor="middle" x="8786" y="-128.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8786" y="-113.54" font-family="Times,serif" font-size="14.00">[hidden=8192, ffn=32768]</text>
<text text-anchor="middle" x="8786" y="-98.54" font-family="Times,serif" font-size="14.00">TP=8 shard</text>
</g>
<!-- gpu15_stage2&#45;&gt;expert3_gpu15_stage2 -->
<g id="edge64" class="edge">
<title>gpu15_stage2&#45;&gt;expert3_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6980.51,-213.49C6991.44,-196.54 7010.25,-172.36 7034,-161.74 7074.18,-143.77 8526.37,-148.67 8671.28,-143.24"/>
<polygon fill="black" stroke="black" points="8671.7,-146.72 8681.47,-142.64 8671.29,-139.73 8671.7,-146.72"/>
</g>
<!-- gate0 -->
<g id="node82" class="node">
<title>gate0</title>
<polygon fill="orange" stroke="black" points="7183.91,-1254.48 6916.8,-1254.48 6848.09,-1178.48 7115.2,-1178.48 7183.91,-1254.48"/>
<text text-anchor="middle" x="7016" y="-1220.28" font-family="Times,serif" font-size="14.00">Gating Layer 0</text>
<text text-anchor="middle" x="7016" y="-1205.28" font-family="Times,serif" font-size="14.00">Select top&#45;K experts</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu0_stage1 -->
<g id="edge67" class="edge">
<title>gate0&#45;&gt;expert0_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6880.29,-1214.21C6536.48,-1210.21 5649.84,-1194.81 5528,-1141.48 5479.86,-1120.41 5462.92,-1112.99 5435,-1068.48 5390.76,-997.95 5459.59,-938.01 5395,-885.48 5340.47,-841.14 499.95,-842.69 235.79,-833.92"/>
<polygon fill="black" stroke="black" points="235.69,-830.41 225.53,-833.39 235.33,-837.4 235.69,-830.41"/>
<text text-anchor="middle" x="5462.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu0_stage1 -->
<g id="edge68" class="edge">
<title>gate0&#45;&gt;expert1_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6880.86,-1214.78C6545.81,-1212.15 5695.61,-1199.75 5582,-1141.48 5541.17,-1120.54 5530.36,-1109.09 5509,-1068.48 5463.55,-982.07 5543.95,-915.05 5469,-852.48 5442.9,-830.69 715.29,-838.04 462.73,-833.73"/>
<polygon fill="black" stroke="black" points="462.63,-830.22 452.52,-833.41 462.41,-837.22 462.63,-830.22"/>
<text text-anchor="middle" x="5536.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu0_stage1 -->
<g id="edge69" class="edge">
<title>gate0&#45;&gt;expert2_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6879.86,-1213.84C6522.66,-1208.65 5586,-1188.91 5586,-1124.48 5586,-1124.48 5586,-1124.48 5586,-922.48 5586,-890.75 5596.5,-872.64 5572,-852.48 5546.41,-831.42 940.59,-837.98 689.87,-833.73"/>
<polygon fill="black" stroke="black" points="689.63,-830.22 679.52,-833.41 689.41,-837.22 689.63,-830.22"/>
<text text-anchor="middle" x="5613.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu0_stage1 -->
<g id="edge70" class="edge">
<title>gate0&#45;&gt;expert3_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6879.3,-1213.14C6540.46,-1206.43 5689,-1183.67 5689,-1124.48 5689,-1124.48 5689,-1124.48 5689,-922.48 5689,-890.75 5699.5,-872.64 5675,-852.48 5650.06,-831.96 1161.18,-837.91 916.62,-833.72"/>
<polygon fill="black" stroke="black" points="916.63,-830.22 906.52,-833.41 916.41,-837.22 916.63,-830.22"/>
<text text-anchor="middle" x="5716.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu1_stage1 -->
<g id="edge71" class="edge">
<title>gate0&#45;&gt;expert0_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6878.56,-1212.3C6558.81,-1204 5792,-1178.45 5792,-1124.48 5792,-1124.48 5792,-1124.48 5792,-922.48 5792,-890.75 5802.5,-872.64 5778,-852.48 5753.72,-832.5 1386.14,-837.84 1143.73,-833.72"/>
<polygon fill="black" stroke="black" points="1143.63,-830.22 1133.52,-833.41 1143.41,-837.21 1143.63,-830.22"/>
<text text-anchor="middle" x="5819.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu1_stage1 -->
<g id="edge72" class="edge">
<title>gate0&#45;&gt;expert1_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6877.7,-1211.3C6577.92,-1201.33 5895,-1173.25 5895,-1124.48 5895,-1124.48 5895,-1124.48 5895,-922.48 5895,-890.75 5905.5,-872.64 5881,-852.48 5857.39,-833.04 1610.86,-837.77 1370.83,-833.72"/>
<polygon fill="black" stroke="black" points="1370.62,-830.21 1360.52,-833.41 1370.41,-837.21 1370.62,-830.21"/>
<text text-anchor="middle" x="5922.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu1_stage1 -->
<g id="edge73" class="edge">
<title>gate0&#45;&gt;expert2_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6876.59,-1210.08C6597.78,-1198.35 5998,-1168.06 5998,-1124.48 5998,-1124.48 5998,-1124.48 5998,-922.48 5998,-890.75 6008.49,-872.65 5984,-852.48 5961.04,-833.58 1831.21,-837.7 1597.56,-833.72"/>
<polygon fill="black" stroke="black" points="1597.63,-830.22 1587.52,-833.41 1597.41,-837.21 1597.63,-830.22"/>
<text text-anchor="middle" x="6025.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu1_stage1 -->
<g id="edge74" class="edge">
<title>gate0&#45;&gt;expert3_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6881.48,-1215.68C6627.14,-1214.26 6101,-1201.95 6101,-1124.48 6101,-1124.48 6101,-1124.48 6101,-922.48 6101,-890.75 6111.49,-872.65 6087,-852.48 6064.7,-834.12 2055.58,-837.63 1824.64,-833.72"/>
<polygon fill="black" stroke="black" points="1824.63,-830.21 1814.52,-833.41 1824.41,-837.21 1824.63,-830.21"/>
<text text-anchor="middle" x="6128.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu2_stage1 -->
<g id="edge75" class="edge">
<title>gate0&#45;&gt;expert0_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6879.63,-1213.84C6648.35,-1209.23 6204,-1191.64 6204,-1124.48 6204,-1124.48 6204,-1124.48 6204,-922.48 6204,-890.75 6214.49,-872.65 6190,-852.48 6168.36,-834.66 2279.71,-837.56 2051.7,-833.72"/>
<polygon fill="black" stroke="black" points="2051.62,-830.21 2041.52,-833.41 2051.41,-837.21 2051.62,-830.21"/>
<text text-anchor="middle" x="6231.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu2_stage1 -->
<g id="edge76" class="edge">
<title>gate0&#45;&gt;expert1_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6877.61,-1211.42C6671.28,-1203.48 6307,-1181.41 6307,-1124.48 6307,-1124.48 6307,-1124.48 6307,-922.48 6307,-890.75 6317.49,-872.65 6293,-852.48 6272.02,-835.2 2503.6,-837.5 2278.75,-833.72"/>
<polygon fill="black" stroke="black" points="2278.62,-830.21 2268.52,-833.41 2278.41,-837.21 2278.62,-830.21"/>
<text text-anchor="middle" x="6334.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu2_stage1 -->
<g id="edge77" class="edge">
<title>gate0&#45;&gt;expert2_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6874.68,-1208.04C6695.62,-1196.68 6410,-1171.22 6410,-1124.48 6410,-1124.48 6410,-1124.48 6410,-922.48 6410,-890.75 6420.49,-872.65 6396,-852.48 6375.68,-835.74 2727.27,-837.43 2505.79,-833.71"/>
<polygon fill="black" stroke="black" points="2505.62,-830.21 2495.52,-833.41 2505.41,-837.21 2505.62,-830.21"/>
<text text-anchor="middle" x="6437.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu2_stage1 -->
<g id="edge78" class="edge">
<title>gate0&#45;&gt;expert3_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6870.17,-1203C6721.64,-1188.27 6513,-1161.06 6513,-1124.48 6513,-1124.48 6513,-1124.48 6513,-922.48 6513,-890.75 6523.49,-872.65 6499,-852.48 6479.34,-836.28 2950.69,-837.37 2732.81,-833.71"/>
<polygon fill="black" stroke="black" points="2732.62,-830.21 2722.52,-833.41 2732.41,-837.2 2732.62,-830.21"/>
<text text-anchor="middle" x="6540.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu3_stage1 -->
<g id="edge79" class="edge">
<title>gate0&#45;&gt;expert0_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6876.38,-1209.79C6760.99,-1201.15 6616,-1179.36 6616,-1124.48 6616,-1124.48 6616,-1124.48 6616,-922.48 6616,-890.75 6626.49,-872.66 6602,-852.48 6582.99,-836.82 3173.88,-837.31 2959.81,-833.71"/>
<polygon fill="black" stroke="black" points="2959.62,-830.21 2949.52,-833.41 2959.41,-837.2 2959.62,-830.21"/>
<text text-anchor="middle" x="6643.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu3_stage1 -->
<g id="edge80" class="edge">
<title>gate0&#45;&gt;expert1_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6862.72,-1194.94C6790.09,-1180.76 6719,-1158.25 6719,-1124.48 6719,-1124.48 6719,-1124.48 6719,-922.48 6719,-890.75 6729.48,-872.66 6705,-852.48 6686.65,-837.36 3394.48,-837.22 3186.56,-833.59"/>
<polygon fill="black" stroke="black" points="3186.63,-830.09 3176.53,-833.28 3186.41,-837.08 3186.63,-830.09"/>
<text text-anchor="middle" x="6746.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu3_stage1 -->
<g id="edge81" class="edge">
<title>gate0&#45;&gt;expert2_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6851.46,-1178.26C6833.75,-1165.33 6822,-1147.92 6822,-1124.48 6822,-1124.48 6822,-1124.48 6822,-922.48 6822,-890.75 6832.48,-872.66 6808,-852.48 6790.3,-837.89 3617.32,-837.16 3413.54,-833.58"/>
<polygon fill="black" stroke="black" points="3413.63,-830.09 3403.53,-833.28 3413.41,-837.08 3413.63,-830.09"/>
<text text-anchor="middle" x="6849.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu3_stage1 -->
<g id="edge82" class="edge">
<title>gate0&#45;&gt;expert3_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6953.79,-1178.41C6937.8,-1164.09 6925,-1145.93 6925,-1124.48 6925,-1124.48 6925,-1124.48 6925,-922.48 6925,-890.75 6935.48,-872.66 6911,-852.48 6876.84,-824.31 3845.14,-838.81 3640.65,-833.71"/>
<polygon fill="black" stroke="black" points="3640.67,-830.21 3630.53,-833.27 3640.37,-837.2 3640.67,-830.21"/>
<text text-anchor="middle" x="6952.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu4_stage1 -->
<g id="edge83" class="edge">
<title>gate0&#45;&gt;expert0_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7017.18,-1178.37C7019.87,-1088.15 7025.38,-863.86 7014,-852.48 6998.99,-837.47 4065.33,-836.96 3867.74,-833.58"/>
<polygon fill="black" stroke="black" points="3867.63,-830.08 3857.53,-833.27 3867.42,-837.07 3867.63,-830.08"/>
<text text-anchor="middle" x="7047.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu4_stage1 -->
<g id="edge84" class="edge">
<title>gate0&#45;&gt;expert1_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7140.57,-1206.26C7193.74,-1196.77 7253.44,-1178.06 7297,-1141.48 7320.61,-1121.66 7329.91,-1033.38 7355,-1015.48 7403.91,-980.59 7583.7,-1033.03 7624,-988.48 7654.71,-954.53 7655.6,-918.6 7624,-885.48 7594.59,-854.66 7282.07,-878.82 7241,-867.48 7227.39,-863.72 7226.68,-855.96 7213,-852.48 7130.83,-831.6 4305.48,-843.7 4094.58,-833.95"/>
<polygon fill="black" stroke="black" points="4094.74,-830.45 4084.53,-833.27 4094.27,-837.43 4094.74,-830.45"/>
<text text-anchor="middle" x="7382.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu4_stage1 -->
<g id="edge85" class="edge">
<title>gate0&#45;&gt;expert2_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7141.52,-1207.48C7227.12,-1199.86 7331.2,-1185.7 7367,-1160.48 7397,-1139.35 7415.71,-1036.19 7446,-1015.48 7485.03,-988.8 7625.77,-1023.96 7657,-988.48 7687.25,-954.12 7688.43,-918.77 7657,-885.48 7633.09,-860.15 7377.66,-876.45 7344,-867.48 7329.6,-863.64 7328.5,-855.95 7314,-852.48 7154.81,-814.39 4568.92,-852.02 4321.52,-834.17"/>
<polygon fill="black" stroke="black" points="4321.8,-830.68 4311.53,-833.27 4321.18,-837.65 4321.8,-830.68"/>
<text text-anchor="middle" x="7473.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu4_stage1 -->
<g id="edge86" class="edge">
<title>gate0&#45;&gt;expert3_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7145.59,-1211.96C7257.27,-1206.68 7408.15,-1193.48 7458,-1160.48 7520.1,-1119.37 7480.96,-1058.16 7542,-1015.48 7598.59,-975.91 7650.62,-1041.38 7695,-988.48 7724.42,-953.41 7726.18,-919 7695,-885.48 7676.18,-865.25 7473.73,-874.46 7447,-867.48 7431.8,-863.51 7430.32,-855.94 7415,-852.48 7262.22,-817.94 4790.38,-851.32 4548.83,-834.18"/>
<polygon fill="black" stroke="black" points="4548.8,-830.67 4538.53,-833.27 4548.18,-837.64 4548.8,-830.67"/>
<text text-anchor="middle" x="7569.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu5_stage1 -->
<g id="edge87" class="edge">
<title>gate0&#45;&gt;expert0_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7148.29,-1214.95C7284.08,-1212.12 7484.38,-1200.91 7549,-1160.48 7613.3,-1120.25 7578.5,-1061.23 7639,-1015.48 7673.67,-989.26 7706.85,-1023.2 7733,-988.48 7760.54,-951.91 7763.74,-919.4 7733,-885.48 7705.56,-855.2 7590.22,-874.7 7550,-867.48 7524.22,-862.85 7518.97,-855.93 7493,-852.48 7196.69,-813.15 5118.32,-867.5 4775.62,-834.33"/>
<polygon fill="black" stroke="black" points="4775.84,-830.83 4765.53,-833.27 4775.11,-837.8 4775.84,-830.83"/>
<text text-anchor="middle" x="7666.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu5_stage1 -->
<g id="edge88" class="edge">
<title>gate0&#45;&gt;expert1_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7144.07,-1210.26C7314.37,-1202.39 7598.81,-1185.69 7640,-1160.48 7704.9,-1120.77 7678.1,-1070.17 7731,-1015.48 7745.91,-1000.06 7760.93,-1007.42 7771,-988.48 7792.48,-948.06 7800.83,-920.2 7771,-885.48 7753.72,-865.36 7679.04,-872.56 7653,-867.48 7624.75,-861.97 7618.57,-855.94 7590,-852.48 7307.58,-818.33 5330.84,-866.01 5002.63,-834.33"/>
<polygon fill="black" stroke="black" points="5002.84,-830.83 4992.53,-833.27 5002.11,-837.79 5002.84,-830.83"/>
<text text-anchor="middle" x="7758.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu5_stage1 -->
<g id="edge89" class="edge">
<title>gate0&#45;&gt;expert2_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7146.16,-1212.41C7339.23,-1206.81 7683.9,-1192.45 7731,-1160.48 7783.56,-1124.81 7847.1,-936.3 7809,-885.48 7805.08,-880.25 7702.47,-853.43 7696,-852.48 7427.83,-813.13 5544.34,-864.4 5229.64,-834.32"/>
<polygon fill="black" stroke="black" points="5229.84,-830.83 5219.53,-833.27 5229.11,-837.79 5229.84,-830.83"/>
<text text-anchor="middle" x="7834.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu5_stage1 -->
<g id="edge90" class="edge">
<title>gate0&#45;&gt;expert3_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7147.38,-1213.64C7361.52,-1209.58 7767.52,-1197.12 7822,-1160.48 7923.84,-1092 7914.59,-987.92 7847,-885.48 7831.72,-862.32 7820.65,-860.21 7794,-852.48 7671.62,-816.99 5663.72,-848.01 5456.53,-834.13"/>
<polygon fill="black" stroke="black" points="5456.79,-830.64 5446.53,-833.27 5456.19,-837.61 5456.79,-830.64"/>
<text text-anchor="middle" x="7925.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu6_stage1 -->
<g id="edge91" class="edge">
<title>gate0&#45;&gt;expert0_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7146.41,-1212.89C7442.48,-1206.54 8143.18,-1188.62 8186,-1160.48 8300.61,-1085.16 8308.9,-942 8205,-852.48 8186.31,-836.38 6513.5,-837.32 6364.58,-833.67"/>
<polygon fill="black" stroke="black" points="6364.67,-830.18 6354.53,-833.26 6364.37,-837.17 6364.67,-830.18"/>
<text text-anchor="middle" x="8304.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu6_stage1 -->
<g id="edge92" class="edge">
<title>gate0&#45;&gt;expert1_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7148.13,-1214.64C7382.21,-1212.1 7851.04,-1201.84 7913,-1160.48 8026.99,-1084.39 8010.09,-931.34 7898,-852.48 7873.64,-835.34 5848.48,-837.8 5683.61,-833.69"/>
<polygon fill="black" stroke="black" points="5683.67,-830.19 5673.53,-833.26 5683.37,-837.18 5683.67,-830.19"/>
<text text-anchor="middle" x="8017.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu6_stage1 -->
<g id="edge93" class="edge">
<title>gate0&#45;&gt;expert2_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.08,-1215.47C7402.3,-1214.39 7934.52,-1206.57 8004,-1160.48 8118.07,-1084.8 8111.8,-935.56 8003,-852.48 7980.66,-835.42 6072.19,-837.62 5910.82,-833.69"/>
<polygon fill="black" stroke="black" points="5910.66,-830.18 5900.53,-833.26 5910.37,-837.17 5910.66,-830.18"/>
<text text-anchor="middle" x="8114.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu6_stage1 -->
<g id="edge94" class="edge">
<title>gate0&#45;&gt;expert3_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.49,-1216.17C7420.88,-1216.5 8017.93,-1211.35 8095,-1160.48 8209.28,-1085.05 8208.86,-938.09 8102,-852.48 8081.43,-836 6292.92,-837.47 6137.72,-833.68"/>
<polygon fill="black" stroke="black" points="6137.67,-830.18 6127.53,-833.26 6137.37,-837.17 6137.67,-830.18"/>
<text text-anchor="middle" x="8208.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert0_gpu7_stage1 -->
<g id="edge95" class="edge">
<title>gate0&#45;&gt;expert0_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.09,-1215.79C7428.08,-1215.44 8065.8,-1209.13 8277,-1160.48 8316.18,-1151.45 8360,-1164.69 8360,-1124.48 8360,-1124.48 8360,-1124.48 8360,-922.48 8360,-883.72 8342.53,-870.07 8308,-852.48 8266.87,-831.53 6741.61,-839.41 6591.81,-833.85"/>
<polygon fill="black" stroke="black" points="6591.72,-830.34 6581.53,-833.25 6591.31,-837.33 6591.72,-830.34"/>
<text text-anchor="middle" x="8387.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert1_gpu7_stage1 -->
<g id="edge96" class="edge">
<title>gate0&#45;&gt;expert1_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7149.13,-1215.88C7443.79,-1215.82 8143.27,-1210.24 8374,-1160.48 8415.71,-1151.48 8463,-1167.15 8463,-1124.48 8463,-1124.48 8463,-1124.48 8463,-922.48 8463,-883.72 8445.53,-870.09 8411,-852.48 8372.89,-833.04 6960.58,-839.14 6818.56,-833.84"/>
<polygon fill="black" stroke="black" points="6818.72,-830.34 6808.53,-833.25 6818.31,-837.33 6818.72,-830.34"/>
<text text-anchor="middle" x="8490.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert2_gpu7_stage1 -->
<g id="edge97" class="edge">
<title>gate0&#45;&gt;expert2_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7146.8,-1213.14C7481.04,-1206.79 8349.18,-1187.86 8477,-1160.48 8518.72,-1151.54 8566,-1167.15 8566,-1124.48 8566,-1124.48 8566,-1124.48 8566,-922.48 8566,-883.99 8549.2,-870.14 8515,-852.48 8479.99,-834.4 7181.84,-838.86 7045.67,-833.83"/>
<polygon fill="black" stroke="black" points="7045.72,-830.33 7035.53,-833.25 7045.31,-837.32 7045.72,-830.33"/>
<text text-anchor="middle" x="8593.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- gate0&#45;&gt;expert3_gpu7_stage1 -->
<g id="edge98" class="edge">
<title>gate0&#45;&gt;expert3_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7148.48,-1215.08C7540.73,-1213.01 8669,-1200.47 8669,-1124.48 8669,-1124.48 8669,-1124.48 8669,-922.48 8669,-883.72 8651.36,-870.41 8617,-852.48 8557.79,-821.59 7606.68,-812.08 7272.78,-809.68"/>
<polygon fill="black" stroke="black" points="7272.62,-806.18 7262.6,-809.61 7272.57,-813.18 7272.62,-806.18"/>
<text text-anchor="middle" x="8696.5" y="-1038.28" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<!-- residual0 -->
<g id="node87" class="node">
<title>residual0</title>
<ellipse fill="lightcoral" stroke="black" cx="7178" cy="-1123.48" rx="109.68" ry="18"/>
<text text-anchor="middle" x="7178" y="-1119.78" font-family="Times,serif" font-size="14.00">Residual Add Layer 0</text>
</g>
<!-- gate0&#45;&gt;residual0 -->
<g id="edge195" class="edge">
<title>gate0&#45;&gt;residual0</title>
<path fill="none" stroke="black" d="M7081.89,-1178.47C7101.4,-1167.51 7122.13,-1155.86 7139.32,-1146.21"/>
<polygon fill="black" stroke="black" points="7141.47,-1149.01 7148.48,-1141.07 7138.04,-1142.91 7141.47,-1149.01"/>
</g>
<!-- gate1 -->
<g id="node83" class="node">
<title>gate1</title>
<polygon fill="orange" stroke="black" points="7614.91,-961.48 7347.8,-961.48 7279.09,-885.48 7546.2,-885.48 7614.91,-961.48"/>
<text text-anchor="middle" x="7447" y="-927.28" font-family="Times,serif" font-size="14.00">Gating Layer 1</text>
<text text-anchor="middle" x="7447" y="-912.28" font-family="Times,serif" font-size="14.00">Select top&#45;K experts</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu0_stage1 -->
<g id="edge99" class="edge">
<title>gate1&#45;&gt;expert0_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.11,-885.95C7277.74,-885.79 7276.37,-885.63 7275,-885.48 7071.8,-862.87 5636.54,-901.9 5435,-867.48 5414.63,-864 5411.38,-855.89 5391,-852.48 5251.86,-829.16 522.79,-849.94 235.58,-834.16"/>
<polygon fill="black" stroke="black" points="235.76,-830.67 225.52,-833.41 235.23,-837.65 235.76,-830.67"/>
<text text-anchor="middle" x="5462.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu0_stage1 -->
<g id="edge100" class="edge">
<title>gate1&#45;&gt;expert1_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.11,-885.96C7277.74,-885.79 7276.37,-885.63 7275,-885.48 7083.18,-864.08 5728.25,-900.03 5538,-867.48 5517.64,-864 5514.38,-855.9 5494,-852.48 5358.27,-829.73 747.42,-849.57 462.77,-834.17"/>
<polygon fill="black" stroke="black" points="462.75,-830.66 452.52,-833.41 462.24,-837.64 462.75,-830.66"/>
<text text-anchor="middle" x="5565.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu0_stage1 -->
<g id="edge101" class="edge">
<title>gate1&#45;&gt;expert2_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.01C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7094.56,-865.29 5819.96,-898.16 5641,-867.48 5620.64,-863.99 5617.38,-855.9 5597,-852.48 5330.85,-807.86 1050.27,-863.98 689.67,-834.38"/>
<polygon fill="black" stroke="black" points="689.81,-830.88 679.52,-833.41 689.14,-837.85 689.81,-830.88"/>
<text text-anchor="middle" x="5668.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu0_stage1 -->
<g id="edge102" class="edge">
<title>gate1&#45;&gt;expert3_gpu0_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.01C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7105.94,-866.5 5911.67,-896.29 5744,-867.48 5723.64,-863.98 5720.38,-855.9 5700,-852.48 5440.64,-808.99 1270.18,-863.23 916.68,-834.38"/>
<polygon fill="black" stroke="black" points="916.81,-830.88 906.52,-833.41 916.15,-837.84 916.81,-830.88"/>
<text text-anchor="middle" x="5771.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu1_stage1 -->
<g id="edge103" class="edge">
<title>gate1&#45;&gt;expert0_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.02C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7117.32,-867.71 6003.38,-894.42 5847,-867.48 5826.64,-863.97 5823.38,-855.9 5803,-852.48 5550.43,-810.11 1489.98,-862.48 1143.68,-834.38"/>
<polygon fill="black" stroke="black" points="1143.81,-830.87 1133.52,-833.41 1143.15,-837.84 1143.81,-830.87"/>
<text text-anchor="middle" x="5874.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu1_stage1 -->
<g id="edge104" class="edge">
<title>gate1&#45;&gt;expert1_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.02C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7128.7,-868.92 6095.09,-892.54 5950,-867.48 5929.64,-863.96 5926.38,-855.9 5906,-852.48 5660.21,-811.23 1709.67,-861.73 1370.67,-834.37"/>
<polygon fill="black" stroke="black" points="1370.81,-830.87 1360.52,-833.41 1370.15,-837.84 1370.81,-830.87"/>
<text text-anchor="middle" x="5977.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu1_stage1 -->
<g id="edge105" class="edge">
<title>gate1&#45;&gt;expert2_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.02C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7140.08,-870.13 6186.8,-890.67 6053,-867.48 6032.64,-863.95 6029.38,-855.9 6009,-852.48 5770.05,-812.37 1931.15,-860.96 1597.89,-834.39"/>
<polygon fill="black" stroke="black" points="1597.81,-830.86 1587.52,-833.41 1597.15,-837.83 1597.81,-830.86"/>
<text text-anchor="middle" x="6080.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu1_stage1 -->
<g id="edge106" class="edge">
<title>gate1&#45;&gt;expert3_gpu1_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.02C7278.04,-885.83 7276.52,-885.65 7275,-885.48 7027.92,-857.19 6401.02,-910.12 6156,-867.48 6135.65,-863.94 6132.38,-855.9 6112,-852.48 5879.76,-813.48 2148.73,-860.24 1824.6,-834.36"/>
<polygon fill="black" stroke="black" points="1824.81,-830.86 1814.52,-833.41 1824.15,-837.83 1824.81,-830.86"/>
<text text-anchor="middle" x="6183.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu2_stage1 -->
<g id="edge107" class="edge">
<title>gate1&#45;&gt;expert0_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.03C7278.04,-885.84 7276.52,-885.66 7275,-885.48 7050.67,-859.61 6481.44,-906.38 6259,-867.48 6238.65,-863.92 6235.38,-855.9 6215,-852.48 5989.59,-814.61 2369.89,-859.48 2051.79,-834.37"/>
<polygon fill="black" stroke="black" points="2051.81,-830.86 2041.52,-833.41 2051.15,-837.83 2051.81,-830.86"/>
<text text-anchor="middle" x="6286.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu2_stage1 -->
<g id="edge108" class="edge">
<title>gate1&#45;&gt;expert1_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.03C7278.04,-885.84 7276.52,-885.66 7275,-885.48 7073.43,-862.03 6561.86,-902.64 6362,-867.48 6341.65,-863.9 6338.37,-855.9 6318,-852.48 6099.31,-815.73 2587.37,-858.76 2278.49,-834.34"/>
<polygon fill="black" stroke="black" points="2278.81,-830.86 2268.52,-833.41 2278.15,-837.83 2278.81,-830.86"/>
<text text-anchor="middle" x="6389.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu2_stage1 -->
<g id="edge109" class="edge">
<title>gate1&#45;&gt;expert2_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.04C7278.04,-885.84 7276.52,-885.66 7275,-885.48 7096.19,-864.45 6642.28,-898.9 6465,-867.48 6444.66,-863.88 6441.37,-855.91 6421,-852.48 6209.12,-816.86 2808.21,-858.01 2505.64,-834.35"/>
<polygon fill="black" stroke="black" points="2505.81,-830.85 2495.52,-833.41 2505.15,-837.82 2505.81,-830.85"/>
<text text-anchor="middle" x="6492.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu2_stage1 -->
<g id="edge110" class="edge">
<title>gate1&#45;&gt;expert3_gpu2_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.04C7278.04,-885.85 7276.52,-885.66 7275,-885.48 7118.94,-866.87 6722.71,-895.15 6568,-867.48 6547.66,-863.84 6544.37,-855.91 6524,-852.48 6318.93,-817.99 3028.83,-857.25 2732.77,-834.36"/>
<polygon fill="black" stroke="black" points="2732.8,-830.85 2722.52,-833.41 2732.16,-837.82 2732.8,-830.85"/>
<text text-anchor="middle" x="6595.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu3_stage1 -->
<g id="edge111" class="edge">
<title>gate1&#45;&gt;expert0_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.57,-886.05C7278.04,-885.86 7276.52,-885.66 7275,-885.48 7141.7,-869.29 6803.13,-891.41 6671,-867.48 6650.67,-863.8 6647.37,-855.91 6627,-852.48 6428.74,-819.11 3249.24,-856.5 2959.88,-834.36"/>
<polygon fill="black" stroke="black" points="2959.8,-830.84 2949.52,-833.41 2959.16,-837.81 2959.8,-830.84"/>
<text text-anchor="middle" x="6698.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu3_stage1 -->
<g id="edge112" class="edge">
<title>gate1&#45;&gt;expert1_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.56,-886.07C7278.04,-885.86 7276.52,-885.67 7275,-885.48 7053.9,-857.94 6993.12,-907.86 6774,-867.48 6753.68,-863.74 6750.37,-855.91 6730,-852.48 6538.5,-820.23 3467.34,-855.6 3186.58,-834.2"/>
<polygon fill="black" stroke="black" points="3186.8,-830.71 3176.53,-833.28 3186.16,-837.68 3186.8,-830.71"/>
<text text-anchor="middle" x="6801.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu3_stage1 -->
<g id="edge113" class="edge">
<title>gate1&#45;&gt;expert2_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.56,-886.09C7278.04,-885.88 7276.51,-885.68 7275,-885.48 7099.39,-862.78 7050.99,-900.38 6877,-867.48 6856.7,-863.64 6853.37,-855.91 6833,-852.48 6648.29,-821.36 3687.43,-854.87 3413.64,-834.2"/>
<polygon fill="black" stroke="black" points="3413.8,-830.7 3403.53,-833.28 3413.17,-837.67 3413.8,-830.7"/>
<text text-anchor="middle" x="6904.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu3_stage1 -->
<g id="edge114" class="edge">
<title>gate1&#45;&gt;expert3_gpu3_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.56,-886.12C7278.03,-885.9 7276.51,-885.69 7275,-885.48 7146.19,-867.76 7110.8,-891.43 6983,-867.48 6961.45,-863.44 6957.66,-855.91 6936,-852.48 6757.79,-824.23 3907.29,-854.18 3640.69,-834.2"/>
<polygon fill="black" stroke="black" points="3640.8,-830.7 3630.53,-833.27 3640.17,-837.67 3640.8,-830.7"/>
<text text-anchor="middle" x="7010.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu4_stage1 -->
<g id="edge115" class="edge">
<title>gate1&#45;&gt;expert0_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.55,-886.18C7278.03,-885.94 7276.51,-885.71 7275,-885.48 7183.24,-871.7 7155.27,-896.08 7067,-867.48 7054.67,-863.49 7054.48,-855.97 7042,-852.48 6958.9,-829.21 4082.3,-843.76 3867.75,-833.96"/>
<polygon fill="black" stroke="black" points="3867.74,-830.45 3857.53,-833.27 3867.27,-837.43 3867.74,-830.45"/>
<text text-anchor="middle" x="7094.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu4_stage1 -->
<g id="edge116" class="edge">
<title>gate1&#45;&gt;expert1_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7279.53,-886.32C7278.01,-886.04 7276.5,-885.76 7275,-885.48 7223.26,-875.94 7208.33,-882.8 7158,-867.48 7142.97,-862.91 7141.32,-855.94 7126,-852.48 6964.26,-815.95 4345.14,-852.3 4094.65,-834.18"/>
<polygon fill="black" stroke="black" points="4094.8,-830.68 4084.53,-833.27 4094.18,-837.65 4094.8,-830.68"/>
<text text-anchor="middle" x="7185.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu4_stage1 -->
<g id="edge117" class="edge">
<title>gate1&#45;&gt;expert2_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7321.89,-885.48C7265.14,-868.7 7210.41,-852.54 7210,-852.48 6895.54,-806.01 4683.76,-869.46 4321.7,-834.34"/>
<polygon fill="black" stroke="black" points="4321.84,-830.84 4311.53,-833.27 4321.11,-837.8 4321.84,-830.84"/>
<text text-anchor="middle" x="7282.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu4_stage1 -->
<g id="edge118" class="edge">
<title>gate1&#45;&gt;expert3_gpu4_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7393.43,-885.48C7371.4,-872.37 7344.99,-859.21 7319,-852.48 7246.23,-833.63 4745.89,-842.73 4548.68,-833.93"/>
<polygon fill="black" stroke="black" points="4548.73,-830.43 4538.53,-833.27 4548.28,-837.42 4548.73,-830.43"/>
<text text-anchor="middle" x="7383.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu5_stage1 -->
<g id="edge119" class="edge">
<title>gate1&#45;&gt;expert0_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7442.4,-885.23C7438.88,-872.76 7432.73,-860.1 7422,-852.48 7392.88,-831.81 4958.09,-838.24 4775.69,-833.7"/>
<polygon fill="black" stroke="black" points="4775.67,-830.2 4765.53,-833.27 4775.37,-837.19 4775.67,-830.2"/>
<text text-anchor="middle" x="7461.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu5_stage1 -->
<g id="edge120" class="edge">
<title>gate1&#45;&gt;expert1_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7519.5,-885.2C7530.96,-874.86 7535.9,-863.46 7525,-852.48 7501.03,-828.34 5179.07,-837.85 5002.53,-833.68"/>
<polygon fill="black" stroke="black" points="5002.66,-830.19 4992.53,-833.27 5002.37,-837.18 5002.66,-830.19"/>
<text text-anchor="middle" x="7558.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu5_stage1 -->
<g id="edge121" class="edge">
<title>gate1&#45;&gt;expert2_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7567.66,-909C7617.21,-898.92 7656.96,-881.65 7628,-852.48 7605.24,-829.55 5401.81,-837.72 5229.59,-833.68"/>
<polygon fill="black" stroke="black" points="5229.66,-830.18 5219.53,-833.27 5229.37,-837.18 5229.66,-830.18"/>
<text text-anchor="middle" x="7664.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu5_stage1 -->
<g id="edge122" class="edge">
<title>gate1&#45;&gt;expert3_gpu5_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7568.78,-910.03C7657.4,-898.58 7757.6,-879.29 7731,-852.48 7709.44,-830.75 5624.08,-837.6 5456.61,-833.68"/>
<polygon fill="black" stroke="black" points="5456.66,-830.18 5446.53,-833.26 5456.38,-837.17 5456.66,-830.18"/>
<text text-anchor="middle" x="7762.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu6_stage1 -->
<g id="edge123" class="edge">
<title>gate1&#45;&gt;expert0_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.86,-921.5C7770.04,-918.68 8105.6,-907.96 8143,-867.48 8147.52,-862.58 8147.69,-857.22 8143,-852.48 8126.24,-835.55 6511.83,-837.17 6364.73,-833.67"/>
<polygon fill="black" stroke="black" points="6364.66,-830.17 6354.53,-833.26 6364.38,-837.16 6364.66,-830.17"/>
<text text-anchor="middle" x="8173.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu6_stage1 -->
<g id="edge124" class="edge">
<title>gate1&#45;&gt;expert1_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7575.13,-917.33C7702.47,-909.89 7873.54,-892.36 7834,-852.48 7813.64,-831.95 5845.89,-837.49 5683.6,-833.68"/>
<polygon fill="black" stroke="black" points="5683.66,-830.18 5673.53,-833.26 5683.38,-837.17 5683.66,-830.18"/>
<text text-anchor="middle" x="7866.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu6_stage1 -->
<g id="edge125" class="edge">
<title>gate1&#45;&gt;expert2_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7579.37,-921.92C7741.87,-918.97 7989.89,-905.85 7937,-852.48 7917.84,-833.15 6067.24,-837.38 5910.54,-833.67"/>
<polygon fill="black" stroke="black" points="5910.66,-830.17 5900.53,-833.26 5910.38,-837.17 5910.66,-830.17"/>
<text text-anchor="middle" x="7971.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu6_stage1 -->
<g id="edge126" class="edge">
<title>gate1&#45;&gt;expert3_gpu6_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7577.32,-919.52C7742.47,-914.39 8009.46,-900.98 8040,-867.48 8044.49,-862.55 8044.69,-857.22 8040,-852.48 8022.05,-834.36 6291.63,-837.27 6137.89,-833.68"/>
<polygon fill="black" stroke="black" points="6137.66,-830.17 6127.53,-833.26 6137.38,-837.16 6137.66,-830.17"/>
<text text-anchor="middle" x="8070.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert0_gpu7_stage1 -->
<g id="edge127" class="edge">
<title>gate1&#45;&gt;expert0_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7580.18,-923C7795.75,-922.44 8201.64,-915 8246,-867.48 8250.55,-862.61 8250.69,-857.22 8246,-852.48 8230.45,-836.76 6734.61,-837.08 6591.94,-833.68"/>
<polygon fill="black" stroke="black" points="6591.66,-830.16 6581.53,-833.25 6591.38,-837.16 6591.66,-830.16"/>
<text text-anchor="middle" x="8276.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert1_gpu7_stage1 -->
<g id="edge128" class="edge">
<title>gate1&#45;&gt;expert1_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7576.92,-919.2C7820.32,-912.42 8322.98,-895.14 8349,-867.48 8353.57,-862.62 8353.69,-857.22 8349,-852.48 8334.64,-837.95 6953.66,-836.99 6818.64,-833.67"/>
<polygon fill="black" stroke="black" points="6818.67,-830.17 6808.53,-833.25 6818.38,-837.16 6818.67,-830.17"/>
<text text-anchor="middle" x="8379.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert2_gpu7_stage1 -->
<g id="edge129" class="edge">
<title>gate1&#45;&gt;expert2_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7580.13,-922.83C7867.1,-922.41 8513.36,-914.63 8452,-852.48 8425.53,-825.67 7179,-838.04 7045.7,-833.79"/>
<polygon fill="black" stroke="black" points="7045.7,-830.29 7035.53,-833.24 7045.33,-837.28 7045.7,-830.29"/>
<text text-anchor="middle" x="8483.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- gate1&#45;&gt;expert3_gpu7_stage1 -->
<g id="edge130" class="edge">
<title>gate1&#45;&gt;expert3_gpu7_stage1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7578.1,-920.74C7864.21,-916.31 8521.81,-902.36 8555,-867.48 8559.6,-862.65 8559.64,-857.27 8555,-852.48 8532.78,-829.56 7602.5,-814.92 7272.57,-810.44"/>
<polygon fill="black" stroke="black" points="7272.55,-806.94 7262.51,-810.31 7272.46,-813.94 7272.55,-806.94"/>
<text text-anchor="middle" x="8585.5" y="-856.28" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<!-- residual1 -->
<g id="node89" class="node">
<title>residual1</title>
<ellipse fill="lightcoral" stroke="black" cx="8694" cy="-807.98" rx="109.68" ry="18"/>
<text text-anchor="middle" x="8694" y="-804.28" font-family="Times,serif" font-size="14.00">Residual Add Layer 1</text>
</g>
<!-- gate1&#45;&gt;residual1 -->
<g id="edge198" class="edge">
<title>gate1&#45;&gt;residual1</title>
<path fill="none" stroke="black" d="M7578.08,-920.7C7863.14,-916.19 8521.58,-902.13 8617,-867.48 8637.1,-860.18 8656.27,-845.66 8670.45,-832.91"/>
<polygon fill="black" stroke="black" points="8672.86,-835.44 8677.79,-826.06 8668.09,-830.32 8672.86,-835.44"/>
</g>
<!-- gate2 -->
<g id="node84" class="node">
<title>gate2</title>
<polygon fill="orange" stroke="black" points="8826.91,-563.74 8559.8,-563.74 8491.09,-487.74 8758.2,-487.74 8826.91,-563.74"/>
<text text-anchor="middle" x="8659" y="-529.54" font-family="Times,serif" font-size="14.00">Gating Layer 2</text>
<text text-anchor="middle" x="8659" y="-514.54" font-family="Times,serif" font-size="14.00">Select top&#45;K experts</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu8_stage2 -->
<g id="edge131" class="edge">
<title>gate2&#45;&gt;expert0_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8523.29,-523.47C8179.48,-519.47 7292.84,-504.07 7171,-450.74 7122.86,-429.67 7106.84,-421.67 7078,-377.74 7031.86,-307.45 7096.32,-246.43 7030,-194.74 6974.49,-151.47 2128.28,-152 1863.8,-143.19"/>
<polygon fill="black" stroke="black" points="1863.7,-139.67 1853.53,-142.65 1863.33,-146.67 1863.7,-139.67"/>
<text text-anchor="middle" x="7105.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu8_stage2 -->
<g id="edge132" class="edge">
<title>gate2&#45;&gt;expert1_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8523.86,-524.04C8188.81,-521.41 7338.61,-509.01 7225,-450.74 7184.17,-429.8 7173.36,-418.35 7152,-377.74 7106.55,-291.33 7186.95,-224.31 7112,-161.74 7085.82,-139.89 2344.05,-147.31 2090.76,-142.99"/>
<polygon fill="black" stroke="black" points="2090.63,-139.48 2080.52,-142.67 2090.41,-146.48 2090.63,-139.48"/>
<text text-anchor="middle" x="7179.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu8_stage2 -->
<g id="edge133" class="edge">
<title>gate2&#45;&gt;expert2_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8522.86,-523.1C8165.66,-517.91 7229,-498.17 7229,-433.74 7229,-433.74 7229,-433.74 7229,-231.74 7229,-200.01 7239.5,-181.9 7215,-161.74 7189.32,-140.61 2564.75,-147.25 2317.52,-142.98"/>
<polygon fill="black" stroke="black" points="2317.63,-139.48 2307.52,-142.67 2317.41,-146.48 2317.63,-139.48"/>
<text text-anchor="middle" x="7256.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu8_stage2 -->
<g id="edge134" class="edge">
<title>gate2&#45;&gt;expert3_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8522.3,-522.4C8183.46,-515.68 7332,-492.93 7332,-433.74 7332,-433.74 7332,-433.74 7332,-231.74 7332,-200.01 7342.5,-181.9 7318,-161.74 7292.98,-141.15 2789.96,-147.18 2544.65,-142.98"/>
<polygon fill="black" stroke="black" points="2544.63,-139.48 2534.52,-142.67 2544.41,-146.48 2544.63,-139.48"/>
<text text-anchor="middle" x="7359.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu9_stage2 -->
<g id="edge135" class="edge">
<title>gate2&#45;&gt;expert0_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8521.56,-521.56C8201.81,-513.26 7435,-487.71 7435,-433.74 7435,-433.74 7435,-433.74 7435,-231.74 7435,-200.01 7445.5,-181.9 7421,-161.74 7396.65,-141.7 3014.93,-147.1 2771.76,-142.98"/>
<polygon fill="black" stroke="black" points="2771.63,-139.48 2761.52,-142.67 2771.41,-146.47 2771.63,-139.48"/>
<text text-anchor="middle" x="7462.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu9_stage2 -->
<g id="edge136" class="edge">
<title>gate2&#45;&gt;expert1_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8520.7,-520.56C8220.92,-510.59 7538,-482.51 7538,-433.74 7538,-433.74 7538,-433.74 7538,-231.74 7538,-200.01 7548.5,-181.9 7524,-161.74 7500.31,-142.24 3239.66,-147.03 2998.86,-142.98"/>
<polygon fill="black" stroke="black" points="2998.62,-139.47 2988.52,-142.67 2998.41,-146.47 2998.62,-139.47"/>
<text text-anchor="middle" x="7565.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu9_stage2 -->
<g id="edge137" class="edge">
<title>gate2&#45;&gt;expert2_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8519.59,-519.34C8240.78,-507.61 7641,-477.32 7641,-433.74 7641,-433.74 7641,-433.74 7641,-231.74 7641,-200.01 7651.49,-181.9 7627,-161.74 7603.96,-142.78 3460.96,-146.94 3225.67,-142.86"/>
<polygon fill="black" stroke="black" points="3225.63,-139.35 3215.53,-142.54 3225.41,-146.35 3225.63,-139.35"/>
<text text-anchor="middle" x="7668.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu9_stage2 -->
<g id="edge138" class="edge">
<title>gate2&#45;&gt;expert3_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8524.48,-524.94C8270.14,-523.52 7744,-511.21 7744,-433.74 7744,-433.74 7744,-433.74 7744,-231.74 7744,-200.01 7754.49,-181.91 7730,-161.74 7707.62,-143.32 3685.34,-146.87 3452.75,-142.86"/>
<polygon fill="black" stroke="black" points="3452.63,-139.35 3442.53,-142.54 3452.41,-146.35 3452.63,-139.35"/>
<text text-anchor="middle" x="7771.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu10_stage2 -->
<g id="edge139" class="edge">
<title>gate2&#45;&gt;expert0_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8522.63,-523.1C8291.35,-518.49 7847,-500.9 7847,-433.74 7847,-433.74 7847,-433.74 7847,-231.74 7847,-200.01 7857.49,-181.91 7833,-161.74 7811.29,-143.86 3909.49,-146.81 3679.81,-142.86"/>
<polygon fill="black" stroke="black" points="3679.63,-139.35 3669.53,-142.54 3679.41,-146.35 3679.63,-139.35"/>
<text text-anchor="middle" x="7874.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu10_stage2 -->
<g id="edge140" class="edge">
<title>gate2&#45;&gt;expert1_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8520.61,-520.68C8314.28,-512.74 7950,-490.67 7950,-433.74 7950,-433.74 7950,-433.74 7950,-231.74 7950,-200.01 7960.49,-181.91 7936,-161.74 7914.93,-144.39 4129.61,-146.74 3906.53,-142.85"/>
<polygon fill="black" stroke="black" points="3906.63,-139.35 3896.53,-142.54 3906.41,-146.35 3906.63,-139.35"/>
<text text-anchor="middle" x="7977.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu10_stage2 -->
<g id="edge141" class="edge">
<title>gate2&#45;&gt;expert2_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8517.68,-517.3C8338.62,-505.94 8053,-480.48 8053,-433.74 8053,-433.74 8053,-433.74 8053,-231.74 8053,-200.01 8063.49,-181.91 8039,-161.74 8018.59,-144.93 4353.4,-146.68 4133.57,-142.85"/>
<polygon fill="black" stroke="black" points="4133.63,-139.35 4123.53,-142.54 4133.41,-146.35 4133.63,-139.35"/>
<text text-anchor="middle" x="8080.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu10_stage2 -->
<g id="edge142" class="edge">
<title>gate2&#45;&gt;expert3_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8513.17,-512.26C8364.64,-497.53 8156,-470.32 8156,-433.74 8156,-433.74 8156,-433.74 8156,-231.74 8156,-200.01 8166.49,-181.91 8142,-161.74 8122.25,-145.47 4576.96,-146.61 4360.59,-142.85"/>
<polygon fill="black" stroke="black" points="4360.63,-139.35 4350.53,-142.54 4360.41,-146.34 4360.63,-139.35"/>
<text text-anchor="middle" x="8183.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu11_stage2 -->
<g id="edge143" class="edge">
<title>gate2&#45;&gt;expert0_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8519.38,-519.05C8403.99,-510.41 8259,-488.62 8259,-433.74 8259,-433.74 8259,-433.74 8259,-231.74 8259,-200.01 8269.49,-181.92 8245,-161.74 8225.91,-146.01 4800.28,-146.55 4587.6,-142.85"/>
<polygon fill="black" stroke="black" points="4587.63,-139.35 4577.53,-142.54 4587.41,-146.34 4587.63,-139.35"/>
<text text-anchor="middle" x="8286.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu11_stage2 -->
<g id="edge144" class="edge">
<title>gate2&#45;&gt;expert1_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8505.72,-504.2C8433.09,-490.02 8362,-467.51 8362,-433.74 8362,-433.74 8362,-433.74 8362,-231.74 8362,-200.01 8372.48,-181.92 8348,-161.74 8329.57,-146.55 5023.37,-146.49 4814.6,-142.85"/>
<polygon fill="black" stroke="black" points="4814.63,-139.35 4804.53,-142.54 4814.41,-146.34 4814.63,-139.35"/>
<text text-anchor="middle" x="8389.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu11_stage2 -->
<g id="edge145" class="edge">
<title>gate2&#45;&gt;expert2_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8494.46,-487.52C8476.75,-474.59 8465,-457.18 8465,-433.74 8465,-433.74 8465,-433.74 8465,-231.74 8465,-200.01 8475.48,-181.92 8451,-161.74 8433.23,-147.09 5246.22,-146.43 5041.58,-142.84"/>
<polygon fill="black" stroke="black" points="5041.63,-139.34 5031.53,-142.54 5041.41,-146.34 5041.63,-139.34"/>
<text text-anchor="middle" x="8492.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu11_stage2 -->
<g id="edge146" class="edge">
<title>gate2&#45;&gt;expert3_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8596.79,-487.67C8580.8,-473.35 8568,-455.19 8568,-433.74 8568,-433.74 8568,-433.74 8568,-231.74 8568,-200.01 8578.48,-181.92 8554,-161.74 8519.68,-133.45 5474.08,-148.08 5268.69,-142.98"/>
<polygon fill="black" stroke="black" points="5268.67,-139.47 5258.53,-142.53 5268.37,-146.46 5268.67,-139.47"/>
<text text-anchor="middle" x="8595.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu12_stage2 -->
<g id="edge147" class="edge">
<title>gate2&#45;&gt;expert0_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8660.18,-487.63C8662.87,-397.41 8668.38,-173.12 8657,-161.74 8641.92,-146.66 5694.27,-146.23 5495.78,-142.84"/>
<polygon fill="black" stroke="black" points="5495.63,-139.34 5485.53,-142.53 5495.42,-146.33 5495.63,-139.34"/>
<text text-anchor="middle" x="8690.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu12_stage2 -->
<g id="edge148" class="edge">
<title>gate2&#45;&gt;expert1_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8780.67,-512.46C8830.79,-502.37 8886.85,-484.03 8929,-450.74 8958.03,-427.81 8951.23,-410.19 8969,-377.74 8981.9,-354.19 8975.66,-339.63 8998,-324.74 9045.23,-293.25 9214.04,-339.95 9252,-297.74 9282.61,-263.7 9283.58,-227.88 9252,-194.74 9223.53,-164.86 8920.77,-187.75 8881,-176.74 8867.39,-172.97 8866.68,-165.22 8853,-161.74 8770.51,-140.79 5934.29,-152.99 5722.62,-143.21"/>
<polygon fill="black" stroke="black" points="5722.74,-139.71 5712.53,-142.53 5722.27,-146.69 5722.74,-139.71"/>
<text text-anchor="middle" x="9025.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu12_stage2 -->
<g id="edge149" class="edge">
<title>gate2&#45;&gt;expert2_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8784.52,-516.74C8870.12,-509.12 8974.2,-494.96 9010,-469.74 9040,-448.61 9058.81,-345.59 9089,-324.74 9161.36,-274.77 9227.22,-364.03 9285,-297.74 9315.08,-263.23 9316.39,-228.06 9285,-194.74 9262.03,-170.35 9016.3,-185.63 8984,-176.74 8970.01,-172.89 8969.09,-165.21 8955,-161.74 8875.71,-142.2 6155.53,-152.67 5949.54,-143.2"/>
<polygon fill="black" stroke="black" points="5949.74,-139.71 5939.53,-142.53 5949.27,-146.69 5949.74,-139.71"/>
<text text-anchor="middle" x="9116.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu12_stage2 -->
<g id="edge150" class="edge">
<title>gate2&#45;&gt;expert3_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8788.59,-521.22C8900.27,-515.94 9051.15,-502.74 9101,-469.74 9163.1,-428.63 9124.36,-367.98 9185,-324.74 9235.88,-288.45 9283.28,-345.99 9323,-297.74 9352.1,-262.4 9354.11,-228.32 9323,-194.74 9305.13,-175.45 9112.54,-183 9087,-176.74 9070.56,-172.71 9068.57,-165.19 9052,-161.74 8898.1,-129.65 6416.66,-160.75 6176.5,-143.42"/>
<polygon fill="black" stroke="black" points="6176.8,-139.93 6166.53,-142.53 6176.18,-146.91 6176.8,-139.93"/>
<text text-anchor="middle" x="9212.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu13_stage2 -->
<g id="edge151" class="edge">
<title>gate2&#45;&gt;expert0_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8791.37,-524.33C8927.23,-521.61 9127.58,-510.49 9192,-469.74 9255.71,-429.44 9221.08,-371.76 9280,-324.74 9309.66,-301.07 9338.81,-328.52 9361,-297.74 9387.77,-260.6 9391.63,-228.76 9361,-194.74 9335.43,-166.34 9227.63,-183.39 9190,-176.74 9162.93,-171.96 9157.27,-165.19 9130,-161.74 8832.47,-124.12 6747.46,-176.9 6403.65,-143.59"/>
<polygon fill="black" stroke="black" points="6403.84,-140.09 6393.53,-142.53 6403.11,-147.06 6403.84,-140.09"/>
<text text-anchor="middle" x="9307.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu13_stage2 -->
<g id="edge152" class="edge">
<title>gate2&#45;&gt;expert1_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8787.17,-519.69C8957.6,-512.03 9242.19,-495.57 9283,-469.74 9346.12,-429.79 9320.32,-382.25 9368,-324.74 9379.66,-310.67 9391.43,-314.37 9399,-297.74 9417.96,-256.08 9428.54,-229.71 9399,-194.74 9383.58,-176.49 9316.41,-181.51 9293,-176.74 9264.8,-170.99 9258.57,-165.2 9230,-161.74 8946.27,-127.43 6960.37,-175.41 6630.68,-143.59"/>
<polygon fill="black" stroke="black" points="6630.84,-140.09 6620.53,-142.53 6630.11,-147.05 6630.84,-140.09"/>
<text text-anchor="middle" x="9395.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu13_stage2 -->
<g id="edge153" class="edge">
<title>gate2&#45;&gt;expert2_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8789.16,-521.67C8982.23,-516.07 9326.9,-501.71 9374,-469.74 9425.87,-434.53 9473.81,-245.49 9437,-194.74 9430.07,-185.18 9347.65,-163.64 9336,-161.74 9067.19,-117.94 7173.89,-173.7 6857.69,-143.59"/>
<polygon fill="black" stroke="black" points="6857.84,-140.08 6847.53,-142.53 6857.11,-147.05 6857.84,-140.08"/>
<text text-anchor="middle" x="9468.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu13_stage2 -->
<g id="edge154" class="edge">
<title>gate2&#45;&gt;expert3_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8790.38,-522.9C9004.52,-518.84 9410.52,-506.38 9465,-469.74 9566.49,-401.49 9541.82,-297.17 9475,-194.74 9462.22,-175.15 9456.03,-169.6 9434,-161.74 9374.11,-140.37 7262.5,-150.59 7084.54,-143.16"/>
<polygon fill="black" stroke="black" points="7084.73,-139.66 7074.53,-142.53 7084.29,-146.65 7084.73,-139.66"/>
<text text-anchor="middle" x="9560.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu14_stage2 -->
<g id="edge155" class="edge">
<title>gate2&#45;&gt;expert0_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8789.41,-522.15C9085.48,-515.8 9786.18,-497.88 9829,-469.74 9943.55,-394.46 9949.64,-250.28 9845,-161.74 9826.04,-145.7 8142.47,-146.6 7992.64,-142.94"/>
<polygon fill="black" stroke="black" points="7992.67,-139.43 7982.53,-142.52 7992.37,-146.43 7992.67,-139.43"/>
<text text-anchor="middle" x="9945.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu14_stage2 -->
<g id="edge156" class="edge">
<title>gate2&#45;&gt;expert1_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8791.13,-523.9C9025.21,-521.36 9494.04,-511.1 9556,-469.74 9670.05,-393.61 9650.78,-239.73 9538,-161.74 9513.37,-144.71 7477.37,-147.08 7311.66,-142.95"/>
<polygon fill="black" stroke="black" points="7311.67,-139.45 7301.53,-142.52 7311.37,-146.44 7311.67,-139.45"/>
<text text-anchor="middle" x="9659.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu14_stage2 -->
<g id="edge157" class="edge">
<title>gate2&#45;&gt;expert2_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8792.08,-524.73C9045.3,-523.65 9577.52,-515.83 9647,-469.74 9761.08,-394.06 9752.51,-243.9 9643,-161.74 9620.39,-144.78 7701.11,-146.91 7538.88,-142.95"/>
<polygon fill="black" stroke="black" points="7538.66,-139.44 7528.53,-142.52 7538.37,-146.43 7538.66,-139.44"/>
<text text-anchor="middle" x="9755.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu14_stage2 -->
<g id="edge158" class="edge">
<title>gate2&#45;&gt;expert3_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8792.49,-525.43C9063.88,-525.76 9660.93,-520.61 9738,-469.74 9852.26,-394.33 9849.58,-246.4 9742,-161.74 9721.16,-145.34 7921.86,-146.76 7765.77,-142.94"/>
<polygon fill="black" stroke="black" points="7765.66,-139.44 7755.53,-142.52 7765.37,-146.43 7765.66,-139.44"/>
<text text-anchor="middle" x="9850.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert0_gpu15_stage2 -->
<g id="edge159" class="edge">
<title>gate2&#45;&gt;expert0_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8792.14,-525.27C9071.23,-525.35 9709.13,-519.83 9920,-469.74 9957.93,-460.73 10000,-472.73 10000,-433.74 10000,-433.74 10000,-433.74 10000,-231.74 10000,-192.98 9982.53,-179.33 9948,-161.74 9906.58,-140.64 8370.66,-148.69 8219.88,-143.12"/>
<polygon fill="black" stroke="black" points="8219.72,-139.6 8209.53,-142.51 8219.31,-146.59 8219.72,-139.6"/>
<text text-anchor="middle" x="10027.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert1_gpu15_stage2 -->
<g id="edge160" class="edge">
<title>gate2&#45;&gt;expert1_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8792.11,-525.12C9086.29,-525.03 9783.86,-519.39 10014,-469.74 10055.71,-460.74 10103,-476.41 10103,-433.74 10103,-433.74 10103,-433.74 10103,-231.74 10103,-192.98 10085.53,-179.35 10051,-161.74 10012.6,-142.16 8589.66,-148.42 8446.63,-143.1"/>
<polygon fill="black" stroke="black" points="8446.72,-139.6 8436.53,-142.51 8446.31,-146.59 8446.72,-139.6"/>
<text text-anchor="middle" x="10130.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert2_gpu15_stage2 -->
<g id="edge161" class="edge">
<title>gate2&#45;&gt;expert2_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8792.57,-525.58C9103.21,-526.6 9866.76,-523.35 10117,-469.74 10158.72,-460.8 10206,-476.41 10206,-433.74 10206,-433.74 10206,-433.74 10206,-231.74 10206,-193.25 10189.2,-179.4 10155,-161.74 10119.71,-143.52 8810.96,-148.14 8673.74,-143.1"/>
<polygon fill="black" stroke="black" points="8673.72,-139.59 8663.53,-142.51 8673.31,-146.58 8673.72,-139.59"/>
<text text-anchor="middle" x="10233.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- gate2&#45;&gt;expert3_gpu15_stage2 -->
<g id="edge162" class="edge">
<title>gate2&#45;&gt;expert3_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8791.58,-524.32C9183.44,-522.21 10309,-509.57 10309,-433.74 10309,-433.74 10309,-433.74 10309,-231.74 10309,-192.98 10291.36,-179.66 10257,-161.74 10197.25,-130.58 9236.68,-121.23 8900.83,-118.91"/>
<polygon fill="black" stroke="black" points="8900.62,-115.41 8890.6,-118.84 8900.57,-122.41 8900.62,-115.41"/>
<text text-anchor="middle" x="10336.5" y="-347.54" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- residual2 -->
<g id="node91" class="node">
<title>residual2</title>
<ellipse fill="lightcoral" stroke="black" cx="8810" cy="-432.74" rx="109.68" ry="18"/>
<text text-anchor="middle" x="8810" y="-429.04" font-family="Times,serif" font-size="14.00">Residual Add Layer 2</text>
</g>
<!-- gate2&#45;&gt;residual2 -->
<g id="edge201" class="edge">
<title>gate2&#45;&gt;residual2</title>
<path fill="none" stroke="black" d="M8720.42,-487.73C8738.44,-476.87 8757.57,-465.34 8773.5,-455.74"/>
<polygon fill="black" stroke="black" points="8775.72,-458.48 8782.48,-450.33 8772.11,-452.49 8775.72,-458.48"/>
</g>
<!-- gate3 -->
<g id="node85" class="node">
<title>gate3</title>
<polygon fill="orange" stroke="black" points="9242.91,-270.74 8975.8,-270.74 8907.09,-194.74 9174.2,-194.74 9242.91,-270.74"/>
<text text-anchor="middle" x="9075" y="-236.54" font-family="Times,serif" font-size="14.00">Gating Layer 3</text>
<text text-anchor="middle" x="9075" y="-221.54" font-family="Times,serif" font-size="14.00">Select top&#45;K experts</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu8_stage2 -->
<g id="edge163" class="edge">
<title>gate3&#45;&gt;expert0_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.11,-195.21C8905.74,-195.05 8904.37,-194.89 8903,-194.74 8701.46,-172.3 7277.89,-210.89 7078,-176.74 7057.63,-173.26 7054.38,-165.15 7034,-161.74 6894.45,-138.36 2151.63,-159.25 1863.61,-143.43"/>
<polygon fill="black" stroke="black" points="1863.76,-139.93 1853.52,-142.67 1863.23,-146.91 1863.76,-139.93"/>
<text text-anchor="middle" x="7105.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu8_stage2 -->
<g id="edge164" class="edge">
<title>gate3&#45;&gt;expert1_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.27C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8712.84,-173.51 7369.6,-209.02 7181,-176.74 7160.64,-173.25 7157.38,-165.16 7137,-161.74 7000.87,-138.92 2376.28,-158.87 2090.8,-143.43"/>
<polygon fill="black" stroke="black" points="2090.75,-139.92 2080.52,-142.67 2090.24,-146.9 2090.75,-139.92"/>
<text text-anchor="middle" x="7208.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu8_stage2 -->
<g id="edge165" class="edge">
<title>gate3&#45;&gt;expert2_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.27C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8724.22,-174.72 7461.31,-207.15 7284,-176.74 7263.64,-173.25 7260.38,-165.16 7240,-161.74 7107.21,-139.48 2596.22,-158.52 2317.56,-143.42"/>
<polygon fill="black" stroke="black" points="2317.75,-139.92 2307.52,-142.67 2317.24,-146.9 2317.75,-139.92"/>
<text text-anchor="middle" x="7311.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu8_stage2 -->
<g id="edge166" class="edge">
<title>gate3&#45;&gt;expert3_gpu8_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.27C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8735.6,-175.93 7553.02,-205.28 7387,-176.74 7366.64,-173.24 7363.38,-165.16 7343,-161.74 7082.83,-118.11 2899.29,-172.57 2544.71,-143.64"/>
<polygon fill="black" stroke="black" points="2544.81,-140.14 2534.52,-142.67 2544.15,-147.1 2544.81,-140.14"/>
<text text-anchor="middle" x="7414.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu9_stage2 -->
<g id="edge167" class="edge">
<title>gate3&#45;&gt;expert0_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.28C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8746.98,-177.14 7644.73,-203.4 7490,-176.74 7469.64,-173.23 7466.38,-165.16 7446,-161.74 7192.61,-119.24 3119.1,-171.83 2771.71,-143.64"/>
<polygon fill="black" stroke="black" points="2771.81,-140.13 2761.52,-142.67 2771.15,-147.1 2771.81,-140.13"/>
<text text-anchor="middle" x="7517.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu9_stage2 -->
<g id="edge168" class="edge">
<title>gate3&#45;&gt;expert1_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.28C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8758.36,-178.35 7736.44,-201.53 7593,-176.74 7572.64,-173.22 7569.38,-165.16 7549,-161.74 7302.4,-120.36 3338.8,-171.08 2998.7,-143.63"/>
<polygon fill="black" stroke="black" points="2998.81,-140.13 2988.52,-142.67 2998.15,-147.1 2998.81,-140.13"/>
<text text-anchor="middle" x="7620.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu9_stage2 -->
<g id="edge169" class="edge">
<title>gate3&#45;&gt;expert2_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.28C8906.04,-195.09 8904.52,-194.91 8903,-194.74 8769.74,-179.56 7828.15,-199.66 7696,-176.74 7675.64,-173.21 7672.38,-165.16 7652,-161.74 7412.29,-121.5 3561.24,-170.08 3225.96,-143.52"/>
<polygon fill="black" stroke="black" points="3225.81,-139.99 3215.53,-142.54 3225.16,-146.96 3225.81,-139.99"/>
<text text-anchor="middle" x="7723.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu9_stage2 -->
<g id="edge170" class="edge">
<title>gate3&#45;&gt;expert3_gpu9_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.28C8906.04,-195.1 8904.52,-194.91 8903,-194.74 8659.23,-166.81 8040.73,-218.84 7799,-176.74 7778.65,-173.2 7775.38,-165.16 7755,-161.74 7522.01,-122.62 3778.82,-169.37 3452.68,-143.49"/>
<polygon fill="black" stroke="black" points="3452.81,-139.99 3442.53,-142.54 3452.16,-146.96 3452.81,-139.99"/>
<text text-anchor="middle" x="7826.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu10_stage2 -->
<g id="edge171" class="edge">
<title>gate3&#45;&gt;expert0_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.29C8906.04,-195.1 8904.52,-194.92 8903,-194.74 8681.99,-169.23 8121.15,-215.1 7902,-176.74 7881.65,-173.18 7878.38,-165.16 7858,-161.74 7631.83,-123.75 3999.99,-168.61 3679.86,-143.5"/>
<polygon fill="black" stroke="black" points="3679.81,-139.98 3669.53,-142.54 3679.16,-146.95 3679.81,-139.98"/>
<text text-anchor="middle" x="7929.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu10_stage2 -->
<g id="edge172" class="edge">
<title>gate3&#45;&gt;expert1_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.29C8906.04,-195.1 8904.52,-194.92 8903,-194.74 8704.74,-171.65 8201.57,-211.35 8005,-176.74 7984.65,-173.16 7981.37,-165.16 7961,-161.74 7741.55,-124.86 4217.47,-167.9 3906.57,-143.48"/>
<polygon fill="black" stroke="black" points="3906.81,-139.98 3896.53,-142.54 3906.16,-146.95 3906.81,-139.98"/>
<text text-anchor="middle" x="8032.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu10_stage2 -->
<g id="edge173" class="edge">
<title>gate3&#45;&gt;expert2_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.3C8906.04,-195.1 8904.52,-194.92 8903,-194.74 8727.5,-174.07 8281.99,-207.61 8108,-176.74 8087.66,-173.13 8084.37,-165.17 8064,-161.74 7851.37,-125.99 4438.32,-167.15 4133.72,-143.48"/>
<polygon fill="black" stroke="black" points="4133.81,-139.98 4123.53,-142.54 4133.16,-146.95 4133.81,-139.98"/>
<text text-anchor="middle" x="8135.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu10_stage2 -->
<g id="edge174" class="edge">
<title>gate3&#45;&gt;expert3_gpu10_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.3C8906.04,-195.11 8904.52,-194.92 8903,-194.74 8750.26,-176.49 8362.42,-203.87 8211,-176.74 8190.66,-173.1 8187.37,-165.17 8167,-161.74 7961.18,-127.12 4658.95,-166.4 4360.85,-143.49"/>
<polygon fill="black" stroke="black" points="4360.81,-139.97 4350.53,-142.54 4360.16,-146.94 4360.81,-139.97"/>
<text text-anchor="middle" x="8238.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu11_stage2 -->
<g id="edge175" class="edge">
<title>gate3&#45;&gt;expert0_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.57,-195.31C8906.04,-195.12 8904.52,-194.92 8903,-194.74 8773.01,-178.91 8442.84,-200.13 8314,-176.74 8293.67,-173.05 8290.37,-165.17 8270,-161.74 8070.88,-128.23 4876.22,-165.69 4587.53,-143.46"/>
<polygon fill="black" stroke="black" points="4587.81,-139.97 4577.53,-142.54 4587.16,-146.94 4587.81,-139.97"/>
<text text-anchor="middle" x="8341.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu11_stage2 -->
<g id="edge176" class="edge">
<title>gate3&#45;&gt;expert1_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.56,-195.33C8906.04,-195.13 8904.52,-194.93 8903,-194.74 8688.52,-167.91 8629.55,-216.03 8417,-176.74 8396.68,-172.98 8393.37,-165.17 8373,-161.74 8180.69,-129.36 5096.53,-164.95 4814.62,-143.46"/>
<polygon fill="black" stroke="black" points="4814.8,-139.97 4804.53,-142.54 4814.16,-146.94 4814.8,-139.97"/>
<text text-anchor="middle" x="8444.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu11_stage2 -->
<g id="edge177" class="edge">
<title>gate3&#45;&gt;expert2_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.56,-195.35C8906.04,-195.14 8904.51,-194.94 8903,-194.74 8734.02,-172.75 8687.42,-208.55 8520,-176.74 8499.7,-172.88 8496.37,-165.17 8476,-161.74 8290.48,-130.49 5316.63,-164.21 5041.69,-143.46"/>
<polygon fill="black" stroke="black" points="5041.8,-139.96 5031.53,-142.54 5041.17,-146.93 5041.8,-139.96"/>
<text text-anchor="middle" x="8547.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu11_stage2 -->
<g id="edge178" class="edge">
<title>gate3&#45;&gt;expert3_gpu11_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.56,-195.39C8906.03,-195.17 8904.51,-194.95 8903,-194.74 8780.81,-177.72 8747.22,-199.67 8626,-176.74 8604.45,-172.67 8600.66,-165.17 8579,-161.74 8399.98,-133.37 5536.51,-163.53 5268.73,-143.46"/>
<polygon fill="black" stroke="black" points="5268.8,-139.96 5258.53,-142.53 5268.17,-146.93 5268.8,-139.96"/>
<text text-anchor="middle" x="8653.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu12_stage2 -->
<g id="edge179" class="edge">
<title>gate3&#45;&gt;expert0_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.55,-195.45C8906.03,-195.21 8904.51,-194.97 8903,-194.74 8818.29,-181.7 8792.66,-202.75 8711,-176.74 8698.29,-172.69 8697.88,-165.23 8685,-161.74 8601.31,-139.08 5711.31,-153.09 5495.8,-143.22"/>
<polygon fill="black" stroke="black" points="5495.74,-139.71 5485.53,-142.53 5495.27,-146.69 5495.74,-139.71"/>
<text text-anchor="middle" x="8738.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu12_stage2 -->
<g id="edge180" class="edge">
<title>gate3&#45;&gt;expert1_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8907.52,-195.62C8906.01,-195.32 8904.5,-195.03 8903,-194.74 8856.51,-185.76 8842.78,-192.12 8798,-176.74 8784.65,-172.15 8783.68,-165.22 8770,-161.74 8689.74,-141.34 5931.42,-152.76 5722.68,-143.21"/>
<polygon fill="black" stroke="black" points="5722.74,-139.7 5712.53,-142.53 5722.27,-146.69 5722.74,-139.7"/>
<text text-anchor="middle" x="8825.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu12_stage2 -->
<g id="edge181" class="edge">
<title>gate3&#45;&gt;expert2_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8957.57,-194.68C8904.66,-178.02 8853.53,-161.98 8852,-161.74 8695.22,-137.21 6191.87,-161.15 5949.59,-143.44"/>
<polygon fill="black" stroke="black" points="5949.8,-139.94 5939.53,-142.53 5949.17,-146.91 5949.8,-139.94"/>
<text text-anchor="middle" x="8923.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu12_stage2 -->
<g id="edge182" class="edge">
<title>gate3&#45;&gt;expert3_gpu12_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9026.63,-194.59C9006.78,-181.54 8982.88,-168.47 8959,-161.74 8886.34,-141.26 6374.77,-151.95 6176.72,-143.19"/>
<polygon fill="black" stroke="black" points="6176.73,-139.69 6166.53,-142.53 6176.28,-146.67 6176.73,-139.69"/>
<text text-anchor="middle" x="9020.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu13_stage2 -->
<g id="edge183" class="edge">
<title>gate3&#45;&gt;expert0_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9077,-194.64C9075.62,-182.34 9071.57,-169.75 9062,-161.74 9034.5,-138.72 6587.02,-147.38 6403.74,-142.96"/>
<polygon fill="black" stroke="black" points="6403.67,-139.45 6393.53,-142.53 6403.37,-146.45 6403.67,-139.45"/>
<text text-anchor="middle" x="9098.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu13_stage2 -->
<g id="edge184" class="edge">
<title>gate3&#45;&gt;expert1_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9159.06,-194.65C9171.31,-184.58 9176.44,-173.26 9165,-161.74 9140.92,-137.49 6807.91,-147.12 6630.57,-142.94"/>
<polygon fill="black" stroke="black" points="6630.66,-139.45 6620.53,-142.53 6630.37,-146.44 6630.66,-139.45"/>
<text text-anchor="middle" x="9198.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu13_stage2 -->
<g id="edge185" class="edge">
<title>gate3&#45;&gt;expert2_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9197.91,-220.64C9253.19,-211.14 9299.7,-193.68 9268,-161.74 9245.12,-138.69 7030.67,-146.99 6857.64,-142.94"/>
<polygon fill="black" stroke="black" points="6857.66,-139.44 6847.53,-142.53 6857.37,-146.44 6857.66,-139.44"/>
<text text-anchor="middle" x="9304.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu13_stage2 -->
<g id="edge186" class="edge">
<title>gate3&#45;&gt;expert3_gpu13_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9197.71,-220.36C9291.05,-209.31 9399.08,-190.04 9371,-161.74 9349.33,-139.9 7252.97,-146.87 7084.66,-142.94"/>
<polygon fill="black" stroke="black" points="7084.66,-139.44 7074.53,-142.52 7084.38,-146.43 7084.66,-139.44"/>
<text text-anchor="middle" x="9402.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu14_stage2 -->
<g id="edge187" class="edge">
<title>gate3&#45;&gt;expert0_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9207.13,-230.95C9401.25,-228.4 9744.8,-218.03 9783,-176.74 9787.53,-171.85 9787.69,-166.48 9783,-161.74 9766.13,-144.7 8140.83,-146.44 7992.79,-142.93"/>
<polygon fill="black" stroke="black" points="7992.66,-139.43 7982.53,-142.52 7992.38,-146.42 7992.66,-139.43"/>
<text text-anchor="middle" x="9813.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu14_stage2 -->
<g id="edge188" class="edge">
<title>gate3&#45;&gt;expert1_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9203.81,-227.22C9335.4,-220.29 9515.07,-203.16 9474,-161.74 9453.53,-141.1 7474.8,-146.76 7311.65,-142.94"/>
<polygon fill="black" stroke="black" points="7311.66,-139.43 7301.53,-142.52 7311.38,-146.43 7311.66,-139.43"/>
<text text-anchor="middle" x="9506.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu14_stage2 -->
<g id="edge189" class="edge">
<title>gate3&#45;&gt;expert2_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9207.76,-231.61C9374.16,-229.18 9631.47,-216.7 9577,-161.74 9557.72,-142.29 7696.17,-146.65 7538.59,-142.93"/>
<polygon fill="black" stroke="black" points="7538.66,-139.43 7528.53,-142.52 7538.38,-146.43 7538.66,-139.43"/>
<text text-anchor="middle" x="9611.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu14_stage2 -->
<g id="edge190" class="edge">
<title>gate3&#45;&gt;expert3_gpu14_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9205.44,-229.04C9373.71,-224.19 9648.66,-211.06 9680,-176.74 9684.5,-171.82 9684.69,-166.48 9680,-161.74 9661.94,-143.51 7920.61,-146.54 7765.95,-142.94"/>
<polygon fill="black" stroke="black" points="7765.66,-139.42 7755.53,-142.52 7765.38,-146.42 7765.66,-139.42"/>
<text text-anchor="middle" x="9710.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert0_gpu15_stage2 -->
<g id="edge191" class="edge">
<title>gate3&#45;&gt;expert0_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9208.42,-232.42C9426.78,-232.11 9840.83,-225.07 9886,-176.74 9890.55,-171.87 9890.69,-166.48 9886,-161.74 9870.32,-145.89 8360.59,-146.35 8219.57,-142.93"/>
<polygon fill="black" stroke="black" points="8219.66,-139.43 8209.53,-142.51 8219.38,-146.42 8219.66,-139.43"/>
<text text-anchor="middle" x="9916.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert1_gpu15_stage2 -->
<g id="edge192" class="edge">
<title>gate3&#45;&gt;expert1_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9205.21,-228.56C9451.31,-221.92 9962.57,-204.81 9989,-176.74 9993.57,-171.89 9993.69,-166.48 9989,-161.74 9974.52,-147.09 8582.72,-146.26 8446.71,-142.93"/>
<polygon fill="black" stroke="black" points="8446.67,-139.42 8436.53,-142.51 8446.38,-146.42 8446.67,-139.42"/>
<text text-anchor="middle" x="10019.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert2_gpu15_stage2 -->
<g id="edge193" class="edge">
<title>gate3&#45;&gt;expert2_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9208.09,-232.2C9497.65,-232.02 10154.21,-224.75 10092,-161.74 10065.3,-134.7 8808.14,-147.32 8673.78,-143.06"/>
<polygon fill="black" stroke="black" points="8673.7,-139.55 8663.53,-142.5 8673.33,-146.54 8673.7,-139.55"/>
<text text-anchor="middle" x="10123.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- gate3&#45;&gt;expert3_gpu15_stage2 -->
<g id="edge194" class="edge">
<title>gate3&#45;&gt;expert3_gpu15_stage2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9206.16,-230.08C9494.64,-225.77 10161.39,-212.04 10195,-176.74 10199.6,-171.91 10199.64,-166.53 10195,-161.74 10172.57,-138.6 9232.66,-124.09 8900.67,-119.67"/>
<polygon fill="black" stroke="black" points="8900.6,-116.17 8890.55,-119.54 8900.5,-123.17 8900.6,-116.17"/>
<text text-anchor="middle" x="10225.5" y="-165.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<!-- residual3 -->
<g id="node93" class="node">
<title>residual3</title>
<ellipse fill="lightcoral" stroke="black" cx="10334" cy="-117.24" rx="109.68" ry="18"/>
<text text-anchor="middle" x="10334" y="-113.54" font-family="Times,serif" font-size="14.00">Residual Add Layer 3</text>
</g>
<!-- gate3&#45;&gt;residual3 -->
<g id="edge204" class="edge">
<title>gate3&#45;&gt;residual3</title>
<path fill="none" stroke="black" d="M9206.34,-230.02C9493.74,-225.63 10160.48,-211.77 10257,-176.74 10277.24,-169.4 10296.53,-154.73 10310.73,-141.92"/>
<polygon fill="black" stroke="black" points="10313.16,-144.44 10318.08,-135.05 10308.38,-139.32 10313.16,-144.44"/>
</g>
<!-- mha0&#45;&gt;gate0 -->
<g id="edge66" class="edge">
<title>mha0&#45;&gt;gate0</title>
<path fill="none" stroke="black" d="M7016,-1291.36C7016,-1283.24 7016,-1273.99 7016,-1264.85"/>
<polygon fill="black" stroke="black" points="7019.5,-1264.65 7016,-1254.65 7012.5,-1264.65 7019.5,-1264.65"/>
</g>
<!-- mha1 -->
<g id="node88" class="node">
<title>mha1</title>
<polygon fill="lightcyan" stroke="black" points="7316.5,-1068.48 7089.5,-1068.48 7089.5,-1015.48 7316.5,-1015.48 7316.5,-1068.48"/>
<text text-anchor="middle" x="7203" y="-1053.28" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention Layer 1</text>
<text text-anchor="middle" x="7203" y="-1038.28" font-family="Times,serif" font-size="14.00">[16 heads, 512 dim/head]</text>
<text text-anchor="middle" x="7203" y="-1023.28" font-family="Times,serif" font-size="14.00">TP=8</text>
</g>
<!-- residual0&#45;&gt;mha1 -->
<g id="edge196" class="edge">
<title>residual0&#45;&gt;mha1</title>
<path fill="none" stroke="black" d="M7183.42,-1105.23C7185.92,-1097.3 7188.97,-1087.59 7191.92,-1078.21"/>
<polygon fill="black" stroke="black" points="7195.26,-1079.25 7194.93,-1068.66 7188.59,-1077.15 7195.26,-1079.25"/>
</g>
<!-- mha1&#45;&gt;gate1 -->
<g id="edge197" class="edge">
<title>mha1&#45;&gt;gate1</title>
<path fill="none" stroke="black" d="M7256.55,-1015.41C7286.94,-1000.9 7325.71,-982.39 7360.33,-965.86"/>
<polygon fill="black" stroke="black" points="7361.98,-968.95 7369.5,-961.48 7358.97,-962.63 7361.98,-968.95"/>
</g>
<!-- mha2 -->
<g id="node90" class="node">
<title>mha2</title>
<polygon fill="lightcyan" stroke="black" points="8772.5,-653.74 8545.5,-653.74 8545.5,-600.74 8772.5,-600.74 8772.5,-653.74"/>
<text text-anchor="middle" x="8659" y="-638.54" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention Layer 2</text>
<text text-anchor="middle" x="8659" y="-623.54" font-family="Times,serif" font-size="14.00">[16 heads, 512 dim/head]</text>
<text text-anchor="middle" x="8659" y="-608.54" font-family="Times,serif" font-size="14.00">TP=8</text>
</g>
<!-- residual1&#45;&gt;mha2 -->
<g id="edge199" class="edge">
<title>residual1&#45;&gt;mha2</title>
<path fill="none" stroke="black" d="M8684.27,-789.81C8677.86,-777.58 8669.94,-760.53 8666,-744.48 8659.52,-718.09 8657.92,-687.37 8657.85,-664.14"/>
<polygon fill="black" stroke="black" points="8661.35,-664.06 8657.92,-654.03 8654.35,-664.01 8661.35,-664.06"/>
</g>
<!-- comm_stage1_to_2 -->
<g id="node94" class="node">
<title>comm_stage1_to_2</title>
<ellipse fill="yellow" stroke="black" cx="8810" cy="-717.61" rx="135.11" ry="26.74"/>
<text text-anchor="middle" x="8810" y="-721.41" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="8810" y="-706.41" font-family="Times,serif" font-size="14.00">Stage 1  Stage 2</text>
</g>
<!-- residual1&#45;&gt;comm_stage1_to_2 -->
<g id="edge205" class="edge">
<title>residual1&#45;&gt;comm_stage1_to_2</title>
<path fill="none" stroke="black" d="M8716.09,-790.15C8731.03,-778.77 8751.2,-763.41 8769.02,-749.83"/>
<polygon fill="black" stroke="black" points="8771.18,-752.58 8777.01,-743.74 8766.94,-747.01 8771.18,-752.58"/>
</g>
<!-- mha2&#45;&gt;gate2 -->
<g id="edge200" class="edge">
<title>mha2&#45;&gt;gate2</title>
<path fill="none" stroke="black" d="M8659,-600.62C8659,-592.5 8659,-583.25 8659,-574.11"/>
<polygon fill="black" stroke="black" points="8662.5,-573.91 8659,-563.91 8655.5,-573.91 8662.5,-573.91"/>
</g>
<!-- mha3 -->
<g id="node92" class="node">
<title>mha3</title>
<polygon fill="lightcyan" stroke="black" points="8959.5,-377.74 8732.5,-377.74 8732.5,-324.74 8959.5,-324.74 8959.5,-377.74"/>
<text text-anchor="middle" x="8846" y="-362.54" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention Layer 3</text>
<text text-anchor="middle" x="8846" y="-347.54" font-family="Times,serif" font-size="14.00">[16 heads, 512 dim/head]</text>
<text text-anchor="middle" x="8846" y="-332.54" font-family="Times,serif" font-size="14.00">TP=8</text>
</g>
<!-- residual2&#45;&gt;mha3 -->
<g id="edge202" class="edge">
<title>residual2&#45;&gt;mha3</title>
<path fill="none" stroke="black" d="M8817.81,-414.49C8821.44,-406.48 8825.89,-396.64 8830.18,-387.18"/>
<polygon fill="black" stroke="black" points="8833.44,-388.47 8834.37,-377.92 8827.06,-385.58 8833.44,-388.47"/>
</g>
<!-- mha3&#45;&gt;gate3 -->
<g id="edge203" class="edge">
<title>mha3&#45;&gt;gate3</title>
<path fill="none" stroke="black" d="M8896.26,-324.67C8924.66,-310.22 8960.86,-291.81 8993.24,-275.33"/>
<polygon fill="black" stroke="black" points="8994.94,-278.4 9002.26,-270.74 8991.76,-272.16 8994.94,-278.4"/>
</g>
<!-- output -->
<g id="node95" class="node">
<title>output</title>
<ellipse fill="lightgray" stroke="black" cx="10334" cy="-26.87" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="10334" y="-30.67" font-family="Times,serif" font-size="14.00">Output Tokens</text>
<text text-anchor="middle" x="10334" y="-15.67" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- residual3&#45;&gt;output -->
<g id="edge207" class="edge">
<title>residual3&#45;&gt;output</title>
<path fill="none" stroke="black" d="M10334,-99.2C10334,-89.27 10334,-76.35 10334,-64.24"/>
<polygon fill="black" stroke="black" points="10337.5,-63.91 10334,-53.91 10330.5,-63.91 10337.5,-63.91"/>
</g>
<!-- comm_stage1_to_2&#45;&gt;mha2 -->
<g id="edge206" class="edge">
<title>comm_stage1_to_2&#45;&gt;mha2</title>
<path fill="none" stroke="black" d="M8767.94,-691.99C8750.46,-681.77 8730,-669.79 8711.55,-658.99"/>
<polygon fill="black" stroke="black" points="8713.08,-655.83 8702.68,-653.8 8709.54,-661.87 8713.08,-655.83"/>
</g>
</g>
</svg>
