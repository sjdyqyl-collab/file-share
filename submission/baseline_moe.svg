<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe Pages: 1 -->
<svg width="18084pt" height="2636pt"
 viewBox="0.00 0.00 18084.00 2635.91" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 2631.91)">
<title>baseline_moe</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2631.91 18080,-2631.91 18080,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_stage0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="5416,-1341.95 5416,-2513.91 18068,-2513.91 18068,-1341.95 5416,-1341.95"/>
<text text-anchor="middle" x="11742" y="-2498.71" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
<text text-anchor="middle" x="11742" y="-2483.71" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="5424,-1349.95 5424,-2467.91 18060,-2467.91 18060,-1349.95 5424,-1349.95"/>
<text text-anchor="middle" x="11742" y="-2452.71" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage1</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="8,-162 8,-1333.95 12660,-1333.95 12660,-162 8,-162"/>
<text text-anchor="middle" x="6334" y="-1318.75" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
<text text-anchor="middle" x="6334" y="-1303.75" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="16,-170 16,-1287.95 12652,-1287.95 12652,-170 16,-170"/>
<text text-anchor="middle" x="6334" y="-1272.75" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightgreen" stroke="black" points="11952.5,-2627.91 11671.73,-2627.91 11599.5,-2521.91 11880.27,-2521.91 11952.5,-2627.91"/>
<text text-anchor="middle" x="11776" y="-2586.21" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="11776" y="-2571.21" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11776" y="-2556.21" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l0_attn_qkv -->
<g id="node2" class="node">
<title>l0_attn_qkv</title>
<polygon fill="lightcoral" stroke="black" points="11815.5,-2436.91 11456.5,-2436.91 11456.5,-2383.91 11815.5,-2383.91 11815.5,-2436.91"/>
<text text-anchor="middle" x="11636" y="-2421.71" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="11636" y="-2406.71" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576]</text>
<text text-anchor="middle" x="11636" y="-2391.71" font-family="Times,serif" font-size="14.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;l0_attn_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_attn_qkv</title>
<path fill="none" stroke="black" d="M11707.63,-2521.5C11707.63,-2521.5 11707.63,-2447.3 11707.63,-2447.3"/>
<polygon fill="black" stroke="black" points="11711.13,-2447.3 11707.63,-2437.3 11704.13,-2447.3 11711.13,-2447.3"/>
</g>
<!-- l0_attn_residual -->
<g id="node6" class="node">
<title>l0_attn_residual</title>
<polygon fill="lightgreen" stroke="black" points="11961.5,-1914.95 11680.73,-1914.95 11608.5,-1808.95 11889.27,-1808.95 11961.5,-1914.95"/>
<text text-anchor="middle" x="11785" y="-1873.25" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="11785" y="-1858.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11785" y="-1843.25" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- input&#45;&gt;l0_attn_residual -->
<g id="edge6" class="edge">
<title>input&#45;&gt;l0_attn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11907.1,-2560.98C11907.1,-2560.98 11907.1,-1924.97 11907.1,-1924.97"/>
<polygon fill="black" stroke="black" points="11910.6,-1924.97 11907.1,-1914.97 11903.6,-1924.97 11910.6,-1924.97"/>
</g>
<!-- l0_attn_split -->
<g id="node3" class="node">
<title>l0_attn_split</title>
<ellipse fill="yellow" stroke="black" cx="11589" cy="-2274.43" rx="272.89" ry="37.45"/>
<text text-anchor="middle" x="11589" y="-2285.73" font-family="Times,serif" font-size="14.00">Split Heads</text>
<text text-anchor="middle" x="11589" y="-2270.73" font-family="Times,serif" font-size="14.00">[1024, seq_len, 24576] &#45;&gt; [1024, 16, seq_len, 1536]</text>
<text text-anchor="middle" x="11589" y="-2255.73" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l0_attn_qkv&#45;&gt;l0_attn_split -->
<g id="edge2" class="edge">
<title>l0_attn_qkv&#45;&gt;l0_attn_split</title>
<path fill="none" stroke="black" d="M11636,-2383.87C11636,-2383.87 11636,-2321.45 11636,-2321.45"/>
<polygon fill="black" stroke="black" points="11639.5,-2321.45 11636,-2311.45 11632.5,-2321.45 11639.5,-2321.45"/>
</g>
<!-- l0_attn_score -->
<g id="node4" class="node">
<title>l0_attn_score</title>
<polygon fill="lightcoral" stroke="black" points="11717.5,-2164.95 11502.5,-2164.95 11502.5,-2111.95 11717.5,-2111.95 11717.5,-2164.95"/>
<text text-anchor="middle" x="11610" y="-2149.75" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="11610" y="-2134.75" font-family="Times,serif" font-size="14.00">[1024, 16, seq_len, seq_len]</text>
<text text-anchor="middle" x="11610" y="-2119.75" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l0_attn_split&#45;&gt;l0_attn_score -->
<g id="edge3" class="edge">
<title>l0_attn_split&#45;&gt;l0_attn_score</title>
<path fill="none" stroke="black" d="M11610,-2236.91C11610,-2236.91 11610,-2175.08 11610,-2175.08"/>
<polygon fill="black" stroke="black" points="11613.5,-2175.08 11610,-2165.08 11606.5,-2175.08 11613.5,-2175.08"/>
</g>
<!-- l0_attn_out -->
<g id="node5" class="node">
<title>l0_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="11840.5,-2039.95 11463.5,-2039.95 11463.5,-1986.95 11840.5,-1986.95 11840.5,-2039.95"/>
<text text-anchor="middle" x="11652" y="-2024.75" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="11652" y="-2009.75" font-family="Times,serif" font-size="14.00">[1024, 16, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11652" y="-1994.75" font-family="Times,serif" font-size="14.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l0_attn_score&#45;&gt;l0_attn_out -->
<g id="edge4" class="edge">
<title>l0_attn_score&#45;&gt;l0_attn_out</title>
<path fill="none" stroke="black" d="M11610,-2111.94C11610,-2111.94 11610,-2050.36 11610,-2050.36"/>
<polygon fill="black" stroke="black" points="11613.5,-2050.36 11610,-2040.36 11606.5,-2050.36 11613.5,-2050.36"/>
</g>
<!-- l0_attn_out&#45;&gt;l0_attn_residual -->
<g id="edge5" class="edge">
<title>l0_attn_out&#45;&gt;l0_attn_residual</title>
<path fill="none" stroke="black" d="M11724.63,-1986.72C11724.63,-1986.72 11724.63,-1925.09 11724.63,-1925.09"/>
<polygon fill="black" stroke="black" points="11728.13,-1925.09 11724.63,-1915.09 11721.13,-1925.09 11728.13,-1925.09"/>
</g>
<!-- l0_gate_0 -->
<g id="node7" class="node">
<title>l0_gate_0</title>
<polygon fill="orange" stroke="black" points="6443.06,-1736.95 6341.16,-1736.95 6314.94,-1660.95 6416.84,-1660.95 6443.06,-1736.95"/>
<text text-anchor="middle" x="6379" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6379" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_0 -->
<g id="edge7" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_0</title>
<path fill="none" stroke="black" d="M11670.53,-1900C10889.74,-1900 6379,-1900 6379,-1900 6379,-1900 6379,-1747.24 6379,-1747.24"/>
<polygon fill="black" stroke="black" points="6382.5,-1747.24 6379,-1737.24 6375.5,-1747.24 6382.5,-1747.24"/>
</g>
<!-- l0_expert_0_0 -->
<g id="node8" class="node">
<title>l0_expert_0_0</title>
<polygon fill="lightblue" stroke="black" points="5782,-1588.95 5432,-1588.95 5432,-1535.95 5782,-1535.95 5782,-1588.95"/>
<text text-anchor="middle" x="5607" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="5607" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5607" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_0_0 -->
<g id="edge9" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_0_0</title>
<path fill="none" stroke="black" d="M11677.09,-1910C10850.04,-1910 5548.67,-1910 5548.67,-1910 5548.67,-1910 5548.67,-1599.15 5548.67,-1599.15"/>
<polygon fill="black" stroke="black" points="5552.17,-1599.15 5548.67,-1589.15 5545.17,-1599.15 5552.17,-1599.15"/>
</g>
<!-- l0_expert_0_1 -->
<g id="node9" class="node">
<title>l0_expert_0_1</title>
<polygon fill="lightblue" stroke="black" points="6168,-1588.95 5818,-1588.95 5818,-1535.95 6168,-1535.95 6168,-1588.95"/>
<text text-anchor="middle" x="5993" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5993" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5993" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_0_1 -->
<g id="edge12" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_0_1</title>
<path fill="none" stroke="black" d="M11673.68,-1905C10865.86,-1905 5934.67,-1905 5934.67,-1905 5934.67,-1905 5934.67,-1599.05 5934.67,-1599.05"/>
<polygon fill="black" stroke="black" points="5938.17,-1599.05 5934.67,-1589.05 5931.17,-1599.05 5938.17,-1599.05"/>
</g>
<!-- l0_expert_0_2 -->
<g id="node10" class="node">
<title>l0_expert_0_2</title>
<polygon fill="lightblue" stroke="black" points="6554,-1588.95 6204,-1588.95 6204,-1535.95 6554,-1535.95 6554,-1588.95"/>
<text text-anchor="middle" x="6379" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="6379" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6379" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_0_2 -->
<g id="edge15" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_0_2</title>
<path fill="none" stroke="black" d="M11666.86,-1895C10886,-1895 6498.64,-1895 6498.64,-1895 6498.64,-1895 6498.64,-1599.1 6498.64,-1599.1"/>
<polygon fill="black" stroke="black" points="6502.14,-1599.1 6498.64,-1589.1 6495.14,-1599.1 6502.14,-1599.1"/>
</g>
<!-- l0_expert_0_3 -->
<g id="node11" class="node">
<title>l0_expert_0_3</title>
<polygon fill="lightblue" stroke="black" points="6940,-1588.95 6590,-1588.95 6590,-1535.95 6940,-1535.95 6940,-1588.95"/>
<text text-anchor="middle" x="6765" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6765" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6765" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_0_3 -->
<g id="edge18" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_0_3</title>
<path fill="none" stroke="black" d="M11663.58,-1890C10902.69,-1890 6823.33,-1890 6823.33,-1890 6823.33,-1890 6823.33,-1598.98 6823.33,-1598.98"/>
<polygon fill="black" stroke="black" points="6826.83,-1598.98 6823.33,-1588.98 6819.83,-1598.98 6826.83,-1598.98"/>
</g>
<!-- l0_mlp_out_0 -->
<g id="node12" class="node">
<title>l0_mlp_out_0</title>
<polygon fill="lightgreen" stroke="black" points="6555.5,-1463.95 6274.73,-1463.95 6202.5,-1357.95 6483.27,-1357.95 6555.5,-1463.95"/>
<text text-anchor="middle" x="6379" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="6379" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6379" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_0 -->
<g id="edge20" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11654.18,-1876C10962.95,-1876 7767.38,-1876 7767.38,-1876 7767.38,-1876 7767.38,-1379 7767.38,-1379 7767.38,-1379 6507.67,-1379 6507.67,-1379"/>
<polygon fill="black" stroke="black" points="6507.67,-1375.5 6497.67,-1379 6507.67,-1382.5 6507.67,-1375.5"/>
</g>
<!-- l0_gate_1 -->
<g id="node13" class="node">
<title>l0_gate_1</title>
<polygon fill="orange" stroke="black" points="8025.06,-1736.95 7923.16,-1736.95 7896.94,-1660.95 7998.84,-1660.95 8025.06,-1736.95"/>
<text text-anchor="middle" x="7961" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="7961" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_1 -->
<g id="edge21" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_1</title>
<path fill="none" stroke="black" d="M11650.59,-1871C10972.67,-1871 7961,-1871 7961,-1871 7961,-1871 7961,-1747.14 7961,-1747.14"/>
<polygon fill="black" stroke="black" points="7964.5,-1747.14 7961,-1737.14 7957.5,-1747.14 7964.5,-1747.14"/>
</g>
<!-- l0_expert_1_0 -->
<g id="node14" class="node">
<title>l0_expert_1_0</title>
<polygon fill="lightblue" stroke="black" points="7364,-1588.95 7014,-1588.95 7014,-1535.95 7364,-1535.95 7364,-1588.95"/>
<text text-anchor="middle" x="7189" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="7189" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7189" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_1_0 -->
<g id="edge23" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_1_0</title>
<path fill="none" stroke="black" d="M11660.81,-1886C10921.36,-1886 7130.67,-1886 7130.67,-1886 7130.67,-1886 7130.67,-1599.21 7130.67,-1599.21"/>
<polygon fill="black" stroke="black" points="7134.17,-1599.21 7130.67,-1589.21 7127.17,-1599.21 7134.17,-1599.21"/>
</g>
<!-- l0_expert_1_1 -->
<g id="node15" class="node">
<title>l0_expert_1_1</title>
<polygon fill="lightblue" stroke="black" points="7750,-1588.95 7400,-1588.95 7400,-1535.95 7750,-1535.95 7750,-1588.95"/>
<text text-anchor="middle" x="7575" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="7575" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7575" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_1_1 -->
<g id="edge26" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_1_1</title>
<path fill="none" stroke="black" d="M11657.55,-1881C10947.99,-1881 7516.67,-1881 7516.67,-1881 7516.67,-1881 7516.67,-1599.06 7516.67,-1599.06"/>
<polygon fill="black" stroke="black" points="7520.17,-1599.06 7516.67,-1589.06 7513.17,-1599.06 7520.17,-1599.06"/>
</g>
<!-- l0_expert_1_2 -->
<g id="node16" class="node">
<title>l0_expert_1_2</title>
<polygon fill="lightblue" stroke="black" points="8136,-1588.95 7786,-1588.95 7786,-1535.95 8136,-1535.95 8136,-1588.95"/>
<text text-anchor="middle" x="7961" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7961" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7961" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_1_2 -->
<g id="edge29" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_1_2</title>
<path fill="none" stroke="black" d="M11647.1,-1866C10975.65,-1866 8080.64,-1866 8080.64,-1866 8080.64,-1866 8080.64,-1599.13 8080.64,-1599.13"/>
<polygon fill="black" stroke="black" points="8084.14,-1599.12 8080.64,-1589.13 8077.14,-1599.13 8084.14,-1599.12"/>
</g>
<!-- l0_expert_1_3 -->
<g id="node17" class="node">
<title>l0_expert_1_3</title>
<polygon fill="lightblue" stroke="black" points="8522,-1588.95 8172,-1588.95 8172,-1535.95 8522,-1535.95 8522,-1588.95"/>
<text text-anchor="middle" x="8347" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="8347" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8347" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_1_3 -->
<g id="edge32" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_1_3</title>
<path fill="none" stroke="black" d="M11643.82,-1861C11003.73,-1861 8405.33,-1861 8405.33,-1861 8405.33,-1861 8405.33,-1599.21 8405.33,-1599.21"/>
<polygon fill="black" stroke="black" points="8408.83,-1599.21 8405.33,-1589.21 8401.83,-1599.21 8408.83,-1599.21"/>
</g>
<!-- l0_mlp_out_1 -->
<g id="node18" class="node">
<title>l0_mlp_out_1</title>
<polygon fill="lightgreen" stroke="black" points="8137.5,-1463.95 7856.73,-1463.95 7784.5,-1357.95 8065.27,-1357.95 8137.5,-1463.95"/>
<text text-anchor="middle" x="7961" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="7961" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7961" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_1 -->
<g id="edge34" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11634.02,-1847C11102.45,-1847 9349.38,-1847 9349.38,-1847 9349.38,-1847 9349.38,-1379 9349.38,-1379 9349.38,-1379 8089.67,-1379 8089.67,-1379"/>
<polygon fill="black" stroke="black" points="8089.67,-1375.5 8079.67,-1379 8089.67,-1382.5 8089.67,-1375.5"/>
</g>
<!-- l0_gate_2 -->
<g id="node19" class="node">
<title>l0_gate_2</title>
<polygon fill="orange" stroke="black" points="9607.06,-1736.95 9505.16,-1736.95 9478.94,-1660.95 9580.84,-1660.95 9607.06,-1736.95"/>
<text text-anchor="middle" x="9543" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="9543" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_2 -->
<g id="edge35" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_2</title>
<path fill="none" stroke="black" d="M11630.9,-1842C11124.37,-1842 9543,-1842 9543,-1842 9543,-1842 9543,-1747.29 9543,-1747.29"/>
<polygon fill="black" stroke="black" points="9546.5,-1747.29 9543,-1737.29 9539.5,-1747.29 9546.5,-1747.29"/>
</g>
<!-- l0_expert_2_0 -->
<g id="node20" class="node">
<title>l0_expert_2_0</title>
<polygon fill="lightblue" stroke="black" points="8946,-1588.95 8596,-1588.95 8596,-1535.95 8946,-1535.95 8946,-1588.95"/>
<text text-anchor="middle" x="8771" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8771" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8771" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_2_0 -->
<g id="edge37" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_2_0</title>
<path fill="none" stroke="black" d="M11641.19,-1857C11034.18,-1857 8712.67,-1857 8712.67,-1857 8712.67,-1857 8712.67,-1599.11 8712.67,-1599.11"/>
<polygon fill="black" stroke="black" points="8716.17,-1599.11 8712.67,-1589.11 8709.17,-1599.11 8716.17,-1599.11"/>
</g>
<!-- l0_expert_2_1 -->
<g id="node21" class="node">
<title>l0_expert_2_1</title>
<polygon fill="lightblue" stroke="black" points="9332,-1588.95 8982,-1588.95 8982,-1535.95 9332,-1535.95 9332,-1588.95"/>
<text text-anchor="middle" x="9157" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="9157" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9157" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_2_1 -->
<g id="edge40" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_2_1</title>
<path fill="none" stroke="black" d="M11637.71,-1852C11075.83,-1852 9098.67,-1852 9098.67,-1852 9098.67,-1852 9098.67,-1599.17 9098.67,-1599.17"/>
<polygon fill="black" stroke="black" points="9102.17,-1599.17 9098.67,-1589.17 9095.17,-1599.17 9102.17,-1599.17"/>
</g>
<!-- l0_expert_2_2 -->
<g id="node22" class="node">
<title>l0_expert_2_2</title>
<polygon fill="lightblue" stroke="black" points="9718,-1588.95 9368,-1588.95 9368,-1535.95 9718,-1535.95 9718,-1588.95"/>
<text text-anchor="middle" x="9543" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="9543" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9543" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_2_2 -->
<g id="edge43" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_2_2</title>
<path fill="none" stroke="black" d="M11627.21,-1837C11135.35,-1837 9662.64,-1837 9662.64,-1837 9662.64,-1837 9662.64,-1599.28 9662.64,-1599.28"/>
<polygon fill="black" stroke="black" points="9666.14,-1599.28 9662.64,-1589.28 9659.14,-1599.28 9666.14,-1599.28"/>
</g>
<!-- l0_expert_2_3 -->
<g id="node23" class="node">
<title>l0_expert_2_3</title>
<polygon fill="lightblue" stroke="black" points="10104,-1588.95 9754,-1588.95 9754,-1535.95 10104,-1535.95 10104,-1588.95"/>
<text text-anchor="middle" x="9929" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9929" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9929" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_2_3 -->
<g id="edge46" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_2_3</title>
<path fill="none" stroke="black" d="M11624.68,-1833C11184.08,-1833 9987.33,-1833 9987.33,-1833 9987.33,-1833 9987.33,-1599.38 9987.33,-1599.38"/>
<polygon fill="black" stroke="black" points="9990.83,-1599.38 9987.33,-1589.38 9983.83,-1599.38 9990.83,-1599.38"/>
</g>
<!-- l0_mlp_out_2 -->
<g id="node24" class="node">
<title>l0_mlp_out_2</title>
<polygon fill="lightgreen" stroke="black" points="9719.5,-1463.95 9438.73,-1463.95 9366.5,-1357.95 9647.27,-1357.95 9719.5,-1463.95"/>
<text text-anchor="middle" x="9543" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="9543" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9543" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_2 -->
<g id="edge48" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11614.56,-1818C11365.5,-1818 10931.38,-1818 10931.38,-1818 10931.38,-1818 10931.38,-1379 10931.38,-1379 10931.38,-1379 9671.67,-1379 9671.67,-1379"/>
<polygon fill="black" stroke="black" points="9671.67,-1375.5 9661.67,-1379 9671.67,-1382.5 9671.67,-1375.5"/>
</g>
<!-- l0_gate_3 -->
<g id="node25" class="node">
<title>l0_gate_3</title>
<polygon fill="orange" stroke="black" points="11189.06,-1736.95 11087.16,-1736.95 11060.94,-1660.95 11162.84,-1660.95 11189.06,-1736.95"/>
<text text-anchor="middle" x="11125" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11125" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_3 -->
<g id="edge49" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_3</title>
<path fill="none" stroke="black" d="M11634.5,-1808.8C11634.5,-1767.43 11634.5,-1717 11634.5,-1717 11634.5,-1717 11192.46,-1717 11192.46,-1717"/>
<polygon fill="black" stroke="black" points="11192.46,-1713.5 11182.46,-1717 11192.46,-1720.5 11192.46,-1713.5"/>
</g>
<!-- l0_expert_3_0 -->
<g id="node26" class="node">
<title>l0_expert_3_0</title>
<polygon fill="lightblue" stroke="black" points="10528,-1588.95 10178,-1588.95 10178,-1535.95 10528,-1535.95 10528,-1588.95"/>
<text text-anchor="middle" x="10353" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10353" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10353" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_3_0 -->
<g id="edge51" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_3_0</title>
<path fill="none" stroke="black" d="M11621.25,-1828C11234.1,-1828 10294.67,-1828 10294.67,-1828 10294.67,-1828 10294.67,-1599.38 10294.67,-1599.38"/>
<polygon fill="black" stroke="black" points="10298.17,-1599.38 10294.67,-1589.38 10291.17,-1599.38 10298.17,-1599.38"/>
</g>
<!-- l0_expert_3_1 -->
<g id="node27" class="node">
<title>l0_expert_3_1</title>
<polygon fill="lightblue" stroke="black" points="10914,-1588.95 10564,-1588.95 10564,-1535.95 10914,-1535.95 10914,-1588.95"/>
<text text-anchor="middle" x="10739" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10739" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10739" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_3_1 -->
<g id="edge54" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_3_1</title>
<path fill="none" stroke="black" d="M11617.88,-1823C11309.16,-1823 10680.67,-1823 10680.67,-1823 10680.67,-1823 10680.67,-1599.36 10680.67,-1599.36"/>
<polygon fill="black" stroke="black" points="10684.17,-1599.36 10680.67,-1589.36 10677.17,-1599.36 10684.17,-1599.36"/>
</g>
<!-- l0_expert_3_2 -->
<g id="node28" class="node">
<title>l0_expert_3_2</title>
<polygon fill="lightblue" stroke="black" points="11300,-1588.95 10950,-1588.95 10950,-1535.95 11300,-1535.95 11300,-1588.95"/>
<text text-anchor="middle" x="11125" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11125" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11125" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_3_2 -->
<g id="edge57" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_3_2</title>
<path fill="none" stroke="black" d="M11611.05,-1813C11453.09,-1813 11244.64,-1813 11244.64,-1813 11244.64,-1813 11244.64,-1599.27 11244.64,-1599.27"/>
<polygon fill="black" stroke="black" points="11248.14,-1599.27 11244.64,-1589.27 11241.14,-1599.27 11248.14,-1599.27"/>
</g>
<!-- l0_expert_3_3 -->
<g id="node29" class="node">
<title>l0_expert_3_3</title>
<polygon fill="lightblue" stroke="black" points="11686,-1588.95 11336,-1588.95 11336,-1535.95 11686,-1535.95 11686,-1588.95"/>
<text text-anchor="middle" x="11511" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11511" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11511" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_3_3 -->
<g id="edge60" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_3_3</title>
<path fill="none" stroke="black" d="M11660.25,-1808.75C11660.25,-1808.75 11660.25,-1599.22 11660.25,-1599.22"/>
<polygon fill="black" stroke="black" points="11663.75,-1599.22 11660.25,-1589.22 11656.75,-1599.22 11663.75,-1599.22"/>
</g>
<!-- l0_mlp_out_3 -->
<g id="node30" class="node">
<title>l0_mlp_out_3</title>
<polygon fill="lightgreen" stroke="black" points="11301.5,-1463.95 11020.73,-1463.95 10948.5,-1357.95 11229.27,-1357.95 11301.5,-1463.95"/>
<text text-anchor="middle" x="11125" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="11125" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11125" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_3 -->
<g id="edge62" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11709.3,-1808.91C11709.3,-1682.71 11709.3,-1375 11709.3,-1375 11709.3,-1375 11251.14,-1375 11251.14,-1375"/>
<polygon fill="black" stroke="black" points="11251.14,-1371.5 11241.14,-1375 11251.14,-1378.5 11251.14,-1371.5"/>
</g>
<!-- l0_gate_4 -->
<g id="node31" class="node">
<title>l0_gate_4</title>
<polygon fill="orange" stroke="black" points="12385.06,-1736.95 12283.16,-1736.95 12256.94,-1660.95 12358.84,-1660.95 12385.06,-1736.95"/>
<text text-anchor="middle" x="12321" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="12321" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_4 -->
<g id="edge63" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_4</title>
<path fill="none" stroke="black" d="M11895.73,-1818C12052.69,-1818 12321,-1818 12321,-1818 12321,-1818 12321,-1747.28 12321,-1747.28"/>
<polygon fill="black" stroke="black" points="12324.5,-1747.28 12321,-1737.28 12317.5,-1747.28 12324.5,-1747.28"/>
</g>
<!-- l0_expert_4_0 -->
<g id="node32" class="node">
<title>l0_expert_4_0</title>
<polygon fill="lightblue" stroke="black" points="12110,-1588.95 11760,-1588.95 11760,-1535.95 12110,-1535.95 12110,-1588.95"/>
<text text-anchor="middle" x="11935" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11935" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11935" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_4_0 -->
<g id="edge65" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_4_0</title>
<path fill="none" stroke="black" d="M11860.62,-1808.75C11860.62,-1808.75 11860.62,-1599.22 11860.62,-1599.22"/>
<polygon fill="black" stroke="black" points="11864.12,-1599.22 11860.62,-1589.22 11857.12,-1599.22 11864.12,-1599.22"/>
</g>
<!-- l0_expert_4_1 -->
<g id="node33" class="node">
<title>l0_expert_4_1</title>
<polygon fill="lightblue" stroke="black" points="12496,-1588.95 12146,-1588.95 12146,-1535.95 12496,-1535.95 12496,-1588.95"/>
<text text-anchor="middle" x="12321" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="12321" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12321" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_4_1 -->
<g id="edge68" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_4_1</title>
<path fill="none" stroke="black" d="M11892.22,-1813C12015.59,-1813 12201.36,-1813 12201.36,-1813 12201.36,-1813 12201.36,-1599.27 12201.36,-1599.27"/>
<polygon fill="black" stroke="black" points="12204.86,-1599.27 12201.36,-1589.27 12197.86,-1599.27 12204.86,-1599.27"/>
</g>
<!-- l0_expert_4_2 -->
<g id="node34" class="node">
<title>l0_expert_4_2</title>
<polygon fill="lightblue" stroke="black" points="12882,-1588.95 12532,-1588.95 12532,-1535.95 12882,-1535.95 12882,-1588.95"/>
<text text-anchor="middle" x="12707" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12707" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12707" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_4_2 -->
<g id="edge71" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_4_2</title>
<path fill="none" stroke="black" d="M11898.41,-1822C12156.47,-1822 12765.33,-1822 12765.33,-1822 12765.33,-1822 12765.33,-1599.25 12765.33,-1599.25"/>
<polygon fill="black" stroke="black" points="12768.83,-1599.25 12765.33,-1589.25 12761.83,-1599.25 12768.83,-1599.25"/>
</g>
<!-- l0_expert_4_3 -->
<g id="node35" class="node">
<title>l0_expert_4_3</title>
<polygon fill="lightblue" stroke="black" points="13268,-1588.95 12918,-1588.95 12918,-1535.95 13268,-1535.95 13268,-1588.95"/>
<text text-anchor="middle" x="13093" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="13093" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13093" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_4_3 -->
<g id="edge74" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_4_3</title>
<path fill="none" stroke="black" d="M11901.79,-1827C12232.46,-1827 13151.33,-1827 13151.33,-1827 13151.33,-1827 13151.33,-1599.28 13151.33,-1599.28"/>
<polygon fill="black" stroke="black" points="13154.83,-1599.28 13151.33,-1589.28 13147.83,-1599.28 13154.83,-1599.28"/>
</g>
<!-- l0_mlp_out_4 -->
<g id="node36" class="node">
<title>l0_mlp_out_4</title>
<polygon fill="lightgreen" stroke="black" points="12883.5,-1463.95 12602.73,-1463.95 12530.5,-1357.95 12811.27,-1357.95 12883.5,-1463.95"/>
<text text-anchor="middle" x="12707" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="12707" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12707" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_4 -->
<g id="edge76" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11746.3,-1808.78C11746.3,-1689.31 11746.3,-1410 11746.3,-1410 11746.3,-1410 12555.76,-1410 12555.76,-1410"/>
<polygon fill="black" stroke="black" points="12555.76,-1413.5 12565.76,-1410 12555.76,-1406.5 12555.76,-1413.5"/>
</g>
<!-- l0_gate_5 -->
<g id="node37" class="node">
<title>l0_gate_5</title>
<polygon fill="orange" stroke="black" points="13967.06,-1736.95 13865.16,-1736.95 13838.94,-1660.95 13940.84,-1660.95 13967.06,-1736.95"/>
<text text-anchor="middle" x="13903" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="13903" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_5 -->
<g id="edge77" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_5</title>
<path fill="none" stroke="black" d="M11911.15,-1841C12367.11,-1841 13903,-1841 13903,-1841 13903,-1841 13903,-1747.02 13903,-1747.02"/>
<polygon fill="black" stroke="black" points="13906.5,-1747.02 13903,-1737.02 13899.5,-1747.02 13906.5,-1747.02"/>
</g>
<!-- l0_expert_5_0 -->
<g id="node38" class="node">
<title>l0_expert_5_0</title>
<polygon fill="lightblue" stroke="black" points="13692,-1588.95 13342,-1588.95 13342,-1535.95 13692,-1535.95 13692,-1588.95"/>
<text text-anchor="middle" x="13517" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="13517" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13517" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_5_0 -->
<g id="edge79" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_5_0</title>
<path fill="none" stroke="black" d="M11904.36,-1831C12287.07,-1831 13458.67,-1831 13458.67,-1831 13458.67,-1831 13458.67,-1599.18 13458.67,-1599.18"/>
<polygon fill="black" stroke="black" points="13462.17,-1599.18 13458.67,-1589.18 13455.17,-1599.18 13462.17,-1599.18"/>
</g>
<!-- l0_expert_5_1 -->
<g id="node39" class="node">
<title>l0_expert_5_1</title>
<polygon fill="lightblue" stroke="black" points="14078,-1588.95 13728,-1588.95 13728,-1535.95 14078,-1535.95 14078,-1588.95"/>
<text text-anchor="middle" x="13903" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="13903" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13903" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_5_1 -->
<g id="edge82" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_5_1</title>
<path fill="none" stroke="black" d="M11907.75,-1836C12342.53,-1836 13783.36,-1836 13783.36,-1836 13783.36,-1836 13783.36,-1599.18 13783.36,-1599.18"/>
<polygon fill="black" stroke="black" points="13786.86,-1599.18 13783.36,-1589.18 13779.86,-1599.18 13786.86,-1599.18"/>
</g>
<!-- l0_expert_5_2 -->
<g id="node40" class="node">
<title>l0_expert_5_2</title>
<polygon fill="lightblue" stroke="black" points="14464,-1588.95 14114,-1588.95 14114,-1535.95 14464,-1535.95 14464,-1588.95"/>
<text text-anchor="middle" x="14289" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="14289" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14289" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_5_2 -->
<g id="edge85" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_5_2</title>
<path fill="none" stroke="black" d="M11917.37,-1850C12442.06,-1850 14347.33,-1850 14347.33,-1850 14347.33,-1850 14347.33,-1598.99 14347.33,-1598.99"/>
<polygon fill="black" stroke="black" points="14350.83,-1598.99 14347.33,-1588.99 14343.83,-1598.99 14350.83,-1598.99"/>
</g>
<!-- l0_expert_5_3 -->
<g id="node41" class="node">
<title>l0_expert_5_3</title>
<polygon fill="lightblue" stroke="black" points="14850,-1588.95 14500,-1588.95 14500,-1535.95 14850,-1535.95 14850,-1588.95"/>
<text text-anchor="middle" x="14675" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="14675" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14675" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_5_3 -->
<g id="edge88" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_5_3</title>
<path fill="none" stroke="black" d="M11920.8,-1855C12499.89,-1855 14733.33,-1855 14733.33,-1855 14733.33,-1855 14733.33,-1599.19 14733.33,-1599.19"/>
<polygon fill="black" stroke="black" points="14736.83,-1599.19 14733.33,-1589.19 14729.83,-1599.19 14736.83,-1599.19"/>
</g>
<!-- l0_mlp_out_5 -->
<g id="node42" class="node">
<title>l0_mlp_out_5</title>
<polygon fill="lightgreen" stroke="black" points="14465.5,-1463.95 14184.73,-1463.95 14112.5,-1357.95 14393.27,-1357.95 14465.5,-1463.95"/>
<text text-anchor="middle" x="14289" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="14289" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14289" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_5 -->
<g id="edge90" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11914.17,-1845C12400.72,-1845 14095.38,-1845 14095.38,-1845 14095.38,-1845 14095.38,-1442 14095.38,-1442 14095.38,-1442 14159.68,-1442 14159.68,-1442"/>
<polygon fill="black" stroke="black" points="14159.68,-1445.5 14169.68,-1442 14159.68,-1438.5 14159.68,-1445.5"/>
</g>
<!-- l0_gate_6 -->
<g id="node43" class="node">
<title>l0_gate_6</title>
<polygon fill="orange" stroke="black" points="15549.06,-1736.95 15447.16,-1736.95 15420.94,-1660.95 15522.84,-1660.95 15549.06,-1736.95"/>
<text text-anchor="middle" x="15485" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="15485" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_6 -->
<g id="edge91" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_6</title>
<path fill="none" stroke="black" d="M11929.76,-1868C12613.33,-1868 15485,-1868 15485,-1868 15485,-1868 15485,-1747.31 15485,-1747.31"/>
<polygon fill="black" stroke="black" points="15488.5,-1747.31 15485,-1737.31 15481.5,-1747.31 15488.5,-1747.31"/>
</g>
<!-- l0_expert_6_0 -->
<g id="node44" class="node">
<title>l0_expert_6_0</title>
<polygon fill="lightblue" stroke="black" points="15274,-1588.95 14924,-1588.95 14924,-1535.95 15274,-1535.95 15274,-1588.95"/>
<text text-anchor="middle" x="15099" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="15099" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15099" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_6_0 -->
<g id="edge93" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_6_0</title>
<path fill="none" stroke="black" d="M11923.59,-1859C12544.57,-1859 15040.67,-1859 15040.67,-1859 15040.67,-1859 15040.67,-1599.03 15040.67,-1599.03"/>
<polygon fill="black" stroke="black" points="15044.17,-1599.03 15040.67,-1589.03 15037.17,-1599.03 15044.17,-1599.03"/>
</g>
<!-- l0_expert_6_1 -->
<g id="node45" class="node">
<title>l0_expert_6_1</title>
<polygon fill="lightblue" stroke="black" points="15660,-1588.95 15310,-1588.95 15310,-1535.95 15660,-1535.95 15660,-1588.95"/>
<text text-anchor="middle" x="15485" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="15485" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15485" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_6_1 -->
<g id="edge96" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_6_1</title>
<path fill="none" stroke="black" d="M11927.01,-1864C12591.93,-1864 15365.36,-1864 15365.36,-1864 15365.36,-1864 15365.36,-1599.21 15365.36,-1599.21"/>
<polygon fill="black" stroke="black" points="15368.86,-1599.21 15365.36,-1589.21 15361.86,-1599.21 15368.86,-1599.21"/>
</g>
<!-- l0_expert_6_2 -->
<g id="node46" class="node">
<title>l0_expert_6_2</title>
<polygon fill="lightblue" stroke="black" points="16046,-1588.95 15696,-1588.95 15696,-1535.95 16046,-1535.95 16046,-1588.95"/>
<text text-anchor="middle" x="15871" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15871" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15871" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_6_2 -->
<g id="edge99" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_6_2</title>
<path fill="none" stroke="black" d="M11936.49,-1878C12682.42,-1878 15929.33,-1878 15929.33,-1878 15929.33,-1878 15929.33,-1599.08 15929.33,-1599.08"/>
<polygon fill="black" stroke="black" points="15932.83,-1599.08 15929.33,-1589.08 15925.83,-1599.08 15932.83,-1599.08"/>
</g>
<!-- l0_expert_6_3 -->
<g id="node47" class="node">
<title>l0_expert_6_3</title>
<polygon fill="lightblue" stroke="black" points="16432,-1588.95 16082,-1588.95 16082,-1535.95 16432,-1535.95 16432,-1588.95"/>
<text text-anchor="middle" x="16257" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="16257" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="16257" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_6_3 -->
<g id="edge102" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_6_3</title>
<path fill="none" stroke="black" d="M11939.31,-1882C12732.64,-1882 16315.33,-1882 16315.33,-1882 16315.33,-1882 16315.33,-1599.15 16315.33,-1599.15"/>
<polygon fill="black" stroke="black" points="16318.83,-1599.15 16315.33,-1589.15 16311.83,-1599.15 16318.83,-1599.15"/>
</g>
<!-- l0_mlp_out_6 -->
<g id="node48" class="node">
<title>l0_mlp_out_6</title>
<polygon fill="lightgreen" stroke="black" points="16047.5,-1463.95 15766.73,-1463.95 15694.5,-1357.95 15975.27,-1357.95 16047.5,-1463.95"/>
<text text-anchor="middle" x="15871" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="15871" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15871" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_6 -->
<g id="edge104" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11933.13,-1873C12644.66,-1873 15677.38,-1873 15677.38,-1873 15677.38,-1873 15677.38,-1442 15677.38,-1442 15677.38,-1442 15741.68,-1442 15741.68,-1442"/>
<polygon fill="black" stroke="black" points="15741.68,-1445.5 15751.68,-1442 15741.68,-1438.5 15741.68,-1445.5"/>
</g>
<!-- l0_gate_7 -->
<g id="node49" class="node">
<title>l0_gate_7</title>
<polygon fill="orange" stroke="black" points="17131.06,-1736.95 17029.16,-1736.95 17002.94,-1660.95 17104.84,-1660.95 17131.06,-1736.95"/>
<text text-anchor="middle" x="17067" y="-1702.75" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="17067" y="-1687.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_gate_7 -->
<g id="edge105" class="edge">
<title>l0_attn_residual&#45;&gt;l0_gate_7</title>
<path fill="none" stroke="black" d="M11948.87,-1896C12840.42,-1896 17067,-1896 17067,-1896 17067,-1896 17067,-1747.41 17067,-1747.41"/>
<polygon fill="black" stroke="black" points="17070.5,-1747.41 17067,-1737.41 17063.5,-1747.41 17070.5,-1747.41"/>
</g>
<!-- l0_expert_7_0 -->
<g id="node50" class="node">
<title>l0_expert_7_0</title>
<polygon fill="lightblue" stroke="black" points="16856,-1588.95 16506,-1588.95 16506,-1535.95 16856,-1535.95 16856,-1588.95"/>
<text text-anchor="middle" x="16681" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="16681" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="16681" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_7_0 -->
<g id="edge107" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_7_0</title>
<path fill="none" stroke="black" d="M11942.52,-1887C12774.84,-1887 16622.67,-1887 16622.67,-1887 16622.67,-1887 16622.67,-1599.01 16622.67,-1599.01"/>
<polygon fill="black" stroke="black" points="16626.17,-1599.01 16622.67,-1589.01 16619.17,-1599.01 16626.17,-1599.01"/>
</g>
<!-- l0_expert_7_1 -->
<g id="node51" class="node">
<title>l0_expert_7_1</title>
<polygon fill="lightblue" stroke="black" points="17242,-1588.95 16892,-1588.95 16892,-1535.95 17242,-1535.95 17242,-1588.95"/>
<text text-anchor="middle" x="17067" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="17067" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="17067" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_7_1 -->
<g id="edge110" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_7_1</title>
<path fill="none" stroke="black" d="M11945.52,-1891C12817.64,-1891 16947.36,-1891 16947.36,-1891 16947.36,-1891 16947.36,-1599.06 16947.36,-1599.06"/>
<polygon fill="black" stroke="black" points="16950.86,-1599.06 16947.36,-1589.06 16943.86,-1599.06 16950.86,-1599.06"/>
</g>
<!-- l0_expert_7_2 -->
<g id="node52" class="node">
<title>l0_expert_7_2</title>
<polygon fill="lightblue" stroke="black" points="17628,-1588.95 17278,-1588.95 17278,-1535.95 17628,-1535.95 17628,-1588.95"/>
<text text-anchor="middle" x="17453" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="17453" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="17453" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_7_2 -->
<g id="edge113" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_7_2</title>
<path fill="none" stroke="black" d="M11954.82,-1905C12904.15,-1905 17511.33,-1905 17511.33,-1905 17511.33,-1905 17511.33,-1599.05 17511.33,-1599.05"/>
<polygon fill="black" stroke="black" points="17514.83,-1599.05 17511.33,-1589.05 17507.83,-1599.05 17514.83,-1599.05"/>
</g>
<!-- l0_expert_7_3 -->
<g id="node53" class="node">
<title>l0_expert_7_3</title>
<polygon fill="lightblue" stroke="black" points="18014,-1588.95 17664,-1588.95 17664,-1535.95 18014,-1535.95 18014,-1588.95"/>
<text text-anchor="middle" x="17839" y="-1573.75" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="17839" y="-1558.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="17839" y="-1543.75" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_expert_7_3 -->
<g id="edge116" class="edge">
<title>l0_attn_residual&#45;&gt;l0_expert_7_3</title>
<path fill="none" stroke="black" d="M11958.49,-1910C12954.13,-1910 17897.33,-1910 17897.33,-1910 17897.33,-1910 17897.33,-1599.15 17897.33,-1599.15"/>
<polygon fill="black" stroke="black" points="17900.83,-1599.15 17897.33,-1589.15 17893.83,-1599.15 17900.83,-1599.15"/>
</g>
<!-- l0_mlp_out_7 -->
<g id="node54" class="node">
<title>l0_mlp_out_7</title>
<polygon fill="lightgreen" stroke="black" points="17629.5,-1463.95 17348.73,-1463.95 17276.5,-1357.95 17557.27,-1357.95 17629.5,-1463.95"/>
<text text-anchor="middle" x="17453" y="-1422.25" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="17453" y="-1407.25" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="17453" y="-1392.25" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- l0_attn_residual&#45;&gt;l0_mlp_out_7 -->
<g id="edge118" class="edge">
<title>l0_attn_residual&#45;&gt;l0_mlp_out_7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11952.2,-1901C12870.48,-1901 17259.38,-1901 17259.38,-1901 17259.38,-1901 17259.38,-1442 17259.38,-1442 17259.38,-1442 17323.68,-1442 17323.68,-1442"/>
<polygon fill="black" stroke="black" points="17323.68,-1445.5 17333.68,-1442 17323.68,-1438.5 17323.68,-1445.5"/>
</g>
<!-- l0_gate_0&#45;&gt;l0_expert_0_0 -->
<g id="edge8" class="edge">
<title>l0_gate_0&#45;&gt;l0_expert_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6332.17,-1711C6173.4,-1711 5665.33,-1711 5665.33,-1711 5665.33,-1711 5665.33,-1599.01 5665.33,-1599.01"/>
<polygon fill="black" stroke="black" points="5668.83,-1599.01 5665.33,-1589.01 5661.83,-1599.01 5668.83,-1599.01"/>
</g>
<!-- l0_gate_0&#45;&gt;l0_expert_0_1 -->
<g id="edge11" class="edge">
<title>l0_gate_0&#45;&gt;l0_expert_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6323.42,-1686C6229.93,-1686 6051.33,-1686 6051.33,-1686 6051.33,-1686 6051.33,-1598.96 6051.33,-1598.96"/>
<polygon fill="black" stroke="black" points="6054.83,-1598.96 6051.33,-1588.96 6047.83,-1598.96 6054.83,-1598.96"/>
</g>
<!-- l0_gate_0&#45;&gt;l0_expert_0_2 -->
<g id="edge14" class="edge">
<title>l0_gate_0&#45;&gt;l0_expert_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6379,-1660.93C6379,-1660.93 6379,-1599.04 6379,-1599.04"/>
<polygon fill="black" stroke="black" points="6382.5,-1599.04 6379,-1589.04 6375.5,-1599.04 6382.5,-1599.04"/>
</g>
<!-- l0_gate_0&#45;&gt;l0_expert_0_3 -->
<g id="edge17" class="edge">
<title>l0_gate_0&#45;&gt;l0_expert_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6423.19,-1679C6512.63,-1679 6706.67,-1679 6706.67,-1679 6706.67,-1679 6706.67,-1599.19 6706.67,-1599.19"/>
<polygon fill="black" stroke="black" points="6710.17,-1599.19 6706.67,-1589.19 6703.17,-1599.19 6710.17,-1599.19"/>
</g>
<!-- l0_expert_0_0&#45;&gt;l0_mlp_out_0 -->
<g id="edge10" class="edge">
<title>l0_expert_0_0&#45;&gt;l0_mlp_out_0</title>
<path fill="none" stroke="black" d="M5712.7,-1535.6C5712.7,-1487.82 5712.7,-1393 5712.7,-1393 5712.7,-1393 6216.14,-1393 6216.14,-1393"/>
<polygon fill="black" stroke="black" points="6216.14,-1396.5 6226.14,-1393 6216.14,-1389.5 6216.14,-1396.5"/>
</g>
<!-- l0_expert_0_1&#45;&gt;l0_mlp_out_0 -->
<g id="edge13" class="edge">
<title>l0_expert_0_1&#45;&gt;l0_mlp_out_0</title>
<path fill="none" stroke="black" d="M6113.75,-1535.89C6113.75,-1496.71 6113.75,-1428 6113.75,-1428 6113.75,-1428 6239.87,-1428 6239.87,-1428"/>
<polygon fill="black" stroke="black" points="6239.87,-1431.5 6249.87,-1428 6239.87,-1424.5 6239.87,-1431.5"/>
</g>
<!-- l0_expert_0_2&#45;&gt;l0_mlp_out_0 -->
<g id="edge16" class="edge">
<title>l0_expert_0_2&#45;&gt;l0_mlp_out_0</title>
<path fill="none" stroke="black" d="M6379,-1535.72C6379,-1535.72 6379,-1474.09 6379,-1474.09"/>
<polygon fill="black" stroke="black" points="6382.5,-1474.09 6379,-1464.09 6375.5,-1474.09 6382.5,-1474.09"/>
</g>
<!-- l0_expert_0_3&#45;&gt;l0_mlp_out_0 -->
<g id="edge19" class="edge">
<title>l0_expert_0_3&#45;&gt;l0_mlp_out_0</title>
<path fill="none" stroke="black" d="M6627.33,-1535.63C6627.33,-1489.49 6627.33,-1400 6627.33,-1400 6627.33,-1400 6522.25,-1400 6522.25,-1400"/>
<polygon fill="black" stroke="black" points="6522.25,-1396.5 6512.25,-1400 6522.25,-1403.5 6522.25,-1396.5"/>
</g>
<!-- l2_attn_qkv -->
<g id="node55" class="node">
<title>l2_attn_qkv</title>
<polygon fill="lightcoral" stroke="black" points="6418.5,-1256.95 6059.5,-1256.95 6059.5,-1203.95 6418.5,-1203.95 6418.5,-1256.95"/>
<text text-anchor="middle" x="6239" y="-1241.75" font-family="Times,serif" font-size="14.00">QKV Linear</text>
<text text-anchor="middle" x="6239" y="-1226.75" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 24576]</text>
<text text-anchor="middle" x="6239" y="-1211.75" font-family="Times,serif" font-size="14.00">TP=8 across GPUs 8&#45;15</text>
</g>
<!-- l0_mlp_out_0&#45;&gt;l2_attn_qkv -->
<g id="edge119" class="edge">
<title>l0_mlp_out_0&#45;&gt;l2_attn_qkv</title>
<path fill="none" stroke="black" d="M6310.63,-1357.77C6310.63,-1357.77 6310.63,-1267.2 6310.63,-1267.2"/>
<polygon fill="black" stroke="black" points="6314.13,-1267.2 6310.63,-1257.2 6307.13,-1267.2 6314.13,-1267.2"/>
</g>
<!-- l2_attn_residual -->
<g id="node59" class="node">
<title>l2_attn_residual</title>
<polygon fill="lightgreen" stroke="black" points="6553.5,-735 6272.73,-735 6200.5,-629 6481.27,-629 6553.5,-735"/>
<text text-anchor="middle" x="6377" y="-693.3" font-family="Times,serif" font-size="14.00">Add &amp; Norm</text>
<text text-anchor="middle" x="6377" y="-678.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6377" y="-663.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l0_mlp_out_0&#45;&gt;l2_attn_residual -->
<g id="edge124" class="edge">
<title>l0_mlp_out_0&#45;&gt;l2_attn_residual</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6509.1,-1395.73C6509.1,-1395.73 6509.1,-745.07 6509.1,-745.07"/>
<polygon fill="black" stroke="black" points="6512.6,-745.07 6509.1,-735.07 6505.6,-745.07 6512.6,-745.07"/>
</g>
<!-- l0_gate_1&#45;&gt;l0_expert_1_0 -->
<g id="edge22" class="edge">
<title>l0_gate_1&#45;&gt;l0_expert_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7916.09,-1717C7759.53,-1717 7247.33,-1717 7247.33,-1717 7247.33,-1717 7247.33,-1599.02 7247.33,-1599.02"/>
<polygon fill="black" stroke="black" points="7250.83,-1599.02 7247.33,-1589.02 7243.83,-1599.02 7250.83,-1599.02"/>
</g>
<!-- l0_gate_1&#45;&gt;l0_expert_1_1 -->
<g id="edge25" class="edge">
<title>l0_gate_1&#45;&gt;l0_expert_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7909.44,-1698C7817.17,-1698 7633.33,-1698 7633.33,-1698 7633.33,-1698 7633.33,-1599.23 7633.33,-1599.23"/>
<polygon fill="black" stroke="black" points="7636.83,-1599.23 7633.33,-1589.23 7629.83,-1599.23 7636.83,-1599.23"/>
</g>
<!-- l0_gate_1&#45;&gt;l0_expert_1_2 -->
<g id="edge28" class="edge">
<title>l0_gate_1&#45;&gt;l0_expert_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M7961,-1660.93C7961,-1660.93 7961,-1599.04 7961,-1599.04"/>
<polygon fill="black" stroke="black" points="7964.5,-1599.04 7961,-1589.04 7957.5,-1599.04 7964.5,-1599.04"/>
</g>
<!-- l0_gate_1&#45;&gt;l0_expert_1_3 -->
<g id="edge31" class="edge">
<title>l0_gate_1&#45;&gt;l0_expert_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8005.19,-1679C8094.63,-1679 8288.67,-1679 8288.67,-1679 8288.67,-1679 8288.67,-1599.19 8288.67,-1599.19"/>
<polygon fill="black" stroke="black" points="8292.17,-1599.19 8288.67,-1589.19 8285.17,-1599.19 8292.17,-1599.19"/>
</g>
<!-- l0_expert_1_0&#45;&gt;l0_mlp_out_1 -->
<g id="edge24" class="edge">
<title>l0_expert_1_0&#45;&gt;l0_mlp_out_1</title>
<path fill="none" stroke="black" d="M7184,-1535.85C7184,-1494.87 7184,-1421 7184,-1421 7184,-1421 7817.43,-1421 7817.43,-1421"/>
<polygon fill="black" stroke="black" points="7817.43,-1424.5 7827.43,-1421 7817.43,-1417.5 7817.43,-1424.5"/>
</g>
<!-- l0_expert_1_1&#45;&gt;l0_mlp_out_1 -->
<g id="edge27" class="edge">
<title>l0_expert_1_1&#45;&gt;l0_mlp_out_1</title>
<path fill="none" stroke="black" d="M7690,-1535.72C7690,-1500.23 7690,-1442 7690,-1442 7690,-1442 7831.74,-1442 7831.74,-1442"/>
<polygon fill="black" stroke="black" points="7831.74,-1445.5 7841.74,-1442 7831.74,-1438.5 7831.74,-1445.5"/>
</g>
<!-- l0_expert_1_2&#45;&gt;l0_mlp_out_1 -->
<g id="edge30" class="edge">
<title>l0_expert_1_2&#45;&gt;l0_mlp_out_1</title>
<path fill="none" stroke="black" d="M7961,-1535.72C7961,-1535.72 7961,-1474.09 7961,-1474.09"/>
<polygon fill="black" stroke="black" points="7964.5,-1474.09 7961,-1464.09 7957.5,-1474.09 7964.5,-1474.09"/>
</g>
<!-- l0_expert_1_3&#45;&gt;l0_mlp_out_1 -->
<g id="edge33" class="edge">
<title>l0_expert_1_3&#45;&gt;l0_mlp_out_1</title>
<path fill="none" stroke="black" d="M8209.33,-1535.63C8209.33,-1489.49 8209.33,-1400 8209.33,-1400 8209.33,-1400 8104.25,-1400 8104.25,-1400"/>
<polygon fill="black" stroke="black" points="8104.25,-1396.5 8094.25,-1400 8104.25,-1403.5 8104.25,-1396.5"/>
</g>
<!-- l0_gate_2&#45;&gt;l0_expert_2_0 -->
<g id="edge36" class="edge">
<title>l0_gate_2&#45;&gt;l0_expert_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9498.09,-1717C9341.53,-1717 8829.33,-1717 8829.33,-1717 8829.33,-1717 8829.33,-1599.02 8829.33,-1599.02"/>
<polygon fill="black" stroke="black" points="8832.83,-1599.02 8829.33,-1589.02 8825.83,-1599.02 8832.83,-1599.02"/>
</g>
<!-- l0_gate_2&#45;&gt;l0_expert_2_1 -->
<g id="edge39" class="edge">
<title>l0_gate_2&#45;&gt;l0_expert_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9491.44,-1698C9399.17,-1698 9215.33,-1698 9215.33,-1698 9215.33,-1698 9215.33,-1599.23 9215.33,-1599.23"/>
<polygon fill="black" stroke="black" points="9218.83,-1599.23 9215.33,-1589.23 9211.83,-1599.23 9218.83,-1599.23"/>
</g>
<!-- l0_gate_2&#45;&gt;l0_expert_2_2 -->
<g id="edge42" class="edge">
<title>l0_gate_2&#45;&gt;l0_expert_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9543,-1660.93C9543,-1660.93 9543,-1599.04 9543,-1599.04"/>
<polygon fill="black" stroke="black" points="9546.5,-1599.04 9543,-1589.04 9539.5,-1599.04 9546.5,-1599.04"/>
</g>
<!-- l0_gate_2&#45;&gt;l0_expert_2_3 -->
<g id="edge45" class="edge">
<title>l0_gate_2&#45;&gt;l0_expert_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9587.19,-1679C9676.63,-1679 9870.67,-1679 9870.67,-1679 9870.67,-1679 9870.67,-1599.19 9870.67,-1599.19"/>
<polygon fill="black" stroke="black" points="9874.17,-1599.19 9870.67,-1589.19 9867.17,-1599.19 9874.17,-1599.19"/>
</g>
<!-- l0_expert_2_0&#45;&gt;l0_mlp_out_2 -->
<g id="edge38" class="edge">
<title>l0_expert_2_0&#45;&gt;l0_mlp_out_2</title>
<path fill="none" stroke="black" d="M8766,-1535.85C8766,-1494.87 8766,-1421 8766,-1421 8766,-1421 9399.43,-1421 9399.43,-1421"/>
<polygon fill="black" stroke="black" points="9399.43,-1424.5 9409.43,-1421 9399.43,-1417.5 9399.43,-1424.5"/>
</g>
<!-- l0_expert_2_1&#45;&gt;l0_mlp_out_2 -->
<g id="edge41" class="edge">
<title>l0_expert_2_1&#45;&gt;l0_mlp_out_2</title>
<path fill="none" stroke="black" d="M9272,-1535.72C9272,-1500.23 9272,-1442 9272,-1442 9272,-1442 9413.74,-1442 9413.74,-1442"/>
<polygon fill="black" stroke="black" points="9413.74,-1445.5 9423.74,-1442 9413.74,-1438.5 9413.74,-1445.5"/>
</g>
<!-- l0_expert_2_2&#45;&gt;l0_mlp_out_2 -->
<g id="edge44" class="edge">
<title>l0_expert_2_2&#45;&gt;l0_mlp_out_2</title>
<path fill="none" stroke="black" d="M9543,-1535.72C9543,-1535.72 9543,-1474.09 9543,-1474.09"/>
<polygon fill="black" stroke="black" points="9546.5,-1474.09 9543,-1464.09 9539.5,-1474.09 9546.5,-1474.09"/>
</g>
<!-- l0_expert_2_3&#45;&gt;l0_mlp_out_2 -->
<g id="edge47" class="edge">
<title>l0_expert_2_3&#45;&gt;l0_mlp_out_2</title>
<path fill="none" stroke="black" d="M9791.33,-1535.63C9791.33,-1489.49 9791.33,-1400 9791.33,-1400 9791.33,-1400 9686.25,-1400 9686.25,-1400"/>
<polygon fill="black" stroke="black" points="9686.25,-1396.5 9676.25,-1400 9686.25,-1403.5 9686.25,-1396.5"/>
</g>
<!-- l0_gate_3&#45;&gt;l0_expert_3_0 -->
<g id="edge50" class="edge">
<title>l0_gate_3&#45;&gt;l0_expert_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11080.09,-1717C10923.53,-1717 10411.33,-1717 10411.33,-1717 10411.33,-1717 10411.33,-1599.02 10411.33,-1599.02"/>
<polygon fill="black" stroke="black" points="10414.83,-1599.02 10411.33,-1589.02 10407.83,-1599.02 10414.83,-1599.02"/>
</g>
<!-- l0_gate_3&#45;&gt;l0_expert_3_1 -->
<g id="edge53" class="edge">
<title>l0_gate_3&#45;&gt;l0_expert_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11073.44,-1698C10981.17,-1698 10797.33,-1698 10797.33,-1698 10797.33,-1698 10797.33,-1599.23 10797.33,-1599.23"/>
<polygon fill="black" stroke="black" points="10800.83,-1599.23 10797.33,-1589.23 10793.83,-1599.23 10800.83,-1599.23"/>
</g>
<!-- l0_gate_3&#45;&gt;l0_expert_3_2 -->
<g id="edge56" class="edge">
<title>l0_gate_3&#45;&gt;l0_expert_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11125,-1660.93C11125,-1660.93 11125,-1599.04 11125,-1599.04"/>
<polygon fill="black" stroke="black" points="11128.5,-1599.04 11125,-1589.04 11121.5,-1599.04 11128.5,-1599.04"/>
</g>
<!-- l0_gate_3&#45;&gt;l0_expert_3_3 -->
<g id="edge59" class="edge">
<title>l0_gate_3&#45;&gt;l0_expert_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11169.14,-1679C11246.81,-1679 11399.75,-1679 11399.75,-1679 11399.75,-1679 11399.75,-1599.19 11399.75,-1599.19"/>
<polygon fill="black" stroke="black" points="11403.25,-1599.19 11399.75,-1589.19 11396.25,-1599.19 11403.25,-1599.19"/>
</g>
<!-- l0_expert_3_0&#45;&gt;l0_mlp_out_3 -->
<g id="edge52" class="edge">
<title>l0_expert_3_0&#45;&gt;l0_mlp_out_3</title>
<path fill="none" stroke="black" d="M10348,-1535.85C10348,-1494.87 10348,-1421 10348,-1421 10348,-1421 10981.43,-1421 10981.43,-1421"/>
<polygon fill="black" stroke="black" points="10981.43,-1424.5 10991.43,-1421 10981.43,-1417.5 10981.43,-1424.5"/>
</g>
<!-- l0_expert_3_1&#45;&gt;l0_mlp_out_3 -->
<g id="edge55" class="edge">
<title>l0_expert_3_1&#45;&gt;l0_mlp_out_3</title>
<path fill="none" stroke="black" d="M10854,-1535.72C10854,-1500.23 10854,-1442 10854,-1442 10854,-1442 10995.74,-1442 10995.74,-1442"/>
<polygon fill="black" stroke="black" points="10995.74,-1445.5 11005.74,-1442 10995.74,-1438.5 10995.74,-1445.5"/>
</g>
<!-- l0_expert_3_2&#45;&gt;l0_mlp_out_3 -->
<g id="edge58" class="edge">
<title>l0_expert_3_2&#45;&gt;l0_mlp_out_3</title>
<path fill="none" stroke="black" d="M11125,-1535.72C11125,-1535.72 11125,-1474.09 11125,-1474.09"/>
<polygon fill="black" stroke="black" points="11128.5,-1474.09 11125,-1464.09 11121.5,-1474.09 11128.5,-1474.09"/>
</g>
<!-- l0_expert_3_3&#45;&gt;l0_mlp_out_3 -->
<g id="edge61" class="edge">
<title>l0_expert_3_3&#45;&gt;l0_mlp_out_3</title>
<path fill="none" stroke="black" d="M11373.33,-1535.6C11373.33,-1487.82 11373.33,-1393 11373.33,-1393 11373.33,-1393 11263.17,-1393 11263.17,-1393"/>
<polygon fill="black" stroke="black" points="11263.17,-1389.5 11253.17,-1393 11263.17,-1396.5 11263.17,-1389.5"/>
</g>
<!-- l0_gate_4&#45;&gt;l0_expert_4_0 -->
<g id="edge64" class="edge">
<title>l0_gate_4&#45;&gt;l0_expert_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12269.65,-1698C12187.49,-1698 12035.62,-1698 12035.62,-1698 12035.62,-1698 12035.62,-1599.23 12035.62,-1599.23"/>
<polygon fill="black" stroke="black" points="12039.12,-1599.23 12035.62,-1589.23 12032.12,-1599.23 12039.12,-1599.23"/>
</g>
<!-- l0_gate_4&#45;&gt;l0_expert_4_1 -->
<g id="edge67" class="edge">
<title>l0_gate_4&#45;&gt;l0_expert_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12321,-1660.93C12321,-1660.93 12321,-1599.04 12321,-1599.04"/>
<polygon fill="black" stroke="black" points="12324.5,-1599.04 12321,-1589.04 12317.5,-1599.04 12324.5,-1599.04"/>
</g>
<!-- l0_gate_4&#45;&gt;l0_expert_4_2 -->
<g id="edge70" class="edge">
<title>l0_gate_4&#45;&gt;l0_expert_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12365.19,-1679C12454.63,-1679 12648.67,-1679 12648.67,-1679 12648.67,-1679 12648.67,-1599.19 12648.67,-1599.19"/>
<polygon fill="black" stroke="black" points="12652.17,-1599.19 12648.67,-1589.19 12645.17,-1599.19 12652.17,-1599.19"/>
</g>
<!-- l0_gate_4&#45;&gt;l0_expert_4_3 -->
<g id="edge73" class="edge">
<title>l0_gate_4&#45;&gt;l0_expert_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M12378.2,-1717C12547.55,-1717 13034.67,-1717 13034.67,-1717 13034.67,-1717 13034.67,-1599.02 13034.67,-1599.02"/>
<polygon fill="black" stroke="black" points="13038.17,-1599.02 13034.67,-1589.02 13031.17,-1599.02 13038.17,-1599.02"/>
</g>
<!-- l0_expert_4_0&#45;&gt;l0_mlp_out_4 -->
<g id="edge66" class="edge">
<title>l0_expert_4_0&#45;&gt;l0_mlp_out_4</title>
<path fill="none" stroke="black" d="M11930,-1535.89C11930,-1496.71 11930,-1428 11930,-1428 11930,-1428 12567.82,-1428 12567.82,-1428"/>
<polygon fill="black" stroke="black" points="12567.82,-1431.5 12577.82,-1428 12567.82,-1424.5 12567.82,-1431.5"/>
</g>
<!-- l0_expert_4_1&#45;&gt;l0_mlp_out_4 -->
<g id="edge69" class="edge">
<title>l0_expert_4_1&#45;&gt;l0_mlp_out_4</title>
<path fill="none" stroke="black" d="M12436,-1535.74C12436,-1501.36 12436,-1446 12436,-1446 12436,-1446 12580.11,-1446 12580.11,-1446"/>
<polygon fill="black" stroke="black" points="12580.11,-1449.5 12590.11,-1446 12580.11,-1442.5 12580.11,-1449.5"/>
</g>
<!-- l0_expert_4_2&#45;&gt;l0_mlp_out_4 -->
<g id="edge72" class="edge">
<title>l0_expert_4_2&#45;&gt;l0_mlp_out_4</title>
<path fill="none" stroke="black" d="M12707,-1535.72C12707,-1535.72 12707,-1474.09 12707,-1474.09"/>
<polygon fill="black" stroke="black" points="12710.5,-1474.09 12707,-1464.09 12703.5,-1474.09 12710.5,-1474.09"/>
</g>
<!-- l0_expert_4_3&#45;&gt;l0_mlp_out_4 -->
<g id="edge75" class="edge">
<title>l0_expert_4_3&#45;&gt;l0_mlp_out_4</title>
<path fill="none" stroke="black" d="M13093,-1535.78C13093,-1484.9 13093,-1379 13093,-1379 13093,-1379 12835.7,-1379 12835.7,-1379"/>
<polygon fill="black" stroke="black" points="12835.7,-1375.5 12825.7,-1379 12835.7,-1382.5 12835.7,-1375.5"/>
</g>
<!-- l0_gate_5&#45;&gt;l0_expert_5_0 -->
<g id="edge78" class="edge">
<title>l0_gate_5&#45;&gt;l0_expert_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13851.44,-1698C13759.17,-1698 13575.33,-1698 13575.33,-1698 13575.33,-1698 13575.33,-1599.23 13575.33,-1599.23"/>
<polygon fill="black" stroke="black" points="13578.83,-1599.23 13575.33,-1589.23 13571.83,-1599.23 13578.83,-1599.23"/>
</g>
<!-- l0_gate_5&#45;&gt;l0_expert_5_1 -->
<g id="edge81" class="edge">
<title>l0_gate_5&#45;&gt;l0_expert_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13903,-1660.93C13903,-1660.93 13903,-1599.04 13903,-1599.04"/>
<polygon fill="black" stroke="black" points="13906.5,-1599.04 13903,-1589.04 13899.5,-1599.04 13906.5,-1599.04"/>
</g>
<!-- l0_gate_5&#45;&gt;l0_expert_5_2 -->
<g id="edge84" class="edge">
<title>l0_gate_5&#45;&gt;l0_expert_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13947.19,-1679C14036.63,-1679 14230.67,-1679 14230.67,-1679 14230.67,-1679 14230.67,-1599.19 14230.67,-1599.19"/>
<polygon fill="black" stroke="black" points="14234.17,-1599.19 14230.67,-1589.19 14227.17,-1599.19 14234.17,-1599.19"/>
</g>
<!-- l0_gate_5&#45;&gt;l0_expert_5_3 -->
<g id="edge87" class="edge">
<title>l0_gate_5&#45;&gt;l0_expert_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M13960.2,-1717C14129.55,-1717 14616.67,-1717 14616.67,-1717 14616.67,-1717 14616.67,-1599.02 14616.67,-1599.02"/>
<polygon fill="black" stroke="black" points="14620.17,-1599.02 14616.67,-1589.02 14613.17,-1599.02 14620.17,-1599.02"/>
</g>
<!-- l0_expert_5_0&#45;&gt;l0_mlp_out_5 -->
<g id="edge80" class="edge">
<title>l0_expert_5_0&#45;&gt;l0_mlp_out_5</title>
<path fill="none" stroke="black" d="M13517,-1535.63C13517,-1489.49 13517,-1400 13517,-1400 13517,-1400 14131.06,-1400 14131.06,-1400"/>
<polygon fill="black" stroke="black" points="14131.06,-1403.5 14141.06,-1400 14131.06,-1396.5 14131.06,-1403.5"/>
</g>
<!-- l0_expert_5_1&#45;&gt;l0_mlp_out_5 -->
<g id="edge83" class="edge">
<title>l0_expert_5_1&#45;&gt;l0_mlp_out_5</title>
<path fill="none" stroke="black" d="M13903,-1535.85C13903,-1494.87 13903,-1421 13903,-1421 13903,-1421 14145.35,-1421 14145.35,-1421"/>
<polygon fill="black" stroke="black" points="14145.35,-1424.5 14155.35,-1421 14145.35,-1417.5 14145.35,-1424.5"/>
</g>
<!-- l0_expert_5_2&#45;&gt;l0_mlp_out_5 -->
<g id="edge86" class="edge">
<title>l0_expert_5_2&#45;&gt;l0_mlp_out_5</title>
<path fill="none" stroke="black" d="M14289,-1535.72C14289,-1535.72 14289,-1474.09 14289,-1474.09"/>
<polygon fill="black" stroke="black" points="14292.5,-1474.09 14289,-1464.09 14285.5,-1474.09 14292.5,-1474.09"/>
</g>
<!-- l0_expert_5_3&#45;&gt;l0_mlp_out_5 -->
<g id="edge89" class="edge">
<title>l0_expert_5_3&#45;&gt;l0_mlp_out_5</title>
<path fill="none" stroke="black" d="M14675,-1535.78C14675,-1484.9 14675,-1379 14675,-1379 14675,-1379 14417.7,-1379 14417.7,-1379"/>
<polygon fill="black" stroke="black" points="14417.7,-1375.5 14407.7,-1379 14417.7,-1382.5 14417.7,-1375.5"/>
</g>
<!-- l0_gate_6&#45;&gt;l0_expert_6_0 -->
<g id="edge92" class="edge">
<title>l0_gate_6&#45;&gt;l0_expert_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15433.44,-1698C15341.17,-1698 15157.33,-1698 15157.33,-1698 15157.33,-1698 15157.33,-1599.23 15157.33,-1599.23"/>
<polygon fill="black" stroke="black" points="15160.83,-1599.23 15157.33,-1589.23 15153.83,-1599.23 15160.83,-1599.23"/>
</g>
<!-- l0_gate_6&#45;&gt;l0_expert_6_1 -->
<g id="edge95" class="edge">
<title>l0_gate_6&#45;&gt;l0_expert_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15485,-1660.93C15485,-1660.93 15485,-1599.04 15485,-1599.04"/>
<polygon fill="black" stroke="black" points="15488.5,-1599.04 15485,-1589.04 15481.5,-1599.04 15488.5,-1599.04"/>
</g>
<!-- l0_gate_6&#45;&gt;l0_expert_6_2 -->
<g id="edge98" class="edge">
<title>l0_gate_6&#45;&gt;l0_expert_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15529.19,-1679C15618.63,-1679 15812.67,-1679 15812.67,-1679 15812.67,-1679 15812.67,-1599.19 15812.67,-1599.19"/>
<polygon fill="black" stroke="black" points="15816.17,-1599.19 15812.67,-1589.19 15809.17,-1599.19 15816.17,-1599.19"/>
</g>
<!-- l0_gate_6&#45;&gt;l0_expert_6_3 -->
<g id="edge101" class="edge">
<title>l0_gate_6&#45;&gt;l0_expert_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M15542.2,-1717C15711.55,-1717 16198.67,-1717 16198.67,-1717 16198.67,-1717 16198.67,-1599.02 16198.67,-1599.02"/>
<polygon fill="black" stroke="black" points="16202.17,-1599.02 16198.67,-1589.02 16195.17,-1599.02 16202.17,-1599.02"/>
</g>
<!-- l0_expert_6_0&#45;&gt;l0_mlp_out_6 -->
<g id="edge94" class="edge">
<title>l0_expert_6_0&#45;&gt;l0_mlp_out_6</title>
<path fill="none" stroke="black" d="M15099,-1535.63C15099,-1489.49 15099,-1400 15099,-1400 15099,-1400 15713.06,-1400 15713.06,-1400"/>
<polygon fill="black" stroke="black" points="15713.06,-1403.5 15723.06,-1400 15713.06,-1396.5 15713.06,-1403.5"/>
</g>
<!-- l0_expert_6_1&#45;&gt;l0_mlp_out_6 -->
<g id="edge97" class="edge">
<title>l0_expert_6_1&#45;&gt;l0_mlp_out_6</title>
<path fill="none" stroke="black" d="M15485,-1535.85C15485,-1494.87 15485,-1421 15485,-1421 15485,-1421 15727.35,-1421 15727.35,-1421"/>
<polygon fill="black" stroke="black" points="15727.35,-1424.5 15737.35,-1421 15727.35,-1417.5 15727.35,-1424.5"/>
</g>
<!-- l0_expert_6_2&#45;&gt;l0_mlp_out_6 -->
<g id="edge100" class="edge">
<title>l0_expert_6_2&#45;&gt;l0_mlp_out_6</title>
<path fill="none" stroke="black" d="M15871,-1535.72C15871,-1535.72 15871,-1474.09 15871,-1474.09"/>
<polygon fill="black" stroke="black" points="15874.5,-1474.09 15871,-1464.09 15867.5,-1474.09 15874.5,-1474.09"/>
</g>
<!-- l0_expert_6_3&#45;&gt;l0_mlp_out_6 -->
<g id="edge103" class="edge">
<title>l0_expert_6_3&#45;&gt;l0_mlp_out_6</title>
<path fill="none" stroke="black" d="M16257,-1535.78C16257,-1484.9 16257,-1379 16257,-1379 16257,-1379 15999.7,-1379 15999.7,-1379"/>
<polygon fill="black" stroke="black" points="15999.7,-1375.5 15989.7,-1379 15999.7,-1382.5 15999.7,-1375.5"/>
</g>
<!-- l0_gate_7&#45;&gt;l0_expert_7_0 -->
<g id="edge106" class="edge">
<title>l0_gate_7&#45;&gt;l0_expert_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17015.44,-1698C16923.17,-1698 16739.33,-1698 16739.33,-1698 16739.33,-1698 16739.33,-1599.23 16739.33,-1599.23"/>
<polygon fill="black" stroke="black" points="16742.83,-1599.23 16739.33,-1589.23 16735.83,-1599.23 16742.83,-1599.23"/>
</g>
<!-- l0_gate_7&#45;&gt;l0_expert_7_1 -->
<g id="edge109" class="edge">
<title>l0_gate_7&#45;&gt;l0_expert_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17067,-1660.93C17067,-1660.93 17067,-1599.04 17067,-1599.04"/>
<polygon fill="black" stroke="black" points="17070.5,-1599.04 17067,-1589.04 17063.5,-1599.04 17070.5,-1599.04"/>
</g>
<!-- l0_gate_7&#45;&gt;l0_expert_7_2 -->
<g id="edge112" class="edge">
<title>l0_gate_7&#45;&gt;l0_expert_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17113.6,-1686C17204.06,-1686 17394.67,-1686 17394.67,-1686 17394.67,-1686 17394.67,-1598.96 17394.67,-1598.96"/>
<polygon fill="black" stroke="black" points="17398.17,-1598.96 17394.67,-1588.96 17391.17,-1598.96 17398.17,-1598.96"/>
</g>
<!-- l0_gate_7&#45;&gt;l0_expert_7_3 -->
<g id="edge115" class="edge">
<title>l0_gate_7&#45;&gt;l0_expert_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M17122.11,-1711C17289.51,-1711 17780.67,-1711 17780.67,-1711 17780.67,-1711 17780.67,-1599.01 17780.67,-1599.01"/>
<polygon fill="black" stroke="black" points="17784.17,-1599.01 17780.67,-1589.01 17777.17,-1599.01 17784.17,-1599.01"/>
</g>
<!-- l0_expert_7_0&#45;&gt;l0_mlp_out_7 -->
<g id="edge108" class="edge">
<title>l0_expert_7_0&#45;&gt;l0_mlp_out_7</title>
<path fill="none" stroke="black" d="M16681,-1535.63C16681,-1489.49 16681,-1400 16681,-1400 16681,-1400 17295.06,-1400 17295.06,-1400"/>
<polygon fill="black" stroke="black" points="17295.06,-1403.5 17305.06,-1400 17295.06,-1396.5 17295.06,-1403.5"/>
</g>
<!-- l0_expert_7_1&#45;&gt;l0_mlp_out_7 -->
<g id="edge111" class="edge">
<title>l0_expert_7_1&#45;&gt;l0_mlp_out_7</title>
<path fill="none" stroke="black" d="M17067,-1535.85C17067,-1494.87 17067,-1421 17067,-1421 17067,-1421 17309.35,-1421 17309.35,-1421"/>
<polygon fill="black" stroke="black" points="17309.35,-1424.5 17319.35,-1421 17309.35,-1417.5 17309.35,-1424.5"/>
</g>
<!-- l0_expert_7_2&#45;&gt;l0_mlp_out_7 -->
<g id="edge114" class="edge">
<title>l0_expert_7_2&#45;&gt;l0_mlp_out_7</title>
<path fill="none" stroke="black" d="M17453,-1535.72C17453,-1535.72 17453,-1474.09 17453,-1474.09"/>
<polygon fill="black" stroke="black" points="17456.5,-1474.09 17453,-1464.09 17449.5,-1474.09 17456.5,-1474.09"/>
</g>
<!-- l0_expert_7_3&#45;&gt;l0_mlp_out_7 -->
<g id="edge117" class="edge">
<title>l0_expert_7_3&#45;&gt;l0_mlp_out_7</title>
<path fill="none" stroke="black" d="M17839,-1535.9C17839,-1492.22 17839,-1410 17839,-1410 17839,-1410 17602.9,-1410 17602.9,-1410"/>
<polygon fill="black" stroke="black" points="17602.9,-1406.5 17592.9,-1410 17602.9,-1413.5 17602.9,-1406.5"/>
</g>
<!-- l2_attn_split -->
<g id="node56" class="node">
<title>l2_attn_split</title>
<ellipse fill="yellow" stroke="black" cx="6192" cy="-1094.48" rx="272.89" ry="37.45"/>
<text text-anchor="middle" x="6192" y="-1105.78" font-family="Times,serif" font-size="14.00">Split Heads</text>
<text text-anchor="middle" x="6192" y="-1090.78" font-family="Times,serif" font-size="14.00">[1024, seq_len, 24576] &#45;&gt; [1024, 16, seq_len, 1536]</text>
<text text-anchor="middle" x="6192" y="-1075.78" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l2_attn_qkv&#45;&gt;l2_attn_split -->
<g id="edge120" class="edge">
<title>l2_attn_qkv&#45;&gt;l2_attn_split</title>
<path fill="none" stroke="black" d="M6239,-1203.91C6239,-1203.91 6239,-1141.49 6239,-1141.49"/>
<polygon fill="black" stroke="black" points="6242.5,-1141.49 6239,-1131.49 6235.5,-1141.49 6242.5,-1141.49"/>
</g>
<!-- l2_attn_score -->
<g id="node57" class="node">
<title>l2_attn_score</title>
<polygon fill="lightcoral" stroke="black" points="6320.5,-985 6105.5,-985 6105.5,-932 6320.5,-932 6320.5,-985"/>
<text text-anchor="middle" x="6213" y="-969.8" font-family="Times,serif" font-size="14.00">Attention Score</text>
<text text-anchor="middle" x="6213" y="-954.8" font-family="Times,serif" font-size="14.00">[1024, 16, seq_len, seq_len]</text>
<text text-anchor="middle" x="6213" y="-939.8" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l2_attn_split&#45;&gt;l2_attn_score -->
<g id="edge121" class="edge">
<title>l2_attn_split&#45;&gt;l2_attn_score</title>
<path fill="none" stroke="black" d="M6213,-1056.96C6213,-1056.96 6213,-995.12 6213,-995.12"/>
<polygon fill="black" stroke="black" points="6216.5,-995.12 6213,-985.12 6209.5,-995.12 6216.5,-995.12"/>
</g>
<!-- l2_attn_out -->
<g id="node58" class="node">
<title>l2_attn_out</title>
<polygon fill="lightcoral" stroke="black" points="6422.5,-860 6045.5,-860 6045.5,-807 6422.5,-807 6422.5,-860"/>
<text text-anchor="middle" x="6234" y="-844.8" font-family="Times,serif" font-size="14.00">Attention Output</text>
<text text-anchor="middle" x="6234" y="-829.8" font-family="Times,serif" font-size="14.00">[1024, 16, seq_len, 1536] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6234" y="-814.8" font-family="Times,serif" font-size="14.00">TP=8 across GPUs 8&#45;15</text>
</g>
<!-- l2_attn_score&#45;&gt;l2_attn_out -->
<g id="edge122" class="edge">
<title>l2_attn_score&#45;&gt;l2_attn_out</title>
<path fill="none" stroke="black" d="M6213,-931.99C6213,-931.99 6213,-870.4 6213,-870.4"/>
<polygon fill="black" stroke="black" points="6216.5,-870.4 6213,-860.4 6209.5,-870.4 6216.5,-870.4"/>
</g>
<!-- l2_attn_out&#45;&gt;l2_attn_residual -->
<g id="edge123" class="edge">
<title>l2_attn_out&#45;&gt;l2_attn_residual</title>
<path fill="none" stroke="black" d="M6311.63,-806.76C6311.63,-806.76 6311.63,-745.13 6311.63,-745.13"/>
<polygon fill="black" stroke="black" points="6315.13,-745.13 6311.63,-735.13 6308.13,-745.13 6315.13,-745.13"/>
</g>
<!-- l2_gate_8 -->
<g id="node60" class="node">
<title>l2_gate_8</title>
<polygon fill="orange" stroke="black" points="1035.06,-557 933.16,-557 906.94,-481 1008.84,-481 1035.06,-557"/>
<text text-anchor="middle" x="971" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="971" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_8 -->
<g id="edge125" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_8</title>
<path fill="none" stroke="black" d="M6263.15,-721C5484.15,-721 971,-721 971,-721 971,-721 971,-567.47 971,-567.47"/>
<polygon fill="black" stroke="black" points="974.5,-567.47 971,-557.47 967.5,-567.47 974.5,-567.47"/>
</g>
<!-- l2_expert_8_0 -->
<g id="node61" class="node">
<title>l2_expert_8_0</title>
<polygon fill="lightblue" stroke="black" points="374,-409 24,-409 24,-356 374,-356 374,-409"/>
<text text-anchor="middle" x="199" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="199" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="199" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_8_0 -->
<g id="edge127" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_8_0</title>
<path fill="none" stroke="black" d="M6269.09,-730C5442.04,-730 140.67,-730 140.67,-730 140.67,-730 140.67,-419.19 140.67,-419.19"/>
<polygon fill="black" stroke="black" points="144.17,-419.19 140.67,-409.19 137.17,-419.19 144.17,-419.19"/>
</g>
<!-- l2_expert_8_1 -->
<g id="node62" class="node">
<title>l2_expert_8_1</title>
<polygon fill="lightblue" stroke="black" points="760,-409 410,-409 410,-356 760,-356 760,-409"/>
<text text-anchor="middle" x="585" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="585" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="585" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_8_1 -->
<g id="edge130" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_8_1</title>
<path fill="none" stroke="black" d="M6265.68,-725C5457.86,-725 526.67,-725 526.67,-725 526.67,-725 526.67,-419.09 526.67,-419.09"/>
<polygon fill="black" stroke="black" points="530.17,-419.09 526.67,-409.09 523.17,-419.09 530.17,-419.09"/>
</g>
<!-- l2_expert_8_2 -->
<g id="node63" class="node">
<title>l2_expert_8_2</title>
<polygon fill="lightblue" stroke="black" points="1146,-409 796,-409 796,-356 1146,-356 1146,-409"/>
<text text-anchor="middle" x="971" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="971" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="971" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_8_2 -->
<g id="edge133" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_8_2</title>
<path fill="none" stroke="black" d="M6259.49,-716C5480.36,-716 1090.64,-716 1090.64,-716 1090.64,-716 1090.64,-419.23 1090.64,-419.23"/>
<polygon fill="black" stroke="black" points="1094.14,-419.23 1090.64,-409.23 1087.14,-419.23 1094.14,-419.23"/>
</g>
<!-- l2_expert_8_3 -->
<g id="node64" class="node">
<title>l2_expert_8_3</title>
<polygon fill="lightblue" stroke="black" points="1532,-409 1182,-409 1182,-356 1532,-356 1532,-409"/>
<text text-anchor="middle" x="1357" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1357" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1357" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_8_3 -->
<g id="edge136" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_8_3</title>
<path fill="none" stroke="black" d="M6256.2,-711C5496.89,-711 1415.33,-711 1415.33,-711 1415.33,-711 1415.33,-419.1 1415.33,-419.1"/>
<polygon fill="black" stroke="black" points="1418.83,-419.1 1415.33,-409.1 1411.83,-419.1 1418.83,-419.1"/>
</g>
<!-- l2_mlp_out_8 -->
<g id="node65" class="node">
<title>l2_mlp_out_8</title>
<polygon fill="lightgreen" stroke="black" points="1147.5,-284 866.73,-284 794.5,-178 1075.27,-178 1147.5,-284"/>
<text text-anchor="middle" x="971" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="971" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="971" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_8 -->
<g id="edge138" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6247.31,-698C5558.45,-698 2359.38,-698 2359.38,-698 2359.38,-698 2359.38,-199 2359.38,-199 2359.38,-199 1099.67,-199 1099.67,-199"/>
<polygon fill="black" stroke="black" points="1099.67,-195.5 1089.67,-199 1099.67,-202.5 1099.67,-195.5"/>
</g>
<!-- l2_gate_9 -->
<g id="node66" class="node">
<title>l2_gate_9</title>
<polygon fill="orange" stroke="black" points="2617.06,-557 2515.16,-557 2488.94,-481 2590.84,-481 2617.06,-557"/>
<text text-anchor="middle" x="2553" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2553" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_9 -->
<g id="edge139" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_9</title>
<path fill="none" stroke="black" d="M6243.98,-693C5568.81,-693 2553,-693 2553,-693 2553,-693 2553,-567.19 2553,-567.19"/>
<polygon fill="black" stroke="black" points="2556.5,-567.19 2553,-557.19 2549.5,-567.19 2556.5,-567.19"/>
</g>
<!-- l2_expert_9_0 -->
<g id="node67" class="node">
<title>l2_expert_9_0</title>
<polygon fill="lightblue" stroke="black" points="1956,-409 1606,-409 1606,-356 1956,-356 1956,-409"/>
<text text-anchor="middle" x="1781" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1781" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1781" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_9_0 -->
<g id="edge141" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_9_0</title>
<path fill="none" stroke="black" d="M6253.41,-707C5515.41,-707 1722.67,-707 1722.67,-707 1722.67,-707 1722.67,-419.06 1722.67,-419.06"/>
<polygon fill="black" stroke="black" points="1726.17,-419.06 1722.67,-409.06 1719.17,-419.06 1726.17,-419.06"/>
</g>
<!-- l2_expert_9_1 -->
<g id="node68" class="node">
<title>l2_expert_9_1</title>
<polygon fill="lightblue" stroke="black" points="2342,-409 1992,-409 1992,-356 2342,-356 2342,-409"/>
<text text-anchor="middle" x="2167" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2167" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2167" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_9_1 -->
<g id="edge144" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_9_1</title>
<path fill="none" stroke="black" d="M6250.13,-702C5541.86,-702 2108.67,-702 2108.67,-702 2108.67,-702 2108.67,-419.19 2108.67,-419.19"/>
<polygon fill="black" stroke="black" points="2112.17,-419.19 2108.67,-409.19 2105.17,-419.19 2112.17,-419.19"/>
</g>
<!-- l2_expert_9_2 -->
<g id="node69" class="node">
<title>l2_expert_9_2</title>
<polygon fill="lightblue" stroke="black" points="2728,-409 2378,-409 2378,-356 2728,-356 2728,-409"/>
<text text-anchor="middle" x="2553" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2553" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2553" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_9_2 -->
<g id="edge147" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_9_2</title>
<path fill="none" stroke="black" d="M6240.49,-688C5571.65,-688 2672.64,-688 2672.64,-688 2672.64,-688 2672.64,-419.08 2672.64,-419.08"/>
<polygon fill="black" stroke="black" points="2676.14,-419.08 2672.64,-409.08 2669.14,-419.08 2676.14,-419.08"/>
</g>
<!-- l2_expert_9_3 -->
<g id="node70" class="node">
<title>l2_expert_9_3</title>
<polygon fill="lightblue" stroke="black" points="3114,-409 2764,-409 2764,-356 3114,-356 3114,-409"/>
<text text-anchor="middle" x="2939" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2939" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2939" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_9_3 -->
<g id="edge150" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_9_3</title>
<path fill="none" stroke="black" d="M6237.95,-684C5601.52,-684 2997.33,-684 2997.33,-684 2997.33,-684 2997.33,-419.26 2997.33,-419.26"/>
<polygon fill="black" stroke="black" points="3000.83,-419.26 2997.33,-409.26 2993.83,-419.26 3000.83,-419.26"/>
</g>
<!-- l2_mlp_out_9 -->
<g id="node71" class="node">
<title>l2_mlp_out_9</title>
<polygon fill="lightgreen" stroke="black" points="2729.5,-284 2448.73,-284 2376.5,-178 2657.27,-178 2729.5,-284"/>
<text text-anchor="middle" x="2553" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="2553" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2553" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_9 -->
<g id="edge152" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6228.31,-670C5699.5,-670 3941.38,-670 3941.38,-670 3941.38,-670 3941.38,-199 3941.38,-199 3941.38,-199 2681.67,-199 2681.67,-199"/>
<polygon fill="black" stroke="black" points="2681.67,-195.5 2671.67,-199 2681.67,-202.5 2681.67,-195.5"/>
</g>
<!-- l2_gate_10 -->
<g id="node72" class="node">
<title>l2_gate_10</title>
<polygon fill="orange" stroke="black" points="4208.72,-557 4091.45,-557 4061.28,-481 4178.55,-481 4208.72,-557"/>
<text text-anchor="middle" x="4135" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4135" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_10 -->
<g id="edge153" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_10</title>
<path fill="none" stroke="black" d="M6224.66,-665C5720.05,-665 4135,-665 4135,-665 4135,-665 4135,-567.36 4135,-567.36"/>
<polygon fill="black" stroke="black" points="4138.5,-567.36 4135,-557.36 4131.5,-567.36 4138.5,-567.36"/>
</g>
<!-- l2_expert_10_0 -->
<g id="node73" class="node">
<title>l2_expert_10_0</title>
<polygon fill="lightblue" stroke="black" points="3538,-409 3188,-409 3188,-356 3538,-356 3538,-409"/>
<text text-anchor="middle" x="3363" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="3363" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3363" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_10_0 -->
<g id="edge155" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_10_0</title>
<path fill="none" stroke="black" d="M6234.47,-679C5629.44,-679 3304.67,-679 3304.67,-679 3304.67,-679 3304.67,-419.07 3304.67,-419.07"/>
<polygon fill="black" stroke="black" points="3308.17,-419.07 3304.67,-409.07 3301.17,-419.07 3308.17,-419.07"/>
</g>
<!-- l2_expert_10_1 -->
<g id="node74" class="node">
<title>l2_expert_10_1</title>
<polygon fill="lightblue" stroke="black" points="3924,-409 3574,-409 3574,-356 3924,-356 3924,-409"/>
<text text-anchor="middle" x="3749" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3749" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3749" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_10_1 -->
<g id="edge158" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_10_1</title>
<path fill="none" stroke="black" d="M6231.62,-675C5672.34,-675 3690.67,-675 3690.67,-675 3690.67,-675 3690.67,-419.23 3690.67,-419.23"/>
<polygon fill="black" stroke="black" points="3694.17,-419.23 3690.67,-409.23 3687.17,-419.23 3694.17,-419.23"/>
</g>
<!-- l2_expert_10_2 -->
<g id="node75" class="node">
<title>l2_expert_10_2</title>
<polygon fill="lightblue" stroke="black" points="4310,-409 3960,-409 3960,-356 4310,-356 4310,-409"/>
<text text-anchor="middle" x="4135" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4135" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4135" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_10_2 -->
<g id="edge161" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_10_2</title>
<path fill="none" stroke="black" d="M6222.14,-661C5733.95,-661 4259.3,-661 4259.3,-661 4259.3,-661 4259.3,-419.2 4259.3,-419.2"/>
<polygon fill="black" stroke="black" points="4262.8,-419.2 4259.3,-409.2 4255.8,-419.2 4262.8,-419.2"/>
</g>
<!-- l2_expert_10_3 -->
<g id="node76" class="node">
<title>l2_expert_10_3</title>
<polygon fill="lightblue" stroke="black" points="4696,-409 4346,-409 4346,-356 4696,-356 4696,-409"/>
<text text-anchor="middle" x="4521" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4521" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4521" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_10_3 -->
<g id="edge164" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_10_3</title>
<path fill="none" stroke="black" d="M6218.65,-656C5779.66,-656 4579.33,-656 4579.33,-656 4579.33,-656 4579.33,-419.22 4579.33,-419.22"/>
<polygon fill="black" stroke="black" points="4582.83,-419.22 4579.33,-409.22 4575.83,-419.22 4582.83,-419.22"/>
</g>
<!-- l2_mlp_out_10 -->
<g id="node77" class="node">
<title>l2_mlp_out_10</title>
<polygon fill="lightgreen" stroke="black" points="4311.5,-284 4030.73,-284 3958.5,-178 4239.27,-178 4311.5,-284"/>
<text text-anchor="middle" x="4135" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="4135" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4135" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_10 -->
<g id="edge166" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6209.12,-642C5960.47,-642 5523.38,-642 5523.38,-642 5523.38,-642 5523.38,-199 5523.38,-199 5523.38,-199 4263.67,-199 4263.67,-199"/>
<polygon fill="black" stroke="black" points="4263.67,-195.5 4253.67,-199 4263.67,-202.5 4263.67,-195.5"/>
</g>
<!-- l2_gate_11 -->
<g id="node78" class="node">
<title>l2_gate_11</title>
<polygon fill="orange" stroke="black" points="5790.72,-557 5673.45,-557 5643.28,-481 5760.55,-481 5790.72,-557"/>
<text text-anchor="middle" x="5717" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="5717" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_11 -->
<g id="edge167" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_11</title>
<path fill="none" stroke="black" d="M6206.54,-638C6032.06,-638 5786.3,-638 5786.3,-638 5786.3,-638 5786.3,-529.09 5786.3,-529.09"/>
<polygon fill="black" stroke="black" points="5789.8,-529.09 5786.3,-519.09 5782.8,-529.09 5789.8,-529.09"/>
</g>
<!-- l2_expert_11_0 -->
<g id="node79" class="node">
<title>l2_expert_11_0</title>
<polygon fill="lightblue" stroke="black" points="5120,-409 4770,-409 4770,-356 5120,-356 5120,-409"/>
<text text-anchor="middle" x="4945" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="4945" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4945" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_11_0 -->
<g id="edge169" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_11_0</title>
<path fill="none" stroke="black" d="M6216.09,-652C5830.72,-652 4886.67,-652 4886.67,-652 4886.67,-652 4886.67,-419.33 4886.67,-419.33"/>
<polygon fill="black" stroke="black" points="4890.17,-419.33 4886.67,-409.33 4883.17,-419.33 4890.17,-419.33"/>
</g>
<!-- l2_expert_11_1 -->
<g id="node80" class="node">
<title>l2_expert_11_1</title>
<polygon fill="lightblue" stroke="black" points="5506,-409 5156,-409 5156,-356 5506,-356 5506,-409"/>
<text text-anchor="middle" x="5331" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="5331" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5331" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_11_1 -->
<g id="edge172" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_11_1</title>
<path fill="none" stroke="black" d="M6212.73,-647C5948.07,-647 5456.67,-647 5456.67,-647 5456.67,-647 5456.67,-419.32 5456.67,-419.32"/>
<polygon fill="black" stroke="black" points="5460.17,-419.32 5456.67,-409.32 5453.17,-419.32 5460.17,-419.32"/>
</g>
<!-- l2_expert_11_2 -->
<g id="node81" class="node">
<title>l2_expert_11_2</title>
<polygon fill="lightblue" stroke="black" points="5892,-409 5542,-409 5542,-356 5892,-356 5892,-409"/>
<text text-anchor="middle" x="5717" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="5717" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5717" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_11_2 -->
<g id="edge175" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_11_2</title>
<path fill="none" stroke="black" d="M6203.18,-633C6051.33,-633 5855,-633 5855,-633 5855,-633 5855,-419.31 5855,-419.31"/>
<polygon fill="black" stroke="black" points="5858.5,-419.31 5855,-409.31 5851.5,-419.31 5858.5,-419.31"/>
</g>
<!-- l2_expert_11_3 -->
<g id="node82" class="node">
<title>l2_expert_11_3</title>
<polygon fill="lightblue" stroke="black" points="6278,-409 5928,-409 5928,-356 6278,-356 6278,-409"/>
<text text-anchor="middle" x="6103" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="6103" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6103" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_11_3 -->
<g id="edge178" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_11_3</title>
<path fill="none" stroke="black" d="M6239.38,-628.8C6239.38,-628.8 6239.38,-419.27 6239.38,-419.27"/>
<polygon fill="black" stroke="black" points="6242.88,-419.27 6239.38,-409.27 6235.88,-419.27 6242.88,-419.27"/>
</g>
<!-- l2_mlp_out_11 -->
<g id="node83" class="node">
<title>l2_mlp_out_11</title>
<polygon fill="lightgreen" stroke="black" points="5893.5,-284 5612.73,-284 5540.5,-178 5821.27,-178 5893.5,-284"/>
<text text-anchor="middle" x="5717" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="5717" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5717" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_11 -->
<g id="edge180" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6302.67,-628.96C6302.67,-502.74 6302.67,-195 6302.67,-195 6302.67,-195 5843.06,-195 5843.06,-195"/>
<polygon fill="black" stroke="black" points="5843.06,-191.5 5833.06,-195 5843.06,-198.5 5843.06,-191.5"/>
</g>
<!-- l2_gate_12 -->
<g id="node84" class="node">
<title>l2_gate_12</title>
<polygon fill="orange" stroke="black" points="6986.72,-557 6869.45,-557 6839.28,-481 6956.55,-481 6986.72,-557"/>
<text text-anchor="middle" x="6913" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="6913" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_12 -->
<g id="edge181" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_12</title>
<path fill="none" stroke="black" d="M6487.62,-638C6638.33,-638 6889.7,-638 6889.7,-638 6889.7,-638 6889.7,-567.31 6889.7,-567.31"/>
<polygon fill="black" stroke="black" points="6893.2,-567.31 6889.7,-557.31 6886.2,-567.31 6893.2,-567.31"/>
</g>
<!-- l2_expert_12_0 -->
<g id="node85" class="node">
<title>l2_expert_12_0</title>
<polygon fill="lightblue" stroke="black" points="6702,-409 6352,-409 6352,-356 6702,-356 6702,-409"/>
<text text-anchor="middle" x="6527" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6527" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6527" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_12_0 -->
<g id="edge183" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_12_0</title>
<path fill="none" stroke="black" d="M6452.62,-628.8C6452.62,-628.8 6452.62,-419.27 6452.62,-419.27"/>
<polygon fill="black" stroke="black" points="6456.12,-419.27 6452.62,-409.27 6449.12,-419.27 6456.12,-419.27"/>
</g>
<!-- l2_expert_12_1 -->
<g id="node86" class="node">
<title>l2_expert_12_1</title>
<polygon fill="lightblue" stroke="black" points="7088,-409 6738,-409 6738,-356 7088,-356 7088,-409"/>
<text text-anchor="middle" x="6913" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6913" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6913" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_12_1 -->
<g id="edge186" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_12_1</title>
<path fill="none" stroke="black" d="M6484.09,-633C6606.08,-633 6788.7,-633 6788.7,-633 6788.7,-633 6788.7,-419.31 6788.7,-419.31"/>
<polygon fill="black" stroke="black" points="6792.2,-419.31 6788.7,-409.31 6785.2,-419.31 6792.2,-419.31"/>
</g>
<!-- l2_expert_12_2 -->
<g id="node87" class="node">
<title>l2_expert_12_2</title>
<polygon fill="lightblue" stroke="black" points="7474,-409 7124,-409 7124,-356 7474,-356 7474,-409"/>
<text text-anchor="middle" x="7299" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7299" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7299" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_12_2 -->
<g id="edge189" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_12_2</title>
<path fill="none" stroke="black" d="M6490.2,-642C6737.5,-642 7304,-642 7304,-642 7304,-642 7304,-419.29 7304,-419.29"/>
<polygon fill="black" stroke="black" points="7307.5,-419.29 7304,-409.29 7300.5,-419.29 7307.5,-419.29"/>
</g>
<!-- l2_expert_12_3 -->
<g id="node88" class="node">
<title>l2_expert_12_3</title>
<polygon fill="lightblue" stroke="black" points="7860,-409 7510,-409 7510,-356 7860,-356 7860,-409"/>
<text text-anchor="middle" x="7685" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7685" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7685" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_12_3 -->
<g id="edge192" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_12_3</title>
<path fill="none" stroke="black" d="M6493.75,-647C6804.81,-647 7630,-647 7630,-647 7630,-647 7630,-419.32 7630,-419.32"/>
<polygon fill="black" stroke="black" points="7633.5,-419.32 7630,-409.32 7626.5,-419.32 7633.5,-419.32"/>
</g>
<!-- l2_mlp_out_12 -->
<g id="node89" class="node">
<title>l2_mlp_out_12</title>
<polygon fill="lightgreen" stroke="black" points="7475.5,-284 7194.73,-284 7122.5,-178 7403.27,-178 7475.5,-284"/>
<text text-anchor="middle" x="7299" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="7299" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7299" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_12 -->
<g id="edge194" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6327.33,-628.94C6327.33,-509.72 6327.33,-231 6327.33,-231 6327.33,-231 7148.49,-231 7148.49,-231"/>
<polygon fill="black" stroke="black" points="7148.49,-234.5 7158.49,-231 7148.49,-227.5 7148.49,-234.5"/>
</g>
<!-- l2_gate_13 -->
<g id="node90" class="node">
<title>l2_gate_13</title>
<polygon fill="orange" stroke="black" points="8568.72,-557 8451.45,-557 8421.28,-481 8538.55,-481 8568.72,-557"/>
<text text-anchor="middle" x="8495" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="8495" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_13 -->
<g id="edge195" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_13</title>
<path fill="none" stroke="black" d="M6503.32,-661C6956.19,-661 8471.7,-661 8471.7,-661 8471.7,-661 8471.7,-567.05 8471.7,-567.05"/>
<polygon fill="black" stroke="black" points="8475.2,-567.05 8471.7,-557.05 8468.2,-567.05 8475.2,-567.05"/>
</g>
<!-- l2_expert_13_0 -->
<g id="node91" class="node">
<title>l2_expert_13_0</title>
<polygon fill="lightblue" stroke="black" points="8284,-409 7934,-409 7934,-356 8284,-356 8284,-409"/>
<text text-anchor="middle" x="8109" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="8109" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8109" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_13_0 -->
<g id="edge197" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_13_0</title>
<path fill="none" stroke="black" d="M6496.95,-652C6877.95,-652 8035.62,-652 8035.62,-652 8035.62,-652 8035.62,-419.33 8035.62,-419.33"/>
<polygon fill="black" stroke="black" points="8039.12,-419.33 8035.62,-409.33 8032.12,-419.33 8039.12,-419.33"/>
</g>
<!-- l2_expert_13_1 -->
<g id="node92" class="node">
<title>l2_expert_13_1</title>
<polygon fill="lightblue" stroke="black" points="8670,-409 8320,-409 8320,-356 8670,-356 8670,-409"/>
<text text-anchor="middle" x="8495" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="8495" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8495" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_13_1 -->
<g id="edge200" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_13_1</title>
<path fill="none" stroke="black" d="M6499.84,-656C6934.05,-656 8370.7,-656 8370.7,-656 8370.7,-656 8370.7,-419.22 8370.7,-419.22"/>
<polygon fill="black" stroke="black" points="8374.2,-419.22 8370.7,-409.22 8367.2,-419.22 8374.2,-419.22"/>
</g>
<!-- l2_expert_13_2 -->
<g id="node93" class="node">
<title>l2_expert_13_2</title>
<polygon fill="lightblue" stroke="black" points="9056,-409 8706,-409 8706,-356 9056,-356 9056,-409"/>
<text text-anchor="middle" x="8881" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="8881" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8881" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_13_2 -->
<g id="edge203" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_13_2</title>
<path fill="none" stroke="black" d="M6509.24,-670C7026.72,-670 8886,-670 8886,-670 8886,-670 8886,-419.03 8886,-419.03"/>
<polygon fill="black" stroke="black" points="8889.5,-419.03 8886,-409.03 8882.5,-419.03 8889.5,-419.03"/>
</g>
<!-- l2_expert_13_3 -->
<g id="node94" class="node">
<title>l2_expert_13_3</title>
<polygon fill="lightblue" stroke="black" points="9442,-409 9092,-409 9092,-356 9442,-356 9442,-409"/>
<text text-anchor="middle" x="9267" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="9267" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9267" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_13_3 -->
<g id="edge206" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_13_3</title>
<path fill="none" stroke="black" d="M6512.78,-675C7077.64,-675 9212,-675 9212,-675 9212,-675 9212,-419.23 9212,-419.23"/>
<polygon fill="black" stroke="black" points="9215.5,-419.23 9212,-409.23 9208.5,-419.23 9215.5,-419.23"/>
</g>
<!-- l2_mlp_out_13 -->
<g id="node95" class="node">
<title>l2_mlp_out_13</title>
<polygon fill="lightgreen" stroke="black" points="9057.5,-284 8776.73,-284 8704.5,-178 8985.27,-178 9057.5,-284"/>
<text text-anchor="middle" x="8881" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="8881" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8881" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_13 -->
<g id="edge208" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6506.17,-665C6992.72,-665 8687.38,-665 8687.38,-665 8687.38,-665 8687.38,-262 8687.38,-262 8687.38,-262 8751.68,-262 8751.68,-262"/>
<polygon fill="black" stroke="black" points="8751.68,-265.5 8761.68,-262 8751.68,-258.5 8751.68,-265.5"/>
</g>
<!-- l2_gate_14 -->
<g id="node96" class="node">
<title>l2_gate_14</title>
<polygon fill="orange" stroke="black" points="10150.72,-557 10033.45,-557 10003.28,-481 10120.55,-481 10150.72,-557"/>
<text text-anchor="middle" x="10077" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="10077" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_14 -->
<g id="edge209" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_14</title>
<path fill="none" stroke="black" d="M6521.7,-688C7202.48,-688 10053.7,-688 10053.7,-688 10053.7,-688 10053.7,-567.35 10053.7,-567.35"/>
<polygon fill="black" stroke="black" points="10057.2,-567.35 10053.7,-557.35 10050.2,-567.35 10057.2,-567.35"/>
</g>
<!-- l2_expert_14_0 -->
<g id="node97" class="node">
<title>l2_expert_14_0</title>
<polygon fill="lightblue" stroke="black" points="9866,-409 9516,-409 9516,-356 9866,-356 9866,-409"/>
<text text-anchor="middle" x="9691" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="9691" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9691" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_14_0 -->
<g id="edge211" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_14_0</title>
<path fill="none" stroke="black" d="M6515.47,-679C7134.44,-679 9617.62,-679 9617.62,-679 9617.62,-679 9617.62,-419.07 9617.62,-419.07"/>
<polygon fill="black" stroke="black" points="9621.12,-419.07 9617.62,-409.07 9614.12,-419.07 9621.12,-419.07"/>
</g>
<!-- l2_expert_14_1 -->
<g id="node98" class="node">
<title>l2_expert_14_1</title>
<polygon fill="lightblue" stroke="black" points="10252,-409 9902,-409 9902,-356 10252,-356 10252,-409"/>
<text text-anchor="middle" x="10077" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10077" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10077" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_14_1 -->
<g id="edge214" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_14_1</title>
<path fill="none" stroke="black" d="M6518.82,-684C7182.88,-684 9952.7,-684 9952.7,-684 9952.7,-684 9952.7,-419.26 9952.7,-419.26"/>
<polygon fill="black" stroke="black" points="9956.2,-419.26 9952.7,-409.26 9949.2,-419.26 9956.2,-419.26"/>
</g>
<!-- l2_expert_14_2 -->
<g id="node99" class="node">
<title>l2_expert_14_2</title>
<polygon fill="lightblue" stroke="black" points="10638,-409 10288,-409 10288,-356 10638,-356 10638,-409"/>
<text text-anchor="middle" x="10463" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="10463" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10463" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_14_2 -->
<g id="edge217" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_14_2</title>
<path fill="none" stroke="black" d="M6528.37,-698C7268.17,-698 10468,-698 10468,-698 10468,-698 10468,-419.13 10468,-419.13"/>
<polygon fill="black" stroke="black" points="10471.5,-419.13 10468,-409.13 10464.5,-419.13 10471.5,-419.13"/>
</g>
<!-- l2_expert_14_3 -->
<g id="node100" class="node">
<title>l2_expert_14_3</title>
<polygon fill="lightblue" stroke="black" points="11024,-409 10674,-409 10674,-356 11024,-356 11024,-409"/>
<text text-anchor="middle" x="10849" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="10849" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10849" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_14_3 -->
<g id="edge220" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_14_3</title>
<path fill="none" stroke="black" d="M6531.29,-702C7312.43,-702 10794,-702 10794,-702 10794,-702 10794,-419.19 10794,-419.19"/>
<polygon fill="black" stroke="black" points="10797.5,-419.19 10794,-409.19 10790.5,-419.19 10797.5,-419.19"/>
</g>
<!-- l2_mlp_out_14 -->
<g id="node101" class="node">
<title>l2_mlp_out_14</title>
<polygon fill="lightgreen" stroke="black" points="10639.5,-284 10358.73,-284 10286.5,-178 10567.27,-178 10639.5,-284"/>
<text text-anchor="middle" x="10463" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="10463" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10463" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_14 -->
<g id="edge222" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6525.13,-693C7236.66,-693 10269.38,-693 10269.38,-693 10269.38,-693 10269.38,-262 10269.38,-262 10269.38,-262 10333.68,-262 10333.68,-262"/>
<polygon fill="black" stroke="black" points="10333.68,-265.5 10343.68,-262 10333.68,-258.5 10333.68,-265.5"/>
</g>
<!-- l2_gate_15 -->
<g id="node102" class="node">
<title>l2_gate_15</title>
<polygon fill="orange" stroke="black" points="11732.72,-557 11615.45,-557 11585.28,-481 11702.55,-481 11732.72,-557"/>
<text text-anchor="middle" x="11659" y="-522.8" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="11659" y="-507.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_gate_15 -->
<g id="edge223" class="edge">
<title>l2_attn_residual&#45;&gt;l2_gate_15</title>
<path fill="none" stroke="black" d="M6540.88,-716C7430.06,-716 11635.7,-716 11635.7,-716 11635.7,-716 11635.7,-567.45 11635.7,-567.45"/>
<polygon fill="black" stroke="black" points="11639.2,-567.45 11635.7,-557.45 11632.2,-567.45 11639.2,-567.45"/>
</g>
<!-- l2_expert_15_0 -->
<g id="node103" class="node">
<title>l2_expert_15_0</title>
<polygon fill="lightblue" stroke="black" points="11448,-409 11098,-409 11098,-356 11448,-356 11448,-409"/>
<text text-anchor="middle" x="11273" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="11273" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11273" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_15_0 -->
<g id="edge225" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_15_0</title>
<path fill="none" stroke="black" d="M6534.72,-707C7365.86,-707 11199.62,-707 11199.62,-707 11199.62,-707 11199.62,-419.06 11199.62,-419.06"/>
<polygon fill="black" stroke="black" points="11203.12,-419.06 11199.62,-409.06 11196.12,-419.06 11203.12,-419.06"/>
</g>
<!-- l2_expert_15_1 -->
<g id="node104" class="node">
<title>l2_expert_15_1</title>
<polygon fill="lightblue" stroke="black" points="11834,-409 11484,-409 11484,-356 11834,-356 11834,-409"/>
<text text-anchor="middle" x="11659" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="11659" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11659" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_15_1 -->
<g id="edge228" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_15_1</title>
<path fill="none" stroke="black" d="M6537.37,-711C7408.71,-711 11534.7,-711 11534.7,-711 11534.7,-711 11534.7,-419.1 11534.7,-419.1"/>
<polygon fill="black" stroke="black" points="11538.2,-419.1 11534.7,-409.1 11531.2,-419.1 11538.2,-419.1"/>
</g>
<!-- l2_expert_15_2 -->
<g id="node105" class="node">
<title>l2_expert_15_2</title>
<polygon fill="lightblue" stroke="black" points="12220,-409 11870,-409 11870,-356 12220,-356 12220,-409"/>
<text text-anchor="middle" x="12045" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="12045" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12045" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_15_2 -->
<g id="edge231" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_15_2</title>
<path fill="none" stroke="black" d="M6546.78,-725C7490.7,-725 12050,-725 12050,-725 12050,-725 12050,-419.09 12050,-419.09"/>
<polygon fill="black" stroke="black" points="12053.5,-419.09 12050,-409.09 12046.5,-419.09 12053.5,-419.09"/>
</g>
<!-- l2_expert_15_3 -->
<g id="node106" class="node">
<title>l2_expert_15_3</title>
<polygon fill="lightblue" stroke="black" points="12606,-409 12256,-409 12256,-356 12606,-356 12606,-409"/>
<text text-anchor="middle" x="12431" y="-393.8" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="12431" y="-378.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] &#45;&gt; [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12431" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_expert_15_3 -->
<g id="edge234" class="edge">
<title>l2_attn_residual&#45;&gt;l2_expert_15_3</title>
<path fill="none" stroke="black" d="M6550.47,-730C7534.98,-730 12376,-730 12376,-730 12376,-730 12376,-419.19 12376,-419.19"/>
<polygon fill="black" stroke="black" points="12379.5,-419.19 12376,-409.19 12372.5,-419.19 12379.5,-419.19"/>
</g>
<!-- l2_mlp_out_15 -->
<g id="node107" class="node">
<title>l2_mlp_out_15</title>
<polygon fill="lightgreen" stroke="black" points="12221.5,-284 11940.73,-284 11868.5,-178 12149.27,-178 12221.5,-284"/>
<text text-anchor="middle" x="12045" y="-242.3" font-family="Times,serif" font-size="14.00">MoE Output</text>
<text text-anchor="middle" x="12045" y="-227.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12045" y="-212.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- l2_attn_residual&#45;&gt;l2_mlp_out_15 -->
<g id="edge236" class="edge">
<title>l2_attn_residual&#45;&gt;l2_mlp_out_15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6544.2,-721C7462.48,-721 11851.38,-721 11851.38,-721 11851.38,-721 11851.38,-262 11851.38,-262 11851.38,-262 11915.68,-262 11915.68,-262"/>
<polygon fill="black" stroke="black" points="11915.68,-265.5 11925.68,-262 11915.68,-258.5 11915.68,-265.5"/>
</g>
<!-- l2_gate_8&#45;&gt;l2_expert_8_0 -->
<g id="edge126" class="edge">
<title>l2_gate_8&#45;&gt;l2_expert_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M924.17,-531C765.4,-531 257.33,-531 257.33,-531 257.33,-531 257.33,-419.05 257.33,-419.05"/>
<polygon fill="black" stroke="black" points="260.83,-419.05 257.33,-409.05 253.83,-419.05 260.83,-419.05"/>
</g>
<!-- l2_gate_8&#45;&gt;l2_expert_8_1 -->
<g id="edge129" class="edge">
<title>l2_gate_8&#45;&gt;l2_expert_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M915.42,-506C821.93,-506 643.33,-506 643.33,-506 643.33,-506 643.33,-419.3 643.33,-419.3"/>
<polygon fill="black" stroke="black" points="646.83,-419.3 643.33,-409.3 639.83,-419.3 646.83,-419.3"/>
</g>
<!-- l2_gate_8&#45;&gt;l2_expert_8_2 -->
<g id="edge132" class="edge">
<title>l2_gate_8&#45;&gt;l2_expert_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M971,-480.98C971,-480.98 971,-419.08 971,-419.08"/>
<polygon fill="black" stroke="black" points="974.5,-419.08 971,-409.08 967.5,-419.08 974.5,-419.08"/>
</g>
<!-- l2_gate_8&#45;&gt;l2_expert_8_3 -->
<g id="edge135" class="edge">
<title>l2_gate_8&#45;&gt;l2_expert_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1015.53,-500C1105.12,-500 1298.67,-500 1298.67,-500 1298.67,-500 1298.67,-419.16 1298.67,-419.16"/>
<polygon fill="black" stroke="black" points="1302.17,-419.16 1298.67,-409.16 1295.17,-419.16 1302.17,-419.16"/>
</g>
<!-- l2_expert_8_0&#45;&gt;l2_mlp_out_8 -->
<g id="edge128" class="edge">
<title>l2_expert_8_0&#45;&gt;l2_mlp_out_8</title>
<path fill="none" stroke="black" d="M199,-355.64C199,-307.85 199,-213 199,-213 199,-213 808.02,-213 808.02,-213"/>
<polygon fill="black" stroke="black" points="808.02,-216.5 818.02,-213 808.02,-209.5 808.02,-216.5"/>
</g>
<!-- l2_expert_8_1&#45;&gt;l2_mlp_out_8 -->
<g id="edge131" class="edge">
<title>l2_expert_8_1&#45;&gt;l2_mlp_out_8</title>
<path fill="none" stroke="black" d="M585,-355.93C585,-316.73 585,-248 585,-248 585,-248 832.2,-248 832.2,-248"/>
<polygon fill="black" stroke="black" points="832.2,-251.5 842.2,-248 832.2,-244.5 832.2,-251.5"/>
</g>
<!-- l2_expert_8_2&#45;&gt;l2_mlp_out_8 -->
<g id="edge134" class="edge">
<title>l2_expert_8_2&#45;&gt;l2_mlp_out_8</title>
<path fill="none" stroke="black" d="M971,-355.76C971,-355.76 971,-294.13 971,-294.13"/>
<polygon fill="black" stroke="black" points="974.5,-294.13 971,-284.13 967.5,-294.13 974.5,-294.13"/>
</g>
<!-- l2_expert_8_3&#45;&gt;l2_mlp_out_8 -->
<g id="edge137" class="edge">
<title>l2_expert_8_3&#45;&gt;l2_mlp_out_8</title>
<path fill="none" stroke="black" d="M1357,-355.67C1357,-309.51 1357,-220 1357,-220 1357,-220 1114.11,-220 1114.11,-220"/>
<polygon fill="black" stroke="black" points="1114.11,-216.5 1104.11,-220 1114.11,-223.5 1114.11,-216.5"/>
</g>
<!-- output -->
<g id="node108" class="node">
<title>output</title>
<polygon fill="lightgreen" stroke="black" points="1147.5,-106 866.73,-106 794.5,0 1075.27,0 1147.5,-106"/>
<text text-anchor="middle" x="971" y="-64.3" font-family="Times,serif" font-size="14.00">Output Tokens</text>
<text text-anchor="middle" x="971" y="-49.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="971" y="-34.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l2_mlp_out_8&#45;&gt;output -->
<g id="edge237" class="edge">
<title>l2_mlp_out_8&#45;&gt;output</title>
<path fill="none" stroke="black" d="M971,-177.59C971,-177.59 971,-116.06 971,-116.06"/>
<polygon fill="black" stroke="black" points="974.5,-116.06 971,-106.06 967.5,-116.06 974.5,-116.06"/>
</g>
<!-- l2_gate_9&#45;&gt;l2_expert_9_0 -->
<g id="edge140" class="edge">
<title>l2_gate_9&#45;&gt;l2_expert_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2508.36,-538C2352.12,-538 1839.33,-538 1839.33,-538 1839.33,-538 1839.33,-419.23 1839.33,-419.23"/>
<polygon fill="black" stroke="black" points="1842.83,-419.23 1839.33,-409.23 1835.83,-419.23 1842.83,-419.23"/>
</g>
<!-- l2_gate_9&#45;&gt;l2_expert_9_1 -->
<g id="edge143" class="edge">
<title>l2_gate_9&#45;&gt;l2_expert_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2501.8,-519C2409.65,-519 2225.33,-519 2225.33,-519 2225.33,-519 2225.33,-419.14 2225.33,-419.14"/>
<polygon fill="black" stroke="black" points="2228.83,-419.14 2225.33,-409.14 2221.83,-419.14 2228.83,-419.14"/>
</g>
<!-- l2_gate_9&#45;&gt;l2_expert_9_2 -->
<g id="edge146" class="edge">
<title>l2_gate_9&#45;&gt;l2_expert_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2553,-480.98C2553,-480.98 2553,-419.08 2553,-419.08"/>
<polygon fill="black" stroke="black" points="2556.5,-419.08 2553,-409.08 2549.5,-419.08 2556.5,-419.08"/>
</g>
<!-- l2_gate_9&#45;&gt;l2_expert_9_3 -->
<g id="edge149" class="edge">
<title>l2_gate_9&#45;&gt;l2_expert_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2597.53,-500C2687.12,-500 2880.67,-500 2880.67,-500 2880.67,-500 2880.67,-419.16 2880.67,-419.16"/>
<polygon fill="black" stroke="black" points="2884.17,-419.16 2880.67,-409.16 2877.17,-419.16 2884.17,-419.16"/>
</g>
<!-- l2_expert_9_0&#45;&gt;l2_mlp_out_9 -->
<g id="edge142" class="edge">
<title>l2_expert_9_0&#45;&gt;l2_mlp_out_9</title>
<path fill="none" stroke="black" d="M1781,-355.88C1781,-314.9 1781,-241 1781,-241 1781,-241 2409.41,-241 2409.41,-241"/>
<polygon fill="black" stroke="black" points="2409.41,-244.5 2419.41,-241 2409.41,-237.5 2409.41,-244.5"/>
</g>
<!-- l2_expert_9_1&#45;&gt;l2_mlp_out_9 -->
<g id="edge145" class="edge">
<title>l2_expert_9_1&#45;&gt;l2_mlp_out_9</title>
<path fill="none" stroke="black" d="M2167,-355.76C2167,-320.26 2167,-262 2167,-262 2167,-262 2423.51,-262 2423.51,-262"/>
<polygon fill="black" stroke="black" points="2423.51,-265.5 2433.51,-262 2423.51,-258.5 2423.51,-265.5"/>
</g>
<!-- l2_expert_9_2&#45;&gt;l2_mlp_out_9 -->
<g id="edge148" class="edge">
<title>l2_expert_9_2&#45;&gt;l2_mlp_out_9</title>
<path fill="none" stroke="black" d="M2553,-355.76C2553,-355.76 2553,-294.13 2553,-294.13"/>
<polygon fill="black" stroke="black" points="2556.5,-294.13 2553,-284.13 2549.5,-294.13 2556.5,-294.13"/>
</g>
<!-- l2_expert_9_3&#45;&gt;l2_mlp_out_9 -->
<g id="edge151" class="edge">
<title>l2_expert_9_3&#45;&gt;l2_mlp_out_9</title>
<path fill="none" stroke="black" d="M2939,-355.67C2939,-309.51 2939,-220 2939,-220 2939,-220 2696.11,-220 2696.11,-220"/>
<polygon fill="black" stroke="black" points="2696.11,-216.5 2686.11,-220 2696.11,-223.5 2696.11,-216.5"/>
</g>
<!-- l2_gate_10&#45;&gt;l2_expert_10_0 -->
<g id="edge154" class="edge">
<title>l2_gate_10&#45;&gt;l2_expert_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4083.67,-538C3920.04,-538 3421.33,-538 3421.33,-538 3421.33,-538 3421.33,-419.23 3421.33,-419.23"/>
<polygon fill="black" stroke="black" points="3424.83,-419.23 3421.33,-409.23 3417.83,-419.23 3424.83,-419.23"/>
</g>
<!-- l2_gate_10&#45;&gt;l2_expert_10_1 -->
<g id="edge157" class="edge">
<title>l2_gate_10&#45;&gt;l2_expert_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4076.04,-519C3981.7,-519 3807.33,-519 3807.33,-519 3807.33,-519 3807.33,-419.14 3807.33,-419.14"/>
<polygon fill="black" stroke="black" points="3810.83,-419.14 3807.33,-409.14 3803.83,-419.14 3810.83,-419.14"/>
</g>
<!-- l2_gate_10&#45;&gt;l2_expert_10_2 -->
<g id="edge160" class="edge">
<title>l2_gate_10&#45;&gt;l2_expert_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4135,-480.98C4135,-480.98 4135,-419.08 4135,-419.08"/>
<polygon fill="black" stroke="black" points="4138.5,-419.08 4135,-409.08 4131.5,-419.08 4138.5,-419.08"/>
</g>
<!-- l2_gate_10&#45;&gt;l2_expert_10_3 -->
<g id="edge163" class="edge">
<title>l2_gate_10&#45;&gt;l2_expert_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4186.2,-500C4278.35,-500 4462.67,-500 4462.67,-500 4462.67,-500 4462.67,-419.16 4462.67,-419.16"/>
<polygon fill="black" stroke="black" points="4466.17,-419.16 4462.67,-409.16 4459.17,-419.16 4466.17,-419.16"/>
</g>
<!-- l2_expert_10_0&#45;&gt;l2_mlp_out_10 -->
<g id="edge156" class="edge">
<title>l2_expert_10_0&#45;&gt;l2_mlp_out_10</title>
<path fill="none" stroke="black" d="M3363,-355.88C3363,-314.9 3363,-241 3363,-241 3363,-241 3991.41,-241 3991.41,-241"/>
<polygon fill="black" stroke="black" points="3991.41,-244.5 4001.41,-241 3991.41,-237.5 3991.41,-244.5"/>
</g>
<!-- l2_expert_10_1&#45;&gt;l2_mlp_out_10 -->
<g id="edge159" class="edge">
<title>l2_expert_10_1&#45;&gt;l2_mlp_out_10</title>
<path fill="none" stroke="black" d="M3749,-355.76C3749,-320.26 3749,-262 3749,-262 3749,-262 4005.51,-262 4005.51,-262"/>
<polygon fill="black" stroke="black" points="4005.51,-265.5 4015.51,-262 4005.51,-258.5 4005.51,-265.5"/>
</g>
<!-- l2_expert_10_2&#45;&gt;l2_mlp_out_10 -->
<g id="edge162" class="edge">
<title>l2_expert_10_2&#45;&gt;l2_mlp_out_10</title>
<path fill="none" stroke="black" d="M4135,-355.76C4135,-355.76 4135,-294.13 4135,-294.13"/>
<polygon fill="black" stroke="black" points="4138.5,-294.13 4135,-284.13 4131.5,-294.13 4138.5,-294.13"/>
</g>
<!-- l2_expert_10_3&#45;&gt;l2_mlp_out_10 -->
<g id="edge165" class="edge">
<title>l2_expert_10_3&#45;&gt;l2_mlp_out_10</title>
<path fill="none" stroke="black" d="M4521,-355.67C4521,-309.51 4521,-220 4521,-220 4521,-220 4278.11,-220 4278.11,-220"/>
<polygon fill="black" stroke="black" points="4278.11,-216.5 4268.11,-220 4278.11,-223.5 4278.11,-216.5"/>
</g>
<!-- l2_gate_11&#45;&gt;l2_expert_11_0 -->
<g id="edge168" class="edge">
<title>l2_gate_11&#45;&gt;l2_expert_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5665.67,-538C5502.04,-538 5003.33,-538 5003.33,-538 5003.33,-538 5003.33,-419.23 5003.33,-419.23"/>
<polygon fill="black" stroke="black" points="5006.83,-419.23 5003.33,-409.23 4999.83,-419.23 5006.83,-419.23"/>
</g>
<!-- l2_gate_11&#45;&gt;l2_expert_11_1 -->
<g id="edge171" class="edge">
<title>l2_gate_11&#45;&gt;l2_expert_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5658.14,-519C5588.34,-519 5481.33,-519 5481.33,-519 5481.33,-519 5481.33,-419.14 5481.33,-419.14"/>
<polygon fill="black" stroke="black" points="5484.83,-419.14 5481.33,-409.14 5477.83,-419.14 5484.83,-419.14"/>
</g>
<!-- l2_gate_11&#45;&gt;l2_expert_11_2 -->
<g id="edge174" class="edge">
<title>l2_gate_11&#45;&gt;l2_expert_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5717,-480.98C5717,-480.98 5717,-419.08 5717,-419.08"/>
<polygon fill="black" stroke="black" points="5720.5,-419.08 5717,-409.08 5713.5,-419.08 5720.5,-419.08"/>
</g>
<!-- l2_gate_11&#45;&gt;l2_expert_11_3 -->
<g id="edge177" class="edge">
<title>l2_gate_11&#45;&gt;l2_expert_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5770.62,-506C5849.28,-506 5986.75,-506 5986.75,-506 5986.75,-506 5986.75,-419.3 5986.75,-419.3"/>
<polygon fill="black" stroke="black" points="5990.25,-419.3 5986.75,-409.3 5983.25,-419.3 5990.25,-419.3"/>
</g>
<!-- l2_expert_11_0&#45;&gt;l2_mlp_out_11 -->
<g id="edge170" class="edge">
<title>l2_expert_11_0&#45;&gt;l2_mlp_out_11</title>
<path fill="none" stroke="black" d="M4945,-355.88C4945,-314.9 4945,-241 4945,-241 4945,-241 5573.41,-241 5573.41,-241"/>
<polygon fill="black" stroke="black" points="5573.41,-244.5 5583.41,-241 5573.41,-237.5 5573.41,-244.5"/>
</g>
<!-- l2_expert_11_1&#45;&gt;l2_mlp_out_11 -->
<g id="edge173" class="edge">
<title>l2_expert_11_1&#45;&gt;l2_mlp_out_11</title>
<path fill="none" stroke="black" d="M5331,-355.76C5331,-320.26 5331,-262 5331,-262 5331,-262 5587.51,-262 5587.51,-262"/>
<polygon fill="black" stroke="black" points="5587.51,-265.5 5597.51,-262 5587.51,-258.5 5587.51,-265.5"/>
</g>
<!-- l2_expert_11_2&#45;&gt;l2_mlp_out_11 -->
<g id="edge176" class="edge">
<title>l2_expert_11_2&#45;&gt;l2_mlp_out_11</title>
<path fill="none" stroke="black" d="M5717,-355.76C5717,-355.76 5717,-294.13 5717,-294.13"/>
<polygon fill="black" stroke="black" points="5720.5,-294.13 5717,-284.13 5713.5,-294.13 5720.5,-294.13"/>
</g>
<!-- l2_expert_11_3&#45;&gt;l2_mlp_out_11 -->
<g id="edge179" class="edge">
<title>l2_expert_11_3&#45;&gt;l2_mlp_out_11</title>
<path fill="none" stroke="black" d="M6103,-355.64C6103,-307.85 6103,-213 6103,-213 6103,-213 5855.26,-213 5855.26,-213"/>
<polygon fill="black" stroke="black" points="5855.26,-209.5 5845.26,-213 5855.26,-216.5 5855.26,-209.5"/>
</g>
<!-- l2_gate_12&#45;&gt;l2_expert_12_0 -->
<g id="edge182" class="edge">
<title>l2_gate_12&#45;&gt;l2_expert_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6859.12,-531C6786.08,-531 6664.67,-531 6664.67,-531 6664.67,-531 6664.67,-419.05 6664.67,-419.05"/>
<polygon fill="black" stroke="black" points="6668.17,-419.05 6664.67,-409.05 6661.17,-419.05 6668.17,-419.05"/>
</g>
<!-- l2_gate_12&#45;&gt;l2_expert_12_1 -->
<g id="edge185" class="edge">
<title>l2_gate_12&#45;&gt;l2_expert_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6913,-480.98C6913,-480.98 6913,-419.08 6913,-419.08"/>
<polygon fill="black" stroke="black" points="6916.5,-419.08 6913,-409.08 6909.5,-419.08 6916.5,-419.08"/>
</g>
<!-- l2_gate_12&#45;&gt;l2_expert_12_2 -->
<g id="edge188" class="edge">
<title>l2_gate_12&#45;&gt;l2_expert_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6964.36,-500C7057.33,-500 7244,-500 7244,-500 7244,-500 7244,-419.16 7244,-419.16"/>
<polygon fill="black" stroke="black" points="7247.5,-419.16 7244,-409.16 7240.5,-419.16 7247.5,-419.16"/>
</g>
<!-- l2_gate_12&#45;&gt;l2_expert_12_3 -->
<g id="edge191" class="edge">
<title>l2_gate_12&#45;&gt;l2_expert_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6979.31,-538C7146.13,-538 7570,-538 7570,-538 7570,-538 7570,-419.23 7570,-419.23"/>
<polygon fill="black" stroke="black" points="7573.5,-419.23 7570,-409.23 7566.5,-419.23 7573.5,-419.23"/>
</g>
<!-- l2_expert_12_0&#45;&gt;l2_mlp_out_12 -->
<g id="edge184" class="edge">
<title>l2_expert_12_0&#45;&gt;l2_mlp_out_12</title>
<path fill="none" stroke="black" d="M6527,-355.93C6527,-316.73 6527,-248 6527,-248 6527,-248 7159.78,-248 7159.78,-248"/>
<polygon fill="black" stroke="black" points="7159.78,-251.5 7169.78,-248 7159.78,-244.5 7159.78,-251.5"/>
</g>
<!-- l2_expert_12_1&#45;&gt;l2_mlp_out_12 -->
<g id="edge187" class="edge">
<title>l2_expert_12_1&#45;&gt;l2_mlp_out_12</title>
<path fill="none" stroke="black" d="M6913,-355.77C6913,-321.38 6913,-266 6913,-266 6913,-266 7172.4,-266 7172.4,-266"/>
<polygon fill="black" stroke="black" points="7172.4,-269.5 7182.4,-266 7172.4,-262.5 7172.4,-269.5"/>
</g>
<!-- l2_expert_12_2&#45;&gt;l2_mlp_out_12 -->
<g id="edge190" class="edge">
<title>l2_expert_12_2&#45;&gt;l2_mlp_out_12</title>
<path fill="none" stroke="black" d="M7299,-355.76C7299,-355.76 7299,-294.13 7299,-294.13"/>
<polygon fill="black" stroke="black" points="7302.5,-294.13 7299,-284.13 7295.5,-294.13 7302.5,-294.13"/>
</g>
<!-- l2_expert_12_3&#45;&gt;l2_mlp_out_12 -->
<g id="edge193" class="edge">
<title>l2_expert_12_3&#45;&gt;l2_mlp_out_12</title>
<path fill="none" stroke="black" d="M7685,-355.82C7685,-304.92 7685,-199 7685,-199 7685,-199 7427.7,-199 7427.7,-199"/>
<polygon fill="black" stroke="black" points="7427.7,-195.5 7417.7,-199 7427.7,-202.5 7427.7,-195.5"/>
</g>
<!-- l2_gate_13&#45;&gt;l2_expert_13_0 -->
<g id="edge196" class="edge">
<title>l2_gate_13&#45;&gt;l2_expert_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8436.15,-519C8362.71,-519 8246.67,-519 8246.67,-519 8246.67,-519 8246.67,-419.14 8246.67,-419.14"/>
<polygon fill="black" stroke="black" points="8250.17,-419.14 8246.67,-409.14 8243.17,-419.14 8250.17,-419.14"/>
</g>
<!-- l2_gate_13&#45;&gt;l2_expert_13_1 -->
<g id="edge199" class="edge">
<title>l2_gate_13&#45;&gt;l2_expert_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8495,-480.98C8495,-480.98 8495,-419.08 8495,-419.08"/>
<polygon fill="black" stroke="black" points="8498.5,-419.08 8495,-409.08 8491.5,-419.08 8498.5,-419.08"/>
</g>
<!-- l2_gate_13&#45;&gt;l2_expert_13_2 -->
<g id="edge202" class="edge">
<title>l2_gate_13&#45;&gt;l2_expert_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8546.36,-500C8639.33,-500 8826,-500 8826,-500 8826,-500 8826,-419.16 8826,-419.16"/>
<polygon fill="black" stroke="black" points="8829.5,-419.16 8826,-409.16 8822.5,-419.16 8829.5,-419.16"/>
</g>
<!-- l2_gate_13&#45;&gt;l2_expert_13_3 -->
<g id="edge205" class="edge">
<title>l2_gate_13&#45;&gt;l2_expert_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M8561.31,-538C8728.13,-538 9152,-538 9152,-538 9152,-538 9152,-419.23 9152,-419.23"/>
<polygon fill="black" stroke="black" points="9155.5,-419.23 9152,-409.23 9148.5,-419.23 9155.5,-419.23"/>
</g>
<!-- l2_expert_13_0&#45;&gt;l2_mlp_out_13 -->
<g id="edge198" class="edge">
<title>l2_expert_13_0&#45;&gt;l2_mlp_out_13</title>
<path fill="none" stroke="black" d="M8109,-355.67C8109,-309.51 8109,-220 8109,-220 8109,-220 8723.06,-220 8723.06,-220"/>
<polygon fill="black" stroke="black" points="8723.06,-223.5 8733.06,-220 8723.06,-216.5 8723.06,-223.5"/>
</g>
<!-- l2_expert_13_1&#45;&gt;l2_mlp_out_13 -->
<g id="edge201" class="edge">
<title>l2_expert_13_1&#45;&gt;l2_mlp_out_13</title>
<path fill="none" stroke="black" d="M8495,-355.88C8495,-314.9 8495,-241 8495,-241 8495,-241 8737.35,-241 8737.35,-241"/>
<polygon fill="black" stroke="black" points="8737.35,-244.5 8747.35,-241 8737.35,-237.5 8737.35,-244.5"/>
</g>
<!-- l2_expert_13_2&#45;&gt;l2_mlp_out_13 -->
<g id="edge204" class="edge">
<title>l2_expert_13_2&#45;&gt;l2_mlp_out_13</title>
<path fill="none" stroke="black" d="M8881,-355.76C8881,-355.76 8881,-294.13 8881,-294.13"/>
<polygon fill="black" stroke="black" points="8884.5,-294.13 8881,-284.13 8877.5,-294.13 8884.5,-294.13"/>
</g>
<!-- l2_expert_13_3&#45;&gt;l2_mlp_out_13 -->
<g id="edge207" class="edge">
<title>l2_expert_13_3&#45;&gt;l2_mlp_out_13</title>
<path fill="none" stroke="black" d="M9267,-355.82C9267,-304.92 9267,-199 9267,-199 9267,-199 9009.7,-199 9009.7,-199"/>
<polygon fill="black" stroke="black" points="9009.7,-195.5 8999.7,-199 9009.7,-202.5 9009.7,-195.5"/>
</g>
<!-- l2_gate_14&#45;&gt;l2_expert_14_0 -->
<g id="edge210" class="edge">
<title>l2_gate_14&#45;&gt;l2_expert_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10018.15,-519C9944.71,-519 9828.67,-519 9828.67,-519 9828.67,-519 9828.67,-419.14 9828.67,-419.14"/>
<polygon fill="black" stroke="black" points="9832.17,-419.14 9828.67,-409.14 9825.17,-419.14 9832.17,-419.14"/>
</g>
<!-- l2_gate_14&#45;&gt;l2_expert_14_1 -->
<g id="edge213" class="edge">
<title>l2_gate_14&#45;&gt;l2_expert_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10077,-480.98C10077,-480.98 10077,-419.08 10077,-419.08"/>
<polygon fill="black" stroke="black" points="10080.5,-419.08 10077,-409.08 10073.5,-419.08 10080.5,-419.08"/>
</g>
<!-- l2_gate_14&#45;&gt;l2_expert_14_2 -->
<g id="edge216" class="edge">
<title>l2_gate_14&#45;&gt;l2_expert_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10128.36,-500C10221.33,-500 10408,-500 10408,-500 10408,-500 10408,-419.16 10408,-419.16"/>
<polygon fill="black" stroke="black" points="10411.5,-419.16 10408,-409.16 10404.5,-419.16 10411.5,-419.16"/>
</g>
<!-- l2_gate_14&#45;&gt;l2_expert_14_3 -->
<g id="edge219" class="edge">
<title>l2_gate_14&#45;&gt;l2_expert_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10143.31,-538C10310.13,-538 10734,-538 10734,-538 10734,-538 10734,-419.23 10734,-419.23"/>
<polygon fill="black" stroke="black" points="10737.5,-419.23 10734,-409.23 10730.5,-419.23 10737.5,-419.23"/>
</g>
<!-- l2_expert_14_0&#45;&gt;l2_mlp_out_14 -->
<g id="edge212" class="edge">
<title>l2_expert_14_0&#45;&gt;l2_mlp_out_14</title>
<path fill="none" stroke="black" d="M9691,-355.67C9691,-309.51 9691,-220 9691,-220 9691,-220 10305.06,-220 10305.06,-220"/>
<polygon fill="black" stroke="black" points="10305.06,-223.5 10315.06,-220 10305.06,-216.5 10305.06,-223.5"/>
</g>
<!-- l2_expert_14_1&#45;&gt;l2_mlp_out_14 -->
<g id="edge215" class="edge">
<title>l2_expert_14_1&#45;&gt;l2_mlp_out_14</title>
<path fill="none" stroke="black" d="M10077,-355.88C10077,-314.9 10077,-241 10077,-241 10077,-241 10319.35,-241 10319.35,-241"/>
<polygon fill="black" stroke="black" points="10319.35,-244.5 10329.35,-241 10319.35,-237.5 10319.35,-244.5"/>
</g>
<!-- l2_expert_14_2&#45;&gt;l2_mlp_out_14 -->
<g id="edge218" class="edge">
<title>l2_expert_14_2&#45;&gt;l2_mlp_out_14</title>
<path fill="none" stroke="black" d="M10463,-355.76C10463,-355.76 10463,-294.13 10463,-294.13"/>
<polygon fill="black" stroke="black" points="10466.5,-294.13 10463,-284.13 10459.5,-294.13 10466.5,-294.13"/>
</g>
<!-- l2_expert_14_3&#45;&gt;l2_mlp_out_14 -->
<g id="edge221" class="edge">
<title>l2_expert_14_3&#45;&gt;l2_mlp_out_14</title>
<path fill="none" stroke="black" d="M10849,-355.82C10849,-304.92 10849,-199 10849,-199 10849,-199 10591.7,-199 10591.7,-199"/>
<polygon fill="black" stroke="black" points="10591.7,-195.5 10581.7,-199 10591.7,-202.5 10591.7,-195.5"/>
</g>
<!-- l2_gate_15&#45;&gt;l2_expert_15_0 -->
<g id="edge224" class="edge">
<title>l2_gate_15&#45;&gt;l2_expert_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11600.15,-519C11526.71,-519 11410.67,-519 11410.67,-519 11410.67,-519 11410.67,-419.14 11410.67,-419.14"/>
<polygon fill="black" stroke="black" points="11414.17,-419.14 11410.67,-409.14 11407.17,-419.14 11414.17,-419.14"/>
</g>
<!-- l2_gate_15&#45;&gt;l2_expert_15_1 -->
<g id="edge227" class="edge">
<title>l2_gate_15&#45;&gt;l2_expert_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11659,-480.98C11659,-480.98 11659,-419.08 11659,-419.08"/>
<polygon fill="black" stroke="black" points="11662.5,-419.08 11659,-409.08 11655.5,-419.08 11662.5,-419.08"/>
</g>
<!-- l2_gate_15&#45;&gt;l2_expert_15_2 -->
<g id="edge230" class="edge">
<title>l2_gate_15&#45;&gt;l2_expert_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11712.55,-506C11806.23,-506 11990,-506 11990,-506 11990,-506 11990,-419.3 11990,-419.3"/>
<polygon fill="black" stroke="black" points="11993.5,-419.3 11990,-409.3 11986.5,-419.3 11993.5,-419.3"/>
</g>
<!-- l2_gate_15&#45;&gt;l2_expert_15_3 -->
<g id="edge233" class="edge">
<title>l2_gate_15&#45;&gt;l2_expert_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M11722.59,-531C11887.47,-531 12316,-531 12316,-531 12316,-531 12316,-419.05 12316,-419.05"/>
<polygon fill="black" stroke="black" points="12319.5,-419.05 12316,-409.05 12312.5,-419.05 12319.5,-419.05"/>
</g>
<!-- l2_expert_15_0&#45;&gt;l2_mlp_out_15 -->
<g id="edge226" class="edge">
<title>l2_expert_15_0&#45;&gt;l2_mlp_out_15</title>
<path fill="none" stroke="black" d="M11273,-355.67C11273,-309.51 11273,-220 11273,-220 11273,-220 11887.06,-220 11887.06,-220"/>
<polygon fill="black" stroke="black" points="11887.06,-223.5 11897.06,-220 11887.06,-216.5 11887.06,-223.5"/>
</g>
<!-- l2_expert_15_1&#45;&gt;l2_mlp_out_15 -->
<g id="edge229" class="edge">
<title>l2_expert_15_1&#45;&gt;l2_mlp_out_15</title>
<path fill="none" stroke="black" d="M11659,-355.88C11659,-314.9 11659,-241 11659,-241 11659,-241 11901.35,-241 11901.35,-241"/>
<polygon fill="black" stroke="black" points="11901.35,-244.5 11911.35,-241 11901.35,-237.5 11901.35,-244.5"/>
</g>
<!-- l2_expert_15_2&#45;&gt;l2_mlp_out_15 -->
<g id="edge232" class="edge">
<title>l2_expert_15_2&#45;&gt;l2_mlp_out_15</title>
<path fill="none" stroke="black" d="M12045,-355.76C12045,-355.76 12045,-294.13 12045,-294.13"/>
<polygon fill="black" stroke="black" points="12048.5,-294.13 12045,-284.13 12041.5,-294.13 12048.5,-294.13"/>
</g>
<!-- l2_expert_15_3&#45;&gt;l2_mlp_out_15 -->
<g id="edge235" class="edge">
<title>l2_expert_15_3&#45;&gt;l2_mlp_out_15</title>
<path fill="none" stroke="black" d="M12431,-355.76C12431,-312.27 12431,-231 12431,-231 12431,-231 12195.45,-231 12195.45,-231"/>
<polygon fill="black" stroke="black" points="12195.45,-227.5 12185.45,-231 12195.45,-234.5 12195.45,-227.5"/>
</g>
</g>
</svg>
