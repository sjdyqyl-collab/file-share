<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: dense_model_dag Pages: 1 -->
<svg width="1440pt" height="148pt"
 viewBox="0.00 0.00 1440.00 148.45" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.09 0.09) rotate(0) translate(4 1694.48)">
<title>dense_model_dag</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1694.48 16471.68,-1694.48 16471.68,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="934" cy="-1663.61" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="934" y="-1667.41" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="934" y="-1652.41" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightyellow" stroke="black" points="744,-1600.74 574,-1600.74 574,-1547.74 744,-1547.74 744,-1600.74"/>
<text text-anchor="middle" x="659" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="659" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="659" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M858.49,-1638.62C824.77,-1627.91 784.76,-1615.2 749.46,-1603.98"/>
<polygon fill="black" stroke="black" points="750.22,-1600.55 739.63,-1600.86 748.1,-1607.22 750.22,-1600.55"/>
</g>
<!-- residual1_1 -->
<g id="node8" class="node">
<title>residual1_1</title>
<polygon fill="lightcoral" stroke="black" points="1360.86,-1244.74 791.58,-1244.74 645.14,-1138.74 1214.42,-1138.74 1360.86,-1244.74"/>
<text text-anchor="middle" x="1003" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1003" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1003" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M972.44,-1637.02C1013.27,-1606.44 1072,-1551.17 1072,-1486.24 1072,-1486.24 1072,-1486.24 1072,-1395.24 1072,-1345.9 1053.42,-1293.23 1035.54,-1253.98"/>
<polygon fill="black" stroke="black" points="1038.66,-1252.4 1031.26,-1244.81 1032.32,-1255.35 1038.66,-1252.4"/>
</g>
<!-- mha_q_1 -->
<g id="node3" class="node">
<title>mha_q_1</title>
<polygon fill="lightblue" stroke="black" points="336,-1511.74 0,-1511.74 0,-1458.74 336,-1458.74 336,-1511.74"/>
<text text-anchor="middle" x="168" y="-1496.54" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="168" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="168" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_q_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M573.75,-1558.14C504.62,-1545.88 405.36,-1528.3 322.33,-1513.59"/>
<polygon fill="black" stroke="black" points="322.74,-1510.1 312.28,-1511.81 321.52,-1517 322.74,-1510.1"/>
</g>
<!-- mha_k_1 -->
<g id="node4" class="node">
<title>mha_k_1</title>
<polygon fill="lightblue" stroke="black" points="690,-1511.74 354,-1511.74 354,-1458.74 690,-1458.74 690,-1511.74"/>
<text text-anchor="middle" x="522" y="-1496.54" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="522" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="522" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_k_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M618.64,-1547.61C603.72,-1538.13 586.65,-1527.29 571.04,-1517.38"/>
<polygon fill="black" stroke="black" points="572.87,-1514.4 562.55,-1511.99 569.11,-1520.31 572.87,-1514.4"/>
</g>
<!-- mha_v_1 -->
<g id="node5" class="node">
<title>mha_v_1</title>
<polygon fill="lightblue" stroke="black" points="1044,-1511.74 708,-1511.74 708,-1458.74 1044,-1458.74 1044,-1511.74"/>
<text text-anchor="middle" x="876" y="-1496.54" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="876" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="876" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln1_1&#45;&gt;mha_v_1 -->
<g id="edge4" class="edge">
<title>ln1_1&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M722.64,-1547.73C747.81,-1537.63 776.9,-1525.97 802.92,-1515.54"/>
<polygon fill="black" stroke="black" points="804.38,-1518.72 812.36,-1511.75 801.78,-1512.23 804.38,-1518.72"/>
</g>
<!-- mha_attn_1 -->
<g id="node6" class="node">
<title>mha_attn_1</title>
<polygon fill="lightblue" stroke="black" points="676,-1422.74 506,-1422.74 506,-1369.74 676,-1369.74 676,-1422.74"/>
<text text-anchor="middle" x="591" y="-1407.54" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="591" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="591" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M292.06,-1458.73C357.18,-1445.33 435.72,-1429.18 495.95,-1416.79"/>
<polygon fill="black" stroke="black" points="496.75,-1420.2 505.84,-1414.76 495.34,-1413.34 496.75,-1420.2"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M542.33,-1458.61C549.22,-1449.92 557.02,-1440.09 564.32,-1430.88"/>
<polygon fill="black" stroke="black" points="567.11,-1433 570.58,-1422.99 561.62,-1428.65 567.11,-1433"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge7" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M792.42,-1458.73C758.49,-1448.37 719.15,-1436.36 684.29,-1425.72"/>
<polygon fill="black" stroke="black" points="685.17,-1422.33 674.58,-1422.75 683.12,-1429.02 685.17,-1422.33"/>
</g>
<!-- mha_out_1 -->
<g id="node7" class="node">
<title>mha_out_1</title>
<polygon fill="lightblue" stroke="black" points="896,-1333.74 560,-1333.74 560,-1280.74 896,-1280.74 896,-1333.74"/>
<text text-anchor="middle" x="728" y="-1318.54" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="728" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="728" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge8" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M631.36,-1369.61C646.28,-1360.13 663.35,-1349.29 678.96,-1339.38"/>
<polygon fill="black" stroke="black" points="680.89,-1342.31 687.45,-1333.99 677.13,-1336.4 680.89,-1342.31"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge10" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M790.06,-1280.63C813.09,-1271.12 840.2,-1259.93 867.23,-1248.78"/>
<polygon fill="black" stroke="black" points="868.87,-1251.89 876.78,-1244.84 866.2,-1245.42 868.87,-1251.89"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="lightyellow" stroke="black" points="988,-1102.37 818,-1102.37 818,-1049.37 988,-1049.37 988,-1102.37"/>
<text text-anchor="middle" x="903" y="-1087.17" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="903" y="-1072.17" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="903" y="-1057.17" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge11" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M957.1,-1138.47C948.6,-1128.79 939.94,-1118.94 932.12,-1110.03"/>
<polygon fill="black" stroke="black" points="934.71,-1107.67 925.48,-1102.47 929.45,-1112.29 934.71,-1107.67"/>
</g>
<!-- residual2_1 -->
<g id="node13" class="node">
<title>residual2_1</title>
<polygon fill="lightcoral" stroke="black" points="1316.86,-746 747.58,-746 601.14,-640 1170.42,-640 1316.86,-746"/>
<text text-anchor="middle" x="959" y="-704.3" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="959" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="959" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge15" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M1025.78,-1138.34C1041.28,-1097.92 1059,-1040.2 1059,-987.5 1059,-987.5 1059,-987.5 1059,-896.5 1059,-844.92 1062.63,-828.35 1040,-782 1035.26,-772.29 1029.09,-762.88 1022.28,-754.07"/>
<polygon fill="black" stroke="black" points="1024.88,-751.71 1015.87,-746.14 1019.44,-756.12 1024.88,-751.71"/>
</g>
<!-- ffn1_1 -->
<g id="node10" class="node">
<title>ffn1_1</title>
<polygon fill="lightblue" stroke="black" points="1031.5,-1013 686.5,-1013 686.5,-960 1031.5,-960 1031.5,-1013"/>
<text text-anchor="middle" x="859" y="-997.8" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="859" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="859" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ln2_1&#45;&gt;ffn1_1 -->
<g id="edge12" class="edge">
<title>ln2_1&#45;&gt;ffn1_1</title>
<path fill="none" stroke="black" d="M890.04,-1049.13C885.78,-1040.69 880.99,-1031.16 876.46,-1022.17"/>
<polygon fill="black" stroke="black" points="879.49,-1020.41 871.87,-1013.06 873.24,-1023.56 879.49,-1020.41"/>
</g>
<!-- gelu_1 -->
<g id="node11" class="node">
<title>gelu_1</title>
<polygon fill="lightblue" stroke="black" points="948.5,-924 769.5,-924 769.5,-871 948.5,-871 948.5,-924"/>
<text text-anchor="middle" x="859" y="-908.8" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="859" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="859" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- ffn1_1&#45;&gt;gelu_1 -->
<g id="edge13" class="edge">
<title>ffn1_1&#45;&gt;gelu_1</title>
<path fill="none" stroke="black" d="M859,-959.87C859,-951.89 859,-942.93 859,-934.38"/>
<polygon fill="black" stroke="black" points="862.5,-934.25 859,-924.25 855.5,-934.25 862.5,-934.25"/>
</g>
<!-- ffn2_1 -->
<g id="node12" class="node">
<title>ffn2_1</title>
<polygon fill="lightblue" stroke="black" points="1031.5,-835 686.5,-835 686.5,-782 1031.5,-782 1031.5,-835"/>
<text text-anchor="middle" x="859" y="-819.8" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="859" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="859" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- gelu_1&#45;&gt;ffn2_1 -->
<g id="edge14" class="edge">
<title>gelu_1&#45;&gt;ffn2_1</title>
<path fill="none" stroke="black" d="M859,-870.87C859,-862.89 859,-853.93 859,-845.38"/>
<polygon fill="black" stroke="black" points="862.5,-845.25 859,-835.25 855.5,-845.25 862.5,-845.25"/>
</g>
<!-- ffn2_1&#45;&gt;residual2_1 -->
<g id="edge16" class="edge">
<title>ffn2_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M881.69,-781.75C889.13,-773.3 897.73,-763.54 906.44,-753.66"/>
<polygon fill="black" stroke="black" points="909.12,-755.91 913.1,-746.1 903.86,-751.29 909.12,-755.91"/>
</g>
<!-- comm_1_2 -->
<g id="node26" class="node">
<title>comm_1_2</title>
<ellipse fill="lightgreen" stroke="black" cx="959" cy="-551" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="959" y="-554.8" font-family="Times,serif" font-size="14.00">GPU 0 → GPU 1</text>
<text text-anchor="middle" x="959" y="-539.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_1&#45;&gt;comm_1_2 -->
<g id="edge17" class="edge">
<title>residual2_1&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M959,-639.87C959,-622.69 959,-603.97 959,-588.24"/>
<polygon fill="black" stroke="black" points="962.5,-587.88 959,-577.88 955.5,-587.88 962.5,-587.88"/>
</g>
<!-- ln1_2 -->
<g id="node14" class="node">
<title>ln1_2</title>
<polygon fill="lightyellow" stroke="black" points="946,-462 776,-462 776,-409 946,-409 946,-462"/>
<text text-anchor="middle" x="861" y="-446.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="861" y="-431.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="861" y="-416.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_q_2 -->
<g id="node15" class="node">
<title>mha_q_2</title>
<polygon fill="lightblue" stroke="black" points="498,-373 162,-373 162,-320 498,-320 498,-373"/>
<text text-anchor="middle" x="330" y="-357.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="330" y="-342.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="330" y="-327.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_q_2 -->
<g id="edge19" class="edge">
<title>ln1_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M775.98,-420.57C700.72,-408.24 588.71,-389.89 495.77,-374.66"/>
<polygon fill="black" stroke="black" points="496.12,-371.17 485.69,-373.01 494.99,-378.08 496.12,-371.17"/>
</g>
<!-- mha_k_2 -->
<g id="node16" class="node">
<title>mha_k_2</title>
<polygon fill="lightblue" stroke="black" points="852,-373 516,-373 516,-320 852,-320 852,-373"/>
<text text-anchor="middle" x="684" y="-357.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="684" y="-342.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="684" y="-327.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_k_2 -->
<g id="edge20" class="edge">
<title>ln1_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M808.85,-408.87C788.87,-399.04 765.88,-387.75 745.13,-377.55"/>
<polygon fill="black" stroke="black" points="746.6,-374.37 736.08,-373.1 743.51,-380.65 746.6,-374.37"/>
</g>
<!-- mha_v_2 -->
<g id="node17" class="node">
<title>mha_v_2</title>
<polygon fill="lightblue" stroke="black" points="1206,-373 870,-373 870,-320 1206,-320 1206,-373"/>
<text text-anchor="middle" x="1038" y="-357.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1038" y="-342.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1038" y="-327.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln1_2&#45;&gt;mha_v_2 -->
<g id="edge21" class="edge">
<title>ln1_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M913.15,-408.87C933.13,-399.04 956.12,-387.75 976.87,-377.55"/>
<polygon fill="black" stroke="black" points="978.49,-380.65 985.92,-373.1 975.4,-374.37 978.49,-380.65"/>
</g>
<!-- mha_attn_2 -->
<g id="node18" class="node">
<title>mha_attn_2</title>
<polygon fill="lightblue" stroke="black" points="857,-284 687,-284 687,-231 857,-231 857,-284"/>
<text text-anchor="middle" x="772" y="-268.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="772" y="-253.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="772" y="-238.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge22" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M459.63,-319.98C529.14,-306.3 613.3,-289.74 676.74,-277.25"/>
<polygon fill="black" stroke="black" points="677.6,-280.65 686.74,-275.28 676.25,-273.78 677.6,-280.65"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge23" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M709.93,-319.87C718.98,-310.92 729.26,-300.75 738.82,-291.3"/>
<polygon fill="black" stroke="black" points="741.3,-293.77 745.95,-284.25 736.38,-288.79 741.3,-293.77"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge24" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M959.99,-319.98C928.59,-309.72 892.23,-297.82 859.9,-287.25"/>
<polygon fill="black" stroke="black" points="860.6,-283.8 850.01,-284.01 858.43,-290.45 860.6,-283.8"/>
</g>
<!-- mha_out_2 -->
<g id="node19" class="node">
<title>mha_out_2</title>
<polygon fill="lightblue" stroke="black" points="1117,-195 781,-195 781,-142 1117,-142 1117,-195"/>
<text text-anchor="middle" x="949" y="-179.8" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="949" y="-164.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="949" y="-149.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge25" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M824.15,-230.87C844.13,-221.04 867.12,-209.75 887.87,-199.55"/>
<polygon fill="black" stroke="black" points="889.49,-202.65 896.92,-195.1 886.4,-196.37 889.49,-202.65"/>
</g>
<!-- residual1_2 -->
<g id="node20" class="node">
<title>residual1_2</title>
<polygon fill="lightcoral" stroke="black" points="1492.86,-106 923.58,-106 777.14,0 1346.42,0 1492.86,-106"/>
<text text-anchor="middle" x="1135" y="-64.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1135" y="-49.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1135" y="-34.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge27" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M991.21,-141.75C1006.13,-132.64 1023.57,-122 1041.05,-111.33"/>
<polygon fill="black" stroke="black" points="1042.91,-114.29 1049.63,-106.1 1039.27,-108.32 1042.91,-114.29"/>
</g>
<!-- ln2_2 -->
<g id="node21" class="node">
<title>ln2_2</title>
<polygon fill="lightyellow" stroke="black" points="4953,-1600.74 4783,-1600.74 4783,-1547.74 4953,-1547.74 4953,-1600.74"/>
<text text-anchor="middle" x="4868" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="4868" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4868" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn1_2 -->
<g id="node22" class="node">
<title>ffn1_2</title>
<polygon fill="lightblue" stroke="black" points="4830.5,-1511.74 4485.5,-1511.74 4485.5,-1458.74 4830.5,-1458.74 4830.5,-1511.74"/>
<text text-anchor="middle" x="4658" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="4658" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4658" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ln2_2&#45;&gt;ffn1_2 -->
<g id="edge29" class="edge">
<title>ln2_2&#45;&gt;ffn1_2</title>
<path fill="none" stroke="black" d="M4806.41,-1547.73C4782.16,-1537.68 4754.15,-1526.08 4729.05,-1515.68"/>
<polygon fill="black" stroke="black" points="4730.17,-1512.35 4719.59,-1511.75 4727.49,-1518.82 4730.17,-1512.35"/>
</g>
<!-- gelu_2 -->
<g id="node23" class="node">
<title>gelu_2</title>
<polygon fill="lightblue" stroke="black" points="4664.5,-1422.74 4485.5,-1422.74 4485.5,-1369.74 4664.5,-1369.74 4664.5,-1422.74"/>
<text text-anchor="middle" x="4575" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="4575" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="4575" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn1_2&#45;&gt;gelu_2 -->
<g id="edge30" class="edge">
<title>ffn1_2&#45;&gt;gelu_2</title>
<path fill="none" stroke="black" d="M4633.55,-1458.61C4625.09,-1449.75 4615.5,-1439.69 4606.56,-1430.32"/>
<polygon fill="black" stroke="black" points="4609,-1427.81 4599.57,-1422.99 4603.94,-1432.64 4609,-1427.81"/>
</g>
<!-- ffn2_2 -->
<g id="node24" class="node">
<title>ffn2_2</title>
<polygon fill="lightblue" stroke="black" points="4685.5,-1333.74 4340.5,-1333.74 4340.5,-1280.74 4685.5,-1280.74 4685.5,-1333.74"/>
<text text-anchor="middle" x="4513" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="4513" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4513" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- gelu_2&#45;&gt;ffn2_2 -->
<g id="edge31" class="edge">
<title>gelu_2&#45;&gt;ffn2_2</title>
<path fill="none" stroke="black" d="M4556.73,-1369.61C4550.61,-1361.01 4543.68,-1351.29 4537.17,-1342.16"/>
<polygon fill="black" stroke="black" points="4540,-1340.1 4531.35,-1333.99 4534.3,-1344.16 4540,-1340.1"/>
</g>
<!-- residual2_2 -->
<g id="node25" class="node">
<title>residual2_2</title>
<polygon fill="lightcoral" stroke="black" points="4807.86,-1244.74 4238.58,-1244.74 4092.14,-1138.74 4661.42,-1138.74 4807.86,-1244.74"/>
<text text-anchor="middle" x="4450" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="4450" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4450" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- ffn2_2&#45;&gt;residual2_2 -->
<g id="edge33" class="edge">
<title>ffn2_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M4498.7,-1280.49C4494.25,-1272.46 4489.13,-1263.23 4483.92,-1253.85"/>
<polygon fill="black" stroke="black" points="4486.83,-1251.88 4478.92,-1244.84 4480.71,-1255.28 4486.83,-1251.88"/>
</g>
<!-- comm_2_3 -->
<g id="node39" class="node">
<title>comm_2_3</title>
<ellipse fill="lightgreen" stroke="black" cx="2159" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="2159" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 1 → GPU 2</text>
<text text-anchor="middle" x="2159" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_2&#45;&gt;comm_2_3 -->
<g id="edge34" class="edge">
<title>residual2_2&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M4142.81,-1175.47C3633.98,-1150.18 2637.47,-1100.65 2285.67,-1083.17"/>
<polygon fill="black" stroke="black" points="2285.61,-1079.66 2275.45,-1082.66 2285.26,-1086.65 2285.61,-1079.66"/>
</g>
<!-- comm_1_2&#45;&gt;ln1_2 -->
<g id="edge18" class="edge">
<title>comm_1_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M937.01,-524.53C923.11,-508.43 904.99,-487.45 889.94,-470.01"/>
<polygon fill="black" stroke="black" points="892.44,-467.56 883.26,-462.28 887.14,-472.14 892.44,-467.56"/>
</g>
<!-- comm_1_2&#45;&gt;residual1_2 -->
<g id="edge26" class="edge">
<title>comm_1_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M1034.14,-529.98C1115.57,-503.19 1234,-447.11 1234,-347.5 1234,-347.5 1234,-347.5 1234,-256.5 1234,-205.02 1207.86,-152.98 1182.44,-114.54"/>
<polygon fill="black" stroke="black" points="1185.2,-112.38 1176.7,-106.06 1179.41,-116.3 1185.2,-112.38"/>
</g>
<!-- ln1_3 -->
<g id="node27" class="node">
<title>ln1_3</title>
<polygon fill="lightyellow" stroke="black" points="1871,-1013 1701,-1013 1701,-960 1871,-960 1871,-1013"/>
<text text-anchor="middle" x="1786" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1786" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1786" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_q_3 -->
<g id="node28" class="node">
<title>mha_q_3</title>
<polygon fill="lightblue" stroke="black" points="1423,-924 1087,-924 1087,-871 1423,-871 1423,-924"/>
<text text-anchor="middle" x="1255" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="1255" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1255" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_q_3 -->
<g id="edge36" class="edge">
<title>ln1_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M1700.98,-971.57C1625.72,-959.24 1513.71,-940.89 1420.77,-925.66"/>
<polygon fill="black" stroke="black" points="1421.12,-922.17 1410.69,-924.01 1419.99,-929.08 1421.12,-922.17"/>
</g>
<!-- mha_k_3 -->
<g id="node29" class="node">
<title>mha_k_3</title>
<polygon fill="lightblue" stroke="black" points="1777,-924 1441,-924 1441,-871 1777,-871 1777,-924"/>
<text text-anchor="middle" x="1609" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="1609" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1609" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_k_3 -->
<g id="edge37" class="edge">
<title>ln1_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M1733.85,-959.87C1713.87,-950.04 1690.88,-938.75 1670.13,-928.55"/>
<polygon fill="black" stroke="black" points="1671.6,-925.37 1661.08,-924.1 1668.51,-931.65 1671.6,-925.37"/>
</g>
<!-- mha_v_3 -->
<g id="node30" class="node">
<title>mha_v_3</title>
<polygon fill="lightblue" stroke="black" points="2131,-924 1795,-924 1795,-871 2131,-871 2131,-924"/>
<text text-anchor="middle" x="1963" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="1963" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1963" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln1_3&#45;&gt;mha_v_3 -->
<g id="edge38" class="edge">
<title>ln1_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M1838.15,-959.87C1858.13,-950.04 1881.12,-938.75 1901.87,-928.55"/>
<polygon fill="black" stroke="black" points="1903.49,-931.65 1910.92,-924.1 1900.4,-925.37 1903.49,-931.65"/>
</g>
<!-- mha_attn_3 -->
<g id="node31" class="node">
<title>mha_attn_3</title>
<polygon fill="lightblue" stroke="black" points="1782,-835 1612,-835 1612,-782 1782,-782 1782,-835"/>
<text text-anchor="middle" x="1697" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="1697" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1697" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge39" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1384.63,-870.98C1454.14,-857.3 1538.3,-840.74 1601.74,-828.25"/>
<polygon fill="black" stroke="black" points="1602.6,-831.65 1611.74,-826.28 1601.25,-824.78 1602.6,-831.65"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge40" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1634.93,-870.87C1643.98,-861.92 1654.26,-851.75 1663.82,-842.3"/>
<polygon fill="black" stroke="black" points="1666.3,-844.77 1670.95,-835.25 1661.38,-839.79 1666.3,-844.77"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge41" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M1884.99,-870.98C1853.59,-860.72 1817.23,-848.82 1784.9,-838.25"/>
<polygon fill="black" stroke="black" points="1785.6,-834.8 1775.01,-835.01 1783.43,-841.45 1785.6,-834.8"/>
</g>
<!-- mha_out_3 -->
<g id="node32" class="node">
<title>mha_out_3</title>
<polygon fill="lightblue" stroke="black" points="1954,-719.5 1618,-719.5 1618,-666.5 1954,-666.5 1954,-719.5"/>
<text text-anchor="middle" x="1786" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="1786" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1786" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge42" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M1717.2,-781.75C1729.71,-765.78 1745.93,-745.1 1759.48,-727.82"/>
<polygon fill="black" stroke="black" points="1762.47,-729.68 1765.88,-719.65 1756.96,-725.36 1762.47,-729.68"/>
</g>
<!-- residual1_3 -->
<g id="node33" class="node">
<title>residual1_3</title>
<polygon fill="lightcoral" stroke="black" points="2329.86,-604 1760.58,-604 1614.14,-498 2183.42,-498 2329.86,-604"/>
<text text-anchor="middle" x="1972" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1972" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="1972" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge44" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1820.12,-666.32C1841.02,-650.58 1868.68,-629.77 1894.66,-610.21"/>
<polygon fill="black" stroke="black" points="1896.77,-613 1902.66,-604.19 1892.56,-607.41 1896.77,-613"/>
</g>
<!-- ln2_3 -->
<g id="node34" class="node">
<title>ln2_3</title>
<polygon fill="lightyellow" stroke="black" points="5651,-1600.74 5481,-1600.74 5481,-1547.74 5651,-1547.74 5651,-1600.74"/>
<text text-anchor="middle" x="5566" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="5566" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5566" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn1_3 -->
<g id="node35" class="node">
<title>ffn1_3</title>
<polygon fill="lightblue" stroke="black" points="5528.5,-1511.74 5183.5,-1511.74 5183.5,-1458.74 5528.5,-1458.74 5528.5,-1511.74"/>
<text text-anchor="middle" x="5356" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="5356" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="5356" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ln2_3&#45;&gt;ffn1_3 -->
<g id="edge46" class="edge">
<title>ln2_3&#45;&gt;ffn1_3</title>
<path fill="none" stroke="black" d="M5504.41,-1547.73C5480.16,-1537.68 5452.15,-1526.08 5427.05,-1515.68"/>
<polygon fill="black" stroke="black" points="5428.17,-1512.35 5417.59,-1511.75 5425.49,-1518.82 5428.17,-1512.35"/>
</g>
<!-- gelu_3 -->
<g id="node36" class="node">
<title>gelu_3</title>
<polygon fill="lightblue" stroke="black" points="5376.5,-1422.74 5197.5,-1422.74 5197.5,-1369.74 5376.5,-1369.74 5376.5,-1422.74"/>
<text text-anchor="middle" x="5287" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="5287" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="5287" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn1_3&#45;&gt;gelu_3 -->
<g id="edge47" class="edge">
<title>ffn1_3&#45;&gt;gelu_3</title>
<path fill="none" stroke="black" d="M5335.67,-1458.61C5328.78,-1449.92 5320.98,-1440.09 5313.68,-1430.88"/>
<polygon fill="black" stroke="black" points="5316.38,-1428.65 5307.42,-1422.99 5310.89,-1433 5316.38,-1428.65"/>
</g>
<!-- ffn2_3 -->
<g id="node37" class="node">
<title>ffn2_3</title>
<polygon fill="lightblue" stroke="black" points="5438.5,-1333.74 5093.5,-1333.74 5093.5,-1280.74 5438.5,-1280.74 5438.5,-1333.74"/>
<text text-anchor="middle" x="5266" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="5266" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5266" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- gelu_3&#45;&gt;ffn2_3 -->
<g id="edge48" class="edge">
<title>gelu_3&#45;&gt;ffn2_3</title>
<path fill="none" stroke="black" d="M5280.81,-1369.61C5278.87,-1361.54 5276.68,-1352.48 5274.59,-1343.84"/>
<polygon fill="black" stroke="black" points="5277.96,-1342.89 5272.22,-1333.99 5271.16,-1344.53 5277.96,-1342.89"/>
</g>
<!-- residual2_3 -->
<g id="node38" class="node">
<title>residual2_3</title>
<polygon fill="lightcoral" stroke="black" points="5540.86,-1244.74 4971.58,-1244.74 4825.14,-1138.74 5394.42,-1138.74 5540.86,-1244.74"/>
<text text-anchor="middle" x="5183" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5183" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5183" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- ffn2_3&#45;&gt;residual2_3 -->
<g id="edge50" class="edge">
<title>ffn2_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M5247.17,-1280.49C5241.11,-1272.21 5234.13,-1262.66 5227.05,-1252.98"/>
<polygon fill="black" stroke="black" points="5229.83,-1250.84 5221.1,-1244.84 5224.17,-1254.97 5229.83,-1250.84"/>
</g>
<!-- comm_3_4 -->
<g id="node52" class="node">
<title>comm_3_4</title>
<ellipse fill="lightgreen" stroke="black" cx="3259" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="3259" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 2 → GPU 3</text>
<text text-anchor="middle" x="3259" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_3&#45;&gt;comm_3_4 -->
<g id="edge51" class="edge">
<title>residual2_3&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M4826.15,-1139.59C4823.09,-1139.3 4820.04,-1139.02 4817,-1138.74 4541.05,-1113.72 3710.15,-1089.15 3388.31,-1080.31"/>
<polygon fill="black" stroke="black" points="3388.1,-1076.81 3378,-1080.03 3387.9,-1083.8 3388.1,-1076.81"/>
</g>
<!-- comm_2_3&#45;&gt;ln1_3 -->
<g id="edge35" class="edge">
<title>comm_2_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M2078.06,-1055.91C2020.22,-1042.36 1942.17,-1024.08 1881.31,-1009.83"/>
<polygon fill="black" stroke="black" points="1881.85,-1006.36 1871.31,-1007.48 1880.25,-1013.17 1881.85,-1006.36"/>
</g>
<!-- comm_2_3&#45;&gt;residual1_3 -->
<g id="edge43" class="edge">
<title>comm_2_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M2159,-1048.87C2159,-1014.47 2159,-951.93 2159,-898.5 2159,-898.5 2159,-898.5 2159,-807.5 2159,-728.52 2100.09,-657.71 2048.4,-610.78"/>
<polygon fill="black" stroke="black" points="2050.63,-608.07 2040.84,-604.03 2045.97,-613.3 2050.63,-608.07"/>
</g>
<!-- ln1_4 -->
<g id="node40" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="2971,-1013 2801,-1013 2801,-960 2971,-960 2971,-1013"/>
<text text-anchor="middle" x="2886" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="2886" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2886" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_q_4 -->
<g id="node41" class="node">
<title>mha_q_4</title>
<polygon fill="lightblue" stroke="black" points="2523,-924 2187,-924 2187,-871 2523,-871 2523,-924"/>
<text text-anchor="middle" x="2355" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="2355" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2355" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_q_4 -->
<g id="edge53" class="edge">
<title>ln1_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M2800.98,-971.57C2725.72,-959.24 2613.71,-940.89 2520.77,-925.66"/>
<polygon fill="black" stroke="black" points="2521.12,-922.17 2510.69,-924.01 2519.99,-929.08 2521.12,-922.17"/>
</g>
<!-- mha_k_4 -->
<g id="node42" class="node">
<title>mha_k_4</title>
<polygon fill="lightblue" stroke="black" points="2877,-924 2541,-924 2541,-871 2877,-871 2877,-924"/>
<text text-anchor="middle" x="2709" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="2709" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2709" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_k_4 -->
<g id="edge54" class="edge">
<title>ln1_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M2833.85,-959.87C2813.87,-950.04 2790.88,-938.75 2770.13,-928.55"/>
<polygon fill="black" stroke="black" points="2771.6,-925.37 2761.08,-924.1 2768.51,-931.65 2771.6,-925.37"/>
</g>
<!-- mha_v_4 -->
<g id="node43" class="node">
<title>mha_v_4</title>
<polygon fill="lightblue" stroke="black" points="3231,-924 2895,-924 2895,-871 3231,-871 3231,-924"/>
<text text-anchor="middle" x="3063" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="3063" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3063" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln1_4&#45;&gt;mha_v_4 -->
<g id="edge55" class="edge">
<title>ln1_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M2938.15,-959.87C2958.13,-950.04 2981.12,-938.75 3001.87,-928.55"/>
<polygon fill="black" stroke="black" points="3003.49,-931.65 3010.92,-924.1 3000.4,-925.37 3003.49,-931.65"/>
</g>
<!-- mha_attn_4 -->
<g id="node44" class="node">
<title>mha_attn_4</title>
<polygon fill="lightblue" stroke="black" points="2882,-835 2712,-835 2712,-782 2882,-782 2882,-835"/>
<text text-anchor="middle" x="2797" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="2797" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2797" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge56" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M2484.63,-870.98C2554.14,-857.3 2638.3,-840.74 2701.74,-828.25"/>
<polygon fill="black" stroke="black" points="2702.6,-831.65 2711.74,-826.28 2701.25,-824.78 2702.6,-831.65"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge57" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M2734.93,-870.87C2743.98,-861.92 2754.26,-851.75 2763.82,-842.3"/>
<polygon fill="black" stroke="black" points="2766.3,-844.77 2770.95,-835.25 2761.38,-839.79 2766.3,-844.77"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge58" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M2984.99,-870.98C2953.59,-860.72 2917.23,-848.82 2884.9,-838.25"/>
<polygon fill="black" stroke="black" points="2885.6,-834.8 2875.01,-835.01 2883.43,-841.45 2885.6,-834.8"/>
</g>
<!-- mha_out_4 -->
<g id="node45" class="node">
<title>mha_out_4</title>
<polygon fill="lightblue" stroke="black" points="3054,-719.5 2718,-719.5 2718,-666.5 3054,-666.5 3054,-719.5"/>
<text text-anchor="middle" x="2886" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="2886" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="2886" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge59" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M2817.2,-781.75C2829.71,-765.78 2845.93,-745.1 2859.48,-727.82"/>
<polygon fill="black" stroke="black" points="2862.47,-729.68 2865.88,-719.65 2856.96,-725.36 2862.47,-729.68"/>
</g>
<!-- residual1_4 -->
<g id="node46" class="node">
<title>residual1_4</title>
<polygon fill="lightcoral" stroke="black" points="3430.86,-604 2861.58,-604 2715.14,-498 3284.42,-498 3430.86,-604"/>
<text text-anchor="middle" x="3073" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="3073" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3073" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge61" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M2920.3,-666.32C2941.32,-650.58 2969.13,-629.77 2995.24,-610.21"/>
<polygon fill="black" stroke="black" points="2997.38,-612.99 3003.29,-604.19 2993.18,-607.38 2997.38,-612.99"/>
</g>
<!-- ln2_4 -->
<g id="node47" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="6269,-1600.74 6099,-1600.74 6099,-1547.74 6269,-1547.74 6269,-1600.74"/>
<text text-anchor="middle" x="6184" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6184" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6184" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn1_4 -->
<g id="node48" class="node">
<title>ffn1_4</title>
<polygon fill="lightblue" stroke="black" points="6260.5,-1511.74 5915.5,-1511.74 5915.5,-1458.74 6260.5,-1458.74 6260.5,-1511.74"/>
<text text-anchor="middle" x="6088" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="6088" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="6088" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ln2_4&#45;&gt;ffn1_4 -->
<g id="edge63" class="edge">
<title>ln2_4&#45;&gt;ffn1_4</title>
<path fill="none" stroke="black" d="M6155.72,-1547.61C6145.75,-1538.57 6134.4,-1528.29 6123.89,-1518.77"/>
<polygon fill="black" stroke="black" points="6126.17,-1516.11 6116.41,-1511.99 6121.47,-1521.3 6126.17,-1516.11"/>
</g>
<!-- gelu_4 -->
<g id="node49" class="node">
<title>gelu_4</title>
<polygon fill="lightblue" stroke="black" points="6115.5,-1422.74 5936.5,-1422.74 5936.5,-1369.74 6115.5,-1369.74 6115.5,-1422.74"/>
<text text-anchor="middle" x="6026" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6026" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="6026" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn1_4&#45;&gt;gelu_4 -->
<g id="edge64" class="edge">
<title>ffn1_4&#45;&gt;gelu_4</title>
<path fill="none" stroke="black" d="M6069.73,-1458.61C6063.61,-1450.01 6056.68,-1440.29 6050.17,-1431.16"/>
<polygon fill="black" stroke="black" points="6053,-1429.1 6044.35,-1422.99 6047.3,-1433.16 6053,-1429.1"/>
</g>
<!-- ffn2_4 -->
<g id="node50" class="node">
<title>ffn2_4</title>
<polygon fill="lightblue" stroke="black" points="6136.5,-1333.74 5791.5,-1333.74 5791.5,-1280.74 6136.5,-1280.74 6136.5,-1333.74"/>
<text text-anchor="middle" x="5964" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="5964" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5964" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- gelu_4&#45;&gt;ffn2_4 -->
<g id="edge65" class="edge">
<title>gelu_4&#45;&gt;ffn2_4</title>
<path fill="none" stroke="black" d="M6007.73,-1369.61C6001.61,-1361.01 5994.68,-1351.29 5988.17,-1342.16"/>
<polygon fill="black" stroke="black" points="5991,-1340.1 5982.35,-1333.99 5985.3,-1344.16 5991,-1340.1"/>
</g>
<!-- residual2_4 -->
<g id="node51" class="node">
<title>residual2_4</title>
<polygon fill="lightcoral" stroke="black" points="6273.86,-1244.74 5704.58,-1244.74 5558.14,-1138.74 6127.42,-1138.74 6273.86,-1244.74"/>
<text text-anchor="middle" x="5916" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="5916" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5916" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- ffn2_4&#45;&gt;residual2_4 -->
<g id="edge67" class="edge">
<title>ffn2_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M5953.11,-1280.49C5949.75,-1272.54 5945.89,-1263.42 5941.97,-1254.14"/>
<polygon fill="black" stroke="black" points="5945.15,-1252.68 5938.03,-1244.84 5938.7,-1255.41 5945.15,-1252.68"/>
</g>
<!-- comm_4_5 -->
<g id="node65" class="node">
<title>comm_4_5</title>
<ellipse fill="lightgreen" stroke="black" cx="4359" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="4359" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 3 → GPU 4</text>
<text text-anchor="middle" x="4359" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_4&#45;&gt;comm_4_5 -->
<g id="edge68" class="edge">
<title>residual2_4&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M5559.14,-1139.64C5556.08,-1139.33 5553.03,-1139.03 5550,-1138.74 5165.06,-1101.47 4707.81,-1085.65 4488.69,-1079.82"/>
<polygon fill="black" stroke="black" points="4488.53,-1076.31 4478.44,-1079.55 4488.34,-1083.31 4488.53,-1076.31"/>
</g>
<!-- comm_3_4&#45;&gt;ln1_4 -->
<g id="edge52" class="edge">
<title>comm_3_4&#45;&gt;ln1_4</title>
<path fill="none" stroke="black" d="M3178.06,-1055.91C3120.22,-1042.36 3042.17,-1024.08 2981.31,-1009.83"/>
<polygon fill="black" stroke="black" points="2981.85,-1006.36 2971.31,-1007.48 2980.25,-1013.17 2981.85,-1006.36"/>
</g>
<!-- comm_3_4&#45;&gt;residual1_4 -->
<g id="edge60" class="edge">
<title>comm_3_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M3259,-1048.87C3259,-1014.47 3259,-951.93 3259,-898.5 3259,-898.5 3259,-898.5 3259,-807.5 3259,-728.67 3200.41,-657.84 3148.99,-610.86"/>
<polygon fill="black" stroke="black" points="3151.25,-608.18 3141.47,-604.11 3146.57,-613.39 3151.25,-608.18"/>
</g>
<!-- ln1_5 -->
<g id="node53" class="node">
<title>ln1_5</title>
<polygon fill="lightyellow" stroke="black" points="4071,-1013 3901,-1013 3901,-960 4071,-960 4071,-1013"/>
<text text-anchor="middle" x="3986" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="3986" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3986" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_q_5 -->
<g id="node54" class="node">
<title>mha_q_5</title>
<polygon fill="lightblue" stroke="black" points="3623,-924 3287,-924 3287,-871 3623,-871 3623,-924"/>
<text text-anchor="middle" x="3455" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="3455" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3455" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_q_5 -->
<g id="edge70" class="edge">
<title>ln1_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M3900.98,-971.57C3825.72,-959.24 3713.71,-940.89 3620.77,-925.66"/>
<polygon fill="black" stroke="black" points="3621.12,-922.17 3610.69,-924.01 3619.99,-929.08 3621.12,-922.17"/>
</g>
<!-- mha_k_5 -->
<g id="node55" class="node">
<title>mha_k_5</title>
<polygon fill="lightblue" stroke="black" points="3977,-924 3641,-924 3641,-871 3977,-871 3977,-924"/>
<text text-anchor="middle" x="3809" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="3809" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3809" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_k_5 -->
<g id="edge71" class="edge">
<title>ln1_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M3933.85,-959.87C3913.87,-950.04 3890.88,-938.75 3870.13,-928.55"/>
<polygon fill="black" stroke="black" points="3871.6,-925.37 3861.08,-924.1 3868.51,-931.65 3871.6,-925.37"/>
</g>
<!-- mha_v_5 -->
<g id="node56" class="node">
<title>mha_v_5</title>
<polygon fill="lightblue" stroke="black" points="4331,-924 3995,-924 3995,-871 4331,-871 4331,-924"/>
<text text-anchor="middle" x="4163" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="4163" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4163" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln1_5&#45;&gt;mha_v_5 -->
<g id="edge72" class="edge">
<title>ln1_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M4038.15,-959.87C4058.13,-950.04 4081.12,-938.75 4101.87,-928.55"/>
<polygon fill="black" stroke="black" points="4103.49,-931.65 4110.92,-924.1 4100.4,-925.37 4103.49,-931.65"/>
</g>
<!-- mha_attn_5 -->
<g id="node57" class="node">
<title>mha_attn_5</title>
<polygon fill="lightblue" stroke="black" points="3982,-835 3812,-835 3812,-782 3982,-782 3982,-835"/>
<text text-anchor="middle" x="3897" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="3897" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="3897" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge73" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M3584.63,-870.98C3654.14,-857.3 3738.3,-840.74 3801.74,-828.25"/>
<polygon fill="black" stroke="black" points="3802.6,-831.65 3811.74,-826.28 3801.25,-824.78 3802.6,-831.65"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge74" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M3834.93,-870.87C3843.98,-861.92 3854.26,-851.75 3863.82,-842.3"/>
<polygon fill="black" stroke="black" points="3866.3,-844.77 3870.95,-835.25 3861.38,-839.79 3866.3,-844.77"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge75" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M4084.99,-870.98C4053.59,-860.72 4017.23,-848.82 3984.9,-838.25"/>
<polygon fill="black" stroke="black" points="3985.6,-834.8 3975.01,-835.01 3983.43,-841.45 3985.6,-834.8"/>
</g>
<!-- mha_out_5 -->
<g id="node58" class="node">
<title>mha_out_5</title>
<polygon fill="lightblue" stroke="black" points="4242,-719.5 3906,-719.5 3906,-666.5 4242,-666.5 4242,-719.5"/>
<text text-anchor="middle" x="4074" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="4074" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4074" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge76" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M3937.16,-781.75C3963.3,-764.98 3997.56,-743.02 4025.25,-725.26"/>
<polygon fill="black" stroke="black" points="4027.47,-728 4033.99,-719.65 4023.69,-722.1 4027.47,-728"/>
</g>
<!-- residual1_5 -->
<g id="node59" class="node">
<title>residual1_5</title>
<polygon fill="lightcoral" stroke="black" points="4574.86,-604 4005.58,-604 3859.14,-498 4428.42,-498 4574.86,-604"/>
<text text-anchor="middle" x="4217" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="4217" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4217" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge78" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M4100.23,-666.32C4116.03,-650.85 4136.84,-630.48 4156.5,-611.23"/>
<polygon fill="black" stroke="black" points="4158.99,-613.69 4163.69,-604.19 4154.09,-608.69 4158.99,-613.69"/>
</g>
<!-- ln2_5 -->
<g id="node60" class="node">
<title>ln2_5</title>
<polygon fill="lightyellow" stroke="black" points="7063,-1600.74 6893,-1600.74 6893,-1547.74 7063,-1547.74 7063,-1600.74"/>
<text text-anchor="middle" x="6978" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="6978" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6978" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn1_5 -->
<g id="node61" class="node">
<title>ffn1_5</title>
<polygon fill="lightblue" stroke="black" points="6940.5,-1511.74 6595.5,-1511.74 6595.5,-1458.74 6940.5,-1458.74 6940.5,-1511.74"/>
<text text-anchor="middle" x="6768" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="6768" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="6768" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ln2_5&#45;&gt;ffn1_5 -->
<g id="edge80" class="edge">
<title>ln2_5&#45;&gt;ffn1_5</title>
<path fill="none" stroke="black" d="M6916.41,-1547.73C6892.16,-1537.68 6864.15,-1526.08 6839.05,-1515.68"/>
<polygon fill="black" stroke="black" points="6840.17,-1512.35 6829.59,-1511.75 6837.49,-1518.82 6840.17,-1512.35"/>
</g>
<!-- gelu_5 -->
<g id="node62" class="node">
<title>gelu_5</title>
<polygon fill="lightblue" stroke="black" points="6801.5,-1422.74 6622.5,-1422.74 6622.5,-1369.74 6801.5,-1369.74 6801.5,-1422.74"/>
<text text-anchor="middle" x="6712" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="6712" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="6712" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn1_5&#45;&gt;gelu_5 -->
<g id="edge81" class="edge">
<title>ffn1_5&#45;&gt;gelu_5</title>
<path fill="none" stroke="black" d="M6751.5,-1458.61C6746.02,-1450.1 6739.84,-1440.49 6734.01,-1431.44"/>
<polygon fill="black" stroke="black" points="6736.93,-1429.5 6728.57,-1422.99 6731.04,-1433.29 6736.93,-1429.5"/>
</g>
<!-- ffn2_5 -->
<g id="node63" class="node">
<title>ffn2_5</title>
<polygon fill="lightblue" stroke="black" points="6842.5,-1333.74 6497.5,-1333.74 6497.5,-1280.74 6842.5,-1280.74 6842.5,-1333.74"/>
<text text-anchor="middle" x="6670" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="6670" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6670" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- gelu_5&#45;&gt;ffn2_5 -->
<g id="edge82" class="edge">
<title>gelu_5&#45;&gt;ffn2_5</title>
<path fill="none" stroke="black" d="M6699.63,-1369.61C6695.6,-1361.27 6691.07,-1351.88 6686.78,-1343"/>
<polygon fill="black" stroke="black" points="6689.93,-1341.47 6682.43,-1333.99 6683.63,-1344.52 6689.93,-1341.47"/>
</g>
<!-- residual2_5 -->
<g id="node64" class="node">
<title>residual2_5</title>
<polygon fill="lightcoral" stroke="black" points="7006.86,-1244.74 6437.58,-1244.74 6291.14,-1138.74 6860.42,-1138.74 7006.86,-1244.74"/>
<text text-anchor="middle" x="6649" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="6649" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6649" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- ffn2_5&#45;&gt;residual2_5 -->
<g id="edge84" class="edge">
<title>ffn2_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M6665.23,-1280.49C6663.8,-1272.7 6662.15,-1263.8 6660.47,-1254.72"/>
<polygon fill="black" stroke="black" points="6663.9,-1254.03 6658.64,-1244.84 6657.02,-1255.31 6663.9,-1254.03"/>
</g>
<!-- comm_5_6 -->
<g id="node78" class="node">
<title>comm_5_6</title>
<ellipse fill="lightgreen" stroke="black" cx="5459" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="5459" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 4 → GPU 5</text>
<text text-anchor="middle" x="5459" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_5&#45;&gt;comm_5_6 -->
<g id="edge85" class="edge">
<title>residual2_5&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M6292.13,-1139.74C6289.08,-1139.4 6286.03,-1139.07 6283,-1138.74 6036.26,-1111.98 5746.69,-1093.13 5584.87,-1083.72"/>
<polygon fill="black" stroke="black" points="5585.06,-1080.23 5574.87,-1083.15 5584.65,-1087.22 5585.06,-1080.23"/>
</g>
<!-- comm_4_5&#45;&gt;ln1_5 -->
<g id="edge69" class="edge">
<title>comm_4_5&#45;&gt;ln1_5</title>
<path fill="none" stroke="black" d="M4278.06,-1055.91C4220.22,-1042.36 4142.17,-1024.08 4081.31,-1009.83"/>
<polygon fill="black" stroke="black" points="4081.85,-1006.36 4071.31,-1007.48 4080.25,-1013.17 4081.85,-1006.36"/>
</g>
<!-- comm_4_5&#45;&gt;residual1_5 -->
<g id="edge77" class="edge">
<title>comm_4_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M4359,-1048.87C4359,-1014.47 4359,-951.93 4359,-898.5 4359,-898.5 4359,-898.5 4359,-807.5 4359,-733.47 4312.89,-660.84 4273.22,-612.06"/>
<polygon fill="black" stroke="black" points="4275.74,-609.61 4266.66,-604.14 4270.34,-614.08 4275.74,-609.61"/>
</g>
<!-- ln1_6 -->
<g id="node66" class="node">
<title>ln1_6</title>
<polygon fill="lightyellow" stroke="black" points="5171,-1013 5001,-1013 5001,-960 5171,-960 5171,-1013"/>
<text text-anchor="middle" x="5086" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="5086" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5086" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_q_6 -->
<g id="node67" class="node">
<title>mha_q_6</title>
<polygon fill="lightblue" stroke="black" points="4723,-924 4387,-924 4387,-871 4723,-871 4723,-924"/>
<text text-anchor="middle" x="4555" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="4555" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4555" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_q_6 -->
<g id="edge87" class="edge">
<title>ln1_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M5000.98,-971.57C4925.72,-959.24 4813.71,-940.89 4720.77,-925.66"/>
<polygon fill="black" stroke="black" points="4721.12,-922.17 4710.69,-924.01 4719.99,-929.08 4721.12,-922.17"/>
</g>
<!-- mha_k_6 -->
<g id="node68" class="node">
<title>mha_k_6</title>
<polygon fill="lightblue" stroke="black" points="5077,-924 4741,-924 4741,-871 5077,-871 5077,-924"/>
<text text-anchor="middle" x="4909" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="4909" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4909" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_k_6 -->
<g id="edge88" class="edge">
<title>ln1_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M5033.85,-959.87C5013.87,-950.04 4990.88,-938.75 4970.13,-928.55"/>
<polygon fill="black" stroke="black" points="4971.6,-925.37 4961.08,-924.1 4968.51,-931.65 4971.6,-925.37"/>
</g>
<!-- mha_v_6 -->
<g id="node69" class="node">
<title>mha_v_6</title>
<polygon fill="lightblue" stroke="black" points="5431,-924 5095,-924 5095,-871 5431,-871 5431,-924"/>
<text text-anchor="middle" x="5263" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="5263" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5263" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln1_6&#45;&gt;mha_v_6 -->
<g id="edge89" class="edge">
<title>ln1_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M5138.15,-959.87C5158.13,-950.04 5181.12,-938.75 5201.87,-928.55"/>
<polygon fill="black" stroke="black" points="5203.49,-931.65 5210.92,-924.1 5200.4,-925.37 5203.49,-931.65"/>
</g>
<!-- mha_attn_6 -->
<g id="node70" class="node">
<title>mha_attn_6</title>
<polygon fill="lightblue" stroke="black" points="5082,-835 4912,-835 4912,-782 5082,-782 5082,-835"/>
<text text-anchor="middle" x="4997" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="4997" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="4997" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge90" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M4684.63,-870.98C4754.14,-857.3 4838.3,-840.74 4901.74,-828.25"/>
<polygon fill="black" stroke="black" points="4902.6,-831.65 4911.74,-826.28 4901.25,-824.78 4902.6,-831.65"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge91" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M4934.93,-870.87C4943.98,-861.92 4954.26,-851.75 4963.82,-842.3"/>
<polygon fill="black" stroke="black" points="4966.3,-844.77 4970.95,-835.25 4961.38,-839.79 4966.3,-844.77"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge92" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M5184.99,-870.98C5153.59,-860.72 5117.23,-848.82 5084.9,-838.25"/>
<polygon fill="black" stroke="black" points="5085.6,-834.8 5075.01,-835.01 5083.43,-841.45 5085.6,-834.8"/>
</g>
<!-- mha_out_6 -->
<g id="node71" class="node">
<title>mha_out_6</title>
<polygon fill="lightblue" stroke="black" points="5254,-719.5 4918,-719.5 4918,-666.5 5254,-666.5 5254,-719.5"/>
<text text-anchor="middle" x="5086" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="5086" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5086" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge93" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M5017.2,-781.75C5029.71,-765.78 5045.93,-745.1 5059.48,-727.82"/>
<polygon fill="black" stroke="black" points="5062.47,-729.68 5065.88,-719.65 5056.96,-725.36 5062.47,-729.68"/>
</g>
<!-- residual1_6 -->
<g id="node72" class="node">
<title>residual1_6</title>
<polygon fill="lightcoral" stroke="black" points="5630.86,-604 5061.58,-604 4915.14,-498 5484.42,-498 5630.86,-604"/>
<text text-anchor="middle" x="5273" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="5273" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5273" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge95" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M5120.3,-666.32C5141.32,-650.58 5169.13,-629.77 5195.24,-610.21"/>
<polygon fill="black" stroke="black" points="5197.38,-612.99 5203.29,-604.19 5193.18,-607.38 5197.38,-612.99"/>
</g>
<!-- ln2_6 -->
<g id="node73" class="node">
<title>ln2_6</title>
<polygon fill="lightyellow" stroke="black" points="7903,-1600.74 7733,-1600.74 7733,-1547.74 7903,-1547.74 7903,-1600.74"/>
<text text-anchor="middle" x="7818" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="7818" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7818" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn1_6 -->
<g id="node74" class="node">
<title>ffn1_6</title>
<polygon fill="lightblue" stroke="black" points="7851.5,-1511.74 7506.5,-1511.74 7506.5,-1458.74 7851.5,-1458.74 7851.5,-1511.74"/>
<text text-anchor="middle" x="7679" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="7679" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="7679" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ln2_6&#45;&gt;ffn1_6 -->
<g id="edge97" class="edge">
<title>ln2_6&#45;&gt;ffn1_6</title>
<path fill="none" stroke="black" d="M7777.05,-1547.61C7761.91,-1538.13 7744.59,-1527.29 7728.76,-1517.38"/>
<polygon fill="black" stroke="black" points="7730.47,-1514.33 7720.14,-1511.99 7726.76,-1520.26 7730.47,-1514.33"/>
</g>
<!-- gelu_6 -->
<g id="node75" class="node">
<title>gelu_6</title>
<polygon fill="lightblue" stroke="black" points="7576.5,-1422.74 7397.5,-1422.74 7397.5,-1369.74 7576.5,-1369.74 7576.5,-1422.74"/>
<text text-anchor="middle" x="7487" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="7487" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="7487" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn1_6&#45;&gt;gelu_6 -->
<g id="edge98" class="edge">
<title>ffn1_6&#45;&gt;gelu_6</title>
<path fill="none" stroke="black" d="M7622.69,-1458.73C7600.71,-1448.77 7575.36,-1437.28 7552.57,-1426.95"/>
<polygon fill="black" stroke="black" points="7553.86,-1423.69 7543.31,-1422.75 7550.97,-1430.07 7553.86,-1423.69"/>
</g>
<!-- ffn2_6 -->
<g id="node76" class="node">
<title>ffn2_6</title>
<polygon fill="lightblue" stroke="black" points="7589.5,-1333.74 7244.5,-1333.74 7244.5,-1280.74 7589.5,-1280.74 7589.5,-1333.74"/>
<text text-anchor="middle" x="7417" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="7417" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7417" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- gelu_6&#45;&gt;ffn2_6 -->
<g id="edge99" class="edge">
<title>gelu_6&#45;&gt;ffn2_6</title>
<path fill="none" stroke="black" d="M7466.38,-1369.61C7459.39,-1360.92 7451.48,-1351.09 7444.07,-1341.88"/>
<polygon fill="black" stroke="black" points="7446.71,-1339.59 7437.72,-1333.99 7441.26,-1343.98 7446.71,-1339.59"/>
</g>
<!-- residual2_6 -->
<g id="node77" class="node">
<title>residual2_6</title>
<polygon fill="lightcoral" stroke="black" points="7739.86,-1244.74 7170.58,-1244.74 7024.14,-1138.74 7593.42,-1138.74 7739.86,-1244.74"/>
<text text-anchor="middle" x="7382" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="7382" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7382" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- ffn2_6&#45;&gt;residual2_6 -->
<g id="edge101" class="edge">
<title>ffn2_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M7409.06,-1280.49C7406.63,-1272.62 7403.85,-1263.61 7401.02,-1254.43"/>
<polygon fill="black" stroke="black" points="7404.36,-1253.36 7398.07,-1244.84 7397.67,-1255.42 7404.36,-1253.36"/>
</g>
<!-- comm_6_7 -->
<g id="node91" class="node">
<title>comm_6_7</title>
<ellipse fill="lightgreen" stroke="black" cx="6559" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="6559" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 5 → GPU 6</text>
<text text-anchor="middle" x="6559" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_6&#45;&gt;comm_6_7 -->
<g id="edge102" class="edge">
<title>residual2_6&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M7026.06,-1140.14C7022.69,-1139.67 7019.34,-1139.2 7016,-1138.74 6897.97,-1122.37 6762.72,-1104.12 6670.17,-1091.71"/>
<polygon fill="black" stroke="black" points="6670.6,-1088.24 6660.22,-1090.38 6669.67,-1095.18 6670.6,-1088.24"/>
</g>
<!-- comm_5_6&#45;&gt;ln1_6 -->
<g id="edge86" class="edge">
<title>comm_5_6&#45;&gt;ln1_6</title>
<path fill="none" stroke="black" d="M5378.06,-1055.91C5320.22,-1042.36 5242.17,-1024.08 5181.31,-1009.83"/>
<polygon fill="black" stroke="black" points="5181.85,-1006.36 5171.31,-1007.48 5180.25,-1013.17 5181.85,-1006.36"/>
</g>
<!-- comm_5_6&#45;&gt;residual1_6 -->
<g id="edge94" class="edge">
<title>comm_5_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M5459,-1048.87C5459,-1014.47 5459,-951.93 5459,-898.5 5459,-898.5 5459,-898.5 5459,-807.5 5459,-728.67 5400.41,-657.84 5348.99,-610.86"/>
<polygon fill="black" stroke="black" points="5351.25,-608.18 5341.47,-604.11 5346.57,-613.39 5351.25,-608.18"/>
</g>
<!-- ln1_7 -->
<g id="node79" class="node">
<title>ln1_7</title>
<polygon fill="lightyellow" stroke="black" points="6271,-1013 6101,-1013 6101,-960 6271,-960 6271,-1013"/>
<text text-anchor="middle" x="6186" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="6186" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6186" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_q_7 -->
<g id="node80" class="node">
<title>mha_q_7</title>
<polygon fill="lightblue" stroke="black" points="5823,-924 5487,-924 5487,-871 5823,-871 5823,-924"/>
<text text-anchor="middle" x="5655" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="5655" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="5655" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_q_7 -->
<g id="edge104" class="edge">
<title>ln1_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M6100.98,-971.57C6025.72,-959.24 5913.71,-940.89 5820.77,-925.66"/>
<polygon fill="black" stroke="black" points="5821.12,-922.17 5810.69,-924.01 5819.99,-929.08 5821.12,-922.17"/>
</g>
<!-- mha_k_7 -->
<g id="node81" class="node">
<title>mha_k_7</title>
<polygon fill="lightblue" stroke="black" points="6177,-924 5841,-924 5841,-871 6177,-871 6177,-924"/>
<text text-anchor="middle" x="6009" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="6009" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6009" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_k_7 -->
<g id="edge105" class="edge">
<title>ln1_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M6133.85,-959.87C6113.87,-950.04 6090.88,-938.75 6070.13,-928.55"/>
<polygon fill="black" stroke="black" points="6071.6,-925.37 6061.08,-924.1 6068.51,-931.65 6071.6,-925.37"/>
</g>
<!-- mha_v_7 -->
<g id="node82" class="node">
<title>mha_v_7</title>
<polygon fill="lightblue" stroke="black" points="6531,-924 6195,-924 6195,-871 6531,-871 6531,-924"/>
<text text-anchor="middle" x="6363" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="6363" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6363" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln1_7&#45;&gt;mha_v_7 -->
<g id="edge106" class="edge">
<title>ln1_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M6238.15,-959.87C6258.13,-950.04 6281.12,-938.75 6301.87,-928.55"/>
<polygon fill="black" stroke="black" points="6303.49,-931.65 6310.92,-924.1 6300.4,-925.37 6303.49,-931.65"/>
</g>
<!-- mha_attn_7 -->
<g id="node83" class="node">
<title>mha_attn_7</title>
<polygon fill="lightblue" stroke="black" points="6228,-835 6058,-835 6058,-782 6228,-782 6228,-835"/>
<text text-anchor="middle" x="6143" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="6143" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6143" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge107" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M5798.12,-870.98C5878.54,-856.65 5976.7,-839.15 6047.7,-826.49"/>
<polygon fill="black" stroke="black" points="6048.74,-829.86 6057.98,-824.66 6047.52,-822.97 6048.74,-829.86"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge108" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M6048.48,-870.87C6062.94,-861.48 6079.46,-850.75 6094.61,-840.92"/>
<polygon fill="black" stroke="black" points="6096.86,-843.63 6103.34,-835.25 6093.05,-837.76 6096.86,-843.63"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge109" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M6298.48,-870.98C6272.96,-860.89 6243.48,-849.23 6217.09,-838.8"/>
<polygon fill="black" stroke="black" points="6218.11,-835.44 6207.52,-835.01 6215.53,-841.95 6218.11,-835.44"/>
</g>
<!-- mha_out_7 -->
<g id="node84" class="node">
<title>mha_out_7</title>
<polygon fill="lightblue" stroke="black" points="6446,-719.5 6110,-719.5 6110,-666.5 6446,-666.5 6446,-719.5"/>
<text text-anchor="middle" x="6278" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="6278" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6278" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge110" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M6173.63,-781.75C6193.22,-765.27 6218.79,-743.78 6239.72,-726.19"/>
<polygon fill="black" stroke="black" points="6242.09,-728.77 6247.49,-719.65 6237.58,-723.41 6242.09,-728.77"/>
</g>
<!-- residual1_7 -->
<g id="node85" class="node">
<title>residual1_7</title>
<polygon fill="lightcoral" stroke="black" points="6775.86,-604 6206.58,-604 6060.14,-498 6629.42,-498 6775.86,-604"/>
<text text-anchor="middle" x="6418" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="6418" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6418" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge112" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M6303.68,-666.32C6319.08,-650.92 6339.34,-630.66 6358.52,-611.48"/>
<polygon fill="black" stroke="black" points="6361.21,-613.74 6365.81,-604.19 6356.26,-608.79 6361.21,-613.74"/>
</g>
<!-- ln2_7 -->
<g id="node86" class="node">
<title>ln2_7</title>
<polygon fill="lightyellow" stroke="black" points="8527,-1600.74 8357,-1600.74 8357,-1547.74 8527,-1547.74 8527,-1600.74"/>
<text text-anchor="middle" x="8442" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8442" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8442" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn1_7 -->
<g id="node87" class="node">
<title>ffn1_7</title>
<polygon fill="lightblue" stroke="black" points="8529.5,-1511.74 8184.5,-1511.74 8184.5,-1458.74 8529.5,-1458.74 8529.5,-1511.74"/>
<text text-anchor="middle" x="8357" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="8357" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="8357" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ln2_7&#45;&gt;ffn1_7 -->
<g id="edge114" class="edge">
<title>ln2_7&#45;&gt;ffn1_7</title>
<path fill="none" stroke="black" d="M8416.96,-1547.61C8408.3,-1538.75 8398.48,-1528.69 8389.32,-1519.32"/>
<polygon fill="black" stroke="black" points="8391.65,-1516.7 8382.16,-1511.99 8386.64,-1521.59 8391.65,-1516.7"/>
</g>
<!-- gelu_7 -->
<g id="node88" class="node">
<title>gelu_7</title>
<polygon fill="lightblue" stroke="black" points="8404.5,-1422.74 8225.5,-1422.74 8225.5,-1369.74 8404.5,-1369.74 8404.5,-1422.74"/>
<text text-anchor="middle" x="8315" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8315" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="8315" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn1_7&#45;&gt;gelu_7 -->
<g id="edge115" class="edge">
<title>ffn1_7&#45;&gt;gelu_7</title>
<path fill="none" stroke="black" d="M8344.63,-1458.61C8340.6,-1450.27 8336.07,-1440.88 8331.78,-1432"/>
<polygon fill="black" stroke="black" points="8334.93,-1430.47 8327.43,-1422.99 8328.63,-1433.52 8334.93,-1430.47"/>
</g>
<!-- ffn2_7 -->
<g id="node89" class="node">
<title>ffn2_7</title>
<polygon fill="lightblue" stroke="black" points="8446.5,-1333.74 8101.5,-1333.74 8101.5,-1280.74 8446.5,-1280.74 8446.5,-1333.74"/>
<text text-anchor="middle" x="8274" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="8274" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8274" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- gelu_7&#45;&gt;ffn2_7 -->
<g id="edge116" class="edge">
<title>gelu_7&#45;&gt;ffn2_7</title>
<path fill="none" stroke="black" d="M8302.92,-1369.61C8299.03,-1361.36 8294.66,-1352.08 8290.51,-1343.28"/>
<polygon fill="black" stroke="black" points="8293.56,-1341.54 8286.13,-1333.99 8287.23,-1344.53 8293.56,-1341.54"/>
</g>
<!-- residual2_7 -->
<g id="node90" class="node">
<title>residual2_7</title>
<polygon fill="lightcoral" stroke="black" points="8472.86,-1244.74 7903.58,-1244.74 7757.14,-1138.74 8326.42,-1138.74 8472.86,-1244.74"/>
<text text-anchor="middle" x="8115" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="8115" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8115" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- ffn2_7&#45;&gt;residual2_7 -->
<g id="edge118" class="edge">
<title>ffn2_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M8237.92,-1280.49C8225.4,-1271.55 8210.8,-1261.12 8196.13,-1250.65"/>
<polygon fill="black" stroke="black" points="8198.15,-1247.8 8187.98,-1244.84 8194.09,-1253.5 8198.15,-1247.8"/>
</g>
<!-- comm_7_8 -->
<g id="node104" class="node">
<title>comm_7_8</title>
<ellipse fill="lightgreen" stroke="black" cx="7659" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="7659" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 6 → GPU 7</text>
<text text-anchor="middle" x="7659" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_7&#45;&gt;comm_7_8 -->
<g id="edge119" class="edge">
<title>residual2_7&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M7906.68,-1138.72C7850.38,-1124.66 7792.46,-1110.2 7746.8,-1098.8"/>
<polygon fill="black" stroke="black" points="7747.51,-1095.36 7736.96,-1096.34 7745.81,-1102.16 7747.51,-1095.36"/>
</g>
<!-- comm_6_7&#45;&gt;ln1_7 -->
<g id="edge103" class="edge">
<title>comm_6_7&#45;&gt;ln1_7</title>
<path fill="none" stroke="black" d="M6478.06,-1055.91C6420.22,-1042.36 6342.17,-1024.08 6281.31,-1009.83"/>
<polygon fill="black" stroke="black" points="6281.85,-1006.36 6271.31,-1007.48 6280.25,-1013.17 6281.85,-1006.36"/>
</g>
<!-- comm_6_7&#45;&gt;residual1_7 -->
<g id="edge111" class="edge">
<title>comm_6_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M6559,-1048.87C6559,-1014.47 6559,-951.93 6559,-898.5 6559,-898.5 6559,-898.5 6559,-807.5 6559,-733.59 6513.21,-660.95 6473.83,-612.13"/>
<polygon fill="black" stroke="black" points="6476.37,-609.71 6467.31,-604.2 6470.96,-614.15 6476.37,-609.71"/>
</g>
<!-- ln1_8 -->
<g id="node92" class="node">
<title>ln1_8</title>
<polygon fill="lightyellow" stroke="black" points="7371,-1013 7201,-1013 7201,-960 7371,-960 7371,-1013"/>
<text text-anchor="middle" x="7286" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="7286" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7286" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_q_8 -->
<g id="node93" class="node">
<title>mha_q_8</title>
<polygon fill="lightblue" stroke="black" points="6923,-924 6587,-924 6587,-871 6923,-871 6923,-924"/>
<text text-anchor="middle" x="6755" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="6755" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="6755" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_q_8 -->
<g id="edge121" class="edge">
<title>ln1_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M7200.98,-971.57C7125.72,-959.24 7013.71,-940.89 6920.77,-925.66"/>
<polygon fill="black" stroke="black" points="6921.12,-922.17 6910.69,-924.01 6919.99,-929.08 6921.12,-922.17"/>
</g>
<!-- mha_k_8 -->
<g id="node94" class="node">
<title>mha_k_8</title>
<polygon fill="lightblue" stroke="black" points="7277,-924 6941,-924 6941,-871 7277,-871 7277,-924"/>
<text text-anchor="middle" x="7109" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="7109" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7109" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_k_8 -->
<g id="edge122" class="edge">
<title>ln1_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M7233.85,-959.87C7213.87,-950.04 7190.88,-938.75 7170.13,-928.55"/>
<polygon fill="black" stroke="black" points="7171.6,-925.37 7161.08,-924.1 7168.51,-931.65 7171.6,-925.37"/>
</g>
<!-- mha_v_8 -->
<g id="node95" class="node">
<title>mha_v_8</title>
<polygon fill="lightblue" stroke="black" points="7631,-924 7295,-924 7295,-871 7631,-871 7631,-924"/>
<text text-anchor="middle" x="7463" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="7463" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7463" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln1_8&#45;&gt;mha_v_8 -->
<g id="edge123" class="edge">
<title>ln1_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M7338.15,-959.87C7358.13,-950.04 7381.12,-938.75 7401.87,-928.55"/>
<polygon fill="black" stroke="black" points="7403.49,-931.65 7410.92,-924.1 7400.4,-925.37 7403.49,-931.65"/>
</g>
<!-- mha_attn_8 -->
<g id="node96" class="node">
<title>mha_attn_8</title>
<polygon fill="lightblue" stroke="black" points="7282,-835 7112,-835 7112,-782 7282,-782 7282,-835"/>
<text text-anchor="middle" x="7197" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="7197" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7197" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge124" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M6884.63,-870.98C6954.14,-857.3 7038.3,-840.74 7101.74,-828.25"/>
<polygon fill="black" stroke="black" points="7102.6,-831.65 7111.74,-826.28 7101.25,-824.78 7102.6,-831.65"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge125" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M7134.93,-870.87C7143.98,-861.92 7154.26,-851.75 7163.82,-842.3"/>
<polygon fill="black" stroke="black" points="7166.3,-844.77 7170.95,-835.25 7161.38,-839.79 7166.3,-844.77"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge126" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M7384.99,-870.98C7353.59,-860.72 7317.23,-848.82 7284.9,-838.25"/>
<polygon fill="black" stroke="black" points="7285.6,-834.8 7275.01,-835.01 7283.43,-841.45 7285.6,-834.8"/>
</g>
<!-- mha_out_8 -->
<g id="node97" class="node">
<title>mha_out_8</title>
<polygon fill="lightblue" stroke="black" points="7542,-719.5 7206,-719.5 7206,-666.5 7542,-666.5 7542,-719.5"/>
<text text-anchor="middle" x="7374" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="7374" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7374" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge127" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M7237.16,-781.75C7263.3,-764.98 7297.56,-743.02 7325.25,-725.26"/>
<polygon fill="black" stroke="black" points="7327.47,-728 7333.99,-719.65 7323.69,-722.1 7327.47,-728"/>
</g>
<!-- residual1_8 -->
<g id="node98" class="node">
<title>residual1_8</title>
<polygon fill="lightcoral" stroke="black" points="7874.86,-604 7305.58,-604 7159.14,-498 7728.42,-498 7874.86,-604"/>
<text text-anchor="middle" x="7517" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="7517" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7517" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge129" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7400.23,-666.32C7416.03,-650.85 7436.84,-630.48 7456.5,-611.23"/>
<polygon fill="black" stroke="black" points="7458.99,-613.69 7463.69,-604.19 7454.09,-608.69 7458.99,-613.69"/>
</g>
<!-- ln2_8 -->
<g id="node99" class="node">
<title>ln2_8</title>
<polygon fill="lightyellow" stroke="black" points="9059,-1600.74 8889,-1600.74 8889,-1547.74 9059,-1547.74 9059,-1600.74"/>
<text text-anchor="middle" x="8974" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="8974" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8974" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn1_8 -->
<g id="node100" class="node">
<title>ffn1_8</title>
<polygon fill="lightblue" stroke="black" points="9078.5,-1511.74 8733.5,-1511.74 8733.5,-1458.74 9078.5,-1458.74 9078.5,-1511.74"/>
<text text-anchor="middle" x="8906" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="8906" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="8906" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ln2_8&#45;&gt;ffn1_8 -->
<g id="edge131" class="edge">
<title>ln2_8&#45;&gt;ffn1_8</title>
<path fill="none" stroke="black" d="M8953.97,-1547.61C8947.18,-1538.92 8939.49,-1529.09 8932.29,-1519.88"/>
<polygon fill="black" stroke="black" points="8935.04,-1517.71 8926.13,-1511.99 8929.53,-1522.02 8935.04,-1517.71"/>
</g>
<!-- gelu_8 -->
<g id="node101" class="node">
<title>gelu_8</title>
<polygon fill="lightblue" stroke="black" points="8978.5,-1422.74 8799.5,-1422.74 8799.5,-1369.74 8978.5,-1369.74 8978.5,-1422.74"/>
<text text-anchor="middle" x="8889" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="8889" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="8889" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn1_8&#45;&gt;gelu_8 -->
<g id="edge132" class="edge">
<title>ffn1_8&#45;&gt;gelu_8</title>
<path fill="none" stroke="black" d="M8900.99,-1458.61C8899.41,-1450.54 8897.64,-1441.48 8895.96,-1432.84"/>
<polygon fill="black" stroke="black" points="8899.38,-1432.13 8894.03,-1422.99 8892.51,-1433.48 8899.38,-1432.13"/>
</g>
<!-- ffn2_8 -->
<g id="node102" class="node">
<title>ffn2_8</title>
<polygon fill="lightblue" stroke="black" points="9045.5,-1333.74 8700.5,-1333.74 8700.5,-1280.74 9045.5,-1280.74 9045.5,-1333.74"/>
<text text-anchor="middle" x="8873" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="8873" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8873" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- gelu_8&#45;&gt;ffn2_8 -->
<g id="edge133" class="edge">
<title>gelu_8&#45;&gt;ffn2_8</title>
<path fill="none" stroke="black" d="M8884.29,-1369.61C8882.8,-1361.54 8881.14,-1352.48 8879.55,-1343.84"/>
<polygon fill="black" stroke="black" points="8882.99,-1343.19 8877.74,-1333.99 8876.1,-1344.46 8882.99,-1343.19"/>
</g>
<!-- residual2_8 -->
<g id="node103" class="node">
<title>residual2_8</title>
<polygon fill="lightcoral" stroke="black" points="9205.86,-1244.74 8636.58,-1244.74 8490.14,-1138.74 9059.42,-1138.74 9205.86,-1244.74"/>
<text text-anchor="middle" x="8848" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="8848" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8848" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- ffn2_8&#45;&gt;residual2_8 -->
<g id="edge135" class="edge">
<title>ffn2_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M8867.33,-1280.49C8865.61,-1272.7 8863.65,-1263.8 8861.65,-1254.72"/>
<polygon fill="black" stroke="black" points="8865.04,-1253.85 8859.48,-1244.84 8858.21,-1255.36 8865.04,-1253.85"/>
</g>
<!-- comm_8_9 -->
<g id="node117" class="node">
<title>comm_8_9</title>
<ellipse fill="lightgreen" stroke="black" cx="8759" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="8759" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
<text text-anchor="middle" x="8759" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_8&#45;&gt;comm_8_9 -->
<g id="edge136" class="edge">
<title>residual2_8&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M8807.15,-1138.47C8799.74,-1128.99 8792.19,-1119.33 8785.34,-1110.57"/>
<polygon fill="black" stroke="black" points="8787.92,-1108.19 8779.01,-1102.47 8782.41,-1112.5 8787.92,-1108.19"/>
</g>
<!-- comm_7_8&#45;&gt;ln1_8 -->
<g id="edge120" class="edge">
<title>comm_7_8&#45;&gt;ln1_8</title>
<path fill="none" stroke="black" d="M7578.06,-1055.91C7520.22,-1042.36 7442.17,-1024.08 7381.31,-1009.83"/>
<polygon fill="black" stroke="black" points="7381.85,-1006.36 7371.31,-1007.48 7380.25,-1013.17 7381.85,-1006.36"/>
</g>
<!-- comm_7_8&#45;&gt;residual1_8 -->
<g id="edge128" class="edge">
<title>comm_7_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M7659,-1048.87C7659,-1014.47 7659,-951.93 7659,-898.5 7659,-898.5 7659,-898.5 7659,-807.5 7659,-733.47 7612.89,-660.84 7573.22,-612.06"/>
<polygon fill="black" stroke="black" points="7575.74,-609.61 7566.66,-604.14 7570.34,-614.08 7575.74,-609.61"/>
</g>
<!-- ln1_9 -->
<g id="node105" class="node">
<title>ln1_9</title>
<polygon fill="lightyellow" stroke="black" points="8471,-1013 8301,-1013 8301,-960 8471,-960 8471,-1013"/>
<text text-anchor="middle" x="8386" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="8386" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8386" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_q_9 -->
<g id="node106" class="node">
<title>mha_q_9</title>
<polygon fill="lightblue" stroke="black" points="8023,-924 7687,-924 7687,-871 8023,-871 8023,-924"/>
<text text-anchor="middle" x="7855" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="7855" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="7855" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_q_9 -->
<g id="edge138" class="edge">
<title>ln1_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M8300.98,-971.57C8225.72,-959.24 8113.71,-940.89 8020.77,-925.66"/>
<polygon fill="black" stroke="black" points="8021.12,-922.17 8010.69,-924.01 8019.99,-929.08 8021.12,-922.17"/>
</g>
<!-- mha_k_9 -->
<g id="node107" class="node">
<title>mha_k_9</title>
<polygon fill="lightblue" stroke="black" points="8377,-924 8041,-924 8041,-871 8377,-871 8377,-924"/>
<text text-anchor="middle" x="8209" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="8209" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8209" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_k_9 -->
<g id="edge139" class="edge">
<title>ln1_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M8333.85,-959.87C8313.87,-950.04 8290.88,-938.75 8270.13,-928.55"/>
<polygon fill="black" stroke="black" points="8271.6,-925.37 8261.08,-924.1 8268.51,-931.65 8271.6,-925.37"/>
</g>
<!-- mha_v_9 -->
<g id="node108" class="node">
<title>mha_v_9</title>
<polygon fill="lightblue" stroke="black" points="8731,-924 8395,-924 8395,-871 8731,-871 8731,-924"/>
<text text-anchor="middle" x="8563" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="8563" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8563" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln1_9&#45;&gt;mha_v_9 -->
<g id="edge140" class="edge">
<title>ln1_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M8438.15,-959.87C8458.13,-950.04 8481.12,-938.75 8501.87,-928.55"/>
<polygon fill="black" stroke="black" points="8503.49,-931.65 8510.92,-924.1 8500.4,-925.37 8503.49,-931.65"/>
</g>
<!-- mha_attn_9 -->
<g id="node109" class="node">
<title>mha_attn_9</title>
<polygon fill="lightblue" stroke="black" points="8382,-835 8212,-835 8212,-782 8382,-782 8382,-835"/>
<text text-anchor="middle" x="8297" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="8297" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8297" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge141" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M7984.63,-870.98C8054.14,-857.3 8138.3,-840.74 8201.74,-828.25"/>
<polygon fill="black" stroke="black" points="8202.6,-831.65 8211.74,-826.28 8201.25,-824.78 8202.6,-831.65"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge142" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M8234.93,-870.87C8243.98,-861.92 8254.26,-851.75 8263.82,-842.3"/>
<polygon fill="black" stroke="black" points="8266.3,-844.77 8270.95,-835.25 8261.38,-839.79 8266.3,-844.77"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge143" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M8484.99,-870.98C8453.59,-860.72 8417.23,-848.82 8384.9,-838.25"/>
<polygon fill="black" stroke="black" points="8385.6,-834.8 8375.01,-835.01 8383.43,-841.45 8385.6,-834.8"/>
</g>
<!-- mha_out_9 -->
<g id="node110" class="node">
<title>mha_out_9</title>
<polygon fill="lightblue" stroke="black" points="8642,-719.5 8306,-719.5 8306,-666.5 8642,-666.5 8642,-719.5"/>
<text text-anchor="middle" x="8474" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="8474" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8474" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge144" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M8337.16,-781.75C8363.3,-764.98 8397.56,-743.02 8425.25,-725.26"/>
<polygon fill="black" stroke="black" points="8427.47,-728 8433.99,-719.65 8423.69,-722.1 8427.47,-728"/>
</g>
<!-- residual1_9 -->
<g id="node111" class="node">
<title>residual1_9</title>
<polygon fill="lightcoral" stroke="black" points="8974.86,-604 8405.58,-604 8259.14,-498 8828.42,-498 8974.86,-604"/>
<text text-anchor="middle" x="8617" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="8617" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8617" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge146" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M8500.23,-666.32C8516.03,-650.85 8536.84,-630.48 8556.5,-611.23"/>
<polygon fill="black" stroke="black" points="8558.99,-613.69 8563.69,-604.19 8554.09,-608.69 8558.99,-613.69"/>
</g>
<!-- ln2_9 -->
<g id="node112" class="node">
<title>ln2_9</title>
<polygon fill="lightyellow" stroke="black" points="9510,-1600.74 9340,-1600.74 9340,-1547.74 9510,-1547.74 9510,-1600.74"/>
<text text-anchor="middle" x="9425" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9425" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9425" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn1_9 -->
<g id="node113" class="node">
<title>ffn1_9</title>
<polygon fill="lightblue" stroke="black" points="9554.5,-1511.74 9209.5,-1511.74 9209.5,-1458.74 9554.5,-1458.74 9554.5,-1511.74"/>
<text text-anchor="middle" x="9382" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="9382" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="9382" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ln2_9&#45;&gt;ffn1_9 -->
<g id="edge148" class="edge">
<title>ln2_9&#45;&gt;ffn1_9</title>
<path fill="none" stroke="black" d="M9412.33,-1547.61C9408.21,-1539.27 9403.57,-1529.88 9399.18,-1521"/>
<polygon fill="black" stroke="black" points="9402.3,-1519.4 9394.73,-1511.99 9396.02,-1522.51 9402.3,-1519.4"/>
</g>
<!-- gelu_9 -->
<g id="node114" class="node">
<title>gelu_9</title>
<polygon fill="lightblue" stroke="black" points="9471.5,-1422.74 9292.5,-1422.74 9292.5,-1369.74 9471.5,-1369.74 9471.5,-1422.74"/>
<text text-anchor="middle" x="9382" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9382" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="9382" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn1_9&#45;&gt;gelu_9 -->
<g id="edge149" class="edge">
<title>ffn1_9&#45;&gt;gelu_9</title>
<path fill="none" stroke="black" d="M9382,-1458.61C9382,-1450.63 9382,-1441.67 9382,-1433.12"/>
<polygon fill="black" stroke="black" points="9385.5,-1432.99 9382,-1422.99 9378.5,-1432.99 9385.5,-1432.99"/>
</g>
<!-- ffn2_9 -->
<g id="node115" class="node">
<title>ffn2_9</title>
<polygon fill="lightblue" stroke="black" points="9554.5,-1333.74 9209.5,-1333.74 9209.5,-1280.74 9554.5,-1280.74 9554.5,-1333.74"/>
<text text-anchor="middle" x="9382" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="9382" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9382" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- gelu_9&#45;&gt;ffn2_9 -->
<g id="edge150" class="edge">
<title>gelu_9&#45;&gt;ffn2_9</title>
<path fill="none" stroke="black" d="M9382,-1369.61C9382,-1361.63 9382,-1352.67 9382,-1344.12"/>
<polygon fill="black" stroke="black" points="9385.5,-1343.99 9382,-1333.99 9378.5,-1343.99 9385.5,-1343.99"/>
</g>
<!-- residual2_9 -->
<g id="node116" class="node">
<title>residual2_9</title>
<polygon fill="lightcoral" stroke="black" points="9938.86,-1244.74 9369.58,-1244.74 9223.14,-1138.74 9792.42,-1138.74 9938.86,-1244.74"/>
<text text-anchor="middle" x="9581" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="9581" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9581" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- ffn2_9&#45;&gt;residual2_9 -->
<g id="edge152" class="edge">
<title>ffn2_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M9427.16,-1280.49C9443.19,-1271.34 9461.95,-1260.64 9480.74,-1249.92"/>
<polygon fill="black" stroke="black" points="9482.71,-1252.83 9489.66,-1244.84 9479.24,-1246.75 9482.71,-1252.83"/>
</g>
<!-- comm_9_10 -->
<g id="node130" class="node">
<title>comm_9_10</title>
<ellipse fill="lightgreen" stroke="black" cx="9581" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="9581" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 8 → GPU 9</text>
<text text-anchor="middle" x="9581" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_9&#45;&gt;comm_9_10 -->
<g id="edge153" class="edge">
<title>residual2_9&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M9581,-1138.47C9581,-1129.85 9581,-1121.09 9581,-1112.98"/>
<polygon fill="black" stroke="black" points="9584.5,-1112.77 9581,-1102.77 9577.5,-1112.77 9584.5,-1112.77"/>
</g>
<!-- comm_8_9&#45;&gt;ln1_9 -->
<g id="edge137" class="edge">
<title>comm_8_9&#45;&gt;ln1_9</title>
<path fill="none" stroke="black" d="M8678.06,-1055.91C8620.22,-1042.36 8542.17,-1024.08 8481.31,-1009.83"/>
<polygon fill="black" stroke="black" points="8481.85,-1006.36 8471.31,-1007.48 8480.25,-1013.17 8481.85,-1006.36"/>
</g>
<!-- comm_8_9&#45;&gt;residual1_9 -->
<g id="edge145" class="edge">
<title>comm_8_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M8759,-1048.87C8759,-1014.47 8759,-951.93 8759,-898.5 8759,-898.5 8759,-898.5 8759,-807.5 8759,-733.47 8712.89,-660.84 8673.22,-612.06"/>
<polygon fill="black" stroke="black" points="8675.74,-609.61 8666.66,-604.14 8670.34,-614.08 8675.74,-609.61"/>
</g>
<!-- ln1_10 -->
<g id="node118" class="node">
<title>ln1_10</title>
<polygon fill="lightyellow" stroke="black" points="9660,-1013 9490,-1013 9490,-960 9660,-960 9660,-1013"/>
<text text-anchor="middle" x="9575" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="9575" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9575" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_q_10 -->
<g id="node119" class="node">
<title>mha_q_10</title>
<polygon fill="lightblue" stroke="black" points="9123,-924 8787,-924 8787,-871 9123,-871 9123,-924"/>
<text text-anchor="middle" x="8955" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="8955" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="8955" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_q_10 -->
<g id="edge155" class="edge">
<title>ln1_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M9489.64,-973.78C9402.69,-961.82 9263.64,-942.6 9133.33,-924.19"/>
<polygon fill="black" stroke="black" points="9133.56,-920.68 9123.16,-922.75 9132.58,-927.61 9133.56,-920.68"/>
</g>
<!-- mha_k_10 -->
<g id="node120" class="node">
<title>mha_k_10</title>
<polygon fill="lightblue" stroke="black" points="9477,-924 9141,-924 9141,-871 9477,-871 9477,-924"/>
<text text-anchor="middle" x="9309" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="9309" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9309" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_k_10 -->
<g id="edge156" class="edge">
<title>ln1_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M9496.99,-959.98C9465.59,-949.72 9429.23,-937.82 9396.9,-927.25"/>
<polygon fill="black" stroke="black" points="9397.6,-923.8 9387.01,-924.01 9395.43,-930.45 9397.6,-923.8"/>
</g>
<!-- mha_v_10 -->
<g id="node121" class="node">
<title>mha_v_10</title>
<polygon fill="lightblue" stroke="black" points="9831,-924 9495,-924 9495,-871 9831,-871 9831,-924"/>
<text text-anchor="middle" x="9663" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="9663" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9663" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln1_10&#45;&gt;mha_v_10 -->
<g id="edge157" class="edge">
<title>ln1_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M9600.93,-959.87C9609.98,-950.92 9620.26,-940.75 9629.82,-931.3"/>
<polygon fill="black" stroke="black" points="9632.3,-933.77 9636.95,-924.25 9627.38,-928.79 9632.3,-933.77"/>
</g>
<!-- mha_attn_10 -->
<g id="node122" class="node">
<title>mha_attn_10</title>
<polygon fill="lightblue" stroke="black" points="9482,-835 9312,-835 9312,-782 9482,-782 9482,-835"/>
<text text-anchor="middle" x="9397" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="9397" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9397" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge158" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M9084.63,-870.98C9154.14,-857.3 9238.3,-840.74 9301.74,-828.25"/>
<polygon fill="black" stroke="black" points="9302.6,-831.65 9311.74,-826.28 9301.25,-824.78 9302.6,-831.65"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge159" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M9334.93,-870.87C9343.98,-861.92 9354.26,-851.75 9363.82,-842.3"/>
<polygon fill="black" stroke="black" points="9366.3,-844.77 9370.95,-835.25 9361.38,-839.79 9366.3,-844.77"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge160" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M9584.99,-870.98C9553.59,-860.72 9517.23,-848.82 9484.9,-838.25"/>
<polygon fill="black" stroke="black" points="9485.6,-834.8 9475.01,-835.01 9483.43,-841.45 9485.6,-834.8"/>
</g>
<!-- mha_out_10 -->
<g id="node123" class="node">
<title>mha_out_10</title>
<polygon fill="lightblue" stroke="black" points="9742,-719.5 9406,-719.5 9406,-666.5 9742,-666.5 9742,-719.5"/>
<text text-anchor="middle" x="9574" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="9574" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9574" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge161" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M9437.16,-781.75C9463.3,-764.98 9497.56,-743.02 9525.25,-725.26"/>
<polygon fill="black" stroke="black" points="9527.47,-728 9533.99,-719.65 9523.69,-722.1 9527.47,-728"/>
</g>
<!-- residual1_10 -->
<g id="node124" class="node">
<title>residual1_10</title>
<polygon fill="lightcoral" stroke="black" points="10074.86,-604 9505.58,-604 9359.14,-498 9928.42,-498 10074.86,-604"/>
<text text-anchor="middle" x="9717" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="9717" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9717" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge163" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M9600.23,-666.32C9616.03,-650.85 9636.84,-630.48 9656.5,-611.23"/>
<polygon fill="black" stroke="black" points="9658.99,-613.69 9663.69,-604.19 9654.09,-608.69 9658.99,-613.69"/>
</g>
<!-- ln2_10 -->
<g id="node125" class="node">
<title>ln2_10</title>
<polygon fill="lightyellow" stroke="black" points="9855,-1600.74 9685,-1600.74 9685,-1547.74 9855,-1547.74 9855,-1600.74"/>
<text text-anchor="middle" x="9770" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="9770" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9770" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn1_10 -->
<g id="node126" class="node">
<title>ffn1_10</title>
<polygon fill="lightblue" stroke="black" points="9985.5,-1511.74 9640.5,-1511.74 9640.5,-1458.74 9985.5,-1458.74 9985.5,-1511.74"/>
<text text-anchor="middle" x="9813" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="9813" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="9813" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ln2_10&#45;&gt;ffn1_10 -->
<g id="edge165" class="edge">
<title>ln2_10&#45;&gt;ffn1_10</title>
<path fill="none" stroke="black" d="M9782.67,-1547.61C9786.79,-1539.27 9791.43,-1529.88 9795.82,-1521"/>
<polygon fill="black" stroke="black" points="9798.98,-1522.51 9800.27,-1511.99 9792.7,-1519.4 9798.98,-1522.51"/>
</g>
<!-- gelu_10 -->
<g id="node127" class="node">
<title>gelu_10</title>
<polygon fill="lightblue" stroke="black" points="9932.5,-1422.74 9753.5,-1422.74 9753.5,-1369.74 9932.5,-1369.74 9932.5,-1422.74"/>
<text text-anchor="middle" x="9843" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="9843" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="9843" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn1_10&#45;&gt;gelu_10 -->
<g id="edge166" class="edge">
<title>ffn1_10&#45;&gt;gelu_10</title>
<path fill="none" stroke="black" d="M9821.84,-1458.61C9824.65,-1450.45 9827.81,-1441.28 9830.82,-1432.56"/>
<polygon fill="black" stroke="black" points="9834.17,-1433.58 9834.12,-1422.99 9827.55,-1431.3 9834.17,-1433.58"/>
</g>
<!-- ffn2_10 -->
<g id="node128" class="node">
<title>ffn2_10</title>
<polygon fill="lightblue" stroke="black" points="10015.5,-1333.74 9670.5,-1333.74 9670.5,-1280.74 10015.5,-1280.74 10015.5,-1333.74"/>
<text text-anchor="middle" x="9843" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="9843" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="9843" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- gelu_10&#45;&gt;ffn2_10 -->
<g id="edge167" class="edge">
<title>gelu_10&#45;&gt;ffn2_10</title>
<path fill="none" stroke="black" d="M9843,-1369.61C9843,-1361.63 9843,-1352.67 9843,-1344.12"/>
<polygon fill="black" stroke="black" points="9846.5,-1343.99 9843,-1333.99 9839.5,-1343.99 9846.5,-1343.99"/>
</g>
<!-- residual2_10 -->
<g id="node129" class="node">
<title>residual2_10</title>
<polygon fill="lightcoral" stroke="black" points="10671.86,-1244.74 10102.58,-1244.74 9956.14,-1138.74 10525.42,-1138.74 10671.86,-1244.74"/>
<text text-anchor="middle" x="10314" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="10314" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10314" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- ffn2_10&#45;&gt;residual2_10 -->
<g id="edge169" class="edge">
<title>ffn2_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M9949,-1280.7C9991.34,-1270.49 10041.79,-1258.34 10091.47,-1246.36"/>
<polygon fill="black" stroke="black" points="10092.49,-1249.72 10101.39,-1243.97 10090.85,-1242.91 10092.49,-1249.72"/>
</g>
<!-- comm_10_11 -->
<g id="node143" class="node">
<title>comm_10_11</title>
<ellipse fill="lightgreen" stroke="black" cx="10409" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="10409" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 9 → GPU 10</text>
<text text-anchor="middle" x="10409" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_10&#45;&gt;comm_10_11 -->
<g id="edge170" class="edge">
<title>residual2_10&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M10357.61,-1138.47C10365.6,-1128.89 10373.74,-1119.14 10381.11,-1110.3"/>
<polygon fill="black" stroke="black" points="10383.93,-1112.39 10387.65,-1102.47 10378.55,-1107.9 10383.93,-1112.39"/>
</g>
<!-- comm_9_10&#45;&gt;ln1_10 -->
<g id="edge154" class="edge">
<title>comm_9_10&#45;&gt;ln1_10</title>
<path fill="none" stroke="black" d="M9579.2,-1048.66C9578.65,-1040.65 9578.04,-1031.71 9577.45,-1023.19"/>
<polygon fill="black" stroke="black" points="9580.93,-1022.83 9576.76,-1013.09 9573.95,-1023.31 9580.93,-1022.83"/>
</g>
<!-- comm_9_10&#45;&gt;residual1_10 -->
<g id="edge162" class="edge">
<title>comm_9_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M9669.34,-1057.55C9750.75,-1035.84 9859,-989.81 9859,-898.5 9859,-898.5 9859,-898.5 9859,-807.5 9859,-733.47 9812.89,-660.84 9773.22,-612.06"/>
<polygon fill="black" stroke="black" points="9775.74,-609.61 9766.66,-604.14 9770.34,-614.08 9775.74,-609.61"/>
</g>
<!-- ln1_11 -->
<g id="node131" class="node">
<title>ln1_11</title>
<polygon fill="lightyellow" stroke="black" points="10494,-1013 10324,-1013 10324,-960 10494,-960 10494,-1013"/>
<text text-anchor="middle" x="10409" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="10409" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10409" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_q_11 -->
<g id="node132" class="node">
<title>mha_q_11</title>
<polygon fill="lightblue" stroke="black" points="10223,-924 9887,-924 9887,-871 10223,-871 10223,-924"/>
<text text-anchor="middle" x="10055" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="10055" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10055" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_q_11 -->
<g id="edge172" class="edge">
<title>ln1_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M10323.76,-964.55C10277.25,-953.12 10219.05,-938.82 10168.72,-926.45"/>
<polygon fill="black" stroke="black" points="10169.31,-922.99 10158.76,-924 10167.64,-929.79 10169.31,-922.99"/>
</g>
<!-- mha_k_11 -->
<g id="node133" class="node">
<title>mha_k_11</title>
<polygon fill="lightblue" stroke="black" points="10577,-924 10241,-924 10241,-871 10577,-871 10577,-924"/>
<text text-anchor="middle" x="10409" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="10409" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10409" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_k_11 -->
<g id="edge173" class="edge">
<title>ln1_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M10409,-959.87C10409,-951.89 10409,-942.93 10409,-934.38"/>
<polygon fill="black" stroke="black" points="10412.5,-934.25 10409,-924.25 10405.5,-934.25 10412.5,-934.25"/>
</g>
<!-- mha_v_11 -->
<g id="node134" class="node">
<title>mha_v_11</title>
<polygon fill="lightblue" stroke="black" points="10931,-924 10595,-924 10595,-871 10931,-871 10931,-924"/>
<text text-anchor="middle" x="10763" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="10763" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10763" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln1_11&#45;&gt;mha_v_11 -->
<g id="edge174" class="edge">
<title>ln1_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M10494.24,-964.55C10540.75,-953.12 10598.95,-938.82 10649.28,-926.45"/>
<polygon fill="black" stroke="black" points="10650.36,-929.79 10659.24,-924 10648.69,-922.99 10650.36,-929.79"/>
</g>
<!-- mha_attn_11 -->
<g id="node135" class="node">
<title>mha_attn_11</title>
<polygon fill="lightblue" stroke="black" points="10582,-835 10412,-835 10412,-782 10582,-782 10582,-835"/>
<text text-anchor="middle" x="10497" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="10497" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10497" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge175" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M10184.63,-870.98C10254.14,-857.3 10338.3,-840.74 10401.74,-828.25"/>
<polygon fill="black" stroke="black" points="10402.6,-831.65 10411.74,-826.28 10401.25,-824.78 10402.6,-831.65"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge176" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M10434.93,-870.87C10443.98,-861.92 10454.26,-851.75 10463.82,-842.3"/>
<polygon fill="black" stroke="black" points="10466.3,-844.77 10470.95,-835.25 10461.38,-839.79 10466.3,-844.77"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge177" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M10684.99,-870.98C10653.59,-860.72 10617.23,-848.82 10584.9,-838.25"/>
<polygon fill="black" stroke="black" points="10585.6,-834.8 10575.01,-835.01 10583.43,-841.45 10585.6,-834.8"/>
</g>
<!-- mha_out_11 -->
<g id="node136" class="node">
<title>mha_out_11</title>
<polygon fill="lightblue" stroke="black" points="10842,-719.5 10506,-719.5 10506,-666.5 10842,-666.5 10842,-719.5"/>
<text text-anchor="middle" x="10674" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="10674" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10674" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge178" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M10537.16,-781.75C10563.3,-764.98 10597.56,-743.02 10625.25,-725.26"/>
<polygon fill="black" stroke="black" points="10627.47,-728 10633.99,-719.65 10623.69,-722.1 10627.47,-728"/>
</g>
<!-- residual1_11 -->
<g id="node137" class="node">
<title>residual1_11</title>
<polygon fill="lightcoral" stroke="black" points="11249.86,-604 10680.58,-604 10534.14,-498 11103.42,-498 11249.86,-604"/>
<text text-anchor="middle" x="10892" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="10892" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10892" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge180" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M10713.73,-666.48C10738.54,-650.55 10771.52,-629.37 10802.37,-609.56"/>
<polygon fill="black" stroke="black" points="10804.48,-612.37 10811,-604.02 10800.7,-606.48 10804.48,-612.37"/>
</g>
<!-- ln2_11 -->
<g id="node138" class="node">
<title>ln2_11</title>
<polygon fill="lightyellow" stroke="black" points="10649,-1600.74 10479,-1600.74 10479,-1547.74 10649,-1547.74 10649,-1600.74"/>
<text text-anchor="middle" x="10564" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="10564" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10564" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn1_11 -->
<g id="node139" class="node">
<title>ffn1_11</title>
<polygon fill="lightblue" stroke="black" points="10779.5,-1511.74 10434.5,-1511.74 10434.5,-1458.74 10779.5,-1458.74 10779.5,-1511.74"/>
<text text-anchor="middle" x="10607" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="10607" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="10607" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ln2_11&#45;&gt;ffn1_11 -->
<g id="edge182" class="edge">
<title>ln2_11&#45;&gt;ffn1_11</title>
<path fill="none" stroke="black" d="M10576.67,-1547.61C10580.79,-1539.27 10585.43,-1529.88 10589.82,-1521"/>
<polygon fill="black" stroke="black" points="10592.98,-1522.51 10594.27,-1511.99 10586.7,-1519.4 10592.98,-1522.51"/>
</g>
<!-- gelu_11 -->
<g id="node140" class="node">
<title>gelu_11</title>
<polygon fill="lightblue" stroke="black" points="10738.5,-1422.74 10559.5,-1422.74 10559.5,-1369.74 10738.5,-1369.74 10738.5,-1422.74"/>
<text text-anchor="middle" x="10649" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="10649" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="10649" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn1_11&#45;&gt;gelu_11 -->
<g id="edge183" class="edge">
<title>ffn1_11&#45;&gt;gelu_11</title>
<path fill="none" stroke="black" d="M10619.37,-1458.61C10623.4,-1450.27 10627.93,-1440.88 10632.22,-1432"/>
<polygon fill="black" stroke="black" points="10635.37,-1433.52 10636.57,-1422.99 10629.07,-1430.47 10635.37,-1433.52"/>
</g>
<!-- ffn2_11 -->
<g id="node141" class="node">
<title>ffn2_11</title>
<polygon fill="lightblue" stroke="black" points="10862.5,-1333.74 10517.5,-1333.74 10517.5,-1280.74 10862.5,-1280.74 10862.5,-1333.74"/>
<text text-anchor="middle" x="10690" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="10690" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="10690" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- gelu_11&#45;&gt;ffn2_11 -->
<g id="edge184" class="edge">
<title>gelu_11&#45;&gt;ffn2_11</title>
<path fill="none" stroke="black" d="M10661.08,-1369.61C10664.97,-1361.36 10669.34,-1352.08 10673.49,-1343.28"/>
<polygon fill="black" stroke="black" points="10676.77,-1344.53 10677.87,-1333.99 10670.44,-1341.54 10676.77,-1344.53"/>
</g>
<!-- residual2_11 -->
<g id="node142" class="node">
<title>residual2_11</title>
<polygon fill="lightcoral" stroke="black" points="11404.86,-1244.74 10835.58,-1244.74 10689.14,-1138.74 11258.42,-1138.74 11404.86,-1244.74"/>
<text text-anchor="middle" x="11047" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11047" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11047" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- ffn2_11&#45;&gt;residual2_11 -->
<g id="edge186" class="edge">
<title>ffn2_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M10770.56,-1280.63C10801.24,-1270.87 10837.51,-1259.34 10873.5,-1247.9"/>
<polygon fill="black" stroke="black" points="10874.67,-1251.2 10883.14,-1244.84 10872.55,-1244.53 10874.67,-1251.2"/>
</g>
<!-- comm_11_12 -->
<g id="node156" class="node">
<title>comm_11_12</title>
<ellipse fill="lightgreen" stroke="black" cx="11509" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="11509" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 10 → GPU 11</text>
<text text-anchor="middle" x="11509" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_11&#45;&gt;comm_11_12 -->
<g id="edge187" class="edge">
<title>residual2_11&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M11258.06,-1138.72C11315.21,-1124.63 11374.01,-1110.14 11420.31,-1098.73"/>
<polygon fill="black" stroke="black" points="11421.42,-1102.06 11430.3,-1096.27 11419.75,-1095.26 11421.42,-1102.06"/>
</g>
<!-- comm_10_11&#45;&gt;ln1_11 -->
<g id="edge171" class="edge">
<title>comm_10_11&#45;&gt;ln1_11</title>
<path fill="none" stroke="black" d="M10409,-1048.66C10409,-1040.65 10409,-1031.71 10409,-1023.19"/>
<polygon fill="black" stroke="black" points="10412.5,-1023.09 10409,-1013.09 10405.5,-1023.09 10412.5,-1023.09"/>
</g>
<!-- comm_10_11&#45;&gt;residual1_11 -->
<g id="edge179" class="edge">
<title>comm_10_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M10514.39,-1062.84C10674.1,-1041.64 10959,-990.88 10959,-898.5 10959,-898.5 10959,-898.5 10959,-807.5 10959,-739.65 10936.62,-664.88 10917.73,-613.85"/>
<polygon fill="black" stroke="black" points="10920.92,-612.41 10914.12,-604.29 10914.37,-614.88 10920.92,-612.41"/>
</g>
<!-- ln1_12 -->
<g id="node144" class="node">
<title>ln1_12</title>
<polygon fill="lightyellow" stroke="black" points="11594,-1013 11424,-1013 11424,-960 11594,-960 11594,-1013"/>
<text text-anchor="middle" x="11509" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="11509" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11509" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_q_12 -->
<g id="node145" class="node">
<title>mha_q_12</title>
<polygon fill="lightblue" stroke="black" points="11323,-924 10987,-924 10987,-871 11323,-871 11323,-924"/>
<text text-anchor="middle" x="11155" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="11155" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11155" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_q_12 -->
<g id="edge189" class="edge">
<title>ln1_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M11423.76,-964.55C11377.25,-953.12 11319.05,-938.82 11268.72,-926.45"/>
<polygon fill="black" stroke="black" points="11269.31,-922.99 11258.76,-924 11267.64,-929.79 11269.31,-922.99"/>
</g>
<!-- mha_k_12 -->
<g id="node146" class="node">
<title>mha_k_12</title>
<polygon fill="lightblue" stroke="black" points="11677,-924 11341,-924 11341,-871 11677,-871 11677,-924"/>
<text text-anchor="middle" x="11509" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="11509" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11509" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_k_12 -->
<g id="edge190" class="edge">
<title>ln1_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M11509,-959.87C11509,-951.89 11509,-942.93 11509,-934.38"/>
<polygon fill="black" stroke="black" points="11512.5,-934.25 11509,-924.25 11505.5,-934.25 11512.5,-934.25"/>
</g>
<!-- mha_v_12 -->
<g id="node147" class="node">
<title>mha_v_12</title>
<polygon fill="lightblue" stroke="black" points="12031,-924 11695,-924 11695,-871 12031,-871 12031,-924"/>
<text text-anchor="middle" x="11863" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="11863" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11863" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln1_12&#45;&gt;mha_v_12 -->
<g id="edge191" class="edge">
<title>ln1_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M11594.24,-964.55C11640.75,-953.12 11698.95,-938.82 11749.28,-926.45"/>
<polygon fill="black" stroke="black" points="11750.36,-929.79 11759.24,-924 11748.69,-922.99 11750.36,-929.79"/>
</g>
<!-- mha_attn_12 -->
<g id="node148" class="node">
<title>mha_attn_12</title>
<polygon fill="lightblue" stroke="black" points="11628,-835 11458,-835 11458,-782 11628,-782 11628,-835"/>
<text text-anchor="middle" x="11543" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="11543" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11543" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge192" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M11268.79,-870.98C11325.73,-858.22 11393.86,-842.94 11447.97,-830.81"/>
<polygon fill="black" stroke="black" points="11448.91,-834.18 11457.9,-828.58 11447.38,-827.35 11448.91,-834.18"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge193" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M11519.02,-870.87C11522.21,-862.71 11525.79,-853.54 11529.2,-844.82"/>
<polygon fill="black" stroke="black" points="11532.56,-845.84 11532.94,-835.25 11526.04,-843.29 11532.56,-845.84"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge194" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M11769.15,-870.98C11727.83,-859.75 11679.37,-846.58 11637.93,-835.31"/>
<polygon fill="black" stroke="black" points="11638.68,-831.89 11628.11,-832.64 11636.84,-838.64 11638.68,-831.89"/>
</g>
<!-- mha_out_12 -->
<g id="node149" class="node">
<title>mha_out_12</title>
<polygon fill="lightblue" stroke="black" points="11845,-719.5 11509,-719.5 11509,-666.5 11845,-666.5 11845,-719.5"/>
<text text-anchor="middle" x="11677" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="11677" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11677" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge195" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M11573.41,-781.75C11592.85,-765.27 11618.23,-743.78 11639,-726.19"/>
<polygon fill="black" stroke="black" points="11641.35,-728.79 11646.71,-719.65 11636.82,-723.45 11641.35,-728.79"/>
</g>
<!-- residual1_12 -->
<g id="node150" class="node">
<title>residual1_12</title>
<polygon fill="lightcoral" stroke="black" points="12067.86,-604 11498.58,-604 11352.14,-498 11921.42,-498 12067.86,-604"/>
<text text-anchor="middle" x="11710" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="11710" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11710" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge197" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M11683.05,-666.32C11686.52,-651.6 11691.04,-632.44 11695.38,-614.02"/>
<polygon fill="black" stroke="black" points="11698.81,-614.73 11697.7,-604.19 11692,-613.12 11698.81,-614.73"/>
</g>
<!-- ln2_12 -->
<g id="node151" class="node">
<title>ln2_12</title>
<polygon fill="lightyellow" stroke="black" points="11215,-1600.74 11045,-1600.74 11045,-1547.74 11215,-1547.74 11215,-1600.74"/>
<text text-anchor="middle" x="11130" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11130" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11130" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn1_12 -->
<g id="node152" class="node">
<title>ffn1_12</title>
<polygon fill="lightblue" stroke="black" points="11345.5,-1511.74 11000.5,-1511.74 11000.5,-1458.74 11345.5,-1458.74 11345.5,-1511.74"/>
<text text-anchor="middle" x="11173" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="11173" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="11173" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ln2_12&#45;&gt;ffn1_12 -->
<g id="edge199" class="edge">
<title>ln2_12&#45;&gt;ffn1_12</title>
<path fill="none" stroke="black" d="M11142.67,-1547.61C11146.79,-1539.27 11151.43,-1529.88 11155.82,-1521"/>
<polygon fill="black" stroke="black" points="11158.98,-1522.51 11160.27,-1511.99 11152.7,-1519.4 11158.98,-1522.51"/>
</g>
<!-- gelu_12 -->
<g id="node153" class="node">
<title>gelu_12</title>
<polygon fill="lightblue" stroke="black" points="11269.5,-1422.74 11090.5,-1422.74 11090.5,-1369.74 11269.5,-1369.74 11269.5,-1422.74"/>
<text text-anchor="middle" x="11180" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11180" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="11180" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn1_12&#45;&gt;gelu_12 -->
<g id="edge200" class="edge">
<title>ffn1_12&#45;&gt;gelu_12</title>
<path fill="none" stroke="black" d="M11175.06,-1458.61C11175.7,-1450.63 11176.43,-1441.67 11177.11,-1433.12"/>
<polygon fill="black" stroke="black" points="11180.61,-1433.24 11177.93,-1422.99 11173.64,-1432.68 11180.61,-1433.24"/>
</g>
<!-- ffn2_12 -->
<g id="node154" class="node">
<title>ffn2_12</title>
<polygon fill="lightblue" stroke="black" points="11360.5,-1333.74 11015.5,-1333.74 11015.5,-1280.74 11360.5,-1280.74 11360.5,-1333.74"/>
<text text-anchor="middle" x="11188" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="11188" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11188" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- gelu_12&#45;&gt;ffn2_12 -->
<g id="edge201" class="edge">
<title>gelu_12&#45;&gt;ffn2_12</title>
<path fill="none" stroke="black" d="M11182.36,-1369.61C11183.09,-1361.63 11183.91,-1352.67 11184.7,-1344.12"/>
<polygon fill="black" stroke="black" points="11188.2,-1344.27 11185.63,-1333.99 11181.23,-1343.63 11188.2,-1344.27"/>
</g>
<!-- residual2_12 -->
<g id="node155" class="node">
<title>residual2_12</title>
<polygon fill="lightcoral" stroke="black" points="12137.86,-1244.74 11568.58,-1244.74 11422.14,-1138.74 11991.42,-1138.74 12137.86,-1244.74"/>
<text text-anchor="middle" x="11780" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="11780" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11780" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- ffn2_12&#45;&gt;residual2_12 -->
<g id="edge203" class="edge">
<title>ffn2_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M11321.23,-1280.7C11387.47,-1268 11469.49,-1252.27 11545.79,-1237.64"/>
<polygon fill="black" stroke="black" points="11546.86,-1241 11556.03,-1235.68 11545.55,-1234.13 11546.86,-1241"/>
</g>
<!-- comm_12_13 -->
<g id="node169" class="node">
<title>comm_12_13</title>
<ellipse fill="lightgreen" stroke="black" cx="12609" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="12609" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 11 → GPU 12</text>
<text text-anchor="middle" x="12609" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_12&#45;&gt;comm_12_13 -->
<g id="edge204" class="edge">
<title>residual2_12&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M12016.71,-1156.82C12059.72,-1150.74 12104.2,-1144.5 12146,-1138.74 12265.76,-1122.23 12403.04,-1103.97 12496.82,-1091.6"/>
<polygon fill="black" stroke="black" points="12497.44,-1095.04 12506.9,-1090.27 12496.53,-1088.1 12497.44,-1095.04"/>
</g>
<!-- comm_11_12&#45;&gt;ln1_12 -->
<g id="edge188" class="edge">
<title>comm_11_12&#45;&gt;ln1_12</title>
<path fill="none" stroke="black" d="M11509,-1048.66C11509,-1040.65 11509,-1031.71 11509,-1023.19"/>
<polygon fill="black" stroke="black" points="11512.5,-1023.09 11509,-1013.09 11505.5,-1023.09 11512.5,-1023.09"/>
</g>
<!-- comm_11_12&#45;&gt;residual1_12 -->
<g id="edge196" class="edge">
<title>comm_11_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M11614.39,-1062.84C11774.1,-1041.64 12059,-990.88 12059,-898.5 12059,-898.5 12059,-898.5 12059,-807.5 12059,-711.86 11972.61,-648.14 11885.79,-608.25"/>
<polygon fill="black" stroke="black" points="11887.13,-605.02 11876.58,-604.11 11884.26,-611.4 11887.13,-605.02"/>
</g>
<!-- ln1_13 -->
<g id="node157" class="node">
<title>ln1_13</title>
<polygon fill="lightyellow" stroke="black" points="12694,-1013 12524,-1013 12524,-960 12694,-960 12694,-1013"/>
<text text-anchor="middle" x="12609" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="12609" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12609" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_q_13 -->
<g id="node158" class="node">
<title>mha_q_13</title>
<polygon fill="lightblue" stroke="black" points="12423,-924 12087,-924 12087,-871 12423,-871 12423,-924"/>
<text text-anchor="middle" x="12255" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="12255" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12255" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_q_13 -->
<g id="edge206" class="edge">
<title>ln1_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M12523.76,-964.55C12477.25,-953.12 12419.05,-938.82 12368.72,-926.45"/>
<polygon fill="black" stroke="black" points="12369.31,-922.99 12358.76,-924 12367.64,-929.79 12369.31,-922.99"/>
</g>
<!-- mha_k_13 -->
<g id="node159" class="node">
<title>mha_k_13</title>
<polygon fill="lightblue" stroke="black" points="12777,-924 12441,-924 12441,-871 12777,-871 12777,-924"/>
<text text-anchor="middle" x="12609" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="12609" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12609" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_k_13 -->
<g id="edge207" class="edge">
<title>ln1_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M12609,-959.87C12609,-951.89 12609,-942.93 12609,-934.38"/>
<polygon fill="black" stroke="black" points="12612.5,-934.25 12609,-924.25 12605.5,-934.25 12612.5,-934.25"/>
</g>
<!-- mha_v_13 -->
<g id="node160" class="node">
<title>mha_v_13</title>
<polygon fill="lightblue" stroke="black" points="13131,-924 12795,-924 12795,-871 13131,-871 13131,-924"/>
<text text-anchor="middle" x="12963" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="12963" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12963" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln1_13&#45;&gt;mha_v_13 -->
<g id="edge208" class="edge">
<title>ln1_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M12694.24,-964.55C12740.75,-953.12 12798.95,-938.82 12849.28,-926.45"/>
<polygon fill="black" stroke="black" points="12850.36,-929.79 12859.24,-924 12848.69,-922.99 12850.36,-929.79"/>
</g>
<!-- mha_attn_13 -->
<g id="node161" class="node">
<title>mha_attn_13</title>
<polygon fill="lightblue" stroke="black" points="12782,-835 12612,-835 12612,-782 12782,-782 12782,-835"/>
<text text-anchor="middle" x="12697" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="12697" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12697" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge209" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M12384.63,-870.98C12454.14,-857.3 12538.3,-840.74 12601.74,-828.25"/>
<polygon fill="black" stroke="black" points="12602.6,-831.65 12611.74,-826.28 12601.25,-824.78 12602.6,-831.65"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge210" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M12634.93,-870.87C12643.98,-861.92 12654.26,-851.75 12663.82,-842.3"/>
<polygon fill="black" stroke="black" points="12666.3,-844.77 12670.95,-835.25 12661.38,-839.79 12666.3,-844.77"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge211" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M12884.99,-870.98C12853.59,-860.72 12817.23,-848.82 12784.9,-838.25"/>
<polygon fill="black" stroke="black" points="12785.6,-834.8 12775.01,-835.01 12783.43,-841.45 12785.6,-834.8"/>
</g>
<!-- mha_out_13 -->
<g id="node162" class="node">
<title>mha_out_13</title>
<polygon fill="lightblue" stroke="black" points="13042,-719.5 12706,-719.5 12706,-666.5 13042,-666.5 13042,-719.5"/>
<text text-anchor="middle" x="12874" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="12874" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12874" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge212" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M12737.16,-781.75C12763.3,-764.98 12797.56,-743.02 12825.25,-725.26"/>
<polygon fill="black" stroke="black" points="12827.47,-728 12833.99,-719.65 12823.69,-722.1 12827.47,-728"/>
</g>
<!-- residual1_13 -->
<g id="node163" class="node">
<title>residual1_13</title>
<polygon fill="lightcoral" stroke="black" points="13374.86,-604 12805.58,-604 12659.14,-498 13228.42,-498 13374.86,-604"/>
<text text-anchor="middle" x="13017" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="13017" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13017" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge214" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M12900.23,-666.32C12916.03,-650.85 12936.84,-630.48 12956.5,-611.23"/>
<polygon fill="black" stroke="black" points="12958.99,-613.69 12963.69,-604.19 12954.09,-608.69 12958.99,-613.69"/>
</g>
<!-- ln2_13 -->
<g id="node164" class="node">
<title>ln2_13</title>
<polygon fill="lightyellow" stroke="black" points="11640,-1600.74 11470,-1600.74 11470,-1547.74 11640,-1547.74 11640,-1600.74"/>
<text text-anchor="middle" x="11555" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="11555" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11555" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn1_13 -->
<g id="node165" class="node">
<title>ffn1_13</title>
<polygon fill="lightblue" stroke="black" points="11770.5,-1511.74 11425.5,-1511.74 11425.5,-1458.74 11770.5,-1458.74 11770.5,-1511.74"/>
<text text-anchor="middle" x="11598" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="11598" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="11598" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ln2_13&#45;&gt;ffn1_13 -->
<g id="edge216" class="edge">
<title>ln2_13&#45;&gt;ffn1_13</title>
<path fill="none" stroke="black" d="M11567.67,-1547.61C11571.79,-1539.27 11576.43,-1529.88 11580.82,-1521"/>
<polygon fill="black" stroke="black" points="11583.98,-1522.51 11585.27,-1511.99 11577.7,-1519.4 11583.98,-1522.51"/>
</g>
<!-- gelu_13 -->
<g id="node166" class="node">
<title>gelu_13</title>
<polygon fill="lightblue" stroke="black" points="11687.5,-1422.74 11508.5,-1422.74 11508.5,-1369.74 11687.5,-1369.74 11687.5,-1422.74"/>
<text text-anchor="middle" x="11598" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="11598" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="11598" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn1_13&#45;&gt;gelu_13 -->
<g id="edge217" class="edge">
<title>ffn1_13&#45;&gt;gelu_13</title>
<path fill="none" stroke="black" d="M11598,-1458.61C11598,-1450.63 11598,-1441.67 11598,-1433.12"/>
<polygon fill="black" stroke="black" points="11601.5,-1432.99 11598,-1422.99 11594.5,-1432.99 11601.5,-1432.99"/>
</g>
<!-- ffn2_13 -->
<g id="node167" class="node">
<title>ffn2_13</title>
<polygon fill="lightblue" stroke="black" points="11772.5,-1333.74 11427.5,-1333.74 11427.5,-1280.74 11772.5,-1280.74 11772.5,-1333.74"/>
<text text-anchor="middle" x="11600" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="11600" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="11600" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- gelu_13&#45;&gt;ffn2_13 -->
<g id="edge218" class="edge">
<title>gelu_13&#45;&gt;ffn2_13</title>
<path fill="none" stroke="black" d="M11598.59,-1369.61C11598.77,-1361.63 11598.98,-1352.67 11599.18,-1344.12"/>
<polygon fill="black" stroke="black" points="11602.68,-1344.07 11599.41,-1333.99 11595.68,-1343.91 11602.68,-1344.07"/>
</g>
<!-- residual2_13 -->
<g id="node168" class="node">
<title>residual2_13</title>
<polygon fill="lightcoral" stroke="black" points="12870.86,-1244.74 12301.58,-1244.74 12155.14,-1138.74 12724.42,-1138.74 12870.86,-1244.74"/>
<text text-anchor="middle" x="12513" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="12513" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12513" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- ffn2_13&#45;&gt;residual2_13 -->
<g id="edge220" class="edge">
<title>ffn2_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M11772.59,-1282.59C11777.78,-1281.96 11782.93,-1281.34 11788,-1280.74 11947.25,-1261.96 11987.81,-1264.02 12147,-1244.74 12186,-1240.02 12227.26,-1234.58 12267.49,-1229.04"/>
<polygon fill="black" stroke="black" points="12267.99,-1232.5 12277.42,-1227.67 12267.03,-1225.57 12267.99,-1232.5"/>
</g>
<!-- comm_13_14 -->
<g id="node182" class="node">
<title>comm_13_14</title>
<ellipse fill="lightgreen" stroke="black" cx="13709" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="13709" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 12 → GPU 13</text>
<text text-anchor="middle" x="13709" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_13&#45;&gt;comm_13_14 -->
<g id="edge221" class="edge">
<title>residual2_13&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M12747.5,-1155.06C12791.14,-1149.09 12836.41,-1143.35 12879,-1138.74 13127.89,-1111.81 13420.04,-1093 13582.91,-1083.64"/>
<polygon fill="black" stroke="black" points="13583.18,-1087.13 13592.96,-1083.07 13582.78,-1080.15 13583.18,-1087.13"/>
</g>
<!-- comm_12_13&#45;&gt;ln1_13 -->
<g id="edge205" class="edge">
<title>comm_12_13&#45;&gt;ln1_13</title>
<path fill="none" stroke="black" d="M12609,-1048.66C12609,-1040.65 12609,-1031.71 12609,-1023.19"/>
<polygon fill="black" stroke="black" points="12612.5,-1023.09 12609,-1013.09 12605.5,-1023.09 12612.5,-1023.09"/>
</g>
<!-- comm_12_13&#45;&gt;residual1_13 -->
<g id="edge213" class="edge">
<title>comm_12_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M12714.39,-1062.84C12874.1,-1041.64 13159,-990.88 13159,-898.5 13159,-898.5 13159,-898.5 13159,-807.5 13159,-733.47 13112.89,-660.84 13073.22,-612.06"/>
<polygon fill="black" stroke="black" points="13075.74,-609.61 13066.66,-604.14 13070.34,-614.08 13075.74,-609.61"/>
</g>
<!-- ln1_14 -->
<g id="node170" class="node">
<title>ln1_14</title>
<polygon fill="lightyellow" stroke="black" points="13794,-1013 13624,-1013 13624,-960 13794,-960 13794,-1013"/>
<text text-anchor="middle" x="13709" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="13709" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13709" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_q_14 -->
<g id="node171" class="node">
<title>mha_q_14</title>
<polygon fill="lightblue" stroke="black" points="13523,-924 13187,-924 13187,-871 13523,-871 13523,-924"/>
<text text-anchor="middle" x="13355" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="13355" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13355" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_q_14 -->
<g id="edge223" class="edge">
<title>ln1_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M13623.76,-964.55C13577.25,-953.12 13519.05,-938.82 13468.72,-926.45"/>
<polygon fill="black" stroke="black" points="13469.31,-922.99 13458.76,-924 13467.64,-929.79 13469.31,-922.99"/>
</g>
<!-- mha_k_14 -->
<g id="node172" class="node">
<title>mha_k_14</title>
<polygon fill="lightblue" stroke="black" points="13877,-924 13541,-924 13541,-871 13877,-871 13877,-924"/>
<text text-anchor="middle" x="13709" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="13709" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13709" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_k_14 -->
<g id="edge224" class="edge">
<title>ln1_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M13709,-959.87C13709,-951.89 13709,-942.93 13709,-934.38"/>
<polygon fill="black" stroke="black" points="13712.5,-934.25 13709,-924.25 13705.5,-934.25 13712.5,-934.25"/>
</g>
<!-- mha_v_14 -->
<g id="node173" class="node">
<title>mha_v_14</title>
<polygon fill="lightblue" stroke="black" points="14231,-924 13895,-924 13895,-871 14231,-871 14231,-924"/>
<text text-anchor="middle" x="14063" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="14063" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14063" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln1_14&#45;&gt;mha_v_14 -->
<g id="edge225" class="edge">
<title>ln1_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M13794.24,-964.55C13840.75,-953.12 13898.95,-938.82 13949.28,-926.45"/>
<polygon fill="black" stroke="black" points="13950.36,-929.79 13959.24,-924 13948.69,-922.99 13950.36,-929.79"/>
</g>
<!-- mha_attn_14 -->
<g id="node174" class="node">
<title>mha_attn_14</title>
<polygon fill="lightblue" stroke="black" points="13882,-835 13712,-835 13712,-782 13882,-782 13882,-835"/>
<text text-anchor="middle" x="13797" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="13797" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13797" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge226" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M13484.63,-870.98C13554.14,-857.3 13638.3,-840.74 13701.74,-828.25"/>
<polygon fill="black" stroke="black" points="13702.6,-831.65 13711.74,-826.28 13701.25,-824.78 13702.6,-831.65"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge227" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M13734.93,-870.87C13743.98,-861.92 13754.26,-851.75 13763.82,-842.3"/>
<polygon fill="black" stroke="black" points="13766.3,-844.77 13770.95,-835.25 13761.38,-839.79 13766.3,-844.77"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge228" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M13984.99,-870.98C13953.59,-860.72 13917.23,-848.82 13884.9,-838.25"/>
<polygon fill="black" stroke="black" points="13885.6,-834.8 13875.01,-835.01 13883.43,-841.45 13885.6,-834.8"/>
</g>
<!-- mha_out_14 -->
<g id="node175" class="node">
<title>mha_out_14</title>
<polygon fill="lightblue" stroke="black" points="14142,-719.5 13806,-719.5 13806,-666.5 14142,-666.5 14142,-719.5"/>
<text text-anchor="middle" x="13974" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="13974" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13974" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge229" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M13837.16,-781.75C13863.3,-764.98 13897.56,-743.02 13925.25,-725.26"/>
<polygon fill="black" stroke="black" points="13927.47,-728 13933.99,-719.65 13923.69,-722.1 13927.47,-728"/>
</g>
<!-- residual1_14 -->
<g id="node176" class="node">
<title>residual1_14</title>
<polygon fill="lightcoral" stroke="black" points="14474.86,-604 13905.58,-604 13759.14,-498 14328.42,-498 14474.86,-604"/>
<text text-anchor="middle" x="14117" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="14117" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14117" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge231" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M14000.23,-666.32C14016.03,-650.85 14036.84,-630.48 14056.5,-611.23"/>
<polygon fill="black" stroke="black" points="14058.99,-613.69 14063.69,-604.19 14054.09,-608.69 14058.99,-613.69"/>
</g>
<!-- ln2_14 -->
<g id="node177" class="node">
<title>ln2_14</title>
<polygon fill="lightyellow" stroke="black" points="12627,-1600.74 12457,-1600.74 12457,-1547.74 12627,-1547.74 12627,-1600.74"/>
<text text-anchor="middle" x="12542" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="12542" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12542" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn1_14 -->
<g id="node178" class="node">
<title>ffn1_14</title>
<polygon fill="lightblue" stroke="black" points="12757.5,-1511.74 12412.5,-1511.74 12412.5,-1458.74 12757.5,-1458.74 12757.5,-1511.74"/>
<text text-anchor="middle" x="12585" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="12585" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="12585" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ln2_14&#45;&gt;ffn1_14 -->
<g id="edge233" class="edge">
<title>ln2_14&#45;&gt;ffn1_14</title>
<path fill="none" stroke="black" d="M12554.67,-1547.61C12558.79,-1539.27 12563.43,-1529.88 12567.82,-1521"/>
<polygon fill="black" stroke="black" points="12570.98,-1522.51 12572.27,-1511.99 12564.7,-1519.4 12570.98,-1522.51"/>
</g>
<!-- gelu_14 -->
<g id="node179" class="node">
<title>gelu_14</title>
<polygon fill="lightblue" stroke="black" points="12747.5,-1422.74 12568.5,-1422.74 12568.5,-1369.74 12747.5,-1369.74 12747.5,-1422.74"/>
<text text-anchor="middle" x="12658" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="12658" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="12658" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn1_14&#45;&gt;gelu_14 -->
<g id="edge234" class="edge">
<title>ffn1_14&#45;&gt;gelu_14</title>
<path fill="none" stroke="black" d="M12606.51,-1458.61C12613.79,-1449.92 12622.05,-1440.09 12629.77,-1430.88"/>
<polygon fill="black" stroke="black" points="12632.65,-1432.9 12636.39,-1422.99 12627.28,-1428.4 12632.65,-1432.9"/>
</g>
<!-- ffn2_14 -->
<g id="node180" class="node">
<title>ffn2_14</title>
<polygon fill="lightblue" stroke="black" points="12903.5,-1333.74 12558.5,-1333.74 12558.5,-1280.74 12903.5,-1280.74 12903.5,-1333.74"/>
<text text-anchor="middle" x="12731" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="12731" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="12731" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- gelu_14&#45;&gt;ffn2_14 -->
<g id="edge235" class="edge">
<title>gelu_14&#45;&gt;ffn2_14</title>
<path fill="none" stroke="black" d="M12679.51,-1369.61C12686.79,-1360.92 12695.05,-1351.09 12702.77,-1341.88"/>
<polygon fill="black" stroke="black" points="12705.65,-1343.9 12709.39,-1333.99 12700.28,-1339.4 12705.65,-1343.9"/>
</g>
<!-- residual2_14 -->
<g id="node181" class="node">
<title>residual2_14</title>
<polygon fill="lightcoral" stroke="black" points="13603.86,-1244.74 13034.58,-1244.74 12888.14,-1138.74 13457.42,-1138.74 13603.86,-1244.74"/>
<text text-anchor="middle" x="13246" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="13246" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13246" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- ffn2_14&#45;&gt;residual2_14 -->
<g id="edge237" class="edge">
<title>ffn2_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M12846.9,-1280.7C12897.82,-1269.47 12959.47,-1255.89 13018.93,-1242.78"/>
<polygon fill="black" stroke="black" points="13019.82,-1246.17 13028.84,-1240.6 13018.32,-1239.33 13019.82,-1246.17"/>
</g>
<!-- comm_14_15 -->
<g id="node195" class="node">
<title>comm_14_15</title>
<ellipse fill="lightgreen" stroke="black" cx="14809" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="14809" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 13 → GPU 14</text>
<text text-anchor="middle" x="14809" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_14&#45;&gt;comm_14_15 -->
<g id="edge238" class="edge">
<title>residual2_14&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M13479.44,-1154.39C13523.39,-1148.45 13569.04,-1142.89 13612,-1138.74 13999.39,-1101.29 14459.65,-1085.53 14679.52,-1079.77"/>
<polygon fill="black" stroke="black" points="14679.91,-1083.26 14689.81,-1079.5 14679.72,-1076.26 14679.91,-1083.26"/>
</g>
<!-- comm_13_14&#45;&gt;ln1_14 -->
<g id="edge222" class="edge">
<title>comm_13_14&#45;&gt;ln1_14</title>
<path fill="none" stroke="black" d="M13709,-1048.66C13709,-1040.65 13709,-1031.71 13709,-1023.19"/>
<polygon fill="black" stroke="black" points="13712.5,-1023.09 13709,-1013.09 13705.5,-1023.09 13712.5,-1023.09"/>
</g>
<!-- comm_13_14&#45;&gt;residual1_14 -->
<g id="edge230" class="edge">
<title>comm_13_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M13814.39,-1062.84C13974.1,-1041.64 14259,-990.88 14259,-898.5 14259,-898.5 14259,-898.5 14259,-807.5 14259,-733.47 14212.89,-660.84 14173.22,-612.06"/>
<polygon fill="black" stroke="black" points="14175.74,-609.61 14166.66,-604.14 14170.34,-614.08 14175.74,-609.61"/>
</g>
<!-- ln1_15 -->
<g id="node183" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="14894,-1013 14724,-1013 14724,-960 14894,-960 14894,-1013"/>
<text text-anchor="middle" x="14809" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="14809" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14809" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_q_15 -->
<g id="node184" class="node">
<title>mha_q_15</title>
<polygon fill="lightblue" stroke="black" points="14623,-924 14287,-924 14287,-871 14623,-871 14623,-924"/>
<text text-anchor="middle" x="14455" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="14455" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14455" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_q_15 -->
<g id="edge240" class="edge">
<title>ln1_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M14723.76,-964.55C14677.25,-953.12 14619.05,-938.82 14568.72,-926.45"/>
<polygon fill="black" stroke="black" points="14569.31,-922.99 14558.76,-924 14567.64,-929.79 14569.31,-922.99"/>
</g>
<!-- mha_k_15 -->
<g id="node185" class="node">
<title>mha_k_15</title>
<polygon fill="lightblue" stroke="black" points="14977,-924 14641,-924 14641,-871 14977,-871 14977,-924"/>
<text text-anchor="middle" x="14809" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="14809" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14809" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_k_15 -->
<g id="edge241" class="edge">
<title>ln1_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M14809,-959.87C14809,-951.89 14809,-942.93 14809,-934.38"/>
<polygon fill="black" stroke="black" points="14812.5,-934.25 14809,-924.25 14805.5,-934.25 14812.5,-934.25"/>
</g>
<!-- mha_v_15 -->
<g id="node186" class="node">
<title>mha_v_15</title>
<polygon fill="lightblue" stroke="black" points="15331,-924 14995,-924 14995,-871 15331,-871 15331,-924"/>
<text text-anchor="middle" x="15163" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="15163" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15163" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln1_15&#45;&gt;mha_v_15 -->
<g id="edge242" class="edge">
<title>ln1_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M14894.24,-964.55C14940.75,-953.12 14998.95,-938.82 15049.28,-926.45"/>
<polygon fill="black" stroke="black" points="15050.36,-929.79 15059.24,-924 15048.69,-922.99 15050.36,-929.79"/>
</g>
<!-- mha_attn_15 -->
<g id="node187" class="node">
<title>mha_attn_15</title>
<polygon fill="lightblue" stroke="black" points="14982,-835 14812,-835 14812,-782 14982,-782 14982,-835"/>
<text text-anchor="middle" x="14897" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="14897" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14897" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge243" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M14584.63,-870.98C14654.14,-857.3 14738.3,-840.74 14801.74,-828.25"/>
<polygon fill="black" stroke="black" points="14802.6,-831.65 14811.74,-826.28 14801.25,-824.78 14802.6,-831.65"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge244" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M14834.93,-870.87C14843.98,-861.92 14854.26,-851.75 14863.82,-842.3"/>
<polygon fill="black" stroke="black" points="14866.3,-844.77 14870.95,-835.25 14861.38,-839.79 14866.3,-844.77"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge245" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M15084.99,-870.98C15053.59,-860.72 15017.23,-848.82 14984.9,-838.25"/>
<polygon fill="black" stroke="black" points="14985.6,-834.8 14975.01,-835.01 14983.43,-841.45 14985.6,-834.8"/>
</g>
<!-- mha_out_15 -->
<g id="node188" class="node">
<title>mha_out_15</title>
<polygon fill="lightblue" stroke="black" points="15242,-719.5 14906,-719.5 14906,-666.5 15242,-666.5 15242,-719.5"/>
<text text-anchor="middle" x="15074" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="15074" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15074" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge246" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M14937.16,-781.75C14963.3,-764.98 14997.56,-743.02 15025.25,-725.26"/>
<polygon fill="black" stroke="black" points="15027.47,-728 15033.99,-719.65 15023.69,-722.1 15027.47,-728"/>
</g>
<!-- residual1_15 -->
<g id="node189" class="node">
<title>residual1_15</title>
<polygon fill="lightcoral" stroke="black" points="15649.86,-604 15080.58,-604 14934.14,-498 15503.42,-498 15649.86,-604"/>
<text text-anchor="middle" x="15292" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="15292" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15292" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge248" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M15113.73,-666.48C15138.54,-650.55 15171.52,-629.37 15202.37,-609.56"/>
<polygon fill="black" stroke="black" points="15204.48,-612.37 15211,-604.02 15200.7,-606.48 15204.48,-612.37"/>
</g>
<!-- ln2_15 -->
<g id="node190" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="13630,-1600.74 13460,-1600.74 13460,-1547.74 13630,-1547.74 13630,-1600.74"/>
<text text-anchor="middle" x="13545" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="13545" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13545" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn1_15 -->
<g id="node191" class="node">
<title>ffn1_15</title>
<polygon fill="lightblue" stroke="black" points="13760.5,-1511.74 13415.5,-1511.74 13415.5,-1458.74 13760.5,-1458.74 13760.5,-1511.74"/>
<text text-anchor="middle" x="13588" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="13588" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="13588" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ln2_15&#45;&gt;ffn1_15 -->
<g id="edge250" class="edge">
<title>ln2_15&#45;&gt;ffn1_15</title>
<path fill="none" stroke="black" d="M13557.67,-1547.61C13561.79,-1539.27 13566.43,-1529.88 13570.82,-1521"/>
<polygon fill="black" stroke="black" points="13573.98,-1522.51 13575.27,-1511.99 13567.7,-1519.4 13573.98,-1522.51"/>
</g>
<!-- gelu_15 -->
<g id="node192" class="node">
<title>gelu_15</title>
<polygon fill="lightblue" stroke="black" points="13716.5,-1422.74 13537.5,-1422.74 13537.5,-1369.74 13716.5,-1369.74 13716.5,-1422.74"/>
<text text-anchor="middle" x="13627" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="13627" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="13627" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn1_15&#45;&gt;gelu_15 -->
<g id="edge251" class="edge">
<title>ffn1_15&#45;&gt;gelu_15</title>
<path fill="none" stroke="black" d="M13599.49,-1458.61C13603.19,-1450.36 13607.35,-1441.08 13611.29,-1432.28"/>
<polygon fill="black" stroke="black" points="13614.56,-1433.55 13615.46,-1422.99 13608.17,-1430.68 13614.56,-1433.55"/>
</g>
<!-- ffn2_15 -->
<g id="node193" class="node">
<title>ffn2_15</title>
<polygon fill="lightblue" stroke="black" points="13838.5,-1333.74 13493.5,-1333.74 13493.5,-1280.74 13838.5,-1280.74 13838.5,-1333.74"/>
<text text-anchor="middle" x="13666" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="13666" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13666" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- gelu_15&#45;&gt;ffn2_15 -->
<g id="edge252" class="edge">
<title>gelu_15&#45;&gt;ffn2_15</title>
<path fill="none" stroke="black" d="M13638.49,-1369.61C13642.19,-1361.36 13646.35,-1352.08 13650.29,-1343.28"/>
<polygon fill="black" stroke="black" points="13653.56,-1344.55 13654.46,-1333.99 13647.17,-1341.68 13653.56,-1344.55"/>
</g>
<!-- residual2_15 -->
<g id="node194" class="node">
<title>residual2_15</title>
<polygon fill="lightcoral" stroke="black" points="14336.86,-1244.74 13767.58,-1244.74 13621.14,-1138.74 14190.42,-1138.74 14336.86,-1244.74"/>
<text text-anchor="middle" x="13979" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="13979" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="13979" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- ffn2_15&#45;&gt;residual2_15 -->
<g id="edge254" class="edge">
<title>ffn2_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M13736.63,-1280.63C13763.19,-1271 13794.52,-1259.64 13825.68,-1248.34"/>
<polygon fill="black" stroke="black" points="13827.13,-1251.53 13835.34,-1244.84 13824.74,-1244.95 13827.13,-1251.53"/>
</g>
<!-- comm_15_16 -->
<g id="node208" class="node">
<title>comm_15_16</title>
<ellipse fill="lightgreen" stroke="black" cx="15488" cy="-1075.87" rx="120.42" ry="26.74"/>
<text text-anchor="middle" x="15488" y="-1079.67" font-family="Times,serif" font-size="14.00">GPU 14 → GPU 15</text>
<text text-anchor="middle" x="15488" y="-1064.67" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
</g>
<!-- residual2_15&#45;&gt;comm_15_16 -->
<g id="edge255" class="edge">
<title>residual2_15&#45;&gt;comm_15_16</title>
<path fill="none" stroke="black" d="M14212.44,-1154.48C14256.4,-1148.53 14302.04,-1142.95 14345,-1138.74 14443.81,-1129.06 15084.89,-1096.79 15361.39,-1083.1"/>
<polygon fill="black" stroke="black" points="15361.66,-1086.59 15371.47,-1082.6 15361.31,-1079.6 15361.66,-1086.59"/>
</g>
<!-- comm_14_15&#45;&gt;ln1_15 -->
<g id="edge239" class="edge">
<title>comm_14_15&#45;&gt;ln1_15</title>
<path fill="none" stroke="black" d="M14809,-1048.66C14809,-1040.65 14809,-1031.71 14809,-1023.19"/>
<polygon fill="black" stroke="black" points="14812.5,-1023.09 14809,-1013.09 14805.5,-1023.09 14812.5,-1023.09"/>
</g>
<!-- comm_14_15&#45;&gt;residual1_15 -->
<g id="edge247" class="edge">
<title>comm_14_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M14914.39,-1062.84C15074.1,-1041.64 15359,-990.88 15359,-898.5 15359,-898.5 15359,-898.5 15359,-807.5 15359,-739.65 15336.62,-664.88 15317.73,-613.85"/>
<polygon fill="black" stroke="black" points="15320.92,-612.41 15314.12,-604.29 15314.37,-614.88 15320.92,-612.41"/>
</g>
<!-- ln1_16 -->
<g id="node196" class="node">
<title>ln1_16</title>
<polygon fill="lightyellow" stroke="black" points="15817,-1013 15647,-1013 15647,-960 15817,-960 15817,-1013"/>
<text text-anchor="middle" x="15732" y="-997.8" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="15732" y="-982.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15732" y="-967.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_q_16 -->
<g id="node197" class="node">
<title>mha_q_16</title>
<polygon fill="lightblue" stroke="black" points="15723,-924 15387,-924 15387,-871 15723,-871 15723,-924"/>
<text text-anchor="middle" x="15555" y="-908.8" font-family="Times,serif" font-size="14.00">MHA Q Linear</text>
<text text-anchor="middle" x="15555" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15555" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_q_16 -->
<g id="edge257" class="edge">
<title>ln1_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M15679.85,-959.87C15659.87,-950.04 15636.88,-938.75 15616.13,-928.55"/>
<polygon fill="black" stroke="black" points="15617.6,-925.37 15607.08,-924.1 15614.51,-931.65 15617.6,-925.37"/>
</g>
<!-- mha_k_16 -->
<g id="node198" class="node">
<title>mha_k_16</title>
<polygon fill="lightblue" stroke="black" points="16077,-924 15741,-924 15741,-871 16077,-871 16077,-924"/>
<text text-anchor="middle" x="15909" y="-908.8" font-family="Times,serif" font-size="14.00">MHA K Linear</text>
<text text-anchor="middle" x="15909" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15909" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_k_16 -->
<g id="edge258" class="edge">
<title>ln1_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M15784.15,-959.87C15804.13,-950.04 15827.12,-938.75 15847.87,-928.55"/>
<polygon fill="black" stroke="black" points="15849.49,-931.65 15856.92,-924.1 15846.4,-925.37 15849.49,-931.65"/>
</g>
<!-- mha_v_16 -->
<g id="node199" class="node">
<title>mha_v_16</title>
<polygon fill="lightblue" stroke="black" points="16431,-924 16095,-924 16095,-871 16431,-871 16431,-924"/>
<text text-anchor="middle" x="16263" y="-908.8" font-family="Times,serif" font-size="14.00">MHA V Linear</text>
<text text-anchor="middle" x="16263" y="-893.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="16263" y="-878.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln1_16&#45;&gt;mha_v_16 -->
<g id="edge259" class="edge">
<title>ln1_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M15817.02,-971.57C15892.28,-959.24 16004.29,-940.89 16097.23,-925.66"/>
<polygon fill="black" stroke="black" points="16098.01,-929.08 16107.31,-924.01 16096.88,-922.17 16098.01,-929.08"/>
</g>
<!-- mha_attn_16 -->
<g id="node200" class="node">
<title>mha_attn_16</title>
<polygon fill="lightblue" stroke="black" points="16027,-835 15857,-835 15857,-782 16027,-782 16027,-835"/>
<text text-anchor="middle" x="15942" y="-819.8" font-family="Times,serif" font-size="14.00">MHA Attention</text>
<text text-anchor="middle" x="15942" y="-804.8" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15942" y="-789.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge260" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M15668.5,-870.98C15725.19,-858.24 15793,-843 15846.91,-830.88"/>
<polygon fill="black" stroke="black" points="15847.83,-834.26 15856.81,-828.65 15846.29,-827.43 15847.83,-834.26"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge261" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M15918.72,-870.87C15921.82,-862.71 15925.3,-853.54 15928.6,-844.82"/>
<polygon fill="black" stroke="black" points="15931.96,-845.84 15932.23,-835.25 15925.41,-843.36 15931.96,-845.84"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge262" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M16168.86,-870.98C16127.33,-859.73 16078.6,-846.52 16036.97,-835.24"/>
<polygon fill="black" stroke="black" points="16037.67,-831.8 16027.1,-832.57 16035.84,-838.56 16037.67,-831.8"/>
</g>
<!-- mha_out_16 -->
<g id="node201" class="node">
<title>mha_out_16</title>
<polygon fill="lightblue" stroke="black" points="16144,-719.5 15808,-719.5 15808,-666.5 16144,-666.5 16144,-719.5"/>
<text text-anchor="middle" x="15976" y="-704.3" font-family="Times,serif" font-size="14.00">MHA Output Linear</text>
<text text-anchor="middle" x="15976" y="-689.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="15976" y="-674.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge263" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M15949.72,-781.75C15954.37,-766.22 15960.36,-746.22 15965.44,-729.25"/>
<polygon fill="black" stroke="black" points="15968.8,-730.24 15968.32,-719.65 15962.09,-728.23 15968.8,-730.24"/>
</g>
<!-- residual1_16 -->
<g id="node202" class="node">
<title>residual1_16</title>
<polygon fill="lightcoral" stroke="black" points="16467.86,-604 15898.58,-604 15752.14,-498 16321.42,-498 16467.86,-604"/>
<text text-anchor="middle" x="16110" y="-562.3" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="16110" y="-547.3" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="16110" y="-532.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge265" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M16000.58,-666.32C16015.32,-650.92 16034.71,-630.66 16053.07,-611.48"/>
<polygon fill="black" stroke="black" points="16055.66,-613.84 16060.04,-604.19 16050.6,-609 16055.66,-613.84"/>
</g>
<!-- ln2_16 -->
<g id="node203" class="node">
<title>ln2_16</title>
<polygon fill="lightyellow" stroke="black" points="14431,-1600.74 14261,-1600.74 14261,-1547.74 14431,-1547.74 14431,-1600.74"/>
<text text-anchor="middle" x="14346" y="-1585.54" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="14346" y="-1570.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14346" y="-1555.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn1_16 -->
<g id="node204" class="node">
<title>ffn1_16</title>
<polygon fill="lightblue" stroke="black" points="14561.5,-1511.74 14216.5,-1511.74 14216.5,-1458.74 14561.5,-1458.74 14561.5,-1511.74"/>
<text text-anchor="middle" x="14389" y="-1496.54" font-family="Times,serif" font-size="14.00">FFN Linear1</text>
<text text-anchor="middle" x="14389" y="-1481.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192]→[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="14389" y="-1466.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ln2_16&#45;&gt;ffn1_16 -->
<g id="edge267" class="edge">
<title>ln2_16&#45;&gt;ffn1_16</title>
<path fill="none" stroke="black" d="M14358.67,-1547.61C14362.79,-1539.27 14367.43,-1529.88 14371.82,-1521"/>
<polygon fill="black" stroke="black" points="14374.98,-1522.51 14376.27,-1511.99 14368.7,-1519.4 14374.98,-1522.51"/>
</g>
<!-- gelu_16 -->
<g id="node205" class="node">
<title>gelu_16</title>
<polygon fill="lightblue" stroke="black" points="14509.5,-1422.74 14330.5,-1422.74 14330.5,-1369.74 14509.5,-1369.74 14509.5,-1422.74"/>
<text text-anchor="middle" x="14420" y="-1407.54" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="14420" y="-1392.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]</text>
<text text-anchor="middle" x="14420" y="-1377.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn1_16&#45;&gt;gelu_16 -->
<g id="edge268" class="edge">
<title>ffn1_16&#45;&gt;gelu_16</title>
<path fill="none" stroke="black" d="M14398.13,-1458.61C14401.04,-1450.45 14404.31,-1441.28 14407.41,-1432.56"/>
<polygon fill="black" stroke="black" points="14410.77,-1433.58 14410.82,-1422.99 14404.17,-1431.23 14410.77,-1433.58"/>
</g>
<!-- ffn2_16 -->
<g id="node206" class="node">
<title>ffn2_16</title>
<polygon fill="lightblue" stroke="black" points="14622.5,-1333.74 14277.5,-1333.74 14277.5,-1280.74 14622.5,-1280.74 14622.5,-1333.74"/>
<text text-anchor="middle" x="14450" y="-1318.54" font-family="Times,serif" font-size="14.00">FFN Linear2</text>
<text text-anchor="middle" x="14450" y="-1303.54" font-family="Times,serif" font-size="14.00">[1024, seq_len, 32768]→[1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14450" y="-1288.54" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- gelu_16&#45;&gt;ffn2_16 -->
<g id="edge269" class="edge">
<title>gelu_16&#45;&gt;ffn2_16</title>
<path fill="none" stroke="black" d="M14428.84,-1369.61C14431.65,-1361.45 14434.81,-1352.28 14437.82,-1343.56"/>
<polygon fill="black" stroke="black" points="14441.17,-1344.58 14441.12,-1333.99 14434.55,-1342.3 14441.17,-1344.58"/>
</g>
<!-- residual2_16 -->
<g id="node207" class="node">
<title>residual2_16</title>
<polygon fill="lightcoral" stroke="black" points="15069.86,-1244.74 14500.58,-1244.74 14354.14,-1138.74 14923.42,-1138.74 15069.86,-1244.74"/>
<text text-anchor="middle" x="14712" y="-1203.04" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="14712" y="-1188.04" font-family="Times,serif" font-size="14.00">[1024, seq_len, 8192] + [1024, seq_len, 8192]</text>
<text text-anchor="middle" x="14712" y="-1173.04" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- ffn2_16&#45;&gt;residual2_16 -->
<g id="edge271" class="edge">
<title>ffn2_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M14509.12,-1280.63C14530.97,-1271.16 14556.67,-1260.03 14582.31,-1248.92"/>
<polygon fill="black" stroke="black" points="14583.96,-1252.02 14591.74,-1244.84 14581.18,-1245.6 14583.96,-1252.02"/>
</g>
<!-- output -->
<g id="node209" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="15826" cy="-1075.87" rx="200.22" ry="26.74"/>
<text text-anchor="middle" x="15826" y="-1079.67" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="15826" y="-1064.67" font-family="Times,serif" font-size="14.00">[batch=1024, seq_len, hidden=8192]</text>
</g>
<!-- residual2_16&#45;&gt;output -->
<g id="edge272" class="edge">
<title>residual2_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M14964.29,-1167.99C15145.93,-1151.18 15396.75,-1127.08 15617,-1102.74 15635.57,-1100.69 15655.05,-1098.43 15674.34,-1096.12"/>
<polygon fill="black" stroke="black" points="15674.89,-1099.58 15684.4,-1094.91 15674.06,-1092.63 15674.89,-1099.58"/>
</g>
<!-- comm_15_16&#45;&gt;ln1_16 -->
<g id="edge256" class="edge">
<title>comm_15_16&#45;&gt;ln1_16</title>
<path fill="none" stroke="black" d="M15549.89,-1052.71C15580.6,-1041.71 15618.09,-1028.29 15651.05,-1016.49"/>
<polygon fill="black" stroke="black" points="15652.43,-1019.71 15660.67,-1013.04 15650.07,-1013.12 15652.43,-1019.71"/>
</g>
<!-- comm_15_16&#45;&gt;residual1_16 -->
<g id="edge264" class="edge">
<title>comm_15_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M15573.94,-1057.05C15588.29,-1054.24 15603.05,-1051.46 15617,-1049 15804.2,-1016.03 16459,-1088.58 16459,-898.5 16459,-898.5 16459,-898.5 16459,-807.5 16459,-711.86 16372.61,-648.14 16285.79,-608.25"/>
<polygon fill="black" stroke="black" points="16287.13,-605.02 16276.58,-604.11 16284.26,-611.4 16287.13,-605.02"/>
</g>
<!-- residual1_{layer} -->
<g id="node210" class="node">
<title>residual1_{layer}</title>
<polygon fill="lightblue" stroke="black" points="9597,-1681.61 9453,-1681.61 9453,-1645.61 9597,-1645.61 9597,-1681.61"/>
<text text-anchor="middle" x="9525" y="-1659.91" font-family="Times,serif" font-size="14.00">residual1_{layer}</text>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_2 -->
<g id="edge28" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M9452.92,-1662.34C8909.9,-1660.19 5469.79,-1644.87 5010,-1600.74 4994.87,-1599.29 4978.92,-1597.09 4963.41,-1594.58"/>
<polygon fill="black" stroke="black" points="4963.73,-1591.09 4953.29,-1592.89 4962.58,-1597.99 4963.73,-1591.09"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_2 -->
<g id="edge32" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M9452.69,-1662.53C8941.5,-1661.83 5880.93,-1655.34 5472,-1600.74 5268.3,-1573.54 5024,-1691.75 5024,-1486.24 5024,-1486.24 5024,-1486.24 5024,-1395.24 5024,-1330.16 4891.13,-1280.83 4753.24,-1247.16"/>
<polygon fill="black" stroke="black" points="4753.85,-1243.7 4743.31,-1244.76 4752.21,-1250.51 4753.85,-1243.7"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_3 -->
<g id="edge45" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M9452.64,-1662.14C8958.87,-1658.85 6093.59,-1638.24 5708,-1600.74 5692.87,-1599.27 5676.93,-1597.06 5661.41,-1594.55"/>
<polygon fill="black" stroke="black" points="5661.73,-1591.05 5651.29,-1592.86 5660.58,-1597.96 5661.73,-1591.05"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_3 -->
<g id="edge49" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M9452.88,-1662.54C8988.89,-1661.91 6432.45,-1655.94 6090,-1600.74 5920.89,-1573.48 5722,-1657.53 5722,-1486.24 5722,-1486.24 5722,-1486.24 5722,-1395.24 5722,-1332.09 5590.73,-1281.96 5457.75,-1247.36"/>
<polygon fill="black" stroke="black" points="5458.32,-1243.9 5447.76,-1244.8 5456.58,-1250.68 5458.32,-1243.9"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_4 -->
<g id="edge62" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M9453,-1662.49C9041.45,-1661.62 6983.33,-1654.57 6352,-1600.74 6328.34,-1598.72 6302.94,-1595.45 6279.25,-1591.92"/>
<polygon fill="black" stroke="black" points="6279.62,-1588.43 6269.21,-1590.39 6278.57,-1595.35 6279.62,-1588.43"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_4 -->
<g id="edge66" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M9452.74,-1662.81C9083.16,-1663.56 7401.63,-1663.41 6884,-1600.74 6649.93,-1572.4 6366,-1722.02 6366,-1486.24 6366,-1486.24 6366,-1486.24 6366,-1395.24 6366,-1325.22 6320.13,-1279.27 6257.69,-1249.16"/>
<polygon fill="black" stroke="black" points="6258.9,-1245.86 6248.36,-1244.83 6255.95,-1252.21 6258.9,-1245.86"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_5 -->
<g id="edge79" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M9452.71,-1662.23C9103.56,-1660.18 7589.4,-1648.64 7120,-1600.74 7104.87,-1599.2 7088.94,-1596.95 7073.42,-1594.42"/>
<polygon fill="black" stroke="black" points="7073.75,-1590.93 7063.31,-1592.73 7072.59,-1597.83 7073.75,-1590.93"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_5 -->
<g id="edge83" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M9452.97,-1661.65C9161.37,-1657.53 8067.7,-1639.75 7724,-1600.74 7458.59,-1570.62 7134,-1753.35 7134,-1486.24 7134,-1486.24 7134,-1486.24 7134,-1395.24 7134,-1335.44 7006.84,-1283.78 6882.73,-1247.61"/>
<polygon fill="black" stroke="black" points="6883.62,-1244.23 6873.04,-1244.82 6881.68,-1250.95 6883.62,-1244.23"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_6 -->
<g id="edge96" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M9452.64,-1662.77C9231.21,-1662.62 8543.38,-1657.27 7977,-1600.74 7956.23,-1598.67 7934.04,-1595.63 7913.04,-1592.38"/>
<polygon fill="black" stroke="black" points="7913.59,-1588.92 7903.16,-1590.81 7912.49,-1595.83 7913.59,-1588.92"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_6 -->
<g id="edge100" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M9452.81,-1662C9149.14,-1658.48 7991,-1635.31 7991,-1486.24 7991,-1486.24 7991,-1486.24 7991,-1395.24 7991,-1328.53 7857.75,-1279.92 7715.9,-1247.07"/>
<polygon fill="black" stroke="black" points="7716.64,-1243.65 7706.11,-1244.83 7715.08,-1250.48 7716.64,-1243.65"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_7 -->
<g id="edge113" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M9452.9,-1659.34C9300.14,-1652.04 8932.75,-1632.51 8626,-1600.74 8597.02,-1597.74 8565.58,-1593.68 8537.02,-1589.68"/>
<polygon fill="black" stroke="black" points="8537.44,-1586.21 8527.05,-1588.27 8536.46,-1593.14 8537.44,-1586.21"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_7 -->
<g id="edge117" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M9452.95,-1663.5C9241.93,-1664.18 8640,-1651.62 8640,-1486.24 8640,-1486.24 8640,-1486.24 8640,-1395.24 8640,-1332.87 8509.41,-1282.35 8378.48,-1247.36"/>
<polygon fill="black" stroke="black" points="8379.22,-1243.94 8368.66,-1244.76 8377.43,-1250.7 8379.22,-1243.94"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_8 -->
<g id="edge130" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M9452.87,-1652.19C9371.45,-1640.3 9235.07,-1620 9118,-1600.74 9102.23,-1598.15 9085.51,-1595.29 9069.27,-1592.45"/>
<polygon fill="black" stroke="black" points="9069.68,-1588.97 9059.22,-1590.69 9068.47,-1595.86 9069.68,-1588.97"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_8 -->
<g id="edge134" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M9452.92,-1661.46C9339.46,-1655.41 9132,-1625.34 9132,-1486.24 9132,-1486.24 9132,-1486.24 9132,-1395.24 9132,-1328 9078.57,-1280.99 9018.06,-1249.32"/>
<polygon fill="black" stroke="black" points="9019.59,-1246.17 9009.09,-1244.75 9016.41,-1252.41 9019.59,-1246.17"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_9 -->
<g id="edge147" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M9505.24,-1645.35C9492.95,-1634.61 9476.75,-1620.45 9462.12,-1607.67"/>
<polygon fill="black" stroke="black" points="9464.03,-1604.69 9454.19,-1600.75 9459.42,-1609.96 9464.03,-1604.69"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_9 -->
<g id="edge151" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M9534.67,-1645.19C9550.93,-1614.21 9582,-1547.06 9582,-1486.24 9582,-1486.24 9582,-1486.24 9582,-1395.24 9582,-1348.18 9581.73,-1294.98 9581.47,-1254.91"/>
<polygon fill="black" stroke="black" points="9584.96,-1254.74 9581.4,-1244.76 9577.96,-1254.79 9584.96,-1254.74"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_10 -->
<g id="edge164" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M9572.82,-1645.56C9605.68,-1633.84 9650.15,-1617.98 9688.53,-1604.29"/>
<polygon fill="black" stroke="black" points="9689.9,-1607.52 9698.15,-1600.86 9687.55,-1600.93 9689.9,-1607.52"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_10 -->
<g id="edge168" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M9597.05,-1654.78C9746,-1636.59 10074,-1585.29 10074,-1486.24 10074,-1486.24 10074,-1486.24 10074,-1395.24 10074,-1331.07 10124.73,-1283.1 10179.55,-1250"/>
<polygon fill="black" stroke="black" points="10181.53,-1252.9 10188.38,-1244.82 10177.98,-1246.86 10181.53,-1252.9"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_11 -->
<g id="edge181" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M9597.24,-1656.54C9780.3,-1641.14 10262.46,-1600.6 10468.47,-1583.27"/>
<polygon fill="black" stroke="black" points="10468.99,-1586.74 10478.66,-1582.42 10468.4,-1579.77 10468.99,-1586.74"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_11 -->
<g id="edge185" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M9597.3,-1661.43C9813.7,-1657.47 10453.9,-1642.45 10658,-1600.74 10803.95,-1570.91 10973,-1635.2 10973,-1486.24 10973,-1486.24 10973,-1486.24 10973,-1395.24 10973,-1345.69 10992.79,-1293.23 11011.9,-1254.13"/>
<polygon fill="black" stroke="black" points="11015.13,-1255.5 11016.47,-1244.99 11008.87,-1252.36 11015.13,-1255.5"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_12 -->
<g id="edge198" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M9597.14,-1662.97C9810.32,-1663.32 10455.74,-1659.08 10987,-1600.74 11002.57,-1599.03 11019,-1596.65 11034.96,-1594.02"/>
<polygon fill="black" stroke="black" points="11035.55,-1597.47 11044.82,-1592.36 11034.38,-1590.57 11035.55,-1597.47"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_12 -->
<g id="edge202" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M9597.15,-1662.29C9900.98,-1660.65 11067.82,-1651.09 11224,-1600.74 11311.4,-1572.56 11396,-1578.07 11396,-1486.24 11396,-1486.24 11396,-1486.24 11396,-1395.24 11396,-1343.42 11382.26,-1318.26 11418,-1280.74 11436.95,-1260.85 11483.19,-1244.46 11536.53,-1231.45"/>
<polygon fill="black" stroke="black" points="11537.65,-1234.78 11546.57,-1229.06 11536.03,-1227.98 11537.65,-1234.78"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_13 -->
<g id="edge215" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M9597.04,-1661.61C9897.08,-1657.23 11048.59,-1638.26 11410,-1600.74 11426.11,-1599.07 11443.12,-1596.66 11459.61,-1593.99"/>
<polygon fill="black" stroke="black" points="11460.5,-1597.39 11469.79,-1592.29 11459.35,-1590.48 11460.5,-1597.39"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_13 -->
<g id="edge219" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M9597.21,-1662.92C9946.36,-1664.08 11450.75,-1665.28 11649,-1600.74 11729.76,-1574.45 11802,-1571.17 11802,-1486.24 11802,-1486.24 11802,-1486.24 11802,-1395.24 11802,-1344.7 12071.12,-1279.7 12278.22,-1237.16"/>
<polygon fill="black" stroke="black" points="12278.94,-1240.59 12288.04,-1235.15 12277.54,-1233.73 12278.94,-1240.59"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_14 -->
<g id="edge232" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M9597.23,-1660.87C9880.38,-1654.02 10942.06,-1627.89 11816,-1600.74 12042.13,-1593.72 12307.83,-1584.01 12446.61,-1578.84"/>
<polygon fill="black" stroke="black" points="12446.92,-1582.33 12456.79,-1578.46 12446.66,-1575.33 12446.92,-1582.33"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_14 -->
<g id="edge236" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M9597.23,-1662.19C10035.17,-1659.5 12326.46,-1643.49 12636,-1600.74 12836.17,-1573.1 13076,-1688.31 13076,-1486.24 13076,-1486.24 13076,-1486.24 13076,-1395.24 13076,-1337.33 13117.28,-1287.33 13159.16,-1251.49"/>
<polygon fill="black" stroke="black" points="13161.54,-1254.06 13166.97,-1244.97 13157.05,-1248.69 13161.54,-1254.06"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_15 -->
<g id="edge249" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M9597.21,-1662.39C9966.91,-1661.07 11685,-1652.28 13090,-1600.74 13214.41,-1596.18 13357.78,-1587.59 13449.8,-1581.65"/>
<polygon fill="black" stroke="black" points="13450.18,-1585.13 13459.93,-1580.99 13449.72,-1578.15 13450.18,-1585.13"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_15 -->
<g id="edge253" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M9597.21,-1662.23C10129.68,-1659.33 13432.56,-1639.82 13639,-1600.74 13781.27,-1573.81 13944,-1631.03 13944,-1486.24 13944,-1486.24 13944,-1486.24 13944,-1395.24 13944,-1347.55 13953.54,-1294.45 13962.66,-1254.6"/>
<polygon fill="black" stroke="black" points="13966.09,-1255.29 13964.97,-1244.76 13959.28,-1253.7 13966.09,-1255.29"/>
</g>
<!-- residual1_{layer}&#45;&gt;ln2_16 -->
<g id="edge266" class="edge">
<title>residual1_{layer}&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M9597.25,-1662.11C10097.94,-1658.6 13057.93,-1636.57 13958,-1600.74 14057.9,-1596.76 14172.07,-1588.85 14250.56,-1582.89"/>
<polygon fill="black" stroke="black" points="14251.21,-1586.35 14260.91,-1582.1 14250.68,-1579.37 14251.21,-1586.35"/>
</g>
<!-- residual1_{layer}&#45;&gt;residual2_16 -->
<g id="edge270" class="edge">
<title>residual1_{layer}&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M9597.18,-1662.5C10186.54,-1661.46 14192.41,-1652.52 14440,-1600.74 14567.98,-1573.97 14711,-1616.99 14711,-1486.24 14711,-1486.24 14711,-1486.24 14711,-1395.24 14711,-1348.18 14711.27,-1294.98 14711.53,-1254.91"/>
<polygon fill="black" stroke="black" points="14715.04,-1254.79 14711.6,-1244.76 14708.04,-1254.74 14715.04,-1254.79"/>
</g>
</g>
</svg>
