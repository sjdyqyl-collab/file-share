<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="129pt" height="1440pt"
 viewBox="0.00 0.00 128.93 1440.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.06 0.06) rotate(0) translate(4 22166.91)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-22166.91 1981,-22166.91 1981,4 -4,4"/>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="664" cy="-22125.43" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="664" y="-22136.73" font-family="Times,serif" font-size="14.00">Total Input</text>
<text text-anchor="middle" x="664" y="-22121.73" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="664" y="-22106.73" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- layer_0_ln1 -->
<g id="node2" class="node">
<title>layer_0_ln1</title>
<polygon fill="lightcoral" stroke="black" points="564,-22040.98 358,-22040.98 358,-21987.98 564,-21987.98 564,-22040.98"/>
<text text-anchor="middle" x="461" y="-22025.78" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="461" y="-22010.78" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="461" y="-21995.78" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_ln1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;layer_0_ln1</title>
<path fill="none" stroke="black" d="M602.54,-22091.44C575.61,-22076.99 544.2,-22060.13 517.82,-22045.97"/>
<polygon fill="black" stroke="black" points="519.18,-22042.73 508.71,-22041.08 515.87,-22048.9 519.18,-22042.73"/>
</g>
<!-- layer_0_add1 -->
<g id="node14" class="node">
<title>layer_0_add1</title>
<polygon fill="lightgreen" stroke="black" points="743,-21318 537,-21318 537,-21265 743,-21265 743,-21318"/>
<text text-anchor="middle" x="640" y="-21302.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="640" y="-21287.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="640" y="-21272.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- input&#45;&gt;layer_0_add1 -->
<g id="edge15" class="edge">
<title>input&#45;&gt;layer_0_add1</title>
<path fill="none" stroke="black" d="M676.49,-22087.93C689.5,-22046.61 708,-21977.03 708,-21915.5 708,-21915.5 708,-21915.5 708,-21468.5 708,-21416.76 707.95,-21401.3 687,-21354 682.71,-21344.32 676.61,-21334.77 670.21,-21326.19"/>
<polygon fill="black" stroke="black" points="672.96,-21324.01 664.05,-21318.28 667.44,-21328.32 672.96,-21324.01"/>
</g>
<!-- layer_0_q_proj -->
<g id="node3" class="node">
<title>layer_0_q_proj</title>
<polygon fill="lightblue" stroke="black" points="224,-21941 18,-21941 18,-21888 224,-21888 224,-21941"/>
<text text-anchor="middle" x="121" y="-21925.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="121" y="-21910.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="121" y="-21895.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_q_proj -->
<g id="edge2" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_q_proj</title>
<path fill="none" stroke="black" d="M372.11,-21987.86C325.27,-21974.36 267.69,-21957.77 219.48,-21943.88"/>
<polygon fill="black" stroke="black" points="220.24,-21940.46 209.66,-21941.05 218.3,-21947.18 220.24,-21940.46"/>
</g>
<!-- layer_0_k_proj -->
<g id="node4" class="node">
<title>layer_0_k_proj</title>
<polygon fill="lightblue" stroke="black" points="452,-21941 246,-21941 246,-21888 452,-21888 452,-21941"/>
<text text-anchor="middle" x="349" y="-21925.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="349" y="-21910.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="349" y="-21895.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_k_proj -->
<g id="edge3" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_k_proj</title>
<path fill="none" stroke="black" d="M431.57,-21987.73C417.55,-21975.47 400.64,-21960.68 385.79,-21947.68"/>
<polygon fill="black" stroke="black" points="388.06,-21945.02 378.23,-21941.07 383.45,-21950.29 388.06,-21945.02"/>
</g>
<!-- layer_0_v_proj -->
<g id="node5" class="node">
<title>layer_0_v_proj</title>
<polygon fill="lightblue" stroke="black" points="676,-21941 470,-21941 470,-21888 676,-21888 676,-21941"/>
<text text-anchor="middle" x="573" y="-21925.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="573" y="-21910.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="573" y="-21895.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln1&#45;&gt;layer_0_v_proj -->
<g id="edge4" class="edge">
<title>layer_0_ln1&#45;&gt;layer_0_v_proj</title>
<path fill="none" stroke="black" d="M490.43,-21987.73C504.45,-21975.47 521.36,-21960.68 536.21,-21947.68"/>
<polygon fill="black" stroke="black" points="538.55,-21950.29 543.77,-21941.07 533.94,-21945.02 538.55,-21950.29"/>
</g>
<!-- layer_0_q_reshape -->
<g id="node6" class="node">
<title>layer_0_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="224,-21852 0,-21852 0,-21799 224,-21799 224,-21852"/>
<text text-anchor="middle" x="112" y="-21836.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="112" y="-21821.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="112" y="-21806.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_q_proj&#45;&gt;layer_0_q_reshape -->
<g id="edge5" class="edge">
<title>layer_0_q_proj&#45;&gt;layer_0_q_reshape</title>
<path fill="none" stroke="black" d="M118.35,-21887.87C117.52,-21879.89 116.6,-21870.93 115.71,-21862.38"/>
<polygon fill="black" stroke="black" points="119.17,-21861.84 114.66,-21852.25 112.21,-21862.56 119.17,-21861.84"/>
</g>
<!-- layer_0_k_reshape -->
<g id="node7" class="node">
<title>layer_0_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="466,-21852 242,-21852 242,-21799 466,-21799 466,-21852"/>
<text text-anchor="middle" x="354" y="-21836.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="354" y="-21821.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="354" y="-21806.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_k_proj&#45;&gt;layer_0_k_reshape -->
<g id="edge6" class="edge">
<title>layer_0_k_proj&#45;&gt;layer_0_k_reshape</title>
<path fill="none" stroke="black" d="M350.47,-21887.87C350.93,-21879.89 351.45,-21870.93 351.94,-21862.38"/>
<polygon fill="black" stroke="black" points="355.44,-21862.43 352.52,-21852.25 348.45,-21862.03 355.44,-21862.43"/>
</g>
<!-- layer_0_v_reshape -->
<g id="node8" class="node">
<title>layer_0_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="680,-21763 456,-21763 456,-21710 680,-21710 680,-21763"/>
<text text-anchor="middle" x="568" y="-21747.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="568" y="-21732.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="568" y="-21717.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_v_proj&#45;&gt;layer_0_v_reshape -->
<g id="edge7" class="edge">
<title>layer_0_v_proj&#45;&gt;layer_0_v_reshape</title>
<path fill="none" stroke="black" d="M572.27,-21887.91C571.41,-21857.67 569.98,-21807.17 569.01,-21773.12"/>
<polygon fill="black" stroke="black" points="572.51,-21773.02 568.73,-21763.12 565.51,-21773.22 572.51,-21773.02"/>
</g>
<!-- layer_0_attn_scores -->
<g id="node9" class="node">
<title>layer_0_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="437.5,-21763 204.5,-21763 204.5,-21710 437.5,-21710 437.5,-21763"/>
<text text-anchor="middle" x="321" y="-21747.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="321" y="-21732.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="321" y="-21717.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_q_reshape&#45;&gt;layer_0_attn_scores -->
<g id="edge8" class="edge">
<title>layer_0_q_reshape&#45;&gt;layer_0_attn_scores</title>
<path fill="none" stroke="black" d="M173.29,-21798.98C197.43,-21788.94 225.3,-21777.34 250.29,-21766.94"/>
<polygon fill="black" stroke="black" points="251.82,-21770.09 259.71,-21763.01 249.13,-21763.63 251.82,-21770.09"/>
</g>
<!-- layer_0_k_reshape&#45;&gt;layer_0_attn_scores -->
<g id="edge9" class="edge">
<title>layer_0_k_reshape&#45;&gt;layer_0_attn_scores</title>
<path fill="none" stroke="black" d="M344.28,-21798.87C341.18,-21790.71 337.7,-21781.54 334.4,-21772.82"/>
<polygon fill="black" stroke="black" points="337.59,-21771.36 330.77,-21763.25 331.04,-21773.84 337.59,-21771.36"/>
</g>
<!-- layer_0_attn_output -->
<g id="node11" class="node">
<title>layer_0_attn_output</title>
<polygon fill="lightblue" stroke="black" points="680,-21585 456,-21585 456,-21532 680,-21532 680,-21585"/>
<text text-anchor="middle" x="568" y="-21569.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="568" y="-21554.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="568" y="-21539.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_v_reshape&#45;&gt;layer_0_attn_output -->
<g id="edge12" class="edge">
<title>layer_0_v_reshape&#45;&gt;layer_0_attn_output</title>
<path fill="none" stroke="black" d="M568,-21709.91C568,-21679.8 568,-21629.61 568,-21595.56"/>
<polygon fill="black" stroke="black" points="571.5,-21595.12 568,-21585.12 564.5,-21595.12 571.5,-21595.12"/>
</g>
<!-- layer_0_attn_weights -->
<g id="node10" class="node">
<title>layer_0_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="488.5,-21674 255.5,-21674 255.5,-21621 488.5,-21621 488.5,-21674"/>
<text text-anchor="middle" x="372" y="-21658.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="372" y="-21643.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="372" y="-21628.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_scores&#45;&gt;layer_0_attn_weights -->
<g id="edge10" class="edge">
<title>layer_0_attn_scores&#45;&gt;layer_0_attn_weights</title>
<path fill="none" stroke="black" d="M336.03,-21709.87C340.96,-21701.45 346.53,-21691.95 351.79,-21682.98"/>
<polygon fill="black" stroke="black" points="354.87,-21684.65 356.91,-21674.25 348.83,-21681.11 354.87,-21684.65"/>
</g>
<!-- layer_0_attn_weights&#45;&gt;layer_0_attn_output -->
<g id="edge11" class="edge">
<title>layer_0_attn_weights&#45;&gt;layer_0_attn_output</title>
<path fill="none" stroke="black" d="M429.48,-21620.98C452.02,-21610.98 478.03,-21599.44 501.38,-21589.07"/>
<polygon fill="black" stroke="black" points="502.8,-21592.27 510.52,-21585.01 499.96,-21585.87 502.8,-21592.27"/>
</g>
<!-- layer_0_attn_reshape -->
<g id="node12" class="node">
<title>layer_0_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="674,-21496 468,-21496 468,-21443 674,-21443 674,-21496"/>
<text text-anchor="middle" x="571" y="-21480.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="571" y="-21465.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="571" y="-21450.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_output&#45;&gt;layer_0_attn_reshape -->
<g id="edge13" class="edge">
<title>layer_0_attn_output&#45;&gt;layer_0_attn_reshape</title>
<path fill="none" stroke="black" d="M568.88,-21531.87C569.16,-21523.89 569.47,-21514.93 569.76,-21506.38"/>
<polygon fill="black" stroke="black" points="573.27,-21506.36 570.11,-21496.25 566.27,-21506.12 573.27,-21506.36"/>
</g>
<!-- layer_0_attn_proj -->
<g id="node13" class="node">
<title>layer_0_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="678,-21407 472,-21407 472,-21354 678,-21354 678,-21407"/>
<text text-anchor="middle" x="575" y="-21391.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="575" y="-21376.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="575" y="-21361.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_attn_reshape&#45;&gt;layer_0_attn_proj -->
<g id="edge14" class="edge">
<title>layer_0_attn_reshape&#45;&gt;layer_0_attn_proj</title>
<path fill="none" stroke="black" d="M572.18,-21442.87C572.55,-21434.89 572.96,-21425.93 573.35,-21417.38"/>
<polygon fill="black" stroke="black" points="576.85,-21417.4 573.82,-21407.25 569.86,-21417.08 576.85,-21417.4"/>
</g>
<!-- layer_0_attn_proj&#45;&gt;layer_0_add1 -->
<g id="edge16" class="edge">
<title>layer_0_attn_proj&#45;&gt;layer_0_add1</title>
<path fill="none" stroke="black" d="M594.15,-21353.87C600.57,-21345.27 607.84,-21335.55 614.66,-21326.42"/>
<polygon fill="black" stroke="black" points="617.58,-21328.36 620.76,-21318.25 611.97,-21324.17 617.58,-21328.36"/>
</g>
<!-- layer_0_ln2 -->
<g id="node15" class="node">
<title>layer_0_ln2</title>
<polygon fill="lightcoral" stroke="black" points="678,-21229 472,-21229 472,-21176 678,-21176 678,-21229"/>
<text text-anchor="middle" x="575" y="-21213.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="575" y="-21198.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="575" y="-21183.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_add1&#45;&gt;layer_0_ln2 -->
<g id="edge17" class="edge">
<title>layer_0_add1&#45;&gt;layer_0_ln2</title>
<path fill="none" stroke="black" d="M620.85,-21264.87C614.43,-21256.27 607.16,-21246.55 600.34,-21237.42"/>
<polygon fill="black" stroke="black" points="603.03,-21235.17 594.24,-21229.25 597.42,-21239.36 603.03,-21235.17"/>
</g>
<!-- layer_0_add -->
<g id="node19" class="node">
<title>layer_0_add</title>
<polygon fill="lightgreen" stroke="black" points="744,-20873 538,-20873 538,-20820 744,-20820 744,-20873"/>
<text text-anchor="middle" x="641" y="-20857.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="641" y="-20842.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="641" y="-20827.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_add1&#45;&gt;layer_0_add -->
<g id="edge21" class="edge">
<title>layer_0_add1&#45;&gt;layer_0_add</title>
<path fill="none" stroke="black" d="M664.05,-21264.72C672.52,-21254.32 681.34,-21241.78 687,-21229 707.95,-21181.7 708,-21166.24 708,-21114.5 708,-21114.5 708,-21114.5 708,-21023.5 708,-20971.68 706.69,-20956.51 686,-20909 681.84,-20899.45 675.98,-20889.95 669.86,-20881.38"/>
<polygon fill="black" stroke="black" points="672.5,-20879.07 663.71,-20873.16 666.89,-20883.26 672.5,-20879.07"/>
</g>
<!-- layer_0_ffn1 -->
<g id="node16" class="node">
<title>layer_0_ffn1</title>
<polygon fill="lightblue" stroke="black" points="679.5,-21140 464.5,-21140 464.5,-21087 679.5,-21087 679.5,-21140"/>
<text text-anchor="middle" x="572" y="-21124.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="572" y="-21109.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="572" y="-21094.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ln2&#45;&gt;layer_0_ffn1 -->
<g id="edge18" class="edge">
<title>layer_0_ln2&#45;&gt;layer_0_ffn1</title>
<path fill="none" stroke="black" d="M574.12,-21175.87C573.84,-21167.89 573.53,-21158.93 573.24,-21150.38"/>
<polygon fill="black" stroke="black" points="576.73,-21150.12 572.89,-21140.25 569.73,-21150.36 576.73,-21150.12"/>
</g>
<!-- layer_0_gelu -->
<g id="node17" class="node">
<title>layer_0_gelu</title>
<polygon fill="lightblue" stroke="black" points="679.5,-21051 464.5,-21051 464.5,-20998 679.5,-20998 679.5,-21051"/>
<text text-anchor="middle" x="572" y="-21035.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="572" y="-21020.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="572" y="-21005.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_ffn1&#45;&gt;layer_0_gelu -->
<g id="edge19" class="edge">
<title>layer_0_ffn1&#45;&gt;layer_0_gelu</title>
<path fill="none" stroke="black" d="M572,-21086.87C572,-21078.89 572,-21069.93 572,-21061.38"/>
<polygon fill="black" stroke="black" points="575.5,-21061.25 572,-21051.25 568.5,-21061.25 575.5,-21061.25"/>
</g>
<!-- layer_0_ffn2 -->
<g id="node18" class="node">
<title>layer_0_ffn2</title>
<polygon fill="lightblue" stroke="black" points="677,-20962 471,-20962 471,-20909 677,-20909 677,-20962"/>
<text text-anchor="middle" x="574" y="-20946.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="574" y="-20931.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="574" y="-20916.8" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<!-- layer_0_gelu&#45;&gt;layer_0_ffn2 -->
<g id="edge20" class="edge">
<title>layer_0_gelu&#45;&gt;layer_0_ffn2</title>
<path fill="none" stroke="black" d="M572.59,-20997.87C572.77,-20989.89 572.98,-20980.93 573.18,-20972.38"/>
<polygon fill="black" stroke="black" points="576.68,-20972.33 573.41,-20962.25 569.68,-20972.17 576.68,-20972.33"/>
</g>
<!-- layer_0_ffn2&#45;&gt;layer_0_add -->
<g id="edge22" class="edge">
<title>layer_0_ffn2&#45;&gt;layer_0_add</title>
<path fill="none" stroke="black" d="M593.74,-20908.87C600.36,-20900.27 607.85,-20890.55 614.88,-20881.42"/>
<polygon fill="black" stroke="black" points="617.84,-20883.31 621.17,-20873.25 612.3,-20879.04 617.84,-20883.31"/>
</g>
<!-- comm_0_1 -->
<g id="node20" class="node">
<title>comm_0_1</title>
<polygon fill="yellow" stroke="black" points="854.64,-20784 514.79,-20784 427.36,-20678 767.21,-20678 854.64,-20784"/>
<text text-anchor="middle" x="641" y="-20742.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="641" y="-20727.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="641" y="-20712.3" font-family="Times,serif" font-size="14.00">GPU 0 → GPU 1</text>
</g>
<!-- layer_0_add&#45;&gt;comm_0_1 -->
<g id="edge23" class="edge">
<title>layer_0_add&#45;&gt;comm_0_1</title>
<path fill="none" stroke="black" d="M641,-20819.75C641,-20812.05 641,-20803.25 641,-20794.27"/>
<polygon fill="black" stroke="black" points="644.5,-20794.1 641,-20784.1 637.5,-20794.1 644.5,-20794.1"/>
</g>
<!-- layer_1_ln1 -->
<g id="node21" class="node">
<title>layer_1_ln1</title>
<polygon fill="lightcoral" stroke="black" points="679,-20642 473,-20642 473,-20589 679,-20589 679,-20642"/>
<text text-anchor="middle" x="576" y="-20626.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="576" y="-20611.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="576" y="-20596.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- comm_0_1&#45;&gt;layer_1_ln1 -->
<g id="edge24" class="edge">
<title>comm_0_1&#45;&gt;layer_1_ln1</title>
<path fill="none" stroke="black" d="M611.16,-20677.9C605.92,-20668.74 600.58,-20659.42 595.7,-20650.9"/>
<polygon fill="black" stroke="black" points="598.62,-20648.95 590.61,-20642.01 592.54,-20652.43 598.62,-20648.95"/>
</g>
<!-- layer_1_add1 -->
<g id="node33" class="node">
<title>layer_1_add1</title>
<polygon fill="lightgreen" stroke="black" points="857,-19930 651,-19930 651,-19877 857,-19877 857,-19930"/>
<text text-anchor="middle" x="754" y="-19914.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="754" y="-19899.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="754" y="-19884.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- comm_0_1&#45;&gt;layer_1_add1 -->
<g id="edge38" class="edge">
<title>comm_0_1&#45;&gt;layer_1_add1</title>
<path fill="none" stroke="black" d="M725.99,-20677.8C772.6,-20642.08 821,-20589.94 821,-20527.5 821,-20527.5 821,-20527.5 821,-20080.5 821,-20028.68 819.69,-20013.51 799,-19966 794.84,-19956.45 788.98,-19946.95 782.86,-19938.38"/>
<polygon fill="black" stroke="black" points="785.5,-19936.07 776.71,-19930.16 779.89,-19940.26 785.5,-19936.07"/>
</g>
<!-- layer_1_q_proj -->
<g id="node22" class="node">
<title>layer_1_q_proj</title>
<polygon fill="lightblue" stroke="black" points="339,-20553 133,-20553 133,-20500 339,-20500 339,-20553"/>
<text text-anchor="middle" x="236" y="-20537.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="236" y="-20522.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="236" y="-20507.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_q_proj -->
<g id="edge25" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_q_proj</title>
<path fill="none" stroke="black" d="M476.29,-20588.98C435.2,-20578.47 387.47,-20566.26 345.43,-20555.5"/>
<polygon fill="black" stroke="black" points="346.27,-20552.1 335.71,-20553.01 344.53,-20558.88 346.27,-20552.1"/>
</g>
<!-- layer_1_k_proj -->
<g id="node23" class="node">
<title>layer_1_k_proj</title>
<polygon fill="lightblue" stroke="black" points="567,-20553 361,-20553 361,-20500 567,-20500 567,-20553"/>
<text text-anchor="middle" x="464" y="-20537.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="464" y="-20522.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="464" y="-20507.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_k_proj -->
<g id="edge26" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_k_proj</title>
<path fill="none" stroke="black" d="M543,-20588.87C531.15,-20579.66 517.62,-20569.15 505.16,-20559.47"/>
<polygon fill="black" stroke="black" points="507.19,-20556.62 497.15,-20553.25 502.9,-20562.15 507.19,-20556.62"/>
</g>
<!-- layer_1_v_proj -->
<g id="node24" class="node">
<title>layer_1_v_proj</title>
<polygon fill="lightblue" stroke="black" points="791,-20553 585,-20553 585,-20500 791,-20500 791,-20553"/>
<text text-anchor="middle" x="688" y="-20537.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="688" y="-20522.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="688" y="-20507.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln1&#45;&gt;layer_1_v_proj -->
<g id="edge27" class="edge">
<title>layer_1_ln1&#45;&gt;layer_1_v_proj</title>
<path fill="none" stroke="black" d="M609,-20588.87C620.85,-20579.66 634.38,-20569.15 646.84,-20559.47"/>
<polygon fill="black" stroke="black" points="649.1,-20562.15 654.85,-20553.25 644.81,-20556.62 649.1,-20562.15"/>
</g>
<!-- layer_1_q_reshape -->
<g id="node25" class="node">
<title>layer_1_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="339,-20464 115,-20464 115,-20411 339,-20411 339,-20464"/>
<text text-anchor="middle" x="227" y="-20448.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="227" y="-20433.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="227" y="-20418.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_q_proj&#45;&gt;layer_1_q_reshape -->
<g id="edge28" class="edge">
<title>layer_1_q_proj&#45;&gt;layer_1_q_reshape</title>
<path fill="none" stroke="black" d="M233.35,-20499.87C232.52,-20491.89 231.6,-20482.93 230.71,-20474.38"/>
<polygon fill="black" stroke="black" points="234.17,-20473.84 229.66,-20464.25 227.21,-20474.56 234.17,-20473.84"/>
</g>
<!-- layer_1_k_reshape -->
<g id="node26" class="node">
<title>layer_1_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="581,-20464 357,-20464 357,-20411 581,-20411 581,-20464"/>
<text text-anchor="middle" x="469" y="-20448.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="469" y="-20433.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="469" y="-20418.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_k_proj&#45;&gt;layer_1_k_reshape -->
<g id="edge29" class="edge">
<title>layer_1_k_proj&#45;&gt;layer_1_k_reshape</title>
<path fill="none" stroke="black" d="M465.47,-20499.87C465.93,-20491.89 466.45,-20482.93 466.94,-20474.38"/>
<polygon fill="black" stroke="black" points="470.44,-20474.43 467.52,-20464.25 463.45,-20474.03 470.44,-20474.43"/>
</g>
<!-- layer_1_v_reshape -->
<g id="node27" class="node">
<title>layer_1_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="793,-20375 569,-20375 569,-20322 793,-20322 793,-20375"/>
<text text-anchor="middle" x="681" y="-20359.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="681" y="-20344.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="681" y="-20329.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_v_proj&#45;&gt;layer_1_v_reshape -->
<g id="edge30" class="edge">
<title>layer_1_v_proj&#45;&gt;layer_1_v_reshape</title>
<path fill="none" stroke="black" d="M686.98,-20499.91C685.78,-20469.67 683.77,-20419.17 682.42,-20385.12"/>
<polygon fill="black" stroke="black" points="685.91,-20384.98 682.02,-20375.12 678.92,-20385.25 685.91,-20384.98"/>
</g>
<!-- layer_1_attn_scores -->
<g id="node28" class="node">
<title>layer_1_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="550.5,-20375 317.5,-20375 317.5,-20322 550.5,-20322 550.5,-20375"/>
<text text-anchor="middle" x="434" y="-20359.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="434" y="-20344.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="434" y="-20329.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_q_reshape&#45;&gt;layer_1_attn_scores -->
<g id="edge31" class="edge">
<title>layer_1_q_reshape&#45;&gt;layer_1_attn_scores</title>
<path fill="none" stroke="black" d="M287.71,-20410.98C311.61,-20400.94 339.22,-20389.34 363.96,-20378.94"/>
<polygon fill="black" stroke="black" points="365.43,-20382.12 373.29,-20375.01 362.72,-20375.66 365.43,-20382.12"/>
</g>
<!-- layer_1_k_reshape&#45;&gt;layer_1_attn_scores -->
<g id="edge32" class="edge">
<title>layer_1_k_reshape&#45;&gt;layer_1_attn_scores</title>
<path fill="none" stroke="black" d="M458.69,-20410.87C455.37,-20402.62 451.64,-20393.34 448.1,-20384.54"/>
<polygon fill="black" stroke="black" points="451.34,-20383.22 444.36,-20375.25 444.84,-20385.83 451.34,-20383.22"/>
</g>
<!-- layer_1_attn_output -->
<g id="node30" class="node">
<title>layer_1_attn_output</title>
<polygon fill="lightblue" stroke="black" points="793,-20197 569,-20197 569,-20144 793,-20144 793,-20197"/>
<text text-anchor="middle" x="681" y="-20181.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="681" y="-20166.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="681" y="-20151.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_v_reshape&#45;&gt;layer_1_attn_output -->
<g id="edge35" class="edge">
<title>layer_1_v_reshape&#45;&gt;layer_1_attn_output</title>
<path fill="none" stroke="black" d="M681,-20321.91C681,-20291.8 681,-20241.61 681,-20207.56"/>
<polygon fill="black" stroke="black" points="684.5,-20207.12 681,-20197.12 677.5,-20207.12 684.5,-20207.12"/>
</g>
<!-- layer_1_attn_weights -->
<g id="node29" class="node">
<title>layer_1_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="601.5,-20286 368.5,-20286 368.5,-20233 601.5,-20233 601.5,-20286"/>
<text text-anchor="middle" x="485" y="-20270.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="485" y="-20255.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="485" y="-20240.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_scores&#45;&gt;layer_1_attn_weights -->
<g id="edge33" class="edge">
<title>layer_1_attn_scores&#45;&gt;layer_1_attn_weights</title>
<path fill="none" stroke="black" d="M449.03,-20321.87C453.96,-20313.45 459.53,-20303.95 464.79,-20294.98"/>
<polygon fill="black" stroke="black" points="467.87,-20296.65 469.91,-20286.25 461.83,-20293.11 467.87,-20296.65"/>
</g>
<!-- layer_1_attn_weights&#45;&gt;layer_1_attn_output -->
<g id="edge34" class="edge">
<title>layer_1_attn_weights&#45;&gt;layer_1_attn_output</title>
<path fill="none" stroke="black" d="M542.48,-20232.98C565.02,-20222.98 591.03,-20211.44 614.38,-20201.07"/>
<polygon fill="black" stroke="black" points="615.8,-20204.27 623.52,-20197.01 612.96,-20197.87 615.8,-20204.27"/>
</g>
<!-- layer_1_attn_reshape -->
<g id="node31" class="node">
<title>layer_1_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="788,-20108 582,-20108 582,-20055 788,-20055 788,-20108"/>
<text text-anchor="middle" x="685" y="-20092.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="685" y="-20077.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="685" y="-20062.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_output&#45;&gt;layer_1_attn_reshape -->
<g id="edge36" class="edge">
<title>layer_1_attn_output&#45;&gt;layer_1_attn_reshape</title>
<path fill="none" stroke="black" d="M682.18,-20143.87C682.55,-20135.89 682.96,-20126.93 683.35,-20118.38"/>
<polygon fill="black" stroke="black" points="686.85,-20118.4 683.82,-20108.25 679.86,-20118.08 686.85,-20118.4"/>
</g>
<!-- layer_1_attn_proj -->
<g id="node32" class="node">
<title>layer_1_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="790,-20019 584,-20019 584,-19966 790,-19966 790,-20019"/>
<text text-anchor="middle" x="687" y="-20003.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="687" y="-19988.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="687" y="-19973.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_attn_reshape&#45;&gt;layer_1_attn_proj -->
<g id="edge37" class="edge">
<title>layer_1_attn_reshape&#45;&gt;layer_1_attn_proj</title>
<path fill="none" stroke="black" d="M685.59,-20054.87C685.77,-20046.89 685.98,-20037.93 686.18,-20029.38"/>
<polygon fill="black" stroke="black" points="689.68,-20029.33 686.41,-20019.25 682.68,-20029.17 689.68,-20029.33"/>
</g>
<!-- layer_1_attn_proj&#45;&gt;layer_1_add1 -->
<g id="edge39" class="edge">
<title>layer_1_attn_proj&#45;&gt;layer_1_add1</title>
<path fill="none" stroke="black" d="M706.74,-19965.87C713.36,-19957.27 720.85,-19947.55 727.88,-19938.42"/>
<polygon fill="black" stroke="black" points="730.84,-19940.31 734.17,-19930.25 725.3,-19936.04 730.84,-19940.31"/>
</g>
<!-- layer_1_ln2 -->
<g id="node34" class="node">
<title>layer_1_ln2</title>
<polygon fill="lightcoral" stroke="black" points="792,-19841 586,-19841 586,-19788 792,-19788 792,-19841"/>
<text text-anchor="middle" x="689" y="-19825.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="689" y="-19810.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="689" y="-19795.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_add1&#45;&gt;layer_1_ln2 -->
<g id="edge40" class="edge">
<title>layer_1_add1&#45;&gt;layer_1_ln2</title>
<path fill="none" stroke="black" d="M734.85,-19876.87C728.43,-19868.27 721.16,-19858.55 714.34,-19849.42"/>
<polygon fill="black" stroke="black" points="717.03,-19847.17 708.24,-19841.25 711.42,-19851.36 717.03,-19847.17"/>
</g>
<!-- layer_1_add -->
<g id="node38" class="node">
<title>layer_1_add</title>
<polygon fill="lightgreen" stroke="black" points="858,-19485 652,-19485 652,-19432 858,-19432 858,-19485"/>
<text text-anchor="middle" x="755" y="-19469.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="755" y="-19454.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="755" y="-19439.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_add1&#45;&gt;layer_1_add -->
<g id="edge44" class="edge">
<title>layer_1_add1&#45;&gt;layer_1_add</title>
<path fill="none" stroke="black" d="M778.05,-19876.72C786.52,-19866.32 795.34,-19853.78 801,-19841 821.95,-19793.7 822,-19778.24 822,-19726.5 822,-19726.5 822,-19726.5 822,-19635.5 822,-19583.68 820.69,-19568.51 800,-19521 795.84,-19511.45 789.98,-19501.95 783.86,-19493.38"/>
<polygon fill="black" stroke="black" points="786.5,-19491.07 777.71,-19485.16 780.89,-19495.26 786.5,-19491.07"/>
</g>
<!-- layer_1_ffn1 -->
<g id="node35" class="node">
<title>layer_1_ffn1</title>
<polygon fill="lightblue" stroke="black" points="793.5,-19752 578.5,-19752 578.5,-19699 793.5,-19699 793.5,-19752"/>
<text text-anchor="middle" x="686" y="-19736.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="686" y="-19721.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="686" y="-19706.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ln2&#45;&gt;layer_1_ffn1 -->
<g id="edge41" class="edge">
<title>layer_1_ln2&#45;&gt;layer_1_ffn1</title>
<path fill="none" stroke="black" d="M688.12,-19787.87C687.84,-19779.89 687.53,-19770.93 687.24,-19762.38"/>
<polygon fill="black" stroke="black" points="690.73,-19762.12 686.89,-19752.25 683.73,-19762.36 690.73,-19762.12"/>
</g>
<!-- layer_1_gelu -->
<g id="node36" class="node">
<title>layer_1_gelu</title>
<polygon fill="lightblue" stroke="black" points="793.5,-19663 578.5,-19663 578.5,-19610 793.5,-19610 793.5,-19663"/>
<text text-anchor="middle" x="686" y="-19647.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="686" y="-19632.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="686" y="-19617.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_ffn1&#45;&gt;layer_1_gelu -->
<g id="edge42" class="edge">
<title>layer_1_ffn1&#45;&gt;layer_1_gelu</title>
<path fill="none" stroke="black" d="M686,-19698.87C686,-19690.89 686,-19681.93 686,-19673.38"/>
<polygon fill="black" stroke="black" points="689.5,-19673.25 686,-19663.25 682.5,-19673.25 689.5,-19673.25"/>
</g>
<!-- layer_1_ffn2 -->
<g id="node37" class="node">
<title>layer_1_ffn2</title>
<polygon fill="lightblue" stroke="black" points="791,-19574 585,-19574 585,-19521 791,-19521 791,-19574"/>
<text text-anchor="middle" x="688" y="-19558.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="688" y="-19543.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="688" y="-19528.8" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<!-- layer_1_gelu&#45;&gt;layer_1_ffn2 -->
<g id="edge43" class="edge">
<title>layer_1_gelu&#45;&gt;layer_1_ffn2</title>
<path fill="none" stroke="black" d="M686.59,-19609.87C686.77,-19601.89 686.98,-19592.93 687.18,-19584.38"/>
<polygon fill="black" stroke="black" points="690.68,-19584.33 687.41,-19574.25 683.68,-19584.17 690.68,-19584.33"/>
</g>
<!-- layer_1_ffn2&#45;&gt;layer_1_add -->
<g id="edge45" class="edge">
<title>layer_1_ffn2&#45;&gt;layer_1_add</title>
<path fill="none" stroke="black" d="M707.74,-19520.87C714.36,-19512.27 721.85,-19502.55 728.88,-19493.42"/>
<polygon fill="black" stroke="black" points="731.84,-19495.31 735.17,-19485.25 726.3,-19491.04 731.84,-19495.31"/>
</g>
<!-- comm_1_2 -->
<g id="node39" class="node">
<title>comm_1_2</title>
<polygon fill="yellow" stroke="black" points="968.64,-19396 628.79,-19396 541.36,-19290 881.21,-19290 968.64,-19396"/>
<text text-anchor="middle" x="755" y="-19354.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="755" y="-19339.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="755" y="-19324.3" font-family="Times,serif" font-size="14.00">GPU 1 → GPU 2</text>
</g>
<!-- layer_1_add&#45;&gt;comm_1_2 -->
<g id="edge46" class="edge">
<title>layer_1_add&#45;&gt;comm_1_2</title>
<path fill="none" stroke="black" d="M755,-19431.75C755,-19424.05 755,-19415.25 755,-19406.27"/>
<polygon fill="black" stroke="black" points="758.5,-19406.1 755,-19396.1 751.5,-19406.1 758.5,-19406.1"/>
</g>
<!-- layer_2_ln1 -->
<g id="node40" class="node">
<title>layer_2_ln1</title>
<polygon fill="lightcoral" stroke="black" points="681,-19254 475,-19254 475,-19201 681,-19201 681,-19254"/>
<text text-anchor="middle" x="578" y="-19238.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="578" y="-19223.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="578" y="-19208.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- comm_1_2&#45;&gt;layer_2_ln1 -->
<g id="edge47" class="edge">
<title>comm_1_2&#45;&gt;layer_2_ln1</title>
<path fill="none" stroke="black" d="M673.75,-19289.9C657.5,-19279.48 640.91,-19268.84 626.21,-19259.41"/>
<polygon fill="black" stroke="black" points="628.1,-19256.47 617.79,-19254.01 624.32,-19262.36 628.1,-19256.47"/>
</g>
<!-- layer_2_add1 -->
<g id="node52" class="node">
<title>layer_2_add1</title>
<polygon fill="lightgreen" stroke="black" points="881,-18542 675,-18542 675,-18489 881,-18489 881,-18542"/>
<text text-anchor="middle" x="778" y="-18526.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="778" y="-18511.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="778" y="-18496.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- comm_1_2&#45;&gt;layer_2_add1 -->
<g id="edge61" class="edge">
<title>comm_1_2&#45;&gt;layer_2_add1</title>
<path fill="none" stroke="black" d="M792.65,-19289.8C817.31,-19250.46 845,-19194.13 845,-19139.5 845,-19139.5 845,-19139.5 845,-18692.5 845,-18640.68 843.69,-18625.51 823,-18578 818.84,-18568.45 812.98,-18558.95 806.86,-18550.38"/>
<polygon fill="black" stroke="black" points="809.5,-18548.07 800.71,-18542.16 803.89,-18552.26 809.5,-18548.07"/>
</g>
<!-- layer_2_q_proj -->
<g id="node41" class="node">
<title>layer_2_q_proj</title>
<polygon fill="lightblue" stroke="black" points="363,-19165 157,-19165 157,-19112 363,-19112 363,-19165"/>
<text text-anchor="middle" x="260" y="-19149.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="260" y="-19134.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="260" y="-19119.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_q_proj -->
<g id="edge48" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_q_proj</title>
<path fill="none" stroke="black" d="M484.74,-19200.98C446.56,-19190.54 402.23,-19178.41 363.09,-19167.7"/>
<polygon fill="black" stroke="black" points="363.83,-19164.28 353.26,-19165.01 361.98,-19171.03 363.83,-19164.28"/>
</g>
<!-- layer_2_k_proj -->
<g id="node42" class="node">
<title>layer_2_k_proj</title>
<polygon fill="lightblue" stroke="black" points="591,-19165 385,-19165 385,-19112 591,-19112 591,-19165"/>
<text text-anchor="middle" x="488" y="-19149.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="488" y="-19134.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="488" y="-19119.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_k_proj -->
<g id="edge49" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_k_proj</title>
<path fill="none" stroke="black" d="M551.48,-19200.87C542.23,-19191.92 531.71,-19181.75 521.93,-19172.3"/>
<polygon fill="black" stroke="black" points="524.26,-19169.68 514.64,-19165.25 519.39,-19174.72 524.26,-19169.68"/>
</g>
<!-- layer_2_v_proj -->
<g id="node43" class="node">
<title>layer_2_v_proj</title>
<polygon fill="lightblue" stroke="black" points="815,-19165 609,-19165 609,-19112 815,-19112 815,-19165"/>
<text text-anchor="middle" x="712" y="-19149.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="712" y="-19134.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="712" y="-19119.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln1&#45;&gt;layer_2_v_proj -->
<g id="edge50" class="edge">
<title>layer_2_ln1&#45;&gt;layer_2_v_proj</title>
<path fill="none" stroke="black" d="M617.48,-19200.87C631.94,-19191.48 648.46,-19180.75 663.61,-19170.92"/>
<polygon fill="black" stroke="black" points="665.86,-19173.63 672.34,-19165.25 662.05,-19167.76 665.86,-19173.63"/>
</g>
<!-- layer_2_q_reshape -->
<g id="node44" class="node">
<title>layer_2_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="363,-19076 139,-19076 139,-19023 363,-19023 363,-19076"/>
<text text-anchor="middle" x="251" y="-19060.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="251" y="-19045.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="251" y="-19030.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_q_proj&#45;&gt;layer_2_q_reshape -->
<g id="edge51" class="edge">
<title>layer_2_q_proj&#45;&gt;layer_2_q_reshape</title>
<path fill="none" stroke="black" d="M257.35,-19111.87C256.52,-19103.89 255.6,-19094.93 254.71,-19086.38"/>
<polygon fill="black" stroke="black" points="258.17,-19085.84 253.66,-19076.25 251.21,-19086.56 258.17,-19085.84"/>
</g>
<!-- layer_2_k_reshape -->
<g id="node45" class="node">
<title>layer_2_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="605,-19076 381,-19076 381,-19023 605,-19023 605,-19076"/>
<text text-anchor="middle" x="493" y="-19060.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="493" y="-19045.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="493" y="-19030.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_k_proj&#45;&gt;layer_2_k_reshape -->
<g id="edge52" class="edge">
<title>layer_2_k_proj&#45;&gt;layer_2_k_reshape</title>
<path fill="none" stroke="black" d="M489.47,-19111.87C489.93,-19103.89 490.45,-19094.93 490.94,-19086.38"/>
<polygon fill="black" stroke="black" points="494.44,-19086.43 491.52,-19076.25 487.45,-19086.03 494.44,-19086.43"/>
</g>
<!-- layer_2_v_reshape -->
<g id="node46" class="node">
<title>layer_2_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="817,-18987 593,-18987 593,-18934 817,-18934 817,-18987"/>
<text text-anchor="middle" x="705" y="-18971.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="705" y="-18956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="705" y="-18941.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_v_proj&#45;&gt;layer_2_v_reshape -->
<g id="edge53" class="edge">
<title>layer_2_v_proj&#45;&gt;layer_2_v_reshape</title>
<path fill="none" stroke="black" d="M710.98,-19111.91C709.78,-19081.67 707.77,-19031.17 706.42,-18997.12"/>
<polygon fill="black" stroke="black" points="709.91,-18996.98 706.02,-18987.12 702.92,-18997.25 709.91,-18996.98"/>
</g>
<!-- layer_2_attn_scores -->
<g id="node47" class="node">
<title>layer_2_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="574.5,-18987 341.5,-18987 341.5,-18934 574.5,-18934 574.5,-18987"/>
<text text-anchor="middle" x="458" y="-18971.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="458" y="-18956.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="458" y="-18941.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_q_reshape&#45;&gt;layer_2_attn_scores -->
<g id="edge54" class="edge">
<title>layer_2_q_reshape&#45;&gt;layer_2_attn_scores</title>
<path fill="none" stroke="black" d="M311.71,-19022.98C335.61,-19012.94 363.22,-19001.34 387.96,-18990.94"/>
<polygon fill="black" stroke="black" points="389.43,-18994.12 397.29,-18987.01 386.72,-18987.66 389.43,-18994.12"/>
</g>
<!-- layer_2_k_reshape&#45;&gt;layer_2_attn_scores -->
<g id="edge55" class="edge">
<title>layer_2_k_reshape&#45;&gt;layer_2_attn_scores</title>
<path fill="none" stroke="black" d="M482.69,-19022.87C479.37,-19014.62 475.64,-19005.34 472.1,-18996.54"/>
<polygon fill="black" stroke="black" points="475.34,-18995.22 468.36,-18987.25 468.84,-18997.83 475.34,-18995.22"/>
</g>
<!-- layer_2_attn_output -->
<g id="node49" class="node">
<title>layer_2_attn_output</title>
<polygon fill="lightblue" stroke="black" points="817,-18809 593,-18809 593,-18756 817,-18756 817,-18809"/>
<text text-anchor="middle" x="705" y="-18793.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="705" y="-18778.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="705" y="-18763.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_v_reshape&#45;&gt;layer_2_attn_output -->
<g id="edge58" class="edge">
<title>layer_2_v_reshape&#45;&gt;layer_2_attn_output</title>
<path fill="none" stroke="black" d="M705,-18933.91C705,-18903.8 705,-18853.61 705,-18819.56"/>
<polygon fill="black" stroke="black" points="708.5,-18819.12 705,-18809.12 701.5,-18819.12 708.5,-18819.12"/>
</g>
<!-- layer_2_attn_weights -->
<g id="node48" class="node">
<title>layer_2_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="625.5,-18898 392.5,-18898 392.5,-18845 625.5,-18845 625.5,-18898"/>
<text text-anchor="middle" x="509" y="-18882.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="509" y="-18867.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="509" y="-18852.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_scores&#45;&gt;layer_2_attn_weights -->
<g id="edge56" class="edge">
<title>layer_2_attn_scores&#45;&gt;layer_2_attn_weights</title>
<path fill="none" stroke="black" d="M473.03,-18933.87C477.96,-18925.45 483.53,-18915.95 488.79,-18906.98"/>
<polygon fill="black" stroke="black" points="491.87,-18908.65 493.91,-18898.25 485.83,-18905.11 491.87,-18908.65"/>
</g>
<!-- layer_2_attn_weights&#45;&gt;layer_2_attn_output -->
<g id="edge57" class="edge">
<title>layer_2_attn_weights&#45;&gt;layer_2_attn_output</title>
<path fill="none" stroke="black" d="M566.48,-18844.98C589.02,-18834.98 615.03,-18823.44 638.38,-18813.07"/>
<polygon fill="black" stroke="black" points="639.8,-18816.27 647.52,-18809.01 636.96,-18809.87 639.8,-18816.27"/>
</g>
<!-- layer_2_attn_reshape -->
<g id="node50" class="node">
<title>layer_2_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="812,-18720 606,-18720 606,-18667 812,-18667 812,-18720"/>
<text text-anchor="middle" x="709" y="-18704.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="709" y="-18689.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="709" y="-18674.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_output&#45;&gt;layer_2_attn_reshape -->
<g id="edge59" class="edge">
<title>layer_2_attn_output&#45;&gt;layer_2_attn_reshape</title>
<path fill="none" stroke="black" d="M706.18,-18755.87C706.55,-18747.89 706.96,-18738.93 707.35,-18730.38"/>
<polygon fill="black" stroke="black" points="710.85,-18730.4 707.82,-18720.25 703.86,-18730.08 710.85,-18730.4"/>
</g>
<!-- layer_2_attn_proj -->
<g id="node51" class="node">
<title>layer_2_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="814,-18631 608,-18631 608,-18578 814,-18578 814,-18631"/>
<text text-anchor="middle" x="711" y="-18615.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="711" y="-18600.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="711" y="-18585.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_attn_reshape&#45;&gt;layer_2_attn_proj -->
<g id="edge60" class="edge">
<title>layer_2_attn_reshape&#45;&gt;layer_2_attn_proj</title>
<path fill="none" stroke="black" d="M709.59,-18666.87C709.77,-18658.89 709.98,-18649.93 710.18,-18641.38"/>
<polygon fill="black" stroke="black" points="713.68,-18641.33 710.41,-18631.25 706.68,-18641.17 713.68,-18641.33"/>
</g>
<!-- layer_2_attn_proj&#45;&gt;layer_2_add1 -->
<g id="edge62" class="edge">
<title>layer_2_attn_proj&#45;&gt;layer_2_add1</title>
<path fill="none" stroke="black" d="M730.74,-18577.87C737.36,-18569.27 744.85,-18559.55 751.88,-18550.42"/>
<polygon fill="black" stroke="black" points="754.84,-18552.31 758.17,-18542.25 749.3,-18548.04 754.84,-18552.31"/>
</g>
<!-- layer_2_ln2 -->
<g id="node53" class="node">
<title>layer_2_ln2</title>
<polygon fill="lightcoral" stroke="black" points="813,-18453 607,-18453 607,-18400 813,-18400 813,-18453"/>
<text text-anchor="middle" x="710" y="-18437.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="710" y="-18422.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="710" y="-18407.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_add1&#45;&gt;layer_2_ln2 -->
<g id="edge63" class="edge">
<title>layer_2_add1&#45;&gt;layer_2_ln2</title>
<path fill="none" stroke="black" d="M757.97,-18488.87C751.18,-18480.18 743.49,-18470.35 736.29,-18461.14"/>
<polygon fill="black" stroke="black" points="739.04,-18458.97 730.13,-18453.25 733.53,-18463.28 739.04,-18458.97"/>
</g>
<!-- layer_2_add -->
<g id="node57" class="node">
<title>layer_2_add</title>
<polygon fill="lightgreen" stroke="black" points="879,-18097 673,-18097 673,-18044 879,-18044 879,-18097"/>
<text text-anchor="middle" x="776" y="-18081.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="776" y="-18066.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="776" y="-18051.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_add1&#45;&gt;layer_2_add -->
<g id="edge67" class="edge">
<title>layer_2_add1&#45;&gt;layer_2_add</title>
<path fill="none" stroke="black" d="M800.19,-18488.77C808.18,-18478.29 816.56,-18465.67 822,-18453 842.44,-18405.38 844,-18390.32 844,-18338.5 844,-18338.5 844,-18338.5 844,-18247.5 844,-18195.76 843.95,-18180.3 823,-18133 818.71,-18123.32 812.61,-18113.77 806.21,-18105.19"/>
<polygon fill="black" stroke="black" points="808.96,-18103.01 800.05,-18097.28 803.44,-18107.32 808.96,-18103.01"/>
</g>
<!-- layer_2_ffn1 -->
<g id="node54" class="node">
<title>layer_2_ffn1</title>
<polygon fill="lightblue" stroke="black" points="815.5,-18364 600.5,-18364 600.5,-18311 815.5,-18311 815.5,-18364"/>
<text text-anchor="middle" x="708" y="-18348.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="708" y="-18333.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="708" y="-18318.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ln2&#45;&gt;layer_2_ffn1 -->
<g id="edge64" class="edge">
<title>layer_2_ln2&#45;&gt;layer_2_ffn1</title>
<path fill="none" stroke="black" d="M709.41,-18399.87C709.23,-18391.89 709.02,-18382.93 708.82,-18374.38"/>
<polygon fill="black" stroke="black" points="712.32,-18374.17 708.59,-18364.25 705.32,-18374.33 712.32,-18374.17"/>
</g>
<!-- layer_2_gelu -->
<g id="node55" class="node">
<title>layer_2_gelu</title>
<polygon fill="lightblue" stroke="black" points="815.5,-18275 600.5,-18275 600.5,-18222 815.5,-18222 815.5,-18275"/>
<text text-anchor="middle" x="708" y="-18259.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="708" y="-18244.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="708" y="-18229.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_ffn1&#45;&gt;layer_2_gelu -->
<g id="edge65" class="edge">
<title>layer_2_ffn1&#45;&gt;layer_2_gelu</title>
<path fill="none" stroke="black" d="M708,-18310.87C708,-18302.89 708,-18293.93 708,-18285.38"/>
<polygon fill="black" stroke="black" points="711.5,-18285.25 708,-18275.25 704.5,-18285.25 711.5,-18285.25"/>
</g>
<!-- layer_2_ffn2 -->
<g id="node56" class="node">
<title>layer_2_ffn2</title>
<polygon fill="lightblue" stroke="black" points="814,-18186 608,-18186 608,-18133 814,-18133 814,-18186"/>
<text text-anchor="middle" x="711" y="-18170.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="711" y="-18155.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="711" y="-18140.8" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<!-- layer_2_gelu&#45;&gt;layer_2_ffn2 -->
<g id="edge66" class="edge">
<title>layer_2_gelu&#45;&gt;layer_2_ffn2</title>
<path fill="none" stroke="black" d="M708.88,-18221.87C709.16,-18213.89 709.47,-18204.93 709.76,-18196.38"/>
<polygon fill="black" stroke="black" points="713.27,-18196.36 710.11,-18186.25 706.27,-18196.12 713.27,-18196.36"/>
</g>
<!-- layer_2_ffn2&#45;&gt;layer_2_add -->
<g id="edge68" class="edge">
<title>layer_2_ffn2&#45;&gt;layer_2_add</title>
<path fill="none" stroke="black" d="M730.15,-18132.87C736.57,-18124.27 743.84,-18114.55 750.66,-18105.42"/>
<polygon fill="black" stroke="black" points="753.58,-18107.36 756.76,-18097.25 747.97,-18103.17 753.58,-18107.36"/>
</g>
<!-- comm_2_3 -->
<g id="node58" class="node">
<title>comm_2_3</title>
<polygon fill="yellow" stroke="black" points="989.64,-18008 649.79,-18008 562.36,-17902 902.21,-17902 989.64,-18008"/>
<text text-anchor="middle" x="776" y="-17966.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="776" y="-17951.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="776" y="-17936.3" font-family="Times,serif" font-size="14.00">GPU 2 → GPU 3</text>
</g>
<!-- layer_2_add&#45;&gt;comm_2_3 -->
<g id="edge69" class="edge">
<title>layer_2_add&#45;&gt;comm_2_3</title>
<path fill="none" stroke="black" d="M776,-18043.75C776,-18036.05 776,-18027.25 776,-18018.27"/>
<polygon fill="black" stroke="black" points="779.5,-18018.1 776,-18008.1 772.5,-18018.1 779.5,-18018.1"/>
</g>
<!-- layer_3_ln1 -->
<g id="node59" class="node">
<title>layer_3_ln1</title>
<polygon fill="lightcoral" stroke="black" points="702,-17866 496,-17866 496,-17813 702,-17813 702,-17866"/>
<text text-anchor="middle" x="599" y="-17850.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="599" y="-17835.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="599" y="-17820.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- comm_2_3&#45;&gt;layer_3_ln1 -->
<g id="edge70" class="edge">
<title>comm_2_3&#45;&gt;layer_3_ln1</title>
<path fill="none" stroke="black" d="M694.75,-17901.9C678.5,-17891.48 661.91,-17880.84 647.21,-17871.41"/>
<polygon fill="black" stroke="black" points="649.1,-17868.47 638.79,-17866.01 645.32,-17874.36 649.1,-17868.47"/>
</g>
<!-- layer_3_add1 -->
<g id="node71" class="node">
<title>layer_3_add1</title>
<polygon fill="lightgreen" stroke="black" points="902,-17154 696,-17154 696,-17101 902,-17101 902,-17154"/>
<text text-anchor="middle" x="799" y="-17138.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="799" y="-17123.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="799" y="-17108.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- comm_2_3&#45;&gt;layer_3_add1 -->
<g id="edge84" class="edge">
<title>comm_2_3&#45;&gt;layer_3_add1</title>
<path fill="none" stroke="black" d="M813.65,-17901.8C838.31,-17862.46 866,-17806.13 866,-17751.5 866,-17751.5 866,-17751.5 866,-17304.5 866,-17252.68 864.69,-17237.51 844,-17190 839.84,-17180.45 833.98,-17170.95 827.86,-17162.38"/>
<polygon fill="black" stroke="black" points="830.5,-17160.07 821.71,-17154.16 824.89,-17164.26 830.5,-17160.07"/>
</g>
<!-- layer_3_q_proj -->
<g id="node60" class="node">
<title>layer_3_q_proj</title>
<polygon fill="lightblue" stroke="black" points="384,-17777 178,-17777 178,-17724 384,-17724 384,-17777"/>
<text text-anchor="middle" x="281" y="-17761.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="281" y="-17746.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="281" y="-17731.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_q_proj -->
<g id="edge71" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_q_proj</title>
<path fill="none" stroke="black" d="M505.74,-17812.98C467.56,-17802.54 423.23,-17790.41 384.09,-17779.7"/>
<polygon fill="black" stroke="black" points="384.83,-17776.28 374.26,-17777.01 382.98,-17783.03 384.83,-17776.28"/>
</g>
<!-- layer_3_k_proj -->
<g id="node61" class="node">
<title>layer_3_k_proj</title>
<polygon fill="lightblue" stroke="black" points="612,-17777 406,-17777 406,-17724 612,-17724 612,-17777"/>
<text text-anchor="middle" x="509" y="-17761.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="509" y="-17746.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="509" y="-17731.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_k_proj -->
<g id="edge72" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_k_proj</title>
<path fill="none" stroke="black" d="M572.48,-17812.87C563.23,-17803.92 552.71,-17793.75 542.93,-17784.3"/>
<polygon fill="black" stroke="black" points="545.26,-17781.68 535.64,-17777.25 540.39,-17786.72 545.26,-17781.68"/>
</g>
<!-- layer_3_v_proj -->
<g id="node62" class="node">
<title>layer_3_v_proj</title>
<polygon fill="lightblue" stroke="black" points="836,-17777 630,-17777 630,-17724 836,-17724 836,-17777"/>
<text text-anchor="middle" x="733" y="-17761.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="733" y="-17746.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="733" y="-17731.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln1&#45;&gt;layer_3_v_proj -->
<g id="edge73" class="edge">
<title>layer_3_ln1&#45;&gt;layer_3_v_proj</title>
<path fill="none" stroke="black" d="M638.48,-17812.87C652.94,-17803.48 669.46,-17792.75 684.61,-17782.92"/>
<polygon fill="black" stroke="black" points="686.86,-17785.63 693.34,-17777.25 683.05,-17779.76 686.86,-17785.63"/>
</g>
<!-- layer_3_q_reshape -->
<g id="node63" class="node">
<title>layer_3_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="384,-17688 160,-17688 160,-17635 384,-17635 384,-17688"/>
<text text-anchor="middle" x="272" y="-17672.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="272" y="-17657.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="272" y="-17642.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_q_proj&#45;&gt;layer_3_q_reshape -->
<g id="edge74" class="edge">
<title>layer_3_q_proj&#45;&gt;layer_3_q_reshape</title>
<path fill="none" stroke="black" d="M278.35,-17723.87C277.52,-17715.89 276.6,-17706.93 275.71,-17698.38"/>
<polygon fill="black" stroke="black" points="279.17,-17697.84 274.66,-17688.25 272.21,-17698.56 279.17,-17697.84"/>
</g>
<!-- layer_3_k_reshape -->
<g id="node64" class="node">
<title>layer_3_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="626,-17688 402,-17688 402,-17635 626,-17635 626,-17688"/>
<text text-anchor="middle" x="514" y="-17672.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="514" y="-17657.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="514" y="-17642.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_k_proj&#45;&gt;layer_3_k_reshape -->
<g id="edge75" class="edge">
<title>layer_3_k_proj&#45;&gt;layer_3_k_reshape</title>
<path fill="none" stroke="black" d="M510.47,-17723.87C510.93,-17715.89 511.45,-17706.93 511.94,-17698.38"/>
<polygon fill="black" stroke="black" points="515.44,-17698.43 512.52,-17688.25 508.45,-17698.03 515.44,-17698.43"/>
</g>
<!-- layer_3_v_reshape -->
<g id="node65" class="node">
<title>layer_3_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="838,-17599 614,-17599 614,-17546 838,-17546 838,-17599"/>
<text text-anchor="middle" x="726" y="-17583.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="726" y="-17568.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="726" y="-17553.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_v_proj&#45;&gt;layer_3_v_reshape -->
<g id="edge76" class="edge">
<title>layer_3_v_proj&#45;&gt;layer_3_v_reshape</title>
<path fill="none" stroke="black" d="M731.98,-17723.91C730.78,-17693.67 728.77,-17643.17 727.42,-17609.12"/>
<polygon fill="black" stroke="black" points="730.91,-17608.98 727.02,-17599.12 723.92,-17609.25 730.91,-17608.98"/>
</g>
<!-- layer_3_attn_scores -->
<g id="node66" class="node">
<title>layer_3_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="595.5,-17599 362.5,-17599 362.5,-17546 595.5,-17546 595.5,-17599"/>
<text text-anchor="middle" x="479" y="-17583.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="479" y="-17568.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="479" y="-17553.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_q_reshape&#45;&gt;layer_3_attn_scores -->
<g id="edge77" class="edge">
<title>layer_3_q_reshape&#45;&gt;layer_3_attn_scores</title>
<path fill="none" stroke="black" d="M332.71,-17634.98C356.61,-17624.94 384.22,-17613.34 408.96,-17602.94"/>
<polygon fill="black" stroke="black" points="410.43,-17606.12 418.29,-17599.01 407.72,-17599.66 410.43,-17606.12"/>
</g>
<!-- layer_3_k_reshape&#45;&gt;layer_3_attn_scores -->
<g id="edge78" class="edge">
<title>layer_3_k_reshape&#45;&gt;layer_3_attn_scores</title>
<path fill="none" stroke="black" d="M503.69,-17634.87C500.37,-17626.62 496.64,-17617.34 493.1,-17608.54"/>
<polygon fill="black" stroke="black" points="496.34,-17607.22 489.36,-17599.25 489.84,-17609.83 496.34,-17607.22"/>
</g>
<!-- layer_3_attn_output -->
<g id="node68" class="node">
<title>layer_3_attn_output</title>
<polygon fill="lightblue" stroke="black" points="838,-17421 614,-17421 614,-17368 838,-17368 838,-17421"/>
<text text-anchor="middle" x="726" y="-17405.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="726" y="-17390.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="726" y="-17375.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_v_reshape&#45;&gt;layer_3_attn_output -->
<g id="edge81" class="edge">
<title>layer_3_v_reshape&#45;&gt;layer_3_attn_output</title>
<path fill="none" stroke="black" d="M726,-17545.91C726,-17515.8 726,-17465.61 726,-17431.56"/>
<polygon fill="black" stroke="black" points="729.5,-17431.12 726,-17421.12 722.5,-17431.12 729.5,-17431.12"/>
</g>
<!-- layer_3_attn_weights -->
<g id="node67" class="node">
<title>layer_3_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="646.5,-17510 413.5,-17510 413.5,-17457 646.5,-17457 646.5,-17510"/>
<text text-anchor="middle" x="530" y="-17494.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="530" y="-17479.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="530" y="-17464.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_scores&#45;&gt;layer_3_attn_weights -->
<g id="edge79" class="edge">
<title>layer_3_attn_scores&#45;&gt;layer_3_attn_weights</title>
<path fill="none" stroke="black" d="M494.03,-17545.87C498.96,-17537.45 504.53,-17527.95 509.79,-17518.98"/>
<polygon fill="black" stroke="black" points="512.87,-17520.65 514.91,-17510.25 506.83,-17517.11 512.87,-17520.65"/>
</g>
<!-- layer_3_attn_weights&#45;&gt;layer_3_attn_output -->
<g id="edge80" class="edge">
<title>layer_3_attn_weights&#45;&gt;layer_3_attn_output</title>
<path fill="none" stroke="black" d="M587.48,-17456.98C610.02,-17446.98 636.03,-17435.44 659.38,-17425.07"/>
<polygon fill="black" stroke="black" points="660.8,-17428.27 668.52,-17421.01 657.96,-17421.87 660.8,-17428.27"/>
</g>
<!-- layer_3_attn_reshape -->
<g id="node69" class="node">
<title>layer_3_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="833,-17332 627,-17332 627,-17279 833,-17279 833,-17332"/>
<text text-anchor="middle" x="730" y="-17316.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="730" y="-17301.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="730" y="-17286.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_output&#45;&gt;layer_3_attn_reshape -->
<g id="edge82" class="edge">
<title>layer_3_attn_output&#45;&gt;layer_3_attn_reshape</title>
<path fill="none" stroke="black" d="M727.18,-17367.87C727.55,-17359.89 727.96,-17350.93 728.35,-17342.38"/>
<polygon fill="black" stroke="black" points="731.85,-17342.4 728.82,-17332.25 724.86,-17342.08 731.85,-17342.4"/>
</g>
<!-- layer_3_attn_proj -->
<g id="node70" class="node">
<title>layer_3_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="835,-17243 629,-17243 629,-17190 835,-17190 835,-17243"/>
<text text-anchor="middle" x="732" y="-17227.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="732" y="-17212.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="732" y="-17197.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_attn_reshape&#45;&gt;layer_3_attn_proj -->
<g id="edge83" class="edge">
<title>layer_3_attn_reshape&#45;&gt;layer_3_attn_proj</title>
<path fill="none" stroke="black" d="M730.59,-17278.87C730.77,-17270.89 730.98,-17261.93 731.18,-17253.38"/>
<polygon fill="black" stroke="black" points="734.68,-17253.33 731.41,-17243.25 727.68,-17253.17 734.68,-17253.33"/>
</g>
<!-- layer_3_attn_proj&#45;&gt;layer_3_add1 -->
<g id="edge85" class="edge">
<title>layer_3_attn_proj&#45;&gt;layer_3_add1</title>
<path fill="none" stroke="black" d="M751.74,-17189.87C758.36,-17181.27 765.85,-17171.55 772.88,-17162.42"/>
<polygon fill="black" stroke="black" points="775.84,-17164.31 779.17,-17154.25 770.3,-17160.04 775.84,-17164.31"/>
</g>
<!-- layer_3_ln2 -->
<g id="node72" class="node">
<title>layer_3_ln2</title>
<polygon fill="lightcoral" stroke="black" points="837,-17065 631,-17065 631,-17012 837,-17012 837,-17065"/>
<text text-anchor="middle" x="734" y="-17049.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="734" y="-17034.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="734" y="-17019.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_add1&#45;&gt;layer_3_ln2 -->
<g id="edge86" class="edge">
<title>layer_3_add1&#45;&gt;layer_3_ln2</title>
<path fill="none" stroke="black" d="M779.85,-17100.87C773.43,-17092.27 766.16,-17082.55 759.34,-17073.42"/>
<polygon fill="black" stroke="black" points="762.03,-17071.17 753.24,-17065.25 756.42,-17075.36 762.03,-17071.17"/>
</g>
<!-- layer_3_add -->
<g id="node76" class="node">
<title>layer_3_add</title>
<polygon fill="lightgreen" stroke="black" points="903,-16709 697,-16709 697,-16656 903,-16656 903,-16709"/>
<text text-anchor="middle" x="800" y="-16693.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="800" y="-16678.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="800" y="-16663.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_add1&#45;&gt;layer_3_add -->
<g id="edge90" class="edge">
<title>layer_3_add1&#45;&gt;layer_3_add</title>
<path fill="none" stroke="black" d="M823.05,-17100.72C831.52,-17090.32 840.34,-17077.78 846,-17065 866.95,-17017.7 867,-17002.24 867,-16950.5 867,-16950.5 867,-16950.5 867,-16859.5 867,-16807.68 865.69,-16792.51 845,-16745 840.84,-16735.45 834.98,-16725.95 828.86,-16717.38"/>
<polygon fill="black" stroke="black" points="831.5,-16715.07 822.71,-16709.16 825.89,-16719.26 831.5,-16715.07"/>
</g>
<!-- layer_3_ffn1 -->
<g id="node73" class="node">
<title>layer_3_ffn1</title>
<polygon fill="lightblue" stroke="black" points="838.5,-16976 623.5,-16976 623.5,-16923 838.5,-16923 838.5,-16976"/>
<text text-anchor="middle" x="731" y="-16960.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="731" y="-16945.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="731" y="-16930.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ln2&#45;&gt;layer_3_ffn1 -->
<g id="edge87" class="edge">
<title>layer_3_ln2&#45;&gt;layer_3_ffn1</title>
<path fill="none" stroke="black" d="M733.12,-17011.87C732.84,-17003.89 732.53,-16994.93 732.24,-16986.38"/>
<polygon fill="black" stroke="black" points="735.73,-16986.12 731.89,-16976.25 728.73,-16986.36 735.73,-16986.12"/>
</g>
<!-- layer_3_gelu -->
<g id="node74" class="node">
<title>layer_3_gelu</title>
<polygon fill="lightblue" stroke="black" points="838.5,-16887 623.5,-16887 623.5,-16834 838.5,-16834 838.5,-16887"/>
<text text-anchor="middle" x="731" y="-16871.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="731" y="-16856.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="731" y="-16841.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_ffn1&#45;&gt;layer_3_gelu -->
<g id="edge88" class="edge">
<title>layer_3_ffn1&#45;&gt;layer_3_gelu</title>
<path fill="none" stroke="black" d="M731,-16922.87C731,-16914.89 731,-16905.93 731,-16897.38"/>
<polygon fill="black" stroke="black" points="734.5,-16897.25 731,-16887.25 727.5,-16897.25 734.5,-16897.25"/>
</g>
<!-- layer_3_ffn2 -->
<g id="node75" class="node">
<title>layer_3_ffn2</title>
<polygon fill="lightblue" stroke="black" points="836,-16798 630,-16798 630,-16745 836,-16745 836,-16798"/>
<text text-anchor="middle" x="733" y="-16782.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="733" y="-16767.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="733" y="-16752.8" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<!-- layer_3_gelu&#45;&gt;layer_3_ffn2 -->
<g id="edge89" class="edge">
<title>layer_3_gelu&#45;&gt;layer_3_ffn2</title>
<path fill="none" stroke="black" d="M731.59,-16833.87C731.77,-16825.89 731.98,-16816.93 732.18,-16808.38"/>
<polygon fill="black" stroke="black" points="735.68,-16808.33 732.41,-16798.25 728.68,-16808.17 735.68,-16808.33"/>
</g>
<!-- layer_3_ffn2&#45;&gt;layer_3_add -->
<g id="edge91" class="edge">
<title>layer_3_ffn2&#45;&gt;layer_3_add</title>
<path fill="none" stroke="black" d="M752.74,-16744.87C759.36,-16736.27 766.85,-16726.55 773.88,-16717.42"/>
<polygon fill="black" stroke="black" points="776.84,-16719.31 780.17,-16709.25 771.3,-16715.04 776.84,-16719.31"/>
</g>
<!-- comm_3_4 -->
<g id="node77" class="node">
<title>comm_3_4</title>
<polygon fill="yellow" stroke="black" points="1013.64,-16620 673.79,-16620 586.36,-16514 926.21,-16514 1013.64,-16620"/>
<text text-anchor="middle" x="800" y="-16578.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="800" y="-16563.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="800" y="-16548.3" font-family="Times,serif" font-size="14.00">GPU 3 → GPU 4</text>
</g>
<!-- layer_3_add&#45;&gt;comm_3_4 -->
<g id="edge92" class="edge">
<title>layer_3_add&#45;&gt;comm_3_4</title>
<path fill="none" stroke="black" d="M800,-16655.75C800,-16648.05 800,-16639.25 800,-16630.27"/>
<polygon fill="black" stroke="black" points="803.5,-16630.1 800,-16620.1 796.5,-16630.1 803.5,-16630.1"/>
</g>
<!-- layer_4_ln1 -->
<g id="node78" class="node">
<title>layer_4_ln1</title>
<polygon fill="lightcoral" stroke="black" points="726,-16478 520,-16478 520,-16425 726,-16425 726,-16478"/>
<text text-anchor="middle" x="623" y="-16462.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="623" y="-16447.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="623" y="-16432.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- comm_3_4&#45;&gt;layer_4_ln1 -->
<g id="edge93" class="edge">
<title>comm_3_4&#45;&gt;layer_4_ln1</title>
<path fill="none" stroke="black" d="M718.75,-16513.9C702.5,-16503.48 685.91,-16492.84 671.21,-16483.41"/>
<polygon fill="black" stroke="black" points="673.1,-16480.47 662.79,-16478.01 669.32,-16486.36 673.1,-16480.47"/>
</g>
<!-- layer_4_add1 -->
<g id="node90" class="node">
<title>layer_4_add1</title>
<polygon fill="lightgreen" stroke="black" points="925,-15766 719,-15766 719,-15713 925,-15713 925,-15766"/>
<text text-anchor="middle" x="822" y="-15750.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="822" y="-15735.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="822" y="-15720.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- comm_3_4&#45;&gt;layer_4_add1 -->
<g id="edge107" class="edge">
<title>comm_3_4&#45;&gt;layer_4_add1</title>
<path fill="none" stroke="black" d="M837.65,-16513.8C862.31,-16474.46 890,-16418.13 890,-16363.5 890,-16363.5 890,-16363.5 890,-15916.5 890,-15864.76 889.95,-15849.3 869,-15802 864.71,-15792.32 858.61,-15782.77 852.21,-15774.19"/>
<polygon fill="black" stroke="black" points="854.96,-15772.01 846.05,-15766.28 849.44,-15776.32 854.96,-15772.01"/>
</g>
<!-- layer_4_q_proj -->
<g id="node79" class="node">
<title>layer_4_q_proj</title>
<polygon fill="lightblue" stroke="black" points="408,-16389 202,-16389 202,-16336 408,-16336 408,-16389"/>
<text text-anchor="middle" x="305" y="-16373.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="305" y="-16358.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="305" y="-16343.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_q_proj -->
<g id="edge94" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_q_proj</title>
<path fill="none" stroke="black" d="M529.74,-16424.98C491.56,-16414.54 447.23,-16402.41 408.09,-16391.7"/>
<polygon fill="black" stroke="black" points="408.83,-16388.28 398.26,-16389.01 406.98,-16395.03 408.83,-16388.28"/>
</g>
<!-- layer_4_k_proj -->
<g id="node80" class="node">
<title>layer_4_k_proj</title>
<polygon fill="lightblue" stroke="black" points="636,-16389 430,-16389 430,-16336 636,-16336 636,-16389"/>
<text text-anchor="middle" x="533" y="-16373.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="533" y="-16358.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="533" y="-16343.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_k_proj -->
<g id="edge95" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_k_proj</title>
<path fill="none" stroke="black" d="M596.48,-16424.87C587.23,-16415.92 576.71,-16405.75 566.93,-16396.3"/>
<polygon fill="black" stroke="black" points="569.26,-16393.68 559.64,-16389.25 564.39,-16398.72 569.26,-16393.68"/>
</g>
<!-- layer_4_v_proj -->
<g id="node81" class="node">
<title>layer_4_v_proj</title>
<polygon fill="lightblue" stroke="black" points="860,-16389 654,-16389 654,-16336 860,-16336 860,-16389"/>
<text text-anchor="middle" x="757" y="-16373.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="757" y="-16358.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="757" y="-16343.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln1&#45;&gt;layer_4_v_proj -->
<g id="edge96" class="edge">
<title>layer_4_ln1&#45;&gt;layer_4_v_proj</title>
<path fill="none" stroke="black" d="M662.48,-16424.87C676.94,-16415.48 693.46,-16404.75 708.61,-16394.92"/>
<polygon fill="black" stroke="black" points="710.86,-16397.63 717.34,-16389.25 707.05,-16391.76 710.86,-16397.63"/>
</g>
<!-- layer_4_q_reshape -->
<g id="node82" class="node">
<title>layer_4_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="408,-16300 184,-16300 184,-16247 408,-16247 408,-16300"/>
<text text-anchor="middle" x="296" y="-16284.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="296" y="-16269.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="296" y="-16254.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_q_proj&#45;&gt;layer_4_q_reshape -->
<g id="edge97" class="edge">
<title>layer_4_q_proj&#45;&gt;layer_4_q_reshape</title>
<path fill="none" stroke="black" d="M302.35,-16335.87C301.52,-16327.89 300.6,-16318.93 299.71,-16310.38"/>
<polygon fill="black" stroke="black" points="303.17,-16309.84 298.66,-16300.25 296.21,-16310.56 303.17,-16309.84"/>
</g>
<!-- layer_4_k_reshape -->
<g id="node83" class="node">
<title>layer_4_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="650,-16300 426,-16300 426,-16247 650,-16247 650,-16300"/>
<text text-anchor="middle" x="538" y="-16284.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="538" y="-16269.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="538" y="-16254.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_k_proj&#45;&gt;layer_4_k_reshape -->
<g id="edge98" class="edge">
<title>layer_4_k_proj&#45;&gt;layer_4_k_reshape</title>
<path fill="none" stroke="black" d="M534.47,-16335.87C534.93,-16327.89 535.45,-16318.93 535.94,-16310.38"/>
<polygon fill="black" stroke="black" points="539.44,-16310.43 536.52,-16300.25 532.45,-16310.03 539.44,-16310.43"/>
</g>
<!-- layer_4_v_reshape -->
<g id="node84" class="node">
<title>layer_4_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="862,-16211 638,-16211 638,-16158 862,-16158 862,-16211"/>
<text text-anchor="middle" x="750" y="-16195.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="750" y="-16180.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="750" y="-16165.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_v_proj&#45;&gt;layer_4_v_reshape -->
<g id="edge99" class="edge">
<title>layer_4_v_proj&#45;&gt;layer_4_v_reshape</title>
<path fill="none" stroke="black" d="M755.98,-16335.91C754.78,-16305.67 752.77,-16255.17 751.42,-16221.12"/>
<polygon fill="black" stroke="black" points="754.91,-16220.98 751.02,-16211.12 747.92,-16221.25 754.91,-16220.98"/>
</g>
<!-- layer_4_attn_scores -->
<g id="node85" class="node">
<title>layer_4_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="619.5,-16211 386.5,-16211 386.5,-16158 619.5,-16158 619.5,-16211"/>
<text text-anchor="middle" x="503" y="-16195.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="503" y="-16180.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="503" y="-16165.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_q_reshape&#45;&gt;layer_4_attn_scores -->
<g id="edge100" class="edge">
<title>layer_4_q_reshape&#45;&gt;layer_4_attn_scores</title>
<path fill="none" stroke="black" d="M356.71,-16246.98C380.61,-16236.94 408.22,-16225.34 432.96,-16214.94"/>
<polygon fill="black" stroke="black" points="434.43,-16218.12 442.29,-16211.01 431.72,-16211.66 434.43,-16218.12"/>
</g>
<!-- layer_4_k_reshape&#45;&gt;layer_4_attn_scores -->
<g id="edge101" class="edge">
<title>layer_4_k_reshape&#45;&gt;layer_4_attn_scores</title>
<path fill="none" stroke="black" d="M527.69,-16246.87C524.37,-16238.62 520.64,-16229.34 517.1,-16220.54"/>
<polygon fill="black" stroke="black" points="520.34,-16219.22 513.36,-16211.25 513.84,-16221.83 520.34,-16219.22"/>
</g>
<!-- layer_4_attn_output -->
<g id="node87" class="node">
<title>layer_4_attn_output</title>
<polygon fill="lightblue" stroke="black" points="862,-16033 638,-16033 638,-15980 862,-15980 862,-16033"/>
<text text-anchor="middle" x="750" y="-16017.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="750" y="-16002.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="750" y="-15987.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_v_reshape&#45;&gt;layer_4_attn_output -->
<g id="edge104" class="edge">
<title>layer_4_v_reshape&#45;&gt;layer_4_attn_output</title>
<path fill="none" stroke="black" d="M750,-16157.91C750,-16127.8 750,-16077.61 750,-16043.56"/>
<polygon fill="black" stroke="black" points="753.5,-16043.12 750,-16033.12 746.5,-16043.12 753.5,-16043.12"/>
</g>
<!-- layer_4_attn_weights -->
<g id="node86" class="node">
<title>layer_4_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="670.5,-16122 437.5,-16122 437.5,-16069 670.5,-16069 670.5,-16122"/>
<text text-anchor="middle" x="554" y="-16106.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="554" y="-16091.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="554" y="-16076.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_scores&#45;&gt;layer_4_attn_weights -->
<g id="edge102" class="edge">
<title>layer_4_attn_scores&#45;&gt;layer_4_attn_weights</title>
<path fill="none" stroke="black" d="M518.03,-16157.87C522.96,-16149.45 528.53,-16139.95 533.79,-16130.98"/>
<polygon fill="black" stroke="black" points="536.87,-16132.65 538.91,-16122.25 530.83,-16129.11 536.87,-16132.65"/>
</g>
<!-- layer_4_attn_weights&#45;&gt;layer_4_attn_output -->
<g id="edge103" class="edge">
<title>layer_4_attn_weights&#45;&gt;layer_4_attn_output</title>
<path fill="none" stroke="black" d="M611.48,-16068.98C634.02,-16058.98 660.03,-16047.44 683.38,-16037.07"/>
<polygon fill="black" stroke="black" points="684.8,-16040.27 692.52,-16033.01 681.96,-16033.87 684.8,-16040.27"/>
</g>
<!-- layer_4_attn_reshape -->
<g id="node88" class="node">
<title>layer_4_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="857,-15944 651,-15944 651,-15891 857,-15891 857,-15944"/>
<text text-anchor="middle" x="754" y="-15928.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="754" y="-15913.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="754" y="-15898.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_output&#45;&gt;layer_4_attn_reshape -->
<g id="edge105" class="edge">
<title>layer_4_attn_output&#45;&gt;layer_4_attn_reshape</title>
<path fill="none" stroke="black" d="M751.18,-15979.87C751.55,-15971.89 751.96,-15962.93 752.35,-15954.38"/>
<polygon fill="black" stroke="black" points="755.85,-15954.4 752.82,-15944.25 748.86,-15954.08 755.85,-15954.4"/>
</g>
<!-- layer_4_attn_proj -->
<g id="node89" class="node">
<title>layer_4_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="860,-15855 654,-15855 654,-15802 860,-15802 860,-15855"/>
<text text-anchor="middle" x="757" y="-15839.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="757" y="-15824.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="757" y="-15809.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_attn_reshape&#45;&gt;layer_4_attn_proj -->
<g id="edge106" class="edge">
<title>layer_4_attn_reshape&#45;&gt;layer_4_attn_proj</title>
<path fill="none" stroke="black" d="M754.88,-15890.87C755.16,-15882.89 755.47,-15873.93 755.76,-15865.38"/>
<polygon fill="black" stroke="black" points="759.27,-15865.36 756.11,-15855.25 752.27,-15865.12 759.27,-15865.36"/>
</g>
<!-- layer_4_attn_proj&#45;&gt;layer_4_add1 -->
<g id="edge108" class="edge">
<title>layer_4_attn_proj&#45;&gt;layer_4_add1</title>
<path fill="none" stroke="black" d="M776.15,-15801.87C782.57,-15793.27 789.84,-15783.55 796.66,-15774.42"/>
<polygon fill="black" stroke="black" points="799.58,-15776.36 802.76,-15766.25 793.97,-15772.17 799.58,-15776.36"/>
</g>
<!-- layer_4_ln2 -->
<g id="node91" class="node">
<title>layer_4_ln2</title>
<polygon fill="lightcoral" stroke="black" points="860,-15677 654,-15677 654,-15624 860,-15624 860,-15677"/>
<text text-anchor="middle" x="757" y="-15661.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="757" y="-15646.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="757" y="-15631.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_add1&#45;&gt;layer_4_ln2 -->
<g id="edge109" class="edge">
<title>layer_4_add1&#45;&gt;layer_4_ln2</title>
<path fill="none" stroke="black" d="M802.85,-15712.87C796.43,-15704.27 789.16,-15694.55 782.34,-15685.42"/>
<polygon fill="black" stroke="black" points="785.03,-15683.17 776.24,-15677.25 779.42,-15687.36 785.03,-15683.17"/>
</g>
<!-- layer_4_add -->
<g id="node95" class="node">
<title>layer_4_add</title>
<polygon fill="lightgreen" stroke="black" points="926,-15321 720,-15321 720,-15268 926,-15268 926,-15321"/>
<text text-anchor="middle" x="823" y="-15305.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="823" y="-15290.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="823" y="-15275.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_add1&#45;&gt;layer_4_add -->
<g id="edge113" class="edge">
<title>layer_4_add1&#45;&gt;layer_4_add</title>
<path fill="none" stroke="black" d="M846.05,-15712.72C854.52,-15702.32 863.34,-15689.78 869,-15677 889.95,-15629.7 890,-15614.24 890,-15562.5 890,-15562.5 890,-15562.5 890,-15471.5 890,-15419.68 888.69,-15404.51 868,-15357 863.84,-15347.45 857.98,-15337.95 851.86,-15329.38"/>
<polygon fill="black" stroke="black" points="854.5,-15327.07 845.71,-15321.16 848.89,-15331.26 854.5,-15327.07"/>
</g>
<!-- layer_4_ffn1 -->
<g id="node92" class="node">
<title>layer_4_ffn1</title>
<polygon fill="lightblue" stroke="black" points="861.5,-15588 646.5,-15588 646.5,-15535 861.5,-15535 861.5,-15588"/>
<text text-anchor="middle" x="754" y="-15572.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="754" y="-15557.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="754" y="-15542.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ln2&#45;&gt;layer_4_ffn1 -->
<g id="edge110" class="edge">
<title>layer_4_ln2&#45;&gt;layer_4_ffn1</title>
<path fill="none" stroke="black" d="M756.12,-15623.87C755.84,-15615.89 755.53,-15606.93 755.24,-15598.38"/>
<polygon fill="black" stroke="black" points="758.73,-15598.12 754.89,-15588.25 751.73,-15598.36 758.73,-15598.12"/>
</g>
<!-- layer_4_gelu -->
<g id="node93" class="node">
<title>layer_4_gelu</title>
<polygon fill="lightblue" stroke="black" points="861.5,-15499 646.5,-15499 646.5,-15446 861.5,-15446 861.5,-15499"/>
<text text-anchor="middle" x="754" y="-15483.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="754" y="-15468.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="754" y="-15453.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_ffn1&#45;&gt;layer_4_gelu -->
<g id="edge111" class="edge">
<title>layer_4_ffn1&#45;&gt;layer_4_gelu</title>
<path fill="none" stroke="black" d="M754,-15534.87C754,-15526.89 754,-15517.93 754,-15509.38"/>
<polygon fill="black" stroke="black" points="757.5,-15509.25 754,-15499.25 750.5,-15509.25 757.5,-15509.25"/>
</g>
<!-- layer_4_ffn2 -->
<g id="node94" class="node">
<title>layer_4_ffn2</title>
<polygon fill="lightblue" stroke="black" points="859,-15410 653,-15410 653,-15357 859,-15357 859,-15410"/>
<text text-anchor="middle" x="756" y="-15394.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="756" y="-15379.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="756" y="-15364.8" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<!-- layer_4_gelu&#45;&gt;layer_4_ffn2 -->
<g id="edge112" class="edge">
<title>layer_4_gelu&#45;&gt;layer_4_ffn2</title>
<path fill="none" stroke="black" d="M754.59,-15445.87C754.77,-15437.89 754.98,-15428.93 755.18,-15420.38"/>
<polygon fill="black" stroke="black" points="758.68,-15420.33 755.41,-15410.25 751.68,-15420.17 758.68,-15420.33"/>
</g>
<!-- layer_4_ffn2&#45;&gt;layer_4_add -->
<g id="edge114" class="edge">
<title>layer_4_ffn2&#45;&gt;layer_4_add</title>
<path fill="none" stroke="black" d="M775.74,-15356.87C782.36,-15348.27 789.85,-15338.55 796.88,-15329.42"/>
<polygon fill="black" stroke="black" points="799.84,-15331.31 803.17,-15321.25 794.3,-15327.04 799.84,-15331.31"/>
</g>
<!-- comm_4_5 -->
<g id="node96" class="node">
<title>comm_4_5</title>
<polygon fill="yellow" stroke="black" points="1036.64,-15232 696.79,-15232 609.36,-15126 949.21,-15126 1036.64,-15232"/>
<text text-anchor="middle" x="823" y="-15190.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="823" y="-15175.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="823" y="-15160.3" font-family="Times,serif" font-size="14.00">GPU 4 → GPU 5</text>
</g>
<!-- layer_4_add&#45;&gt;comm_4_5 -->
<g id="edge115" class="edge">
<title>layer_4_add&#45;&gt;comm_4_5</title>
<path fill="none" stroke="black" d="M823,-15267.75C823,-15260.05 823,-15251.25 823,-15242.27"/>
<polygon fill="black" stroke="black" points="826.5,-15242.1 823,-15232.1 819.5,-15242.1 826.5,-15242.1"/>
</g>
<!-- layer_5_ln1 -->
<g id="node97" class="node">
<title>layer_5_ln1</title>
<polygon fill="lightcoral" stroke="black" points="749,-15090 543,-15090 543,-15037 749,-15037 749,-15090"/>
<text text-anchor="middle" x="646" y="-15074.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="646" y="-15059.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="646" y="-15044.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- comm_4_5&#45;&gt;layer_5_ln1 -->
<g id="edge116" class="edge">
<title>comm_4_5&#45;&gt;layer_5_ln1</title>
<path fill="none" stroke="black" d="M741.75,-15125.9C725.5,-15115.48 708.91,-15104.84 694.21,-15095.41"/>
<polygon fill="black" stroke="black" points="696.1,-15092.47 685.79,-15090.01 692.32,-15098.36 696.1,-15092.47"/>
</g>
<!-- layer_5_add1 -->
<g id="node109" class="node">
<title>layer_5_add1</title>
<polygon fill="lightgreen" stroke="black" points="948,-14378 742,-14378 742,-14325 948,-14325 948,-14378"/>
<text text-anchor="middle" x="845" y="-14362.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="845" y="-14347.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="845" y="-14332.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- comm_4_5&#45;&gt;layer_5_add1 -->
<g id="edge130" class="edge">
<title>comm_4_5&#45;&gt;layer_5_add1</title>
<path fill="none" stroke="black" d="M860.65,-15125.8C885.31,-15086.46 913,-15030.13 913,-14975.5 913,-14975.5 913,-14975.5 913,-14528.5 913,-14476.76 912.95,-14461.3 892,-14414 887.71,-14404.32 881.61,-14394.77 875.21,-14386.19"/>
<polygon fill="black" stroke="black" points="877.96,-14384.01 869.05,-14378.28 872.44,-14388.32 877.96,-14384.01"/>
</g>
<!-- layer_5_q_proj -->
<g id="node98" class="node">
<title>layer_5_q_proj</title>
<polygon fill="lightblue" stroke="black" points="431,-15001 225,-15001 225,-14948 431,-14948 431,-15001"/>
<text text-anchor="middle" x="328" y="-14985.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="328" y="-14970.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="328" y="-14955.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_q_proj -->
<g id="edge117" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_q_proj</title>
<path fill="none" stroke="black" d="M552.74,-15036.98C514.56,-15026.54 470.23,-15014.41 431.09,-15003.7"/>
<polygon fill="black" stroke="black" points="431.83,-15000.28 421.26,-15001.01 429.98,-15007.03 431.83,-15000.28"/>
</g>
<!-- layer_5_k_proj -->
<g id="node99" class="node">
<title>layer_5_k_proj</title>
<polygon fill="lightblue" stroke="black" points="659,-15001 453,-15001 453,-14948 659,-14948 659,-15001"/>
<text text-anchor="middle" x="556" y="-14985.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="556" y="-14970.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="556" y="-14955.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_k_proj -->
<g id="edge118" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_k_proj</title>
<path fill="none" stroke="black" d="M619.48,-15036.87C610.23,-15027.92 599.71,-15017.75 589.93,-15008.3"/>
<polygon fill="black" stroke="black" points="592.26,-15005.68 582.64,-15001.25 587.39,-15010.72 592.26,-15005.68"/>
</g>
<!-- layer_5_v_proj -->
<g id="node100" class="node">
<title>layer_5_v_proj</title>
<polygon fill="lightblue" stroke="black" points="883,-15001 677,-15001 677,-14948 883,-14948 883,-15001"/>
<text text-anchor="middle" x="780" y="-14985.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="780" y="-14970.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780" y="-14955.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln1&#45;&gt;layer_5_v_proj -->
<g id="edge119" class="edge">
<title>layer_5_ln1&#45;&gt;layer_5_v_proj</title>
<path fill="none" stroke="black" d="M685.48,-15036.87C699.94,-15027.48 716.46,-15016.75 731.61,-15006.92"/>
<polygon fill="black" stroke="black" points="733.86,-15009.63 740.34,-15001.25 730.05,-15003.76 733.86,-15009.63"/>
</g>
<!-- layer_5_q_reshape -->
<g id="node101" class="node">
<title>layer_5_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="431,-14912 207,-14912 207,-14859 431,-14859 431,-14912"/>
<text text-anchor="middle" x="319" y="-14896.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="319" y="-14881.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="319" y="-14866.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_q_proj&#45;&gt;layer_5_q_reshape -->
<g id="edge120" class="edge">
<title>layer_5_q_proj&#45;&gt;layer_5_q_reshape</title>
<path fill="none" stroke="black" d="M325.35,-14947.87C324.52,-14939.89 323.6,-14930.93 322.71,-14922.38"/>
<polygon fill="black" stroke="black" points="326.17,-14921.84 321.66,-14912.25 319.21,-14922.56 326.17,-14921.84"/>
</g>
<!-- layer_5_k_reshape -->
<g id="node102" class="node">
<title>layer_5_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="673,-14912 449,-14912 449,-14859 673,-14859 673,-14912"/>
<text text-anchor="middle" x="561" y="-14896.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="561" y="-14881.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="561" y="-14866.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_k_proj&#45;&gt;layer_5_k_reshape -->
<g id="edge121" class="edge">
<title>layer_5_k_proj&#45;&gt;layer_5_k_reshape</title>
<path fill="none" stroke="black" d="M557.47,-14947.87C557.93,-14939.89 558.45,-14930.93 558.94,-14922.38"/>
<polygon fill="black" stroke="black" points="562.44,-14922.43 559.52,-14912.25 555.45,-14922.03 562.44,-14922.43"/>
</g>
<!-- layer_5_v_reshape -->
<g id="node103" class="node">
<title>layer_5_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="885,-14823 661,-14823 661,-14770 885,-14770 885,-14823"/>
<text text-anchor="middle" x="773" y="-14807.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="773" y="-14792.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="773" y="-14777.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_v_proj&#45;&gt;layer_5_v_reshape -->
<g id="edge122" class="edge">
<title>layer_5_v_proj&#45;&gt;layer_5_v_reshape</title>
<path fill="none" stroke="black" d="M778.98,-14947.91C777.78,-14917.67 775.77,-14867.17 774.42,-14833.12"/>
<polygon fill="black" stroke="black" points="777.91,-14832.98 774.02,-14823.12 770.92,-14833.25 777.91,-14832.98"/>
</g>
<!-- layer_5_attn_scores -->
<g id="node104" class="node">
<title>layer_5_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="642.5,-14823 409.5,-14823 409.5,-14770 642.5,-14770 642.5,-14823"/>
<text text-anchor="middle" x="526" y="-14807.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="526" y="-14792.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="526" y="-14777.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_q_reshape&#45;&gt;layer_5_attn_scores -->
<g id="edge123" class="edge">
<title>layer_5_q_reshape&#45;&gt;layer_5_attn_scores</title>
<path fill="none" stroke="black" d="M379.71,-14858.98C403.61,-14848.94 431.22,-14837.34 455.96,-14826.94"/>
<polygon fill="black" stroke="black" points="457.43,-14830.12 465.29,-14823.01 454.72,-14823.66 457.43,-14830.12"/>
</g>
<!-- layer_5_k_reshape&#45;&gt;layer_5_attn_scores -->
<g id="edge124" class="edge">
<title>layer_5_k_reshape&#45;&gt;layer_5_attn_scores</title>
<path fill="none" stroke="black" d="M550.69,-14858.87C547.37,-14850.62 543.64,-14841.34 540.1,-14832.54"/>
<polygon fill="black" stroke="black" points="543.34,-14831.22 536.36,-14823.25 536.84,-14833.83 543.34,-14831.22"/>
</g>
<!-- layer_5_attn_output -->
<g id="node106" class="node">
<title>layer_5_attn_output</title>
<polygon fill="lightblue" stroke="black" points="885,-14645 661,-14645 661,-14592 885,-14592 885,-14645"/>
<text text-anchor="middle" x="773" y="-14629.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="773" y="-14614.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="773" y="-14599.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_v_reshape&#45;&gt;layer_5_attn_output -->
<g id="edge127" class="edge">
<title>layer_5_v_reshape&#45;&gt;layer_5_attn_output</title>
<path fill="none" stroke="black" d="M773,-14769.91C773,-14739.8 773,-14689.61 773,-14655.56"/>
<polygon fill="black" stroke="black" points="776.5,-14655.12 773,-14645.12 769.5,-14655.12 776.5,-14655.12"/>
</g>
<!-- layer_5_attn_weights -->
<g id="node105" class="node">
<title>layer_5_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="693.5,-14734 460.5,-14734 460.5,-14681 693.5,-14681 693.5,-14734"/>
<text text-anchor="middle" x="577" y="-14718.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="577" y="-14703.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="577" y="-14688.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_scores&#45;&gt;layer_5_attn_weights -->
<g id="edge125" class="edge">
<title>layer_5_attn_scores&#45;&gt;layer_5_attn_weights</title>
<path fill="none" stroke="black" d="M541.03,-14769.87C545.96,-14761.45 551.53,-14751.95 556.79,-14742.98"/>
<polygon fill="black" stroke="black" points="559.87,-14744.65 561.91,-14734.25 553.83,-14741.11 559.87,-14744.65"/>
</g>
<!-- layer_5_attn_weights&#45;&gt;layer_5_attn_output -->
<g id="edge126" class="edge">
<title>layer_5_attn_weights&#45;&gt;layer_5_attn_output</title>
<path fill="none" stroke="black" d="M634.48,-14680.98C657.02,-14670.98 683.03,-14659.44 706.38,-14649.07"/>
<polygon fill="black" stroke="black" points="707.8,-14652.27 715.52,-14645.01 704.96,-14645.87 707.8,-14652.27"/>
</g>
<!-- layer_5_attn_reshape -->
<g id="node107" class="node">
<title>layer_5_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="879,-14556 673,-14556 673,-14503 879,-14503 879,-14556"/>
<text text-anchor="middle" x="776" y="-14540.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="776" y="-14525.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="776" y="-14510.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_output&#45;&gt;layer_5_attn_reshape -->
<g id="edge128" class="edge">
<title>layer_5_attn_output&#45;&gt;layer_5_attn_reshape</title>
<path fill="none" stroke="black" d="M773.88,-14591.87C774.16,-14583.89 774.47,-14574.93 774.76,-14566.38"/>
<polygon fill="black" stroke="black" points="778.27,-14566.36 775.11,-14556.25 771.27,-14566.12 778.27,-14566.36"/>
</g>
<!-- layer_5_attn_proj -->
<g id="node108" class="node">
<title>layer_5_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="883,-14467 677,-14467 677,-14414 883,-14414 883,-14467"/>
<text text-anchor="middle" x="780" y="-14451.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="780" y="-14436.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="780" y="-14421.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_attn_reshape&#45;&gt;layer_5_attn_proj -->
<g id="edge129" class="edge">
<title>layer_5_attn_reshape&#45;&gt;layer_5_attn_proj</title>
<path fill="none" stroke="black" d="M777.18,-14502.87C777.55,-14494.89 777.96,-14485.93 778.35,-14477.38"/>
<polygon fill="black" stroke="black" points="781.85,-14477.4 778.82,-14467.25 774.86,-14477.08 781.85,-14477.4"/>
</g>
<!-- layer_5_attn_proj&#45;&gt;layer_5_add1 -->
<g id="edge131" class="edge">
<title>layer_5_attn_proj&#45;&gt;layer_5_add1</title>
<path fill="none" stroke="black" d="M799.15,-14413.87C805.57,-14405.27 812.84,-14395.55 819.66,-14386.42"/>
<polygon fill="black" stroke="black" points="822.58,-14388.36 825.76,-14378.25 816.97,-14384.17 822.58,-14388.36"/>
</g>
<!-- layer_5_ln2 -->
<g id="node110" class="node">
<title>layer_5_ln2</title>
<polygon fill="lightcoral" stroke="black" points="880,-14289 674,-14289 674,-14236 880,-14236 880,-14289"/>
<text text-anchor="middle" x="777" y="-14273.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="777" y="-14258.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="777" y="-14243.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_add1&#45;&gt;layer_5_ln2 -->
<g id="edge132" class="edge">
<title>layer_5_add1&#45;&gt;layer_5_ln2</title>
<path fill="none" stroke="black" d="M824.97,-14324.87C818.18,-14316.18 810.49,-14306.35 803.29,-14297.14"/>
<polygon fill="black" stroke="black" points="806.04,-14294.97 797.13,-14289.25 800.53,-14299.28 806.04,-14294.97"/>
</g>
<!-- layer_5_add -->
<g id="node114" class="node">
<title>layer_5_add</title>
<polygon fill="lightgreen" stroke="black" points="947,-13933 741,-13933 741,-13880 947,-13880 947,-13933"/>
<text text-anchor="middle" x="844" y="-13917.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="844" y="-13902.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="844" y="-13887.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_add1&#45;&gt;layer_5_add -->
<g id="edge136" class="edge">
<title>layer_5_add1&#45;&gt;layer_5_add</title>
<path fill="none" stroke="black" d="M867.19,-14324.77C875.18,-14314.29 883.56,-14301.67 889,-14289 909.44,-14241.38 911,-14226.32 911,-14174.5 911,-14174.5 911,-14174.5 911,-14083.5 911,-14031.68 909.69,-14016.51 889,-13969 884.84,-13959.45 878.98,-13949.95 872.86,-13941.38"/>
<polygon fill="black" stroke="black" points="875.5,-13939.07 866.71,-13933.16 869.89,-13943.26 875.5,-13939.07"/>
</g>
<!-- layer_5_ffn1 -->
<g id="node111" class="node">
<title>layer_5_ffn1</title>
<polygon fill="lightblue" stroke="black" points="882.5,-14200 667.5,-14200 667.5,-14147 882.5,-14147 882.5,-14200"/>
<text text-anchor="middle" x="775" y="-14184.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="775" y="-14169.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="775" y="-14154.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ln2&#45;&gt;layer_5_ffn1 -->
<g id="edge133" class="edge">
<title>layer_5_ln2&#45;&gt;layer_5_ffn1</title>
<path fill="none" stroke="black" d="M776.41,-14235.87C776.23,-14227.89 776.02,-14218.93 775.82,-14210.38"/>
<polygon fill="black" stroke="black" points="779.32,-14210.17 775.59,-14200.25 772.32,-14210.33 779.32,-14210.17"/>
</g>
<!-- layer_5_gelu -->
<g id="node112" class="node">
<title>layer_5_gelu</title>
<polygon fill="lightblue" stroke="black" points="882.5,-14111 667.5,-14111 667.5,-14058 882.5,-14058 882.5,-14111"/>
<text text-anchor="middle" x="775" y="-14095.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="775" y="-14080.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="775" y="-14065.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_ffn1&#45;&gt;layer_5_gelu -->
<g id="edge134" class="edge">
<title>layer_5_ffn1&#45;&gt;layer_5_gelu</title>
<path fill="none" stroke="black" d="M775,-14146.87C775,-14138.89 775,-14129.93 775,-14121.38"/>
<polygon fill="black" stroke="black" points="778.5,-14121.25 775,-14111.25 771.5,-14121.25 778.5,-14121.25"/>
</g>
<!-- layer_5_ffn2 -->
<g id="node113" class="node">
<title>layer_5_ffn2</title>
<polygon fill="lightblue" stroke="black" points="880,-14022 674,-14022 674,-13969 880,-13969 880,-14022"/>
<text text-anchor="middle" x="777" y="-14006.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="777" y="-13991.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="777" y="-13976.8" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<!-- layer_5_gelu&#45;&gt;layer_5_ffn2 -->
<g id="edge135" class="edge">
<title>layer_5_gelu&#45;&gt;layer_5_ffn2</title>
<path fill="none" stroke="black" d="M775.59,-14057.87C775.77,-14049.89 775.98,-14040.93 776.18,-14032.38"/>
<polygon fill="black" stroke="black" points="779.68,-14032.33 776.41,-14022.25 772.68,-14032.17 779.68,-14032.33"/>
</g>
<!-- layer_5_ffn2&#45;&gt;layer_5_add -->
<g id="edge137" class="edge">
<title>layer_5_ffn2&#45;&gt;layer_5_add</title>
<path fill="none" stroke="black" d="M796.74,-13968.87C803.36,-13960.27 810.85,-13950.55 817.88,-13941.42"/>
<polygon fill="black" stroke="black" points="820.84,-13943.31 824.17,-13933.25 815.3,-13939.04 820.84,-13943.31"/>
</g>
<!-- comm_5_6 -->
<g id="node115" class="node">
<title>comm_5_6</title>
<polygon fill="yellow" stroke="black" points="1057.64,-13844 717.79,-13844 630.36,-13738 970.21,-13738 1057.64,-13844"/>
<text text-anchor="middle" x="844" y="-13802.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="844" y="-13787.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="844" y="-13772.3" font-family="Times,serif" font-size="14.00">GPU 5 → GPU 6</text>
</g>
<!-- layer_5_add&#45;&gt;comm_5_6 -->
<g id="edge138" class="edge">
<title>layer_5_add&#45;&gt;comm_5_6</title>
<path fill="none" stroke="black" d="M844,-13879.75C844,-13872.05 844,-13863.25 844,-13854.27"/>
<polygon fill="black" stroke="black" points="847.5,-13854.1 844,-13844.1 840.5,-13854.1 847.5,-13854.1"/>
</g>
<!-- layer_6_ln1 -->
<g id="node116" class="node">
<title>layer_6_ln1</title>
<polygon fill="lightcoral" stroke="black" points="882,-13702 676,-13702 676,-13649 882,-13649 882,-13702"/>
<text text-anchor="middle" x="779" y="-13686.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="779" y="-13671.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="779" y="-13656.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- comm_5_6&#45;&gt;layer_6_ln1 -->
<g id="edge139" class="edge">
<title>comm_5_6&#45;&gt;layer_6_ln1</title>
<path fill="none" stroke="black" d="M814.16,-13737.9C808.92,-13728.74 803.58,-13719.42 798.7,-13710.9"/>
<polygon fill="black" stroke="black" points="801.62,-13708.95 793.61,-13702.01 795.54,-13712.43 801.62,-13708.95"/>
</g>
<!-- layer_6_add1 -->
<g id="node128" class="node">
<title>layer_6_add1</title>
<polygon fill="lightgreen" stroke="black" points="1059,-12990 853,-12990 853,-12937 1059,-12937 1059,-12990"/>
<text text-anchor="middle" x="956" y="-12974.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="956" y="-12959.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="956" y="-12944.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- comm_5_6&#45;&gt;layer_6_add1 -->
<g id="edge153" class="edge">
<title>comm_5_6&#45;&gt;layer_6_add1</title>
<path fill="none" stroke="black" d="M928.99,-13737.8C975.6,-13702.08 1024,-13649.94 1024,-13587.5 1024,-13587.5 1024,-13587.5 1024,-13140.5 1024,-13088.76 1023.95,-13073.3 1003,-13026 998.71,-13016.32 992.61,-13006.77 986.21,-12998.19"/>
<polygon fill="black" stroke="black" points="988.96,-12996.01 980.05,-12990.28 983.44,-13000.32 988.96,-12996.01"/>
</g>
<!-- layer_6_q_proj -->
<g id="node117" class="node">
<title>layer_6_q_proj</title>
<polygon fill="lightblue" stroke="black" points="542,-13613 336,-13613 336,-13560 542,-13560 542,-13613"/>
<text text-anchor="middle" x="439" y="-13597.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="439" y="-13582.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="439" y="-13567.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_q_proj -->
<g id="edge140" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_q_proj</title>
<path fill="none" stroke="black" d="M679.29,-13648.98C638.2,-13638.47 590.47,-13626.26 548.43,-13615.5"/>
<polygon fill="black" stroke="black" points="549.27,-13612.1 538.71,-13613.01 547.53,-13618.88 549.27,-13612.1"/>
</g>
<!-- layer_6_k_proj -->
<g id="node118" class="node">
<title>layer_6_k_proj</title>
<polygon fill="lightblue" stroke="black" points="770,-13613 564,-13613 564,-13560 770,-13560 770,-13613"/>
<text text-anchor="middle" x="667" y="-13597.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="667" y="-13582.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="667" y="-13567.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_k_proj -->
<g id="edge141" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_k_proj</title>
<path fill="none" stroke="black" d="M746,-13648.87C734.15,-13639.66 720.62,-13629.15 708.16,-13619.47"/>
<polygon fill="black" stroke="black" points="710.19,-13616.62 700.15,-13613.25 705.9,-13622.15 710.19,-13616.62"/>
</g>
<!-- layer_6_v_proj -->
<g id="node119" class="node">
<title>layer_6_v_proj</title>
<polygon fill="lightblue" stroke="black" points="994,-13613 788,-13613 788,-13560 994,-13560 994,-13613"/>
<text text-anchor="middle" x="891" y="-13597.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="891" y="-13582.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="891" y="-13567.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln1&#45;&gt;layer_6_v_proj -->
<g id="edge142" class="edge">
<title>layer_6_ln1&#45;&gt;layer_6_v_proj</title>
<path fill="none" stroke="black" d="M812,-13648.87C823.85,-13639.66 837.38,-13629.15 849.84,-13619.47"/>
<polygon fill="black" stroke="black" points="852.1,-13622.15 857.85,-13613.25 847.81,-13616.62 852.1,-13622.15"/>
</g>
<!-- layer_6_q_reshape -->
<g id="node120" class="node">
<title>layer_6_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="542,-13524 318,-13524 318,-13471 542,-13471 542,-13524"/>
<text text-anchor="middle" x="430" y="-13508.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="430" y="-13493.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="430" y="-13478.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_q_proj&#45;&gt;layer_6_q_reshape -->
<g id="edge143" class="edge">
<title>layer_6_q_proj&#45;&gt;layer_6_q_reshape</title>
<path fill="none" stroke="black" d="M436.35,-13559.87C435.52,-13551.89 434.6,-13542.93 433.71,-13534.38"/>
<polygon fill="black" stroke="black" points="437.17,-13533.84 432.66,-13524.25 430.21,-13534.56 437.17,-13533.84"/>
</g>
<!-- layer_6_k_reshape -->
<g id="node121" class="node">
<title>layer_6_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="784,-13524 560,-13524 560,-13471 784,-13471 784,-13524"/>
<text text-anchor="middle" x="672" y="-13508.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="672" y="-13493.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="672" y="-13478.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_k_proj&#45;&gt;layer_6_k_reshape -->
<g id="edge144" class="edge">
<title>layer_6_k_proj&#45;&gt;layer_6_k_reshape</title>
<path fill="none" stroke="black" d="M668.47,-13559.87C668.93,-13551.89 669.45,-13542.93 669.94,-13534.38"/>
<polygon fill="black" stroke="black" points="673.44,-13534.43 670.52,-13524.25 666.45,-13534.03 673.44,-13534.43"/>
</g>
<!-- layer_6_v_reshape -->
<g id="node122" class="node">
<title>layer_6_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="996,-13435 772,-13435 772,-13382 996,-13382 996,-13435"/>
<text text-anchor="middle" x="884" y="-13419.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="884" y="-13404.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="884" y="-13389.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_v_proj&#45;&gt;layer_6_v_reshape -->
<g id="edge145" class="edge">
<title>layer_6_v_proj&#45;&gt;layer_6_v_reshape</title>
<path fill="none" stroke="black" d="M889.98,-13559.91C888.78,-13529.67 886.77,-13479.17 885.42,-13445.12"/>
<polygon fill="black" stroke="black" points="888.91,-13444.98 885.02,-13435.12 881.92,-13445.25 888.91,-13444.98"/>
</g>
<!-- layer_6_attn_scores -->
<g id="node123" class="node">
<title>layer_6_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="753.5,-13435 520.5,-13435 520.5,-13382 753.5,-13382 753.5,-13435"/>
<text text-anchor="middle" x="637" y="-13419.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="637" y="-13404.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="637" y="-13389.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_q_reshape&#45;&gt;layer_6_attn_scores -->
<g id="edge146" class="edge">
<title>layer_6_q_reshape&#45;&gt;layer_6_attn_scores</title>
<path fill="none" stroke="black" d="M490.71,-13470.98C514.61,-13460.94 542.22,-13449.34 566.96,-13438.94"/>
<polygon fill="black" stroke="black" points="568.43,-13442.12 576.29,-13435.01 565.72,-13435.66 568.43,-13442.12"/>
</g>
<!-- layer_6_k_reshape&#45;&gt;layer_6_attn_scores -->
<g id="edge147" class="edge">
<title>layer_6_k_reshape&#45;&gt;layer_6_attn_scores</title>
<path fill="none" stroke="black" d="M661.69,-13470.87C658.37,-13462.62 654.64,-13453.34 651.1,-13444.54"/>
<polygon fill="black" stroke="black" points="654.34,-13443.22 647.36,-13435.25 647.84,-13445.83 654.34,-13443.22"/>
</g>
<!-- layer_6_attn_output -->
<g id="node125" class="node">
<title>layer_6_attn_output</title>
<polygon fill="lightblue" stroke="black" points="996,-13257 772,-13257 772,-13204 996,-13204 996,-13257"/>
<text text-anchor="middle" x="884" y="-13241.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="884" y="-13226.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="884" y="-13211.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_v_reshape&#45;&gt;layer_6_attn_output -->
<g id="edge150" class="edge">
<title>layer_6_v_reshape&#45;&gt;layer_6_attn_output</title>
<path fill="none" stroke="black" d="M884,-13381.91C884,-13351.8 884,-13301.61 884,-13267.56"/>
<polygon fill="black" stroke="black" points="887.5,-13267.12 884,-13257.12 880.5,-13267.12 887.5,-13267.12"/>
</g>
<!-- layer_6_attn_weights -->
<g id="node124" class="node">
<title>layer_6_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="804.5,-13346 571.5,-13346 571.5,-13293 804.5,-13293 804.5,-13346"/>
<text text-anchor="middle" x="688" y="-13330.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="688" y="-13315.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="688" y="-13300.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_scores&#45;&gt;layer_6_attn_weights -->
<g id="edge148" class="edge">
<title>layer_6_attn_scores&#45;&gt;layer_6_attn_weights</title>
<path fill="none" stroke="black" d="M652.03,-13381.87C656.96,-13373.45 662.53,-13363.95 667.79,-13354.98"/>
<polygon fill="black" stroke="black" points="670.87,-13356.65 672.91,-13346.25 664.83,-13353.11 670.87,-13356.65"/>
</g>
<!-- layer_6_attn_weights&#45;&gt;layer_6_attn_output -->
<g id="edge149" class="edge">
<title>layer_6_attn_weights&#45;&gt;layer_6_attn_output</title>
<path fill="none" stroke="black" d="M745.48,-13292.98C768.02,-13282.98 794.03,-13271.44 817.38,-13261.07"/>
<polygon fill="black" stroke="black" points="818.8,-13264.27 826.52,-13257.01 815.96,-13257.87 818.8,-13264.27"/>
</g>
<!-- layer_6_attn_reshape -->
<g id="node126" class="node">
<title>layer_6_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="991,-13168 785,-13168 785,-13115 991,-13115 991,-13168"/>
<text text-anchor="middle" x="888" y="-13152.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="888" y="-13137.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="888" y="-13122.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_output&#45;&gt;layer_6_attn_reshape -->
<g id="edge151" class="edge">
<title>layer_6_attn_output&#45;&gt;layer_6_attn_reshape</title>
<path fill="none" stroke="black" d="M885.18,-13203.87C885.55,-13195.89 885.96,-13186.93 886.35,-13178.38"/>
<polygon fill="black" stroke="black" points="889.85,-13178.4 886.82,-13168.25 882.86,-13178.08 889.85,-13178.4"/>
</g>
<!-- layer_6_attn_proj -->
<g id="node127" class="node">
<title>layer_6_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="994,-13079 788,-13079 788,-13026 994,-13026 994,-13079"/>
<text text-anchor="middle" x="891" y="-13063.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="891" y="-13048.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="891" y="-13033.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_attn_reshape&#45;&gt;layer_6_attn_proj -->
<g id="edge152" class="edge">
<title>layer_6_attn_reshape&#45;&gt;layer_6_attn_proj</title>
<path fill="none" stroke="black" d="M888.88,-13114.87C889.16,-13106.89 889.47,-13097.93 889.76,-13089.38"/>
<polygon fill="black" stroke="black" points="893.27,-13089.36 890.11,-13079.25 886.27,-13089.12 893.27,-13089.36"/>
</g>
<!-- layer_6_attn_proj&#45;&gt;layer_6_add1 -->
<g id="edge154" class="edge">
<title>layer_6_attn_proj&#45;&gt;layer_6_add1</title>
<path fill="none" stroke="black" d="M910.15,-13025.87C916.57,-13017.27 923.84,-13007.55 930.66,-12998.42"/>
<polygon fill="black" stroke="black" points="933.58,-13000.36 936.76,-12990.25 927.97,-12996.17 933.58,-13000.36"/>
</g>
<!-- layer_6_ln2 -->
<g id="node129" class="node">
<title>layer_6_ln2</title>
<polygon fill="lightcoral" stroke="black" points="991,-12901 785,-12901 785,-12848 991,-12848 991,-12901"/>
<text text-anchor="middle" x="888" y="-12885.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="888" y="-12870.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="888" y="-12855.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_add1&#45;&gt;layer_6_ln2 -->
<g id="edge155" class="edge">
<title>layer_6_add1&#45;&gt;layer_6_ln2</title>
<path fill="none" stroke="black" d="M935.97,-12936.87C929.18,-12928.18 921.49,-12918.35 914.29,-12909.14"/>
<polygon fill="black" stroke="black" points="917.04,-12906.97 908.13,-12901.25 911.53,-12911.28 917.04,-12906.97"/>
</g>
<!-- layer_6_add -->
<g id="node133" class="node">
<title>layer_6_add</title>
<polygon fill="lightgreen" stroke="black" points="1057,-12545 851,-12545 851,-12492 1057,-12492 1057,-12545"/>
<text text-anchor="middle" x="954" y="-12529.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="954" y="-12514.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="954" y="-12499.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_add1&#45;&gt;layer_6_add -->
<g id="edge159" class="edge">
<title>layer_6_add1&#45;&gt;layer_6_add</title>
<path fill="none" stroke="black" d="M978.19,-12936.77C986.18,-12926.29 994.56,-12913.67 1000,-12901 1020.44,-12853.38 1022,-12838.32 1022,-12786.5 1022,-12786.5 1022,-12786.5 1022,-12695.5 1022,-12643.76 1021.95,-12628.3 1001,-12581 996.71,-12571.32 990.61,-12561.77 984.21,-12553.19"/>
<polygon fill="black" stroke="black" points="986.96,-12551.01 978.05,-12545.28 981.44,-12555.32 986.96,-12551.01"/>
</g>
<!-- layer_6_ffn1 -->
<g id="node130" class="node">
<title>layer_6_ffn1</title>
<polygon fill="lightblue" stroke="black" points="993.5,-12812 778.5,-12812 778.5,-12759 993.5,-12759 993.5,-12812"/>
<text text-anchor="middle" x="886" y="-12796.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="886" y="-12781.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="886" y="-12766.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ln2&#45;&gt;layer_6_ffn1 -->
<g id="edge156" class="edge">
<title>layer_6_ln2&#45;&gt;layer_6_ffn1</title>
<path fill="none" stroke="black" d="M887.41,-12847.87C887.23,-12839.89 887.02,-12830.93 886.82,-12822.38"/>
<polygon fill="black" stroke="black" points="890.32,-12822.17 886.59,-12812.25 883.32,-12822.33 890.32,-12822.17"/>
</g>
<!-- layer_6_gelu -->
<g id="node131" class="node">
<title>layer_6_gelu</title>
<polygon fill="lightblue" stroke="black" points="993.5,-12723 778.5,-12723 778.5,-12670 993.5,-12670 993.5,-12723"/>
<text text-anchor="middle" x="886" y="-12707.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="886" y="-12692.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="886" y="-12677.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_ffn1&#45;&gt;layer_6_gelu -->
<g id="edge157" class="edge">
<title>layer_6_ffn1&#45;&gt;layer_6_gelu</title>
<path fill="none" stroke="black" d="M886,-12758.87C886,-12750.89 886,-12741.93 886,-12733.38"/>
<polygon fill="black" stroke="black" points="889.5,-12733.25 886,-12723.25 882.5,-12733.25 889.5,-12733.25"/>
</g>
<!-- layer_6_ffn2 -->
<g id="node132" class="node">
<title>layer_6_ffn2</title>
<polygon fill="lightblue" stroke="black" points="992,-12634 786,-12634 786,-12581 992,-12581 992,-12634"/>
<text text-anchor="middle" x="889" y="-12618.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="889" y="-12603.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="889" y="-12588.8" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<!-- layer_6_gelu&#45;&gt;layer_6_ffn2 -->
<g id="edge158" class="edge">
<title>layer_6_gelu&#45;&gt;layer_6_ffn2</title>
<path fill="none" stroke="black" d="M886.88,-12669.87C887.16,-12661.89 887.47,-12652.93 887.76,-12644.38"/>
<polygon fill="black" stroke="black" points="891.27,-12644.36 888.11,-12634.25 884.27,-12644.12 891.27,-12644.36"/>
</g>
<!-- layer_6_ffn2&#45;&gt;layer_6_add -->
<g id="edge160" class="edge">
<title>layer_6_ffn2&#45;&gt;layer_6_add</title>
<path fill="none" stroke="black" d="M908.15,-12580.87C914.57,-12572.27 921.84,-12562.55 928.66,-12553.42"/>
<polygon fill="black" stroke="black" points="931.58,-12555.36 934.76,-12545.25 925.97,-12551.17 931.58,-12555.36"/>
</g>
<!-- comm_6_7 -->
<g id="node134" class="node">
<title>comm_6_7</title>
<polygon fill="yellow" stroke="black" points="1167.64,-12456 827.79,-12456 740.36,-12350 1080.21,-12350 1167.64,-12456"/>
<text text-anchor="middle" x="954" y="-12414.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="954" y="-12399.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="954" y="-12384.3" font-family="Times,serif" font-size="14.00">GPU 6 → GPU 7</text>
</g>
<!-- layer_6_add&#45;&gt;comm_6_7 -->
<g id="edge161" class="edge">
<title>layer_6_add&#45;&gt;comm_6_7</title>
<path fill="none" stroke="black" d="M954,-12491.75C954,-12484.05 954,-12475.25 954,-12466.27"/>
<polygon fill="black" stroke="black" points="957.5,-12466.1 954,-12456.1 950.5,-12466.1 957.5,-12466.1"/>
</g>
<!-- layer_7_ln1 -->
<g id="node135" class="node">
<title>layer_7_ln1</title>
<polygon fill="lightcoral" stroke="black" points="992,-12314 786,-12314 786,-12261 992,-12261 992,-12314"/>
<text text-anchor="middle" x="889" y="-12298.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="889" y="-12283.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="889" y="-12268.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- comm_6_7&#45;&gt;layer_7_ln1 -->
<g id="edge162" class="edge">
<title>comm_6_7&#45;&gt;layer_7_ln1</title>
<path fill="none" stroke="black" d="M924.16,-12349.9C918.92,-12340.74 913.58,-12331.42 908.7,-12322.9"/>
<polygon fill="black" stroke="black" points="911.62,-12320.95 903.61,-12314.01 905.54,-12324.43 911.62,-12320.95"/>
</g>
<!-- layer_7_add1 -->
<g id="node147" class="node">
<title>layer_7_add1</title>
<polygon fill="lightgreen" stroke="black" points="1169,-11602 963,-11602 963,-11549 1169,-11549 1169,-11602"/>
<text text-anchor="middle" x="1066" y="-11586.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1066" y="-11571.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1066" y="-11556.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- comm_6_7&#45;&gt;layer_7_add1 -->
<g id="edge176" class="edge">
<title>comm_6_7&#45;&gt;layer_7_add1</title>
<path fill="none" stroke="black" d="M1038.99,-12349.8C1085.6,-12314.08 1134,-12261.94 1134,-12199.5 1134,-12199.5 1134,-12199.5 1134,-11752.5 1134,-11700.76 1133.95,-11685.3 1113,-11638 1108.71,-11628.32 1102.61,-11618.77 1096.21,-11610.19"/>
<polygon fill="black" stroke="black" points="1098.96,-11608.01 1090.05,-11602.28 1093.44,-11612.32 1098.96,-11608.01"/>
</g>
<!-- layer_7_q_proj -->
<g id="node136" class="node">
<title>layer_7_q_proj</title>
<polygon fill="lightblue" stroke="black" points="652,-12225 446,-12225 446,-12172 652,-12172 652,-12225"/>
<text text-anchor="middle" x="549" y="-12209.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="549" y="-12194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="549" y="-12179.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_q_proj -->
<g id="edge163" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_q_proj</title>
<path fill="none" stroke="black" d="M789.29,-12260.98C748.2,-12250.47 700.47,-12238.26 658.43,-12227.5"/>
<polygon fill="black" stroke="black" points="659.27,-12224.1 648.71,-12225.01 657.53,-12230.88 659.27,-12224.1"/>
</g>
<!-- layer_7_k_proj -->
<g id="node137" class="node">
<title>layer_7_k_proj</title>
<polygon fill="lightblue" stroke="black" points="880,-12225 674,-12225 674,-12172 880,-12172 880,-12225"/>
<text text-anchor="middle" x="777" y="-12209.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="777" y="-12194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="777" y="-12179.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_k_proj -->
<g id="edge164" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_k_proj</title>
<path fill="none" stroke="black" d="M856,-12260.87C844.15,-12251.66 830.62,-12241.15 818.16,-12231.47"/>
<polygon fill="black" stroke="black" points="820.19,-12228.62 810.15,-12225.25 815.9,-12234.15 820.19,-12228.62"/>
</g>
<!-- layer_7_v_proj -->
<g id="node138" class="node">
<title>layer_7_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1104,-12225 898,-12225 898,-12172 1104,-12172 1104,-12225"/>
<text text-anchor="middle" x="1001" y="-12209.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1001" y="-12194.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-12179.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln1&#45;&gt;layer_7_v_proj -->
<g id="edge165" class="edge">
<title>layer_7_ln1&#45;&gt;layer_7_v_proj</title>
<path fill="none" stroke="black" d="M922,-12260.87C933.85,-12251.66 947.38,-12241.15 959.84,-12231.47"/>
<polygon fill="black" stroke="black" points="962.1,-12234.15 967.85,-12225.25 957.81,-12228.62 962.1,-12234.15"/>
</g>
<!-- layer_7_q_reshape -->
<g id="node139" class="node">
<title>layer_7_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="652,-12136 428,-12136 428,-12083 652,-12083 652,-12136"/>
<text text-anchor="middle" x="540" y="-12120.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="540" y="-12105.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="540" y="-12090.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_q_proj&#45;&gt;layer_7_q_reshape -->
<g id="edge166" class="edge">
<title>layer_7_q_proj&#45;&gt;layer_7_q_reshape</title>
<path fill="none" stroke="black" d="M546.35,-12171.87C545.52,-12163.89 544.6,-12154.93 543.71,-12146.38"/>
<polygon fill="black" stroke="black" points="547.17,-12145.84 542.66,-12136.25 540.21,-12146.56 547.17,-12145.84"/>
</g>
<!-- layer_7_k_reshape -->
<g id="node140" class="node">
<title>layer_7_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="894,-12136 670,-12136 670,-12083 894,-12083 894,-12136"/>
<text text-anchor="middle" x="782" y="-12120.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="782" y="-12105.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="782" y="-12090.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_k_proj&#45;&gt;layer_7_k_reshape -->
<g id="edge167" class="edge">
<title>layer_7_k_proj&#45;&gt;layer_7_k_reshape</title>
<path fill="none" stroke="black" d="M778.47,-12171.87C778.93,-12163.89 779.45,-12154.93 779.94,-12146.38"/>
<polygon fill="black" stroke="black" points="783.44,-12146.43 780.52,-12136.25 776.45,-12146.03 783.44,-12146.43"/>
</g>
<!-- layer_7_v_reshape -->
<g id="node141" class="node">
<title>layer_7_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1106,-12047 882,-12047 882,-11994 1106,-11994 1106,-12047"/>
<text text-anchor="middle" x="994" y="-12031.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="994" y="-12016.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="994" y="-12001.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_v_proj&#45;&gt;layer_7_v_reshape -->
<g id="edge168" class="edge">
<title>layer_7_v_proj&#45;&gt;layer_7_v_reshape</title>
<path fill="none" stroke="black" d="M999.98,-12171.91C998.78,-12141.67 996.77,-12091.17 995.42,-12057.12"/>
<polygon fill="black" stroke="black" points="998.91,-12056.98 995.02,-12047.12 991.92,-12057.25 998.91,-12056.98"/>
</g>
<!-- layer_7_attn_scores -->
<g id="node142" class="node">
<title>layer_7_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="863.5,-12047 630.5,-12047 630.5,-11994 863.5,-11994 863.5,-12047"/>
<text text-anchor="middle" x="747" y="-12031.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="747" y="-12016.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="747" y="-12001.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_q_reshape&#45;&gt;layer_7_attn_scores -->
<g id="edge169" class="edge">
<title>layer_7_q_reshape&#45;&gt;layer_7_attn_scores</title>
<path fill="none" stroke="black" d="M600.71,-12082.98C624.61,-12072.94 652.22,-12061.34 676.96,-12050.94"/>
<polygon fill="black" stroke="black" points="678.43,-12054.12 686.29,-12047.01 675.72,-12047.66 678.43,-12054.12"/>
</g>
<!-- layer_7_k_reshape&#45;&gt;layer_7_attn_scores -->
<g id="edge170" class="edge">
<title>layer_7_k_reshape&#45;&gt;layer_7_attn_scores</title>
<path fill="none" stroke="black" d="M771.69,-12082.87C768.37,-12074.62 764.64,-12065.34 761.1,-12056.54"/>
<polygon fill="black" stroke="black" points="764.34,-12055.22 757.36,-12047.25 757.84,-12057.83 764.34,-12055.22"/>
</g>
<!-- layer_7_attn_output -->
<g id="node144" class="node">
<title>layer_7_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1106,-11869 882,-11869 882,-11816 1106,-11816 1106,-11869"/>
<text text-anchor="middle" x="994" y="-11853.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="994" y="-11838.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="994" y="-11823.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_v_reshape&#45;&gt;layer_7_attn_output -->
<g id="edge173" class="edge">
<title>layer_7_v_reshape&#45;&gt;layer_7_attn_output</title>
<path fill="none" stroke="black" d="M994,-11993.91C994,-11963.8 994,-11913.61 994,-11879.56"/>
<polygon fill="black" stroke="black" points="997.5,-11879.12 994,-11869.12 990.5,-11879.12 997.5,-11879.12"/>
</g>
<!-- layer_7_attn_weights -->
<g id="node143" class="node">
<title>layer_7_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="914.5,-11958 681.5,-11958 681.5,-11905 914.5,-11905 914.5,-11958"/>
<text text-anchor="middle" x="798" y="-11942.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="798" y="-11927.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="798" y="-11912.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_scores&#45;&gt;layer_7_attn_weights -->
<g id="edge171" class="edge">
<title>layer_7_attn_scores&#45;&gt;layer_7_attn_weights</title>
<path fill="none" stroke="black" d="M762.03,-11993.87C766.96,-11985.45 772.53,-11975.95 777.79,-11966.98"/>
<polygon fill="black" stroke="black" points="780.87,-11968.65 782.91,-11958.25 774.83,-11965.11 780.87,-11968.65"/>
</g>
<!-- layer_7_attn_weights&#45;&gt;layer_7_attn_output -->
<g id="edge172" class="edge">
<title>layer_7_attn_weights&#45;&gt;layer_7_attn_output</title>
<path fill="none" stroke="black" d="M855.48,-11904.98C878.02,-11894.98 904.03,-11883.44 927.38,-11873.07"/>
<polygon fill="black" stroke="black" points="928.8,-11876.27 936.52,-11869.01 925.96,-11869.87 928.8,-11876.27"/>
</g>
<!-- layer_7_attn_reshape -->
<g id="node145" class="node">
<title>layer_7_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1101,-11780 895,-11780 895,-11727 1101,-11727 1101,-11780"/>
<text text-anchor="middle" x="998" y="-11764.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="998" y="-11749.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="998" y="-11734.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_output&#45;&gt;layer_7_attn_reshape -->
<g id="edge174" class="edge">
<title>layer_7_attn_output&#45;&gt;layer_7_attn_reshape</title>
<path fill="none" stroke="black" d="M995.18,-11815.87C995.55,-11807.89 995.96,-11798.93 996.35,-11790.38"/>
<polygon fill="black" stroke="black" points="999.85,-11790.4 996.82,-11780.25 992.86,-11790.08 999.85,-11790.4"/>
</g>
<!-- layer_7_attn_proj -->
<g id="node146" class="node">
<title>layer_7_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1104,-11691 898,-11691 898,-11638 1104,-11638 1104,-11691"/>
<text text-anchor="middle" x="1001" y="-11675.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1001" y="-11660.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-11645.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_attn_reshape&#45;&gt;layer_7_attn_proj -->
<g id="edge175" class="edge">
<title>layer_7_attn_reshape&#45;&gt;layer_7_attn_proj</title>
<path fill="none" stroke="black" d="M998.88,-11726.87C999.16,-11718.89 999.47,-11709.93 999.76,-11701.38"/>
<polygon fill="black" stroke="black" points="1003.27,-11701.36 1000.11,-11691.25 996.27,-11701.12 1003.27,-11701.36"/>
</g>
<!-- layer_7_attn_proj&#45;&gt;layer_7_add1 -->
<g id="edge177" class="edge">
<title>layer_7_attn_proj&#45;&gt;layer_7_add1</title>
<path fill="none" stroke="black" d="M1020.15,-11637.87C1026.57,-11629.27 1033.84,-11619.55 1040.66,-11610.42"/>
<polygon fill="black" stroke="black" points="1043.58,-11612.36 1046.76,-11602.25 1037.97,-11608.17 1043.58,-11612.36"/>
</g>
<!-- layer_7_ln2 -->
<g id="node148" class="node">
<title>layer_7_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1101,-11513 895,-11513 895,-11460 1101,-11460 1101,-11513"/>
<text text-anchor="middle" x="998" y="-11497.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="998" y="-11482.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="998" y="-11467.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_add1&#45;&gt;layer_7_ln2 -->
<g id="edge178" class="edge">
<title>layer_7_add1&#45;&gt;layer_7_ln2</title>
<path fill="none" stroke="black" d="M1045.97,-11548.87C1039.18,-11540.18 1031.49,-11530.35 1024.29,-11521.14"/>
<polygon fill="black" stroke="black" points="1027.04,-11518.97 1018.13,-11513.25 1021.53,-11523.28 1027.04,-11518.97"/>
</g>
<!-- layer_7_add -->
<g id="node152" class="node">
<title>layer_7_add</title>
<polygon fill="lightgreen" stroke="black" points="1167,-11157 961,-11157 961,-11104 1167,-11104 1167,-11157"/>
<text text-anchor="middle" x="1064" y="-11141.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1064" y="-11126.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1064" y="-11111.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_add1&#45;&gt;layer_7_add -->
<g id="edge182" class="edge">
<title>layer_7_add1&#45;&gt;layer_7_add</title>
<path fill="none" stroke="black" d="M1088.19,-11548.77C1096.18,-11538.29 1104.56,-11525.67 1110,-11513 1130.44,-11465.38 1132,-11450.32 1132,-11398.5 1132,-11398.5 1132,-11398.5 1132,-11307.5 1132,-11255.76 1131.95,-11240.3 1111,-11193 1106.71,-11183.32 1100.61,-11173.77 1094.21,-11165.19"/>
<polygon fill="black" stroke="black" points="1096.96,-11163.01 1088.05,-11157.28 1091.44,-11167.32 1096.96,-11163.01"/>
</g>
<!-- layer_7_ffn1 -->
<g id="node149" class="node">
<title>layer_7_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1103.5,-11424 888.5,-11424 888.5,-11371 1103.5,-11371 1103.5,-11424"/>
<text text-anchor="middle" x="996" y="-11408.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="996" y="-11393.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="996" y="-11378.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ln2&#45;&gt;layer_7_ffn1 -->
<g id="edge179" class="edge">
<title>layer_7_ln2&#45;&gt;layer_7_ffn1</title>
<path fill="none" stroke="black" d="M997.41,-11459.87C997.23,-11451.89 997.02,-11442.93 996.82,-11434.38"/>
<polygon fill="black" stroke="black" points="1000.32,-11434.17 996.59,-11424.25 993.32,-11434.33 1000.32,-11434.17"/>
</g>
<!-- layer_7_gelu -->
<g id="node150" class="node">
<title>layer_7_gelu</title>
<polygon fill="lightblue" stroke="black" points="1103.5,-11335 888.5,-11335 888.5,-11282 1103.5,-11282 1103.5,-11335"/>
<text text-anchor="middle" x="996" y="-11319.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="996" y="-11304.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="996" y="-11289.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_ffn1&#45;&gt;layer_7_gelu -->
<g id="edge180" class="edge">
<title>layer_7_ffn1&#45;&gt;layer_7_gelu</title>
<path fill="none" stroke="black" d="M996,-11370.87C996,-11362.89 996,-11353.93 996,-11345.38"/>
<polygon fill="black" stroke="black" points="999.5,-11345.25 996,-11335.25 992.5,-11345.25 999.5,-11345.25"/>
</g>
<!-- layer_7_ffn2 -->
<g id="node151" class="node">
<title>layer_7_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1102,-11246 896,-11246 896,-11193 1102,-11193 1102,-11246"/>
<text text-anchor="middle" x="999" y="-11230.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="999" y="-11215.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="999" y="-11200.8" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<!-- layer_7_gelu&#45;&gt;layer_7_ffn2 -->
<g id="edge181" class="edge">
<title>layer_7_gelu&#45;&gt;layer_7_ffn2</title>
<path fill="none" stroke="black" d="M996.88,-11281.87C997.16,-11273.89 997.47,-11264.93 997.76,-11256.38"/>
<polygon fill="black" stroke="black" points="1001.27,-11256.36 998.11,-11246.25 994.27,-11256.12 1001.27,-11256.36"/>
</g>
<!-- layer_7_ffn2&#45;&gt;layer_7_add -->
<g id="edge183" class="edge">
<title>layer_7_ffn2&#45;&gt;layer_7_add</title>
<path fill="none" stroke="black" d="M1018.15,-11192.87C1024.57,-11184.27 1031.84,-11174.55 1038.66,-11165.42"/>
<polygon fill="black" stroke="black" points="1041.58,-11167.36 1044.76,-11157.25 1035.97,-11163.17 1041.58,-11167.36"/>
</g>
<!-- comm_7_8 -->
<g id="node153" class="node">
<title>comm_7_8</title>
<polygon fill="yellow" stroke="black" points="1277.64,-11068 937.79,-11068 850.36,-10962 1190.21,-10962 1277.64,-11068"/>
<text text-anchor="middle" x="1064" y="-11026.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1064" y="-11011.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1064" y="-10996.3" font-family="Times,serif" font-size="14.00">GPU 7 → GPU 8</text>
</g>
<!-- layer_7_add&#45;&gt;comm_7_8 -->
<g id="edge184" class="edge">
<title>layer_7_add&#45;&gt;comm_7_8</title>
<path fill="none" stroke="black" d="M1064,-11103.75C1064,-11096.05 1064,-11087.25 1064,-11078.27"/>
<polygon fill="black" stroke="black" points="1067.5,-11078.1 1064,-11068.1 1060.5,-11078.1 1067.5,-11078.1"/>
</g>
<!-- layer_8_ln1 -->
<g id="node154" class="node">
<title>layer_8_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1102,-10926 896,-10926 896,-10873 1102,-10873 1102,-10926"/>
<text text-anchor="middle" x="999" y="-10910.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="999" y="-10895.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="999" y="-10880.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- comm_7_8&#45;&gt;layer_8_ln1 -->
<g id="edge185" class="edge">
<title>comm_7_8&#45;&gt;layer_8_ln1</title>
<path fill="none" stroke="black" d="M1034.16,-10961.9C1028.92,-10952.74 1023.58,-10943.42 1018.7,-10934.9"/>
<polygon fill="black" stroke="black" points="1021.62,-10932.95 1013.61,-10926.01 1015.54,-10936.43 1021.62,-10932.95"/>
</g>
<!-- layer_8_add1 -->
<g id="node166" class="node">
<title>layer_8_add1</title>
<polygon fill="lightgreen" stroke="black" points="1280,-10214 1074,-10214 1074,-10161 1280,-10161 1280,-10214"/>
<text text-anchor="middle" x="1177" y="-10198.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1177" y="-10183.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1177" y="-10168.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- comm_7_8&#45;&gt;layer_8_add1 -->
<g id="edge199" class="edge">
<title>comm_7_8&#45;&gt;layer_8_add1</title>
<path fill="none" stroke="black" d="M1148.99,-10961.8C1195.6,-10926.08 1244,-10873.94 1244,-10811.5 1244,-10811.5 1244,-10811.5 1244,-10364.5 1244,-10312.68 1242.69,-10297.51 1222,-10250 1217.84,-10240.45 1211.98,-10230.95 1205.86,-10222.38"/>
<polygon fill="black" stroke="black" points="1208.5,-10220.07 1199.71,-10214.16 1202.89,-10224.26 1208.5,-10220.07"/>
</g>
<!-- layer_8_q_proj -->
<g id="node155" class="node">
<title>layer_8_q_proj</title>
<polygon fill="lightblue" stroke="black" points="762,-10837 556,-10837 556,-10784 762,-10784 762,-10837"/>
<text text-anchor="middle" x="659" y="-10821.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="659" y="-10806.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="659" y="-10791.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_q_proj -->
<g id="edge186" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_q_proj</title>
<path fill="none" stroke="black" d="M899.29,-10872.98C858.2,-10862.47 810.47,-10850.26 768.43,-10839.5"/>
<polygon fill="black" stroke="black" points="769.27,-10836.1 758.71,-10837.01 767.53,-10842.88 769.27,-10836.1"/>
</g>
<!-- layer_8_k_proj -->
<g id="node156" class="node">
<title>layer_8_k_proj</title>
<polygon fill="lightblue" stroke="black" points="990,-10837 784,-10837 784,-10784 990,-10784 990,-10837"/>
<text text-anchor="middle" x="887" y="-10821.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="887" y="-10806.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="887" y="-10791.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_k_proj -->
<g id="edge187" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_k_proj</title>
<path fill="none" stroke="black" d="M966,-10872.87C954.15,-10863.66 940.62,-10853.15 928.16,-10843.47"/>
<polygon fill="black" stroke="black" points="930.19,-10840.62 920.15,-10837.25 925.9,-10846.15 930.19,-10840.62"/>
</g>
<!-- layer_8_v_proj -->
<g id="node157" class="node">
<title>layer_8_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1214,-10837 1008,-10837 1008,-10784 1214,-10784 1214,-10837"/>
<text text-anchor="middle" x="1111" y="-10821.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1111" y="-10806.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1111" y="-10791.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln1&#45;&gt;layer_8_v_proj -->
<g id="edge188" class="edge">
<title>layer_8_ln1&#45;&gt;layer_8_v_proj</title>
<path fill="none" stroke="black" d="M1032,-10872.87C1043.85,-10863.66 1057.38,-10853.15 1069.84,-10843.47"/>
<polygon fill="black" stroke="black" points="1072.1,-10846.15 1077.85,-10837.25 1067.81,-10840.62 1072.1,-10846.15"/>
</g>
<!-- layer_8_q_reshape -->
<g id="node158" class="node">
<title>layer_8_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="762,-10748 538,-10748 538,-10695 762,-10695 762,-10748"/>
<text text-anchor="middle" x="650" y="-10732.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="650" y="-10717.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="650" y="-10702.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_q_proj&#45;&gt;layer_8_q_reshape -->
<g id="edge189" class="edge">
<title>layer_8_q_proj&#45;&gt;layer_8_q_reshape</title>
<path fill="none" stroke="black" d="M656.35,-10783.87C655.52,-10775.89 654.6,-10766.93 653.71,-10758.38"/>
<polygon fill="black" stroke="black" points="657.17,-10757.84 652.66,-10748.25 650.21,-10758.56 657.17,-10757.84"/>
</g>
<!-- layer_8_k_reshape -->
<g id="node159" class="node">
<title>layer_8_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1004,-10748 780,-10748 780,-10695 1004,-10695 1004,-10748"/>
<text text-anchor="middle" x="892" y="-10732.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="892" y="-10717.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="892" y="-10702.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_k_proj&#45;&gt;layer_8_k_reshape -->
<g id="edge190" class="edge">
<title>layer_8_k_proj&#45;&gt;layer_8_k_reshape</title>
<path fill="none" stroke="black" d="M888.47,-10783.87C888.93,-10775.89 889.45,-10766.93 889.94,-10758.38"/>
<polygon fill="black" stroke="black" points="893.44,-10758.43 890.52,-10748.25 886.45,-10758.03 893.44,-10758.43"/>
</g>
<!-- layer_8_v_reshape -->
<g id="node160" class="node">
<title>layer_8_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1216,-10659 992,-10659 992,-10606 1216,-10606 1216,-10659"/>
<text text-anchor="middle" x="1104" y="-10643.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1104" y="-10628.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1104" y="-10613.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_v_proj&#45;&gt;layer_8_v_reshape -->
<g id="edge191" class="edge">
<title>layer_8_v_proj&#45;&gt;layer_8_v_reshape</title>
<path fill="none" stroke="black" d="M1109.98,-10783.91C1108.78,-10753.67 1106.77,-10703.17 1105.42,-10669.12"/>
<polygon fill="black" stroke="black" points="1108.91,-10668.98 1105.02,-10659.12 1101.92,-10669.25 1108.91,-10668.98"/>
</g>
<!-- layer_8_attn_scores -->
<g id="node161" class="node">
<title>layer_8_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="973.5,-10659 740.5,-10659 740.5,-10606 973.5,-10606 973.5,-10659"/>
<text text-anchor="middle" x="857" y="-10643.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="857" y="-10628.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="857" y="-10613.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_q_reshape&#45;&gt;layer_8_attn_scores -->
<g id="edge192" class="edge">
<title>layer_8_q_reshape&#45;&gt;layer_8_attn_scores</title>
<path fill="none" stroke="black" d="M710.71,-10694.98C734.61,-10684.94 762.22,-10673.34 786.96,-10662.94"/>
<polygon fill="black" stroke="black" points="788.43,-10666.12 796.29,-10659.01 785.72,-10659.66 788.43,-10666.12"/>
</g>
<!-- layer_8_k_reshape&#45;&gt;layer_8_attn_scores -->
<g id="edge193" class="edge">
<title>layer_8_k_reshape&#45;&gt;layer_8_attn_scores</title>
<path fill="none" stroke="black" d="M881.69,-10694.87C878.37,-10686.62 874.64,-10677.34 871.1,-10668.54"/>
<polygon fill="black" stroke="black" points="874.34,-10667.22 867.36,-10659.25 867.84,-10669.83 874.34,-10667.22"/>
</g>
<!-- layer_8_attn_output -->
<g id="node163" class="node">
<title>layer_8_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1216,-10481 992,-10481 992,-10428 1216,-10428 1216,-10481"/>
<text text-anchor="middle" x="1104" y="-10465.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1104" y="-10450.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1104" y="-10435.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_v_reshape&#45;&gt;layer_8_attn_output -->
<g id="edge196" class="edge">
<title>layer_8_v_reshape&#45;&gt;layer_8_attn_output</title>
<path fill="none" stroke="black" d="M1104,-10605.91C1104,-10575.8 1104,-10525.61 1104,-10491.56"/>
<polygon fill="black" stroke="black" points="1107.5,-10491.12 1104,-10481.12 1100.5,-10491.12 1107.5,-10491.12"/>
</g>
<!-- layer_8_attn_weights -->
<g id="node162" class="node">
<title>layer_8_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1024.5,-10570 791.5,-10570 791.5,-10517 1024.5,-10517 1024.5,-10570"/>
<text text-anchor="middle" x="908" y="-10554.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="908" y="-10539.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="908" y="-10524.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_scores&#45;&gt;layer_8_attn_weights -->
<g id="edge194" class="edge">
<title>layer_8_attn_scores&#45;&gt;layer_8_attn_weights</title>
<path fill="none" stroke="black" d="M872.03,-10605.87C876.96,-10597.45 882.53,-10587.95 887.79,-10578.98"/>
<polygon fill="black" stroke="black" points="890.87,-10580.65 892.91,-10570.25 884.83,-10577.11 890.87,-10580.65"/>
</g>
<!-- layer_8_attn_weights&#45;&gt;layer_8_attn_output -->
<g id="edge195" class="edge">
<title>layer_8_attn_weights&#45;&gt;layer_8_attn_output</title>
<path fill="none" stroke="black" d="M965.48,-10516.98C988.02,-10506.98 1014.03,-10495.44 1037.38,-10485.07"/>
<polygon fill="black" stroke="black" points="1038.8,-10488.27 1046.52,-10481.01 1035.96,-10481.87 1038.8,-10488.27"/>
</g>
<!-- layer_8_attn_reshape -->
<g id="node164" class="node">
<title>layer_8_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1211,-10392 1005,-10392 1005,-10339 1211,-10339 1211,-10392"/>
<text text-anchor="middle" x="1108" y="-10376.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1108" y="-10361.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1108" y="-10346.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_output&#45;&gt;layer_8_attn_reshape -->
<g id="edge197" class="edge">
<title>layer_8_attn_output&#45;&gt;layer_8_attn_reshape</title>
<path fill="none" stroke="black" d="M1105.18,-10427.87C1105.55,-10419.89 1105.96,-10410.93 1106.35,-10402.38"/>
<polygon fill="black" stroke="black" points="1109.85,-10402.4 1106.82,-10392.25 1102.86,-10402.08 1109.85,-10402.4"/>
</g>
<!-- layer_8_attn_proj -->
<g id="node165" class="node">
<title>layer_8_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1213,-10303 1007,-10303 1007,-10250 1213,-10250 1213,-10303"/>
<text text-anchor="middle" x="1110" y="-10287.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1110" y="-10272.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1110" y="-10257.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_attn_reshape&#45;&gt;layer_8_attn_proj -->
<g id="edge198" class="edge">
<title>layer_8_attn_reshape&#45;&gt;layer_8_attn_proj</title>
<path fill="none" stroke="black" d="M1108.59,-10338.87C1108.77,-10330.89 1108.98,-10321.93 1109.18,-10313.38"/>
<polygon fill="black" stroke="black" points="1112.68,-10313.33 1109.41,-10303.25 1105.68,-10313.17 1112.68,-10313.33"/>
</g>
<!-- layer_8_attn_proj&#45;&gt;layer_8_add1 -->
<g id="edge200" class="edge">
<title>layer_8_attn_proj&#45;&gt;layer_8_add1</title>
<path fill="none" stroke="black" d="M1129.74,-10249.87C1136.36,-10241.27 1143.85,-10231.55 1150.88,-10222.42"/>
<polygon fill="black" stroke="black" points="1153.84,-10224.31 1157.17,-10214.25 1148.3,-10220.04 1153.84,-10224.31"/>
</g>
<!-- layer_8_ln2 -->
<g id="node167" class="node">
<title>layer_8_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1215,-10125 1009,-10125 1009,-10072 1215,-10072 1215,-10125"/>
<text text-anchor="middle" x="1112" y="-10109.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1112" y="-10094.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1112" y="-10079.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_add1&#45;&gt;layer_8_ln2 -->
<g id="edge201" class="edge">
<title>layer_8_add1&#45;&gt;layer_8_ln2</title>
<path fill="none" stroke="black" d="M1157.85,-10160.87C1151.43,-10152.27 1144.16,-10142.55 1137.34,-10133.42"/>
<polygon fill="black" stroke="black" points="1140.03,-10131.17 1131.24,-10125.25 1134.42,-10135.36 1140.03,-10131.17"/>
</g>
<!-- layer_8_add -->
<g id="node171" class="node">
<title>layer_8_add</title>
<polygon fill="lightgreen" stroke="black" points="1281,-9769 1075,-9769 1075,-9716 1281,-9716 1281,-9769"/>
<text text-anchor="middle" x="1178" y="-9753.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1178" y="-9738.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1178" y="-9723.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_add1&#45;&gt;layer_8_add -->
<g id="edge205" class="edge">
<title>layer_8_add1&#45;&gt;layer_8_add</title>
<path fill="none" stroke="black" d="M1201.05,-10160.72C1209.52,-10150.32 1218.34,-10137.78 1224,-10125 1244.95,-10077.7 1245,-10062.24 1245,-10010.5 1245,-10010.5 1245,-10010.5 1245,-9919.5 1245,-9867.68 1243.69,-9852.51 1223,-9805 1218.84,-9795.45 1212.98,-9785.95 1206.86,-9777.38"/>
<polygon fill="black" stroke="black" points="1209.5,-9775.07 1200.71,-9769.16 1203.89,-9779.26 1209.5,-9775.07"/>
</g>
<!-- layer_8_ffn1 -->
<g id="node168" class="node">
<title>layer_8_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1216.5,-10036 1001.5,-10036 1001.5,-9983 1216.5,-9983 1216.5,-10036"/>
<text text-anchor="middle" x="1109" y="-10020.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1109" y="-10005.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1109" y="-9990.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ln2&#45;&gt;layer_8_ffn1 -->
<g id="edge202" class="edge">
<title>layer_8_ln2&#45;&gt;layer_8_ffn1</title>
<path fill="none" stroke="black" d="M1111.12,-10071.87C1110.84,-10063.89 1110.53,-10054.93 1110.24,-10046.38"/>
<polygon fill="black" stroke="black" points="1113.73,-10046.12 1109.89,-10036.25 1106.73,-10046.36 1113.73,-10046.12"/>
</g>
<!-- layer_8_gelu -->
<g id="node169" class="node">
<title>layer_8_gelu</title>
<polygon fill="lightblue" stroke="black" points="1216.5,-9947 1001.5,-9947 1001.5,-9894 1216.5,-9894 1216.5,-9947"/>
<text text-anchor="middle" x="1109" y="-9931.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1109" y="-9916.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1109" y="-9901.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_ffn1&#45;&gt;layer_8_gelu -->
<g id="edge203" class="edge">
<title>layer_8_ffn1&#45;&gt;layer_8_gelu</title>
<path fill="none" stroke="black" d="M1109,-9982.87C1109,-9974.89 1109,-9965.93 1109,-9957.38"/>
<polygon fill="black" stroke="black" points="1112.5,-9957.25 1109,-9947.25 1105.5,-9957.25 1112.5,-9957.25"/>
</g>
<!-- layer_8_ffn2 -->
<g id="node170" class="node">
<title>layer_8_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1214,-9858 1008,-9858 1008,-9805 1214,-9805 1214,-9858"/>
<text text-anchor="middle" x="1111" y="-9842.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1111" y="-9827.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1111" y="-9812.8" font-family="Times,serif" font-size="14.00">GPU 8</text>
</g>
<!-- layer_8_gelu&#45;&gt;layer_8_ffn2 -->
<g id="edge204" class="edge">
<title>layer_8_gelu&#45;&gt;layer_8_ffn2</title>
<path fill="none" stroke="black" d="M1109.59,-9893.87C1109.77,-9885.89 1109.98,-9876.93 1110.18,-9868.38"/>
<polygon fill="black" stroke="black" points="1113.68,-9868.33 1110.41,-9858.25 1106.68,-9868.17 1113.68,-9868.33"/>
</g>
<!-- layer_8_ffn2&#45;&gt;layer_8_add -->
<g id="edge206" class="edge">
<title>layer_8_ffn2&#45;&gt;layer_8_add</title>
<path fill="none" stroke="black" d="M1130.74,-9804.87C1137.36,-9796.27 1144.85,-9786.55 1151.88,-9777.42"/>
<polygon fill="black" stroke="black" points="1154.84,-9779.31 1158.17,-9769.25 1149.3,-9775.04 1154.84,-9779.31"/>
</g>
<!-- comm_8_9 -->
<g id="node172" class="node">
<title>comm_8_9</title>
<polygon fill="yellow" stroke="black" points="1391.64,-9680 1051.79,-9680 964.36,-9574 1304.21,-9574 1391.64,-9680"/>
<text text-anchor="middle" x="1178" y="-9638.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1178" y="-9623.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1178" y="-9608.3" font-family="Times,serif" font-size="14.00">GPU 8 → GPU 9</text>
</g>
<!-- layer_8_add&#45;&gt;comm_8_9 -->
<g id="edge207" class="edge">
<title>layer_8_add&#45;&gt;comm_8_9</title>
<path fill="none" stroke="black" d="M1178,-9715.75C1178,-9708.05 1178,-9699.25 1178,-9690.27"/>
<polygon fill="black" stroke="black" points="1181.5,-9690.1 1178,-9680.1 1174.5,-9690.1 1181.5,-9690.1"/>
</g>
<!-- layer_9_ln1 -->
<g id="node173" class="node">
<title>layer_9_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1216,-9538 1010,-9538 1010,-9485 1216,-9485 1216,-9538"/>
<text text-anchor="middle" x="1113" y="-9522.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1113" y="-9507.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1113" y="-9492.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- comm_8_9&#45;&gt;layer_9_ln1 -->
<g id="edge208" class="edge">
<title>comm_8_9&#45;&gt;layer_9_ln1</title>
<path fill="none" stroke="black" d="M1148.16,-9573.9C1142.92,-9564.74 1137.58,-9555.42 1132.7,-9546.9"/>
<polygon fill="black" stroke="black" points="1135.62,-9544.95 1127.61,-9538.01 1129.54,-9548.43 1135.62,-9544.95"/>
</g>
<!-- layer_9_add1 -->
<g id="node185" class="node">
<title>layer_9_add1</title>
<polygon fill="lightgreen" stroke="black" points="1393,-8826 1187,-8826 1187,-8773 1393,-8773 1393,-8826"/>
<text text-anchor="middle" x="1290" y="-8810.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1290" y="-8795.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1290" y="-8780.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- comm_8_9&#45;&gt;layer_9_add1 -->
<g id="edge222" class="edge">
<title>comm_8_9&#45;&gt;layer_9_add1</title>
<path fill="none" stroke="black" d="M1262.99,-9573.8C1309.6,-9538.08 1358,-9485.94 1358,-9423.5 1358,-9423.5 1358,-9423.5 1358,-8976.5 1358,-8924.76 1357.95,-8909.3 1337,-8862 1332.71,-8852.32 1326.61,-8842.77 1320.21,-8834.19"/>
<polygon fill="black" stroke="black" points="1322.96,-8832.01 1314.05,-8826.28 1317.44,-8836.32 1322.96,-8832.01"/>
</g>
<!-- layer_9_q_proj -->
<g id="node174" class="node">
<title>layer_9_q_proj</title>
<polygon fill="lightblue" stroke="black" points="876,-9449 670,-9449 670,-9396 876,-9396 876,-9449"/>
<text text-anchor="middle" x="773" y="-9433.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="773" y="-9418.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="773" y="-9403.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_q_proj -->
<g id="edge209" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_q_proj</title>
<path fill="none" stroke="black" d="M1013.29,-9484.98C972.2,-9474.47 924.47,-9462.26 882.43,-9451.5"/>
<polygon fill="black" stroke="black" points="883.27,-9448.1 872.71,-9449.01 881.53,-9454.88 883.27,-9448.1"/>
</g>
<!-- layer_9_k_proj -->
<g id="node175" class="node">
<title>layer_9_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1104,-9449 898,-9449 898,-9396 1104,-9396 1104,-9449"/>
<text text-anchor="middle" x="1001" y="-9433.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1001" y="-9418.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1001" y="-9403.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_k_proj -->
<g id="edge210" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_k_proj</title>
<path fill="none" stroke="black" d="M1080,-9484.87C1068.15,-9475.66 1054.62,-9465.15 1042.16,-9455.47"/>
<polygon fill="black" stroke="black" points="1044.19,-9452.62 1034.15,-9449.25 1039.9,-9458.15 1044.19,-9452.62"/>
</g>
<!-- layer_9_v_proj -->
<g id="node176" class="node">
<title>layer_9_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1328,-9449 1122,-9449 1122,-9396 1328,-9396 1328,-9449"/>
<text text-anchor="middle" x="1225" y="-9433.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1225" y="-9418.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1225" y="-9403.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln1&#45;&gt;layer_9_v_proj -->
<g id="edge211" class="edge">
<title>layer_9_ln1&#45;&gt;layer_9_v_proj</title>
<path fill="none" stroke="black" d="M1146,-9484.87C1157.85,-9475.66 1171.38,-9465.15 1183.84,-9455.47"/>
<polygon fill="black" stroke="black" points="1186.1,-9458.15 1191.85,-9449.25 1181.81,-9452.62 1186.1,-9458.15"/>
</g>
<!-- layer_9_q_reshape -->
<g id="node177" class="node">
<title>layer_9_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="876,-9360 652,-9360 652,-9307 876,-9307 876,-9360"/>
<text text-anchor="middle" x="764" y="-9344.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="764" y="-9329.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="764" y="-9314.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_q_proj&#45;&gt;layer_9_q_reshape -->
<g id="edge212" class="edge">
<title>layer_9_q_proj&#45;&gt;layer_9_q_reshape</title>
<path fill="none" stroke="black" d="M770.35,-9395.87C769.52,-9387.89 768.6,-9378.93 767.71,-9370.38"/>
<polygon fill="black" stroke="black" points="771.17,-9369.84 766.66,-9360.25 764.21,-9370.56 771.17,-9369.84"/>
</g>
<!-- layer_9_k_reshape -->
<g id="node178" class="node">
<title>layer_9_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1118,-9360 894,-9360 894,-9307 1118,-9307 1118,-9360"/>
<text text-anchor="middle" x="1006" y="-9344.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1006" y="-9329.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1006" y="-9314.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_k_proj&#45;&gt;layer_9_k_reshape -->
<g id="edge213" class="edge">
<title>layer_9_k_proj&#45;&gt;layer_9_k_reshape</title>
<path fill="none" stroke="black" d="M1002.47,-9395.87C1002.93,-9387.89 1003.45,-9378.93 1003.94,-9370.38"/>
<polygon fill="black" stroke="black" points="1007.44,-9370.43 1004.52,-9360.25 1000.45,-9370.03 1007.44,-9370.43"/>
</g>
<!-- layer_9_v_reshape -->
<g id="node179" class="node">
<title>layer_9_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1330,-9271 1106,-9271 1106,-9218 1330,-9218 1330,-9271"/>
<text text-anchor="middle" x="1218" y="-9255.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1218" y="-9240.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1218" y="-9225.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_v_proj&#45;&gt;layer_9_v_reshape -->
<g id="edge214" class="edge">
<title>layer_9_v_proj&#45;&gt;layer_9_v_reshape</title>
<path fill="none" stroke="black" d="M1223.98,-9395.91C1222.78,-9365.67 1220.77,-9315.17 1219.42,-9281.12"/>
<polygon fill="black" stroke="black" points="1222.91,-9280.98 1219.02,-9271.12 1215.92,-9281.25 1222.91,-9280.98"/>
</g>
<!-- layer_9_attn_scores -->
<g id="node180" class="node">
<title>layer_9_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1087.5,-9271 854.5,-9271 854.5,-9218 1087.5,-9218 1087.5,-9271"/>
<text text-anchor="middle" x="971" y="-9255.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="971" y="-9240.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="971" y="-9225.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_q_reshape&#45;&gt;layer_9_attn_scores -->
<g id="edge215" class="edge">
<title>layer_9_q_reshape&#45;&gt;layer_9_attn_scores</title>
<path fill="none" stroke="black" d="M824.71,-9306.98C848.61,-9296.94 876.22,-9285.34 900.96,-9274.94"/>
<polygon fill="black" stroke="black" points="902.43,-9278.12 910.29,-9271.01 899.72,-9271.66 902.43,-9278.12"/>
</g>
<!-- layer_9_k_reshape&#45;&gt;layer_9_attn_scores -->
<g id="edge216" class="edge">
<title>layer_9_k_reshape&#45;&gt;layer_9_attn_scores</title>
<path fill="none" stroke="black" d="M995.69,-9306.87C992.37,-9298.62 988.64,-9289.34 985.1,-9280.54"/>
<polygon fill="black" stroke="black" points="988.34,-9279.22 981.36,-9271.25 981.84,-9281.83 988.34,-9279.22"/>
</g>
<!-- layer_9_attn_output -->
<g id="node182" class="node">
<title>layer_9_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1330,-9093 1106,-9093 1106,-9040 1330,-9040 1330,-9093"/>
<text text-anchor="middle" x="1218" y="-9077.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1218" y="-9062.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1218" y="-9047.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_v_reshape&#45;&gt;layer_9_attn_output -->
<g id="edge219" class="edge">
<title>layer_9_v_reshape&#45;&gt;layer_9_attn_output</title>
<path fill="none" stroke="black" d="M1218,-9217.91C1218,-9187.8 1218,-9137.61 1218,-9103.56"/>
<polygon fill="black" stroke="black" points="1221.5,-9103.12 1218,-9093.12 1214.5,-9103.12 1221.5,-9103.12"/>
</g>
<!-- layer_9_attn_weights -->
<g id="node181" class="node">
<title>layer_9_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1138.5,-9182 905.5,-9182 905.5,-9129 1138.5,-9129 1138.5,-9182"/>
<text text-anchor="middle" x="1022" y="-9166.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1022" y="-9151.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1022" y="-9136.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_scores&#45;&gt;layer_9_attn_weights -->
<g id="edge217" class="edge">
<title>layer_9_attn_scores&#45;&gt;layer_9_attn_weights</title>
<path fill="none" stroke="black" d="M986.03,-9217.87C990.96,-9209.45 996.53,-9199.95 1001.79,-9190.98"/>
<polygon fill="black" stroke="black" points="1004.87,-9192.65 1006.91,-9182.25 998.83,-9189.11 1004.87,-9192.65"/>
</g>
<!-- layer_9_attn_weights&#45;&gt;layer_9_attn_output -->
<g id="edge218" class="edge">
<title>layer_9_attn_weights&#45;&gt;layer_9_attn_output</title>
<path fill="none" stroke="black" d="M1079.48,-9128.98C1102.02,-9118.98 1128.03,-9107.44 1151.38,-9097.07"/>
<polygon fill="black" stroke="black" points="1152.8,-9100.27 1160.52,-9093.01 1149.96,-9093.87 1152.8,-9100.27"/>
</g>
<!-- layer_9_attn_reshape -->
<g id="node183" class="node">
<title>layer_9_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1325,-9004 1119,-9004 1119,-8951 1325,-8951 1325,-9004"/>
<text text-anchor="middle" x="1222" y="-8988.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1222" y="-8973.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1222" y="-8958.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_output&#45;&gt;layer_9_attn_reshape -->
<g id="edge220" class="edge">
<title>layer_9_attn_output&#45;&gt;layer_9_attn_reshape</title>
<path fill="none" stroke="black" d="M1219.18,-9039.87C1219.55,-9031.89 1219.96,-9022.93 1220.35,-9014.38"/>
<polygon fill="black" stroke="black" points="1223.85,-9014.4 1220.82,-9004.25 1216.86,-9014.08 1223.85,-9014.4"/>
</g>
<!-- layer_9_attn_proj -->
<g id="node184" class="node">
<title>layer_9_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1328,-8915 1122,-8915 1122,-8862 1328,-8862 1328,-8915"/>
<text text-anchor="middle" x="1225" y="-8899.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1225" y="-8884.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1225" y="-8869.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_attn_reshape&#45;&gt;layer_9_attn_proj -->
<g id="edge221" class="edge">
<title>layer_9_attn_reshape&#45;&gt;layer_9_attn_proj</title>
<path fill="none" stroke="black" d="M1222.88,-8950.87C1223.16,-8942.89 1223.47,-8933.93 1223.76,-8925.38"/>
<polygon fill="black" stroke="black" points="1227.27,-8925.36 1224.11,-8915.25 1220.27,-8925.12 1227.27,-8925.36"/>
</g>
<!-- layer_9_attn_proj&#45;&gt;layer_9_add1 -->
<g id="edge223" class="edge">
<title>layer_9_attn_proj&#45;&gt;layer_9_add1</title>
<path fill="none" stroke="black" d="M1244.15,-8861.87C1250.57,-8853.27 1257.84,-8843.55 1264.66,-8834.42"/>
<polygon fill="black" stroke="black" points="1267.58,-8836.36 1270.76,-8826.25 1261.97,-8832.17 1267.58,-8836.36"/>
</g>
<!-- layer_9_ln2 -->
<g id="node186" class="node">
<title>layer_9_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1325,-8737 1119,-8737 1119,-8684 1325,-8684 1325,-8737"/>
<text text-anchor="middle" x="1222" y="-8721.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1222" y="-8706.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1222" y="-8691.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_add1&#45;&gt;layer_9_ln2 -->
<g id="edge224" class="edge">
<title>layer_9_add1&#45;&gt;layer_9_ln2</title>
<path fill="none" stroke="black" d="M1269.97,-8772.87C1263.18,-8764.18 1255.49,-8754.35 1248.29,-8745.14"/>
<polygon fill="black" stroke="black" points="1251.04,-8742.97 1242.13,-8737.25 1245.53,-8747.28 1251.04,-8742.97"/>
</g>
<!-- layer_9_add -->
<g id="node190" class="node">
<title>layer_9_add</title>
<polygon fill="lightgreen" stroke="black" points="1392,-8381 1186,-8381 1186,-8328 1392,-8328 1392,-8381"/>
<text text-anchor="middle" x="1289" y="-8365.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1289" y="-8350.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1289" y="-8335.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_add1&#45;&gt;layer_9_add -->
<g id="edge228" class="edge">
<title>layer_9_add1&#45;&gt;layer_9_add</title>
<path fill="none" stroke="black" d="M1312.19,-8772.77C1320.18,-8762.29 1328.56,-8749.67 1334,-8737 1354.44,-8689.38 1356,-8674.32 1356,-8622.5 1356,-8622.5 1356,-8622.5 1356,-8531.5 1356,-8479.68 1354.69,-8464.51 1334,-8417 1329.84,-8407.45 1323.98,-8397.95 1317.86,-8389.38"/>
<polygon fill="black" stroke="black" points="1320.5,-8387.07 1311.71,-8381.16 1314.89,-8391.26 1320.5,-8387.07"/>
</g>
<!-- layer_9_ffn1 -->
<g id="node187" class="node">
<title>layer_9_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1327.5,-8648 1112.5,-8648 1112.5,-8595 1327.5,-8595 1327.5,-8648"/>
<text text-anchor="middle" x="1220" y="-8632.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1220" y="-8617.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1220" y="-8602.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ln2&#45;&gt;layer_9_ffn1 -->
<g id="edge225" class="edge">
<title>layer_9_ln2&#45;&gt;layer_9_ffn1</title>
<path fill="none" stroke="black" d="M1221.41,-8683.87C1221.23,-8675.89 1221.02,-8666.93 1220.82,-8658.38"/>
<polygon fill="black" stroke="black" points="1224.32,-8658.17 1220.59,-8648.25 1217.32,-8658.33 1224.32,-8658.17"/>
</g>
<!-- layer_9_gelu -->
<g id="node188" class="node">
<title>layer_9_gelu</title>
<polygon fill="lightblue" stroke="black" points="1327.5,-8559 1112.5,-8559 1112.5,-8506 1327.5,-8506 1327.5,-8559"/>
<text text-anchor="middle" x="1220" y="-8543.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1220" y="-8528.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1220" y="-8513.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_ffn1&#45;&gt;layer_9_gelu -->
<g id="edge226" class="edge">
<title>layer_9_ffn1&#45;&gt;layer_9_gelu</title>
<path fill="none" stroke="black" d="M1220,-8594.87C1220,-8586.89 1220,-8577.93 1220,-8569.38"/>
<polygon fill="black" stroke="black" points="1223.5,-8569.25 1220,-8559.25 1216.5,-8569.25 1223.5,-8569.25"/>
</g>
<!-- layer_9_ffn2 -->
<g id="node189" class="node">
<title>layer_9_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1325,-8470 1119,-8470 1119,-8417 1325,-8417 1325,-8470"/>
<text text-anchor="middle" x="1222" y="-8454.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1222" y="-8439.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1222" y="-8424.8" font-family="Times,serif" font-size="14.00">GPU 9</text>
</g>
<!-- layer_9_gelu&#45;&gt;layer_9_ffn2 -->
<g id="edge227" class="edge">
<title>layer_9_gelu&#45;&gt;layer_9_ffn2</title>
<path fill="none" stroke="black" d="M1220.59,-8505.87C1220.77,-8497.89 1220.98,-8488.93 1221.18,-8480.38"/>
<polygon fill="black" stroke="black" points="1224.68,-8480.33 1221.41,-8470.25 1217.68,-8480.17 1224.68,-8480.33"/>
</g>
<!-- layer_9_ffn2&#45;&gt;layer_9_add -->
<g id="edge229" class="edge">
<title>layer_9_ffn2&#45;&gt;layer_9_add</title>
<path fill="none" stroke="black" d="M1241.74,-8416.87C1248.36,-8408.27 1255.85,-8398.55 1262.88,-8389.42"/>
<polygon fill="black" stroke="black" points="1265.84,-8391.31 1269.17,-8381.25 1260.3,-8387.04 1265.84,-8391.31"/>
</g>
<!-- comm_9_10 -->
<g id="node191" class="node">
<title>comm_9_10</title>
<polygon fill="yellow" stroke="black" points="1502.64,-8292 1162.79,-8292 1075.36,-8186 1415.21,-8186 1502.64,-8292"/>
<text text-anchor="middle" x="1289" y="-8250.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1289" y="-8235.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1289" y="-8220.3" font-family="Times,serif" font-size="14.00">GPU 9 → GPU 10</text>
</g>
<!-- layer_9_add&#45;&gt;comm_9_10 -->
<g id="edge230" class="edge">
<title>layer_9_add&#45;&gt;comm_9_10</title>
<path fill="none" stroke="black" d="M1289,-8327.75C1289,-8320.05 1289,-8311.25 1289,-8302.27"/>
<polygon fill="black" stroke="black" points="1292.5,-8302.1 1289,-8292.1 1285.5,-8302.1 1292.5,-8302.1"/>
</g>
<!-- layer_10_ln1 -->
<g id="node192" class="node">
<title>layer_10_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1327,-8150 1121,-8150 1121,-8097 1327,-8097 1327,-8150"/>
<text text-anchor="middle" x="1224" y="-8134.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1224" y="-8119.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1224" y="-8104.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- comm_9_10&#45;&gt;layer_10_ln1 -->
<g id="edge231" class="edge">
<title>comm_9_10&#45;&gt;layer_10_ln1</title>
<path fill="none" stroke="black" d="M1259.16,-8185.9C1253.92,-8176.74 1248.58,-8167.42 1243.7,-8158.9"/>
<polygon fill="black" stroke="black" points="1246.62,-8156.95 1238.61,-8150.01 1240.54,-8160.43 1246.62,-8156.95"/>
</g>
<!-- layer_10_add1 -->
<g id="node204" class="node">
<title>layer_10_add1</title>
<polygon fill="lightgreen" stroke="black" points="1505,-7438 1299,-7438 1299,-7385 1505,-7385 1505,-7438"/>
<text text-anchor="middle" x="1402" y="-7422.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1402" y="-7407.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1402" y="-7392.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- comm_9_10&#45;&gt;layer_10_add1 -->
<g id="edge245" class="edge">
<title>comm_9_10&#45;&gt;layer_10_add1</title>
<path fill="none" stroke="black" d="M1373.99,-8185.8C1420.6,-8150.08 1469,-8097.94 1469,-8035.5 1469,-8035.5 1469,-8035.5 1469,-7588.5 1469,-7536.68 1467.69,-7521.51 1447,-7474 1442.84,-7464.45 1436.98,-7454.95 1430.86,-7446.38"/>
<polygon fill="black" stroke="black" points="1433.5,-7444.07 1424.71,-7438.16 1427.89,-7448.26 1433.5,-7444.07"/>
</g>
<!-- layer_10_q_proj -->
<g id="node193" class="node">
<title>layer_10_q_proj</title>
<polygon fill="lightblue" stroke="black" points="987,-8061 781,-8061 781,-8008 987,-8008 987,-8061"/>
<text text-anchor="middle" x="884" y="-8045.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="884" y="-8030.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="884" y="-8015.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_q_proj -->
<g id="edge232" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_q_proj</title>
<path fill="none" stroke="black" d="M1124.29,-8096.98C1083.2,-8086.47 1035.47,-8074.26 993.43,-8063.5"/>
<polygon fill="black" stroke="black" points="994.27,-8060.1 983.71,-8061.01 992.53,-8066.88 994.27,-8060.1"/>
</g>
<!-- layer_10_k_proj -->
<g id="node194" class="node">
<title>layer_10_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1215,-8061 1009,-8061 1009,-8008 1215,-8008 1215,-8061"/>
<text text-anchor="middle" x="1112" y="-8045.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1112" y="-8030.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1112" y="-8015.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_k_proj -->
<g id="edge233" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_k_proj</title>
<path fill="none" stroke="black" d="M1191,-8096.87C1179.15,-8087.66 1165.62,-8077.15 1153.16,-8067.47"/>
<polygon fill="black" stroke="black" points="1155.19,-8064.62 1145.15,-8061.25 1150.9,-8070.15 1155.19,-8064.62"/>
</g>
<!-- layer_10_v_proj -->
<g id="node195" class="node">
<title>layer_10_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1439,-8061 1233,-8061 1233,-8008 1439,-8008 1439,-8061"/>
<text text-anchor="middle" x="1336" y="-8045.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1336" y="-8030.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1336" y="-8015.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln1&#45;&gt;layer_10_v_proj -->
<g id="edge234" class="edge">
<title>layer_10_ln1&#45;&gt;layer_10_v_proj</title>
<path fill="none" stroke="black" d="M1257,-8096.87C1268.85,-8087.66 1282.38,-8077.15 1294.84,-8067.47"/>
<polygon fill="black" stroke="black" points="1297.1,-8070.15 1302.85,-8061.25 1292.81,-8064.62 1297.1,-8070.15"/>
</g>
<!-- layer_10_q_reshape -->
<g id="node196" class="node">
<title>layer_10_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="987,-7972 763,-7972 763,-7919 987,-7919 987,-7972"/>
<text text-anchor="middle" x="875" y="-7956.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="875" y="-7941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="875" y="-7926.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_q_proj&#45;&gt;layer_10_q_reshape -->
<g id="edge235" class="edge">
<title>layer_10_q_proj&#45;&gt;layer_10_q_reshape</title>
<path fill="none" stroke="black" d="M881.35,-8007.87C880.52,-7999.89 879.6,-7990.93 878.71,-7982.38"/>
<polygon fill="black" stroke="black" points="882.17,-7981.84 877.66,-7972.25 875.21,-7982.56 882.17,-7981.84"/>
</g>
<!-- layer_10_k_reshape -->
<g id="node197" class="node">
<title>layer_10_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1229,-7972 1005,-7972 1005,-7919 1229,-7919 1229,-7972"/>
<text text-anchor="middle" x="1117" y="-7956.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1117" y="-7941.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1117" y="-7926.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_k_proj&#45;&gt;layer_10_k_reshape -->
<g id="edge236" class="edge">
<title>layer_10_k_proj&#45;&gt;layer_10_k_reshape</title>
<path fill="none" stroke="black" d="M1113.47,-8007.87C1113.93,-7999.89 1114.45,-7990.93 1114.94,-7982.38"/>
<polygon fill="black" stroke="black" points="1118.44,-7982.43 1115.52,-7972.25 1111.45,-7982.03 1118.44,-7982.43"/>
</g>
<!-- layer_10_v_reshape -->
<g id="node198" class="node">
<title>layer_10_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1441,-7883 1217,-7883 1217,-7830 1441,-7830 1441,-7883"/>
<text text-anchor="middle" x="1329" y="-7867.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1329" y="-7852.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1329" y="-7837.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_v_proj&#45;&gt;layer_10_v_reshape -->
<g id="edge237" class="edge">
<title>layer_10_v_proj&#45;&gt;layer_10_v_reshape</title>
<path fill="none" stroke="black" d="M1334.98,-8007.91C1333.78,-7977.67 1331.77,-7927.17 1330.42,-7893.12"/>
<polygon fill="black" stroke="black" points="1333.91,-7892.98 1330.02,-7883.12 1326.92,-7893.25 1333.91,-7892.98"/>
</g>
<!-- layer_10_attn_scores -->
<g id="node199" class="node">
<title>layer_10_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1198.5,-7883 965.5,-7883 965.5,-7830 1198.5,-7830 1198.5,-7883"/>
<text text-anchor="middle" x="1082" y="-7867.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1082" y="-7852.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1082" y="-7837.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_q_reshape&#45;&gt;layer_10_attn_scores -->
<g id="edge238" class="edge">
<title>layer_10_q_reshape&#45;&gt;layer_10_attn_scores</title>
<path fill="none" stroke="black" d="M935.71,-7918.98C959.61,-7908.94 987.22,-7897.34 1011.96,-7886.94"/>
<polygon fill="black" stroke="black" points="1013.43,-7890.12 1021.29,-7883.01 1010.72,-7883.66 1013.43,-7890.12"/>
</g>
<!-- layer_10_k_reshape&#45;&gt;layer_10_attn_scores -->
<g id="edge239" class="edge">
<title>layer_10_k_reshape&#45;&gt;layer_10_attn_scores</title>
<path fill="none" stroke="black" d="M1106.69,-7918.87C1103.37,-7910.62 1099.64,-7901.34 1096.1,-7892.54"/>
<polygon fill="black" stroke="black" points="1099.34,-7891.22 1092.36,-7883.25 1092.84,-7893.83 1099.34,-7891.22"/>
</g>
<!-- layer_10_attn_output -->
<g id="node201" class="node">
<title>layer_10_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1441,-7705 1217,-7705 1217,-7652 1441,-7652 1441,-7705"/>
<text text-anchor="middle" x="1329" y="-7689.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1329" y="-7674.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1329" y="-7659.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_v_reshape&#45;&gt;layer_10_attn_output -->
<g id="edge242" class="edge">
<title>layer_10_v_reshape&#45;&gt;layer_10_attn_output</title>
<path fill="none" stroke="black" d="M1329,-7829.91C1329,-7799.8 1329,-7749.61 1329,-7715.56"/>
<polygon fill="black" stroke="black" points="1332.5,-7715.12 1329,-7705.12 1325.5,-7715.12 1332.5,-7715.12"/>
</g>
<!-- layer_10_attn_weights -->
<g id="node200" class="node">
<title>layer_10_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1249.5,-7794 1016.5,-7794 1016.5,-7741 1249.5,-7741 1249.5,-7794"/>
<text text-anchor="middle" x="1133" y="-7778.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1133" y="-7763.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1133" y="-7748.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_scores&#45;&gt;layer_10_attn_weights -->
<g id="edge240" class="edge">
<title>layer_10_attn_scores&#45;&gt;layer_10_attn_weights</title>
<path fill="none" stroke="black" d="M1097.03,-7829.87C1101.96,-7821.45 1107.53,-7811.95 1112.79,-7802.98"/>
<polygon fill="black" stroke="black" points="1115.87,-7804.65 1117.91,-7794.25 1109.83,-7801.11 1115.87,-7804.65"/>
</g>
<!-- layer_10_attn_weights&#45;&gt;layer_10_attn_output -->
<g id="edge241" class="edge">
<title>layer_10_attn_weights&#45;&gt;layer_10_attn_output</title>
<path fill="none" stroke="black" d="M1190.48,-7740.98C1213.02,-7730.98 1239.03,-7719.44 1262.38,-7709.07"/>
<polygon fill="black" stroke="black" points="1263.8,-7712.27 1271.52,-7705.01 1260.96,-7705.87 1263.8,-7712.27"/>
</g>
<!-- layer_10_attn_reshape -->
<g id="node202" class="node">
<title>layer_10_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1436,-7616 1230,-7616 1230,-7563 1436,-7563 1436,-7616"/>
<text text-anchor="middle" x="1333" y="-7600.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1333" y="-7585.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1333" y="-7570.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_output&#45;&gt;layer_10_attn_reshape -->
<g id="edge243" class="edge">
<title>layer_10_attn_output&#45;&gt;layer_10_attn_reshape</title>
<path fill="none" stroke="black" d="M1330.18,-7651.87C1330.55,-7643.89 1330.96,-7634.93 1331.35,-7626.38"/>
<polygon fill="black" stroke="black" points="1334.85,-7626.4 1331.82,-7616.25 1327.86,-7626.08 1334.85,-7626.4"/>
</g>
<!-- layer_10_attn_proj -->
<g id="node203" class="node">
<title>layer_10_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1438,-7527 1232,-7527 1232,-7474 1438,-7474 1438,-7527"/>
<text text-anchor="middle" x="1335" y="-7511.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1335" y="-7496.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1335" y="-7481.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_attn_reshape&#45;&gt;layer_10_attn_proj -->
<g id="edge244" class="edge">
<title>layer_10_attn_reshape&#45;&gt;layer_10_attn_proj</title>
<path fill="none" stroke="black" d="M1333.59,-7562.87C1333.77,-7554.89 1333.98,-7545.93 1334.18,-7537.38"/>
<polygon fill="black" stroke="black" points="1337.68,-7537.33 1334.41,-7527.25 1330.68,-7537.17 1337.68,-7537.33"/>
</g>
<!-- layer_10_attn_proj&#45;&gt;layer_10_add1 -->
<g id="edge246" class="edge">
<title>layer_10_attn_proj&#45;&gt;layer_10_add1</title>
<path fill="none" stroke="black" d="M1354.74,-7473.87C1361.36,-7465.27 1368.85,-7455.55 1375.88,-7446.42"/>
<polygon fill="black" stroke="black" points="1378.84,-7448.31 1382.17,-7438.25 1373.3,-7444.04 1378.84,-7448.31"/>
</g>
<!-- layer_10_ln2 -->
<g id="node205" class="node">
<title>layer_10_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1440,-7349 1234,-7349 1234,-7296 1440,-7296 1440,-7349"/>
<text text-anchor="middle" x="1337" y="-7333.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1337" y="-7318.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1337" y="-7303.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_add1&#45;&gt;layer_10_ln2 -->
<g id="edge247" class="edge">
<title>layer_10_add1&#45;&gt;layer_10_ln2</title>
<path fill="none" stroke="black" d="M1382.85,-7384.87C1376.43,-7376.27 1369.16,-7366.55 1362.34,-7357.42"/>
<polygon fill="black" stroke="black" points="1365.03,-7355.17 1356.24,-7349.25 1359.42,-7359.36 1365.03,-7355.17"/>
</g>
<!-- layer_10_add -->
<g id="node209" class="node">
<title>layer_10_add</title>
<polygon fill="lightgreen" stroke="black" points="1505,-6993 1299,-6993 1299,-6940 1505,-6940 1505,-6993"/>
<text text-anchor="middle" x="1402" y="-6977.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1402" y="-6962.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1402" y="-6947.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_add1&#45;&gt;layer_10_add -->
<g id="edge251" class="edge">
<title>layer_10_add1&#45;&gt;layer_10_add</title>
<path fill="none" stroke="black" d="M1426.05,-7384.72C1434.52,-7374.32 1443.34,-7361.78 1449,-7349 1469.95,-7301.7 1470,-7286.24 1470,-7234.5 1470,-7234.5 1470,-7234.5 1470,-7143.5 1470,-7091.76 1469.95,-7076.3 1449,-7029 1444.71,-7019.32 1438.61,-7009.77 1432.21,-7001.19"/>
<polygon fill="black" stroke="black" points="1434.96,-6999.01 1426.05,-6993.28 1429.44,-7003.32 1434.96,-6999.01"/>
</g>
<!-- layer_10_ffn1 -->
<g id="node206" class="node">
<title>layer_10_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1441.5,-7260 1226.5,-7260 1226.5,-7207 1441.5,-7207 1441.5,-7260"/>
<text text-anchor="middle" x="1334" y="-7244.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1334" y="-7229.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1334" y="-7214.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ln2&#45;&gt;layer_10_ffn1 -->
<g id="edge248" class="edge">
<title>layer_10_ln2&#45;&gt;layer_10_ffn1</title>
<path fill="none" stroke="black" d="M1336.12,-7295.87C1335.84,-7287.89 1335.53,-7278.93 1335.24,-7270.38"/>
<polygon fill="black" stroke="black" points="1338.73,-7270.12 1334.89,-7260.25 1331.73,-7270.36 1338.73,-7270.12"/>
</g>
<!-- layer_10_gelu -->
<g id="node207" class="node">
<title>layer_10_gelu</title>
<polygon fill="lightblue" stroke="black" points="1441.5,-7171 1226.5,-7171 1226.5,-7118 1441.5,-7118 1441.5,-7171"/>
<text text-anchor="middle" x="1334" y="-7155.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1334" y="-7140.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1334" y="-7125.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_ffn1&#45;&gt;layer_10_gelu -->
<g id="edge249" class="edge">
<title>layer_10_ffn1&#45;&gt;layer_10_gelu</title>
<path fill="none" stroke="black" d="M1334,-7206.87C1334,-7198.89 1334,-7189.93 1334,-7181.38"/>
<polygon fill="black" stroke="black" points="1337.5,-7181.25 1334,-7171.25 1330.5,-7181.25 1337.5,-7181.25"/>
</g>
<!-- layer_10_ffn2 -->
<g id="node208" class="node">
<title>layer_10_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1440,-7082 1234,-7082 1234,-7029 1440,-7029 1440,-7082"/>
<text text-anchor="middle" x="1337" y="-7066.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1337" y="-7051.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1337" y="-7036.8" font-family="Times,serif" font-size="14.00">GPU 10</text>
</g>
<!-- layer_10_gelu&#45;&gt;layer_10_ffn2 -->
<g id="edge250" class="edge">
<title>layer_10_gelu&#45;&gt;layer_10_ffn2</title>
<path fill="none" stroke="black" d="M1334.88,-7117.87C1335.16,-7109.89 1335.47,-7100.93 1335.76,-7092.38"/>
<polygon fill="black" stroke="black" points="1339.27,-7092.36 1336.11,-7082.25 1332.27,-7092.12 1339.27,-7092.36"/>
</g>
<!-- layer_10_ffn2&#45;&gt;layer_10_add -->
<g id="edge252" class="edge">
<title>layer_10_ffn2&#45;&gt;layer_10_add</title>
<path fill="none" stroke="black" d="M1356.15,-7028.87C1362.57,-7020.27 1369.84,-7010.55 1376.66,-7001.42"/>
<polygon fill="black" stroke="black" points="1379.58,-7003.36 1382.76,-6993.25 1373.97,-6999.17 1379.58,-7003.36"/>
</g>
<!-- comm_10_11 -->
<g id="node210" class="node">
<title>comm_10_11</title>
<polygon fill="yellow" stroke="black" points="1615.64,-6904 1275.79,-6904 1188.36,-6798 1528.21,-6798 1615.64,-6904"/>
<text text-anchor="middle" x="1402" y="-6862.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1402" y="-6847.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1402" y="-6832.3" font-family="Times,serif" font-size="14.00">GPU 10 → GPU 11</text>
</g>
<!-- layer_10_add&#45;&gt;comm_10_11 -->
<g id="edge253" class="edge">
<title>layer_10_add&#45;&gt;comm_10_11</title>
<path fill="none" stroke="black" d="M1402,-6939.75C1402,-6932.05 1402,-6923.25 1402,-6914.27"/>
<polygon fill="black" stroke="black" points="1405.5,-6914.1 1402,-6904.1 1398.5,-6914.1 1405.5,-6914.1"/>
</g>
<!-- layer_11_ln1 -->
<g id="node211" class="node">
<title>layer_11_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1440,-6762 1234,-6762 1234,-6709 1440,-6709 1440,-6762"/>
<text text-anchor="middle" x="1337" y="-6746.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1337" y="-6731.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1337" y="-6716.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- comm_10_11&#45;&gt;layer_11_ln1 -->
<g id="edge254" class="edge">
<title>comm_10_11&#45;&gt;layer_11_ln1</title>
<path fill="none" stroke="black" d="M1372.16,-6797.9C1366.92,-6788.74 1361.58,-6779.42 1356.7,-6770.9"/>
<polygon fill="black" stroke="black" points="1359.62,-6768.95 1351.61,-6762.01 1353.54,-6772.43 1359.62,-6768.95"/>
</g>
<!-- layer_11_add1 -->
<g id="node223" class="node">
<title>layer_11_add1</title>
<polygon fill="lightgreen" stroke="black" points="1617,-6050 1411,-6050 1411,-5997 1617,-5997 1617,-6050"/>
<text text-anchor="middle" x="1514" y="-6034.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1514" y="-6019.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1514" y="-6004.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- comm_10_11&#45;&gt;layer_11_add1 -->
<g id="edge268" class="edge">
<title>comm_10_11&#45;&gt;layer_11_add1</title>
<path fill="none" stroke="black" d="M1486.99,-6797.8C1533.6,-6762.08 1582,-6709.94 1582,-6647.5 1582,-6647.5 1582,-6647.5 1582,-6200.5 1582,-6148.76 1581.95,-6133.3 1561,-6086 1556.71,-6076.32 1550.61,-6066.77 1544.21,-6058.19"/>
<polygon fill="black" stroke="black" points="1546.96,-6056.01 1538.05,-6050.28 1541.44,-6060.32 1546.96,-6056.01"/>
</g>
<!-- layer_11_q_proj -->
<g id="node212" class="node">
<title>layer_11_q_proj</title>
<polygon fill="lightblue" stroke="black" points="1100,-6673 894,-6673 894,-6620 1100,-6620 1100,-6673"/>
<text text-anchor="middle" x="997" y="-6657.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="997" y="-6642.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="997" y="-6627.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_q_proj -->
<g id="edge255" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_q_proj</title>
<path fill="none" stroke="black" d="M1237.29,-6708.98C1196.2,-6698.47 1148.47,-6686.26 1106.43,-6675.5"/>
<polygon fill="black" stroke="black" points="1107.27,-6672.1 1096.71,-6673.01 1105.53,-6678.88 1107.27,-6672.1"/>
</g>
<!-- layer_11_k_proj -->
<g id="node213" class="node">
<title>layer_11_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1328,-6673 1122,-6673 1122,-6620 1328,-6620 1328,-6673"/>
<text text-anchor="middle" x="1225" y="-6657.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1225" y="-6642.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1225" y="-6627.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_k_proj -->
<g id="edge256" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_k_proj</title>
<path fill="none" stroke="black" d="M1304,-6708.87C1292.15,-6699.66 1278.62,-6689.15 1266.16,-6679.47"/>
<polygon fill="black" stroke="black" points="1268.19,-6676.62 1258.15,-6673.25 1263.9,-6682.15 1268.19,-6676.62"/>
</g>
<!-- layer_11_v_proj -->
<g id="node214" class="node">
<title>layer_11_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1552,-6673 1346,-6673 1346,-6620 1552,-6620 1552,-6673"/>
<text text-anchor="middle" x="1449" y="-6657.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1449" y="-6642.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1449" y="-6627.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln1&#45;&gt;layer_11_v_proj -->
<g id="edge257" class="edge">
<title>layer_11_ln1&#45;&gt;layer_11_v_proj</title>
<path fill="none" stroke="black" d="M1370,-6708.87C1381.85,-6699.66 1395.38,-6689.15 1407.84,-6679.47"/>
<polygon fill="black" stroke="black" points="1410.1,-6682.15 1415.85,-6673.25 1405.81,-6676.62 1410.1,-6682.15"/>
</g>
<!-- layer_11_q_reshape -->
<g id="node215" class="node">
<title>layer_11_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="1100,-6584 876,-6584 876,-6531 1100,-6531 1100,-6584"/>
<text text-anchor="middle" x="988" y="-6568.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="988" y="-6553.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="988" y="-6538.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_q_proj&#45;&gt;layer_11_q_reshape -->
<g id="edge258" class="edge">
<title>layer_11_q_proj&#45;&gt;layer_11_q_reshape</title>
<path fill="none" stroke="black" d="M994.35,-6619.87C993.52,-6611.89 992.6,-6602.93 991.71,-6594.38"/>
<polygon fill="black" stroke="black" points="995.17,-6593.84 990.66,-6584.25 988.21,-6594.56 995.17,-6593.84"/>
</g>
<!-- layer_11_k_reshape -->
<g id="node216" class="node">
<title>layer_11_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1342,-6584 1118,-6584 1118,-6531 1342,-6531 1342,-6584"/>
<text text-anchor="middle" x="1230" y="-6568.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1230" y="-6553.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1230" y="-6538.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_k_proj&#45;&gt;layer_11_k_reshape -->
<g id="edge259" class="edge">
<title>layer_11_k_proj&#45;&gt;layer_11_k_reshape</title>
<path fill="none" stroke="black" d="M1226.47,-6619.87C1226.93,-6611.89 1227.45,-6602.93 1227.94,-6594.38"/>
<polygon fill="black" stroke="black" points="1231.44,-6594.43 1228.52,-6584.25 1224.45,-6594.03 1231.44,-6594.43"/>
</g>
<!-- layer_11_v_reshape -->
<g id="node217" class="node">
<title>layer_11_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1554,-6495 1330,-6495 1330,-6442 1554,-6442 1554,-6495"/>
<text text-anchor="middle" x="1442" y="-6479.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1442" y="-6464.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1442" y="-6449.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_v_proj&#45;&gt;layer_11_v_reshape -->
<g id="edge260" class="edge">
<title>layer_11_v_proj&#45;&gt;layer_11_v_reshape</title>
<path fill="none" stroke="black" d="M1447.98,-6619.91C1446.78,-6589.67 1444.77,-6539.17 1443.42,-6505.12"/>
<polygon fill="black" stroke="black" points="1446.91,-6504.98 1443.02,-6495.12 1439.92,-6505.25 1446.91,-6504.98"/>
</g>
<!-- layer_11_attn_scores -->
<g id="node218" class="node">
<title>layer_11_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1311.5,-6495 1078.5,-6495 1078.5,-6442 1311.5,-6442 1311.5,-6495"/>
<text text-anchor="middle" x="1195" y="-6479.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1195" y="-6464.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1195" y="-6449.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_q_reshape&#45;&gt;layer_11_attn_scores -->
<g id="edge261" class="edge">
<title>layer_11_q_reshape&#45;&gt;layer_11_attn_scores</title>
<path fill="none" stroke="black" d="M1048.71,-6530.98C1072.61,-6520.94 1100.22,-6509.34 1124.96,-6498.94"/>
<polygon fill="black" stroke="black" points="1126.43,-6502.12 1134.29,-6495.01 1123.72,-6495.66 1126.43,-6502.12"/>
</g>
<!-- layer_11_k_reshape&#45;&gt;layer_11_attn_scores -->
<g id="edge262" class="edge">
<title>layer_11_k_reshape&#45;&gt;layer_11_attn_scores</title>
<path fill="none" stroke="black" d="M1219.69,-6530.87C1216.37,-6522.62 1212.64,-6513.34 1209.1,-6504.54"/>
<polygon fill="black" stroke="black" points="1212.34,-6503.22 1205.36,-6495.25 1205.84,-6505.83 1212.34,-6503.22"/>
</g>
<!-- layer_11_attn_output -->
<g id="node220" class="node">
<title>layer_11_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1554,-6317 1330,-6317 1330,-6264 1554,-6264 1554,-6317"/>
<text text-anchor="middle" x="1442" y="-6301.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1442" y="-6286.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1442" y="-6271.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_v_reshape&#45;&gt;layer_11_attn_output -->
<g id="edge265" class="edge">
<title>layer_11_v_reshape&#45;&gt;layer_11_attn_output</title>
<path fill="none" stroke="black" d="M1442,-6441.91C1442,-6411.8 1442,-6361.61 1442,-6327.56"/>
<polygon fill="black" stroke="black" points="1445.5,-6327.12 1442,-6317.12 1438.5,-6327.12 1445.5,-6327.12"/>
</g>
<!-- layer_11_attn_weights -->
<g id="node219" class="node">
<title>layer_11_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1362.5,-6406 1129.5,-6406 1129.5,-6353 1362.5,-6353 1362.5,-6406"/>
<text text-anchor="middle" x="1246" y="-6390.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1246" y="-6375.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1246" y="-6360.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_scores&#45;&gt;layer_11_attn_weights -->
<g id="edge263" class="edge">
<title>layer_11_attn_scores&#45;&gt;layer_11_attn_weights</title>
<path fill="none" stroke="black" d="M1210.03,-6441.87C1214.96,-6433.45 1220.53,-6423.95 1225.79,-6414.98"/>
<polygon fill="black" stroke="black" points="1228.87,-6416.65 1230.91,-6406.25 1222.83,-6413.11 1228.87,-6416.65"/>
</g>
<!-- layer_11_attn_weights&#45;&gt;layer_11_attn_output -->
<g id="edge264" class="edge">
<title>layer_11_attn_weights&#45;&gt;layer_11_attn_output</title>
<path fill="none" stroke="black" d="M1303.48,-6352.98C1326.02,-6342.98 1352.03,-6331.44 1375.38,-6321.07"/>
<polygon fill="black" stroke="black" points="1376.8,-6324.27 1384.52,-6317.01 1373.96,-6317.87 1376.8,-6324.27"/>
</g>
<!-- layer_11_attn_reshape -->
<g id="node221" class="node">
<title>layer_11_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1549,-6228 1343,-6228 1343,-6175 1549,-6175 1549,-6228"/>
<text text-anchor="middle" x="1446" y="-6212.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1446" y="-6197.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1446" y="-6182.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_output&#45;&gt;layer_11_attn_reshape -->
<g id="edge266" class="edge">
<title>layer_11_attn_output&#45;&gt;layer_11_attn_reshape</title>
<path fill="none" stroke="black" d="M1443.18,-6263.87C1443.55,-6255.89 1443.96,-6246.93 1444.35,-6238.38"/>
<polygon fill="black" stroke="black" points="1447.85,-6238.4 1444.82,-6228.25 1440.86,-6238.08 1447.85,-6238.4"/>
</g>
<!-- layer_11_attn_proj -->
<g id="node222" class="node">
<title>layer_11_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1552,-6139 1346,-6139 1346,-6086 1552,-6086 1552,-6139"/>
<text text-anchor="middle" x="1449" y="-6123.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1449" y="-6108.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1449" y="-6093.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_attn_reshape&#45;&gt;layer_11_attn_proj -->
<g id="edge267" class="edge">
<title>layer_11_attn_reshape&#45;&gt;layer_11_attn_proj</title>
<path fill="none" stroke="black" d="M1446.88,-6174.87C1447.16,-6166.89 1447.47,-6157.93 1447.76,-6149.38"/>
<polygon fill="black" stroke="black" points="1451.27,-6149.36 1448.11,-6139.25 1444.27,-6149.12 1451.27,-6149.36"/>
</g>
<!-- layer_11_attn_proj&#45;&gt;layer_11_add1 -->
<g id="edge269" class="edge">
<title>layer_11_attn_proj&#45;&gt;layer_11_add1</title>
<path fill="none" stroke="black" d="M1468.15,-6085.87C1474.57,-6077.27 1481.84,-6067.55 1488.66,-6058.42"/>
<polygon fill="black" stroke="black" points="1491.58,-6060.36 1494.76,-6050.25 1485.97,-6056.17 1491.58,-6060.36"/>
</g>
<!-- layer_11_ln2 -->
<g id="node224" class="node">
<title>layer_11_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1552,-5961 1346,-5961 1346,-5908 1552,-5908 1552,-5961"/>
<text text-anchor="middle" x="1449" y="-5945.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1449" y="-5930.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1449" y="-5915.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_add1&#45;&gt;layer_11_ln2 -->
<g id="edge270" class="edge">
<title>layer_11_add1&#45;&gt;layer_11_ln2</title>
<path fill="none" stroke="black" d="M1494.85,-5996.87C1488.43,-5988.27 1481.16,-5978.55 1474.34,-5969.42"/>
<polygon fill="black" stroke="black" points="1477.03,-5967.17 1468.24,-5961.25 1471.42,-5971.36 1477.03,-5967.17"/>
</g>
<!-- layer_11_add -->
<g id="node228" class="node">
<title>layer_11_add</title>
<polygon fill="lightgreen" stroke="black" points="1617,-5605 1411,-5605 1411,-5552 1617,-5552 1617,-5605"/>
<text text-anchor="middle" x="1514" y="-5589.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1514" y="-5574.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1514" y="-5559.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_add1&#45;&gt;layer_11_add -->
<g id="edge274" class="edge">
<title>layer_11_add1&#45;&gt;layer_11_add</title>
<path fill="none" stroke="black" d="M1538.05,-5996.72C1546.52,-5986.32 1555.34,-5973.78 1561,-5961 1581.95,-5913.7 1582,-5898.24 1582,-5846.5 1582,-5846.5 1582,-5846.5 1582,-5755.5 1582,-5703.76 1581.95,-5688.3 1561,-5641 1556.71,-5631.32 1550.61,-5621.77 1544.21,-5613.19"/>
<polygon fill="black" stroke="black" points="1546.96,-5611.01 1538.05,-5605.28 1541.44,-5615.32 1546.96,-5611.01"/>
</g>
<!-- layer_11_ffn1 -->
<g id="node225" class="node">
<title>layer_11_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1553.5,-5872 1338.5,-5872 1338.5,-5819 1553.5,-5819 1553.5,-5872"/>
<text text-anchor="middle" x="1446" y="-5856.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1446" y="-5841.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1446" y="-5826.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ln2&#45;&gt;layer_11_ffn1 -->
<g id="edge271" class="edge">
<title>layer_11_ln2&#45;&gt;layer_11_ffn1</title>
<path fill="none" stroke="black" d="M1448.12,-5907.87C1447.84,-5899.89 1447.53,-5890.93 1447.24,-5882.38"/>
<polygon fill="black" stroke="black" points="1450.73,-5882.12 1446.89,-5872.25 1443.73,-5882.36 1450.73,-5882.12"/>
</g>
<!-- layer_11_gelu -->
<g id="node226" class="node">
<title>layer_11_gelu</title>
<polygon fill="lightblue" stroke="black" points="1553.5,-5783 1338.5,-5783 1338.5,-5730 1553.5,-5730 1553.5,-5783"/>
<text text-anchor="middle" x="1446" y="-5767.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1446" y="-5752.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1446" y="-5737.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_ffn1&#45;&gt;layer_11_gelu -->
<g id="edge272" class="edge">
<title>layer_11_ffn1&#45;&gt;layer_11_gelu</title>
<path fill="none" stroke="black" d="M1446,-5818.87C1446,-5810.89 1446,-5801.93 1446,-5793.38"/>
<polygon fill="black" stroke="black" points="1449.5,-5793.25 1446,-5783.25 1442.5,-5793.25 1449.5,-5793.25"/>
</g>
<!-- layer_11_ffn2 -->
<g id="node227" class="node">
<title>layer_11_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1552,-5694 1346,-5694 1346,-5641 1552,-5641 1552,-5694"/>
<text text-anchor="middle" x="1449" y="-5678.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1449" y="-5663.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1449" y="-5648.8" font-family="Times,serif" font-size="14.00">GPU 11</text>
</g>
<!-- layer_11_gelu&#45;&gt;layer_11_ffn2 -->
<g id="edge273" class="edge">
<title>layer_11_gelu&#45;&gt;layer_11_ffn2</title>
<path fill="none" stroke="black" d="M1446.88,-5729.87C1447.16,-5721.89 1447.47,-5712.93 1447.76,-5704.38"/>
<polygon fill="black" stroke="black" points="1451.27,-5704.36 1448.11,-5694.25 1444.27,-5704.12 1451.27,-5704.36"/>
</g>
<!-- layer_11_ffn2&#45;&gt;layer_11_add -->
<g id="edge275" class="edge">
<title>layer_11_ffn2&#45;&gt;layer_11_add</title>
<path fill="none" stroke="black" d="M1468.15,-5640.87C1474.57,-5632.27 1481.84,-5622.55 1488.66,-5613.42"/>
<polygon fill="black" stroke="black" points="1491.58,-5615.36 1494.76,-5605.25 1485.97,-5611.17 1491.58,-5615.36"/>
</g>
<!-- comm_11_12 -->
<g id="node229" class="node">
<title>comm_11_12</title>
<polygon fill="yellow" stroke="black" points="1727.64,-5516 1387.79,-5516 1300.36,-5410 1640.21,-5410 1727.64,-5516"/>
<text text-anchor="middle" x="1514" y="-5474.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1514" y="-5459.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1514" y="-5444.3" font-family="Times,serif" font-size="14.00">GPU 11 → GPU 12</text>
</g>
<!-- layer_11_add&#45;&gt;comm_11_12 -->
<g id="edge276" class="edge">
<title>layer_11_add&#45;&gt;comm_11_12</title>
<path fill="none" stroke="black" d="M1514,-5551.75C1514,-5544.05 1514,-5535.25 1514,-5526.27"/>
<polygon fill="black" stroke="black" points="1517.5,-5526.1 1514,-5516.1 1510.5,-5526.1 1517.5,-5526.1"/>
</g>
<!-- layer_12_ln1 -->
<g id="node230" class="node">
<title>layer_12_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1552,-5374 1346,-5374 1346,-5321 1552,-5321 1552,-5374"/>
<text text-anchor="middle" x="1449" y="-5358.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1449" y="-5343.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1449" y="-5328.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- comm_11_12&#45;&gt;layer_12_ln1 -->
<g id="edge277" class="edge">
<title>comm_11_12&#45;&gt;layer_12_ln1</title>
<path fill="none" stroke="black" d="M1484.16,-5409.9C1478.92,-5400.74 1473.58,-5391.42 1468.7,-5382.9"/>
<polygon fill="black" stroke="black" points="1471.62,-5380.95 1463.61,-5374.01 1465.54,-5384.43 1471.62,-5380.95"/>
</g>
<!-- layer_12_add1 -->
<g id="node242" class="node">
<title>layer_12_add1</title>
<polygon fill="lightgreen" stroke="black" points="1729,-4662 1523,-4662 1523,-4609 1729,-4609 1729,-4662"/>
<text text-anchor="middle" x="1626" y="-4646.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1626" y="-4631.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1626" y="-4616.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- comm_11_12&#45;&gt;layer_12_add1 -->
<g id="edge291" class="edge">
<title>comm_11_12&#45;&gt;layer_12_add1</title>
<path fill="none" stroke="black" d="M1598.99,-5409.8C1645.6,-5374.08 1694,-5321.94 1694,-5259.5 1694,-5259.5 1694,-5259.5 1694,-4812.5 1694,-4760.76 1693.95,-4745.3 1673,-4698 1668.71,-4688.32 1662.61,-4678.77 1656.21,-4670.19"/>
<polygon fill="black" stroke="black" points="1658.96,-4668.01 1650.05,-4662.28 1653.44,-4672.32 1658.96,-4668.01"/>
</g>
<!-- layer_12_q_proj -->
<g id="node231" class="node">
<title>layer_12_q_proj</title>
<polygon fill="lightblue" stroke="black" points="1212,-5285 1006,-5285 1006,-5232 1212,-5232 1212,-5285"/>
<text text-anchor="middle" x="1109" y="-5269.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1109" y="-5254.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1109" y="-5239.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_q_proj -->
<g id="edge278" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_q_proj</title>
<path fill="none" stroke="black" d="M1349.29,-5320.98C1308.2,-5310.47 1260.47,-5298.26 1218.43,-5287.5"/>
<polygon fill="black" stroke="black" points="1219.27,-5284.1 1208.71,-5285.01 1217.53,-5290.88 1219.27,-5284.1"/>
</g>
<!-- layer_12_k_proj -->
<g id="node232" class="node">
<title>layer_12_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1440,-5285 1234,-5285 1234,-5232 1440,-5232 1440,-5285"/>
<text text-anchor="middle" x="1337" y="-5269.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1337" y="-5254.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1337" y="-5239.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_k_proj -->
<g id="edge279" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_k_proj</title>
<path fill="none" stroke="black" d="M1416,-5320.87C1404.15,-5311.66 1390.62,-5301.15 1378.16,-5291.47"/>
<polygon fill="black" stroke="black" points="1380.19,-5288.62 1370.15,-5285.25 1375.9,-5294.15 1380.19,-5288.62"/>
</g>
<!-- layer_12_v_proj -->
<g id="node233" class="node">
<title>layer_12_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1664,-5285 1458,-5285 1458,-5232 1664,-5232 1664,-5285"/>
<text text-anchor="middle" x="1561" y="-5269.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1561" y="-5254.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1561" y="-5239.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln1&#45;&gt;layer_12_v_proj -->
<g id="edge280" class="edge">
<title>layer_12_ln1&#45;&gt;layer_12_v_proj</title>
<path fill="none" stroke="black" d="M1482,-5320.87C1493.85,-5311.66 1507.38,-5301.15 1519.84,-5291.47"/>
<polygon fill="black" stroke="black" points="1522.1,-5294.15 1527.85,-5285.25 1517.81,-5288.62 1522.1,-5294.15"/>
</g>
<!-- layer_12_q_reshape -->
<g id="node234" class="node">
<title>layer_12_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="1212,-5196 988,-5196 988,-5143 1212,-5143 1212,-5196"/>
<text text-anchor="middle" x="1100" y="-5180.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="1100" y="-5165.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1100" y="-5150.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_q_proj&#45;&gt;layer_12_q_reshape -->
<g id="edge281" class="edge">
<title>layer_12_q_proj&#45;&gt;layer_12_q_reshape</title>
<path fill="none" stroke="black" d="M1106.35,-5231.87C1105.52,-5223.89 1104.6,-5214.93 1103.71,-5206.38"/>
<polygon fill="black" stroke="black" points="1107.17,-5205.84 1102.66,-5196.25 1100.21,-5206.56 1107.17,-5205.84"/>
</g>
<!-- layer_12_k_reshape -->
<g id="node235" class="node">
<title>layer_12_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1454,-5196 1230,-5196 1230,-5143 1454,-5143 1454,-5196"/>
<text text-anchor="middle" x="1342" y="-5180.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1342" y="-5165.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1342" y="-5150.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_k_proj&#45;&gt;layer_12_k_reshape -->
<g id="edge282" class="edge">
<title>layer_12_k_proj&#45;&gt;layer_12_k_reshape</title>
<path fill="none" stroke="black" d="M1338.47,-5231.87C1338.93,-5223.89 1339.45,-5214.93 1339.94,-5206.38"/>
<polygon fill="black" stroke="black" points="1343.44,-5206.43 1340.52,-5196.25 1336.45,-5206.03 1343.44,-5206.43"/>
</g>
<!-- layer_12_v_reshape -->
<g id="node236" class="node">
<title>layer_12_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1666,-5107 1442,-5107 1442,-5054 1666,-5054 1666,-5107"/>
<text text-anchor="middle" x="1554" y="-5091.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1554" y="-5076.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1554" y="-5061.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_v_proj&#45;&gt;layer_12_v_reshape -->
<g id="edge283" class="edge">
<title>layer_12_v_proj&#45;&gt;layer_12_v_reshape</title>
<path fill="none" stroke="black" d="M1559.98,-5231.91C1558.78,-5201.67 1556.77,-5151.17 1555.42,-5117.12"/>
<polygon fill="black" stroke="black" points="1558.91,-5116.98 1555.02,-5107.12 1551.92,-5117.25 1558.91,-5116.98"/>
</g>
<!-- layer_12_attn_scores -->
<g id="node237" class="node">
<title>layer_12_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1423.5,-5107 1190.5,-5107 1190.5,-5054 1423.5,-5054 1423.5,-5107"/>
<text text-anchor="middle" x="1307" y="-5091.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1307" y="-5076.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1307" y="-5061.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_q_reshape&#45;&gt;layer_12_attn_scores -->
<g id="edge284" class="edge">
<title>layer_12_q_reshape&#45;&gt;layer_12_attn_scores</title>
<path fill="none" stroke="black" d="M1160.71,-5142.98C1184.61,-5132.94 1212.22,-5121.34 1236.96,-5110.94"/>
<polygon fill="black" stroke="black" points="1238.43,-5114.12 1246.29,-5107.01 1235.72,-5107.66 1238.43,-5114.12"/>
</g>
<!-- layer_12_k_reshape&#45;&gt;layer_12_attn_scores -->
<g id="edge285" class="edge">
<title>layer_12_k_reshape&#45;&gt;layer_12_attn_scores</title>
<path fill="none" stroke="black" d="M1331.69,-5142.87C1328.37,-5134.62 1324.64,-5125.34 1321.1,-5116.54"/>
<polygon fill="black" stroke="black" points="1324.34,-5115.22 1317.36,-5107.25 1317.84,-5117.83 1324.34,-5115.22"/>
</g>
<!-- layer_12_attn_output -->
<g id="node239" class="node">
<title>layer_12_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1666,-4929 1442,-4929 1442,-4876 1666,-4876 1666,-4929"/>
<text text-anchor="middle" x="1554" y="-4913.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1554" y="-4898.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1554" y="-4883.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_v_reshape&#45;&gt;layer_12_attn_output -->
<g id="edge288" class="edge">
<title>layer_12_v_reshape&#45;&gt;layer_12_attn_output</title>
<path fill="none" stroke="black" d="M1554,-5053.91C1554,-5023.8 1554,-4973.61 1554,-4939.56"/>
<polygon fill="black" stroke="black" points="1557.5,-4939.12 1554,-4929.12 1550.5,-4939.12 1557.5,-4939.12"/>
</g>
<!-- layer_12_attn_weights -->
<g id="node238" class="node">
<title>layer_12_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1474.5,-5018 1241.5,-5018 1241.5,-4965 1474.5,-4965 1474.5,-5018"/>
<text text-anchor="middle" x="1358" y="-5002.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1358" y="-4987.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1358" y="-4972.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_scores&#45;&gt;layer_12_attn_weights -->
<g id="edge286" class="edge">
<title>layer_12_attn_scores&#45;&gt;layer_12_attn_weights</title>
<path fill="none" stroke="black" d="M1322.03,-5053.87C1326.96,-5045.45 1332.53,-5035.95 1337.79,-5026.98"/>
<polygon fill="black" stroke="black" points="1340.87,-5028.65 1342.91,-5018.25 1334.83,-5025.11 1340.87,-5028.65"/>
</g>
<!-- layer_12_attn_weights&#45;&gt;layer_12_attn_output -->
<g id="edge287" class="edge">
<title>layer_12_attn_weights&#45;&gt;layer_12_attn_output</title>
<path fill="none" stroke="black" d="M1415.48,-4964.98C1438.02,-4954.98 1464.03,-4943.44 1487.38,-4933.07"/>
<polygon fill="black" stroke="black" points="1488.8,-4936.27 1496.52,-4929.01 1485.96,-4929.87 1488.8,-4936.27"/>
</g>
<!-- layer_12_attn_reshape -->
<g id="node240" class="node">
<title>layer_12_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1660,-4840 1454,-4840 1454,-4787 1660,-4787 1660,-4840"/>
<text text-anchor="middle" x="1557" y="-4824.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1557" y="-4809.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1557" y="-4794.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_output&#45;&gt;layer_12_attn_reshape -->
<g id="edge289" class="edge">
<title>layer_12_attn_output&#45;&gt;layer_12_attn_reshape</title>
<path fill="none" stroke="black" d="M1554.88,-4875.87C1555.16,-4867.89 1555.47,-4858.93 1555.76,-4850.38"/>
<polygon fill="black" stroke="black" points="1559.27,-4850.36 1556.11,-4840.25 1552.27,-4850.12 1559.27,-4850.36"/>
</g>
<!-- layer_12_attn_proj -->
<g id="node241" class="node">
<title>layer_12_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1664,-4751 1458,-4751 1458,-4698 1664,-4698 1664,-4751"/>
<text text-anchor="middle" x="1561" y="-4735.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1561" y="-4720.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1561" y="-4705.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_attn_reshape&#45;&gt;layer_12_attn_proj -->
<g id="edge290" class="edge">
<title>layer_12_attn_reshape&#45;&gt;layer_12_attn_proj</title>
<path fill="none" stroke="black" d="M1558.18,-4786.87C1558.55,-4778.89 1558.96,-4769.93 1559.35,-4761.38"/>
<polygon fill="black" stroke="black" points="1562.85,-4761.4 1559.82,-4751.25 1555.86,-4761.08 1562.85,-4761.4"/>
</g>
<!-- layer_12_attn_proj&#45;&gt;layer_12_add1 -->
<g id="edge292" class="edge">
<title>layer_12_attn_proj&#45;&gt;layer_12_add1</title>
<path fill="none" stroke="black" d="M1580.15,-4697.87C1586.57,-4689.27 1593.84,-4679.55 1600.66,-4670.42"/>
<polygon fill="black" stroke="black" points="1603.58,-4672.36 1606.76,-4662.25 1597.97,-4668.17 1603.58,-4672.36"/>
</g>
<!-- layer_12_ln2 -->
<g id="node243" class="node">
<title>layer_12_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1664,-4573 1458,-4573 1458,-4520 1664,-4520 1664,-4573"/>
<text text-anchor="middle" x="1561" y="-4557.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1561" y="-4542.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1561" y="-4527.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_add1&#45;&gt;layer_12_ln2 -->
<g id="edge293" class="edge">
<title>layer_12_add1&#45;&gt;layer_12_ln2</title>
<path fill="none" stroke="black" d="M1606.85,-4608.87C1600.43,-4600.27 1593.16,-4590.55 1586.34,-4581.42"/>
<polygon fill="black" stroke="black" points="1589.03,-4579.17 1580.24,-4573.25 1583.42,-4583.36 1589.03,-4579.17"/>
</g>
<!-- layer_12_add -->
<g id="node247" class="node">
<title>layer_12_add</title>
<polygon fill="lightgreen" stroke="black" points="1730,-4217 1524,-4217 1524,-4164 1730,-4164 1730,-4217"/>
<text text-anchor="middle" x="1627" y="-4201.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1627" y="-4186.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1627" y="-4171.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_add1&#45;&gt;layer_12_add -->
<g id="edge297" class="edge">
<title>layer_12_add1&#45;&gt;layer_12_add</title>
<path fill="none" stroke="black" d="M1650.05,-4608.72C1658.52,-4598.32 1667.34,-4585.78 1673,-4573 1693.95,-4525.7 1694,-4510.24 1694,-4458.5 1694,-4458.5 1694,-4458.5 1694,-4367.5 1694,-4315.68 1692.69,-4300.51 1672,-4253 1667.84,-4243.45 1661.98,-4233.95 1655.86,-4225.38"/>
<polygon fill="black" stroke="black" points="1658.5,-4223.07 1649.71,-4217.16 1652.89,-4227.26 1658.5,-4223.07"/>
</g>
<!-- layer_12_ffn1 -->
<g id="node244" class="node">
<title>layer_12_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1665.5,-4484 1450.5,-4484 1450.5,-4431 1665.5,-4431 1665.5,-4484"/>
<text text-anchor="middle" x="1558" y="-4468.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1558" y="-4453.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1558" y="-4438.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ln2&#45;&gt;layer_12_ffn1 -->
<g id="edge294" class="edge">
<title>layer_12_ln2&#45;&gt;layer_12_ffn1</title>
<path fill="none" stroke="black" d="M1560.12,-4519.87C1559.84,-4511.89 1559.53,-4502.93 1559.24,-4494.38"/>
<polygon fill="black" stroke="black" points="1562.73,-4494.12 1558.89,-4484.25 1555.73,-4494.36 1562.73,-4494.12"/>
</g>
<!-- layer_12_gelu -->
<g id="node245" class="node">
<title>layer_12_gelu</title>
<polygon fill="lightblue" stroke="black" points="1665.5,-4395 1450.5,-4395 1450.5,-4342 1665.5,-4342 1665.5,-4395"/>
<text text-anchor="middle" x="1558" y="-4379.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1558" y="-4364.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1558" y="-4349.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_ffn1&#45;&gt;layer_12_gelu -->
<g id="edge295" class="edge">
<title>layer_12_ffn1&#45;&gt;layer_12_gelu</title>
<path fill="none" stroke="black" d="M1558,-4430.87C1558,-4422.89 1558,-4413.93 1558,-4405.38"/>
<polygon fill="black" stroke="black" points="1561.5,-4405.25 1558,-4395.25 1554.5,-4405.25 1561.5,-4405.25"/>
</g>
<!-- layer_12_ffn2 -->
<g id="node246" class="node">
<title>layer_12_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1663,-4306 1457,-4306 1457,-4253 1663,-4253 1663,-4306"/>
<text text-anchor="middle" x="1560" y="-4290.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1560" y="-4275.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1560" y="-4260.8" font-family="Times,serif" font-size="14.00">GPU 12</text>
</g>
<!-- layer_12_gelu&#45;&gt;layer_12_ffn2 -->
<g id="edge296" class="edge">
<title>layer_12_gelu&#45;&gt;layer_12_ffn2</title>
<path fill="none" stroke="black" d="M1558.59,-4341.87C1558.77,-4333.89 1558.98,-4324.93 1559.18,-4316.38"/>
<polygon fill="black" stroke="black" points="1562.68,-4316.33 1559.41,-4306.25 1555.68,-4316.17 1562.68,-4316.33"/>
</g>
<!-- layer_12_ffn2&#45;&gt;layer_12_add -->
<g id="edge298" class="edge">
<title>layer_12_ffn2&#45;&gt;layer_12_add</title>
<path fill="none" stroke="black" d="M1579.74,-4252.87C1586.36,-4244.27 1593.85,-4234.55 1600.88,-4225.42"/>
<polygon fill="black" stroke="black" points="1603.84,-4227.31 1607.17,-4217.25 1598.3,-4223.04 1603.84,-4227.31"/>
</g>
<!-- comm_12_13 -->
<g id="node248" class="node">
<title>comm_12_13</title>
<polygon fill="yellow" stroke="black" points="1840.64,-4128 1500.79,-4128 1413.36,-4022 1753.21,-4022 1840.64,-4128"/>
<text text-anchor="middle" x="1627" y="-4086.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1627" y="-4071.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1627" y="-4056.3" font-family="Times,serif" font-size="14.00">GPU 12 → GPU 13</text>
</g>
<!-- layer_12_add&#45;&gt;comm_12_13 -->
<g id="edge299" class="edge">
<title>layer_12_add&#45;&gt;comm_12_13</title>
<path fill="none" stroke="black" d="M1627,-4163.75C1627,-4156.05 1627,-4147.25 1627,-4138.27"/>
<polygon fill="black" stroke="black" points="1630.5,-4138.1 1627,-4128.1 1623.5,-4138.1 1630.5,-4138.1"/>
</g>
<!-- layer_13_ln1 -->
<g id="node249" class="node">
<title>layer_13_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1553,-3986 1347,-3986 1347,-3933 1553,-3933 1553,-3986"/>
<text text-anchor="middle" x="1450" y="-3970.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1450" y="-3955.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1450" y="-3940.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- comm_12_13&#45;&gt;layer_13_ln1 -->
<g id="edge300" class="edge">
<title>comm_12_13&#45;&gt;layer_13_ln1</title>
<path fill="none" stroke="black" d="M1545.75,-4021.9C1529.5,-4011.48 1512.91,-4000.84 1498.21,-3991.41"/>
<polygon fill="black" stroke="black" points="1500.1,-3988.47 1489.79,-3986.01 1496.32,-3994.36 1500.1,-3988.47"/>
</g>
<!-- layer_13_add1 -->
<g id="node261" class="node">
<title>layer_13_add1</title>
<polygon fill="lightgreen" stroke="black" points="1752,-3274 1546,-3274 1546,-3221 1752,-3221 1752,-3274"/>
<text text-anchor="middle" x="1649" y="-3258.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1649" y="-3243.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1649" y="-3228.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- comm_12_13&#45;&gt;layer_13_add1 -->
<g id="edge314" class="edge">
<title>comm_12_13&#45;&gt;layer_13_add1</title>
<path fill="none" stroke="black" d="M1664.65,-4021.8C1689.31,-3982.46 1717,-3926.13 1717,-3871.5 1717,-3871.5 1717,-3871.5 1717,-3424.5 1717,-3372.76 1716.95,-3357.3 1696,-3310 1691.71,-3300.32 1685.61,-3290.77 1679.21,-3282.19"/>
<polygon fill="black" stroke="black" points="1681.96,-3280.01 1673.05,-3274.28 1676.44,-3284.32 1681.96,-3280.01"/>
</g>
<!-- layer_13_q_proj -->
<g id="node250" class="node">
<title>layer_13_q_proj</title>
<polygon fill="lightblue" stroke="black" points="1235,-3897 1029,-3897 1029,-3844 1235,-3844 1235,-3897"/>
<text text-anchor="middle" x="1132" y="-3881.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1132" y="-3866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1132" y="-3851.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_q_proj -->
<g id="edge301" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_q_proj</title>
<path fill="none" stroke="black" d="M1356.74,-3932.98C1318.56,-3922.54 1274.23,-3910.41 1235.09,-3899.7"/>
<polygon fill="black" stroke="black" points="1235.83,-3896.28 1225.26,-3897.01 1233.98,-3903.03 1235.83,-3896.28"/>
</g>
<!-- layer_13_k_proj -->
<g id="node251" class="node">
<title>layer_13_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1463,-3897 1257,-3897 1257,-3844 1463,-3844 1463,-3897"/>
<text text-anchor="middle" x="1360" y="-3881.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1360" y="-3866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1360" y="-3851.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_k_proj -->
<g id="edge302" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_k_proj</title>
<path fill="none" stroke="black" d="M1423.48,-3932.87C1414.23,-3923.92 1403.71,-3913.75 1393.93,-3904.3"/>
<polygon fill="black" stroke="black" points="1396.26,-3901.68 1386.64,-3897.25 1391.39,-3906.72 1396.26,-3901.68"/>
</g>
<!-- layer_13_v_proj -->
<g id="node252" class="node">
<title>layer_13_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1687,-3897 1481,-3897 1481,-3844 1687,-3844 1687,-3897"/>
<text text-anchor="middle" x="1584" y="-3881.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1584" y="-3866.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1584" y="-3851.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln1&#45;&gt;layer_13_v_proj -->
<g id="edge303" class="edge">
<title>layer_13_ln1&#45;&gt;layer_13_v_proj</title>
<path fill="none" stroke="black" d="M1489.48,-3932.87C1503.94,-3923.48 1520.46,-3912.75 1535.61,-3902.92"/>
<polygon fill="black" stroke="black" points="1537.86,-3905.63 1544.34,-3897.25 1534.05,-3899.76 1537.86,-3905.63"/>
</g>
<!-- layer_13_q_reshape -->
<g id="node253" class="node">
<title>layer_13_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="1235,-3808 1011,-3808 1011,-3755 1235,-3755 1235,-3808"/>
<text text-anchor="middle" x="1123" y="-3792.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="1123" y="-3777.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1123" y="-3762.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_q_proj&#45;&gt;layer_13_q_reshape -->
<g id="edge304" class="edge">
<title>layer_13_q_proj&#45;&gt;layer_13_q_reshape</title>
<path fill="none" stroke="black" d="M1129.35,-3843.87C1128.52,-3835.89 1127.6,-3826.93 1126.71,-3818.38"/>
<polygon fill="black" stroke="black" points="1130.17,-3817.84 1125.66,-3808.25 1123.21,-3818.56 1130.17,-3817.84"/>
</g>
<!-- layer_13_k_reshape -->
<g id="node254" class="node">
<title>layer_13_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1477,-3808 1253,-3808 1253,-3755 1477,-3755 1477,-3808"/>
<text text-anchor="middle" x="1365" y="-3792.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1365" y="-3777.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1365" y="-3762.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_k_proj&#45;&gt;layer_13_k_reshape -->
<g id="edge305" class="edge">
<title>layer_13_k_proj&#45;&gt;layer_13_k_reshape</title>
<path fill="none" stroke="black" d="M1361.47,-3843.87C1361.93,-3835.89 1362.45,-3826.93 1362.94,-3818.38"/>
<polygon fill="black" stroke="black" points="1366.44,-3818.43 1363.52,-3808.25 1359.45,-3818.03 1366.44,-3818.43"/>
</g>
<!-- layer_13_v_reshape -->
<g id="node255" class="node">
<title>layer_13_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1689,-3719 1465,-3719 1465,-3666 1689,-3666 1689,-3719"/>
<text text-anchor="middle" x="1577" y="-3703.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1577" y="-3688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1577" y="-3673.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_v_proj&#45;&gt;layer_13_v_reshape -->
<g id="edge306" class="edge">
<title>layer_13_v_proj&#45;&gt;layer_13_v_reshape</title>
<path fill="none" stroke="black" d="M1582.98,-3843.91C1581.78,-3813.67 1579.77,-3763.17 1578.42,-3729.12"/>
<polygon fill="black" stroke="black" points="1581.91,-3728.98 1578.02,-3719.12 1574.92,-3729.25 1581.91,-3728.98"/>
</g>
<!-- layer_13_attn_scores -->
<g id="node256" class="node">
<title>layer_13_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1446.5,-3719 1213.5,-3719 1213.5,-3666 1446.5,-3666 1446.5,-3719"/>
<text text-anchor="middle" x="1330" y="-3703.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1330" y="-3688.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1330" y="-3673.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_q_reshape&#45;&gt;layer_13_attn_scores -->
<g id="edge307" class="edge">
<title>layer_13_q_reshape&#45;&gt;layer_13_attn_scores</title>
<path fill="none" stroke="black" d="M1183.71,-3754.98C1207.61,-3744.94 1235.22,-3733.34 1259.96,-3722.94"/>
<polygon fill="black" stroke="black" points="1261.43,-3726.12 1269.29,-3719.01 1258.72,-3719.66 1261.43,-3726.12"/>
</g>
<!-- layer_13_k_reshape&#45;&gt;layer_13_attn_scores -->
<g id="edge308" class="edge">
<title>layer_13_k_reshape&#45;&gt;layer_13_attn_scores</title>
<path fill="none" stroke="black" d="M1354.69,-3754.87C1351.37,-3746.62 1347.64,-3737.34 1344.1,-3728.54"/>
<polygon fill="black" stroke="black" points="1347.34,-3727.22 1340.36,-3719.25 1340.84,-3729.83 1347.34,-3727.22"/>
</g>
<!-- layer_13_attn_output -->
<g id="node258" class="node">
<title>layer_13_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1689,-3541 1465,-3541 1465,-3488 1689,-3488 1689,-3541"/>
<text text-anchor="middle" x="1577" y="-3525.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1577" y="-3510.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1577" y="-3495.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_v_reshape&#45;&gt;layer_13_attn_output -->
<g id="edge311" class="edge">
<title>layer_13_v_reshape&#45;&gt;layer_13_attn_output</title>
<path fill="none" stroke="black" d="M1577,-3665.91C1577,-3635.8 1577,-3585.61 1577,-3551.56"/>
<polygon fill="black" stroke="black" points="1580.5,-3551.12 1577,-3541.12 1573.5,-3551.12 1580.5,-3551.12"/>
</g>
<!-- layer_13_attn_weights -->
<g id="node257" class="node">
<title>layer_13_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1497.5,-3630 1264.5,-3630 1264.5,-3577 1497.5,-3577 1497.5,-3630"/>
<text text-anchor="middle" x="1381" y="-3614.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1381" y="-3599.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1381" y="-3584.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_scores&#45;&gt;layer_13_attn_weights -->
<g id="edge309" class="edge">
<title>layer_13_attn_scores&#45;&gt;layer_13_attn_weights</title>
<path fill="none" stroke="black" d="M1345.03,-3665.87C1349.96,-3657.45 1355.53,-3647.95 1360.79,-3638.98"/>
<polygon fill="black" stroke="black" points="1363.87,-3640.65 1365.91,-3630.25 1357.83,-3637.11 1363.87,-3640.65"/>
</g>
<!-- layer_13_attn_weights&#45;&gt;layer_13_attn_output -->
<g id="edge310" class="edge">
<title>layer_13_attn_weights&#45;&gt;layer_13_attn_output</title>
<path fill="none" stroke="black" d="M1438.48,-3576.98C1461.02,-3566.98 1487.03,-3555.44 1510.38,-3545.07"/>
<polygon fill="black" stroke="black" points="1511.8,-3548.27 1519.52,-3541.01 1508.96,-3541.87 1511.8,-3548.27"/>
</g>
<!-- layer_13_attn_reshape -->
<g id="node259" class="node">
<title>layer_13_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1683,-3452 1477,-3452 1477,-3399 1683,-3399 1683,-3452"/>
<text text-anchor="middle" x="1580" y="-3436.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1580" y="-3421.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1580" y="-3406.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_output&#45;&gt;layer_13_attn_reshape -->
<g id="edge312" class="edge">
<title>layer_13_attn_output&#45;&gt;layer_13_attn_reshape</title>
<path fill="none" stroke="black" d="M1577.88,-3487.87C1578.16,-3479.89 1578.47,-3470.93 1578.76,-3462.38"/>
<polygon fill="black" stroke="black" points="1582.27,-3462.36 1579.11,-3452.25 1575.27,-3462.12 1582.27,-3462.36"/>
</g>
<!-- layer_13_attn_proj -->
<g id="node260" class="node">
<title>layer_13_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1687,-3363 1481,-3363 1481,-3310 1687,-3310 1687,-3363"/>
<text text-anchor="middle" x="1584" y="-3347.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1584" y="-3332.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1584" y="-3317.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_attn_reshape&#45;&gt;layer_13_attn_proj -->
<g id="edge313" class="edge">
<title>layer_13_attn_reshape&#45;&gt;layer_13_attn_proj</title>
<path fill="none" stroke="black" d="M1581.18,-3398.87C1581.55,-3390.89 1581.96,-3381.93 1582.35,-3373.38"/>
<polygon fill="black" stroke="black" points="1585.85,-3373.4 1582.82,-3363.25 1578.86,-3373.08 1585.85,-3373.4"/>
</g>
<!-- layer_13_attn_proj&#45;&gt;layer_13_add1 -->
<g id="edge315" class="edge">
<title>layer_13_attn_proj&#45;&gt;layer_13_add1</title>
<path fill="none" stroke="black" d="M1603.15,-3309.87C1609.57,-3301.27 1616.84,-3291.55 1623.66,-3282.42"/>
<polygon fill="black" stroke="black" points="1626.58,-3284.36 1629.76,-3274.25 1620.97,-3280.17 1626.58,-3284.36"/>
</g>
<!-- layer_13_ln2 -->
<g id="node262" class="node">
<title>layer_13_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1687,-3185 1481,-3185 1481,-3132 1687,-3132 1687,-3185"/>
<text text-anchor="middle" x="1584" y="-3169.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1584" y="-3154.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1584" y="-3139.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_add1&#45;&gt;layer_13_ln2 -->
<g id="edge316" class="edge">
<title>layer_13_add1&#45;&gt;layer_13_ln2</title>
<path fill="none" stroke="black" d="M1629.85,-3220.87C1623.43,-3212.27 1616.16,-3202.55 1609.34,-3193.42"/>
<polygon fill="black" stroke="black" points="1612.03,-3191.17 1603.24,-3185.25 1606.42,-3195.36 1612.03,-3191.17"/>
</g>
<!-- layer_13_add -->
<g id="node266" class="node">
<title>layer_13_add</title>
<polygon fill="lightgreen" stroke="black" points="1753,-2829 1547,-2829 1547,-2776 1753,-2776 1753,-2829"/>
<text text-anchor="middle" x="1650" y="-2813.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1650" y="-2798.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1650" y="-2783.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_add1&#45;&gt;layer_13_add -->
<g id="edge320" class="edge">
<title>layer_13_add1&#45;&gt;layer_13_add</title>
<path fill="none" stroke="black" d="M1673.05,-3220.72C1681.52,-3210.32 1690.34,-3197.78 1696,-3185 1716.95,-3137.7 1717,-3122.24 1717,-3070.5 1717,-3070.5 1717,-3070.5 1717,-2979.5 1717,-2927.68 1715.69,-2912.51 1695,-2865 1690.84,-2855.45 1684.98,-2845.95 1678.86,-2837.38"/>
<polygon fill="black" stroke="black" points="1681.5,-2835.07 1672.71,-2829.16 1675.89,-2839.26 1681.5,-2835.07"/>
</g>
<!-- layer_13_ffn1 -->
<g id="node263" class="node">
<title>layer_13_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1688.5,-3096 1473.5,-3096 1473.5,-3043 1688.5,-3043 1688.5,-3096"/>
<text text-anchor="middle" x="1581" y="-3080.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1581" y="-3065.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1581" y="-3050.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ln2&#45;&gt;layer_13_ffn1 -->
<g id="edge317" class="edge">
<title>layer_13_ln2&#45;&gt;layer_13_ffn1</title>
<path fill="none" stroke="black" d="M1583.12,-3131.87C1582.84,-3123.89 1582.53,-3114.93 1582.24,-3106.38"/>
<polygon fill="black" stroke="black" points="1585.73,-3106.12 1581.89,-3096.25 1578.73,-3106.36 1585.73,-3106.12"/>
</g>
<!-- layer_13_gelu -->
<g id="node264" class="node">
<title>layer_13_gelu</title>
<polygon fill="lightblue" stroke="black" points="1688.5,-3007 1473.5,-3007 1473.5,-2954 1688.5,-2954 1688.5,-3007"/>
<text text-anchor="middle" x="1581" y="-2991.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1581" y="-2976.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1581" y="-2961.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_ffn1&#45;&gt;layer_13_gelu -->
<g id="edge318" class="edge">
<title>layer_13_ffn1&#45;&gt;layer_13_gelu</title>
<path fill="none" stroke="black" d="M1581,-3042.87C1581,-3034.89 1581,-3025.93 1581,-3017.38"/>
<polygon fill="black" stroke="black" points="1584.5,-3017.25 1581,-3007.25 1577.5,-3017.25 1584.5,-3017.25"/>
</g>
<!-- layer_13_ffn2 -->
<g id="node265" class="node">
<title>layer_13_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1686,-2918 1480,-2918 1480,-2865 1686,-2865 1686,-2918"/>
<text text-anchor="middle" x="1583" y="-2902.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1583" y="-2887.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1583" y="-2872.8" font-family="Times,serif" font-size="14.00">GPU 13</text>
</g>
<!-- layer_13_gelu&#45;&gt;layer_13_ffn2 -->
<g id="edge319" class="edge">
<title>layer_13_gelu&#45;&gt;layer_13_ffn2</title>
<path fill="none" stroke="black" d="M1581.59,-2953.87C1581.77,-2945.89 1581.98,-2936.93 1582.18,-2928.38"/>
<polygon fill="black" stroke="black" points="1585.68,-2928.33 1582.41,-2918.25 1578.68,-2928.17 1585.68,-2928.33"/>
</g>
<!-- layer_13_ffn2&#45;&gt;layer_13_add -->
<g id="edge321" class="edge">
<title>layer_13_ffn2&#45;&gt;layer_13_add</title>
<path fill="none" stroke="black" d="M1602.74,-2864.87C1609.36,-2856.27 1616.85,-2846.55 1623.88,-2837.42"/>
<polygon fill="black" stroke="black" points="1626.84,-2839.31 1630.17,-2829.25 1621.3,-2835.04 1626.84,-2839.31"/>
</g>
<!-- comm_13_14 -->
<g id="node267" class="node">
<title>comm_13_14</title>
<polygon fill="yellow" stroke="black" points="1863.64,-2740 1523.79,-2740 1436.36,-2634 1776.21,-2634 1863.64,-2740"/>
<text text-anchor="middle" x="1650" y="-2698.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1650" y="-2683.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1650" y="-2668.3" font-family="Times,serif" font-size="14.00">GPU 13 → GPU 14</text>
</g>
<!-- layer_13_add&#45;&gt;comm_13_14 -->
<g id="edge322" class="edge">
<title>layer_13_add&#45;&gt;comm_13_14</title>
<path fill="none" stroke="black" d="M1650,-2775.75C1650,-2768.05 1650,-2759.25 1650,-2750.27"/>
<polygon fill="black" stroke="black" points="1653.5,-2750.1 1650,-2740.1 1646.5,-2750.1 1653.5,-2750.1"/>
</g>
<!-- layer_14_ln1 -->
<g id="node268" class="node">
<title>layer_14_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1688,-2598 1482,-2598 1482,-2545 1688,-2545 1688,-2598"/>
<text text-anchor="middle" x="1585" y="-2582.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1585" y="-2567.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1585" y="-2552.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- comm_13_14&#45;&gt;layer_14_ln1 -->
<g id="edge323" class="edge">
<title>comm_13_14&#45;&gt;layer_14_ln1</title>
<path fill="none" stroke="black" d="M1620.16,-2633.9C1614.92,-2624.74 1609.58,-2615.42 1604.7,-2606.9"/>
<polygon fill="black" stroke="black" points="1607.62,-2604.95 1599.61,-2598.01 1601.54,-2608.43 1607.62,-2604.95"/>
</g>
<!-- layer_14_add1 -->
<g id="node280" class="node">
<title>layer_14_add1</title>
<polygon fill="lightgreen" stroke="black" points="1865,-1886 1659,-1886 1659,-1833 1865,-1833 1865,-1886"/>
<text text-anchor="middle" x="1762" y="-1870.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1762" y="-1855.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1762" y="-1840.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- comm_13_14&#45;&gt;layer_14_add1 -->
<g id="edge337" class="edge">
<title>comm_13_14&#45;&gt;layer_14_add1</title>
<path fill="none" stroke="black" d="M1734.99,-2633.8C1781.6,-2598.08 1830,-2545.94 1830,-2483.5 1830,-2483.5 1830,-2483.5 1830,-2036.5 1830,-1984.76 1829.95,-1969.3 1809,-1922 1804.71,-1912.32 1798.61,-1902.77 1792.21,-1894.19"/>
<polygon fill="black" stroke="black" points="1794.96,-1892.01 1786.05,-1886.28 1789.44,-1896.32 1794.96,-1892.01"/>
</g>
<!-- layer_14_q_proj -->
<g id="node269" class="node">
<title>layer_14_q_proj</title>
<polygon fill="lightblue" stroke="black" points="1348,-2509 1142,-2509 1142,-2456 1348,-2456 1348,-2509"/>
<text text-anchor="middle" x="1245" y="-2493.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1245" y="-2478.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1245" y="-2463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_q_proj -->
<g id="edge324" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_q_proj</title>
<path fill="none" stroke="black" d="M1485.29,-2544.98C1444.2,-2534.47 1396.47,-2522.26 1354.43,-2511.5"/>
<polygon fill="black" stroke="black" points="1355.27,-2508.1 1344.71,-2509.01 1353.53,-2514.88 1355.27,-2508.1"/>
</g>
<!-- layer_14_k_proj -->
<g id="node270" class="node">
<title>layer_14_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1576,-2509 1370,-2509 1370,-2456 1576,-2456 1576,-2509"/>
<text text-anchor="middle" x="1473" y="-2493.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1473" y="-2478.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1473" y="-2463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_k_proj -->
<g id="edge325" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_k_proj</title>
<path fill="none" stroke="black" d="M1552,-2544.87C1540.15,-2535.66 1526.62,-2525.15 1514.16,-2515.47"/>
<polygon fill="black" stroke="black" points="1516.19,-2512.62 1506.15,-2509.25 1511.9,-2518.15 1516.19,-2512.62"/>
</g>
<!-- layer_14_v_proj -->
<g id="node271" class="node">
<title>layer_14_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1800,-2509 1594,-2509 1594,-2456 1800,-2456 1800,-2509"/>
<text text-anchor="middle" x="1697" y="-2493.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1697" y="-2478.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1697" y="-2463.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln1&#45;&gt;layer_14_v_proj -->
<g id="edge326" class="edge">
<title>layer_14_ln1&#45;&gt;layer_14_v_proj</title>
<path fill="none" stroke="black" d="M1618,-2544.87C1629.85,-2535.66 1643.38,-2525.15 1655.84,-2515.47"/>
<polygon fill="black" stroke="black" points="1658.1,-2518.15 1663.85,-2509.25 1653.81,-2512.62 1658.1,-2518.15"/>
</g>
<!-- layer_14_q_reshape -->
<g id="node272" class="node">
<title>layer_14_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="1348,-2420 1124,-2420 1124,-2367 1348,-2367 1348,-2420"/>
<text text-anchor="middle" x="1236" y="-2404.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="1236" y="-2389.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1236" y="-2374.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_q_proj&#45;&gt;layer_14_q_reshape -->
<g id="edge327" class="edge">
<title>layer_14_q_proj&#45;&gt;layer_14_q_reshape</title>
<path fill="none" stroke="black" d="M1242.35,-2455.87C1241.52,-2447.89 1240.6,-2438.93 1239.71,-2430.38"/>
<polygon fill="black" stroke="black" points="1243.17,-2429.84 1238.66,-2420.25 1236.21,-2430.56 1243.17,-2429.84"/>
</g>
<!-- layer_14_k_reshape -->
<g id="node273" class="node">
<title>layer_14_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1590,-2420 1366,-2420 1366,-2367 1590,-2367 1590,-2420"/>
<text text-anchor="middle" x="1478" y="-2404.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1478" y="-2389.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1478" y="-2374.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_k_proj&#45;&gt;layer_14_k_reshape -->
<g id="edge328" class="edge">
<title>layer_14_k_proj&#45;&gt;layer_14_k_reshape</title>
<path fill="none" stroke="black" d="M1474.47,-2455.87C1474.93,-2447.89 1475.45,-2438.93 1475.94,-2430.38"/>
<polygon fill="black" stroke="black" points="1479.44,-2430.43 1476.52,-2420.25 1472.45,-2430.03 1479.44,-2430.43"/>
</g>
<!-- layer_14_v_reshape -->
<g id="node274" class="node">
<title>layer_14_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1802,-2331 1578,-2331 1578,-2278 1802,-2278 1802,-2331"/>
<text text-anchor="middle" x="1690" y="-2315.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1690" y="-2300.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1690" y="-2285.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_v_proj&#45;&gt;layer_14_v_reshape -->
<g id="edge329" class="edge">
<title>layer_14_v_proj&#45;&gt;layer_14_v_reshape</title>
<path fill="none" stroke="black" d="M1695.98,-2455.91C1694.78,-2425.67 1692.77,-2375.17 1691.42,-2341.12"/>
<polygon fill="black" stroke="black" points="1694.91,-2340.98 1691.02,-2331.12 1687.92,-2341.25 1694.91,-2340.98"/>
</g>
<!-- layer_14_attn_scores -->
<g id="node275" class="node">
<title>layer_14_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1559.5,-2331 1326.5,-2331 1326.5,-2278 1559.5,-2278 1559.5,-2331"/>
<text text-anchor="middle" x="1443" y="-2315.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1443" y="-2300.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1443" y="-2285.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_q_reshape&#45;&gt;layer_14_attn_scores -->
<g id="edge330" class="edge">
<title>layer_14_q_reshape&#45;&gt;layer_14_attn_scores</title>
<path fill="none" stroke="black" d="M1296.71,-2366.98C1320.61,-2356.94 1348.22,-2345.34 1372.96,-2334.94"/>
<polygon fill="black" stroke="black" points="1374.43,-2338.12 1382.29,-2331.01 1371.72,-2331.66 1374.43,-2338.12"/>
</g>
<!-- layer_14_k_reshape&#45;&gt;layer_14_attn_scores -->
<g id="edge331" class="edge">
<title>layer_14_k_reshape&#45;&gt;layer_14_attn_scores</title>
<path fill="none" stroke="black" d="M1467.69,-2366.87C1464.37,-2358.62 1460.64,-2349.34 1457.1,-2340.54"/>
<polygon fill="black" stroke="black" points="1460.34,-2339.22 1453.36,-2331.25 1453.84,-2341.83 1460.34,-2339.22"/>
</g>
<!-- layer_14_attn_output -->
<g id="node277" class="node">
<title>layer_14_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1802,-2153 1578,-2153 1578,-2100 1802,-2100 1802,-2153"/>
<text text-anchor="middle" x="1690" y="-2137.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1690" y="-2122.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1690" y="-2107.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_v_reshape&#45;&gt;layer_14_attn_output -->
<g id="edge334" class="edge">
<title>layer_14_v_reshape&#45;&gt;layer_14_attn_output</title>
<path fill="none" stroke="black" d="M1690,-2277.91C1690,-2247.8 1690,-2197.61 1690,-2163.56"/>
<polygon fill="black" stroke="black" points="1693.5,-2163.12 1690,-2153.12 1686.5,-2163.12 1693.5,-2163.12"/>
</g>
<!-- layer_14_attn_weights -->
<g id="node276" class="node">
<title>layer_14_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1610.5,-2242 1377.5,-2242 1377.5,-2189 1610.5,-2189 1610.5,-2242"/>
<text text-anchor="middle" x="1494" y="-2226.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1494" y="-2211.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1494" y="-2196.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_scores&#45;&gt;layer_14_attn_weights -->
<g id="edge332" class="edge">
<title>layer_14_attn_scores&#45;&gt;layer_14_attn_weights</title>
<path fill="none" stroke="black" d="M1458.03,-2277.87C1462.96,-2269.45 1468.53,-2259.95 1473.79,-2250.98"/>
<polygon fill="black" stroke="black" points="1476.87,-2252.65 1478.91,-2242.25 1470.83,-2249.11 1476.87,-2252.65"/>
</g>
<!-- layer_14_attn_weights&#45;&gt;layer_14_attn_output -->
<g id="edge333" class="edge">
<title>layer_14_attn_weights&#45;&gt;layer_14_attn_output</title>
<path fill="none" stroke="black" d="M1551.48,-2188.98C1574.02,-2178.98 1600.03,-2167.44 1623.38,-2157.07"/>
<polygon fill="black" stroke="black" points="1624.8,-2160.27 1632.52,-2153.01 1621.96,-2153.87 1624.8,-2160.27"/>
</g>
<!-- layer_14_attn_reshape -->
<g id="node278" class="node">
<title>layer_14_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1797,-2064 1591,-2064 1591,-2011 1797,-2011 1797,-2064"/>
<text text-anchor="middle" x="1694" y="-2048.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1694" y="-2033.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1694" y="-2018.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_output&#45;&gt;layer_14_attn_reshape -->
<g id="edge335" class="edge">
<title>layer_14_attn_output&#45;&gt;layer_14_attn_reshape</title>
<path fill="none" stroke="black" d="M1691.18,-2099.87C1691.55,-2091.89 1691.96,-2082.93 1692.35,-2074.38"/>
<polygon fill="black" stroke="black" points="1695.85,-2074.4 1692.82,-2064.25 1688.86,-2074.08 1695.85,-2074.4"/>
</g>
<!-- layer_14_attn_proj -->
<g id="node279" class="node">
<title>layer_14_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1800,-1975 1594,-1975 1594,-1922 1800,-1922 1800,-1975"/>
<text text-anchor="middle" x="1697" y="-1959.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1697" y="-1944.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1697" y="-1929.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_attn_reshape&#45;&gt;layer_14_attn_proj -->
<g id="edge336" class="edge">
<title>layer_14_attn_reshape&#45;&gt;layer_14_attn_proj</title>
<path fill="none" stroke="black" d="M1694.88,-2010.87C1695.16,-2002.89 1695.47,-1993.93 1695.76,-1985.38"/>
<polygon fill="black" stroke="black" points="1699.27,-1985.36 1696.11,-1975.25 1692.27,-1985.12 1699.27,-1985.36"/>
</g>
<!-- layer_14_attn_proj&#45;&gt;layer_14_add1 -->
<g id="edge338" class="edge">
<title>layer_14_attn_proj&#45;&gt;layer_14_add1</title>
<path fill="none" stroke="black" d="M1716.15,-1921.87C1722.57,-1913.27 1729.84,-1903.55 1736.66,-1894.42"/>
<polygon fill="black" stroke="black" points="1739.58,-1896.36 1742.76,-1886.25 1733.97,-1892.17 1739.58,-1896.36"/>
</g>
<!-- layer_14_ln2 -->
<g id="node281" class="node">
<title>layer_14_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1800,-1797 1594,-1797 1594,-1744 1800,-1744 1800,-1797"/>
<text text-anchor="middle" x="1697" y="-1781.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1697" y="-1766.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1697" y="-1751.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_add1&#45;&gt;layer_14_ln2 -->
<g id="edge339" class="edge">
<title>layer_14_add1&#45;&gt;layer_14_ln2</title>
<path fill="none" stroke="black" d="M1742.85,-1832.87C1736.43,-1824.27 1729.16,-1814.55 1722.34,-1805.42"/>
<polygon fill="black" stroke="black" points="1725.03,-1803.17 1716.24,-1797.25 1719.42,-1807.36 1725.03,-1803.17"/>
</g>
<!-- layer_14_add -->
<g id="node285" class="node">
<title>layer_14_add</title>
<polygon fill="lightgreen" stroke="black" points="1865,-1441 1659,-1441 1659,-1388 1865,-1388 1865,-1441"/>
<text text-anchor="middle" x="1762" y="-1425.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1762" y="-1410.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1762" y="-1395.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_add1&#45;&gt;layer_14_add -->
<g id="edge343" class="edge">
<title>layer_14_add1&#45;&gt;layer_14_add</title>
<path fill="none" stroke="black" d="M1786.05,-1832.72C1794.52,-1822.32 1803.34,-1809.78 1809,-1797 1829.95,-1749.7 1830,-1734.24 1830,-1682.5 1830,-1682.5 1830,-1682.5 1830,-1591.5 1830,-1539.76 1829.95,-1524.3 1809,-1477 1804.71,-1467.32 1798.61,-1457.77 1792.21,-1449.19"/>
<polygon fill="black" stroke="black" points="1794.96,-1447.01 1786.05,-1441.28 1789.44,-1451.32 1794.96,-1447.01"/>
</g>
<!-- layer_14_ffn1 -->
<g id="node282" class="node">
<title>layer_14_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1801.5,-1708 1586.5,-1708 1586.5,-1655 1801.5,-1655 1801.5,-1708"/>
<text text-anchor="middle" x="1694" y="-1692.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1694" y="-1677.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1694" y="-1662.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ln2&#45;&gt;layer_14_ffn1 -->
<g id="edge340" class="edge">
<title>layer_14_ln2&#45;&gt;layer_14_ffn1</title>
<path fill="none" stroke="black" d="M1696.12,-1743.87C1695.84,-1735.89 1695.53,-1726.93 1695.24,-1718.38"/>
<polygon fill="black" stroke="black" points="1698.73,-1718.12 1694.89,-1708.25 1691.73,-1718.36 1698.73,-1718.12"/>
</g>
<!-- layer_14_gelu -->
<g id="node283" class="node">
<title>layer_14_gelu</title>
<polygon fill="lightblue" stroke="black" points="1801.5,-1619 1586.5,-1619 1586.5,-1566 1801.5,-1566 1801.5,-1619"/>
<text text-anchor="middle" x="1694" y="-1603.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1694" y="-1588.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1694" y="-1573.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_ffn1&#45;&gt;layer_14_gelu -->
<g id="edge341" class="edge">
<title>layer_14_ffn1&#45;&gt;layer_14_gelu</title>
<path fill="none" stroke="black" d="M1694,-1654.87C1694,-1646.89 1694,-1637.93 1694,-1629.38"/>
<polygon fill="black" stroke="black" points="1697.5,-1629.25 1694,-1619.25 1690.5,-1629.25 1697.5,-1629.25"/>
</g>
<!-- layer_14_ffn2 -->
<g id="node284" class="node">
<title>layer_14_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1800,-1530 1594,-1530 1594,-1477 1800,-1477 1800,-1530"/>
<text text-anchor="middle" x="1697" y="-1514.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1697" y="-1499.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1697" y="-1484.8" font-family="Times,serif" font-size="14.00">GPU 14</text>
</g>
<!-- layer_14_gelu&#45;&gt;layer_14_ffn2 -->
<g id="edge342" class="edge">
<title>layer_14_gelu&#45;&gt;layer_14_ffn2</title>
<path fill="none" stroke="black" d="M1694.88,-1565.87C1695.16,-1557.89 1695.47,-1548.93 1695.76,-1540.38"/>
<polygon fill="black" stroke="black" points="1699.27,-1540.36 1696.11,-1530.25 1692.27,-1540.12 1699.27,-1540.36"/>
</g>
<!-- layer_14_ffn2&#45;&gt;layer_14_add -->
<g id="edge344" class="edge">
<title>layer_14_ffn2&#45;&gt;layer_14_add</title>
<path fill="none" stroke="black" d="M1716.15,-1476.87C1722.57,-1468.27 1729.84,-1458.55 1736.66,-1449.42"/>
<polygon fill="black" stroke="black" points="1739.58,-1451.36 1742.76,-1441.25 1733.97,-1447.17 1739.58,-1451.36"/>
</g>
<!-- comm_14_15 -->
<g id="node286" class="node">
<title>comm_14_15</title>
<polygon fill="yellow" stroke="black" points="1975.64,-1352 1635.79,-1352 1548.36,-1246 1888.21,-1246 1975.64,-1352"/>
<text text-anchor="middle" x="1762" y="-1310.3" font-family="Times,serif" font-size="14.00">Layer Transfer</text>
<text text-anchor="middle" x="1762" y="-1295.3" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1762" y="-1280.3" font-family="Times,serif" font-size="14.00">GPU 14 → GPU 15</text>
</g>
<!-- layer_14_add&#45;&gt;comm_14_15 -->
<g id="edge345" class="edge">
<title>layer_14_add&#45;&gt;comm_14_15</title>
<path fill="none" stroke="black" d="M1762,-1387.75C1762,-1380.05 1762,-1371.25 1762,-1362.27"/>
<polygon fill="black" stroke="black" points="1765.5,-1362.1 1762,-1352.1 1758.5,-1362.1 1765.5,-1362.1"/>
</g>
<!-- layer_15_ln1 -->
<g id="node287" class="node">
<title>layer_15_ln1</title>
<polygon fill="lightcoral" stroke="black" points="1800,-1210 1594,-1210 1594,-1157 1800,-1157 1800,-1210"/>
<text text-anchor="middle" x="1697" y="-1194.8" font-family="Times,serif" font-size="14.00">LayerNorm 1</text>
<text text-anchor="middle" x="1697" y="-1179.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1697" y="-1164.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- comm_14_15&#45;&gt;layer_15_ln1 -->
<g id="edge346" class="edge">
<title>comm_14_15&#45;&gt;layer_15_ln1</title>
<path fill="none" stroke="black" d="M1732.16,-1245.9C1726.92,-1236.74 1721.58,-1227.42 1716.7,-1218.9"/>
<polygon fill="black" stroke="black" points="1719.62,-1216.95 1711.61,-1210.01 1713.54,-1220.43 1719.62,-1216.95"/>
</g>
<!-- layer_15_add1 -->
<g id="node299" class="node">
<title>layer_15_add1</title>
<polygon fill="lightgreen" stroke="black" points="1977,-498 1771,-498 1771,-445 1977,-445 1977,-498"/>
<text text-anchor="middle" x="1874" y="-482.8" font-family="Times,serif" font-size="14.00">Residual Add 1</text>
<text text-anchor="middle" x="1874" y="-467.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1874" y="-452.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- comm_14_15&#45;&gt;layer_15_add1 -->
<g id="edge360" class="edge">
<title>comm_14_15&#45;&gt;layer_15_add1</title>
<path fill="none" stroke="black" d="M1846.99,-1245.8C1893.6,-1210.08 1942,-1157.94 1942,-1095.5 1942,-1095.5 1942,-1095.5 1942,-648.5 1942,-596.76 1941.95,-581.3 1921,-534 1916.71,-524.32 1910.61,-514.77 1904.21,-506.19"/>
<polygon fill="black" stroke="black" points="1906.96,-504.01 1898.05,-498.28 1901.44,-508.32 1906.96,-504.01"/>
</g>
<!-- layer_15_q_proj -->
<g id="node288" class="node">
<title>layer_15_q_proj</title>
<polygon fill="lightblue" stroke="black" points="1460,-1121 1254,-1121 1254,-1068 1460,-1068 1460,-1121"/>
<text text-anchor="middle" x="1357" y="-1105.8" font-family="Times,serif" font-size="14.00">Q Projection</text>
<text text-anchor="middle" x="1357" y="-1090.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1357" y="-1075.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_q_proj -->
<g id="edge347" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_q_proj</title>
<path fill="none" stroke="black" d="M1597.29,-1156.98C1556.2,-1146.47 1508.47,-1134.26 1466.43,-1123.5"/>
<polygon fill="black" stroke="black" points="1467.27,-1120.1 1456.71,-1121.01 1465.53,-1126.88 1467.27,-1120.1"/>
</g>
<!-- layer_15_k_proj -->
<g id="node289" class="node">
<title>layer_15_k_proj</title>
<polygon fill="lightblue" stroke="black" points="1688,-1121 1482,-1121 1482,-1068 1688,-1068 1688,-1121"/>
<text text-anchor="middle" x="1585" y="-1105.8" font-family="Times,serif" font-size="14.00">K Projection</text>
<text text-anchor="middle" x="1585" y="-1090.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1585" y="-1075.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_k_proj -->
<g id="edge348" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_k_proj</title>
<path fill="none" stroke="black" d="M1664,-1156.87C1652.15,-1147.66 1638.62,-1137.15 1626.16,-1127.47"/>
<polygon fill="black" stroke="black" points="1628.19,-1124.62 1618.15,-1121.25 1623.9,-1130.15 1628.19,-1124.62"/>
</g>
<!-- layer_15_v_proj -->
<g id="node290" class="node">
<title>layer_15_v_proj</title>
<polygon fill="lightblue" stroke="black" points="1912,-1121 1706,-1121 1706,-1068 1912,-1068 1912,-1121"/>
<text text-anchor="middle" x="1809" y="-1105.8" font-family="Times,serif" font-size="14.00">V Projection</text>
<text text-anchor="middle" x="1809" y="-1090.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1809" y="-1075.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln1&#45;&gt;layer_15_v_proj -->
<g id="edge349" class="edge">
<title>layer_15_ln1&#45;&gt;layer_15_v_proj</title>
<path fill="none" stroke="black" d="M1730,-1156.87C1741.85,-1147.66 1755.38,-1137.15 1767.84,-1127.47"/>
<polygon fill="black" stroke="black" points="1770.1,-1130.15 1775.85,-1121.25 1765.81,-1124.62 1770.1,-1130.15"/>
</g>
<!-- layer_15_q_reshape -->
<g id="node291" class="node">
<title>layer_15_q_reshape</title>
<polygon fill="lightblue" stroke="black" points="1460,-1032 1236,-1032 1236,-979 1460,-979 1460,-1032"/>
<text text-anchor="middle" x="1348" y="-1016.8" font-family="Times,serif" font-size="14.00">Reshape Q</text>
<text text-anchor="middle" x="1348" y="-1001.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1348" y="-986.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_q_proj&#45;&gt;layer_15_q_reshape -->
<g id="edge350" class="edge">
<title>layer_15_q_proj&#45;&gt;layer_15_q_reshape</title>
<path fill="none" stroke="black" d="M1354.35,-1067.87C1353.52,-1059.89 1352.6,-1050.93 1351.71,-1042.38"/>
<polygon fill="black" stroke="black" points="1355.17,-1041.84 1350.66,-1032.25 1348.21,-1042.56 1355.17,-1041.84"/>
</g>
<!-- layer_15_k_reshape -->
<g id="node292" class="node">
<title>layer_15_k_reshape</title>
<polygon fill="lightblue" stroke="black" points="1702,-1032 1478,-1032 1478,-979 1702,-979 1702,-1032"/>
<text text-anchor="middle" x="1590" y="-1016.8" font-family="Times,serif" font-size="14.00">Reshape K</text>
<text text-anchor="middle" x="1590" y="-1001.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1590" y="-986.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_k_proj&#45;&gt;layer_15_k_reshape -->
<g id="edge351" class="edge">
<title>layer_15_k_proj&#45;&gt;layer_15_k_reshape</title>
<path fill="none" stroke="black" d="M1586.47,-1067.87C1586.93,-1059.89 1587.45,-1050.93 1587.94,-1042.38"/>
<polygon fill="black" stroke="black" points="1591.44,-1042.43 1588.52,-1032.25 1584.45,-1042.03 1591.44,-1042.43"/>
</g>
<!-- layer_15_v_reshape -->
<g id="node293" class="node">
<title>layer_15_v_reshape</title>
<polygon fill="lightblue" stroke="black" points="1914,-943 1690,-943 1690,-890 1914,-890 1914,-943"/>
<text text-anchor="middle" x="1802" y="-927.8" font-family="Times,serif" font-size="14.00">Reshape V</text>
<text text-anchor="middle" x="1802" y="-912.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1802" y="-897.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_v_proj&#45;&gt;layer_15_v_reshape -->
<g id="edge352" class="edge">
<title>layer_15_v_proj&#45;&gt;layer_15_v_reshape</title>
<path fill="none" stroke="black" d="M1807.98,-1067.91C1806.78,-1037.67 1804.77,-987.17 1803.42,-953.12"/>
<polygon fill="black" stroke="black" points="1806.91,-952.98 1803.02,-943.12 1799.92,-953.25 1806.91,-952.98"/>
</g>
<!-- layer_15_attn_scores -->
<g id="node294" class="node">
<title>layer_15_attn_scores</title>
<polygon fill="lightblue" stroke="black" points="1671.5,-943 1438.5,-943 1438.5,-890 1671.5,-890 1671.5,-943"/>
<text text-anchor="middle" x="1555" y="-927.8" font-family="Times,serif" font-size="14.00">QK^T Matmul</text>
<text text-anchor="middle" x="1555" y="-912.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1555" y="-897.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_q_reshape&#45;&gt;layer_15_attn_scores -->
<g id="edge353" class="edge">
<title>layer_15_q_reshape&#45;&gt;layer_15_attn_scores</title>
<path fill="none" stroke="black" d="M1408.71,-978.98C1432.61,-968.94 1460.22,-957.34 1484.96,-946.94"/>
<polygon fill="black" stroke="black" points="1486.43,-950.12 1494.29,-943.01 1483.72,-943.66 1486.43,-950.12"/>
</g>
<!-- layer_15_k_reshape&#45;&gt;layer_15_attn_scores -->
<g id="edge354" class="edge">
<title>layer_15_k_reshape&#45;&gt;layer_15_attn_scores</title>
<path fill="none" stroke="black" d="M1579.69,-978.87C1576.37,-970.62 1572.64,-961.34 1569.1,-952.54"/>
<polygon fill="black" stroke="black" points="1572.34,-951.22 1565.36,-943.25 1565.84,-953.83 1572.34,-951.22"/>
</g>
<!-- layer_15_attn_output -->
<g id="node296" class="node">
<title>layer_15_attn_output</title>
<polygon fill="lightblue" stroke="black" points="1914,-765 1690,-765 1690,-712 1914,-712 1914,-765"/>
<text text-anchor="middle" x="1802" y="-749.8" font-family="Times,serif" font-size="14.00">Weighted V</text>
<text text-anchor="middle" x="1802" y="-734.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 512]</text>
<text text-anchor="middle" x="1802" y="-719.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_v_reshape&#45;&gt;layer_15_attn_output -->
<g id="edge357" class="edge">
<title>layer_15_v_reshape&#45;&gt;layer_15_attn_output</title>
<path fill="none" stroke="black" d="M1802,-889.91C1802,-859.8 1802,-809.61 1802,-775.56"/>
<polygon fill="black" stroke="black" points="1805.5,-775.12 1802,-765.12 1798.5,-775.12 1805.5,-775.12"/>
</g>
<!-- layer_15_attn_weights -->
<g id="node295" class="node">
<title>layer_15_attn_weights</title>
<polygon fill="lightblue" stroke="black" points="1722.5,-854 1489.5,-854 1489.5,-801 1722.5,-801 1722.5,-854"/>
<text text-anchor="middle" x="1606" y="-838.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="1606" y="-823.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 16, 2048, 2048]</text>
<text text-anchor="middle" x="1606" y="-808.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_scores&#45;&gt;layer_15_attn_weights -->
<g id="edge355" class="edge">
<title>layer_15_attn_scores&#45;&gt;layer_15_attn_weights</title>
<path fill="none" stroke="black" d="M1570.03,-889.87C1574.96,-881.45 1580.53,-871.95 1585.79,-862.98"/>
<polygon fill="black" stroke="black" points="1588.87,-864.65 1590.91,-854.25 1582.83,-861.11 1588.87,-864.65"/>
</g>
<!-- layer_15_attn_weights&#45;&gt;layer_15_attn_output -->
<g id="edge356" class="edge">
<title>layer_15_attn_weights&#45;&gt;layer_15_attn_output</title>
<path fill="none" stroke="black" d="M1663.48,-800.98C1686.02,-790.98 1712.03,-779.44 1735.38,-769.07"/>
<polygon fill="black" stroke="black" points="1736.8,-772.27 1744.52,-765.01 1733.96,-765.87 1736.8,-772.27"/>
</g>
<!-- layer_15_attn_reshape -->
<g id="node297" class="node">
<title>layer_15_attn_reshape</title>
<polygon fill="lightblue" stroke="black" points="1908,-676 1702,-676 1702,-623 1908,-623 1908,-676"/>
<text text-anchor="middle" x="1805" y="-660.8" font-family="Times,serif" font-size="14.00">Reshape Back</text>
<text text-anchor="middle" x="1805" y="-645.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1805" y="-630.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_output&#45;&gt;layer_15_attn_reshape -->
<g id="edge358" class="edge">
<title>layer_15_attn_output&#45;&gt;layer_15_attn_reshape</title>
<path fill="none" stroke="black" d="M1802.88,-711.87C1803.16,-703.89 1803.47,-694.93 1803.76,-686.38"/>
<polygon fill="black" stroke="black" points="1807.27,-686.36 1804.11,-676.25 1800.27,-686.12 1807.27,-686.36"/>
</g>
<!-- layer_15_attn_proj -->
<g id="node298" class="node">
<title>layer_15_attn_proj</title>
<polygon fill="lightblue" stroke="black" points="1912,-587 1706,-587 1706,-534 1912,-534 1912,-587"/>
<text text-anchor="middle" x="1809" y="-571.8" font-family="Times,serif" font-size="14.00">Output Projection</text>
<text text-anchor="middle" x="1809" y="-556.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1809" y="-541.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_attn_reshape&#45;&gt;layer_15_attn_proj -->
<g id="edge359" class="edge">
<title>layer_15_attn_reshape&#45;&gt;layer_15_attn_proj</title>
<path fill="none" stroke="black" d="M1806.18,-622.87C1806.55,-614.89 1806.96,-605.93 1807.35,-597.38"/>
<polygon fill="black" stroke="black" points="1810.85,-597.4 1807.82,-587.25 1803.86,-597.08 1810.85,-597.4"/>
</g>
<!-- layer_15_attn_proj&#45;&gt;layer_15_add1 -->
<g id="edge361" class="edge">
<title>layer_15_attn_proj&#45;&gt;layer_15_add1</title>
<path fill="none" stroke="black" d="M1828.15,-533.87C1834.57,-525.27 1841.84,-515.55 1848.66,-506.42"/>
<polygon fill="black" stroke="black" points="1851.58,-508.36 1854.76,-498.25 1845.97,-504.17 1851.58,-508.36"/>
</g>
<!-- layer_15_ln2 -->
<g id="node300" class="node">
<title>layer_15_ln2</title>
<polygon fill="lightcoral" stroke="black" points="1909,-409 1703,-409 1703,-356 1909,-356 1909,-409"/>
<text text-anchor="middle" x="1806" y="-393.8" font-family="Times,serif" font-size="14.00">LayerNorm 2</text>
<text text-anchor="middle" x="1806" y="-378.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1806" y="-363.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_add1&#45;&gt;layer_15_ln2 -->
<g id="edge362" class="edge">
<title>layer_15_add1&#45;&gt;layer_15_ln2</title>
<path fill="none" stroke="black" d="M1853.97,-444.87C1847.18,-436.18 1839.49,-426.35 1832.29,-417.14"/>
<polygon fill="black" stroke="black" points="1835.04,-414.97 1826.13,-409.25 1829.53,-419.28 1835.04,-414.97"/>
</g>
<!-- layer_15_add -->
<g id="node304" class="node">
<title>layer_15_add</title>
<polygon fill="lightgreen" stroke="black" points="1975,-53 1769,-53 1769,0 1975,0 1975,-53"/>
<text text-anchor="middle" x="1872" y="-37.8" font-family="Times,serif" font-size="14.00">Residual Add 2</text>
<text text-anchor="middle" x="1872" y="-22.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1872" y="-7.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_add1&#45;&gt;layer_15_add -->
<g id="edge366" class="edge">
<title>layer_15_add1&#45;&gt;layer_15_add</title>
<path fill="none" stroke="black" d="M1896.19,-444.77C1904.18,-434.29 1912.56,-421.67 1918,-409 1938.44,-361.38 1940,-346.32 1940,-294.5 1940,-294.5 1940,-294.5 1940,-203.5 1940,-151.76 1939.95,-136.3 1919,-89 1914.71,-79.32 1908.61,-69.77 1902.21,-61.19"/>
<polygon fill="black" stroke="black" points="1904.96,-59.01 1896.05,-53.28 1899.44,-63.32 1904.96,-59.01"/>
</g>
<!-- layer_15_ffn1 -->
<g id="node301" class="node">
<title>layer_15_ffn1</title>
<polygon fill="lightblue" stroke="black" points="1911.5,-320 1696.5,-320 1696.5,-267 1911.5,-267 1911.5,-320"/>
<text text-anchor="middle" x="1804" y="-304.8" font-family="Times,serif" font-size="14.00">FFN First Linear</text>
<text text-anchor="middle" x="1804" y="-289.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1804" y="-274.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ln2&#45;&gt;layer_15_ffn1 -->
<g id="edge363" class="edge">
<title>layer_15_ln2&#45;&gt;layer_15_ffn1</title>
<path fill="none" stroke="black" d="M1805.41,-355.87C1805.23,-347.89 1805.02,-338.93 1804.82,-330.38"/>
<polygon fill="black" stroke="black" points="1808.32,-330.17 1804.59,-320.25 1801.32,-330.33 1808.32,-330.17"/>
</g>
<!-- layer_15_gelu -->
<g id="node302" class="node">
<title>layer_15_gelu</title>
<polygon fill="lightblue" stroke="black" points="1911.5,-231 1696.5,-231 1696.5,-178 1911.5,-178 1911.5,-231"/>
<text text-anchor="middle" x="1804" y="-215.8" font-family="Times,serif" font-size="14.00">GELU Activation</text>
<text text-anchor="middle" x="1804" y="-200.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 32768]</text>
<text text-anchor="middle" x="1804" y="-185.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_ffn1&#45;&gt;layer_15_gelu -->
<g id="edge364" class="edge">
<title>layer_15_ffn1&#45;&gt;layer_15_gelu</title>
<path fill="none" stroke="black" d="M1804,-266.87C1804,-258.89 1804,-249.93 1804,-241.38"/>
<polygon fill="black" stroke="black" points="1807.5,-241.25 1804,-231.25 1800.5,-241.25 1807.5,-241.25"/>
</g>
<!-- layer_15_ffn2 -->
<g id="node303" class="node">
<title>layer_15_ffn2</title>
<polygon fill="lightblue" stroke="black" points="1910,-142 1704,-142 1704,-89 1910,-89 1910,-142"/>
<text text-anchor="middle" x="1807" y="-126.8" font-family="Times,serif" font-size="14.00">FFN Second Linear</text>
<text text-anchor="middle" x="1807" y="-111.8" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="1807" y="-96.8" font-family="Times,serif" font-size="14.00">GPU 15</text>
</g>
<!-- layer_15_gelu&#45;&gt;layer_15_ffn2 -->
<g id="edge365" class="edge">
<title>layer_15_gelu&#45;&gt;layer_15_ffn2</title>
<path fill="none" stroke="black" d="M1804.88,-177.87C1805.16,-169.89 1805.47,-160.93 1805.76,-152.38"/>
<polygon fill="black" stroke="black" points="1809.27,-152.36 1806.11,-142.25 1802.27,-152.12 1809.27,-152.36"/>
</g>
<!-- layer_15_ffn2&#45;&gt;layer_15_add -->
<g id="edge367" class="edge">
<title>layer_15_ffn2&#45;&gt;layer_15_add</title>
<path fill="none" stroke="black" d="M1826.15,-88.87C1832.57,-80.27 1839.84,-70.55 1846.66,-61.42"/>
<polygon fill="black" stroke="black" points="1849.58,-63.36 1852.76,-53.25 1843.97,-59.17 1849.58,-63.36"/>
</g>
<!-- output -->
<g id="node305" class="node">
<title>output</title>
<ellipse fill="lightgreen" stroke="black" cx="925" cy="-22014.48" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="925" y="-22025.78" font-family="Times,serif" font-size="14.00">Total Output</text>
<text text-anchor="middle" x="925" y="-22010.78" font-family="Times,serif" font-size="14.00">Shape: [1024, 2048, 8192]</text>
<text text-anchor="middle" x="925" y="-21995.78" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- comm_15_16 -->
<g id="node306" class="node">
<title>comm_15_16</title>
<polygon fill="lightblue" stroke="black" points="979.5,-22143.43 870.5,-22143.43 870.5,-22107.43 979.5,-22107.43 979.5,-22143.43"/>
<text text-anchor="middle" x="925" y="-22121.73" font-family="Times,serif" font-size="14.00">comm_15_16</text>
</g>
<!-- comm_15_16&#45;&gt;output -->
<g id="edge368" class="edge">
<title>comm_15_16&#45;&gt;output</title>
<path fill="none" stroke="black" d="M925,-22107.41C925,-22095.33 925,-22078.49 925,-22062.52"/>
<polygon fill="black" stroke="black" points="928.5,-22062.21 925,-22052.21 921.5,-22062.21 928.5,-22062.21"/>
</g>
</g>
</svg>
