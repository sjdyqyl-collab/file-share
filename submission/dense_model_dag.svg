<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: Dense_Model_Layerwise_Deployment Pages: 1 -->
<svg width="181pt" height="2160pt"
 viewBox="0.00 0.00 181.31 2160.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.11 0.11) rotate(0) translate(4 18849.16)">
<title>Dense_Model_Layerwise_Deployment</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-18849.16 1578.5,-18849.16 1578.5,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_gpu_0</title>
<path fill="none" stroke="blue" d="M663,-17623.25C663,-17623.25 1349,-17623.25 1349,-17623.25 1355,-17623.25 1361,-17629.25 1361,-17635.25 1361,-17635.25 1361,-18731.21 1361,-18731.21 1361,-18737.21 1355,-18743.21 1349,-18743.21 1349,-18743.21 663,-18743.21 663,-18743.21 657,-18743.21 651,-18737.21 651,-18731.21 651,-18731.21 651,-17635.25 651,-17635.25 651,-17629.25 657,-17623.25 663,-17623.25"/>
<text text-anchor="middle" x="1006" y="-18728.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_gpu_1</title>
<path fill="none" stroke="blue" d="M483,-16455.3C483,-16455.3 1169,-16455.3 1169,-16455.3 1175,-16455.3 1181,-16461.3 1181,-16467.3 1181,-16467.3 1181,-17563.25 1181,-17563.25 1181,-17569.25 1175,-17575.25 1169,-17575.25 1169,-17575.25 483,-17575.25 483,-17575.25 477,-17575.25 471,-17569.25 471,-17563.25 471,-17563.25 471,-16467.3 471,-16467.3 471,-16461.3 477,-16455.3 483,-16455.3"/>
<text text-anchor="middle" x="826" y="-17560.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_gpu_2</title>
<path fill="none" stroke="blue" d="M387,-15287.35C387,-15287.35 1073,-15287.35 1073,-15287.35 1079,-15287.35 1085,-15293.35 1085,-15299.35 1085,-15299.35 1085,-16395.3 1085,-16395.3 1085,-16401.3 1079,-16407.3 1073,-16407.3 1073,-16407.3 387,-16407.3 387,-16407.3 381,-16407.3 375,-16401.3 375,-16395.3 375,-16395.3 375,-15299.35 375,-15299.35 375,-15293.35 381,-15287.35 387,-15287.35"/>
<text text-anchor="middle" x="730" y="-16392.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu_3</title>
<path fill="none" stroke="blue" d="M201,-14119.39C201,-14119.39 887,-14119.39 887,-14119.39 893,-14119.39 899,-14125.39 899,-14131.39 899,-14131.39 899,-15227.35 899,-15227.35 899,-15233.35 893,-15239.35 887,-15239.35 887,-15239.35 201,-15239.35 201,-15239.35 195,-15239.35 189,-15233.35 189,-15227.35 189,-15227.35 189,-14131.39 189,-14131.39 189,-14125.39 195,-14119.39 201,-14119.39"/>
<text text-anchor="middle" x="544" y="-15224.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu_4</title>
<path fill="none" stroke="blue" d="M62,-12951.44C62,-12951.44 748,-12951.44 748,-12951.44 754,-12951.44 760,-12957.44 760,-12963.44 760,-12963.44 760,-14059.39 760,-14059.39 760,-14065.39 754,-14071.39 748,-14071.39 748,-14071.39 62,-14071.39 62,-14071.39 56,-14071.39 50,-14065.39 50,-14059.39 50,-14059.39 50,-12963.44 50,-12963.44 50,-12957.44 56,-12951.44 62,-12951.44"/>
<text text-anchor="middle" x="405" y="-14056.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu_5</title>
<path fill="none" stroke="blue" d="M62,-11783.49C62,-11783.49 748,-11783.49 748,-11783.49 754,-11783.49 760,-11789.49 760,-11795.49 760,-11795.49 760,-12891.44 760,-12891.44 760,-12897.44 754,-12903.44 748,-12903.44 748,-12903.44 62,-12903.44 62,-12903.44 56,-12903.44 50,-12897.44 50,-12891.44 50,-12891.44 50,-11795.49 50,-11795.49 50,-11789.49 56,-11783.49 62,-11783.49"/>
<text text-anchor="middle" x="405" y="-12888.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu_6</title>
<path fill="none" stroke="blue" d="M62,-10615.53C62,-10615.53 748,-10615.53 748,-10615.53 754,-10615.53 760,-10621.53 760,-10627.53 760,-10627.53 760,-11723.49 760,-11723.49 760,-11729.49 754,-11735.49 748,-11735.49 748,-11735.49 62,-11735.49 62,-11735.49 56,-11735.49 50,-11729.49 50,-11723.49 50,-11723.49 50,-10627.53 50,-10627.53 50,-10621.53 56,-10615.53 62,-10615.53"/>
<text text-anchor="middle" x="405" y="-11720.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu_7</title>
<path fill="none" stroke="blue" d="M62,-9447.58C62,-9447.58 748,-9447.58 748,-9447.58 754,-9447.58 760,-9453.58 760,-9459.58 760,-9459.58 760,-10555.53 760,-10555.53 760,-10561.53 754,-10567.53 748,-10567.53 748,-10567.53 62,-10567.53 62,-10567.53 56,-10567.53 50,-10561.53 50,-10555.53 50,-10555.53 50,-9459.58 50,-9459.58 50,-9453.58 56,-9447.58 62,-9447.58"/>
<text text-anchor="middle" x="405" y="-10552.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu_8</title>
<path fill="none" stroke="blue" d="M35,-8279.63C35,-8279.63 721,-8279.63 721,-8279.63 727,-8279.63 733,-8285.63 733,-8291.63 733,-8291.63 733,-9387.58 733,-9387.58 733,-9393.58 727,-9399.58 721,-9399.58 721,-9399.58 35,-9399.58 35,-9399.58 29,-9399.58 23,-9393.58 23,-9387.58 23,-9387.58 23,-8291.63 23,-8291.63 23,-8285.63 29,-8279.63 35,-8279.63"/>
<text text-anchor="middle" x="378" y="-9384.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu_9</title>
<path fill="none" stroke="blue" d="M50,-7111.67C50,-7111.67 736,-7111.67 736,-7111.67 742,-7111.67 748,-7117.67 748,-7123.67 748,-7123.67 748,-8219.63 748,-8219.63 748,-8225.63 742,-8231.63 736,-8231.63 736,-8231.63 50,-8231.63 50,-8231.63 44,-8231.63 38,-8225.63 38,-8219.63 38,-8219.63 38,-7123.67 38,-7123.67 38,-7117.67 44,-7111.67 50,-7111.67"/>
<text text-anchor="middle" x="393" y="-8216.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu_10</title>
<path fill="none" stroke="blue" d="M20,-5943.72C20,-5943.72 706,-5943.72 706,-5943.72 712,-5943.72 718,-5949.72 718,-5955.72 718,-5955.72 718,-7051.67 718,-7051.67 718,-7057.67 712,-7063.67 706,-7063.67 706,-7063.67 20,-7063.67 20,-7063.67 14,-7063.67 8,-7057.67 8,-7051.67 8,-7051.67 8,-5955.72 8,-5955.72 8,-5949.72 14,-5943.72 20,-5943.72"/>
<text text-anchor="middle" x="363" y="-7048.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_gpu_11</title>
<path fill="none" stroke="blue" d="M53,-4775.77C53,-4775.77 739,-4775.77 739,-4775.77 745,-4775.77 751,-4781.77 751,-4787.77 751,-4787.77 751,-5883.72 751,-5883.72 751,-5889.72 745,-5895.72 739,-5895.72 739,-5895.72 53,-5895.72 53,-5895.72 47,-5895.72 41,-5889.72 41,-5883.72 41,-5883.72 41,-4787.77 41,-4787.77 41,-4781.77 47,-4775.77 53,-4775.77"/>
<text text-anchor="middle" x="396" y="-5880.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_gpu_12</title>
<path fill="none" stroke="blue" d="M35,-3607.81C35,-3607.81 721,-3607.81 721,-3607.81 727,-3607.81 733,-3613.81 733,-3619.81 733,-3619.81 733,-4715.77 733,-4715.77 733,-4721.77 727,-4727.77 721,-4727.77 721,-4727.77 35,-4727.77 35,-4727.77 29,-4727.77 23,-4721.77 23,-4715.77 23,-4715.77 23,-3619.81 23,-3619.81 23,-3613.81 29,-3607.81 35,-3607.81"/>
<text text-anchor="middle" x="378" y="-4712.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu_13</title>
<path fill="none" stroke="blue" d="M41,-2439.86C41,-2439.86 727,-2439.86 727,-2439.86 733,-2439.86 739,-2445.86 739,-2451.86 739,-2451.86 739,-3547.81 739,-3547.81 739,-3553.81 733,-3559.81 727,-3559.81 727,-3559.81 41,-3559.81 41,-3559.81 35,-3559.81 29,-3553.81 29,-3547.81 29,-3547.81 29,-2451.86 29,-2451.86 29,-2445.86 35,-2439.86 41,-2439.86"/>
<text text-anchor="middle" x="384" y="-3544.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu_14</title>
<path fill="none" stroke="blue" d="M24,-1271.91C24,-1271.91 710,-1271.91 710,-1271.91 716,-1271.91 722,-1277.91 722,-1283.91 722,-1283.91 722,-2379.86 722,-2379.86 722,-2385.86 716,-2391.86 710,-2391.86 710,-2391.86 24,-2391.86 24,-2391.86 18,-2391.86 12,-2385.86 12,-2379.86 12,-2379.86 12,-1283.91 12,-1283.91 12,-1277.91 18,-1271.91 24,-1271.91"/>
<text text-anchor="middle" x="367" y="-2376.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu_15</title>
<path fill="none" stroke="blue" d="M58,-103.95C58,-103.95 744,-103.95 744,-103.95 750,-103.95 756,-109.95 756,-115.95 756,-115.95 756,-1211.91 756,-1211.91 756,-1217.91 750,-1223.91 744,-1223.91 744,-1223.91 58,-1223.91 58,-1223.91 52,-1223.91 46,-1217.91 46,-1211.91 46,-1211.91 46,-115.95 46,-115.95 46,-109.95 52,-103.95 58,-103.95"/>
<text text-anchor="middle" x="401" y="-1208.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightgreen" stroke="black" cx="1356" cy="-18807.68" rx="218.49" ry="37.45"/>
<text text-anchor="middle" x="1356" y="-18818.98" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="1356" y="-18803.98" font-family="Times,serif" font-size="14.00">[Batch=1024, Seq=2048, Hidden=4096]</text>
<text text-anchor="middle" x="1356" y="-18788.98" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1 -->
<g id="node2" class="node">
<title>ln1_1</title>
<polygon fill="lightyellow" stroke="black" points="1160.5,-18712.21 1001.5,-18712.21 1001.5,-18659.21 1160.5,-18659.21 1160.5,-18712.21"/>
<text text-anchor="middle" x="1081" y="-18697.01" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="1081" y="-18682.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1081" y="-18667.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- input&#45;&gt;ln1_1 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M1277.93,-18772.62C1237.21,-18754.86 1187.88,-18733.33 1148.78,-18716.28"/>
<polygon fill="black" stroke="black" points="1150.14,-18713.05 1139.58,-18712.26 1147.34,-18719.47 1150.14,-18713.05"/>
</g>
<!-- residual1_1 -->
<g id="node8" class="node">
<title>residual1_1</title>
<polygon fill="lightpink" stroke="black" points="1349.69,-18352.21 1087.71,-18352.21 1020.31,-18246.21 1282.29,-18246.21 1349.69,-18352.21"/>
<text text-anchor="middle" x="1185" y="-18310.51" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1185" y="-18295.51" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1185" y="-18280.51" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- input&#45;&gt;residual1_1 -->
<g id="edge9" class="edge">
<title>input&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M1367.69,-18770.07C1374.2,-18746.52 1381,-18715.11 1381,-18686.71 1381,-18686.71 1381,-18686.71 1381,-18414.71 1381,-18392.18 1371.23,-18374.01 1356.06,-18359.37"/>
<polygon fill="black" stroke="black" points="1358.02,-18356.43 1348.19,-18352.46 1353.4,-18361.69 1358.02,-18356.43"/>
</g>
<!-- mha_q_1 -->
<g id="node3" class="node">
<title>mha_q_1</title>
<polygon fill="lightcoral" stroke="black" points="878.5,-18622.21 659.5,-18622.21 659.5,-18569.21 878.5,-18569.21 878.5,-18622.21"/>
<text text-anchor="middle" x="769" y="-18607.01" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="769" y="-18592.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="769" y="-18577.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_q_1 -->
<g id="edge2" class="edge">
<title>ln1_1&#45;&gt;mha_q_1</title>
<path fill="none" stroke="black" d="M1001.46,-18662.27C961.26,-18650.93 912.06,-18637.06 869.3,-18625"/>
<polygon fill="black" stroke="black" points="870,-18621.56 859.43,-18622.21 868.1,-18628.29 870,-18621.56"/>
</g>
<!-- mha_k_1 -->
<g id="node4" class="node">
<title>mha_k_1</title>
<polygon fill="lightcoral" stroke="black" points="1115.5,-18622.21 896.5,-18622.21 896.5,-18569.21 1115.5,-18569.21 1115.5,-18622.21"/>
<text text-anchor="middle" x="1006" y="-18607.01" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="1006" y="-18592.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1006" y="-18577.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_k_1 -->
<g id="edge3" class="edge">
<title>ln1_1&#45;&gt;mha_k_1</title>
<path fill="none" stroke="black" d="M1058.9,-18658.78C1051.27,-18649.83 1042.62,-18639.67 1034.54,-18630.2"/>
<polygon fill="black" stroke="black" points="1037.09,-18627.79 1027.94,-18622.45 1031.76,-18632.33 1037.09,-18627.79"/>
</g>
<!-- mha_v_1 -->
<g id="node5" class="node">
<title>mha_v_1</title>
<polygon fill="lightcoral" stroke="black" points="1352.5,-18622.21 1133.5,-18622.21 1133.5,-18569.21 1352.5,-18569.21 1352.5,-18622.21"/>
<text text-anchor="middle" x="1243" y="-18607.01" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1243" y="-18592.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1243" y="-18577.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln1_1&#45;&gt;mha_v_1 -->
<g id="edge4" class="edge">
<title>ln1_1&#45;&gt;mha_v_1</title>
<path fill="none" stroke="black" d="M1128.29,-18659.02C1146.67,-18649.03 1167.88,-18637.51 1187.01,-18627.12"/>
<polygon fill="black" stroke="black" points="1188.81,-18630.12 1195.93,-18622.28 1185.47,-18623.97 1188.81,-18630.12"/>
</g>
<!-- mha_attn_1 -->
<g id="node6" class="node">
<title>mha_attn_1</title>
<polygon fill="lightcoral" stroke="black" points="1108.5,-18532.21 937.5,-18532.21 937.5,-18479.21 1108.5,-18479.21 1108.5,-18532.21"/>
<text text-anchor="middle" x="1023" y="-18517.01" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="1023" y="-18502.01" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="1023" y="-18487.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- mha_q_1&#45;&gt;mha_attn_1 -->
<g id="edge5" class="edge">
<title>mha_q_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M842.81,-18569.13C873.07,-18558.65 908.26,-18546.46 939.46,-18535.65"/>
<polygon fill="black" stroke="black" points="940.7,-18538.92 949.01,-18532.34 938.41,-18532.31 940.7,-18538.92"/>
</g>
<!-- mha_k_1&#45;&gt;mha_attn_1 -->
<g id="edge6" class="edge">
<title>mha_k_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1011.01,-18568.78C1012.6,-18560.54 1014.39,-18551.29 1016.09,-18542.48"/>
<polygon fill="black" stroke="black" points="1019.57,-18542.93 1018.03,-18532.45 1012.69,-18541.6 1019.57,-18542.93"/>
</g>
<!-- mha_v_1&#45;&gt;mha_attn_1 -->
<g id="edge7" class="edge">
<title>mha_v_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M1179.07,-18569.13C1153.2,-18558.79 1123.17,-18546.77 1096.41,-18536.07"/>
<polygon fill="black" stroke="black" points="1097.67,-18532.81 1087.09,-18532.34 1095.07,-18539.31 1097.67,-18532.81"/>
</g>
<!-- mha_out_1 -->
<g id="node7" class="node">
<title>mha_out_1</title>
<polygon fill="lightcoral" stroke="black" points="1238.5,-18442.21 1079.5,-18442.21 1079.5,-18389.21 1238.5,-18389.21 1238.5,-18442.21"/>
<text text-anchor="middle" x="1159" y="-18427.01" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="1159" y="-18412.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1159" y="-18397.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge8" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M1062.7,-18479.02C1077.79,-18469.26 1095.13,-18458.03 1110.9,-18447.83"/>
<polygon fill="black" stroke="black" points="1112.99,-18450.65 1119.48,-18442.28 1109.19,-18444.77 1112.99,-18450.65"/>
</g>
<!-- mha_out_1&#45;&gt;residual1_1 -->
<g id="edge10" class="edge">
<title>mha_out_1&#45;&gt;residual1_1</title>
<path fill="none" stroke="black" d="M1164.83,-18389.01C1166.66,-18380.98 1168.75,-18371.76 1170.89,-18362.35"/>
<polygon fill="black" stroke="black" points="1174.32,-18363.05 1173.12,-18352.53 1167.49,-18361.5 1174.32,-18363.05"/>
</g>
<!-- ln2_1 -->
<g id="node9" class="node">
<title>ln2_1</title>
<polygon fill="lightyellow" stroke="black" points="1178.5,-18209.21 1019.5,-18209.21 1019.5,-18156.21 1178.5,-18156.21 1178.5,-18209.21"/>
<text text-anchor="middle" x="1099" y="-18194.01" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="1099" y="-18179.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1099" y="-18164.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- residual1_1&#45;&gt;ln2_1 -->
<g id="edge11" class="edge">
<title>residual1_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M1145.77,-18245.98C1138.52,-18236.33 1131.13,-18226.48 1124.42,-18217.55"/>
<polygon fill="black" stroke="black" points="1127.03,-18215.2 1118.23,-18209.31 1121.44,-18219.41 1127.03,-18215.2"/>
</g>
<!-- residual2_1 -->
<g id="node13" class="node">
<title>residual2_1</title>
<polygon fill="lightpink" stroke="black" points="1341.69,-17849.21 1079.71,-17849.21 1012.31,-17743.21 1274.29,-17743.21 1341.69,-17849.21"/>
<text text-anchor="middle" x="1177" y="-17807.51" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="1177" y="-17792.51" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1177" y="-17777.51" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- residual1_1&#45;&gt;residual2_1 -->
<g id="edge15" class="edge">
<title>residual1_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M1201.98,-18246.04C1206.91,-18226.68 1211,-18204.4 1211,-18183.71 1211,-18183.71 1211,-18183.71 1211,-17911.71 1211,-17894.2 1207.3,-17875.79 1202.34,-17858.97"/>
<polygon fill="black" stroke="black" points="1205.63,-17857.76 1199.3,-17849.27 1198.96,-17859.86 1205.63,-17857.76"/>
</g>
<!-- ffn_up_1 -->
<g id="node10" class="node">
<title>ffn_up_1</title>
<polygon fill="lightblue" stroke="black" points="1192,-18119.21 976,-18119.21 976,-18066.21 1192,-18066.21 1192,-18119.21"/>
<text text-anchor="middle" x="1084" y="-18104.01" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="1084" y="-18089.01" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="1084" y="-18074.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ln2_1&#45;&gt;ffn_up_1 -->
<g id="edge12" class="edge">
<title>ln2_1&#45;&gt;ffn_up_1</title>
<path fill="none" stroke="black" d="M1094.58,-18155.78C1093.18,-18147.54 1091.6,-18138.29 1090.1,-18129.48"/>
<polygon fill="black" stroke="black" points="1093.52,-18128.72 1088.39,-18119.45 1086.62,-18129.89 1093.52,-18128.72"/>
</g>
<!-- ffn_act_1 -->
<g id="node11" class="node">
<title>ffn_act_1</title>
<polygon fill="lightgreen" stroke="black" points="1168,-18029.21 1000,-18029.21 1000,-17976.21 1168,-17976.21 1168,-18029.21"/>
<text text-anchor="middle" x="1084" y="-18014.01" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="1084" y="-17999.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="1084" y="-17984.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ffn_up_1&#45;&gt;ffn_act_1 -->
<g id="edge13" class="edge">
<title>ffn_up_1&#45;&gt;ffn_act_1</title>
<path fill="none" stroke="black" d="M1084,-18065.78C1084,-18057.54 1084,-18048.29 1084,-18039.48"/>
<polygon fill="black" stroke="black" points="1087.5,-18039.45 1084,-18029.45 1080.5,-18039.45 1087.5,-18039.45"/>
</g>
<!-- ffn_down_1 -->
<g id="node12" class="node">
<title>ffn_down_1</title>
<polygon fill="lightblue" stroke="black" points="1192,-17939.21 976,-17939.21 976,-17886.21 1192,-17886.21 1192,-17939.21"/>
<text text-anchor="middle" x="1084" y="-17924.01" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="1084" y="-17909.01" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="1084" y="-17894.01" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- ffn_act_1&#45;&gt;ffn_down_1 -->
<g id="edge14" class="edge">
<title>ffn_act_1&#45;&gt;ffn_down_1</title>
<path fill="none" stroke="black" d="M1084,-17975.78C1084,-17967.54 1084,-17958.29 1084,-17949.48"/>
<polygon fill="black" stroke="black" points="1087.5,-17949.45 1084,-17939.45 1080.5,-17949.45 1087.5,-17949.45"/>
</g>
<!-- ffn_down_1&#45;&gt;residual2_1 -->
<g id="edge16" class="edge">
<title>ffn_down_1&#45;&gt;residual2_1</title>
<path fill="none" stroke="black" d="M1104.87,-17886.01C1111.8,-17877.48 1119.84,-17867.59 1127.97,-17857.57"/>
<polygon fill="black" stroke="black" points="1130.92,-17859.5 1134.5,-17849.53 1125.48,-17855.08 1130.92,-17859.5"/>
</g>
<!-- layer_out_1 -->
<g id="node14" class="node">
<title>layer_out_1</title>
<ellipse fill="lightgray" stroke="black" cx="1177" cy="-17668.73" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="1177" y="-17680.03" font-family="Times,serif" font-size="14.00">Layer1_Output</text>
<text text-anchor="middle" x="1177" y="-17665.03" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1177" y="-17650.03" font-family="Times,serif" font-size="14.00">GPU&#45;0</text>
</g>
<!-- residual2_1&#45;&gt;layer_out_1 -->
<g id="edge17" class="edge">
<title>residual2_1&#45;&gt;layer_out_1</title>
<path fill="none" stroke="black" d="M1177,-17743.08C1177,-17734.18 1177,-17724.98 1177,-17716.23"/>
<polygon fill="black" stroke="black" points="1180.5,-17716.22 1177,-17706.22 1173.5,-17716.22 1180.5,-17716.22"/>
</g>
<!-- ln1_2 -->
<g id="node15" class="node">
<title>ln1_2</title>
<polygon fill="lightyellow" stroke="black" points="975.5,-17544.25 816.5,-17544.25 816.5,-17491.25 975.5,-17491.25 975.5,-17544.25"/>
<text text-anchor="middle" x="896" y="-17529.05" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="896" y="-17514.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="896" y="-17499.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- layer_out_1&#45;&gt;ln1_2 -->
<g id="edge18" class="edge">
<title>layer_out_1&#45;&gt;ln1_2</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M1103.45,-17640.35C1083.81,-17632.31 1062.83,-17623.02 1044,-17613.25 1007.95,-17594.55 969.34,-17569.72 940.6,-17550.21"/>
<polygon fill="red" stroke="red" points="942.24,-17547.09 932.01,-17544.34 938.29,-17552.87 942.24,-17547.09"/>
<text text-anchor="middle" x="1115.5" y="-17602.05" font-family="Times,serif" font-size="14.00">GPU&#45;0→GPU&#45;1</text>
<text text-anchor="middle" x="1115.5" y="-17587.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_2 -->
<g id="node21" class="node">
<title>residual1_2</title>
<polygon fill="lightpink" stroke="black" points="1169.69,-17184.25 907.71,-17184.25 840.31,-17078.25 1102.29,-17078.25 1169.69,-17184.25"/>
<text text-anchor="middle" x="1005" y="-17142.55" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="1005" y="-17127.55" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="1005" y="-17112.55" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- layer_out_1&#45;&gt;residual1_2 -->
<g id="edge26" class="edge">
<title>layer_out_1&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M1186.21,-17631.26C1192.98,-17601.26 1201,-17557.53 1201,-17518.75 1201,-17518.75 1201,-17518.75 1201,-17246.75 1201,-17224.23 1191.23,-17206.06 1176.06,-17191.42"/>
<polygon fill="black" stroke="black" points="1178.02,-17188.48 1168.19,-17184.51 1173.4,-17193.74 1178.02,-17188.48"/>
</g>
<!-- mha_q_2 -->
<g id="node16" class="node">
<title>mha_q_2</title>
<polygon fill="lightcoral" stroke="black" points="698.5,-17454.25 479.5,-17454.25 479.5,-17401.25 698.5,-17401.25 698.5,-17454.25"/>
<text text-anchor="middle" x="589" y="-17439.05" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="589" y="-17424.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="589" y="-17409.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_q_2 -->
<g id="edge19" class="edge">
<title>ln1_2&#45;&gt;mha_q_2</title>
<path fill="none" stroke="black" d="M816.14,-17493.86C777,-17482.64 729.48,-17469.02 688.04,-17457.14"/>
<polygon fill="black" stroke="black" points="688.78,-17453.71 678.2,-17454.32 686.85,-17460.44 688.78,-17453.71"/>
</g>
<!-- mha_k_2 -->
<g id="node17" class="node">
<title>mha_k_2</title>
<polygon fill="lightcoral" stroke="black" points="935.5,-17454.25 716.5,-17454.25 716.5,-17401.25 935.5,-17401.25 935.5,-17454.25"/>
<text text-anchor="middle" x="826" y="-17439.05" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="826" y="-17424.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="826" y="-17409.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_k_2 -->
<g id="edge20" class="edge">
<title>ln1_2&#45;&gt;mha_k_2</title>
<path fill="none" stroke="black" d="M875.38,-17490.83C868.33,-17481.96 860.34,-17471.92 852.87,-17462.53"/>
<polygon fill="black" stroke="black" points="855.44,-17460.14 846.48,-17454.49 849.96,-17464.5 855.44,-17460.14"/>
</g>
<!-- mha_v_2 -->
<g id="node18" class="node">
<title>mha_v_2</title>
<polygon fill="lightcoral" stroke="black" points="1172.5,-17454.25 953.5,-17454.25 953.5,-17401.25 1172.5,-17401.25 1172.5,-17454.25"/>
<text text-anchor="middle" x="1063" y="-17439.05" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="1063" y="-17424.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="1063" y="-17409.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln1_2&#45;&gt;mha_v_2 -->
<g id="edge21" class="edge">
<title>ln1_2&#45;&gt;mha_v_2</title>
<path fill="none" stroke="black" d="M944.75,-17491.06C963.79,-17481.03 985.75,-17469.46 1005.55,-17459.03"/>
<polygon fill="black" stroke="black" points="1007.26,-17462.08 1014.48,-17454.32 1004,-17455.89 1007.26,-17462.08"/>
</g>
<!-- mha_attn_2 -->
<g id="node19" class="node">
<title>mha_attn_2</title>
<polygon fill="lightcoral" stroke="black" points="928.5,-17364.25 757.5,-17364.25 757.5,-17311.25 928.5,-17311.25 928.5,-17364.25"/>
<text text-anchor="middle" x="843" y="-17349.05" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="843" y="-17334.05" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="843" y="-17319.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- mha_q_2&#45;&gt;mha_attn_2 -->
<g id="edge22" class="edge">
<title>mha_q_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M662.81,-17401.18C693.07,-17390.7 728.26,-17378.51 759.46,-17367.7"/>
<polygon fill="black" stroke="black" points="760.7,-17370.97 769.01,-17364.39 758.41,-17364.35 760.7,-17370.97"/>
</g>
<!-- mha_k_2&#45;&gt;mha_attn_2 -->
<g id="edge23" class="edge">
<title>mha_k_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M831.01,-17400.83C832.6,-17392.59 834.39,-17383.33 836.09,-17374.53"/>
<polygon fill="black" stroke="black" points="839.57,-17374.98 838.03,-17364.49 832.69,-17373.65 839.57,-17374.98"/>
</g>
<!-- mha_v_2&#45;&gt;mha_attn_2 -->
<g id="edge24" class="edge">
<title>mha_v_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M999.07,-17401.18C973.2,-17390.83 943.17,-17378.82 916.41,-17368.12"/>
<polygon fill="black" stroke="black" points="917.67,-17364.85 907.09,-17364.39 915.07,-17371.35 917.67,-17364.85"/>
</g>
<!-- mha_out_2 -->
<g id="node20" class="node">
<title>mha_out_2</title>
<polygon fill="lightcoral" stroke="black" points="1036.5,-17274.25 877.5,-17274.25 877.5,-17221.25 1036.5,-17221.25 1036.5,-17274.25"/>
<text text-anchor="middle" x="957" y="-17259.05" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="957" y="-17244.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="957" y="-17229.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge25" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M876.28,-17311.06C888.69,-17301.48 902.92,-17290.5 915.95,-17280.44"/>
<polygon fill="black" stroke="black" points="918.1,-17283.2 923.88,-17274.32 913.82,-17277.66 918.1,-17283.2"/>
</g>
<!-- mha_out_2&#45;&gt;residual1_2 -->
<g id="edge27" class="edge">
<title>mha_out_2&#45;&gt;residual1_2</title>
<path fill="none" stroke="black" d="M967.77,-17221.06C971.21,-17212.86 975.17,-17203.41 979.2,-17193.8"/>
<polygon fill="black" stroke="black" points="982.43,-17195.15 983.07,-17184.57 975.97,-17192.44 982.43,-17195.15"/>
</g>
<!-- ln2_2 -->
<g id="node22" class="node">
<title>ln2_2</title>
<polygon fill="lightyellow" stroke="black" points="998.5,-17041.25 839.5,-17041.25 839.5,-16988.25 998.5,-16988.25 998.5,-17041.25"/>
<text text-anchor="middle" x="919" y="-17026.05" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="919" y="-17011.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="919" y="-16996.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- residual1_2&#45;&gt;ln2_2 -->
<g id="edge28" class="edge">
<title>residual1_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M965.77,-17078.03C958.52,-17068.37 951.13,-17058.53 944.42,-17049.6"/>
<polygon fill="black" stroke="black" points="947.03,-17047.25 938.23,-17041.36 941.44,-17051.45 947.03,-17047.25"/>
</g>
<!-- residual2_2 -->
<g id="node26" class="node">
<title>residual2_2</title>
<polygon fill="lightpink" stroke="black" points="1163.69,-16681.25 901.71,-16681.25 834.31,-16575.25 1096.29,-16575.25 1163.69,-16681.25"/>
<text text-anchor="middle" x="999" y="-16639.55" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="999" y="-16624.55" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="999" y="-16609.55" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- residual1_2&#45;&gt;residual2_2 -->
<g id="edge32" class="edge">
<title>residual1_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M1021.98,-17078.09C1026.91,-17058.73 1031,-17036.44 1031,-17015.75 1031,-17015.75 1031,-17015.75 1031,-16743.75 1031,-16726.33 1027.52,-16707.94 1022.85,-16691.12"/>
<polygon fill="black" stroke="black" points="1026.18,-16690.02 1019.99,-16681.42 1019.46,-16692 1026.18,-16690.02"/>
</g>
<!-- ffn_up_2 -->
<g id="node23" class="node">
<title>ffn_up_2</title>
<polygon fill="lightblue" stroke="black" points="1012,-16951.25 796,-16951.25 796,-16898.25 1012,-16898.25 1012,-16951.25"/>
<text text-anchor="middle" x="904" y="-16936.05" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="904" y="-16921.05" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="904" y="-16906.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ln2_2&#45;&gt;ffn_up_2 -->
<g id="edge29" class="edge">
<title>ln2_2&#45;&gt;ffn_up_2</title>
<path fill="none" stroke="black" d="M914.58,-16987.83C913.18,-16979.59 911.6,-16970.33 910.1,-16961.53"/>
<polygon fill="black" stroke="black" points="913.52,-16960.76 908.39,-16951.49 906.62,-16961.94 913.52,-16960.76"/>
</g>
<!-- ffn_act_2 -->
<g id="node24" class="node">
<title>ffn_act_2</title>
<polygon fill="lightgreen" stroke="black" points="988,-16861.25 820,-16861.25 820,-16808.25 988,-16808.25 988,-16861.25"/>
<text text-anchor="middle" x="904" y="-16846.05" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="904" y="-16831.05" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="904" y="-16816.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ffn_up_2&#45;&gt;ffn_act_2 -->
<g id="edge30" class="edge">
<title>ffn_up_2&#45;&gt;ffn_act_2</title>
<path fill="none" stroke="black" d="M904,-16897.83C904,-16889.59 904,-16880.33 904,-16871.53"/>
<polygon fill="black" stroke="black" points="907.5,-16871.49 904,-16861.49 900.5,-16871.49 907.5,-16871.49"/>
</g>
<!-- ffn_down_2 -->
<g id="node25" class="node">
<title>ffn_down_2</title>
<polygon fill="lightblue" stroke="black" points="1012,-16771.25 796,-16771.25 796,-16718.25 1012,-16718.25 1012,-16771.25"/>
<text text-anchor="middle" x="904" y="-16756.05" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="904" y="-16741.05" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="904" y="-16726.05" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- ffn_act_2&#45;&gt;ffn_down_2 -->
<g id="edge31" class="edge">
<title>ffn_act_2&#45;&gt;ffn_down_2</title>
<path fill="none" stroke="black" d="M904,-16807.83C904,-16799.59 904,-16790.33 904,-16781.53"/>
<polygon fill="black" stroke="black" points="907.5,-16781.49 904,-16771.49 900.5,-16781.49 907.5,-16781.49"/>
</g>
<!-- ffn_down_2&#45;&gt;residual2_2 -->
<g id="edge33" class="edge">
<title>ffn_down_2&#45;&gt;residual2_2</title>
<path fill="none" stroke="black" d="M925.32,-16718.06C932.47,-16709.44 940.77,-16699.44 949.17,-16689.32"/>
<polygon fill="black" stroke="black" points="951.9,-16691.5 955.59,-16681.57 946.51,-16687.03 951.9,-16691.5"/>
</g>
<!-- layer_out_2 -->
<g id="node27" class="node">
<title>layer_out_2</title>
<ellipse fill="lightgray" stroke="black" cx="999" cy="-16500.78" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="999" y="-16512.08" font-family="Times,serif" font-size="14.00">Layer2_Output</text>
<text text-anchor="middle" x="999" y="-16497.08" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="999" y="-16482.08" font-family="Times,serif" font-size="14.00">GPU&#45;1</text>
</g>
<!-- residual2_2&#45;&gt;layer_out_2 -->
<g id="edge34" class="edge">
<title>residual2_2&#45;&gt;layer_out_2</title>
<path fill="none" stroke="black" d="M999,-16575.13C999,-16566.22 999,-16557.03 999,-16548.28"/>
<polygon fill="black" stroke="black" points="1002.5,-16548.26 999,-16538.26 995.5,-16548.26 1002.5,-16548.26"/>
</g>
<!-- ln1_3 -->
<g id="node28" class="node">
<title>ln1_3</title>
<polygon fill="lightyellow" stroke="black" points="864.5,-16376.3 705.5,-16376.3 705.5,-16323.3 864.5,-16323.3 864.5,-16376.3"/>
<text text-anchor="middle" x="785" y="-16361.1" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="785" y="-16346.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="785" y="-16331.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- layer_out_2&#45;&gt;ln1_3 -->
<g id="edge35" class="edge">
<title>layer_out_2&#45;&gt;ln1_3</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M951.51,-16466.71C915.26,-16441.48 865.64,-16406.94 830.02,-16382.14"/>
<polygon fill="red" stroke="red" points="831.94,-16379.21 821.73,-16376.37 827.94,-16384.96 831.94,-16379.21"/>
<text text-anchor="middle" x="988.5" y="-16434.1" font-family="Times,serif" font-size="14.00">GPU&#45;1→GPU&#45;2</text>
<text text-anchor="middle" x="988.5" y="-16419.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_3 -->
<g id="node34" class="node">
<title>residual1_3</title>
<polygon fill="lightpink" stroke="black" points="1073.69,-16016.3 811.71,-16016.3 744.31,-15910.3 1006.29,-15910.3 1073.69,-16016.3"/>
<text text-anchor="middle" x="909" y="-15974.6" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="909" y="-15959.6" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="909" y="-15944.6" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- layer_out_2&#45;&gt;residual1_3 -->
<g id="edge43" class="edge">
<title>layer_out_2&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M1044.67,-16466.25C1051.7,-16459.81 1058.45,-16452.73 1064,-16445.3 1091.39,-16408.61 1105,-16396.58 1105,-16350.8 1105,-16350.8 1105,-16350.8 1105,-16078.8 1105,-16056.28 1095.23,-16038.11 1080.06,-16023.46"/>
<polygon fill="black" stroke="black" points="1082.02,-16020.53 1072.19,-16016.56 1077.4,-16025.78 1082.02,-16020.53"/>
</g>
<!-- mha_q_3 -->
<g id="node29" class="node">
<title>mha_q_3</title>
<polygon fill="lightcoral" stroke="black" points="602.5,-16286.3 383.5,-16286.3 383.5,-16233.3 602.5,-16233.3 602.5,-16286.3"/>
<text text-anchor="middle" x="493" y="-16271.1" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="493" y="-16256.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="493" y="-16241.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_q_3 -->
<g id="edge36" class="edge">
<title>ln1_3&#45;&gt;mha_q_3</title>
<path fill="none" stroke="black" d="M705.21,-16324.75C668.94,-16313.82 625.75,-16300.81 587.83,-16289.38"/>
<polygon fill="black" stroke="black" points="588.39,-16285.89 577.8,-16286.36 586.37,-16292.59 588.39,-16285.89"/>
</g>
<!-- mha_k_3 -->
<g id="node30" class="node">
<title>mha_k_3</title>
<polygon fill="lightcoral" stroke="black" points="839.5,-16286.3 620.5,-16286.3 620.5,-16233.3 839.5,-16233.3 839.5,-16286.3"/>
<text text-anchor="middle" x="730" y="-16271.1" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="730" y="-16256.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="730" y="-16241.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_k_3 -->
<g id="edge37" class="edge">
<title>ln1_3&#45;&gt;mha_k_3</title>
<path fill="none" stroke="black" d="M768.8,-16322.87C763.37,-16314.19 757.23,-16304.37 751.47,-16295.15"/>
<polygon fill="black" stroke="black" points="754.36,-16293.17 746.09,-16286.54 748.42,-16296.88 754.36,-16293.17"/>
</g>
<!-- mha_v_3 -->
<g id="node31" class="node">
<title>mha_v_3</title>
<polygon fill="lightcoral" stroke="black" points="1076.5,-16286.3 857.5,-16286.3 857.5,-16233.3 1076.5,-16233.3 1076.5,-16286.3"/>
<text text-anchor="middle" x="967" y="-16271.1" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="967" y="-16256.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="967" y="-16241.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln1_3&#45;&gt;mha_v_3 -->
<g id="edge38" class="edge">
<title>ln1_3&#45;&gt;mha_v_3</title>
<path fill="none" stroke="black" d="M838.13,-16323.11C859.06,-16312.99 883.25,-16301.3 904.97,-16290.79"/>
<polygon fill="black" stroke="black" points="906.64,-16293.87 914.12,-16286.37 903.59,-16287.57 906.64,-16293.87"/>
</g>
<!-- mha_attn_3 -->
<g id="node32" class="node">
<title>mha_attn_3</title>
<polygon fill="lightcoral" stroke="black" points="912.5,-16196.3 741.5,-16196.3 741.5,-16143.3 912.5,-16143.3 912.5,-16196.3"/>
<text text-anchor="middle" x="827" y="-16181.1" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="827" y="-16166.1" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="827" y="-16151.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- mha_q_3&#45;&gt;mha_attn_3 -->
<g id="edge39" class="edge">
<title>mha_q_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M590.06,-16233.23C634.55,-16221.5 687.14,-16207.65 731.45,-16195.97"/>
<polygon fill="black" stroke="black" points="732.58,-16199.3 741.35,-16193.37 730.79,-16192.53 732.58,-16199.3"/>
</g>
<!-- mha_k_3&#45;&gt;mha_attn_3 -->
<g id="edge40" class="edge">
<title>mha_k_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M758.32,-16233.11C768.58,-16223.8 780.3,-16213.16 791.13,-16203.34"/>
<polygon fill="black" stroke="black" points="793.76,-16205.68 798.82,-16196.37 789.06,-16200.5 793.76,-16205.68"/>
</g>
<!-- mha_v_3&#45;&gt;mha_attn_3 -->
<g id="edge41" class="edge">
<title>mha_v_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M926.13,-16233.11C910.6,-16223.35 892.75,-16212.13 876.51,-16201.92"/>
<polygon fill="black" stroke="black" points="878.01,-16198.73 867.68,-16196.37 874.28,-16204.65 878.01,-16198.73"/>
</g>
<!-- mha_out_3 -->
<g id="node33" class="node">
<title>mha_out_3</title>
<polygon fill="lightcoral" stroke="black" points="974.5,-16106.3 815.5,-16106.3 815.5,-16053.3 974.5,-16053.3 974.5,-16106.3"/>
<text text-anchor="middle" x="895" y="-16091.1" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="895" y="-16076.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="895" y="-16061.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge42" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M847.03,-16142.87C853.88,-16134.01 861.65,-16123.96 868.9,-16114.58"/>
<polygon fill="black" stroke="black" points="871.76,-16116.59 875.11,-16106.54 866.22,-16112.31 871.76,-16116.59"/>
</g>
<!-- mha_out_3&#45;&gt;residual1_3 -->
<g id="edge44" class="edge">
<title>mha_out_3&#45;&gt;residual1_3</title>
<path fill="none" stroke="black" d="M898.14,-16053.1C899.11,-16045.16 900.23,-16036.04 901.37,-16026.74"/>
<polygon fill="black" stroke="black" points="904.86,-16026.97 902.6,-16016.62 897.91,-16026.12 904.86,-16026.97"/>
</g>
<!-- ln2_3 -->
<g id="node35" class="node">
<title>ln2_3</title>
<polygon fill="lightyellow" stroke="black" points="906.5,-15873.3 747.5,-15873.3 747.5,-15820.3 906.5,-15820.3 906.5,-15873.3"/>
<text text-anchor="middle" x="827" y="-15858.1" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="827" y="-15843.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="827" y="-15828.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- residual1_3&#45;&gt;ln2_3 -->
<g id="edge45" class="edge">
<title>residual1_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M871.6,-15910.08C864.69,-15900.42 857.63,-15890.57 851.24,-15881.65"/>
<polygon fill="black" stroke="black" points="854,-15879.49 845.34,-15873.4 848.31,-15883.57 854,-15879.49"/>
</g>
<!-- residual2_3 -->
<g id="node39" class="node">
<title>residual2_3</title>
<polygon fill="lightpink" stroke="black" points="1059.69,-15513.3 797.71,-15513.3 730.31,-15407.3 992.29,-15407.3 1059.69,-15513.3"/>
<text text-anchor="middle" x="895" y="-15471.6" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="895" y="-15456.6" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="895" y="-15441.6" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- residual1_3&#45;&gt;residual2_3 -->
<g id="edge49" class="edge">
<title>residual1_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M928.68,-15910.03C934.33,-15890.76 939,-15868.55 939,-15847.8 939,-15847.8 939,-15847.8 939,-15575.8 939,-15558 934.31,-15539.61 927.99,-15522.92"/>
<polygon fill="black" stroke="black" points="931.1,-15521.27 924.1,-15513.31 924.61,-15523.89 931.1,-15521.27"/>
</g>
<!-- ffn_up_3 -->
<g id="node36" class="node">
<title>ffn_up_3</title>
<polygon fill="lightblue" stroke="black" points="920,-15783.3 704,-15783.3 704,-15730.3 920,-15730.3 920,-15783.3"/>
<text text-anchor="middle" x="812" y="-15768.1" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="812" y="-15753.1" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="812" y="-15738.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ln2_3&#45;&gt;ffn_up_3 -->
<g id="edge46" class="edge">
<title>ln2_3&#45;&gt;ffn_up_3</title>
<path fill="none" stroke="black" d="M822.58,-15819.87C821.18,-15811.64 819.6,-15802.38 818.1,-15793.58"/>
<polygon fill="black" stroke="black" points="821.52,-15792.81 816.39,-15783.54 814.62,-15793.99 821.52,-15792.81"/>
</g>
<!-- ffn_act_3 -->
<g id="node37" class="node">
<title>ffn_act_3</title>
<polygon fill="lightgreen" stroke="black" points="896,-15693.3 728,-15693.3 728,-15640.3 896,-15640.3 896,-15693.3"/>
<text text-anchor="middle" x="812" y="-15678.1" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="812" y="-15663.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="812" y="-15648.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ffn_up_3&#45;&gt;ffn_act_3 -->
<g id="edge47" class="edge">
<title>ffn_up_3&#45;&gt;ffn_act_3</title>
<path fill="none" stroke="black" d="M812,-15729.87C812,-15721.64 812,-15712.38 812,-15703.58"/>
<polygon fill="black" stroke="black" points="815.5,-15703.54 812,-15693.54 808.5,-15703.54 815.5,-15703.54"/>
</g>
<!-- ffn_down_3 -->
<g id="node38" class="node">
<title>ffn_down_3</title>
<polygon fill="lightblue" stroke="black" points="920,-15603.3 704,-15603.3 704,-15550.3 920,-15550.3 920,-15603.3"/>
<text text-anchor="middle" x="812" y="-15588.1" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="812" y="-15573.1" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="812" y="-15558.1" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- ffn_act_3&#45;&gt;ffn_down_3 -->
<g id="edge48" class="edge">
<title>ffn_act_3&#45;&gt;ffn_down_3</title>
<path fill="none" stroke="black" d="M812,-15639.87C812,-15631.64 812,-15622.38 812,-15613.58"/>
<polygon fill="black" stroke="black" points="815.5,-15613.54 812,-15603.54 808.5,-15613.54 815.5,-15613.54"/>
</g>
<!-- ffn_down_3&#45;&gt;residual2_3 -->
<g id="edge50" class="edge">
<title>ffn_down_3&#45;&gt;residual2_3</title>
<path fill="none" stroke="black" d="M830.63,-15550.1C836.75,-15541.66 843.84,-15531.88 851.03,-15521.96"/>
<polygon fill="black" stroke="black" points="854.04,-15523.77 857.07,-15513.62 848.37,-15519.66 854.04,-15523.77"/>
</g>
<!-- layer_out_3 -->
<g id="node40" class="node">
<title>layer_out_3</title>
<ellipse fill="lightgray" stroke="black" cx="895" cy="-15332.82" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="895" y="-15344.12" font-family="Times,serif" font-size="14.00">Layer3_Output</text>
<text text-anchor="middle" x="895" y="-15329.12" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="895" y="-15314.12" font-family="Times,serif" font-size="14.00">GPU&#45;2</text>
</g>
<!-- residual2_3&#45;&gt;layer_out_3 -->
<g id="edge51" class="edge">
<title>residual2_3&#45;&gt;layer_out_3</title>
<path fill="none" stroke="black" d="M895,-15407.18C895,-15398.27 895,-15389.07 895,-15380.33"/>
<polygon fill="black" stroke="black" points="898.5,-15380.31 895,-15370.31 891.5,-15380.31 898.5,-15380.31"/>
</g>
<!-- ln1_4 -->
<g id="node41" class="node">
<title>ln1_4</title>
<polygon fill="lightyellow" stroke="black" points="693.5,-15208.35 534.5,-15208.35 534.5,-15155.35 693.5,-15155.35 693.5,-15208.35"/>
<text text-anchor="middle" x="614" y="-15193.15" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="614" y="-15178.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="614" y="-15163.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- layer_out_3&#45;&gt;ln1_4 -->
<g id="edge52" class="edge">
<title>layer_out_3&#45;&gt;ln1_4</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M821.45,-15304.45C801.81,-15296.4 780.83,-15287.11 762,-15277.35 725.95,-15258.65 687.34,-15233.82 658.6,-15214.3"/>
<polygon fill="red" stroke="red" points="660.24,-15211.19 650.01,-15208.43 656.29,-15216.96 660.24,-15211.19"/>
<text text-anchor="middle" x="833.5" y="-15266.15" font-family="Times,serif" font-size="14.00">GPU&#45;2→GPU&#45;3</text>
<text text-anchor="middle" x="833.5" y="-15251.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_4 -->
<g id="node47" class="node">
<title>residual1_4</title>
<polygon fill="lightpink" stroke="black" points="886.69,-14848.35 624.71,-14848.35 557.31,-14742.35 819.29,-14742.35 886.69,-14848.35"/>
<text text-anchor="middle" x="722" y="-14806.65" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="722" y="-14791.65" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="722" y="-14776.65" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- layer_out_3&#45;&gt;residual1_4 -->
<g id="edge60" class="edge">
<title>layer_out_3&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M904.21,-15295.35C910.98,-15265.35 919,-15221.62 919,-15182.85 919,-15182.85 919,-15182.85 919,-14910.85 919,-14888.24 909.18,-14870.02 893.93,-14855.36"/>
<polygon fill="black" stroke="black" points="895.86,-14852.39 886.03,-14848.44 891.25,-14857.66 895.86,-14852.39"/>
</g>
<!-- mha_q_4 -->
<g id="node42" class="node">
<title>mha_q_4</title>
<polygon fill="lightcoral" stroke="black" points="416.5,-15118.35 197.5,-15118.35 197.5,-15065.35 416.5,-15065.35 416.5,-15118.35"/>
<text text-anchor="middle" x="307" y="-15103.15" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="307" y="-15088.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="307" y="-15073.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_q_4 -->
<g id="edge53" class="edge">
<title>ln1_4&#45;&gt;mha_q_4</title>
<path fill="none" stroke="black" d="M534.14,-15157.96C495,-15146.73 447.48,-15133.11 406.04,-15121.24"/>
<polygon fill="black" stroke="black" points="406.78,-15117.81 396.2,-15118.42 404.85,-15124.54 406.78,-15117.81"/>
</g>
<!-- mha_k_4 -->
<g id="node43" class="node">
<title>mha_k_4</title>
<polygon fill="lightcoral" stroke="black" points="653.5,-15118.35 434.5,-15118.35 434.5,-15065.35 653.5,-15065.35 653.5,-15118.35"/>
<text text-anchor="middle" x="544" y="-15103.15" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="544" y="-15088.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="544" y="-15073.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_k_4 -->
<g id="edge54" class="edge">
<title>ln1_4&#45;&gt;mha_k_4</title>
<path fill="none" stroke="black" d="M593.38,-15154.92C586.33,-15146.06 578.34,-15136.01 570.87,-15126.62"/>
<polygon fill="black" stroke="black" points="573.44,-15124.24 564.48,-15118.59 567.96,-15128.59 573.44,-15124.24"/>
</g>
<!-- mha_v_4 -->
<g id="node44" class="node">
<title>mha_v_4</title>
<polygon fill="lightcoral" stroke="black" points="890.5,-15118.35 671.5,-15118.35 671.5,-15065.35 890.5,-15065.35 890.5,-15118.35"/>
<text text-anchor="middle" x="781" y="-15103.15" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="781" y="-15088.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="781" y="-15073.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln1_4&#45;&gt;mha_v_4 -->
<g id="edge55" class="edge">
<title>ln1_4&#45;&gt;mha_v_4</title>
<path fill="none" stroke="black" d="M662.75,-15155.16C681.79,-15145.13 703.75,-15133.55 723.55,-15123.12"/>
<polygon fill="black" stroke="black" points="725.26,-15126.17 732.48,-15118.42 722,-15119.98 725.26,-15126.17"/>
</g>
<!-- mha_attn_4 -->
<g id="node45" class="node">
<title>mha_attn_4</title>
<polygon fill="lightcoral" stroke="black" points="651.5,-15028.35 480.5,-15028.35 480.5,-14975.35 651.5,-14975.35 651.5,-15028.35"/>
<text text-anchor="middle" x="566" y="-15013.15" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="566" y="-14998.15" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="566" y="-14983.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- mha_q_4&#45;&gt;mha_attn_4 -->
<g id="edge56" class="edge">
<title>mha_q_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M382.26,-15065.28C413.12,-15054.79 449,-15042.6 480.82,-15031.79"/>
<polygon fill="black" stroke="black" points="482.21,-15035.01 490.55,-15028.48 479.96,-15028.38 482.21,-15035.01"/>
</g>
<!-- mha_k_4&#45;&gt;mha_attn_4 -->
<g id="edge57" class="edge">
<title>mha_k_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M550.48,-15064.92C552.56,-15056.59 554.91,-15047.22 557.13,-15038.34"/>
<polygon fill="black" stroke="black" points="560.53,-15039.14 559.56,-15028.59 553.74,-15037.44 560.53,-15039.14"/>
</g>
<!-- mha_v_4&#45;&gt;mha_attn_4 -->
<g id="edge58" class="edge">
<title>mha_v_4&#45;&gt;mha_attn_4</title>
<path fill="none" stroke="black" d="M718.52,-15065.28C693.35,-15054.97 664.15,-15043.02 638.08,-15032.35"/>
<polygon fill="black" stroke="black" points="639.21,-15029.03 628.63,-15028.48 636.56,-15035.51 639.21,-15029.03"/>
</g>
<!-- mha_out_4 -->
<g id="node46" class="node">
<title>mha_out_4</title>
<polygon fill="lightcoral" stroke="black" points="738.5,-14938.35 579.5,-14938.35 579.5,-14885.35 738.5,-14885.35 738.5,-14938.35"/>
<text text-anchor="middle" x="659" y="-14923.15" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="659" y="-14908.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="659" y="-14893.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- mha_attn_4&#45;&gt;mha_out_4 -->
<g id="edge59" class="edge">
<title>mha_attn_4&#45;&gt;mha_out_4</title>
<path fill="none" stroke="black" d="M593.4,-14974.92C603.14,-14965.7 614.24,-14955.2 624.5,-14945.49"/>
<polygon fill="black" stroke="black" points="626.94,-14948 631.8,-14938.59 622.13,-14942.92 626.94,-14948"/>
</g>
<!-- mha_out_4&#45;&gt;residual1_4 -->
<g id="edge61" class="edge">
<title>mha_out_4&#45;&gt;residual1_4</title>
<path fill="none" stroke="black" d="M673.14,-14885.15C677.69,-14876.87 682.95,-14867.31 688.3,-14857.6"/>
<polygon fill="black" stroke="black" points="691.46,-14859.12 693.21,-14848.67 685.33,-14855.74 691.46,-14859.12"/>
</g>
<!-- ln2_4 -->
<g id="node48" class="node">
<title>ln2_4</title>
<polygon fill="lightyellow" stroke="black" points="715.5,-14705.35 556.5,-14705.35 556.5,-14652.35 715.5,-14652.35 715.5,-14705.35"/>
<text text-anchor="middle" x="636" y="-14690.15" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="636" y="-14675.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="636" y="-14660.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- residual1_4&#45;&gt;ln2_4 -->
<g id="edge62" class="edge">
<title>residual1_4&#45;&gt;ln2_4</title>
<path fill="none" stroke="black" d="M682.77,-14742.12C675.52,-14732.47 668.13,-14722.62 661.42,-14713.69"/>
<polygon fill="black" stroke="black" points="664.03,-14711.34 655.23,-14705.45 658.44,-14715.55 664.03,-14711.34"/>
</g>
<!-- residual2_4 -->
<g id="node52" class="node">
<title>residual2_4</title>
<polygon fill="lightpink" stroke="black" points="864.69,-14345.35 602.71,-14345.35 535.31,-14239.35 797.29,-14239.35 864.69,-14345.35"/>
<text text-anchor="middle" x="700" y="-14303.65" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="700" y="-14288.65" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="700" y="-14273.65" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- residual1_4&#45;&gt;residual2_4 -->
<g id="edge66" class="edge">
<title>residual1_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M738.98,-14742.18C743.91,-14722.82 748,-14700.54 748,-14679.85 748,-14679.85 748,-14679.85 748,-14407.85 748,-14389.92 742.93,-14371.55 736.09,-14354.93"/>
<polygon fill="black" stroke="black" points="739.11,-14353.1 731.88,-14345.36 732.7,-14355.92 739.11,-14353.1"/>
</g>
<!-- ffn_up_4 -->
<g id="node49" class="node">
<title>ffn_up_4</title>
<polygon fill="lightblue" stroke="black" points="729,-14615.35 513,-14615.35 513,-14562.35 729,-14562.35 729,-14615.35"/>
<text text-anchor="middle" x="621" y="-14600.15" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="621" y="-14585.15" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="621" y="-14570.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ln2_4&#45;&gt;ffn_up_4 -->
<g id="edge63" class="edge">
<title>ln2_4&#45;&gt;ffn_up_4</title>
<path fill="none" stroke="black" d="M631.58,-14651.92C630.18,-14643.68 628.6,-14634.43 627.1,-14625.62"/>
<polygon fill="black" stroke="black" points="630.52,-14624.86 625.39,-14615.59 623.62,-14626.03 630.52,-14624.86"/>
</g>
<!-- ffn_act_4 -->
<g id="node50" class="node">
<title>ffn_act_4</title>
<polygon fill="lightgreen" stroke="black" points="705,-14525.35 537,-14525.35 537,-14472.35 705,-14472.35 705,-14525.35"/>
<text text-anchor="middle" x="621" y="-14510.15" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="621" y="-14495.15" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="621" y="-14480.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ffn_up_4&#45;&gt;ffn_act_4 -->
<g id="edge64" class="edge">
<title>ffn_up_4&#45;&gt;ffn_act_4</title>
<path fill="none" stroke="black" d="M621,-14561.92C621,-14553.68 621,-14544.43 621,-14535.62"/>
<polygon fill="black" stroke="black" points="624.5,-14535.59 621,-14525.59 617.5,-14535.59 624.5,-14535.59"/>
</g>
<!-- ffn_down_4 -->
<g id="node51" class="node">
<title>ffn_down_4</title>
<polygon fill="lightblue" stroke="black" points="729,-14435.35 513,-14435.35 513,-14382.35 729,-14382.35 729,-14435.35"/>
<text text-anchor="middle" x="621" y="-14420.15" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="621" y="-14405.15" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="621" y="-14390.15" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- ffn_act_4&#45;&gt;ffn_down_4 -->
<g id="edge65" class="edge">
<title>ffn_act_4&#45;&gt;ffn_down_4</title>
<path fill="none" stroke="black" d="M621,-14471.92C621,-14463.68 621,-14454.43 621,-14445.62"/>
<polygon fill="black" stroke="black" points="624.5,-14445.59 621,-14435.59 617.5,-14445.59 624.5,-14445.59"/>
</g>
<!-- ffn_down_4&#45;&gt;residual2_4 -->
<g id="edge67" class="edge">
<title>ffn_down_4&#45;&gt;residual2_4</title>
<path fill="none" stroke="black" d="M638.73,-14382.15C644.56,-14373.7 651.31,-14363.92 658.15,-14354"/>
<polygon fill="black" stroke="black" points="661.1,-14355.89 663.9,-14345.67 655.34,-14351.91 661.1,-14355.89"/>
</g>
<!-- layer_out_4 -->
<g id="node53" class="node">
<title>layer_out_4</title>
<ellipse fill="lightgray" stroke="black" cx="700" cy="-14164.87" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="700" y="-14176.17" font-family="Times,serif" font-size="14.00">Layer4_Output</text>
<text text-anchor="middle" x="700" y="-14161.17" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="700" y="-14146.17" font-family="Times,serif" font-size="14.00">GPU&#45;3</text>
</g>
<!-- residual2_4&#45;&gt;layer_out_4 -->
<g id="edge68" class="edge">
<title>residual2_4&#45;&gt;layer_out_4</title>
<path fill="none" stroke="black" d="M700,-14239.22C700,-14230.32 700,-14221.12 700,-14212.37"/>
<polygon fill="black" stroke="black" points="703.5,-14212.36 700,-14202.36 696.5,-14212.36 703.5,-14212.36"/>
</g>
<!-- ln1_5 -->
<g id="node54" class="node">
<title>ln1_5</title>
<polygon fill="lightyellow" stroke="black" points="565.5,-14040.39 406.5,-14040.39 406.5,-13987.39 565.5,-13987.39 565.5,-14040.39"/>
<text text-anchor="middle" x="486" y="-14025.19" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="486" y="-14010.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="486" y="-13995.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- layer_out_4&#45;&gt;ln1_5 -->
<g id="edge69" class="edge">
<title>layer_out_4&#45;&gt;ln1_5</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M652.51,-14130.81C616.26,-14105.57 566.64,-14071.03 531.02,-14046.23"/>
<polygon fill="red" stroke="red" points="532.94,-14043.31 522.73,-14040.47 528.94,-14049.05 532.94,-14043.31"/>
<text text-anchor="middle" x="690.5" y="-14098.19" font-family="Times,serif" font-size="14.00">GPU&#45;3→GPU&#45;4</text>
<text text-anchor="middle" x="690.5" y="-14083.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_5 -->
<g id="node60" class="node">
<title>residual1_5</title>
<polygon fill="lightpink" stroke="black" points="668.69,-13680.39 406.71,-13680.39 339.31,-13574.39 601.29,-13574.39 668.69,-13680.39"/>
<text text-anchor="middle" x="504" y="-13638.69" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="504" y="-13623.69" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="504" y="-13608.69" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- layer_out_4&#45;&gt;residual1_5 -->
<g id="edge77" class="edge">
<title>layer_out_4&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M748.79,-14130.94C755.47,-14124.51 761.54,-14117.29 766,-14109.39 786.87,-14072.42 780,-14057.35 780,-14014.89 780,-14014.89 780,-14014.89 780,-13742.89 780,-13679.24 716.59,-13650.3 650.56,-13637.42"/>
<polygon fill="black" stroke="black" points="650.85,-13633.92 640.38,-13635.56 649.59,-13640.8 650.85,-13633.92"/>
</g>
<!-- mha_q_5 -->
<g id="node55" class="node">
<title>mha_q_5</title>
<polygon fill="lightcoral" stroke="black" points="277.5,-13950.39 58.5,-13950.39 58.5,-13897.39 277.5,-13897.39 277.5,-13950.39"/>
<text text-anchor="middle" x="168" y="-13935.19" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="168" y="-13920.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="168" y="-13905.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_q_5 -->
<g id="edge70" class="edge">
<title>ln1_5&#45;&gt;mha_q_5</title>
<path fill="none" stroke="black" d="M406.17,-13990.8C364.94,-13979.39 314.19,-13965.35 270.14,-13953.16"/>
<polygon fill="black" stroke="black" points="270.84,-13949.72 260.27,-13950.43 268.98,-13956.47 270.84,-13949.72"/>
</g>
<!-- mha_k_5 -->
<g id="node56" class="node">
<title>mha_k_5</title>
<polygon fill="lightcoral" stroke="black" points="514.5,-13950.39 295.5,-13950.39 295.5,-13897.39 514.5,-13897.39 514.5,-13950.39"/>
<text text-anchor="middle" x="405" y="-13935.19" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="405" y="-13920.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="405" y="-13905.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_k_5 -->
<g id="edge71" class="edge">
<title>ln1_5&#45;&gt;mha_k_5</title>
<path fill="none" stroke="black" d="M462.14,-13986.97C453.81,-13977.93 444.36,-13967.65 435.57,-13958.1"/>
<polygon fill="black" stroke="black" points="438.04,-13955.62 428.69,-13950.63 432.89,-13960.36 438.04,-13955.62"/>
</g>
<!-- mha_v_5 -->
<g id="node57" class="node">
<title>mha_v_5</title>
<polygon fill="lightcoral" stroke="black" points="751.5,-13950.39 532.5,-13950.39 532.5,-13897.39 751.5,-13897.39 751.5,-13950.39"/>
<text text-anchor="middle" x="642" y="-13935.19" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="642" y="-13920.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="642" y="-13905.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln1_5&#45;&gt;mha_v_5 -->
<g id="edge72" class="edge">
<title>ln1_5&#45;&gt;mha_v_5</title>
<path fill="none" stroke="black" d="M531.54,-13987.2C549.16,-13977.26 569.47,-13965.81 587.84,-13955.45"/>
<polygon fill="black" stroke="black" points="589.68,-13958.42 596.67,-13950.46 586.24,-13952.33 589.68,-13958.42"/>
</g>
<!-- mha_attn_5 -->
<g id="node58" class="node">
<title>mha_attn_5</title>
<polygon fill="lightcoral" stroke="black" points="508.5,-13860.39 337.5,-13860.39 337.5,-13807.39 508.5,-13807.39 508.5,-13860.39"/>
<text text-anchor="middle" x="423" y="-13845.19" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="423" y="-13830.19" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="423" y="-13815.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- mha_q_5&#45;&gt;mha_attn_5 -->
<g id="edge73" class="edge">
<title>mha_q_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M242.1,-13897.32C272.48,-13886.84 307.81,-13874.65 339.13,-13863.84"/>
<polygon fill="black" stroke="black" points="340.4,-13867.1 348.72,-13860.53 338.12,-13860.48 340.4,-13867.1"/>
</g>
<!-- mha_k_5&#45;&gt;mha_attn_5 -->
<g id="edge74" class="edge">
<title>mha_k_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M410.3,-13896.97C411.99,-13888.73 413.88,-13879.47 415.68,-13870.67"/>
<polygon fill="black" stroke="black" points="419.16,-13871.13 417.73,-13860.63 412.3,-13869.73 419.16,-13871.13"/>
</g>
<!-- mha_v_5&#45;&gt;mha_attn_5 -->
<g id="edge75" class="edge">
<title>mha_v_5&#45;&gt;mha_attn_5</title>
<path fill="none" stroke="black" d="M578.36,-13897.32C552.72,-13887.02 522.98,-13875.07 496.42,-13864.4"/>
<polygon fill="black" stroke="black" points="497.38,-13861.01 486.8,-13860.53 494.77,-13867.5 497.38,-13861.01"/>
</g>
<!-- mha_out_5 -->
<g id="node59" class="node">
<title>mha_out_5</title>
<polygon fill="lightcoral" stroke="black" points="531.5,-13770.39 372.5,-13770.39 372.5,-13717.39 531.5,-13717.39 531.5,-13770.39"/>
<text text-anchor="middle" x="452" y="-13755.19" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="452" y="-13740.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="452" y="-13725.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- mha_attn_5&#45;&gt;mha_out_5 -->
<g id="edge76" class="edge">
<title>mha_attn_5&#45;&gt;mha_out_5</title>
<path fill="none" stroke="black" d="M431.54,-13806.97C434.29,-13798.64 437.38,-13789.27 440.3,-13780.38"/>
<polygon fill="black" stroke="black" points="443.71,-13781.23 443.52,-13770.63 437.06,-13779.04 443.71,-13781.23"/>
</g>
<!-- mha_out_5&#45;&gt;residual1_5 -->
<g id="edge78" class="edge">
<title>mha_out_5&#45;&gt;residual1_5</title>
<path fill="none" stroke="black" d="M463.67,-13717.2C467.39,-13709 471.68,-13699.55 476.05,-13689.94"/>
<polygon fill="black" stroke="black" points="479.29,-13691.27 480.24,-13680.71 472.92,-13688.37 479.29,-13691.27"/>
</g>
<!-- ln2_5 -->
<g id="node61" class="node">
<title>ln2_5</title>
<polygon fill="lightyellow" stroke="black" points="501.5,-13537.39 342.5,-13537.39 342.5,-13484.39 501.5,-13484.39 501.5,-13537.39"/>
<text text-anchor="middle" x="422" y="-13522.19" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="422" y="-13507.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="422" y="-13492.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- residual1_5&#45;&gt;ln2_5 -->
<g id="edge79" class="edge">
<title>residual1_5&#45;&gt;ln2_5</title>
<path fill="none" stroke="black" d="M466.6,-13574.17C459.69,-13564.51 452.63,-13554.67 446.24,-13545.74"/>
<polygon fill="black" stroke="black" points="449,-13543.59 440.34,-13537.5 443.31,-13547.66 449,-13543.59"/>
</g>
<!-- residual2_5 -->
<g id="node65" class="node">
<title>residual2_5</title>
<polygon fill="lightpink" stroke="black" points="650.69,-13177.39 388.71,-13177.39 321.31,-13071.39 583.29,-13071.39 650.69,-13177.39"/>
<text text-anchor="middle" x="486" y="-13135.69" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="486" y="-13120.69" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="486" y="-13105.69" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- residual1_5&#45;&gt;residual2_5 -->
<g id="edge83" class="edge">
<title>residual1_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M523.68,-13574.12C529.33,-13554.85 534,-13532.65 534,-13511.89 534,-13511.89 534,-13511.89 534,-13239.89 534,-13221.96 528.93,-13203.6 522.09,-13186.97"/>
<polygon fill="black" stroke="black" points="525.11,-13185.15 517.88,-13177.4 518.7,-13187.97 525.11,-13185.15"/>
</g>
<!-- ffn_up_5 -->
<g id="node62" class="node">
<title>ffn_up_5</title>
<polygon fill="lightblue" stroke="black" points="515,-13447.39 299,-13447.39 299,-13394.39 515,-13394.39 515,-13447.39"/>
<text text-anchor="middle" x="407" y="-13432.19" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="407" y="-13417.19" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="407" y="-13402.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ln2_5&#45;&gt;ffn_up_5 -->
<g id="edge80" class="edge">
<title>ln2_5&#45;&gt;ffn_up_5</title>
<path fill="none" stroke="black" d="M417.58,-13483.97C416.18,-13475.73 414.6,-13466.47 413.1,-13457.67"/>
<polygon fill="black" stroke="black" points="416.52,-13456.9 411.39,-13447.63 409.62,-13458.08 416.52,-13456.9"/>
</g>
<!-- ffn_act_5 -->
<g id="node63" class="node">
<title>ffn_act_5</title>
<polygon fill="lightgreen" stroke="black" points="491,-13357.39 323,-13357.39 323,-13304.39 491,-13304.39 491,-13357.39"/>
<text text-anchor="middle" x="407" y="-13342.19" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="407" y="-13327.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="407" y="-13312.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ffn_up_5&#45;&gt;ffn_act_5 -->
<g id="edge81" class="edge">
<title>ffn_up_5&#45;&gt;ffn_act_5</title>
<path fill="none" stroke="black" d="M407,-13393.97C407,-13385.73 407,-13376.47 407,-13367.67"/>
<polygon fill="black" stroke="black" points="410.5,-13367.63 407,-13357.63 403.5,-13367.63 410.5,-13367.63"/>
</g>
<!-- ffn_down_5 -->
<g id="node64" class="node">
<title>ffn_down_5</title>
<polygon fill="lightblue" stroke="black" points="515,-13267.39 299,-13267.39 299,-13214.39 515,-13214.39 515,-13267.39"/>
<text text-anchor="middle" x="407" y="-13252.19" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="407" y="-13237.19" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="407" y="-13222.19" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- ffn_act_5&#45;&gt;ffn_down_5 -->
<g id="edge82" class="edge">
<title>ffn_act_5&#45;&gt;ffn_down_5</title>
<path fill="none" stroke="black" d="M407,-13303.97C407,-13295.73 407,-13286.47 407,-13277.67"/>
<polygon fill="black" stroke="black" points="410.5,-13277.63 407,-13267.63 403.5,-13277.63 410.5,-13277.63"/>
</g>
<!-- ffn_down_5&#45;&gt;residual2_5 -->
<g id="edge84" class="edge">
<title>ffn_down_5&#45;&gt;residual2_5</title>
<path fill="none" stroke="black" d="M424.73,-13214.2C430.56,-13205.75 437.31,-13195.97 444.15,-13186.05"/>
<polygon fill="black" stroke="black" points="447.1,-13187.93 449.9,-13177.71 441.34,-13183.96 447.1,-13187.93"/>
</g>
<!-- layer_out_5 -->
<g id="node66" class="node">
<title>layer_out_5</title>
<ellipse fill="lightgray" stroke="black" cx="486" cy="-12996.92" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="486" y="-13008.22" font-family="Times,serif" font-size="14.00">Layer5_Output</text>
<text text-anchor="middle" x="486" y="-12993.22" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="486" y="-12978.22" font-family="Times,serif" font-size="14.00">GPU&#45;4</text>
</g>
<!-- residual2_5&#45;&gt;layer_out_5 -->
<g id="edge85" class="edge">
<title>residual2_5&#45;&gt;layer_out_5</title>
<path fill="none" stroke="black" d="M486,-13071.27C486,-13062.37 486,-13053.17 486,-13044.42"/>
<polygon fill="black" stroke="black" points="489.5,-13044.4 486,-13034.4 482.5,-13044.4 489.5,-13044.4"/>
</g>
<!-- ln1_6 -->
<g id="node67" class="node">
<title>ln1_6</title>
<polygon fill="lightyellow" stroke="black" points="500.5,-12872.44 341.5,-12872.44 341.5,-12819.44 500.5,-12819.44 500.5,-12872.44"/>
<text text-anchor="middle" x="421" y="-12857.24" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="421" y="-12842.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="421" y="-12827.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- layer_out_5&#45;&gt;ln1_6 -->
<g id="edge86" class="edge">
<title>layer_out_5&#45;&gt;ln1_6</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M470.1,-12959.47C459.79,-12935.85 446.44,-12905.25 436.26,-12881.93"/>
<polygon fill="red" stroke="red" points="439.46,-12880.5 432.25,-12872.74 433.05,-12883.3 439.46,-12880.5"/>
<text text-anchor="middle" x="533.5" y="-12930.24" font-family="Times,serif" font-size="14.00">GPU&#45;4→GPU&#45;5</text>
<text text-anchor="middle" x="533.5" y="-12915.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_6 -->
<g id="node73" class="node">
<title>residual1_6</title>
<polygon fill="lightpink" stroke="black" points="661.69,-12512.44 399.71,-12512.44 332.31,-12406.44 594.29,-12406.44 661.69,-12512.44"/>
<text text-anchor="middle" x="497" y="-12470.74" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="497" y="-12455.74" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="497" y="-12440.74" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- layer_out_5&#45;&gt;residual1_6 -->
<g id="edge94" class="edge">
<title>layer_out_5&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M592.97,-12985.05C677.03,-12969.89 780,-12933.63 780,-12846.94 780,-12846.94 780,-12846.94 780,-12574.94 780,-12544.63 723.51,-12518.55 661,-12498.96"/>
<polygon fill="black" stroke="black" points="661.92,-12495.59 651.34,-12496 659.87,-12502.28 661.92,-12495.59"/>
</g>
<!-- mha_q_6 -->
<g id="node68" class="node">
<title>mha_q_6</title>
<polygon fill="lightcoral" stroke="black" points="277.5,-12782.44 58.5,-12782.44 58.5,-12729.44 277.5,-12729.44 277.5,-12782.44"/>
<text text-anchor="middle" x="168" y="-12767.24" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="168" y="-12752.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="168" y="-12737.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_q_6 -->
<g id="edge87" class="edge">
<title>ln1_6&#45;&gt;mha_q_6</title>
<path fill="none" stroke="black" d="M347.48,-12819.37C317.34,-12808.88 282.29,-12796.69 251.21,-12785.88"/>
<polygon fill="black" stroke="black" points="252.3,-12782.55 241.7,-12782.58 250,-12789.17 252.3,-12782.55"/>
</g>
<!-- mha_k_6 -->
<g id="node69" class="node">
<title>mha_k_6</title>
<polygon fill="lightcoral" stroke="black" points="514.5,-12782.44 295.5,-12782.44 295.5,-12729.44 514.5,-12729.44 514.5,-12782.44"/>
<text text-anchor="middle" x="405" y="-12767.24" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="405" y="-12752.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="405" y="-12737.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_k_6 -->
<g id="edge88" class="edge">
<title>ln1_6&#45;&gt;mha_k_6</title>
<path fill="none" stroke="black" d="M416.29,-12819.01C414.79,-12810.78 413.11,-12801.52 411.5,-12792.72"/>
<polygon fill="black" stroke="black" points="414.91,-12791.89 409.68,-12782.68 408.03,-12793.15 414.91,-12791.89"/>
</g>
<!-- mha_v_6 -->
<g id="node70" class="node">
<title>mha_v_6</title>
<polygon fill="lightcoral" stroke="black" points="751.5,-12782.44 532.5,-12782.44 532.5,-12729.44 751.5,-12729.44 751.5,-12782.44"/>
<text text-anchor="middle" x="642" y="-12767.24" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="642" y="-12752.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="642" y="-12737.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln1_6&#45;&gt;mha_v_6 -->
<g id="edge89" class="edge">
<title>ln1_6&#45;&gt;mha_v_6</title>
<path fill="none" stroke="black" d="M485.22,-12819.37C511.21,-12809.02 541.37,-12797.01 568.26,-12786.3"/>
<polygon fill="black" stroke="black" points="569.62,-12789.53 577.62,-12782.58 567.04,-12783.02 569.62,-12789.53"/>
</g>
<!-- mha_attn_6 -->
<g id="node71" class="node">
<title>mha_attn_6</title>
<polygon fill="lightcoral" stroke="black" points="501.5,-12692.44 330.5,-12692.44 330.5,-12639.44 501.5,-12639.44 501.5,-12692.44"/>
<text text-anchor="middle" x="416" y="-12677.24" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="416" y="-12662.24" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="416" y="-12647.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- mha_q_6&#45;&gt;mha_attn_6 -->
<g id="edge90" class="edge">
<title>mha_q_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M240.07,-12729.37C269.49,-12718.93 303.67,-12706.8 334.04,-12696.02"/>
<polygon fill="black" stroke="black" points="335.5,-12699.22 343.76,-12692.58 333.16,-12692.62 335.5,-12699.22"/>
</g>
<!-- mha_k_6&#45;&gt;mha_attn_6 -->
<g id="edge91" class="edge">
<title>mha_k_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M408.24,-12729.01C409.27,-12720.78 410.43,-12711.52 411.53,-12702.72"/>
<polygon fill="black" stroke="black" points="415.01,-12703.04 412.78,-12692.68 408.07,-12702.17 415.01,-12703.04"/>
</g>
<!-- mha_v_6&#45;&gt;mha_attn_6 -->
<g id="edge92" class="edge">
<title>mha_v_6&#45;&gt;mha_attn_6</title>
<path fill="none" stroke="black" d="M576.33,-12729.37C549.75,-12719.02 518.9,-12707.01 491.41,-12696.3"/>
<polygon fill="black" stroke="black" points="492.42,-12692.94 481.84,-12692.58 489.88,-12699.47 492.42,-12692.94"/>
</g>
<!-- mha_out_6 -->
<g id="node72" class="node">
<title>mha_out_6</title>
<polygon fill="lightcoral" stroke="black" points="542.5,-12602.44 383.5,-12602.44 383.5,-12549.44 542.5,-12549.44 542.5,-12602.44"/>
<text text-anchor="middle" x="463" y="-12587.24" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="463" y="-12572.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="463" y="-12557.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- mha_attn_6&#45;&gt;mha_out_6 -->
<g id="edge93" class="edge">
<title>mha_attn_6&#45;&gt;mha_out_6</title>
<path fill="none" stroke="black" d="M429.85,-12639.01C434.44,-12630.42 439.62,-12620.71 444.5,-12611.57"/>
<polygon fill="black" stroke="black" points="447.63,-12613.15 449.25,-12602.68 441.45,-12609.85 447.63,-12613.15"/>
</g>
<!-- mha_out_6&#45;&gt;residual1_6 -->
<g id="edge95" class="edge">
<title>mha_out_6&#45;&gt;residual1_6</title>
<path fill="none" stroke="black" d="M470.63,-12549.24C473.01,-12541.22 475.75,-12531.99 478.55,-12522.58"/>
<polygon fill="black" stroke="black" points="481.97,-12523.34 481.46,-12512.76 475.26,-12521.35 481.97,-12523.34"/>
</g>
<!-- ln2_6 -->
<g id="node74" class="node">
<title>ln2_6</title>
<polygon fill="lightyellow" stroke="black" points="494.5,-12369.44 335.5,-12369.44 335.5,-12316.44 494.5,-12316.44 494.5,-12369.44"/>
<text text-anchor="middle" x="415" y="-12354.24" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="415" y="-12339.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="415" y="-12324.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- residual1_6&#45;&gt;ln2_6 -->
<g id="edge96" class="edge">
<title>residual1_6&#45;&gt;ln2_6</title>
<path fill="none" stroke="black" d="M459.6,-12406.22C452.69,-12396.56 445.63,-12386.71 439.24,-12377.79"/>
<polygon fill="black" stroke="black" points="442,-12375.63 433.34,-12369.54 436.31,-12379.71 442,-12375.63"/>
</g>
<!-- residual2_6 -->
<g id="node78" class="node">
<title>residual2_6</title>
<polygon fill="lightpink" stroke="black" points="635.69,-12009.44 373.71,-12009.44 306.31,-11903.44 568.29,-11903.44 635.69,-12009.44"/>
<text text-anchor="middle" x="471" y="-11967.74" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="471" y="-11952.74" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-11937.74" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- residual1_6&#45;&gt;residual2_6 -->
<g id="edge100" class="edge">
<title>residual1_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M516.68,-12406.17C522.33,-12386.9 527,-12364.69 527,-12343.94 527,-12343.94 527,-12343.94 527,-12071.94 527,-12053.64 521.16,-12035.22 513.25,-12018.66"/>
<polygon fill="black" stroke="black" points="516.32,-12016.99 508.66,-12009.67 510.09,-12020.17 516.32,-12016.99"/>
</g>
<!-- ffn_up_6 -->
<g id="node75" class="node">
<title>ffn_up_6</title>
<polygon fill="lightblue" stroke="black" points="508,-12279.44 292,-12279.44 292,-12226.44 508,-12226.44 508,-12279.44"/>
<text text-anchor="middle" x="400" y="-12264.24" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="400" y="-12249.24" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="400" y="-12234.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ln2_6&#45;&gt;ffn_up_6 -->
<g id="edge97" class="edge">
<title>ln2_6&#45;&gt;ffn_up_6</title>
<path fill="none" stroke="black" d="M410.58,-12316.01C409.18,-12307.78 407.6,-12298.52 406.1,-12289.72"/>
<polygon fill="black" stroke="black" points="409.52,-12288.95 404.39,-12279.68 402.62,-12290.13 409.52,-12288.95"/>
</g>
<!-- ffn_act_6 -->
<g id="node76" class="node">
<title>ffn_act_6</title>
<polygon fill="lightgreen" stroke="black" points="484,-12189.44 316,-12189.44 316,-12136.44 484,-12136.44 484,-12189.44"/>
<text text-anchor="middle" x="400" y="-12174.24" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="400" y="-12159.24" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="400" y="-12144.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ffn_up_6&#45;&gt;ffn_act_6 -->
<g id="edge98" class="edge">
<title>ffn_up_6&#45;&gt;ffn_act_6</title>
<path fill="none" stroke="black" d="M400,-12226.01C400,-12217.78 400,-12208.52 400,-12199.72"/>
<polygon fill="black" stroke="black" points="403.5,-12199.68 400,-12189.68 396.5,-12199.68 403.5,-12199.68"/>
</g>
<!-- ffn_down_6 -->
<g id="node77" class="node">
<title>ffn_down_6</title>
<polygon fill="lightblue" stroke="black" points="508,-12099.44 292,-12099.44 292,-12046.44 508,-12046.44 508,-12099.44"/>
<text text-anchor="middle" x="400" y="-12084.24" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="400" y="-12069.24" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="400" y="-12054.24" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- ffn_act_6&#45;&gt;ffn_down_6 -->
<g id="edge99" class="edge">
<title>ffn_act_6&#45;&gt;ffn_down_6</title>
<path fill="none" stroke="black" d="M400,-12136.01C400,-12127.78 400,-12118.52 400,-12109.72"/>
<polygon fill="black" stroke="black" points="403.5,-12109.68 400,-12099.68 396.5,-12109.68 403.5,-12109.68"/>
</g>
<!-- ffn_down_6&#45;&gt;residual2_6 -->
<g id="edge101" class="edge">
<title>ffn_down_6&#45;&gt;residual2_6</title>
<path fill="none" stroke="black" d="M415.93,-12046.24C421.12,-12037.88 427.12,-12028.21 433.2,-12018.39"/>
<polygon fill="black" stroke="black" points="436.26,-12020.1 438.56,-12009.76 430.31,-12016.41 436.26,-12020.1"/>
</g>
<!-- layer_out_6 -->
<g id="node79" class="node">
<title>layer_out_6</title>
<ellipse fill="lightgray" stroke="black" cx="471" cy="-11828.96" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="471" y="-11840.26" font-family="Times,serif" font-size="14.00">Layer6_Output</text>
<text text-anchor="middle" x="471" y="-11825.26" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-11810.26" font-family="Times,serif" font-size="14.00">GPU&#45;5</text>
</g>
<!-- residual2_6&#45;&gt;layer_out_6 -->
<g id="edge102" class="edge">
<title>residual2_6&#45;&gt;layer_out_6</title>
<path fill="none" stroke="black" d="M471,-11903.32C471,-11894.41 471,-11885.21 471,-11876.47"/>
<polygon fill="black" stroke="black" points="474.5,-11876.45 471,-11866.45 467.5,-11876.45 474.5,-11876.45"/>
</g>
<!-- ln1_7 -->
<g id="node80" class="node">
<title>ln1_7</title>
<polygon fill="lightyellow" stroke="black" points="506.5,-11704.49 347.5,-11704.49 347.5,-11651.49 506.5,-11651.49 506.5,-11704.49"/>
<text text-anchor="middle" x="427" y="-11689.29" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="427" y="-11674.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="427" y="-11659.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- layer_out_6&#45;&gt;ln1_7 -->
<g id="edge103" class="edge">
<title>layer_out_6&#45;&gt;ln1_7</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M460.24,-11791.52C453.32,-11768.11 444.38,-11737.84 437.52,-11714.6"/>
<polygon fill="red" stroke="red" points="440.81,-11713.38 434.62,-11704.78 434.09,-11715.36 440.81,-11713.38"/>
<text text-anchor="middle" x="526.5" y="-11762.29" font-family="Times,serif" font-size="14.00">GPU&#45;5→GPU&#45;6</text>
<text text-anchor="middle" x="526.5" y="-11747.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_7 -->
<g id="node86" class="node">
<title>residual1_7</title>
<polygon fill="lightpink" stroke="black" points="661.69,-11344.49 399.71,-11344.49 332.31,-11238.49 594.29,-11238.49 661.69,-11344.49"/>
<text text-anchor="middle" x="497" y="-11302.79" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="497" y="-11287.79" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="497" y="-11272.79" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- layer_out_6&#45;&gt;residual1_7 -->
<g id="edge111" class="edge">
<title>layer_out_6&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M579.94,-11819.41C668.9,-11805.75 780,-11770.4 780,-11678.99 780,-11678.99 780,-11678.99 780,-11406.99 780,-11376.68 723.51,-11350.59 661,-11331.01"/>
<polygon fill="black" stroke="black" points="661.92,-11327.63 651.34,-11328.05 659.87,-11334.33 661.92,-11327.63"/>
</g>
<!-- mha_q_7 -->
<g id="node81" class="node">
<title>mha_q_7</title>
<polygon fill="lightcoral" stroke="black" points="277.5,-11614.49 58.5,-11614.49 58.5,-11561.49 277.5,-11561.49 277.5,-11614.49"/>
<text text-anchor="middle" x="168" y="-11599.29" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="168" y="-11584.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="168" y="-11569.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_q_7 -->
<g id="edge104" class="edge">
<title>ln1_7&#45;&gt;mha_q_7</title>
<path fill="none" stroke="black" d="M351.74,-11651.42C320.88,-11640.93 285,-11628.74 253.18,-11617.93"/>
<polygon fill="black" stroke="black" points="254.04,-11614.52 243.45,-11614.62 251.79,-11621.15 254.04,-11614.52"/>
</g>
<!-- mha_k_7 -->
<g id="node82" class="node">
<title>mha_k_7</title>
<polygon fill="lightcoral" stroke="black" points="514.5,-11614.49 295.5,-11614.49 295.5,-11561.49 514.5,-11561.49 514.5,-11614.49"/>
<text text-anchor="middle" x="405" y="-11599.29" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="405" y="-11584.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="405" y="-11569.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_k_7 -->
<g id="edge105" class="edge">
<title>ln1_7&#45;&gt;mha_k_7</title>
<path fill="none" stroke="black" d="M420.52,-11651.06C418.44,-11642.73 416.09,-11633.37 413.87,-11624.48"/>
<polygon fill="black" stroke="black" points="417.26,-11623.58 411.44,-11614.73 410.47,-11625.28 417.26,-11623.58"/>
</g>
<!-- mha_v_7 -->
<g id="node83" class="node">
<title>mha_v_7</title>
<polygon fill="lightcoral" stroke="black" points="751.5,-11614.49 532.5,-11614.49 532.5,-11561.49 751.5,-11561.49 751.5,-11614.49"/>
<text text-anchor="middle" x="642" y="-11599.29" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="642" y="-11584.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="642" y="-11569.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln1_7&#45;&gt;mha_v_7 -->
<g id="edge106" class="edge">
<title>ln1_7&#45;&gt;mha_v_7</title>
<path fill="none" stroke="black" d="M489.48,-11651.42C514.65,-11641.11 543.85,-11629.16 569.92,-11618.49"/>
<polygon fill="black" stroke="black" points="571.44,-11621.65 579.37,-11614.62 568.79,-11615.17 571.44,-11621.65"/>
</g>
<!-- mha_attn_7 -->
<g id="node84" class="node">
<title>mha_attn_7</title>
<polygon fill="lightcoral" stroke="black" points="501.5,-11524.49 330.5,-11524.49 330.5,-11471.49 501.5,-11471.49 501.5,-11524.49"/>
<text text-anchor="middle" x="416" y="-11509.29" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="416" y="-11494.29" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="416" y="-11479.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- mha_q_7&#45;&gt;mha_attn_7 -->
<g id="edge107" class="edge">
<title>mha_q_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M240.07,-11561.42C269.49,-11550.97 303.67,-11538.84 334.04,-11528.07"/>
<polygon fill="black" stroke="black" points="335.5,-11531.26 343.76,-11524.62 333.16,-11524.67 335.5,-11531.26"/>
</g>
<!-- mha_k_7&#45;&gt;mha_attn_7 -->
<g id="edge108" class="edge">
<title>mha_k_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M408.24,-11561.06C409.27,-11552.82 410.43,-11543.57 411.53,-11534.76"/>
<polygon fill="black" stroke="black" points="415.01,-11535.09 412.78,-11524.73 408.07,-11534.22 415.01,-11535.09"/>
</g>
<!-- mha_v_7&#45;&gt;mha_attn_7 -->
<g id="edge109" class="edge">
<title>mha_v_7&#45;&gt;mha_attn_7</title>
<path fill="none" stroke="black" d="M576.33,-11561.42C549.75,-11551.07 518.9,-11539.05 491.41,-11528.35"/>
<polygon fill="black" stroke="black" points="492.42,-11524.99 481.84,-11524.62 489.88,-11531.51 492.42,-11524.99"/>
</g>
<!-- mha_out_7 -->
<g id="node85" class="node">
<title>mha_out_7</title>
<polygon fill="lightcoral" stroke="black" points="542.5,-11434.49 383.5,-11434.49 383.5,-11381.49 542.5,-11381.49 542.5,-11434.49"/>
<text text-anchor="middle" x="463" y="-11419.29" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="463" y="-11404.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="463" y="-11389.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- mha_attn_7&#45;&gt;mha_out_7 -->
<g id="edge110" class="edge">
<title>mha_attn_7&#45;&gt;mha_out_7</title>
<path fill="none" stroke="black" d="M429.85,-11471.06C434.44,-11462.47 439.62,-11452.76 444.5,-11443.62"/>
<polygon fill="black" stroke="black" points="447.63,-11445.2 449.25,-11434.73 441.45,-11441.9 447.63,-11445.2"/>
</g>
<!-- mha_out_7&#45;&gt;residual1_7 -->
<g id="edge112" class="edge">
<title>mha_out_7&#45;&gt;residual1_7</title>
<path fill="none" stroke="black" d="M470.63,-11381.29C473.01,-11373.27 475.75,-11364.04 478.55,-11354.63"/>
<polygon fill="black" stroke="black" points="481.97,-11355.39 481.46,-11344.81 475.26,-11353.4 481.97,-11355.39"/>
</g>
<!-- ln2_7 -->
<g id="node87" class="node">
<title>ln2_7</title>
<polygon fill="lightyellow" stroke="black" points="494.5,-11201.49 335.5,-11201.49 335.5,-11148.49 494.5,-11148.49 494.5,-11201.49"/>
<text text-anchor="middle" x="415" y="-11186.29" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="415" y="-11171.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="415" y="-11156.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- residual1_7&#45;&gt;ln2_7 -->
<g id="edge113" class="edge">
<title>residual1_7&#45;&gt;ln2_7</title>
<path fill="none" stroke="black" d="M459.6,-11238.26C452.69,-11228.61 445.63,-11218.76 439.24,-11209.83"/>
<polygon fill="black" stroke="black" points="442,-11207.68 433.34,-11201.59 436.31,-11211.76 442,-11207.68"/>
</g>
<!-- residual2_7 -->
<g id="node91" class="node">
<title>residual2_7</title>
<polygon fill="lightpink" stroke="black" points="635.69,-10841.49 373.71,-10841.49 306.31,-10735.49 568.29,-10735.49 635.69,-10841.49"/>
<text text-anchor="middle" x="471" y="-10799.79" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="471" y="-10784.79" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-10769.79" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- residual1_7&#45;&gt;residual2_7 -->
<g id="edge117" class="edge">
<title>residual1_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M516.68,-11238.22C522.33,-11218.94 527,-11196.74 527,-11175.99 527,-11175.99 527,-11175.99 527,-10903.99 527,-10885.69 521.16,-10867.27 513.25,-10850.71"/>
<polygon fill="black" stroke="black" points="516.32,-10849.03 508.66,-10841.71 510.09,-10852.21 516.32,-10849.03"/>
</g>
<!-- ffn_up_7 -->
<g id="node88" class="node">
<title>ffn_up_7</title>
<polygon fill="lightblue" stroke="black" points="508,-11111.49 292,-11111.49 292,-11058.49 508,-11058.49 508,-11111.49"/>
<text text-anchor="middle" x="400" y="-11096.29" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="400" y="-11081.29" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="400" y="-11066.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ln2_7&#45;&gt;ffn_up_7 -->
<g id="edge114" class="edge">
<title>ln2_7&#45;&gt;ffn_up_7</title>
<path fill="none" stroke="black" d="M410.58,-11148.06C409.18,-11139.82 407.6,-11130.57 406.1,-11121.76"/>
<polygon fill="black" stroke="black" points="409.52,-11121 404.39,-11111.73 402.62,-11122.17 409.52,-11121"/>
</g>
<!-- ffn_act_7 -->
<g id="node89" class="node">
<title>ffn_act_7</title>
<polygon fill="lightgreen" stroke="black" points="484,-11021.49 316,-11021.49 316,-10968.49 484,-10968.49 484,-11021.49"/>
<text text-anchor="middle" x="400" y="-11006.29" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="400" y="-10991.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="400" y="-10976.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ffn_up_7&#45;&gt;ffn_act_7 -->
<g id="edge115" class="edge">
<title>ffn_up_7&#45;&gt;ffn_act_7</title>
<path fill="none" stroke="black" d="M400,-11058.06C400,-11049.82 400,-11040.57 400,-11031.76"/>
<polygon fill="black" stroke="black" points="403.5,-11031.73 400,-11021.73 396.5,-11031.73 403.5,-11031.73"/>
</g>
<!-- ffn_down_7 -->
<g id="node90" class="node">
<title>ffn_down_7</title>
<polygon fill="lightblue" stroke="black" points="508,-10931.49 292,-10931.49 292,-10878.49 508,-10878.49 508,-10931.49"/>
<text text-anchor="middle" x="400" y="-10916.29" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="400" y="-10901.29" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="400" y="-10886.29" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- ffn_act_7&#45;&gt;ffn_down_7 -->
<g id="edge116" class="edge">
<title>ffn_act_7&#45;&gt;ffn_down_7</title>
<path fill="none" stroke="black" d="M400,-10968.06C400,-10959.82 400,-10950.57 400,-10941.76"/>
<polygon fill="black" stroke="black" points="403.5,-10941.73 400,-10931.73 396.5,-10941.73 403.5,-10941.73"/>
</g>
<!-- ffn_down_7&#45;&gt;residual2_7 -->
<g id="edge118" class="edge">
<title>ffn_down_7&#45;&gt;residual2_7</title>
<path fill="none" stroke="black" d="M415.93,-10878.29C421.12,-10869.93 427.12,-10860.26 433.2,-10850.44"/>
<polygon fill="black" stroke="black" points="436.26,-10852.15 438.56,-10841.81 430.31,-10848.46 436.26,-10852.15"/>
</g>
<!-- layer_out_7 -->
<g id="node92" class="node">
<title>layer_out_7</title>
<ellipse fill="lightgray" stroke="black" cx="471" cy="-10661.01" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="471" y="-10672.31" font-family="Times,serif" font-size="14.00">Layer7_Output</text>
<text text-anchor="middle" x="471" y="-10657.31" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-10642.31" font-family="Times,serif" font-size="14.00">GPU&#45;6</text>
</g>
<!-- residual2_7&#45;&gt;layer_out_7 -->
<g id="edge119" class="edge">
<title>residual2_7&#45;&gt;layer_out_7</title>
<path fill="none" stroke="black" d="M471,-10735.36C471,-10726.46 471,-10717.26 471,-10708.51"/>
<polygon fill="black" stroke="black" points="474.5,-10708.5 471,-10698.5 467.5,-10708.5 474.5,-10708.5"/>
</g>
<!-- ln1_8 -->
<g id="node93" class="node">
<title>ln1_8</title>
<polygon fill="lightyellow" stroke="black" points="497.5,-10536.53 338.5,-10536.53 338.5,-10483.53 497.5,-10483.53 497.5,-10536.53"/>
<text text-anchor="middle" x="418" y="-10521.33" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="418" y="-10506.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="418" y="-10491.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- layer_out_7&#45;&gt;ln1_8 -->
<g id="edge120" class="edge">
<title>layer_out_7&#45;&gt;ln1_8</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M458.03,-10623.57C449.67,-10600.05 438.84,-10569.62 430.56,-10546.33"/>
<polygon fill="red" stroke="red" points="433.83,-10545.08 427.18,-10536.83 427.23,-10547.42 433.83,-10545.08"/>
<text text-anchor="middle" x="522.5" y="-10594.33" font-family="Times,serif" font-size="14.00">GPU&#45;6→GPU&#45;7</text>
<text text-anchor="middle" x="522.5" y="-10579.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_8 -->
<g id="node99" class="node">
<title>residual1_8</title>
<polygon fill="lightpink" stroke="black" points="656.69,-10176.53 394.71,-10176.53 327.31,-10070.53 589.29,-10070.53 656.69,-10176.53"/>
<text text-anchor="middle" x="492" y="-10134.83" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="492" y="-10119.83" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="492" y="-10104.83" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- layer_out_7&#45;&gt;residual1_8 -->
<g id="edge128" class="edge">
<title>layer_out_7&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M579.94,-10651.45C668.9,-10637.8 780,-10602.45 780,-10511.03 780,-10511.03 780,-10511.03 780,-10239.03 780,-10207.62 720.09,-10181.05 654.92,-10161.43"/>
<polygon fill="black" stroke="black" points="655.86,-10158.05 645.28,-10158.58 653.88,-10164.77 655.86,-10158.05"/>
</g>
<!-- mha_q_8 -->
<g id="node94" class="node">
<title>mha_q_8</title>
<polygon fill="lightcoral" stroke="black" points="277.5,-10446.53 58.5,-10446.53 58.5,-10393.53 277.5,-10393.53 277.5,-10446.53"/>
<text text-anchor="middle" x="168" y="-10431.33" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="168" y="-10416.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="168" y="-10401.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_q_8 -->
<g id="edge121" class="edge">
<title>ln1_8&#45;&gt;mha_q_8</title>
<path fill="none" stroke="black" d="M345.35,-10483.46C315.69,-10473.02 281.23,-10460.89 250.62,-10450.12"/>
<polygon fill="black" stroke="black" points="251.42,-10446.69 240.83,-10446.67 249.1,-10453.29 251.42,-10446.69"/>
</g>
<!-- mha_k_8 -->
<g id="node95" class="node">
<title>mha_k_8</title>
<polygon fill="lightcoral" stroke="black" points="514.5,-10446.53 295.5,-10446.53 295.5,-10393.53 514.5,-10393.53 514.5,-10446.53"/>
<text text-anchor="middle" x="405" y="-10431.33" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="405" y="-10416.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="405" y="-10401.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_k_8 -->
<g id="edge122" class="edge">
<title>ln1_8&#45;&gt;mha_k_8</title>
<path fill="none" stroke="black" d="M414.17,-10483.11C412.95,-10474.87 411.59,-10465.61 410.29,-10456.81"/>
<polygon fill="black" stroke="black" points="413.73,-10456.16 408.8,-10446.77 406.8,-10457.18 413.73,-10456.16"/>
</g>
<!-- mha_v_8 -->
<g id="node96" class="node">
<title>mha_v_8</title>
<polygon fill="lightcoral" stroke="black" points="751.5,-10446.53 532.5,-10446.53 532.5,-10393.53 751.5,-10393.53 751.5,-10446.53"/>
<text text-anchor="middle" x="642" y="-10431.33" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="642" y="-10416.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="642" y="-10401.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln1_8&#45;&gt;mha_v_8 -->
<g id="edge123" class="edge">
<title>ln1_8&#45;&gt;mha_v_8</title>
<path fill="none" stroke="black" d="M483.09,-10483.46C509.44,-10473.11 540.01,-10461.1 567.26,-10450.4"/>
<polygon fill="black" stroke="black" points="568.72,-10453.58 576.75,-10446.67 566.16,-10447.07 568.72,-10453.58"/>
</g>
<!-- mha_attn_8 -->
<g id="node97" class="node">
<title>mha_attn_8</title>
<polygon fill="lightcoral" stroke="black" points="519.5,-10356.53 348.5,-10356.53 348.5,-10303.53 519.5,-10303.53 519.5,-10356.53"/>
<text text-anchor="middle" x="434" y="-10341.33" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="434" y="-10326.33" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="434" y="-10311.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- mha_q_8&#45;&gt;mha_attn_8 -->
<g id="edge124" class="edge">
<title>mha_q_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M245.3,-10393.46C277.13,-10382.93 314.15,-10370.68 346.94,-10359.84"/>
<polygon fill="black" stroke="black" points="348.12,-10363.13 356.51,-10356.67 345.92,-10356.49 348.12,-10363.13"/>
</g>
<!-- mha_k_8&#45;&gt;mha_attn_8 -->
<g id="edge125" class="edge">
<title>mha_k_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M413.54,-10393.11C416.29,-10384.78 419.38,-10375.41 422.3,-10366.52"/>
<polygon fill="black" stroke="black" points="425.71,-10367.37 425.52,-10356.77 419.06,-10365.18 425.71,-10367.37"/>
</g>
<!-- mha_v_8&#45;&gt;mha_attn_8 -->
<g id="edge126" class="edge">
<title>mha_v_8&#45;&gt;mha_attn_8</title>
<path fill="none" stroke="black" d="M581.56,-10393.46C557.31,-10383.2 529.2,-10371.31 504.07,-10360.68"/>
<polygon fill="black" stroke="black" points="505.17,-10357.34 494.59,-10356.67 502.44,-10363.79 505.17,-10357.34"/>
</g>
<!-- mha_out_8 -->
<g id="node98" class="node">
<title>mha_out_8</title>
<polygon fill="lightcoral" stroke="black" points="550.5,-10266.53 391.5,-10266.53 391.5,-10213.53 550.5,-10213.53 550.5,-10266.53"/>
<text text-anchor="middle" x="471" y="-10251.33" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="471" y="-10236.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-10221.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- mha_attn_8&#45;&gt;mha_out_8 -->
<g id="edge127" class="edge">
<title>mha_attn_8&#45;&gt;mha_out_8</title>
<path fill="none" stroke="black" d="M444.9,-10303.11C448.44,-10294.69 452.43,-10285.21 456.2,-10276.24"/>
<polygon fill="black" stroke="black" points="459.53,-10277.35 460.18,-10266.77 453.07,-10274.64 459.53,-10277.35"/>
</g>
<!-- mha_out_8&#45;&gt;residual1_8 -->
<g id="edge129" class="edge">
<title>mha_out_8&#45;&gt;residual1_8</title>
<path fill="none" stroke="black" d="M475.71,-10213.34C477.17,-10205.4 478.84,-10196.28 480.55,-10186.97"/>
<polygon fill="black" stroke="black" points="484.04,-10187.32 482.4,-10176.85 477.16,-10186.06 484.04,-10187.32"/>
</g>
<!-- ln2_8 -->
<g id="node100" class="node">
<title>ln2_8</title>
<polygon fill="lightyellow" stroke="black" points="489.5,-10033.53 330.5,-10033.53 330.5,-9980.53 489.5,-9980.53 489.5,-10033.53"/>
<text text-anchor="middle" x="410" y="-10018.33" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="410" y="-10003.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="410" y="-9988.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual1_8&#45;&gt;ln2_8 -->
<g id="edge130" class="edge">
<title>residual1_8&#45;&gt;ln2_8</title>
<path fill="none" stroke="black" d="M454.6,-10070.31C447.69,-10060.65 440.63,-10050.81 434.24,-10041.88"/>
<polygon fill="black" stroke="black" points="437,-10039.73 428.34,-10033.64 431.31,-10043.8 437,-10039.73"/>
</g>
<!-- residual2_8 -->
<g id="node104" class="node">
<title>residual2_8</title>
<polygon fill="lightpink" stroke="black" points="626.69,-9673.53 364.71,-9673.53 297.31,-9567.53 559.29,-9567.53 626.69,-9673.53"/>
<text text-anchor="middle" x="462" y="-9631.83" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="462" y="-9616.83" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="462" y="-9601.83" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual1_8&#45;&gt;residual2_8 -->
<g id="edge134" class="edge">
<title>residual1_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M511.68,-10070.26C517.33,-10050.99 522,-10028.79 522,-10008.03 522,-10008.03 522,-10008.03 522,-9736.03 522,-9717.57 515.8,-9699.15 507.39,-9682.65"/>
<polygon fill="black" stroke="black" points="510.37,-9680.8 502.52,-9673.69 504.23,-9684.15 510.37,-9680.8"/>
</g>
<!-- ffn_up_8 -->
<g id="node101" class="node">
<title>ffn_up_8</title>
<polygon fill="lightblue" stroke="black" points="503,-9943.53 287,-9943.53 287,-9890.53 503,-9890.53 503,-9943.53"/>
<text text-anchor="middle" x="395" y="-9928.33" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="395" y="-9913.33" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="395" y="-9898.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ln2_8&#45;&gt;ffn_up_8 -->
<g id="edge131" class="edge">
<title>ln2_8&#45;&gt;ffn_up_8</title>
<path fill="none" stroke="black" d="M405.58,-9980.11C404.18,-9971.87 402.6,-9962.61 401.1,-9953.81"/>
<polygon fill="black" stroke="black" points="404.52,-9953.04 399.39,-9943.77 397.62,-9954.22 404.52,-9953.04"/>
</g>
<!-- ffn_act_8 -->
<g id="node102" class="node">
<title>ffn_act_8</title>
<polygon fill="lightgreen" stroke="black" points="479,-9853.53 311,-9853.53 311,-9800.53 479,-9800.53 479,-9853.53"/>
<text text-anchor="middle" x="395" y="-9838.33" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="395" y="-9823.33" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="395" y="-9808.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ffn_up_8&#45;&gt;ffn_act_8 -->
<g id="edge132" class="edge">
<title>ffn_up_8&#45;&gt;ffn_act_8</title>
<path fill="none" stroke="black" d="M395,-9890.11C395,-9881.87 395,-9872.61 395,-9863.81"/>
<polygon fill="black" stroke="black" points="398.5,-9863.77 395,-9853.77 391.5,-9863.77 398.5,-9863.77"/>
</g>
<!-- ffn_down_8 -->
<g id="node103" class="node">
<title>ffn_down_8</title>
<polygon fill="lightblue" stroke="black" points="503,-9763.53 287,-9763.53 287,-9710.53 503,-9710.53 503,-9763.53"/>
<text text-anchor="middle" x="395" y="-9748.33" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="395" y="-9733.33" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="395" y="-9718.33" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- ffn_act_8&#45;&gt;ffn_down_8 -->
<g id="edge133" class="edge">
<title>ffn_act_8&#45;&gt;ffn_down_8</title>
<path fill="none" stroke="black" d="M395,-9800.11C395,-9791.87 395,-9782.61 395,-9773.81"/>
<polygon fill="black" stroke="black" points="398.5,-9773.77 395,-9763.77 391.5,-9773.77 398.5,-9773.77"/>
</g>
<!-- ffn_down_8&#45;&gt;residual2_8 -->
<g id="edge135" class="edge">
<title>ffn_down_8&#45;&gt;residual2_8</title>
<path fill="none" stroke="black" d="M410.04,-9710.34C414.93,-9701.97 420.59,-9692.3 426.33,-9682.49"/>
<polygon fill="black" stroke="black" points="429.35,-9684.25 431.38,-9673.85 423.31,-9680.72 429.35,-9684.25"/>
</g>
<!-- layer_out_8 -->
<g id="node105" class="node">
<title>layer_out_8</title>
<ellipse fill="lightgray" stroke="black" cx="462" cy="-9493.06" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="462" y="-9504.36" font-family="Times,serif" font-size="14.00">Layer8_Output</text>
<text text-anchor="middle" x="462" y="-9489.36" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="462" y="-9474.36" font-family="Times,serif" font-size="14.00">GPU&#45;7</text>
</g>
<!-- residual2_8&#45;&gt;layer_out_8 -->
<g id="edge136" class="edge">
<title>residual2_8&#45;&gt;layer_out_8</title>
<path fill="none" stroke="black" d="M462,-9567.41C462,-9558.51 462,-9549.31 462,-9540.56"/>
<polygon fill="black" stroke="black" points="465.5,-9540.54 462,-9530.54 458.5,-9540.54 465.5,-9540.54"/>
</g>
<!-- ln1_9 -->
<g id="node106" class="node">
<title>ln1_9</title>
<polygon fill="lightyellow" stroke="black" points="474.5,-9368.58 315.5,-9368.58 315.5,-9315.58 474.5,-9315.58 474.5,-9368.58"/>
<text text-anchor="middle" x="395" y="-9353.38" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="395" y="-9338.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="395" y="-9323.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- layer_out_8&#45;&gt;ln1_9 -->
<g id="edge137" class="edge">
<title>layer_out_8&#45;&gt;ln1_9</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M445.61,-9455.61C434.99,-9431.99 421.23,-9401.39 410.73,-9378.07"/>
<polygon fill="red" stroke="red" points="413.89,-9376.56 406.6,-9368.88 407.51,-9379.43 413.89,-9376.56"/>
<text text-anchor="middle" x="508.5" y="-9426.38" font-family="Times,serif" font-size="14.00">GPU&#45;7→GPU&#45;8</text>
<text text-anchor="middle" x="508.5" y="-9411.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_9 -->
<g id="node112" class="node">
<title>residual1_9</title>
<polygon fill="lightpink" stroke="black" points="724.69,-9008.58 462.71,-9008.58 395.31,-8902.58 657.29,-8902.58 724.69,-9008.58"/>
<text text-anchor="middle" x="560" y="-8966.88" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="560" y="-8951.88" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="560" y="-8936.88" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- layer_out_8&#45;&gt;residual1_9 -->
<g id="edge145" class="edge">
<title>layer_out_8&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M568.29,-9480.76C651.42,-9465.33 753,-9428.92 753,-9343.08 753,-9343.08 753,-9343.08 753,-9071.08 753,-9048.48 743.09,-9030.24 727.76,-9015.55"/>
<polygon fill="black" stroke="black" points="729.66,-9012.56 719.82,-9008.62 725.05,-9017.83 729.66,-9012.56"/>
</g>
<!-- mha_q_9 -->
<g id="node107" class="node">
<title>mha_q_9</title>
<polygon fill="lightcoral" stroke="black" points="250.5,-9278.58 31.5,-9278.58 31.5,-9225.58 250.5,-9225.58 250.5,-9278.58"/>
<text text-anchor="middle" x="141" y="-9263.38" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="141" y="-9248.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="141" y="-9233.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_q_9 -->
<g id="edge138" class="edge">
<title>ln1_9&#45;&gt;mha_q_9</title>
<path fill="none" stroke="black" d="M321.19,-9315.51C290.93,-9305.02 255.74,-9292.83 224.54,-9282.02"/>
<polygon fill="black" stroke="black" points="225.59,-9278.68 214.99,-9278.72 223.3,-9285.3 225.59,-9278.68"/>
</g>
<!-- mha_k_9 -->
<g id="node108" class="node">
<title>mha_k_9</title>
<polygon fill="lightcoral" stroke="black" points="487.5,-9278.58 268.5,-9278.58 268.5,-9225.58 487.5,-9225.58 487.5,-9278.58"/>
<text text-anchor="middle" x="378" y="-9263.38" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="378" y="-9248.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="378" y="-9233.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_k_9 -->
<g id="edge139" class="edge">
<title>ln1_9&#45;&gt;mha_k_9</title>
<path fill="none" stroke="black" d="M389.99,-9315.15C388.4,-9306.92 386.61,-9297.66 384.91,-9288.86"/>
<polygon fill="black" stroke="black" points="388.31,-9287.98 382.97,-9278.82 381.43,-9289.3 388.31,-9287.98"/>
</g>
<!-- mha_v_9 -->
<g id="node109" class="node">
<title>mha_v_9</title>
<polygon fill="lightcoral" stroke="black" points="724.5,-9278.58 505.5,-9278.58 505.5,-9225.58 724.5,-9225.58 724.5,-9278.58"/>
<text text-anchor="middle" x="615" y="-9263.38" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="615" y="-9248.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="615" y="-9233.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln1_9&#45;&gt;mha_v_9 -->
<g id="edge140" class="edge">
<title>ln1_9&#45;&gt;mha_v_9</title>
<path fill="none" stroke="black" d="M458.93,-9315.51C484.8,-9305.16 514.83,-9293.15 541.59,-9282.44"/>
<polygon fill="black" stroke="black" points="542.93,-9285.68 550.91,-9278.72 540.33,-9279.18 542.93,-9285.68"/>
</g>
<!-- mha_attn_9 -->
<g id="node110" class="node">
<title>mha_attn_9</title>
<polygon fill="lightcoral" stroke="black" points="480.5,-9188.58 309.5,-9188.58 309.5,-9135.58 480.5,-9135.58 480.5,-9188.58"/>
<text text-anchor="middle" x="395" y="-9173.38" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="395" y="-9158.38" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="395" y="-9143.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- mha_q_9&#45;&gt;mha_attn_9 -->
<g id="edge141" class="edge">
<title>mha_q_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M214.81,-9225.51C245.07,-9215.02 280.26,-9202.83 311.46,-9192.02"/>
<polygon fill="black" stroke="black" points="312.7,-9195.3 321.01,-9188.72 310.41,-9188.68 312.7,-9195.3"/>
</g>
<!-- mha_k_9&#45;&gt;mha_attn_9 -->
<g id="edge142" class="edge">
<title>mha_k_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M383.01,-9225.15C384.6,-9216.92 386.39,-9207.66 388.09,-9198.86"/>
<polygon fill="black" stroke="black" points="391.57,-9199.3 390.03,-9188.82 384.69,-9197.98 391.57,-9199.3"/>
</g>
<!-- mha_v_9&#45;&gt;mha_attn_9 -->
<g id="edge143" class="edge">
<title>mha_v_9&#45;&gt;mha_attn_9</title>
<path fill="none" stroke="black" d="M551.07,-9225.51C525.2,-9215.16 495.17,-9203.15 468.41,-9192.44"/>
<polygon fill="black" stroke="black" points="469.67,-9189.18 459.09,-9188.72 467.07,-9195.68 469.67,-9189.18"/>
</g>
<!-- mha_out_9 -->
<g id="node111" class="node">
<title>mha_out_9</title>
<polygon fill="lightcoral" stroke="black" points="588.5,-9098.58 429.5,-9098.58 429.5,-9045.58 588.5,-9045.58 588.5,-9098.58"/>
<text text-anchor="middle" x="509" y="-9083.38" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="509" y="-9068.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="509" y="-9053.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- mha_attn_9&#45;&gt;mha_out_9 -->
<g id="edge144" class="edge">
<title>mha_attn_9&#45;&gt;mha_out_9</title>
<path fill="none" stroke="black" d="M428.28,-9135.39C440.69,-9125.81 454.92,-9114.82 467.95,-9104.77"/>
<polygon fill="black" stroke="black" points="470.1,-9107.53 475.88,-9098.65 465.82,-9101.99 470.1,-9107.53"/>
</g>
<!-- mha_out_9&#45;&gt;residual1_9 -->
<g id="edge146" class="edge">
<title>mha_out_9&#45;&gt;residual1_9</title>
<path fill="none" stroke="black" d="M520.45,-9045.38C524.1,-9037.19 528.3,-9027.74 532.58,-9018.13"/>
<polygon fill="black" stroke="black" points="535.82,-9019.46 536.7,-9008.9 529.43,-9016.61 535.82,-9019.46"/>
</g>
<!-- ln2_9 -->
<g id="node113" class="node">
<title>ln2_9</title>
<polygon fill="lightyellow" stroke="black" points="553.5,-8865.58 394.5,-8865.58 394.5,-8812.58 553.5,-8812.58 553.5,-8865.58"/>
<text text-anchor="middle" x="474" y="-8850.38" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="474" y="-8835.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="474" y="-8820.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual1_9&#45;&gt;ln2_9 -->
<g id="edge147" class="edge">
<title>residual1_9&#45;&gt;ln2_9</title>
<path fill="none" stroke="black" d="M520.77,-8902.36C513.52,-8892.7 506.13,-8882.85 499.42,-8873.93"/>
<polygon fill="black" stroke="black" points="502.03,-8871.58 493.23,-8865.68 496.44,-8875.78 502.03,-8871.58"/>
</g>
<!-- residual2_9 -->
<g id="node117" class="node">
<title>residual2_9</title>
<polygon fill="lightpink" stroke="black" points="711.69,-8505.58 449.71,-8505.58 382.31,-8399.58 644.29,-8399.58 711.69,-8505.58"/>
<text text-anchor="middle" x="547" y="-8463.88" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="547" y="-8448.88" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="547" y="-8433.88" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual1_9&#45;&gt;residual2_9 -->
<g id="edge151" class="edge">
<title>residual1_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M576.98,-8902.41C581.91,-8883.05 586,-8860.77 586,-8840.08 586,-8840.08 586,-8840.08 586,-8568.08 586,-8550.44 581.8,-8532.04 576.16,-8515.29"/>
<polygon fill="black" stroke="black" points="579.36,-8513.86 572.69,-8505.63 572.77,-8516.23 579.36,-8513.86"/>
</g>
<!-- ffn_up_9 -->
<g id="node114" class="node">
<title>ffn_up_9</title>
<polygon fill="lightblue" stroke="black" points="567,-8775.58 351,-8775.58 351,-8722.58 567,-8722.58 567,-8775.58"/>
<text text-anchor="middle" x="459" y="-8760.38" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="459" y="-8745.38" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="459" y="-8730.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ln2_9&#45;&gt;ffn_up_9 -->
<g id="edge148" class="edge">
<title>ln2_9&#45;&gt;ffn_up_9</title>
<path fill="none" stroke="black" d="M469.58,-8812.15C468.18,-8803.92 466.6,-8794.66 465.1,-8785.86"/>
<polygon fill="black" stroke="black" points="468.52,-8785.09 463.39,-8775.82 461.62,-8786.27 468.52,-8785.09"/>
</g>
<!-- ffn_act_9 -->
<g id="node115" class="node">
<title>ffn_act_9</title>
<polygon fill="lightgreen" stroke="black" points="543,-8685.58 375,-8685.58 375,-8632.58 543,-8632.58 543,-8685.58"/>
<text text-anchor="middle" x="459" y="-8670.38" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="459" y="-8655.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="459" y="-8640.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ffn_up_9&#45;&gt;ffn_act_9 -->
<g id="edge149" class="edge">
<title>ffn_up_9&#45;&gt;ffn_act_9</title>
<path fill="none" stroke="black" d="M459,-8722.15C459,-8713.92 459,-8704.66 459,-8695.86"/>
<polygon fill="black" stroke="black" points="462.5,-8695.82 459,-8685.82 455.5,-8695.82 462.5,-8695.82"/>
</g>
<!-- ffn_down_9 -->
<g id="node116" class="node">
<title>ffn_down_9</title>
<polygon fill="lightblue" stroke="black" points="567,-8595.58 351,-8595.58 351,-8542.58 567,-8542.58 567,-8595.58"/>
<text text-anchor="middle" x="459" y="-8580.38" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="459" y="-8565.38" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="459" y="-8550.38" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- ffn_act_9&#45;&gt;ffn_down_9 -->
<g id="edge150" class="edge">
<title>ffn_act_9&#45;&gt;ffn_down_9</title>
<path fill="none" stroke="black" d="M459,-8632.15C459,-8623.92 459,-8614.66 459,-8605.86"/>
<polygon fill="black" stroke="black" points="462.5,-8605.82 459,-8595.82 455.5,-8605.82 462.5,-8605.82"/>
</g>
<!-- ffn_down_9&#45;&gt;residual2_9 -->
<g id="edge152" class="edge">
<title>ffn_down_9&#45;&gt;residual2_9</title>
<path fill="none" stroke="black" d="M478.75,-8542.38C485.31,-8533.85 492.91,-8523.96 500.61,-8513.94"/>
<polygon fill="black" stroke="black" points="503.47,-8515.96 506.79,-8505.9 497.92,-8511.7 503.47,-8515.96"/>
</g>
<!-- layer_out_9 -->
<g id="node118" class="node">
<title>layer_out_9</title>
<ellipse fill="lightgray" stroke="black" cx="547" cy="-8325.1" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="547" y="-8336.4" font-family="Times,serif" font-size="14.00">Layer9_Output</text>
<text text-anchor="middle" x="547" y="-8321.4" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="547" y="-8306.4" font-family="Times,serif" font-size="14.00">GPU&#45;8</text>
</g>
<!-- residual2_9&#45;&gt;layer_out_9 -->
<g id="edge153" class="edge">
<title>residual2_9&#45;&gt;layer_out_9</title>
<path fill="none" stroke="black" d="M547,-8399.46C547,-8390.55 547,-8381.35 547,-8372.61"/>
<polygon fill="black" stroke="black" points="550.5,-8372.59 547,-8362.59 543.5,-8372.59 550.5,-8372.59"/>
</g>
<!-- ln1_10 -->
<g id="node119" class="node">
<title>ln1_10</title>
<polygon fill="lightyellow" stroke="black" points="550.5,-8200.63 391.5,-8200.63 391.5,-8147.63 550.5,-8147.63 550.5,-8200.63"/>
<text text-anchor="middle" x="471" y="-8185.43" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="471" y="-8170.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="471" y="-8155.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- layer_out_9&#45;&gt;ln1_10 -->
<g id="edge154" class="edge">
<title>layer_out_9&#45;&gt;ln1_10</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M528.6,-8288.04C516.5,-8264.32 500.75,-8233.44 488.78,-8209.98"/>
<polygon fill="red" stroke="red" points="491.89,-8208.37 484.23,-8201.06 485.65,-8211.55 491.89,-8208.37"/>
<text text-anchor="middle" x="590.5" y="-8258.43" font-family="Times,serif" font-size="14.00">GPU&#45;8→GPU&#45;9</text>
<text text-anchor="middle" x="590.5" y="-8243.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_10 -->
<g id="node125" class="node">
<title>residual1_10</title>
<polygon fill="lightpink" stroke="black" points="704.69,-7840.63 442.71,-7840.63 375.31,-7734.63 637.29,-7734.63 704.69,-7840.63"/>
<text text-anchor="middle" x="540" y="-7798.93" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="540" y="-7783.93" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="540" y="-7768.93" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- layer_out_9&#45;&gt;residual1_10 -->
<g id="edge162" class="edge">
<title>layer_out_9&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M635.93,-8302.1C697.34,-8280.97 768,-8242.1 768,-8175.13 768,-8175.13 768,-8175.13 768,-7903.13 768,-7861.2 736.83,-7834.62 697.53,-7817.78"/>
<polygon fill="black" stroke="black" points="698.52,-7814.4 687.94,-7813.91 695.9,-7820.89 698.52,-7814.4"/>
</g>
<!-- mha_q_10 -->
<g id="node120" class="node">
<title>mha_q_10</title>
<polygon fill="lightcoral" stroke="black" points="265.5,-8110.63 46.5,-8110.63 46.5,-8057.63 265.5,-8057.63 265.5,-8110.63"/>
<text text-anchor="middle" x="156" y="-8095.43" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="156" y="-8080.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="156" y="-8065.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_q_10 -->
<g id="edge155" class="edge">
<title>ln1_10&#45;&gt;mha_q_10</title>
<path fill="none" stroke="black" d="M391.1,-8150.81C350.44,-8139.45 300.56,-8125.51 257.23,-8113.41"/>
<polygon fill="black" stroke="black" points="258.09,-8110.01 247.52,-8110.69 256.21,-8116.76 258.09,-8110.01"/>
</g>
<!-- mha_k_10 -->
<g id="node121" class="node">
<title>mha_k_10</title>
<polygon fill="lightcoral" stroke="black" points="502.5,-8110.63 283.5,-8110.63 283.5,-8057.63 502.5,-8057.63 502.5,-8110.63"/>
<text text-anchor="middle" x="393" y="-8095.43" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="393" y="-8080.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="393" y="-8065.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_k_10 -->
<g id="edge156" class="edge">
<title>ln1_10&#45;&gt;mha_k_10</title>
<path fill="none" stroke="black" d="M448.02,-8147.2C440.09,-8138.25 431.08,-8128.09 422.69,-8118.62"/>
<polygon fill="black" stroke="black" points="425.07,-8116.03 415.82,-8110.87 419.83,-8120.67 425.07,-8116.03"/>
</g>
<!-- mha_v_10 -->
<g id="node122" class="node">
<title>mha_v_10</title>
<polygon fill="lightcoral" stroke="black" points="739.5,-8110.63 520.5,-8110.63 520.5,-8057.63 739.5,-8057.63 739.5,-8110.63"/>
<text text-anchor="middle" x="630" y="-8095.43" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="630" y="-8080.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="630" y="-8065.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln1_10&#45;&gt;mha_v_10 -->
<g id="edge157" class="edge">
<title>ln1_10&#45;&gt;mha_v_10</title>
<path fill="none" stroke="black" d="M517.42,-8147.44C535.46,-8137.45 556.27,-8125.93 575.05,-8115.54"/>
<polygon fill="black" stroke="black" points="576.75,-8118.6 583.8,-8110.7 573.36,-8112.48 576.75,-8118.6"/>
</g>
<!-- mha_attn_10 -->
<g id="node123" class="node">
<title>mha_attn_10</title>
<polygon fill="lightcoral" stroke="black" points="482.5,-8020.63 311.5,-8020.63 311.5,-7967.63 482.5,-7967.63 482.5,-8020.63"/>
<text text-anchor="middle" x="397" y="-8005.43" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="397" y="-7990.43" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="397" y="-7975.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- mha_q_10&#45;&gt;mha_attn_10 -->
<g id="edge158" class="edge">
<title>mha_q_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M226.03,-8057.56C254.62,-8047.11 287.84,-8034.98 317.35,-8024.21"/>
<polygon fill="black" stroke="black" points="318.6,-8027.48 326.79,-8020.76 316.2,-8020.9 318.6,-8027.48"/>
</g>
<!-- mha_k_10&#45;&gt;mha_attn_10 -->
<g id="edge159" class="edge">
<title>mha_k_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M394.18,-8057.2C394.55,-8048.96 394.97,-8039.71 395.37,-8030.9"/>
<polygon fill="black" stroke="black" points="398.87,-8031.02 395.83,-8020.87 391.88,-8030.7 398.87,-8031.02"/>
</g>
<!-- mha_v_10&#45;&gt;mha_attn_10 -->
<g id="edge160" class="edge">
<title>mha_v_10&#45;&gt;mha_attn_10</title>
<path fill="none" stroke="black" d="M562.29,-8057.56C534.77,-8047.16 502.81,-8035.09 474.37,-8024.35"/>
<polygon fill="black" stroke="black" points="475.47,-8021.02 464.88,-8020.76 472.99,-8027.57 475.47,-8021.02"/>
</g>
<!-- mha_out_10 -->
<g id="node124" class="node">
<title>mha_out_10</title>
<polygon fill="lightcoral" stroke="black" points="536.5,-7930.63 377.5,-7930.63 377.5,-7877.63 536.5,-7877.63 536.5,-7930.63"/>
<text text-anchor="middle" x="457" y="-7915.43" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="457" y="-7900.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="457" y="-7885.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- mha_attn_10&#45;&gt;mha_out_10 -->
<g id="edge161" class="edge">
<title>mha_attn_10&#45;&gt;mha_out_10</title>
<path fill="none" stroke="black" d="M414.68,-7967.2C420.66,-7958.43 427.43,-7948.49 433.78,-7939.19"/>
<polygon fill="black" stroke="black" points="436.71,-7941.1 439.45,-7930.87 430.92,-7937.16 436.71,-7941.1"/>
</g>
<!-- mha_out_10&#45;&gt;residual1_10 -->
<g id="edge163" class="edge">
<title>mha_out_10&#45;&gt;residual1_10</title>
<path fill="none" stroke="black" d="M475.63,-7877.43C481.75,-7868.98 488.84,-7859.2 496.03,-7849.28"/>
<polygon fill="black" stroke="black" points="499.04,-7851.1 502.07,-7840.95 493.37,-7846.99 499.04,-7851.1"/>
</g>
<!-- ln2_10 -->
<g id="node126" class="node">
<title>ln2_10</title>
<polygon fill="lightyellow" stroke="black" points="530.5,-7697.63 371.5,-7697.63 371.5,-7644.63 530.5,-7644.63 530.5,-7697.63"/>
<text text-anchor="middle" x="451" y="-7682.43" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="451" y="-7667.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="451" y="-7652.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual1_10&#45;&gt;ln2_10 -->
<g id="edge164" class="edge">
<title>residual1_10&#45;&gt;ln2_10</title>
<path fill="none" stroke="black" d="M499.41,-7734.4C491.82,-7724.65 484.09,-7714.7 477.09,-7705.7"/>
<polygon fill="black" stroke="black" points="479.8,-7703.48 470.9,-7697.73 474.27,-7707.77 479.8,-7703.48"/>
</g>
<!-- residual2_10 -->
<g id="node130" class="node">
<title>residual2_10</title>
<polygon fill="lightpink" stroke="black" points="673.69,-7337.63 411.71,-7337.63 344.31,-7231.63 606.29,-7231.63 673.69,-7337.63"/>
<text text-anchor="middle" x="509" y="-7295.93" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="509" y="-7280.93" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="509" y="-7265.93" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual1_10&#45;&gt;residual2_10 -->
<g id="edge168" class="edge">
<title>residual1_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M554.96,-7734.63C559.35,-7715.19 563,-7692.81 563,-7672.13 563,-7672.13 563,-7672.13 563,-7400.13 563,-7381.86 557.31,-7363.39 549.62,-7346.77"/>
<polygon fill="black" stroke="black" points="552.73,-7345.16 545.17,-7337.73 546.45,-7348.25 552.73,-7345.16"/>
</g>
<!-- ffn_up_10 -->
<g id="node127" class="node">
<title>ffn_up_10</title>
<polygon fill="lightblue" stroke="black" points="544,-7607.63 328,-7607.63 328,-7554.63 544,-7554.63 544,-7607.63"/>
<text text-anchor="middle" x="436" y="-7592.43" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="436" y="-7577.43" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="436" y="-7562.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ln2_10&#45;&gt;ffn_up_10 -->
<g id="edge165" class="edge">
<title>ln2_10&#45;&gt;ffn_up_10</title>
<path fill="none" stroke="black" d="M446.58,-7644.2C445.18,-7635.96 443.6,-7626.71 442.1,-7617.9"/>
<polygon fill="black" stroke="black" points="445.52,-7617.14 440.39,-7607.87 438.62,-7618.31 445.52,-7617.14"/>
</g>
<!-- ffn_act_10 -->
<g id="node128" class="node">
<title>ffn_act_10</title>
<polygon fill="lightgreen" stroke="black" points="520,-7517.63 352,-7517.63 352,-7464.63 520,-7464.63 520,-7517.63"/>
<text text-anchor="middle" x="436" y="-7502.43" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="436" y="-7487.43" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="436" y="-7472.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ffn_up_10&#45;&gt;ffn_act_10 -->
<g id="edge166" class="edge">
<title>ffn_up_10&#45;&gt;ffn_act_10</title>
<path fill="none" stroke="black" d="M436,-7554.2C436,-7545.96 436,-7536.71 436,-7527.9"/>
<polygon fill="black" stroke="black" points="439.5,-7527.87 436,-7517.87 432.5,-7527.87 439.5,-7527.87"/>
</g>
<!-- ffn_down_10 -->
<g id="node129" class="node">
<title>ffn_down_10</title>
<polygon fill="lightblue" stroke="black" points="544,-7427.63 328,-7427.63 328,-7374.63 544,-7374.63 544,-7427.63"/>
<text text-anchor="middle" x="436" y="-7412.43" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="436" y="-7397.43" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="436" y="-7382.43" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- ffn_act_10&#45;&gt;ffn_down_10 -->
<g id="edge167" class="edge">
<title>ffn_act_10&#45;&gt;ffn_down_10</title>
<path fill="none" stroke="black" d="M436,-7464.2C436,-7455.96 436,-7446.71 436,-7437.9"/>
<polygon fill="black" stroke="black" points="439.5,-7437.87 436,-7427.87 432.5,-7437.87 439.5,-7437.87"/>
</g>
<!-- ffn_down_10&#45;&gt;residual2_10 -->
<g id="edge169" class="edge">
<title>ffn_down_10&#45;&gt;residual2_10</title>
<path fill="none" stroke="black" d="M452.38,-7374.43C457.71,-7366.07 463.88,-7356.4 470.14,-7346.58"/>
<polygon fill="black" stroke="black" points="473.22,-7348.26 475.64,-7337.95 467.32,-7344.5 473.22,-7348.26"/>
</g>
<!-- layer_out_10 -->
<g id="node131" class="node">
<title>layer_out_10</title>
<ellipse fill="lightgray" stroke="black" cx="509" cy="-7157.15" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="509" y="-7168.45" font-family="Times,serif" font-size="14.00">Layer10_Output</text>
<text text-anchor="middle" x="509" y="-7153.45" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="509" y="-7138.45" font-family="Times,serif" font-size="14.00">GPU&#45;9</text>
</g>
<!-- residual2_10&#45;&gt;layer_out_10 -->
<g id="edge170" class="edge">
<title>residual2_10&#45;&gt;layer_out_10</title>
<path fill="none" stroke="black" d="M509,-7231.5C509,-7222.6 509,-7213.4 509,-7204.65"/>
<polygon fill="black" stroke="black" points="512.5,-7204.64 509,-7194.64 505.5,-7204.64 512.5,-7204.64"/>
</g>
<!-- ln1_11 -->
<g id="node132" class="node">
<title>ln1_11</title>
<polygon fill="lightyellow" stroke="black" points="531.5,-7032.67 372.5,-7032.67 372.5,-6979.67 531.5,-6979.67 531.5,-7032.67"/>
<text text-anchor="middle" x="452" y="-7017.47" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="452" y="-7002.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="452" y="-6987.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- layer_out_10&#45;&gt;ln1_11 -->
<g id="edge171" class="edge">
<title>layer_out_10&#45;&gt;ln1_11</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M495.06,-7119.71C486.06,-7096.19 474.41,-7065.76 465.51,-7042.47"/>
<polygon fill="red" stroke="red" points="468.71,-7041.06 461.87,-7032.97 462.17,-7043.56 468.71,-7041.06"/>
<text text-anchor="middle" x="559.5" y="-7090.47" font-family="Times,serif" font-size="14.00">GPU&#45;9→GPU&#45;10</text>
<text text-anchor="middle" x="559.5" y="-7075.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_11 -->
<g id="node138" class="node">
<title>residual1_11</title>
<polygon fill="lightpink" stroke="black" points="627.69,-6672.67 365.71,-6672.67 298.31,-6566.67 560.29,-6566.67 627.69,-6672.67"/>
<text text-anchor="middle" x="463" y="-6630.97" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="463" y="-6615.97" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="463" y="-6600.97" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- layer_out_10&#45;&gt;residual1_11 -->
<g id="edge179" class="edge">
<title>layer_out_10&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M600.49,-7135.31C664.28,-7114.74 738,-7076.06 738,-7007.17 738,-7007.17 738,-7007.17 738,-6735.17 738,-6671.96 675.31,-6643.01 609.8,-6630.01"/>
<polygon fill="black" stroke="black" points="610.17,-6626.52 599.69,-6628.14 608.89,-6633.4 610.17,-6626.52"/>
</g>
<!-- mha_q_11 -->
<g id="node133" class="node">
<title>mha_q_11</title>
<polygon fill="lightcoral" stroke="black" points="235.5,-6942.67 16.5,-6942.67 16.5,-6889.67 235.5,-6889.67 235.5,-6942.67"/>
<text text-anchor="middle" x="126" y="-6927.47" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="126" y="-6912.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="126" y="-6897.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_q_11 -->
<g id="edge172" class="edge">
<title>ln1_11&#45;&gt;mha_q_11</title>
<path fill="none" stroke="black" d="M372.25,-6983.65C329.49,-6972.1 276.27,-6957.74 230.27,-6945.32"/>
<polygon fill="black" stroke="black" points="231.13,-6941.93 220.56,-6942.7 229.31,-6948.69 231.13,-6941.93"/>
</g>
<!-- mha_k_11 -->
<g id="node134" class="node">
<title>mha_k_11</title>
<polygon fill="lightcoral" stroke="black" points="472.5,-6942.67 253.5,-6942.67 253.5,-6889.67 472.5,-6889.67 472.5,-6942.67"/>
<text text-anchor="middle" x="363" y="-6927.47" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="363" y="-6912.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="363" y="-6897.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_k_11 -->
<g id="edge173" class="edge">
<title>ln1_11&#45;&gt;mha_k_11</title>
<path fill="none" stroke="black" d="M425.78,-6979.25C416.54,-6970.12 406.04,-6959.73 396.3,-6950.1"/>
<polygon fill="black" stroke="black" points="398.61,-6947.46 389.03,-6942.91 393.68,-6952.43 398.61,-6947.46"/>
</g>
<!-- mha_v_11 -->
<g id="node135" class="node">
<title>mha_v_11</title>
<polygon fill="lightcoral" stroke="black" points="709.5,-6942.67 490.5,-6942.67 490.5,-6889.67 709.5,-6889.67 709.5,-6942.67"/>
<text text-anchor="middle" x="600" y="-6927.47" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="600" y="-6912.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="600" y="-6897.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln1_11&#45;&gt;mha_v_11 -->
<g id="edge174" class="edge">
<title>ln1_11&#45;&gt;mha_v_11</title>
<path fill="none" stroke="black" d="M495.21,-6979.48C511.77,-6969.63 530.84,-6958.29 548.14,-6948.01"/>
<polygon fill="black" stroke="black" points="550.19,-6950.86 557,-6942.74 546.61,-6944.85 550.19,-6950.86"/>
</g>
<!-- mha_attn_11 -->
<g id="node136" class="node">
<title>mha_attn_11</title>
<polygon fill="lightcoral" stroke="black" points="456.5,-6852.67 285.5,-6852.67 285.5,-6799.67 456.5,-6799.67 456.5,-6852.67"/>
<text text-anchor="middle" x="371" y="-6837.47" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="371" y="-6822.47" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="371" y="-6807.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- mha_q_11&#45;&gt;mha_attn_11 -->
<g id="edge175" class="edge">
<title>mha_q_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M197.19,-6889.6C226.26,-6879.16 260.03,-6867.03 290.03,-6856.26"/>
<polygon fill="black" stroke="black" points="291.4,-6859.48 299.63,-6852.81 289.03,-6852.89 291.4,-6859.48"/>
</g>
<!-- mha_k_11&#45;&gt;mha_attn_11 -->
<g id="edge176" class="edge">
<title>mha_k_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M365.36,-6889.25C366.11,-6881.01 366.95,-6871.75 367.75,-6862.95"/>
<polygon fill="black" stroke="black" points="371.24,-6863.19 368.66,-6852.91 364.27,-6862.56 371.24,-6863.19"/>
</g>
<!-- mha_v_11&#45;&gt;mha_attn_11 -->
<g id="edge177" class="edge">
<title>mha_v_11&#45;&gt;mha_attn_11</title>
<path fill="none" stroke="black" d="M533.46,-6889.6C506.41,-6879.21 475,-6867.14 447.04,-6856.4"/>
<polygon fill="black" stroke="black" points="448.3,-6853.13 437.71,-6852.81 445.79,-6859.66 448.3,-6853.13"/>
</g>
<!-- mha_out_11 -->
<g id="node137" class="node">
<title>mha_out_11</title>
<polygon fill="lightcoral" stroke="black" points="500.5,-6762.67 341.5,-6762.67 341.5,-6709.67 500.5,-6709.67 500.5,-6762.67"/>
<text text-anchor="middle" x="421" y="-6747.47" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="421" y="-6732.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="421" y="-6717.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- mha_attn_11&#45;&gt;mha_out_11 -->
<g id="edge178" class="edge">
<title>mha_attn_11&#45;&gt;mha_out_11</title>
<path fill="none" stroke="black" d="M385.73,-6799.25C390.61,-6790.65 396.13,-6780.95 401.32,-6771.81"/>
<polygon fill="black" stroke="black" points="404.48,-6773.34 406.37,-6762.91 398.39,-6769.88 404.48,-6773.34"/>
</g>
<!-- mha_out_11&#45;&gt;residual1_11 -->
<g id="edge180" class="edge">
<title>mha_out_11&#45;&gt;residual1_11</title>
<path fill="none" stroke="black" d="M430.43,-6709.48C433.4,-6701.37 436.83,-6692.03 440.31,-6682.52"/>
<polygon fill="black" stroke="black" points="443.65,-6683.59 443.81,-6672.99 437.08,-6681.18 443.65,-6683.59"/>
</g>
<!-- ln2_11 -->
<g id="node139" class="node">
<title>ln2_11</title>
<polygon fill="lightyellow" stroke="black" points="460.5,-6529.67 301.5,-6529.67 301.5,-6476.67 460.5,-6476.67 460.5,-6529.67"/>
<text text-anchor="middle" x="381" y="-6514.47" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="381" y="-6499.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="381" y="-6484.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual1_11&#45;&gt;ln2_11 -->
<g id="edge181" class="edge">
<title>residual1_11&#45;&gt;ln2_11</title>
<path fill="none" stroke="black" d="M425.6,-6566.45C418.69,-6556.79 411.63,-6546.95 405.24,-6538.02"/>
<polygon fill="black" stroke="black" points="408,-6535.87 399.34,-6529.78 402.31,-6539.94 408,-6535.87"/>
</g>
<!-- residual2_11 -->
<g id="node143" class="node">
<title>residual2_11</title>
<polygon fill="lightpink" stroke="black" points="603.69,-6169.67 341.71,-6169.67 274.31,-6063.67 536.29,-6063.67 603.69,-6169.67"/>
<text text-anchor="middle" x="439" y="-6127.97" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="439" y="-6112.97" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="439" y="-6097.97" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual1_11&#45;&gt;residual2_11 -->
<g id="edge185" class="edge">
<title>residual1_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M482.68,-6566.4C488.33,-6547.13 493,-6524.93 493,-6504.17 493,-6504.17 493,-6504.17 493,-6232.17 493,-6213.91 487.31,-6195.43 479.62,-6178.81"/>
<polygon fill="black" stroke="black" points="482.73,-6177.2 475.17,-6169.78 476.45,-6180.3 482.73,-6177.2"/>
</g>
<!-- ffn_up_11 -->
<g id="node140" class="node">
<title>ffn_up_11</title>
<polygon fill="lightblue" stroke="black" points="474,-6439.67 258,-6439.67 258,-6386.67 474,-6386.67 474,-6439.67"/>
<text text-anchor="middle" x="366" y="-6424.47" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="366" y="-6409.47" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="366" y="-6394.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ln2_11&#45;&gt;ffn_up_11 -->
<g id="edge182" class="edge">
<title>ln2_11&#45;&gt;ffn_up_11</title>
<path fill="none" stroke="black" d="M376.58,-6476.25C375.18,-6468.01 373.6,-6458.75 372.1,-6449.95"/>
<polygon fill="black" stroke="black" points="375.52,-6449.18 370.39,-6439.91 368.62,-6450.36 375.52,-6449.18"/>
</g>
<!-- ffn_act_11 -->
<g id="node141" class="node">
<title>ffn_act_11</title>
<polygon fill="lightgreen" stroke="black" points="450,-6349.67 282,-6349.67 282,-6296.67 450,-6296.67 450,-6349.67"/>
<text text-anchor="middle" x="366" y="-6334.47" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="366" y="-6319.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="366" y="-6304.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ffn_up_11&#45;&gt;ffn_act_11 -->
<g id="edge183" class="edge">
<title>ffn_up_11&#45;&gt;ffn_act_11</title>
<path fill="none" stroke="black" d="M366,-6386.25C366,-6378.01 366,-6368.75 366,-6359.95"/>
<polygon fill="black" stroke="black" points="369.5,-6359.91 366,-6349.91 362.5,-6359.91 369.5,-6359.91"/>
</g>
<!-- ffn_down_11 -->
<g id="node142" class="node">
<title>ffn_down_11</title>
<polygon fill="lightblue" stroke="black" points="474,-6259.67 258,-6259.67 258,-6206.67 474,-6206.67 474,-6259.67"/>
<text text-anchor="middle" x="366" y="-6244.47" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="366" y="-6229.47" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="366" y="-6214.47" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- ffn_act_11&#45;&gt;ffn_down_11 -->
<g id="edge184" class="edge">
<title>ffn_act_11&#45;&gt;ffn_down_11</title>
<path fill="none" stroke="black" d="M366,-6296.25C366,-6288.01 366,-6278.75 366,-6269.95"/>
<polygon fill="black" stroke="black" points="369.5,-6269.91 366,-6259.91 362.5,-6269.91 369.5,-6269.91"/>
</g>
<!-- ffn_down_11&#45;&gt;residual2_11 -->
<g id="edge186" class="edge">
<title>ffn_down_11&#45;&gt;residual2_11</title>
<path fill="none" stroke="black" d="M382.38,-6206.48C387.71,-6198.11 393.88,-6188.44 400.14,-6178.63"/>
<polygon fill="black" stroke="black" points="403.22,-6180.31 405.64,-6169.99 397.32,-6176.54 403.22,-6180.31"/>
</g>
<!-- layer_out_11 -->
<g id="node144" class="node">
<title>layer_out_11</title>
<ellipse fill="lightgray" stroke="black" cx="439" cy="-5989.2" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="439" y="-6000.5" font-family="Times,serif" font-size="14.00">Layer11_Output</text>
<text text-anchor="middle" x="439" y="-5985.5" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="439" y="-5970.5" font-family="Times,serif" font-size="14.00">GPU&#45;10</text>
</g>
<!-- residual2_11&#45;&gt;layer_out_11 -->
<g id="edge187" class="edge">
<title>residual2_11&#45;&gt;layer_out_11</title>
<path fill="none" stroke="black" d="M439,-6063.55C439,-6054.65 439,-6045.45 439,-6036.7"/>
<polygon fill="black" stroke="black" points="442.5,-6036.68 439,-6026.68 435.5,-6036.68 442.5,-6036.68"/>
</g>
<!-- ln1_12 -->
<g id="node145" class="node">
<title>ln1_12</title>
<polygon fill="lightyellow" stroke="black" points="478.5,-5864.72 319.5,-5864.72 319.5,-5811.72 478.5,-5811.72 478.5,-5864.72"/>
<text text-anchor="middle" x="399" y="-5849.52" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="399" y="-5834.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="399" y="-5819.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- layer_out_11&#45;&gt;ln1_12 -->
<g id="edge188" class="edge">
<title>layer_out_11&#45;&gt;ln1_12</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M429.21,-5951.75C422.93,-5928.34 414.8,-5898.08 408.56,-5874.83"/>
<polygon fill="red" stroke="red" points="411.9,-5873.77 405.93,-5865.02 405.14,-5875.58 411.9,-5873.77"/>
<text text-anchor="middle" x="495.5" y="-5922.52" font-family="Times,serif" font-size="14.00">GPU&#45;10→GPU&#45;11</text>
<text text-anchor="middle" x="495.5" y="-5907.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_12 -->
<g id="node151" class="node">
<title>residual1_12</title>
<polygon fill="lightpink" stroke="black" points="656.69,-5504.72 394.71,-5504.72 327.31,-5398.72 589.29,-5398.72 656.69,-5504.72"/>
<text text-anchor="middle" x="492" y="-5463.02" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="492" y="-5448.02" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="492" y="-5433.02" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- layer_out_11&#45;&gt;residual1_12 -->
<g id="edge196" class="edge">
<title>layer_out_11&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M550.01,-5983.04C646.53,-5971.86 771,-5938.25 771,-5839.22 771,-5839.22 771,-5839.22 771,-5567.22 771,-5502.22 705.39,-5473.34 637.8,-5460.83"/>
<polygon fill="black" stroke="black" points="638.27,-5457.35 627.82,-5459.1 637.08,-5464.25 638.27,-5457.35"/>
</g>
<!-- mha_q_12 -->
<g id="node146" class="node">
<title>mha_q_12</title>
<polygon fill="lightcoral" stroke="black" points="268.5,-5774.72 49.5,-5774.72 49.5,-5721.72 268.5,-5721.72 268.5,-5774.72"/>
<text text-anchor="middle" x="159" y="-5759.52" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="159" y="-5744.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="159" y="-5729.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_q_12 -->
<g id="edge189" class="edge">
<title>ln1_12&#45;&gt;mha_q_12</title>
<path fill="none" stroke="black" d="M329.26,-5811.65C300.79,-5801.21 267.7,-5789.08 238.32,-5778.3"/>
<polygon fill="black" stroke="black" points="239.51,-5775.01 228.91,-5774.86 237.1,-5781.58 239.51,-5775.01"/>
</g>
<!-- mha_k_12 -->
<g id="node147" class="node">
<title>mha_k_12</title>
<polygon fill="lightcoral" stroke="black" points="505.5,-5774.72 286.5,-5774.72 286.5,-5721.72 505.5,-5721.72 505.5,-5774.72"/>
<text text-anchor="middle" x="396" y="-5759.52" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="396" y="-5744.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="396" y="-5729.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_k_12 -->
<g id="edge190" class="edge">
<title>ln1_12&#45;&gt;mha_k_12</title>
<path fill="none" stroke="black" d="M398.12,-5811.29C397.84,-5803.06 397.52,-5793.8 397.22,-5785"/>
<polygon fill="black" stroke="black" points="400.72,-5784.84 396.88,-5774.96 393.72,-5785.08 400.72,-5784.84"/>
</g>
<!-- mha_v_12 -->
<g id="node148" class="node">
<title>mha_v_12</title>
<polygon fill="lightcoral" stroke="black" points="742.5,-5774.72 523.5,-5774.72 523.5,-5721.72 742.5,-5721.72 742.5,-5774.72"/>
<text text-anchor="middle" x="633" y="-5759.52" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="633" y="-5744.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="633" y="-5729.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln1_12&#45;&gt;mha_v_12 -->
<g id="edge191" class="edge">
<title>ln1_12&#45;&gt;mha_v_12</title>
<path fill="none" stroke="black" d="M467,-5811.65C494.64,-5801.25 526.73,-5789.18 555.29,-5778.44"/>
<polygon fill="black" stroke="black" points="556.71,-5781.65 564.83,-5774.86 554.24,-5775.1 556.71,-5781.65"/>
</g>
<!-- mha_attn_12 -->
<g id="node149" class="node">
<title>mha_attn_12</title>
<polygon fill="lightcoral" stroke="black" points="492.5,-5684.72 321.5,-5684.72 321.5,-5631.72 492.5,-5631.72 492.5,-5684.72"/>
<text text-anchor="middle" x="407" y="-5669.52" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="407" y="-5654.52" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="407" y="-5639.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- mha_q_12&#45;&gt;mha_attn_12 -->
<g id="edge192" class="edge">
<title>mha_q_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M231.07,-5721.65C260.49,-5711.21 294.67,-5699.08 325.04,-5688.3"/>
<polygon fill="black" stroke="black" points="326.5,-5691.5 334.76,-5684.86 324.16,-5684.9 326.5,-5691.5"/>
</g>
<!-- mha_k_12&#45;&gt;mha_attn_12 -->
<g id="edge193" class="edge">
<title>mha_k_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M399.24,-5721.29C400.27,-5713.06 401.43,-5703.8 402.53,-5695"/>
<polygon fill="black" stroke="black" points="406.01,-5695.32 403.78,-5684.96 399.07,-5694.45 406.01,-5695.32"/>
</g>
<!-- mha_v_12&#45;&gt;mha_attn_12 -->
<g id="edge194" class="edge">
<title>mha_v_12&#45;&gt;mha_attn_12</title>
<path fill="none" stroke="black" d="M567.33,-5721.65C540.75,-5711.3 509.9,-5699.29 482.41,-5688.58"/>
<polygon fill="black" stroke="black" points="483.42,-5685.22 472.84,-5684.86 480.88,-5691.75 483.42,-5685.22"/>
</g>
<!-- mha_out_12 -->
<g id="node150" class="node">
<title>mha_out_12</title>
<polygon fill="lightcoral" stroke="black" points="537.5,-5594.72 378.5,-5594.72 378.5,-5541.72 537.5,-5541.72 537.5,-5594.72"/>
<text text-anchor="middle" x="458" y="-5579.52" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="458" y="-5564.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="458" y="-5549.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- mha_attn_12&#45;&gt;mha_out_12 -->
<g id="edge195" class="edge">
<title>mha_attn_12&#45;&gt;mha_out_12</title>
<path fill="none" stroke="black" d="M422.03,-5631.29C427.01,-5622.7 432.63,-5612.99 437.93,-5603.85"/>
<polygon fill="black" stroke="black" points="441.1,-5605.37 443.08,-5594.96 435.04,-5601.86 441.1,-5605.37"/>
</g>
<!-- mha_out_12&#45;&gt;residual1_12 -->
<g id="edge197" class="edge">
<title>mha_out_12&#45;&gt;residual1_12</title>
<path fill="none" stroke="black" d="M465.63,-5541.52C468.01,-5533.5 470.75,-5524.27 473.55,-5514.86"/>
<polygon fill="black" stroke="black" points="476.97,-5515.62 476.46,-5505.04 470.26,-5513.63 476.97,-5515.62"/>
</g>
<!-- ln2_12 -->
<g id="node152" class="node">
<title>ln2_12</title>
<polygon fill="lightyellow" stroke="black" points="485.5,-5361.72 326.5,-5361.72 326.5,-5308.72 485.5,-5308.72 485.5,-5361.72"/>
<text text-anchor="middle" x="406" y="-5346.52" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="406" y="-5331.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="406" y="-5316.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual1_12&#45;&gt;ln2_12 -->
<g id="edge198" class="edge">
<title>residual1_12&#45;&gt;ln2_12</title>
<path fill="none" stroke="black" d="M452.77,-5398.5C445.52,-5388.84 438.13,-5378.99 431.42,-5370.07"/>
<polygon fill="black" stroke="black" points="434.03,-5367.72 425.23,-5361.82 428.44,-5371.92 434.03,-5367.72"/>
</g>
<!-- residual2_12 -->
<g id="node156" class="node">
<title>residual2_12</title>
<polygon fill="lightpink" stroke="black" points="627.69,-5001.72 365.71,-5001.72 298.31,-4895.72 560.29,-4895.72 627.69,-5001.72"/>
<text text-anchor="middle" x="463" y="-4960.02" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="463" y="-4945.02" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="463" y="-4930.02" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual1_12&#45;&gt;residual2_12 -->
<g id="edge202" class="edge">
<title>residual1_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M508.98,-5398.55C513.91,-5379.19 518,-5356.91 518,-5336.22 518,-5336.22 518,-5336.22 518,-5064.22 518,-5045.89 512.2,-5027.4 504.37,-5010.77"/>
<polygon fill="black" stroke="black" points="507.45,-5009.11 499.84,-5001.74 501.2,-5012.25 507.45,-5009.11"/>
</g>
<!-- ffn_up_12 -->
<g id="node153" class="node">
<title>ffn_up_12</title>
<polygon fill="lightblue" stroke="black" points="499,-5271.72 283,-5271.72 283,-5218.72 499,-5218.72 499,-5271.72"/>
<text text-anchor="middle" x="391" y="-5256.52" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="391" y="-5241.52" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="391" y="-5226.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ln2_12&#45;&gt;ffn_up_12 -->
<g id="edge199" class="edge">
<title>ln2_12&#45;&gt;ffn_up_12</title>
<path fill="none" stroke="black" d="M401.58,-5308.29C400.18,-5300.06 398.6,-5290.8 397.1,-5282"/>
<polygon fill="black" stroke="black" points="400.52,-5281.23 395.39,-5271.96 393.62,-5282.41 400.52,-5281.23"/>
</g>
<!-- ffn_act_12 -->
<g id="node154" class="node">
<title>ffn_act_12</title>
<polygon fill="lightgreen" stroke="black" points="475,-5181.72 307,-5181.72 307,-5128.72 475,-5128.72 475,-5181.72"/>
<text text-anchor="middle" x="391" y="-5166.52" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="391" y="-5151.52" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="391" y="-5136.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ffn_up_12&#45;&gt;ffn_act_12 -->
<g id="edge200" class="edge">
<title>ffn_up_12&#45;&gt;ffn_act_12</title>
<path fill="none" stroke="black" d="M391,-5218.29C391,-5210.06 391,-5200.8 391,-5192"/>
<polygon fill="black" stroke="black" points="394.5,-5191.96 391,-5181.96 387.5,-5191.96 394.5,-5191.96"/>
</g>
<!-- ffn_down_12 -->
<g id="node155" class="node">
<title>ffn_down_12</title>
<polygon fill="lightblue" stroke="black" points="499,-5091.72 283,-5091.72 283,-5038.72 499,-5038.72 499,-5091.72"/>
<text text-anchor="middle" x="391" y="-5076.52" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="391" y="-5061.52" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="391" y="-5046.52" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- ffn_act_12&#45;&gt;ffn_down_12 -->
<g id="edge201" class="edge">
<title>ffn_act_12&#45;&gt;ffn_down_12</title>
<path fill="none" stroke="black" d="M391,-5128.29C391,-5120.06 391,-5110.8 391,-5102"/>
<polygon fill="black" stroke="black" points="394.5,-5101.96 391,-5091.96 387.5,-5101.96 394.5,-5101.96"/>
</g>
<!-- ffn_down_12&#45;&gt;residual2_12 -->
<g id="edge203" class="edge">
<title>ffn_down_12&#45;&gt;residual2_12</title>
<path fill="none" stroke="black" d="M407.16,-5038.52C412.42,-5030.16 418.5,-5020.49 424.67,-5010.67"/>
<polygon fill="black" stroke="black" points="427.74,-5012.37 430.1,-5002.04 421.81,-5008.64 427.74,-5012.37"/>
</g>
<!-- layer_out_12 -->
<g id="node157" class="node">
<title>layer_out_12</title>
<ellipse fill="lightgray" stroke="black" cx="463" cy="-4821.24" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="463" y="-4832.54" font-family="Times,serif" font-size="14.00">Layer12_Output</text>
<text text-anchor="middle" x="463" y="-4817.54" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="463" y="-4802.54" font-family="Times,serif" font-size="14.00">GPU&#45;11</text>
</g>
<!-- residual2_12&#45;&gt;layer_out_12 -->
<g id="edge204" class="edge">
<title>residual2_12&#45;&gt;layer_out_12</title>
<path fill="none" stroke="black" d="M463,-4895.6C463,-4886.69 463,-4877.49 463,-4868.75"/>
<polygon fill="black" stroke="black" points="466.5,-4868.73 463,-4858.73 459.5,-4868.73 466.5,-4868.73"/>
</g>
<!-- ln1_13 -->
<g id="node158" class="node">
<title>ln1_13</title>
<polygon fill="lightyellow" stroke="black" points="486.5,-4696.77 327.5,-4696.77 327.5,-4643.77 486.5,-4643.77 486.5,-4696.77"/>
<text text-anchor="middle" x="407" y="-4681.57" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="407" y="-4666.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="407" y="-4651.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- layer_out_12&#45;&gt;ln1_13 -->
<g id="edge205" class="edge">
<title>layer_out_12&#45;&gt;ln1_13</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M449.3,-4783.8C440.46,-4760.28 429.02,-4729.85 420.27,-4706.56"/>
<polygon fill="red" stroke="red" points="423.49,-4705.19 416.7,-4697.06 416.94,-4707.65 423.49,-4705.19"/>
<text text-anchor="middle" x="513.5" y="-4754.57" font-family="Times,serif" font-size="14.00">GPU&#45;11→GPU&#45;12</text>
<text text-anchor="middle" x="513.5" y="-4739.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_13 -->
<g id="node164" class="node">
<title>residual1_13</title>
<polygon fill="lightpink" stroke="black" points="724.69,-4336.77 462.71,-4336.77 395.31,-4230.77 657.29,-4230.77 724.69,-4336.77"/>
<text text-anchor="middle" x="560" y="-4295.07" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="560" y="-4280.07" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="560" y="-4265.07" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- layer_out_12&#45;&gt;residual1_13 -->
<g id="edge213" class="edge">
<title>layer_out_12&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M569.34,-4808.75C652.1,-4793.21 753,-4756.74 753,-4671.27 753,-4671.27 753,-4671.27 753,-4399.27 753,-4376.67 743.09,-4358.43 727.76,-4343.74"/>
<polygon fill="black" stroke="black" points="729.66,-4340.75 719.82,-4336.81 725.05,-4346.02 729.66,-4340.75"/>
</g>
<!-- mha_q_13 -->
<g id="node159" class="node">
<title>mha_q_13</title>
<polygon fill="lightcoral" stroke="black" points="250.5,-4606.77 31.5,-4606.77 31.5,-4553.77 250.5,-4553.77 250.5,-4606.77"/>
<text text-anchor="middle" x="141" y="-4591.57" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="141" y="-4576.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="141" y="-4561.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_q_13 -->
<g id="edge206" class="edge">
<title>ln1_13&#45;&gt;mha_q_13</title>
<path fill="none" stroke="black" d="M329.7,-4643.7C297.87,-4633.16 260.85,-4620.91 228.06,-4610.07"/>
<polygon fill="black" stroke="black" points="229.08,-4606.72 218.49,-4606.9 226.88,-4613.37 229.08,-4606.72"/>
</g>
<!-- mha_k_13 -->
<g id="node160" class="node">
<title>mha_k_13</title>
<polygon fill="lightcoral" stroke="black" points="487.5,-4606.77 268.5,-4606.77 268.5,-4553.77 487.5,-4553.77 487.5,-4606.77"/>
<text text-anchor="middle" x="378" y="-4591.57" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="378" y="-4576.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="378" y="-4561.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_k_13 -->
<g id="edge207" class="edge">
<title>ln1_13&#45;&gt;mha_k_13</title>
<path fill="none" stroke="black" d="M398.46,-4643.34C395.71,-4635.01 392.62,-4625.65 389.7,-4616.76"/>
<polygon fill="black" stroke="black" points="392.94,-4615.41 386.48,-4607.01 386.29,-4617.6 392.94,-4615.41"/>
</g>
<!-- mha_v_13 -->
<g id="node161" class="node">
<title>mha_v_13</title>
<polygon fill="lightcoral" stroke="black" points="724.5,-4606.77 505.5,-4606.77 505.5,-4553.77 724.5,-4553.77 724.5,-4606.77"/>
<text text-anchor="middle" x="615" y="-4591.57" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="615" y="-4576.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="615" y="-4561.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln1_13&#45;&gt;mha_v_13 -->
<g id="edge208" class="edge">
<title>ln1_13&#45;&gt;mha_v_13</title>
<path fill="none" stroke="black" d="M467.44,-4643.7C491.69,-4633.44 519.8,-4621.54 544.93,-4610.91"/>
<polygon fill="black" stroke="black" points="546.56,-4614.02 554.41,-4606.9 543.83,-4607.57 546.56,-4614.02"/>
</g>
<!-- mha_attn_13 -->
<g id="node162" class="node">
<title>mha_attn_13</title>
<polygon fill="lightcoral" stroke="black" points="480.5,-4516.77 309.5,-4516.77 309.5,-4463.77 480.5,-4463.77 480.5,-4516.77"/>
<text text-anchor="middle" x="395" y="-4501.57" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="395" y="-4486.57" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="395" y="-4471.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- mha_q_13&#45;&gt;mha_attn_13 -->
<g id="edge209" class="edge">
<title>mha_q_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M214.81,-4553.7C245.07,-4543.21 280.26,-4531.02 311.46,-4520.21"/>
<polygon fill="black" stroke="black" points="312.7,-4523.48 321.01,-4516.9 310.41,-4516.87 312.7,-4523.48"/>
</g>
<!-- mha_k_13&#45;&gt;mha_attn_13 -->
<g id="edge210" class="edge">
<title>mha_k_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M383.01,-4553.34C384.6,-4545.1 386.39,-4535.85 388.09,-4527.04"/>
<polygon fill="black" stroke="black" points="391.57,-4527.49 390.03,-4517.01 384.69,-4526.16 391.57,-4527.49"/>
</g>
<!-- mha_v_13&#45;&gt;mha_attn_13 -->
<g id="edge211" class="edge">
<title>mha_v_13&#45;&gt;mha_attn_13</title>
<path fill="none" stroke="black" d="M551.07,-4553.7C525.2,-4543.35 495.17,-4531.33 468.41,-4520.63"/>
<polygon fill="black" stroke="black" points="469.67,-4517.37 459.09,-4516.9 467.07,-4523.87 469.67,-4517.37"/>
</g>
<!-- mha_out_13 -->
<g id="node163" class="node">
<title>mha_out_13</title>
<polygon fill="lightcoral" stroke="black" points="610.5,-4426.77 451.5,-4426.77 451.5,-4373.77 610.5,-4373.77 610.5,-4426.77"/>
<text text-anchor="middle" x="531" y="-4411.57" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="531" y="-4396.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="531" y="-4381.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- mha_attn_13&#45;&gt;mha_out_13 -->
<g id="edge212" class="edge">
<title>mha_attn_13&#45;&gt;mha_out_13</title>
<path fill="none" stroke="black" d="M434.7,-4463.58C449.79,-4453.82 467.13,-4442.6 482.9,-4432.39"/>
<polygon fill="black" stroke="black" points="484.99,-4435.21 491.48,-4426.84 481.19,-4429.33 484.99,-4435.21"/>
</g>
<!-- mha_out_13&#45;&gt;residual1_13 -->
<g id="edge214" class="edge">
<title>mha_out_13&#45;&gt;residual1_13</title>
<path fill="none" stroke="black" d="M537.51,-4373.57C539.54,-4365.55 541.88,-4356.32 544.26,-4346.91"/>
<polygon fill="black" stroke="black" points="547.69,-4347.64 546.75,-4337.09 540.9,-4345.92 547.69,-4347.64"/>
</g>
<!-- ln2_13 -->
<g id="node165" class="node">
<title>ln2_13</title>
<polygon fill="lightyellow" stroke="black" points="544.5,-4193.77 385.5,-4193.77 385.5,-4140.77 544.5,-4140.77 544.5,-4193.77"/>
<text text-anchor="middle" x="465" y="-4178.57" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="465" y="-4163.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="465" y="-4148.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual1_13&#45;&gt;ln2_13 -->
<g id="edge215" class="edge">
<title>residual1_13&#45;&gt;ln2_13</title>
<path fill="none" stroke="black" d="M516.67,-4230.54C508.58,-4220.79 500.32,-4210.84 492.85,-4201.84"/>
<polygon fill="black" stroke="black" points="495.32,-4199.33 486.24,-4193.87 489.93,-4203.8 495.32,-4199.33"/>
</g>
<!-- residual2_13 -->
<g id="node169" class="node">
<title>residual2_13</title>
<polygon fill="lightpink" stroke="black" points="692.69,-3833.77 430.71,-3833.77 363.31,-3727.77 625.29,-3727.77 692.69,-3833.77"/>
<text text-anchor="middle" x="528" y="-3792.07" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="528" y="-3777.07" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="528" y="-3762.07" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual1_13&#45;&gt;residual2_13 -->
<g id="edge219" class="edge">
<title>residual1_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M571.05,-4230.57C574.3,-4211.11 577,-4188.76 577,-4168.27 577,-4168.27 577,-4168.27 577,-3896.27 577,-3878.37 571.88,-3860.08 564.95,-3843.52"/>
<polygon fill="black" stroke="black" points="567.96,-3841.69 560.68,-3833.99 561.57,-3844.54 567.96,-3841.69"/>
</g>
<!-- ffn_up_13 -->
<g id="node166" class="node">
<title>ffn_up_13</title>
<polygon fill="lightblue" stroke="black" points="558,-4103.77 342,-4103.77 342,-4050.77 558,-4050.77 558,-4103.77"/>
<text text-anchor="middle" x="450" y="-4088.57" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="450" y="-4073.57" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="450" y="-4058.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ln2_13&#45;&gt;ffn_up_13 -->
<g id="edge216" class="edge">
<title>ln2_13&#45;&gt;ffn_up_13</title>
<path fill="none" stroke="black" d="M460.58,-4140.34C459.18,-4132.1 457.6,-4122.85 456.1,-4114.04"/>
<polygon fill="black" stroke="black" points="459.52,-4113.28 454.39,-4104.01 452.62,-4114.45 459.52,-4113.28"/>
</g>
<!-- ffn_act_13 -->
<g id="node167" class="node">
<title>ffn_act_13</title>
<polygon fill="lightgreen" stroke="black" points="534,-4013.77 366,-4013.77 366,-3960.77 534,-3960.77 534,-4013.77"/>
<text text-anchor="middle" x="450" y="-3998.57" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="450" y="-3983.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="450" y="-3968.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ffn_up_13&#45;&gt;ffn_act_13 -->
<g id="edge217" class="edge">
<title>ffn_up_13&#45;&gt;ffn_act_13</title>
<path fill="none" stroke="black" d="M450,-4050.34C450,-4042.1 450,-4032.85 450,-4024.04"/>
<polygon fill="black" stroke="black" points="453.5,-4024.01 450,-4014.01 446.5,-4024.01 453.5,-4024.01"/>
</g>
<!-- ffn_down_13 -->
<g id="node168" class="node">
<title>ffn_down_13</title>
<polygon fill="lightblue" stroke="black" points="558,-3923.77 342,-3923.77 342,-3870.77 558,-3870.77 558,-3923.77"/>
<text text-anchor="middle" x="450" y="-3908.57" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="450" y="-3893.57" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="450" y="-3878.57" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- ffn_act_13&#45;&gt;ffn_down_13 -->
<g id="edge218" class="edge">
<title>ffn_act_13&#45;&gt;ffn_down_13</title>
<path fill="none" stroke="black" d="M450,-3960.34C450,-3952.1 450,-3942.85 450,-3934.04"/>
<polygon fill="black" stroke="black" points="453.5,-3934.01 450,-3924.01 446.5,-3934.01 453.5,-3934.01"/>
</g>
<!-- ffn_down_13&#45;&gt;residual2_13 -->
<g id="edge220" class="edge">
<title>ffn_down_13&#45;&gt;residual2_13</title>
<path fill="none" stroke="black" d="M467.5,-3870.57C473.26,-3862.12 479.92,-3852.34 486.68,-3842.42"/>
<polygon fill="black" stroke="black" points="489.62,-3844.32 492.36,-3834.09 483.84,-3840.38 489.62,-3844.32"/>
</g>
<!-- layer_out_13 -->
<g id="node170" class="node">
<title>layer_out_13</title>
<ellipse fill="lightgray" stroke="black" cx="528" cy="-3653.29" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="528" y="-3664.59" font-family="Times,serif" font-size="14.00">Layer13_Output</text>
<text text-anchor="middle" x="528" y="-3649.59" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="528" y="-3634.59" font-family="Times,serif" font-size="14.00">GPU&#45;12</text>
</g>
<!-- residual2_13&#45;&gt;layer_out_13 -->
<g id="edge221" class="edge">
<title>residual2_13&#45;&gt;layer_out_13</title>
<path fill="none" stroke="black" d="M528,-3727.64C528,-3718.74 528,-3709.54 528,-3700.79"/>
<polygon fill="black" stroke="black" points="531.5,-3700.78 528,-3690.78 524.5,-3700.78 531.5,-3700.78"/>
</g>
<!-- ln1_14 -->
<g id="node171" class="node">
<title>ln1_14</title>
<polygon fill="lightyellow" stroke="black" points="532.5,-3528.81 373.5,-3528.81 373.5,-3475.81 532.5,-3475.81 532.5,-3528.81"/>
<text text-anchor="middle" x="453" y="-3513.61" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="453" y="-3498.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="453" y="-3483.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- layer_out_13&#45;&gt;ln1_14 -->
<g id="edge222" class="edge">
<title>layer_out_13&#45;&gt;ln1_14</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M509.84,-3616.23C497.96,-3592.61 482.5,-3561.9 470.7,-3538.47"/>
<polygon fill="red" stroke="red" points="473.68,-3536.6 466.05,-3529.24 467.42,-3539.75 473.68,-3536.6"/>
<text text-anchor="middle" x="571.5" y="-3586.61" font-family="Times,serif" font-size="14.00">GPU&#45;12→GPU&#45;13</text>
<text text-anchor="middle" x="571.5" y="-3571.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_14 -->
<g id="node177" class="node">
<title>residual1_14</title>
<polygon fill="lightpink" stroke="black" points="682.69,-3168.81 420.71,-3168.81 353.31,-3062.81 615.29,-3062.81 682.69,-3168.81"/>
<text text-anchor="middle" x="518" y="-3127.11" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="518" y="-3112.11" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="518" y="-3097.11" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- layer_out_13&#45;&gt;residual1_14 -->
<g id="edge230" class="edge">
<title>layer_out_13&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M620.29,-3631.69C684.64,-3611.25 759,-3572.63 759,-3503.31 759,-3503.31 759,-3503.31 759,-3231.31 759,-3182.89 718.82,-3154.92 671.27,-3138.78"/>
<polygon fill="black" stroke="black" points="672.26,-3135.42 661.67,-3135.7 670.13,-3142.09 672.26,-3135.42"/>
</g>
<!-- mha_q_14 -->
<g id="node172" class="node">
<title>mha_q_14</title>
<polygon fill="lightcoral" stroke="black" points="256.5,-3438.81 37.5,-3438.81 37.5,-3385.81 256.5,-3385.81 256.5,-3438.81"/>
<text text-anchor="middle" x="147" y="-3423.61" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="147" y="-3408.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="147" y="-3393.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_q_14 -->
<g id="edge223" class="edge">
<title>ln1_14&#45;&gt;mha_q_14</title>
<path fill="none" stroke="black" d="M373.4,-3478.42C334.38,-3467.2 287.02,-3453.58 245.72,-3441.7"/>
<polygon fill="black" stroke="black" points="246.49,-3438.28 235.91,-3438.88 244.55,-3445.01 246.49,-3438.28"/>
</g>
<!-- mha_k_14 -->
<g id="node173" class="node">
<title>mha_k_14</title>
<polygon fill="lightcoral" stroke="black" points="493.5,-3438.81 274.5,-3438.81 274.5,-3385.81 493.5,-3385.81 493.5,-3438.81"/>
<text text-anchor="middle" x="384" y="-3423.61" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="384" y="-3408.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="384" y="-3393.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_k_14 -->
<g id="edge224" class="edge">
<title>ln1_14&#45;&gt;mha_k_14</title>
<path fill="none" stroke="black" d="M432.67,-3475.39C425.72,-3466.52 417.85,-3456.48 410.48,-3447.09"/>
<polygon fill="black" stroke="black" points="413.11,-3444.76 404.18,-3439.05 407.6,-3449.08 413.11,-3444.76"/>
</g>
<!-- mha_v_14 -->
<g id="node174" class="node">
<title>mha_v_14</title>
<polygon fill="lightcoral" stroke="black" points="730.5,-3438.81 511.5,-3438.81 511.5,-3385.81 730.5,-3385.81 730.5,-3438.81"/>
<text text-anchor="middle" x="621" y="-3423.61" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="621" y="-3408.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="621" y="-3393.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln1_14&#45;&gt;mha_v_14 -->
<g id="edge225" class="edge">
<title>ln1_14&#45;&gt;mha_v_14</title>
<path fill="none" stroke="black" d="M502.04,-3475.62C521.19,-3465.59 543.29,-3454.02 563.21,-3443.59"/>
<polygon fill="black" stroke="black" points="564.95,-3446.62 572.19,-3438.88 561.7,-3440.42 564.95,-3446.62"/>
</g>
<!-- mha_attn_14 -->
<g id="node175" class="node">
<title>mha_attn_14</title>
<polygon fill="lightcoral" stroke="black" points="475.5,-3348.81 304.5,-3348.81 304.5,-3295.81 475.5,-3295.81 475.5,-3348.81"/>
<text text-anchor="middle" x="390" y="-3333.61" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="390" y="-3318.61" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="390" y="-3303.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- mha_q_14&#45;&gt;mha_attn_14 -->
<g id="edge226" class="edge">
<title>mha_q_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M217.61,-3385.74C246.44,-3375.3 279.94,-3363.17 309.69,-3352.4"/>
<polygon fill="black" stroke="black" points="311,-3355.64 319.21,-3348.95 308.62,-3349.06 311,-3355.64"/>
</g>
<!-- mha_k_14&#45;&gt;mha_attn_14 -->
<g id="edge227" class="edge">
<title>mha_k_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M385.77,-3385.39C386.33,-3377.15 386.96,-3367.89 387.56,-3359.09"/>
<polygon fill="black" stroke="black" points="391.06,-3359.27 388.24,-3349.05 384.07,-3358.79 391.06,-3359.27"/>
</g>
<!-- mha_v_14&#45;&gt;mha_attn_14 -->
<g id="edge228" class="edge">
<title>mha_v_14&#45;&gt;mha_attn_14</title>
<path fill="none" stroke="black" d="M553.87,-3385.74C526.59,-3375.35 494.9,-3363.28 466.71,-3352.54"/>
<polygon fill="black" stroke="black" points="467.88,-3349.24 457.29,-3348.95 465.39,-3355.78 467.88,-3349.24"/>
</g>
<!-- mha_out_14 -->
<g id="node176" class="node">
<title>mha_out_14</title>
<polygon fill="lightcoral" stroke="black" points="532.5,-3258.81 373.5,-3258.81 373.5,-3205.81 532.5,-3205.81 532.5,-3258.81"/>
<text text-anchor="middle" x="453" y="-3243.61" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="453" y="-3228.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="453" y="-3213.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- mha_attn_14&#45;&gt;mha_out_14 -->
<g id="edge229" class="edge">
<title>mha_attn_14&#45;&gt;mha_out_14</title>
<path fill="none" stroke="black" d="M408.56,-3295.39C414.84,-3286.61 421.95,-3276.68 428.62,-3267.37"/>
<polygon fill="black" stroke="black" points="431.6,-3269.22 434.57,-3259.05 425.9,-3265.15 431.6,-3269.22"/>
</g>
<!-- mha_out_14&#45;&gt;residual1_14 -->
<g id="edge231" class="edge">
<title>mha_out_14&#45;&gt;residual1_14</title>
<path fill="none" stroke="black" d="M467.59,-3205.62C472.29,-3197.34 477.71,-3187.78 483.23,-3178.07"/>
<polygon fill="black" stroke="black" points="486.41,-3179.56 488.3,-3169.13 480.32,-3176.1 486.41,-3179.56"/>
</g>
<!-- ln2_14 -->
<g id="node178" class="node">
<title>ln2_14</title>
<polygon fill="lightyellow" stroke="black" points="511.5,-3025.81 352.5,-3025.81 352.5,-2972.81 511.5,-2972.81 511.5,-3025.81"/>
<text text-anchor="middle" x="432" y="-3010.61" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="432" y="-2995.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="432" y="-2980.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual1_14&#45;&gt;ln2_14 -->
<g id="edge232" class="edge">
<title>residual1_14&#45;&gt;ln2_14</title>
<path fill="none" stroke="black" d="M478.77,-3062.59C471.52,-3052.93 464.13,-3043.09 457.42,-3034.16"/>
<polygon fill="black" stroke="black" points="460.03,-3031.81 451.23,-3025.92 454.44,-3036.01 460.03,-3031.81"/>
</g>
<!-- residual2_14 -->
<g id="node182" class="node">
<title>residual2_14</title>
<polygon fill="lightpink" stroke="black" points="658.69,-2665.81 396.71,-2665.81 329.31,-2559.81 591.29,-2559.81 658.69,-2665.81"/>
<text text-anchor="middle" x="494" y="-2624.11" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="494" y="-2609.11" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="494" y="-2594.11" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual1_14&#45;&gt;residual2_14 -->
<g id="edge236" class="edge">
<title>residual1_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M534.98,-3062.65C539.91,-3043.29 544,-3021 544,-3000.31 544,-3000.31 544,-3000.31 544,-2728.31 544,-2710.36 538.77,-2692.05 531.7,-2675.49"/>
<polygon fill="black" stroke="black" points="534.69,-2673.6 527.35,-2665.96 528.32,-2676.51 534.69,-2673.6"/>
</g>
<!-- ffn_up_14 -->
<g id="node179" class="node">
<title>ffn_up_14</title>
<polygon fill="lightblue" stroke="black" points="525,-2935.81 309,-2935.81 309,-2882.81 525,-2882.81 525,-2935.81"/>
<text text-anchor="middle" x="417" y="-2920.61" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="417" y="-2905.61" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="417" y="-2890.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ln2_14&#45;&gt;ffn_up_14 -->
<g id="edge233" class="edge">
<title>ln2_14&#45;&gt;ffn_up_14</title>
<path fill="none" stroke="black" d="M427.58,-2972.39C426.18,-2964.15 424.6,-2954.89 423.1,-2946.09"/>
<polygon fill="black" stroke="black" points="426.52,-2945.32 421.39,-2936.05 419.62,-2946.5 426.52,-2945.32"/>
</g>
<!-- ffn_act_14 -->
<g id="node180" class="node">
<title>ffn_act_14</title>
<polygon fill="lightgreen" stroke="black" points="501,-2845.81 333,-2845.81 333,-2792.81 501,-2792.81 501,-2845.81"/>
<text text-anchor="middle" x="417" y="-2830.61" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="417" y="-2815.61" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="417" y="-2800.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ffn_up_14&#45;&gt;ffn_act_14 -->
<g id="edge234" class="edge">
<title>ffn_up_14&#45;&gt;ffn_act_14</title>
<path fill="none" stroke="black" d="M417,-2882.39C417,-2874.15 417,-2864.89 417,-2856.09"/>
<polygon fill="black" stroke="black" points="420.5,-2856.05 417,-2846.05 413.5,-2856.05 420.5,-2856.05"/>
</g>
<!-- ffn_down_14 -->
<g id="node181" class="node">
<title>ffn_down_14</title>
<polygon fill="lightblue" stroke="black" points="525,-2755.81 309,-2755.81 309,-2702.81 525,-2702.81 525,-2755.81"/>
<text text-anchor="middle" x="417" y="-2740.61" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="417" y="-2725.61" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="417" y="-2710.61" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- ffn_act_14&#45;&gt;ffn_down_14 -->
<g id="edge235" class="edge">
<title>ffn_act_14&#45;&gt;ffn_down_14</title>
<path fill="none" stroke="black" d="M417,-2792.39C417,-2784.15 417,-2774.89 417,-2766.09"/>
<polygon fill="black" stroke="black" points="420.5,-2766.05 417,-2756.05 413.5,-2766.05 420.5,-2766.05"/>
</g>
<!-- ffn_down_14&#45;&gt;residual2_14 -->
<g id="edge237" class="edge">
<title>ffn_down_14&#45;&gt;residual2_14</title>
<path fill="none" stroke="black" d="M434.28,-2702.62C439.96,-2694.17 446.54,-2684.39 453.21,-2674.47"/>
<polygon fill="black" stroke="black" points="456.14,-2676.39 458.81,-2666.13 450.33,-2672.48 456.14,-2676.39"/>
</g>
<!-- layer_out_14 -->
<g id="node183" class="node">
<title>layer_out_14</title>
<ellipse fill="lightgray" stroke="black" cx="494" cy="-2485.34" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="494" y="-2496.64" font-family="Times,serif" font-size="14.00">Layer14_Output</text>
<text text-anchor="middle" x="494" y="-2481.64" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="494" y="-2466.64" font-family="Times,serif" font-size="14.00">GPU&#45;13</text>
</g>
<!-- residual2_14&#45;&gt;layer_out_14 -->
<g id="edge238" class="edge">
<title>residual2_14&#45;&gt;layer_out_14</title>
<path fill="none" stroke="black" d="M494,-2559.69C494,-2550.79 494,-2541.59 494,-2532.84"/>
<polygon fill="black" stroke="black" points="497.5,-2532.82 494,-2522.82 490.5,-2532.82 497.5,-2532.82"/>
</g>
<!-- ln1_15 -->
<g id="node184" class="node">
<title>ln1_15</title>
<polygon fill="lightyellow" stroke="black" points="519.5,-2360.86 360.5,-2360.86 360.5,-2307.86 519.5,-2307.86 519.5,-2360.86"/>
<text text-anchor="middle" x="440" y="-2345.66" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="440" y="-2330.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="440" y="-2315.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- layer_out_14&#45;&gt;ln1_15 -->
<g id="edge239" class="edge">
<title>layer_out_14&#45;&gt;ln1_15</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M480.79,-2447.89C472.27,-2424.38 461.24,-2393.94 452.79,-2370.66"/>
<polygon fill="red" stroke="red" points="456.05,-2369.36 449.35,-2361.16 449.47,-2371.75 456.05,-2369.36"/>
<text text-anchor="middle" x="545.5" y="-2418.66" font-family="Times,serif" font-size="14.00">GPU&#45;13→GPU&#45;14</text>
<text text-anchor="middle" x="545.5" y="-2403.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_15 -->
<g id="node190" class="node">
<title>residual1_15</title>
<polygon fill="lightpink" stroke="black" points="650.69,-2000.86 388.71,-2000.86 321.31,-1894.86 583.29,-1894.86 650.69,-2000.86"/>
<text text-anchor="middle" x="486" y="-1959.16" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="486" y="-1944.16" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="486" y="-1929.16" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- layer_out_14&#45;&gt;residual1_15 -->
<g id="edge247" class="edge">
<title>layer_out_14&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M591.3,-2466.27C660.78,-2447.1 742,-2408.94 742,-2335.36 742,-2335.36 742,-2335.36 742,-2063.36 742,-2008.13 691.73,-1979.36 635.75,-1964.45"/>
<polygon fill="black" stroke="black" points="636.54,-1961.04 625.98,-1962 634.83,-1967.83 636.54,-1961.04"/>
</g>
<!-- mha_q_15 -->
<g id="node185" class="node">
<title>mha_q_15</title>
<polygon fill="lightcoral" stroke="black" points="239.5,-2270.86 20.5,-2270.86 20.5,-2217.86 239.5,-2217.86 239.5,-2270.86"/>
<text text-anchor="middle" x="130" y="-2255.66" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="130" y="-2240.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="130" y="-2225.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_q_15 -->
<g id="edge240" class="edge">
<title>ln1_15&#45;&gt;mha_q_15</title>
<path fill="none" stroke="black" d="M360.17,-2310.7C320.39,-2299.41 271.9,-2285.64 229.7,-2273.66"/>
<polygon fill="black" stroke="black" points="230.54,-2270.26 219.96,-2270.9 228.62,-2277 230.54,-2270.26"/>
</g>
<!-- mha_k_15 -->
<g id="node186" class="node">
<title>mha_k_15</title>
<polygon fill="lightcoral" stroke="black" points="476.5,-2270.86 257.5,-2270.86 257.5,-2217.86 476.5,-2217.86 476.5,-2270.86"/>
<text text-anchor="middle" x="367" y="-2255.66" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="367" y="-2240.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="367" y="-2225.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_k_15 -->
<g id="edge241" class="edge">
<title>ln1_15&#45;&gt;mha_k_15</title>
<path fill="none" stroke="black" d="M418.49,-2307.43C411.07,-2298.48 402.64,-2288.32 394.78,-2278.85"/>
<polygon fill="black" stroke="black" points="397.43,-2276.56 388.35,-2271.1 392.04,-2281.03 397.43,-2276.56"/>
</g>
<!-- mha_v_15 -->
<g id="node187" class="node">
<title>mha_v_15</title>
<polygon fill="lightcoral" stroke="black" points="713.5,-2270.86 494.5,-2270.86 494.5,-2217.86 713.5,-2217.86 713.5,-2270.86"/>
<text text-anchor="middle" x="604" y="-2255.66" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="604" y="-2240.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="604" y="-2225.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln1_15&#45;&gt;mha_v_15 -->
<g id="edge242" class="edge">
<title>ln1_15&#45;&gt;mha_v_15</title>
<path fill="none" stroke="black" d="M487.88,-2307.67C506.49,-2297.68 527.95,-2286.17 547.32,-2275.77"/>
<polygon fill="black" stroke="black" points="549.19,-2278.74 556.35,-2270.93 545.88,-2272.57 549.19,-2278.74"/>
</g>
<!-- mha_attn_15 -->
<g id="node188" class="node">
<title>mha_attn_15</title>
<polygon fill="lightcoral" stroke="black" points="468.5,-2180.86 297.5,-2180.86 297.5,-2127.86 468.5,-2127.86 468.5,-2180.86"/>
<text text-anchor="middle" x="383" y="-2165.66" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="383" y="-2150.66" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="383" y="-2135.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- mha_q_15&#45;&gt;mha_attn_15 -->
<g id="edge243" class="edge">
<title>mha_q_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M203.52,-2217.79C233.66,-2207.3 268.71,-2195.11 299.79,-2184.3"/>
<polygon fill="black" stroke="black" points="301,-2187.59 309.3,-2181 298.7,-2180.97 301,-2187.59"/>
</g>
<!-- mha_k_15&#45;&gt;mha_attn_15 -->
<g id="edge244" class="edge">
<title>mha_k_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M371.71,-2217.43C373.21,-2209.2 374.89,-2199.94 376.5,-2191.14"/>
<polygon fill="black" stroke="black" points="379.97,-2191.57 378.32,-2181.1 373.09,-2190.31 379.97,-2191.57"/>
</g>
<!-- mha_v_15&#45;&gt;mha_attn_15 -->
<g id="edge245" class="edge">
<title>mha_v_15&#45;&gt;mha_attn_15</title>
<path fill="none" stroke="black" d="M539.78,-2217.79C513.79,-2207.44 483.63,-2195.43 456.74,-2184.72"/>
<polygon fill="black" stroke="black" points="457.96,-2181.44 447.38,-2181 455.38,-2187.95 457.96,-2181.44"/>
</g>
<!-- mha_out_15 -->
<g id="node189" class="node">
<title>mha_out_15</title>
<polygon fill="lightcoral" stroke="black" points="522.5,-2090.86 363.5,-2090.86 363.5,-2037.86 522.5,-2037.86 522.5,-2090.86"/>
<text text-anchor="middle" x="443" y="-2075.66" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="443" y="-2060.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="443" y="-2045.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- mha_attn_15&#45;&gt;mha_out_15 -->
<g id="edge246" class="edge">
<title>mha_attn_15&#45;&gt;mha_out_15</title>
<path fill="none" stroke="black" d="M400.68,-2127.43C406.66,-2118.66 413.43,-2108.73 419.78,-2099.42"/>
<polygon fill="black" stroke="black" points="422.71,-2101.34 425.45,-2091.1 416.92,-2097.39 422.71,-2101.34"/>
</g>
<!-- mha_out_15&#45;&gt;residual1_15 -->
<g id="edge248" class="edge">
<title>mha_out_15&#45;&gt;residual1_15</title>
<path fill="none" stroke="black" d="M452.65,-2037.66C455.7,-2029.55 459.2,-2020.22 462.77,-2010.71"/>
<polygon fill="black" stroke="black" points="466.11,-2011.77 466.35,-2001.18 459.56,-2009.31 466.11,-2011.77"/>
</g>
<!-- ln2_15 -->
<g id="node191" class="node">
<title>ln2_15</title>
<polygon fill="lightyellow" stroke="black" points="479.5,-1857.86 320.5,-1857.86 320.5,-1804.86 479.5,-1804.86 479.5,-1857.86"/>
<text text-anchor="middle" x="400" y="-1842.66" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="400" y="-1827.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="400" y="-1812.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual1_15&#45;&gt;ln2_15 -->
<g id="edge249" class="edge">
<title>residual1_15&#45;&gt;ln2_15</title>
<path fill="none" stroke="black" d="M446.77,-1894.64C439.52,-1884.98 432.13,-1875.13 425.42,-1866.21"/>
<polygon fill="black" stroke="black" points="428.03,-1863.86 419.23,-1857.96 422.44,-1868.06 428.03,-1863.86"/>
</g>
<!-- residual2_15 -->
<g id="node195" class="node">
<title>residual2_15</title>
<polygon fill="lightpink" stroke="black" points="617.69,-1497.86 355.71,-1497.86 288.31,-1391.86 550.29,-1391.86 617.69,-1497.86"/>
<text text-anchor="middle" x="453" y="-1456.16" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="453" y="-1441.16" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="453" y="-1426.16" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual1_15&#45;&gt;residual2_15 -->
<g id="edge253" class="edge">
<title>residual1_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M502.98,-1894.69C507.91,-1875.33 512,-1853.05 512,-1832.36 512,-1832.36 512,-1832.36 512,-1560.36 512,-1541.96 505.91,-1523.57 497.64,-1507.07"/>
<polygon fill="black" stroke="black" points="500.65,-1505.28 492.84,-1498.11 494.48,-1508.58 500.65,-1505.28"/>
</g>
<!-- ffn_up_15 -->
<g id="node192" class="node">
<title>ffn_up_15</title>
<polygon fill="lightblue" stroke="black" points="493,-1767.86 277,-1767.86 277,-1714.86 493,-1714.86 493,-1767.86"/>
<text text-anchor="middle" x="385" y="-1752.66" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="385" y="-1737.66" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="385" y="-1722.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ln2_15&#45;&gt;ffn_up_15 -->
<g id="edge250" class="edge">
<title>ln2_15&#45;&gt;ffn_up_15</title>
<path fill="none" stroke="black" d="M395.58,-1804.43C394.18,-1796.2 392.6,-1786.94 391.1,-1778.14"/>
<polygon fill="black" stroke="black" points="394.52,-1777.37 389.39,-1768.1 387.62,-1778.55 394.52,-1777.37"/>
</g>
<!-- ffn_act_15 -->
<g id="node193" class="node">
<title>ffn_act_15</title>
<polygon fill="lightgreen" stroke="black" points="469,-1677.86 301,-1677.86 301,-1624.86 469,-1624.86 469,-1677.86"/>
<text text-anchor="middle" x="385" y="-1662.66" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="385" y="-1647.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="385" y="-1632.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ffn_up_15&#45;&gt;ffn_act_15 -->
<g id="edge251" class="edge">
<title>ffn_up_15&#45;&gt;ffn_act_15</title>
<path fill="none" stroke="black" d="M385,-1714.43C385,-1706.2 385,-1696.94 385,-1688.14"/>
<polygon fill="black" stroke="black" points="388.5,-1688.1 385,-1678.1 381.5,-1688.1 388.5,-1688.1"/>
</g>
<!-- ffn_down_15 -->
<g id="node194" class="node">
<title>ffn_down_15</title>
<polygon fill="lightblue" stroke="black" points="493,-1587.86 277,-1587.86 277,-1534.86 493,-1534.86 493,-1587.86"/>
<text text-anchor="middle" x="385" y="-1572.66" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="385" y="-1557.66" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="385" y="-1542.66" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- ffn_act_15&#45;&gt;ffn_down_15 -->
<g id="edge252" class="edge">
<title>ffn_act_15&#45;&gt;ffn_down_15</title>
<path fill="none" stroke="black" d="M385,-1624.43C385,-1616.2 385,-1606.94 385,-1598.14"/>
<polygon fill="black" stroke="black" points="388.5,-1598.1 385,-1588.1 381.5,-1598.1 388.5,-1598.1"/>
</g>
<!-- ffn_down_15&#45;&gt;residual2_15 -->
<g id="edge254" class="edge">
<title>ffn_down_15&#45;&gt;residual2_15</title>
<path fill="none" stroke="black" d="M400.26,-1534.66C405.23,-1526.3 410.97,-1516.63 416.8,-1506.81"/>
<polygon fill="black" stroke="black" points="419.83,-1508.57 421.93,-1498.18 413.81,-1504.99 419.83,-1508.57"/>
</g>
<!-- layer_out_15 -->
<g id="node196" class="node">
<title>layer_out_15</title>
<ellipse fill="lightgray" stroke="black" cx="453" cy="-1317.38" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="453" y="-1328.68" font-family="Times,serif" font-size="14.00">Layer15_Output</text>
<text text-anchor="middle" x="453" y="-1313.68" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="453" y="-1298.68" font-family="Times,serif" font-size="14.00">GPU&#45;14</text>
</g>
<!-- residual2_15&#45;&gt;layer_out_15 -->
<g id="edge255" class="edge">
<title>residual2_15&#45;&gt;layer_out_15</title>
<path fill="none" stroke="black" d="M453,-1391.74C453,-1382.83 453,-1373.63 453,-1364.89"/>
<polygon fill="black" stroke="black" points="456.5,-1364.87 453,-1354.87 449.5,-1364.87 456.5,-1364.87"/>
</g>
<!-- ln1_16 -->
<g id="node197" class="node">
<title>ln1_16</title>
<polygon fill="lightyellow" stroke="black" points="488.5,-1192.91 329.5,-1192.91 329.5,-1139.91 488.5,-1139.91 488.5,-1192.91"/>
<text text-anchor="middle" x="409" y="-1177.71" font-family="Times,serif" font-size="14.00">LayerNorm1</text>
<text text-anchor="middle" x="409" y="-1162.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="409" y="-1147.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- layer_out_15&#45;&gt;ln1_16 -->
<g id="edge256" class="edge">
<title>layer_out_15&#45;&gt;ln1_16</title>
<path fill="none" stroke="red" stroke-dasharray="5,2" d="M442.24,-1279.94C435.32,-1256.53 426.38,-1226.26 419.52,-1203.02"/>
<polygon fill="red" stroke="red" points="422.81,-1201.8 416.62,-1193.2 416.09,-1203.78 422.81,-1201.8"/>
<text text-anchor="middle" x="508.5" y="-1250.71" font-family="Times,serif" font-size="14.00">GPU&#45;14→GPU&#45;15</text>
<text text-anchor="middle" x="508.5" y="-1235.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
</g>
<!-- residual1_16 -->
<g id="node203" class="node">
<title>residual1_16</title>
<polygon fill="lightpink" stroke="black" points="744.69,-832.91 482.71,-832.91 415.31,-726.91 677.29,-726.91 744.69,-832.91"/>
<text text-anchor="middle" x="580" y="-791.21" font-family="Times,serif" font-size="14.00">ResidualAdd1</text>
<text text-anchor="middle" x="580" y="-776.21" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="580" y="-761.21" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- layer_out_15&#45;&gt;residual1_16 -->
<g id="edge264" class="edge">
<title>layer_out_15&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M563.25,-1309.93C656.83,-1297.77 776,-1263.43 776,-1167.41 776,-1167.41 776,-1167.41 776,-895.41 776,-872.89 766.23,-854.71 751.06,-840.07"/>
<polygon fill="black" stroke="black" points="753.02,-837.13 743.19,-833.16 748.4,-842.39 753.02,-837.13"/>
</g>
<!-- mha_q_16 -->
<g id="node198" class="node">
<title>mha_q_16</title>
<polygon fill="lightcoral" stroke="black" points="273.5,-1102.91 54.5,-1102.91 54.5,-1049.91 273.5,-1049.91 273.5,-1102.91"/>
<text text-anchor="middle" x="164" y="-1087.71" font-family="Times,serif" font-size="14.00">MHA&#45;Q</text>
<text text-anchor="middle" x="164" y="-1072.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="164" y="-1057.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_q_16 -->
<g id="edge257" class="edge">
<title>ln1_16&#45;&gt;mha_q_16</title>
<path fill="none" stroke="black" d="M337.81,-1139.84C308.74,-1129.39 274.97,-1117.26 244.97,-1106.49"/>
<polygon fill="black" stroke="black" points="245.97,-1103.13 235.37,-1103.04 243.6,-1109.72 245.97,-1103.13"/>
</g>
<!-- mha_k_16 -->
<g id="node199" class="node">
<title>mha_k_16</title>
<polygon fill="lightcoral" stroke="black" points="510.5,-1102.91 291.5,-1102.91 291.5,-1049.91 510.5,-1049.91 510.5,-1102.91"/>
<text text-anchor="middle" x="401" y="-1087.71" font-family="Times,serif" font-size="14.00">MHA&#45;K</text>
<text text-anchor="middle" x="401" y="-1072.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="401" y="-1057.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_k_16 -->
<g id="edge258" class="edge">
<title>ln1_16&#45;&gt;mha_k_16</title>
<path fill="none" stroke="black" d="M406.64,-1139.48C405.89,-1131.24 405.05,-1121.99 404.25,-1113.18"/>
<polygon fill="black" stroke="black" points="407.73,-1112.79 403.34,-1103.15 400.76,-1113.42 407.73,-1112.79"/>
</g>
<!-- mha_v_16 -->
<g id="node200" class="node">
<title>mha_v_16</title>
<polygon fill="lightcoral" stroke="black" points="747.5,-1102.91 528.5,-1102.91 528.5,-1049.91 747.5,-1049.91 747.5,-1102.91"/>
<text text-anchor="middle" x="638" y="-1087.71" font-family="Times,serif" font-size="14.00">MHA&#45;V</text>
<text text-anchor="middle" x="638" y="-1072.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096×64×64]</text>
<text text-anchor="middle" x="638" y="-1057.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln1_16&#45;&gt;mha_v_16 -->
<g id="edge259" class="edge">
<title>ln1_16&#45;&gt;mha_v_16</title>
<path fill="none" stroke="black" d="M475.54,-1139.84C502.59,-1129.44 534,-1117.37 561.96,-1106.63"/>
<polygon fill="black" stroke="black" points="563.21,-1109.9 571.29,-1103.04 560.7,-1103.36 563.21,-1109.9"/>
</g>
<!-- mha_attn_16 -->
<g id="node201" class="node">
<title>mha_attn_16</title>
<polygon fill="lightcoral" stroke="black" points="503.5,-1012.91 332.5,-1012.91 332.5,-959.91 503.5,-959.91 503.5,-1012.91"/>
<text text-anchor="middle" x="418" y="-997.71" font-family="Times,serif" font-size="14.00">MHA&#45;Attn</text>
<text text-anchor="middle" x="418" y="-982.71" font-family="Times,serif" font-size="14.00">[1024×2048×64×64]</text>
<text text-anchor="middle" x="418" y="-967.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- mha_q_16&#45;&gt;mha_attn_16 -->
<g id="edge260" class="edge">
<title>mha_q_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M237.81,-1049.84C268.07,-1039.35 303.26,-1027.16 334.46,-1016.35"/>
<polygon fill="black" stroke="black" points="335.7,-1019.62 344.01,-1013.04 333.41,-1013.01 335.7,-1019.62"/>
</g>
<!-- mha_k_16&#45;&gt;mha_attn_16 -->
<g id="edge261" class="edge">
<title>mha_k_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M406.01,-1049.48C407.6,-1041.24 409.39,-1031.99 411.09,-1023.18"/>
<polygon fill="black" stroke="black" points="414.57,-1023.63 413.03,-1013.15 407.69,-1022.3 414.57,-1023.63"/>
</g>
<!-- mha_v_16&#45;&gt;mha_attn_16 -->
<g id="edge262" class="edge">
<title>mha_v_16&#45;&gt;mha_attn_16</title>
<path fill="none" stroke="black" d="M574.07,-1049.84C548.2,-1039.49 518.17,-1027.47 491.41,-1016.77"/>
<polygon fill="black" stroke="black" points="492.67,-1013.51 482.09,-1013.04 490.07,-1020.01 492.67,-1013.51"/>
</g>
<!-- mha_out_16 -->
<g id="node202" class="node">
<title>mha_out_16</title>
<polygon fill="lightcoral" stroke="black" points="633.5,-922.91 474.5,-922.91 474.5,-869.91 633.5,-869.91 633.5,-922.91"/>
<text text-anchor="middle" x="554" y="-907.71" font-family="Times,serif" font-size="14.00">MHA&#45;Out</text>
<text text-anchor="middle" x="554" y="-892.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="554" y="-877.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- mha_attn_16&#45;&gt;mha_out_16 -->
<g id="edge263" class="edge">
<title>mha_attn_16&#45;&gt;mha_out_16</title>
<path fill="none" stroke="black" d="M457.7,-959.72C472.79,-949.96 490.13,-938.74 505.9,-928.53"/>
<polygon fill="black" stroke="black" points="507.99,-931.35 514.48,-922.98 504.19,-925.47 507.99,-931.35"/>
</g>
<!-- mha_out_16&#45;&gt;residual1_16 -->
<g id="edge265" class="edge">
<title>mha_out_16&#45;&gt;residual1_16</title>
<path fill="none" stroke="black" d="M559.83,-869.71C561.66,-861.69 563.75,-852.46 565.89,-843.05"/>
<polygon fill="black" stroke="black" points="569.32,-843.75 568.12,-833.23 562.49,-842.2 569.32,-843.75"/>
</g>
<!-- ln2_16 -->
<g id="node204" class="node">
<title>ln2_16</title>
<polygon fill="lightyellow" stroke="black" points="573.5,-689.91 414.5,-689.91 414.5,-636.91 573.5,-636.91 573.5,-689.91"/>
<text text-anchor="middle" x="494" y="-674.71" font-family="Times,serif" font-size="14.00">LayerNorm2</text>
<text text-anchor="middle" x="494" y="-659.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="494" y="-644.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual1_16&#45;&gt;ln2_16 -->
<g id="edge266" class="edge">
<title>residual1_16&#45;&gt;ln2_16</title>
<path fill="none" stroke="black" d="M540.77,-726.68C533.52,-717.03 526.13,-707.18 519.42,-698.25"/>
<polygon fill="black" stroke="black" points="522.03,-695.9 513.23,-690.01 516.44,-700.11 522.03,-695.9"/>
</g>
<!-- residual2_16 -->
<g id="node208" class="node">
<title>residual2_16</title>
<polygon fill="lightpink" stroke="black" points="736.69,-329.91 474.71,-329.91 407.31,-223.91 669.29,-223.91 736.69,-329.91"/>
<text text-anchor="middle" x="572" y="-288.21" font-family="Times,serif" font-size="14.00">ResidualAdd2</text>
<text text-anchor="middle" x="572" y="-273.21" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="572" y="-258.21" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual1_16&#45;&gt;residual2_16 -->
<g id="edge270" class="edge">
<title>residual1_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M596.98,-726.74C601.91,-707.38 606,-685.1 606,-664.41 606,-664.41 606,-664.41 606,-392.41 606,-374.9 602.3,-356.49 597.34,-339.67"/>
<polygon fill="black" stroke="black" points="600.63,-338.46 594.3,-329.97 593.96,-340.56 600.63,-338.46"/>
</g>
<!-- ffn_up_16 -->
<g id="node205" class="node">
<title>ffn_up_16</title>
<polygon fill="lightblue" stroke="black" points="587,-599.91 371,-599.91 371,-546.91 587,-546.91 587,-599.91"/>
<text text-anchor="middle" x="479" y="-584.71" font-family="Times,serif" font-size="14.00">FFN&#45;Up</text>
<text text-anchor="middle" x="479" y="-569.71" font-family="Times,serif" font-size="14.00">[1024×2048×4096→11008]</text>
<text text-anchor="middle" x="479" y="-554.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ln2_16&#45;&gt;ffn_up_16 -->
<g id="edge267" class="edge">
<title>ln2_16&#45;&gt;ffn_up_16</title>
<path fill="none" stroke="black" d="M489.58,-636.48C488.18,-628.24 486.6,-618.99 485.1,-610.18"/>
<polygon fill="black" stroke="black" points="488.52,-609.42 483.39,-600.15 481.62,-610.59 488.52,-609.42"/>
</g>
<!-- ffn_act_16 -->
<g id="node206" class="node">
<title>ffn_act_16</title>
<polygon fill="lightgreen" stroke="black" points="563,-509.91 395,-509.91 395,-456.91 563,-456.91 563,-509.91"/>
<text text-anchor="middle" x="479" y="-494.71" font-family="Times,serif" font-size="14.00">GELU</text>
<text text-anchor="middle" x="479" y="-479.71" font-family="Times,serif" font-size="14.00">[1024×2048×11008]</text>
<text text-anchor="middle" x="479" y="-464.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ffn_up_16&#45;&gt;ffn_act_16 -->
<g id="edge268" class="edge">
<title>ffn_up_16&#45;&gt;ffn_act_16</title>
<path fill="none" stroke="black" d="M479,-546.48C479,-538.24 479,-528.99 479,-520.18"/>
<polygon fill="black" stroke="black" points="482.5,-520.15 479,-510.15 475.5,-520.15 482.5,-520.15"/>
</g>
<!-- ffn_down_16 -->
<g id="node207" class="node">
<title>ffn_down_16</title>
<polygon fill="lightblue" stroke="black" points="587,-419.91 371,-419.91 371,-366.91 587,-366.91 587,-419.91"/>
<text text-anchor="middle" x="479" y="-404.71" font-family="Times,serif" font-size="14.00">FFN&#45;Down</text>
<text text-anchor="middle" x="479" y="-389.71" font-family="Times,serif" font-size="14.00">[1024×2048×11008→4096]</text>
<text text-anchor="middle" x="479" y="-374.71" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- ffn_act_16&#45;&gt;ffn_down_16 -->
<g id="edge269" class="edge">
<title>ffn_act_16&#45;&gt;ffn_down_16</title>
<path fill="none" stroke="black" d="M479,-456.48C479,-448.24 479,-438.99 479,-430.18"/>
<polygon fill="black" stroke="black" points="482.5,-430.15 479,-420.15 475.5,-430.15 482.5,-430.15"/>
</g>
<!-- ffn_down_16&#45;&gt;residual2_16 -->
<g id="edge271" class="edge">
<title>ffn_down_16&#45;&gt;residual2_16</title>
<path fill="none" stroke="black" d="M499.87,-366.71C506.8,-358.18 514.84,-348.29 522.97,-338.27"/>
<polygon fill="black" stroke="black" points="525.92,-340.2 529.5,-330.23 520.48,-335.78 525.92,-340.2"/>
</g>
<!-- layer_out_16 -->
<g id="node209" class="node">
<title>layer_out_16</title>
<ellipse fill="lightgray" stroke="black" cx="572" cy="-149.43" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="572" y="-160.73" font-family="Times,serif" font-size="14.00">Layer16_Output</text>
<text text-anchor="middle" x="572" y="-145.73" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="572" y="-130.73" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- residual2_16&#45;&gt;layer_out_16 -->
<g id="edge272" class="edge">
<title>residual2_16&#45;&gt;layer_out_16</title>
<path fill="none" stroke="black" d="M572,-223.78C572,-214.88 572,-205.68 572,-196.93"/>
<polygon fill="black" stroke="black" points="575.5,-196.92 572,-186.92 568.5,-196.92 575.5,-196.92"/>
</g>
<!-- final_output -->
<g id="node210" class="node">
<title>final_output</title>
<ellipse fill="gold" stroke="black" cx="572" cy="-37.48" rx="112.36" ry="37.45"/>
<text text-anchor="middle" x="572" y="-48.78" font-family="Times,serif" font-size="14.00">Final Output</text>
<text text-anchor="middle" x="572" y="-33.78" font-family="Times,serif" font-size="14.00">[1024×2048×4096]</text>
<text text-anchor="middle" x="572" y="-18.78" font-family="Times,serif" font-size="14.00">GPU&#45;15</text>
</g>
<!-- layer_out_16&#45;&gt;final_output -->
<g id="edge273" class="edge">
<title>layer_out_16&#45;&gt;final_output</title>
<path fill="none" stroke="black" d="M572,-111.82C572,-103.38 572,-94.28 572,-85.47"/>
<polygon fill="black" stroke="black" points="575.5,-85.3 572,-75.3 568.5,-85.3 575.5,-85.3"/>
</g>
</g>
</svg>
