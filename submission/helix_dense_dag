// Helix Dense Transformer DAG with 16-GPU Two-Level Partitioning
digraph {
	nodesep=0.8 rankdir=TB ranksep=1.2 splines=ortho
	node [fillcolor=lightblue shape=rectangle style=filled]
	edge [fontsize=10]
	subgraph cluster_input {
		fillcolor=lightgray label="Input Processing" style=rounded
		input [label="Input Tokens
(B×L×D)
All GPUs" fillcolor=lightgreen shape=ellipse]
		embed [label="Embedding Layer
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		pos_enc [label="Positional Encoding
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
	}
	subgraph cluster_layer1 {
		fillcolor=lightyellow label="Layer 1" style=rounded
		ln1_0 [label="LayerNorm
(B×L×D)
GPU 0-3" fillcolor=lightblue shape=rectangle]
		ln1_1 [label="LayerNorm
(B×L×D)
GPU 4-7" fillcolor=lightblue shape=rectangle]
		ln1_2 [label="LayerNorm
(B×L×D)
GPU 8-11" fillcolor=lightblue shape=rectangle]
		ln1_3 [label="LayerNorm
(B×L×D)
GPU 12-15" fillcolor=lightblue shape=rectangle]
		q_proj_0_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		k_proj_0_0 [label="K Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		v_proj_0_0 [label="V Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		q_proj_0_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		k_proj_0_1 [label="K Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		v_proj_0_1 [label="V Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		q_proj_0_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		k_proj_0_2 [label="K Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		v_proj_0_2 [label="V Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		q_proj_0_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		k_proj_0_3 [label="K Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		v_proj_0_3 [label="V Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		q_proj_1_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		k_proj_1_0 [label="K Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		v_proj_1_0 [label="V Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		q_proj_1_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		k_proj_1_1 [label="K Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		v_proj_1_1 [label="V Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		q_proj_1_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		k_proj_1_2 [label="K Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		v_proj_1_2 [label="V Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		q_proj_1_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		k_proj_1_3 [label="K Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		v_proj_1_3 [label="V Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		q_proj_2_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		k_proj_2_0 [label="K Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		v_proj_2_0 [label="V Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		q_proj_2_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		k_proj_2_1 [label="K Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		v_proj_2_1 [label="V Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		q_proj_2_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		k_proj_2_2 [label="K Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		v_proj_2_2 [label="V Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		q_proj_2_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		k_proj_2_3 [label="K Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		v_proj_2_3 [label="V Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		q_proj_3_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		k_proj_3_0 [label="K Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		v_proj_3_0 [label="V Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		q_proj_3_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		k_proj_3_1 [label="K Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		v_proj_3_1 [label="V Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		q_proj_3_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		k_proj_3_2 [label="K Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		v_proj_3_2 [label="V Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		q_proj_3_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		k_proj_3_3 [label="K Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		v_proj_3_3 [label="V Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		attn_0_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 0" fillcolor=orange shape=rectangle]
		attn_0_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 1" fillcolor=orange shape=rectangle]
		attn_0_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 2" fillcolor=orange shape=rectangle]
		attn_0_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 3" fillcolor=orange shape=rectangle]
		attn_1_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 4" fillcolor=orange shape=rectangle]
		attn_1_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 5" fillcolor=orange shape=rectangle]
		attn_1_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 6" fillcolor=orange shape=rectangle]
		attn_1_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 7" fillcolor=orange shape=rectangle]
		attn_2_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 8" fillcolor=orange shape=rectangle]
		attn_2_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 9" fillcolor=orange shape=rectangle]
		attn_2_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 10" fillcolor=orange shape=rectangle]
		attn_2_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 11" fillcolor=orange shape=rectangle]
		attn_3_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 12" fillcolor=orange shape=rectangle]
		attn_3_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 13" fillcolor=orange shape=rectangle]
		attn_3_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 14" fillcolor=orange shape=rectangle]
		attn_3_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 15" fillcolor=orange shape=rectangle]
		concat_dim_0 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 0-3" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_1 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 4-7" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_2 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 8-11" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_3 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 12-15" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_heads [label="Head Group Concatenation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		out_proj [label="Output Projection
(B×L×D)
All GPUs" fillcolor=lightcoral shape=rectangle]
		residual1 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
		ln2 [label="LayerNorm
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		mlp_linear1_0 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_1 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_5 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_6 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_7 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_8 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_9 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_10 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_11 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_12 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_13 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_14 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_15 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_0 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightblue shape=rectangle]
		mlp_gelu_1 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightblue shape=rectangle]
		mlp_gelu_2 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightblue shape=rectangle]
		mlp_gelu_3 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightblue shape=rectangle]
		mlp_gelu_4 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightblue shape=rectangle]
		mlp_gelu_5 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightblue shape=rectangle]
		mlp_gelu_6 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightblue shape=rectangle]
		mlp_gelu_7 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightblue shape=rectangle]
		mlp_gelu_8 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightblue shape=rectangle]
		mlp_gelu_9 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightblue shape=rectangle]
		mlp_gelu_10 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightblue shape=rectangle]
		mlp_gelu_11 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightblue shape=rectangle]
		mlp_gelu_12 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightblue shape=rectangle]
		mlp_gelu_13 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightblue shape=rectangle]
		mlp_gelu_14 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightblue shape=rectangle]
		mlp_gelu_15 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightblue shape=rectangle]
		mlp_linear2_0 [label="MLP Linear2
(B×L×D/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_1 [label="MLP Linear2
(B×L×D/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_2 [label="MLP Linear2
(B×L×D/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_3 [label="MLP Linear2
(B×L×D/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_4 [label="MLP Linear2
(B×L×D/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_5 [label="MLP Linear2
(B×L×D/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_6 [label="MLP Linear2
(B×L×D/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_7 [label="MLP Linear2
(B×L×D/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_8 [label="MLP Linear2
(B×L×D/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_9 [label="MLP Linear2
(B×L×D/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_10 [label="MLP Linear2
(B×L×D/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_11 [label="MLP Linear2
(B×L×D/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_12 [label="MLP Linear2
(B×L×D/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_13 [label="MLP Linear2
(B×L×D/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_14 [label="MLP Linear2
(B×L×D/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_linear2_15 [label="MLP Linear2
(B×L×D/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_agg [label="MLP Output Aggregation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		residual2 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
	}
	subgraph cluster_layer2 {
		fillcolor=lightyellow label="Layer 2" style=rounded
		ln2_0 [label="LayerNorm
(B×L×D)
GPU 0-3" fillcolor=lightblue shape=rectangle]
		ln2_1 [label="LayerNorm
(B×L×D)
GPU 4-7" fillcolor=lightblue shape=rectangle]
		ln2_2 [label="LayerNorm
(B×L×D)
GPU 8-11" fillcolor=lightblue shape=rectangle]
		ln2_3 [label="LayerNorm
(B×L×D)
GPU 12-15" fillcolor=lightblue shape=rectangle]
		q_proj_2_0_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		k_proj_2_0_0 [label="K Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		v_proj_2_0_0 [label="V Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		attn_2_0_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 0" fillcolor=orange shape=rectangle]
		q_proj_2_0_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		k_proj_2_0_1 [label="K Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		v_proj_2_0_1 [label="V Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		attn_2_0_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 1" fillcolor=orange shape=rectangle]
		q_proj_2_0_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		k_proj_2_0_2 [label="K Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		v_proj_2_0_2 [label="V Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		attn_2_0_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 2" fillcolor=orange shape=rectangle]
		q_proj_2_0_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		k_proj_2_0_3 [label="K Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		v_proj_2_0_3 [label="V Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		attn_2_0_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 3" fillcolor=orange shape=rectangle]
		q_proj_2_1_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		k_proj_2_1_0 [label="K Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		v_proj_2_1_0 [label="V Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		attn_2_1_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 4" fillcolor=orange shape=rectangle]
		q_proj_2_1_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		k_proj_2_1_1 [label="K Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		v_proj_2_1_1 [label="V Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		attn_2_1_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 5" fillcolor=orange shape=rectangle]
		q_proj_2_1_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		k_proj_2_1_2 [label="K Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		v_proj_2_1_2 [label="V Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		attn_2_1_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 6" fillcolor=orange shape=rectangle]
		q_proj_2_1_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		k_proj_2_1_3 [label="K Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		v_proj_2_1_3 [label="V Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		attn_2_1_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 7" fillcolor=orange shape=rectangle]
		q_proj_2_2_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		k_proj_2_2_0 [label="K Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		v_proj_2_2_0 [label="V Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		attn_2_2_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 8" fillcolor=orange shape=rectangle]
		q_proj_2_2_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		k_proj_2_2_1 [label="K Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		v_proj_2_2_1 [label="V Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		attn_2_2_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 9" fillcolor=orange shape=rectangle]
		q_proj_2_2_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		k_proj_2_2_2 [label="K Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		v_proj_2_2_2 [label="V Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		attn_2_2_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 10" fillcolor=orange shape=rectangle]
		q_proj_2_2_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		k_proj_2_2_3 [label="K Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		v_proj_2_2_3 [label="V Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		attn_2_2_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 11" fillcolor=orange shape=rectangle]
		q_proj_2_3_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		k_proj_2_3_0 [label="K Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		v_proj_2_3_0 [label="V Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		attn_2_3_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 12" fillcolor=orange shape=rectangle]
		q_proj_2_3_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		k_proj_2_3_1 [label="K Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		v_proj_2_3_1 [label="V Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		attn_2_3_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 13" fillcolor=orange shape=rectangle]
		q_proj_2_3_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		k_proj_2_3_2 [label="K Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		v_proj_2_3_2 [label="V Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		attn_2_3_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 14" fillcolor=orange shape=rectangle]
		q_proj_2_3_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		k_proj_2_3_3 [label="K Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		v_proj_2_3_3 [label="V Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		attn_2_3_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 15" fillcolor=orange shape=rectangle]
		concat_dim_2_0 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 0-3" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_2_1 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 4-7" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_2_2 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 8-11" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_2_3 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 12-15" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_heads_2 [label="Head Group Concatenation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		out_proj_2 [label="Output Projection
(B×L×D)
All GPUs" fillcolor=lightcoral shape=rectangle]
		residual2_1 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
		ln2_mlp [label="LayerNorm
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		mlp_linear1_2_0 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_0 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_0 [label="MLP Linear2
(B×L×D/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_1 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_1 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_1 [label="MLP Linear2
(B×L×D/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_2 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_2 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_2 [label="MLP Linear2
(B×L×D/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_3 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_3 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_3 [label="MLP Linear2
(B×L×D/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_4 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_4 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_4 [label="MLP Linear2
(B×L×D/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_5 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_5 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_5 [label="MLP Linear2
(B×L×D/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_6 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_6 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_6 [label="MLP Linear2
(B×L×D/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_7 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_7 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_7 [label="MLP Linear2
(B×L×D/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_8 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_8 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_8 [label="MLP Linear2
(B×L×D/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_9 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_9 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_9 [label="MLP Linear2
(B×L×D/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_10 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_10 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_10 [label="MLP Linear2
(B×L×D/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_11 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_11 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_11 [label="MLP Linear2
(B×L×D/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_12 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_12 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_12 [label="MLP Linear2
(B×L×D/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_13 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_13 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_13 [label="MLP Linear2
(B×L×D/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_14 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_14 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_14 [label="MLP Linear2
(B×L×D/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_2_15 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_2_15 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightblue shape=rectangle]
		mlp_linear2_2_15 [label="MLP Linear2
(B×L×D/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_agg_2 [label="MLP Output Aggregation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		residual2_2 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
	}
	subgraph cluster_layer3 {
		fillcolor=lightyellow label="Layer 3" style=rounded
		ln3_0 [label="LayerNorm
(B×L×D)
GPU 0-3" fillcolor=lightblue shape=rectangle]
		ln3_1 [label="LayerNorm
(B×L×D)
GPU 4-7" fillcolor=lightblue shape=rectangle]
		ln3_2 [label="LayerNorm
(B×L×D)
GPU 8-11" fillcolor=lightblue shape=rectangle]
		ln3_3 [label="LayerNorm
(B×L×D)
GPU 12-15" fillcolor=lightblue shape=rectangle]
		q_proj_3_0_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		k_proj_3_0_0 [label="K Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		v_proj_3_0_0 [label="V Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		attn_3_0_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 0" fillcolor=orange shape=rectangle]
		q_proj_3_0_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		k_proj_3_0_1 [label="K Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		v_proj_3_0_1 [label="V Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		attn_3_0_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 1" fillcolor=orange shape=rectangle]
		q_proj_3_0_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		k_proj_3_0_2 [label="K Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		v_proj_3_0_2 [label="V Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		attn_3_0_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 2" fillcolor=orange shape=rectangle]
		q_proj_3_0_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		k_proj_3_0_3 [label="K Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		v_proj_3_0_3 [label="V Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		attn_3_0_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 3" fillcolor=orange shape=rectangle]
		q_proj_3_1_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		k_proj_3_1_0 [label="K Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		v_proj_3_1_0 [label="V Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		attn_3_1_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 4" fillcolor=orange shape=rectangle]
		q_proj_3_1_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		k_proj_3_1_1 [label="K Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		v_proj_3_1_1 [label="V Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		attn_3_1_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 5" fillcolor=orange shape=rectangle]
		q_proj_3_1_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		k_proj_3_1_2 [label="K Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		v_proj_3_1_2 [label="V Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		attn_3_1_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 6" fillcolor=orange shape=rectangle]
		q_proj_3_1_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		k_proj_3_1_3 [label="K Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		v_proj_3_1_3 [label="V Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		attn_3_1_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 7" fillcolor=orange shape=rectangle]
		q_proj_3_2_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		k_proj_3_2_0 [label="K Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		v_proj_3_2_0 [label="V Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		attn_3_2_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 8" fillcolor=orange shape=rectangle]
		q_proj_3_2_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		k_proj_3_2_1 [label="K Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		v_proj_3_2_1 [label="V Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		attn_3_2_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 9" fillcolor=orange shape=rectangle]
		q_proj_3_2_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		k_proj_3_2_2 [label="K Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		v_proj_3_2_2 [label="V Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		attn_3_2_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 10" fillcolor=orange shape=rectangle]
		q_proj_3_2_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		k_proj_3_2_3 [label="K Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		v_proj_3_2_3 [label="V Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		attn_3_2_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 11" fillcolor=orange shape=rectangle]
		q_proj_3_3_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		k_proj_3_3_0 [label="K Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		v_proj_3_3_0 [label="V Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		attn_3_3_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 12" fillcolor=orange shape=rectangle]
		q_proj_3_3_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		k_proj_3_3_1 [label="K Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		v_proj_3_3_1 [label="V Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		attn_3_3_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 13" fillcolor=orange shape=rectangle]
		q_proj_3_3_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		k_proj_3_3_2 [label="K Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		v_proj_3_3_2 [label="V Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		attn_3_3_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 14" fillcolor=orange shape=rectangle]
		q_proj_3_3_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		k_proj_3_3_3 [label="K Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		v_proj_3_3_3 [label="V Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		attn_3_3_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 15" fillcolor=orange shape=rectangle]
		concat_dim_3_0 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 0-3" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_3_1 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 4-7" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_3_2 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 8-11" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_3_3 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 12-15" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_heads_3 [label="Head Group Concatenation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		out_proj_3 [label="Output Projection
(B×L×D)
All GPUs" fillcolor=lightcoral shape=rectangle]
		residual3_1 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
		ln3_mlp [label="LayerNorm
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		mlp_linear1_3_0 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_0 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_0 [label="MLP Linear2
(B×L×D/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_1 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_1 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_1 [label="MLP Linear2
(B×L×D/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_2 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_2 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_2 [label="MLP Linear2
(B×L×D/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_3 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_3 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_3 [label="MLP Linear2
(B×L×D/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_4 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_4 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_4 [label="MLP Linear2
(B×L×D/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_5 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_5 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_5 [label="MLP Linear2
(B×L×D/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_6 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_6 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_6 [label="MLP Linear2
(B×L×D/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_7 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_7 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_7 [label="MLP Linear2
(B×L×D/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_8 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_8 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_8 [label="MLP Linear2
(B×L×D/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_9 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_9 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_9 [label="MLP Linear2
(B×L×D/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_10 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_10 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_10 [label="MLP Linear2
(B×L×D/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_11 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_11 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_11 [label="MLP Linear2
(B×L×D/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_12 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_12 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_12 [label="MLP Linear2
(B×L×D/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_13 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_13 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_13 [label="MLP Linear2
(B×L×D/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_14 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_14 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_14 [label="MLP Linear2
(B×L×D/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_3_15 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_3_15 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightblue shape=rectangle]
		mlp_linear2_3_15 [label="MLP Linear2
(B×L×D/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_agg_3 [label="MLP Output Aggregation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		residual3_2 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
	}
	subgraph cluster_layer4 {
		fillcolor=lightyellow label="Layer 4" style=rounded
		ln4_0 [label="LayerNorm
(B×L×D)
GPU 0-3" fillcolor=lightblue shape=rectangle]
		ln4_1 [label="LayerNorm
(B×L×D)
GPU 4-7" fillcolor=lightblue shape=rectangle]
		ln4_2 [label="LayerNorm
(B×L×D)
GPU 8-11" fillcolor=lightblue shape=rectangle]
		ln4_3 [label="LayerNorm
(B×L×D)
GPU 12-15" fillcolor=lightblue shape=rectangle]
		q_proj_4_0_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		k_proj_4_0_0 [label="K Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		v_proj_4_0_0 [label="V Projection
(B×L×d_s×h_g)
GPU 0" fillcolor=lightcoral shape=rectangle]
		attn_4_0_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 0" fillcolor=orange shape=rectangle]
		q_proj_4_0_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		k_proj_4_0_1 [label="K Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		v_proj_4_0_1 [label="V Projection
(B×L×d_s×h_g)
GPU 1" fillcolor=lightcoral shape=rectangle]
		attn_4_0_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 1" fillcolor=orange shape=rectangle]
		q_proj_4_0_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		k_proj_4_0_2 [label="K Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		v_proj_4_0_2 [label="V Projection
(B×L×d_s×h_g)
GPU 2" fillcolor=lightcoral shape=rectangle]
		attn_4_0_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 2" fillcolor=orange shape=rectangle]
		q_proj_4_0_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		k_proj_4_0_3 [label="K Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		v_proj_4_0_3 [label="V Projection
(B×L×d_s×h_g)
GPU 3" fillcolor=lightcoral shape=rectangle]
		attn_4_0_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 3" fillcolor=orange shape=rectangle]
		q_proj_4_1_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		k_proj_4_1_0 [label="K Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		v_proj_4_1_0 [label="V Projection
(B×L×d_s×h_g)
GPU 4" fillcolor=lightcoral shape=rectangle]
		attn_4_1_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 4" fillcolor=orange shape=rectangle]
		q_proj_4_1_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		k_proj_4_1_1 [label="K Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		v_proj_4_1_1 [label="V Projection
(B×L×d_s×h_g)
GPU 5" fillcolor=lightcoral shape=rectangle]
		attn_4_1_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 5" fillcolor=orange shape=rectangle]
		q_proj_4_1_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		k_proj_4_1_2 [label="K Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		v_proj_4_1_2 [label="V Projection
(B×L×d_s×h_g)
GPU 6" fillcolor=lightcoral shape=rectangle]
		attn_4_1_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 6" fillcolor=orange shape=rectangle]
		q_proj_4_1_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		k_proj_4_1_3 [label="K Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		v_proj_4_1_3 [label="V Projection
(B×L×d_s×h_g)
GPU 7" fillcolor=lightcoral shape=rectangle]
		attn_4_1_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 7" fillcolor=orange shape=rectangle]
		q_proj_4_2_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		k_proj_4_2_0 [label="K Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		v_proj_4_2_0 [label="V Projection
(B×L×d_s×h_g)
GPU 8" fillcolor=lightcoral shape=rectangle]
		attn_4_2_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 8" fillcolor=orange shape=rectangle]
		q_proj_4_2_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		k_proj_4_2_1 [label="K Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		v_proj_4_2_1 [label="V Projection
(B×L×d_s×h_g)
GPU 9" fillcolor=lightcoral shape=rectangle]
		attn_4_2_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 9" fillcolor=orange shape=rectangle]
		q_proj_4_2_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		k_proj_4_2_2 [label="K Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		v_proj_4_2_2 [label="V Projection
(B×L×d_s×h_g)
GPU 10" fillcolor=lightcoral shape=rectangle]
		attn_4_2_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 10" fillcolor=orange shape=rectangle]
		q_proj_4_2_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		k_proj_4_2_3 [label="K Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		v_proj_4_2_3 [label="V Projection
(B×L×d_s×h_g)
GPU 11" fillcolor=lightcoral shape=rectangle]
		attn_4_2_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 11" fillcolor=orange shape=rectangle]
		q_proj_4_3_0 [label="Q Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		k_proj_4_3_0 [label="K Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		v_proj_4_3_0 [label="V Projection
(B×L×d_s×h_g)
GPU 12" fillcolor=lightcoral shape=rectangle]
		attn_4_3_0 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 12" fillcolor=orange shape=rectangle]
		q_proj_4_3_1 [label="Q Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		k_proj_4_3_1 [label="K Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		v_proj_4_3_1 [label="V Projection
(B×L×d_s×h_g)
GPU 13" fillcolor=lightcoral shape=rectangle]
		attn_4_3_1 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 13" fillcolor=orange shape=rectangle]
		q_proj_4_3_2 [label="Q Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		k_proj_4_3_2 [label="K Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		v_proj_4_3_2 [label="V Projection
(B×L×d_s×h_g)
GPU 14" fillcolor=lightcoral shape=rectangle]
		attn_4_3_2 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 14" fillcolor=orange shape=rectangle]
		q_proj_4_3_3 [label="Q Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		k_proj_4_3_3 [label="K Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		v_proj_4_3_3 [label="V Projection
(B×L×d_s×h_g)
GPU 15" fillcolor=lightcoral shape=rectangle]
		attn_4_3_3 [label="Scaled Dot-Product Attention
(B×L×d_s×h_g)
GPU 15" fillcolor=orange shape=rectangle]
		concat_dim_4_0 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 0-3" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_4_1 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 4-7" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_4_2 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 8-11" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_dim_4_3 [label="Dimension Concatenation
(B×L×d×h_g)
GPUs 12-15" fillcolor=lightgreen shape=parallelogram style=dashed]
		concat_heads_4 [label="Head Group Concatenation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		out_proj_4 [label="Output Projection
(B×L×D)
All GPUs" fillcolor=lightcoral shape=rectangle]
		residual4_1 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
		ln4_mlp [label="LayerNorm
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		mlp_linear1_4_0 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_0 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 0" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_0 [label="MLP Linear2
(B×L×D/16)
GPU 0" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_1 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_1 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 1" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_1 [label="MLP Linear2
(B×L×D/16)
GPU 1" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_2 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_2 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 2" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_2 [label="MLP Linear2
(B×L×D/16)
GPU 2" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_3 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_3 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 3" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_3 [label="MLP Linear2
(B×L×D/16)
GPU 3" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_4 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_4 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 4" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_4 [label="MLP Linear2
(B×L×D/16)
GPU 4" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_5 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_5 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 5" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_5 [label="MLP Linear2
(B×L×D/16)
GPU 5" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_6 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_6 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 6" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_6 [label="MLP Linear2
(B×L×D/16)
GPU 6" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_7 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_7 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 7" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_7 [label="MLP Linear2
(B×L×D/16)
GPU 7" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_8 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_8 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 8" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_8 [label="MLP Linear2
(B×L×D/16)
GPU 8" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_9 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_9 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 9" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_9 [label="MLP Linear2
(B×L×D/16)
GPU 9" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_10 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_10 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 10" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_10 [label="MLP Linear2
(B×L×D/16)
GPU 10" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_11 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_11 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 11" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_11 [label="MLP Linear2
(B×L×D/16)
GPU 11" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_12 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_12 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 12" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_12 [label="MLP Linear2
(B×L×D/16)
GPU 12" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_13 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_13 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 13" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_13 [label="MLP Linear2
(B×L×D/16)
GPU 13" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_14 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_14 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 14" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_14 [label="MLP Linear2
(B×L×D/16)
GPU 14" fillcolor=lightcoral shape=rectangle]
		mlp_linear1_4_15 [label="MLP Linear1
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_gelu_4_15 [label="GELU Activation
(B×L×ffn_hidden_size/16)
GPU 15" fillcolor=lightblue shape=rectangle]
		mlp_linear2_4_15 [label="MLP Linear2
(B×L×D/16)
GPU 15" fillcolor=lightcoral shape=rectangle]
		mlp_agg_4 [label="MLP Output Aggregation
(B×L×D)
All GPUs" fillcolor=lightgreen shape=parallelogram]
		residual4_2 [label="Residual Add
(B×L×D)
All GPUs" fillcolor=yellow shape=ellipse]
	}
	subgraph cluster_output {
		fillcolor=lightgray label="Output Processing" style=rounded
		final_ln [label="Final LayerNorm
(B×L×D)
All GPUs" fillcolor=lightblue shape=rectangle]
		lm_head [label="Language Model Head
(B×L×Vocab)
All GPUs" fillcolor=lightcoral shape=rectangle]
		output [label="Output Tokens
(B×L)
All GPUs" fillcolor=lightgreen shape=ellipse]
	}
	input -> embed
	embed -> pos_enc
	pos_enc -> ln1_0
	ln1_0 -> q_proj_0_0
	ln1_0 -> k_proj_0_0
	ln1_0 -> v_proj_0_0
	q_proj_0_0 -> attn_0_0
	k_proj_0_0 -> attn_0_0
	v_proj_0_0 -> attn_0_0
	attn_0_0 -> concat_dim_0
	ln1_0 -> q_proj_0_1
	ln1_0 -> k_proj_0_1
	ln1_0 -> v_proj_0_1
	q_proj_0_1 -> attn_0_1
	k_proj_0_1 -> attn_0_1
	v_proj_0_1 -> attn_0_1
	attn_0_1 -> concat_dim_0
	ln1_0 -> q_proj_0_2
	ln1_0 -> k_proj_0_2
	ln1_0 -> v_proj_0_2
	q_proj_0_2 -> attn_0_2
	k_proj_0_2 -> attn_0_2
	v_proj_0_2 -> attn_0_2
	attn_0_2 -> concat_dim_0
	ln1_0 -> q_proj_0_3
	ln1_0 -> k_proj_0_3
	ln1_0 -> v_proj_0_3
	q_proj_0_3 -> attn_0_3
	k_proj_0_3 -> attn_0_3
	v_proj_0_3 -> attn_0_3
	attn_0_3 -> concat_dim_0
	concat_dim_0 -> concat_heads
	pos_enc -> ln1_1
	ln1_1 -> q_proj_1_0
	ln1_1 -> k_proj_1_0
	ln1_1 -> v_proj_1_0
	q_proj_1_0 -> attn_1_0
	k_proj_1_0 -> attn_1_0
	v_proj_1_0 -> attn_1_0
	attn_1_0 -> concat_dim_1
	ln1_1 -> q_proj_1_1
	ln1_1 -> k_proj_1_1
	ln1_1 -> v_proj_1_1
	q_proj_1_1 -> attn_1_1
	k_proj_1_1 -> attn_1_1
	v_proj_1_1 -> attn_1_1
	attn_1_1 -> concat_dim_1
	ln1_1 -> q_proj_1_2
	ln1_1 -> k_proj_1_2
	ln1_1 -> v_proj_1_2
	q_proj_1_2 -> attn_1_2
	k_proj_1_2 -> attn_1_2
	v_proj_1_2 -> attn_1_2
	attn_1_2 -> concat_dim_1
	ln1_1 -> q_proj_1_3
	ln1_1 -> k_proj_1_3
	ln1_1 -> v_proj_1_3
	q_proj_1_3 -> attn_1_3
	k_proj_1_3 -> attn_1_3
	v_proj_1_3 -> attn_1_3
	attn_1_3 -> concat_dim_1
	concat_dim_1 -> concat_heads
	pos_enc -> ln1_2
	ln1_2 -> q_proj_2_0
	ln1_2 -> k_proj_2_0
	ln1_2 -> v_proj_2_0
	q_proj_2_0 -> attn_2_0
	k_proj_2_0 -> attn_2_0
	v_proj_2_0 -> attn_2_0
	attn_2_0 -> concat_dim_2
	ln1_2 -> q_proj_2_1
	ln1_2 -> k_proj_2_1
	ln1_2 -> v_proj_2_1
	q_proj_2_1 -> attn_2_1
	k_proj_2_1 -> attn_2_1
	v_proj_2_1 -> attn_2_1
	attn_2_1 -> concat_dim_2
	ln1_2 -> q_proj_2_2
	ln1_2 -> k_proj_2_2
	ln1_2 -> v_proj_2_2
	q_proj_2_2 -> attn_2_2
	k_proj_2_2 -> attn_2_2
	v_proj_2_2 -> attn_2_2
	attn_2_2 -> concat_dim_2
	ln1_2 -> q_proj_2_3
	ln1_2 -> k_proj_2_3
	ln1_2 -> v_proj_2_3
	q_proj_2_3 -> attn_2_3
	k_proj_2_3 -> attn_2_3
	v_proj_2_3 -> attn_2_3
	attn_2_3 -> concat_dim_2
	concat_dim_2 -> concat_heads
	pos_enc -> ln1_3
	ln1_3 -> q_proj_3_0
	ln1_3 -> k_proj_3_0
	ln1_3 -> v_proj_3_0
	q_proj_3_0 -> attn_3_0
	k_proj_3_0 -> attn_3_0
	v_proj_3_0 -> attn_3_0
	attn_3_0 -> concat_dim_3
	ln1_3 -> q_proj_3_1
	ln1_3 -> k_proj_3_1
	ln1_3 -> v_proj_3_1
	q_proj_3_1 -> attn_3_1
	k_proj_3_1 -> attn_3_1
	v_proj_3_1 -> attn_3_1
	attn_3_1 -> concat_dim_3
	ln1_3 -> q_proj_3_2
	ln1_3 -> k_proj_3_2
	ln1_3 -> v_proj_3_2
	q_proj_3_2 -> attn_3_2
	k_proj_3_2 -> attn_3_2
	v_proj_3_2 -> attn_3_2
	attn_3_2 -> concat_dim_3
	ln1_3 -> q_proj_3_3
	ln1_3 -> k_proj_3_3
	ln1_3 -> v_proj_3_3
	q_proj_3_3 -> attn_3_3
	k_proj_3_3 -> attn_3_3
	v_proj_3_3 -> attn_3_3
	attn_3_3 -> concat_dim_3
	concat_dim_3 -> concat_heads
	concat_heads -> out_proj
	out_proj -> residual1
	pos_enc -> residual1
	residual1 -> ln2
	ln2 -> mlp_linear1_0
	mlp_linear1_0 -> mlp_gelu_0
	mlp_gelu_0 -> mlp_linear2_0
	mlp_linear2_0 -> mlp_agg
	ln2 -> mlp_linear1_1
	mlp_linear1_1 -> mlp_gelu_1
	mlp_gelu_1 -> mlp_linear2_1
	mlp_linear2_1 -> mlp_agg
	ln2 -> mlp_linear1_2
	mlp_linear1_2 -> mlp_gelu_2
	mlp_gelu_2 -> mlp_linear2_2
	mlp_linear2_2 -> mlp_agg
	ln2 -> mlp_linear1_3
	mlp_linear1_3 -> mlp_gelu_3
	mlp_gelu_3 -> mlp_linear2_3
	mlp_linear2_3 -> mlp_agg
	ln2 -> mlp_linear1_4
	mlp_linear1_4 -> mlp_gelu_4
	mlp_gelu_4 -> mlp_linear2_4
	mlp_linear2_4 -> mlp_agg
	ln2 -> mlp_linear1_5
	mlp_linear1_5 -> mlp_gelu_5
	mlp_gelu_5 -> mlp_linear2_5
	mlp_linear2_5 -> mlp_agg
	ln2 -> mlp_linear1_6
	mlp_linear1_6 -> mlp_gelu_6
	mlp_gelu_6 -> mlp_linear2_6
	mlp_linear2_6 -> mlp_agg
	ln2 -> mlp_linear1_7
	mlp_linear1_7 -> mlp_gelu_7
	mlp_gelu_7 -> mlp_linear2_7
	mlp_linear2_7 -> mlp_agg
	ln2 -> mlp_linear1_8
	mlp_linear1_8 -> mlp_gelu_8
	mlp_gelu_8 -> mlp_linear2_8
	mlp_linear2_8 -> mlp_agg
	ln2 -> mlp_linear1_9
	mlp_linear1_9 -> mlp_gelu_9
	mlp_gelu_9 -> mlp_linear2_9
	mlp_linear2_9 -> mlp_agg
	ln2 -> mlp_linear1_10
	mlp_linear1_10 -> mlp_gelu_10
	mlp_gelu_10 -> mlp_linear2_10
	mlp_linear2_10 -> mlp_agg
	ln2 -> mlp_linear1_11
	mlp_linear1_11 -> mlp_gelu_11
	mlp_gelu_11 -> mlp_linear2_11
	mlp_linear2_11 -> mlp_agg
	ln2 -> mlp_linear1_12
	mlp_linear1_12 -> mlp_gelu_12
	mlp_gelu_12 -> mlp_linear2_12
	mlp_linear2_12 -> mlp_agg
	ln2 -> mlp_linear1_13
	mlp_linear1_13 -> mlp_gelu_13
	mlp_gelu_13 -> mlp_linear2_13
	mlp_linear2_13 -> mlp_agg
	ln2 -> mlp_linear1_14
	mlp_linear1_14 -> mlp_gelu_14
	mlp_gelu_14 -> mlp_linear2_14
	mlp_linear2_14 -> mlp_agg
	ln2 -> mlp_linear1_15
	mlp_linear1_15 -> mlp_gelu_15
	mlp_gelu_15 -> mlp_linear2_15
	mlp_linear2_15 -> mlp_agg
	mlp_agg -> residual2
	residual1 -> residual2
	residual2 -> ln2_0
	ln2_0 -> q_proj_2_0_0
	ln2_0 -> k_proj_2_0_0
	ln2_0 -> v_proj_2_0_0
	q_proj_2_0_0 -> attn_2_0_0
	k_proj_2_0_0 -> attn_2_0_0
	v_proj_2_0_0 -> attn_2_0_0
	attn_2_0_0 -> concat_dim_2_0
	ln2_0 -> q_proj_2_0_1
	ln2_0 -> k_proj_2_0_1
	ln2_0 -> v_proj_2_0_1
	q_proj_2_0_1 -> attn_2_0_1
	k_proj_2_0_1 -> attn_2_0_1
	v_proj_2_0_1 -> attn_2_0_1
	attn_2_0_1 -> concat_dim_2_0
	ln2_0 -> q_proj_2_0_2
	ln2_0 -> k_proj_2_0_2
	ln2_0 -> v_proj_2_0_2
	q_proj_2_0_2 -> attn_2_0_2
	k_proj_2_0_2 -> attn_2_0_2
	v_proj_2_0_2 -> attn_2_0_2
	attn_2_0_2 -> concat_dim_2_0
	ln2_0 -> q_proj_2_0_3
	ln2_0 -> k_proj_2_0_3
	ln2_0 -> v_proj_2_0_3
	q_proj_2_0_3 -> attn_2_0_3
	k_proj_2_0_3 -> attn_2_0_3
	v_proj_2_0_3 -> attn_2_0_3
	attn_2_0_3 -> concat_dim_2_0
	concat_dim_2_0 -> concat_heads_2
	residual2 -> ln2_1
	ln2_1 -> q_proj_2_1_0
	ln2_1 -> k_proj_2_1_0
	ln2_1 -> v_proj_2_1_0
	q_proj_2_1_0 -> attn_2_1_0
	k_proj_2_1_0 -> attn_2_1_0
	v_proj_2_1_0 -> attn_2_1_0
	attn_2_1_0 -> concat_dim_2_1
	ln2_1 -> q_proj_2_1_1
	ln2_1 -> k_proj_2_1_1
	ln2_1 -> v_proj_2_1_1
	q_proj_2_1_1 -> attn_2_1_1
	k_proj_2_1_1 -> attn_2_1_1
	v_proj_2_1_1 -> attn_2_1_1
	attn_2_1_1 -> concat_dim_2_1
	ln2_1 -> q_proj_2_1_2
	ln2_1 -> k_proj_2_1_2
	ln2_1 -> v_proj_2_1_2
	q_proj_2_1_2 -> attn_2_1_2
	k_proj_2_1_2 -> attn_2_1_2
	v_proj_2_1_2 -> attn_2_1_2
	attn_2_1_2 -> concat_dim_2_1
	ln2_1 -> q_proj_2_1_3
	ln2_1 -> k_proj_2_1_3
	ln2_1 -> v_proj_2_1_3
	q_proj_2_1_3 -> attn_2_1_3
	k_proj_2_1_3 -> attn_2_1_3
	v_proj_2_1_3 -> attn_2_1_3
	attn_2_1_3 -> concat_dim_2_1
	concat_dim_2_1 -> concat_heads_2
	residual2 -> ln2_2
	ln2_2 -> q_proj_2_2_0
	ln2_2 -> k_proj_2_2_0
	ln2_2 -> v_proj_2_2_0
	q_proj_2_2_0 -> attn_2_2_0
	k_proj_2_2_0 -> attn_2_2_0
	v_proj_2_2_0 -> attn_2_2_0
	attn_2_2_0 -> concat_dim_2_2
	ln2_2 -> q_proj_2_2_1
	ln2_2 -> k_proj_2_2_1
	ln2_2 -> v_proj_2_2_1
	q_proj_2_2_1 -> attn_2_2_1
	k_proj_2_2_1 -> attn_2_2_1
	v_proj_2_2_1 -> attn_2_2_1
	attn_2_2_1 -> concat_dim_2_2
	ln2_2 -> q_proj_2_2_2
	ln2_2 -> k_proj_2_2_2
	ln2_2 -> v_proj_2_2_2
	q_proj_2_2_2 -> attn_2_2_2
	k_proj_2_2_2 -> attn_2_2_2
	v_proj_2_2_2 -> attn_2_2_2
	attn_2_2_2 -> concat_dim_2_2
	ln2_2 -> q_proj_2_2_3
	ln2_2 -> k_proj_2_2_3
	ln2_2 -> v_proj_2_2_3
	q_proj_2_2_3 -> attn_2_2_3
	k_proj_2_2_3 -> attn_2_2_3
	v_proj_2_2_3 -> attn_2_2_3
	attn_2_2_3 -> concat_dim_2_2
	concat_dim_2_2 -> concat_heads_2
	residual2 -> ln2_3
	ln2_3 -> q_proj_2_3_0
	ln2_3 -> k_proj_2_3_0
	ln2_3 -> v_proj_2_3_0
	q_proj_2_3_0 -> attn_2_3_0
	k_proj_2_3_0 -> attn_2_3_0
	v_proj_2_3_0 -> attn_2_3_0
	attn_2_3_0 -> concat_dim_2_3
	ln2_3 -> q_proj_2_3_1
	ln2_3 -> k_proj_2_3_1
	ln2_3 -> v_proj_2_3_1
	q_proj_2_3_1 -> attn_2_3_1
	k_proj_2_3_1 -> attn_2_3_1
	v_proj_2_3_1 -> attn_2_3_1
	attn_2_3_1 -> concat_dim_2_3
	ln2_3 -> q_proj_2_3_2
	ln2_3 -> k_proj_2_3_2
	ln2_3 -> v_proj_2_3_2
	q_proj_2_3_2 -> attn_2_3_2
	k_proj_2_3_2 -> attn_2_3_2
	v_proj_2_3_2 -> attn_2_3_2
	attn_2_3_2 -> concat_dim_2_3
	ln2_3 -> q_proj_2_3_3
	ln2_3 -> k_proj_2_3_3
	ln2_3 -> v_proj_2_3_3
	q_proj_2_3_3 -> attn_2_3_3
	k_proj_2_3_3 -> attn_2_3_3
	v_proj_2_3_3 -> attn_2_3_3
	attn_2_3_3 -> concat_dim_2_3
	concat_dim_2_3 -> concat_heads_2
	concat_heads_2 -> out_proj_2
	out_proj_2 -> residual2_1
	residual2 -> residual2_1
	residual2_1 -> ln2_mlp
	ln2_mlp -> mlp_linear1_2_0
	mlp_linear1_2_0 -> mlp_gelu_2_0
	mlp_gelu_2_0 -> mlp_linear2_2_0
	mlp_linear2_2_0 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_1
	mlp_linear1_2_1 -> mlp_gelu_2_1
	mlp_gelu_2_1 -> mlp_linear2_2_1
	mlp_linear2_2_1 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_2
	mlp_linear1_2_2 -> mlp_gelu_2_2
	mlp_gelu_2_2 -> mlp_linear2_2_2
	mlp_linear2_2_2 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_3
	mlp_linear1_2_3 -> mlp_gelu_2_3
	mlp_gelu_2_3 -> mlp_linear2_2_3
	mlp_linear2_2_3 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_4
	mlp_linear1_2_4 -> mlp_gelu_2_4
	mlp_gelu_2_4 -> mlp_linear2_2_4
	mlp_linear2_2_4 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_5
	mlp_linear1_2_5 -> mlp_gelu_2_5
	mlp_gelu_2_5 -> mlp_linear2_2_5
	mlp_linear2_2_5 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_6
	mlp_linear1_2_6 -> mlp_gelu_2_6
	mlp_gelu_2_6 -> mlp_linear2_2_6
	mlp_linear2_2_6 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_7
	mlp_linear1_2_7 -> mlp_gelu_2_7
	mlp_gelu_2_7 -> mlp_linear2_2_7
	mlp_linear2_2_7 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_8
	mlp_linear1_2_8 -> mlp_gelu_2_8
	mlp_gelu_2_8 -> mlp_linear2_2_8
	mlp_linear2_2_8 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_9
	mlp_linear1_2_9 -> mlp_gelu_2_9
	mlp_gelu_2_9 -> mlp_linear2_2_9
	mlp_linear2_2_9 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_10
	mlp_linear1_2_10 -> mlp_gelu_2_10
	mlp_gelu_2_10 -> mlp_linear2_2_10
	mlp_linear2_2_10 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_11
	mlp_linear1_2_11 -> mlp_gelu_2_11
	mlp_gelu_2_11 -> mlp_linear2_2_11
	mlp_linear2_2_11 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_12
	mlp_linear1_2_12 -> mlp_gelu_2_12
	mlp_gelu_2_12 -> mlp_linear2_2_12
	mlp_linear2_2_12 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_13
	mlp_linear1_2_13 -> mlp_gelu_2_13
	mlp_gelu_2_13 -> mlp_linear2_2_13
	mlp_linear2_2_13 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_14
	mlp_linear1_2_14 -> mlp_gelu_2_14
	mlp_gelu_2_14 -> mlp_linear2_2_14
	mlp_linear2_2_14 -> mlp_agg_2
	ln2_mlp -> mlp_linear1_2_15
	mlp_linear1_2_15 -> mlp_gelu_2_15
	mlp_gelu_2_15 -> mlp_linear2_2_15
	mlp_linear2_2_15 -> mlp_agg_2
	mlp_agg_2 -> residual2_2
	residual2_1 -> residual2_2
	residual2_2 -> ln3_0
	ln3_0 -> q_proj_3_0_0
	ln3_0 -> k_proj_3_0_0
	ln3_0 -> v_proj_3_0_0
	q_proj_3_0_0 -> attn_3_0_0
	k_proj_3_0_0 -> attn_3_0_0
	v_proj_3_0_0 -> attn_3_0_0
	attn_3_0_0 -> concat_dim_3_0
	ln3_0 -> q_proj_3_0_1
	ln3_0 -> k_proj_3_0_1
	ln3_0 -> v_proj_3_0_1
	q_proj_3_0_1 -> attn_3_0_1
	k_proj_3_0_1 -> attn_3_0_1
	v_proj_3_0_1 -> attn_3_0_1
	attn_3_0_1 -> concat_dim_3_0
	ln3_0 -> q_proj_3_0_2
	ln3_0 -> k_proj_3_0_2
	ln3_0 -> v_proj_3_0_2
	q_proj_3_0_2 -> attn_3_0_2
	k_proj_3_0_2 -> attn_3_0_2
	v_proj_3_0_2 -> attn_3_0_2
	attn_3_0_2 -> concat_dim_3_0
	ln3_0 -> q_proj_3_0_3
	ln3_0 -> k_proj_3_0_3
	ln3_0 -> v_proj_3_0_3
	q_proj_3_0_3 -> attn_3_0_3
	k_proj_3_0_3 -> attn_3_0_3
	v_proj_3_0_3 -> attn_3_0_3
	attn_3_0_3 -> concat_dim_3_0
	concat_dim_3_0 -> concat_heads_3
	residual2_2 -> ln3_1
	ln3_1 -> q_proj_3_1_0
	ln3_1 -> k_proj_3_1_0
	ln3_1 -> v_proj_3_1_0
	q_proj_3_1_0 -> attn_3_1_0
	k_proj_3_1_0 -> attn_3_1_0
	v_proj_3_1_0 -> attn_3_1_0
	attn_3_1_0 -> concat_dim_3_1
	ln3_1 -> q_proj_3_1_1
	ln3_1 -> k_proj_3_1_1
	ln3_1 -> v_proj_3_1_1
	q_proj_3_1_1 -> attn_3_1_1
	k_proj_3_1_1 -> attn_3_1_1
	v_proj_3_1_1 -> attn_3_1_1
	attn_3_1_1 -> concat_dim_3_1
	ln3_1 -> q_proj_3_1_2
	ln3_1 -> k_proj_3_1_2
	ln3_1 -> v_proj_3_1_2
	q_proj_3_1_2 -> attn_3_1_2
	k_proj_3_1_2 -> attn_3_1_2
	v_proj_3_1_2 -> attn_3_1_2
	attn_3_1_2 -> concat_dim_3_1
	ln3_1 -> q_proj_3_1_3
	ln3_1 -> k_proj_3_1_3
	ln3_1 -> v_proj_3_1_3
	q_proj_3_1_3 -> attn_3_1_3
	k_proj_3_1_3 -> attn_3_1_3
	v_proj_3_1_3 -> attn_3_1_3
	attn_3_1_3 -> concat_dim_3_1
	concat_dim_3_1 -> concat_heads_3
	residual2_2 -> ln3_2
	ln3_2 -> q_proj_3_2_0
	ln3_2 -> k_proj_3_2_0
	ln3_2 -> v_proj_3_2_0
	q_proj_3_2_0 -> attn_3_2_0
	k_proj_3_2_0 -> attn_3_2_0
	v_proj_3_2_0 -> attn_3_2_0
	attn_3_2_0 -> concat_dim_3_2
	ln3_2 -> q_proj_3_2_1
	ln3_2 -> k_proj_3_2_1
	ln3_2 -> v_proj_3_2_1
	q_proj_3_2_1 -> attn_3_2_1
	k_proj_3_2_1 -> attn_3_2_1
	v_proj_3_2_1 -> attn_3_2_1
	attn_3_2_1 -> concat_dim_3_2
	ln3_2 -> q_proj_3_2_2
	ln3_2 -> k_proj_3_2_2
	ln3_2 -> v_proj_3_2_2
	q_proj_3_2_2 -> attn_3_2_2
	k_proj_3_2_2 -> attn_3_2_2
	v_proj_3_2_2 -> attn_3_2_2
	attn_3_2_2 -> concat_dim_3_2
	ln3_2 -> q_proj_3_2_3
	ln3_2 -> k_proj_3_2_3
	ln3_2 -> v_proj_3_2_3
	q_proj_3_2_3 -> attn_3_2_3
	k_proj_3_2_3 -> attn_3_2_3
	v_proj_3_2_3 -> attn_3_2_3
	attn_3_2_3 -> concat_dim_3_2
	concat_dim_3_2 -> concat_heads_3
	residual2_2 -> ln3_3
	ln3_3 -> q_proj_3_3_0
	ln3_3 -> k_proj_3_3_0
	ln3_3 -> v_proj_3_3_0
	q_proj_3_3_0 -> attn_3_3_0
	k_proj_3_3_0 -> attn_3_3_0
	v_proj_3_3_0 -> attn_3_3_0
	attn_3_3_0 -> concat_dim_3_3
	ln3_3 -> q_proj_3_3_1
	ln3_3 -> k_proj_3_3_1
	ln3_3 -> v_proj_3_3_1
	q_proj_3_3_1 -> attn_3_3_1
	k_proj_3_3_1 -> attn_3_3_1
	v_proj_3_3_1 -> attn_3_3_1
	attn_3_3_1 -> concat_dim_3_3
	ln3_3 -> q_proj_3_3_2
	ln3_3 -> k_proj_3_3_2
	ln3_3 -> v_proj_3_3_2
	q_proj_3_3_2 -> attn_3_3_2
	k_proj_3_3_2 -> attn_3_3_2
	v_proj_3_3_2 -> attn_3_3_2
	attn_3_3_2 -> concat_dim_3_3
	ln3_3 -> q_proj_3_3_3
	ln3_3 -> k_proj_3_3_3
	ln3_3 -> v_proj_3_3_3
	q_proj_3_3_3 -> attn_3_3_3
	k_proj_3_3_3 -> attn_3_3_3
	v_proj_3_3_3 -> attn_3_3_3
	attn_3_3_3 -> concat_dim_3_3
	concat_dim_3_3 -> concat_heads_3
	concat_heads_3 -> out_proj_3
	out_proj_3 -> residual3_1
	residual2_2 -> residual3_1
	residual3_1 -> ln3_mlp
	ln3_mlp -> mlp_linear1_3_0
	mlp_linear1_3_0 -> mlp_gelu_3_0
	mlp_gelu_3_0 -> mlp_linear2_3_0
	mlp_linear2_3_0 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_1
	mlp_linear1_3_1 -> mlp_gelu_3_1
	mlp_gelu_3_1 -> mlp_linear2_3_1
	mlp_linear2_3_1 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_2
	mlp_linear1_3_2 -> mlp_gelu_3_2
	mlp_gelu_3_2 -> mlp_linear2_3_2
	mlp_linear2_3_2 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_3
	mlp_linear1_3_3 -> mlp_gelu_3_3
	mlp_gelu_3_3 -> mlp_linear2_3_3
	mlp_linear2_3_3 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_4
	mlp_linear1_3_4 -> mlp_gelu_3_4
	mlp_gelu_3_4 -> mlp_linear2_3_4
	mlp_linear2_3_4 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_5
	mlp_linear1_3_5 -> mlp_gelu_3_5
	mlp_gelu_3_5 -> mlp_linear2_3_5
	mlp_linear2_3_5 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_6
	mlp_linear1_3_6 -> mlp_gelu_3_6
	mlp_gelu_3_6 -> mlp_linear2_3_6
	mlp_linear2_3_6 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_7
	mlp_linear1_3_7 -> mlp_gelu_3_7
	mlp_gelu_3_7 -> mlp_linear2_3_7
	mlp_linear2_3_7 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_8
	mlp_linear1_3_8 -> mlp_gelu_3_8
	mlp_gelu_3_8 -> mlp_linear2_3_8
	mlp_linear2_3_8 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_9
	mlp_linear1_3_9 -> mlp_gelu_3_9
	mlp_gelu_3_9 -> mlp_linear2_3_9
	mlp_linear2_3_9 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_10
	mlp_linear1_3_10 -> mlp_gelu_3_10
	mlp_gelu_3_10 -> mlp_linear2_3_10
	mlp_linear2_3_10 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_11
	mlp_linear1_3_11 -> mlp_gelu_3_11
	mlp_gelu_3_11 -> mlp_linear2_3_11
	mlp_linear2_3_11 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_12
	mlp_linear1_3_12 -> mlp_gelu_3_12
	mlp_gelu_3_12 -> mlp_linear2_3_12
	mlp_linear2_3_12 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_13
	mlp_linear1_3_13 -> mlp_gelu_3_13
	mlp_gelu_3_13 -> mlp_linear2_3_13
	mlp_linear2_3_13 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_14
	mlp_linear1_3_14 -> mlp_gelu_3_14
	mlp_gelu_3_14 -> mlp_linear2_3_14
	mlp_linear2_3_14 -> mlp_agg_3
	ln3_mlp -> mlp_linear1_3_15
	mlp_linear1_3_15 -> mlp_gelu_3_15
	mlp_gelu_3_15 -> mlp_linear2_3_15
	mlp_linear2_3_15 -> mlp_agg_3
	mlp_agg_3 -> residual3_2
	residual3_1 -> residual3_2
	residual3_2 -> ln4_0
	ln4_0 -> q_proj_4_0_0
	ln4_0 -> k_proj_4_0_0
	ln4_0 -> v_proj_4_0_0
	q_proj_4_0_0 -> attn_4_0_0
	k_proj_4_0_0 -> attn_4_0_0
	v_proj_4_0_0 -> attn_4_0_0
	attn_4_0_0 -> concat_dim_4_0
	ln4_0 -> q_proj_4_0_1
	ln4_0 -> k_proj_4_0_1
	ln4_0 -> v_proj_4_0_1
	q_proj_4_0_1 -> attn_4_0_1
	k_proj_4_0_1 -> attn_4_0_1
	v_proj_4_0_1 -> attn_4_0_1
	attn_4_0_1 -> concat_dim_4_0
	ln4_0 -> q_proj_4_0_2
	ln4_0 -> k_proj_4_0_2
	ln4_0 -> v_proj_4_0_2
	q_proj_4_0_2 -> attn_4_0_2
	k_proj_4_0_2 -> attn_4_0_2
	v_proj_4_0_2 -> attn_4_0_2
	attn_4_0_2 -> concat_dim_4_0
	ln4_0 -> q_proj_4_0_3
	ln4_0 -> k_proj_4_0_3
	ln4_0 -> v_proj_4_0_3
	q_proj_4_0_3 -> attn_4_0_3
	k_proj_4_0_3 -> attn_4_0_3
	v_proj_4_0_3 -> attn_4_0_3
	attn_4_0_3 -> concat_dim_4_0
	concat_dim_4_0 -> concat_heads_4
	residual3_2 -> ln4_1
	ln4_1 -> q_proj_4_1_0
	ln4_1 -> k_proj_4_1_0
	ln4_1 -> v_proj_4_1_0
	q_proj_4_1_0 -> attn_4_1_0
	k_proj_4_1_0 -> attn_4_1_0
	v_proj_4_1_0 -> attn_4_1_0
	attn_4_1_0 -> concat_dim_4_1
	ln4_1 -> q_proj_4_1_1
	ln4_1 -> k_proj_4_1_1
	ln4_1 -> v_proj_4_1_1
	q_proj_4_1_1 -> attn_4_1_1
	k_proj_4_1_1 -> attn_4_1_1
	v_proj_4_1_1 -> attn_4_1_1
	attn_4_1_1 -> concat_dim_4_1
	ln4_1 -> q_proj_4_1_2
	ln4_1 -> k_proj_4_1_2
	ln4_1 -> v_proj_4_1_2
	q_proj_4_1_2 -> attn_4_1_2
	k_proj_4_1_2 -> attn_4_1_2
	v_proj_4_1_2 -> attn_4_1_2
	attn_4_1_2 -> concat_dim_4_1
	ln4_1 -> q_proj_4_1_3
	ln4_1 -> k_proj_4_1_3
	ln4_1 -> v_proj_4_1_3
	q_proj_4_1_3 -> attn_4_1_3
	k_proj_4_1_3 -> attn_4_1_3
	v_proj_4_1_3 -> attn_4_1_3
	attn_4_1_3 -> concat_dim_4_1
	concat_dim_4_1 -> concat_heads_4
	residual3_2 -> ln4_2
	ln4_2 -> q_proj_4_2_0
	ln4_2 -> k_proj_4_2_0
	ln4_2 -> v_proj_4_2_0
	q_proj_4_2_0 -> attn_4_2_0
	k_proj_4_2_0 -> attn_4_2_0
	v_proj_4_2_0 -> attn_4_2_0
	attn_4_2_0 -> concat_dim_4_2
	ln4_2 -> q_proj_4_2_1
	ln4_2 -> k_proj_4_2_1
	ln4_2 -> v_proj_4_2_1
	q_proj_4_2_1 -> attn_4_2_1
	k_proj_4_2_1 -> attn_4_2_1
	v_proj_4_2_1 -> attn_4_2_1
	attn_4_2_1 -> concat_dim_4_2
	ln4_2 -> q_proj_4_2_2
	ln4_2 -> k_proj_4_2_2
	ln4_2 -> v_proj_4_2_2
	q_proj_4_2_2 -> attn_4_2_2
	k_proj_4_2_2 -> attn_4_2_2
	v_proj_4_2_2 -> attn_4_2_2
	attn_4_2_2 -> concat_dim_4_2
	ln4_2 -> q_proj_4_2_3
	ln4_2 -> k_proj_4_2_3
	ln4_2 -> v_proj_4_2_3
	q_proj_4_2_3 -> attn_4_2_3
	k_proj_4_2_3 -> attn_4_2_3
	v_proj_4_2_3 -> attn_4_2_3
	attn_4_2_3 -> concat_dim_4_2
	concat_dim_4_2 -> concat_heads_4
	residual3_2 -> ln4_3
	ln4_3 -> q_proj_4_3_0
	ln4_3 -> k_proj_4_3_0
	ln4_3 -> v_proj_4_3_0
	q_proj_4_3_0 -> attn_4_3_0
	k_proj_4_3_0 -> attn_4_3_0
	v_proj_4_3_0 -> attn_4_3_0
	attn_4_3_0 -> concat_dim_4_3
	ln4_3 -> q_proj_4_3_1
	ln4_3 -> k_proj_4_3_1
	ln4_3 -> v_proj_4_3_1
	q_proj_4_3_1 -> attn_4_3_1
	k_proj_4_3_1 -> attn_4_3_1
	v_proj_4_3_1 -> attn_4_3_1
	attn_4_3_1 -> concat_dim_4_3
	ln4_3 -> q_proj_4_3_2
	ln4_3 -> k_proj_4_3_2
	ln4_3 -> v_proj_4_3_2
	q_proj_4_3_2 -> attn_4_3_2
	k_proj_4_3_2 -> attn_4_3_2
	v_proj_4_3_2 -> attn_4_3_2
	attn_4_3_2 -> concat_dim_4_3
	ln4_3 -> q_proj_4_3_3
	ln4_3 -> k_proj_4_3_3
	ln4_3 -> v_proj_4_3_3
	q_proj_4_3_3 -> attn_4_3_3
	k_proj_4_3_3 -> attn_4_3_3
	v_proj_4_3_3 -> attn_4_3_3
	attn_4_3_3 -> concat_dim_4_3
	concat_dim_4_3 -> concat_heads_4
	concat_heads_4 -> out_proj_4
	out_proj_4 -> residual4_1
	residual3_2 -> residual4_1
	residual4_1 -> ln4_mlp
	ln4_mlp -> mlp_linear1_4_0
	mlp_linear1_4_0 -> mlp_gelu_4_0
	mlp_gelu_4_0 -> mlp_linear2_4_0
	mlp_linear2_4_0 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_1
	mlp_linear1_4_1 -> mlp_gelu_4_1
	mlp_gelu_4_1 -> mlp_linear2_4_1
	mlp_linear2_4_1 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_2
	mlp_linear1_4_2 -> mlp_gelu_4_2
	mlp_gelu_4_2 -> mlp_linear2_4_2
	mlp_linear2_4_2 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_3
	mlp_linear1_4_3 -> mlp_gelu_4_3
	mlp_gelu_4_3 -> mlp_linear2_4_3
	mlp_linear2_4_3 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_4
	mlp_linear1_4_4 -> mlp_gelu_4_4
	mlp_gelu_4_4 -> mlp_linear2_4_4
	mlp_linear2_4_4 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_5
	mlp_linear1_4_5 -> mlp_gelu_4_5
	mlp_gelu_4_5 -> mlp_linear2_4_5
	mlp_linear2_4_5 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_6
	mlp_linear1_4_6 -> mlp_gelu_4_6
	mlp_gelu_4_6 -> mlp_linear2_4_6
	mlp_linear2_4_6 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_7
	mlp_linear1_4_7 -> mlp_gelu_4_7
	mlp_gelu_4_7 -> mlp_linear2_4_7
	mlp_linear2_4_7 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_8
	mlp_linear1_4_8 -> mlp_gelu_4_8
	mlp_gelu_4_8 -> mlp_linear2_4_8
	mlp_linear2_4_8 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_9
	mlp_linear1_4_9 -> mlp_gelu_4_9
	mlp_gelu_4_9 -> mlp_linear2_4_9
	mlp_linear2_4_9 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_10
	mlp_linear1_4_10 -> mlp_gelu_4_10
	mlp_gelu_4_10 -> mlp_linear2_4_10
	mlp_linear2_4_10 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_11
	mlp_linear1_4_11 -> mlp_gelu_4_11
	mlp_gelu_4_11 -> mlp_linear2_4_11
	mlp_linear2_4_11 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_12
	mlp_linear1_4_12 -> mlp_gelu_4_12
	mlp_gelu_4_12 -> mlp_linear2_4_12
	mlp_linear2_4_12 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_13
	mlp_linear1_4_13 -> mlp_gelu_4_13
	mlp_gelu_4_13 -> mlp_linear2_4_13
	mlp_linear2_4_13 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_14
	mlp_linear1_4_14 -> mlp_gelu_4_14
	mlp_gelu_4_14 -> mlp_linear2_4_14
	mlp_linear2_4_14 -> mlp_agg_4
	ln4_mlp -> mlp_linear1_4_15
	mlp_linear1_4_15 -> mlp_gelu_4_15
	mlp_gelu_4_15 -> mlp_linear2_4_15
	mlp_linear2_4_15 -> mlp_agg_4
	mlp_agg_4 -> residual4_2
	residual4_1 -> residual4_2
	residual4_2 -> final_ln
	final_ln -> lm_head
	lm_head -> output
}
