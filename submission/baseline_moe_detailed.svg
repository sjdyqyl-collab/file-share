<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: baseline_moe_detailed Pages: 1 -->
<svg width="2880pt" height="36pt"
 viewBox="0.00 0.00 2880.00 36.19" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.02 0.02) rotate(0) translate(4 1488)">
<title>baseline_moe_detailed</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1488 118736.66,-1488 118736.66,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_layer1</title>
<polygon fill="none" stroke="black" points="8,-8 8,-1262 18068,-1262 18068,-8 8,-8"/>
<text text-anchor="middle" x="9038" y="-1246.8" font-family="Times,serif" font-size="14.00">Layer 1 (16 experts total, 4 experts/GPU)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_layer1_stage1</title>
<polygon fill="none" stroke="black" points="1718,-230 1718,-1231 18060,-1231 18060,-230 1718,-230"/>
<text text-anchor="middle" x="9889" y="-1215.8" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 0&#45;7)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer1_stage2</title>
<polygon fill="none" stroke="black" points="16,-16 16,-161 18060,-161 18060,-16 16,-16"/>
<text text-anchor="middle" x="9038" y="-145.8" font-family="Times,serif" font-size="14.00">Stage 2 (GPUs 8&#45;15)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" points="10077,-1292 10077,-1476 46167,-1476 46167,-1292 10077,-1292"/>
<text text-anchor="middle" x="28122" y="-1460.8" font-family="Times,serif" font-size="14.00">Layer 2 (16 experts total, 4 experts/GPU)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_layer2_stage1</title>
<polygon fill="none" stroke="black" points="28171,-1300 28171,-1445 46159,-1445 46159,-1300 28171,-1300"/>
<text text-anchor="middle" x="37165" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 0&#45;7)</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_layer2_stage2</title>
<polygon fill="none" stroke="black" points="10085,-1300 10085,-1445 28129,-1445 28129,-1300 10085,-1300"/>
<text text-anchor="middle" x="19107" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 2 (GPUs 8&#45;15)</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="black" points="46193,-1292 46193,-1476 82283,-1476 82283,-1292 46193,-1292"/>
<text text-anchor="middle" x="64238" y="-1460.8" font-family="Times,serif" font-size="14.00">Layer 3 (16 experts total, 4 experts/GPU)</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer3_stage1</title>
<polygon fill="none" stroke="black" points="64287,-1300 64287,-1445 82275,-1445 82275,-1300 64287,-1300"/>
<text text-anchor="middle" x="73281" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 0&#45;7)</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_layer3_stage2</title>
<polygon fill="none" stroke="black" points="46201,-1300 46201,-1445 64245,-1445 64245,-1300 46201,-1300"/>
<text text-anchor="middle" x="55223" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 2 (GPUs 8&#45;15)</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_layer4</title>
<polygon fill="none" stroke="black" points="82309,-1292 82309,-1476 118399,-1476 118399,-1292 82309,-1292"/>
<text text-anchor="middle" x="100354" y="-1460.8" font-family="Times,serif" font-size="14.00">Layer 4 (16 experts total, 4 experts/GPU)</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer4_stage1</title>
<polygon fill="none" stroke="black" points="100403,-1300 100403,-1445 118391,-1445 118391,-1300 100403,-1300"/>
<text text-anchor="middle" x="109397" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 1 (GPUs 0&#45;7)</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_layer4_stage2</title>
<polygon fill="none" stroke="black" points="82317,-1300 82317,-1445 100361,-1445 100361,-1300 82317,-1300"/>
<text text-anchor="middle" x="91339" y="-1429.8" font-family="Times,serif" font-size="14.00">Stage 2 (GPUs 8&#45;15)</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="lightcoral" stroke="black" cx="9889" cy="-1361" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="9889" y="-1372.3" font-family="Times,serif" font-size="14.00">Model Input</text>
<text text-anchor="middle" x="9889" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="9889" y="-1342.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
<!-- l1_s1_attn -->
<g id="node2" class="node">
<title>l1_s1_attn</title>
<polygon fill="lightblue" stroke="black" points="9889,-1200 9683,-1147 9889,-1094 10095,-1147 9889,-1200"/>
<text text-anchor="middle" x="9889" y="-1158.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="9889" y="-1143.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="9889" y="-1128.3" font-family="Times,serif" font-size="14.00">TP across GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;l1_s1_attn -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l1_s1_attn</title>
<path fill="none" stroke="black" d="M9889,-1323.07C9889,-1292.06 9889,-1247.07 9889,-1210.47"/>
<polygon fill="black" stroke="black" points="9892.5,-1210.39 9889,-1200.39 9885.5,-1210.39 9892.5,-1210.39"/>
</g>
<!-- l1_s1_route -->
<g id="node3" class="node">
<title>l1_s1_route</title>
<polygon fill="orange" stroke="black" points="10037.01,-986 9801.56,-986 9740.99,-880 9976.44,-880 10037.01,-986"/>
<text text-anchor="middle" x="9889" y="-944.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="9889" y="-929.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="9889" y="-914.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 0&#45;7</text>
</g>
<!-- l1_s1_attn&#45;&gt;l1_s1_route -->
<g id="edge2" class="edge">
<title>l1_s1_attn&#45;&gt;l1_s1_route</title>
<path fill="none" stroke="black" d="M9889,-1093.87C9889,-1064.46 9889,-1027.51 9889,-996.55"/>
<polygon fill="black" stroke="black" points="9892.5,-996.3 9889,-986.3 9885.5,-996.3 9892.5,-996.3"/>
</g>
<!-- l1_s1_gpu0_exp0 -->
<g id="node4" class="node">
<title>l1_s1_gpu0_exp0</title>
<polygon fill="lightblue" stroke="black" points="1953,-772 1726,-719 1953,-666 2180,-719 1953,-772"/>
<text text-anchor="middle" x="1953" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="1953" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="1953" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu0_exp0 -->
<g id="edge3" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.02,-930.81C8858.07,-921.55 2991.03,-858.86 2209,-772 2163.84,-766.98 2114.81,-757.93 2071.86,-748.76"/>
<polygon fill="black" stroke="black" points="2072.46,-745.31 2061.94,-746.62 2070.98,-752.15 2072.46,-745.31"/>
</g>
<!-- l1_s1_gpu0_exp1 -->
<g id="node5" class="node">
<title>l1_s1_gpu0_exp1</title>
<polygon fill="lightblue" stroke="black" points="2465,-772 2238,-719 2465,-666 2692,-719 2465,-772"/>
<text text-anchor="middle" x="2465" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="2465" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2465" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu0_exp1 -->
<g id="edge4" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.7,-932.24C8956.14,-933.5 4167.96,-933.8 2721,-772 2675.84,-766.95 2626.82,-757.89 2583.87,-748.73"/>
<polygon fill="black" stroke="black" points="2584.46,-745.27 2573.95,-746.59 2582.99,-752.12 2584.46,-745.27"/>
</g>
<!-- l1_s1_gpu0_exp2 -->
<g id="node6" class="node">
<title>l1_s1_gpu0_exp2</title>
<polygon fill="lightblue" stroke="black" points="2977,-772 2750,-719 2977,-666 3204,-719 2977,-772"/>
<text text-anchor="middle" x="2977" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2977" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="2977" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu0_exp2 -->
<g id="edge5" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.51,-932.01C8989.54,-931.64 4571.5,-922.84 3233,-772 3187.95,-766.92 3139.05,-757.88 3096.17,-748.75"/>
<polygon fill="black" stroke="black" points="3096.78,-745.3 3086.27,-746.61 3095.31,-752.14 3096.78,-745.3"/>
</g>
<!-- l1_s1_gpu0_exp3 -->
<g id="node7" class="node">
<title>l1_s1_gpu0_exp3</title>
<polygon fill="lightblue" stroke="black" points="3489,-772 3262,-719 3489,-666 3716,-719 3489,-772"/>
<text text-anchor="middle" x="3489" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3489" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="3489" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu0_exp3 -->
<g id="edge6" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.46,-931.73C9024.86,-929.64 4975.33,-911.89 3745,-772 3699.95,-766.88 3651.05,-757.83 3608.18,-748.7"/>
<polygon fill="black" stroke="black" points="3608.79,-745.25 3598.27,-746.56 3607.31,-752.09 3608.79,-745.25"/>
</g>
<!-- l1_s1_gpu1_exp0 -->
<g id="node8" class="node">
<title>l1_s1_gpu1_exp0</title>
<polygon fill="lightblue" stroke="black" points="4001,-772 3774,-719 4001,-666 4228,-719 4001,-772"/>
<text text-anchor="middle" x="4001" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4001" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4001" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu1_exp0 -->
<g id="edge7" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu1_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.18,-931.41C9060.93,-927.46 5379.25,-900.95 4257,-772 4211.96,-766.82 4163.06,-757.76 4120.18,-748.64"/>
<polygon fill="black" stroke="black" points="4120.79,-745.19 4110.28,-746.51 4119.32,-752.03 4120.79,-745.19"/>
</g>
<!-- l1_s1_gpu1_exp1 -->
<g id="node9" class="node">
<title>l1_s1_gpu1_exp1</title>
<polygon fill="lightblue" stroke="black" points="4513,-772 4286,-719 4513,-666 4740,-719 4513,-772"/>
<text text-anchor="middle" x="4513" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="4513" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="4513" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu1_exp1 -->
<g id="edge8" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770,-931.02C9099.13,-925.06 5783.49,-890.03 4769,-772 4724.07,-766.77 4675.3,-757.73 4632.49,-748.63"/>
<polygon fill="black" stroke="black" points="4633.11,-745.18 4622.6,-746.51 4631.64,-752.03 4633.11,-745.18"/>
</g>
<!-- l1_s1_gpu1_exp2 -->
<g id="node10" class="node">
<title>l1_s1_gpu1_exp2</title>
<polygon fill="lightblue" stroke="black" points="5025,-772 4798,-719 5025,-666 5252,-719 5025,-772"/>
<text text-anchor="middle" x="5025" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="5025" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5025" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu1_exp2 -->
<g id="edge9" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9769.77,-930.54C9139.22,-922.4 6188,-879.11 5281,-772 5236.08,-766.7 5187.31,-757.63 5144.5,-748.54"/>
<polygon fill="black" stroke="black" points="5145.12,-745.1 5134.61,-746.42 5143.65,-751.94 5145.12,-745.1"/>
</g>
<!-- l1_s1_gpu1_exp3 -->
<g id="node11" class="node">
<title>l1_s1_gpu1_exp3</title>
<polygon fill="lightblue" stroke="black" points="5537,-772 5310,-719 5537,-666 5764,-719 5537,-772"/>
<text text-anchor="middle" x="5537" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="5537" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="5537" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu1_exp3 -->
<g id="edge10" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9769.27,-929.93C9180.95,-919.38 6592.74,-868.21 5793,-772 5748.2,-766.61 5699.55,-757.56 5656.81,-748.5"/>
<polygon fill="black" stroke="black" points="5657.45,-745.05 5646.94,-746.38 5655.98,-751.9 5657.45,-745.05"/>
</g>
<!-- l1_s1_gpu2_exp0 -->
<g id="node12" class="node">
<title>l1_s1_gpu2_exp0</title>
<polygon fill="lightblue" stroke="black" points="6049,-772 5822,-719 6049,-666 6276,-719 6049,-772"/>
<text text-anchor="middle" x="6049" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="6049" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6049" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu2_exp0 -->
<g id="edge11" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9768.82,-929.15C9225.81,-915.91 6997.93,-857.32 6305,-772 6260.32,-766.5 6211.8,-757.44 6169.13,-748.42"/>
<polygon fill="black" stroke="black" points="6169.78,-744.98 6159.27,-746.31 6168.32,-751.83 6169.78,-744.98"/>
</g>
<!-- l1_s1_gpu2_exp1 -->
<g id="node13" class="node">
<title>l1_s1_gpu2_exp1</title>
<polygon fill="lightblue" stroke="black" points="6561,-772 6334,-719 6561,-666 6788,-719 6561,-772"/>
<text text-anchor="middle" x="6561" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="6561" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="6561" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu2_exp1 -->
<g id="edge12" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9770.54,-932.14C9360,-931.27 7960.72,-917.13 6817,-772 6772.44,-766.35 6724.05,-757.28 6681.45,-748.3"/>
<polygon fill="black" stroke="black" points="6682.12,-744.86 6671.61,-746.2 6680.66,-751.71 6682.12,-744.86"/>
</g>
<!-- l1_s1_gpu2_exp2 -->
<g id="node14" class="node">
<title>l1_s1_gpu2_exp2</title>
<polygon fill="lightblue" stroke="black" points="7073,-772 6846,-719 7073,-666 7300,-719 7073,-772"/>
<text text-anchor="middle" x="7073" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="7073" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7073" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu2_exp2 -->
<g id="edge13" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9769.77,-930.39C9403.66,-924.18 8263.82,-895.56 7329,-772 7284.68,-766.14 7236.54,-757.09 7194.08,-748.16"/>
<polygon fill="black" stroke="black" points="7194.78,-744.73 7184.27,-746.08 7193.33,-751.58 7194.78,-744.73"/>
</g>
<!-- l1_s1_gpu2_exp3 -->
<g id="node15" class="node">
<title>l1_s1_gpu2_exp3</title>
<polygon fill="lightblue" stroke="black" points="7585,-772 7358,-719 7585,-666 7812,-719 7585,-772"/>
<text text-anchor="middle" x="7585" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="7585" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="7585" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu2_exp3 -->
<g id="edge14" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9768.12,-927.73C9450.8,-915.39 8568.35,-873.89 7841,-772 7797.13,-765.85 7749.48,-756.83 7707.3,-748.02"/>
<polygon fill="black" stroke="black" points="7707.78,-744.54 7697.27,-745.9 7706.34,-751.39 7707.78,-744.54"/>
</g>
<!-- l1_s1_gpu3_exp0 -->
<g id="node16" class="node">
<title>l1_s1_gpu3_exp0</title>
<polygon fill="lightblue" stroke="black" points="8097,-772 7870,-719 8097,-666 8324,-719 8097,-772"/>
<text text-anchor="middle" x="8097" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="8097" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8097" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu3_exp0 -->
<g id="edge15" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9765.54,-923.21C9504.03,-903.7 8875.41,-852.07 8353,-772 8309.63,-765.35 8262.48,-756.3 8220.6,-747.62"/>
<polygon fill="black" stroke="black" points="8221.14,-744.15 8210.63,-745.54 8219.71,-751.01 8221.14,-744.15"/>
</g>
<!-- l1_s1_gpu3_exp1 -->
<g id="node17" class="node">
<title>l1_s1_gpu3_exp1</title>
<polygon fill="lightblue" stroke="black" points="8609,-772 8382,-719 8609,-666 8836,-719 8609,-772"/>
<text text-anchor="middle" x="8609" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="8609" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="8609" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu3_exp1 -->
<g id="edge16" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9760.17,-913.79C9565.76,-885.87 9186,-829.65 8865,-772 8822.75,-764.41 8776.74,-755.32 8735.53,-746.89"/>
<polygon fill="black" stroke="black" points="8736.21,-743.45 8725.71,-744.87 8734.81,-750.31 8736.21,-743.45"/>
</g>
<!-- l1_s1_gpu3_exp2 -->
<g id="node18" class="node">
<title>l1_s1_gpu3_exp2</title>
<polygon fill="lightblue" stroke="black" points="9121,-772 8894,-719 9121,-666 9348,-719 9121,-772"/>
<text text-anchor="middle" x="9121" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="9121" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9121" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu3_exp2 -->
<g id="edge17" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9748.14,-893.12C9599.81,-852.17 9369.26,-788.53 9232.89,-750.89"/>
<polygon fill="black" stroke="black" points="9233.81,-747.51 9223.24,-748.22 9231.94,-754.26 9233.81,-747.51"/>
</g>
<!-- l1_s1_gpu3_exp3 -->
<g id="node19" class="node">
<title>l1_s1_gpu3_exp3</title>
<polygon fill="lightblue" stroke="black" points="9633,-772 9406,-719 9633,-666 9860,-719 9633,-772"/>
<text text-anchor="middle" x="9633" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="9633" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="9633" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu3_exp3 -->
<g id="edge18" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9826.05,-879.87C9784.41,-845.39 9730.26,-800.55 9689.92,-767.13"/>
<polygon fill="black" stroke="black" points="9691.97,-764.29 9682.04,-760.61 9687.51,-769.69 9691.97,-764.29"/>
</g>
<!-- l1_s1_gpu4_exp0 -->
<g id="node20" class="node">
<title>l1_s1_gpu4_exp0</title>
<polygon fill="lightblue" stroke="black" points="10145,-772 9918,-719 10145,-666 10372,-719 10145,-772"/>
<text text-anchor="middle" x="10145" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="10145" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10145" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu4_exp0 -->
<g id="edge19" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu4_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9951.95,-879.87C9993.59,-845.39 10047.74,-800.55 10088.08,-767.13"/>
<polygon fill="black" stroke="black" points="10090.49,-769.69 10095.96,-760.61 10086.03,-764.29 10090.49,-769.69"/>
</g>
<!-- l1_s1_gpu4_exp1 -->
<g id="node21" class="node">
<title>l1_s1_gpu4_exp1</title>
<polygon fill="lightblue" stroke="black" points="10657,-772 10430,-719 10657,-666 10884,-719 10657,-772"/>
<text text-anchor="middle" x="10657" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="10657" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="10657" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu4_exp1 -->
<g id="edge20" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu4_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9990.59,-903.96C10134.3,-864.29 10396.02,-792.04 10545.13,-750.88"/>
<polygon fill="black" stroke="black" points="10546.07,-754.25 10554.78,-748.22 10544.21,-747.5 10546.07,-754.25"/>
</g>
<!-- l1_s1_gpu4_exp2 -->
<g id="node22" class="node">
<title>l1_s1_gpu4_exp2</title>
<polygon fill="lightblue" stroke="black" points="11169,-772 10942,-719 11169,-666 11396,-719 11169,-772"/>
<text text-anchor="middle" x="11169" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="11169" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="11169" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu4_exp2 -->
<g id="edge21" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu4_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M9997.64,-916.68C10184.92,-889.9 10580.49,-831.72 10913,-772 10955.25,-764.41 11001.26,-755.32 11042.47,-746.89"/>
<polygon fill="black" stroke="black" points="11043.19,-750.31 11052.29,-744.87 11041.79,-743.45 11043.19,-750.31"/>
</g>
<!-- l1_s1_gpu4_exp3 -->
<g id="node23" class="node">
<title>l1_s1_gpu4_exp3</title>
<polygon fill="lightblue" stroke="black" points="11681,-772 11454,-719 11681,-666 11908,-719 11681,-772"/>
<text text-anchor="middle" x="11681" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="11681" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="11681" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu4_exp3 -->
<g id="edge22" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu4_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10001.73,-924.01C10256.41,-905.13 10895.3,-853.19 11425,-772 11468.37,-765.35 11515.52,-756.3 11557.4,-747.62"/>
<polygon fill="black" stroke="black" points="11558.29,-751.01 11567.37,-745.54 11556.86,-744.15 11558.29,-751.01"/>
</g>
<!-- l1_s1_gpu5_exp0 -->
<g id="node24" class="node">
<title>l1_s1_gpu5_exp0</title>
<polygon fill="lightblue" stroke="black" points="12193,-772 11966,-719 12193,-666 12420,-719 12193,-772"/>
<text text-anchor="middle" x="12193" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="12193" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="12193" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu5_exp0 -->
<g id="edge23" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu5_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10003.88,-927.96C10315.95,-915.92 11205.01,-874.54 11937,-772 11980.87,-765.85 12028.52,-756.83 12070.7,-748.02"/>
<polygon fill="black" stroke="black" points="12071.66,-751.39 12080.73,-745.9 12070.22,-744.54 12071.66,-751.39"/>
</g>
<!-- l1_s1_gpu5_exp1 -->
<g id="node25" class="node">
<title>l1_s1_gpu5_exp1</title>
<polygon fill="lightblue" stroke="black" points="12705,-772 12478,-719 12705,-666 12932,-719 12705,-772"/>
<text text-anchor="middle" x="12705" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="12705" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="12705" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu5_exp1 -->
<g id="edge24" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu5_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10005.33,-930.43C10368.29,-924.33 11511.7,-895.88 12449,-772 12493.32,-766.14 12541.46,-757.09 12583.92,-748.16"/>
<polygon fill="black" stroke="black" points="12584.67,-751.58 12593.73,-746.08 12583.22,-744.73 12584.67,-751.58"/>
</g>
<!-- l1_s1_gpu5_exp2 -->
<g id="node26" class="node">
<title>l1_s1_gpu5_exp2</title>
<polygon fill="lightblue" stroke="black" points="13217,-772 12990,-719 13217,-666 13444,-719 13217,-772"/>
<text text-anchor="middle" x="13217" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="13217" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="13217" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu5_exp2 -->
<g id="edge25" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu5_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10006.39,-932.14C10415.57,-931.29 11816.28,-917.26 12961,-772 13005.56,-766.35 13053.95,-757.28 13096.55,-748.3"/>
<polygon fill="black" stroke="black" points="13097.34,-751.71 13106.39,-746.2 13095.88,-744.86 13097.34,-751.71"/>
</g>
<!-- l1_s1_gpu5_exp3 -->
<g id="node27" class="node">
<title>l1_s1_gpu5_exp3</title>
<polygon fill="lightblue" stroke="black" points="13729,-772 13502,-719 13729,-666 13956,-719 13729,-772"/>
<text text-anchor="middle" x="13729" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="13729" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="13729" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu5_exp3 -->
<g id="edge26" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu5_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10004.68,-929.26C10539.75,-916.24 12778.13,-857.55 13473,-772 13517.68,-766.5 13566.2,-757.44 13608.87,-748.42"/>
<polygon fill="black" stroke="black" points="13609.68,-751.83 13618.73,-746.31 13608.22,-744.98 13609.68,-751.83"/>
</g>
<!-- l1_s1_gpu6_exp0 -->
<g id="node28" class="node">
<title>l1_s1_gpu6_exp0</title>
<polygon fill="lightblue" stroke="black" points="14241,-772 14014,-719 14241,-666 14468,-719 14241,-772"/>
<text text-anchor="middle" x="14241" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 0</text>
<text text-anchor="middle" x="14241" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14241" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu6_exp0 -->
<g id="edge27" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu6_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10005.34,-929.99C10587.04,-919.58 13183.72,-868.39 13985,-772 14029.8,-766.61 14078.45,-757.56 14121.19,-748.5"/>
<polygon fill="black" stroke="black" points="14122.02,-751.9 14131.06,-746.38 14120.55,-745.05 14122.02,-751.9"/>
</g>
<!-- l1_s1_gpu6_exp1 -->
<g id="node29" class="node">
<title>l1_s1_gpu6_exp1</title>
<polygon fill="lightblue" stroke="black" points="14753,-772 14526,-719 14753,-666 14980,-719 14753,-772"/>
<text text-anchor="middle" x="14753" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="14753" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="14753" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu6_exp1 -->
<g id="edge28" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu6_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10005.4,-930.57C10629.89,-922.53 13588.64,-879.28 14497,-772 14541.92,-766.7 14590.69,-757.63 14633.5,-748.54"/>
<polygon fill="black" stroke="black" points="14634.35,-751.94 14643.39,-746.42 14632.88,-745.1 14634.35,-751.94"/>
</g>
<!-- l1_s1_gpu6_exp2 -->
<g id="node30" class="node">
<title>l1_s1_gpu6_exp2</title>
<polygon fill="lightblue" stroke="black" points="15265,-772 15038,-719 15265,-666 15492,-719 15265,-772"/>
<text text-anchor="middle" x="15265" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="15265" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15265" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu6_exp2 -->
<g id="edge29" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu6_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10005.82,-931.04C10671.64,-925.14 13993.41,-890.15 15009,-772 15053.93,-766.77 15102.7,-757.73 15145.51,-748.63"/>
<polygon fill="black" stroke="black" points="15146.36,-752.03 15155.4,-746.51 15144.89,-745.18 15146.36,-752.03"/>
</g>
<!-- l1_s1_gpu6_exp3 -->
<g id="node31" class="node">
<title>l1_s1_gpu6_exp3</title>
<polygon fill="lightblue" stroke="black" points="15777,-772 15550,-719 15777,-666 16004,-719 15777,-772"/>
<text text-anchor="middle" x="15777" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="15777" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="15777" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu6_exp3 -->
<g id="edge30" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu6_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10006.1,-931.42C10711.09,-927.5 14397.84,-901.05 15521,-772 15566.04,-766.82 15614.94,-757.76 15657.82,-748.64"/>
<polygon fill="black" stroke="black" points="15658.68,-752.03 15667.72,-746.51 15657.21,-745.19 15658.68,-752.03"/>
</g>
<!-- l1_s1_gpu7_exp0 -->
<g id="node32" class="node">
<title>l1_s1_gpu7_exp0</title>
<polygon fill="lightblue" stroke="black" points="16289,-772 16062,-719 16289,-666 16516,-719 16289,-772"/>
<text text-anchor="middle" x="16289" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="16289" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="16289" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu7_exp0 -->
<g id="edge31" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu7_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10006.04,-931.74C10747.68,-929.66 14801.85,-911.99 16033,-772 16078.05,-766.88 16126.95,-757.83 16169.82,-748.7"/>
<polygon fill="black" stroke="black" points="16170.69,-752.09 16179.73,-746.56 16169.21,-745.25 16170.69,-752.09"/>
</g>
<!-- l1_s1_gpu7_exp1 -->
<g id="node33" class="node">
<title>l1_s1_gpu7_exp1</title>
<polygon fill="lightblue" stroke="black" points="16801,-772 16574,-719 16801,-666 17028,-719 16801,-772"/>
<text text-anchor="middle" x="16801" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 5</text>
<text text-anchor="middle" x="16801" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="16801" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu7_exp1 -->
<g id="edge32" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu7_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10006.24,-932.01C10783.72,-931.65 15205.78,-922.92 16545,-772 16590.05,-766.92 16638.95,-757.88 16681.83,-748.75"/>
<polygon fill="black" stroke="black" points="16682.69,-752.14 16691.73,-746.61 16681.22,-745.3 16682.69,-752.14"/>
</g>
<!-- l1_s1_gpu7_exp2 -->
<g id="node34" class="node">
<title>l1_s1_gpu7_exp2</title>
<polygon fill="lightblue" stroke="black" points="17313,-772 17086,-719 17313,-666 17540,-719 17313,-772"/>
<text text-anchor="middle" x="17313" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 6</text>
<text text-anchor="middle" x="17313" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17313" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu7_exp2 -->
<g id="edge33" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu7_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10006.32,-932.24C10818.02,-933.5 15609.46,-933.86 17057,-772 17102.16,-766.95 17151.18,-757.89 17194.13,-748.73"/>
<polygon fill="black" stroke="black" points="17195.01,-752.12 17204.05,-746.59 17193.54,-745.27 17195.01,-752.12"/>
</g>
<!-- l1_s1_gpu7_exp3 -->
<g id="node35" class="node">
<title>l1_s1_gpu7_exp3</title>
<polygon fill="lightblue" stroke="black" points="17825,-772 17598,-719 17825,-666 18052,-719 17825,-772"/>
<text text-anchor="middle" x="17825" y="-730.3" font-family="Times,serif" font-size="14.00">Expert 7</text>
<text text-anchor="middle" x="17825" y="-715.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="17825" y="-700.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s1_route&#45;&gt;l1_s1_gpu7_exp3 -->
<g id="edge34" class="edge">
<title>l1_s1_route&#45;&gt;l1_s1_gpu7_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M10005.82,-930.84C10910.61,-921.65 16786.35,-858.93 17569,-772 17614.16,-766.98 17663.19,-757.93 17706.14,-748.76"/>
<polygon fill="black" stroke="black" points="17707.02,-752.15 17716.06,-746.62 17705.54,-745.31 17707.02,-752.15"/>
</g>
<!-- l1_s1_agg -->
<g id="node36" class="node">
<title>l1_s1_agg</title>
<polygon fill="orange" stroke="black" points="10362.94,-558 10016.25,-558 9927.06,-452 10273.75,-452 10362.94,-558"/>
<text text-anchor="middle" x="10145" y="-516.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10145" y="-501.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="10145" y="-486.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 0&#45;7</text>
</g>
<!-- l1_s1_gpu0_exp0&#45;&gt;l1_s1_agg -->
<g id="edge35" class="edge">
<title>l1_s1_gpu0_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M2061.94,-691.36C2107.15,-681.49 2160.32,-671.39 2209,-666 3001.95,-578.2 8854.07,-518.32 9963.68,-507.69"/>
<polygon fill="black" stroke="black" points="9963.77,-511.19 9973.73,-507.6 9963.7,-504.19 9963.77,-511.19"/>
</g>
<!-- l1_s1_gpu0_exp1&#45;&gt;l1_s1_agg -->
<g id="edge36" class="edge">
<title>l1_s1_gpu0_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M2573.95,-691.39C2619.15,-681.53 2672.32,-671.42 2721,-666 4187.22,-502.62 8965.66,-503.49 9961.95,-505.51"/>
<polygon fill="black" stroke="black" points="9962.06,-509.01 9972.07,-505.53 9962.08,-502.01 9962.06,-509.01"/>
</g>
<!-- l1_s1_gpu0_exp2&#45;&gt;l1_s1_agg -->
<g id="edge37" class="edge">
<title>l1_s1_gpu0_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M3085.95,-691.43C3131.16,-681.57 3184.33,-671.46 3233,-666 4592.1,-513.46 9008.42,-505.71 9962.3,-505.85"/>
<polygon fill="black" stroke="black" points="9962.33,-509.35 9972.33,-505.85 9962.33,-502.35 9962.33,-509.35"/>
</g>
<!-- l1_s1_gpu0_exp3&#45;&gt;l1_s1_agg -->
<g id="edge38" class="edge">
<title>l1_s1_gpu0_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M3598.27,-691.41C3643.41,-681.58 3696.44,-671.5 3745,-666 4997.03,-524.3 9051.55,-508.09 9962.27,-506.24"/>
<polygon fill="black" stroke="black" points="9962.52,-509.74 9972.51,-506.22 9962.5,-502.74 9962.52,-509.74"/>
</g>
<!-- l1_s1_gpu1_exp0&#45;&gt;l1_s1_agg -->
<g id="edge39" class="edge">
<title>l1_s1_gpu1_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M4110.28,-691.46C4155.42,-681.64 4208.45,-671.55 4257,-666 5402.48,-535.1 9098.23,-510.66 9962.86,-506.7"/>
<polygon fill="black" stroke="black" points="9962.91,-510.2 9972.9,-506.65 9962.88,-503.2 9962.91,-510.2"/>
</g>
<!-- l1_s1_gpu1_exp1&#45;&gt;l1_s1_agg -->
<g id="edge40" class="edge">
<title>l1_s1_gpu1_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M4622.6,-691.46C4667.67,-681.66 4720.57,-671.6 4769,-666 5808.04,-545.9 9145.76,-513.47 9963.08,-507.24"/>
<polygon fill="black" stroke="black" points="9963.2,-510.74 9973.17,-507.17 9963.14,-503.74 9963.2,-510.74"/>
</g>
<!-- l1_s1_gpu1_exp2&#45;&gt;l1_s1_agg -->
<g id="edge41" class="edge">
<title>l1_s1_gpu1_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M5134.61,-691.53C5179.68,-681.75 5232.58,-671.67 5281,-666 6214.12,-556.66 9196.76,-516.54 9963.78,-507.9"/>
<polygon fill="black" stroke="black" points="9963.85,-511.39 9973.81,-507.78 9963.77,-504.4 9963.85,-511.39"/>
</g>
<!-- l1_s1_gpu1_exp3&#45;&gt;l1_s1_agg -->
<g id="edge42" class="edge">
<title>l1_s1_gpu1_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M5646.93,-691.56C5691.94,-681.81 5744.7,-671.75 5793,-666 6620.51,-567.42 9249.95,-519.97 9964.37,-508.7"/>
<polygon fill="black" stroke="black" points="9964.54,-512.19 9974.49,-508.54 9964.43,-505.2 9964.54,-512.19"/>
</g>
<!-- l1_s1_gpu2_exp0&#45;&gt;l1_s1_agg -->
<g id="edge43" class="edge">
<title>l1_s1_gpu2_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M6159.26,-691.61C6204.2,-681.9 6256.83,-671.86 6305,-666 7027.39,-578.15 9306.58,-523.85 9965.16,-509.7"/>
<polygon fill="black" stroke="black" points="9965.29,-513.2 9975.21,-509.49 9965.14,-506.2 9965.29,-513.2"/>
</g>
<!-- l1_s1_gpu2_exp1&#45;&gt;l1_s1_agg -->
<g id="edge44" class="edge">
<title>l1_s1_gpu2_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M6671.6,-691.7C6716.47,-682.04 6768.96,-672 6817,-666 8008.79,-517.19 9456.6,-504.52 9961.13,-505.04"/>
<polygon fill="black" stroke="black" points="9961.41,-508.54 9971.41,-505.05 9961.42,-501.54 9961.41,-508.54"/>
</g>
<!-- l1_s1_gpu2_exp2&#45;&gt;l1_s1_agg -->
<g id="edge45" class="edge">
<title>l1_s1_gpu2_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M7183.94,-691.85C7228.75,-682.23 7281.1,-672.19 7329,-666 8317.32,-538.22 9513.9,-512.49 9963.04,-507.31"/>
<polygon fill="black" stroke="black" points="9963.22,-510.8 9973.18,-507.19 9963.14,-503.8 9963.22,-510.8"/>
</g>
<!-- l1_s1_gpu2_exp3&#45;&gt;l1_s1_agg -->
<g id="edge46" class="edge">
<title>l1_s1_gpu2_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M7696.61,-692.02C7741.29,-682.49 7793.36,-672.46 7841,-666 8628.17,-559.19 9576.87,-521.87 9965.63,-510.46"/>
<polygon fill="black" stroke="black" points="9965.95,-513.95 9975.84,-510.16 9965.75,-506.95 9965.95,-513.95"/>
</g>
<!-- l1_s1_gpu3_exp0&#45;&gt;l1_s1_agg -->
<g id="edge47" class="edge">
<title>l1_s1_gpu3_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M8209.95,-692.24C8254.34,-682.85 8305.88,-672.87 8353,-666 8942.17,-580.13 9647.48,-533.43 9969.33,-515.18"/>
<polygon fill="black" stroke="black" points="9969.89,-518.65 9979.68,-514.59 9969.5,-511.66 9969.89,-518.65"/>
</g>
<!-- l1_s1_gpu3_exp1&#45;&gt;l1_s1_agg -->
<g id="edge48" class="edge">
<title>l1_s1_gpu3_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M8723.67,-692.77C8767.72,-683.59 8818.57,-673.61 8865,-666 9261.19,-601.1 9730.17,-548.63 9975.72,-523.01"/>
<polygon fill="black" stroke="black" points="9976.22,-526.48 9985.8,-521.96 9975.49,-519.52 9976.22,-526.48"/>
</g>
<!-- l1_s1_gpu3_exp2&#45;&gt;l1_s1_agg -->
<g id="edge49" class="edge">
<title>l1_s1_gpu3_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M9239.22,-693.53C9424.04,-655.26 9781.57,-581.24 9987.86,-538.53"/>
<polygon fill="black" stroke="black" points="9988.79,-541.92 9997.87,-536.46 9987.37,-535.06 9988.79,-541.92"/>
</g>
<!-- l1_s1_gpu3_exp3&#45;&gt;l1_s1_agg -->
<g id="edge50" class="edge">
<title>l1_s1_gpu3_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M9713.56,-684.64C9792.87,-651.8 9915.46,-601.04 10009.73,-562.01"/>
<polygon fill="black" stroke="black" points="10011.15,-565.21 10019.05,-558.15 10008.47,-558.74 10011.15,-565.21"/>
</g>
<!-- l1_s1_gpu4_exp0&#45;&gt;l1_s1_agg -->
<g id="edge51" class="edge">
<title>l1_s1_gpu4_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M10145,-665.87C10145,-636.46 10145,-599.51 10145,-568.55"/>
<polygon fill="black" stroke="black" points="10148.5,-568.3 10145,-558.3 10141.5,-568.3 10148.5,-568.3"/>
</g>
<!-- l1_s1_gpu4_exp1&#45;&gt;l1_s1_agg -->
<g id="edge52" class="edge">
<title>l1_s1_gpu4_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M10576.44,-684.64C10497.13,-651.8 10374.54,-601.04 10280.27,-562.01"/>
<polygon fill="black" stroke="black" points="10281.53,-558.74 10270.95,-558.15 10278.85,-565.21 10281.53,-558.74"/>
</g>
<!-- l1_s1_gpu4_exp2&#45;&gt;l1_s1_agg -->
<g id="edge53" class="edge">
<title>l1_s1_gpu4_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M11050.78,-693.53C10883.87,-658.97 10576.09,-595.25 10366.07,-551.77"/>
<polygon fill="black" stroke="black" points="10366.65,-548.31 10356.14,-549.71 10365.23,-555.17 10366.65,-548.31"/>
</g>
<!-- l1_s1_gpu4_exp3&#45;&gt;l1_s1_agg -->
<g id="edge54" class="edge">
<title>l1_s1_gpu4_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M11566.33,-692.77C11522.28,-683.59 11471.43,-673.61 11425,-666 11044.97,-603.74 10597.97,-552.94 10345.42,-526.28"/>
<polygon fill="black" stroke="black" points="10345.72,-522.79 10335.41,-525.23 10344.99,-529.76 10345.72,-522.79"/>
</g>
<!-- l1_s1_gpu5_exp0&#45;&gt;l1_s1_agg -->
<g id="edge55" class="edge">
<title>l1_s1_gpu5_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M12080.05,-692.24C12035.66,-682.85 11984.12,-672.87 11937,-666 11357.87,-581.6 10666.51,-535.03 10337.45,-516.13"/>
<polygon fill="black" stroke="black" points="10337.52,-512.63 10327.34,-515.55 10337.12,-519.62 10337.52,-512.63"/>
</g>
<!-- l1_s1_gpu5_exp1&#45;&gt;l1_s1_agg -->
<g id="edge56" class="edge">
<title>l1_s1_gpu5_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M12593.39,-692.02C12548.71,-682.49 12496.64,-672.46 12449,-666 11667.79,-560 10727.49,-522.44 10333.29,-510.72"/>
<polygon fill="black" stroke="black" points="10333.32,-507.22 10323.22,-510.43 10333.12,-514.22 10333.32,-507.22"/>
</g>
<!-- l1_s1_gpu5_exp2&#45;&gt;l1_s1_agg -->
<g id="edge57" class="edge">
<title>l1_s1_gpu5_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M13106.06,-691.85C13061.25,-682.23 13008.9,-672.19 12961,-666 11975.39,-538.57 10782.66,-512.63 10330.67,-507.35"/>
<polygon fill="black" stroke="black" points="10330.5,-503.85 10320.46,-507.23 10330.42,-510.85 10330.5,-503.85"/>
</g>
<!-- l1_s1_gpu5_exp3&#45;&gt;l1_s1_agg -->
<g id="edge58" class="edge">
<title>l1_s1_gpu5_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M13618.4,-691.7C13573.53,-682.04 13521.04,-672 13473,-666 12281.21,-517.19 10833.4,-504.52 10328.87,-505.04"/>
<polygon fill="black" stroke="black" points="10328.58,-501.54 10318.59,-505.05 10328.59,-508.54 10328.58,-501.54"/>
</g>
<!-- l1_s1_gpu6_exp0&#45;&gt;l1_s1_agg -->
<g id="edge59" class="edge">
<title>l1_s1_gpu6_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M14130.74,-691.61C14085.8,-681.9 14033.17,-671.86 13985,-666 13265.39,-578.48 11000.94,-524.26 10332.52,-509.87"/>
<polygon fill="black" stroke="black" points="10332.39,-506.36 10322.31,-509.65 10332.24,-513.36 10332.39,-506.36"/>
</g>
<!-- l1_s1_gpu6_exp1&#45;&gt;l1_s1_agg -->
<g id="edge60" class="edge">
<title>l1_s1_gpu6_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M14643.07,-691.56C14598.06,-681.81 14545.3,-671.75 14497,-666 13671.83,-567.7 11054.88,-520.24 10331.73,-508.79"/>
<polygon fill="black" stroke="black" points="10331.53,-505.29 10321.48,-508.63 10331.42,-512.29 10331.53,-505.29"/>
</g>
<!-- l1_s1_gpu6_exp2&#45;&gt;l1_s1_agg -->
<g id="edge61" class="edge">
<title>l1_s1_gpu6_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M15155.39,-691.53C15110.32,-681.75 15057.42,-671.67 15009,-666 14077.84,-556.89 11105.75,-516.71 10331.08,-507.95"/>
<polygon fill="black" stroke="black" points="10330.99,-504.45 10320.95,-507.84 10330.91,-511.45 10330.99,-504.45"/>
</g>
<!-- l1_s1_gpu6_exp3&#45;&gt;l1_s1_agg -->
<g id="edge62" class="edge">
<title>l1_s1_gpu6_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M15667.4,-691.46C15622.33,-681.66 15569.43,-671.6 15521,-666 14483.55,-546.08 11154.43,-513.57 10330.68,-507.27"/>
<polygon fill="black" stroke="black" points="10330.54,-503.77 10320.51,-507.19 10330.49,-510.77 10330.54,-503.77"/>
</g>
<!-- l1_s1_gpu7_exp0&#45;&gt;l1_s1_agg -->
<g id="edge63" class="edge">
<title>l1_s1_gpu7_exp0&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M16179.72,-691.46C16134.58,-681.64 16081.55,-671.55 16033,-666 14888.79,-535.24 11199.93,-510.72 10330.02,-506.71"/>
<polygon fill="black" stroke="black" points="10329.93,-503.21 10319.91,-506.67 10329.9,-510.21 10329.93,-503.21"/>
</g>
<!-- l1_s1_gpu7_exp1&#45;&gt;l1_s1_agg -->
<g id="edge64" class="edge">
<title>l1_s1_gpu7_exp1&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M16691.73,-691.41C16646.59,-681.58 16593.56,-671.5 16545,-666 15294.01,-524.42 11245.12,-508.12 10329.99,-506.24"/>
<polygon fill="black" stroke="black" points="10329.7,-502.74 10319.7,-506.22 10329.69,-509.74 10329.7,-502.74"/>
</g>
<!-- l1_s1_gpu7_exp2&#45;&gt;l1_s1_agg -->
<g id="edge65" class="edge">
<title>l1_s1_gpu7_exp2&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M17204.05,-691.43C17158.84,-681.57 17105.67,-671.46 17057,-666 15698.64,-513.54 11286.41,-505.72 10329.27,-505.85"/>
<polygon fill="black" stroke="black" points="10329.2,-502.35 10319.2,-505.85 10329.2,-509.35 10329.2,-502.35"/>
</g>
<!-- l1_s1_gpu7_exp3&#45;&gt;l1_s1_agg -->
<g id="edge66" class="edge">
<title>l1_s1_gpu7_exp3&#45;&gt;l1_s1_agg</title>
<path fill="none" stroke="black" d="M17716.05,-691.39C17670.85,-681.53 17617.68,-671.42 17569,-666 16103.38,-502.68 11328.24,-503.49 10329.27,-505.5"/>
<polygon fill="black" stroke="black" points="10329.12,-502 10319.12,-505.52 10329.13,-509 10329.12,-502"/>
</g>
<!-- l1_s1_residual -->
<g id="node37" class="node">
<title>l1_s1_residual</title>
<polygon fill="orange" stroke="black" points="13995,-344 13860,-291 13995,-238 14130,-291 13995,-344"/>
<text text-anchor="middle" x="13995" y="-302.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="13995" y="-287.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="13995" y="-272.3" font-family="Times,serif" font-size="14.00">Across GPUs 0&#45;7</text>
</g>
<!-- l1_s1_agg&#45;&gt;l1_s1_residual -->
<g id="edge67" class="edge">
<title>l1_s1_agg&#45;&gt;l1_s1_residual</title>
<path fill="none" stroke="black" d="M10310.12,-494.91C10955.01,-459.4 13296.32,-330.47 13868.29,-298.98"/>
<polygon fill="black" stroke="black" points="13868.84,-302.45 13878.63,-298.41 13868.45,-295.46 13868.84,-302.45"/>
</g>
<!-- l1_s2_attn -->
<g id="node38" class="node">
<title>l1_s2_attn</title>
<polygon fill="lightblue" stroke="black" points="17846,-130 17640,-77 17846,-24 18052,-77 17846,-130"/>
<text text-anchor="middle" x="17846" y="-88.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="17846" y="-73.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="17846" y="-58.3" font-family="Times,serif" font-size="14.00">TP across GPUs 8&#45;15</text>
</g>
<!-- l1_s1_residual&#45;&gt;l1_s2_attn -->
<g id="edge68" class="edge">
<title>l1_s1_residual&#45;&gt;l1_s2_attn</title>
<path fill="none" stroke="black" d="M14129.29,-290.65C14699.76,-292.56 16924.41,-291.33 17611,-161 17662.48,-151.23 17717.85,-132.12 17761.91,-114.71"/>
<polygon fill="black" stroke="black" points="17763.43,-117.87 17771.42,-110.9 17760.83,-111.37 17763.43,-117.87"/>
</g>
<!-- l1_s2_route -->
<g id="node39" class="node">
<title>l1_s2_route</title>
<polygon fill="orange" stroke="black" points="17581.67,-130 17330.85,-130 17266.33,-24 17517.15,-24 17581.67,-130"/>
<text text-anchor="middle" x="17424" y="-88.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="17424" y="-73.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="17424" y="-58.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 8&#45;15</text>
</g>
<!-- l1_s2_gpu8_exp0 -->
<g id="node40" class="node">
<title>l1_s2_gpu8_exp0</title>
<polygon fill="lightblue" stroke="black" points="16981,-130 16754,-77 16981,-24 17208,-77 16981,-130"/>
<text text-anchor="middle" x="16981" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="16981" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16981" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu8_exp1 -->
<g id="node41" class="node">
<title>l1_s2_gpu8_exp1</title>
<polygon fill="lightblue" stroke="black" points="16469,-130 16242,-77 16469,-24 16696,-77 16469,-130"/>
<text text-anchor="middle" x="16469" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="16469" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="16469" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu8_exp2 -->
<g id="node42" class="node">
<title>l1_s2_gpu8_exp2</title>
<polygon fill="lightblue" stroke="black" points="15957,-130 15730,-77 15957,-24 16184,-77 15957,-130"/>
<text text-anchor="middle" x="15957" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="15957" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="15957" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu8_exp3 -->
<g id="node43" class="node">
<title>l1_s2_gpu8_exp3</title>
<polygon fill="lightblue" stroke="black" points="15445,-130 15218,-77 15445,-24 15672,-77 15445,-130"/>
<text text-anchor="middle" x="15445" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="15445" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="15445" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu9_exp0 -->
<g id="node44" class="node">
<title>l1_s2_gpu9_exp0</title>
<polygon fill="lightblue" stroke="black" points="14933,-130 14706,-77 14933,-24 15160,-77 14933,-130"/>
<text text-anchor="middle" x="14933" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="14933" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="14933" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu9_exp1 -->
<g id="node45" class="node">
<title>l1_s2_gpu9_exp1</title>
<polygon fill="lightblue" stroke="black" points="14421,-130 14194,-77 14421,-24 14648,-77 14421,-130"/>
<text text-anchor="middle" x="14421" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="14421" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="14421" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu9_exp2 -->
<g id="node46" class="node">
<title>l1_s2_gpu9_exp2</title>
<polygon fill="lightblue" stroke="black" points="13909,-130 13682,-77 13909,-24 14136,-77 13909,-130"/>
<text text-anchor="middle" x="13909" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="13909" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13909" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu9_exp3 -->
<g id="node47" class="node">
<title>l1_s2_gpu9_exp3</title>
<polygon fill="lightblue" stroke="black" points="13397,-130 13170,-77 13397,-24 13624,-77 13397,-130"/>
<text text-anchor="middle" x="13397" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="13397" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="13397" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu10_exp0 -->
<g id="node48" class="node">
<title>l1_s2_gpu10_exp0</title>
<polygon fill="lightblue" stroke="black" points="12885,-130 12658,-77 12885,-24 13112,-77 12885,-130"/>
<text text-anchor="middle" x="12885" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="12885" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12885" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu10_exp1 -->
<g id="node49" class="node">
<title>l1_s2_gpu10_exp1</title>
<polygon fill="lightblue" stroke="black" points="12373,-130 12146,-77 12373,-24 12600,-77 12373,-130"/>
<text text-anchor="middle" x="12373" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="12373" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="12373" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu10_exp2 -->
<g id="node50" class="node">
<title>l1_s2_gpu10_exp2</title>
<polygon fill="lightblue" stroke="black" points="11861,-130 11634,-77 11861,-24 12088,-77 11861,-130"/>
<text text-anchor="middle" x="11861" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="11861" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11861" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu10_exp3 -->
<g id="node51" class="node">
<title>l1_s2_gpu10_exp3</title>
<polygon fill="lightblue" stroke="black" points="11349,-130 11122,-77 11349,-24 11576,-77 11349,-130"/>
<text text-anchor="middle" x="11349" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="11349" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="11349" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu11_exp0 -->
<g id="node52" class="node">
<title>l1_s2_gpu11_exp0</title>
<polygon fill="lightblue" stroke="black" points="10837,-130 10610,-77 10837,-24 11064,-77 10837,-130"/>
<text text-anchor="middle" x="10837" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="10837" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10837" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu11_exp1 -->
<g id="node53" class="node">
<title>l1_s2_gpu11_exp1</title>
<polygon fill="lightblue" stroke="black" points="10325,-130 10098,-77 10325,-24 10552,-77 10325,-130"/>
<text text-anchor="middle" x="10325" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="10325" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="10325" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu11_exp2 -->
<g id="node54" class="node">
<title>l1_s2_gpu11_exp2</title>
<polygon fill="lightblue" stroke="black" points="9813,-130 9586,-77 9813,-24 10040,-77 9813,-130"/>
<text text-anchor="middle" x="9813" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="9813" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9813" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu11_exp3 -->
<g id="node55" class="node">
<title>l1_s2_gpu11_exp3</title>
<polygon fill="lightblue" stroke="black" points="9301,-130 9074,-77 9301,-24 9528,-77 9301,-130"/>
<text text-anchor="middle" x="9301" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="9301" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="9301" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu12_exp0 -->
<g id="node56" class="node">
<title>l1_s2_gpu12_exp0</title>
<polygon fill="lightblue" stroke="black" points="8789,-130 8562,-77 8789,-24 9016,-77 8789,-130"/>
<text text-anchor="middle" x="8789" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="8789" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8789" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu12_exp1 -->
<g id="node57" class="node">
<title>l1_s2_gpu12_exp1</title>
<polygon fill="lightblue" stroke="black" points="8277,-130 8050,-77 8277,-24 8504,-77 8277,-130"/>
<text text-anchor="middle" x="8277" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="8277" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="8277" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu12_exp2 -->
<g id="node58" class="node">
<title>l1_s2_gpu12_exp2</title>
<polygon fill="lightblue" stroke="black" points="7765,-130 7538,-77 7765,-24 7992,-77 7765,-130"/>
<text text-anchor="middle" x="7765" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="7765" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7765" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu12_exp3 -->
<g id="node59" class="node">
<title>l1_s2_gpu12_exp3</title>
<polygon fill="lightblue" stroke="black" points="7253,-130 7026,-77 7253,-24 7480,-77 7253,-130"/>
<text text-anchor="middle" x="7253" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="7253" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="7253" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu13_exp0 -->
<g id="node60" class="node">
<title>l1_s2_gpu13_exp0</title>
<polygon fill="lightblue" stroke="black" points="6741,-130 6514,-77 6741,-24 6968,-77 6741,-130"/>
<text text-anchor="middle" x="6741" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="6741" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6741" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu13_exp1 -->
<g id="node61" class="node">
<title>l1_s2_gpu13_exp1</title>
<polygon fill="lightblue" stroke="black" points="6229,-130 6002,-77 6229,-24 6456,-77 6229,-130"/>
<text text-anchor="middle" x="6229" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="6229" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="6229" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu13_exp2 -->
<g id="node62" class="node">
<title>l1_s2_gpu13_exp2</title>
<polygon fill="lightblue" stroke="black" points="5717,-130 5490,-77 5717,-24 5944,-77 5717,-130"/>
<text text-anchor="middle" x="5717" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="5717" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="5717" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu13_exp3 -->
<g id="node63" class="node">
<title>l1_s2_gpu13_exp3</title>
<polygon fill="lightblue" stroke="black" points="5205,-130 4978,-77 5205,-24 5432,-77 5205,-130"/>
<text text-anchor="middle" x="5205" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="5205" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="5205" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu14_exp0 -->
<g id="node64" class="node">
<title>l1_s2_gpu14_exp0</title>
<polygon fill="lightblue" stroke="black" points="4693,-130 4466,-77 4693,-24 4920,-77 4693,-130"/>
<text text-anchor="middle" x="4693" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 8</text>
<text text-anchor="middle" x="4693" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="4693" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu14_exp1 -->
<g id="node65" class="node">
<title>l1_s2_gpu14_exp1</title>
<polygon fill="lightblue" stroke="black" points="4181,-130 3954,-77 4181,-24 4408,-77 4181,-130"/>
<text text-anchor="middle" x="4181" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 9</text>
<text text-anchor="middle" x="4181" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="4181" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu14_exp2 -->
<g id="node66" class="node">
<title>l1_s2_gpu14_exp2</title>
<polygon fill="lightblue" stroke="black" points="3669,-130 3442,-77 3669,-24 3896,-77 3669,-130"/>
<text text-anchor="middle" x="3669" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 10</text>
<text text-anchor="middle" x="3669" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3669" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu14_exp3 -->
<g id="node67" class="node">
<title>l1_s2_gpu14_exp3</title>
<polygon fill="lightblue" stroke="black" points="3157,-130 2930,-77 3157,-24 3384,-77 3157,-130"/>
<text text-anchor="middle" x="3157" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 11</text>
<text text-anchor="middle" x="3157" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="3157" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu15_exp0 -->
<g id="node68" class="node">
<title>l1_s2_gpu15_exp0</title>
<polygon fill="lightblue" stroke="black" points="2645,-130 2418,-77 2645,-24 2872,-77 2645,-130"/>
<text text-anchor="middle" x="2645" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 12</text>
<text text-anchor="middle" x="2645" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="2645" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu15_exp1 -->
<g id="node69" class="node">
<title>l1_s2_gpu15_exp1</title>
<polygon fill="lightblue" stroke="black" points="2133,-130 1906,-77 2133,-24 2360,-77 2133,-130"/>
<text text-anchor="middle" x="2133" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 13</text>
<text text-anchor="middle" x="2133" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="2133" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu15_exp2 -->
<g id="node70" class="node">
<title>l1_s2_gpu15_exp2</title>
<polygon fill="lightblue" stroke="black" points="1621,-130 1394,-77 1621,-24 1848,-77 1621,-130"/>
<text text-anchor="middle" x="1621" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 14</text>
<text text-anchor="middle" x="1621" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="1621" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_gpu15_exp3 -->
<g id="node71" class="node">
<title>l1_s2_gpu15_exp3</title>
<polygon fill="lightblue" stroke="black" points="1109,-130 882,-77 1109,-24 1336,-77 1109,-130"/>
<text text-anchor="middle" x="1109" y="-88.3" font-family="Times,serif" font-size="14.00">Expert 15</text>
<text text-anchor="middle" x="1109" y="-73.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="1109" y="-58.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l1_s2_agg -->
<g id="node72" class="node">
<title>l1_s2_agg</title>
<polygon fill="orange" stroke="black" points="824.1,-130 462.84,-130 369.9,-24 731.16,-24 824.1,-130"/>
<text text-anchor="middle" x="597" y="-88.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="597" y="-73.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="597" y="-58.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 8&#45;15</text>
</g>
<!-- l1_s2_residual -->
<g id="node73" class="node">
<title>l1_s2_residual</title>
<polygon fill="orange" stroke="black" points="168,-130 24,-77 168,-24 312,-77 168,-130"/>
<text text-anchor="middle" x="168" y="-88.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="168" y="-73.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="168" y="-58.3" font-family="Times,serif" font-size="14.00">Across GPUs 8&#45;15</text>
</g>
<!-- l2_s1_attn -->
<g id="node74" class="node">
<title>l2_s1_attn</title>
<polygon fill="lightblue" stroke="black" points="45945,-1414 45739,-1361 45945,-1308 46151,-1361 45945,-1414"/>
<text text-anchor="middle" x="45945" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="45945" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="45945" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 0&#45;7</text>
</g>
<!-- l2_s1_route -->
<g id="node75" class="node">
<title>l2_s1_route</title>
<polygon fill="orange" stroke="black" points="45681.01,-1414 45445.56,-1414 45384.99,-1308 45620.44,-1308 45681.01,-1414"/>
<text text-anchor="middle" x="45533" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="45533" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="45533" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 0&#45;7</text>
</g>
<!-- l2_s1_gpu0_exp0 -->
<g id="node76" class="node">
<title>l2_s1_gpu0_exp0</title>
<polygon fill="lightblue" stroke="black" points="45100,-1414 44873,-1361 45100,-1308 45327,-1361 45100,-1414"/>
<text text-anchor="middle" x="45100" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 16</text>
<text text-anchor="middle" x="45100" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="45100" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu0_exp1 -->
<g id="node77" class="node">
<title>l2_s1_gpu0_exp1</title>
<polygon fill="lightblue" stroke="black" points="44588,-1414 44361,-1361 44588,-1308 44815,-1361 44588,-1414"/>
<text text-anchor="middle" x="44588" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 17</text>
<text text-anchor="middle" x="44588" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="44588" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu0_exp2 -->
<g id="node78" class="node">
<title>l2_s1_gpu0_exp2</title>
<polygon fill="lightblue" stroke="black" points="44076,-1414 43849,-1361 44076,-1308 44303,-1361 44076,-1414"/>
<text text-anchor="middle" x="44076" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 18</text>
<text text-anchor="middle" x="44076" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="44076" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu0_exp3 -->
<g id="node79" class="node">
<title>l2_s1_gpu0_exp3</title>
<polygon fill="lightblue" stroke="black" points="43564,-1414 43337,-1361 43564,-1308 43791,-1361 43564,-1414"/>
<text text-anchor="middle" x="43564" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 19</text>
<text text-anchor="middle" x="43564" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="43564" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu1_exp0 -->
<g id="node80" class="node">
<title>l2_s1_gpu1_exp0</title>
<polygon fill="lightblue" stroke="black" points="43052,-1414 42825,-1361 43052,-1308 43279,-1361 43052,-1414"/>
<text text-anchor="middle" x="43052" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 20</text>
<text text-anchor="middle" x="43052" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="43052" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu1_exp1 -->
<g id="node81" class="node">
<title>l2_s1_gpu1_exp1</title>
<polygon fill="lightblue" stroke="black" points="42540,-1414 42313,-1361 42540,-1308 42767,-1361 42540,-1414"/>
<text text-anchor="middle" x="42540" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 21</text>
<text text-anchor="middle" x="42540" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="42540" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu1_exp2 -->
<g id="node82" class="node">
<title>l2_s1_gpu1_exp2</title>
<polygon fill="lightblue" stroke="black" points="42028,-1414 41801,-1361 42028,-1308 42255,-1361 42028,-1414"/>
<text text-anchor="middle" x="42028" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 22</text>
<text text-anchor="middle" x="42028" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="42028" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu1_exp3 -->
<g id="node83" class="node">
<title>l2_s1_gpu1_exp3</title>
<polygon fill="lightblue" stroke="black" points="41516,-1414 41289,-1361 41516,-1308 41743,-1361 41516,-1414"/>
<text text-anchor="middle" x="41516" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 23</text>
<text text-anchor="middle" x="41516" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="41516" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu2_exp0 -->
<g id="node84" class="node">
<title>l2_s1_gpu2_exp0</title>
<polygon fill="lightblue" stroke="black" points="41004,-1414 40777,-1361 41004,-1308 41231,-1361 41004,-1414"/>
<text text-anchor="middle" x="41004" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="41004" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="41004" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu2_exp1 -->
<g id="node85" class="node">
<title>l2_s1_gpu2_exp1</title>
<polygon fill="lightblue" stroke="black" points="40492,-1414 40265,-1361 40492,-1308 40719,-1361 40492,-1414"/>
<text text-anchor="middle" x="40492" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="40492" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="40492" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu2_exp2 -->
<g id="node86" class="node">
<title>l2_s1_gpu2_exp2</title>
<polygon fill="lightblue" stroke="black" points="39980,-1414 39753,-1361 39980,-1308 40207,-1361 39980,-1414"/>
<text text-anchor="middle" x="39980" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="39980" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="39980" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu2_exp3 -->
<g id="node87" class="node">
<title>l2_s1_gpu2_exp3</title>
<polygon fill="lightblue" stroke="black" points="39468,-1414 39241,-1361 39468,-1308 39695,-1361 39468,-1414"/>
<text text-anchor="middle" x="39468" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="39468" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="39468" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu3_exp0 -->
<g id="node88" class="node">
<title>l2_s1_gpu3_exp0</title>
<polygon fill="lightblue" stroke="black" points="38956,-1414 38729,-1361 38956,-1308 39183,-1361 38956,-1414"/>
<text text-anchor="middle" x="38956" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="38956" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="38956" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu3_exp1 -->
<g id="node89" class="node">
<title>l2_s1_gpu3_exp1</title>
<polygon fill="lightblue" stroke="black" points="38444,-1414 38217,-1361 38444,-1308 38671,-1361 38444,-1414"/>
<text text-anchor="middle" x="38444" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="38444" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="38444" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu3_exp2 -->
<g id="node90" class="node">
<title>l2_s1_gpu3_exp2</title>
<polygon fill="lightblue" stroke="black" points="37932,-1414 37705,-1361 37932,-1308 38159,-1361 37932,-1414"/>
<text text-anchor="middle" x="37932" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="37932" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="37932" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu3_exp3 -->
<g id="node91" class="node">
<title>l2_s1_gpu3_exp3</title>
<polygon fill="lightblue" stroke="black" points="37420,-1414 37193,-1361 37420,-1308 37647,-1361 37420,-1414"/>
<text text-anchor="middle" x="37420" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="37420" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="37420" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu4_exp0 -->
<g id="node92" class="node">
<title>l2_s1_gpu4_exp0</title>
<polygon fill="lightblue" stroke="black" points="36908,-1414 36681,-1361 36908,-1308 37135,-1361 36908,-1414"/>
<text text-anchor="middle" x="36908" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="36908" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="36908" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu4_exp1 -->
<g id="node93" class="node">
<title>l2_s1_gpu4_exp1</title>
<polygon fill="lightblue" stroke="black" points="36396,-1414 36169,-1361 36396,-1308 36623,-1361 36396,-1414"/>
<text text-anchor="middle" x="36396" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="36396" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="36396" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu4_exp2 -->
<g id="node94" class="node">
<title>l2_s1_gpu4_exp2</title>
<polygon fill="lightblue" stroke="black" points="35884,-1414 35657,-1361 35884,-1308 36111,-1361 35884,-1414"/>
<text text-anchor="middle" x="35884" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="35884" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="35884" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu4_exp3 -->
<g id="node95" class="node">
<title>l2_s1_gpu4_exp3</title>
<polygon fill="lightblue" stroke="black" points="35372,-1414 35145,-1361 35372,-1308 35599,-1361 35372,-1414"/>
<text text-anchor="middle" x="35372" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="35372" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="35372" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu5_exp0 -->
<g id="node96" class="node">
<title>l2_s1_gpu5_exp0</title>
<polygon fill="lightblue" stroke="black" points="34860,-1414 34633,-1361 34860,-1308 35087,-1361 34860,-1414"/>
<text text-anchor="middle" x="34860" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="34860" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="34860" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu5_exp1 -->
<g id="node97" class="node">
<title>l2_s1_gpu5_exp1</title>
<polygon fill="lightblue" stroke="black" points="34348,-1414 34121,-1361 34348,-1308 34575,-1361 34348,-1414"/>
<text text-anchor="middle" x="34348" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="34348" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="34348" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu5_exp2 -->
<g id="node98" class="node">
<title>l2_s1_gpu5_exp2</title>
<polygon fill="lightblue" stroke="black" points="33836,-1414 33609,-1361 33836,-1308 34063,-1361 33836,-1414"/>
<text text-anchor="middle" x="33836" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="33836" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="33836" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu5_exp3 -->
<g id="node99" class="node">
<title>l2_s1_gpu5_exp3</title>
<polygon fill="lightblue" stroke="black" points="33324,-1414 33097,-1361 33324,-1308 33551,-1361 33324,-1414"/>
<text text-anchor="middle" x="33324" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="33324" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="33324" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu6_exp0 -->
<g id="node100" class="node">
<title>l2_s1_gpu6_exp0</title>
<polygon fill="lightblue" stroke="black" points="32812,-1414 32585,-1361 32812,-1308 33039,-1361 32812,-1414"/>
<text text-anchor="middle" x="32812" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="32812" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="32812" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu6_exp1 -->
<g id="node101" class="node">
<title>l2_s1_gpu6_exp1</title>
<polygon fill="lightblue" stroke="black" points="32300,-1414 32073,-1361 32300,-1308 32527,-1361 32300,-1414"/>
<text text-anchor="middle" x="32300" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="32300" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="32300" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu6_exp2 -->
<g id="node102" class="node">
<title>l2_s1_gpu6_exp2</title>
<polygon fill="lightblue" stroke="black" points="31788,-1414 31561,-1361 31788,-1308 32015,-1361 31788,-1414"/>
<text text-anchor="middle" x="31788" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="31788" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="31788" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu6_exp3 -->
<g id="node103" class="node">
<title>l2_s1_gpu6_exp3</title>
<polygon fill="lightblue" stroke="black" points="31276,-1414 31049,-1361 31276,-1308 31503,-1361 31276,-1414"/>
<text text-anchor="middle" x="31276" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="31276" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="31276" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu7_exp0 -->
<g id="node104" class="node">
<title>l2_s1_gpu7_exp0</title>
<polygon fill="lightblue" stroke="black" points="30764,-1414 30537,-1361 30764,-1308 30991,-1361 30764,-1414"/>
<text text-anchor="middle" x="30764" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="30764" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="30764" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu7_exp1 -->
<g id="node105" class="node">
<title>l2_s1_gpu7_exp1</title>
<polygon fill="lightblue" stroke="black" points="30252,-1414 30025,-1361 30252,-1308 30479,-1361 30252,-1414"/>
<text text-anchor="middle" x="30252" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="30252" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="30252" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu7_exp2 -->
<g id="node106" class="node">
<title>l2_s1_gpu7_exp2</title>
<polygon fill="lightblue" stroke="black" points="29740,-1414 29513,-1361 29740,-1308 29967,-1361 29740,-1414"/>
<text text-anchor="middle" x="29740" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="29740" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="29740" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_gpu7_exp3 -->
<g id="node107" class="node">
<title>l2_s1_gpu7_exp3</title>
<polygon fill="lightblue" stroke="black" points="29228,-1414 29001,-1361 29228,-1308 29455,-1361 29228,-1414"/>
<text text-anchor="middle" x="29228" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="29228" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="29228" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s1_agg -->
<g id="node108" class="node">
<title>l2_s1_agg</title>
<polygon fill="orange" stroke="black" points="28942.94,-1414 28596.25,-1414 28507.06,-1308 28853.75,-1308 28942.94,-1414"/>
<text text-anchor="middle" x="28725" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="28725" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="28725" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 0&#45;7</text>
</g>
<!-- l2_s1_residual -->
<g id="node109" class="node">
<title>l2_s1_residual</title>
<polygon fill="orange" stroke="black" points="28314,-1414 28179,-1361 28314,-1308 28449,-1361 28314,-1414"/>
<text text-anchor="middle" x="28314" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="28314" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="28314" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 0&#45;7</text>
</g>
<!-- l2_s2_attn -->
<g id="node110" class="node">
<title>l2_s2_attn</title>
<polygon fill="lightblue" stroke="black" points="27915,-1414 27709,-1361 27915,-1308 28121,-1361 27915,-1414"/>
<text text-anchor="middle" x="27915" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="27915" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="27915" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 8&#45;15</text>
</g>
<!-- l2_s2_route -->
<g id="node111" class="node">
<title>l2_s2_route</title>
<polygon fill="orange" stroke="black" points="27650.67,-1414 27399.85,-1414 27335.33,-1308 27586.15,-1308 27650.67,-1414"/>
<text text-anchor="middle" x="27493" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="27493" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="27493" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 8&#45;15</text>
</g>
<!-- l2_s2_gpu8_exp0 -->
<g id="node112" class="node">
<title>l2_s2_gpu8_exp0</title>
<polygon fill="lightblue" stroke="black" points="27050,-1414 26823,-1361 27050,-1308 27277,-1361 27050,-1414"/>
<text text-anchor="middle" x="27050" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 24</text>
<text text-anchor="middle" x="27050" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="27050" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu8_exp1 -->
<g id="node113" class="node">
<title>l2_s2_gpu8_exp1</title>
<polygon fill="lightblue" stroke="black" points="26538,-1414 26311,-1361 26538,-1308 26765,-1361 26538,-1414"/>
<text text-anchor="middle" x="26538" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 25</text>
<text text-anchor="middle" x="26538" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="26538" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu8_exp2 -->
<g id="node114" class="node">
<title>l2_s2_gpu8_exp2</title>
<polygon fill="lightblue" stroke="black" points="26026,-1414 25799,-1361 26026,-1308 26253,-1361 26026,-1414"/>
<text text-anchor="middle" x="26026" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 26</text>
<text text-anchor="middle" x="26026" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="26026" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu8_exp3 -->
<g id="node115" class="node">
<title>l2_s2_gpu8_exp3</title>
<polygon fill="lightblue" stroke="black" points="25514,-1414 25287,-1361 25514,-1308 25741,-1361 25514,-1414"/>
<text text-anchor="middle" x="25514" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 27</text>
<text text-anchor="middle" x="25514" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="25514" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu9_exp0 -->
<g id="node116" class="node">
<title>l2_s2_gpu9_exp0</title>
<polygon fill="lightblue" stroke="black" points="25002,-1414 24775,-1361 25002,-1308 25229,-1361 25002,-1414"/>
<text text-anchor="middle" x="25002" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 28</text>
<text text-anchor="middle" x="25002" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="25002" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu9_exp1 -->
<g id="node117" class="node">
<title>l2_s2_gpu9_exp1</title>
<polygon fill="lightblue" stroke="black" points="24490,-1414 24263,-1361 24490,-1308 24717,-1361 24490,-1414"/>
<text text-anchor="middle" x="24490" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 29</text>
<text text-anchor="middle" x="24490" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="24490" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu9_exp2 -->
<g id="node118" class="node">
<title>l2_s2_gpu9_exp2</title>
<polygon fill="lightblue" stroke="black" points="23978,-1414 23751,-1361 23978,-1308 24205,-1361 23978,-1414"/>
<text text-anchor="middle" x="23978" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 30</text>
<text text-anchor="middle" x="23978" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23978" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu9_exp3 -->
<g id="node119" class="node">
<title>l2_s2_gpu9_exp3</title>
<polygon fill="lightblue" stroke="black" points="23466,-1414 23239,-1361 23466,-1308 23693,-1361 23466,-1414"/>
<text text-anchor="middle" x="23466" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 31</text>
<text text-anchor="middle" x="23466" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="23466" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu10_exp0 -->
<g id="node120" class="node">
<title>l2_s2_gpu10_exp0</title>
<polygon fill="lightblue" stroke="black" points="22954,-1414 22727,-1361 22954,-1308 23181,-1361 22954,-1414"/>
<text text-anchor="middle" x="22954" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="22954" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="22954" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu10_exp1 -->
<g id="node121" class="node">
<title>l2_s2_gpu10_exp1</title>
<polygon fill="lightblue" stroke="black" points="22442,-1414 22215,-1361 22442,-1308 22669,-1361 22442,-1414"/>
<text text-anchor="middle" x="22442" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="22442" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="22442" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu10_exp2 -->
<g id="node122" class="node">
<title>l2_s2_gpu10_exp2</title>
<polygon fill="lightblue" stroke="black" points="21930,-1414 21703,-1361 21930,-1308 22157,-1361 21930,-1414"/>
<text text-anchor="middle" x="21930" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="21930" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="21930" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu10_exp3 -->
<g id="node123" class="node">
<title>l2_s2_gpu10_exp3</title>
<polygon fill="lightblue" stroke="black" points="21418,-1414 21191,-1361 21418,-1308 21645,-1361 21418,-1414"/>
<text text-anchor="middle" x="21418" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="21418" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="21418" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu11_exp0 -->
<g id="node124" class="node">
<title>l2_s2_gpu11_exp0</title>
<polygon fill="lightblue" stroke="black" points="20906,-1414 20679,-1361 20906,-1308 21133,-1361 20906,-1414"/>
<text text-anchor="middle" x="20906" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="20906" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="20906" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu11_exp1 -->
<g id="node125" class="node">
<title>l2_s2_gpu11_exp1</title>
<polygon fill="lightblue" stroke="black" points="20394,-1414 20167,-1361 20394,-1308 20621,-1361 20394,-1414"/>
<text text-anchor="middle" x="20394" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="20394" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="20394" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu11_exp2 -->
<g id="node126" class="node">
<title>l2_s2_gpu11_exp2</title>
<polygon fill="lightblue" stroke="black" points="19882,-1414 19655,-1361 19882,-1308 20109,-1361 19882,-1414"/>
<text text-anchor="middle" x="19882" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="19882" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="19882" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu11_exp3 -->
<g id="node127" class="node">
<title>l2_s2_gpu11_exp3</title>
<polygon fill="lightblue" stroke="black" points="19370,-1414 19143,-1361 19370,-1308 19597,-1361 19370,-1414"/>
<text text-anchor="middle" x="19370" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="19370" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="19370" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu12_exp0 -->
<g id="node128" class="node">
<title>l2_s2_gpu12_exp0</title>
<polygon fill="lightblue" stroke="black" points="18858,-1414 18631,-1361 18858,-1308 19085,-1361 18858,-1414"/>
<text text-anchor="middle" x="18858" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="18858" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="18858" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu12_exp1 -->
<g id="node129" class="node">
<title>l2_s2_gpu12_exp1</title>
<polygon fill="lightblue" stroke="black" points="18346,-1414 18119,-1361 18346,-1308 18573,-1361 18346,-1414"/>
<text text-anchor="middle" x="18346" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="18346" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="18346" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu12_exp2 -->
<g id="node130" class="node">
<title>l2_s2_gpu12_exp2</title>
<polygon fill="lightblue" stroke="black" points="17834,-1414 17607,-1361 17834,-1308 18061,-1361 17834,-1414"/>
<text text-anchor="middle" x="17834" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="17834" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17834" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu12_exp3 -->
<g id="node131" class="node">
<title>l2_s2_gpu12_exp3</title>
<polygon fill="lightblue" stroke="black" points="17322,-1414 17095,-1361 17322,-1308 17549,-1361 17322,-1414"/>
<text text-anchor="middle" x="17322" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="17322" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="17322" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu13_exp0 -->
<g id="node132" class="node">
<title>l2_s2_gpu13_exp0</title>
<polygon fill="lightblue" stroke="black" points="16810,-1414 16583,-1361 16810,-1308 17037,-1361 16810,-1414"/>
<text text-anchor="middle" x="16810" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="16810" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16810" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu13_exp1 -->
<g id="node133" class="node">
<title>l2_s2_gpu13_exp1</title>
<polygon fill="lightblue" stroke="black" points="16298,-1414 16071,-1361 16298,-1308 16525,-1361 16298,-1414"/>
<text text-anchor="middle" x="16298" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="16298" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="16298" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu13_exp2 -->
<g id="node134" class="node">
<title>l2_s2_gpu13_exp2</title>
<polygon fill="lightblue" stroke="black" points="15786,-1414 15559,-1361 15786,-1308 16013,-1361 15786,-1414"/>
<text text-anchor="middle" x="15786" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="15786" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15786" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu13_exp3 -->
<g id="node135" class="node">
<title>l2_s2_gpu13_exp3</title>
<polygon fill="lightblue" stroke="black" points="15274,-1414 15047,-1361 15274,-1308 15501,-1361 15274,-1414"/>
<text text-anchor="middle" x="15274" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="15274" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="15274" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu14_exp0 -->
<g id="node136" class="node">
<title>l2_s2_gpu14_exp0</title>
<polygon fill="lightblue" stroke="black" points="14762,-1414 14535,-1361 14762,-1308 14989,-1361 14762,-1414"/>
<text text-anchor="middle" x="14762" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="14762" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14762" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu14_exp1 -->
<g id="node137" class="node">
<title>l2_s2_gpu14_exp1</title>
<polygon fill="lightblue" stroke="black" points="14250,-1414 14023,-1361 14250,-1308 14477,-1361 14250,-1414"/>
<text text-anchor="middle" x="14250" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="14250" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="14250" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu14_exp2 -->
<g id="node138" class="node">
<title>l2_s2_gpu14_exp2</title>
<polygon fill="lightblue" stroke="black" points="13738,-1414 13511,-1361 13738,-1308 13965,-1361 13738,-1414"/>
<text text-anchor="middle" x="13738" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="13738" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13738" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu14_exp3 -->
<g id="node139" class="node">
<title>l2_s2_gpu14_exp3</title>
<polygon fill="lightblue" stroke="black" points="13226,-1414 12999,-1361 13226,-1308 13453,-1361 13226,-1414"/>
<text text-anchor="middle" x="13226" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="13226" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="13226" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu15_exp0 -->
<g id="node140" class="node">
<title>l2_s2_gpu15_exp0</title>
<polygon fill="lightblue" stroke="black" points="12714,-1414 12487,-1361 12714,-1308 12941,-1361 12714,-1414"/>
<text text-anchor="middle" x="12714" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="12714" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12714" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu15_exp1 -->
<g id="node141" class="node">
<title>l2_s2_gpu15_exp1</title>
<polygon fill="lightblue" stroke="black" points="12202,-1414 11975,-1361 12202,-1308 12429,-1361 12202,-1414"/>
<text text-anchor="middle" x="12202" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="12202" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="12202" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu15_exp2 -->
<g id="node142" class="node">
<title>l2_s2_gpu15_exp2</title>
<polygon fill="lightblue" stroke="black" points="11690,-1414 11463,-1361 11690,-1308 11917,-1361 11690,-1414"/>
<text text-anchor="middle" x="11690" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="11690" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="11690" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_gpu15_exp3 -->
<g id="node143" class="node">
<title>l2_s2_gpu15_exp3</title>
<polygon fill="lightblue" stroke="black" points="11178,-1414 10951,-1361 11178,-1308 11405,-1361 11178,-1414"/>
<text text-anchor="middle" x="11178" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="11178" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="11178" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l2_s2_agg -->
<g id="node144" class="node">
<title>l2_s2_agg</title>
<polygon fill="orange" stroke="black" points="10893.1,-1414 10531.84,-1414 10438.9,-1308 10800.16,-1308 10893.1,-1414"/>
<text text-anchor="middle" x="10666" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="10666" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="10666" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 8&#45;15</text>
</g>
<!-- l2_s2_residual -->
<g id="node145" class="node">
<title>l2_s2_residual</title>
<polygon fill="orange" stroke="black" points="10237,-1414 10093,-1361 10237,-1308 10381,-1361 10237,-1414"/>
<text text-anchor="middle" x="10237" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="10237" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="10237" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 8&#45;15</text>
</g>
<!-- l3_s1_attn -->
<g id="node146" class="node">
<title>l3_s1_attn</title>
<polygon fill="lightblue" stroke="black" points="82061,-1414 81855,-1361 82061,-1308 82267,-1361 82061,-1414"/>
<text text-anchor="middle" x="82061" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="82061" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="82061" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 0&#45;7</text>
</g>
<!-- l3_s1_route -->
<g id="node147" class="node">
<title>l3_s1_route</title>
<polygon fill="orange" stroke="black" points="81797.01,-1414 81561.56,-1414 81500.99,-1308 81736.44,-1308 81797.01,-1414"/>
<text text-anchor="middle" x="81649" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="81649" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="81649" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 0&#45;7</text>
</g>
<!-- l3_s1_gpu0_exp0 -->
<g id="node148" class="node">
<title>l3_s1_gpu0_exp0</title>
<polygon fill="lightblue" stroke="black" points="81216,-1414 80989,-1361 81216,-1308 81443,-1361 81216,-1414"/>
<text text-anchor="middle" x="81216" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 32</text>
<text text-anchor="middle" x="81216" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="81216" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu0_exp1 -->
<g id="node149" class="node">
<title>l3_s1_gpu0_exp1</title>
<polygon fill="lightblue" stroke="black" points="80704,-1414 80477,-1361 80704,-1308 80931,-1361 80704,-1414"/>
<text text-anchor="middle" x="80704" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 33</text>
<text text-anchor="middle" x="80704" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="80704" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu0_exp2 -->
<g id="node150" class="node">
<title>l3_s1_gpu0_exp2</title>
<polygon fill="lightblue" stroke="black" points="80192,-1414 79965,-1361 80192,-1308 80419,-1361 80192,-1414"/>
<text text-anchor="middle" x="80192" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 34</text>
<text text-anchor="middle" x="80192" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="80192" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu0_exp3 -->
<g id="node151" class="node">
<title>l3_s1_gpu0_exp3</title>
<polygon fill="lightblue" stroke="black" points="79680,-1414 79453,-1361 79680,-1308 79907,-1361 79680,-1414"/>
<text text-anchor="middle" x="79680" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 35</text>
<text text-anchor="middle" x="79680" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="79680" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu1_exp0 -->
<g id="node152" class="node">
<title>l3_s1_gpu1_exp0</title>
<polygon fill="lightblue" stroke="black" points="79168,-1414 78941,-1361 79168,-1308 79395,-1361 79168,-1414"/>
<text text-anchor="middle" x="79168" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 36</text>
<text text-anchor="middle" x="79168" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="79168" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu1_exp1 -->
<g id="node153" class="node">
<title>l3_s1_gpu1_exp1</title>
<polygon fill="lightblue" stroke="black" points="78656,-1414 78429,-1361 78656,-1308 78883,-1361 78656,-1414"/>
<text text-anchor="middle" x="78656" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 37</text>
<text text-anchor="middle" x="78656" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="78656" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu1_exp2 -->
<g id="node154" class="node">
<title>l3_s1_gpu1_exp2</title>
<polygon fill="lightblue" stroke="black" points="78144,-1414 77917,-1361 78144,-1308 78371,-1361 78144,-1414"/>
<text text-anchor="middle" x="78144" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 38</text>
<text text-anchor="middle" x="78144" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="78144" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu1_exp3 -->
<g id="node155" class="node">
<title>l3_s1_gpu1_exp3</title>
<polygon fill="lightblue" stroke="black" points="77632,-1414 77405,-1361 77632,-1308 77859,-1361 77632,-1414"/>
<text text-anchor="middle" x="77632" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 39</text>
<text text-anchor="middle" x="77632" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="77632" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu2_exp0 -->
<g id="node156" class="node">
<title>l3_s1_gpu2_exp0</title>
<polygon fill="lightblue" stroke="black" points="77120,-1414 76893,-1361 77120,-1308 77347,-1361 77120,-1414"/>
<text text-anchor="middle" x="77120" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="77120" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="77120" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu2_exp1 -->
<g id="node157" class="node">
<title>l3_s1_gpu2_exp1</title>
<polygon fill="lightblue" stroke="black" points="76608,-1414 76381,-1361 76608,-1308 76835,-1361 76608,-1414"/>
<text text-anchor="middle" x="76608" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="76608" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="76608" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu2_exp2 -->
<g id="node158" class="node">
<title>l3_s1_gpu2_exp2</title>
<polygon fill="lightblue" stroke="black" points="76096,-1414 75869,-1361 76096,-1308 76323,-1361 76096,-1414"/>
<text text-anchor="middle" x="76096" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="76096" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="76096" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu2_exp3 -->
<g id="node159" class="node">
<title>l3_s1_gpu2_exp3</title>
<polygon fill="lightblue" stroke="black" points="75584,-1414 75357,-1361 75584,-1308 75811,-1361 75584,-1414"/>
<text text-anchor="middle" x="75584" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="75584" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="75584" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu3_exp0 -->
<g id="node160" class="node">
<title>l3_s1_gpu3_exp0</title>
<polygon fill="lightblue" stroke="black" points="75072,-1414 74845,-1361 75072,-1308 75299,-1361 75072,-1414"/>
<text text-anchor="middle" x="75072" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="75072" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="75072" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu3_exp1 -->
<g id="node161" class="node">
<title>l3_s1_gpu3_exp1</title>
<polygon fill="lightblue" stroke="black" points="74560,-1414 74333,-1361 74560,-1308 74787,-1361 74560,-1414"/>
<text text-anchor="middle" x="74560" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="74560" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="74560" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu3_exp2 -->
<g id="node162" class="node">
<title>l3_s1_gpu3_exp2</title>
<polygon fill="lightblue" stroke="black" points="74048,-1414 73821,-1361 74048,-1308 74275,-1361 74048,-1414"/>
<text text-anchor="middle" x="74048" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="74048" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="74048" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu3_exp3 -->
<g id="node163" class="node">
<title>l3_s1_gpu3_exp3</title>
<polygon fill="lightblue" stroke="black" points="73536,-1414 73309,-1361 73536,-1308 73763,-1361 73536,-1414"/>
<text text-anchor="middle" x="73536" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="73536" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="73536" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu4_exp0 -->
<g id="node164" class="node">
<title>l3_s1_gpu4_exp0</title>
<polygon fill="lightblue" stroke="black" points="73024,-1414 72797,-1361 73024,-1308 73251,-1361 73024,-1414"/>
<text text-anchor="middle" x="73024" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="73024" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="73024" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu4_exp1 -->
<g id="node165" class="node">
<title>l3_s1_gpu4_exp1</title>
<polygon fill="lightblue" stroke="black" points="72512,-1414 72285,-1361 72512,-1308 72739,-1361 72512,-1414"/>
<text text-anchor="middle" x="72512" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="72512" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="72512" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu4_exp2 -->
<g id="node166" class="node">
<title>l3_s1_gpu4_exp2</title>
<polygon fill="lightblue" stroke="black" points="72000,-1414 71773,-1361 72000,-1308 72227,-1361 72000,-1414"/>
<text text-anchor="middle" x="72000" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="72000" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="72000" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu4_exp3 -->
<g id="node167" class="node">
<title>l3_s1_gpu4_exp3</title>
<polygon fill="lightblue" stroke="black" points="71488,-1414 71261,-1361 71488,-1308 71715,-1361 71488,-1414"/>
<text text-anchor="middle" x="71488" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="71488" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="71488" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu5_exp0 -->
<g id="node168" class="node">
<title>l3_s1_gpu5_exp0</title>
<polygon fill="lightblue" stroke="black" points="70976,-1414 70749,-1361 70976,-1308 71203,-1361 70976,-1414"/>
<text text-anchor="middle" x="70976" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="70976" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="70976" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu5_exp1 -->
<g id="node169" class="node">
<title>l3_s1_gpu5_exp1</title>
<polygon fill="lightblue" stroke="black" points="70464,-1414 70237,-1361 70464,-1308 70691,-1361 70464,-1414"/>
<text text-anchor="middle" x="70464" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="70464" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="70464" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu5_exp2 -->
<g id="node170" class="node">
<title>l3_s1_gpu5_exp2</title>
<polygon fill="lightblue" stroke="black" points="69952,-1414 69725,-1361 69952,-1308 70179,-1361 69952,-1414"/>
<text text-anchor="middle" x="69952" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="69952" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="69952" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu5_exp3 -->
<g id="node171" class="node">
<title>l3_s1_gpu5_exp3</title>
<polygon fill="lightblue" stroke="black" points="69440,-1414 69213,-1361 69440,-1308 69667,-1361 69440,-1414"/>
<text text-anchor="middle" x="69440" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="69440" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="69440" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu6_exp0 -->
<g id="node172" class="node">
<title>l3_s1_gpu6_exp0</title>
<polygon fill="lightblue" stroke="black" points="68928,-1414 68701,-1361 68928,-1308 69155,-1361 68928,-1414"/>
<text text-anchor="middle" x="68928" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="68928" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="68928" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu6_exp1 -->
<g id="node173" class="node">
<title>l3_s1_gpu6_exp1</title>
<polygon fill="lightblue" stroke="black" points="68416,-1414 68189,-1361 68416,-1308 68643,-1361 68416,-1414"/>
<text text-anchor="middle" x="68416" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="68416" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="68416" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu6_exp2 -->
<g id="node174" class="node">
<title>l3_s1_gpu6_exp2</title>
<polygon fill="lightblue" stroke="black" points="67904,-1414 67677,-1361 67904,-1308 68131,-1361 67904,-1414"/>
<text text-anchor="middle" x="67904" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="67904" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="67904" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu6_exp3 -->
<g id="node175" class="node">
<title>l3_s1_gpu6_exp3</title>
<polygon fill="lightblue" stroke="black" points="67392,-1414 67165,-1361 67392,-1308 67619,-1361 67392,-1414"/>
<text text-anchor="middle" x="67392" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="67392" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="67392" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu7_exp0 -->
<g id="node176" class="node">
<title>l3_s1_gpu7_exp0</title>
<polygon fill="lightblue" stroke="black" points="66880,-1414 66653,-1361 66880,-1308 67107,-1361 66880,-1414"/>
<text text-anchor="middle" x="66880" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="66880" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="66880" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu7_exp1 -->
<g id="node177" class="node">
<title>l3_s1_gpu7_exp1</title>
<polygon fill="lightblue" stroke="black" points="66368,-1414 66141,-1361 66368,-1308 66595,-1361 66368,-1414"/>
<text text-anchor="middle" x="66368" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="66368" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="66368" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu7_exp2 -->
<g id="node178" class="node">
<title>l3_s1_gpu7_exp2</title>
<polygon fill="lightblue" stroke="black" points="65856,-1414 65629,-1361 65856,-1308 66083,-1361 65856,-1414"/>
<text text-anchor="middle" x="65856" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="65856" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="65856" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_gpu7_exp3 -->
<g id="node179" class="node">
<title>l3_s1_gpu7_exp3</title>
<polygon fill="lightblue" stroke="black" points="65344,-1414 65117,-1361 65344,-1308 65571,-1361 65344,-1414"/>
<text text-anchor="middle" x="65344" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="65344" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="65344" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s1_agg -->
<g id="node180" class="node">
<title>l3_s1_agg</title>
<polygon fill="orange" stroke="black" points="65058.94,-1414 64712.25,-1414 64623.06,-1308 64969.75,-1308 65058.94,-1414"/>
<text text-anchor="middle" x="64841" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="64841" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="64841" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 0&#45;7</text>
</g>
<!-- l3_s1_residual -->
<g id="node181" class="node">
<title>l3_s1_residual</title>
<polygon fill="orange" stroke="black" points="64430,-1414 64295,-1361 64430,-1308 64565,-1361 64430,-1414"/>
<text text-anchor="middle" x="64430" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="64430" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="64430" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 0&#45;7</text>
</g>
<!-- l3_s2_attn -->
<g id="node182" class="node">
<title>l3_s2_attn</title>
<polygon fill="lightblue" stroke="black" points="64031,-1414 63825,-1361 64031,-1308 64237,-1361 64031,-1414"/>
<text text-anchor="middle" x="64031" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="64031" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="64031" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 8&#45;15</text>
</g>
<!-- l3_s2_route -->
<g id="node183" class="node">
<title>l3_s2_route</title>
<polygon fill="orange" stroke="black" points="63766.67,-1414 63515.85,-1414 63451.33,-1308 63702.15,-1308 63766.67,-1414"/>
<text text-anchor="middle" x="63609" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="63609" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="63609" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 8&#45;15</text>
</g>
<!-- l3_s2_gpu8_exp0 -->
<g id="node184" class="node">
<title>l3_s2_gpu8_exp0</title>
<polygon fill="lightblue" stroke="black" points="63166,-1414 62939,-1361 63166,-1308 63393,-1361 63166,-1414"/>
<text text-anchor="middle" x="63166" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 40</text>
<text text-anchor="middle" x="63166" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="63166" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu8_exp1 -->
<g id="node185" class="node">
<title>l3_s2_gpu8_exp1</title>
<polygon fill="lightblue" stroke="black" points="62654,-1414 62427,-1361 62654,-1308 62881,-1361 62654,-1414"/>
<text text-anchor="middle" x="62654" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 41</text>
<text text-anchor="middle" x="62654" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="62654" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu8_exp2 -->
<g id="node186" class="node">
<title>l3_s2_gpu8_exp2</title>
<polygon fill="lightblue" stroke="black" points="62142,-1414 61915,-1361 62142,-1308 62369,-1361 62142,-1414"/>
<text text-anchor="middle" x="62142" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 42</text>
<text text-anchor="middle" x="62142" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="62142" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu8_exp3 -->
<g id="node187" class="node">
<title>l3_s2_gpu8_exp3</title>
<polygon fill="lightblue" stroke="black" points="61630,-1414 61403,-1361 61630,-1308 61857,-1361 61630,-1414"/>
<text text-anchor="middle" x="61630" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 43</text>
<text text-anchor="middle" x="61630" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="61630" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu9_exp0 -->
<g id="node188" class="node">
<title>l3_s2_gpu9_exp0</title>
<polygon fill="lightblue" stroke="black" points="61118,-1414 60891,-1361 61118,-1308 61345,-1361 61118,-1414"/>
<text text-anchor="middle" x="61118" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 44</text>
<text text-anchor="middle" x="61118" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="61118" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu9_exp1 -->
<g id="node189" class="node">
<title>l3_s2_gpu9_exp1</title>
<polygon fill="lightblue" stroke="black" points="60606,-1414 60379,-1361 60606,-1308 60833,-1361 60606,-1414"/>
<text text-anchor="middle" x="60606" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 45</text>
<text text-anchor="middle" x="60606" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="60606" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu9_exp2 -->
<g id="node190" class="node">
<title>l3_s2_gpu9_exp2</title>
<polygon fill="lightblue" stroke="black" points="60094,-1414 59867,-1361 60094,-1308 60321,-1361 60094,-1414"/>
<text text-anchor="middle" x="60094" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 46</text>
<text text-anchor="middle" x="60094" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="60094" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu9_exp3 -->
<g id="node191" class="node">
<title>l3_s2_gpu9_exp3</title>
<polygon fill="lightblue" stroke="black" points="59582,-1414 59355,-1361 59582,-1308 59809,-1361 59582,-1414"/>
<text text-anchor="middle" x="59582" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 47</text>
<text text-anchor="middle" x="59582" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="59582" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu10_exp0 -->
<g id="node192" class="node">
<title>l3_s2_gpu10_exp0</title>
<polygon fill="lightblue" stroke="black" points="59070,-1414 58843,-1361 59070,-1308 59297,-1361 59070,-1414"/>
<text text-anchor="middle" x="59070" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="59070" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="59070" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu10_exp1 -->
<g id="node193" class="node">
<title>l3_s2_gpu10_exp1</title>
<polygon fill="lightblue" stroke="black" points="58558,-1414 58331,-1361 58558,-1308 58785,-1361 58558,-1414"/>
<text text-anchor="middle" x="58558" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="58558" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="58558" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu10_exp2 -->
<g id="node194" class="node">
<title>l3_s2_gpu10_exp2</title>
<polygon fill="lightblue" stroke="black" points="58046,-1414 57819,-1361 58046,-1308 58273,-1361 58046,-1414"/>
<text text-anchor="middle" x="58046" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="58046" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="58046" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu10_exp3 -->
<g id="node195" class="node">
<title>l3_s2_gpu10_exp3</title>
<polygon fill="lightblue" stroke="black" points="57534,-1414 57307,-1361 57534,-1308 57761,-1361 57534,-1414"/>
<text text-anchor="middle" x="57534" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="57534" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="57534" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu11_exp0 -->
<g id="node196" class="node">
<title>l3_s2_gpu11_exp0</title>
<polygon fill="lightblue" stroke="black" points="57022,-1414 56795,-1361 57022,-1308 57249,-1361 57022,-1414"/>
<text text-anchor="middle" x="57022" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="57022" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="57022" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu11_exp1 -->
<g id="node197" class="node">
<title>l3_s2_gpu11_exp1</title>
<polygon fill="lightblue" stroke="black" points="56510,-1414 56283,-1361 56510,-1308 56737,-1361 56510,-1414"/>
<text text-anchor="middle" x="56510" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="56510" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="56510" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu11_exp2 -->
<g id="node198" class="node">
<title>l3_s2_gpu11_exp2</title>
<polygon fill="lightblue" stroke="black" points="55998,-1414 55771,-1361 55998,-1308 56225,-1361 55998,-1414"/>
<text text-anchor="middle" x="55998" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="55998" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="55998" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu11_exp3 -->
<g id="node199" class="node">
<title>l3_s2_gpu11_exp3</title>
<polygon fill="lightblue" stroke="black" points="55486,-1414 55259,-1361 55486,-1308 55713,-1361 55486,-1414"/>
<text text-anchor="middle" x="55486" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="55486" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="55486" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu12_exp0 -->
<g id="node200" class="node">
<title>l3_s2_gpu12_exp0</title>
<polygon fill="lightblue" stroke="black" points="54974,-1414 54747,-1361 54974,-1308 55201,-1361 54974,-1414"/>
<text text-anchor="middle" x="54974" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="54974" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="54974" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu12_exp1 -->
<g id="node201" class="node">
<title>l3_s2_gpu12_exp1</title>
<polygon fill="lightblue" stroke="black" points="54462,-1414 54235,-1361 54462,-1308 54689,-1361 54462,-1414"/>
<text text-anchor="middle" x="54462" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="54462" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="54462" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu12_exp2 -->
<g id="node202" class="node">
<title>l3_s2_gpu12_exp2</title>
<polygon fill="lightblue" stroke="black" points="53950,-1414 53723,-1361 53950,-1308 54177,-1361 53950,-1414"/>
<text text-anchor="middle" x="53950" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="53950" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="53950" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu12_exp3 -->
<g id="node203" class="node">
<title>l3_s2_gpu12_exp3</title>
<polygon fill="lightblue" stroke="black" points="53438,-1414 53211,-1361 53438,-1308 53665,-1361 53438,-1414"/>
<text text-anchor="middle" x="53438" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="53438" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="53438" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu13_exp0 -->
<g id="node204" class="node">
<title>l3_s2_gpu13_exp0</title>
<polygon fill="lightblue" stroke="black" points="52926,-1414 52699,-1361 52926,-1308 53153,-1361 52926,-1414"/>
<text text-anchor="middle" x="52926" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="52926" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="52926" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu13_exp1 -->
<g id="node205" class="node">
<title>l3_s2_gpu13_exp1</title>
<polygon fill="lightblue" stroke="black" points="52414,-1414 52187,-1361 52414,-1308 52641,-1361 52414,-1414"/>
<text text-anchor="middle" x="52414" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="52414" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="52414" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu13_exp2 -->
<g id="node206" class="node">
<title>l3_s2_gpu13_exp2</title>
<polygon fill="lightblue" stroke="black" points="51902,-1414 51675,-1361 51902,-1308 52129,-1361 51902,-1414"/>
<text text-anchor="middle" x="51902" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="51902" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="51902" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu13_exp3 -->
<g id="node207" class="node">
<title>l3_s2_gpu13_exp3</title>
<polygon fill="lightblue" stroke="black" points="51390,-1414 51163,-1361 51390,-1308 51617,-1361 51390,-1414"/>
<text text-anchor="middle" x="51390" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="51390" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="51390" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu14_exp0 -->
<g id="node208" class="node">
<title>l3_s2_gpu14_exp0</title>
<polygon fill="lightblue" stroke="black" points="50878,-1414 50651,-1361 50878,-1308 51105,-1361 50878,-1414"/>
<text text-anchor="middle" x="50878" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 64</text>
<text text-anchor="middle" x="50878" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="50878" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu14_exp1 -->
<g id="node209" class="node">
<title>l3_s2_gpu14_exp1</title>
<polygon fill="lightblue" stroke="black" points="50366,-1414 50139,-1361 50366,-1308 50593,-1361 50366,-1414"/>
<text text-anchor="middle" x="50366" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 65</text>
<text text-anchor="middle" x="50366" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="50366" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu14_exp2 -->
<g id="node210" class="node">
<title>l3_s2_gpu14_exp2</title>
<polygon fill="lightblue" stroke="black" points="49854,-1414 49627,-1361 49854,-1308 50081,-1361 49854,-1414"/>
<text text-anchor="middle" x="49854" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 66</text>
<text text-anchor="middle" x="49854" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="49854" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu14_exp3 -->
<g id="node211" class="node">
<title>l3_s2_gpu14_exp3</title>
<polygon fill="lightblue" stroke="black" points="49342,-1414 49115,-1361 49342,-1308 49569,-1361 49342,-1414"/>
<text text-anchor="middle" x="49342" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 67</text>
<text text-anchor="middle" x="49342" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="49342" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu15_exp0 -->
<g id="node212" class="node">
<title>l3_s2_gpu15_exp0</title>
<polygon fill="lightblue" stroke="black" points="48830,-1414 48603,-1361 48830,-1308 49057,-1361 48830,-1414"/>
<text text-anchor="middle" x="48830" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 68</text>
<text text-anchor="middle" x="48830" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="48830" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu15_exp1 -->
<g id="node213" class="node">
<title>l3_s2_gpu15_exp1</title>
<polygon fill="lightblue" stroke="black" points="48318,-1414 48091,-1361 48318,-1308 48545,-1361 48318,-1414"/>
<text text-anchor="middle" x="48318" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 69</text>
<text text-anchor="middle" x="48318" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="48318" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu15_exp2 -->
<g id="node214" class="node">
<title>l3_s2_gpu15_exp2</title>
<polygon fill="lightblue" stroke="black" points="47806,-1414 47579,-1361 47806,-1308 48033,-1361 47806,-1414"/>
<text text-anchor="middle" x="47806" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 70</text>
<text text-anchor="middle" x="47806" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="47806" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_gpu15_exp3 -->
<g id="node215" class="node">
<title>l3_s2_gpu15_exp3</title>
<polygon fill="lightblue" stroke="black" points="47294,-1414 47067,-1361 47294,-1308 47521,-1361 47294,-1414"/>
<text text-anchor="middle" x="47294" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 71</text>
<text text-anchor="middle" x="47294" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="47294" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l3_s2_agg -->
<g id="node216" class="node">
<title>l3_s2_agg</title>
<polygon fill="orange" stroke="black" points="47009.1,-1414 46647.84,-1414 46554.9,-1308 46916.16,-1308 47009.1,-1414"/>
<text text-anchor="middle" x="46782" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="46782" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="46782" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 8&#45;15</text>
</g>
<!-- l3_s2_residual -->
<g id="node217" class="node">
<title>l3_s2_residual</title>
<polygon fill="orange" stroke="black" points="46353,-1414 46209,-1361 46353,-1308 46497,-1361 46353,-1414"/>
<text text-anchor="middle" x="46353" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="46353" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="46353" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 8&#45;15</text>
</g>
<!-- l4_s1_attn -->
<g id="node218" class="node">
<title>l4_s1_attn</title>
<polygon fill="lightblue" stroke="black" points="118177,-1414 117971,-1361 118177,-1308 118383,-1361 118177,-1414"/>
<text text-anchor="middle" x="118177" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="118177" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="118177" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 0&#45;7</text>
</g>
<!-- l4_s1_route -->
<g id="node219" class="node">
<title>l4_s1_route</title>
<polygon fill="orange" stroke="black" points="117913.01,-1414 117677.56,-1414 117616.99,-1308 117852.44,-1308 117913.01,-1414"/>
<text text-anchor="middle" x="117765" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="117765" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="117765" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 0&#45;7</text>
</g>
<!-- l4_s1_gpu0_exp0 -->
<g id="node220" class="node">
<title>l4_s1_gpu0_exp0</title>
<polygon fill="lightblue" stroke="black" points="117332,-1414 117105,-1361 117332,-1308 117559,-1361 117332,-1414"/>
<text text-anchor="middle" x="117332" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 48</text>
<text text-anchor="middle" x="117332" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="117332" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu0_exp1 -->
<g id="node221" class="node">
<title>l4_s1_gpu0_exp1</title>
<polygon fill="lightblue" stroke="black" points="116820,-1414 116593,-1361 116820,-1308 117047,-1361 116820,-1414"/>
<text text-anchor="middle" x="116820" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 49</text>
<text text-anchor="middle" x="116820" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="116820" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu0_exp2 -->
<g id="node222" class="node">
<title>l4_s1_gpu0_exp2</title>
<polygon fill="lightblue" stroke="black" points="116308,-1414 116081,-1361 116308,-1308 116535,-1361 116308,-1414"/>
<text text-anchor="middle" x="116308" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 50</text>
<text text-anchor="middle" x="116308" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="116308" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu0_exp3 -->
<g id="node223" class="node">
<title>l4_s1_gpu0_exp3</title>
<polygon fill="lightblue" stroke="black" points="115796,-1414 115569,-1361 115796,-1308 116023,-1361 115796,-1414"/>
<text text-anchor="middle" x="115796" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 51</text>
<text text-anchor="middle" x="115796" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 0</text>
<text text-anchor="middle" x="115796" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu1_exp0 -->
<g id="node224" class="node">
<title>l4_s1_gpu1_exp0</title>
<polygon fill="lightblue" stroke="black" points="115284,-1414 115057,-1361 115284,-1308 115511,-1361 115284,-1414"/>
<text text-anchor="middle" x="115284" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 52</text>
<text text-anchor="middle" x="115284" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="115284" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu1_exp1 -->
<g id="node225" class="node">
<title>l4_s1_gpu1_exp1</title>
<polygon fill="lightblue" stroke="black" points="114772,-1414 114545,-1361 114772,-1308 114999,-1361 114772,-1414"/>
<text text-anchor="middle" x="114772" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 53</text>
<text text-anchor="middle" x="114772" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="114772" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu1_exp2 -->
<g id="node226" class="node">
<title>l4_s1_gpu1_exp2</title>
<polygon fill="lightblue" stroke="black" points="114260,-1414 114033,-1361 114260,-1308 114487,-1361 114260,-1414"/>
<text text-anchor="middle" x="114260" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 54</text>
<text text-anchor="middle" x="114260" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="114260" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu1_exp3 -->
<g id="node227" class="node">
<title>l4_s1_gpu1_exp3</title>
<polygon fill="lightblue" stroke="black" points="113748,-1414 113521,-1361 113748,-1308 113975,-1361 113748,-1414"/>
<text text-anchor="middle" x="113748" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 55</text>
<text text-anchor="middle" x="113748" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="113748" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu2_exp0 -->
<g id="node228" class="node">
<title>l4_s1_gpu2_exp0</title>
<polygon fill="lightblue" stroke="black" points="113236,-1414 113009,-1361 113236,-1308 113463,-1361 113236,-1414"/>
<text text-anchor="middle" x="113236" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="113236" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="113236" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu2_exp1 -->
<g id="node229" class="node">
<title>l4_s1_gpu2_exp1</title>
<polygon fill="lightblue" stroke="black" points="112724,-1414 112497,-1361 112724,-1308 112951,-1361 112724,-1414"/>
<text text-anchor="middle" x="112724" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="112724" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="112724" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu2_exp2 -->
<g id="node230" class="node">
<title>l4_s1_gpu2_exp2</title>
<polygon fill="lightblue" stroke="black" points="112212,-1414 111985,-1361 112212,-1308 112439,-1361 112212,-1414"/>
<text text-anchor="middle" x="112212" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="112212" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="112212" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu2_exp3 -->
<g id="node231" class="node">
<title>l4_s1_gpu2_exp3</title>
<polygon fill="lightblue" stroke="black" points="111700,-1414 111473,-1361 111700,-1308 111927,-1361 111700,-1414"/>
<text text-anchor="middle" x="111700" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="111700" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="111700" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu3_exp0 -->
<g id="node232" class="node">
<title>l4_s1_gpu3_exp0</title>
<polygon fill="lightblue" stroke="black" points="111188,-1414 110961,-1361 111188,-1308 111415,-1361 111188,-1414"/>
<text text-anchor="middle" x="111188" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="111188" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="111188" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu3_exp1 -->
<g id="node233" class="node">
<title>l4_s1_gpu3_exp1</title>
<polygon fill="lightblue" stroke="black" points="110676,-1414 110449,-1361 110676,-1308 110903,-1361 110676,-1414"/>
<text text-anchor="middle" x="110676" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="110676" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="110676" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu3_exp2 -->
<g id="node234" class="node">
<title>l4_s1_gpu3_exp2</title>
<polygon fill="lightblue" stroke="black" points="110164,-1414 109937,-1361 110164,-1308 110391,-1361 110164,-1414"/>
<text text-anchor="middle" x="110164" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="110164" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="110164" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu3_exp3 -->
<g id="node235" class="node">
<title>l4_s1_gpu3_exp3</title>
<polygon fill="lightblue" stroke="black" points="109652,-1414 109425,-1361 109652,-1308 109879,-1361 109652,-1414"/>
<text text-anchor="middle" x="109652" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="109652" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="109652" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu4_exp0 -->
<g id="node236" class="node">
<title>l4_s1_gpu4_exp0</title>
<polygon fill="lightblue" stroke="black" points="109140,-1414 108913,-1361 109140,-1308 109367,-1361 109140,-1414"/>
<text text-anchor="middle" x="109140" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 64</text>
<text text-anchor="middle" x="109140" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="109140" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu4_exp1 -->
<g id="node237" class="node">
<title>l4_s1_gpu4_exp1</title>
<polygon fill="lightblue" stroke="black" points="108628,-1414 108401,-1361 108628,-1308 108855,-1361 108628,-1414"/>
<text text-anchor="middle" x="108628" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 65</text>
<text text-anchor="middle" x="108628" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="108628" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu4_exp2 -->
<g id="node238" class="node">
<title>l4_s1_gpu4_exp2</title>
<polygon fill="lightblue" stroke="black" points="108116,-1414 107889,-1361 108116,-1308 108343,-1361 108116,-1414"/>
<text text-anchor="middle" x="108116" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 66</text>
<text text-anchor="middle" x="108116" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="108116" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu4_exp3 -->
<g id="node239" class="node">
<title>l4_s1_gpu4_exp3</title>
<polygon fill="lightblue" stroke="black" points="107604,-1414 107377,-1361 107604,-1308 107831,-1361 107604,-1414"/>
<text text-anchor="middle" x="107604" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 67</text>
<text text-anchor="middle" x="107604" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="107604" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu5_exp0 -->
<g id="node240" class="node">
<title>l4_s1_gpu5_exp0</title>
<polygon fill="lightblue" stroke="black" points="107092,-1414 106865,-1361 107092,-1308 107319,-1361 107092,-1414"/>
<text text-anchor="middle" x="107092" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 68</text>
<text text-anchor="middle" x="107092" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="107092" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu5_exp1 -->
<g id="node241" class="node">
<title>l4_s1_gpu5_exp1</title>
<polygon fill="lightblue" stroke="black" points="106580,-1414 106353,-1361 106580,-1308 106807,-1361 106580,-1414"/>
<text text-anchor="middle" x="106580" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 69</text>
<text text-anchor="middle" x="106580" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="106580" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu5_exp2 -->
<g id="node242" class="node">
<title>l4_s1_gpu5_exp2</title>
<polygon fill="lightblue" stroke="black" points="106068,-1414 105841,-1361 106068,-1308 106295,-1361 106068,-1414"/>
<text text-anchor="middle" x="106068" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 70</text>
<text text-anchor="middle" x="106068" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="106068" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu5_exp3 -->
<g id="node243" class="node">
<title>l4_s1_gpu5_exp3</title>
<polygon fill="lightblue" stroke="black" points="105556,-1414 105329,-1361 105556,-1308 105783,-1361 105556,-1414"/>
<text text-anchor="middle" x="105556" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 71</text>
<text text-anchor="middle" x="105556" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="105556" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu6_exp0 -->
<g id="node244" class="node">
<title>l4_s1_gpu6_exp0</title>
<polygon fill="lightblue" stroke="black" points="105044,-1414 104817,-1361 105044,-1308 105271,-1361 105044,-1414"/>
<text text-anchor="middle" x="105044" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 72</text>
<text text-anchor="middle" x="105044" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="105044" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu6_exp1 -->
<g id="node245" class="node">
<title>l4_s1_gpu6_exp1</title>
<polygon fill="lightblue" stroke="black" points="104532,-1414 104305,-1361 104532,-1308 104759,-1361 104532,-1414"/>
<text text-anchor="middle" x="104532" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 73</text>
<text text-anchor="middle" x="104532" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="104532" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu6_exp2 -->
<g id="node246" class="node">
<title>l4_s1_gpu6_exp2</title>
<polygon fill="lightblue" stroke="black" points="104020,-1414 103793,-1361 104020,-1308 104247,-1361 104020,-1414"/>
<text text-anchor="middle" x="104020" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 74</text>
<text text-anchor="middle" x="104020" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="104020" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu6_exp3 -->
<g id="node247" class="node">
<title>l4_s1_gpu6_exp3</title>
<polygon fill="lightblue" stroke="black" points="103508,-1414 103281,-1361 103508,-1308 103735,-1361 103508,-1414"/>
<text text-anchor="middle" x="103508" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 75</text>
<text text-anchor="middle" x="103508" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="103508" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu7_exp0 -->
<g id="node248" class="node">
<title>l4_s1_gpu7_exp0</title>
<polygon fill="lightblue" stroke="black" points="102996,-1414 102769,-1361 102996,-1308 103223,-1361 102996,-1414"/>
<text text-anchor="middle" x="102996" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 76</text>
<text text-anchor="middle" x="102996" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="102996" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu7_exp1 -->
<g id="node249" class="node">
<title>l4_s1_gpu7_exp1</title>
<polygon fill="lightblue" stroke="black" points="102484,-1414 102257,-1361 102484,-1308 102711,-1361 102484,-1414"/>
<text text-anchor="middle" x="102484" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 77</text>
<text text-anchor="middle" x="102484" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="102484" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu7_exp2 -->
<g id="node250" class="node">
<title>l4_s1_gpu7_exp2</title>
<polygon fill="lightblue" stroke="black" points="101972,-1414 101745,-1361 101972,-1308 102199,-1361 101972,-1414"/>
<text text-anchor="middle" x="101972" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 78</text>
<text text-anchor="middle" x="101972" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="101972" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_gpu7_exp3 -->
<g id="node251" class="node">
<title>l4_s1_gpu7_exp3</title>
<polygon fill="lightblue" stroke="black" points="101460,-1414 101233,-1361 101460,-1308 101687,-1361 101460,-1414"/>
<text text-anchor="middle" x="101460" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 79</text>
<text text-anchor="middle" x="101460" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="101460" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s1_agg -->
<g id="node252" class="node">
<title>l4_s1_agg</title>
<polygon fill="orange" stroke="black" points="101174.94,-1414 100828.25,-1414 100739.06,-1308 101085.75,-1308 101174.94,-1414"/>
<text text-anchor="middle" x="100957" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="100957" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="100957" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 0&#45;7</text>
</g>
<!-- l4_s1_residual -->
<g id="node253" class="node">
<title>l4_s1_residual</title>
<polygon fill="orange" stroke="black" points="100546,-1414 100411,-1361 100546,-1308 100681,-1361 100546,-1414"/>
<text text-anchor="middle" x="100546" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="100546" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="100546" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 0&#45;7</text>
</g>
<!-- l4_s2_attn -->
<g id="node254" class="node">
<title>l4_s2_attn</title>
<polygon fill="lightblue" stroke="black" points="100147,-1414 99941,-1361 100147,-1308 100353,-1361 100147,-1414"/>
<text text-anchor="middle" x="100147" y="-1372.3" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
<text text-anchor="middle" x="100147" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="100147" y="-1342.3" font-family="Times,serif" font-size="14.00">TP across GPUs 8&#45;15</text>
</g>
<!-- l4_s2_route -->
<g id="node255" class="node">
<title>l4_s2_route</title>
<polygon fill="orange" stroke="black" points="99882.67,-1414 99631.85,-1414 99567.33,-1308 99818.15,-1308 99882.67,-1414"/>
<text text-anchor="middle" x="99725" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Routing</text>
<text text-anchor="middle" x="99725" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="99725" y="-1342.3" font-family="Times,serif" font-size="14.00">Gate on GPUs 8&#45;15</text>
</g>
<!-- l4_s2_gpu8_exp0 -->
<g id="node256" class="node">
<title>l4_s2_gpu8_exp0</title>
<polygon fill="lightblue" stroke="black" points="99282,-1414 99055,-1361 99282,-1308 99509,-1361 99282,-1414"/>
<text text-anchor="middle" x="99282" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 56</text>
<text text-anchor="middle" x="99282" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="99282" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu8_exp1 -->
<g id="node257" class="node">
<title>l4_s2_gpu8_exp1</title>
<polygon fill="lightblue" stroke="black" points="98770,-1414 98543,-1361 98770,-1308 98997,-1361 98770,-1414"/>
<text text-anchor="middle" x="98770" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 57</text>
<text text-anchor="middle" x="98770" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="98770" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu8_exp2 -->
<g id="node258" class="node">
<title>l4_s2_gpu8_exp2</title>
<polygon fill="lightblue" stroke="black" points="98258,-1414 98031,-1361 98258,-1308 98485,-1361 98258,-1414"/>
<text text-anchor="middle" x="98258" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 58</text>
<text text-anchor="middle" x="98258" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="98258" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu8_exp3 -->
<g id="node259" class="node">
<title>l4_s2_gpu8_exp3</title>
<polygon fill="lightblue" stroke="black" points="97746,-1414 97519,-1361 97746,-1308 97973,-1361 97746,-1414"/>
<text text-anchor="middle" x="97746" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 59</text>
<text text-anchor="middle" x="97746" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="97746" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu9_exp0 -->
<g id="node260" class="node">
<title>l4_s2_gpu9_exp0</title>
<polygon fill="lightblue" stroke="black" points="97234,-1414 97007,-1361 97234,-1308 97461,-1361 97234,-1414"/>
<text text-anchor="middle" x="97234" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 60</text>
<text text-anchor="middle" x="97234" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="97234" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu9_exp1 -->
<g id="node261" class="node">
<title>l4_s2_gpu9_exp1</title>
<polygon fill="lightblue" stroke="black" points="96722,-1414 96495,-1361 96722,-1308 96949,-1361 96722,-1414"/>
<text text-anchor="middle" x="96722" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 61</text>
<text text-anchor="middle" x="96722" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="96722" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu9_exp2 -->
<g id="node262" class="node">
<title>l4_s2_gpu9_exp2</title>
<polygon fill="lightblue" stroke="black" points="96210,-1414 95983,-1361 96210,-1308 96437,-1361 96210,-1414"/>
<text text-anchor="middle" x="96210" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 62</text>
<text text-anchor="middle" x="96210" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="96210" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu9_exp3 -->
<g id="node263" class="node">
<title>l4_s2_gpu9_exp3</title>
<polygon fill="lightblue" stroke="black" points="95698,-1414 95471,-1361 95698,-1308 95925,-1361 95698,-1414"/>
<text text-anchor="middle" x="95698" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 63</text>
<text text-anchor="middle" x="95698" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 9</text>
<text text-anchor="middle" x="95698" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu10_exp0 -->
<g id="node264" class="node">
<title>l4_s2_gpu10_exp0</title>
<polygon fill="lightblue" stroke="black" points="95186,-1414 94959,-1361 95186,-1308 95413,-1361 95186,-1414"/>
<text text-anchor="middle" x="95186" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 64</text>
<text text-anchor="middle" x="95186" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="95186" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu10_exp1 -->
<g id="node265" class="node">
<title>l4_s2_gpu10_exp1</title>
<polygon fill="lightblue" stroke="black" points="94674,-1414 94447,-1361 94674,-1308 94901,-1361 94674,-1414"/>
<text text-anchor="middle" x="94674" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 65</text>
<text text-anchor="middle" x="94674" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="94674" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu10_exp2 -->
<g id="node266" class="node">
<title>l4_s2_gpu10_exp2</title>
<polygon fill="lightblue" stroke="black" points="94162,-1414 93935,-1361 94162,-1308 94389,-1361 94162,-1414"/>
<text text-anchor="middle" x="94162" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 66</text>
<text text-anchor="middle" x="94162" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="94162" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu10_exp3 -->
<g id="node267" class="node">
<title>l4_s2_gpu10_exp3</title>
<polygon fill="lightblue" stroke="black" points="93650,-1414 93423,-1361 93650,-1308 93877,-1361 93650,-1414"/>
<text text-anchor="middle" x="93650" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 67</text>
<text text-anchor="middle" x="93650" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 10</text>
<text text-anchor="middle" x="93650" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu11_exp0 -->
<g id="node268" class="node">
<title>l4_s2_gpu11_exp0</title>
<polygon fill="lightblue" stroke="black" points="93138,-1414 92911,-1361 93138,-1308 93365,-1361 93138,-1414"/>
<text text-anchor="middle" x="93138" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 68</text>
<text text-anchor="middle" x="93138" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="93138" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu11_exp1 -->
<g id="node269" class="node">
<title>l4_s2_gpu11_exp1</title>
<polygon fill="lightblue" stroke="black" points="92626,-1414 92399,-1361 92626,-1308 92853,-1361 92626,-1414"/>
<text text-anchor="middle" x="92626" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 69</text>
<text text-anchor="middle" x="92626" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="92626" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu11_exp2 -->
<g id="node270" class="node">
<title>l4_s2_gpu11_exp2</title>
<polygon fill="lightblue" stroke="black" points="92114,-1414 91887,-1361 92114,-1308 92341,-1361 92114,-1414"/>
<text text-anchor="middle" x="92114" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 70</text>
<text text-anchor="middle" x="92114" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="92114" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu11_exp3 -->
<g id="node271" class="node">
<title>l4_s2_gpu11_exp3</title>
<polygon fill="lightblue" stroke="black" points="91602,-1414 91375,-1361 91602,-1308 91829,-1361 91602,-1414"/>
<text text-anchor="middle" x="91602" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 71</text>
<text text-anchor="middle" x="91602" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 11</text>
<text text-anchor="middle" x="91602" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu12_exp0 -->
<g id="node272" class="node">
<title>l4_s2_gpu12_exp0</title>
<polygon fill="lightblue" stroke="black" points="91090,-1414 90863,-1361 91090,-1308 91317,-1361 91090,-1414"/>
<text text-anchor="middle" x="91090" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 72</text>
<text text-anchor="middle" x="91090" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="91090" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu12_exp1 -->
<g id="node273" class="node">
<title>l4_s2_gpu12_exp1</title>
<polygon fill="lightblue" stroke="black" points="90578,-1414 90351,-1361 90578,-1308 90805,-1361 90578,-1414"/>
<text text-anchor="middle" x="90578" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 73</text>
<text text-anchor="middle" x="90578" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="90578" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu12_exp2 -->
<g id="node274" class="node">
<title>l4_s2_gpu12_exp2</title>
<polygon fill="lightblue" stroke="black" points="90066,-1414 89839,-1361 90066,-1308 90293,-1361 90066,-1414"/>
<text text-anchor="middle" x="90066" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 74</text>
<text text-anchor="middle" x="90066" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="90066" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu12_exp3 -->
<g id="node275" class="node">
<title>l4_s2_gpu12_exp3</title>
<polygon fill="lightblue" stroke="black" points="89554,-1414 89327,-1361 89554,-1308 89781,-1361 89554,-1414"/>
<text text-anchor="middle" x="89554" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 75</text>
<text text-anchor="middle" x="89554" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 12</text>
<text text-anchor="middle" x="89554" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu13_exp0 -->
<g id="node276" class="node">
<title>l4_s2_gpu13_exp0</title>
<polygon fill="lightblue" stroke="black" points="89042,-1414 88815,-1361 89042,-1308 89269,-1361 89042,-1414"/>
<text text-anchor="middle" x="89042" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 76</text>
<text text-anchor="middle" x="89042" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="89042" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu13_exp1 -->
<g id="node277" class="node">
<title>l4_s2_gpu13_exp1</title>
<polygon fill="lightblue" stroke="black" points="88530,-1414 88303,-1361 88530,-1308 88757,-1361 88530,-1414"/>
<text text-anchor="middle" x="88530" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 77</text>
<text text-anchor="middle" x="88530" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="88530" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu13_exp2 -->
<g id="node278" class="node">
<title>l4_s2_gpu13_exp2</title>
<polygon fill="lightblue" stroke="black" points="88018,-1414 87791,-1361 88018,-1308 88245,-1361 88018,-1414"/>
<text text-anchor="middle" x="88018" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 78</text>
<text text-anchor="middle" x="88018" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="88018" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu13_exp3 -->
<g id="node279" class="node">
<title>l4_s2_gpu13_exp3</title>
<polygon fill="lightblue" stroke="black" points="87506,-1414 87279,-1361 87506,-1308 87733,-1361 87506,-1414"/>
<text text-anchor="middle" x="87506" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 79</text>
<text text-anchor="middle" x="87506" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 13</text>
<text text-anchor="middle" x="87506" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu14_exp0 -->
<g id="node280" class="node">
<title>l4_s2_gpu14_exp0</title>
<polygon fill="lightblue" stroke="black" points="86994,-1414 86767,-1361 86994,-1308 87221,-1361 86994,-1414"/>
<text text-anchor="middle" x="86994" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 80</text>
<text text-anchor="middle" x="86994" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="86994" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu14_exp1 -->
<g id="node281" class="node">
<title>l4_s2_gpu14_exp1</title>
<polygon fill="lightblue" stroke="black" points="86482,-1414 86255,-1361 86482,-1308 86709,-1361 86482,-1414"/>
<text text-anchor="middle" x="86482" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 81</text>
<text text-anchor="middle" x="86482" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="86482" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu14_exp2 -->
<g id="node282" class="node">
<title>l4_s2_gpu14_exp2</title>
<polygon fill="lightblue" stroke="black" points="85970,-1414 85743,-1361 85970,-1308 86197,-1361 85970,-1414"/>
<text text-anchor="middle" x="85970" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 82</text>
<text text-anchor="middle" x="85970" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="85970" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu14_exp3 -->
<g id="node283" class="node">
<title>l4_s2_gpu14_exp3</title>
<polygon fill="lightblue" stroke="black" points="85458,-1414 85231,-1361 85458,-1308 85685,-1361 85458,-1414"/>
<text text-anchor="middle" x="85458" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 83</text>
<text text-anchor="middle" x="85458" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 14</text>
<text text-anchor="middle" x="85458" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu15_exp0 -->
<g id="node284" class="node">
<title>l4_s2_gpu15_exp0</title>
<polygon fill="lightblue" stroke="black" points="84946,-1414 84719,-1361 84946,-1308 85173,-1361 84946,-1414"/>
<text text-anchor="middle" x="84946" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 84</text>
<text text-anchor="middle" x="84946" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="84946" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu15_exp1 -->
<g id="node285" class="node">
<title>l4_s2_gpu15_exp1</title>
<polygon fill="lightblue" stroke="black" points="84434,-1414 84207,-1361 84434,-1308 84661,-1361 84434,-1414"/>
<text text-anchor="middle" x="84434" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 85</text>
<text text-anchor="middle" x="84434" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="84434" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu15_exp2 -->
<g id="node286" class="node">
<title>l4_s2_gpu15_exp2</title>
<polygon fill="lightblue" stroke="black" points="83922,-1414 83695,-1361 83922,-1308 84149,-1361 83922,-1414"/>
<text text-anchor="middle" x="83922" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 86</text>
<text text-anchor="middle" x="83922" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="83922" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_gpu15_exp3 -->
<g id="node287" class="node">
<title>l4_s2_gpu15_exp3</title>
<polygon fill="lightblue" stroke="black" points="83410,-1414 83183,-1361 83410,-1308 83637,-1361 83410,-1414"/>
<text text-anchor="middle" x="83410" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert 87</text>
<text text-anchor="middle" x="83410" y="-1357.3" font-family="Times,serif" font-size="14.00">GPU 15</text>
<text text-anchor="middle" x="83410" y="-1342.3" font-family="Times,serif" font-size="14.00">[Variable tokens, expert_dim]</text>
</g>
<!-- l4_s2_agg -->
<g id="node288" class="node">
<title>l4_s2_agg</title>
<polygon fill="orange" stroke="black" points="83125.1,-1414 82763.84,-1414 82670.9,-1308 83032.16,-1308 83125.1,-1414"/>
<text text-anchor="middle" x="82898" y="-1372.3" font-family="Times,serif" font-size="14.00">Expert Aggregation</text>
<text text-anchor="middle" x="82898" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="82898" y="-1342.3" font-family="Times,serif" font-size="14.00">All&#45;reduce across GPUs 8&#45;15</text>
</g>
<!-- l4_s2_residual -->
<g id="node289" class="node">
<title>l4_s2_residual</title>
<polygon fill="orange" stroke="black" points="82469,-1414 82325,-1361 82469,-1308 82613,-1361 82469,-1414"/>
<text text-anchor="middle" x="82469" y="-1372.3" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="82469" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens]</text>
<text text-anchor="middle" x="82469" y="-1342.3" font-family="Times,serif" font-size="14.00">Across GPUs 8&#45;15</text>
</g>
<!-- output -->
<g id="node290" class="node">
<title>output</title>
<ellipse fill="lightcoral" stroke="black" cx="118587" cy="-1361" rx="145.83" ry="37.45"/>
<text text-anchor="middle" x="118587" y="-1372.3" font-family="Times,serif" font-size="14.00">Model Output</text>
<text text-anchor="middle" x="118587" y="-1357.3" font-family="Times,serif" font-size="14.00">[1024 tokens, hidden_dim]</text>
<text text-anchor="middle" x="118587" y="-1342.3" font-family="Times,serif" font-size="14.00">All GPUs</text>
</g>
</g>
</svg>
