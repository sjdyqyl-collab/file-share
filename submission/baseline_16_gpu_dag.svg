<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="2160pt" height="1368pt"
 viewBox="0.00 0.00 2160.00 1367.66" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.22 0.22) rotate(0) translate(4 6334.72)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-6334.72 10007,-6334.72 10007,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="7750,-6030.77 7750,-6322.72 7956,-6322.72 7956,-6030.77 7750,-6030.77"/>
<text text-anchor="middle" x="7853" y="-6307.52" font-family="Times,serif" font-size="14.00">Input Processing</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage_0_layer_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="1562,-4628.81 1562,-6022.77 9995,-6022.77 9995,-4628.81 1562,-4628.81"/>
<text text-anchor="middle" x="5778.5" y="-6007.57" font-family="Times,serif" font-size="14.00">Layer 1</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage_0_layer_1</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="620,-3226.86 620,-4620.81 9053,-4620.81 9053,-3226.86 620,-3226.86"/>
<text text-anchor="middle" x="4836.5" y="-4605.61" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_stage_0</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6561,-3089.91 6561,-3218.86 6849,-3218.86 6849,-3089.91 6561,-3089.91"/>
<text text-anchor="middle" x="6705" y="-3203.66" font-family="Times,serif" font-size="14.00">Pipeline Stage 0</text>
<text text-anchor="middle" x="6705" y="-3188.66" font-family="Times,serif" font-size="14.00">(GPUs 0&#45;7)</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_stage_1_layer_2</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="212,-1687.95 212,-3081.91 8645,-3081.91 8645,-1687.95 212,-1687.95"/>
<text text-anchor="middle" x="4428.5" y="-3066.71" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_stage_1_layer_3</title>
<polygon fill="none" stroke="black" stroke-dasharray="1,5" points="8,-286 8,-1679.95 8441,-1679.95 8441,-286 8,-286"/>
<text text-anchor="middle" x="4224.5" y="-1664.75" font-family="Times,serif" font-size="14.00">Layer 4</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" stroke-dasharray="5,2" points="6178,-8 6178,-278 6414,-278 6414,-8 6178,-8"/>
<text text-anchor="middle" x="6296" y="-262.8" font-family="Times,serif" font-size="14.00">Output Processing</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<ellipse fill="lightblue" stroke="black" cx="7853" cy="-6254.24" rx="94.51" ry="37.45"/>
<text text-anchor="middle" x="7853" y="-6265.54" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="7853" y="-6250.54" font-family="Times,serif" font-size="14.00">Shape: (1024, 1)</text>
<text text-anchor="middle" x="7853" y="-6235.54" font-family="Times,serif" font-size="14.00">GPU: CPU</text>
</g>
<!-- embed -->
<g id="node2" class="node">
<title>embed</title>
<polygon fill="lightgreen" stroke="black" points="7942.5,-6180.77 7763.5,-6180.77 7763.5,-6127.77 7942.5,-6127.77 7942.5,-6180.77"/>
<text text-anchor="middle" x="7853" y="-6165.57" font-family="Times,serif" font-size="14.00">Embedding Layer</text>
<text text-anchor="middle" x="7853" y="-6150.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7853" y="-6135.57" font-family="Times,serif" font-size="14.00">GPU: Stage 0</text>
</g>
<!-- input_tokens&#45;&gt;embed -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;embed</title>
<path fill="none" stroke="black" d="M7853,-6216.76C7853,-6208.34 7853,-6199.4 7853,-6191.02"/>
<polygon fill="black" stroke="black" points="7856.5,-6190.78 7853,-6180.78 7849.5,-6190.78 7856.5,-6190.78"/>
</g>
<!-- pos_embed -->
<g id="node3" class="node">
<title>pos_embed</title>
<polygon fill="lightgreen" stroke="black" points="7942.5,-6091.77 7763.5,-6091.77 7763.5,-6038.77 7942.5,-6038.77 7942.5,-6091.77"/>
<text text-anchor="middle" x="7853" y="-6076.57" font-family="Times,serif" font-size="14.00">Positional Encoding</text>
<text text-anchor="middle" x="7853" y="-6061.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7853" y="-6046.57" font-family="Times,serif" font-size="14.00">GPU: Stage 0</text>
</g>
<!-- embed&#45;&gt;pos_embed -->
<g id="edge2" class="edge">
<title>embed&#45;&gt;pos_embed</title>
<path fill="none" stroke="black" d="M7853,-6127.63C7853,-6119.65 7853,-6110.7 7853,-6102.15"/>
<polygon fill="black" stroke="black" points="7856.5,-6102.02 7853,-6092.02 7849.5,-6102.02 7856.5,-6102.02"/>
</g>
<!-- mha_qkv_0 -->
<g id="node4" class="node">
<title>mha_qkv_0</title>
<polygon fill="lightgreen" stroke="black" points="7886,-5991.77 7692,-5991.77 7692,-5938.77 7886,-5938.77 7886,-5991.77"/>
<text text-anchor="middle" x="7789" y="-5976.57" font-family="Times,serif" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="middle" x="7789" y="-5961.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7789" y="-5946.57" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pos_embed&#45;&gt;mha_qkv_0 -->
<g id="edge3" class="edge">
<title>pos_embed&#45;&gt;mha_qkv_0</title>
<path fill="none" stroke="black" d="M7836.18,-6038.52C7828.54,-6026.81 7819.39,-6012.81 7811.2,-6000.25"/>
<polygon fill="black" stroke="black" points="7814.1,-5998.3 7805.7,-5991.84 7808.24,-6002.13 7814.1,-5998.3"/>
</g>
<!-- mha_residual_0 -->
<g id="node7" class="node">
<title>mha_residual_0</title>
<polygon fill="lightyellow" stroke="black" points="8035.66,-5724.77 7740.32,-5724.77 7664.34,-5618.77 7959.68,-5618.77 8035.66,-5724.77"/>
<text text-anchor="middle" x="7850" y="-5683.07" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="7850" y="-5668.07" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7850" y="-5653.07" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- pos_embed&#45;&gt;mha_residual_0 -->
<g id="edge7" class="edge">
<title>pos_embed&#45;&gt;mha_residual_0</title>
<path fill="none" stroke="black" d="M7884.92,-6038.49C7889,-6033.71 7892.59,-6028.42 7895,-6022.77 7940.66,-5915.64 7926.77,-5873.61 7898,-5760.77 7895.73,-5751.85 7892.34,-5742.86 7888.41,-5734.21"/>
<polygon fill="black" stroke="black" points="7891.45,-5732.46 7883.95,-5724.98 7885.15,-5735.51 7891.45,-5732.46"/>
</g>
<!-- mha_attn_0 -->
<g id="node5" class="node">
<title>mha_attn_0</title>
<polygon fill="lightgreen" stroke="black" points="7874.5,-5902.77 7695.5,-5902.77 7695.5,-5849.77 7874.5,-5849.77 7874.5,-5902.77"/>
<text text-anchor="middle" x="7785" y="-5887.57" font-family="Times,serif" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="middle" x="7785" y="-5872.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7785" y="-5857.57" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_qkv_0&#45;&gt;mha_attn_0 -->
<g id="edge4" class="edge">
<title>mha_qkv_0&#45;&gt;mha_attn_0</title>
<path fill="none" stroke="black" d="M7787.82,-5938.63C7787.45,-5930.65 7787.04,-5921.7 7786.65,-5913.15"/>
<polygon fill="black" stroke="black" points="7790.14,-5912.85 7786.18,-5903.02 7783.15,-5913.17 7790.14,-5912.85"/>
</g>
<!-- mha_out_0 -->
<g id="node6" class="node">
<title>mha_out_0</title>
<polygon fill="lightgreen" stroke="black" points="7889,-5813.77 7677,-5813.77 7677,-5760.77 7889,-5760.77 7889,-5813.77"/>
<text text-anchor="middle" x="7783" y="-5798.57" font-family="Times,serif" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="middle" x="7783" y="-5783.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7783" y="-5768.57" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_attn_0&#45;&gt;mha_out_0 -->
<g id="edge5" class="edge">
<title>mha_attn_0&#45;&gt;mha_out_0</title>
<path fill="none" stroke="black" d="M7784.41,-5849.63C7784.23,-5841.65 7784.02,-5832.7 7783.82,-5824.15"/>
<polygon fill="black" stroke="black" points="7787.32,-5823.93 7783.59,-5814.02 7780.32,-5824.09 7787.32,-5823.93"/>
</g>
<!-- mha_out_0&#45;&gt;mha_residual_0 -->
<g id="edge6" class="edge">
<title>mha_out_0&#45;&gt;mha_residual_0</title>
<path fill="none" stroke="black" d="M7798.2,-5760.51C7802.99,-5752.4 7808.5,-5743.07 7814.1,-5733.58"/>
<polygon fill="black" stroke="black" points="7817.18,-5735.25 7819.25,-5724.86 7811.15,-5731.7 7817.18,-5735.25"/>
</g>
<!-- ln1_0 -->
<g id="node8" class="node">
<title>ln1_0</title>
<polygon fill="lightgreen" stroke="black" points="7939.5,-5582.77 7760.5,-5582.77 7760.5,-5529.77 7939.5,-5529.77 7939.5,-5582.77"/>
<text text-anchor="middle" x="7850" y="-5567.57" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="7850" y="-5552.57" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7850" y="-5537.57" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_residual_0&#45;&gt;ln1_0 -->
<g id="edge8" class="edge">
<title>mha_residual_0&#45;&gt;ln1_0</title>
<path fill="none" stroke="black" d="M7850,-5618.67C7850,-5610 7850,-5601.18 7850,-5593.03"/>
<polygon fill="black" stroke="black" points="7853.5,-5592.78 7850,-5582.78 7846.5,-5592.78 7853.5,-5592.78"/>
</g>
<!-- gate_0 -->
<g id="node9" class="node">
<title>gate_0</title>
<polygon fill="lightyellow" stroke="black" points="6066.83,-5493.77 5801.44,-5493.77 5733.17,-5387.77 5998.56,-5387.77 6066.83,-5493.77"/>
<text text-anchor="middle" x="5900" y="-5452.07" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="5900" y="-5437.07" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="5900" y="-5422.07" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln1_0&#45;&gt;gate_0 -->
<g id="edge9" class="edge">
<title>ln1_0&#45;&gt;gate_0</title>
<path fill="none" stroke="black" d="M7760.18,-5550.04C7451.73,-5532.09 6433.59,-5472.82 6048.93,-5450.43"/>
<polygon fill="black" stroke="black" points="6049.03,-5446.94 6038.85,-5449.85 6048.63,-5453.92 6049.03,-5446.94"/>
</g>
<!-- moe_residual_0 -->
<g id="node139" class="node">
<title>moe_residual_0</title>
<polygon fill="lightyellow" stroke="black" points="7566.66,-4831.81 7271.32,-4831.81 7195.34,-4725.81 7490.68,-4725.81 7566.66,-4831.81"/>
<text text-anchor="middle" x="7381" y="-4790.11" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="7381" y="-4775.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7381" y="-4760.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln1_0&#45;&gt;moe_residual_0 -->
<g id="edge170" class="edge">
<title>ln1_0&#45;&gt;moe_residual_0</title>
<path fill="none" stroke="black" d="M7939.63,-5552.61C8323.67,-5540.43 9817.9,-5484.75 9976,-5351.77 9988.86,-5340.95 9986,-5332.1 9986,-5315.29 9986,-5315.29 9986,-5315.29 9986,-5035.31 9986,-4912.13 8116.74,-4814.3 7545.09,-4787.27"/>
<polygon fill="black" stroke="black" points="7544.86,-4783.75 7534.71,-4786.78 7544.53,-4790.75 7544.86,-4783.75"/>
</g>
<!-- route_to_expert_0_0_0 -->
<g id="node10" class="node">
<title>route_to_expert_0_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="1692" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1692" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="1692" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1692" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_0_0 -->
<g id="edge10" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.9,-5438.85C5106.13,-5434.06 2220.55,-5409.92 1824,-5351.77 1811.35,-5349.91 1798.18,-5347.23 1785.28,-5344.14"/>
<polygon fill="black" stroke="black" points="1786.03,-5340.72 1775.48,-5341.71 1784.34,-5347.51 1786.03,-5340.72"/>
</g>
<!-- route_to_expert_0_0_1 -->
<g id="node14" class="node">
<title>route_to_expert_0_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="1955" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1955" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="1955" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1955" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_0_1 -->
<g id="edge14" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.73,-5438.63C5132.07,-5433 2456.2,-5406.18 2087,-5351.77 2074.35,-5349.9 2061.19,-5347.21 2048.28,-5344.12"/>
<polygon fill="black" stroke="black" points="2049.03,-5340.7 2038.48,-5341.69 2047.35,-5347.5 2049.03,-5340.7"/>
</g>
<!-- route_to_expert_0_0_2 -->
<g id="node18" class="node">
<title>route_to_expert_0_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="2218" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2218" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="2218" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2218" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_0_2 -->
<g id="edge18" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.76,-5438.38C5159.53,-5431.87 2691.94,-5402.47 2350,-5351.77 2337.44,-5349.9 2324.38,-5347.23 2311.57,-5344.17"/>
<polygon fill="black" stroke="black" points="2312.39,-5340.77 2301.84,-5341.76 2310.71,-5347.56 2312.39,-5340.77"/>
</g>
<!-- route_to_expert_0_0_3 -->
<g id="node22" class="node">
<title>route_to_expert_0_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="2481" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2481" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="2481" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2481" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_0_3 -->
<g id="edge22" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.43,-5438.09C5187.07,-5430.64 2927.68,-5398.74 2613,-5351.77 2600.45,-5349.89 2587.39,-5347.21 2574.58,-5344.15"/>
<polygon fill="black" stroke="black" points="2575.39,-5340.74 2564.85,-5341.73 2573.71,-5347.54 2575.39,-5340.74"/>
</g>
<!-- route_to_expert_0_1_0 -->
<g id="node26" class="node">
<title>route_to_expert_0_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="2744" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2744" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="2744" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2744" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_1_0 -->
<g id="edge26" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5766.57,-5440.14C5258.6,-5440.91 3445.53,-5437.46 2876,-5351.77 2863.45,-5349.88 2850.39,-5347.19 2837.58,-5344.12"/>
<polygon fill="black" stroke="black" points="2838.4,-5340.72 2827.85,-5341.7 2836.71,-5347.51 2838.4,-5340.72"/>
</g>
<!-- route_to_expert_0_1_1 -->
<g id="node30" class="node">
<title>route_to_expert_0_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="3007" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3007" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="3007" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3007" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_1_1 -->
<g id="edge30" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5766.43,-5439.71C5287.08,-5438.84 3654.63,-5430.09 3139,-5351.77 3126.45,-5349.86 3113.39,-5347.16 3100.59,-5344.09"/>
<polygon fill="black" stroke="black" points="3101.4,-5340.68 3090.86,-5341.67 3099.72,-5347.48 3101.4,-5340.68"/>
</g>
<!-- route_to_expert_0_1_2 -->
<g id="node34" class="node">
<title>route_to_expert_0_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="3270" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3270" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="3270" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3270" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_1_2 -->
<g id="edge34" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5766.14,-5439.18C5316.68,-5436.57 3863.89,-5422.71 3402,-5351.77 3389.45,-5349.84 3376.4,-5347.13 3363.59,-5344.05"/>
<polygon fill="black" stroke="black" points="3364.41,-5340.64 3353.86,-5341.62 3362.72,-5347.44 3364.41,-5340.64"/>
</g>
<!-- route_to_expert_0_1_3 -->
<g id="node38" class="node">
<title>route_to_expert_0_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="3533" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3533" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="3533" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3533" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_1_3 -->
<g id="edge38" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.5,-5438.53C5347.27,-5434.03 4073.28,-5415.34 3665,-5351.77 3652.67,-5349.85 3639.85,-5347.18 3627.26,-5344.16"/>
<polygon fill="black" stroke="black" points="3627.77,-5340.68 3617.23,-5341.66 3626.09,-5347.47 3627.77,-5340.68"/>
</g>
<!-- route_to_expert_0_2_0 -->
<g id="node42" class="node">
<title>route_to_expert_0_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="3796" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3796" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="3796" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3796" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_2_0 -->
<g id="edge42" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.26,-5437.7C5380.75,-5431.17 4283.09,-5408.02 3928,-5351.77 3915.68,-5349.81 3902.86,-5347.13 3890.27,-5344.1"/>
<polygon fill="black" stroke="black" points="3890.79,-5340.62 3880.24,-5341.59 3889.09,-5347.41 3890.79,-5340.62"/>
</g>
<!-- route_to_expert_0_2_1 -->
<g id="node46" class="node">
<title>route_to_expert_0_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="4059" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4059" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="4059" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4059" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_2_1 -->
<g id="edge46" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5764.46,-5436.6C5415.61,-5427.85 4493.07,-5400.68 4191,-5351.77 4178.68,-5349.77 4165.87,-5347.06 4153.28,-5344.02"/>
<polygon fill="black" stroke="black" points="4153.8,-5340.54 4143.25,-5341.51 4152.1,-5347.33 4153.8,-5340.54"/>
</g>
<!-- route_to_expert_0_2_2 -->
<g id="node50" class="node">
<title>route_to_expert_0_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="4322" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4322" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="4322" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4322" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_2_2 -->
<g id="edge50" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5763.55,-5435.1C5453.48,-5423.91 4703.48,-5393.36 4454,-5351.77 4441.79,-5349.73 4429.08,-5347.01 4416.59,-5343.98"/>
<polygon fill="black" stroke="black" points="4417.18,-5340.52 4406.62,-5341.48 4415.47,-5347.31 4417.18,-5340.52"/>
</g>
<!-- route_to_expert_0_2_3 -->
<g id="node54" class="node">
<title>route_to_expert_0_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="4585" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4585" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="4585" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4585" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_2_3 -->
<g id="edge54" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5765.45,-5438.28C5544.85,-5433.95 5093.15,-5417.08 4717,-5351.77 4704.89,-5349.66 4692.29,-5346.92 4679.9,-5343.89"/>
<polygon fill="black" stroke="black" points="4680.56,-5340.45 4670.01,-5341.4 4678.85,-5347.24 4680.56,-5340.45"/>
</g>
<!-- route_to_expert_0_3_0 -->
<g id="node58" class="node">
<title>route_to_expert_0_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="4848" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4848" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="4848" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4848" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_3_0 -->
<g id="edge58" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5762.97,-5434.12C5582.31,-5424.97 5255.14,-5402.54 4980,-5351.77 4968.01,-5349.55 4955.52,-5346.76 4943.22,-5343.72"/>
<polygon fill="black" stroke="black" points="4943.97,-5340.29 4933.41,-5341.22 4942.24,-5347.08 4943.97,-5340.29"/>
</g>
<!-- route_to_expert_0_3_1 -->
<g id="node62" class="node">
<title>route_to_expert_0_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="5111" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5111" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="5111" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5111" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_3_1 -->
<g id="edge62" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5757.77,-5426.38C5624.06,-5412.46 5418.76,-5387.65 5243,-5351.77 5231.35,-5349.39 5219.22,-5346.55 5207.23,-5343.52"/>
<polygon fill="black" stroke="black" points="5207.77,-5340.04 5197.22,-5340.93 5206.02,-5346.82 5207.77,-5340.04"/>
</g>
<!-- route_to_expert_0_3_2 -->
<g id="node66" class="node">
<title>route_to_expert_0_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="5374" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5374" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="5374" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5374" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_3_2 -->
<g id="edge66" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5745.21,-5407.06C5672.41,-5391.2 5584.54,-5371.38 5506,-5351.77 5495.03,-5349.03 5483.58,-5346.05 5472.2,-5343.01"/>
<polygon fill="black" stroke="black" points="5472.8,-5339.55 5462.24,-5340.33 5470.99,-5346.31 5472.8,-5339.55"/>
</g>
<!-- route_to_expert_0_3_3 -->
<g id="node70" class="node">
<title>route_to_expert_0_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="5637" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5637" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="5637" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5637" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_3_3 -->
<g id="edge70" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5789.99,-5387.7C5763.53,-5375.17 5735.87,-5362.09 5711.47,-5350.54"/>
<polygon fill="black" stroke="black" points="5712.82,-5347.3 5702.29,-5346.19 5709.83,-5353.63 5712.82,-5347.3"/>
</g>
<!-- route_to_expert_0_4_0 -->
<g id="node74" class="node">
<title>route_to_expert_0_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="5900" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5900" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 16</text>
<text text-anchor="middle" x="5900" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5900" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_4_0 -->
<g id="edge74" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5900,-5387.7C5900,-5379.27 5900,-5370.58 5900,-5362.28"/>
<polygon fill="black" stroke="black" points="5903.5,-5362.02 5900,-5352.02 5896.5,-5362.02 5903.5,-5362.02"/>
</g>
<!-- route_to_expert_0_4_1 -->
<g id="node78" class="node">
<title>route_to_expert_0_4_1</title>
<ellipse fill="lightblue" stroke="black" cx="6163" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6163" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 17</text>
<text text-anchor="middle" x="6163" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6163" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_4_1 -->
<g id="edge78" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6001.31,-5391.82C6030.43,-5378.04 6061.64,-5363.26 6088.8,-5350.41"/>
<polygon fill="black" stroke="black" points="6090.3,-5353.57 6097.84,-5346.13 6087.3,-5347.24 6090.3,-5353.57"/>
</g>
<!-- route_to_expert_0_4_2 -->
<g id="node82" class="node">
<title>route_to_expert_0_4_2</title>
<ellipse fill="lightblue" stroke="black" cx="6426" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6426" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 18</text>
<text text-anchor="middle" x="6426" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6426" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_4_2 -->
<g id="edge82" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6016.73,-5415.29C6095.33,-5398.42 6201.18,-5374.94 6294,-5351.77 6304.97,-5349.03 6316.42,-5346.05 6327.8,-5343.01"/>
<polygon fill="black" stroke="black" points="6329.01,-5346.31 6337.76,-5340.33 6327.2,-5339.55 6329.01,-5346.31"/>
</g>
<!-- route_to_expert_0_4_3 -->
<g id="node86" class="node">
<title>route_to_expert_0_4_3</title>
<ellipse fill="lightblue" stroke="black" cx="6689" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6689" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 19</text>
<text text-anchor="middle" x="6689" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6689" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_4_3 -->
<g id="edge86" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6024.66,-5428.19C6157.44,-5414.66 6373.35,-5389.26 6557,-5351.77 6568.65,-5349.39 6580.78,-5346.55 6592.77,-5343.52"/>
<polygon fill="black" stroke="black" points="6593.98,-5346.82 6602.78,-5340.93 6592.23,-5340.04 6593.98,-5346.82"/>
</g>
<!-- route_to_expert_0_5_0 -->
<g id="node90" class="node">
<title>route_to_expert_0_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="6952" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6952" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 20</text>
<text text-anchor="middle" x="6952" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6952" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_5_0 -->
<g id="edge90" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6028.97,-5434.52C6207.83,-5425.64 6540.72,-5403.31 6820,-5351.77 6831.99,-5349.55 6844.48,-5346.76 6856.78,-5343.72"/>
<polygon fill="black" stroke="black" points="6857.76,-5347.08 6866.59,-5341.22 6856.03,-5340.29 6857.76,-5347.08"/>
</g>
<!-- route_to_expert_0_5_1 -->
<g id="node94" class="node">
<title>route_to_expert_0_5_1</title>
<ellipse fill="lightblue" stroke="black" cx="7215" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7215" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 21</text>
<text text-anchor="middle" x="7215" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7215" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_5_1 -->
<g id="edge94" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.44,-5438.34C6250.88,-5434.11 6705.07,-5417.39 7083,-5351.77 7095.11,-5349.66 7107.71,-5346.92 7120.1,-5343.89"/>
<polygon fill="black" stroke="black" points="7121.15,-5347.24 7129.99,-5341.4 7119.44,-5340.45 7121.15,-5347.24"/>
</g>
<!-- route_to_expert_0_5_2 -->
<g id="node98" class="node">
<title>route_to_expert_0_5_2</title>
<ellipse fill="lightblue" stroke="black" cx="7478" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7478" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 22</text>
<text text-anchor="middle" x="7478" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7478" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_5_2 -->
<g id="edge98" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6029.3,-5435.36C6334.84,-5424.39 7094.58,-5393.68 7346,-5351.77 7358.21,-5349.73 7370.92,-5347.01 7383.41,-5343.98"/>
<polygon fill="black" stroke="black" points="7384.53,-5347.31 7393.38,-5341.48 7382.82,-5340.52 7384.53,-5347.31"/>
</g>
<!-- route_to_expert_0_5_3 -->
<g id="node102" class="node">
<title>route_to_expert_0_5_3</title>
<ellipse fill="lightblue" stroke="black" cx="7741" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7741" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 23</text>
<text text-anchor="middle" x="7741" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7741" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_5_3 -->
<g id="edge102" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6030.19,-5436.74C6374.85,-5428.13 7305.37,-5400.93 7609,-5351.77 7621.32,-5349.77 7634.13,-5347.06 7646.72,-5344.02"/>
<polygon fill="black" stroke="black" points="7647.9,-5347.33 7656.75,-5341.51 7646.2,-5340.54 7647.9,-5347.33"/>
</g>
<!-- route_to_expert_0_6_0 -->
<g id="node106" class="node">
<title>route_to_expert_0_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="8004" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8004" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 24</text>
<text text-anchor="middle" x="8004" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8004" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_6_0 -->
<g id="edge106" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6030.98,-5437.76C6412.05,-5431.33 7515.75,-5408.2 7872,-5351.77 7884.32,-5349.81 7897.14,-5347.13 7909.73,-5344.1"/>
<polygon fill="black" stroke="black" points="7910.91,-5347.41 7919.76,-5341.59 7909.21,-5340.62 7910.91,-5347.41"/>
</g>
<!-- route_to_expert_0_6_1 -->
<g id="node110" class="node">
<title>route_to_expert_0_6_1</title>
<ellipse fill="lightblue" stroke="black" cx="8267" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8267" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 25</text>
<text text-anchor="middle" x="8267" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8267" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_6_1 -->
<g id="edge110" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.57,-5438.56C6446.74,-5434.12 7725.76,-5415.49 8135,-5351.77 8147.33,-5349.85 8160.15,-5347.18 8172.74,-5344.16"/>
<polygon fill="black" stroke="black" points="8173.91,-5347.47 8182.77,-5341.66 8172.23,-5340.68 8173.91,-5347.47"/>
</g>
<!-- route_to_expert_0_6_2 -->
<g id="node114" class="node">
<title>route_to_expert_0_6_2</title>
<ellipse fill="lightblue" stroke="black" cx="8530" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8530" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 26</text>
<text text-anchor="middle" x="8530" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8530" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_6_2 -->
<g id="edge114" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.91,-5439.19C6479.1,-5436.61 7935.44,-5422.82 8398,-5351.77 8410.55,-5349.84 8423.6,-5347.13 8436.41,-5344.05"/>
<polygon fill="black" stroke="black" points="8437.28,-5347.44 8446.14,-5341.62 8435.59,-5340.64 8437.28,-5347.44"/>
</g>
<!-- route_to_expert_0_6_3 -->
<g id="node118" class="node">
<title>route_to_expert_0_6_3</title>
<ellipse fill="lightblue" stroke="black" cx="8793" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8793" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 27</text>
<text text-anchor="middle" x="8793" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8793" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_6_3 -->
<g id="edge118" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6032.33,-5439.71C6510.1,-5438.86 8144.92,-5430.15 8661,-5351.77 8673.55,-5349.86 8686.61,-5347.16 8699.41,-5344.09"/>
<polygon fill="black" stroke="black" points="8700.28,-5347.48 8709.14,-5341.67 8698.6,-5340.68 8700.28,-5347.48"/>
</g>
<!-- route_to_expert_0_7_0 -->
<g id="node122" class="node">
<title>route_to_expert_0_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="9056" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="9056" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 28</text>
<text text-anchor="middle" x="9056" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9056" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_7_0 -->
<g id="edge122" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6032.56,-5440.14C6539.33,-5440.92 8354.15,-5437.51 8924,-5351.77 8936.55,-5349.88 8949.61,-5347.19 8962.42,-5344.12"/>
<polygon fill="black" stroke="black" points="8963.29,-5347.51 8972.15,-5341.7 8961.6,-5340.72 8963.29,-5347.51"/>
</g>
<!-- route_to_expert_0_7_1 -->
<g id="node126" class="node">
<title>route_to_expert_0_7_1</title>
<ellipse fill="lightblue" stroke="black" cx="9319" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="9319" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 29</text>
<text text-anchor="middle" x="9319" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9319" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_7_1 -->
<g id="edge126" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.19,-5438.14C6604.05,-5430.76 8871.7,-5398.83 9187,-5351.77 9199.55,-5349.89 9212.61,-5347.21 9225.42,-5344.15"/>
<polygon fill="black" stroke="black" points="9226.29,-5347.54 9235.15,-5341.73 9224.61,-5340.74 9226.29,-5347.54"/>
</g>
<!-- route_to_expert_0_7_2 -->
<g id="node130" class="node">
<title>route_to_expert_0_7_2</title>
<ellipse fill="lightblue" stroke="black" cx="9582" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="9582" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 30</text>
<text text-anchor="middle" x="9582" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9582" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_7_2 -->
<g id="edge130" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.22,-5438.42C6632.21,-5431.97 9107.49,-5402.55 9450,-5351.77 9462.56,-5349.9 9475.62,-5347.23 9488.43,-5344.17"/>
<polygon fill="black" stroke="black" points="9489.29,-5347.56 9498.16,-5341.76 9487.61,-5340.77 9489.29,-5347.56"/>
</g>
<!-- route_to_expert_0_7_3 -->
<g id="node134" class="node">
<title>route_to_expert_0_7_3</title>
<ellipse fill="lightblue" stroke="black" cx="9845" cy="-5314.29" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="9845" y="-5325.59" font-family="Times,serif" font-size="14.00">Route to Expert 31</text>
<text text-anchor="middle" x="9845" y="-5310.59" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9845" y="-5295.59" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_0&#45;&gt;route_to_expert_0_7_3 -->
<g id="edge134" class="edge">
<title>gate_0&#45;&gt;route_to_expert_0_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M6031.39,-5438.66C6659.76,-5433.08 9343.24,-5406.27 9713,-5351.77 9725.65,-5349.9 9738.81,-5347.21 9751.72,-5344.12"/>
<polygon fill="black" stroke="black" points="9752.65,-5347.5 9761.52,-5341.69 9750.97,-5340.7 9752.65,-5347.5"/>
</g>
<!-- expert_linear1_0_0_0 -->
<g id="node11" class="node">
<title>expert_linear1_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1783,-5240.81 1601,-5240.81 1601,-5187.81 1783,-5187.81 1783,-5240.81"/>
<text text-anchor="middle" x="1692" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="1692" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1692" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_0_0_0&#45;&gt;expert_linear1_0_0_0 -->
<g id="edge11" class="edge">
<title>route_to_expert_0_0_0&#45;&gt;expert_linear1_0_0_0</title>
<path fill="none" stroke="black" d="M1692,-5276.81C1692,-5268.39 1692,-5259.45 1692,-5251.06"/>
<polygon fill="black" stroke="black" points="1695.5,-5250.82 1692,-5240.82 1688.5,-5250.82 1695.5,-5250.82"/>
</g>
<!-- expert_activation_0_0_0 -->
<g id="node12" class="node">
<title>expert_activation_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1784,-5151.81 1602,-5151.81 1602,-5098.81 1784,-5098.81 1784,-5151.81"/>
<text text-anchor="middle" x="1693" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="1693" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1693" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_0_0_0&#45;&gt;expert_activation_0_0_0 -->
<g id="edge12" class="edge">
<title>expert_linear1_0_0_0&#45;&gt;expert_activation_0_0_0</title>
<path fill="none" stroke="black" d="M1692.29,-5187.68C1692.39,-5179.7 1692.49,-5170.75 1692.59,-5162.2"/>
<polygon fill="black" stroke="black" points="1696.09,-5162.1 1692.7,-5152.06 1689.09,-5162.02 1696.09,-5162.1"/>
</g>
<!-- expert_linear2_0_0_0 -->
<g id="node13" class="node">
<title>expert_linear2_0_0_0</title>
<polygon fill="lightgreen" stroke="black" points="2035.5,-5062.81 1862.5,-5062.81 1862.5,-5009.81 2035.5,-5009.81 2035.5,-5062.81"/>
<text text-anchor="middle" x="1949" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="1949" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1949" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_0_0_0&#45;&gt;expert_linear2_0_0_0 -->
<g id="edge13" class="edge">
<title>expert_activation_0_0_0&#45;&gt;expert_linear2_0_0_0</title>
<path fill="none" stroke="black" d="M1768.08,-5098.8C1798.3,-5088.53 1833.29,-5076.64 1864.4,-5066.06"/>
<polygon fill="black" stroke="black" points="1865.58,-5069.36 1873.92,-5062.83 1863.33,-5062.73 1865.58,-5069.36"/>
</g>
<!-- aggregate_0 -->
<g id="node138" class="node">
<title>aggregate_0</title>
<polygon fill="lightyellow" stroke="black" points="6113.64,-4973.81 5773.79,-4973.81 5686.36,-4867.81 6026.21,-4867.81 6113.64,-4973.81"/>
<text text-anchor="middle" x="5900" y="-4932.11" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="5900" y="-4917.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="5900" y="-4902.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- expert_linear2_0_0_0&#45;&gt;aggregate_0 -->
<g id="edge138" class="edge">
<title>expert_linear2_0_0_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2035.73,-5030.54C2140.67,-5024.91 2322.73,-5015.58 2479,-5009.81 3720.6,-4963.98 5216.55,-4934.31 5722.78,-4924.97"/>
<polygon fill="black" stroke="black" points="5723.16,-4928.47 5733.09,-4924.78 5723.03,-4921.47 5723.16,-4928.47"/>
</g>
<!-- expert_linear1_0_0_1 -->
<g id="node15" class="node">
<title>expert_linear1_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="2140,-5240.81 1958,-5240.81 1958,-5187.81 2140,-5187.81 2140,-5240.81"/>
<text text-anchor="middle" x="2049" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="2049" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2049" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_0_0_1&#45;&gt;expert_linear1_0_0_1 -->
<g id="edge15" class="edge">
<title>route_to_expert_0_0_1&#45;&gt;expert_linear1_0_0_1</title>
<path fill="none" stroke="black" d="M1988.67,-5278.19C1997.98,-5268.49 2008.05,-5257.99 2017.25,-5248.4"/>
<polygon fill="black" stroke="black" points="2020.01,-5250.58 2024.41,-5240.94 2014.96,-5245.74 2020.01,-5250.58"/>
</g>
<!-- expert_activation_0_0_1 -->
<g id="node16" class="node">
<title>expert_activation_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="2488,-5151.81 2306,-5151.81 2306,-5098.81 2488,-5098.81 2488,-5151.81"/>
<text text-anchor="middle" x="2397" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="2397" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2397" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_0_0_1&#45;&gt;expert_activation_0_0_1 -->
<g id="edge16" class="edge">
<title>expert_linear1_0_0_1&#45;&gt;expert_activation_0_0_1</title>
<path fill="none" stroke="black" d="M2140.43,-5190.46C2188.29,-5178.49 2247,-5163.81 2296.17,-5151.52"/>
<polygon fill="black" stroke="black" points="2297.02,-5154.92 2305.88,-5149.09 2295.33,-5148.12 2297.02,-5154.92"/>
</g>
<!-- expert_linear2_0_0_1 -->
<g id="node17" class="node">
<title>expert_linear2_0_0_1</title>
<polygon fill="lightgreen" stroke="black" points="2660.5,-5062.81 2487.5,-5062.81 2487.5,-5009.81 2660.5,-5009.81 2660.5,-5062.81"/>
<text text-anchor="middle" x="2574" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="2574" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2574" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_0_0_1&#45;&gt;expert_linear2_0_0_1 -->
<g id="edge17" class="edge">
<title>expert_activation_0_0_1&#45;&gt;expert_linear2_0_0_1</title>
<path fill="none" stroke="black" d="M2449.15,-5098.68C2469.13,-5088.86 2492.12,-5077.56 2512.87,-5067.36"/>
<polygon fill="black" stroke="black" points="2514.49,-5070.46 2521.92,-5062.91 2511.4,-5064.18 2514.49,-5070.46"/>
</g>
<!-- expert_linear2_0_0_1&#45;&gt;aggregate_0 -->
<g id="edge139" class="edge">
<title>expert_linear2_0_0_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M2660.58,-5025.83C2714.44,-5020.28 2785.17,-5013.64 2848,-5009.81 3938.17,-4943.44 5250.54,-4926.9 5721.23,-4922.98"/>
<polygon fill="black" stroke="black" points="5721.54,-4926.47 5731.51,-4922.89 5721.48,-4919.47 5721.54,-4926.47"/>
</g>
<!-- expert_linear1_0_0_2 -->
<g id="node19" class="node">
<title>expert_linear1_0_0_2</title>
<polygon fill="lightgreen" stroke="black" points="2403,-5240.81 2221,-5240.81 2221,-5187.81 2403,-5187.81 2403,-5240.81"/>
<text text-anchor="middle" x="2312" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="2312" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2312" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_0_0_2&#45;&gt;expert_linear1_0_0_2 -->
<g id="edge19" class="edge">
<title>route_to_expert_0_0_2&#45;&gt;expert_linear1_0_0_2</title>
<path fill="none" stroke="black" d="M2251.67,-5278.19C2260.98,-5268.49 2271.05,-5257.99 2280.25,-5248.4"/>
<polygon fill="black" stroke="black" points="2283.01,-5250.58 2287.41,-5240.94 2277.96,-5245.74 2283.01,-5250.58"/>
</g>
<!-- expert_activation_0_0_2 -->
<g id="node20" class="node">
<title>expert_activation_0_0_2</title>
<polygon fill="lightgreen" stroke="black" points="2940,-5151.81 2758,-5151.81 2758,-5098.81 2940,-5098.81 2940,-5151.81"/>
<text text-anchor="middle" x="2849" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="2849" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2849" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_0_0_2&#45;&gt;expert_activation_0_0_2 -->
<g id="edge20" class="edge">
<title>expert_linear1_0_0_2&#45;&gt;expert_activation_0_0_2</title>
<path fill="none" stroke="black" d="M2403.17,-5195.06C2416.51,-5192.53 2430.1,-5190.04 2443,-5187.81 2546.51,-5169.91 2665.38,-5152.24 2747.62,-5140.47"/>
<polygon fill="black" stroke="black" points="2748.31,-5143.9 2757.72,-5139.02 2747.32,-5136.97 2748.31,-5143.9"/>
</g>
<!-- expert_linear2_0_0_2 -->
<g id="node21" class="node">
<title>expert_linear2_0_0_2</title>
<polygon fill="lightgreen" stroke="black" points="3029.5,-5062.81 2856.5,-5062.81 2856.5,-5009.81 3029.5,-5009.81 3029.5,-5062.81"/>
<text text-anchor="middle" x="2943" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="2943" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2943" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_0_0_2&#45;&gt;expert_linear2_0_0_2 -->
<g id="edge21" class="edge">
<title>expert_activation_0_0_2&#45;&gt;expert_linear2_0_0_2</title>
<path fill="none" stroke="black" d="M2876.69,-5098.68C2886.36,-5089.73 2897.35,-5079.57 2907.56,-5070.12"/>
<polygon fill="black" stroke="black" points="2910.22,-5072.42 2915.18,-5063.06 2905.46,-5067.29 2910.22,-5072.42"/>
</g>
<!-- expert_linear2_0_0_2&#45;&gt;aggregate_0 -->
<g id="edge140" class="edge">
<title>expert_linear2_0_0_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3029.82,-5021.77C3062.13,-5017.23 3099.17,-5012.61 3133,-5009.81 4106.36,-4929.23 5277.95,-4921.13 5719.73,-4921.22"/>
<polygon fill="black" stroke="black" points="5720.03,-4924.72 5730.03,-4921.22 5720.03,-4917.72 5720.03,-4924.72"/>
</g>
<!-- expert_linear1_0_0_3 -->
<g id="node23" class="node">
<title>expert_linear1_0_0_3</title>
<polygon fill="lightgreen" stroke="black" points="2634,-5240.81 2452,-5240.81 2452,-5187.81 2634,-5187.81 2634,-5240.81"/>
<text text-anchor="middle" x="2543" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="2543" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2543" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_0_0_3&#45;&gt;expert_linear1_0_0_3 -->
<g id="edge23" class="edge">
<title>route_to_expert_0_0_3&#45;&gt;expert_linear1_0_0_3</title>
<path fill="none" stroke="black" d="M2503.73,-5277.36C2509.49,-5268.27 2515.65,-5258.53 2521.35,-5249.52"/>
<polygon fill="black" stroke="black" points="2524.47,-5251.14 2526.86,-5240.81 2518.56,-5247.39 2524.47,-5251.14"/>
</g>
<!-- expert_activation_0_0_3 -->
<g id="node24" class="node">
<title>expert_activation_0_0_3</title>
<polygon fill="lightgreen" stroke="black" points="3266,-5151.81 3084,-5151.81 3084,-5098.81 3266,-5098.81 3266,-5151.81"/>
<text text-anchor="middle" x="3175" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="3175" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3175" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_0_0_3&#45;&gt;expert_activation_0_0_3 -->
<g id="edge24" class="edge">
<title>expert_linear1_0_0_3&#45;&gt;expert_activation_0_0_3</title>
<path fill="none" stroke="black" d="M2634.32,-5198.62C2657.67,-5194.97 2682.75,-5191.16 2706,-5187.81 2832.46,-5169.63 2978.44,-5150.84 3073.5,-5138.89"/>
<polygon fill="black" stroke="black" points="3074.2,-5142.33 3083.68,-5137.61 3073.32,-5135.38 3074.2,-5142.33"/>
</g>
<!-- expert_linear2_0_0_3 -->
<g id="node25" class="node">
<title>expert_linear2_0_0_3</title>
<polygon fill="lightgreen" stroke="black" points="3314.5,-5062.81 3141.5,-5062.81 3141.5,-5009.81 3314.5,-5009.81 3314.5,-5062.81"/>
<text text-anchor="middle" x="3228" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="3228" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3228" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_0_0_3&#45;&gt;expert_linear2_0_0_3 -->
<g id="edge25" class="edge">
<title>expert_activation_0_0_3&#45;&gt;expert_linear2_0_0_3</title>
<path fill="none" stroke="black" d="M3190.62,-5098.68C3195.74,-5090.26 3201.53,-5080.76 3207,-5071.79"/>
<polygon fill="black" stroke="black" points="3210.1,-5073.42 3212.31,-5063.06 3204.12,-5069.78 3210.1,-5073.42"/>
</g>
<!-- expert_linear2_0_0_3&#45;&gt;aggregate_0 -->
<g id="edge141" class="edge">
<title>expert_linear2_0_0_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3314.59,-5018.57C3335.29,-5015.13 3357.37,-5011.92 3378,-5009.81 3833.73,-4963.33 5227.84,-4934.07 5723.12,-4924.91"/>
<polygon fill="black" stroke="black" points="5723.29,-4928.41 5733.22,-4924.72 5723.16,-4921.41 5723.29,-4928.41"/>
</g>
<!-- expert_linear1_0_1_0 -->
<g id="node27" class="node">
<title>expert_linear1_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="2897,-5240.81 2715,-5240.81 2715,-5187.81 2897,-5187.81 2897,-5240.81"/>
<text text-anchor="middle" x="2806" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="2806" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2806" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_0_1_0&#45;&gt;expert_linear1_0_1_0 -->
<g id="edge27" class="edge">
<title>route_to_expert_0_1_0&#45;&gt;expert_linear1_0_1_0</title>
<path fill="none" stroke="black" d="M2766.73,-5277.36C2772.49,-5268.27 2778.65,-5258.53 2784.35,-5249.52"/>
<polygon fill="black" stroke="black" points="2787.47,-5251.14 2789.86,-5240.81 2781.56,-5247.39 2787.47,-5251.14"/>
</g>
<!-- expert_activation_0_1_0 -->
<g id="node28" class="node">
<title>expert_activation_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="3529,-5151.81 3347,-5151.81 3347,-5098.81 3529,-5098.81 3529,-5151.81"/>
<text text-anchor="middle" x="3438" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="3438" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3438" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_0_1_0&#45;&gt;expert_activation_0_1_0 -->
<g id="edge28" class="edge">
<title>expert_linear1_0_1_0&#45;&gt;expert_activation_0_1_0</title>
<path fill="none" stroke="black" d="M2897.29,-5198.4C2920.64,-5194.76 2945.73,-5191 2969,-5187.81 3104.67,-5169.23 3139.33,-5170.4 3275,-5151.81 3295,-5149.07 3316.34,-5145.91 3336.76,-5142.76"/>
<polygon fill="black" stroke="black" points="3337.36,-5146.21 3346.71,-5141.22 3336.29,-5139.3 3337.36,-5146.21"/>
</g>
<!-- expert_linear2_0_1_0 -->
<g id="node29" class="node">
<title>expert_linear2_0_1_0</title>
<polygon fill="lightgreen" stroke="black" points="3559.5,-5062.81 3386.5,-5062.81 3386.5,-5009.81 3559.5,-5009.81 3559.5,-5062.81"/>
<text text-anchor="middle" x="3473" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="3473" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3473" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_0_1_0&#45;&gt;expert_linear2_0_1_0 -->
<g id="edge29" class="edge">
<title>expert_activation_0_1_0&#45;&gt;expert_linear2_0_1_0</title>
<path fill="none" stroke="black" d="M3448.31,-5098.68C3451.63,-5090.44 3455.36,-5081.15 3458.9,-5072.35"/>
<polygon fill="black" stroke="black" points="3462.16,-5073.65 3462.64,-5063.06 3455.66,-5071.03 3462.16,-5073.65"/>
</g>
<!-- expert_linear2_0_1_0&#45;&gt;aggregate_0 -->
<g id="edge142" class="edge">
<title>expert_linear2_0_1_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3559.8,-5016.1C3573.53,-5013.62 3587.61,-5011.39 3601,-5009.81 4011.01,-4961.43 5257.98,-4933.81 5722.83,-4924.96"/>
<polygon fill="black" stroke="black" points="5723.06,-4928.46 5732.99,-4924.77 5722.93,-4921.46 5723.06,-4928.46"/>
</g>
<!-- expert_linear1_0_1_1 -->
<g id="node31" class="node">
<title>expert_linear1_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="3160,-5240.81 2978,-5240.81 2978,-5187.81 3160,-5187.81 3160,-5240.81"/>
<text text-anchor="middle" x="3069" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="3069" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3069" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_0_1_1&#45;&gt;expert_linear1_0_1_1 -->
<g id="edge31" class="edge">
<title>route_to_expert_0_1_1&#45;&gt;expert_linear1_0_1_1</title>
<path fill="none" stroke="black" d="M3029.73,-5277.36C3035.49,-5268.27 3041.65,-5258.53 3047.35,-5249.52"/>
<polygon fill="black" stroke="black" points="3050.47,-5251.14 3052.86,-5240.81 3044.56,-5247.39 3050.47,-5251.14"/>
</g>
<!-- expert_activation_0_1_1 -->
<g id="node32" class="node">
<title>expert_activation_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="3760,-5151.81 3578,-5151.81 3578,-5098.81 3760,-5098.81 3760,-5151.81"/>
<text text-anchor="middle" x="3669" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="3669" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3669" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_0_1_1&#45;&gt;expert_activation_0_1_1 -->
<g id="edge32" class="edge">
<title>expert_linear1_0_1_1&#45;&gt;expert_activation_0_1_1</title>
<path fill="none" stroke="black" d="M3160.29,-5198.4C3183.64,-5194.76 3208.73,-5191 3232,-5187.81 3367.67,-5169.23 3402.7,-5172.91 3538,-5151.81 3547.7,-5150.3 3557.78,-5148.59 3567.85,-5146.79"/>
<polygon fill="black" stroke="black" points="3568.68,-5150.19 3577.89,-5144.96 3567.43,-5143.31 3568.68,-5150.19"/>
</g>
<!-- expert_linear2_0_1_1 -->
<g id="node33" class="node">
<title>expert_linear2_0_1_1</title>
<polygon fill="lightgreen" stroke="black" points="3782.5,-5062.81 3609.5,-5062.81 3609.5,-5009.81 3782.5,-5009.81 3782.5,-5062.81"/>
<text text-anchor="middle" x="3696" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="3696" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3696" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_0_1_1&#45;&gt;expert_linear2_0_1_1 -->
<g id="edge33" class="edge">
<title>expert_activation_0_1_1&#45;&gt;expert_linear2_0_1_1</title>
<path fill="none" stroke="black" d="M3676.95,-5098.68C3679.49,-5090.52 3682.33,-5081.35 3685.04,-5072.63"/>
<polygon fill="black" stroke="black" points="3688.39,-5073.65 3688.01,-5063.06 3681.7,-5071.58 3688.39,-5073.65"/>
</g>
<!-- expert_linear2_0_1_1&#45;&gt;aggregate_0 -->
<g id="edge143" class="edge">
<title>expert_linear2_0_1_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3782.68,-5013.34C3789.86,-5011.98 3797.03,-5010.77 3804,-5009.81 4172.5,-4959.04 5287.4,-4933.27 5722.95,-4924.92"/>
<polygon fill="black" stroke="black" points="5723.18,-4928.42 5733.11,-4924.73 5723.05,-4921.42 5723.18,-4928.42"/>
</g>
<!-- expert_linear1_0_1_2 -->
<g id="node35" class="node">
<title>expert_linear1_0_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3423,-5240.81 3241,-5240.81 3241,-5187.81 3423,-5187.81 3423,-5240.81"/>
<text text-anchor="middle" x="3332" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="3332" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3332" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_0_1_2&#45;&gt;expert_linear1_0_1_2 -->
<g id="edge35" class="edge">
<title>route_to_expert_0_1_2&#45;&gt;expert_linear1_0_1_2</title>
<path fill="none" stroke="black" d="M3292.73,-5277.36C3298.49,-5268.27 3304.65,-5258.53 3310.35,-5249.52"/>
<polygon fill="black" stroke="black" points="3313.47,-5251.14 3315.86,-5240.81 3307.56,-5247.39 3313.47,-5251.14"/>
</g>
<!-- expert_activation_0_1_2 -->
<g id="node36" class="node">
<title>expert_activation_0_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3976,-5151.81 3794,-5151.81 3794,-5098.81 3976,-5098.81 3976,-5151.81"/>
<text text-anchor="middle" x="3885" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="3885" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3885" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_0_1_2&#45;&gt;expert_activation_0_1_2 -->
<g id="edge36" class="edge">
<title>expert_linear1_0_1_2&#45;&gt;expert_activation_0_1_2</title>
<path fill="none" stroke="black" d="M3423.32,-5198.62C3446.67,-5194.98 3471.75,-5191.16 3495,-5187.81 3616.57,-5170.32 3648.02,-5173.02 3769,-5151.81 3773.95,-5150.95 3779.01,-5150.01 3784.11,-5149.03"/>
<polygon fill="black" stroke="black" points="3784.82,-5152.46 3793.96,-5147.1 3783.47,-5145.59 3784.82,-5152.46"/>
</g>
<!-- expert_linear2_0_1_2 -->
<g id="node37" class="node">
<title>expert_linear2_0_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3985.5,-5062.81 3812.5,-5062.81 3812.5,-5009.81 3985.5,-5009.81 3985.5,-5062.81"/>
<text text-anchor="middle" x="3899" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="3899" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3899" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_0_1_2&#45;&gt;expert_linear2_0_1_2 -->
<g id="edge37" class="edge">
<title>expert_activation_0_1_2&#45;&gt;expert_linear2_0_1_2</title>
<path fill="none" stroke="black" d="M3889.12,-5098.68C3890.41,-5090.7 3891.85,-5081.75 3893.23,-5073.2"/>
<polygon fill="black" stroke="black" points="3896.72,-5073.49 3894.86,-5063.06 3889.81,-5072.38 3896.72,-5073.49"/>
</g>
<!-- expert_linear2_0_1_2&#45;&gt;aggregate_0 -->
<g id="edge144" class="edge">
<title>expert_linear2_0_1_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M3985.68,-5013.84C3993.86,-5012.28 4002.07,-5010.9 4010,-5009.81 4337.88,-4964.89 5320.55,-4936.17 5724.08,-4925.97"/>
<polygon fill="black" stroke="black" points="5724.18,-4929.47 5734.09,-4925.72 5724.01,-4922.47 5724.18,-4929.47"/>
</g>
<!-- expert_linear1_0_1_3 -->
<g id="node39" class="node">
<title>expert_linear1_0_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3686,-5240.81 3504,-5240.81 3504,-5187.81 3686,-5187.81 3686,-5240.81"/>
<text text-anchor="middle" x="3595" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="3595" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3595" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_0_1_3&#45;&gt;expert_linear1_0_1_3 -->
<g id="edge39" class="edge">
<title>route_to_expert_0_1_3&#45;&gt;expert_linear1_0_1_3</title>
<path fill="none" stroke="black" d="M3555.73,-5277.36C3561.49,-5268.27 3567.65,-5258.53 3573.35,-5249.52"/>
<polygon fill="black" stroke="black" points="3576.47,-5251.14 3578.86,-5240.81 3570.56,-5247.39 3576.47,-5251.14"/>
</g>
<!-- expert_activation_0_1_3 -->
<g id="node40" class="node">
<title>expert_activation_0_1_3</title>
<polygon fill="lightgreen" stroke="black" points="4184,-5151.81 4002,-5151.81 4002,-5098.81 4184,-5098.81 4184,-5151.81"/>
<text text-anchor="middle" x="4093" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="4093" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4093" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_0_1_3&#45;&gt;expert_activation_0_1_3 -->
<g id="edge40" class="edge">
<title>expert_linear1_0_1_3&#45;&gt;expert_activation_0_1_3</title>
<path fill="none" stroke="black" d="M3686.18,-5199.02C3799.12,-5181.31 3977.66,-5153.26 3985,-5151.81 3987.23,-5151.38 3989.48,-5150.92 3991.75,-5150.46"/>
<polygon fill="black" stroke="black" points="3992.7,-5153.84 4001.77,-5148.36 3991.27,-5146.98 3992.7,-5153.84"/>
</g>
<!-- expert_linear2_0_1_3 -->
<g id="node41" class="node">
<title>expert_linear2_0_1_3</title>
<polygon fill="lightgreen" stroke="black" points="4191.5,-5062.81 4018.5,-5062.81 4018.5,-5009.81 4191.5,-5009.81 4191.5,-5062.81"/>
<text text-anchor="middle" x="4105" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="4105" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4105" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_0_1_3&#45;&gt;expert_linear2_0_1_3 -->
<g id="edge41" class="edge">
<title>expert_activation_0_1_3&#45;&gt;expert_linear2_0_1_3</title>
<path fill="none" stroke="black" d="M4096.54,-5098.68C4097.64,-5090.7 4098.87,-5081.75 4100.05,-5073.2"/>
<polygon fill="black" stroke="black" points="4103.55,-5073.45 4101.45,-5063.06 4096.61,-5072.49 4103.55,-5073.45"/>
</g>
<!-- expert_linear2_0_1_3&#45;&gt;aggregate_0 -->
<g id="edge145" class="edge">
<title>expert_linear2_0_1_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4191.6,-5013.59C4199.15,-5012.14 4206.69,-5010.85 4214,-5009.81 4501.49,-4969.01 5353.89,-4938.66 5724.56,-4927.02"/>
<polygon fill="black" stroke="black" points="5724.69,-4930.51 5734.58,-4926.7 5724.48,-4923.52 5724.69,-4930.51"/>
</g>
<!-- expert_linear1_0_2_0 -->
<g id="node43" class="node">
<title>expert_linear1_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="3949,-5240.81 3767,-5240.81 3767,-5187.81 3949,-5187.81 3949,-5240.81"/>
<text text-anchor="middle" x="3858" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="3858" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3858" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_0_2_0&#45;&gt;expert_linear1_0_2_0 -->
<g id="edge43" class="edge">
<title>route_to_expert_0_2_0&#45;&gt;expert_linear1_0_2_0</title>
<path fill="none" stroke="black" d="M3818.73,-5277.36C3824.49,-5268.27 3830.65,-5258.53 3836.35,-5249.52"/>
<polygon fill="black" stroke="black" points="3839.47,-5251.14 3841.86,-5240.81 3833.56,-5247.39 3839.47,-5251.14"/>
</g>
<!-- expert_activation_0_2_0 -->
<g id="node44" class="node">
<title>expert_activation_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4388,-5151.81 4206,-5151.81 4206,-5098.81 4388,-5098.81 4388,-5151.81"/>
<text text-anchor="middle" x="4297" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="4297" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4297" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_0_2_0&#45;&gt;expert_activation_0_2_0 -->
<g id="edge44" class="edge">
<title>expert_linear1_0_2_0&#45;&gt;expert_activation_0_2_0</title>
<path fill="none" stroke="black" d="M3949.28,-5198.05C4016.8,-5186.4 4110.9,-5169.4 4193,-5151.81 4193.91,-5151.62 4194.83,-5151.42 4195.76,-5151.22"/>
<polygon fill="black" stroke="black" points="4196.75,-5154.58 4205.76,-5149.01 4195.24,-5147.75 4196.75,-5154.58"/>
</g>
<!-- expert_linear2_0_2_0 -->
<g id="node45" class="node">
<title>expert_linear2_0_2_0</title>
<polygon fill="lightgreen" stroke="black" points="4395.5,-5062.81 4222.5,-5062.81 4222.5,-5009.81 4395.5,-5009.81 4395.5,-5062.81"/>
<text text-anchor="middle" x="4309" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="4309" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4309" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_0_2_0&#45;&gt;expert_linear2_0_2_0 -->
<g id="edge45" class="edge">
<title>expert_activation_0_2_0&#45;&gt;expert_linear2_0_2_0</title>
<path fill="none" stroke="black" d="M4300.54,-5098.68C4301.64,-5090.7 4302.87,-5081.75 4304.05,-5073.2"/>
<polygon fill="black" stroke="black" points="4307.55,-5073.45 4305.45,-5063.06 4300.61,-5072.49 4307.55,-5073.45"/>
</g>
<!-- expert_linear2_0_2_0&#45;&gt;aggregate_0 -->
<g id="edge146" class="edge">
<title>expert_linear2_0_2_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4395.69,-5013.47C4402.87,-5012.08 4410.04,-5010.83 4417,-5009.81 4883.97,-4941.35 5441.08,-4925.8 5720.88,-4922.5"/>
<polygon fill="black" stroke="black" points="5721.16,-4926 5731.12,-4922.38 5721.08,-4919 5721.16,-4926"/>
</g>
<!-- expert_linear1_0_2_1 -->
<g id="node47" class="node">
<title>expert_linear1_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="4212,-5240.81 4030,-5240.81 4030,-5187.81 4212,-5187.81 4212,-5240.81"/>
<text text-anchor="middle" x="4121" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="4121" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4121" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_0_2_1&#45;&gt;expert_linear1_0_2_1 -->
<g id="edge47" class="edge">
<title>route_to_expert_0_2_1&#45;&gt;expert_linear1_0_2_1</title>
<path fill="none" stroke="black" d="M4081.73,-5277.36C4087.49,-5268.27 4093.65,-5258.53 4099.35,-5249.52"/>
<polygon fill="black" stroke="black" points="4102.47,-5251.14 4104.86,-5240.81 4096.56,-5247.39 4102.47,-5251.14"/>
</g>
<!-- expert_activation_0_2_1 -->
<g id="node48" class="node">
<title>expert_activation_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="4590,-5151.81 4408,-5151.81 4408,-5098.81 4590,-5098.81 4590,-5151.81"/>
<text text-anchor="middle" x="4499" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="4499" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4499" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_0_2_1&#45;&gt;expert_activation_0_2_1 -->
<g id="edge48" class="edge">
<title>expert_linear1_0_2_1&#45;&gt;expert_activation_0_2_1</title>
<path fill="none" stroke="black" d="M4212.19,-5193.61C4266.04,-5181.82 4335.49,-5166.35 4397,-5151.81 4397.33,-5151.73 4397.67,-5151.66 4398,-5151.58"/>
<polygon fill="black" stroke="black" points="4398.91,-5154.96 4407.83,-5149.23 4397.29,-5148.15 4398.91,-5154.96"/>
</g>
<!-- expert_linear2_0_2_1 -->
<g id="node49" class="node">
<title>expert_linear2_0_2_1</title>
<polygon fill="lightgreen" stroke="black" points="4598.5,-5062.81 4425.5,-5062.81 4425.5,-5009.81 4598.5,-5009.81 4598.5,-5062.81"/>
<text text-anchor="middle" x="4512" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="4512" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4512" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_0_2_1&#45;&gt;expert_linear2_0_2_1 -->
<g id="edge49" class="edge">
<title>expert_activation_0_2_1&#45;&gt;expert_linear2_0_2_1</title>
<path fill="none" stroke="black" d="M4502.83,-5098.68C4504.02,-5090.7 4505.36,-5081.75 4506.64,-5073.2"/>
<polygon fill="black" stroke="black" points="4510.14,-5073.47 4508.15,-5063.06 4503.21,-5072.44 4510.14,-5073.47"/>
</g>
<!-- expert_linear2_0_2_1&#45;&gt;aggregate_0 -->
<g id="edge147" class="edge">
<title>expert_linear2_0_2_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4598.57,-5012.39C4603.43,-5011.44 4608.27,-5010.57 4613,-5009.81 5005.68,-4947.33 5472.69,-4929.19 5722.08,-4923.94"/>
<polygon fill="black" stroke="black" points="5722.4,-4927.43 5732.32,-4923.73 5722.25,-4920.43 5722.4,-4927.43"/>
</g>
<!-- expert_linear1_0_2_2 -->
<g id="node51" class="node">
<title>expert_linear1_0_2_2</title>
<polygon fill="lightgreen" stroke="black" points="4475,-5240.81 4293,-5240.81 4293,-5187.81 4475,-5187.81 4475,-5240.81"/>
<text text-anchor="middle" x="4384" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="4384" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4384" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_0_2_2&#45;&gt;expert_linear1_0_2_2 -->
<g id="edge51" class="edge">
<title>route_to_expert_0_2_2&#45;&gt;expert_linear1_0_2_2</title>
<path fill="none" stroke="black" d="M4344.73,-5277.36C4350.49,-5268.27 4356.65,-5258.53 4362.35,-5249.52"/>
<polygon fill="black" stroke="black" points="4365.47,-5251.14 4367.86,-5240.81 4359.56,-5247.39 4365.47,-5251.14"/>
</g>
<!-- expert_activation_0_2_2 -->
<g id="node52" class="node">
<title>expert_activation_0_2_2</title>
<polygon fill="lightgreen" stroke="black" points="4791,-5151.81 4609,-5151.81 4609,-5098.81 4791,-5098.81 4791,-5151.81"/>
<text text-anchor="middle" x="4700" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="4700" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4700" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_0_2_2&#45;&gt;expert_activation_0_2_2 -->
<g id="edge52" class="edge">
<title>expert_linear1_0_2_2&#45;&gt;expert_activation_0_2_2</title>
<path fill="none" stroke="black" d="M4475.4,-5188.15C4514.13,-5177.49 4559.4,-5165.02 4599.1,-5154.09"/>
<polygon fill="black" stroke="black" points="4600.09,-5157.45 4608.81,-5151.42 4598.23,-5150.7 4600.09,-5157.45"/>
</g>
<!-- expert_linear2_0_2_2 -->
<g id="node53" class="node">
<title>expert_linear2_0_2_2</title>
<polygon fill="lightgreen" stroke="black" points="4794.5,-5062.81 4621.5,-5062.81 4621.5,-5009.81 4794.5,-5009.81 4794.5,-5062.81"/>
<text text-anchor="middle" x="4708" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="4708" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4708" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_0_2_2&#45;&gt;expert_linear2_0_2_2 -->
<g id="edge53" class="edge">
<title>expert_activation_0_2_2&#45;&gt;expert_linear2_0_2_2</title>
<path fill="none" stroke="black" d="M4702.36,-5098.68C4703.09,-5090.7 4703.91,-5081.75 4704.7,-5073.2"/>
<polygon fill="black" stroke="black" points="4708.2,-5073.34 4705.63,-5063.06 4701.23,-5072.7 4708.2,-5073.34"/>
</g>
<!-- expert_linear2_0_2_2&#45;&gt;aggregate_0 -->
<g id="edge148" class="edge">
<title>expert_linear2_0_2_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4794.59,-5013.16C4800.8,-5011.92 4806.98,-5010.78 4813,-5009.81 5132.25,-4958.45 5509.34,-4936.45 5724.99,-4927.5"/>
<polygon fill="black" stroke="black" points="5725.29,-4930.99 5735.14,-4927.08 5725,-4924 5725.29,-4930.99"/>
</g>
<!-- expert_linear1_0_2_3 -->
<g id="node55" class="node">
<title>expert_linear1_0_2_3</title>
<polygon fill="lightgreen" stroke="black" points="4737,-5240.81 4555,-5240.81 4555,-5187.81 4737,-5187.81 4737,-5240.81"/>
<text text-anchor="middle" x="4646" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="4646" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4646" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_0_2_3&#45;&gt;expert_linear1_0_2_3 -->
<g id="edge55" class="edge">
<title>route_to_expert_0_2_3&#45;&gt;expert_linear1_0_2_3</title>
<path fill="none" stroke="black" d="M4607.37,-5277.36C4613.03,-5268.27 4619.09,-5258.53 4624.7,-5249.52"/>
<polygon fill="black" stroke="black" points="4627.81,-5251.15 4630.12,-5240.81 4621.87,-5247.45 4627.81,-5251.15"/>
</g>
<!-- expert_activation_0_2_3 -->
<g id="node56" class="node">
<title>expert_activation_0_2_3</title>
<polygon fill="lightgreen" stroke="black" points="4991,-5151.81 4809,-5151.81 4809,-5098.81 4991,-5098.81 4991,-5151.81"/>
<text text-anchor="middle" x="4900" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="4900" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4900" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_0_2_3&#45;&gt;expert_activation_0_2_3 -->
<g id="edge56" class="edge">
<title>expert_linear1_0_2_3&#45;&gt;expert_activation_0_2_3</title>
<path fill="none" stroke="black" d="M4720.49,-5187.8C4750.34,-5177.57 4784.89,-5165.74 4815.66,-5155.2"/>
<polygon fill="black" stroke="black" points="4817.18,-5158.38 4825.51,-5151.83 4814.91,-5151.76 4817.18,-5158.38"/>
</g>
<!-- expert_linear2_0_2_3 -->
<g id="node57" class="node">
<title>expert_linear2_0_2_3</title>
<polygon fill="lightgreen" stroke="black" points="4994.5,-5062.81 4821.5,-5062.81 4821.5,-5009.81 4994.5,-5009.81 4994.5,-5062.81"/>
<text text-anchor="middle" x="4908" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="4908" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4908" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_0_2_3&#45;&gt;expert_linear2_0_2_3 -->
<g id="edge57" class="edge">
<title>expert_activation_0_2_3&#45;&gt;expert_linear2_0_2_3</title>
<path fill="none" stroke="black" d="M4902.36,-5098.68C4903.09,-5090.7 4903.91,-5081.75 4904.7,-5073.2"/>
<polygon fill="black" stroke="black" points="4908.2,-5073.34 4905.63,-5063.06 4901.23,-5072.7 4908.2,-5073.34"/>
</g>
<!-- expert_linear2_0_2_3&#45;&gt;aggregate_0 -->
<g id="edge149" class="edge">
<title>expert_linear2_0_2_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M4994.61,-5013.28C5000.81,-5012.01 5006.99,-5010.84 5013,-5009.81 5259.86,-4967.8 5549.04,-4943.74 5728.4,-4931.72"/>
<polygon fill="black" stroke="black" points="5728.71,-4935.21 5738.46,-4931.05 5728.25,-4928.23 5728.71,-4935.21"/>
</g>
<!-- expert_linear1_0_3_0 -->
<g id="node59" class="node">
<title>expert_linear1_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="4998,-5240.81 4816,-5240.81 4816,-5187.81 4998,-5187.81 4998,-5240.81"/>
<text text-anchor="middle" x="4907" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="4907" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4907" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_0_3_0&#45;&gt;expert_linear1_0_3_0 -->
<g id="edge59" class="edge">
<title>route_to_expert_0_3_0&#45;&gt;expert_linear1_0_3_0</title>
<path fill="none" stroke="black" d="M4869.63,-5277.36C4875.11,-5268.27 4880.98,-5258.53 4886.4,-5249.52"/>
<polygon fill="black" stroke="black" points="4889.48,-5251.19 4891.64,-5240.81 4883.49,-5247.57 4889.48,-5251.19"/>
</g>
<!-- expert_activation_0_3_0 -->
<g id="node60" class="node">
<title>expert_activation_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="5191,-5151.81 5009,-5151.81 5009,-5098.81 5191,-5098.81 5191,-5151.81"/>
<text text-anchor="middle" x="5100" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="5100" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5100" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_0_3_0&#45;&gt;expert_activation_0_3_0 -->
<g id="edge60" class="edge">
<title>expert_linear1_0_3_0&#45;&gt;expert_activation_0_3_0</title>
<path fill="none" stroke="black" d="M4963.6,-5187.8C4985.7,-5177.84 5011.18,-5166.35 5034.09,-5156.02"/>
<polygon fill="black" stroke="black" points="5035.72,-5159.13 5043.4,-5151.83 5032.84,-5152.75 5035.72,-5159.13"/>
</g>
<!-- expert_linear2_0_3_0 -->
<g id="node61" class="node">
<title>expert_linear2_0_3_0</title>
<polygon fill="lightgreen" stroke="black" points="5194.5,-5062.81 5021.5,-5062.81 5021.5,-5009.81 5194.5,-5009.81 5194.5,-5062.81"/>
<text text-anchor="middle" x="5108" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="5108" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5108" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_0_3_0&#45;&gt;expert_linear2_0_3_0 -->
<g id="edge61" class="edge">
<title>expert_activation_0_3_0&#45;&gt;expert_linear2_0_3_0</title>
<path fill="none" stroke="black" d="M5102.36,-5098.68C5103.09,-5090.7 5103.91,-5081.75 5104.7,-5073.2"/>
<polygon fill="black" stroke="black" points="5108.2,-5073.34 5105.63,-5063.06 5101.23,-5072.7 5108.2,-5073.34"/>
</g>
<!-- expert_linear2_0_3_0&#45;&gt;aggregate_0 -->
<g id="edge150" class="edge">
<title>expert_linear2_0_3_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M5194.66,-5013.29C5200.52,-5012.04 5206.33,-5010.87 5212,-5009.81 5388.74,-4976.95 5593.33,-4952.49 5733.17,-4937.81"/>
<polygon fill="black" stroke="black" points="5733.54,-4941.29 5743.12,-4936.77 5732.81,-4934.32 5733.54,-4941.29"/>
</g>
<!-- expert_linear1_0_3_1 -->
<g id="node63" class="node">
<title>expert_linear1_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="5257,-5240.81 5075,-5240.81 5075,-5187.81 5257,-5187.81 5257,-5240.81"/>
<text text-anchor="middle" x="5166" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="5166" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5166" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_0_3_1&#45;&gt;expert_linear1_0_3_1 -->
<g id="edge63" class="edge">
<title>route_to_expert_0_3_1&#45;&gt;expert_linear1_0_3_1</title>
<path fill="none" stroke="black" d="M5131.32,-5277.09C5136.32,-5268.18 5141.66,-5258.68 5146.61,-5249.86"/>
<polygon fill="black" stroke="black" points="5149.75,-5251.4 5151.6,-5240.97 5143.65,-5247.98 5149.75,-5251.4"/>
</g>
<!-- expert_activation_0_3_1 -->
<g id="node64" class="node">
<title>expert_activation_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="5391,-5151.81 5209,-5151.81 5209,-5098.81 5391,-5098.81 5391,-5151.81"/>
<text text-anchor="middle" x="5300" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="5300" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5300" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_0_3_1&#45;&gt;expert_activation_0_3_1 -->
<g id="edge64" class="edge">
<title>expert_linear1_0_3_1&#45;&gt;expert_activation_0_3_1</title>
<path fill="none" stroke="black" d="M5205.48,-5187.68C5219.94,-5178.3 5236.46,-5167.57 5251.61,-5157.73"/>
<polygon fill="black" stroke="black" points="5253.86,-5160.44 5260.34,-5152.06 5250.05,-5154.57 5253.86,-5160.44"/>
</g>
<!-- expert_linear2_0_3_1 -->
<g id="node65" class="node">
<title>expert_linear2_0_3_1</title>
<polygon fill="lightgreen" stroke="black" points="5393.5,-5062.81 5220.5,-5062.81 5220.5,-5009.81 5393.5,-5009.81 5393.5,-5062.81"/>
<text text-anchor="middle" x="5307" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="5307" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5307" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_0_3_1&#45;&gt;expert_linear2_0_3_1 -->
<g id="edge65" class="edge">
<title>expert_activation_0_3_1&#45;&gt;expert_linear2_0_3_1</title>
<path fill="none" stroke="black" d="M5302.06,-5098.68C5302.7,-5090.7 5303.43,-5081.75 5304.11,-5073.2"/>
<polygon fill="black" stroke="black" points="5307.61,-5073.31 5304.93,-5063.06 5300.64,-5072.75 5307.61,-5073.31"/>
</g>
<!-- expert_linear2_0_3_1&#45;&gt;aggregate_0 -->
<g id="edge151" class="edge">
<title>expert_linear2_0_3_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M5393.73,-5013.62C5399.57,-5012.29 5405.36,-5011.01 5411,-5009.81 5520.61,-4986.54 5644.89,-4964.22 5740.73,-4947.89"/>
<polygon fill="black" stroke="black" points="5741.53,-4951.31 5750.8,-4946.18 5740.35,-4944.4 5741.53,-4951.31"/>
</g>
<!-- expert_linear1_0_3_2 -->
<g id="node67" class="node">
<title>expert_linear1_0_3_2</title>
<polygon fill="lightgreen" stroke="black" points="5512,-5240.81 5330,-5240.81 5330,-5187.81 5512,-5187.81 5512,-5240.81"/>
<text text-anchor="middle" x="5421" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="5421" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5421" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_0_3_2&#45;&gt;expert_linear1_0_3_2 -->
<g id="edge67" class="edge">
<title>route_to_expert_0_3_2&#45;&gt;expert_linear1_0_3_2</title>
<path fill="none" stroke="black" d="M5391.37,-5277.09C5395.59,-5268.28 5400.1,-5258.88 5404.29,-5250.14"/>
<polygon fill="black" stroke="black" points="5407.52,-5251.5 5408.69,-5240.97 5401.21,-5248.47 5407.52,-5251.5"/>
</g>
<!-- expert_activation_0_3_2 -->
<g id="node68" class="node">
<title>expert_activation_0_3_2</title>
<polygon fill="lightgreen" stroke="black" points="5591,-5151.81 5409,-5151.81 5409,-5098.81 5591,-5098.81 5591,-5151.81"/>
<text text-anchor="middle" x="5500" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="5500" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5500" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_0_3_2&#45;&gt;expert_activation_0_3_2 -->
<g id="edge68" class="edge">
<title>expert_linear1_0_3_2&#45;&gt;expert_activation_0_3_2</title>
<path fill="none" stroke="black" d="M5444.28,-5187.68C5452.24,-5178.91 5461.27,-5168.96 5469.71,-5159.67"/>
<polygon fill="black" stroke="black" points="5472.49,-5161.82 5476.62,-5152.06 5467.3,-5157.11 5472.49,-5161.82"/>
</g>
<!-- expert_linear2_0_3_2 -->
<g id="node69" class="node">
<title>expert_linear2_0_3_2</title>
<polygon fill="lightgreen" stroke="black" points="5592.5,-5062.81 5419.5,-5062.81 5419.5,-5009.81 5592.5,-5009.81 5592.5,-5062.81"/>
<text text-anchor="middle" x="5506" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="5506" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5506" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_0_3_2&#45;&gt;expert_linear2_0_3_2 -->
<g id="edge69" class="edge">
<title>expert_activation_0_3_2&#45;&gt;expert_linear2_0_3_2</title>
<path fill="none" stroke="black" d="M5501.77,-5098.68C5502.32,-5090.7 5502.94,-5081.75 5503.53,-5073.2"/>
<polygon fill="black" stroke="black" points="5507.03,-5073.28 5504.22,-5063.06 5500.04,-5072.8 5507.03,-5073.28"/>
</g>
<!-- expert_linear2_0_3_2&#45;&gt;aggregate_0 -->
<g id="edge152" class="edge">
<title>expert_linear2_0_3_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M5592.95,-5010.26C5640.09,-4996.69 5699.61,-4979.54 5753.66,-4963.97"/>
<polygon fill="black" stroke="black" points="5754.7,-4967.31 5763.34,-4961.18 5752.76,-4960.59 5754.7,-4967.31"/>
</g>
<!-- expert_linear1_0_3_3 -->
<g id="node71" class="node">
<title>expert_linear1_0_3_3</title>
<polygon fill="lightgreen" stroke="black" points="5759,-5240.81 5577,-5240.81 5577,-5187.81 5759,-5187.81 5759,-5240.81"/>
<text text-anchor="middle" x="5668" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="5668" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5668" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_0_3_3&#45;&gt;expert_linear1_0_3_3 -->
<g id="edge71" class="edge">
<title>route_to_expert_0_3_3&#45;&gt;expert_linear1_0_3_3</title>
<path fill="none" stroke="black" d="M5648.54,-5276.81C5651.27,-5268.2 5654.16,-5259.05 5656.87,-5250.5"/>
<polygon fill="black" stroke="black" points="5660.25,-5251.41 5659.93,-5240.82 5653.57,-5249.3 5660.25,-5251.41"/>
</g>
<!-- expert_activation_0_3_3 -->
<g id="node72" class="node">
<title>expert_activation_0_3_3</title>
<polygon fill="lightgreen" stroke="black" points="5791,-5151.81 5609,-5151.81 5609,-5098.81 5791,-5098.81 5791,-5151.81"/>
<text text-anchor="middle" x="5700" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="5700" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5700" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_0_3_3&#45;&gt;expert_activation_0_3_3 -->
<g id="edge72" class="edge">
<title>expert_linear1_0_3_3&#45;&gt;expert_activation_0_3_3</title>
<path fill="none" stroke="black" d="M5677.43,-5187.68C5680.43,-5179.52 5683.8,-5170.35 5687.01,-5161.63"/>
<polygon fill="black" stroke="black" points="5690.36,-5162.66 5690.53,-5152.06 5683.79,-5160.24 5690.36,-5162.66"/>
</g>
<!-- expert_linear2_0_3_3 -->
<g id="node73" class="node">
<title>expert_linear2_0_3_3</title>
<polygon fill="lightgreen" stroke="black" points="5790.5,-5062.81 5617.5,-5062.81 5617.5,-5009.81 5790.5,-5009.81 5790.5,-5062.81"/>
<text text-anchor="middle" x="5704" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="5704" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5704" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_0_3_3&#45;&gt;expert_linear2_0_3_3 -->
<g id="edge73" class="edge">
<title>expert_activation_0_3_3&#45;&gt;expert_linear2_0_3_3</title>
<path fill="none" stroke="black" d="M5701.18,-5098.68C5701.55,-5090.7 5701.96,-5081.75 5702.35,-5073.2"/>
<polygon fill="black" stroke="black" points="5705.85,-5073.21 5702.82,-5063.06 5698.86,-5072.89 5705.85,-5073.21"/>
</g>
<!-- expert_linear2_0_3_3&#45;&gt;aggregate_0 -->
<g id="edge153" class="edge">
<title>expert_linear2_0_3_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M5748.48,-5009.56C5764.27,-5000.41 5782.74,-4989.71 5801.25,-4979"/>
<polygon fill="black" stroke="black" points="5803.14,-4981.95 5810.04,-4973.91 5799.63,-4975.89 5803.14,-4981.95"/>
</g>
<!-- expert_linear1_0_4_0 -->
<g id="node75" class="node">
<title>expert_linear1_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5991,-5240.81 5809,-5240.81 5809,-5187.81 5991,-5187.81 5991,-5240.81"/>
<text text-anchor="middle" x="5900" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 16 Linear 1</text>
<text text-anchor="middle" x="5900" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5900" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_0_4_0&#45;&gt;expert_linear1_0_4_0 -->
<g id="edge75" class="edge">
<title>route_to_expert_0_4_0&#45;&gt;expert_linear1_0_4_0</title>
<path fill="none" stroke="black" d="M5900,-5276.81C5900,-5268.39 5900,-5259.45 5900,-5251.06"/>
<polygon fill="black" stroke="black" points="5903.5,-5250.82 5900,-5240.82 5896.5,-5250.82 5903.5,-5250.82"/>
</g>
<!-- expert_activation_0_4_0 -->
<g id="node76" class="node">
<title>expert_activation_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5991,-5151.81 5809,-5151.81 5809,-5098.81 5991,-5098.81 5991,-5151.81"/>
<text text-anchor="middle" x="5900" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 16 GELU</text>
<text text-anchor="middle" x="5900" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5900" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_0_4_0&#45;&gt;expert_activation_0_4_0 -->
<g id="edge76" class="edge">
<title>expert_linear1_0_4_0&#45;&gt;expert_activation_0_4_0</title>
<path fill="none" stroke="black" d="M5900,-5187.68C5900,-5179.7 5900,-5170.75 5900,-5162.2"/>
<polygon fill="black" stroke="black" points="5903.5,-5162.06 5900,-5152.06 5896.5,-5162.06 5903.5,-5162.06"/>
</g>
<!-- expert_linear2_0_4_0 -->
<g id="node77" class="node">
<title>expert_linear2_0_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5986.5,-5062.81 5813.5,-5062.81 5813.5,-5009.81 5986.5,-5009.81 5986.5,-5062.81"/>
<text text-anchor="middle" x="5900" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 16 Linear 2</text>
<text text-anchor="middle" x="5900" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5900" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_0_4_0&#45;&gt;expert_linear2_0_4_0 -->
<g id="edge77" class="edge">
<title>expert_activation_0_4_0&#45;&gt;expert_linear2_0_4_0</title>
<path fill="none" stroke="black" d="M5900,-5098.68C5900,-5090.7 5900,-5081.75 5900,-5073.2"/>
<polygon fill="black" stroke="black" points="5903.5,-5073.06 5900,-5063.06 5896.5,-5073.06 5903.5,-5073.06"/>
</g>
<!-- expert_linear2_0_4_0&#45;&gt;aggregate_0 -->
<g id="edge154" class="edge">
<title>expert_linear2_0_4_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M5900,-5009.56C5900,-5001.86 5900,-4993.06 5900,-4984.08"/>
<polygon fill="black" stroke="black" points="5903.5,-4983.91 5900,-4973.91 5896.5,-4983.91 5903.5,-4983.91"/>
</g>
<!-- expert_linear1_0_4_1 -->
<g id="node79" class="node">
<title>expert_linear1_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="6222,-5240.81 6040,-5240.81 6040,-5187.81 6222,-5187.81 6222,-5240.81"/>
<text text-anchor="middle" x="6131" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 17 Linear 1</text>
<text text-anchor="middle" x="6131" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6131" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_0_4_1&#45;&gt;expert_linear1_0_4_1 -->
<g id="edge79" class="edge">
<title>route_to_expert_0_4_1&#45;&gt;expert_linear1_0_4_1</title>
<path fill="none" stroke="black" d="M6151.08,-5276.81C6148.27,-5268.2 6145.28,-5259.05 6142.49,-5250.5"/>
<polygon fill="black" stroke="black" points="6145.76,-5249.24 6139.33,-5240.82 6139.11,-5251.42 6145.76,-5249.24"/>
</g>
<!-- expert_activation_0_4_1 -->
<g id="node80" class="node">
<title>expert_activation_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="6212,-5151.81 6030,-5151.81 6030,-5098.81 6212,-5098.81 6212,-5151.81"/>
<text text-anchor="middle" x="6121" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 17 GELU</text>
<text text-anchor="middle" x="6121" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6121" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_0_4_1&#45;&gt;expert_activation_0_4_1 -->
<g id="edge80" class="edge">
<title>expert_linear1_0_4_1&#45;&gt;expert_activation_0_4_1</title>
<path fill="none" stroke="black" d="M6128.05,-5187.68C6127.14,-5179.7 6126.11,-5170.75 6125.12,-5162.2"/>
<polygon fill="black" stroke="black" points="6128.58,-5161.6 6123.96,-5152.06 6121.62,-5162.4 6128.58,-5161.6"/>
</g>
<!-- expert_linear2_0_4_1 -->
<g id="node81" class="node">
<title>expert_linear2_0_4_1</title>
<polygon fill="lightgreen" stroke="black" points="6197.5,-5062.81 6024.5,-5062.81 6024.5,-5009.81 6197.5,-5009.81 6197.5,-5062.81"/>
<text text-anchor="middle" x="6111" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 17 Linear 2</text>
<text text-anchor="middle" x="6111" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6111" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_0_4_1&#45;&gt;expert_linear2_0_4_1 -->
<g id="edge81" class="edge">
<title>expert_activation_0_4_1&#45;&gt;expert_linear2_0_4_1</title>
<path fill="none" stroke="black" d="M6118.05,-5098.68C6117.14,-5090.7 6116.11,-5081.75 6115.12,-5073.2"/>
<polygon fill="black" stroke="black" points="6118.58,-5072.6 6113.96,-5063.06 6111.62,-5073.4 6118.58,-5072.6"/>
</g>
<!-- expert_linear2_0_4_1&#45;&gt;aggregate_0 -->
<g id="edge155" class="edge">
<title>expert_linear2_0_4_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M6063.38,-5009.7C6046.23,-5000.47 6026.12,-4989.66 6005.99,-4978.83"/>
<polygon fill="black" stroke="black" points="6007.52,-4975.68 5997.06,-4974.02 6004.21,-4981.84 6007.52,-4975.68"/>
</g>
<!-- expert_linear1_0_4_2 -->
<g id="node83" class="node">
<title>expert_linear1_0_4_2</title>
<polygon fill="lightgreen" stroke="black" points="6470,-5240.81 6288,-5240.81 6288,-5187.81 6470,-5187.81 6470,-5240.81"/>
<text text-anchor="middle" x="6379" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 18 Linear 1</text>
<text text-anchor="middle" x="6379" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6379" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_0_4_2&#45;&gt;expert_linear1_0_4_2 -->
<g id="edge83" class="edge">
<title>route_to_expert_0_4_2&#45;&gt;expert_linear1_0_4_2</title>
<path fill="none" stroke="black" d="M6408.63,-5277.09C6404.41,-5268.28 6399.9,-5258.88 6395.71,-5250.14"/>
<polygon fill="black" stroke="black" points="6398.79,-5248.47 6391.31,-5240.97 6392.48,-5251.5 6398.79,-5248.47"/>
</g>
<!-- expert_activation_0_4_2 -->
<g id="node84" class="node">
<title>expert_activation_0_4_2</title>
<polygon fill="lightgreen" stroke="black" points="6441,-5151.81 6259,-5151.81 6259,-5098.81 6441,-5098.81 6441,-5151.81"/>
<text text-anchor="middle" x="6350" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 18 GELU</text>
<text text-anchor="middle" x="6350" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6350" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_0_4_2&#45;&gt;expert_activation_0_4_2 -->
<g id="edge84" class="edge">
<title>expert_linear1_0_4_2&#45;&gt;expert_activation_0_4_2</title>
<path fill="none" stroke="black" d="M6370.46,-5187.68C6367.74,-5179.52 6364.68,-5170.35 6361.77,-5161.63"/>
<polygon fill="black" stroke="black" points="6365.07,-5160.44 6358.58,-5152.06 6358.43,-5162.66 6365.07,-5160.44"/>
</g>
<!-- expert_linear2_0_4_2 -->
<g id="node85" class="node">
<title>expert_linear2_0_4_2</title>
<polygon fill="lightgreen" stroke="black" points="6426.5,-5062.81 6253.5,-5062.81 6253.5,-5009.81 6426.5,-5009.81 6426.5,-5062.81"/>
<text text-anchor="middle" x="6340" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 18 Linear 2</text>
<text text-anchor="middle" x="6340" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6340" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_0_4_2&#45;&gt;expert_linear2_0_4_2 -->
<g id="edge85" class="edge">
<title>expert_activation_0_4_2&#45;&gt;expert_linear2_0_4_2</title>
<path fill="none" stroke="black" d="M6347.05,-5098.68C6346.14,-5090.7 6345.11,-5081.75 6344.12,-5073.2"/>
<polygon fill="black" stroke="black" points="6347.58,-5072.6 6342.96,-5063.06 6340.62,-5073.4 6347.58,-5072.6"/>
</g>
<!-- expert_linear2_0_4_2&#45;&gt;aggregate_0 -->
<g id="edge156" class="edge">
<title>expert_linear2_0_4_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M6253.33,-5012.96C6212.41,-5002.4 6161.6,-4989.29 6111.39,-4976.34"/>
<polygon fill="black" stroke="black" points="6112.25,-4972.95 6101.69,-4973.84 6110.5,-4979.73 6112.25,-4972.95"/>
</g>
<!-- expert_linear1_0_4_3 -->
<g id="node87" class="node">
<title>expert_linear1_0_4_3</title>
<polygon fill="lightgreen" stroke="black" points="6670,-5240.81 6488,-5240.81 6488,-5187.81 6670,-5187.81 6670,-5240.81"/>
<text text-anchor="middle" x="6579" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 19 Linear 1</text>
<text text-anchor="middle" x="6579" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6579" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_0_4_3&#45;&gt;expert_linear1_0_4_3 -->
<g id="edge87" class="edge">
<title>route_to_expert_0_4_3&#45;&gt;expert_linear1_0_4_3</title>
<path fill="none" stroke="black" d="M6649.91,-5278.47C6638.78,-5268.56 6626.7,-5257.8 6615.71,-5248.01"/>
<polygon fill="black" stroke="black" points="6617.73,-5245.13 6607.94,-5241.09 6613.08,-5250.35 6617.73,-5245.13"/>
</g>
<!-- expert_activation_0_4_3 -->
<g id="node88" class="node">
<title>expert_activation_0_4_3</title>
<polygon fill="lightgreen" stroke="black" points="6660,-5151.81 6478,-5151.81 6478,-5098.81 6660,-5098.81 6660,-5151.81"/>
<text text-anchor="middle" x="6569" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 19 GELU</text>
<text text-anchor="middle" x="6569" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6569" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_0_4_3&#45;&gt;expert_activation_0_4_3 -->
<g id="edge88" class="edge">
<title>expert_linear1_0_4_3&#45;&gt;expert_activation_0_4_3</title>
<path fill="none" stroke="black" d="M6576.05,-5187.68C6575.14,-5179.7 6574.11,-5170.75 6573.12,-5162.2"/>
<polygon fill="black" stroke="black" points="6576.58,-5161.6 6571.96,-5152.06 6569.62,-5162.4 6576.58,-5161.6"/>
</g>
<!-- expert_linear2_0_4_3 -->
<g id="node89" class="node">
<title>expert_linear2_0_4_3</title>
<polygon fill="lightgreen" stroke="black" points="6641.5,-5062.81 6468.5,-5062.81 6468.5,-5009.81 6641.5,-5009.81 6641.5,-5062.81"/>
<text text-anchor="middle" x="6555" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 19 Linear 2</text>
<text text-anchor="middle" x="6555" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6555" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_0_4_3&#45;&gt;expert_linear2_0_4_3 -->
<g id="edge89" class="edge">
<title>expert_activation_0_4_3&#45;&gt;expert_linear2_0_4_3</title>
<path fill="none" stroke="black" d="M6564.88,-5098.68C6563.59,-5090.7 6562.15,-5081.75 6560.77,-5073.2"/>
<polygon fill="black" stroke="black" points="6564.19,-5072.38 6559.14,-5063.06 6557.28,-5073.49 6564.19,-5072.38"/>
</g>
<!-- expert_linear2_0_4_3&#45;&gt;aggregate_0 -->
<g id="edge157" class="edge">
<title>expert_linear2_0_4_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M6468.33,-5016.23C6457.46,-5013.99 6446.48,-5011.8 6436,-5009.81 6327.16,-4989.23 6205.35,-4969.01 6105.39,-4953.15"/>
<polygon fill="black" stroke="black" points="6105.91,-4949.69 6095.48,-4951.58 6104.81,-4956.6 6105.91,-4949.69"/>
</g>
<!-- expert_linear1_0_5_0 -->
<g id="node91" class="node">
<title>expert_linear1_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="6956,-5240.81 6774,-5240.81 6774,-5187.81 6956,-5187.81 6956,-5240.81"/>
<text text-anchor="middle" x="6865" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 20 Linear 1</text>
<text text-anchor="middle" x="6865" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6865" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_0_5_0&#45;&gt;expert_linear1_0_5_0 -->
<g id="edge91" class="edge">
<title>route_to_expert_0_5_0&#45;&gt;expert_linear1_0_5_0</title>
<path fill="none" stroke="black" d="M6920.59,-5277.92C6912.15,-5268.41 6903.05,-5258.16 6894.7,-5248.76"/>
<polygon fill="black" stroke="black" points="6897.16,-5246.26 6887.9,-5241.1 6891.92,-5250.91 6897.16,-5246.26"/>
</g>
<!-- expert_activation_0_5_0 -->
<g id="node92" class="node">
<title>expert_activation_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="6903,-5151.81 6721,-5151.81 6721,-5098.81 6903,-5098.81 6903,-5151.81"/>
<text text-anchor="middle" x="6812" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 20 GELU</text>
<text text-anchor="middle" x="6812" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6812" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_0_5_0&#45;&gt;expert_activation_0_5_0 -->
<g id="edge92" class="edge">
<title>expert_linear1_0_5_0&#45;&gt;expert_activation_0_5_0</title>
<path fill="none" stroke="black" d="M6849.38,-5187.68C6844.26,-5179.26 6838.47,-5169.76 6833,-5160.79"/>
<polygon fill="black" stroke="black" points="6835.88,-5158.78 6827.69,-5152.06 6829.9,-5162.42 6835.88,-5158.78"/>
</g>
<!-- expert_linear2_0_5_0 -->
<g id="node93" class="node">
<title>expert_linear2_0_5_0</title>
<polygon fill="lightgreen" stroke="black" points="6870.5,-5062.81 6697.5,-5062.81 6697.5,-5009.81 6870.5,-5009.81 6870.5,-5062.81"/>
<text text-anchor="middle" x="6784" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 20 Linear 2</text>
<text text-anchor="middle" x="6784" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6784" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_0_5_0&#45;&gt;expert_linear2_0_5_0 -->
<g id="edge93" class="edge">
<title>expert_activation_0_5_0&#45;&gt;expert_linear2_0_5_0</title>
<path fill="none" stroke="black" d="M6803.75,-5098.68C6801.13,-5090.52 6798.17,-5081.35 6795.37,-5072.63"/>
<polygon fill="black" stroke="black" points="6798.68,-5071.51 6792.29,-5063.06 6792.02,-5073.65 6798.68,-5071.51"/>
</g>
<!-- expert_linear2_0_5_0&#45;&gt;aggregate_0 -->
<g id="edge158" class="edge">
<title>expert_linear2_0_5_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M6697.23,-5017.73C6681.87,-5014.89 6665.99,-5012.12 6651,-5009.81 6463.3,-4980.86 6247.9,-4956.53 6096.05,-4940.84"/>
<polygon fill="black" stroke="black" points="6095.99,-4937.31 6085.68,-4939.77 6095.27,-4944.28 6095.99,-4937.31"/>
</g>
<!-- expert_linear1_0_5_1 -->
<g id="node95" class="node">
<title>expert_linear1_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="7231,-5240.81 7049,-5240.81 7049,-5187.81 7231,-5187.81 7231,-5240.81"/>
<text text-anchor="middle" x="7140" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 21 Linear 1</text>
<text text-anchor="middle" x="7140" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7140" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_0_5_1&#45;&gt;expert_linear1_0_5_1 -->
<g id="edge95" class="edge">
<title>route_to_expert_0_5_1&#45;&gt;expert_linear1_0_5_1</title>
<path fill="none" stroke="black" d="M7187.71,-5277.64C7180.59,-5268.34 7172.94,-5258.35 7165.9,-5249.14"/>
<polygon fill="black" stroke="black" points="7168.49,-5246.77 7159.63,-5240.96 7162.93,-5251.03 7168.49,-5246.77"/>
</g>
<!-- expert_activation_0_5_1 -->
<g id="node96" class="node">
<title>expert_activation_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="7190,-5151.81 7008,-5151.81 7008,-5098.81 7190,-5098.81 7190,-5151.81"/>
<text text-anchor="middle" x="7099" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 21 GELU</text>
<text text-anchor="middle" x="7099" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7099" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_0_5_1&#45;&gt;expert_activation_0_5_1 -->
<g id="edge96" class="edge">
<title>expert_linear1_0_5_1&#45;&gt;expert_activation_0_5_1</title>
<path fill="none" stroke="black" d="M7127.92,-5187.68C7124.03,-5179.44 7119.66,-5170.15 7115.51,-5161.35"/>
<polygon fill="black" stroke="black" points="7118.56,-5159.62 7111.13,-5152.06 7112.23,-5162.6 7118.56,-5159.62"/>
</g>
<!-- expert_linear2_0_5_1 -->
<g id="node97" class="node">
<title>expert_linear2_0_5_1</title>
<polygon fill="lightgreen" stroke="black" points="7143.5,-5062.81 6970.5,-5062.81 6970.5,-5009.81 7143.5,-5009.81 7143.5,-5062.81"/>
<text text-anchor="middle" x="7057" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 21 Linear 2</text>
<text text-anchor="middle" x="7057" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7057" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_0_5_1&#45;&gt;expert_linear2_0_5_1 -->
<g id="edge97" class="edge">
<title>expert_activation_0_5_1&#45;&gt;expert_linear2_0_5_1</title>
<path fill="none" stroke="black" d="M7086.63,-5098.68C7082.6,-5090.35 7078.07,-5080.96 7073.78,-5072.07"/>
<polygon fill="black" stroke="black" points="7076.93,-5070.55 7069.43,-5063.06 7070.63,-5073.59 7076.93,-5070.55"/>
</g>
<!-- expert_linear2_0_5_1&#45;&gt;aggregate_0 -->
<g id="edge159" class="edge">
<title>expert_linear2_0_5_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M6970.24,-5021.87C6941.56,-5017.68 6909.45,-5013.25 6880,-5009.81 6606.91,-4977.9 6289.84,-4951.33 6092.03,-4936"/>
<polygon fill="black" stroke="black" points="6092.06,-4932.49 6081.82,-4935.21 6091.52,-4939.47 6092.06,-4932.49"/>
</g>
<!-- expert_linear1_0_5_2 -->
<g id="node99" class="node">
<title>expert_linear1_0_5_2</title>
<polygon fill="lightgreen" stroke="black" points="7500,-5240.81 7318,-5240.81 7318,-5187.81 7500,-5187.81 7500,-5240.81"/>
<text text-anchor="middle" x="7409" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 22 Linear 1</text>
<text text-anchor="middle" x="7409" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7409" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_0_5_2&#45;&gt;expert_linear1_0_5_2 -->
<g id="edge99" class="edge">
<title>route_to_expert_0_5_2&#45;&gt;expert_linear1_0_5_2</title>
<path fill="none" stroke="black" d="M7452.7,-5277.36C7446.23,-5268.18 7439.29,-5258.33 7432.89,-5249.24"/>
<polygon fill="black" stroke="black" points="7435.58,-5246.97 7426.96,-5240.81 7429.86,-5251 7435.58,-5246.97"/>
</g>
<!-- expert_activation_0_5_2 -->
<g id="node100" class="node">
<title>expert_activation_0_5_2</title>
<polygon fill="lightgreen" stroke="black" points="7466,-5151.81 7284,-5151.81 7284,-5098.81 7466,-5098.81 7466,-5151.81"/>
<text text-anchor="middle" x="7375" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 22 GELU</text>
<text text-anchor="middle" x="7375" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7375" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_0_5_2&#45;&gt;expert_activation_0_5_2 -->
<g id="edge100" class="edge">
<title>expert_linear1_0_5_2&#45;&gt;expert_activation_0_5_2</title>
<path fill="none" stroke="black" d="M7398.98,-5187.68C7395.79,-5179.52 7392.21,-5170.35 7388.8,-5161.63"/>
<polygon fill="black" stroke="black" points="7391.96,-5160.1 7385.06,-5152.06 7385.44,-5162.65 7391.96,-5160.1"/>
</g>
<!-- expert_linear2_0_5_2 -->
<g id="node101" class="node">
<title>expert_linear2_0_5_2</title>
<polygon fill="lightgreen" stroke="black" points="7414.5,-5062.81 7241.5,-5062.81 7241.5,-5009.81 7414.5,-5009.81 7414.5,-5062.81"/>
<text text-anchor="middle" x="7328" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 22 Linear 2</text>
<text text-anchor="middle" x="7328" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7328" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_0_5_2&#45;&gt;expert_linear2_0_5_2 -->
<g id="edge101" class="edge">
<title>expert_activation_0_5_2&#45;&gt;expert_linear2_0_5_2</title>
<path fill="none" stroke="black" d="M7361.15,-5098.68C7356.65,-5090.35 7351.58,-5080.96 7346.78,-5072.07"/>
<polygon fill="black" stroke="black" points="7349.74,-5070.2 7341.91,-5063.06 7343.58,-5073.52 7349.74,-5070.2"/>
</g>
<!-- expert_linear2_0_5_2&#45;&gt;aggregate_0 -->
<g id="edge160" class="edge">
<title>expert_linear2_0_5_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M7241.38,-5021.39C7213.24,-5017.21 7181.85,-5012.92 7153,-5009.81 6776.09,-4969.17 6333.28,-4943.15 6087.87,-4930.63"/>
<polygon fill="black" stroke="black" points="6087.95,-4927.13 6077.78,-4930.12 6087.59,-4934.12 6087.95,-4927.13"/>
</g>
<!-- expert_linear1_0_5_3 -->
<g id="node103" class="node">
<title>expert_linear1_0_5_3</title>
<polygon fill="lightgreen" stroke="black" points="7766,-5240.81 7584,-5240.81 7584,-5187.81 7766,-5187.81 7766,-5240.81"/>
<text text-anchor="middle" x="7675" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 23 Linear 1</text>
<text text-anchor="middle" x="7675" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7675" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_0_5_3&#45;&gt;expert_linear1_0_5_3 -->
<g id="edge103" class="edge">
<title>route_to_expert_0_5_3&#45;&gt;expert_linear1_0_5_3</title>
<path fill="none" stroke="black" d="M7716.8,-5277.36C7710.61,-5268.18 7703.97,-5258.33 7697.86,-5249.24"/>
<polygon fill="black" stroke="black" points="7700.67,-5247.15 7692.18,-5240.81 7694.86,-5251.06 7700.67,-5247.15"/>
</g>
<!-- expert_activation_0_5_3 -->
<g id="node104" class="node">
<title>expert_activation_0_5_3</title>
<polygon fill="lightgreen" stroke="black" points="7733,-5151.81 7551,-5151.81 7551,-5098.81 7733,-5098.81 7733,-5151.81"/>
<text text-anchor="middle" x="7642" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 23 GELU</text>
<text text-anchor="middle" x="7642" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7642" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_0_5_3&#45;&gt;expert_activation_0_5_3 -->
<g id="edge104" class="edge">
<title>expert_linear1_0_5_3&#45;&gt;expert_activation_0_5_3</title>
<path fill="none" stroke="black" d="M7665.28,-5187.68C7662.18,-5179.52 7658.7,-5170.35 7655.4,-5161.63"/>
<polygon fill="black" stroke="black" points="7658.59,-5160.17 7651.77,-5152.06 7652.04,-5162.65 7658.59,-5160.17"/>
</g>
<!-- expert_linear2_0_5_3 -->
<g id="node105" class="node">
<title>expert_linear2_0_5_3</title>
<polygon fill="lightgreen" stroke="black" points="7683.5,-5062.81 7510.5,-5062.81 7510.5,-5009.81 7683.5,-5009.81 7683.5,-5062.81"/>
<text text-anchor="middle" x="7597" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 23 Linear 2</text>
<text text-anchor="middle" x="7597" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7597" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_0_5_3&#45;&gt;expert_linear2_0_5_3 -->
<g id="edge105" class="edge">
<title>expert_activation_0_5_3&#45;&gt;expert_linear2_0_5_3</title>
<path fill="none" stroke="black" d="M7628.74,-5098.68C7624.43,-5090.35 7619.57,-5080.96 7614.98,-5072.07"/>
<polygon fill="black" stroke="black" points="7618.02,-5070.34 7610.32,-5063.06 7611.8,-5073.55 7618.02,-5070.34"/>
</g>
<!-- expert_linear2_0_5_3&#45;&gt;aggregate_0 -->
<g id="edge161" class="edge">
<title>expert_linear2_0_5_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M7510.07,-5020.96C7482.6,-5016.84 7452.09,-5012.69 7424,-5009.81 6942.46,-4960.52 6372.28,-4936.77 6085.06,-4927.21"/>
<polygon fill="black" stroke="black" points="6085.07,-4923.71 6074.96,-4926.87 6084.84,-4930.7 6085.07,-4923.71"/>
</g>
<!-- expert_linear1_0_6_0 -->
<g id="node107" class="node">
<title>expert_linear1_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="8030,-5240.81 7848,-5240.81 7848,-5187.81 8030,-5187.81 8030,-5240.81"/>
<text text-anchor="middle" x="7939" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 24 Linear 1</text>
<text text-anchor="middle" x="7939" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7939" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_0_6_0&#45;&gt;expert_linear1_0_6_0 -->
<g id="edge107" class="edge">
<title>route_to_expert_0_6_0&#45;&gt;expert_linear1_0_6_0</title>
<path fill="none" stroke="black" d="M7980.17,-5277.36C7974.07,-5268.18 7967.54,-5258.33 7961.51,-5249.24"/>
<polygon fill="black" stroke="black" points="7964.36,-5247.21 7955.92,-5240.81 7958.53,-5251.08 7964.36,-5247.21"/>
</g>
<!-- expert_activation_0_6_0 -->
<g id="node108" class="node">
<title>expert_activation_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="7998,-5151.81 7816,-5151.81 7816,-5098.81 7998,-5098.81 7998,-5151.81"/>
<text text-anchor="middle" x="7907" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 24 GELU</text>
<text text-anchor="middle" x="7907" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7907" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_0_6_0&#45;&gt;expert_activation_0_6_0 -->
<g id="edge108" class="edge">
<title>expert_linear1_0_6_0&#45;&gt;expert_activation_0_6_0</title>
<path fill="none" stroke="black" d="M7929.57,-5187.68C7926.57,-5179.52 7923.2,-5170.35 7919.99,-5161.63"/>
<polygon fill="black" stroke="black" points="7923.21,-5160.24 7916.47,-5152.06 7916.64,-5162.66 7923.21,-5160.24"/>
</g>
<!-- expert_linear2_0_6_0 -->
<g id="node109" class="node">
<title>expert_linear2_0_6_0</title>
<polygon fill="lightgreen" stroke="black" points="7949.5,-5062.81 7776.5,-5062.81 7776.5,-5009.81 7949.5,-5009.81 7949.5,-5062.81"/>
<text text-anchor="middle" x="7863" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 24 Linear 2</text>
<text text-anchor="middle" x="7863" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7863" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_0_6_0&#45;&gt;expert_linear2_0_6_0 -->
<g id="edge109" class="edge">
<title>expert_activation_0_6_0&#45;&gt;expert_linear2_0_6_0</title>
<path fill="none" stroke="black" d="M7894.04,-5098.68C7889.82,-5090.35 7885.07,-5080.96 7880.58,-5072.07"/>
<polygon fill="black" stroke="black" points="7883.66,-5070.41 7876.02,-5063.06 7877.41,-5073.57 7883.66,-5070.41"/>
</g>
<!-- expert_linear2_0_6_0&#45;&gt;aggregate_0 -->
<g id="edge162" class="edge">
<title>expert_linear2_0_6_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M7776.29,-5020.6C7749.64,-5016.54 7720.17,-5012.51 7693,-5009.81 7106.81,-4951.61 6408.82,-4931.38 6083.66,-4924.78"/>
<polygon fill="black" stroke="black" points="6083.27,-4921.27 6073.2,-4924.57 6083.12,-4928.27 6083.27,-4921.27"/>
</g>
<!-- expert_linear1_0_6_1 -->
<g id="node111" class="node">
<title>expert_linear1_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="8294,-5240.81 8112,-5240.81 8112,-5187.81 8294,-5187.81 8294,-5240.81"/>
<text text-anchor="middle" x="8203" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 25 Linear 1</text>
<text text-anchor="middle" x="8203" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8203" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_0_6_1&#45;&gt;expert_linear1_0_6_1 -->
<g id="edge111" class="edge">
<title>route_to_expert_0_6_1&#45;&gt;expert_linear1_0_6_1</title>
<path fill="none" stroke="black" d="M8243.53,-5277.36C8237.53,-5268.18 8231.1,-5258.33 8225.16,-5249.24"/>
<polygon fill="black" stroke="black" points="8228.06,-5247.27 8219.66,-5240.81 8222.2,-5251.1 8228.06,-5247.27"/>
</g>
<!-- expert_activation_0_6_1 -->
<g id="node112" class="node">
<title>expert_activation_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="8262,-5151.81 8080,-5151.81 8080,-5098.81 8262,-5098.81 8262,-5151.81"/>
<text text-anchor="middle" x="8171" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 25 GELU</text>
<text text-anchor="middle" x="8171" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8171" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_0_6_1&#45;&gt;expert_activation_0_6_1 -->
<g id="edge112" class="edge">
<title>expert_linear1_0_6_1&#45;&gt;expert_activation_0_6_1</title>
<path fill="none" stroke="black" d="M8193.57,-5187.68C8190.57,-5179.52 8187.2,-5170.35 8183.99,-5161.63"/>
<polygon fill="black" stroke="black" points="8187.21,-5160.24 8180.47,-5152.06 8180.64,-5162.66 8187.21,-5160.24"/>
</g>
<!-- expert_linear2_0_6_1 -->
<g id="node113" class="node">
<title>expert_linear2_0_6_1</title>
<polygon fill="lightgreen" stroke="black" points="8214.5,-5062.81 8041.5,-5062.81 8041.5,-5009.81 8214.5,-5009.81 8214.5,-5062.81"/>
<text text-anchor="middle" x="8128" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 25 Linear 2</text>
<text text-anchor="middle" x="8128" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8128" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_0_6_1&#45;&gt;expert_linear2_0_6_1 -->
<g id="edge113" class="edge">
<title>expert_activation_0_6_1&#45;&gt;expert_linear2_0_6_1</title>
<path fill="none" stroke="black" d="M8158.33,-5098.68C8154.21,-5090.35 8149.57,-5080.96 8145.18,-5072.07"/>
<polygon fill="black" stroke="black" points="8148.3,-5070.48 8140.73,-5063.06 8142.02,-5073.58 8148.3,-5070.48"/>
</g>
<!-- expert_linear2_0_6_1&#45;&gt;aggregate_0 -->
<g id="edge163" class="edge">
<title>expert_linear2_0_6_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M8041.38,-5020.42C8015,-5016.38 7985.88,-5012.41 7959,-5009.81 7268.06,-4943.11 6441.82,-4926.97 6082.18,-4923.06"/>
<polygon fill="black" stroke="black" points="6081.98,-4919.56 6071.94,-4922.95 6081.9,-4926.56 6081.98,-4919.56"/>
</g>
<!-- expert_linear1_0_6_2 -->
<g id="node115" class="node">
<title>expert_linear1_0_6_2</title>
<polygon fill="lightgreen" stroke="black" points="8558,-5240.81 8376,-5240.81 8376,-5187.81 8558,-5187.81 8558,-5240.81"/>
<text text-anchor="middle" x="8467" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 26 Linear 1</text>
<text text-anchor="middle" x="8467" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8467" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_0_6_2&#45;&gt;expert_linear1_0_6_2 -->
<g id="edge115" class="edge">
<title>route_to_expert_0_6_2&#45;&gt;expert_linear1_0_6_2</title>
<path fill="none" stroke="black" d="M8506.9,-5277.36C8500.99,-5268.18 8494.66,-5258.33 8488.82,-5249.24"/>
<polygon fill="black" stroke="black" points="8491.75,-5247.33 8483.4,-5240.81 8485.86,-5251.12 8491.75,-5247.33"/>
</g>
<!-- expert_activation_0_6_2 -->
<g id="node116" class="node">
<title>expert_activation_0_6_2</title>
<polygon fill="lightgreen" stroke="black" points="8526,-5151.81 8344,-5151.81 8344,-5098.81 8526,-5098.81 8526,-5151.81"/>
<text text-anchor="middle" x="8435" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 26 GELU</text>
<text text-anchor="middle" x="8435" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8435" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_0_6_2&#45;&gt;expert_activation_0_6_2 -->
<g id="edge116" class="edge">
<title>expert_linear1_0_6_2&#45;&gt;expert_activation_0_6_2</title>
<path fill="none" stroke="black" d="M8457.57,-5187.68C8454.57,-5179.52 8451.2,-5170.35 8447.99,-5161.63"/>
<polygon fill="black" stroke="black" points="8451.21,-5160.24 8444.47,-5152.06 8444.64,-5162.66 8451.21,-5160.24"/>
</g>
<!-- expert_linear2_0_6_2 -->
<g id="node117" class="node">
<title>expert_linear2_0_6_2</title>
<polygon fill="lightgreen" stroke="black" points="8479.5,-5062.81 8306.5,-5062.81 8306.5,-5009.81 8479.5,-5009.81 8479.5,-5062.81"/>
<text text-anchor="middle" x="8393" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 26 Linear 2</text>
<text text-anchor="middle" x="8393" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8393" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_0_6_2&#45;&gt;expert_linear2_0_6_2 -->
<g id="edge117" class="edge">
<title>expert_activation_0_6_2&#45;&gt;expert_linear2_0_6_2</title>
<path fill="none" stroke="black" d="M8422.63,-5098.68C8418.6,-5090.35 8414.07,-5080.96 8409.78,-5072.07"/>
<polygon fill="black" stroke="black" points="8412.93,-5070.55 8405.43,-5063.06 8406.63,-5073.59 8412.93,-5070.55"/>
</g>
<!-- expert_linear2_0_6_2&#45;&gt;aggregate_0 -->
<g id="edge164" class="edge">
<title>expert_linear2_0_6_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M8306.39,-5020.34C8280.01,-5016.3 8250.88,-5012.34 8224,-5009.81 7427.89,-4934.92 6472.7,-4923.24 6081,-4921.79"/>
<polygon fill="black" stroke="black" points="6081.01,-4918.29 6071,-4921.75 6080.99,-4925.29 6081.01,-4918.29"/>
</g>
<!-- expert_linear1_0_6_3 -->
<g id="node119" class="node">
<title>expert_linear1_0_6_3</title>
<polygon fill="lightgreen" stroke="black" points="8821,-5240.81 8639,-5240.81 8639,-5187.81 8821,-5187.81 8821,-5240.81"/>
<text text-anchor="middle" x="8730" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 27 Linear 1</text>
<text text-anchor="middle" x="8730" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8730" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_0_6_3&#45;&gt;expert_linear1_0_6_3 -->
<g id="edge119" class="edge">
<title>route_to_expert_0_6_3&#45;&gt;expert_linear1_0_6_3</title>
<path fill="none" stroke="black" d="M8769.9,-5277.36C8763.99,-5268.18 8757.66,-5258.33 8751.82,-5249.24"/>
<polygon fill="black" stroke="black" points="8754.75,-5247.33 8746.4,-5240.81 8748.86,-5251.12 8754.75,-5247.33"/>
</g>
<!-- expert_activation_0_6_3 -->
<g id="node120" class="node">
<title>expert_activation_0_6_3</title>
<polygon fill="lightgreen" stroke="black" points="8790,-5151.81 8608,-5151.81 8608,-5098.81 8790,-5098.81 8790,-5151.81"/>
<text text-anchor="middle" x="8699" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 27 GELU</text>
<text text-anchor="middle" x="8699" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8699" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_0_6_3&#45;&gt;expert_activation_0_6_3 -->
<g id="edge120" class="edge">
<title>expert_linear1_0_6_3&#45;&gt;expert_activation_0_6_3</title>
<path fill="none" stroke="black" d="M8720.87,-5187.68C8717.96,-5179.52 8714.69,-5170.35 8711.59,-5161.63"/>
<polygon fill="black" stroke="black" points="8714.83,-5160.31 8708.18,-5152.06 8708.23,-5162.66 8714.83,-5160.31"/>
</g>
<!-- expert_linear2_0_6_3 -->
<g id="node121" class="node">
<title>expert_linear2_0_6_3</title>
<polygon fill="lightgreen" stroke="black" points="8743.5,-5062.81 8570.5,-5062.81 8570.5,-5009.81 8743.5,-5009.81 8743.5,-5062.81"/>
<text text-anchor="middle" x="8657" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 27 Linear 2</text>
<text text-anchor="middle" x="8657" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8657" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_0_6_3&#45;&gt;expert_linear2_0_6_3 -->
<g id="edge121" class="edge">
<title>expert_activation_0_6_3&#45;&gt;expert_linear2_0_6_3</title>
<path fill="none" stroke="black" d="M8686.63,-5098.68C8682.6,-5090.35 8678.07,-5080.96 8673.78,-5072.07"/>
<polygon fill="black" stroke="black" points="8676.93,-5070.55 8669.43,-5063.06 8670.63,-5073.59 8676.93,-5070.55"/>
</g>
<!-- expert_linear2_0_6_3&#45;&gt;aggregate_0 -->
<g id="edge165" class="edge">
<title>expert_linear2_0_6_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M8570.47,-5020.21C8544.37,-5016.18 8515.58,-5012.27 8489,-5009.81 8021.47,-4966.53 6594.25,-4935.31 6083.88,-4925.27"/>
<polygon fill="black" stroke="black" points="6083.91,-4921.77 6073.85,-4925.07 6083.78,-4928.77 6083.91,-4921.77"/>
</g>
<!-- expert_linear1_0_7_0 -->
<g id="node123" class="node">
<title>expert_linear1_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="9084,-5240.81 8902,-5240.81 8902,-5187.81 9084,-5187.81 9084,-5240.81"/>
<text text-anchor="middle" x="8993" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 28 Linear 1</text>
<text text-anchor="middle" x="8993" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8993" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_0_7_0&#45;&gt;expert_linear1_0_7_0 -->
<g id="edge123" class="edge">
<title>route_to_expert_0_7_0&#45;&gt;expert_linear1_0_7_0</title>
<path fill="none" stroke="black" d="M9032.9,-5277.36C9026.99,-5268.18 9020.66,-5258.33 9014.82,-5249.24"/>
<polygon fill="black" stroke="black" points="9017.75,-5247.33 9009.4,-5240.81 9011.86,-5251.12 9017.75,-5247.33"/>
</g>
<!-- expert_activation_0_7_0 -->
<g id="node124" class="node">
<title>expert_activation_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="9053,-5151.81 8871,-5151.81 8871,-5098.81 9053,-5098.81 9053,-5151.81"/>
<text text-anchor="middle" x="8962" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 28 GELU</text>
<text text-anchor="middle" x="8962" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8962" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_0_7_0&#45;&gt;expert_activation_0_7_0 -->
<g id="edge124" class="edge">
<title>expert_linear1_0_7_0&#45;&gt;expert_activation_0_7_0</title>
<path fill="none" stroke="black" d="M8983.87,-5187.68C8980.96,-5179.52 8977.69,-5170.35 8974.59,-5161.63"/>
<polygon fill="black" stroke="black" points="8977.83,-5160.31 8971.18,-5152.06 8971.23,-5162.66 8977.83,-5160.31"/>
</g>
<!-- expert_linear2_0_7_0 -->
<g id="node125" class="node">
<title>expert_linear2_0_7_0</title>
<polygon fill="lightgreen" stroke="black" points="8976.5,-5062.81 8803.5,-5062.81 8803.5,-5009.81 8976.5,-5009.81 8976.5,-5062.81"/>
<text text-anchor="middle" x="8890" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 28 Linear 2</text>
<text text-anchor="middle" x="8890" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8890" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_0_7_0&#45;&gt;expert_linear2_0_7_0 -->
<g id="edge125" class="edge">
<title>expert_activation_0_7_0&#45;&gt;expert_linear2_0_7_0</title>
<path fill="none" stroke="black" d="M8940.79,-5098.68C8933.6,-5090 8925.46,-5080.16 8917.84,-5070.95"/>
<polygon fill="black" stroke="black" points="8920.38,-5068.54 8911.31,-5063.06 8914.99,-5073 8920.38,-5068.54"/>
</g>
<!-- expert_linear2_0_7_0&#45;&gt;aggregate_0 -->
<g id="edge166" class="edge">
<title>expert_linear2_0_7_0&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M8803.33,-5017.11C8786.69,-5014.2 8769.36,-5011.58 8753,-5009.81 8232.38,-4953.67 6626.99,-4930.25 6082.67,-4923.79"/>
<polygon fill="black" stroke="black" points="6082.41,-4920.28 6072.37,-4923.67 6082.33,-4927.28 6082.41,-4920.28"/>
</g>
<!-- expert_linear1_0_7_1 -->
<g id="node127" class="node">
<title>expert_linear1_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="9347,-5240.81 9165,-5240.81 9165,-5187.81 9347,-5187.81 9347,-5240.81"/>
<text text-anchor="middle" x="9256" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 29 Linear 1</text>
<text text-anchor="middle" x="9256" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9256" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_0_7_1&#45;&gt;expert_linear1_0_7_1 -->
<g id="edge127" class="edge">
<title>route_to_expert_0_7_1&#45;&gt;expert_linear1_0_7_1</title>
<path fill="none" stroke="black" d="M9295.9,-5277.36C9289.99,-5268.18 9283.66,-5258.33 9277.82,-5249.24"/>
<polygon fill="black" stroke="black" points="9280.75,-5247.33 9272.4,-5240.81 9274.86,-5251.12 9280.75,-5247.33"/>
</g>
<!-- expert_activation_0_7_1 -->
<g id="node128" class="node">
<title>expert_activation_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="9316,-5151.81 9134,-5151.81 9134,-5098.81 9316,-5098.81 9316,-5151.81"/>
<text text-anchor="middle" x="9225" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 29 GELU</text>
<text text-anchor="middle" x="9225" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9225" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_0_7_1&#45;&gt;expert_activation_0_7_1 -->
<g id="edge128" class="edge">
<title>expert_linear1_0_7_1&#45;&gt;expert_activation_0_7_1</title>
<path fill="none" stroke="black" d="M9246.87,-5187.68C9243.96,-5179.52 9240.69,-5170.35 9237.59,-5161.63"/>
<polygon fill="black" stroke="black" points="9240.83,-5160.31 9234.18,-5152.06 9234.23,-5162.66 9240.83,-5160.31"/>
</g>
<!-- expert_linear2_0_7_1 -->
<g id="node129" class="node">
<title>expert_linear2_0_7_1</title>
<polygon fill="lightgreen" stroke="black" points="9239.5,-5062.81 9066.5,-5062.81 9066.5,-5009.81 9239.5,-5009.81 9239.5,-5062.81"/>
<text text-anchor="middle" x="9153" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 29 Linear 2</text>
<text text-anchor="middle" x="9153" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9153" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_0_7_1&#45;&gt;expert_linear2_0_7_1 -->
<g id="edge129" class="edge">
<title>expert_activation_0_7_1&#45;&gt;expert_linear2_0_7_1</title>
<path fill="none" stroke="black" d="M9203.79,-5098.68C9196.6,-5090 9188.46,-5080.16 9180.84,-5070.95"/>
<polygon fill="black" stroke="black" points="9183.38,-5068.54 9174.31,-5063.06 9177.99,-5073 9183.38,-5068.54"/>
</g>
<!-- expert_linear2_0_7_1&#45;&gt;aggregate_0 -->
<g id="edge167" class="edge">
<title>expert_linear2_0_7_1&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M9066.14,-5019.98C9040.42,-5016 9012.14,-5012.17 8986,-5009.81 8417.17,-4958.47 6656.69,-4931.62 6082.87,-4924.07"/>
<polygon fill="black" stroke="black" points="6082.89,-4920.57 6072.85,-4923.94 6082.8,-4927.57 6082.89,-4920.57"/>
</g>
<!-- expert_linear1_0_7_2 -->
<g id="node131" class="node">
<title>expert_linear1_0_7_2</title>
<polygon fill="lightgreen" stroke="black" points="9610,-5240.81 9428,-5240.81 9428,-5187.81 9610,-5187.81 9610,-5240.81"/>
<text text-anchor="middle" x="9519" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 30 Linear 1</text>
<text text-anchor="middle" x="9519" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9519" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_0_7_2&#45;&gt;expert_linear1_0_7_2 -->
<g id="edge131" class="edge">
<title>route_to_expert_0_7_2&#45;&gt;expert_linear1_0_7_2</title>
<path fill="none" stroke="black" d="M9558.9,-5277.36C9552.99,-5268.18 9546.66,-5258.33 9540.82,-5249.24"/>
<polygon fill="black" stroke="black" points="9543.75,-5247.33 9535.4,-5240.81 9537.86,-5251.12 9543.75,-5247.33"/>
</g>
<!-- expert_activation_0_7_2 -->
<g id="node132" class="node">
<title>expert_activation_0_7_2</title>
<polygon fill="lightgreen" stroke="black" points="9579,-5151.81 9397,-5151.81 9397,-5098.81 9579,-5098.81 9579,-5151.81"/>
<text text-anchor="middle" x="9488" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 30 GELU</text>
<text text-anchor="middle" x="9488" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9488" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_0_7_2&#45;&gt;expert_activation_0_7_2 -->
<g id="edge132" class="edge">
<title>expert_linear1_0_7_2&#45;&gt;expert_activation_0_7_2</title>
<path fill="none" stroke="black" d="M9509.87,-5187.68C9506.96,-5179.52 9503.69,-5170.35 9500.59,-5161.63"/>
<polygon fill="black" stroke="black" points="9503.83,-5160.31 9497.18,-5152.06 9497.23,-5162.66 9503.83,-5160.31"/>
</g>
<!-- expert_linear2_0_7_2 -->
<g id="node133" class="node">
<title>expert_linear2_0_7_2</title>
<polygon fill="lightgreen" stroke="black" points="9502.5,-5062.81 9329.5,-5062.81 9329.5,-5009.81 9502.5,-5009.81 9502.5,-5062.81"/>
<text text-anchor="middle" x="9416" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 30 Linear 2</text>
<text text-anchor="middle" x="9416" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9416" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_0_7_2&#45;&gt;expert_linear2_0_7_2 -->
<g id="edge133" class="edge">
<title>expert_activation_0_7_2&#45;&gt;expert_linear2_0_7_2</title>
<path fill="none" stroke="black" d="M9466.79,-5098.68C9459.6,-5090 9451.46,-5080.16 9443.84,-5070.95"/>
<polygon fill="black" stroke="black" points="9446.38,-5068.54 9437.31,-5063.06 9440.99,-5073 9446.38,-5068.54"/>
</g>
<!-- expert_linear2_0_7_2&#45;&gt;aggregate_0 -->
<g id="edge168" class="edge">
<title>expert_linear2_0_7_2&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M9329.14,-5019.94C9303.42,-5015.96 9275.15,-5012.14 9249,-5009.81 8626.3,-4954.31 6687.82,-4929.97 6082.49,-4923.59"/>
<polygon fill="black" stroke="black" points="6082.4,-4920.09 6072.36,-4923.49 6082.33,-4927.09 6082.4,-4920.09"/>
</g>
<!-- expert_linear1_0_7_3 -->
<g id="node135" class="node">
<title>expert_linear1_0_7_3</title>
<polygon fill="lightgreen" stroke="black" points="9905,-5240.81 9723,-5240.81 9723,-5187.81 9905,-5187.81 9905,-5240.81"/>
<text text-anchor="middle" x="9814" y="-5225.61" font-family="Times,serif" font-size="14.00">Expert 31 Linear 1</text>
<text text-anchor="middle" x="9814" y="-5210.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9814" y="-5195.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_0_7_3&#45;&gt;expert_linear1_0_7_3 -->
<g id="edge135" class="edge">
<title>route_to_expert_0_7_3&#45;&gt;expert_linear1_0_7_3</title>
<path fill="none" stroke="black" d="M9833.46,-5276.81C9830.73,-5268.2 9827.84,-5259.05 9825.13,-5250.5"/>
<polygon fill="black" stroke="black" points="9828.43,-5249.3 9822.07,-5240.82 9821.75,-5251.41 9828.43,-5249.3"/>
</g>
<!-- expert_activation_0_7_3 -->
<g id="node136" class="node">
<title>expert_activation_0_7_3</title>
<polygon fill="lightgreen" stroke="black" points="9889,-5151.81 9707,-5151.81 9707,-5098.81 9889,-5098.81 9889,-5151.81"/>
<text text-anchor="middle" x="9798" y="-5136.61" font-family="Times,serif" font-size="14.00">Expert 31 GELU</text>
<text text-anchor="middle" x="9798" y="-5121.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="9798" y="-5106.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_0_7_3&#45;&gt;expert_activation_0_7_3 -->
<g id="edge136" class="edge">
<title>expert_linear1_0_7_3&#45;&gt;expert_activation_0_7_3</title>
<path fill="none" stroke="black" d="M9809.29,-5187.68C9807.8,-5179.61 9806.14,-5170.55 9804.55,-5161.92"/>
<polygon fill="black" stroke="black" points="9807.99,-5161.26 9802.74,-5152.06 9801.1,-5162.53 9807.99,-5161.26"/>
</g>
<!-- expert_linear2_0_7_3 -->
<g id="node137" class="node">
<title>expert_linear2_0_7_3</title>
<polygon fill="lightgreen" stroke="black" points="9804.5,-5062.81 9631.5,-5062.81 9631.5,-5009.81 9804.5,-5009.81 9804.5,-5062.81"/>
<text text-anchor="middle" x="9718" y="-5047.61" font-family="Times,serif" font-size="14.00">Expert 31 Linear 2</text>
<text text-anchor="middle" x="9718" y="-5032.61" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="9718" y="-5017.61" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_0_7_3&#45;&gt;expert_linear2_0_7_3 -->
<g id="edge137" class="edge">
<title>expert_activation_0_7_3&#45;&gt;expert_linear2_0_7_3</title>
<path fill="none" stroke="black" d="M9774.43,-5098.68C9766.36,-5089.91 9757.22,-5079.96 9748.68,-5070.67"/>
<polygon fill="black" stroke="black" points="9751.02,-5068.05 9741.68,-5063.06 9745.87,-5072.79 9751.02,-5068.05"/>
</g>
<!-- expert_linear2_0_7_3&#45;&gt;aggregate_0 -->
<g id="edge169" class="edge">
<title>expert_linear2_0_7_3&#45;&gt;aggregate_0</title>
<path fill="none" stroke="black" d="M9631.49,-5022.68C9594.73,-5017.81 9551.35,-5012.72 9512,-5009.81 8834.67,-4959.76 6718.71,-4931.42 6082.64,-4923.87"/>
<polygon fill="black" stroke="black" points="6082.51,-4920.37 6072.47,-4923.75 6082.42,-4927.37 6082.51,-4920.37"/>
</g>
<!-- aggregate_0&#45;&gt;moe_residual_0 -->
<g id="edge171" class="edge">
<title>aggregate_0&#45;&gt;moe_residual_0</title>
<path fill="none" stroke="black" d="M6057.09,-4904.96C6344.71,-4877.77 6952.1,-4820.36 7232.9,-4793.81"/>
<polygon fill="black" stroke="black" points="7233.53,-4797.27 7243.16,-4792.84 7232.87,-4790.3 7233.53,-4797.27"/>
</g>
<!-- ln2_0 -->
<g id="node140" class="node">
<title>ln2_0</title>
<polygon fill="lightgreen" stroke="black" points="7470.5,-4689.81 7291.5,-4689.81 7291.5,-4636.81 7470.5,-4636.81 7470.5,-4689.81"/>
<text text-anchor="middle" x="7381" y="-4674.61" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="7381" y="-4659.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7381" y="-4644.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- moe_residual_0&#45;&gt;ln2_0 -->
<g id="edge172" class="edge">
<title>moe_residual_0&#45;&gt;ln2_0</title>
<path fill="none" stroke="black" d="M7381,-4725.71C7381,-4717.04 7381,-4708.23 7381,-4700.08"/>
<polygon fill="black" stroke="black" points="7384.5,-4699.83 7381,-4689.83 7377.5,-4699.83 7384.5,-4699.83"/>
</g>
<!-- mha_qkv_1 -->
<g id="node141" class="node">
<title>mha_qkv_1</title>
<polygon fill="lightgreen" stroke="black" points="7414,-4589.81 7220,-4589.81 7220,-4536.81 7414,-4536.81 7414,-4589.81"/>
<text text-anchor="middle" x="7317" y="-4574.61" font-family="Times,serif" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="middle" x="7317" y="-4559.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7317" y="-4544.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln2_0&#45;&gt;mha_qkv_1 -->
<g id="edge173" class="edge">
<title>ln2_0&#45;&gt;mha_qkv_1</title>
<path fill="none" stroke="black" d="M7364.18,-4636.56C7356.54,-4624.86 7347.39,-4610.85 7339.2,-4598.3"/>
<polygon fill="black" stroke="black" points="7342.1,-4596.35 7333.7,-4589.89 7336.24,-4600.18 7342.1,-4596.35"/>
</g>
<!-- mha_residual_1 -->
<g id="node144" class="node">
<title>mha_residual_1</title>
<polygon fill="lightyellow" stroke="black" points="7563.66,-4322.81 7268.32,-4322.81 7192.34,-4216.81 7487.68,-4216.81 7563.66,-4322.81"/>
<text text-anchor="middle" x="7378" y="-4281.11" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="7378" y="-4266.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7378" y="-4251.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln2_0&#45;&gt;mha_residual_1 -->
<g id="edge177" class="edge">
<title>ln2_0&#45;&gt;mha_residual_1</title>
<path fill="none" stroke="black" d="M7412.92,-4636.53C7417,-4631.76 7420.59,-4626.47 7423,-4620.81 7468.66,-4513.68 7454.77,-4471.65 7426,-4358.81 7423.73,-4349.9 7420.34,-4340.91 7416.41,-4332.26"/>
<polygon fill="black" stroke="black" points="7419.45,-4330.51 7411.95,-4323.03 7413.15,-4333.56 7419.45,-4330.51"/>
</g>
<!-- mha_attn_1 -->
<g id="node142" class="node">
<title>mha_attn_1</title>
<polygon fill="lightgreen" stroke="black" points="7402.5,-4500.81 7223.5,-4500.81 7223.5,-4447.81 7402.5,-4447.81 7402.5,-4500.81"/>
<text text-anchor="middle" x="7313" y="-4485.61" font-family="Times,serif" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="middle" x="7313" y="-4470.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7313" y="-4455.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_qkv_1&#45;&gt;mha_attn_1 -->
<g id="edge174" class="edge">
<title>mha_qkv_1&#45;&gt;mha_attn_1</title>
<path fill="none" stroke="black" d="M7315.82,-4536.68C7315.45,-4528.7 7315.04,-4519.75 7314.65,-4511.2"/>
<polygon fill="black" stroke="black" points="7318.14,-4510.89 7314.18,-4501.06 7311.15,-4511.21 7318.14,-4510.89"/>
</g>
<!-- mha_out_1 -->
<g id="node143" class="node">
<title>mha_out_1</title>
<polygon fill="lightgreen" stroke="black" points="7417,-4411.81 7205,-4411.81 7205,-4358.81 7417,-4358.81 7417,-4411.81"/>
<text text-anchor="middle" x="7311" y="-4396.61" font-family="Times,serif" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="middle" x="7311" y="-4381.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7311" y="-4366.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_attn_1&#45;&gt;mha_out_1 -->
<g id="edge175" class="edge">
<title>mha_attn_1&#45;&gt;mha_out_1</title>
<path fill="none" stroke="black" d="M7312.41,-4447.68C7312.23,-4439.7 7312.02,-4430.75 7311.82,-4422.2"/>
<polygon fill="black" stroke="black" points="7315.32,-4421.98 7311.59,-4412.06 7308.32,-4422.14 7315.32,-4421.98"/>
</g>
<!-- mha_out_1&#45;&gt;mha_residual_1 -->
<g id="edge176" class="edge">
<title>mha_out_1&#45;&gt;mha_residual_1</title>
<path fill="none" stroke="black" d="M7326.2,-4358.56C7330.99,-4350.45 7336.5,-4341.11 7342.1,-4331.63"/>
<polygon fill="black" stroke="black" points="7345.18,-4333.3 7347.25,-4322.91 7339.15,-4329.74 7345.18,-4333.3"/>
</g>
<!-- ln1_1 -->
<g id="node145" class="node">
<title>ln1_1</title>
<polygon fill="lightgreen" stroke="black" points="7467.5,-4180.81 7288.5,-4180.81 7288.5,-4127.81 7467.5,-4127.81 7467.5,-4180.81"/>
<text text-anchor="middle" x="7378" y="-4165.61" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="7378" y="-4150.61" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="7378" y="-4135.61" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- mha_residual_1&#45;&gt;ln1_1 -->
<g id="edge178" class="edge">
<title>mha_residual_1&#45;&gt;ln1_1</title>
<path fill="none" stroke="black" d="M7378,-4216.71C7378,-4208.04 7378,-4199.23 7378,-4191.08"/>
<polygon fill="black" stroke="black" points="7381.5,-4190.83 7378,-4180.83 7374.5,-4190.83 7381.5,-4190.83"/>
</g>
<!-- gate_1 -->
<g id="node146" class="node">
<title>gate_1</title>
<polygon fill="lightyellow" stroke="black" points="5124.83,-4091.81 4859.44,-4091.81 4791.17,-3985.81 5056.56,-3985.81 5124.83,-4091.81"/>
<text text-anchor="middle" x="4958" y="-4050.11" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="4958" y="-4035.11" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="4958" y="-4020.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln1_1&#45;&gt;gate_1 -->
<g id="edge179" class="edge">
<title>ln1_1&#45;&gt;gate_1</title>
<path fill="none" stroke="black" d="M7288.28,-4149.11C6924.83,-4132.06 5559.84,-4068.04 5105.86,-4046.75"/>
<polygon fill="black" stroke="black" points="5105.79,-4043.24 5095.64,-4046.27 5105.46,-4050.23 5105.79,-4043.24"/>
</g>
<!-- moe_residual_1 -->
<g id="node276" class="node">
<title>moe_residual_1</title>
<polygon fill="lightyellow" stroke="black" points="6890.66,-3429.86 6595.32,-3429.86 6519.34,-3323.86 6814.68,-3323.86 6890.66,-3429.86"/>
<text text-anchor="middle" x="6705" y="-3388.16" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="6705" y="-3373.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6705" y="-3358.16" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ln1_1&#45;&gt;moe_residual_1 -->
<g id="edge340" class="edge">
<title>ln1_1&#45;&gt;moe_residual_1</title>
<path fill="none" stroke="black" d="M7467.61,-4148.09C7795.12,-4128.2 8914.43,-4053.16 9034,-3949.81 9046.72,-3938.82 9044,-3930.15 9044,-3913.34 9044,-3913.34 9044,-3913.34 9044,-3633.36 9044,-3413.59 7391.19,-3382.76 6864.32,-3378.51"/>
<polygon fill="black" stroke="black" points="6864.01,-3375.01 6853.98,-3378.43 6863.95,-3382.01 6864.01,-3375.01"/>
</g>
<!-- route_to_expert_1_0_0 -->
<g id="node147" class="node">
<title>route_to_expert_1_0_0</title>
<ellipse fill="lightblue" stroke="black" cx="750" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="750" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="750" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="750" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_0_0 -->
<g id="edge180" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_0_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.9,-4036.89C4164.13,-4032.1 1278.55,-4007.96 882,-3949.81 869.35,-3947.96 856.18,-3945.27 843.28,-3942.19"/>
<polygon fill="black" stroke="black" points="844.03,-3938.77 833.48,-3939.76 842.34,-3945.56 844.03,-3938.77"/>
</g>
<!-- route_to_expert_1_0_1 -->
<g id="node151" class="node">
<title>route_to_expert_1_0_1</title>
<ellipse fill="lightblue" stroke="black" cx="1013" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1013" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="1013" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1013" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_0_1 -->
<g id="edge184" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_0_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.73,-4036.68C4190.07,-4031.05 1514.2,-4004.23 1145,-3949.81 1132.35,-3947.95 1119.19,-3945.26 1106.28,-3942.17"/>
<polygon fill="black" stroke="black" points="1107.03,-3938.75 1096.48,-3939.74 1105.35,-3945.54 1107.03,-3938.75"/>
</g>
<!-- route_to_expert_1_0_2 -->
<g id="node155" class="node">
<title>route_to_expert_1_0_2</title>
<ellipse fill="lightblue" stroke="black" cx="1276" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1276" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="1276" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1276" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_0_2 -->
<g id="edge188" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_0_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.76,-4036.43C4217.53,-4029.92 1749.94,-4000.51 1408,-3949.81 1395.44,-3947.95 1382.38,-3945.28 1369.57,-3942.22"/>
<polygon fill="black" stroke="black" points="1370.39,-3938.81 1359.84,-3939.81 1368.71,-3945.61 1370.39,-3938.81"/>
</g>
<!-- route_to_expert_1_0_3 -->
<g id="node159" class="node">
<title>route_to_expert_1_0_3</title>
<ellipse fill="lightblue" stroke="black" cx="1539" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1539" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="1539" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1539" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_0_3 -->
<g id="edge192" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_0_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.43,-4036.14C4245.07,-4028.68 1985.68,-3996.79 1671,-3949.81 1658.45,-3947.94 1645.39,-3945.26 1632.58,-3942.19"/>
<polygon fill="black" stroke="black" points="1633.39,-3938.79 1622.85,-3939.78 1631.71,-3945.58 1633.39,-3938.79"/>
</g>
<!-- route_to_expert_1_1_0 -->
<g id="node163" class="node">
<title>route_to_expert_1_1_0</title>
<ellipse fill="lightblue" stroke="black" cx="1802" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1802" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1802" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1802" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_1_0 -->
<g id="edge196" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_1_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4824.57,-4038.19C4316.6,-4038.96 2503.53,-4035.51 1934,-3949.81 1921.45,-3947.92 1908.39,-3945.24 1895.58,-3942.17"/>
<polygon fill="black" stroke="black" points="1896.4,-3938.76 1885.85,-3939.75 1894.71,-3945.56 1896.4,-3938.76"/>
</g>
<!-- route_to_expert_1_1_1 -->
<g id="node167" class="node">
<title>route_to_expert_1_1_1</title>
<ellipse fill="lightblue" stroke="black" cx="2065" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2065" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="2065" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2065" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_1_1 -->
<g id="edge200" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_1_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4824.43,-4037.76C4345.08,-4036.89 2712.63,-4028.13 2197,-3949.81 2184.45,-3947.91 2171.39,-3945.21 2158.59,-3942.13"/>
<polygon fill="black" stroke="black" points="2159.4,-3938.73 2148.86,-3939.71 2157.72,-3945.52 2159.4,-3938.73"/>
</g>
<!-- route_to_expert_1_1_2 -->
<g id="node171" class="node">
<title>route_to_expert_1_1_2</title>
<ellipse fill="lightblue" stroke="black" cx="2328" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2328" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="2328" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2328" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_1_2 -->
<g id="edge204" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_1_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4824.14,-4037.23C4374.68,-4034.62 2921.89,-4020.76 2460,-3949.81 2447.45,-3947.89 2434.4,-3945.18 2421.59,-3942.09"/>
<polygon fill="black" stroke="black" points="2422.41,-3938.69 2411.86,-3939.67 2420.72,-3945.48 2422.41,-3938.69"/>
</g>
<!-- route_to_expert_1_1_3 -->
<g id="node175" class="node">
<title>route_to_expert_1_1_3</title>
<ellipse fill="lightblue" stroke="black" cx="2591" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2591" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="2591" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2591" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_1_3 -->
<g id="edge208" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_1_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.5,-4036.57C4405.27,-4032.08 3131.28,-4013.39 2723,-3949.81 2710.67,-3947.89 2697.85,-3945.23 2685.26,-3942.2"/>
<polygon fill="black" stroke="black" points="2685.77,-3938.73 2675.23,-3939.71 2684.09,-3945.52 2685.77,-3938.73"/>
</g>
<!-- route_to_expert_1_2_0 -->
<g id="node179" class="node">
<title>route_to_expert_1_2_0</title>
<ellipse fill="lightblue" stroke="black" cx="2854" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2854" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2854" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2854" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_2_0 -->
<g id="edge212" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_2_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.26,-4035.75C4438.75,-4029.22 3341.09,-4006.06 2986,-3949.81 2973.68,-3947.86 2960.86,-3945.18 2948.27,-3942.14"/>
<polygon fill="black" stroke="black" points="2948.79,-3938.66 2938.24,-3939.64 2947.09,-3945.46 2948.79,-3938.66"/>
</g>
<!-- route_to_expert_1_2_1 -->
<g id="node183" class="node">
<title>route_to_expert_1_2_1</title>
<ellipse fill="lightblue" stroke="black" cx="3117" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3117" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="3117" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3117" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_2_1 -->
<g id="edge216" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_2_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4822.46,-4034.65C4473.61,-4025.9 3551.07,-3998.73 3249,-3949.81 3236.68,-3947.82 3223.87,-3945.11 3211.28,-3942.06"/>
<polygon fill="black" stroke="black" points="3211.8,-3938.58 3201.25,-3939.55 3210.1,-3945.38 3211.8,-3938.58"/>
</g>
<!-- route_to_expert_1_2_2 -->
<g id="node187" class="node">
<title>route_to_expert_1_2_2</title>
<ellipse fill="lightblue" stroke="black" cx="3380" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3380" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="3380" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3380" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_2_2 -->
<g id="edge220" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_2_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4821.55,-4033.15C4511.48,-4021.96 3761.48,-3991.41 3512,-3949.81 3499.79,-3947.78 3487.08,-3945.06 3474.59,-3942.02"/>
<polygon fill="black" stroke="black" points="3475.18,-3938.56 3464.62,-3939.53 3473.47,-3945.35 3475.18,-3938.56"/>
</g>
<!-- route_to_expert_1_2_3 -->
<g id="node191" class="node">
<title>route_to_expert_1_2_3</title>
<ellipse fill="lightblue" stroke="black" cx="3643" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3643" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3643" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3643" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_2_3 -->
<g id="edge224" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_2_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4823.45,-4036.33C4602.85,-4032 4151.15,-4015.13 3775,-3949.81 3762.89,-3947.71 3750.29,-3944.97 3737.9,-3941.94"/>
<polygon fill="black" stroke="black" points="3738.56,-3938.49 3728.01,-3939.45 3736.85,-3945.28 3738.56,-3938.49"/>
</g>
<!-- route_to_expert_1_3_0 -->
<g id="node195" class="node">
<title>route_to_expert_1_3_0</title>
<ellipse fill="lightblue" stroke="black" cx="3906" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3906" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3906" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3906" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_3_0 -->
<g id="edge228" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_3_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4820.97,-4032.16C4640.31,-4023.02 4313.14,-4000.59 4038,-3949.81 4026.01,-3947.6 4013.52,-3944.81 4001.22,-3941.76"/>
<polygon fill="black" stroke="black" points="4001.97,-3938.34 3991.41,-3939.27 4000.24,-3945.12 4001.97,-3938.34"/>
</g>
<!-- route_to_expert_1_3_1 -->
<g id="node199" class="node">
<title>route_to_expert_1_3_1</title>
<ellipse fill="lightblue" stroke="black" cx="4169" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4169" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="4169" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4169" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_3_1 -->
<g id="edge232" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_3_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4815.77,-4024.42C4682.06,-4010.51 4476.76,-3985.69 4301,-3949.81 4289.35,-3947.44 4277.22,-3944.6 4265.23,-3941.56"/>
<polygon fill="black" stroke="black" points="4265.77,-3938.09 4255.22,-3938.98 4264.02,-3944.87 4265.77,-3938.09"/>
</g>
<!-- route_to_expert_1_3_2 -->
<g id="node203" class="node">
<title>route_to_expert_1_3_2</title>
<ellipse fill="lightblue" stroke="black" cx="4432" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4432" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="4432" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4432" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_3_2 -->
<g id="edge236" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_3_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4803.21,-4005.11C4730.41,-3989.25 4642.54,-3969.42 4564,-3949.81 4553.03,-3947.07 4541.58,-3944.09 4530.2,-3941.06"/>
<polygon fill="black" stroke="black" points="4530.8,-3937.59 4520.24,-3938.38 4528.99,-3944.35 4530.8,-3937.59"/>
</g>
<!-- route_to_expert_1_3_3 -->
<g id="node207" class="node">
<title>route_to_expert_1_3_3</title>
<ellipse fill="lightblue" stroke="black" cx="4695" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4695" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4695" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4695" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_3_3 -->
<g id="edge240" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_3_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4847.99,-3985.75C4821.53,-3973.22 4793.87,-3960.13 4769.47,-3948.58"/>
<polygon fill="black" stroke="black" points="4770.82,-3945.35 4760.29,-3944.24 4767.83,-3951.68 4770.82,-3945.35"/>
</g>
<!-- route_to_expert_1_4_0 -->
<g id="node211" class="node">
<title>route_to_expert_1_4_0</title>
<ellipse fill="lightblue" stroke="black" cx="4958" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4958" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 16</text>
<text text-anchor="middle" x="4958" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4958" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_4_0 -->
<g id="edge244" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_4_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4958,-3985.75C4958,-3977.31 4958,-3968.63 4958,-3960.32"/>
<polygon fill="black" stroke="black" points="4961.5,-3960.06 4958,-3950.06 4954.5,-3960.06 4961.5,-3960.06"/>
</g>
<!-- route_to_expert_1_4_1 -->
<g id="node215" class="node">
<title>route_to_expert_1_4_1</title>
<ellipse fill="lightblue" stroke="black" cx="5221" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5221" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 17</text>
<text text-anchor="middle" x="5221" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5221" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_4_1 -->
<g id="edge248" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_4_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5059.31,-3989.87C5088.43,-3976.08 5119.64,-3961.31 5146.8,-3948.46"/>
<polygon fill="black" stroke="black" points="5148.3,-3951.62 5155.84,-3944.18 5145.3,-3945.29 5148.3,-3951.62"/>
</g>
<!-- route_to_expert_1_4_2 -->
<g id="node219" class="node">
<title>route_to_expert_1_4_2</title>
<ellipse fill="lightblue" stroke="black" cx="5484" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5484" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 18</text>
<text text-anchor="middle" x="5484" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5484" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_4_2 -->
<g id="edge252" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_4_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5074.73,-4013.34C5153.33,-3996.47 5259.18,-3972.99 5352,-3949.81 5362.97,-3947.07 5374.42,-3944.09 5385.8,-3941.06"/>
<polygon fill="black" stroke="black" points="5387.01,-3944.35 5395.76,-3938.38 5385.2,-3937.59 5387.01,-3944.35"/>
</g>
<!-- route_to_expert_1_4_3 -->
<g id="node223" class="node">
<title>route_to_expert_1_4_3</title>
<ellipse fill="lightblue" stroke="black" cx="5747" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5747" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 19</text>
<text text-anchor="middle" x="5747" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5747" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_4_3 -->
<g id="edge256" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_4_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5082.66,-4026.23C5215.44,-4012.71 5431.35,-3987.3 5615,-3949.81 5626.65,-3947.44 5638.78,-3944.6 5650.77,-3941.56"/>
<polygon fill="black" stroke="black" points="5651.98,-3944.87 5660.78,-3938.98 5650.23,-3938.09 5651.98,-3944.87"/>
</g>
<!-- route_to_expert_1_5_0 -->
<g id="node227" class="node">
<title>route_to_expert_1_5_0</title>
<ellipse fill="lightblue" stroke="black" cx="6010" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6010" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 20</text>
<text text-anchor="middle" x="6010" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6010" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_5_0 -->
<g id="edge260" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_5_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5086.97,-4032.57C5265.83,-4023.69 5598.72,-4001.35 5878,-3949.81 5889.99,-3947.6 5902.48,-3944.81 5914.78,-3941.76"/>
<polygon fill="black" stroke="black" points="5915.76,-3945.12 5924.59,-3939.27 5914.03,-3938.34 5915.76,-3945.12"/>
</g>
<!-- route_to_expert_1_5_1 -->
<g id="node231" class="node">
<title>route_to_expert_1_5_1</title>
<ellipse fill="lightblue" stroke="black" cx="6273" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6273" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 21</text>
<text text-anchor="middle" x="6273" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6273" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_5_1 -->
<g id="edge264" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_5_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.44,-4036.39C5308.88,-4032.15 5763.07,-4015.44 6141,-3949.81 6153.11,-3947.71 6165.71,-3944.97 6178.1,-3941.94"/>
<polygon fill="black" stroke="black" points="6179.15,-3945.28 6187.99,-3939.45 6177.44,-3938.49 6179.15,-3945.28"/>
</g>
<!-- route_to_expert_1_5_2 -->
<g id="node235" class="node">
<title>route_to_expert_1_5_2</title>
<ellipse fill="lightblue" stroke="black" cx="6536" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6536" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 22</text>
<text text-anchor="middle" x="6536" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6536" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_5_2 -->
<g id="edge268" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_5_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5087.3,-4033.41C5392.84,-4022.44 6152.58,-3991.73 6404,-3949.81 6416.21,-3947.78 6428.92,-3945.06 6441.41,-3942.02"/>
<polygon fill="black" stroke="black" points="6442.53,-3945.35 6451.38,-3939.53 6440.82,-3938.56 6442.53,-3945.35"/>
</g>
<!-- route_to_expert_1_5_3 -->
<g id="node239" class="node">
<title>route_to_expert_1_5_3</title>
<ellipse fill="lightblue" stroke="black" cx="6799" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6799" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 23</text>
<text text-anchor="middle" x="6799" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6799" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_5_3 -->
<g id="edge272" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_5_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.19,-4034.79C5432.85,-4026.18 6363.37,-3998.98 6667,-3949.81 6679.32,-3947.82 6692.13,-3945.11 6704.72,-3942.06"/>
<polygon fill="black" stroke="black" points="6705.9,-3945.38 6714.75,-3939.55 6704.2,-3938.58 6705.9,-3945.38"/>
</g>
<!-- route_to_expert_1_6_0 -->
<g id="node243" class="node">
<title>route_to_expert_1_6_0</title>
<ellipse fill="lightblue" stroke="black" cx="7062" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7062" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 24</text>
<text text-anchor="middle" x="7062" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7062" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_6_0 -->
<g id="edge276" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_6_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5088.98,-4035.81C5470.05,-4029.37 6573.75,-4006.25 6930,-3949.81 6942.32,-3947.86 6955.14,-3945.18 6967.73,-3942.14"/>
<polygon fill="black" stroke="black" points="6968.91,-3945.46 6977.76,-3939.64 6967.21,-3938.66 6968.91,-3945.46"/>
</g>
<!-- route_to_expert_1_6_1 -->
<g id="node247" class="node">
<title>route_to_expert_1_6_1</title>
<ellipse fill="lightblue" stroke="black" cx="7325" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7325" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 25</text>
<text text-anchor="middle" x="7325" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7325" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_6_1 -->
<g id="edge280" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_6_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.57,-4036.6C5504.74,-4032.17 6783.76,-4013.54 7193,-3949.81 7205.33,-3947.89 7218.15,-3945.23 7230.74,-3942.2"/>
<polygon fill="black" stroke="black" points="7231.91,-3945.52 7240.77,-3939.71 7230.23,-3938.73 7231.91,-3945.52"/>
</g>
<!-- route_to_expert_1_6_2 -->
<g id="node251" class="node">
<title>route_to_expert_1_6_2</title>
<ellipse fill="lightblue" stroke="black" cx="7588" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7588" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 26</text>
<text text-anchor="middle" x="7588" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7588" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_6_2 -->
<g id="edge284" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_6_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.91,-4037.24C5537.1,-4034.66 6993.44,-4020.86 7456,-3949.81 7468.55,-3947.89 7481.6,-3945.18 7494.41,-3942.09"/>
<polygon fill="black" stroke="black" points="7495.28,-3945.48 7504.14,-3939.67 7493.59,-3938.69 7495.28,-3945.48"/>
</g>
<!-- route_to_expert_1_6_3 -->
<g id="node255" class="node">
<title>route_to_expert_1_6_3</title>
<ellipse fill="lightblue" stroke="black" cx="7851" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7851" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 27</text>
<text text-anchor="middle" x="7851" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7851" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_6_3 -->
<g id="edge288" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_6_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5090.33,-4037.76C5568.1,-4036.91 7202.92,-4028.2 7719,-3949.81 7731.55,-3947.91 7744.61,-3945.21 7757.41,-3942.13"/>
<polygon fill="black" stroke="black" points="7758.28,-3945.52 7767.14,-3939.71 7756.6,-3938.73 7758.28,-3945.52"/>
</g>
<!-- route_to_expert_1_7_0 -->
<g id="node259" class="node">
<title>route_to_expert_1_7_0</title>
<ellipse fill="lightblue" stroke="black" cx="8114" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8114" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 28</text>
<text text-anchor="middle" x="8114" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8114" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_7_0 -->
<g id="edge292" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_7_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5090.56,-4038.19C5597.33,-4038.96 7412.15,-4035.56 7982,-3949.81 7994.55,-3947.92 8007.61,-3945.24 8020.42,-3942.17"/>
<polygon fill="black" stroke="black" points="8021.29,-3945.56 8030.15,-3939.75 8019.6,-3938.76 8021.29,-3945.56"/>
</g>
<!-- route_to_expert_1_7_1 -->
<g id="node263" class="node">
<title>route_to_expert_1_7_1</title>
<ellipse fill="lightblue" stroke="black" cx="8377" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8377" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 29</text>
<text text-anchor="middle" x="8377" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8377" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_7_1 -->
<g id="edge296" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_7_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.19,-4036.18C5662.05,-4028.81 7929.7,-3996.88 8245,-3949.81 8257.55,-3947.94 8270.61,-3945.26 8283.42,-3942.19"/>
<polygon fill="black" stroke="black" points="8284.29,-3945.58 8293.15,-3939.78 8282.61,-3938.79 8284.29,-3945.58"/>
</g>
<!-- route_to_expert_1_7_2 -->
<g id="node267" class="node">
<title>route_to_expert_1_7_2</title>
<ellipse fill="lightblue" stroke="black" cx="8640" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8640" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 30</text>
<text text-anchor="middle" x="8640" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8640" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_7_2 -->
<g id="edge300" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_7_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.22,-4036.46C5690.21,-4030.02 8165.49,-4000.6 8508,-3949.81 8520.56,-3947.95 8533.62,-3945.28 8546.43,-3942.22"/>
<polygon fill="black" stroke="black" points="8547.29,-3945.61 8556.16,-3939.81 8545.61,-3938.81 8547.29,-3945.61"/>
</g>
<!-- route_to_expert_1_7_3 -->
<g id="node271" class="node">
<title>route_to_expert_1_7_3</title>
<ellipse fill="lightblue" stroke="black" cx="8903" cy="-3912.34" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8903" y="-3923.64" font-family="Times,serif" font-size="14.00">Route to Expert 31</text>
<text text-anchor="middle" x="8903" y="-3908.64" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8903" y="-3893.64" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- gate_1&#45;&gt;route_to_expert_1_7_3 -->
<g id="edge304" class="edge">
<title>gate_1&#45;&gt;route_to_expert_1_7_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M5089.39,-4036.7C5717.76,-4031.13 8401.24,-4004.31 8771,-3949.81 8783.65,-3947.95 8796.81,-3945.26 8809.72,-3942.17"/>
<polygon fill="black" stroke="black" points="8810.65,-3945.54 8819.52,-3939.74 8808.97,-3938.75 8810.65,-3945.54"/>
</g>
<!-- expert_linear1_1_0_0 -->
<g id="node148" class="node">
<title>expert_linear1_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="873,-3838.86 691,-3838.86 691,-3785.86 873,-3785.86 873,-3838.86"/>
<text text-anchor="middle" x="782" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="782" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="782" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_1_0_0&#45;&gt;expert_linear1_1_0_0 -->
<g id="edge181" class="edge">
<title>route_to_expert_1_0_0&#45;&gt;expert_linear1_1_0_0</title>
<path fill="none" stroke="black" d="M761.92,-3874.85C764.73,-3866.25 767.72,-3857.1 770.51,-3848.55"/>
<polygon fill="black" stroke="black" points="773.89,-3849.46 773.67,-3838.87 767.24,-3847.29 773.89,-3849.46"/>
</g>
<!-- expert_activation_1_0_0 -->
<g id="node149" class="node">
<title>expert_activation_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="905,-3749.86 723,-3749.86 723,-3696.86 905,-3696.86 905,-3749.86"/>
<text text-anchor="middle" x="814" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="814" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="814" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_1_0_0&#45;&gt;expert_activation_1_0_0 -->
<g id="edge182" class="edge">
<title>expert_linear1_1_0_0&#45;&gt;expert_activation_1_0_0</title>
<path fill="none" stroke="black" d="M791.43,-3785.73C794.43,-3777.57 797.8,-3768.4 801.01,-3759.68"/>
<polygon fill="black" stroke="black" points="804.36,-3760.7 804.53,-3750.11 797.79,-3758.29 804.36,-3760.7"/>
</g>
<!-- expert_linear2_1_0_0 -->
<g id="node150" class="node">
<title>expert_linear2_1_0_0</title>
<polygon fill="lightgreen" stroke="black" points="1256.5,-3660.86 1083.5,-3660.86 1083.5,-3607.86 1256.5,-3607.86 1256.5,-3660.86"/>
<text text-anchor="middle" x="1170" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="1170" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1170" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_1_0_0&#45;&gt;expert_linear2_1_0_0 -->
<g id="edge183" class="edge">
<title>expert_activation_1_0_0&#45;&gt;expert_linear2_1_0_0</title>
<path fill="none" stroke="black" d="M905.22,-3700.07C956.7,-3687.49 1021,-3671.77 1073.35,-3658.98"/>
<polygon fill="black" stroke="black" points="1074.43,-3662.32 1083.31,-3656.54 1072.77,-3655.52 1074.43,-3662.32"/>
</g>
<!-- aggregate_1 -->
<g id="node275" class="node">
<title>aggregate_1</title>
<polygon fill="lightyellow" stroke="black" points="5171.64,-3571.86 4831.79,-3571.86 4744.36,-3465.86 5084.21,-3465.86 5171.64,-3571.86"/>
<text text-anchor="middle" x="4958" y="-3530.16" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="4958" y="-3515.16" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="4958" y="-3500.16" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- expert_linear2_1_0_0&#45;&gt;aggregate_1 -->
<g id="edge308" class="edge">
<title>expert_linear2_1_0_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1256.66,-3612.27C1266.18,-3610.51 1275.76,-3608.98 1285,-3607.86 1972.84,-3524.17 4138.72,-3519.15 4778.41,-3519.55"/>
<polygon fill="black" stroke="black" points="4778.64,-3523.05 4788.64,-3519.55 4778.64,-3516.05 4778.64,-3523.05"/>
</g>
<!-- expert_linear1_1_0_1 -->
<g id="node152" class="node">
<title>expert_linear1_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1136,-3838.86 954,-3838.86 954,-3785.86 1136,-3785.86 1136,-3838.86"/>
<text text-anchor="middle" x="1045" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="1045" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1045" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_1_0_1&#45;&gt;expert_linear1_1_0_1 -->
<g id="edge185" class="edge">
<title>route_to_expert_1_0_1&#45;&gt;expert_linear1_1_0_1</title>
<path fill="none" stroke="black" d="M1024.92,-3874.85C1027.73,-3866.25 1030.72,-3857.1 1033.51,-3848.55"/>
<polygon fill="black" stroke="black" points="1036.89,-3849.46 1036.67,-3838.87 1030.24,-3847.29 1036.89,-3849.46"/>
</g>
<!-- expert_activation_1_0_1 -->
<g id="node153" class="node">
<title>expert_activation_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1137,-3749.86 955,-3749.86 955,-3696.86 1137,-3696.86 1137,-3749.86"/>
<text text-anchor="middle" x="1046" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="1046" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1046" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_1_0_1&#45;&gt;expert_activation_1_0_1 -->
<g id="edge186" class="edge">
<title>expert_linear1_1_0_1&#45;&gt;expert_activation_1_0_1</title>
<path fill="none" stroke="black" d="M1045.29,-3785.73C1045.39,-3777.75 1045.49,-3768.79 1045.59,-3760.24"/>
<polygon fill="black" stroke="black" points="1049.09,-3760.15 1045.7,-3750.11 1042.09,-3760.07 1049.09,-3760.15"/>
</g>
<!-- expert_linear2_1_0_1 -->
<g id="node154" class="node">
<title>expert_linear2_1_0_1</title>
<polygon fill="lightgreen" stroke="black" points="1467.5,-3660.86 1294.5,-3660.86 1294.5,-3607.86 1467.5,-3607.86 1467.5,-3660.86"/>
<text text-anchor="middle" x="1381" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="1381" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1381" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_1_0_1&#45;&gt;expert_linear2_1_0_1 -->
<g id="edge187" class="edge">
<title>expert_activation_1_0_1&#45;&gt;expert_linear2_1_0_1</title>
<path fill="none" stroke="black" d="M1137.1,-3698.7C1182.77,-3686.84 1238.09,-3672.47 1284.49,-3660.42"/>
<polygon fill="black" stroke="black" points="1285.45,-3663.79 1294.25,-3657.89 1283.69,-3657.02 1285.45,-3663.79"/>
</g>
<!-- expert_linear2_1_0_1&#45;&gt;aggregate_1 -->
<g id="edge309" class="edge">
<title>expert_linear2_1_0_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1467.64,-3627.44C1554.64,-3621.68 1692.56,-3613.06 1812,-3607.86 2942.09,-3558.64 4301.81,-3531.48 4780.71,-3522.89"/>
<polygon fill="black" stroke="black" points="4780.88,-3526.38 4790.82,-3522.7 4780.76,-3519.38 4780.88,-3526.38"/>
</g>
<!-- expert_linear1_1_0_2 -->
<g id="node156" class="node">
<title>expert_linear1_1_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1367,-3838.86 1185,-3838.86 1185,-3785.86 1367,-3785.86 1367,-3838.86"/>
<text text-anchor="middle" x="1276" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="1276" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1276" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_1_0_2&#45;&gt;expert_linear1_1_0_2 -->
<g id="edge189" class="edge">
<title>route_to_expert_1_0_2&#45;&gt;expert_linear1_1_0_2</title>
<path fill="none" stroke="black" d="M1276,-3874.85C1276,-3866.44 1276,-3857.49 1276,-3849.11"/>
<polygon fill="black" stroke="black" points="1279.5,-3848.87 1276,-3838.87 1272.5,-3848.87 1279.5,-3848.87"/>
</g>
<!-- expert_activation_1_0_2 -->
<g id="node157" class="node">
<title>expert_activation_1_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1793,-3749.86 1611,-3749.86 1611,-3696.86 1793,-3696.86 1793,-3749.86"/>
<text text-anchor="middle" x="1702" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1702" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1702" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_1_0_2&#45;&gt;expert_activation_1_0_2 -->
<g id="edge190" class="edge">
<title>expert_linear1_1_0_2&#45;&gt;expert_activation_1_0_2</title>
<path fill="none" stroke="black" d="M1367.13,-3792.75C1435.76,-3778.73 1529.83,-3759.52 1600.8,-3745.03"/>
<polygon fill="black" stroke="black" points="1601.55,-3748.45 1610.65,-3743.02 1600.15,-3741.59 1601.55,-3748.45"/>
</g>
<!-- expert_linear2_1_0_2 -->
<g id="node158" class="node">
<title>expert_linear2_1_0_2</title>
<polygon fill="lightgreen" stroke="black" points="1993.5,-3660.86 1820.5,-3660.86 1820.5,-3607.86 1993.5,-3607.86 1993.5,-3660.86"/>
<text text-anchor="middle" x="1907" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1907" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1907" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_1_0_2&#45;&gt;expert_linear2_1_0_2 -->
<g id="edge191" class="edge">
<title>expert_activation_1_0_2&#45;&gt;expert_linear2_1_0_2</title>
<path fill="none" stroke="black" d="M1762.12,-3696.84C1785.8,-3686.8 1813.13,-3675.2 1837.64,-3664.8"/>
<polygon fill="black" stroke="black" points="1839.04,-3668 1846.88,-3660.87 1836.31,-3661.56 1839.04,-3668"/>
</g>
<!-- expert_linear2_1_0_2&#45;&gt;aggregate_1 -->
<g id="edge310" class="edge">
<title>expert_linear2_1_0_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M1993.51,-3621.3C2032.41,-3616.33 2078.93,-3611.01 2121,-3607.86 3123.48,-3532.73 4329.84,-3521.46 4778.52,-3519.98"/>
<polygon fill="black" stroke="black" points="4778.66,-3523.48 4788.65,-3519.95 4778.64,-3516.48 4778.66,-3523.48"/>
</g>
<!-- expert_linear1_1_0_3 -->
<g id="node160" class="node">
<title>expert_linear1_1_0_3</title>
<polygon fill="lightgreen" stroke="black" points="1700,-3838.86 1518,-3838.86 1518,-3785.86 1700,-3785.86 1700,-3838.86"/>
<text text-anchor="middle" x="1609" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1609" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1609" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- route_to_expert_1_0_3&#45;&gt;expert_linear1_1_0_3 -->
<g id="edge193" class="edge">
<title>route_to_expert_1_0_3&#45;&gt;expert_linear1_1_0_3</title>
<path fill="none" stroke="black" d="M1564.67,-3875.41C1571.3,-3866.13 1578.41,-3856.17 1584.96,-3847.01"/>
<polygon fill="black" stroke="black" points="1587.82,-3849.03 1590.78,-3838.86 1582.12,-3844.96 1587.82,-3849.03"/>
</g>
<!-- expert_activation_1_0_3 -->
<g id="node161" class="node">
<title>expert_activation_1_0_3</title>
<polygon fill="lightgreen" stroke="black" points="2221,-3749.86 2039,-3749.86 2039,-3696.86 2221,-3696.86 2221,-3749.86"/>
<text text-anchor="middle" x="2130" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="2130" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2130" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_linear1_1_0_3&#45;&gt;expert_activation_1_0_3 -->
<g id="edge194" class="edge">
<title>expert_linear1_1_0_3&#45;&gt;expert_activation_1_0_3</title>
<path fill="none" stroke="black" d="M1700.05,-3796.16C1791.89,-3780.82 1933.37,-3757.19 2028.71,-3741.27"/>
<polygon fill="black" stroke="black" points="2029.36,-3744.71 2038.65,-3739.61 2028.21,-3737.81 2029.36,-3744.71"/>
</g>
<!-- expert_linear2_1_0_3 -->
<g id="node162" class="node">
<title>expert_linear2_1_0_3</title>
<polygon fill="lightgreen" stroke="black" points="2302.5,-3660.86 2129.5,-3660.86 2129.5,-3607.86 2302.5,-3607.86 2302.5,-3660.86"/>
<text text-anchor="middle" x="2216" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="2216" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2216" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- expert_activation_1_0_3&#45;&gt;expert_linear2_1_0_3 -->
<g id="edge195" class="edge">
<title>expert_activation_1_0_3&#45;&gt;expert_linear2_1_0_3</title>
<path fill="none" stroke="black" d="M2155.34,-3696.73C2164.1,-3687.87 2174.04,-3677.81 2183.3,-3668.44"/>
<polygon fill="black" stroke="black" points="2186.01,-3670.68 2190.55,-3661.11 2181.03,-3665.76 2186.01,-3670.68"/>
</g>
<!-- expert_linear2_1_0_3&#45;&gt;aggregate_1 -->
<g id="edge311" class="edge">
<title>expert_linear2_1_0_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2302.83,-3619.38C2333.17,-3614.99 2367.52,-3610.59 2399,-3607.86 3289.69,-3530.7 4360.29,-3520.46 4778.39,-3519.62"/>
<polygon fill="black" stroke="black" points="4778.46,-3523.12 4788.45,-3519.6 4778.45,-3516.12 4778.46,-3523.12"/>
</g>
<!-- expert_linear1_1_1_0 -->
<g id="node164" class="node">
<title>expert_linear1_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="1971,-3838.86 1789,-3838.86 1789,-3785.86 1971,-3785.86 1971,-3838.86"/>
<text text-anchor="middle" x="1880" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1880" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1880" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_1_1_0&#45;&gt;expert_linear1_1_1_0 -->
<g id="edge197" class="edge">
<title>route_to_expert_1_1_0&#45;&gt;expert_linear1_1_1_0</title>
<path fill="none" stroke="black" d="M1830.38,-3875.69C1837.86,-3866.29 1845.9,-3856.19 1853.29,-3846.91"/>
<polygon fill="black" stroke="black" points="1856.09,-3849.01 1859.58,-3839.01 1850.62,-3844.65 1856.09,-3849.01"/>
</g>
<!-- expert_activation_1_1_0 -->
<g id="node165" class="node">
<title>expert_activation_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="2535,-3749.86 2353,-3749.86 2353,-3696.86 2535,-3696.86 2535,-3749.86"/>
<text text-anchor="middle" x="2444" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="2444" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2444" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_1_1_0&#45;&gt;expert_activation_1_1_0 -->
<g id="edge198" class="edge">
<title>expert_linear1_1_1_0&#45;&gt;expert_activation_1_1_0</title>
<path fill="none" stroke="black" d="M1971.24,-3797.29C2073.03,-3781.58 2237.22,-3756.26 2342.85,-3739.96"/>
<polygon fill="black" stroke="black" points="2343.54,-3743.4 2352.89,-3738.41 2342.47,-3736.48 2343.54,-3743.4"/>
</g>
<!-- expert_linear2_1_1_0 -->
<g id="node166" class="node">
<title>expert_linear2_1_1_0</title>
<polygon fill="lightgreen" stroke="black" points="2580.5,-3660.86 2407.5,-3660.86 2407.5,-3607.86 2580.5,-3607.86 2580.5,-3660.86"/>
<text text-anchor="middle" x="2494" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="2494" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2494" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_1_1_0&#45;&gt;expert_linear2_1_1_0 -->
<g id="edge199" class="edge">
<title>expert_activation_1_1_0&#45;&gt;expert_linear2_1_1_0</title>
<path fill="none" stroke="black" d="M2458.73,-3696.73C2463.57,-3688.31 2469.03,-3678.81 2474.18,-3669.84"/>
<polygon fill="black" stroke="black" points="2477.25,-3671.52 2479.2,-3661.11 2471.18,-3668.04 2477.25,-3671.52"/>
</g>
<!-- expert_linear2_1_1_0&#45;&gt;aggregate_1 -->
<g id="edge312" class="edge">
<title>expert_linear2_1_1_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2580.58,-3616.25C2600.06,-3612.96 2620.68,-3609.9 2640,-3607.86 3054.45,-3564 4313.91,-3533.54 4781.11,-3523.48"/>
<polygon fill="black" stroke="black" points="4781.4,-3526.98 4791.33,-3523.26 4781.25,-3519.98 4781.4,-3526.98"/>
</g>
<!-- expert_linear1_1_1_1 -->
<g id="node168" class="node">
<title>expert_linear1_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2250,-3838.86 2068,-3838.86 2068,-3785.86 2250,-3785.86 2250,-3838.86"/>
<text text-anchor="middle" x="2159" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="2159" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2159" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_1_1_1&#45;&gt;expert_linear1_1_1_1 -->
<g id="edge201" class="edge">
<title>route_to_expert_1_1_1&#45;&gt;expert_linear1_1_1_1</title>
<path fill="none" stroke="black" d="M2098.67,-3876.24C2107.98,-3866.54 2118.05,-3856.04 2127.25,-3846.45"/>
<polygon fill="black" stroke="black" points="2130.01,-3848.63 2134.41,-3838.99 2124.96,-3843.78 2130.01,-3848.63"/>
</g>
<!-- expert_activation_1_1_1 -->
<g id="node169" class="node">
<title>expert_activation_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2792,-3749.86 2610,-3749.86 2610,-3696.86 2792,-3696.86 2792,-3749.86"/>
<text text-anchor="middle" x="2701" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="2701" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2701" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_1_1_1&#45;&gt;expert_activation_1_1_1 -->
<g id="edge202" class="edge">
<title>expert_linear1_1_1_1&#45;&gt;expert_activation_1_1_1</title>
<path fill="none" stroke="black" d="M2250.15,-3792.99C2263.5,-3790.48 2277.09,-3788.03 2290,-3785.86 2402.44,-3766.96 2431.28,-3767 2544,-3749.86 2562.05,-3747.12 2581.25,-3744.09 2599.8,-3741.11"/>
<polygon fill="black" stroke="black" points="2600.41,-3744.55 2609.73,-3739.5 2599.3,-3737.64 2600.41,-3744.55"/>
</g>
<!-- expert_linear2_1_1_1 -->
<g id="node170" class="node">
<title>expert_linear2_1_1_1</title>
<polygon fill="lightgreen" stroke="black" points="2821.5,-3660.86 2648.5,-3660.86 2648.5,-3607.86 2821.5,-3607.86 2821.5,-3660.86"/>
<text text-anchor="middle" x="2735" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2735" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2735" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_1_1_1&#45;&gt;expert_linear2_1_1_1 -->
<g id="edge203" class="edge">
<title>expert_activation_1_1_1&#45;&gt;expert_linear2_1_1_1</title>
<path fill="none" stroke="black" d="M2711.02,-3696.73C2714.21,-3688.57 2717.79,-3679.4 2721.2,-3670.68"/>
<polygon fill="black" stroke="black" points="2724.56,-3671.7 2724.94,-3661.11 2718.04,-3669.15 2724.56,-3671.7"/>
</g>
<!-- expert_linear2_1_1_1&#45;&gt;aggregate_1 -->
<g id="edge313" class="edge">
<title>expert_linear2_1_1_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M2821.81,-3613.93C2834.89,-3611.54 2848.26,-3609.41 2861,-3607.86 3230.56,-3562.99 4346.09,-3533.69 4781.36,-3523.68"/>
<polygon fill="black" stroke="black" points="4781.6,-3527.18 4791.51,-3523.45 4781.44,-3520.18 4781.6,-3527.18"/>
</g>
<!-- expert_linear1_1_1_2 -->
<g id="node172" class="node">
<title>expert_linear1_1_1_2</title>
<polygon fill="lightgreen" stroke="black" points="2481,-3838.86 2299,-3838.86 2299,-3785.86 2481,-3785.86 2481,-3838.86"/>
<text text-anchor="middle" x="2390" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="2390" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2390" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_1_1_2&#45;&gt;expert_linear1_1_1_2 -->
<g id="edge205" class="edge">
<title>route_to_expert_1_1_2&#45;&gt;expert_linear1_1_1_2</title>
<path fill="none" stroke="black" d="M2350.73,-3875.41C2356.49,-3866.32 2362.65,-3856.58 2368.35,-3847.57"/>
<polygon fill="black" stroke="black" points="2371.47,-3849.18 2373.86,-3838.86 2365.56,-3845.44 2371.47,-3849.18"/>
</g>
<!-- expert_activation_1_1_2 -->
<g id="node173" class="node">
<title>expert_activation_1_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3021,-3749.86 2839,-3749.86 2839,-3696.86 3021,-3696.86 3021,-3749.86"/>
<text text-anchor="middle" x="2930" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2930" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2930" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_1_1_2&#45;&gt;expert_activation_1_1_2 -->
<g id="edge206" class="edge">
<title>expert_linear1_1_1_2&#45;&gt;expert_activation_1_1_2</title>
<path fill="none" stroke="black" d="M2481.35,-3796.89C2504.71,-3793.24 2529.78,-3789.36 2553,-3785.86 2663.13,-3769.25 2691.22,-3768.67 2801,-3749.86 2810.1,-3748.3 2819.55,-3746.6 2829,-3744.84"/>
<polygon fill="black" stroke="black" points="2829.66,-3748.27 2838.84,-3742.98 2828.37,-3741.39 2829.66,-3748.27"/>
</g>
<!-- expert_linear2_1_1_2 -->
<g id="node174" class="node">
<title>expert_linear2_1_1_2</title>
<polygon fill="lightgreen" stroke="black" points="3042.5,-3660.86 2869.5,-3660.86 2869.5,-3607.86 3042.5,-3607.86 3042.5,-3660.86"/>
<text text-anchor="middle" x="2956" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2956" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2956" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_1_1_2&#45;&gt;expert_linear2_1_1_2 -->
<g id="edge207" class="edge">
<title>expert_activation_1_1_2&#45;&gt;expert_linear2_1_1_2</title>
<path fill="none" stroke="black" d="M2937.66,-3696.73C2940.07,-3688.66 2942.78,-3679.6 2945.36,-3670.96"/>
<polygon fill="black" stroke="black" points="2948.79,-3671.69 2948.3,-3661.11 2942.09,-3669.69 2948.79,-3671.69"/>
</g>
<!-- expert_linear2_1_1_2&#45;&gt;aggregate_1 -->
<g id="edge314" class="edge">
<title>expert_linear2_1_1_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3042.75,-3611.25C3049.57,-3609.95 3056.38,-3608.79 3063,-3607.86 3391.56,-3561.5 4376.94,-3533.6 4781.59,-3523.82"/>
<polygon fill="black" stroke="black" points="4781.72,-3527.32 4791.63,-3523.58 4781.55,-3520.32 4781.72,-3527.32"/>
</g>
<!-- expert_linear1_1_1_3 -->
<g id="node176" class="node">
<title>expert_linear1_1_1_3</title>
<polygon fill="lightgreen" stroke="black" points="2744,-3838.86 2562,-3838.86 2562,-3785.86 2744,-3785.86 2744,-3838.86"/>
<text text-anchor="middle" x="2653" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2653" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2653" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- route_to_expert_1_1_3&#45;&gt;expert_linear1_1_1_3 -->
<g id="edge209" class="edge">
<title>route_to_expert_1_1_3&#45;&gt;expert_linear1_1_1_3</title>
<path fill="none" stroke="black" d="M2613.73,-3875.41C2619.49,-3866.32 2625.65,-3856.58 2631.35,-3847.57"/>
<polygon fill="black" stroke="black" points="2634.47,-3849.18 2636.86,-3838.86 2628.56,-3845.44 2634.47,-3849.18"/>
</g>
<!-- expert_activation_1_1_3 -->
<g id="node177" class="node">
<title>expert_activation_1_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3235,-3749.86 3053,-3749.86 3053,-3696.86 3235,-3696.86 3235,-3749.86"/>
<text text-anchor="middle" x="3144" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="3144" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3144" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_linear1_1_1_3&#45;&gt;expert_activation_1_1_3 -->
<g id="edge210" class="edge">
<title>expert_linear1_1_1_3&#45;&gt;expert_activation_1_1_3</title>
<path fill="none" stroke="black" d="M2744.24,-3797.1C2837.75,-3782.38 2976.77,-3760.15 3030,-3749.86 3034.2,-3749.05 3038.48,-3748.2 3042.8,-3747.32"/>
<polygon fill="black" stroke="black" points="3043.86,-3750.68 3052.94,-3745.23 3042.44,-3743.82 3043.86,-3750.68"/>
</g>
<!-- expert_linear2_1_1_3 -->
<g id="node178" class="node">
<title>expert_linear2_1_1_3</title>
<polygon fill="lightgreen" stroke="black" points="3244.5,-3660.86 3071.5,-3660.86 3071.5,-3607.86 3244.5,-3607.86 3244.5,-3660.86"/>
<text text-anchor="middle" x="3158" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="3158" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3158" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- expert_activation_1_1_3&#45;&gt;expert_linear2_1_1_3 -->
<g id="edge211" class="edge">
<title>expert_activation_1_1_3&#45;&gt;expert_linear2_1_1_3</title>
<path fill="none" stroke="black" d="M3148.12,-3696.73C3149.41,-3688.75 3150.85,-3679.79 3152.23,-3671.24"/>
<polygon fill="black" stroke="black" points="3155.72,-3671.54 3153.86,-3661.11 3148.81,-3670.43 3155.72,-3671.54"/>
</g>
<!-- expert_linear2_1_1_3&#45;&gt;aggregate_1 -->
<g id="edge315" class="edge">
<title>expert_linear2_1_1_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3244.8,-3611.75C3252.61,-3610.26 3260.43,-3608.93 3268,-3607.86 3556.39,-3567.25 4411.68,-3536.76 4782.85,-3525.07"/>
<polygon fill="black" stroke="black" points="4782.99,-3528.57 4792.88,-3524.76 4782.77,-3521.57 4782.99,-3528.57"/>
</g>
<!-- expert_linear1_1_2_0 -->
<g id="node180" class="node">
<title>expert_linear1_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="3007,-3838.86 2825,-3838.86 2825,-3785.86 3007,-3785.86 3007,-3838.86"/>
<text text-anchor="middle" x="2916" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2916" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2916" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_1_2_0&#45;&gt;expert_linear1_1_2_0 -->
<g id="edge213" class="edge">
<title>route_to_expert_1_2_0&#45;&gt;expert_linear1_1_2_0</title>
<path fill="none" stroke="black" d="M2876.73,-3875.41C2882.49,-3866.32 2888.65,-3856.58 2894.35,-3847.57"/>
<polygon fill="black" stroke="black" points="2897.47,-3849.18 2899.86,-3838.86 2891.56,-3845.44 2897.47,-3849.18"/>
</g>
<!-- expert_activation_1_2_0 -->
<g id="node181" class="node">
<title>expert_activation_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="3442,-3749.86 3260,-3749.86 3260,-3696.86 3442,-3696.86 3442,-3749.86"/>
<text text-anchor="middle" x="3351" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="3351" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3351" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_1_2_0&#45;&gt;expert_activation_1_2_0 -->
<g id="edge214" class="edge">
<title>expert_linear1_1_2_0&#45;&gt;expert_activation_1_2_0</title>
<path fill="none" stroke="black" d="M3007.08,-3795.51C3073.03,-3783.73 3164.24,-3766.83 3244,-3749.86 3245.93,-3749.45 3247.87,-3749.03 3249.83,-3748.61"/>
<polygon fill="black" stroke="black" points="3250.7,-3752 3259.72,-3746.43 3249.2,-3745.16 3250.7,-3752"/>
</g>
<!-- expert_linear2_1_2_0 -->
<g id="node182" class="node">
<title>expert_linear2_1_2_0</title>
<polygon fill="lightgreen" stroke="black" points="3449.5,-3660.86 3276.5,-3660.86 3276.5,-3607.86 3449.5,-3607.86 3449.5,-3660.86"/>
<text text-anchor="middle" x="3363" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="3363" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3363" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_1_2_0&#45;&gt;expert_linear2_1_2_0 -->
<g id="edge215" class="edge">
<title>expert_activation_1_2_0&#45;&gt;expert_linear2_1_2_0</title>
<path fill="none" stroke="black" d="M3354.54,-3696.73C3355.64,-3688.75 3356.87,-3679.79 3358.05,-3671.24"/>
<polygon fill="black" stroke="black" points="3361.55,-3671.49 3359.45,-3661.11 3354.61,-3670.54 3361.55,-3671.49"/>
</g>
<!-- expert_linear2_1_2_0&#45;&gt;aggregate_1 -->
<g id="edge316" class="edge">
<title>expert_linear2_1_2_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3449.61,-3611.69C3457.15,-3610.23 3464.69,-3608.92 3472,-3607.86 3940.3,-3539.72 4498.95,-3524.04 4779.1,-3520.63"/>
<polygon fill="black" stroke="black" points="4779.4,-3524.13 4789.36,-3520.51 4779.31,-3517.13 4779.4,-3524.13"/>
</g>
<!-- expert_linear1_1_2_1 -->
<g id="node184" class="node">
<title>expert_linear1_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3270,-3838.86 3088,-3838.86 3088,-3785.86 3270,-3785.86 3270,-3838.86"/>
<text text-anchor="middle" x="3179" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="3179" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3179" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_1_2_1&#45;&gt;expert_linear1_1_2_1 -->
<g id="edge217" class="edge">
<title>route_to_expert_1_2_1&#45;&gt;expert_linear1_1_2_1</title>
<path fill="none" stroke="black" d="M3139.73,-3875.41C3145.49,-3866.32 3151.65,-3856.58 3157.35,-3847.57"/>
<polygon fill="black" stroke="black" points="3160.47,-3849.18 3162.86,-3838.86 3154.56,-3845.44 3160.47,-3849.18"/>
</g>
<!-- expert_activation_1_2_1 -->
<g id="node185" class="node">
<title>expert_activation_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3646,-3749.86 3464,-3749.86 3464,-3696.86 3646,-3696.86 3646,-3749.86"/>
<text text-anchor="middle" x="3555" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="3555" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3555" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_1_2_1&#45;&gt;expert_activation_1_2_1 -->
<g id="edge218" class="edge">
<title>expert_linear1_1_2_1&#45;&gt;expert_activation_1_2_1</title>
<path fill="none" stroke="black" d="M3270.07,-3791.2C3322.95,-3779.39 3390.8,-3764.04 3451,-3749.86 3452.06,-3749.61 3453.13,-3749.36 3454.21,-3749.1"/>
<polygon fill="black" stroke="black" points="3455.07,-3752.49 3463.99,-3746.78 3453.45,-3745.68 3455.07,-3752.49"/>
</g>
<!-- expert_linear2_1_2_1 -->
<g id="node186" class="node">
<title>expert_linear2_1_2_1</title>
<polygon fill="lightgreen" stroke="black" points="3653.5,-3660.86 3480.5,-3660.86 3480.5,-3607.86 3653.5,-3607.86 3653.5,-3660.86"/>
<text text-anchor="middle" x="3567" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="3567" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3567" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_1_2_1&#45;&gt;expert_linear2_1_2_1 -->
<g id="edge219" class="edge">
<title>expert_activation_1_2_1&#45;&gt;expert_linear2_1_2_1</title>
<path fill="none" stroke="black" d="M3558.54,-3696.73C3559.64,-3688.75 3560.87,-3679.79 3562.05,-3671.24"/>
<polygon fill="black" stroke="black" points="3565.55,-3671.49 3563.45,-3661.11 3558.61,-3670.54 3565.55,-3671.49"/>
</g>
<!-- expert_linear2_1_2_1&#45;&gt;aggregate_1 -->
<g id="edge317" class="edge">
<title>expert_linear2_1_2_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3653.54,-3611.29C3660.1,-3610 3666.64,-3608.84 3673,-3607.86 4065.55,-3547.64 4531.89,-3528.62 4780.71,-3522.62"/>
<polygon fill="black" stroke="black" points="4781.02,-3526.11 4790.93,-3522.38 4780.85,-3519.12 4781.02,-3526.11"/>
</g>
<!-- expert_linear1_1_2_2 -->
<g id="node188" class="node">
<title>expert_linear1_1_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3533,-3838.86 3351,-3838.86 3351,-3785.86 3533,-3785.86 3533,-3838.86"/>
<text text-anchor="middle" x="3442" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3442" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3442" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_1_2_2&#45;&gt;expert_linear1_1_2_2 -->
<g id="edge221" class="edge">
<title>route_to_expert_1_2_2&#45;&gt;expert_linear1_1_2_2</title>
<path fill="none" stroke="black" d="M3402.73,-3875.41C3408.49,-3866.32 3414.65,-3856.58 3420.35,-3847.57"/>
<polygon fill="black" stroke="black" points="3423.47,-3849.18 3425.86,-3838.86 3417.56,-3845.44 3423.47,-3849.18"/>
</g>
<!-- expert_activation_1_2_2 -->
<g id="node189" class="node">
<title>expert_activation_1_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3848,-3749.86 3666,-3749.86 3666,-3696.86 3848,-3696.86 3848,-3749.86"/>
<text text-anchor="middle" x="3757" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="3757" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3757" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_1_2_2&#45;&gt;expert_activation_1_2_2 -->
<g id="edge222" class="edge">
<title>expert_linear1_1_2_2&#45;&gt;expert_activation_1_2_2</title>
<path fill="none" stroke="black" d="M3533.11,-3786.2C3571.64,-3775.56 3616.65,-3763.12 3656.16,-3752.21"/>
<polygon fill="black" stroke="black" points="3657.11,-3755.58 3665.82,-3749.54 3655.25,-3748.83 3657.11,-3755.58"/>
</g>
<!-- expert_linear2_1_2_2 -->
<g id="node190" class="node">
<title>expert_linear2_1_2_2</title>
<polygon fill="lightgreen" stroke="black" points="3854.5,-3660.86 3681.5,-3660.86 3681.5,-3607.86 3854.5,-3607.86 3854.5,-3660.86"/>
<text text-anchor="middle" x="3768" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3768" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3768" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_1_2_2&#45;&gt;expert_linear2_1_2_2 -->
<g id="edge223" class="edge">
<title>expert_activation_1_2_2&#45;&gt;expert_linear2_1_2_2</title>
<path fill="none" stroke="black" d="M3760.24,-3696.73C3761.25,-3688.75 3762.38,-3679.79 3763.46,-3671.24"/>
<polygon fill="black" stroke="black" points="3766.96,-3671.47 3764.74,-3661.11 3760.02,-3670.59 3766.96,-3671.47"/>
</g>
<!-- expert_linear2_1_2_2&#45;&gt;aggregate_1 -->
<g id="edge318" class="edge">
<title>expert_linear2_1_2_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M3854.58,-3610.51C3859.44,-3609.54 3864.27,-3608.64 3869,-3607.86 4188.61,-3554.98 4566.46,-3533.49 4782.59,-3525.04"/>
<polygon fill="black" stroke="black" points="4782.9,-3528.53 4792.76,-3524.65 4782.63,-3521.54 4782.9,-3528.53"/>
</g>
<!-- expert_linear1_1_2_3 -->
<g id="node192" class="node">
<title>expert_linear1_1_2_3</title>
<polygon fill="lightgreen" stroke="black" points="3795,-3838.86 3613,-3838.86 3613,-3785.86 3795,-3785.86 3795,-3838.86"/>
<text text-anchor="middle" x="3704" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3704" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3704" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- route_to_expert_1_2_3&#45;&gt;expert_linear1_1_2_3 -->
<g id="edge225" class="edge">
<title>route_to_expert_1_2_3&#45;&gt;expert_linear1_1_2_3</title>
<path fill="none" stroke="black" d="M3665.37,-3875.41C3671.03,-3866.32 3677.09,-3856.58 3682.7,-3847.57"/>
<polygon fill="black" stroke="black" points="3685.81,-3849.2 3688.12,-3838.86 3679.87,-3845.5 3685.81,-3849.2"/>
</g>
<!-- expert_activation_1_2_3 -->
<g id="node193" class="node">
<title>expert_activation_1_2_3</title>
<polygon fill="lightgreen" stroke="black" points="4049,-3749.86 3867,-3749.86 3867,-3696.86 4049,-3696.86 4049,-3749.86"/>
<text text-anchor="middle" x="3958" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3958" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3958" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_linear1_1_2_3&#45;&gt;expert_activation_1_2_3 -->
<g id="edge226" class="edge">
<title>expert_linear1_1_2_3&#45;&gt;expert_activation_1_2_3</title>
<path fill="none" stroke="black" d="M3778.49,-3785.84C3808.34,-3775.62 3842.89,-3763.79 3873.66,-3753.25"/>
<polygon fill="black" stroke="black" points="3875.18,-3756.43 3883.51,-3749.87 3872.91,-3749.8 3875.18,-3756.43"/>
</g>
<!-- expert_linear2_1_2_3 -->
<g id="node194" class="node">
<title>expert_linear2_1_2_3</title>
<polygon fill="lightgreen" stroke="black" points="4050.5,-3660.86 3877.5,-3660.86 3877.5,-3607.86 4050.5,-3607.86 4050.5,-3660.86"/>
<text text-anchor="middle" x="3964" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3964" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3964" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- expert_activation_1_2_3&#45;&gt;expert_linear2_1_2_3 -->
<g id="edge227" class="edge">
<title>expert_activation_1_2_3&#45;&gt;expert_linear2_1_2_3</title>
<path fill="none" stroke="black" d="M3959.77,-3696.73C3960.32,-3688.75 3960.94,-3679.79 3961.53,-3671.24"/>
<polygon fill="black" stroke="black" points="3965.03,-3671.33 3962.22,-3661.11 3958.04,-3670.85 3965.03,-3671.33"/>
</g>
<!-- expert_linear2_1_2_3&#45;&gt;aggregate_1 -->
<g id="edge319" class="edge">
<title>expert_linear2_1_2_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4050.62,-3610.79C4055.81,-3609.72 4060.96,-3608.73 4066,-3607.86 4314.29,-3564.81 4605.39,-3541.02 4785.79,-3529.34"/>
<polygon fill="black" stroke="black" points="4786.14,-3532.82 4795.9,-3528.69 4785.69,-3525.84 4786.14,-3532.82"/>
</g>
<!-- expert_linear1_1_3_0 -->
<g id="node196" class="node">
<title>expert_linear1_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="4056,-3838.86 3874,-3838.86 3874,-3785.86 4056,-3785.86 4056,-3838.86"/>
<text text-anchor="middle" x="3965" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3965" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3965" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_1_3_0&#45;&gt;expert_linear1_1_3_0 -->
<g id="edge229" class="edge">
<title>route_to_expert_1_3_0&#45;&gt;expert_linear1_1_3_0</title>
<path fill="none" stroke="black" d="M3927.63,-3875.41C3933.11,-3866.32 3938.98,-3856.58 3944.4,-3847.57"/>
<polygon fill="black" stroke="black" points="3947.48,-3849.23 3949.64,-3838.86 3941.49,-3845.62 3947.48,-3849.23"/>
</g>
<!-- expert_activation_1_3_0 -->
<g id="node197" class="node">
<title>expert_activation_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="4249,-3749.86 4067,-3749.86 4067,-3696.86 4249,-3696.86 4249,-3749.86"/>
<text text-anchor="middle" x="4158" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="4158" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4158" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_1_3_0&#45;&gt;expert_activation_1_3_0 -->
<g id="edge230" class="edge">
<title>expert_linear1_1_3_0&#45;&gt;expert_activation_1_3_0</title>
<path fill="none" stroke="black" d="M4021.6,-3785.84C4043.7,-3775.89 4069.18,-3764.4 4092.09,-3754.07"/>
<polygon fill="black" stroke="black" points="4093.72,-3757.17 4101.4,-3749.87 4090.84,-3750.79 4093.72,-3757.17"/>
</g>
<!-- expert_linear2_1_3_0 -->
<g id="node198" class="node">
<title>expert_linear2_1_3_0</title>
<polygon fill="lightgreen" stroke="black" points="4247.5,-3660.86 4074.5,-3660.86 4074.5,-3607.86 4247.5,-3607.86 4247.5,-3660.86"/>
<text text-anchor="middle" x="4161" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="4161" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4161" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_1_3_0&#45;&gt;expert_linear2_1_3_0 -->
<g id="edge231" class="edge">
<title>expert_activation_1_3_0&#45;&gt;expert_linear2_1_3_0</title>
<path fill="none" stroke="black" d="M4158.88,-3696.73C4159.16,-3688.75 4159.47,-3679.79 4159.76,-3671.24"/>
<polygon fill="black" stroke="black" points="4163.27,-3671.22 4160.11,-3661.11 4156.27,-3670.98 4163.27,-3671.22"/>
</g>
<!-- expert_linear2_1_3_0&#45;&gt;aggregate_1 -->
<g id="edge320" class="edge">
<title>expert_linear2_1_3_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4247.66,-3613.1C4256.87,-3611.21 4266.11,-3609.42 4275,-3607.86 4450.33,-3577.02 4652.76,-3552.29 4791.45,-3536.99"/>
<polygon fill="black" stroke="black" points="4792.19,-3540.43 4801.75,-3535.86 4791.42,-3533.47 4792.19,-3540.43"/>
</g>
<!-- expert_linear1_1_3_1 -->
<g id="node200" class="node">
<title>expert_linear1_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="4315,-3838.86 4133,-3838.86 4133,-3785.86 4315,-3785.86 4315,-3838.86"/>
<text text-anchor="middle" x="4224" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="4224" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4224" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_1_3_1&#45;&gt;expert_linear1_1_3_1 -->
<g id="edge233" class="edge">
<title>route_to_expert_1_3_1&#45;&gt;expert_linear1_1_3_1</title>
<path fill="none" stroke="black" d="M4189.32,-3875.13C4194.32,-3866.23 4199.66,-3856.73 4204.61,-3847.91"/>
<polygon fill="black" stroke="black" points="4207.75,-3849.45 4209.6,-3839.02 4201.65,-3846.02 4207.75,-3849.45"/>
</g>
<!-- expert_activation_1_3_1 -->
<g id="node201" class="node">
<title>expert_activation_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="4449,-3749.86 4267,-3749.86 4267,-3696.86 4449,-3696.86 4449,-3749.86"/>
<text text-anchor="middle" x="4358" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="4358" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4358" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_1_3_1&#45;&gt;expert_activation_1_3_1 -->
<g id="edge234" class="edge">
<title>expert_linear1_1_3_1&#45;&gt;expert_activation_1_3_1</title>
<path fill="none" stroke="black" d="M4263.48,-3785.73C4277.94,-3776.34 4294.46,-3765.61 4309.61,-3755.78"/>
<polygon fill="black" stroke="black" points="4311.86,-3758.49 4318.34,-3750.11 4308.05,-3752.62 4311.86,-3758.49"/>
</g>
<!-- expert_linear2_1_3_1 -->
<g id="node202" class="node">
<title>expert_linear2_1_3_1</title>
<polygon fill="lightgreen" stroke="black" points="4456.5,-3660.86 4283.5,-3660.86 4283.5,-3607.86 4456.5,-3607.86 4456.5,-3660.86"/>
<text text-anchor="middle" x="4370" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="4370" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4370" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_1_3_1&#45;&gt;expert_linear2_1_3_1 -->
<g id="edge235" class="edge">
<title>expert_activation_1_3_1&#45;&gt;expert_linear2_1_3_1</title>
<path fill="none" stroke="black" d="M4361.54,-3696.73C4362.64,-3688.75 4363.87,-3679.79 4365.05,-3671.24"/>
<polygon fill="black" stroke="black" points="4368.55,-3671.49 4366.45,-3661.11 4361.61,-3670.54 4368.55,-3671.49"/>
</g>
<!-- expert_linear2_1_3_1&#45;&gt;aggregate_1 -->
<g id="edge321" class="edge">
<title>expert_linear2_1_3_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4456.72,-3611.88C4462.89,-3610.48 4469.04,-3609.13 4475,-3607.86 4582.8,-3584.97 4704.92,-3562.75 4799.4,-3546.37"/>
<polygon fill="black" stroke="black" points="4800.06,-3549.81 4809.32,-3544.65 4798.87,-3542.91 4800.06,-3549.81"/>
</g>
<!-- expert_linear1_1_3_2 -->
<g id="node204" class="node">
<title>expert_linear1_1_3_2</title>
<polygon fill="lightgreen" stroke="black" points="4570,-3838.86 4388,-3838.86 4388,-3785.86 4570,-3785.86 4570,-3838.86"/>
<text text-anchor="middle" x="4479" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="4479" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4479" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_1_3_2&#45;&gt;expert_linear1_1_3_2 -->
<g id="edge237" class="edge">
<title>route_to_expert_1_3_2&#45;&gt;expert_linear1_1_3_2</title>
<path fill="none" stroke="black" d="M4449.37,-3875.13C4453.59,-3866.33 4458.1,-3856.93 4462.29,-3848.18"/>
<polygon fill="black" stroke="black" points="4465.52,-3849.55 4466.69,-3839.02 4459.21,-3846.52 4465.52,-3849.55"/>
</g>
<!-- expert_activation_1_3_2 -->
<g id="node205" class="node">
<title>expert_activation_1_3_2</title>
<polygon fill="lightgreen" stroke="black" points="4649,-3749.86 4467,-3749.86 4467,-3696.86 4649,-3696.86 4649,-3749.86"/>
<text text-anchor="middle" x="4558" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="4558" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4558" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_1_3_2&#45;&gt;expert_activation_1_3_2 -->
<g id="edge238" class="edge">
<title>expert_linear1_1_3_2&#45;&gt;expert_activation_1_3_2</title>
<path fill="none" stroke="black" d="M4502.28,-3785.73C4510.24,-3776.96 4519.27,-3767.01 4527.71,-3757.72"/>
<polygon fill="black" stroke="black" points="4530.49,-3759.87 4534.62,-3750.11 4525.3,-3755.16 4530.49,-3759.87"/>
</g>
<!-- expert_linear2_1_3_2 -->
<g id="node206" class="node">
<title>expert_linear2_1_3_2</title>
<polygon fill="lightgreen" stroke="black" points="4656.5,-3660.86 4483.5,-3660.86 4483.5,-3607.86 4656.5,-3607.86 4656.5,-3660.86"/>
<text text-anchor="middle" x="4570" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="4570" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4570" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_1_3_2&#45;&gt;expert_linear2_1_3_2 -->
<g id="edge239" class="edge">
<title>expert_activation_1_3_2&#45;&gt;expert_linear2_1_3_2</title>
<path fill="none" stroke="black" d="M4561.54,-3696.73C4562.64,-3688.75 4563.87,-3679.79 4565.05,-3671.24"/>
<polygon fill="black" stroke="black" points="4568.55,-3671.49 4566.45,-3661.11 4561.61,-3670.54 4568.55,-3671.49"/>
</g>
<!-- expert_linear2_1_3_2&#45;&gt;aggregate_1 -->
<g id="edge322" class="edge">
<title>expert_linear2_1_3_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4656.59,-3608.03C4702.22,-3594.68 4759.42,-3577.95 4811.69,-3562.66"/>
<polygon fill="black" stroke="black" points="4812.78,-3565.99 4821.39,-3559.82 4810.81,-3559.27 4812.78,-3565.99"/>
</g>
<!-- expert_linear1_1_3_3 -->
<g id="node208" class="node">
<title>expert_linear1_1_3_3</title>
<polygon fill="lightgreen" stroke="black" points="4818,-3838.86 4636,-3838.86 4636,-3785.86 4818,-3785.86 4818,-3838.86"/>
<text text-anchor="middle" x="4727" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4727" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4727" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- route_to_expert_1_3_3&#45;&gt;expert_linear1_1_3_3 -->
<g id="edge241" class="edge">
<title>route_to_expert_1_3_3&#45;&gt;expert_linear1_1_3_3</title>
<path fill="none" stroke="black" d="M4706.92,-3874.85C4709.73,-3866.25 4712.72,-3857.1 4715.51,-3848.55"/>
<polygon fill="black" stroke="black" points="4718.89,-3849.46 4718.67,-3838.87 4712.24,-3847.29 4718.89,-3849.46"/>
</g>
<!-- expert_activation_1_3_3 -->
<g id="node209" class="node">
<title>expert_activation_1_3_3</title>
<polygon fill="lightgreen" stroke="black" points="4849,-3749.86 4667,-3749.86 4667,-3696.86 4849,-3696.86 4849,-3749.86"/>
<text text-anchor="middle" x="4758" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4758" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4758" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_linear1_1_3_3&#45;&gt;expert_activation_1_3_3 -->
<g id="edge242" class="edge">
<title>expert_linear1_1_3_3&#45;&gt;expert_activation_1_3_3</title>
<path fill="none" stroke="black" d="M4736.13,-3785.73C4739.04,-3777.57 4742.31,-3768.4 4745.41,-3759.68"/>
<polygon fill="black" stroke="black" points="4748.77,-3760.7 4748.82,-3750.11 4742.17,-3758.35 4748.77,-3760.7"/>
</g>
<!-- expert_linear2_1_3_3 -->
<g id="node210" class="node">
<title>expert_linear2_1_3_3</title>
<polygon fill="lightgreen" stroke="black" points="4851.5,-3660.86 4678.5,-3660.86 4678.5,-3607.86 4851.5,-3607.86 4851.5,-3660.86"/>
<text text-anchor="middle" x="4765" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4765" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4765" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- expert_activation_1_3_3&#45;&gt;expert_linear2_1_3_3 -->
<g id="edge243" class="edge">
<title>expert_activation_1_3_3&#45;&gt;expert_linear2_1_3_3</title>
<path fill="none" stroke="black" d="M4760.06,-3696.73C4760.7,-3688.75 4761.43,-3679.79 4762.11,-3671.24"/>
<polygon fill="black" stroke="black" points="4765.61,-3671.36 4762.93,-3661.11 4758.64,-3670.8 4765.61,-3671.36"/>
</g>
<!-- expert_linear2_1_3_3&#45;&gt;aggregate_1 -->
<g id="edge323" class="edge">
<title>expert_linear2_1_3_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4808.79,-3607.61C4824.28,-3598.5 4842.37,-3587.86 4860.51,-3577.19"/>
<polygon fill="black" stroke="black" points="4862.57,-3580.04 4869.41,-3571.96 4859.02,-3574.01 4862.57,-3580.04"/>
</g>
<!-- expert_linear1_1_4_0 -->
<g id="node212" class="node">
<title>expert_linear1_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5049,-3838.86 4867,-3838.86 4867,-3785.86 5049,-3785.86 5049,-3838.86"/>
<text text-anchor="middle" x="4958" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 16 Linear 1</text>
<text text-anchor="middle" x="4958" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4958" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_1_4_0&#45;&gt;expert_linear1_1_4_0 -->
<g id="edge245" class="edge">
<title>route_to_expert_1_4_0&#45;&gt;expert_linear1_1_4_0</title>
<path fill="none" stroke="black" d="M4958,-3874.85C4958,-3866.44 4958,-3857.49 4958,-3849.11"/>
<polygon fill="black" stroke="black" points="4961.5,-3848.87 4958,-3838.87 4954.5,-3848.87 4961.5,-3848.87"/>
</g>
<!-- expert_activation_1_4_0 -->
<g id="node213" class="node">
<title>expert_activation_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5049,-3749.86 4867,-3749.86 4867,-3696.86 5049,-3696.86 5049,-3749.86"/>
<text text-anchor="middle" x="4958" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 16 GELU</text>
<text text-anchor="middle" x="4958" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4958" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_1_4_0&#45;&gt;expert_activation_1_4_0 -->
<g id="edge246" class="edge">
<title>expert_linear1_1_4_0&#45;&gt;expert_activation_1_4_0</title>
<path fill="none" stroke="black" d="M4958,-3785.73C4958,-3777.75 4958,-3768.79 4958,-3760.24"/>
<polygon fill="black" stroke="black" points="4961.5,-3760.11 4958,-3750.11 4954.5,-3760.11 4961.5,-3760.11"/>
</g>
<!-- expert_linear2_1_4_0 -->
<g id="node214" class="node">
<title>expert_linear2_1_4_0</title>
<polygon fill="lightgreen" stroke="black" points="5044.5,-3660.86 4871.5,-3660.86 4871.5,-3607.86 5044.5,-3607.86 5044.5,-3660.86"/>
<text text-anchor="middle" x="4958" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 16 Linear 2</text>
<text text-anchor="middle" x="4958" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4958" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_1_4_0&#45;&gt;expert_linear2_1_4_0 -->
<g id="edge247" class="edge">
<title>expert_activation_1_4_0&#45;&gt;expert_linear2_1_4_0</title>
<path fill="none" stroke="black" d="M4958,-3696.73C4958,-3688.75 4958,-3679.79 4958,-3671.24"/>
<polygon fill="black" stroke="black" points="4961.5,-3671.11 4958,-3661.11 4954.5,-3671.11 4961.5,-3671.11"/>
</g>
<!-- expert_linear2_1_4_0&#45;&gt;aggregate_1 -->
<g id="edge324" class="edge">
<title>expert_linear2_1_4_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M4958,-3607.61C4958,-3599.91 4958,-3591.11 4958,-3582.13"/>
<polygon fill="black" stroke="black" points="4961.5,-3581.96 4958,-3571.96 4954.5,-3581.96 4961.5,-3581.96"/>
</g>
<!-- expert_linear1_1_4_1 -->
<g id="node216" class="node">
<title>expert_linear1_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="5304,-3838.86 5122,-3838.86 5122,-3785.86 5304,-3785.86 5304,-3838.86"/>
<text text-anchor="middle" x="5213" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 17 Linear 1</text>
<text text-anchor="middle" x="5213" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5213" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_1_4_1&#45;&gt;expert_linear1_1_4_1 -->
<g id="edge249" class="edge">
<title>route_to_expert_1_4_1&#45;&gt;expert_linear1_1_4_1</title>
<path fill="none" stroke="black" d="M5218.02,-3874.85C5217.33,-3866.44 5216.6,-3857.49 5215.92,-3849.11"/>
<polygon fill="black" stroke="black" points="5219.39,-3848.55 5215.08,-3838.87 5212.41,-3849.12 5219.39,-3848.55"/>
</g>
<!-- expert_activation_1_4_1 -->
<g id="node217" class="node">
<title>expert_activation_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="5280,-3749.86 5098,-3749.86 5098,-3696.86 5280,-3696.86 5280,-3749.86"/>
<text text-anchor="middle" x="5189" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 17 GELU</text>
<text text-anchor="middle" x="5189" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5189" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_1_4_1&#45;&gt;expert_activation_1_4_1 -->
<g id="edge250" class="edge">
<title>expert_linear1_1_4_1&#45;&gt;expert_activation_1_4_1</title>
<path fill="none" stroke="black" d="M5205.93,-3785.73C5203.7,-3777.66 5201.2,-3768.6 5198.82,-3759.96"/>
<polygon fill="black" stroke="black" points="5202.14,-3758.82 5196.1,-3750.11 5195.39,-3760.68 5202.14,-3758.82"/>
</g>
<!-- expert_linear2_1_4_1 -->
<g id="node218" class="node">
<title>expert_linear2_1_4_1</title>
<polygon fill="lightgreen" stroke="black" points="5255.5,-3660.86 5082.5,-3660.86 5082.5,-3607.86 5255.5,-3607.86 5255.5,-3660.86"/>
<text text-anchor="middle" x="5169" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 17 Linear 2</text>
<text text-anchor="middle" x="5169" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5169" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_1_4_1&#45;&gt;expert_linear2_1_4_1 -->
<g id="edge251" class="edge">
<title>expert_activation_1_4_1&#45;&gt;expert_linear2_1_4_1</title>
<path fill="none" stroke="black" d="M5183.11,-3696.73C5181.25,-3688.66 5179.17,-3679.6 5177.18,-3670.96"/>
<polygon fill="black" stroke="black" points="5180.57,-3670.07 5174.92,-3661.11 5173.75,-3671.64 5180.57,-3670.07"/>
</g>
<!-- expert_linear2_1_4_1&#45;&gt;aggregate_1 -->
<g id="edge325" class="edge">
<title>expert_linear2_1_4_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M5121.38,-3607.75C5104.23,-3598.52 5084.12,-3587.7 5063.99,-3576.87"/>
<polygon fill="black" stroke="black" points="5065.52,-3573.73 5055.06,-3572.07 5062.21,-3579.89 5065.52,-3573.73"/>
</g>
<!-- expert_linear1_1_4_2 -->
<g id="node220" class="node">
<title>expert_linear1_1_4_2</title>
<polygon fill="lightgreen" stroke="black" points="5504,-3838.86 5322,-3838.86 5322,-3785.86 5504,-3785.86 5504,-3838.86"/>
<text text-anchor="middle" x="5413" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 18 Linear 1</text>
<text text-anchor="middle" x="5413" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5413" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_1_4_2&#45;&gt;expert_linear1_1_4_2 -->
<g id="edge253" class="edge">
<title>route_to_expert_1_4_2&#45;&gt;expert_linear1_1_4_2</title>
<path fill="none" stroke="black" d="M5458.17,-3875.69C5451.43,-3866.39 5444.18,-3856.39 5437.52,-3847.19"/>
<polygon fill="black" stroke="black" points="5440.29,-3845.05 5431.58,-3839.01 5434.62,-3849.16 5440.29,-3845.05"/>
</g>
<!-- expert_activation_1_4_2 -->
<g id="node221" class="node">
<title>expert_activation_1_4_2</title>
<polygon fill="lightgreen" stroke="black" points="5496,-3749.86 5314,-3749.86 5314,-3696.86 5496,-3696.86 5496,-3749.86"/>
<text text-anchor="middle" x="5405" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 18 GELU</text>
<text text-anchor="middle" x="5405" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5405" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_1_4_2&#45;&gt;expert_activation_1_4_2 -->
<g id="edge254" class="edge">
<title>expert_linear1_1_4_2&#45;&gt;expert_activation_1_4_2</title>
<path fill="none" stroke="black" d="M5410.64,-3785.73C5409.91,-3777.75 5409.09,-3768.79 5408.3,-3760.24"/>
<polygon fill="black" stroke="black" points="5411.77,-3759.75 5407.37,-3750.11 5404.8,-3760.39 5411.77,-3759.75"/>
</g>
<!-- expert_linear2_1_4_2 -->
<g id="node222" class="node">
<title>expert_linear2_1_4_2</title>
<polygon fill="lightgreen" stroke="black" points="5468.5,-3660.86 5295.5,-3660.86 5295.5,-3607.86 5468.5,-3607.86 5468.5,-3660.86"/>
<text text-anchor="middle" x="5382" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 18 Linear 2</text>
<text text-anchor="middle" x="5382" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5382" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_1_4_2&#45;&gt;expert_linear2_1_4_2 -->
<g id="edge255" class="edge">
<title>expert_activation_1_4_2&#45;&gt;expert_linear2_1_4_2</title>
<path fill="none" stroke="black" d="M5398.22,-3696.73C5396.09,-3688.66 5393.69,-3679.6 5391.41,-3670.96"/>
<polygon fill="black" stroke="black" points="5394.75,-3669.88 5388.81,-3661.11 5387.98,-3671.67 5394.75,-3669.88"/>
</g>
<!-- expert_linear2_1_4_2&#45;&gt;aggregate_1 -->
<g id="edge326" class="edge">
<title>expert_linear2_1_4_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M5295.43,-3610.19C5256.68,-3599.81 5209.21,-3587.1 5162.24,-3574.53"/>
<polygon fill="black" stroke="black" points="5163.11,-3571.14 5152.54,-3571.94 5161.3,-3577.9 5163.11,-3571.14"/>
</g>
<!-- expert_linear1_1_4_3 -->
<g id="node224" class="node">
<title>expert_linear1_1_4_3</title>
<polygon fill="lightgreen" stroke="black" points="5798,-3838.86 5616,-3838.86 5616,-3785.86 5798,-3785.86 5798,-3838.86"/>
<text text-anchor="middle" x="5707" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 19 Linear 1</text>
<text text-anchor="middle" x="5707" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5707" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- route_to_expert_1_4_3&#45;&gt;expert_linear1_1_4_3 -->
<g id="edge257" class="edge">
<title>route_to_expert_1_4_3&#45;&gt;expert_linear1_1_4_3</title>
<path fill="none" stroke="black" d="M5732.22,-3875.13C5728.66,-3866.42 5724.87,-3857.13 5721.33,-3848.46"/>
<polygon fill="black" stroke="black" points="5724.49,-3846.95 5717.47,-3839.02 5718.01,-3849.6 5724.49,-3846.95"/>
</g>
<!-- expert_activation_1_4_3 -->
<g id="node225" class="node">
<title>expert_activation_1_4_3</title>
<polygon fill="lightgreen" stroke="black" points="5767,-3749.86 5585,-3749.86 5585,-3696.86 5767,-3696.86 5767,-3749.86"/>
<text text-anchor="middle" x="5676" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 19 GELU</text>
<text text-anchor="middle" x="5676" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5676" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_linear1_1_4_3&#45;&gt;expert_activation_1_4_3 -->
<g id="edge258" class="edge">
<title>expert_linear1_1_4_3&#45;&gt;expert_activation_1_4_3</title>
<path fill="none" stroke="black" d="M5697.87,-3785.73C5694.96,-3777.57 5691.69,-3768.4 5688.59,-3759.68"/>
<polygon fill="black" stroke="black" points="5691.83,-3758.35 5685.18,-3750.11 5685.23,-3760.7 5691.83,-3758.35"/>
</g>
<!-- expert_linear2_1_4_3 -->
<g id="node226" class="node">
<title>expert_linear2_1_4_3</title>
<polygon fill="lightgreen" stroke="black" points="5722.5,-3660.86 5549.5,-3660.86 5549.5,-3607.86 5722.5,-3607.86 5722.5,-3660.86"/>
<text text-anchor="middle" x="5636" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 19 Linear 2</text>
<text text-anchor="middle" x="5636" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5636" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- expert_activation_1_4_3&#45;&gt;expert_linear2_1_4_3 -->
<g id="edge259" class="edge">
<title>expert_activation_1_4_3&#45;&gt;expert_linear2_1_4_3</title>
<path fill="none" stroke="black" d="M5664.22,-3696.73C5660.42,-3688.48 5656.16,-3679.2 5652.11,-3670.4"/>
<polygon fill="black" stroke="black" points="5655.2,-3668.73 5647.84,-3661.11 5648.84,-3671.66 5655.2,-3668.73"/>
</g>
<!-- expert_linear2_1_4_3&#45;&gt;aggregate_1 -->
<g id="edge327" class="edge">
<title>expert_linear2_1_4_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M5549.44,-3618.87C5453.41,-3602.79 5295.04,-3576.28 5166.33,-3554.74"/>
<polygon fill="black" stroke="black" points="5166.78,-3551.26 5156.33,-3553.06 5165.62,-3558.17 5166.78,-3551.26"/>
</g>
<!-- expert_linear1_1_5_0 -->
<g id="node228" class="node">
<title>expert_linear1_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="6077,-3838.86 5895,-3838.86 5895,-3785.86 6077,-3785.86 6077,-3838.86"/>
<text text-anchor="middle" x="5986" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 20 Linear 1</text>
<text text-anchor="middle" x="5986" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5986" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_1_5_0&#45;&gt;expert_linear1_1_5_0 -->
<g id="edge261" class="edge">
<title>route_to_expert_1_5_0&#45;&gt;expert_linear1_1_5_0</title>
<path fill="none" stroke="black" d="M6001.06,-3874.85C5998.98,-3866.34 5996.76,-3857.3 5994.69,-3848.83"/>
<polygon fill="black" stroke="black" points="5998.03,-3847.75 5992.25,-3838.87 5991.23,-3849.42 5998.03,-3847.75"/>
</g>
<!-- expert_activation_1_5_0 -->
<g id="node229" class="node">
<title>expert_activation_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="6039,-3749.86 5857,-3749.86 5857,-3696.86 6039,-3696.86 6039,-3749.86"/>
<text text-anchor="middle" x="5948" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 20 GELU</text>
<text text-anchor="middle" x="5948" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5948" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_1_5_0&#45;&gt;expert_activation_1_5_0 -->
<g id="edge262" class="edge">
<title>expert_linear1_1_5_0&#45;&gt;expert_activation_1_5_0</title>
<path fill="none" stroke="black" d="M5974.8,-3785.73C5971.2,-3777.48 5967.15,-3768.2 5963.3,-3759.4"/>
<polygon fill="black" stroke="black" points="5966.46,-3757.87 5959.25,-3750.11 5960.04,-3760.67 5966.46,-3757.87"/>
</g>
<!-- expert_linear2_1_5_0 -->
<g id="node230" class="node">
<title>expert_linear2_1_5_0</title>
<polygon fill="lightgreen" stroke="black" points="5988.5,-3660.86 5815.5,-3660.86 5815.5,-3607.86 5988.5,-3607.86 5988.5,-3660.86"/>
<text text-anchor="middle" x="5902" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 20 Linear 2</text>
<text text-anchor="middle" x="5902" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5902" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_1_5_0&#45;&gt;expert_linear2_1_5_0 -->
<g id="edge263" class="edge">
<title>expert_activation_1_5_0&#45;&gt;expert_linear2_1_5_0</title>
<path fill="none" stroke="black" d="M5934.45,-3696.73C5930.04,-3688.39 5925.08,-3679 5920.38,-3670.12"/>
<polygon fill="black" stroke="black" points="5923.38,-3668.31 5915.61,-3661.11 5917.19,-3671.59 5923.38,-3668.31"/>
</g>
<!-- expert_linear2_1_5_0&#45;&gt;aggregate_1 -->
<g id="edge328" class="edge">
<title>expert_linear2_1_5_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M5815.16,-3619.72C5788.51,-3615.7 5759.07,-3611.43 5732,-3607.86 5536.02,-3582.03 5311.51,-3557.01 5154.94,-3540.29"/>
<polygon fill="black" stroke="black" points="5155.04,-3536.78 5144.73,-3539.2 5154.3,-3543.74 5155.04,-3536.78"/>
</g>
<!-- expert_linear1_1_5_1 -->
<g id="node232" class="node">
<title>expert_linear1_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="6348,-3838.86 6166,-3838.86 6166,-3785.86 6348,-3785.86 6348,-3838.86"/>
<text text-anchor="middle" x="6257" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 21 Linear 1</text>
<text text-anchor="middle" x="6257" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6257" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_1_5_1&#45;&gt;expert_linear1_1_5_1 -->
<g id="edge265" class="edge">
<title>route_to_expert_1_5_1&#45;&gt;expert_linear1_1_5_1</title>
<path fill="none" stroke="black" d="M6267.04,-3874.85C6265.65,-3866.34 6264.17,-3857.3 6262.79,-3848.83"/>
<polygon fill="black" stroke="black" points="6266.23,-3848.18 6261.17,-3838.87 6259.32,-3849.3 6266.23,-3848.18"/>
</g>
<!-- expert_activation_1_5_1 -->
<g id="node233" class="node">
<title>expert_activation_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="6313,-3749.86 6131,-3749.86 6131,-3696.86 6313,-3696.86 6313,-3749.86"/>
<text text-anchor="middle" x="6222" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 21 GELU</text>
<text text-anchor="middle" x="6222" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6222" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_1_5_1&#45;&gt;expert_activation_1_5_1 -->
<g id="edge266" class="edge">
<title>expert_linear1_1_5_1&#45;&gt;expert_activation_1_5_1</title>
<path fill="none" stroke="black" d="M6246.69,-3785.73C6243.37,-3777.48 6239.64,-3768.2 6236.1,-3759.4"/>
<polygon fill="black" stroke="black" points="6239.34,-3758.08 6232.36,-3750.11 6232.84,-3760.69 6239.34,-3758.08"/>
</g>
<!-- expert_linear2_1_5_1 -->
<g id="node234" class="node">
<title>expert_linear2_1_5_1</title>
<polygon fill="lightgreen" stroke="black" points="6257.5,-3660.86 6084.5,-3660.86 6084.5,-3607.86 6257.5,-3607.86 6257.5,-3660.86"/>
<text text-anchor="middle" x="6171" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 21 Linear 2</text>
<text text-anchor="middle" x="6171" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6171" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_1_5_1&#45;&gt;expert_linear2_1_5_1 -->
<g id="edge267" class="edge">
<title>expert_activation_1_5_1&#45;&gt;expert_linear2_1_5_1</title>
<path fill="none" stroke="black" d="M6206.97,-3696.73C6202.04,-3688.31 6196.47,-3678.81 6191.21,-3669.84"/>
<polygon fill="black" stroke="black" points="6194.17,-3667.97 6186.09,-3661.11 6188.13,-3671.51 6194.17,-3667.97"/>
</g>
<!-- expert_linear2_1_5_1&#45;&gt;aggregate_1 -->
<g id="edge329" class="edge">
<title>expert_linear2_1_5_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M6084.46,-3619.53C6056.87,-3615.41 6026.2,-3611.13 5998,-3607.86 5702.25,-3573.58 5357.72,-3547.06 5148.86,-3532.45"/>
<polygon fill="black" stroke="black" points="5148.92,-3528.95 5138.7,-3531.74 5148.44,-3535.93 5148.92,-3528.95"/>
</g>
<!-- expert_linear1_1_5_2 -->
<g id="node236" class="node">
<title>expert_linear1_1_5_2</title>
<polygon fill="lightgreen" stroke="black" points="6615,-3838.86 6433,-3838.86 6433,-3785.86 6615,-3785.86 6615,-3838.86"/>
<text text-anchor="middle" x="6524" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 22 Linear 1</text>
<text text-anchor="middle" x="6524" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6524" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_1_5_2&#45;&gt;expert_linear1_1_5_2 -->
<g id="edge269" class="edge">
<title>route_to_expert_1_5_2&#45;&gt;expert_linear1_1_5_2</title>
<path fill="none" stroke="black" d="M6531.53,-3874.85C6530.49,-3866.34 6529.38,-3857.3 6528.34,-3848.83"/>
<polygon fill="black" stroke="black" points="6531.81,-3848.37 6527.12,-3838.87 6524.87,-3849.22 6531.81,-3848.37"/>
</g>
<!-- expert_activation_1_5_2 -->
<g id="node237" class="node">
<title>expert_activation_1_5_2</title>
<polygon fill="lightgreen" stroke="black" points="6582,-3749.86 6400,-3749.86 6400,-3696.86 6582,-3696.86 6582,-3749.86"/>
<text text-anchor="middle" x="6491" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 22 GELU</text>
<text text-anchor="middle" x="6491" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6491" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_1_5_2&#45;&gt;expert_activation_1_5_2 -->
<g id="edge270" class="edge">
<title>expert_linear1_1_5_2&#45;&gt;expert_activation_1_5_2</title>
<path fill="none" stroke="black" d="M6514.28,-3785.73C6511.18,-3777.57 6507.7,-3768.4 6504.4,-3759.68"/>
<polygon fill="black" stroke="black" points="6507.59,-3758.22 6500.77,-3750.11 6501.04,-3760.7 6507.59,-3758.22"/>
</g>
<!-- expert_linear2_1_5_2 -->
<g id="node238" class="node">
<title>expert_linear2_1_5_2</title>
<polygon fill="lightgreen" stroke="black" points="6525.5,-3660.86 6352.5,-3660.86 6352.5,-3607.86 6525.5,-3607.86 6525.5,-3660.86"/>
<text text-anchor="middle" x="6439" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 22 Linear 2</text>
<text text-anchor="middle" x="6439" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6439" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_1_5_2&#45;&gt;expert_linear2_1_5_2 -->
<g id="edge271" class="edge">
<title>expert_activation_1_5_2&#45;&gt;expert_linear2_1_5_2</title>
<path fill="none" stroke="black" d="M6475.68,-3696.73C6470.65,-3688.31 6464.97,-3678.81 6459.61,-3669.84"/>
<polygon fill="black" stroke="black" points="6462.53,-3667.9 6454.39,-3661.11 6456.52,-3671.49 6462.53,-3667.9"/>
</g>
<!-- expert_linear2_1_5_2&#45;&gt;aggregate_1 -->
<g id="edge330" class="edge">
<title>expert_linear2_1_5_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M6352.11,-3619.1C6324.92,-3615 6294.76,-3610.85 6267,-3607.86 5868.51,-3565 5399.39,-3539.48 5145,-3527.72"/>
<polygon fill="black" stroke="black" points="5145.07,-3524.22 5134.92,-3527.25 5144.75,-3531.21 5145.07,-3524.22"/>
</g>
<!-- expert_linear1_1_5_3 -->
<g id="node240" class="node">
<title>expert_linear1_1_5_3</title>
<polygon fill="lightgreen" stroke="black" points="6880,-3838.86 6698,-3838.86 6698,-3785.86 6880,-3785.86 6880,-3838.86"/>
<text text-anchor="middle" x="6789" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 23 Linear 1</text>
<text text-anchor="middle" x="6789" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6789" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- route_to_expert_1_5_3&#45;&gt;expert_linear1_1_5_3 -->
<g id="edge273" class="edge">
<title>route_to_expert_1_5_3&#45;&gt;expert_linear1_1_5_3</title>
<path fill="none" stroke="black" d="M6795.28,-3874.85C6794.41,-3866.34 6793.48,-3857.3 6792.62,-3848.83"/>
<polygon fill="black" stroke="black" points="6796.1,-3848.46 6791.6,-3838.87 6789.14,-3849.17 6796.1,-3848.46"/>
</g>
<!-- expert_activation_1_5_3 -->
<g id="node241" class="node">
<title>expert_activation_1_5_3</title>
<polygon fill="lightgreen" stroke="black" points="6848,-3749.86 6666,-3749.86 6666,-3696.86 6848,-3696.86 6848,-3749.86"/>
<text text-anchor="middle" x="6757" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 23 GELU</text>
<text text-anchor="middle" x="6757" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6757" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_linear1_1_5_3&#45;&gt;expert_activation_1_5_3 -->
<g id="edge274" class="edge">
<title>expert_linear1_1_5_3&#45;&gt;expert_activation_1_5_3</title>
<path fill="none" stroke="black" d="M6779.57,-3785.73C6776.57,-3777.57 6773.2,-3768.4 6769.99,-3759.68"/>
<polygon fill="black" stroke="black" points="6773.21,-3758.29 6766.47,-3750.11 6766.64,-3760.7 6773.21,-3758.29"/>
</g>
<!-- expert_linear2_1_5_3 -->
<g id="node242" class="node">
<title>expert_linear2_1_5_3</title>
<polygon fill="lightgreen" stroke="black" points="6791.5,-3660.86 6618.5,-3660.86 6618.5,-3607.86 6791.5,-3607.86 6791.5,-3660.86"/>
<text text-anchor="middle" x="6705" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 23 Linear 2</text>
<text text-anchor="middle" x="6705" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6705" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- expert_activation_1_5_3&#45;&gt;expert_linear2_1_5_3 -->
<g id="edge275" class="edge">
<title>expert_activation_1_5_3&#45;&gt;expert_linear2_1_5_3</title>
<path fill="none" stroke="black" d="M6741.68,-3696.73C6736.65,-3688.31 6730.97,-3678.81 6725.61,-3669.84"/>
<polygon fill="black" stroke="black" points="6728.53,-3667.9 6720.39,-3661.11 6722.52,-3671.49 6728.53,-3667.9"/>
</g>
<!-- expert_linear2_1_5_3&#45;&gt;aggregate_1 -->
<g id="edge331" class="edge">
<title>expert_linear2_1_5_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M6618.28,-3618.76C6591.63,-3614.7 6562.16,-3610.65 6535,-3607.86 6033.08,-3556.32 5437.96,-3533.41 5142.93,-3524.6"/>
<polygon fill="black" stroke="black" points="5142.66,-3521.09 5132.56,-3524.29 5142.45,-3528.08 5142.66,-3521.09"/>
</g>
<!-- expert_linear1_1_6_0 -->
<g id="node244" class="node">
<title>expert_linear1_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="7144,-3838.86 6962,-3838.86 6962,-3785.86 7144,-3785.86 7144,-3838.86"/>
<text text-anchor="middle" x="7053" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 24 Linear 1</text>
<text text-anchor="middle" x="7053" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7053" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_1_6_0&#45;&gt;expert_linear1_1_6_0 -->
<g id="edge277" class="edge">
<title>route_to_expert_1_6_0&#45;&gt;expert_linear1_1_6_0</title>
<path fill="none" stroke="black" d="M7058.65,-3874.85C7057.87,-3866.34 7057.04,-3857.3 7056.26,-3848.83"/>
<polygon fill="black" stroke="black" points="7059.74,-3848.51 7055.34,-3838.87 7052.77,-3849.15 7059.74,-3848.51"/>
</g>
<!-- expert_activation_1_6_0 -->
<g id="node245" class="node">
<title>expert_activation_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="7112,-3749.86 6930,-3749.86 6930,-3696.86 7112,-3696.86 7112,-3749.86"/>
<text text-anchor="middle" x="7021" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 24 GELU</text>
<text text-anchor="middle" x="7021" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7021" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_1_6_0&#45;&gt;expert_activation_1_6_0 -->
<g id="edge278" class="edge">
<title>expert_linear1_1_6_0&#45;&gt;expert_activation_1_6_0</title>
<path fill="none" stroke="black" d="M7043.57,-3785.73C7040.57,-3777.57 7037.2,-3768.4 7033.99,-3759.68"/>
<polygon fill="black" stroke="black" points="7037.21,-3758.29 7030.47,-3750.11 7030.64,-3760.7 7037.21,-3758.29"/>
</g>
<!-- expert_linear2_1_6_0 -->
<g id="node246" class="node">
<title>expert_linear2_1_6_0</title>
<polygon fill="lightgreen" stroke="black" points="7056.5,-3660.86 6883.5,-3660.86 6883.5,-3607.86 7056.5,-3607.86 7056.5,-3660.86"/>
<text text-anchor="middle" x="6970" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 24 Linear 2</text>
<text text-anchor="middle" x="6970" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6970" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_1_6_0&#45;&gt;expert_linear2_1_6_0 -->
<g id="edge279" class="edge">
<title>expert_activation_1_6_0&#45;&gt;expert_linear2_1_6_0</title>
<path fill="none" stroke="black" d="M7005.97,-3696.73C7001.04,-3688.31 6995.47,-3678.81 6990.21,-3669.84"/>
<polygon fill="black" stroke="black" points="6993.17,-3667.97 6985.09,-3661.11 6987.13,-3671.51 6993.17,-3667.97"/>
</g>
<!-- expert_linear2_1_6_0&#45;&gt;aggregate_1 -->
<g id="edge332" class="edge">
<title>expert_linear2_1_6_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M6883.37,-3618.55C6856.99,-3614.51 6827.87,-3610.52 6801,-3607.86 6195.04,-3547.84 5472.8,-3528.43 5141.08,-3522.42"/>
<polygon fill="black" stroke="black" points="5140.95,-3518.92 5130.89,-3522.24 5140.83,-3525.92 5140.95,-3518.92"/>
</g>
<!-- expert_linear1_1_6_1 -->
<g id="node248" class="node">
<title>expert_linear1_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="7353,-3838.86 7171,-3838.86 7171,-3785.86 7353,-3785.86 7353,-3838.86"/>
<text text-anchor="middle" x="7262" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 25 Linear 1</text>
<text text-anchor="middle" x="7262" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7262" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_1_6_1&#45;&gt;expert_linear1_1_6_1 -->
<g id="edge281" class="edge">
<title>route_to_expert_1_6_1&#45;&gt;expert_linear1_1_6_1</title>
<path fill="none" stroke="black" d="M7301.9,-3875.41C7295.99,-3866.22 7289.66,-3856.37 7283.82,-3847.29"/>
<polygon fill="black" stroke="black" points="7286.75,-3845.38 7278.4,-3838.86 7280.86,-3849.16 7286.75,-3845.38"/>
</g>
<!-- expert_activation_1_6_1 -->
<g id="node249" class="node">
<title>expert_activation_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="7345,-3749.86 7163,-3749.86 7163,-3696.86 7345,-3696.86 7345,-3749.86"/>
<text text-anchor="middle" x="7254" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 25 GELU</text>
<text text-anchor="middle" x="7254" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7254" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_1_6_1&#45;&gt;expert_activation_1_6_1 -->
<g id="edge282" class="edge">
<title>expert_linear1_1_6_1&#45;&gt;expert_activation_1_6_1</title>
<path fill="none" stroke="black" d="M7259.64,-3785.73C7258.91,-3777.75 7258.09,-3768.79 7257.3,-3760.24"/>
<polygon fill="black" stroke="black" points="7260.77,-3759.75 7256.37,-3750.11 7253.8,-3760.39 7260.77,-3759.75"/>
</g>
<!-- expert_linear2_1_6_1 -->
<g id="node250" class="node">
<title>expert_linear2_1_6_1</title>
<polygon fill="lightgreen" stroke="black" points="7297.5,-3660.86 7124.5,-3660.86 7124.5,-3607.86 7297.5,-3607.86 7297.5,-3660.86"/>
<text text-anchor="middle" x="7211" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 25 Linear 2</text>
<text text-anchor="middle" x="7211" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7211" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_1_6_1&#45;&gt;expert_linear2_1_6_1 -->
<g id="edge283" class="edge">
<title>expert_activation_1_6_1&#45;&gt;expert_linear2_1_6_1</title>
<path fill="none" stroke="black" d="M7241.33,-3696.73C7237.21,-3688.39 7232.57,-3679 7228.18,-3670.12"/>
<polygon fill="black" stroke="black" points="7231.3,-3668.52 7223.73,-3661.11 7225.02,-3671.63 7231.3,-3668.52"/>
</g>
<!-- expert_linear2_1_6_1&#45;&gt;aggregate_1 -->
<g id="edge333" class="edge">
<title>expert_linear2_1_6_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M7124.24,-3616.17C7105.12,-3612.93 7084.93,-3609.91 7066,-3607.86 6355.71,-3530.92 5504.07,-3520.14 5138.8,-3519.37"/>
<polygon fill="black" stroke="black" points="5138.67,-3515.87 5128.66,-3519.35 5138.66,-3522.87 5138.67,-3515.87"/>
</g>
<!-- expert_linear1_1_6_2 -->
<g id="node252" class="node">
<title>expert_linear1_1_6_2</title>
<polygon fill="lightgreen" stroke="black" points="7616,-3838.86 7434,-3838.86 7434,-3785.86 7616,-3785.86 7616,-3838.86"/>
<text text-anchor="middle" x="7525" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 26 Linear 1</text>
<text text-anchor="middle" x="7525" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7525" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_1_6_2&#45;&gt;expert_linear1_1_6_2 -->
<g id="edge285" class="edge">
<title>route_to_expert_1_6_2&#45;&gt;expert_linear1_1_6_2</title>
<path fill="none" stroke="black" d="M7564.9,-3875.41C7558.99,-3866.22 7552.66,-3856.37 7546.82,-3847.29"/>
<polygon fill="black" stroke="black" points="7549.75,-3845.38 7541.4,-3838.86 7543.86,-3849.16 7549.75,-3845.38"/>
</g>
<!-- expert_activation_1_6_2 -->
<g id="node253" class="node">
<title>expert_activation_1_6_2</title>
<polygon fill="lightgreen" stroke="black" points="7585,-3749.86 7403,-3749.86 7403,-3696.86 7585,-3696.86 7585,-3749.86"/>
<text text-anchor="middle" x="7494" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 26 GELU</text>
<text text-anchor="middle" x="7494" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7494" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_1_6_2&#45;&gt;expert_activation_1_6_2 -->
<g id="edge286" class="edge">
<title>expert_linear1_1_6_2&#45;&gt;expert_activation_1_6_2</title>
<path fill="none" stroke="black" d="M7515.87,-3785.73C7512.96,-3777.57 7509.69,-3768.4 7506.59,-3759.68"/>
<polygon fill="black" stroke="black" points="7509.83,-3758.35 7503.18,-3750.11 7503.23,-3760.7 7509.83,-3758.35"/>
</g>
<!-- expert_linear2_1_6_2 -->
<g id="node254" class="node">
<title>expert_linear2_1_6_2</title>
<polygon fill="lightgreen" stroke="black" points="7519.5,-3660.86 7346.5,-3660.86 7346.5,-3607.86 7519.5,-3607.86 7519.5,-3660.86"/>
<text text-anchor="middle" x="7433" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 26 Linear 2</text>
<text text-anchor="middle" x="7433" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7433" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_1_6_2&#45;&gt;expert_linear2_1_6_2 -->
<g id="edge287" class="edge">
<title>expert_activation_1_6_2&#45;&gt;expert_linear2_1_6_2</title>
<path fill="none" stroke="black" d="M7476.03,-3696.73C7470.06,-3688.22 7463.32,-3678.61 7456.98,-3669.56"/>
<polygon fill="black" stroke="black" points="7459.66,-3667.29 7451.05,-3661.11 7453.93,-3671.31 7459.66,-3667.29"/>
</g>
<!-- expert_linear2_1_6_2&#45;&gt;aggregate_1 -->
<g id="edge334" class="edge">
<title>expert_linear2_1_6_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M7346.2,-3613.88C7333.12,-3611.5 7319.74,-3609.38 7307,-3607.86 6888.79,-3558.04 5617.97,-3531.35 5141.25,-3522.88"/>
<polygon fill="black" stroke="black" points="5141.23,-3519.38 5131.17,-3522.7 5141.11,-3526.38 5141.23,-3519.38"/>
</g>
<!-- expert_linear1_1_6_3 -->
<g id="node256" class="node">
<title>expert_linear1_1_6_3</title>
<polygon fill="lightgreen" stroke="black" points="7879,-3838.86 7697,-3838.86 7697,-3785.86 7879,-3785.86 7879,-3838.86"/>
<text text-anchor="middle" x="7788" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 27 Linear 1</text>
<text text-anchor="middle" x="7788" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7788" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- route_to_expert_1_6_3&#45;&gt;expert_linear1_1_6_3 -->
<g id="edge289" class="edge">
<title>route_to_expert_1_6_3&#45;&gt;expert_linear1_1_6_3</title>
<path fill="none" stroke="black" d="M7827.9,-3875.41C7821.99,-3866.22 7815.66,-3856.37 7809.82,-3847.29"/>
<polygon fill="black" stroke="black" points="7812.75,-3845.38 7804.4,-3838.86 7806.86,-3849.16 7812.75,-3845.38"/>
</g>
<!-- expert_activation_1_6_3 -->
<g id="node257" class="node">
<title>expert_activation_1_6_3</title>
<polygon fill="lightgreen" stroke="black" points="7848,-3749.86 7666,-3749.86 7666,-3696.86 7848,-3696.86 7848,-3749.86"/>
<text text-anchor="middle" x="7757" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 27 GELU</text>
<text text-anchor="middle" x="7757" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7757" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_linear1_1_6_3&#45;&gt;expert_activation_1_6_3 -->
<g id="edge290" class="edge">
<title>expert_linear1_1_6_3&#45;&gt;expert_activation_1_6_3</title>
<path fill="none" stroke="black" d="M7778.87,-3785.73C7775.96,-3777.57 7772.69,-3768.4 7769.59,-3759.68"/>
<polygon fill="black" stroke="black" points="7772.83,-3758.35 7766.18,-3750.11 7766.23,-3760.7 7772.83,-3758.35"/>
</g>
<!-- expert_linear2_1_6_3 -->
<g id="node258" class="node">
<title>expert_linear2_1_6_3</title>
<polygon fill="lightgreen" stroke="black" points="7776.5,-3660.86 7603.5,-3660.86 7603.5,-3607.86 7776.5,-3607.86 7776.5,-3660.86"/>
<text text-anchor="middle" x="7690" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 27 Linear 2</text>
<text text-anchor="middle" x="7690" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7690" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- expert_activation_1_6_3&#45;&gt;expert_linear2_1_6_3 -->
<g id="edge291" class="edge">
<title>expert_activation_1_6_3&#45;&gt;expert_linear2_1_6_3</title>
<path fill="none" stroke="black" d="M7737.26,-3696.73C7730.64,-3688.13 7723.15,-3678.41 7716.12,-3669.28"/>
<polygon fill="black" stroke="black" points="7718.7,-3666.9 7709.83,-3661.11 7713.16,-3671.17 7718.7,-3666.9"/>
</g>
<!-- expert_linear2_1_6_3&#45;&gt;aggregate_1 -->
<g id="edge335" class="edge">
<title>expert_linear2_1_6_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M7603.35,-3617.63C7579.35,-3613.82 7553.23,-3610.18 7529,-3607.86 7065.25,-3563.37 5649.86,-3532.95 5141.9,-3523.21"/>
<polygon fill="black" stroke="black" points="5141.61,-3519.71 5131.54,-3523.02 5141.47,-3526.71 5141.61,-3519.71"/>
</g>
<!-- expert_linear1_1_7_0 -->
<g id="node260" class="node">
<title>expert_linear1_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="8142,-3838.86 7960,-3838.86 7960,-3785.86 8142,-3785.86 8142,-3838.86"/>
<text text-anchor="middle" x="8051" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 28 Linear 1</text>
<text text-anchor="middle" x="8051" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8051" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_1_7_0&#45;&gt;expert_linear1_1_7_0 -->
<g id="edge293" class="edge">
<title>route_to_expert_1_7_0&#45;&gt;expert_linear1_1_7_0</title>
<path fill="none" stroke="black" d="M8090.9,-3875.41C8084.99,-3866.22 8078.66,-3856.37 8072.82,-3847.29"/>
<polygon fill="black" stroke="black" points="8075.75,-3845.38 8067.4,-3838.86 8069.86,-3849.16 8075.75,-3845.38"/>
</g>
<!-- expert_activation_1_7_0 -->
<g id="node261" class="node">
<title>expert_activation_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="8111,-3749.86 7929,-3749.86 7929,-3696.86 8111,-3696.86 8111,-3749.86"/>
<text text-anchor="middle" x="8020" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 28 GELU</text>
<text text-anchor="middle" x="8020" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8020" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_1_7_0&#45;&gt;expert_activation_1_7_0 -->
<g id="edge294" class="edge">
<title>expert_linear1_1_7_0&#45;&gt;expert_activation_1_7_0</title>
<path fill="none" stroke="black" d="M8041.87,-3785.73C8038.96,-3777.57 8035.69,-3768.4 8032.59,-3759.68"/>
<polygon fill="black" stroke="black" points="8035.83,-3758.35 8029.18,-3750.11 8029.23,-3760.7 8035.83,-3758.35"/>
</g>
<!-- expert_linear2_1_7_0 -->
<g id="node262" class="node">
<title>expert_linear2_1_7_0</title>
<polygon fill="lightgreen" stroke="black" points="8037.5,-3660.86 7864.5,-3660.86 7864.5,-3607.86 8037.5,-3607.86 8037.5,-3660.86"/>
<text text-anchor="middle" x="7951" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 28 Linear 2</text>
<text text-anchor="middle" x="7951" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7951" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_1_7_0&#45;&gt;expert_linear2_1_7_0 -->
<g id="edge295" class="edge">
<title>expert_activation_1_7_0&#45;&gt;expert_linear2_1_7_0</title>
<path fill="none" stroke="black" d="M7999.67,-3696.73C7992.78,-3688.04 7984.98,-3678.21 7977.68,-3669"/>
<polygon fill="black" stroke="black" points="7980.38,-3666.77 7971.42,-3661.11 7974.89,-3671.12 7980.38,-3666.77"/>
</g>
<!-- expert_linear2_1_7_0&#45;&gt;aggregate_1 -->
<g id="edge336" class="edge">
<title>expert_linear2_1_7_0&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M7864.33,-3617.93C7839.15,-3614 7811.54,-3610.22 7786,-3607.86 7269.91,-3560.13 5683.02,-3531.29 5141.39,-3522.63"/>
<polygon fill="black" stroke="black" points="5141.19,-3519.13 5131.13,-3522.47 5141.08,-3526.13 5141.19,-3519.13"/>
</g>
<!-- expert_linear1_1_7_1 -->
<g id="node264" class="node">
<title>expert_linear1_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="8405,-3838.86 8223,-3838.86 8223,-3785.86 8405,-3785.86 8405,-3838.86"/>
<text text-anchor="middle" x="8314" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 29 Linear 1</text>
<text text-anchor="middle" x="8314" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8314" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_1_7_1&#45;&gt;expert_linear1_1_7_1 -->
<g id="edge297" class="edge">
<title>route_to_expert_1_7_1&#45;&gt;expert_linear1_1_7_1</title>
<path fill="none" stroke="black" d="M8353.9,-3875.41C8347.99,-3866.22 8341.66,-3856.37 8335.82,-3847.29"/>
<polygon fill="black" stroke="black" points="8338.75,-3845.38 8330.4,-3838.86 8332.86,-3849.16 8338.75,-3845.38"/>
</g>
<!-- expert_activation_1_7_1 -->
<g id="node265" class="node">
<title>expert_activation_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="8375,-3749.86 8193,-3749.86 8193,-3696.86 8375,-3696.86 8375,-3749.86"/>
<text text-anchor="middle" x="8284" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 29 GELU</text>
<text text-anchor="middle" x="8284" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8284" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_1_7_1&#45;&gt;expert_activation_1_7_1 -->
<g id="edge298" class="edge">
<title>expert_linear1_1_7_1&#45;&gt;expert_activation_1_7_1</title>
<path fill="none" stroke="black" d="M8305.16,-3785.73C8302.35,-3777.57 8299.19,-3768.4 8296.18,-3759.68"/>
<polygon fill="black" stroke="black" points="8299.45,-3758.42 8292.88,-3750.11 8292.83,-3760.7 8299.45,-3758.42"/>
</g>
<!-- expert_linear2_1_7_1 -->
<g id="node266" class="node">
<title>expert_linear2_1_7_1</title>
<polygon fill="lightgreen" stroke="black" points="8298.5,-3660.86 8125.5,-3660.86 8125.5,-3607.86 8298.5,-3607.86 8298.5,-3660.86"/>
<text text-anchor="middle" x="8212" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 29 Linear 2</text>
<text text-anchor="middle" x="8212" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8212" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_1_7_1&#45;&gt;expert_linear2_1_7_1 -->
<g id="edge299" class="edge">
<title>expert_activation_1_7_1&#45;&gt;expert_linear2_1_7_1</title>
<path fill="none" stroke="black" d="M8262.79,-3696.73C8255.6,-3688.04 8247.46,-3678.21 8239.84,-3669"/>
<polygon fill="black" stroke="black" points="8242.38,-3666.58 8233.31,-3661.11 8236.99,-3671.05 8242.38,-3666.58"/>
</g>
<!-- expert_linear2_1_7_1&#45;&gt;aggregate_1 -->
<g id="edge337" class="edge">
<title>expert_linear2_1_7_1&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M8125.33,-3617.89C8100.15,-3613.95 8072.55,-3610.19 8047,-3607.86 7477.5,-3555.95 5714.41,-3529.47 5140.55,-3522.07"/>
<polygon fill="black" stroke="black" points="5140.57,-3518.57 5130.53,-3521.94 5140.48,-3525.56 5140.57,-3518.57"/>
</g>
<!-- expert_linear1_1_7_2 -->
<g id="node268" class="node">
<title>expert_linear1_1_7_2</title>
<polygon fill="lightgreen" stroke="black" points="8688,-3838.86 8506,-3838.86 8506,-3785.86 8688,-3785.86 8688,-3838.86"/>
<text text-anchor="middle" x="8597" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 30 Linear 1</text>
<text text-anchor="middle" x="8597" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8597" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_1_7_2&#45;&gt;expert_linear1_1_7_2 -->
<g id="edge301" class="edge">
<title>route_to_expert_1_7_2&#45;&gt;expert_linear1_1_7_2</title>
<path fill="none" stroke="black" d="M8624.11,-3875.13C8620.25,-3866.33 8616.12,-3856.93 8612.28,-3848.18"/>
<polygon fill="black" stroke="black" points="8615.48,-3846.77 8608.26,-3839.02 8609.07,-3849.58 8615.48,-3846.77"/>
</g>
<!-- expert_activation_1_7_2 -->
<g id="node269" class="node">
<title>expert_activation_1_7_2</title>
<polygon fill="lightgreen" stroke="black" points="8614,-3749.86 8432,-3749.86 8432,-3696.86 8614,-3696.86 8614,-3749.86"/>
<text text-anchor="middle" x="8523" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 30 GELU</text>
<text text-anchor="middle" x="8523" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8523" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_1_7_2&#45;&gt;expert_activation_1_7_2 -->
<g id="edge302" class="edge">
<title>expert_linear1_1_7_2&#45;&gt;expert_activation_1_7_2</title>
<path fill="none" stroke="black" d="M8575.2,-3785.73C8567.81,-3777.04 8559.45,-3767.21 8551.61,-3758"/>
<polygon fill="black" stroke="black" points="8554.05,-3755.46 8544.9,-3750.11 8548.72,-3759.99 8554.05,-3755.46"/>
</g>
<!-- expert_linear2_1_7_2 -->
<g id="node270" class="node">
<title>expert_linear2_1_7_2</title>
<polygon fill="lightgreen" stroke="black" points="8548.5,-3660.86 8375.5,-3660.86 8375.5,-3607.86 8548.5,-3607.86 8548.5,-3660.86"/>
<text text-anchor="middle" x="8462" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 30 Linear 2</text>
<text text-anchor="middle" x="8462" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8462" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_1_7_2&#45;&gt;expert_linear2_1_7_2 -->
<g id="edge303" class="edge">
<title>expert_activation_1_7_2&#45;&gt;expert_linear2_1_7_2</title>
<path fill="none" stroke="black" d="M8505.03,-3696.73C8499.06,-3688.22 8492.32,-3678.61 8485.98,-3669.56"/>
<polygon fill="black" stroke="black" points="8488.66,-3667.29 8480.05,-3661.11 8482.93,-3671.31 8488.66,-3667.29"/>
</g>
<!-- expert_linear2_1_7_2&#45;&gt;aggregate_1 -->
<g id="edge338" class="edge">
<title>expert_linear2_1_7_2&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M8375.13,-3616.83C8353.29,-3613.26 8329.85,-3609.95 8308,-3607.86 7685.29,-3548.41 5745.05,-3526.74 5140.05,-3521.33"/>
<polygon fill="black" stroke="black" points="5139.96,-3517.83 5129.93,-3521.24 5139.9,-3524.83 5139.96,-3517.83"/>
</g>
<!-- expert_linear1_1_7_3 -->
<g id="node272" class="node">
<title>expert_linear1_1_7_3</title>
<polygon fill="lightgreen" stroke="black" points="8963,-3838.86 8781,-3838.86 8781,-3785.86 8963,-3785.86 8963,-3838.86"/>
<text text-anchor="middle" x="8872" y="-3823.66" font-family="Times,serif" font-size="14.00">Expert 31 Linear 1</text>
<text text-anchor="middle" x="8872" y="-3808.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8872" y="-3793.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- route_to_expert_1_7_3&#45;&gt;expert_linear1_1_7_3 -->
<g id="edge305" class="edge">
<title>route_to_expert_1_7_3&#45;&gt;expert_linear1_1_7_3</title>
<path fill="none" stroke="black" d="M8891.46,-3874.85C8888.73,-3866.25 8885.84,-3857.1 8883.13,-3848.55"/>
<polygon fill="black" stroke="black" points="8886.43,-3847.35 8880.07,-3838.87 8879.75,-3849.46 8886.43,-3847.35"/>
</g>
<!-- expert_activation_1_7_3 -->
<g id="node273" class="node">
<title>expert_activation_1_7_3</title>
<polygon fill="lightgreen" stroke="black" points="8893,-3749.86 8711,-3749.86 8711,-3696.86 8893,-3696.86 8893,-3749.86"/>
<text text-anchor="middle" x="8802" y="-3734.66" font-family="Times,serif" font-size="14.00">Expert 31 GELU</text>
<text text-anchor="middle" x="8802" y="-3719.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8802" y="-3704.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_linear1_1_7_3&#45;&gt;expert_activation_1_7_3 -->
<g id="edge306" class="edge">
<title>expert_linear1_1_7_3&#45;&gt;expert_activation_1_7_3</title>
<path fill="none" stroke="black" d="M8851.38,-3785.73C8844.39,-3777.04 8836.48,-3767.21 8829.07,-3758"/>
<polygon fill="black" stroke="black" points="8831.71,-3755.71 8822.72,-3750.11 8826.26,-3760.09 8831.71,-3755.71"/>
</g>
<!-- expert_linear2_1_7_3 -->
<g id="node274" class="node">
<title>expert_linear2_1_7_3</title>
<polygon fill="lightgreen" stroke="black" points="8813.5,-3660.86 8640.5,-3660.86 8640.5,-3607.86 8813.5,-3607.86 8813.5,-3660.86"/>
<text text-anchor="middle" x="8727" y="-3645.66" font-family="Times,serif" font-size="14.00">Expert 31 Linear 2</text>
<text text-anchor="middle" x="8727" y="-3630.66" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8727" y="-3615.66" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- expert_activation_1_7_3&#45;&gt;expert_linear2_1_7_3 -->
<g id="edge307" class="edge">
<title>expert_activation_1_7_3&#45;&gt;expert_linear2_1_7_3</title>
<path fill="none" stroke="black" d="M8779.9,-3696.73C8772.34,-3687.96 8763.77,-3678.01 8755.76,-3668.72"/>
<polygon fill="black" stroke="black" points="8758.38,-3666.4 8749.2,-3661.11 8753.08,-3670.97 8758.38,-3666.4"/>
</g>
<!-- expert_linear2_1_7_3&#45;&gt;aggregate_1 -->
<g id="edge339" class="edge">
<title>expert_linear2_1_7_3&#45;&gt;aggregate_1</title>
<path fill="none" stroke="black" d="M8640.41,-3618.16C8614.03,-3614.11 8584.9,-3610.21 8558,-3607.86 7883.65,-3548.98 5774.22,-3526.74 5140.09,-3521.29"/>
<polygon fill="black" stroke="black" points="5139.97,-3517.79 5129.94,-3521.2 5139.91,-3524.79 5139.97,-3517.79"/>
</g>
<!-- aggregate_1&#45;&gt;moe_residual_1 -->
<g id="edge341" class="edge">
<title>aggregate_1&#45;&gt;moe_residual_1</title>
<path fill="none" stroke="black" d="M5116.89,-3505.13C5452.39,-3478.24 6228.98,-3416.01 6555.79,-3389.82"/>
<polygon fill="black" stroke="black" points="6556.12,-3393.3 6565.8,-3389.01 6555.56,-3386.32 6556.12,-3393.3"/>
</g>
<!-- ln2_1 -->
<g id="node277" class="node">
<title>ln2_1</title>
<polygon fill="lightgreen" stroke="black" points="6794.5,-3287.86 6615.5,-3287.86 6615.5,-3234.86 6794.5,-3234.86 6794.5,-3287.86"/>
<text text-anchor="middle" x="6705" y="-3272.66" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="6705" y="-3257.66" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6705" y="-3242.66" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- moe_residual_1&#45;&gt;ln2_1 -->
<g id="edge342" class="edge">
<title>moe_residual_1&#45;&gt;ln2_1</title>
<path fill="none" stroke="black" d="M6705,-3323.76C6705,-3315.09 6705,-3306.27 6705,-3298.13"/>
<polygon fill="black" stroke="black" points="6708.5,-3297.87 6705,-3287.87 6701.5,-3297.87 6708.5,-3297.87"/>
</g>
<!-- pipeline_comm_0 -->
<g id="node278" class="node">
<title>pipeline_comm_0</title>
<ellipse fill="lightblue" stroke="black" cx="6705" cy="-3135.38" rx="135.53" ry="37.45"/>
<text text-anchor="middle" x="6705" y="-3146.68" font-family="Times,serif" font-size="14.00">Pipeline Communication</text>
<text text-anchor="middle" x="6705" y="-3131.68" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6705" y="-3116.68" font-family="Times,serif" font-size="14.00">GPU: Stage 0 &#45;&gt; Stage 1</text>
</g>
<!-- ln2_1&#45;&gt;pipeline_comm_0 -->
<g id="edge343" class="edge">
<title>ln2_1&#45;&gt;pipeline_comm_0</title>
<path fill="none" stroke="black" d="M6705,-3234.67C6705,-3219.85 6705,-3200.75 6705,-3183.34"/>
<polygon fill="black" stroke="black" points="6708.5,-3183.33 6705,-3173.33 6701.5,-3183.33 6708.5,-3183.33"/>
</g>
<!-- mha_qkv_2 -->
<g id="node279" class="node">
<title>mha_qkv_2</title>
<polygon fill="lightgreen" stroke="black" points="6738,-3050.91 6544,-3050.91 6544,-2997.91 6738,-2997.91 6738,-3050.91"/>
<text text-anchor="middle" x="6641" y="-3035.71" font-family="Times,serif" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="middle" x="6641" y="-3020.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6641" y="-3005.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm_0&#45;&gt;mha_qkv_2 -->
<g id="edge344" class="edge">
<title>pipeline_comm_0&#45;&gt;mha_qkv_2</title>
<path fill="none" stroke="black" d="M6683.69,-3098.1C6676.5,-3085.86 6668.5,-3072.24 6661.39,-3060.13"/>
<polygon fill="black" stroke="black" points="6664.23,-3058.06 6656.15,-3051.21 6658.2,-3061.6 6664.23,-3058.06"/>
</g>
<!-- mha_residual_2 -->
<g id="node282" class="node">
<title>mha_residual_2</title>
<polygon fill="lightyellow" stroke="black" points="6888.66,-2783.91 6593.32,-2783.91 6517.34,-2677.91 6812.68,-2677.91 6888.66,-2783.91"/>
<text text-anchor="middle" x="6703" y="-2742.21" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="6703" y="-2727.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6703" y="-2712.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- pipeline_comm_0&#45;&gt;mha_residual_2 -->
<g id="edge348" class="edge">
<title>pipeline_comm_0&#45;&gt;mha_residual_2</title>
<path fill="none" stroke="black" d="M6738.18,-3098.99C6741.75,-3093.59 6744.86,-3087.83 6747,-3081.91 6786.61,-2972.39 6779.78,-2932.75 6751,-2819.91 6748.73,-2810.99 6745.34,-2802 6741.41,-2793.35"/>
<polygon fill="black" stroke="black" points="6744.45,-2791.6 6736.95,-2784.12 6738.15,-2794.65 6744.45,-2791.6"/>
</g>
<!-- mha_attn_2 -->
<g id="node280" class="node">
<title>mha_attn_2</title>
<polygon fill="lightgreen" stroke="black" points="6728.5,-2961.91 6549.5,-2961.91 6549.5,-2908.91 6728.5,-2908.91 6728.5,-2961.91"/>
<text text-anchor="middle" x="6639" y="-2946.71" font-family="Times,serif" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="middle" x="6639" y="-2931.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6639" y="-2916.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_qkv_2&#45;&gt;mha_attn_2 -->
<g id="edge345" class="edge">
<title>mha_qkv_2&#45;&gt;mha_attn_2</title>
<path fill="none" stroke="black" d="M6640.41,-2997.77C6640.23,-2989.79 6640.02,-2980.84 6639.82,-2972.29"/>
<polygon fill="black" stroke="black" points="6643.32,-2972.07 6639.59,-2962.16 6636.32,-2972.23 6643.32,-2972.07"/>
</g>
<!-- mha_out_2 -->
<g id="node281" class="node">
<title>mha_out_2</title>
<polygon fill="lightgreen" stroke="black" points="6742,-2872.91 6530,-2872.91 6530,-2819.91 6742,-2819.91 6742,-2872.91"/>
<text text-anchor="middle" x="6636" y="-2857.71" font-family="Times,serif" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="middle" x="6636" y="-2842.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6636" y="-2827.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_attn_2&#45;&gt;mha_out_2 -->
<g id="edge346" class="edge">
<title>mha_attn_2&#45;&gt;mha_out_2</title>
<path fill="none" stroke="black" d="M6638.12,-2908.77C6637.84,-2900.79 6637.53,-2891.84 6637.24,-2883.29"/>
<polygon fill="black" stroke="black" points="6640.73,-2883.03 6636.89,-2873.16 6633.73,-2883.27 6640.73,-2883.03"/>
</g>
<!-- mha_out_2&#45;&gt;mha_residual_2 -->
<g id="edge347" class="edge">
<title>mha_out_2&#45;&gt;mha_residual_2</title>
<path fill="none" stroke="black" d="M6651.2,-2819.65C6655.99,-2811.54 6661.5,-2802.21 6667.1,-2792.72"/>
<polygon fill="black" stroke="black" points="6670.18,-2794.39 6672.25,-2784 6664.15,-2790.84 6670.18,-2794.39"/>
</g>
<!-- ln1_2 -->
<g id="node283" class="node">
<title>ln1_2</title>
<polygon fill="lightgreen" stroke="black" points="6792.5,-2641.91 6613.5,-2641.91 6613.5,-2588.91 6792.5,-2588.91 6792.5,-2641.91"/>
<text text-anchor="middle" x="6703" y="-2626.71" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="6703" y="-2611.71" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6703" y="-2596.71" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_residual_2&#45;&gt;ln1_2 -->
<g id="edge349" class="edge">
<title>mha_residual_2&#45;&gt;ln1_2</title>
<path fill="none" stroke="black" d="M6703,-2677.81C6703,-2669.14 6703,-2660.32 6703,-2652.17"/>
<polygon fill="black" stroke="black" points="6706.5,-2651.92 6703,-2641.92 6699.5,-2651.92 6706.5,-2651.92"/>
</g>
<!-- gate_2 -->
<g id="node284" class="node">
<title>gate_2</title>
<polygon fill="lightyellow" stroke="black" points="4716.83,-2552.91 4451.44,-2552.91 4383.17,-2446.91 4648.56,-2446.91 4716.83,-2552.91"/>
<text text-anchor="middle" x="4550" y="-2511.21" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="4550" y="-2496.21" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="4550" y="-2481.21" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_2&#45;&gt;gate_2 -->
<g id="edge350" class="edge">
<title>ln1_2&#45;&gt;gate_2</title>
<path fill="none" stroke="black" d="M6613.23,-2609.67C6280.27,-2592.12 5113.82,-2530.63 4698.35,-2508.73"/>
<polygon fill="black" stroke="black" points="4698.24,-2505.22 4688.07,-2508.19 4697.87,-2512.21 4698.24,-2505.22"/>
</g>
<!-- moe_residual_2 -->
<g id="node414" class="node">
<title>moe_residual_2</title>
<polygon fill="lightyellow" stroke="black" points="6584.66,-1890.95 6289.32,-1890.95 6213.34,-1784.95 6508.68,-1784.95 6584.66,-1890.95"/>
<text text-anchor="middle" x="6399" y="-1849.25" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="6399" y="-1834.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6399" y="-1819.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_2&#45;&gt;moe_residual_2 -->
<g id="edge511" class="edge">
<title>ln1_2&#45;&gt;moe_residual_2</title>
<path fill="none" stroke="black" d="M6792.77,-2610.78C7153.47,-2595.44 8484.61,-2531.05 8626,-2410.91 8638.81,-2400.02 8636,-2391.24 8636,-2374.43 8636,-2374.43 8636,-2374.43 8636,-2094.45 8636,-1885.13 7069.83,-1847.22 6558.42,-1840.42"/>
<polygon fill="black" stroke="black" points="6558.42,-1836.92 6548.38,-1840.29 6558.33,-1843.92 6558.42,-1836.92"/>
</g>
<!-- route_to_expert_2_8_0 -->
<g id="node285" class="node">
<title>route_to_expert_2_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="342" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="342" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="342" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="342" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_8_0 -->
<g id="edge351" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.9,-2497.99C3756.13,-2493.2 870.55,-2469.06 474,-2410.91 461.35,-2409.05 448.18,-2406.37 435.28,-2403.28"/>
<polygon fill="black" stroke="black" points="436.03,-2399.86 425.48,-2400.85 434.34,-2406.65 436.03,-2399.86"/>
</g>
<!-- route_to_expert_2_8_1 -->
<g id="node289" class="node">
<title>route_to_expert_2_8_1</title>
<ellipse fill="lightblue" stroke="black" cx="605" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="605" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="605" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="605" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_8_1 -->
<g id="edge355" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.73,-2497.77C3782.07,-2492.14 1106.2,-2465.32 737,-2410.91 724.35,-2409.04 711.19,-2406.35 698.28,-2403.26"/>
<polygon fill="black" stroke="black" points="699.03,-2399.84 688.48,-2400.83 697.35,-2406.64 699.03,-2399.84"/>
</g>
<!-- route_to_expert_2_8_2 -->
<g id="node293" class="node">
<title>route_to_expert_2_8_2</title>
<ellipse fill="lightblue" stroke="black" cx="868" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="868" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="868" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="868" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_8_2 -->
<g id="edge359" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.76,-2497.52C3809.53,-2491.01 1341.94,-2461.61 1000,-2410.91 987.44,-2409.04 974.38,-2406.37 961.57,-2403.31"/>
<polygon fill="black" stroke="black" points="962.39,-2399.91 951.84,-2400.9 960.71,-2406.7 962.39,-2399.91"/>
</g>
<!-- route_to_expert_2_8_3 -->
<g id="node297" class="node">
<title>route_to_expert_2_8_3</title>
<ellipse fill="lightblue" stroke="black" cx="1131" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1131" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="1131" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1131" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_8_3 -->
<g id="edge363" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.43,-2497.23C3837.07,-2489.78 1577.68,-2457.88 1263,-2410.91 1250.45,-2409.03 1237.39,-2406.35 1224.58,-2403.29"/>
<polygon fill="black" stroke="black" points="1225.39,-2399.88 1214.85,-2400.87 1223.71,-2406.68 1225.39,-2399.88"/>
</g>
<!-- route_to_expert_2_9_0 -->
<g id="node301" class="node">
<title>route_to_expert_2_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="1394" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1394" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1394" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1394" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_9_0 -->
<g id="edge367" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4416.57,-2499.28C3908.6,-2500.05 2095.53,-2496.6 1526,-2410.91 1513.45,-2409.02 1500.39,-2406.33 1487.58,-2403.26"/>
<polygon fill="black" stroke="black" points="1488.4,-2399.86 1477.85,-2400.84 1486.71,-2406.65 1488.4,-2399.86"/>
</g>
<!-- route_to_expert_2_9_1 -->
<g id="node305" class="node">
<title>route_to_expert_2_9_1</title>
<ellipse fill="lightblue" stroke="black" cx="1657" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1657" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="1657" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1657" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_9_1 -->
<g id="edge371" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4416.43,-2498.85C3937.08,-2497.98 2304.63,-2489.23 1789,-2410.91 1776.45,-2409 1763.39,-2406.3 1750.59,-2403.23"/>
<polygon fill="black" stroke="black" points="1751.4,-2399.82 1740.86,-2400.81 1749.72,-2406.62 1751.4,-2399.82"/>
</g>
<!-- route_to_expert_2_9_2 -->
<g id="node309" class="node">
<title>route_to_expert_2_9_2</title>
<ellipse fill="lightblue" stroke="black" cx="1920" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1920" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="1920" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1920" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_9_2 -->
<g id="edge375" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4416.14,-2498.32C3966.68,-2495.71 2513.89,-2481.85 2052,-2410.91 2039.45,-2408.98 2026.4,-2406.27 2013.59,-2403.19"/>
<polygon fill="black" stroke="black" points="2014.41,-2399.78 2003.86,-2400.76 2012.72,-2406.58 2014.41,-2399.78"/>
</g>
<!-- route_to_expert_2_9_3 -->
<g id="node313" class="node">
<title>route_to_expert_2_9_3</title>
<ellipse fill="lightblue" stroke="black" cx="2183" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2183" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="2183" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2183" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_9_3 -->
<g id="edge379" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.5,-2497.67C3997.27,-2493.17 2723.28,-2474.48 2315,-2410.91 2302.67,-2408.99 2289.85,-2406.32 2277.26,-2403.3"/>
<polygon fill="black" stroke="black" points="2277.77,-2399.82 2267.23,-2400.8 2276.09,-2406.61 2277.77,-2399.82"/>
</g>
<!-- route_to_expert_2_10_0 -->
<g id="node317" class="node">
<title>route_to_expert_2_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="2446" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2446" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2446" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2446" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_10_0 -->
<g id="edge383" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.26,-2496.84C4030.75,-2490.31 2933.09,-2467.16 2578,-2410.91 2565.68,-2408.95 2552.86,-2406.27 2540.27,-2403.24"/>
<polygon fill="black" stroke="black" points="2540.79,-2399.76 2530.24,-2400.73 2539.09,-2406.55 2540.79,-2399.76"/>
</g>
<!-- route_to_expert_2_10_1 -->
<g id="node321" class="node">
<title>route_to_expert_2_10_1</title>
<ellipse fill="lightblue" stroke="black" cx="2709" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2709" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="2709" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2709" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_10_1 -->
<g id="edge387" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4414.46,-2495.74C4065.61,-2486.99 3143.07,-2459.82 2841,-2410.91 2828.68,-2408.91 2815.87,-2406.2 2803.28,-2403.16"/>
<polygon fill="black" stroke="black" points="2803.8,-2399.68 2793.25,-2400.65 2802.1,-2406.47 2803.8,-2399.68"/>
</g>
<!-- route_to_expert_2_10_2 -->
<g id="node325" class="node">
<title>route_to_expert_2_10_2</title>
<ellipse fill="lightblue" stroke="black" cx="2972" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2972" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="2972" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2972" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_10_2 -->
<g id="edge391" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4413.55,-2494.24C4103.48,-2483.05 3353.48,-2452.5 3104,-2410.91 3091.79,-2408.87 3079.08,-2406.15 3066.59,-2403.12"/>
<polygon fill="black" stroke="black" points="3067.18,-2399.66 3056.62,-2400.62 3065.47,-2406.45 3067.18,-2399.66"/>
</g>
<!-- route_to_expert_2_10_3 -->
<g id="node329" class="node">
<title>route_to_expert_2_10_3</title>
<ellipse fill="lightblue" stroke="black" cx="3235" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3235" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3235" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3235" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_10_3 -->
<g id="edge395" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4415.45,-2497.42C4194.85,-2493.09 3743.15,-2476.22 3367,-2410.91 3354.89,-2408.8 3342.29,-2406.06 3329.9,-2403.03"/>
<polygon fill="black" stroke="black" points="3330.56,-2399.59 3320.01,-2400.54 3328.85,-2406.38 3330.56,-2399.59"/>
</g>
<!-- route_to_expert_2_11_0 -->
<g id="node333" class="node">
<title>route_to_expert_2_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="3498" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3498" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3498" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3498" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_11_0 -->
<g id="edge399" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4412.97,-2493.26C4232.31,-2484.11 3905.14,-2461.68 3630,-2410.91 3618.01,-2408.69 3605.52,-2405.9 3593.22,-2402.86"/>
<polygon fill="black" stroke="black" points="3593.97,-2399.43 3583.41,-2400.36 3592.24,-2406.22 3593.97,-2399.43"/>
</g>
<!-- route_to_expert_2_11_1 -->
<g id="node337" class="node">
<title>route_to_expert_2_11_1</title>
<ellipse fill="lightblue" stroke="black" cx="3761" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3761" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="3761" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3761" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_11_1 -->
<g id="edge403" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4407.77,-2485.52C4274.06,-2471.6 4068.76,-2446.79 3893,-2410.91 3881.35,-2408.53 3869.22,-2405.69 3857.23,-2402.66"/>
<polygon fill="black" stroke="black" points="3857.77,-2399.18 3847.22,-2400.07 3856.02,-2405.96 3857.77,-2399.18"/>
</g>
<!-- route_to_expert_2_11_2 -->
<g id="node341" class="node">
<title>route_to_expert_2_11_2</title>
<ellipse fill="lightblue" stroke="black" cx="4024" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4024" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="4024" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4024" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_11_2 -->
<g id="edge407" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4395.21,-2466.2C4322.41,-2450.34 4234.54,-2430.52 4156,-2410.91 4145.03,-2408.17 4133.58,-2405.19 4122.2,-2402.15"/>
<polygon fill="black" stroke="black" points="4122.8,-2398.69 4112.24,-2399.47 4120.99,-2405.45 4122.8,-2398.69"/>
</g>
<!-- route_to_expert_2_11_3 -->
<g id="node345" class="node">
<title>route_to_expert_2_11_3</title>
<ellipse fill="lightblue" stroke="black" cx="4287" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4287" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4287" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4287" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_11_3 -->
<g id="edge411" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4439.99,-2446.84C4413.53,-2434.31 4385.87,-2421.23 4361.47,-2409.68"/>
<polygon fill="black" stroke="black" points="4362.82,-2406.44 4352.29,-2405.33 4359.83,-2412.77 4362.82,-2406.44"/>
</g>
<!-- route_to_expert_2_12_0 -->
<g id="node349" class="node">
<title>route_to_expert_2_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="4550" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4550" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 16</text>
<text text-anchor="middle" x="4550" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4550" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_12_0 -->
<g id="edge415" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4550,-2446.84C4550,-2438.41 4550,-2429.72 4550,-2421.42"/>
<polygon fill="black" stroke="black" points="4553.5,-2421.16 4550,-2411.16 4546.5,-2421.16 4553.5,-2421.16"/>
</g>
<!-- route_to_expert_2_12_1 -->
<g id="node353" class="node">
<title>route_to_expert_2_12_1</title>
<ellipse fill="lightblue" stroke="black" cx="4813" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4813" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 17</text>
<text text-anchor="middle" x="4813" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4813" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_12_1 -->
<g id="edge419" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4651.31,-2450.96C4680.43,-2437.18 4711.64,-2422.4 4738.8,-2409.55"/>
<polygon fill="black" stroke="black" points="4740.3,-2412.71 4747.84,-2405.27 4737.3,-2406.38 4740.3,-2412.71"/>
</g>
<!-- route_to_expert_2_12_2 -->
<g id="node357" class="node">
<title>route_to_expert_2_12_2</title>
<ellipse fill="lightblue" stroke="black" cx="5076" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5076" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 18</text>
<text text-anchor="middle" x="5076" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5076" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_12_2 -->
<g id="edge423" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4666.73,-2474.43C4745.33,-2457.56 4851.18,-2434.08 4944,-2410.91 4954.97,-2408.17 4966.42,-2405.19 4977.8,-2402.15"/>
<polygon fill="black" stroke="black" points="4979.01,-2405.45 4987.76,-2399.47 4977.2,-2398.69 4979.01,-2405.45"/>
</g>
<!-- route_to_expert_2_12_3 -->
<g id="node361" class="node">
<title>route_to_expert_2_12_3</title>
<ellipse fill="lightblue" stroke="black" cx="5339" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5339" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 19</text>
<text text-anchor="middle" x="5339" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5339" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_12_3 -->
<g id="edge427" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4674.66,-2487.33C4807.44,-2473.8 5023.35,-2448.4 5207,-2410.91 5218.65,-2408.53 5230.78,-2405.69 5242.77,-2402.66"/>
<polygon fill="black" stroke="black" points="5243.98,-2405.96 5252.78,-2400.07 5242.23,-2399.18 5243.98,-2405.96"/>
</g>
<!-- route_to_expert_2_13_0 -->
<g id="node365" class="node">
<title>route_to_expert_2_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="5602" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5602" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 20</text>
<text text-anchor="middle" x="5602" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5602" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_13_0 -->
<g id="edge431" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4678.97,-2493.66C4857.83,-2484.78 5190.72,-2462.45 5470,-2410.91 5481.99,-2408.69 5494.48,-2405.9 5506.78,-2402.86"/>
<polygon fill="black" stroke="black" points="5507.76,-2406.22 5516.59,-2400.36 5506.03,-2399.43 5507.76,-2406.22"/>
</g>
<!-- route_to_expert_2_13_1 -->
<g id="node369" class="node">
<title>route_to_expert_2_13_1</title>
<ellipse fill="lightblue" stroke="black" cx="5865" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5865" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 21</text>
<text text-anchor="middle" x="5865" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5865" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_13_1 -->
<g id="edge435" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.44,-2497.48C4900.88,-2493.25 5355.07,-2476.53 5733,-2410.91 5745.11,-2408.8 5757.71,-2406.06 5770.1,-2403.03"/>
<polygon fill="black" stroke="black" points="5771.15,-2406.38 5779.99,-2400.54 5769.44,-2399.59 5771.15,-2406.38"/>
</g>
<!-- route_to_expert_2_13_2 -->
<g id="node373" class="node">
<title>route_to_expert_2_13_2</title>
<ellipse fill="lightblue" stroke="black" cx="6128" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6128" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 22</text>
<text text-anchor="middle" x="6128" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6128" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_13_2 -->
<g id="edge439" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4679.3,-2494.5C4984.84,-2483.53 5744.58,-2452.82 5996,-2410.91 6008.21,-2408.87 6020.92,-2406.15 6033.41,-2403.12"/>
<polygon fill="black" stroke="black" points="6034.53,-2406.45 6043.38,-2400.62 6032.82,-2399.66 6034.53,-2406.45"/>
</g>
<!-- route_to_expert_2_13_3 -->
<g id="node377" class="node">
<title>route_to_expert_2_13_3</title>
<ellipse fill="lightblue" stroke="black" cx="6391" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6391" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 23</text>
<text text-anchor="middle" x="6391" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6391" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_13_3 -->
<g id="edge443" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4680.19,-2495.88C5024.85,-2487.27 5955.37,-2460.07 6259,-2410.91 6271.32,-2408.91 6284.13,-2406.2 6296.72,-2403.16"/>
<polygon fill="black" stroke="black" points="6297.9,-2406.47 6306.75,-2400.65 6296.2,-2399.68 6297.9,-2406.47"/>
</g>
<!-- route_to_expert_2_14_0 -->
<g id="node381" class="node">
<title>route_to_expert_2_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="6654" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6654" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 24</text>
<text text-anchor="middle" x="6654" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6654" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_14_0 -->
<g id="edge447" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4680.98,-2496.9C5062.05,-2490.47 6165.75,-2467.34 6522,-2410.91 6534.32,-2408.95 6547.14,-2406.27 6559.73,-2403.24"/>
<polygon fill="black" stroke="black" points="6560.91,-2406.55 6569.76,-2400.73 6559.21,-2399.76 6560.91,-2406.55"/>
</g>
<!-- route_to_expert_2_14_1 -->
<g id="node385" class="node">
<title>route_to_expert_2_14_1</title>
<ellipse fill="lightblue" stroke="black" cx="6917" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6917" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 25</text>
<text text-anchor="middle" x="6917" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6917" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_14_1 -->
<g id="edge451" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.57,-2497.7C5096.74,-2493.26 6375.76,-2474.63 6785,-2410.91 6797.33,-2408.99 6810.15,-2406.32 6822.74,-2403.3"/>
<polygon fill="black" stroke="black" points="6823.91,-2406.61 6832.77,-2400.8 6822.23,-2399.82 6823.91,-2406.61"/>
</g>
<!-- route_to_expert_2_14_2 -->
<g id="node389" class="node">
<title>route_to_expert_2_14_2</title>
<ellipse fill="lightblue" stroke="black" cx="7180" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7180" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 26</text>
<text text-anchor="middle" x="7180" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7180" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_14_2 -->
<g id="edge455" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.91,-2498.33C5129.1,-2495.75 6585.44,-2481.96 7048,-2410.91 7060.55,-2408.98 7073.6,-2406.27 7086.41,-2403.19"/>
<polygon fill="black" stroke="black" points="7087.28,-2406.58 7096.14,-2400.76 7085.59,-2399.78 7087.28,-2406.58"/>
</g>
<!-- route_to_expert_2_14_3 -->
<g id="node393" class="node">
<title>route_to_expert_2_14_3</title>
<ellipse fill="lightblue" stroke="black" cx="7443" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7443" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 27</text>
<text text-anchor="middle" x="7443" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7443" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_14_3 -->
<g id="edge459" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4682.33,-2498.85C5160.1,-2498 6794.92,-2489.29 7311,-2410.91 7323.55,-2409 7336.61,-2406.3 7349.41,-2403.23"/>
<polygon fill="black" stroke="black" points="7350.28,-2406.62 7359.14,-2400.81 7348.6,-2399.82 7350.28,-2406.62"/>
</g>
<!-- route_to_expert_2_15_0 -->
<g id="node397" class="node">
<title>route_to_expert_2_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="7706" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7706" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 28</text>
<text text-anchor="middle" x="7706" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7706" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_15_0 -->
<g id="edge463" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4682.56,-2499.28C5189.33,-2500.06 7004.15,-2496.65 7574,-2410.91 7586.55,-2409.02 7599.61,-2406.33 7612.42,-2403.26"/>
<polygon fill="black" stroke="black" points="7613.29,-2406.65 7622.15,-2400.84 7611.6,-2399.86 7613.29,-2406.65"/>
</g>
<!-- route_to_expert_2_15_1 -->
<g id="node401" class="node">
<title>route_to_expert_2_15_1</title>
<ellipse fill="lightblue" stroke="black" cx="7969" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7969" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 29</text>
<text text-anchor="middle" x="7969" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7969" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_15_1 -->
<g id="edge467" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.19,-2497.28C5254.05,-2489.9 7521.7,-2457.98 7837,-2410.91 7849.55,-2409.03 7862.61,-2406.35 7875.42,-2403.29"/>
<polygon fill="black" stroke="black" points="7876.29,-2406.68 7885.15,-2400.87 7874.61,-2399.88 7876.29,-2406.68"/>
</g>
<!-- route_to_expert_2_15_2 -->
<g id="node405" class="node">
<title>route_to_expert_2_15_2</title>
<ellipse fill="lightblue" stroke="black" cx="8232" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8232" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 30</text>
<text text-anchor="middle" x="8232" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8232" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_15_2 -->
<g id="edge471" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.22,-2497.56C5282.21,-2491.11 7757.49,-2461.69 8100,-2410.91 8112.56,-2409.04 8125.62,-2406.37 8138.43,-2403.31"/>
<polygon fill="black" stroke="black" points="8139.29,-2406.7 8148.16,-2400.9 8137.61,-2399.91 8139.29,-2406.7"/>
</g>
<!-- route_to_expert_2_15_3 -->
<g id="node409" class="node">
<title>route_to_expert_2_15_3</title>
<ellipse fill="lightblue" stroke="black" cx="8495" cy="-2373.43" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8495" y="-2384.73" font-family="Times,serif" font-size="14.00">Route to Expert 31</text>
<text text-anchor="middle" x="8495" y="-2369.73" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8495" y="-2354.73" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_2&#45;&gt;route_to_expert_2_15_3 -->
<g id="edge475" class="edge">
<title>gate_2&#45;&gt;route_to_expert_2_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4681.39,-2497.8C5309.76,-2492.22 7993.24,-2465.41 8363,-2410.91 8375.65,-2409.04 8388.81,-2406.35 8401.72,-2403.26"/>
<polygon fill="black" stroke="black" points="8402.65,-2406.64 8411.52,-2400.83 8400.97,-2399.84 8402.65,-2406.64"/>
</g>
<!-- expert_linear1_2_8_0 -->
<g id="node286" class="node">
<title>expert_linear1_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="465,-2299.95 283,-2299.95 283,-2246.95 465,-2246.95 465,-2299.95"/>
<text text-anchor="middle" x="374" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="374" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="374" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_2_8_0&#45;&gt;expert_linear1_2_8_0 -->
<g id="edge352" class="edge">
<title>route_to_expert_2_8_0&#45;&gt;expert_linear1_2_8_0</title>
<path fill="none" stroke="black" d="M353.92,-2335.95C356.73,-2327.34 359.72,-2318.19 362.51,-2309.64"/>
<polygon fill="black" stroke="black" points="365.89,-2310.56 365.67,-2299.96 359.24,-2308.38 365.89,-2310.56"/>
</g>
<!-- expert_activation_2_8_0 -->
<g id="node287" class="node">
<title>expert_activation_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="497,-2210.95 315,-2210.95 315,-2157.95 497,-2157.95 497,-2210.95"/>
<text text-anchor="middle" x="406" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="406" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="406" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_2_8_0&#45;&gt;expert_activation_2_8_0 -->
<g id="edge353" class="edge">
<title>expert_linear1_2_8_0&#45;&gt;expert_activation_2_8_0</title>
<path fill="none" stroke="black" d="M383.43,-2246.82C386.43,-2238.66 389.8,-2229.49 393.01,-2220.77"/>
<polygon fill="black" stroke="black" points="396.36,-2221.8 396.53,-2211.2 389.79,-2219.38 396.36,-2221.8"/>
</g>
<!-- expert_linear2_2_8_0 -->
<g id="node288" class="node">
<title>expert_linear2_2_8_0</title>
<polygon fill="lightgreen" stroke="black" points="601.5,-2121.95 428.5,-2121.95 428.5,-2068.95 601.5,-2068.95 601.5,-2121.95"/>
<text text-anchor="middle" x="515" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="515" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="515" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_2_8_0&#45;&gt;expert_linear2_2_8_0 -->
<g id="edge354" class="edge">
<title>expert_activation_2_8_0&#45;&gt;expert_linear2_2_8_0</title>
<path fill="none" stroke="black" d="M438.11,-2157.82C449.54,-2148.7 462.56,-2138.31 474.6,-2128.7"/>
<polygon fill="black" stroke="black" points="477.11,-2131.18 482.74,-2122.2 472.74,-2125.71 477.11,-2131.18"/>
</g>
<!-- aggregate_2 -->
<g id="node413" class="node">
<title>aggregate_2</title>
<polygon fill="lightyellow" stroke="black" points="4763.64,-2032.95 4423.79,-2032.95 4336.36,-1926.95 4676.21,-1926.95 4763.64,-2032.95"/>
<text text-anchor="middle" x="4550" y="-1991.25" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="4550" y="-1976.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="4550" y="-1961.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- expert_linear2_2_8_0&#45;&gt;aggregate_2 -->
<g id="edge479" class="edge">
<title>expert_linear2_2_8_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M601.66,-2081.65C637.85,-2076.82 680.38,-2071.8 719,-2068.95 1442.94,-2015.53 3716.52,-1989.24 4371.69,-1982.65"/>
<polygon fill="black" stroke="black" points="4372.19,-1986.14 4382.16,-1982.54 4372.12,-1979.14 4372.19,-1986.14"/>
</g>
<!-- expert_linear1_2_8_1 -->
<g id="node290" class="node">
<title>expert_linear1_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="753,-2299.95 571,-2299.95 571,-2246.95 753,-2246.95 753,-2299.95"/>
<text text-anchor="middle" x="662" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="662" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="662" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_2_8_1&#45;&gt;expert_linear1_2_8_1 -->
<g id="edge356" class="edge">
<title>route_to_expert_2_8_1&#45;&gt;expert_linear1_2_8_1</title>
<path fill="none" stroke="black" d="M625.9,-2336.5C631.19,-2327.41 636.86,-2317.67 642.1,-2308.66"/>
<polygon fill="black" stroke="black" points="645.16,-2310.36 647.16,-2299.95 639.11,-2306.84 645.16,-2310.36"/>
</g>
<!-- expert_activation_2_8_1 -->
<g id="node291" class="node">
<title>expert_activation_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="823,-2210.95 641,-2210.95 641,-2157.95 823,-2157.95 823,-2210.95"/>
<text text-anchor="middle" x="732" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="732" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="732" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_2_8_1&#45;&gt;expert_activation_2_8_1 -->
<g id="edge357" class="edge">
<title>expert_linear1_2_8_1&#45;&gt;expert_activation_2_8_1</title>
<path fill="none" stroke="black" d="M682.62,-2246.82C689.61,-2238.14 697.52,-2228.3 704.93,-2219.09"/>
<polygon fill="black" stroke="black" points="707.74,-2221.19 711.28,-2211.2 702.29,-2216.8 707.74,-2221.19"/>
</g>
<!-- expert_linear2_2_8_1 -->
<g id="node292" class="node">
<title>expert_linear2_2_8_1</title>
<polygon fill="lightgreen" stroke="black" points="901.5,-2121.95 728.5,-2121.95 728.5,-2068.95 901.5,-2068.95 901.5,-2121.95"/>
<text text-anchor="middle" x="815" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="815" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="815" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_2_8_1&#45;&gt;expert_linear2_2_8_1 -->
<g id="edge358" class="edge">
<title>expert_activation_2_8_1&#45;&gt;expert_linear2_2_8_1</title>
<path fill="none" stroke="black" d="M756.45,-2157.82C764.91,-2148.96 774.5,-2138.91 783.44,-2129.54"/>
<polygon fill="black" stroke="black" points="786.06,-2131.85 790.43,-2122.2 781,-2127.02 786.06,-2131.85"/>
</g>
<!-- expert_linear2_2_8_1&#45;&gt;aggregate_2 -->
<g id="edge480" class="edge">
<title>expert_linear2_2_8_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M901.72,-2080.02C930.95,-2075.71 963.81,-2071.47 994,-2068.95 1660.85,-2013.39 3747,-1988.84 4371.58,-1982.61"/>
<polygon fill="black" stroke="black" points="4372.06,-1986.1 4382.02,-1982.51 4371.99,-1979.11 4372.06,-1986.1"/>
</g>
<!-- expert_linear1_2_8_2 -->
<g id="node294" class="node">
<title>expert_linear1_2_8_2</title>
<polygon fill="lightgreen" stroke="black" points="1010,-2299.95 828,-2299.95 828,-2246.95 1010,-2246.95 1010,-2299.95"/>
<text text-anchor="middle" x="919" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="919" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="919" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_2_8_2&#45;&gt;expert_linear1_2_8_2 -->
<g id="edge360" class="edge">
<title>route_to_expert_2_8_2&#45;&gt;expert_linear1_2_8_2</title>
<path fill="none" stroke="black" d="M886.85,-2336.23C891.48,-2327.32 896.43,-2317.82 901.02,-2309"/>
<polygon fill="black" stroke="black" points="904.13,-2310.6 905.65,-2300.11 897.92,-2307.36 904.13,-2310.6"/>
</g>
<!-- expert_activation_2_8_2 -->
<g id="node295" class="node">
<title>expert_activation_2_8_2</title>
<polygon fill="lightgreen" stroke="black" points="1086,-2210.95 904,-2210.95 904,-2157.95 1086,-2157.95 1086,-2210.95"/>
<text text-anchor="middle" x="995" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="995" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="995" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_2_8_2&#45;&gt;expert_activation_2_8_2 -->
<g id="edge361" class="edge">
<title>expert_linear1_2_8_2&#45;&gt;expert_activation_2_8_2</title>
<path fill="none" stroke="black" d="M941.39,-2246.82C949.05,-2238.05 957.74,-2228.1 965.86,-2218.81"/>
<polygon fill="black" stroke="black" points="968.56,-2221.04 972.51,-2211.2 963.29,-2216.43 968.56,-2221.04"/>
</g>
<!-- expert_linear2_2_8_2 -->
<g id="node296" class="node">
<title>expert_linear2_2_8_2</title>
<polygon fill="lightgreen" stroke="black" points="1176.5,-2121.95 1003.5,-2121.95 1003.5,-2068.95 1176.5,-2068.95 1176.5,-2121.95"/>
<text text-anchor="middle" x="1090" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1090" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1090" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_2_8_2&#45;&gt;expert_linear2_2_8_2 -->
<g id="edge362" class="edge">
<title>expert_activation_2_8_2&#45;&gt;expert_linear2_2_8_2</title>
<path fill="none" stroke="black" d="M1022.99,-2157.82C1032.85,-2148.79 1044.08,-2138.51 1054.48,-2128.98"/>
<polygon fill="black" stroke="black" points="1056.87,-2131.54 1061.88,-2122.2 1052.14,-2126.38 1056.87,-2131.54"/>
</g>
<!-- expert_linear2_2_8_2&#45;&gt;aggregate_2 -->
<g id="edge481" class="edge">
<title>expert_linear2_2_8_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1176.81,-2080.82C1209.13,-2076.27 1246.16,-2071.67 1280,-2068.95 1888.59,-2020.06 3781.63,-1991.22 4372.18,-1983.24"/>
<polygon fill="black" stroke="black" points="4372.54,-1986.73 4382.49,-1983.1 4372.44,-1979.73 4372.54,-1986.73"/>
</g>
<!-- expert_linear1_2_8_3 -->
<g id="node298" class="node">
<title>expert_linear1_2_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1261,-2299.95 1079,-2299.95 1079,-2246.95 1261,-2246.95 1261,-2299.95"/>
<text text-anchor="middle" x="1170" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1170" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1170" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_2_8_3&#45;&gt;expert_linear1_2_8_3 -->
<g id="edge364" class="edge">
<title>route_to_expert_2_8_3&#45;&gt;expert_linear1_2_8_3</title>
<path fill="none" stroke="black" d="M1145.52,-2335.95C1148.98,-2327.25 1152.67,-2317.99 1156.1,-2309.37"/>
<polygon fill="black" stroke="black" points="1159.4,-2310.55 1159.85,-2299.96 1152.9,-2307.96 1159.4,-2310.55"/>
</g>
<!-- expert_activation_2_8_3 -->
<g id="node299" class="node">
<title>expert_activation_2_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1317,-2210.95 1135,-2210.95 1135,-2157.95 1317,-2157.95 1317,-2210.95"/>
<text text-anchor="middle" x="1226" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1226" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1226" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_2_8_3&#45;&gt;expert_activation_2_8_3 -->
<g id="edge365" class="edge">
<title>expert_linear1_2_8_3&#45;&gt;expert_activation_2_8_3</title>
<path fill="none" stroke="black" d="M1186.5,-2246.82C1191.98,-2238.31 1198.16,-2228.7 1203.99,-2219.65"/>
<polygon fill="black" stroke="black" points="1206.96,-2221.51 1209.43,-2211.2 1201.07,-2217.72 1206.96,-2221.51"/>
</g>
<!-- expert_linear2_2_8_3 -->
<g id="node300" class="node">
<title>expert_linear2_2_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1462.5,-2121.95 1289.5,-2121.95 1289.5,-2068.95 1462.5,-2068.95 1462.5,-2121.95"/>
<text text-anchor="middle" x="1376" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1376" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1376" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_2_8_3&#45;&gt;expert_linear2_2_8_3 -->
<g id="edge366" class="edge">
<title>expert_activation_2_8_3&#45;&gt;expert_linear2_2_8_3</title>
<path fill="none" stroke="black" d="M1270.19,-2157.82C1286.75,-2148.22 1305.73,-2137.21 1323.01,-2127.19"/>
<polygon fill="black" stroke="black" points="1324.97,-2130.1 1331.86,-2122.05 1321.46,-2124.04 1324.97,-2130.1"/>
</g>
<!-- expert_linear2_2_8_3&#45;&gt;aggregate_2 -->
<g id="edge482" class="edge">
<title>expert_linear2_2_8_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1462.55,-2081.43C1497.13,-2076.72 1537.38,-2071.85 1574,-2068.95 2631.23,-1985.45 3905.4,-1979.27 4369.68,-1980.11"/>
<polygon fill="black" stroke="black" points="4369.81,-1983.61 4379.82,-1980.13 4369.83,-1976.61 4369.81,-1983.61"/>
</g>
<!-- expert_linear1_2_9_0 -->
<g id="node302" class="node">
<title>expert_linear1_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1501,-2299.95 1319,-2299.95 1319,-2246.95 1501,-2246.95 1501,-2299.95"/>
<text text-anchor="middle" x="1410" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1410" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1410" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_2_9_0&#45;&gt;expert_linear1_2_9_0 -->
<g id="edge368" class="edge">
<title>route_to_expert_2_9_0&#45;&gt;expert_linear1_2_9_0</title>
<path fill="none" stroke="black" d="M1399.96,-2335.95C1401.35,-2327.44 1402.83,-2318.39 1404.21,-2309.92"/>
<polygon fill="black" stroke="black" points="1407.68,-2310.4 1405.83,-2299.96 1400.77,-2309.27 1407.68,-2310.4"/>
</g>
<!-- expert_activation_2_9_0 -->
<g id="node303" class="node">
<title>expert_activation_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1533,-2210.95 1351,-2210.95 1351,-2157.95 1533,-2157.95 1533,-2210.95"/>
<text text-anchor="middle" x="1442" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1442" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1442" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_2_9_0&#45;&gt;expert_activation_2_9_0 -->
<g id="edge369" class="edge">
<title>expert_linear1_2_9_0&#45;&gt;expert_activation_2_9_0</title>
<path fill="none" stroke="black" d="M1419.43,-2246.82C1422.43,-2238.66 1425.8,-2229.49 1429.01,-2220.77"/>
<polygon fill="black" stroke="black" points="1432.36,-2221.8 1432.53,-2211.2 1425.79,-2219.38 1432.36,-2221.8"/>
</g>
<!-- expert_linear2_2_9_0 -->
<g id="node304" class="node">
<title>expert_linear2_2_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1756.5,-2121.95 1583.5,-2121.95 1583.5,-2068.95 1756.5,-2068.95 1756.5,-2121.95"/>
<text text-anchor="middle" x="1670" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="1670" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1670" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_2_9_0&#45;&gt;expert_linear2_2_9_0 -->
<g id="edge370" class="edge">
<title>expert_activation_2_9_0&#45;&gt;expert_linear2_2_9_0</title>
<path fill="none" stroke="black" d="M1508.87,-2157.94C1535.43,-2147.8 1566.14,-2136.08 1593.58,-2125.61"/>
<polygon fill="black" stroke="black" points="1595.04,-2128.8 1603.13,-2121.97 1592.54,-2122.26 1595.04,-2128.8"/>
</g>
<!-- expert_linear2_2_9_0&#45;&gt;aggregate_2 -->
<g id="edge483" class="edge">
<title>expert_linear2_2_9_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1756.68,-2075.68C1771.73,-2073 1787.27,-2070.6 1802,-2068.95 2302.55,-2012.95 3845.3,-1989.48 4371.79,-1982.96"/>
<polygon fill="black" stroke="black" points="4372.18,-1986.46 4382.13,-1982.83 4372.09,-1979.46 4372.18,-1986.46"/>
</g>
<!-- expert_linear1_2_9_1 -->
<g id="node306" class="node">
<title>expert_linear1_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="1748,-2299.95 1566,-2299.95 1566,-2246.95 1748,-2246.95 1748,-2299.95"/>
<text text-anchor="middle" x="1657" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="1657" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1657" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_2_9_1&#45;&gt;expert_linear1_2_9_1 -->
<g id="edge372" class="edge">
<title>route_to_expert_2_9_1&#45;&gt;expert_linear1_2_9_1</title>
<path fill="none" stroke="black" d="M1657,-2335.95C1657,-2327.53 1657,-2318.59 1657,-2310.2"/>
<polygon fill="black" stroke="black" points="1660.5,-2309.96 1657,-2299.96 1653.5,-2309.96 1660.5,-2309.96"/>
</g>
<!-- expert_activation_2_9_1 -->
<g id="node307" class="node">
<title>expert_activation_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="1749,-2210.95 1567,-2210.95 1567,-2157.95 1749,-2157.95 1749,-2210.95"/>
<text text-anchor="middle" x="1658" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="1658" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1658" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_2_9_1&#45;&gt;expert_activation_2_9_1 -->
<g id="edge373" class="edge">
<title>expert_linear1_2_9_1&#45;&gt;expert_activation_2_9_1</title>
<path fill="none" stroke="black" d="M1657.29,-2246.82C1657.39,-2238.84 1657.49,-2229.89 1657.59,-2221.34"/>
<polygon fill="black" stroke="black" points="1661.09,-2221.24 1657.7,-2211.2 1654.09,-2221.16 1661.09,-2221.24"/>
</g>
<!-- expert_linear2_2_9_1 -->
<g id="node308" class="node">
<title>expert_linear2_2_9_1</title>
<polygon fill="lightgreen" stroke="black" points="1983.5,-2121.95 1810.5,-2121.95 1810.5,-2068.95 1983.5,-2068.95 1983.5,-2121.95"/>
<text text-anchor="middle" x="1897" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="1897" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1897" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_2_9_1&#45;&gt;expert_linear2_2_9_1 -->
<g id="edge374" class="edge">
<title>expert_activation_2_9_1&#45;&gt;expert_linear2_2_9_1</title>
<path fill="none" stroke="black" d="M1728.09,-2157.94C1756.06,-2147.76 1788.41,-2135.98 1817.27,-2125.48"/>
<polygon fill="black" stroke="black" points="1818.71,-2128.68 1826.91,-2121.97 1816.31,-2122.1 1818.71,-2128.68"/>
</g>
<!-- expert_linear2_2_9_1&#45;&gt;aggregate_2 -->
<g id="edge484" class="edge">
<title>expert_linear2_2_9_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M1983.61,-2086.98C2051.43,-2081.34 2148.16,-2073.78 2233,-2068.95 3031.72,-2023.49 3986.71,-1995.58 4373.97,-1985.37"/>
<polygon fill="black" stroke="black" points="4374.23,-1988.86 4384.14,-1985.1 4374.05,-1981.87 4374.23,-1988.86"/>
</g>
<!-- expert_linear1_2_9_2 -->
<g id="node310" class="node">
<title>expert_linear1_2_9_2</title>
<polygon fill="lightgreen" stroke="black" points="2073,-2299.95 1891,-2299.95 1891,-2246.95 2073,-2246.95 2073,-2299.95"/>
<text text-anchor="middle" x="1982" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="1982" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1982" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_2_9_2&#45;&gt;expert_linear1_2_9_2 -->
<g id="edge376" class="edge">
<title>route_to_expert_2_9_2&#45;&gt;expert_linear1_2_9_2</title>
<path fill="none" stroke="black" d="M1942.73,-2336.5C1948.49,-2327.41 1954.65,-2317.67 1960.35,-2308.66"/>
<polygon fill="black" stroke="black" points="1963.47,-2310.28 1965.86,-2299.95 1957.56,-2306.53 1963.47,-2310.28"/>
</g>
<!-- expert_activation_2_9_2 -->
<g id="node311" class="node">
<title>expert_activation_2_9_2</title>
<polygon fill="lightgreen" stroke="black" points="2295,-2210.95 2113,-2210.95 2113,-2157.95 2295,-2157.95 2295,-2210.95"/>
<text text-anchor="middle" x="2204" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2204" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2204" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_2_9_2&#45;&gt;expert_activation_2_9_2 -->
<g id="edge377" class="edge">
<title>expert_linear1_2_9_2&#45;&gt;expert_activation_2_9_2</title>
<path fill="none" stroke="black" d="M2047.11,-2246.94C2072.86,-2236.85 2102.61,-2225.19 2129.24,-2214.75"/>
<polygon fill="black" stroke="black" points="2130.86,-2217.88 2138.89,-2210.97 2128.31,-2211.36 2130.86,-2217.88"/>
</g>
<!-- expert_linear2_2_9_2 -->
<g id="node312" class="node">
<title>expert_linear2_2_9_2</title>
<polygon fill="lightgreen" stroke="black" points="2414.5,-2121.95 2241.5,-2121.95 2241.5,-2068.95 2414.5,-2068.95 2414.5,-2121.95"/>
<text text-anchor="middle" x="2328" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2328" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2328" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_2_9_2&#45;&gt;expert_linear2_2_9_2 -->
<g id="edge378" class="edge">
<title>expert_activation_2_9_2&#45;&gt;expert_linear2_2_9_2</title>
<path fill="none" stroke="black" d="M2240.53,-2157.82C2253.79,-2148.52 2268.92,-2137.91 2282.82,-2128.15"/>
<polygon fill="black" stroke="black" points="2285.12,-2130.81 2291.3,-2122.2 2281.1,-2125.08 2285.12,-2130.81"/>
</g>
<!-- expert_linear2_2_9_2&#45;&gt;aggregate_2 -->
<g id="edge485" class="edge">
<title>expert_linear2_2_9_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2414.72,-2083.01C2455.42,-2078 2504.63,-2072.48 2549,-2068.95 3221.56,-2015.43 4024.06,-1992.49 4373.21,-1984.52"/>
<polygon fill="black" stroke="black" points="4373.49,-1988.01 4383.4,-1984.29 4373.33,-1981.01 4373.49,-1988.01"/>
</g>
<!-- expert_linear1_2_9_3 -->
<g id="node314" class="node">
<title>expert_linear1_2_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2336,-2299.95 2154,-2299.95 2154,-2246.95 2336,-2246.95 2336,-2299.95"/>
<text text-anchor="middle" x="2245" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2245" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2245" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_2_9_3&#45;&gt;expert_linear1_2_9_3 -->
<g id="edge380" class="edge">
<title>route_to_expert_2_9_3&#45;&gt;expert_linear1_2_9_3</title>
<path fill="none" stroke="black" d="M2205.73,-2336.5C2211.49,-2327.41 2217.65,-2317.67 2223.35,-2308.66"/>
<polygon fill="black" stroke="black" points="2226.47,-2310.28 2228.86,-2299.95 2220.56,-2306.53 2226.47,-2310.28"/>
</g>
<!-- expert_activation_2_9_3 -->
<g id="node315" class="node">
<title>expert_activation_2_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2668,-2210.95 2486,-2210.95 2486,-2157.95 2668,-2157.95 2668,-2210.95"/>
<text text-anchor="middle" x="2577" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2577" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2577" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_2_9_3&#45;&gt;expert_activation_2_9_3 -->
<g id="edge381" class="edge">
<title>expert_linear1_2_9_3&#45;&gt;expert_activation_2_9_3</title>
<path fill="none" stroke="black" d="M2336.16,-2248.57C2379.53,-2237.2 2431.52,-2223.58 2476.07,-2211.9"/>
<polygon fill="black" stroke="black" points="2476.97,-2215.28 2485.76,-2209.36 2475.2,-2208.51 2476.97,-2215.28"/>
</g>
<!-- expert_linear2_2_9_3 -->
<g id="node316" class="node">
<title>expert_linear2_2_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2730.5,-2121.95 2557.5,-2121.95 2557.5,-2068.95 2730.5,-2068.95 2730.5,-2121.95"/>
<text text-anchor="middle" x="2644" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2644" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2644" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_2_9_3&#45;&gt;expert_linear2_2_9_3 -->
<g id="edge382" class="edge">
<title>expert_activation_2_9_3&#45;&gt;expert_linear2_2_9_3</title>
<path fill="none" stroke="black" d="M2596.74,-2157.82C2603.36,-2149.22 2610.85,-2139.5 2617.88,-2130.37"/>
<polygon fill="black" stroke="black" points="2620.84,-2132.26 2624.17,-2122.2 2615.3,-2127.99 2620.84,-2132.26"/>
</g>
<!-- expert_linear2_2_9_3&#45;&gt;aggregate_2 -->
<g id="edge486" class="edge">
<title>expert_linear2_2_9_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2730.91,-2079.13C2755.45,-2075.28 2782.21,-2071.51 2807,-2068.95 3377.4,-2010.1 4057.05,-1990.17 4372.67,-1983.78"/>
<polygon fill="black" stroke="black" points="4372.89,-1987.27 4382.82,-1983.57 4372.75,-1980.28 4372.89,-1987.27"/>
</g>
<!-- expert_linear1_2_10_0 -->
<g id="node318" class="node">
<title>expert_linear1_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2599,-2299.95 2417,-2299.95 2417,-2246.95 2599,-2246.95 2599,-2299.95"/>
<text text-anchor="middle" x="2508" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2508" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2508" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_2_10_0&#45;&gt;expert_linear1_2_10_0 -->
<g id="edge384" class="edge">
<title>route_to_expert_2_10_0&#45;&gt;expert_linear1_2_10_0</title>
<path fill="none" stroke="black" d="M2468.73,-2336.5C2474.49,-2327.41 2480.65,-2317.67 2486.35,-2308.66"/>
<polygon fill="black" stroke="black" points="2489.47,-2310.28 2491.86,-2299.95 2483.56,-2306.53 2489.47,-2310.28"/>
</g>
<!-- expert_activation_2_10_0 -->
<g id="node319" class="node">
<title>expert_activation_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2955,-2210.95 2773,-2210.95 2773,-2157.95 2955,-2157.95 2955,-2210.95"/>
<text text-anchor="middle" x="2864" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2864" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2864" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_2_10_0&#45;&gt;expert_activation_2_10_0 -->
<g id="edge385" class="edge">
<title>expert_linear1_2_10_0&#45;&gt;expert_activation_2_10_0</title>
<path fill="none" stroke="black" d="M2599.22,-2250.16C2649.25,-2237.94 2711.39,-2222.75 2762.89,-2210.16"/>
<polygon fill="black" stroke="black" points="2763.83,-2213.54 2772.71,-2207.76 2762.17,-2206.74 2763.83,-2213.54"/>
</g>
<!-- expert_linear2_2_10_0 -->
<g id="node320" class="node">
<title>expert_linear2_2_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2988.5,-2121.95 2815.5,-2121.95 2815.5,-2068.95 2988.5,-2068.95 2988.5,-2121.95"/>
<text text-anchor="middle" x="2902" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="2902" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2902" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_2_10_0&#45;&gt;expert_linear2_2_10_0 -->
<g id="edge386" class="edge">
<title>expert_activation_2_10_0&#45;&gt;expert_linear2_2_10_0</title>
<path fill="none" stroke="black" d="M2875.2,-2157.82C2878.8,-2149.58 2882.85,-2140.29 2886.7,-2131.49"/>
<polygon fill="black" stroke="black" points="2889.96,-2132.77 2890.75,-2122.2 2883.54,-2129.97 2889.96,-2132.77"/>
</g>
<!-- expert_linear2_2_10_0&#45;&gt;aggregate_2 -->
<g id="edge487" class="edge">
<title>expert_linear2_2_10_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M2988.6,-2076.27C3004.32,-2073.46 3020.61,-2070.86 3036,-2068.95 3517.05,-2009.46 4089.2,-1990.02 4372.64,-1983.8"/>
<polygon fill="black" stroke="black" points="4373.09,-1987.29 4383.02,-1983.57 4372.94,-1980.29 4373.09,-1987.29"/>
</g>
<!-- expert_linear1_2_10_1 -->
<g id="node322" class="node">
<title>expert_linear1_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="2862,-2299.95 2680,-2299.95 2680,-2246.95 2862,-2246.95 2862,-2299.95"/>
<text text-anchor="middle" x="2771" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2771" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2771" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_2_10_1&#45;&gt;expert_linear1_2_10_1 -->
<g id="edge388" class="edge">
<title>route_to_expert_2_10_1&#45;&gt;expert_linear1_2_10_1</title>
<path fill="none" stroke="black" d="M2731.73,-2336.5C2737.49,-2327.41 2743.65,-2317.67 2749.35,-2308.66"/>
<polygon fill="black" stroke="black" points="2752.47,-2310.28 2754.86,-2299.95 2746.56,-2306.53 2752.47,-2310.28"/>
</g>
<!-- expert_activation_2_10_1 -->
<g id="node323" class="node">
<title>expert_activation_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3198,-2210.95 3016,-2210.95 3016,-2157.95 3198,-2157.95 3198,-2210.95"/>
<text text-anchor="middle" x="3107" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="3107" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3107" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_2_10_1&#45;&gt;expert_activation_2_10_1 -->
<g id="edge389" class="edge">
<title>expert_linear1_2_10_1&#45;&gt;expert_activation_2_10_1</title>
<path fill="none" stroke="black" d="M2862.37,-2248.8C2906.82,-2237.29 2960.37,-2223.42 3006.02,-2211.6"/>
<polygon fill="black" stroke="black" points="3007.14,-2214.93 3015.94,-2209.03 3005.38,-2208.15 3007.14,-2214.93"/>
</g>
<!-- expert_linear2_2_10_1 -->
<g id="node324" class="node">
<title>expert_linear2_2_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3217.5,-2121.95 3044.5,-2121.95 3044.5,-2068.95 3217.5,-2068.95 3217.5,-2121.95"/>
<text text-anchor="middle" x="3131" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="3131" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3131" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_2_10_1&#45;&gt;expert_linear2_2_10_1 -->
<g id="edge390" class="edge">
<title>expert_activation_2_10_1&#45;&gt;expert_linear2_2_10_1</title>
<path fill="none" stroke="black" d="M3114.07,-2157.82C3116.3,-2149.75 3118.8,-2140.69 3121.18,-2132.06"/>
<polygon fill="black" stroke="black" points="3124.61,-2132.77 3123.9,-2122.2 3117.86,-2130.91 3124.61,-2132.77"/>
</g>
<!-- expert_linear2_2_10_1&#45;&gt;aggregate_2 -->
<g id="edge488" class="edge">
<title>expert_linear2_2_10_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3217.66,-2074.66C3229.16,-2072.49 3240.84,-2070.5 3252,-2068.95 3650.72,-2013.7 4123.36,-1992.73 4373.76,-1985.09"/>
<polygon fill="black" stroke="black" points="4374.15,-1988.58 4384.04,-1984.78 4373.94,-1981.58 4374.15,-1988.58"/>
</g>
<!-- expert_linear1_2_10_2 -->
<g id="node326" class="node">
<title>expert_linear1_2_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3125,-2299.95 2943,-2299.95 2943,-2246.95 3125,-2246.95 3125,-2299.95"/>
<text text-anchor="middle" x="3034" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="3034" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3034" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_2_10_2&#45;&gt;expert_linear1_2_10_2 -->
<g id="edge392" class="edge">
<title>route_to_expert_2_10_2&#45;&gt;expert_linear1_2_10_2</title>
<path fill="none" stroke="black" d="M2994.73,-2336.5C3000.49,-2327.41 3006.65,-2317.67 3012.35,-2308.66"/>
<polygon fill="black" stroke="black" points="3015.47,-2310.28 3017.86,-2299.95 3009.56,-2306.53 3015.47,-2310.28"/>
</g>
<!-- expert_activation_2_10_2 -->
<g id="node327" class="node">
<title>expert_activation_2_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3420,-2210.95 3238,-2210.95 3238,-2157.95 3420,-2157.95 3420,-2210.95"/>
<text text-anchor="middle" x="3329" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="3329" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3329" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_2_10_2&#45;&gt;expert_activation_2_10_2 -->
<g id="edge393" class="edge">
<title>expert_linear1_2_10_2&#45;&gt;expert_activation_2_10_2</title>
<path fill="none" stroke="black" d="M3120.52,-2246.94C3155.64,-2236.58 3196.36,-2224.57 3232.44,-2213.93"/>
<polygon fill="black" stroke="black" points="3233.88,-2217.15 3242.49,-2210.97 3231.9,-2210.44 3233.88,-2217.15"/>
</g>
<!-- expert_linear2_2_10_2 -->
<g id="node328" class="node">
<title>expert_linear2_2_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3433.5,-2121.95 3260.5,-2121.95 3260.5,-2068.95 3433.5,-2068.95 3433.5,-2121.95"/>
<text text-anchor="middle" x="3347" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3347" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3347" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_2_10_2&#45;&gt;expert_linear2_2_10_2 -->
<g id="edge394" class="edge">
<title>expert_activation_2_10_2&#45;&gt;expert_linear2_2_10_2</title>
<path fill="none" stroke="black" d="M3334.3,-2157.82C3335.97,-2149.75 3337.85,-2140.69 3339.63,-2132.06"/>
<polygon fill="black" stroke="black" points="3343.07,-2132.7 3341.67,-2122.2 3336.22,-2131.29 3343.07,-2132.7"/>
</g>
<!-- expert_linear2_2_10_2&#45;&gt;aggregate_2 -->
<g id="edge489" class="edge">
<title>expert_linear2_2_10_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3433.73,-2073.89C3443.24,-2072.04 3452.8,-2070.34 3462,-2068.95 3782.28,-2020.73 4159.85,-1997.67 4375.46,-1987.67"/>
<polygon fill="black" stroke="black" points="4375.78,-1991.16 4385.61,-1987.21 4375.46,-1984.17 4375.78,-1991.16"/>
</g>
<!-- expert_linear1_2_10_3 -->
<g id="node330" class="node">
<title>expert_linear1_2_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3387,-2299.95 3205,-2299.95 3205,-2246.95 3387,-2246.95 3387,-2299.95"/>
<text text-anchor="middle" x="3296" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3296" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3296" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_2_10_3&#45;&gt;expert_linear1_2_10_3 -->
<g id="edge396" class="edge">
<title>route_to_expert_2_10_3&#45;&gt;expert_linear1_2_10_3</title>
<path fill="none" stroke="black" d="M3257.37,-2336.5C3263.03,-2327.41 3269.09,-2317.67 3274.7,-2308.66"/>
<polygon fill="black" stroke="black" points="3277.81,-2310.29 3280.12,-2299.95 3271.87,-2306.59 3277.81,-2310.29"/>
</g>
<!-- expert_activation_2_10_3 -->
<g id="node331" class="node">
<title>expert_activation_2_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3631,-2210.95 3449,-2210.95 3449,-2157.95 3631,-2157.95 3631,-2210.95"/>
<text text-anchor="middle" x="3540" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3540" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3540" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_2_10_3&#45;&gt;expert_activation_2_10_3 -->
<g id="edge397" class="edge">
<title>expert_linear1_2_10_3&#45;&gt;expert_activation_2_10_3</title>
<path fill="none" stroke="black" d="M3367.56,-2246.94C3396.24,-2236.71 3429.43,-2224.88 3458.98,-2214.34"/>
<polygon fill="black" stroke="black" points="3460.2,-2217.62 3468.44,-2210.97 3457.85,-2211.03 3460.2,-2217.62"/>
</g>
<!-- expert_linear2_2_10_3 -->
<g id="node332" class="node">
<title>expert_linear2_2_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3643.5,-2121.95 3470.5,-2121.95 3470.5,-2068.95 3643.5,-2068.95 3643.5,-2121.95"/>
<text text-anchor="middle" x="3557" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3557" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3557" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_2_10_3&#45;&gt;expert_linear2_2_10_3 -->
<g id="edge398" class="edge">
<title>expert_activation_2_10_3&#45;&gt;expert_linear2_2_10_3</title>
<path fill="none" stroke="black" d="M3545.01,-2157.82C3546.59,-2149.75 3548.36,-2140.69 3550.04,-2132.06"/>
<polygon fill="black" stroke="black" points="3553.49,-2132.69 3551.97,-2122.2 3546.62,-2131.35 3553.49,-2132.69"/>
</g>
<!-- expert_linear2_2_10_3&#45;&gt;aggregate_2 -->
<g id="edge490" class="edge">
<title>expert_linear2_2_10_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3643.63,-2072.06C3649.16,-2070.92 3654.64,-2069.88 3660,-2068.95 3907.79,-2026.26 4198.22,-2002.37 4378.19,-1990.57"/>
<polygon fill="black" stroke="black" points="4378.53,-1994.06 4388.28,-1989.92 4378.07,-1987.07 4378.53,-1994.06"/>
</g>
<!-- expert_linear1_2_11_0 -->
<g id="node334" class="node">
<title>expert_linear1_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3648,-2299.95 3466,-2299.95 3466,-2246.95 3648,-2246.95 3648,-2299.95"/>
<text text-anchor="middle" x="3557" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3557" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3557" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_2_11_0&#45;&gt;expert_linear1_2_11_0 -->
<g id="edge400" class="edge">
<title>route_to_expert_2_11_0&#45;&gt;expert_linear1_2_11_0</title>
<path fill="none" stroke="black" d="M3519.63,-2336.5C3525.11,-2327.41 3530.98,-2317.67 3536.4,-2308.66"/>
<polygon fill="black" stroke="black" points="3539.48,-2310.33 3541.64,-2299.95 3533.49,-2306.71 3539.48,-2310.33"/>
</g>
<!-- expert_activation_2_11_0 -->
<g id="node335" class="node">
<title>expert_activation_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3836,-2210.95 3654,-2210.95 3654,-2157.95 3836,-2157.95 3836,-2210.95"/>
<text text-anchor="middle" x="3745" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3745" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3745" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_2_11_0&#45;&gt;expert_activation_2_11_0 -->
<g id="edge401" class="edge">
<title>expert_linear1_2_11_0&#45;&gt;expert_activation_2_11_0</title>
<path fill="none" stroke="black" d="M3612.14,-2246.94C3633.56,-2237.02 3658.26,-2225.6 3680.5,-2215.3"/>
<polygon fill="black" stroke="black" points="3682.26,-2218.34 3689.87,-2210.97 3679.32,-2211.99 3682.26,-2218.34"/>
</g>
<!-- expert_linear2_2_11_0 -->
<g id="node336" class="node">
<title>expert_linear2_2_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3841.5,-2121.95 3668.5,-2121.95 3668.5,-2068.95 3841.5,-2068.95 3841.5,-2121.95"/>
<text text-anchor="middle" x="3755" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="3755" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3755" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_2_11_0&#45;&gt;expert_linear2_2_11_0 -->
<g id="edge402" class="edge">
<title>expert_activation_2_11_0&#45;&gt;expert_linear2_2_11_0</title>
<path fill="none" stroke="black" d="M3747.95,-2157.82C3748.86,-2149.84 3749.89,-2140.89 3750.88,-2132.34"/>
<polygon fill="black" stroke="black" points="3754.38,-2132.54 3752.04,-2122.2 3747.42,-2131.74 3754.38,-2132.54"/>
</g>
<!-- expert_linear2_2_11_0&#45;&gt;aggregate_2 -->
<g id="edge491" class="edge">
<title>expert_linear2_2_11_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M3841.61,-2072.8C3848.15,-2071.42 3854.67,-2070.12 3861,-2068.95 4038.22,-2036.42 4243.27,-2011.89 4383.31,-1997.1"/>
<polygon fill="black" stroke="black" points="4383.69,-2000.57 4393.27,-1996.05 4382.96,-1993.61 4383.69,-2000.57"/>
</g>
<!-- expert_linear1_2_11_1 -->
<g id="node338" class="node">
<title>expert_linear1_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="3907,-2299.95 3725,-2299.95 3725,-2246.95 3907,-2246.95 3907,-2299.95"/>
<text text-anchor="middle" x="3816" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="3816" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3816" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_2_11_1&#45;&gt;expert_linear1_2_11_1 -->
<g id="edge404" class="edge">
<title>route_to_expert_2_11_1&#45;&gt;expert_linear1_2_11_1</title>
<path fill="none" stroke="black" d="M3781.32,-2336.23C3786.32,-2327.32 3791.66,-2317.82 3796.61,-2309"/>
<polygon fill="black" stroke="black" points="3799.75,-2310.54 3801.6,-2300.11 3793.65,-2307.12 3799.75,-2310.54"/>
</g>
<!-- expert_activation_2_11_1 -->
<g id="node339" class="node">
<title>expert_activation_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="4039,-2210.95 3857,-2210.95 3857,-2157.95 4039,-2157.95 4039,-2210.95"/>
<text text-anchor="middle" x="3948" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="3948" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3948" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_2_11_1&#45;&gt;expert_activation_2_11_1 -->
<g id="edge405" class="edge">
<title>expert_linear1_2_11_1&#45;&gt;expert_activation_2_11_1</title>
<path fill="none" stroke="black" d="M3854.89,-2246.82C3869.13,-2237.44 3885.41,-2226.71 3900.33,-2216.87"/>
<polygon fill="black" stroke="black" points="3902.51,-2219.63 3908.93,-2211.2 3898.66,-2213.78 3902.51,-2219.63"/>
</g>
<!-- expert_linear2_2_11_1 -->
<g id="node340" class="node">
<title>expert_linear2_2_11_1</title>
<polygon fill="lightgreen" stroke="black" points="4042.5,-2121.95 3869.5,-2121.95 3869.5,-2068.95 4042.5,-2068.95 4042.5,-2121.95"/>
<text text-anchor="middle" x="3956" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="3956" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3956" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_2_11_1&#45;&gt;expert_linear2_2_11_1 -->
<g id="edge406" class="edge">
<title>expert_activation_2_11_1&#45;&gt;expert_linear2_2_11_1</title>
<path fill="none" stroke="black" d="M3950.36,-2157.82C3951.09,-2149.84 3951.91,-2140.89 3952.7,-2132.34"/>
<polygon fill="black" stroke="black" points="3956.2,-2132.48 3953.63,-2122.2 3949.23,-2131.84 3956.2,-2132.48"/>
</g>
<!-- expert_linear2_2_11_1&#45;&gt;aggregate_2 -->
<g id="edge492" class="edge">
<title>expert_linear2_2_11_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4042.73,-2072.76C4048.57,-2071.43 4054.36,-2070.15 4060,-2068.95 4169.93,-2045.63 4294.6,-2023.3 4390.67,-2006.97"/>
<polygon fill="black" stroke="black" points="4391.49,-2010.38 4400.76,-2005.25 4390.32,-2003.48 4391.49,-2010.38"/>
</g>
<!-- expert_linear1_2_11_2 -->
<g id="node342" class="node">
<title>expert_linear1_2_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4162,-2299.95 3980,-2299.95 3980,-2246.95 4162,-2246.95 4162,-2299.95"/>
<text text-anchor="middle" x="4071" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="4071" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4071" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_2_11_2&#45;&gt;expert_linear1_2_11_2 -->
<g id="edge408" class="edge">
<title>route_to_expert_2_11_2&#45;&gt;expert_linear1_2_11_2</title>
<path fill="none" stroke="black" d="M4041.37,-2336.23C4045.59,-2327.42 4050.1,-2318.02 4054.29,-2309.28"/>
<polygon fill="black" stroke="black" points="4057.52,-2310.64 4058.69,-2300.11 4051.21,-2307.61 4057.52,-2310.64"/>
</g>
<!-- expert_activation_2_11_2 -->
<g id="node343" class="node">
<title>expert_activation_2_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4240,-2210.95 4058,-2210.95 4058,-2157.95 4240,-2157.95 4240,-2210.95"/>
<text text-anchor="middle" x="4149" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="4149" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4149" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_2_11_2&#45;&gt;expert_activation_2_11_2 -->
<g id="edge409" class="edge">
<title>expert_linear1_2_11_2&#45;&gt;expert_activation_2_11_2</title>
<path fill="none" stroke="black" d="M4093.98,-2246.82C4101.84,-2238.05 4110.76,-2228.1 4119.09,-2218.81"/>
<polygon fill="black" stroke="black" points="4121.84,-2220.99 4125.91,-2211.2 4116.63,-2216.31 4121.84,-2220.99"/>
</g>
<!-- expert_linear2_2_11_2 -->
<g id="node344" class="node">
<title>expert_linear2_2_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4241.5,-2121.95 4068.5,-2121.95 4068.5,-2068.95 4241.5,-2068.95 4241.5,-2121.95"/>
<text text-anchor="middle" x="4155" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="4155" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4155" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_2_11_2&#45;&gt;expert_linear2_2_11_2 -->
<g id="edge410" class="edge">
<title>expert_activation_2_11_2&#45;&gt;expert_linear2_2_11_2</title>
<path fill="none" stroke="black" d="M4150.77,-2157.82C4151.32,-2149.84 4151.94,-2140.89 4152.53,-2132.34"/>
<polygon fill="black" stroke="black" points="4156.03,-2132.42 4153.22,-2122.2 4149.04,-2131.94 4156.03,-2132.42"/>
</g>
<!-- expert_linear2_2_11_2&#45;&gt;aggregate_2 -->
<g id="edge493" class="edge">
<title>expert_linear2_2_11_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4241.68,-2069.55C4289.03,-2055.94 4348.94,-2038.73 4403.33,-2023.1"/>
<polygon fill="black" stroke="black" points="4404.42,-2026.43 4413.06,-2020.3 4402.49,-2019.7 4404.42,-2026.43"/>
</g>
<!-- expert_linear1_2_11_3 -->
<g id="node346" class="node">
<title>expert_linear1_2_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4410,-2299.95 4228,-2299.95 4228,-2246.95 4410,-2246.95 4410,-2299.95"/>
<text text-anchor="middle" x="4319" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4319" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4319" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_2_11_3&#45;&gt;expert_linear1_2_11_3 -->
<g id="edge412" class="edge">
<title>route_to_expert_2_11_3&#45;&gt;expert_linear1_2_11_3</title>
<path fill="none" stroke="black" d="M4298.92,-2335.95C4301.73,-2327.34 4304.72,-2318.19 4307.51,-2309.64"/>
<polygon fill="black" stroke="black" points="4310.89,-2310.56 4310.67,-2299.96 4304.24,-2308.38 4310.89,-2310.56"/>
</g>
<!-- expert_activation_2_11_3 -->
<g id="node347" class="node">
<title>expert_activation_2_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4441,-2210.95 4259,-2210.95 4259,-2157.95 4441,-2157.95 4441,-2210.95"/>
<text text-anchor="middle" x="4350" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4350" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4350" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_2_11_3&#45;&gt;expert_activation_2_11_3 -->
<g id="edge413" class="edge">
<title>expert_linear1_2_11_3&#45;&gt;expert_activation_2_11_3</title>
<path fill="none" stroke="black" d="M4328.13,-2246.82C4331.04,-2238.66 4334.31,-2229.49 4337.41,-2220.77"/>
<polygon fill="black" stroke="black" points="4340.77,-2221.8 4340.82,-2211.2 4334.17,-2219.45 4340.77,-2221.8"/>
</g>
<!-- expert_linear2_2_11_3 -->
<g id="node348" class="node">
<title>expert_linear2_2_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4441.5,-2121.95 4268.5,-2121.95 4268.5,-2068.95 4441.5,-2068.95 4441.5,-2121.95"/>
<text text-anchor="middle" x="4355" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4355" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4355" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_2_11_3&#45;&gt;expert_linear2_2_11_3 -->
<g id="edge414" class="edge">
<title>expert_activation_2_11_3&#45;&gt;expert_linear2_2_11_3</title>
<path fill="none" stroke="black" d="M4351.47,-2157.82C4351.93,-2149.84 4352.45,-2140.89 4352.94,-2132.34"/>
<polygon fill="black" stroke="black" points="4356.44,-2132.39 4353.52,-2122.2 4349.45,-2131.99 4356.44,-2132.39"/>
</g>
<!-- expert_linear2_2_11_3&#45;&gt;aggregate_2 -->
<g id="edge494" class="edge">
<title>expert_linear2_2_11_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4399.25,-2068.7C4414.89,-2059.59 4433.17,-2048.95 4451.5,-2038.28"/>
<polygon fill="black" stroke="black" points="4453.61,-2041.11 4460.49,-2033.05 4450.09,-2035.06 4453.61,-2041.11"/>
</g>
<!-- expert_linear1_2_12_0 -->
<g id="node350" class="node">
<title>expert_linear1_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4641,-2299.95 4459,-2299.95 4459,-2246.95 4641,-2246.95 4641,-2299.95"/>
<text text-anchor="middle" x="4550" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 16 Linear 1</text>
<text text-anchor="middle" x="4550" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4550" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_2_12_0&#45;&gt;expert_linear1_2_12_0 -->
<g id="edge416" class="edge">
<title>route_to_expert_2_12_0&#45;&gt;expert_linear1_2_12_0</title>
<path fill="none" stroke="black" d="M4550,-2335.95C4550,-2327.53 4550,-2318.59 4550,-2310.2"/>
<polygon fill="black" stroke="black" points="4553.5,-2309.96 4550,-2299.96 4546.5,-2309.96 4553.5,-2309.96"/>
</g>
<!-- expert_activation_2_12_0 -->
<g id="node351" class="node">
<title>expert_activation_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4641,-2210.95 4459,-2210.95 4459,-2157.95 4641,-2157.95 4641,-2210.95"/>
<text text-anchor="middle" x="4550" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 16 GELU</text>
<text text-anchor="middle" x="4550" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4550" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_2_12_0&#45;&gt;expert_activation_2_12_0 -->
<g id="edge417" class="edge">
<title>expert_linear1_2_12_0&#45;&gt;expert_activation_2_12_0</title>
<path fill="none" stroke="black" d="M4550,-2246.82C4550,-2238.84 4550,-2229.89 4550,-2221.34"/>
<polygon fill="black" stroke="black" points="4553.5,-2221.2 4550,-2211.2 4546.5,-2221.2 4553.5,-2221.2"/>
</g>
<!-- expert_linear2_2_12_0 -->
<g id="node352" class="node">
<title>expert_linear2_2_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4636.5,-2121.95 4463.5,-2121.95 4463.5,-2068.95 4636.5,-2068.95 4636.5,-2121.95"/>
<text text-anchor="middle" x="4550" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 16 Linear 2</text>
<text text-anchor="middle" x="4550" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4550" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_2_12_0&#45;&gt;expert_linear2_2_12_0 -->
<g id="edge418" class="edge">
<title>expert_activation_2_12_0&#45;&gt;expert_linear2_2_12_0</title>
<path fill="none" stroke="black" d="M4550,-2157.82C4550,-2149.84 4550,-2140.89 4550,-2132.34"/>
<polygon fill="black" stroke="black" points="4553.5,-2132.2 4550,-2122.2 4546.5,-2132.2 4553.5,-2132.2"/>
</g>
<!-- expert_linear2_2_12_0&#45;&gt;aggregate_2 -->
<g id="edge495" class="edge">
<title>expert_linear2_2_12_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4550,-2068.7C4550,-2061 4550,-2052.2 4550,-2043.22"/>
<polygon fill="black" stroke="black" points="4553.5,-2043.05 4550,-2033.05 4546.5,-2043.05 4553.5,-2043.05"/>
</g>
<!-- expert_linear1_2_12_1 -->
<g id="node354" class="node">
<title>expert_linear1_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4872,-2299.95 4690,-2299.95 4690,-2246.95 4872,-2246.95 4872,-2299.95"/>
<text text-anchor="middle" x="4781" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 17 Linear 1</text>
<text text-anchor="middle" x="4781" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4781" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_2_12_1&#45;&gt;expert_linear1_2_12_1 -->
<g id="edge420" class="edge">
<title>route_to_expert_2_12_1&#45;&gt;expert_linear1_2_12_1</title>
<path fill="none" stroke="black" d="M4801.08,-2335.95C4798.27,-2327.34 4795.28,-2318.19 4792.49,-2309.64"/>
<polygon fill="black" stroke="black" points="4795.76,-2308.38 4789.33,-2299.96 4789.11,-2310.56 4795.76,-2308.38"/>
</g>
<!-- expert_activation_2_12_1 -->
<g id="node355" class="node">
<title>expert_activation_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4862,-2210.95 4680,-2210.95 4680,-2157.95 4862,-2157.95 4862,-2210.95"/>
<text text-anchor="middle" x="4771" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 17 GELU</text>
<text text-anchor="middle" x="4771" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4771" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_2_12_1&#45;&gt;expert_activation_2_12_1 -->
<g id="edge421" class="edge">
<title>expert_linear1_2_12_1&#45;&gt;expert_activation_2_12_1</title>
<path fill="none" stroke="black" d="M4778.05,-2246.82C4777.14,-2238.84 4776.11,-2229.89 4775.12,-2221.34"/>
<polygon fill="black" stroke="black" points="4778.58,-2220.74 4773.96,-2211.2 4771.62,-2221.54 4778.58,-2220.74"/>
</g>
<!-- expert_linear2_2_12_1 -->
<g id="node356" class="node">
<title>expert_linear2_2_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4847.5,-2121.95 4674.5,-2121.95 4674.5,-2068.95 4847.5,-2068.95 4847.5,-2121.95"/>
<text text-anchor="middle" x="4761" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 17 Linear 2</text>
<text text-anchor="middle" x="4761" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4761" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_2_12_1&#45;&gt;expert_linear2_2_12_1 -->
<g id="edge422" class="edge">
<title>expert_activation_2_12_1&#45;&gt;expert_linear2_2_12_1</title>
<path fill="none" stroke="black" d="M4768.05,-2157.82C4767.14,-2149.84 4766.11,-2140.89 4765.12,-2132.34"/>
<polygon fill="black" stroke="black" points="4768.58,-2131.74 4763.96,-2122.2 4761.62,-2132.54 4768.58,-2131.74"/>
</g>
<!-- expert_linear2_2_12_1&#45;&gt;aggregate_2 -->
<g id="edge496" class="edge">
<title>expert_linear2_2_12_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4713.38,-2068.84C4696.23,-2059.61 4676.12,-2048.8 4655.99,-2037.97"/>
<polygon fill="black" stroke="black" points="4657.52,-2034.82 4647.06,-2033.16 4654.21,-2040.98 4657.52,-2034.82"/>
</g>
<!-- expert_linear1_2_12_2 -->
<g id="node358" class="node">
<title>expert_linear1_2_12_2</title>
<polygon fill="lightgreen" stroke="black" points="5119,-2299.95 4937,-2299.95 4937,-2246.95 5119,-2246.95 5119,-2299.95"/>
<text text-anchor="middle" x="5028" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 18 Linear 1</text>
<text text-anchor="middle" x="5028" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5028" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_2_12_2&#45;&gt;expert_linear1_2_12_2 -->
<g id="edge424" class="edge">
<title>route_to_expert_2_12_2&#45;&gt;expert_linear1_2_12_2</title>
<path fill="none" stroke="black" d="M5058.26,-2336.23C5053.95,-2327.42 5049.34,-2318.02 5045.06,-2309.28"/>
<polygon fill="black" stroke="black" points="5048.11,-2307.55 5040.57,-2300.11 5041.83,-2310.63 5048.11,-2307.55"/>
</g>
<!-- expert_activation_2_12_2 -->
<g id="node359" class="node">
<title>expert_activation_2_12_2</title>
<polygon fill="lightgreen" stroke="black" points="5100,-2210.95 4918,-2210.95 4918,-2157.95 5100,-2157.95 5100,-2210.95"/>
<text text-anchor="middle" x="5009" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 18 GELU</text>
<text text-anchor="middle" x="5009" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5009" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_2_12_2&#45;&gt;expert_activation_2_12_2 -->
<g id="edge425" class="edge">
<title>expert_linear1_2_12_2&#45;&gt;expert_activation_2_12_2</title>
<path fill="none" stroke="black" d="M5022.4,-2246.82C5020.64,-2238.75 5018.66,-2229.69 5016.78,-2221.06"/>
<polygon fill="black" stroke="black" points="5020.18,-2220.23 5014.62,-2211.2 5013.34,-2221.72 5020.18,-2220.23"/>
</g>
<!-- expert_linear2_2_12_2 -->
<g id="node360" class="node">
<title>expert_linear2_2_12_2</title>
<polygon fill="lightgreen" stroke="black" points="5076.5,-2121.95 4903.5,-2121.95 4903.5,-2068.95 5076.5,-2068.95 5076.5,-2121.95"/>
<text text-anchor="middle" x="4990" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 18 Linear 2</text>
<text text-anchor="middle" x="4990" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4990" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_2_12_2&#45;&gt;expert_linear2_2_12_2 -->
<g id="edge426" class="edge">
<title>expert_activation_2_12_2&#45;&gt;expert_linear2_2_12_2</title>
<path fill="none" stroke="black" d="M5003.4,-2157.82C5001.64,-2149.75 4999.66,-2140.69 4997.78,-2132.06"/>
<polygon fill="black" stroke="black" points="5001.18,-2131.23 4995.62,-2122.2 4994.34,-2132.72 5001.18,-2131.23"/>
</g>
<!-- expert_linear2_2_12_2&#45;&gt;aggregate_2 -->
<g id="edge497" class="edge">
<title>expert_linear2_2_12_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M4903.33,-2072.1C4862.41,-2061.54 4811.6,-2048.43 4761.39,-2035.48"/>
<polygon fill="black" stroke="black" points="4762.25,-2032.09 4751.69,-2032.98 4760.5,-2038.87 4762.25,-2032.09"/>
</g>
<!-- expert_linear1_2_12_3 -->
<g id="node362" class="node">
<title>expert_linear1_2_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5374,-2299.95 5192,-2299.95 5192,-2246.95 5374,-2246.95 5374,-2299.95"/>
<text text-anchor="middle" x="5283" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 19 Linear 1</text>
<text text-anchor="middle" x="5283" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5283" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_2_12_3&#45;&gt;expert_linear1_2_12_3 -->
<g id="edge428" class="edge">
<title>route_to_expert_2_12_3&#45;&gt;expert_linear1_2_12_3</title>
<path fill="none" stroke="black" d="M5318.31,-2336.23C5313.22,-2327.32 5307.79,-2317.82 5302.74,-2309"/>
<polygon fill="black" stroke="black" points="5305.67,-2307.05 5297.66,-2300.11 5299.59,-2310.53 5305.67,-2307.05"/>
</g>
<!-- expert_activation_2_12_3 -->
<g id="node363" class="node">
<title>expert_activation_2_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5349,-2210.95 5167,-2210.95 5167,-2157.95 5349,-2157.95 5349,-2210.95"/>
<text text-anchor="middle" x="5258" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 19 GELU</text>
<text text-anchor="middle" x="5258" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5258" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_2_12_3&#45;&gt;expert_activation_2_12_3 -->
<g id="edge429" class="edge">
<title>expert_linear1_2_12_3&#45;&gt;expert_activation_2_12_3</title>
<path fill="none" stroke="black" d="M5275.63,-2246.82C5273.32,-2238.75 5270.71,-2229.69 5268.23,-2221.06"/>
<polygon fill="black" stroke="black" points="5271.53,-2219.85 5265.4,-2211.2 5264.8,-2221.78 5271.53,-2219.85"/>
</g>
<!-- expert_linear2_2_12_3 -->
<g id="node364" class="node">
<title>expert_linear2_2_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5318.5,-2121.95 5145.5,-2121.95 5145.5,-2068.95 5318.5,-2068.95 5318.5,-2121.95"/>
<text text-anchor="middle" x="5232" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 19 Linear 2</text>
<text text-anchor="middle" x="5232" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5232" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_2_12_3&#45;&gt;expert_linear2_2_12_3 -->
<g id="edge430" class="edge">
<title>expert_activation_2_12_3&#45;&gt;expert_linear2_2_12_3</title>
<path fill="none" stroke="black" d="M5250.34,-2157.82C5247.93,-2149.75 5245.22,-2140.69 5242.64,-2132.06"/>
<polygon fill="black" stroke="black" points="5245.91,-2130.78 5239.7,-2122.2 5239.21,-2132.79 5245.91,-2130.78"/>
</g>
<!-- expert_linear2_2_12_3&#45;&gt;aggregate_2 -->
<g id="edge498" class="edge">
<title>expert_linear2_2_12_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M5145.17,-2079.14C5125.71,-2075.75 5105.15,-2072.2 5086,-2068.95 4977.46,-2050.57 4856.45,-2030.65 4756.92,-2014.42"/>
<polygon fill="black" stroke="black" points="4757.48,-2010.97 4747.05,-2012.81 4756.36,-2017.88 4757.48,-2010.97"/>
</g>
<!-- expert_linear1_2_13_0 -->
<g id="node366" class="node">
<title>expert_linear1_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5633,-2299.95 5451,-2299.95 5451,-2246.95 5633,-2246.95 5633,-2299.95"/>
<text text-anchor="middle" x="5542" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 20 Linear 1</text>
<text text-anchor="middle" x="5542" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5542" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_2_13_0&#45;&gt;expert_linear1_2_13_0 -->
<g id="edge432" class="edge">
<title>route_to_expert_2_13_0&#45;&gt;expert_linear1_2_13_0</title>
<path fill="none" stroke="black" d="M5580,-2336.5C5574.43,-2327.41 5568.46,-2317.67 5562.95,-2308.66"/>
<polygon fill="black" stroke="black" points="5565.82,-2306.65 5557.62,-2299.95 5559.85,-2310.31 5565.82,-2306.65"/>
</g>
<!-- expert_activation_2_13_0 -->
<g id="node367" class="node">
<title>expert_activation_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5604,-2210.95 5422,-2210.95 5422,-2157.95 5604,-2157.95 5604,-2210.95"/>
<text text-anchor="middle" x="5513" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 20 GELU</text>
<text text-anchor="middle" x="5513" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5513" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_2_13_0&#45;&gt;expert_activation_2_13_0 -->
<g id="edge433" class="edge">
<title>expert_linear1_2_13_0&#45;&gt;expert_activation_2_13_0</title>
<path fill="none" stroke="black" d="M5533.46,-2246.82C5530.74,-2238.66 5527.68,-2229.49 5524.77,-2220.77"/>
<polygon fill="black" stroke="black" points="5528.07,-2219.58 5521.58,-2211.2 5521.43,-2221.8 5528.07,-2219.58"/>
</g>
<!-- expert_linear2_2_13_0 -->
<g id="node368" class="node">
<title>expert_linear2_2_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5568.5,-2121.95 5395.5,-2121.95 5395.5,-2068.95 5568.5,-2068.95 5568.5,-2121.95"/>
<text text-anchor="middle" x="5482" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 20 Linear 2</text>
<text text-anchor="middle" x="5482" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5482" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_2_13_0&#45;&gt;expert_linear2_2_13_0 -->
<g id="edge434" class="edge">
<title>expert_activation_2_13_0&#45;&gt;expert_linear2_2_13_0</title>
<path fill="none" stroke="black" d="M5503.87,-2157.82C5500.96,-2149.66 5497.69,-2140.49 5494.59,-2131.77"/>
<polygon fill="black" stroke="black" points="5497.83,-2130.45 5491.18,-2122.2 5491.23,-2132.8 5497.83,-2130.45"/>
</g>
<!-- expert_linear2_2_13_0&#45;&gt;aggregate_2 -->
<g id="edge499" class="edge">
<title>expert_linear2_2_13_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M5395.38,-2079.31C5373.43,-2075.69 5349.88,-2072 5328,-2068.95 5130.56,-2041.46 4904.01,-2016.59 4746.5,-2000.35"/>
<polygon fill="black" stroke="black" points="4746.53,-1996.84 4736.22,-1999.3 4745.81,-2003.8 4746.53,-1996.84"/>
</g>
<!-- expert_linear1_2_13_1 -->
<g id="node370" class="node">
<title>expert_linear1_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5894,-2299.95 5712,-2299.95 5712,-2246.95 5894,-2246.95 5894,-2299.95"/>
<text text-anchor="middle" x="5803" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 21 Linear 1</text>
<text text-anchor="middle" x="5803" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5803" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_2_13_1&#45;&gt;expert_linear1_2_13_1 -->
<g id="edge436" class="edge">
<title>route_to_expert_2_13_1&#45;&gt;expert_linear1_2_13_1</title>
<path fill="none" stroke="black" d="M5842.27,-2336.5C5836.51,-2327.41 5830.35,-2317.67 5824.65,-2308.66"/>
<polygon fill="black" stroke="black" points="5827.44,-2306.53 5819.14,-2299.95 5821.53,-2310.28 5827.44,-2306.53"/>
</g>
<!-- expert_activation_2_13_1 -->
<g id="node371" class="node">
<title>expert_activation_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5864,-2210.95 5682,-2210.95 5682,-2157.95 5864,-2157.95 5864,-2210.95"/>
<text text-anchor="middle" x="5773" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 21 GELU</text>
<text text-anchor="middle" x="5773" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5773" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_2_13_1&#45;&gt;expert_activation_2_13_1 -->
<g id="edge437" class="edge">
<title>expert_linear1_2_13_1&#45;&gt;expert_activation_2_13_1</title>
<path fill="none" stroke="black" d="M5794.16,-2246.82C5791.35,-2238.66 5788.19,-2229.49 5785.18,-2220.77"/>
<polygon fill="black" stroke="black" points="5788.45,-2219.52 5781.88,-2211.2 5781.83,-2221.8 5788.45,-2219.52"/>
</g>
<!-- expert_linear2_2_13_1 -->
<g id="node372" class="node">
<title>expert_linear2_2_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5824.5,-2121.95 5651.5,-2121.95 5651.5,-2068.95 5824.5,-2068.95 5824.5,-2121.95"/>
<text text-anchor="middle" x="5738" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 21 Linear 2</text>
<text text-anchor="middle" x="5738" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5738" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_2_13_1&#45;&gt;expert_linear2_2_13_1 -->
<g id="edge438" class="edge">
<title>expert_activation_2_13_1&#45;&gt;expert_linear2_2_13_1</title>
<path fill="none" stroke="black" d="M5762.69,-2157.82C5759.37,-2149.58 5755.64,-2140.29 5752.1,-2131.49"/>
<polygon fill="black" stroke="black" points="5755.34,-2130.17 5748.36,-2122.2 5748.84,-2132.79 5755.34,-2130.17"/>
</g>
<!-- expert_linear2_2_13_1&#45;&gt;aggregate_2 -->
<g id="edge500" class="edge">
<title>expert_linear2_2_13_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M5651.39,-2079.47C5627.65,-2075.69 5601.87,-2071.87 5578,-2068.95 5286.73,-2033.32 4947.28,-2007.26 4740.59,-1993.11"/>
<polygon fill="black" stroke="black" points="4740.76,-1989.61 4730.54,-1992.42 4740.28,-1996.59 4740.76,-1989.61"/>
</g>
<!-- expert_linear1_2_13_2 -->
<g id="node374" class="node">
<title>expert_linear1_2_13_2</title>
<polygon fill="lightgreen" stroke="black" points="6156,-2299.95 5974,-2299.95 5974,-2246.95 6156,-2246.95 6156,-2299.95"/>
<text text-anchor="middle" x="6065" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 22 Linear 1</text>
<text text-anchor="middle" x="6065" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6065" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_2_13_2&#45;&gt;expert_linear1_2_13_2 -->
<g id="edge440" class="edge">
<title>route_to_expert_2_13_2&#45;&gt;expert_linear1_2_13_2</title>
<path fill="none" stroke="black" d="M6104.9,-2336.5C6098.99,-2327.32 6092.66,-2317.47 6086.82,-2308.38"/>
<polygon fill="black" stroke="black" points="6089.75,-2306.47 6081.4,-2299.95 6083.86,-2310.26 6089.75,-2306.47"/>
</g>
<!-- expert_activation_2_13_2 -->
<g id="node375" class="node">
<title>expert_activation_2_13_2</title>
<polygon fill="lightgreen" stroke="black" points="6129,-2210.95 5947,-2210.95 5947,-2157.95 6129,-2157.95 6129,-2210.95"/>
<text text-anchor="middle" x="6038" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 22 GELU</text>
<text text-anchor="middle" x="6038" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6038" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_2_13_2&#45;&gt;expert_activation_2_13_2 -->
<g id="edge441" class="edge">
<title>expert_linear1_2_13_2&#45;&gt;expert_activation_2_13_2</title>
<path fill="none" stroke="black" d="M6057.05,-2246.82C6054.51,-2238.66 6051.67,-2229.49 6048.96,-2220.77"/>
<polygon fill="black" stroke="black" points="6052.3,-2219.72 6045.99,-2211.2 6045.61,-2221.79 6052.3,-2219.72"/>
</g>
<!-- expert_linear2_2_13_2 -->
<g id="node376" class="node">
<title>expert_linear2_2_13_2</title>
<polygon fill="lightgreen" stroke="black" points="6083.5,-2121.95 5910.5,-2121.95 5910.5,-2068.95 6083.5,-2068.95 6083.5,-2121.95"/>
<text text-anchor="middle" x="5997" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 22 Linear 2</text>
<text text-anchor="middle" x="5997" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5997" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_2_13_2&#45;&gt;expert_linear2_2_13_2 -->
<g id="edge442" class="edge">
<title>expert_activation_2_13_2&#45;&gt;expert_linear2_2_13_2</title>
<path fill="none" stroke="black" d="M6025.92,-2157.82C6022.03,-2149.58 6017.66,-2140.29 6013.51,-2131.49"/>
<polygon fill="black" stroke="black" points="6016.56,-2129.76 6009.13,-2122.2 6010.23,-2132.74 6016.56,-2129.76"/>
</g>
<!-- expert_linear2_2_13_2&#45;&gt;aggregate_2 -->
<g id="edge501" class="edge">
<title>expert_linear2_2_13_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M5910.48,-2079.49C5885.83,-2075.61 5858.91,-2071.75 5834,-2068.95 5445.26,-2025.31 4987.71,-2000.2 4737.27,-1988.69"/>
<polygon fill="black" stroke="black" points="4737.13,-1985.18 4726.98,-1988.22 4736.81,-1992.17 4737.13,-1985.18"/>
</g>
<!-- expert_linear1_2_13_3 -->
<g id="node378" class="node">
<title>expert_linear1_2_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6419,-2299.95 6237,-2299.95 6237,-2246.95 6419,-2246.95 6419,-2299.95"/>
<text text-anchor="middle" x="6328" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 23 Linear 1</text>
<text text-anchor="middle" x="6328" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6328" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_2_13_3&#45;&gt;expert_linear1_2_13_3 -->
<g id="edge444" class="edge">
<title>route_to_expert_2_13_3&#45;&gt;expert_linear1_2_13_3</title>
<path fill="none" stroke="black" d="M6367.9,-2336.5C6361.99,-2327.32 6355.66,-2317.47 6349.82,-2308.38"/>
<polygon fill="black" stroke="black" points="6352.75,-2306.47 6344.4,-2299.95 6346.86,-2310.26 6352.75,-2306.47"/>
</g>
<!-- expert_activation_2_13_3 -->
<g id="node379" class="node">
<title>expert_activation_2_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6360,-2210.95 6178,-2210.95 6178,-2157.95 6360,-2157.95 6360,-2210.95"/>
<text text-anchor="middle" x="6269" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 23 GELU</text>
<text text-anchor="middle" x="6269" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6269" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_2_13_3&#45;&gt;expert_activation_2_13_3 -->
<g id="edge445" class="edge">
<title>expert_linear1_2_13_3&#45;&gt;expert_activation_2_13_3</title>
<path fill="none" stroke="black" d="M6310.62,-2246.82C6304.85,-2238.31 6298.33,-2228.7 6292.19,-2219.65"/>
<polygon fill="black" stroke="black" points="6294.97,-2217.51 6286.46,-2211.2 6289.18,-2221.44 6294.97,-2217.51"/>
</g>
<!-- expert_linear2_2_13_3 -->
<g id="node380" class="node">
<title>expert_linear2_2_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6328.5,-2121.95 6155.5,-2121.95 6155.5,-2068.95 6328.5,-2068.95 6328.5,-2121.95"/>
<text text-anchor="middle" x="6242" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 23 Linear 2</text>
<text text-anchor="middle" x="6242" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6242" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_2_13_3&#45;&gt;expert_linear2_2_13_3 -->
<g id="edge446" class="edge">
<title>expert_activation_2_13_3&#45;&gt;expert_linear2_2_13_3</title>
<path fill="none" stroke="black" d="M6261.05,-2157.82C6258.51,-2149.66 6255.67,-2140.49 6252.96,-2131.77"/>
<polygon fill="black" stroke="black" points="6256.3,-2130.72 6249.99,-2122.2 6249.61,-2132.79 6256.3,-2130.72"/>
</g>
<!-- expert_linear2_2_13_3&#45;&gt;aggregate_2 -->
<g id="edge502" class="edge">
<title>expert_linear2_2_13_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M6155.17,-2077.9C6134.84,-2074.5 6113.21,-2071.25 6093,-2068.95 5604.09,-2013.35 5023.83,-1992.25 4733.99,-1984.76"/>
<polygon fill="black" stroke="black" points="4733.89,-1981.25 4723.8,-1984.5 4733.71,-1988.25 4733.89,-1981.25"/>
</g>
<!-- expert_linear1_2_14_0 -->
<g id="node382" class="node">
<title>expert_linear1_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6682,-2299.95 6500,-2299.95 6500,-2246.95 6682,-2246.95 6682,-2299.95"/>
<text text-anchor="middle" x="6591" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 24 Linear 1</text>
<text text-anchor="middle" x="6591" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6591" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_2_14_0&#45;&gt;expert_linear1_2_14_0 -->
<g id="edge448" class="edge">
<title>route_to_expert_2_14_0&#45;&gt;expert_linear1_2_14_0</title>
<path fill="none" stroke="black" d="M6630.9,-2336.5C6624.99,-2327.32 6618.66,-2317.47 6612.82,-2308.38"/>
<polygon fill="black" stroke="black" points="6615.75,-2306.47 6607.4,-2299.95 6609.86,-2310.26 6615.75,-2306.47"/>
</g>
<!-- expert_activation_2_14_0 -->
<g id="node383" class="node">
<title>expert_activation_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6652,-2210.95 6470,-2210.95 6470,-2157.95 6652,-2157.95 6652,-2210.95"/>
<text text-anchor="middle" x="6561" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 24 GELU</text>
<text text-anchor="middle" x="6561" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6561" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_2_14_0&#45;&gt;expert_activation_2_14_0 -->
<g id="edge449" class="edge">
<title>expert_linear1_2_14_0&#45;&gt;expert_activation_2_14_0</title>
<path fill="none" stroke="black" d="M6582.16,-2246.82C6579.35,-2238.66 6576.19,-2229.49 6573.18,-2220.77"/>
<polygon fill="black" stroke="black" points="6576.45,-2219.52 6569.88,-2211.2 6569.83,-2221.8 6576.45,-2219.52"/>
</g>
<!-- expert_linear2_2_14_0 -->
<g id="node384" class="node">
<title>expert_linear2_2_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6598.5,-2121.95 6425.5,-2121.95 6425.5,-2068.95 6598.5,-2068.95 6598.5,-2121.95"/>
<text text-anchor="middle" x="6512" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 24 Linear 2</text>
<text text-anchor="middle" x="6512" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6512" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_2_14_0&#45;&gt;expert_linear2_2_14_0 -->
<g id="edge450" class="edge">
<title>expert_activation_2_14_0&#45;&gt;expert_linear2_2_14_0</title>
<path fill="none" stroke="black" d="M6546.56,-2157.82C6541.82,-2149.4 6536.47,-2139.9 6531.42,-2130.93"/>
<polygon fill="black" stroke="black" points="6534.46,-2129.2 6526.5,-2122.2 6528.36,-2132.63 6534.46,-2129.2"/>
</g>
<!-- expert_linear2_2_14_0&#45;&gt;aggregate_2 -->
<g id="edge503" class="edge">
<title>expert_linear2_2_14_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M6425.47,-2080.09C6397.61,-2075.92 6366.56,-2071.74 6338,-2068.95 5753.73,-2011.9 5058.26,-1991.13 4733.76,-1984.16"/>
<polygon fill="black" stroke="black" points="4733.39,-1980.65 4723.32,-1983.94 4733.25,-1987.65 4733.39,-1980.65"/>
</g>
<!-- expert_linear1_2_14_1 -->
<g id="node386" class="node">
<title>expert_linear1_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6945,-2299.95 6763,-2299.95 6763,-2246.95 6945,-2246.95 6945,-2299.95"/>
<text text-anchor="middle" x="6854" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 25 Linear 1</text>
<text text-anchor="middle" x="6854" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6854" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_2_14_1&#45;&gt;expert_linear1_2_14_1 -->
<g id="edge452" class="edge">
<title>route_to_expert_2_14_1&#45;&gt;expert_linear1_2_14_1</title>
<path fill="none" stroke="black" d="M6893.9,-2336.5C6887.99,-2327.32 6881.66,-2317.47 6875.82,-2308.38"/>
<polygon fill="black" stroke="black" points="6878.75,-2306.47 6870.4,-2299.95 6872.86,-2310.26 6878.75,-2306.47"/>
</g>
<!-- expert_activation_2_14_1 -->
<g id="node387" class="node">
<title>expert_activation_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6883,-2210.95 6701,-2210.95 6701,-2157.95 6883,-2157.95 6883,-2210.95"/>
<text text-anchor="middle" x="6792" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 25 GELU</text>
<text text-anchor="middle" x="6792" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6792" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_2_14_1&#45;&gt;expert_activation_2_14_1 -->
<g id="edge453" class="edge">
<title>expert_linear1_2_14_1&#45;&gt;expert_activation_2_14_1</title>
<path fill="none" stroke="black" d="M6835.73,-2246.82C6829.61,-2238.22 6822.68,-2228.5 6816.17,-2219.37"/>
<polygon fill="black" stroke="black" points="6819,-2217.32 6810.35,-2211.2 6813.3,-2221.38 6819,-2217.32"/>
</g>
<!-- expert_linear2_2_14_1 -->
<g id="node388" class="node">
<title>expert_linear2_2_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6848.5,-2121.95 6675.5,-2121.95 6675.5,-2068.95 6848.5,-2068.95 6848.5,-2121.95"/>
<text text-anchor="middle" x="6762" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 25 Linear 2</text>
<text text-anchor="middle" x="6762" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6762" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_2_14_1&#45;&gt;expert_linear2_2_14_1 -->
<g id="edge454" class="edge">
<title>expert_activation_2_14_1&#45;&gt;expert_linear2_2_14_1</title>
<path fill="none" stroke="black" d="M6783.16,-2157.82C6780.35,-2149.66 6777.19,-2140.49 6774.18,-2131.77"/>
<polygon fill="black" stroke="black" points="6777.45,-2130.52 6770.88,-2122.2 6770.83,-2132.8 6777.45,-2130.52"/>
</g>
<!-- expert_linear2_2_14_1&#45;&gt;aggregate_2 -->
<g id="edge504" class="edge">
<title>expert_linear2_2_14_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M6675.1,-2078.17C6653.27,-2074.6 6629.83,-2071.22 6608,-2068.95 5917.45,-1997.28 5090.74,-1983.71 4731.49,-1981.33"/>
<polygon fill="black" stroke="black" points="4731.29,-1977.83 4721.26,-1981.27 4731.24,-1984.83 4731.29,-1977.83"/>
</g>
<!-- expert_linear1_2_14_2 -->
<g id="node390" class="node">
<title>expert_linear1_2_14_2</title>
<polygon fill="lightgreen" stroke="black" points="7240,-2299.95 7058,-2299.95 7058,-2246.95 7240,-2246.95 7240,-2299.95"/>
<text text-anchor="middle" x="7149" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 26 Linear 1</text>
<text text-anchor="middle" x="7149" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7149" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_2_14_2&#45;&gt;expert_linear1_2_14_2 -->
<g id="edge456" class="edge">
<title>route_to_expert_2_14_2&#45;&gt;expert_linear1_2_14_2</title>
<path fill="none" stroke="black" d="M7168.46,-2335.95C7165.73,-2327.34 7162.84,-2318.19 7160.13,-2309.64"/>
<polygon fill="black" stroke="black" points="7163.43,-2308.44 7157.07,-2299.96 7156.75,-2310.55 7163.43,-2308.44"/>
</g>
<!-- expert_activation_2_14_2 -->
<g id="node391" class="node">
<title>expert_activation_2_14_2</title>
<polygon fill="lightgreen" stroke="black" points="7191,-2210.95 7009,-2210.95 7009,-2157.95 7191,-2157.95 7191,-2210.95"/>
<text text-anchor="middle" x="7100" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 26 GELU</text>
<text text-anchor="middle" x="7100" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7100" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_2_14_2&#45;&gt;expert_activation_2_14_2 -->
<g id="edge457" class="edge">
<title>expert_linear1_2_14_2&#45;&gt;expert_activation_2_14_2</title>
<path fill="none" stroke="black" d="M7134.56,-2246.82C7129.82,-2238.4 7124.47,-2228.9 7119.42,-2219.93"/>
<polygon fill="black" stroke="black" points="7122.46,-2218.2 7114.5,-2211.2 7116.36,-2221.63 7122.46,-2218.2"/>
</g>
<!-- expert_linear2_2_14_2 -->
<g id="node392" class="node">
<title>expert_linear2_2_14_2</title>
<polygon fill="lightgreen" stroke="black" points="7137.5,-2121.95 6964.5,-2121.95 6964.5,-2068.95 7137.5,-2068.95 7137.5,-2121.95"/>
<text text-anchor="middle" x="7051" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 26 Linear 2</text>
<text text-anchor="middle" x="7051" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7051" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_2_14_2&#45;&gt;expert_linear2_2_14_2 -->
<g id="edge458" class="edge">
<title>expert_activation_2_14_2&#45;&gt;expert_linear2_2_14_2</title>
<path fill="none" stroke="black" d="M7085.56,-2157.82C7080.82,-2149.4 7075.47,-2139.9 7070.42,-2130.93"/>
<polygon fill="black" stroke="black" points="7073.46,-2129.2 7065.5,-2122.2 7067.36,-2132.63 7073.46,-2129.2"/>
</g>
<!-- expert_linear2_2_14_2&#45;&gt;aggregate_2 -->
<g id="edge505" class="edge">
<title>expert_linear2_2_14_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M6964.24,-2081.24C6931.07,-2076.65 6892.86,-2071.91 6858,-2068.95 6068.4,-2001.89 5122.49,-1985.92 4732.14,-1982.13"/>
<polygon fill="black" stroke="black" points="4731.92,-1978.63 4721.89,-1982.03 4731.85,-1985.63 4731.92,-1978.63"/>
</g>
<!-- expert_linear1_2_14_3 -->
<g id="node394" class="node">
<title>expert_linear1_2_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7487,-2299.95 7305,-2299.95 7305,-2246.95 7487,-2246.95 7487,-2299.95"/>
<text text-anchor="middle" x="7396" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 27 Linear 1</text>
<text text-anchor="middle" x="7396" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7396" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_2_14_3&#45;&gt;expert_linear1_2_14_3 -->
<g id="edge460" class="edge">
<title>route_to_expert_2_14_3&#45;&gt;expert_linear1_2_14_3</title>
<path fill="none" stroke="black" d="M7425.63,-2336.23C7421.41,-2327.42 7416.9,-2318.02 7412.71,-2309.28"/>
<polygon fill="black" stroke="black" points="7415.79,-2307.61 7408.31,-2300.11 7409.48,-2310.64 7415.79,-2307.61"/>
</g>
<!-- expert_activation_2_14_3 -->
<g id="node395" class="node">
<title>expert_activation_2_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7464,-2210.95 7282,-2210.95 7282,-2157.95 7464,-2157.95 7464,-2210.95"/>
<text text-anchor="middle" x="7373" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 27 GELU</text>
<text text-anchor="middle" x="7373" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7373" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_2_14_3&#45;&gt;expert_activation_2_14_3 -->
<g id="edge461" class="edge">
<title>expert_linear1_2_14_3&#45;&gt;expert_activation_2_14_3</title>
<path fill="none" stroke="black" d="M7389.22,-2246.82C7387.09,-2238.75 7384.69,-2229.69 7382.41,-2221.06"/>
<polygon fill="black" stroke="black" points="7385.75,-2219.98 7379.81,-2211.2 7378.98,-2221.77 7385.75,-2219.98"/>
</g>
<!-- expert_linear2_2_14_3 -->
<g id="node396" class="node">
<title>expert_linear2_2_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7382.5,-2121.95 7209.5,-2121.95 7209.5,-2068.95 7382.5,-2068.95 7382.5,-2121.95"/>
<text text-anchor="middle" x="7296" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 27 Linear 2</text>
<text text-anchor="middle" x="7296" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7296" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_2_14_3&#45;&gt;expert_linear2_2_14_3 -->
<g id="edge462" class="edge">
<title>expert_activation_2_14_3&#45;&gt;expert_linear2_2_14_3</title>
<path fill="none" stroke="black" d="M7350.31,-2157.82C7342.55,-2149.05 7333.75,-2139.1 7325.53,-2129.81"/>
<polygon fill="black" stroke="black" points="7328.04,-2127.37 7318.79,-2122.2 7322.8,-2132.01 7328.04,-2127.37"/>
</g>
<!-- expert_linear2_2_14_3&#45;&gt;aggregate_2 -->
<g id="edge506" class="edge">
<title>expert_linear2_2_14_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M7209.21,-2077.56C7188.87,-2074.17 7167.23,-2071.02 7147,-2068.95 6678.03,-2021.1 5244,-1992.73 4733.13,-1983.93"/>
<polygon fill="black" stroke="black" points="4733.14,-1980.42 4723.08,-1983.75 4733.02,-1987.42 4733.14,-1980.42"/>
</g>
<!-- expert_linear1_2_15_0 -->
<g id="node398" class="node">
<title>expert_linear1_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7742,-2299.95 7560,-2299.95 7560,-2246.95 7742,-2246.95 7742,-2299.95"/>
<text text-anchor="middle" x="7651" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 28 Linear 1</text>
<text text-anchor="middle" x="7651" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7651" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_2_15_0&#45;&gt;expert_linear1_2_15_0 -->
<g id="edge464" class="edge">
<title>route_to_expert_2_15_0&#45;&gt;expert_linear1_2_15_0</title>
<path fill="none" stroke="black" d="M7685.68,-2336.23C7680.68,-2327.32 7675.34,-2317.82 7670.39,-2309"/>
<polygon fill="black" stroke="black" points="7673.35,-2307.12 7665.4,-2300.11 7667.25,-2310.54 7673.35,-2307.12"/>
</g>
<!-- expert_activation_2_15_0 -->
<g id="node399" class="node">
<title>expert_activation_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7715,-2210.95 7533,-2210.95 7533,-2157.95 7715,-2157.95 7715,-2210.95"/>
<text text-anchor="middle" x="7624" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 28 GELU</text>
<text text-anchor="middle" x="7624" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7624" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_2_15_0&#45;&gt;expert_activation_2_15_0 -->
<g id="edge465" class="edge">
<title>expert_linear1_2_15_0&#45;&gt;expert_activation_2_15_0</title>
<path fill="none" stroke="black" d="M7643.05,-2246.82C7640.51,-2238.66 7637.67,-2229.49 7634.96,-2220.77"/>
<polygon fill="black" stroke="black" points="7638.3,-2219.72 7631.99,-2211.2 7631.61,-2221.79 7638.3,-2219.72"/>
</g>
<!-- expert_linear2_2_15_0 -->
<g id="node400" class="node">
<title>expert_linear2_2_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7640.5,-2121.95 7467.5,-2121.95 7467.5,-2068.95 7640.5,-2068.95 7640.5,-2121.95"/>
<text text-anchor="middle" x="7554" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 28 Linear 2</text>
<text text-anchor="middle" x="7554" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7554" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_2_15_0&#45;&gt;expert_linear2_2_15_0 -->
<g id="edge466" class="edge">
<title>expert_activation_2_15_0&#45;&gt;expert_linear2_2_15_0</title>
<path fill="none" stroke="black" d="M7603.38,-2157.82C7596.39,-2149.14 7588.48,-2139.3 7581.07,-2130.09"/>
<polygon fill="black" stroke="black" points="7583.71,-2127.8 7574.72,-2122.2 7578.26,-2132.19 7583.71,-2127.8"/>
</g>
<!-- expert_linear2_2_15_0&#45;&gt;aggregate_2 -->
<g id="edge507" class="edge">
<title>expert_linear2_2_15_0&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M7467.24,-2078.75C7442.97,-2074.91 7416.52,-2071.25 7392,-2068.95 6873.12,-2020.27 5276.75,-1992.03 4733.34,-1983.63"/>
<polygon fill="black" stroke="black" points="4733.11,-1980.12 4723.05,-1983.47 4733,-1987.12 4733.11,-1980.12"/>
</g>
<!-- expert_linear1_2_15_1 -->
<g id="node402" class="node">
<title>expert_linear1_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="8001,-2299.95 7819,-2299.95 7819,-2246.95 8001,-2246.95 8001,-2299.95"/>
<text text-anchor="middle" x="7910" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 29 Linear 1</text>
<text text-anchor="middle" x="7910" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7910" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_2_15_1&#45;&gt;expert_linear1_2_15_1 -->
<g id="edge468" class="edge">
<title>route_to_expert_2_15_1&#45;&gt;expert_linear1_2_15_1</title>
<path fill="none" stroke="black" d="M7947.37,-2336.5C7941.89,-2327.41 7936.02,-2317.67 7930.6,-2308.66"/>
<polygon fill="black" stroke="black" points="7933.51,-2306.71 7925.36,-2299.95 7927.52,-2310.33 7933.51,-2306.71"/>
</g>
<!-- expert_activation_2_15_1 -->
<g id="node403" class="node">
<title>expert_activation_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="7972,-2210.95 7790,-2210.95 7790,-2157.95 7972,-2157.95 7972,-2210.95"/>
<text text-anchor="middle" x="7881" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 29 GELU</text>
<text text-anchor="middle" x="7881" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7881" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_2_15_1&#45;&gt;expert_activation_2_15_1 -->
<g id="edge469" class="edge">
<title>expert_linear1_2_15_1&#45;&gt;expert_activation_2_15_1</title>
<path fill="none" stroke="black" d="M7901.46,-2246.82C7898.74,-2238.66 7895.68,-2229.49 7892.77,-2220.77"/>
<polygon fill="black" stroke="black" points="7896.07,-2219.58 7889.58,-2211.2 7889.43,-2221.8 7896.07,-2219.58"/>
</g>
<!-- expert_linear2_2_15_1 -->
<g id="node404" class="node">
<title>expert_linear2_2_15_1</title>
<polygon fill="lightgreen" stroke="black" points="7898.5,-2121.95 7725.5,-2121.95 7725.5,-2068.95 7898.5,-2068.95 7898.5,-2121.95"/>
<text text-anchor="middle" x="7812" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 29 Linear 2</text>
<text text-anchor="middle" x="7812" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7812" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_2_15_1&#45;&gt;expert_linear2_2_15_1 -->
<g id="edge470" class="edge">
<title>expert_activation_2_15_1&#45;&gt;expert_linear2_2_15_1</title>
<path fill="none" stroke="black" d="M7860.67,-2157.82C7853.78,-2149.14 7845.98,-2139.3 7838.68,-2130.09"/>
<polygon fill="black" stroke="black" points="7841.38,-2127.86 7832.42,-2122.2 7835.89,-2132.21 7841.38,-2127.86"/>
</g>
<!-- expert_linear2_2_15_1&#45;&gt;aggregate_2 -->
<g id="edge508" class="edge">
<title>expert_linear2_2_15_1&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M7725.24,-2078.7C7700.97,-2074.87 7674.52,-2071.22 7650,-2068.95 7078.38,-2016.07 5308.1,-1990.23 4732.7,-1983.07"/>
<polygon fill="black" stroke="black" points="4732.7,-1979.57 4722.65,-1982.95 4732.61,-1986.57 4732.7,-1979.57"/>
</g>
<!-- expert_linear1_2_15_2 -->
<g id="node406" class="node">
<title>expert_linear1_2_15_2</title>
<polygon fill="lightgreen" stroke="black" points="8262,-2299.95 8080,-2299.95 8080,-2246.95 8262,-2246.95 8262,-2299.95"/>
<text text-anchor="middle" x="8171" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 30 Linear 1</text>
<text text-anchor="middle" x="8171" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8171" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_2_15_2&#45;&gt;expert_linear1_2_15_2 -->
<g id="edge472" class="edge">
<title>route_to_expert_2_15_2&#45;&gt;expert_linear1_2_15_2</title>
<path fill="none" stroke="black" d="M8209.63,-2336.5C8203.97,-2327.41 8197.91,-2317.67 8192.3,-2308.66"/>
<polygon fill="black" stroke="black" points="8195.13,-2306.59 8186.88,-2299.95 8189.19,-2310.29 8195.13,-2306.59"/>
</g>
<!-- expert_activation_2_15_2 -->
<g id="node407" class="node">
<title>expert_activation_2_15_2</title>
<polygon fill="lightgreen" stroke="black" points="8232,-2210.95 8050,-2210.95 8050,-2157.95 8232,-2157.95 8232,-2210.95"/>
<text text-anchor="middle" x="8141" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 30 GELU</text>
<text text-anchor="middle" x="8141" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8141" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_2_15_2&#45;&gt;expert_activation_2_15_2 -->
<g id="edge473" class="edge">
<title>expert_linear1_2_15_2&#45;&gt;expert_activation_2_15_2</title>
<path fill="none" stroke="black" d="M8162.16,-2246.82C8159.35,-2238.66 8156.19,-2229.49 8153.18,-2220.77"/>
<polygon fill="black" stroke="black" points="8156.45,-2219.52 8149.88,-2211.2 8149.83,-2221.8 8156.45,-2219.52"/>
</g>
<!-- expert_linear2_2_15_2 -->
<g id="node408" class="node">
<title>expert_linear2_2_15_2</title>
<polygon fill="lightgreen" stroke="black" points="8158.5,-2121.95 7985.5,-2121.95 7985.5,-2068.95 8158.5,-2068.95 8158.5,-2121.95"/>
<text text-anchor="middle" x="8072" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 30 Linear 2</text>
<text text-anchor="middle" x="8072" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8072" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_2_15_2&#45;&gt;expert_linear2_2_15_2 -->
<g id="edge474" class="edge">
<title>expert_activation_2_15_2&#45;&gt;expert_linear2_2_15_2</title>
<path fill="none" stroke="black" d="M8120.67,-2157.82C8113.78,-2149.14 8105.98,-2139.3 8098.68,-2130.09"/>
<polygon fill="black" stroke="black" points="8101.38,-2127.86 8092.42,-2122.2 8095.89,-2132.21 8101.38,-2127.86"/>
</g>
<!-- expert_linear2_2_15_2&#45;&gt;aggregate_2 -->
<g id="edge509" class="edge">
<title>expert_linear2_2_15_2&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M7985.44,-2078.87C7960.52,-2074.97 7933.25,-2071.24 7908,-2068.95 7283.52,-2012.46 5338.84,-1988.78 4732.46,-1982.65"/>
<polygon fill="black" stroke="black" points="4732.35,-1979.15 4722.32,-1982.55 4732.28,-1986.15 4732.35,-1979.15"/>
</g>
<!-- expert_linear1_2_15_3 -->
<g id="node410" class="node">
<title>expert_linear1_2_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8555,-2299.95 8373,-2299.95 8373,-2246.95 8555,-2246.95 8555,-2299.95"/>
<text text-anchor="middle" x="8464" y="-2284.75" font-family="Times,serif" font-size="14.00">Expert 31 Linear 1</text>
<text text-anchor="middle" x="8464" y="-2269.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8464" y="-2254.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_2_15_3&#45;&gt;expert_linear1_2_15_3 -->
<g id="edge476" class="edge">
<title>route_to_expert_2_15_3&#45;&gt;expert_linear1_2_15_3</title>
<path fill="none" stroke="black" d="M8483.46,-2335.95C8480.73,-2327.34 8477.84,-2318.19 8475.13,-2309.64"/>
<polygon fill="black" stroke="black" points="8478.43,-2308.44 8472.07,-2299.96 8471.75,-2310.55 8478.43,-2308.44"/>
</g>
<!-- expert_activation_2_15_3 -->
<g id="node411" class="node">
<title>expert_activation_2_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8448,-2210.95 8266,-2210.95 8266,-2157.95 8448,-2157.95 8448,-2210.95"/>
<text text-anchor="middle" x="8357" y="-2195.75" font-family="Times,serif" font-size="14.00">Expert 31 GELU</text>
<text text-anchor="middle" x="8357" y="-2180.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8357" y="-2165.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_2_15_3&#45;&gt;expert_activation_2_15_3 -->
<g id="edge477" class="edge">
<title>expert_linear1_2_15_3&#45;&gt;expert_activation_2_15_3</title>
<path fill="none" stroke="black" d="M8432.48,-2246.82C8421.26,-2237.7 8408.48,-2227.31 8396.66,-2217.7"/>
<polygon fill="black" stroke="black" points="8398.64,-2214.8 8388.67,-2211.2 8394.22,-2220.23 8398.64,-2214.8"/>
</g>
<!-- expert_linear2_2_15_3 -->
<g id="node412" class="node">
<title>expert_linear2_2_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8396.5,-2121.95 8223.5,-2121.95 8223.5,-2068.95 8396.5,-2068.95 8396.5,-2121.95"/>
<text text-anchor="middle" x="8310" y="-2106.75" font-family="Times,serif" font-size="14.00">Expert 31 Linear 2</text>
<text text-anchor="middle" x="8310" y="-2091.75" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8310" y="-2076.75" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_2_15_3&#45;&gt;expert_linear2_2_15_3 -->
<g id="edge478" class="edge">
<title>expert_activation_2_15_3&#45;&gt;expert_linear2_2_15_3</title>
<path fill="none" stroke="black" d="M8343.15,-2157.82C8338.65,-2149.49 8333.58,-2140.1 8328.78,-2131.21"/>
<polygon fill="black" stroke="black" points="8331.74,-2129.34 8323.91,-2122.2 8325.58,-2132.66 8331.74,-2129.34"/>
</g>
<!-- expert_linear2_2_15_3&#45;&gt;aggregate_2 -->
<g id="edge510" class="edge">
<title>expert_linear2_2_15_3&#45;&gt;aggregate_2</title>
<path fill="none" stroke="black" d="M8223.19,-2076.69C8205.02,-2073.58 8185.94,-2070.77 8168,-2068.95 7490.68,-2000.31 5367.53,-1984.82 4731.69,-1981.68"/>
<polygon fill="black" stroke="black" points="4731.54,-1978.18 4721.52,-1981.64 4731.5,-1985.18 4731.54,-1978.18"/>
</g>
<!-- aggregate_2&#45;&gt;moe_residual_2 -->
<g id="edge512" class="edge">
<title>aggregate_2&#45;&gt;moe_residual_2</title>
<path fill="none" stroke="black" d="M4709.25,-1966.9C5062.07,-1940.18 5905.5,-1876.32 6249.29,-1850.29"/>
<polygon fill="black" stroke="black" points="6249.6,-1853.78 6259.31,-1849.53 6249.08,-1846.8 6249.6,-1853.78"/>
</g>
<!-- ln2_2 -->
<g id="node415" class="node">
<title>ln2_2</title>
<polygon fill="lightgreen" stroke="black" points="6488.5,-1748.95 6309.5,-1748.95 6309.5,-1695.95 6488.5,-1695.95 6488.5,-1748.95"/>
<text text-anchor="middle" x="6399" y="-1733.75" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="6399" y="-1718.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6399" y="-1703.75" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- moe_residual_2&#45;&gt;ln2_2 -->
<g id="edge513" class="edge">
<title>moe_residual_2&#45;&gt;ln2_2</title>
<path fill="none" stroke="black" d="M6399,-1784.85C6399,-1776.18 6399,-1767.37 6399,-1759.22"/>
<polygon fill="black" stroke="black" points="6402.5,-1758.97 6399,-1748.97 6395.5,-1758.97 6402.5,-1758.97"/>
</g>
<!-- mha_qkv_3 -->
<g id="node416" class="node">
<title>mha_qkv_3</title>
<polygon fill="lightgreen" stroke="black" points="6432,-1648.95 6238,-1648.95 6238,-1595.95 6432,-1595.95 6432,-1648.95"/>
<text text-anchor="middle" x="6335" y="-1633.75" font-family="Times,serif" font-size="14.00">MHA QKV Linear (TP=8)</text>
<text text-anchor="middle" x="6335" y="-1618.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6335" y="-1603.75" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln2_2&#45;&gt;mha_qkv_3 -->
<g id="edge514" class="edge">
<title>ln2_2&#45;&gt;mha_qkv_3</title>
<path fill="none" stroke="black" d="M6382.18,-1695.7C6374.54,-1684 6365.39,-1669.99 6357.2,-1657.44"/>
<polygon fill="black" stroke="black" points="6360.1,-1655.49 6351.7,-1649.03 6354.24,-1659.32 6360.1,-1655.49"/>
</g>
<!-- mha_residual_3 -->
<g id="node419" class="node">
<title>mha_residual_3</title>
<polygon fill="lightyellow" stroke="black" points="6582.66,-1381.95 6287.32,-1381.95 6211.34,-1275.95 6506.68,-1275.95 6582.66,-1381.95"/>
<text text-anchor="middle" x="6397" y="-1340.25" font-family="Times,serif" font-size="14.00">MHA Residual Add</text>
<text text-anchor="middle" x="6397" y="-1325.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6397" y="-1310.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln2_2&#45;&gt;mha_residual_3 -->
<g id="edge518" class="edge">
<title>ln2_2&#45;&gt;mha_residual_3</title>
<path fill="none" stroke="black" d="M6430.9,-1695.66C6434.98,-1690.89 6438.58,-1685.61 6441,-1679.95 6486.91,-1572.93 6473.78,-1530.8 6445,-1417.95 6442.73,-1409.04 6439.34,-1400.05 6435.41,-1391.4"/>
<polygon fill="black" stroke="black" points="6438.45,-1389.65 6430.95,-1382.17 6432.15,-1392.7 6438.45,-1389.65"/>
</g>
<!-- mha_attn_3 -->
<g id="node417" class="node">
<title>mha_attn_3</title>
<polygon fill="lightgreen" stroke="black" points="6422.5,-1559.95 6243.5,-1559.95 6243.5,-1506.95 6422.5,-1506.95 6422.5,-1559.95"/>
<text text-anchor="middle" x="6333" y="-1544.75" font-family="Times,serif" font-size="14.00">MHA Attention (TP=8)</text>
<text text-anchor="middle" x="6333" y="-1529.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6333" y="-1514.75" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_qkv_3&#45;&gt;mha_attn_3 -->
<g id="edge515" class="edge">
<title>mha_qkv_3&#45;&gt;mha_attn_3</title>
<path fill="none" stroke="black" d="M6334.41,-1595.82C6334.23,-1587.84 6334.02,-1578.89 6333.82,-1570.34"/>
<polygon fill="black" stroke="black" points="6337.32,-1570.12 6333.59,-1560.2 6330.32,-1570.28 6337.32,-1570.12"/>
</g>
<!-- mha_out_3 -->
<g id="node418" class="node">
<title>mha_out_3</title>
<polygon fill="lightgreen" stroke="black" points="6436,-1470.95 6224,-1470.95 6224,-1417.95 6436,-1417.95 6436,-1470.95"/>
<text text-anchor="middle" x="6330" y="-1455.75" font-family="Times,serif" font-size="14.00">MHA Output Linear (TP=8)</text>
<text text-anchor="middle" x="6330" y="-1440.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6330" y="-1425.75" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_attn_3&#45;&gt;mha_out_3 -->
<g id="edge516" class="edge">
<title>mha_attn_3&#45;&gt;mha_out_3</title>
<path fill="none" stroke="black" d="M6332.12,-1506.82C6331.84,-1498.84 6331.53,-1489.89 6331.24,-1481.34"/>
<polygon fill="black" stroke="black" points="6334.73,-1481.08 6330.89,-1471.2 6327.73,-1481.32 6334.73,-1481.08"/>
</g>
<!-- mha_out_3&#45;&gt;mha_residual_3 -->
<g id="edge517" class="edge">
<title>mha_out_3&#45;&gt;mha_residual_3</title>
<path fill="none" stroke="black" d="M6345.2,-1417.7C6349.99,-1409.59 6355.5,-1400.26 6361.1,-1390.77"/>
<polygon fill="black" stroke="black" points="6364.18,-1392.44 6366.25,-1382.05 6358.15,-1388.88 6364.18,-1392.44"/>
</g>
<!-- ln1_3 -->
<g id="node420" class="node">
<title>ln1_3</title>
<polygon fill="lightgreen" stroke="black" points="6486.5,-1239.95 6307.5,-1239.95 6307.5,-1186.95 6486.5,-1186.95 6486.5,-1239.95"/>
<text text-anchor="middle" x="6397" y="-1224.75" font-family="Times,serif" font-size="14.00">Layer Norm 1</text>
<text text-anchor="middle" x="6397" y="-1209.75" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6397" y="-1194.75" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- mha_residual_3&#45;&gt;ln1_3 -->
<g id="edge519" class="edge">
<title>mha_residual_3&#45;&gt;ln1_3</title>
<path fill="none" stroke="black" d="M6397,-1275.85C6397,-1267.18 6397,-1258.37 6397,-1250.22"/>
<polygon fill="black" stroke="black" points="6400.5,-1249.97 6397,-1239.97 6393.5,-1249.97 6400.5,-1249.97"/>
</g>
<!-- gate_3 -->
<g id="node421" class="node">
<title>gate_3</title>
<polygon fill="lightyellow" stroke="black" points="4512.83,-1150.95 4247.44,-1150.95 4179.17,-1044.95 4444.56,-1044.95 4512.83,-1150.95"/>
<text text-anchor="middle" x="4346" y="-1109.25" font-family="Times,serif" font-size="14.00">Expert Gate</text>
<text text-anchor="middle" x="4346" y="-1094.25" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 16)</text>
<text text-anchor="middle" x="4346" y="-1079.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_3&#45;&gt;gate_3 -->
<g id="edge520" class="edge">
<title>ln1_3&#45;&gt;gate_3</title>
<path fill="none" stroke="black" d="M6307.22,-1207.49C5986.49,-1189.74 4895.12,-1129.34 4494.79,-1107.19"/>
<polygon fill="black" stroke="black" points="4494.77,-1103.68 4484.59,-1106.62 4494.39,-1110.67 4494.77,-1103.68"/>
</g>
<!-- moe_residual_3 -->
<g id="node551" class="node">
<title>moe_residual_3</title>
<polygon fill="lightyellow" stroke="black" points="6481.66,-489 6186.32,-489 6110.34,-383 6405.68,-383 6481.66,-489"/>
<text text-anchor="middle" x="6296" y="-447.3" font-family="Times,serif" font-size="14.00">MoE Residual Add</text>
<text text-anchor="middle" x="6296" y="-432.3" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6296" y="-417.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ln1_3&#45;&gt;moe_residual_3 -->
<g id="edge681" class="edge">
<title>ln1_3&#45;&gt;moe_residual_3</title>
<path fill="none" stroke="black" d="M6486.74,-1209.34C6859.39,-1195.61 8272.23,-1135.54 8422,-1008.95 8434.84,-998.1 8432,-989.29 8432,-972.48 8432,-972.48 8432,-972.48 8432,-692.5 8432,-493.59 6952.83,-448.8 6456.31,-439.37"/>
<polygon fill="black" stroke="black" points="6456.26,-435.87 6446.2,-439.18 6456.13,-442.86 6456.26,-435.87"/>
</g>
<!-- route_to_expert_3_8_0 -->
<g id="node422" class="node">
<title>route_to_expert_3_8_0</title>
<ellipse fill="lightblue" stroke="black" cx="138" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="138" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 0</text>
<text text-anchor="middle" x="138" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="138" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_8_0 -->
<g id="edge521" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_8_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.9,-1096.03C3552.13,-1091.24 666.55,-1067.1 270,-1008.95 257.35,-1007.1 244.18,-1004.41 231.28,-1001.33"/>
<polygon fill="black" stroke="black" points="232.03,-997.91 221.48,-998.9 230.34,-1004.7 232.03,-997.91"/>
</g>
<!-- route_to_expert_3_8_1 -->
<g id="node426" class="node">
<title>route_to_expert_3_8_1</title>
<ellipse fill="lightblue" stroke="black" cx="401" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="401" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 1</text>
<text text-anchor="middle" x="401" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="401" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_8_1 -->
<g id="edge525" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_8_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.73,-1095.82C3578.07,-1090.19 902.2,-1063.37 533,-1008.95 520.35,-1007.09 507.19,-1004.4 494.28,-1001.31"/>
<polygon fill="black" stroke="black" points="495.03,-997.89 484.48,-998.88 493.35,-1004.68 495.03,-997.89"/>
</g>
<!-- route_to_expert_3_8_2 -->
<g id="node430" class="node">
<title>route_to_expert_3_8_2</title>
<ellipse fill="lightblue" stroke="black" cx="664" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="664" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 2</text>
<text text-anchor="middle" x="664" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="664" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_8_2 -->
<g id="edge529" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_8_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.76,-1095.57C3605.53,-1089.06 1137.94,-1059.65 796,-1008.95 783.44,-1007.09 770.38,-1004.42 757.57,-1001.36"/>
<polygon fill="black" stroke="black" points="758.39,-997.95 747.84,-998.95 756.71,-1004.75 758.39,-997.95"/>
</g>
<!-- route_to_expert_3_8_3 -->
<g id="node434" class="node">
<title>route_to_expert_3_8_3</title>
<ellipse fill="lightblue" stroke="black" cx="927" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="927" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 3</text>
<text text-anchor="middle" x="927" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="927" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_8_3 -->
<g id="edge533" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_8_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.43,-1095.28C3633.07,-1087.82 1373.68,-1055.93 1059,-1008.95 1046.45,-1007.08 1033.39,-1004.4 1020.58,-1001.33"/>
<polygon fill="black" stroke="black" points="1021.39,-997.93 1010.85,-998.92 1019.71,-1004.72 1021.39,-997.93"/>
</g>
<!-- route_to_expert_3_9_0 -->
<g id="node438" class="node">
<title>route_to_expert_3_9_0</title>
<ellipse fill="lightblue" stroke="black" cx="1190" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1190" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 4</text>
<text text-anchor="middle" x="1190" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1190" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_9_0 -->
<g id="edge537" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_9_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4212.57,-1097.33C3704.6,-1098.1 1891.53,-1094.65 1322,-1008.95 1309.45,-1007.06 1296.39,-1004.38 1283.58,-1001.31"/>
<polygon fill="black" stroke="black" points="1284.4,-997.9 1273.85,-998.89 1282.71,-1004.7 1284.4,-997.9"/>
</g>
<!-- route_to_expert_3_9_1 -->
<g id="node442" class="node">
<title>route_to_expert_3_9_1</title>
<ellipse fill="lightblue" stroke="black" cx="1453" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1453" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 5</text>
<text text-anchor="middle" x="1453" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1453" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_9_1 -->
<g id="edge541" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_9_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4212.43,-1096.9C3733.08,-1096.03 2100.63,-1087.27 1585,-1008.95 1572.45,-1007.05 1559.39,-1004.35 1546.59,-1001.27"/>
<polygon fill="black" stroke="black" points="1547.4,-997.87 1536.86,-998.85 1545.72,-1004.66 1547.4,-997.87"/>
</g>
<!-- route_to_expert_3_9_2 -->
<g id="node446" class="node">
<title>route_to_expert_3_9_2</title>
<ellipse fill="lightblue" stroke="black" cx="1716" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1716" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 6</text>
<text text-anchor="middle" x="1716" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1716" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_9_2 -->
<g id="edge545" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_9_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4212.14,-1096.37C3762.68,-1093.76 2309.89,-1079.9 1848,-1008.95 1835.45,-1007.03 1822.4,-1004.32 1809.59,-1001.23"/>
<polygon fill="black" stroke="black" points="1810.41,-997.83 1799.86,-998.81 1808.72,-1004.62 1810.41,-997.83"/>
</g>
<!-- route_to_expert_3_9_3 -->
<g id="node450" class="node">
<title>route_to_expert_3_9_3</title>
<ellipse fill="lightblue" stroke="black" cx="1979" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="1979" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 7</text>
<text text-anchor="middle" x="1979" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1979" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_9_3 -->
<g id="edge549" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_9_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.5,-1095.71C3793.27,-1091.22 2519.28,-1072.53 2111,-1008.95 2098.67,-1007.03 2085.85,-1004.37 2073.26,-1001.34"/>
<polygon fill="black" stroke="black" points="2073.77,-997.87 2063.23,-998.85 2072.09,-1004.66 2073.77,-997.87"/>
</g>
<!-- route_to_expert_3_10_0 -->
<g id="node454" class="node">
<title>route_to_expert_3_10_0</title>
<ellipse fill="lightblue" stroke="black" cx="2242" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2242" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 8</text>
<text text-anchor="middle" x="2242" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2242" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_10_0 -->
<g id="edge553" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_10_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.26,-1094.89C3826.75,-1088.36 2729.09,-1065.2 2374,-1008.95 2361.68,-1007 2348.86,-1004.32 2336.27,-1001.28"/>
<polygon fill="black" stroke="black" points="2336.79,-997.8 2326.24,-998.78 2335.09,-1004.6 2336.79,-997.8"/>
</g>
<!-- route_to_expert_3_10_1 -->
<g id="node458" class="node">
<title>route_to_expert_3_10_1</title>
<ellipse fill="lightblue" stroke="black" cx="2505" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2505" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 9</text>
<text text-anchor="middle" x="2505" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2505" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_10_1 -->
<g id="edge557" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_10_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4210.46,-1093.79C3861.61,-1085.04 2939.07,-1057.87 2637,-1008.95 2624.68,-1006.96 2611.87,-1004.25 2599.28,-1001.2"/>
<polygon fill="black" stroke="black" points="2599.8,-997.72 2589.25,-998.69 2598.1,-1004.52 2599.8,-997.72"/>
</g>
<!-- route_to_expert_3_10_2 -->
<g id="node462" class="node">
<title>route_to_expert_3_10_2</title>
<ellipse fill="lightblue" stroke="black" cx="2768" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="2768" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 10</text>
<text text-anchor="middle" x="2768" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2768" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_10_2 -->
<g id="edge561" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_10_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4209.55,-1092.29C3899.48,-1081.1 3149.48,-1050.55 2900,-1008.95 2887.79,-1006.92 2875.08,-1004.2 2862.59,-1001.16"/>
<polygon fill="black" stroke="black" points="2863.18,-997.7 2852.62,-998.67 2861.47,-1004.49 2863.18,-997.7"/>
</g>
<!-- route_to_expert_3_10_3 -->
<g id="node466" class="node">
<title>route_to_expert_3_10_3</title>
<ellipse fill="lightblue" stroke="black" cx="3031" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3031" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 11</text>
<text text-anchor="middle" x="3031" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3031" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_10_3 -->
<g id="edge565" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_10_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4211.45,-1095.47C3990.85,-1091.14 3539.15,-1074.27 3163,-1008.95 3150.89,-1006.85 3138.29,-1004.11 3125.9,-1001.08"/>
<polygon fill="black" stroke="black" points="3126.56,-997.63 3116.01,-998.59 3124.85,-1004.42 3126.56,-997.63"/>
</g>
<!-- route_to_expert_3_11_0 -->
<g id="node470" class="node">
<title>route_to_expert_3_11_0</title>
<ellipse fill="lightblue" stroke="black" cx="3294" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3294" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 12</text>
<text text-anchor="middle" x="3294" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3294" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_11_0 -->
<g id="edge569" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_11_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4208.97,-1091.3C4028.31,-1082.16 3701.14,-1059.73 3426,-1008.95 3414.01,-1006.74 3401.52,-1003.95 3389.22,-1000.9"/>
<polygon fill="black" stroke="black" points="3389.97,-997.48 3379.41,-998.41 3388.24,-1004.26 3389.97,-997.48"/>
</g>
<!-- route_to_expert_3_11_1 -->
<g id="node474" class="node">
<title>route_to_expert_3_11_1</title>
<ellipse fill="lightblue" stroke="black" cx="3557" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3557" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 13</text>
<text text-anchor="middle" x="3557" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3557" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_11_1 -->
<g id="edge573" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_11_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4203.77,-1083.56C4070.06,-1069.65 3864.76,-1044.83 3689,-1008.95 3677.35,-1006.58 3665.22,-1003.74 3653.23,-1000.7"/>
<polygon fill="black" stroke="black" points="3653.77,-997.23 3643.22,-998.12 3652.02,-1004.01 3653.77,-997.23"/>
</g>
<!-- route_to_expert_3_11_2 -->
<g id="node478" class="node">
<title>route_to_expert_3_11_2</title>
<ellipse fill="lightblue" stroke="black" cx="3820" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="3820" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 14</text>
<text text-anchor="middle" x="3820" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3820" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_11_2 -->
<g id="edge577" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_11_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4191.21,-1064.25C4118.41,-1048.39 4030.54,-1028.56 3952,-1008.95 3941.03,-1006.21 3929.58,-1003.23 3918.2,-1000.2"/>
<polygon fill="black" stroke="black" points="3918.8,-996.73 3908.24,-997.52 3916.99,-1003.49 3918.8,-996.73"/>
</g>
<!-- route_to_expert_3_11_3 -->
<g id="node482" class="node">
<title>route_to_expert_3_11_3</title>
<ellipse fill="lightblue" stroke="black" cx="4083" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4083" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 15</text>
<text text-anchor="middle" x="4083" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4083" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_11_3 -->
<g id="edge581" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_11_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4235.99,-1044.89C4209.53,-1032.36 4181.87,-1019.27 4157.47,-1007.72"/>
<polygon fill="black" stroke="black" points="4158.82,-1004.49 4148.29,-1003.38 4155.83,-1010.82 4158.82,-1004.49"/>
</g>
<!-- route_to_expert_3_12_0 -->
<g id="node486" class="node">
<title>route_to_expert_3_12_0</title>
<ellipse fill="lightblue" stroke="black" cx="4346" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4346" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 16</text>
<text text-anchor="middle" x="4346" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4346" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_12_0 -->
<g id="edge585" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_12_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4346,-1044.89C4346,-1036.45 4346,-1027.77 4346,-1019.46"/>
<polygon fill="black" stroke="black" points="4349.5,-1019.2 4346,-1009.2 4342.5,-1019.2 4349.5,-1019.2"/>
</g>
<!-- route_to_expert_3_12_1 -->
<g id="node490" class="node">
<title>route_to_expert_3_12_1</title>
<ellipse fill="lightblue" stroke="black" cx="4609" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4609" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 17</text>
<text text-anchor="middle" x="4609" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4609" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_12_1 -->
<g id="edge589" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_12_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4447.31,-1049.01C4476.43,-1035.22 4507.64,-1020.45 4534.8,-1007.6"/>
<polygon fill="black" stroke="black" points="4536.3,-1010.76 4543.84,-1003.32 4533.3,-1004.43 4536.3,-1010.76"/>
</g>
<!-- route_to_expert_3_12_2 -->
<g id="node494" class="node">
<title>route_to_expert_3_12_2</title>
<ellipse fill="lightblue" stroke="black" cx="4872" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="4872" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 18</text>
<text text-anchor="middle" x="4872" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4872" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_12_2 -->
<g id="edge593" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_12_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4462.73,-1072.48C4541.33,-1055.61 4647.18,-1032.13 4740,-1008.95 4750.97,-1006.21 4762.42,-1003.23 4773.8,-1000.2"/>
<polygon fill="black" stroke="black" points="4775.01,-1003.49 4783.76,-997.52 4773.2,-996.73 4775.01,-1003.49"/>
</g>
<!-- route_to_expert_3_12_3 -->
<g id="node498" class="node">
<title>route_to_expert_3_12_3</title>
<ellipse fill="lightblue" stroke="black" cx="5135" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5135" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 19</text>
<text text-anchor="middle" x="5135" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5135" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_12_3 -->
<g id="edge597" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_12_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4470.66,-1085.37C4603.44,-1071.85 4819.35,-1046.45 5003,-1008.95 5014.65,-1006.58 5026.78,-1003.74 5038.77,-1000.7"/>
<polygon fill="black" stroke="black" points="5039.98,-1004.01 5048.78,-998.12 5038.23,-997.23 5039.98,-1004.01"/>
</g>
<!-- route_to_expert_3_13_0 -->
<g id="node502" class="node">
<title>route_to_expert_3_13_0</title>
<ellipse fill="lightblue" stroke="black" cx="5398" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5398" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 20</text>
<text text-anchor="middle" x="5398" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5398" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_13_0 -->
<g id="edge601" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_13_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4474.97,-1091.71C4653.83,-1082.83 4986.72,-1060.49 5266,-1008.95 5277.99,-1006.74 5290.48,-1003.95 5302.78,-1000.9"/>
<polygon fill="black" stroke="black" points="5303.76,-1004.26 5312.59,-998.41 5302.03,-997.48 5303.76,-1004.26"/>
</g>
<!-- route_to_expert_3_13_1 -->
<g id="node506" class="node">
<title>route_to_expert_3_13_1</title>
<ellipse fill="lightblue" stroke="black" cx="5661" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5661" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 21</text>
<text text-anchor="middle" x="5661" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5661" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_13_1 -->
<g id="edge605" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_13_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.44,-1095.53C4696.88,-1091.29 5151.07,-1074.58 5529,-1008.95 5541.11,-1006.85 5553.71,-1004.11 5566.1,-1001.08"/>
<polygon fill="black" stroke="black" points="5567.15,-1004.42 5575.99,-998.59 5565.44,-997.63 5567.15,-1004.42"/>
</g>
<!-- route_to_expert_3_13_2 -->
<g id="node510" class="node">
<title>route_to_expert_3_13_2</title>
<ellipse fill="lightblue" stroke="black" cx="5924" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="5924" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 22</text>
<text text-anchor="middle" x="5924" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5924" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_13_2 -->
<g id="edge609" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_13_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4475.3,-1092.55C4780.84,-1081.58 5540.58,-1050.87 5792,-1008.95 5804.21,-1006.92 5816.92,-1004.2 5829.41,-1001.16"/>
<polygon fill="black" stroke="black" points="5830.53,-1004.49 5839.38,-998.67 5828.82,-997.7 5830.53,-1004.49"/>
</g>
<!-- route_to_expert_3_13_3 -->
<g id="node514" class="node">
<title>route_to_expert_3_13_3</title>
<ellipse fill="lightblue" stroke="black" cx="6187" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6187" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 23</text>
<text text-anchor="middle" x="6187" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6187" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_13_3 -->
<g id="edge613" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_13_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4476.19,-1093.93C4820.85,-1085.32 5751.37,-1058.12 6055,-1008.95 6067.32,-1006.96 6080.13,-1004.25 6092.72,-1001.2"/>
<polygon fill="black" stroke="black" points="6093.9,-1004.52 6102.75,-998.69 6092.2,-997.72 6093.9,-1004.52"/>
</g>
<!-- route_to_expert_3_14_0 -->
<g id="node518" class="node">
<title>route_to_expert_3_14_0</title>
<ellipse fill="lightblue" stroke="black" cx="6450" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6450" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 24</text>
<text text-anchor="middle" x="6450" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6450" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_14_0 -->
<g id="edge617" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_14_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4476.98,-1094.95C4858.05,-1088.51 5961.75,-1065.39 6318,-1008.95 6330.32,-1007 6343.14,-1004.32 6355.73,-1001.28"/>
<polygon fill="black" stroke="black" points="6356.91,-1004.6 6365.76,-998.78 6355.21,-997.8 6356.91,-1004.6"/>
</g>
<!-- route_to_expert_3_14_1 -->
<g id="node522" class="node">
<title>route_to_expert_3_14_1</title>
<ellipse fill="lightblue" stroke="black" cx="6713" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6713" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 25</text>
<text text-anchor="middle" x="6713" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6713" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_14_1 -->
<g id="edge621" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_14_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.57,-1095.74C4892.74,-1091.31 6171.76,-1072.68 6581,-1008.95 6593.33,-1007.03 6606.15,-1004.37 6618.74,-1001.34"/>
<polygon fill="black" stroke="black" points="6619.91,-1004.66 6628.77,-998.85 6618.23,-997.87 6619.91,-1004.66"/>
</g>
<!-- route_to_expert_3_14_2 -->
<g id="node526" class="node">
<title>route_to_expert_3_14_2</title>
<ellipse fill="lightblue" stroke="black" cx="6976" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="6976" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 26</text>
<text text-anchor="middle" x="6976" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6976" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_14_2 -->
<g id="edge625" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_14_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.91,-1096.38C4925.1,-1093.8 6381.44,-1080 6844,-1008.95 6856.55,-1007.03 6869.6,-1004.32 6882.41,-1001.23"/>
<polygon fill="black" stroke="black" points="6883.28,-1004.62 6892.14,-998.81 6881.59,-997.83 6883.28,-1004.62"/>
</g>
<!-- route_to_expert_3_14_3 -->
<g id="node530" class="node">
<title>route_to_expert_3_14_3</title>
<ellipse fill="lightblue" stroke="black" cx="7239" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7239" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 27</text>
<text text-anchor="middle" x="7239" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7239" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_14_3 -->
<g id="edge629" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_14_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4478.33,-1096.9C4956.1,-1096.05 6590.92,-1087.34 7107,-1008.95 7119.55,-1007.05 7132.61,-1004.35 7145.41,-1001.27"/>
<polygon fill="black" stroke="black" points="7146.28,-1004.66 7155.14,-998.85 7144.6,-997.87 7146.28,-1004.66"/>
</g>
<!-- route_to_expert_3_15_0 -->
<g id="node534" class="node">
<title>route_to_expert_3_15_0</title>
<ellipse fill="lightblue" stroke="black" cx="7502" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7502" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 28</text>
<text text-anchor="middle" x="7502" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7502" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_15_0 -->
<g id="edge633" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_15_0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4478.56,-1097.33C4985.33,-1098.1 6800.15,-1094.7 7370,-1008.95 7382.55,-1007.06 7395.61,-1004.38 7408.42,-1001.31"/>
<polygon fill="black" stroke="black" points="7409.29,-1004.7 7418.15,-998.89 7407.6,-997.9 7409.29,-1004.7"/>
</g>
<!-- route_to_expert_3_15_1 -->
<g id="node538" class="node">
<title>route_to_expert_3_15_1</title>
<ellipse fill="lightblue" stroke="black" cx="7765" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="7765" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 29</text>
<text text-anchor="middle" x="7765" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7765" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_15_1 -->
<g id="edge637" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_15_1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.19,-1095.32C5050.05,-1087.95 7317.7,-1056.02 7633,-1008.95 7645.55,-1007.08 7658.61,-1004.4 7671.42,-1001.33"/>
<polygon fill="black" stroke="black" points="7672.29,-1004.72 7681.15,-998.92 7670.61,-997.93 7672.29,-1004.72"/>
</g>
<!-- route_to_expert_3_15_2 -->
<g id="node542" class="node">
<title>route_to_expert_3_15_2</title>
<ellipse fill="lightblue" stroke="black" cx="8028" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8028" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 30</text>
<text text-anchor="middle" x="8028" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8028" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_15_2 -->
<g id="edge641" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_15_2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.22,-1095.6C5078.21,-1089.16 7553.49,-1059.74 7896,-1008.95 7908.56,-1007.09 7921.62,-1004.42 7934.43,-1001.36"/>
<polygon fill="black" stroke="black" points="7935.29,-1004.75 7944.16,-998.95 7933.61,-997.95 7935.29,-1004.75"/>
</g>
<!-- route_to_expert_3_15_3 -->
<g id="node546" class="node">
<title>route_to_expert_3_15_3</title>
<ellipse fill="lightblue" stroke="black" cx="8291" cy="-971.48" rx="122.16" ry="37.45"/>
<text text-anchor="middle" x="8291" y="-982.78" font-family="Times,serif" font-size="14.00">Route to Expert 31</text>
<text text-anchor="middle" x="8291" y="-967.78" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8291" y="-952.78" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- gate_3&#45;&gt;route_to_expert_3_15_3 -->
<g id="edge645" class="edge">
<title>gate_3&#45;&gt;route_to_expert_3_15_3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4477.39,-1095.84C5105.76,-1090.27 7789.24,-1063.45 8159,-1008.95 8171.65,-1007.09 8184.81,-1004.4 8197.72,-1001.31"/>
<polygon fill="black" stroke="black" points="8198.65,-1004.68 8207.52,-998.88 8196.97,-997.89 8198.65,-1004.68"/>
</g>
<!-- expert_linear1_3_8_0 -->
<g id="node423" class="node">
<title>expert_linear1_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="229,-898 47,-898 47,-845 229,-845 229,-898"/>
<text text-anchor="middle" x="138" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 1</text>
<text text-anchor="middle" x="138" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="138" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_3_8_0&#45;&gt;expert_linear1_3_8_0 -->
<g id="edge522" class="edge">
<title>route_to_expert_3_8_0&#45;&gt;expert_linear1_3_8_0</title>
<path fill="none" stroke="black" d="M138,-933.99C138,-925.58 138,-916.63 138,-908.25"/>
<polygon fill="black" stroke="black" points="141.5,-908.01 138,-898.01 134.5,-908.01 141.5,-908.01"/>
</g>
<!-- expert_activation_3_8_0 -->
<g id="node424" class="node">
<title>expert_activation_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="230,-809 48,-809 48,-756 230,-756 230,-809"/>
<text text-anchor="middle" x="139" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 0 GELU</text>
<text text-anchor="middle" x="139" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="139" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_3_8_0&#45;&gt;expert_activation_3_8_0 -->
<g id="edge523" class="edge">
<title>expert_linear1_3_8_0&#45;&gt;expert_activation_3_8_0</title>
<path fill="none" stroke="black" d="M138.29,-844.87C138.39,-836.89 138.49,-827.93 138.59,-819.38"/>
<polygon fill="black" stroke="black" points="142.09,-819.29 138.7,-809.25 135.09,-819.21 142.09,-819.29"/>
</g>
<!-- expert_linear2_3_8_0 -->
<g id="node425" class="node">
<title>expert_linear2_3_8_0</title>
<polygon fill="lightgreen" stroke="black" points="569.5,-720 396.5,-720 396.5,-667 569.5,-667 569.5,-720"/>
<text text-anchor="middle" x="483" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 0 Linear 2</text>
<text text-anchor="middle" x="483" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="483" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_3_8_0&#45;&gt;expert_linear2_3_8_0 -->
<g id="edge524" class="edge">
<title>expert_activation_3_8_0&#45;&gt;expert_linear2_3_8_0</title>
<path fill="none" stroke="black" d="M230.28,-758.41C278.42,-746.24 337.47,-731.31 386.37,-718.94"/>
<polygon fill="black" stroke="black" points="387.5,-722.26 396.33,-716.42 385.78,-715.48 387.5,-722.26"/>
</g>
<!-- aggregate_3 -->
<g id="node550" class="node">
<title>aggregate_3</title>
<polygon fill="lightyellow" stroke="black" points="4559.64,-631 4219.79,-631 4132.36,-525 4472.21,-525 4559.64,-631"/>
<text text-anchor="middle" x="4346" y="-589.3" font-family="Times,serif" font-size="14.00">Aggregate Expert Outputs</text>
<text text-anchor="middle" x="4346" y="-574.3" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="4346" y="-559.3" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- expert_linear2_3_8_0&#45;&gt;aggregate_3 -->
<g id="edge649" class="edge">
<title>expert_linear2_3_8_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M569.78,-686.64C658.5,-680.85 800.3,-672.13 923,-667 2164.71,-615.07 3661.18,-589.27 4168.2,-581.55"/>
<polygon fill="black" stroke="black" points="4168.58,-585.05 4178.53,-581.4 4168.48,-578.05 4168.58,-585.05"/>
</g>
<!-- expert_linear1_3_8_1 -->
<g id="node427" class="node">
<title>expert_linear1_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="558,-898 376,-898 376,-845 558,-845 558,-898"/>
<text text-anchor="middle" x="467" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 1</text>
<text text-anchor="middle" x="467" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="467" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_3_8_1&#45;&gt;expert_linear1_3_8_1 -->
<g id="edge526" class="edge">
<title>route_to_expert_3_8_1&#45;&gt;expert_linear1_3_8_1</title>
<path fill="none" stroke="black" d="M425.2,-934.55C431.39,-925.36 438.03,-915.51 444.14,-906.43"/>
<polygon fill="black" stroke="black" points="447.14,-908.25 449.82,-898 441.33,-904.34 447.14,-908.25"/>
</g>
<!-- expert_activation_3_8_1 -->
<g id="node428" class="node">
<title>expert_activation_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="934,-809 752,-809 752,-756 934,-756 934,-809"/>
<text text-anchor="middle" x="843" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 1 GELU</text>
<text text-anchor="middle" x="843" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="843" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_3_8_1&#45;&gt;expert_activation_3_8_1 -->
<g id="edge527" class="edge">
<title>expert_linear1_3_8_1&#45;&gt;expert_activation_3_8_1</title>
<path fill="none" stroke="black" d="M558.02,-849.44C613.59,-836.58 684.74,-820.12 742.04,-806.86"/>
<polygon fill="black" stroke="black" points="742.89,-810.26 751.84,-804.59 741.31,-803.44 742.89,-810.26"/>
</g>
<!-- expert_linear2_3_8_1 -->
<g id="node429" class="node">
<title>expert_linear2_3_8_1</title>
<polygon fill="lightgreen" stroke="black" points="1105.5,-720 932.5,-720 932.5,-667 1105.5,-667 1105.5,-720"/>
<text text-anchor="middle" x="1019" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 1 Linear 2</text>
<text text-anchor="middle" x="1019" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1019" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_3_8_1&#45;&gt;expert_linear2_3_8_1 -->
<g id="edge528" class="edge">
<title>expert_activation_3_8_1&#45;&gt;expert_linear2_3_8_1</title>
<path fill="none" stroke="black" d="M894.85,-755.87C914.73,-746.04 937.58,-734.75 958.21,-724.55"/>
<polygon fill="black" stroke="black" points="959.8,-727.67 967.21,-720.1 956.7,-721.39 959.8,-727.67"/>
</g>
<!-- expert_linear2_3_8_1&#45;&gt;aggregate_3 -->
<g id="edge650" class="edge">
<title>expert_linear2_3_8_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1105.56,-682.95C1158.95,-677.41 1228.87,-670.8 1291,-667 2382.22,-600.2 3695.89,-583.92 4167.05,-580.11"/>
<polygon fill="black" stroke="black" points="4167.37,-583.61 4177.34,-580.03 4167.31,-576.61 4167.37,-583.61"/>
</g>
<!-- expert_linear1_3_8_2 -->
<g id="node431" class="node">
<title>expert_linear1_3_8_2</title>
<polygon fill="lightgreen" stroke="black" points="825,-898 643,-898 643,-845 825,-845 825,-898"/>
<text text-anchor="middle" x="734" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 1</text>
<text text-anchor="middle" x="734" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="734" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_3_8_2&#45;&gt;expert_linear1_3_8_2 -->
<g id="edge530" class="edge">
<title>route_to_expert_3_8_2&#45;&gt;expert_linear1_3_8_2</title>
<path fill="none" stroke="black" d="M689.67,-934.55C696.3,-925.27 703.41,-915.31 709.96,-906.15"/>
<polygon fill="black" stroke="black" points="712.82,-908.17 715.78,-898 707.12,-904.1 712.82,-908.17"/>
</g>
<!-- expert_activation_3_8_2 -->
<g id="node432" class="node">
<title>expert_activation_3_8_2</title>
<polygon fill="lightgreen" stroke="black" points="1386,-809 1204,-809 1204,-756 1386,-756 1386,-809"/>
<text text-anchor="middle" x="1295" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 2 GELU</text>
<text text-anchor="middle" x="1295" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1295" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_3_8_2&#45;&gt;expert_activation_3_8_2 -->
<g id="edge531" class="edge">
<title>expert_linear1_3_8_2&#45;&gt;expert_activation_3_8_2</title>
<path fill="none" stroke="black" d="M825.07,-856.38C926.07,-840.71 1088.58,-815.51 1193.57,-799.23"/>
<polygon fill="black" stroke="black" points="1194.2,-802.67 1203.55,-797.68 1193.13,-795.76 1194.2,-802.67"/>
</g>
<!-- expert_linear2_3_8_2 -->
<g id="node433" class="node">
<title>expert_linear2_3_8_2</title>
<polygon fill="lightgreen" stroke="black" points="1473.5,-720 1300.5,-720 1300.5,-667 1473.5,-667 1473.5,-720"/>
<text text-anchor="middle" x="1387" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 2 Linear 2</text>
<text text-anchor="middle" x="1387" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1387" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_3_8_2&#45;&gt;expert_linear2_3_8_2 -->
<g id="edge532" class="edge">
<title>expert_activation_3_8_2&#45;&gt;expert_linear2_3_8_2</title>
<path fill="none" stroke="black" d="M1322.11,-755.87C1331.57,-746.92 1342.32,-736.75 1352.31,-727.3"/>
<polygon fill="black" stroke="black" points="1354.91,-729.66 1359.77,-720.25 1350.1,-724.58 1354.91,-729.66"/>
</g>
<!-- expert_linear2_3_8_2&#45;&gt;aggregate_3 -->
<g id="edge651" class="edge">
<title>expert_linear2_3_8_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1473.84,-678.82C1505.59,-674.32 1541.85,-669.77 1575,-667 2550.01,-585.61 3723.74,-577.99 4165.86,-578.3"/>
<polygon fill="black" stroke="black" points="4166.17,-581.8 4176.17,-578.31 4166.17,-574.8 4166.17,-581.8"/>
</g>
<!-- expert_linear1_3_8_3 -->
<g id="node435" class="node">
<title>expert_linear1_3_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1096,-898 914,-898 914,-845 1096,-845 1096,-898"/>
<text text-anchor="middle" x="1005" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 1</text>
<text text-anchor="middle" x="1005" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1005" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- route_to_expert_3_8_3&#45;&gt;expert_linear1_3_8_3 -->
<g id="edge534" class="edge">
<title>route_to_expert_3_8_3&#45;&gt;expert_linear1_3_8_3</title>
<path fill="none" stroke="black" d="M955.38,-934.83C962.86,-925.43 970.9,-915.33 978.29,-906.05"/>
<polygon fill="black" stroke="black" points="981.09,-908.15 984.58,-898.15 975.62,-903.79 981.09,-908.15"/>
</g>
<!-- expert_activation_3_8_3 -->
<g id="node436" class="node">
<title>expert_activation_3_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1712,-809 1530,-809 1530,-756 1712,-756 1712,-809"/>
<text text-anchor="middle" x="1621" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 3 GELU</text>
<text text-anchor="middle" x="1621" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1621" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_linear1_3_8_3&#45;&gt;expert_activation_3_8_3 -->
<g id="edge535" class="edge">
<title>expert_linear1_3_8_3&#45;&gt;expert_activation_3_8_3</title>
<path fill="none" stroke="black" d="M1096.06,-857.5C1124.25,-853.48 1155.41,-849.05 1184,-845 1299.04,-828.71 1431.14,-810.14 1519.72,-797.7"/>
<polygon fill="black" stroke="black" points="1520.35,-801.15 1529.76,-796.29 1519.37,-794.22 1520.35,-801.15"/>
</g>
<!-- expert_linear2_3_8_3 -->
<g id="node437" class="node">
<title>expert_linear2_3_8_3</title>
<polygon fill="lightgreen" stroke="black" points="1757.5,-720 1584.5,-720 1584.5,-667 1757.5,-667 1757.5,-720"/>
<text text-anchor="middle" x="1671" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 3 Linear 2</text>
<text text-anchor="middle" x="1671" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1671" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- expert_activation_3_8_3&#45;&gt;expert_linear2_3_8_3 -->
<g id="edge536" class="edge">
<title>expert_activation_3_8_3&#45;&gt;expert_linear2_3_8_3</title>
<path fill="none" stroke="black" d="M1635.73,-755.87C1640.57,-747.45 1646.03,-737.95 1651.18,-728.98"/>
<polygon fill="black" stroke="black" points="1654.25,-730.66 1656.2,-720.25 1648.18,-727.18 1654.25,-730.66"/>
</g>
<!-- expert_linear2_3_8_3&#45;&gt;aggregate_3 -->
<g id="edge652" class="edge">
<title>expert_linear2_3_8_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1757.78,-675.42C1777.51,-672.1 1798.42,-669.03 1818,-667 2274.74,-619.66 3672.22,-590.94 4168.69,-582.01"/>
<polygon fill="black" stroke="black" points="4168.88,-585.51 4178.82,-581.83 4168.75,-578.51 4168.88,-585.51"/>
</g>
<!-- expert_linear1_3_9_0 -->
<g id="node439" class="node">
<title>expert_linear1_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1375,-898 1193,-898 1193,-845 1375,-845 1375,-898"/>
<text text-anchor="middle" x="1284" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 1</text>
<text text-anchor="middle" x="1284" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1284" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_3_9_0&#45;&gt;expert_linear1_3_9_0 -->
<g id="edge538" class="edge">
<title>route_to_expert_3_9_0&#45;&gt;expert_linear1_3_9_0</title>
<path fill="none" stroke="black" d="M1223.67,-935.38C1232.98,-925.68 1243.05,-915.18 1252.25,-905.59"/>
<polygon fill="black" stroke="black" points="1255.01,-907.77 1259.41,-898.13 1249.96,-902.92 1255.01,-907.77"/>
</g>
<!-- expert_activation_3_9_0 -->
<g id="node440" class="node">
<title>expert_activation_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1975,-809 1793,-809 1793,-756 1975,-756 1975,-809"/>
<text text-anchor="middle" x="1884" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 4 GELU</text>
<text text-anchor="middle" x="1884" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1884" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_3_9_0&#45;&gt;expert_activation_3_9_0 -->
<g id="edge539" class="edge">
<title>expert_linear1_3_9_0&#45;&gt;expert_activation_3_9_0</title>
<path fill="none" stroke="black" d="M1375.11,-851.85C1388.46,-849.39 1402.07,-847.02 1415,-845 1550.3,-823.9 1585.33,-827.59 1721,-809 1741,-806.26 1762.34,-803.1 1782.76,-799.95"/>
<polygon fill="black" stroke="black" points="1783.36,-803.4 1792.71,-798.41 1782.29,-796.48 1783.36,-803.4"/>
</g>
<!-- expert_linear2_3_9_0 -->
<g id="node441" class="node">
<title>expert_linear2_3_9_0</title>
<polygon fill="lightgreen" stroke="black" points="1999.5,-720 1826.5,-720 1826.5,-667 1999.5,-667 1999.5,-720"/>
<text text-anchor="middle" x="1913" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 4 Linear 2</text>
<text text-anchor="middle" x="1913" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="1913" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_3_9_0&#45;&gt;expert_linear2_3_9_0 -->
<g id="edge540" class="edge">
<title>expert_activation_3_9_0&#45;&gt;expert_linear2_3_9_0</title>
<path fill="none" stroke="black" d="M1892.54,-755.87C1895.26,-747.71 1898.32,-738.54 1901.23,-729.82"/>
<polygon fill="black" stroke="black" points="1904.57,-730.84 1904.42,-720.25 1897.93,-728.63 1904.57,-730.84"/>
</g>
<!-- expert_linear2_3_9_0&#45;&gt;aggregate_3 -->
<g id="edge653" class="edge">
<title>expert_linear2_3_9_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M1999.8,-673.03C2012.88,-670.65 2026.26,-668.52 2039,-667 2450.61,-617.83 3703.22,-590.66 4169.05,-582.05"/>
<polygon fill="black" stroke="black" points="4169.3,-585.54 4179.23,-581.86 4169.17,-578.55 4169.3,-585.54"/>
</g>
<!-- expert_linear1_3_9_1 -->
<g id="node443" class="node">
<title>expert_linear1_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="1606,-898 1424,-898 1424,-845 1606,-845 1606,-898"/>
<text text-anchor="middle" x="1515" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 1</text>
<text text-anchor="middle" x="1515" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1515" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_3_9_1&#45;&gt;expert_linear1_3_9_1 -->
<g id="edge542" class="edge">
<title>route_to_expert_3_9_1&#45;&gt;expert_linear1_3_9_1</title>
<path fill="none" stroke="black" d="M1475.73,-934.55C1481.49,-925.46 1487.65,-915.72 1493.35,-906.71"/>
<polygon fill="black" stroke="black" points="1496.47,-908.32 1498.86,-898 1490.56,-904.58 1496.47,-908.32"/>
</g>
<!-- expert_activation_3_9_1 -->
<g id="node444" class="node">
<title>expert_activation_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="2206,-809 2024,-809 2024,-756 2206,-756 2206,-809"/>
<text text-anchor="middle" x="2115" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 5 GELU</text>
<text text-anchor="middle" x="2115" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2115" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_3_9_1&#45;&gt;expert_activation_3_9_1 -->
<g id="edge543" class="edge">
<title>expert_linear1_3_9_1&#45;&gt;expert_activation_3_9_1</title>
<path fill="none" stroke="black" d="M1606.29,-855.59C1629.64,-851.95 1654.73,-848.19 1678,-845 1813.67,-826.41 1848.7,-830.1 1984,-809 1993.7,-807.49 2003.78,-805.78 2013.85,-803.98"/>
<polygon fill="black" stroke="black" points="2014.68,-807.38 2023.89,-802.15 2013.43,-800.49 2014.68,-807.38"/>
</g>
<!-- expert_linear2_3_9_1 -->
<g id="node445" class="node">
<title>expert_linear2_3_9_1</title>
<polygon fill="lightgreen" stroke="black" points="2220.5,-720 2047.5,-720 2047.5,-667 2220.5,-667 2220.5,-720"/>
<text text-anchor="middle" x="2134" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 5 Linear 2</text>
<text text-anchor="middle" x="2134" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2134" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_3_9_1&#45;&gt;expert_linear2_3_9_1 -->
<g id="edge544" class="edge">
<title>expert_activation_3_9_1&#45;&gt;expert_linear2_3_9_1</title>
<path fill="none" stroke="black" d="M2120.6,-755.87C2122.36,-747.8 2124.34,-738.74 2126.22,-730.1"/>
<polygon fill="black" stroke="black" points="2129.66,-730.77 2128.38,-720.25 2122.82,-729.27 2129.66,-730.77"/>
</g>
<!-- expert_linear2_3_9_1&#45;&gt;aggregate_3 -->
<g id="edge654" class="edge">
<title>expert_linear2_3_9_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2220.81,-671.7C2230.61,-669.86 2240.49,-668.24 2250,-667 2618.99,-619.07 3734.23,-591.59 4169.4,-582.45"/>
<polygon fill="black" stroke="black" points="4169.62,-585.95 4179.55,-582.24 4169.48,-578.95 4169.62,-585.95"/>
</g>
<!-- expert_linear1_3_9_2 -->
<g id="node447" class="node">
<title>expert_linear1_3_9_2</title>
<polygon fill="lightgreen" stroke="black" points="1869,-898 1687,-898 1687,-845 1869,-845 1869,-898"/>
<text text-anchor="middle" x="1778" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 1</text>
<text text-anchor="middle" x="1778" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="1778" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_3_9_2&#45;&gt;expert_linear1_3_9_2 -->
<g id="edge546" class="edge">
<title>route_to_expert_3_9_2&#45;&gt;expert_linear1_3_9_2</title>
<path fill="none" stroke="black" d="M1738.73,-934.55C1744.49,-925.46 1750.65,-915.72 1756.35,-906.71"/>
<polygon fill="black" stroke="black" points="1759.47,-908.32 1761.86,-898 1753.56,-904.58 1759.47,-908.32"/>
</g>
<!-- expert_activation_3_9_2 -->
<g id="node448" class="node">
<title>expert_activation_3_9_2</title>
<polygon fill="lightgreen" stroke="black" points="2422,-809 2240,-809 2240,-756 2422,-756 2422,-809"/>
<text text-anchor="middle" x="2331" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 6 GELU</text>
<text text-anchor="middle" x="2331" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2331" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_3_9_2&#45;&gt;expert_activation_3_9_2 -->
<g id="edge547" class="edge">
<title>expert_linear1_3_9_2&#45;&gt;expert_activation_3_9_2</title>
<path fill="none" stroke="black" d="M1869.32,-855.81C1892.67,-852.16 1917.75,-848.35 1941,-845 2062.57,-827.51 2094.02,-830.2 2215,-809 2219.95,-808.13 2225.01,-807.2 2230.11,-806.22"/>
<polygon fill="black" stroke="black" points="2230.82,-809.65 2239.96,-804.29 2229.47,-802.78 2230.82,-809.65"/>
</g>
<!-- expert_linear2_3_9_2 -->
<g id="node449" class="node">
<title>expert_linear2_3_9_2</title>
<polygon fill="lightgreen" stroke="black" points="2431.5,-720 2258.5,-720 2258.5,-667 2431.5,-667 2431.5,-720"/>
<text text-anchor="middle" x="2345" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 6 Linear 2</text>
<text text-anchor="middle" x="2345" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2345" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_3_9_2&#45;&gt;expert_linear2_3_9_2 -->
<g id="edge548" class="edge">
<title>expert_activation_3_9_2&#45;&gt;expert_linear2_3_9_2</title>
<path fill="none" stroke="black" d="M2335.12,-755.87C2336.41,-747.89 2337.85,-738.93 2339.23,-730.38"/>
<polygon fill="black" stroke="black" points="2342.72,-730.68 2340.86,-720.25 2335.81,-729.57 2342.72,-730.68"/>
</g>
<!-- expert_linear2_3_9_2&#45;&gt;aggregate_3 -->
<g id="edge655" class="edge">
<title>expert_linear2_3_9_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2431.79,-670.85C2439.61,-669.36 2447.43,-668.05 2455,-667 2783.01,-621.73 3766.22,-593.2 4169.98,-583.11"/>
<polygon fill="black" stroke="black" points="4170.09,-586.61 4180,-582.86 4169.91,-579.61 4170.09,-586.61"/>
</g>
<!-- expert_linear1_3_9_3 -->
<g id="node451" class="node">
<title>expert_linear1_3_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2132,-898 1950,-898 1950,-845 2132,-845 2132,-898"/>
<text text-anchor="middle" x="2041" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 1</text>
<text text-anchor="middle" x="2041" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2041" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- route_to_expert_3_9_3&#45;&gt;expert_linear1_3_9_3 -->
<g id="edge550" class="edge">
<title>route_to_expert_3_9_3&#45;&gt;expert_linear1_3_9_3</title>
<path fill="none" stroke="black" d="M2001.73,-934.55C2007.49,-925.46 2013.65,-915.72 2019.35,-906.71"/>
<polygon fill="black" stroke="black" points="2022.47,-908.32 2024.86,-898 2016.56,-904.58 2022.47,-908.32"/>
</g>
<!-- expert_activation_3_9_3 -->
<g id="node452" class="node">
<title>expert_activation_3_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2630,-809 2448,-809 2448,-756 2630,-756 2630,-809"/>
<text text-anchor="middle" x="2539" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 7 GELU</text>
<text text-anchor="middle" x="2539" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2539" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_linear1_3_9_3&#45;&gt;expert_activation_3_9_3 -->
<g id="edge551" class="edge">
<title>expert_linear1_3_9_3&#45;&gt;expert_activation_3_9_3</title>
<path fill="none" stroke="black" d="M2132.18,-856.21C2245.12,-838.49 2423.66,-810.44 2431,-809 2433.23,-808.56 2435.48,-808.11 2437.75,-807.65"/>
<polygon fill="black" stroke="black" points="2438.7,-811.02 2447.77,-805.55 2437.27,-804.17 2438.7,-811.02"/>
</g>
<!-- expert_linear2_3_9_3 -->
<g id="node453" class="node">
<title>expert_linear2_3_9_3</title>
<polygon fill="lightgreen" stroke="black" points="2636.5,-720 2463.5,-720 2463.5,-667 2636.5,-667 2636.5,-720"/>
<text text-anchor="middle" x="2550" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 7 Linear 2</text>
<text text-anchor="middle" x="2550" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2550" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- expert_activation_3_9_3&#45;&gt;expert_linear2_3_9_3 -->
<g id="edge552" class="edge">
<title>expert_activation_3_9_3&#45;&gt;expert_linear2_3_9_3</title>
<path fill="none" stroke="black" d="M2542.24,-755.87C2543.25,-747.89 2544.38,-738.93 2545.46,-730.38"/>
<polygon fill="black" stroke="black" points="2548.96,-730.61 2546.74,-720.25 2542.02,-729.73 2548.96,-730.61"/>
</g>
<!-- expert_linear2_3_9_3&#45;&gt;aggregate_3 -->
<g id="edge656" class="edge">
<title>expert_linear2_3_9_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2636.69,-670.6C2643.87,-669.22 2651.04,-668 2658,-667 2945.88,-625.85 3799.75,-595.67 4170.7,-584.14"/>
<polygon fill="black" stroke="black" points="4170.83,-587.64 4180.72,-583.83 4170.62,-580.64 4170.83,-587.64"/>
</g>
<!-- expert_linear1_3_10_0 -->
<g id="node455" class="node">
<title>expert_linear1_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2395,-898 2213,-898 2213,-845 2395,-845 2395,-898"/>
<text text-anchor="middle" x="2304" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 1</text>
<text text-anchor="middle" x="2304" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2304" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_3_10_0&#45;&gt;expert_linear1_3_10_0 -->
<g id="edge554" class="edge">
<title>route_to_expert_3_10_0&#45;&gt;expert_linear1_3_10_0</title>
<path fill="none" stroke="black" d="M2264.73,-934.55C2270.49,-925.46 2276.65,-915.72 2282.35,-906.71"/>
<polygon fill="black" stroke="black" points="2285.47,-908.32 2287.86,-898 2279.56,-904.58 2285.47,-908.32"/>
</g>
<!-- expert_activation_3_10_0 -->
<g id="node456" class="node">
<title>expert_activation_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2834,-809 2652,-809 2652,-756 2834,-756 2834,-809"/>
<text text-anchor="middle" x="2743" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 8 GELU</text>
<text text-anchor="middle" x="2743" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2743" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_3_10_0&#45;&gt;expert_activation_3_10_0 -->
<g id="edge555" class="edge">
<title>expert_linear1_3_10_0&#45;&gt;expert_activation_3_10_0</title>
<path fill="none" stroke="black" d="M2395.28,-855.24C2462.8,-843.58 2556.9,-826.59 2639,-809 2639.91,-808.8 2640.83,-808.61 2641.76,-808.41"/>
<polygon fill="black" stroke="black" points="2642.75,-811.77 2651.76,-806.19 2641.24,-804.94 2642.75,-811.77"/>
</g>
<!-- expert_linear2_3_10_0 -->
<g id="node457" class="node">
<title>expert_linear2_3_10_0</title>
<polygon fill="lightgreen" stroke="black" points="2839.5,-720 2666.5,-720 2666.5,-667 2839.5,-667 2839.5,-720"/>
<text text-anchor="middle" x="2753" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 8 Linear 2</text>
<text text-anchor="middle" x="2753" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2753" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_3_10_0&#45;&gt;expert_linear2_3_10_0 -->
<g id="edge556" class="edge">
<title>expert_activation_3_10_0&#45;&gt;expert_linear2_3_10_0</title>
<path fill="none" stroke="black" d="M2745.95,-755.87C2746.86,-747.89 2747.89,-738.93 2748.88,-730.38"/>
<polygon fill="black" stroke="black" points="2752.38,-730.58 2750.04,-720.25 2745.42,-729.78 2752.38,-730.58"/>
</g>
<!-- expert_linear2_3_10_0&#45;&gt;aggregate_3 -->
<g id="edge657" class="edge">
<title>expert_linear2_3_10_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M2839.53,-670.37C2846.09,-669.09 2852.63,-667.95 2859,-667 3327.24,-597.38 3886.14,-582.33 4166.64,-579.41"/>
<polygon fill="black" stroke="black" points="4166.95,-582.9 4176.91,-579.3 4166.88,-575.9 4166.95,-582.9"/>
</g>
<!-- expert_linear1_3_10_1 -->
<g id="node459" class="node">
<title>expert_linear1_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="2658,-898 2476,-898 2476,-845 2658,-845 2658,-898"/>
<text text-anchor="middle" x="2567" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 1</text>
<text text-anchor="middle" x="2567" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2567" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_3_10_1&#45;&gt;expert_linear1_3_10_1 -->
<g id="edge558" class="edge">
<title>route_to_expert_3_10_1&#45;&gt;expert_linear1_3_10_1</title>
<path fill="none" stroke="black" d="M2527.73,-934.55C2533.49,-925.46 2539.65,-915.72 2545.35,-906.71"/>
<polygon fill="black" stroke="black" points="2548.47,-908.32 2550.86,-898 2542.56,-904.58 2548.47,-908.32"/>
</g>
<!-- expert_activation_3_10_1 -->
<g id="node460" class="node">
<title>expert_activation_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3036,-809 2854,-809 2854,-756 3036,-756 3036,-809"/>
<text text-anchor="middle" x="2945" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 9 GELU</text>
<text text-anchor="middle" x="2945" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2945" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_3_10_1&#45;&gt;expert_activation_3_10_1 -->
<g id="edge559" class="edge">
<title>expert_linear1_3_10_1&#45;&gt;expert_activation_3_10_1</title>
<path fill="none" stroke="black" d="M2658.19,-850.8C2712.04,-839.01 2781.49,-823.54 2843,-809 2843.33,-808.92 2843.67,-808.84 2844,-808.76"/>
<polygon fill="black" stroke="black" points="2844.91,-812.14 2853.83,-806.42 2843.29,-805.33 2844.91,-812.14"/>
</g>
<!-- expert_linear2_3_10_1 -->
<g id="node461" class="node">
<title>expert_linear2_3_10_1</title>
<polygon fill="lightgreen" stroke="black" points="3040.5,-720 2867.5,-720 2867.5,-667 3040.5,-667 3040.5,-720"/>
<text text-anchor="middle" x="2954" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 9 Linear 2</text>
<text text-anchor="middle" x="2954" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="2954" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_3_10_1&#45;&gt;expert_linear2_3_10_1 -->
<g id="edge560" class="edge">
<title>expert_activation_3_10_1&#45;&gt;expert_linear2_3_10_1</title>
<path fill="none" stroke="black" d="M2947.65,-755.87C2948.48,-747.89 2949.4,-738.93 2950.29,-730.38"/>
<polygon fill="black" stroke="black" points="2953.79,-730.56 2951.34,-720.25 2946.83,-729.84 2953.79,-730.56"/>
</g>
<!-- expert_linear2_3_10_1&#45;&gt;aggregate_3 -->
<g id="edge658" class="edge">
<title>expert_linear2_3_10_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3040.58,-670.26C3046.79,-669.04 3052.97,-667.93 3059,-667 3452.09,-606.28 3919.19,-587.46 4168.42,-581.62"/>
<polygon fill="black" stroke="black" points="4168.74,-585.11 4178.66,-581.39 4168.58,-578.12 4168.74,-585.11"/>
</g>
<!-- expert_linear1_3_10_2 -->
<g id="node463" class="node">
<title>expert_linear1_3_10_2</title>
<polygon fill="lightgreen" stroke="black" points="2921,-898 2739,-898 2739,-845 2921,-845 2921,-898"/>
<text text-anchor="middle" x="2830" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 1</text>
<text text-anchor="middle" x="2830" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="2830" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_3_10_2&#45;&gt;expert_linear1_3_10_2 -->
<g id="edge562" class="edge">
<title>route_to_expert_3_10_2&#45;&gt;expert_linear1_3_10_2</title>
<path fill="none" stroke="black" d="M2790.73,-934.55C2796.49,-925.46 2802.65,-915.72 2808.35,-906.71"/>
<polygon fill="black" stroke="black" points="2811.47,-908.32 2813.86,-898 2805.56,-904.58 2811.47,-908.32"/>
</g>
<!-- expert_activation_3_10_2 -->
<g id="node464" class="node">
<title>expert_activation_3_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3237,-809 3055,-809 3055,-756 3237,-756 3237,-809"/>
<text text-anchor="middle" x="3146" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 10 GELU</text>
<text text-anchor="middle" x="3146" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3146" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_3_10_2&#45;&gt;expert_activation_3_10_2 -->
<g id="edge563" class="edge">
<title>expert_linear1_3_10_2&#45;&gt;expert_activation_3_10_2</title>
<path fill="none" stroke="black" d="M2921.4,-845.34C2960.13,-834.67 3005.4,-822.21 3045.1,-811.28"/>
<polygon fill="black" stroke="black" points="3046.09,-814.64 3054.81,-808.61 3044.23,-807.89 3046.09,-814.64"/>
</g>
<!-- expert_linear2_3_10_2 -->
<g id="node465" class="node">
<title>expert_linear2_3_10_2</title>
<polygon fill="lightgreen" stroke="black" points="3240.5,-720 3067.5,-720 3067.5,-667 3240.5,-667 3240.5,-720"/>
<text text-anchor="middle" x="3154" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 10 Linear 2</text>
<text text-anchor="middle" x="3154" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3154" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_3_10_2&#45;&gt;expert_linear2_3_10_2 -->
<g id="edge564" class="edge">
<title>expert_activation_3_10_2&#45;&gt;expert_linear2_3_10_2</title>
<path fill="none" stroke="black" d="M3148.36,-755.87C3149.09,-747.89 3149.91,-738.93 3150.7,-730.38"/>
<polygon fill="black" stroke="black" points="3154.2,-730.53 3151.63,-720.25 3147.23,-729.89 3154.2,-730.53"/>
</g>
<!-- expert_linear2_3_10_2&#45;&gt;aggregate_3 -->
<g id="edge659" class="edge">
<title>expert_linear2_3_10_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3240.59,-670.34C3246.8,-669.1 3252.98,-667.97 3259,-667 3578.25,-615.64 3955.34,-593.64 4170.99,-584.69"/>
<polygon fill="black" stroke="black" points="4171.29,-588.18 4181.14,-584.27 4171,-581.18 4171.29,-588.18"/>
</g>
<!-- expert_linear1_3_10_3 -->
<g id="node467" class="node">
<title>expert_linear1_3_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3183,-898 3001,-898 3001,-845 3183,-845 3183,-898"/>
<text text-anchor="middle" x="3092" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 1</text>
<text text-anchor="middle" x="3092" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3092" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- route_to_expert_3_10_3&#45;&gt;expert_linear1_3_10_3 -->
<g id="edge566" class="edge">
<title>route_to_expert_3_10_3&#45;&gt;expert_linear1_3_10_3</title>
<path fill="none" stroke="black" d="M3053.37,-934.55C3059.03,-925.46 3065.09,-915.72 3070.7,-906.71"/>
<polygon fill="black" stroke="black" points="3073.81,-908.34 3076.12,-898 3067.87,-904.64 3073.81,-908.34"/>
</g>
<!-- expert_activation_3_10_3 -->
<g id="node468" class="node">
<title>expert_activation_3_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3437,-809 3255,-809 3255,-756 3437,-756 3437,-809"/>
<text text-anchor="middle" x="3346" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 11 GELU</text>
<text text-anchor="middle" x="3346" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3346" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_linear1_3_10_3&#45;&gt;expert_activation_3_10_3 -->
<g id="edge567" class="edge">
<title>expert_linear1_3_10_3&#45;&gt;expert_activation_3_10_3</title>
<path fill="none" stroke="black" d="M3166.49,-844.98C3196.34,-834.76 3230.89,-822.93 3261.66,-812.39"/>
<polygon fill="black" stroke="black" points="3263.18,-815.57 3271.51,-809.01 3260.91,-808.94 3263.18,-815.57"/>
</g>
<!-- expert_linear2_3_10_3 -->
<g id="node469" class="node">
<title>expert_linear2_3_10_3</title>
<polygon fill="lightgreen" stroke="black" points="3440.5,-720 3267.5,-720 3267.5,-667 3440.5,-667 3440.5,-720"/>
<text text-anchor="middle" x="3354" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 11 Linear 2</text>
<text text-anchor="middle" x="3354" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3354" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- expert_activation_3_10_3&#45;&gt;expert_linear2_3_10_3 -->
<g id="edge568" class="edge">
<title>expert_activation_3_10_3&#45;&gt;expert_linear2_3_10_3</title>
<path fill="none" stroke="black" d="M3348.36,-755.87C3349.09,-747.89 3349.91,-738.93 3350.7,-730.38"/>
<polygon fill="black" stroke="black" points="3354.2,-730.53 3351.63,-720.25 3347.23,-729.89 3354.2,-730.53"/>
</g>
<!-- expert_linear2_3_10_3&#45;&gt;aggregate_3 -->
<g id="edge660" class="edge">
<title>expert_linear2_3_10_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3440.61,-670.47C3446.81,-669.2 3452.99,-668.02 3459,-667 3705.86,-624.99 3995.04,-600.93 4174.4,-588.91"/>
<polygon fill="black" stroke="black" points="4174.71,-592.4 4184.46,-588.24 4174.25,-585.41 4174.71,-592.4"/>
</g>
<!-- expert_linear1_3_11_0 -->
<g id="node471" class="node">
<title>expert_linear1_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3444,-898 3262,-898 3262,-845 3444,-845 3444,-898"/>
<text text-anchor="middle" x="3353" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 1</text>
<text text-anchor="middle" x="3353" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3353" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_3_11_0&#45;&gt;expert_linear1_3_11_0 -->
<g id="edge570" class="edge">
<title>route_to_expert_3_11_0&#45;&gt;expert_linear1_3_11_0</title>
<path fill="none" stroke="black" d="M3315.63,-934.55C3321.11,-925.46 3326.98,-915.72 3332.4,-906.71"/>
<polygon fill="black" stroke="black" points="3335.48,-908.37 3337.64,-898 3329.49,-904.76 3335.48,-908.37"/>
</g>
<!-- expert_activation_3_11_0 -->
<g id="node472" class="node">
<title>expert_activation_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3637,-809 3455,-809 3455,-756 3637,-756 3637,-809"/>
<text text-anchor="middle" x="3546" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 12 GELU</text>
<text text-anchor="middle" x="3546" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3546" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_3_11_0&#45;&gt;expert_activation_3_11_0 -->
<g id="edge571" class="edge">
<title>expert_linear1_3_11_0&#45;&gt;expert_activation_3_11_0</title>
<path fill="none" stroke="black" d="M3409.6,-844.98C3431.7,-835.03 3457.18,-823.54 3480.09,-813.21"/>
<polygon fill="black" stroke="black" points="3481.72,-816.31 3489.4,-809.01 3478.84,-809.93 3481.72,-816.31"/>
</g>
<!-- expert_linear2_3_11_0 -->
<g id="node473" class="node">
<title>expert_linear2_3_11_0</title>
<polygon fill="lightgreen" stroke="black" points="3640.5,-720 3467.5,-720 3467.5,-667 3640.5,-667 3640.5,-720"/>
<text text-anchor="middle" x="3554" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 12 Linear 2</text>
<text text-anchor="middle" x="3554" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3554" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_3_11_0&#45;&gt;expert_linear2_3_11_0 -->
<g id="edge572" class="edge">
<title>expert_activation_3_11_0&#45;&gt;expert_linear2_3_11_0</title>
<path fill="none" stroke="black" d="M3548.36,-755.87C3549.09,-747.89 3549.91,-738.93 3550.7,-730.38"/>
<polygon fill="black" stroke="black" points="3554.2,-730.53 3551.63,-720.25 3547.23,-729.89 3554.2,-730.53"/>
</g>
<!-- expert_linear2_3_11_0&#45;&gt;aggregate_3 -->
<g id="edge661" class="edge">
<title>expert_linear2_3_11_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3640.64,-670.66C3646.84,-669.35 3653,-668.11 3659,-667 3835.2,-634.42 4039.06,-609.95 4178.67,-595.19"/>
<polygon fill="black" stroke="black" points="4179.45,-598.63 4189.03,-594.1 4178.72,-591.67 4179.45,-598.63"/>
</g>
<!-- expert_linear1_3_11_1 -->
<g id="node475" class="node">
<title>expert_linear1_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="3703,-898 3521,-898 3521,-845 3703,-845 3703,-898"/>
<text text-anchor="middle" x="3612" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 1</text>
<text text-anchor="middle" x="3612" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3612" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_3_11_1&#45;&gt;expert_linear1_3_11_1 -->
<g id="edge574" class="edge">
<title>route_to_expert_3_11_1&#45;&gt;expert_linear1_3_11_1</title>
<path fill="none" stroke="black" d="M3577.32,-934.27C3582.32,-925.37 3587.66,-915.87 3592.61,-907.05"/>
<polygon fill="black" stroke="black" points="3595.75,-908.59 3597.6,-898.16 3589.65,-905.16 3595.75,-908.59"/>
</g>
<!-- expert_activation_3_11_1 -->
<g id="node476" class="node">
<title>expert_activation_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="3837,-809 3655,-809 3655,-756 3837,-756 3837,-809"/>
<text text-anchor="middle" x="3746" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 13 GELU</text>
<text text-anchor="middle" x="3746" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3746" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_3_11_1&#45;&gt;expert_activation_3_11_1 -->
<g id="edge575" class="edge">
<title>expert_linear1_3_11_1&#45;&gt;expert_activation_3_11_1</title>
<path fill="none" stroke="black" d="M3651.48,-844.87C3665.94,-835.48 3682.46,-824.75 3697.61,-814.92"/>
<polygon fill="black" stroke="black" points="3699.86,-817.63 3706.34,-809.25 3696.05,-811.76 3699.86,-817.63"/>
</g>
<!-- expert_linear2_3_11_1 -->
<g id="node477" class="node">
<title>expert_linear2_3_11_1</title>
<polygon fill="lightgreen" stroke="black" points="3840.5,-720 3667.5,-720 3667.5,-667 3840.5,-667 3840.5,-720"/>
<text text-anchor="middle" x="3754" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 13 Linear 2</text>
<text text-anchor="middle" x="3754" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3754" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_3_11_1&#45;&gt;expert_linear2_3_11_1 -->
<g id="edge576" class="edge">
<title>expert_activation_3_11_1&#45;&gt;expert_linear2_3_11_1</title>
<path fill="none" stroke="black" d="M3748.36,-755.87C3749.09,-747.89 3749.91,-738.93 3750.7,-730.38"/>
<polygon fill="black" stroke="black" points="3754.2,-730.53 3751.63,-720.25 3747.23,-729.89 3754.2,-730.53"/>
</g>
<!-- expert_linear2_3_11_1&#45;&gt;aggregate_3 -->
<g id="edge662" class="edge">
<title>expert_linear2_3_11_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M3840.73,-670.81C3846.57,-669.48 3852.36,-668.2 3858,-667 3967.29,-643.77 4091.19,-621.48 4186.79,-605.14"/>
<polygon fill="black" stroke="black" points="4187.57,-608.56 4196.84,-603.43 4186.39,-601.66 4187.57,-608.56"/>
</g>
<!-- expert_linear1_3_11_2 -->
<g id="node479" class="node">
<title>expert_linear1_3_11_2</title>
<polygon fill="lightgreen" stroke="black" points="3958,-898 3776,-898 3776,-845 3958,-845 3958,-898"/>
<text text-anchor="middle" x="3867" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 1</text>
<text text-anchor="middle" x="3867" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3867" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_3_11_2&#45;&gt;expert_linear1_3_11_2 -->
<g id="edge578" class="edge">
<title>route_to_expert_3_11_2&#45;&gt;expert_linear1_3_11_2</title>
<path fill="none" stroke="black" d="M3837.37,-934.27C3841.59,-925.47 3846.1,-916.07 3850.29,-907.32"/>
<polygon fill="black" stroke="black" points="3853.52,-908.69 3854.69,-898.16 3847.21,-905.66 3853.52,-908.69"/>
</g>
<!-- expert_activation_3_11_2 -->
<g id="node480" class="node">
<title>expert_activation_3_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4037,-809 3855,-809 3855,-756 4037,-756 4037,-809"/>
<text text-anchor="middle" x="3946" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 14 GELU</text>
<text text-anchor="middle" x="3946" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="3946" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_3_11_2&#45;&gt;expert_activation_3_11_2 -->
<g id="edge579" class="edge">
<title>expert_linear1_3_11_2&#45;&gt;expert_activation_3_11_2</title>
<path fill="none" stroke="black" d="M3890.28,-844.87C3898.24,-836.1 3907.27,-826.15 3915.71,-816.86"/>
<polygon fill="black" stroke="black" points="3918.49,-819.01 3922.62,-809.25 3913.3,-814.3 3918.49,-819.01"/>
</g>
<!-- expert_linear2_3_11_2 -->
<g id="node481" class="node">
<title>expert_linear2_3_11_2</title>
<polygon fill="lightgreen" stroke="black" points="4039.5,-720 3866.5,-720 3866.5,-667 4039.5,-667 4039.5,-720"/>
<text text-anchor="middle" x="3953" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 14 Linear 2</text>
<text text-anchor="middle" x="3953" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="3953" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_3_11_2&#45;&gt;expert_linear2_3_11_2 -->
<g id="edge580" class="edge">
<title>expert_activation_3_11_2&#45;&gt;expert_linear2_3_11_2</title>
<path fill="none" stroke="black" d="M3948.06,-755.87C3948.7,-747.89 3949.43,-738.93 3950.11,-730.38"/>
<polygon fill="black" stroke="black" points="3953.61,-730.5 3950.93,-720.25 3946.64,-729.94 3953.61,-730.5"/>
</g>
<!-- expert_linear2_3_11_2&#45;&gt;aggregate_3 -->
<g id="edge663" class="edge">
<title>expert_linear2_3_11_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4039.73,-667.45C4086.64,-653.9 4145.85,-636.8 4199.67,-621.26"/>
<polygon fill="black" stroke="black" points="4200.67,-624.62 4209.3,-618.48 4198.72,-617.89 4200.67,-624.62"/>
</g>
<!-- expert_linear1_3_11_3 -->
<g id="node483" class="node">
<title>expert_linear1_3_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4206,-898 4024,-898 4024,-845 4206,-845 4206,-898"/>
<text text-anchor="middle" x="4115" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 1</text>
<text text-anchor="middle" x="4115" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4115" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- route_to_expert_3_11_3&#45;&gt;expert_linear1_3_11_3 -->
<g id="edge582" class="edge">
<title>route_to_expert_3_11_3&#45;&gt;expert_linear1_3_11_3</title>
<path fill="none" stroke="black" d="M4094.92,-933.99C4097.73,-925.39 4100.72,-916.24 4103.51,-907.69"/>
<polygon fill="black" stroke="black" points="4106.89,-908.6 4106.67,-898.01 4100.24,-906.43 4106.89,-908.6"/>
</g>
<!-- expert_activation_3_11_3 -->
<g id="node484" class="node">
<title>expert_activation_3_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4237,-809 4055,-809 4055,-756 4237,-756 4237,-809"/>
<text text-anchor="middle" x="4146" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 15 GELU</text>
<text text-anchor="middle" x="4146" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4146" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_linear1_3_11_3&#45;&gt;expert_activation_3_11_3 -->
<g id="edge583" class="edge">
<title>expert_linear1_3_11_3&#45;&gt;expert_activation_3_11_3</title>
<path fill="none" stroke="black" d="M4124.13,-844.87C4127.04,-836.71 4130.31,-827.54 4133.41,-818.82"/>
<polygon fill="black" stroke="black" points="4136.77,-819.84 4136.82,-809.25 4130.17,-817.49 4136.77,-819.84"/>
</g>
<!-- expert_linear2_3_11_3 -->
<g id="node485" class="node">
<title>expert_linear2_3_11_3</title>
<polygon fill="lightgreen" stroke="black" points="4237.5,-720 4064.5,-720 4064.5,-667 4237.5,-667 4237.5,-720"/>
<text text-anchor="middle" x="4151" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 15 Linear 2</text>
<text text-anchor="middle" x="4151" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4151" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- expert_activation_3_11_3&#45;&gt;expert_linear2_3_11_3 -->
<g id="edge584" class="edge">
<title>expert_activation_3_11_3&#45;&gt;expert_linear2_3_11_3</title>
<path fill="none" stroke="black" d="M4147.47,-755.87C4147.93,-747.89 4148.45,-738.93 4148.94,-730.38"/>
<polygon fill="black" stroke="black" points="4152.44,-730.43 4149.52,-720.25 4145.45,-730.03 4152.44,-730.43"/>
</g>
<!-- expert_linear2_3_11_3&#45;&gt;aggregate_3 -->
<g id="edge664" class="edge">
<title>expert_linear2_3_11_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4195.25,-666.75C4210.89,-657.64 4229.17,-647 4247.5,-636.33"/>
<polygon fill="black" stroke="black" points="4249.61,-639.15 4256.49,-631.1 4246.09,-633.1 4249.61,-639.15"/>
</g>
<!-- expert_linear1_3_12_0 -->
<g id="node487" class="node">
<title>expert_linear1_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4437,-898 4255,-898 4255,-845 4437,-845 4437,-898"/>
<text text-anchor="middle" x="4346" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 16 Linear 1</text>
<text text-anchor="middle" x="4346" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4346" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_3_12_0&#45;&gt;expert_linear1_3_12_0 -->
<g id="edge586" class="edge">
<title>route_to_expert_3_12_0&#45;&gt;expert_linear1_3_12_0</title>
<path fill="none" stroke="black" d="M4346,-933.99C4346,-925.58 4346,-916.63 4346,-908.25"/>
<polygon fill="black" stroke="black" points="4349.5,-908.01 4346,-898.01 4342.5,-908.01 4349.5,-908.01"/>
</g>
<!-- expert_activation_3_12_0 -->
<g id="node488" class="node">
<title>expert_activation_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4437,-809 4255,-809 4255,-756 4437,-756 4437,-809"/>
<text text-anchor="middle" x="4346" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 16 GELU</text>
<text text-anchor="middle" x="4346" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4346" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_3_12_0&#45;&gt;expert_activation_3_12_0 -->
<g id="edge587" class="edge">
<title>expert_linear1_3_12_0&#45;&gt;expert_activation_3_12_0</title>
<path fill="none" stroke="black" d="M4346,-844.87C4346,-836.89 4346,-827.93 4346,-819.38"/>
<polygon fill="black" stroke="black" points="4349.5,-819.25 4346,-809.25 4342.5,-819.25 4349.5,-819.25"/>
</g>
<!-- expert_linear2_3_12_0 -->
<g id="node489" class="node">
<title>expert_linear2_3_12_0</title>
<polygon fill="lightgreen" stroke="black" points="4432.5,-720 4259.5,-720 4259.5,-667 4432.5,-667 4432.5,-720"/>
<text text-anchor="middle" x="4346" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 16 Linear 2</text>
<text text-anchor="middle" x="4346" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4346" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_3_12_0&#45;&gt;expert_linear2_3_12_0 -->
<g id="edge588" class="edge">
<title>expert_activation_3_12_0&#45;&gt;expert_linear2_3_12_0</title>
<path fill="none" stroke="black" d="M4346,-755.87C4346,-747.89 4346,-738.93 4346,-730.38"/>
<polygon fill="black" stroke="black" points="4349.5,-730.25 4346,-720.25 4342.5,-730.25 4349.5,-730.25"/>
</g>
<!-- expert_linear2_3_12_0&#45;&gt;aggregate_3 -->
<g id="edge665" class="edge">
<title>expert_linear2_3_12_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4346,-666.75C4346,-659.05 4346,-650.25 4346,-641.27"/>
<polygon fill="black" stroke="black" points="4349.5,-641.1 4346,-631.1 4342.5,-641.1 4349.5,-641.1"/>
</g>
<!-- expert_linear1_3_12_1 -->
<g id="node491" class="node">
<title>expert_linear1_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4669,-898 4487,-898 4487,-845 4669,-845 4669,-898"/>
<text text-anchor="middle" x="4578" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 17 Linear 1</text>
<text text-anchor="middle" x="4578" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4578" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_3_12_1&#45;&gt;expert_linear1_3_12_1 -->
<g id="edge590" class="edge">
<title>route_to_expert_3_12_1&#45;&gt;expert_linear1_3_12_1</title>
<path fill="none" stroke="black" d="M4597.46,-933.99C4594.73,-925.39 4591.84,-916.24 4589.13,-907.69"/>
<polygon fill="black" stroke="black" points="4592.43,-906.49 4586.07,-898.01 4585.75,-908.6 4592.43,-906.49"/>
</g>
<!-- expert_activation_3_12_1 -->
<g id="node492" class="node">
<title>expert_activation_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4659,-809 4477,-809 4477,-756 4659,-756 4659,-809"/>
<text text-anchor="middle" x="4568" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 17 GELU</text>
<text text-anchor="middle" x="4568" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4568" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_3_12_1&#45;&gt;expert_activation_3_12_1 -->
<g id="edge591" class="edge">
<title>expert_linear1_3_12_1&#45;&gt;expert_activation_3_12_1</title>
<path fill="none" stroke="black" d="M4575.05,-844.87C4574.14,-836.89 4573.11,-827.93 4572.12,-819.38"/>
<polygon fill="black" stroke="black" points="4575.58,-818.78 4570.96,-809.25 4568.62,-819.58 4575.58,-818.78"/>
</g>
<!-- expert_linear2_3_12_1 -->
<g id="node493" class="node">
<title>expert_linear2_3_12_1</title>
<polygon fill="lightgreen" stroke="black" points="4643.5,-720 4470.5,-720 4470.5,-667 4643.5,-667 4643.5,-720"/>
<text text-anchor="middle" x="4557" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 17 Linear 2</text>
<text text-anchor="middle" x="4557" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4557" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_3_12_1&#45;&gt;expert_linear2_3_12_1 -->
<g id="edge592" class="edge">
<title>expert_activation_3_12_1&#45;&gt;expert_linear2_3_12_1</title>
<path fill="none" stroke="black" d="M4564.76,-755.87C4563.75,-747.89 4562.62,-738.93 4561.54,-730.38"/>
<polygon fill="black" stroke="black" points="4564.98,-729.73 4560.26,-720.25 4558.04,-730.61 4564.98,-729.73"/>
</g>
<!-- expert_linear2_3_12_1&#45;&gt;aggregate_3 -->
<g id="edge666" class="edge">
<title>expert_linear2_3_12_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4509.38,-666.89C4492.23,-657.66 4472.12,-646.84 4451.99,-636.01"/>
<polygon fill="black" stroke="black" points="4453.52,-632.87 4443.06,-631.21 4450.21,-639.03 4453.52,-632.87"/>
</g>
<!-- expert_linear1_3_12_2 -->
<g id="node495" class="node">
<title>expert_linear1_3_12_2</title>
<polygon fill="lightgreen" stroke="black" points="4916,-898 4734,-898 4734,-845 4916,-845 4916,-898"/>
<text text-anchor="middle" x="4825" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 18 Linear 1</text>
<text text-anchor="middle" x="4825" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4825" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_3_12_2&#45;&gt;expert_linear1_3_12_2 -->
<g id="edge594" class="edge">
<title>route_to_expert_3_12_2&#45;&gt;expert_linear1_3_12_2</title>
<path fill="none" stroke="black" d="M4854.63,-934.27C4850.41,-925.47 4845.9,-916.07 4841.71,-907.32"/>
<polygon fill="black" stroke="black" points="4844.79,-905.66 4837.31,-898.16 4838.48,-908.69 4844.79,-905.66"/>
</g>
<!-- expert_activation_3_12_2 -->
<g id="node496" class="node">
<title>expert_activation_3_12_2</title>
<polygon fill="lightgreen" stroke="black" points="4897,-809 4715,-809 4715,-756 4897,-756 4897,-809"/>
<text text-anchor="middle" x="4806" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 18 GELU</text>
<text text-anchor="middle" x="4806" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="4806" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_3_12_2&#45;&gt;expert_activation_3_12_2 -->
<g id="edge595" class="edge">
<title>expert_linear1_3_12_2&#45;&gt;expert_activation_3_12_2</title>
<path fill="none" stroke="black" d="M4819.4,-844.87C4817.64,-836.8 4815.66,-827.74 4813.78,-819.1"/>
<polygon fill="black" stroke="black" points="4817.18,-818.27 4811.62,-809.25 4810.34,-819.77 4817.18,-818.27"/>
</g>
<!-- expert_linear2_3_12_2 -->
<g id="node497" class="node">
<title>expert_linear2_3_12_2</title>
<polygon fill="lightgreen" stroke="black" points="4872.5,-720 4699.5,-720 4699.5,-667 4872.5,-667 4872.5,-720"/>
<text text-anchor="middle" x="4786" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 18 Linear 2</text>
<text text-anchor="middle" x="4786" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="4786" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_3_12_2&#45;&gt;expert_linear2_3_12_2 -->
<g id="edge596" class="edge">
<title>expert_activation_3_12_2&#45;&gt;expert_linear2_3_12_2</title>
<path fill="none" stroke="black" d="M4800.11,-755.87C4798.25,-747.8 4796.17,-738.74 4794.18,-730.1"/>
<polygon fill="black" stroke="black" points="4797.57,-729.21 4791.92,-720.25 4790.75,-730.78 4797.57,-729.21"/>
</g>
<!-- expert_linear2_3_12_2&#45;&gt;aggregate_3 -->
<g id="edge667" class="edge">
<title>expert_linear2_3_12_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4699.33,-670.14C4658.41,-659.59 4607.6,-646.48 4557.39,-633.53"/>
<polygon fill="black" stroke="black" points="4558.25,-630.14 4547.69,-631.03 4556.5,-636.91 4558.25,-630.14"/>
</g>
<!-- expert_linear1_3_12_3 -->
<g id="node499" class="node">
<title>expert_linear1_3_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5171,-898 4989,-898 4989,-845 5171,-845 5171,-898"/>
<text text-anchor="middle" x="5080" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 19 Linear 1</text>
<text text-anchor="middle" x="5080" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5080" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- route_to_expert_3_12_3&#45;&gt;expert_linear1_3_12_3 -->
<g id="edge598" class="edge">
<title>route_to_expert_3_12_3&#45;&gt;expert_linear1_3_12_3</title>
<path fill="none" stroke="black" d="M5114.68,-934.27C5109.68,-925.37 5104.34,-915.87 5099.39,-907.05"/>
<polygon fill="black" stroke="black" points="5102.35,-905.16 5094.4,-898.16 5096.25,-908.59 5102.35,-905.16"/>
</g>
<!-- expert_activation_3_12_3 -->
<g id="node500" class="node">
<title>expert_activation_3_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5161,-809 4979,-809 4979,-756 5161,-756 5161,-809"/>
<text text-anchor="middle" x="5070" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 19 GELU</text>
<text text-anchor="middle" x="5070" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5070" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_linear1_3_12_3&#45;&gt;expert_activation_3_12_3 -->
<g id="edge599" class="edge">
<title>expert_linear1_3_12_3&#45;&gt;expert_activation_3_12_3</title>
<path fill="none" stroke="black" d="M5077.05,-844.87C5076.14,-836.89 5075.11,-827.93 5074.12,-819.38"/>
<polygon fill="black" stroke="black" points="5077.58,-818.78 5072.96,-809.25 5070.62,-819.58 5077.58,-818.78"/>
</g>
<!-- expert_linear2_3_12_3 -->
<g id="node501" class="node">
<title>expert_linear2_3_12_3</title>
<polygon fill="lightgreen" stroke="black" points="5114.5,-720 4941.5,-720 4941.5,-667 5114.5,-667 5114.5,-720"/>
<text text-anchor="middle" x="5028" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 19 Linear 2</text>
<text text-anchor="middle" x="5028" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5028" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- expert_activation_3_12_3&#45;&gt;expert_linear2_3_12_3 -->
<g id="edge600" class="edge">
<title>expert_activation_3_12_3&#45;&gt;expert_linear2_3_12_3</title>
<path fill="none" stroke="black" d="M5057.63,-755.87C5053.6,-747.53 5049.07,-738.14 5044.78,-729.26"/>
<polygon fill="black" stroke="black" points="5047.93,-727.73 5040.43,-720.25 5041.63,-730.78 5047.93,-727.73"/>
</g>
<!-- expert_linear2_3_12_3&#45;&gt;aggregate_3 -->
<g id="edge668" class="edge">
<title>expert_linear2_3_12_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M4941.17,-677.19C4921.71,-673.79 4901.15,-670.24 4882,-667 4773.46,-648.61 4652.45,-628.7 4552.92,-612.47"/>
<polygon fill="black" stroke="black" points="4553.48,-609.01 4543.05,-610.86 4552.36,-615.92 4553.48,-609.01"/>
</g>
<!-- expert_linear1_3_13_0 -->
<g id="node503" class="node">
<title>expert_linear1_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5391,-898 5209,-898 5209,-845 5391,-845 5391,-898"/>
<text text-anchor="middle" x="5300" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 20 Linear 1</text>
<text text-anchor="middle" x="5300" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5300" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_3_13_0&#45;&gt;expert_linear1_3_13_0 -->
<g id="edge602" class="edge">
<title>route_to_expert_3_13_0&#45;&gt;expert_linear1_3_13_0</title>
<path fill="none" stroke="black" d="M5362.9,-935.38C5353.09,-925.58 5342.48,-914.97 5332.81,-905.31"/>
<polygon fill="black" stroke="black" points="5335.18,-902.73 5325.64,-898.13 5330.23,-907.68 5335.18,-902.73"/>
</g>
<!-- expert_activation_3_13_0 -->
<g id="node504" class="node">
<title>expert_activation_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5364,-809 5182,-809 5182,-756 5364,-756 5364,-809"/>
<text text-anchor="middle" x="5273" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 20 GELU</text>
<text text-anchor="middle" x="5273" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5273" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_3_13_0&#45;&gt;expert_activation_3_13_0 -->
<g id="edge603" class="edge">
<title>expert_linear1_3_13_0&#45;&gt;expert_activation_3_13_0</title>
<path fill="none" stroke="black" d="M5292.05,-844.87C5289.51,-836.71 5286.67,-827.54 5283.96,-818.82"/>
<polygon fill="black" stroke="black" points="5287.3,-817.76 5280.99,-809.25 5280.61,-819.84 5287.3,-817.76"/>
</g>
<!-- expert_linear2_3_13_0 -->
<g id="node505" class="node">
<title>expert_linear2_3_13_0</title>
<polygon fill="lightgreen" stroke="black" points="5337.5,-720 5164.5,-720 5164.5,-667 5337.5,-667 5337.5,-720"/>
<text text-anchor="middle" x="5251" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 20 Linear 2</text>
<text text-anchor="middle" x="5251" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5251" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_3_13_0&#45;&gt;expert_linear2_3_13_0 -->
<g id="edge604" class="edge">
<title>expert_activation_3_13_0&#45;&gt;expert_linear2_3_13_0</title>
<path fill="none" stroke="black" d="M5266.52,-755.87C5264.48,-747.8 5262.19,-738.74 5260,-730.1"/>
<polygon fill="black" stroke="black" points="5263.36,-729.09 5257.51,-720.25 5256.57,-730.8 5263.36,-729.09"/>
</g>
<!-- expert_linear2_3_13_0&#45;&gt;aggregate_3 -->
<g id="edge669" class="edge">
<title>expert_linear2_3_13_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M5164.42,-674.09C5150.92,-671.51 5137.11,-669.05 5124,-667 4926.23,-636.02 4698.54,-611.56 4540.8,-596.37"/>
<polygon fill="black" stroke="black" points="4540.8,-592.86 4530.51,-595.39 4540.13,-599.83 4540.8,-592.86"/>
</g>
<!-- expert_linear1_3_13_1 -->
<g id="node507" class="node">
<title>expert_linear1_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5618,-898 5436,-898 5436,-845 5618,-845 5618,-898"/>
<text text-anchor="middle" x="5527" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 21 Linear 1</text>
<text text-anchor="middle" x="5527" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5527" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_3_13_1&#45;&gt;expert_linear1_3_13_1 -->
<g id="edge606" class="edge">
<title>route_to_expert_3_13_1&#45;&gt;expert_linear1_3_13_1</title>
<path fill="none" stroke="black" d="M5614.88,-936.76C5600.46,-926.21 5584.59,-914.61 5570.36,-904.2"/>
<polygon fill="black" stroke="black" points="5572.33,-901.31 5562.19,-898.23 5568.2,-906.96 5572.33,-901.31"/>
</g>
<!-- expert_activation_3_13_1 -->
<g id="node508" class="node">
<title>expert_activation_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5605,-809 5423,-809 5423,-756 5605,-756 5605,-809"/>
<text text-anchor="middle" x="5514" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 21 GELU</text>
<text text-anchor="middle" x="5514" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5514" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_3_13_1&#45;&gt;expert_activation_3_13_1 -->
<g id="edge607" class="edge">
<title>expert_linear1_3_13_1&#45;&gt;expert_activation_3_13_1</title>
<path fill="none" stroke="black" d="M5523.17,-844.87C5521.98,-836.89 5520.64,-827.93 5519.36,-819.38"/>
<polygon fill="black" stroke="black" points="5522.79,-818.62 5517.85,-809.25 5515.86,-819.66 5522.79,-818.62"/>
</g>
<!-- expert_linear2_3_13_1 -->
<g id="node509" class="node">
<title>expert_linear2_3_13_1</title>
<polygon fill="lightgreen" stroke="black" points="5569.5,-720 5396.5,-720 5396.5,-667 5569.5,-667 5569.5,-720"/>
<text text-anchor="middle" x="5483" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 21 Linear 2</text>
<text text-anchor="middle" x="5483" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5483" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_3_13_1&#45;&gt;expert_linear2_3_13_1 -->
<g id="edge608" class="edge">
<title>expert_activation_3_13_1&#45;&gt;expert_linear2_3_13_1</title>
<path fill="none" stroke="black" d="M5504.87,-755.87C5501.96,-747.71 5498.69,-738.54 5495.59,-729.82"/>
<polygon fill="black" stroke="black" points="5498.83,-728.49 5492.18,-720.25 5492.23,-730.84 5498.83,-728.49"/>
</g>
<!-- expert_linear2_3_13_1&#45;&gt;aggregate_3 -->
<g id="edge670" class="edge">
<title>expert_linear2_3_13_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M5396.14,-674.91C5379.86,-671.98 5362.95,-669.19 5347,-667 5065.71,-628.36 4737.5,-603.28 4535.72,-590.14"/>
<polygon fill="black" stroke="black" points="4535.81,-586.64 4525.61,-589.49 4535.36,-593.63 4535.81,-586.64"/>
</g>
<!-- expert_linear1_3_13_2 -->
<g id="node511" class="node">
<title>expert_linear1_3_13_2</title>
<polygon fill="lightgreen" stroke="black" points="5832,-898 5650,-898 5650,-845 5832,-845 5832,-898"/>
<text text-anchor="middle" x="5741" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 22 Linear 1</text>
<text text-anchor="middle" x="5741" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5741" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_3_13_2&#45;&gt;expert_linear1_3_13_2 -->
<g id="edge610" class="edge">
<title>route_to_expert_3_13_2&#45;&gt;expert_linear1_3_13_2</title>
<path fill="none" stroke="black" d="M5864.59,-938.67C5843.13,-927.18 5818.97,-914.24 5797.74,-902.88"/>
<polygon fill="black" stroke="black" points="5799.31,-899.75 5788.84,-898.11 5796.01,-905.92 5799.31,-899.75"/>
</g>
<!-- expert_activation_3_13_2 -->
<g id="node512" class="node">
<title>expert_activation_3_13_2</title>
<polygon fill="lightgreen" stroke="black" points="5826,-809 5644,-809 5644,-756 5826,-756 5826,-809"/>
<text text-anchor="middle" x="5735" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 22 GELU</text>
<text text-anchor="middle" x="5735" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5735" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_3_13_2&#45;&gt;expert_activation_3_13_2 -->
<g id="edge611" class="edge">
<title>expert_linear1_3_13_2&#45;&gt;expert_activation_3_13_2</title>
<path fill="none" stroke="black" d="M5739.23,-844.87C5738.68,-836.89 5738.06,-827.93 5737.47,-819.38"/>
<polygon fill="black" stroke="black" points="5740.96,-818.99 5736.78,-809.25 5733.97,-819.47 5740.96,-818.99"/>
</g>
<!-- expert_linear2_3_13_2 -->
<g id="node513" class="node">
<title>expert_linear2_3_13_2</title>
<polygon fill="lightgreen" stroke="black" points="5795.5,-720 5622.5,-720 5622.5,-667 5795.5,-667 5795.5,-720"/>
<text text-anchor="middle" x="5709" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 22 Linear 2</text>
<text text-anchor="middle" x="5709" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5709" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_3_13_2&#45;&gt;expert_linear2_3_13_2 -->
<g id="edge612" class="edge">
<title>expert_activation_3_13_2&#45;&gt;expert_linear2_3_13_2</title>
<path fill="none" stroke="black" d="M5727.34,-755.87C5724.93,-747.8 5722.22,-738.74 5719.64,-730.1"/>
<polygon fill="black" stroke="black" points="5722.91,-728.83 5716.7,-720.25 5716.21,-730.83 5722.91,-728.83"/>
</g>
<!-- expert_linear2_3_13_2&#45;&gt;aggregate_3 -->
<g id="edge671" class="edge">
<title>expert_linear2_3_13_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M5622.18,-673.94C5607.81,-671.31 5593.02,-668.87 5579,-667 5209.51,-617.76 4773.8,-594.83 4531.83,-585.17"/>
<polygon fill="black" stroke="black" points="4531.65,-581.66 4521.52,-584.76 4531.37,-588.66 4531.65,-581.66"/>
</g>
<!-- expert_linear1_3_13_3 -->
<g id="node515" class="node">
<title>expert_linear1_3_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6039,-898 5857,-898 5857,-845 6039,-845 6039,-898"/>
<text text-anchor="middle" x="5948" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 23 Linear 1</text>
<text text-anchor="middle" x="5948" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5948" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- route_to_expert_3_13_3&#45;&gt;expert_linear1_3_13_3 -->
<g id="edge614" class="edge">
<title>route_to_expert_3_13_3&#45;&gt;expert_linear1_3_13_3</title>
<path fill="none" stroke="black" d="M6115.29,-941.08C6085.14,-928.72 6050.13,-914.37 6019.96,-902"/>
<polygon fill="black" stroke="black" points="6020.92,-898.61 6010.34,-898.06 6018.27,-905.09 6020.92,-898.61"/>
</g>
<!-- expert_activation_3_13_3 -->
<g id="node516" class="node">
<title>expert_activation_3_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6036,-809 5854,-809 5854,-756 6036,-756 6036,-809"/>
<text text-anchor="middle" x="5945" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 23 GELU</text>
<text text-anchor="middle" x="5945" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="5945" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_linear1_3_13_3&#45;&gt;expert_activation_3_13_3 -->
<g id="edge615" class="edge">
<title>expert_linear1_3_13_3&#45;&gt;expert_activation_3_13_3</title>
<path fill="none" stroke="black" d="M5947.12,-844.87C5946.84,-836.89 5946.53,-827.93 5946.24,-819.38"/>
<polygon fill="black" stroke="black" points="5949.73,-819.12 5945.89,-809.25 5942.73,-819.36 5949.73,-819.12"/>
</g>
<!-- expert_linear2_3_13_3 -->
<g id="node517" class="node">
<title>expert_linear2_3_13_3</title>
<polygon fill="lightgreen" stroke="black" points="6013.5,-720 5840.5,-720 5840.5,-667 6013.5,-667 6013.5,-720"/>
<text text-anchor="middle" x="5927" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 23 Linear 2</text>
<text text-anchor="middle" x="5927" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="5927" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- expert_activation_3_13_3&#45;&gt;expert_linear2_3_13_3 -->
<g id="edge616" class="edge">
<title>expert_activation_3_13_3&#45;&gt;expert_linear2_3_13_3</title>
<path fill="none" stroke="black" d="M5939.7,-755.87C5938.03,-747.8 5936.15,-738.74 5934.37,-730.1"/>
<polygon fill="black" stroke="black" points="5937.78,-729.33 5932.33,-720.25 5930.93,-730.75 5937.78,-729.33"/>
</g>
<!-- expert_linear2_3_13_3&#45;&gt;aggregate_3 -->
<g id="edge672" class="edge">
<title>expert_linear2_3_13_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M5840.3,-672.76C5828.48,-670.54 5816.47,-668.54 5805,-667 5348.64,-605.88 4806.25,-587.19 4529.04,-581.49"/>
<polygon fill="black" stroke="black" points="4528.95,-577.99 4518.88,-581.29 4528.81,-584.99 4528.95,-577.99"/>
</g>
<!-- expert_linear1_3_14_0 -->
<g id="node519" class="node">
<title>expert_linear1_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6242,-898 6060,-898 6060,-845 6242,-845 6242,-898"/>
<text text-anchor="middle" x="6151" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 24 Linear 1</text>
<text text-anchor="middle" x="6151" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6151" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_3_14_0&#45;&gt;expert_linear1_3_14_0 -->
<g id="edge618" class="edge">
<title>route_to_expert_3_14_0&#45;&gt;expert_linear1_3_14_0</title>
<path fill="none" stroke="black" d="M6367.9,-943.57C6327.81,-930.44 6279.54,-914.62 6238.72,-901.24"/>
<polygon fill="black" stroke="black" points="6239.65,-897.86 6229.05,-898.08 6237.47,-904.52 6239.65,-897.86"/>
</g>
<!-- expert_activation_3_14_0 -->
<g id="node520" class="node">
<title>expert_activation_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6241,-809 6059,-809 6059,-756 6241,-756 6241,-809"/>
<text text-anchor="middle" x="6150" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 24 GELU</text>
<text text-anchor="middle" x="6150" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6150" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_3_14_0&#45;&gt;expert_activation_3_14_0 -->
<g id="edge619" class="edge">
<title>expert_linear1_3_14_0&#45;&gt;expert_activation_3_14_0</title>
<path fill="none" stroke="black" d="M6150.71,-844.87C6150.61,-836.89 6150.51,-827.93 6150.41,-819.38"/>
<polygon fill="black" stroke="black" points="6153.91,-819.21 6150.3,-809.25 6146.91,-819.29 6153.91,-819.21"/>
</g>
<!-- expert_linear2_3_14_0 -->
<g id="node521" class="node">
<title>expert_linear2_3_14_0</title>
<polygon fill="lightgreen" stroke="black" points="6225.5,-720 6052.5,-720 6052.5,-667 6225.5,-667 6225.5,-720"/>
<text text-anchor="middle" x="6139" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 24 Linear 2</text>
<text text-anchor="middle" x="6139" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6139" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_3_14_0&#45;&gt;expert_linear2_3_14_0 -->
<g id="edge620" class="edge">
<title>expert_activation_3_14_0&#45;&gt;expert_linear2_3_14_0</title>
<path fill="none" stroke="black" d="M6146.76,-755.87C6145.75,-747.89 6144.62,-738.93 6143.54,-730.38"/>
<polygon fill="black" stroke="black" points="6146.98,-729.73 6142.26,-720.25 6140.04,-730.61 6146.98,-729.73"/>
</g>
<!-- expert_linear2_3_14_0&#45;&gt;aggregate_3 -->
<g id="edge673" class="edge">
<title>expert_linear2_3_14_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M6052.5,-671.86C6042.59,-669.98 6032.6,-668.3 6023,-667 5482.19,-593.87 4835.65,-580.64 4527.14,-578.81"/>
<polygon fill="black" stroke="black" points="4526.78,-575.3 4516.76,-578.75 4526.74,-582.3 4526.78,-575.3"/>
</g>
<!-- expert_linear1_3_14_1 -->
<g id="node523" class="node">
<title>expert_linear1_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6658,-898 6476,-898 6476,-845 6658,-845 6658,-898"/>
<text text-anchor="middle" x="6567" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 25 Linear 1</text>
<text text-anchor="middle" x="6567" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6567" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_3_14_1&#45;&gt;expert_linear1_3_14_1 -->
<g id="edge622" class="edge">
<title>route_to_expert_3_14_1&#45;&gt;expert_linear1_3_14_1</title>
<path fill="none" stroke="black" d="M6663.16,-937.03C6647.13,-926.27 6629.44,-914.4 6613.65,-903.8"/>
<polygon fill="black" stroke="black" points="6615.34,-900.73 6605.09,-898.06 6611.44,-906.54 6615.34,-900.73"/>
</g>
<!-- expert_activation_3_14_1 -->
<g id="node524" class="node">
<title>expert_activation_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6597,-809 6415,-809 6415,-756 6597,-756 6597,-809"/>
<text text-anchor="middle" x="6506" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 25 GELU</text>
<text text-anchor="middle" x="6506" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6506" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_3_14_1&#45;&gt;expert_activation_3_14_1 -->
<g id="edge623" class="edge">
<title>expert_linear1_3_14_1&#45;&gt;expert_activation_3_14_1</title>
<path fill="none" stroke="black" d="M6549.03,-844.87C6543.06,-836.36 6536.32,-826.75 6529.98,-817.7"/>
<polygon fill="black" stroke="black" points="6532.66,-815.43 6524.05,-809.25 6526.93,-819.45 6532.66,-815.43"/>
</g>
<!-- expert_linear2_3_14_1 -->
<g id="node525" class="node">
<title>expert_linear2_3_14_1</title>
<polygon fill="lightgreen" stroke="black" points="6539.5,-720 6366.5,-720 6366.5,-667 6539.5,-667 6539.5,-720"/>
<text text-anchor="middle" x="6453" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 25 Linear 2</text>
<text text-anchor="middle" x="6453" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6453" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_3_14_1&#45;&gt;expert_linear2_3_14_1 -->
<g id="edge624" class="edge">
<title>expert_activation_3_14_1&#45;&gt;expert_linear2_3_14_1</title>
<path fill="none" stroke="black" d="M6490.38,-755.87C6485.26,-747.45 6479.47,-737.95 6474,-728.98"/>
<polygon fill="black" stroke="black" points="6476.88,-726.97 6468.69,-720.25 6470.9,-730.61 6476.88,-726.97"/>
</g>
<!-- expert_linear2_3_14_1&#45;&gt;aggregate_3 -->
<g id="edge674" class="edge">
<title>expert_linear2_3_14_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M6366.41,-680.96C6326.47,-676 6278.39,-670.54 6235,-667 5611.01,-616.03 4868.46,-592.17 4530.24,-583.31"/>
<polygon fill="black" stroke="black" points="4530.19,-579.81 4520.1,-583.04 4530.01,-586.8 4530.19,-579.81"/>
</g>
<!-- expert_linear1_3_14_2 -->
<g id="node527" class="node">
<title>expert_linear1_3_14_2</title>
<polygon fill="lightgreen" stroke="black" points="6998,-898 6816,-898 6816,-845 6998,-845 6998,-898"/>
<text text-anchor="middle" x="6907" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 26 Linear 1</text>
<text text-anchor="middle" x="6907" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6907" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_3_14_2&#45;&gt;expert_linear1_3_14_2 -->
<g id="edge626" class="edge">
<title>route_to_expert_3_14_2&#45;&gt;expert_linear1_3_14_2</title>
<path fill="none" stroke="black" d="M6950.7,-934.55C6944.23,-925.36 6937.29,-915.51 6930.89,-906.43"/>
<polygon fill="black" stroke="black" points="6933.58,-904.16 6924.96,-898 6927.86,-908.19 6933.58,-904.16"/>
</g>
<!-- expert_activation_3_14_2 -->
<g id="node528" class="node">
<title>expert_activation_3_14_2</title>
<polygon fill="lightgreen" stroke="black" points="6930,-809 6748,-809 6748,-756 6930,-756 6930,-809"/>
<text text-anchor="middle" x="6839" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 26 GELU</text>
<text text-anchor="middle" x="6839" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="6839" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_3_14_2&#45;&gt;expert_activation_3_14_2 -->
<g id="edge627" class="edge">
<title>expert_linear1_3_14_2&#45;&gt;expert_activation_3_14_2</title>
<path fill="none" stroke="black" d="M6886.97,-844.87C6880.18,-836.18 6872.49,-826.35 6865.29,-817.14"/>
<polygon fill="black" stroke="black" points="6868.04,-814.97 6859.13,-809.25 6862.53,-819.28 6868.04,-814.97"/>
</g>
<!-- expert_linear2_3_14_2 -->
<g id="node529" class="node">
<title>expert_linear2_3_14_2</title>
<polygon fill="lightgreen" stroke="black" points="6866.5,-720 6693.5,-720 6693.5,-667 6866.5,-667 6866.5,-720"/>
<text text-anchor="middle" x="6780" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 26 Linear 2</text>
<text text-anchor="middle" x="6780" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="6780" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_3_14_2&#45;&gt;expert_linear2_3_14_2 -->
<g id="edge628" class="edge">
<title>expert_activation_3_14_2&#45;&gt;expert_linear2_3_14_2</title>
<path fill="none" stroke="black" d="M6821.62,-755.87C6815.85,-747.36 6809.33,-737.75 6803.19,-728.7"/>
<polygon fill="black" stroke="black" points="6805.97,-726.56 6797.46,-720.25 6800.18,-730.49 6805.97,-726.56"/>
</g>
<!-- expert_linear2_3_14_2&#45;&gt;aggregate_3 -->
<g id="edge675" class="edge">
<title>expert_linear2_3_14_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M6693.48,-681.5C6650.16,-676.36 6596.88,-670.59 6549,-667 5801.25,-610.86 4907.85,-589.11 4529.6,-581.99"/>
<polygon fill="black" stroke="black" points="4529.45,-578.49 4519.38,-581.8 4529.32,-585.49 4529.45,-578.49"/>
</g>
<!-- expert_linear1_3_14_3 -->
<g id="node531" class="node">
<title>expert_linear1_3_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7299,-898 7117,-898 7117,-845 7299,-845 7299,-898"/>
<text text-anchor="middle" x="7208" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 27 Linear 1</text>
<text text-anchor="middle" x="7208" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7208" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- route_to_expert_3_14_3&#45;&gt;expert_linear1_3_14_3 -->
<g id="edge630" class="edge">
<title>route_to_expert_3_14_3&#45;&gt;expert_linear1_3_14_3</title>
<path fill="none" stroke="black" d="M7227.46,-933.99C7224.73,-925.39 7221.84,-916.24 7219.13,-907.69"/>
<polygon fill="black" stroke="black" points="7222.43,-906.49 7216.07,-898.01 7215.75,-908.6 7222.43,-906.49"/>
</g>
<!-- expert_activation_3_14_3 -->
<g id="node532" class="node">
<title>expert_activation_3_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7249,-809 7067,-809 7067,-756 7249,-756 7249,-809"/>
<text text-anchor="middle" x="7158" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 27 GELU</text>
<text text-anchor="middle" x="7158" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7158" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_linear1_3_14_3&#45;&gt;expert_activation_3_14_3 -->
<g id="edge631" class="edge">
<title>expert_linear1_3_14_3&#45;&gt;expert_activation_3_14_3</title>
<path fill="none" stroke="black" d="M7193.27,-844.87C7188.43,-836.45 7182.97,-826.95 7177.82,-817.98"/>
<polygon fill="black" stroke="black" points="7180.82,-816.18 7172.8,-809.25 7174.75,-819.66 7180.82,-816.18"/>
</g>
<!-- expert_linear2_3_14_3 -->
<g id="node533" class="node">
<title>expert_linear2_3_14_3</title>
<polygon fill="lightgreen" stroke="black" points="7180.5,-720 7007.5,-720 7007.5,-667 7180.5,-667 7180.5,-720"/>
<text text-anchor="middle" x="7094" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 27 Linear 2</text>
<text text-anchor="middle" x="7094" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7094" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- expert_activation_3_14_3&#45;&gt;expert_linear2_3_14_3 -->
<g id="edge632" class="edge">
<title>expert_activation_3_14_3&#45;&gt;expert_linear2_3_14_3</title>
<path fill="none" stroke="black" d="M7139.14,-755.87C7132.82,-747.27 7125.67,-737.55 7118.95,-728.42"/>
<polygon fill="black" stroke="black" points="7121.69,-726.23 7112.94,-720.25 7116.05,-730.38 7121.69,-726.23"/>
</g>
<!-- expert_linear2_3_14_3&#45;&gt;aggregate_3 -->
<g id="edge676" class="edge">
<title>expert_linear2_3_14_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M7007.43,-680.73C6967.49,-675.72 6919.41,-670.29 6876,-667 5997.87,-600.48 4944.43,-584.18 4528.07,-580.24"/>
<polygon fill="black" stroke="black" points="4528.09,-576.74 4518.06,-580.14 4528.02,-583.74 4528.09,-576.74"/>
</g>
<!-- expert_linear1_3_15_0 -->
<g id="node535" class="node">
<title>expert_linear1_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7511,-898 7329,-898 7329,-845 7511,-845 7511,-898"/>
<text text-anchor="middle" x="7420" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 28 Linear 1</text>
<text text-anchor="middle" x="7420" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7420" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_3_15_0&#45;&gt;expert_linear1_3_15_0 -->
<g id="edge634" class="edge">
<title>route_to_expert_3_15_0&#45;&gt;expert_linear1_3_15_0</title>
<path fill="none" stroke="black" d="M7472.4,-935.1C7464.52,-925.69 7456.03,-915.55 7448.23,-906.23"/>
<polygon fill="black" stroke="black" points="7450.69,-903.71 7441.58,-898.29 7445.32,-908.21 7450.69,-903.71"/>
</g>
<!-- expert_activation_3_15_0 -->
<g id="node536" class="node">
<title>expert_activation_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7510,-809 7328,-809 7328,-756 7510,-756 7510,-809"/>
<text text-anchor="middle" x="7419" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 28 GELU</text>
<text text-anchor="middle" x="7419" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7419" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_3_15_0&#45;&gt;expert_activation_3_15_0 -->
<g id="edge635" class="edge">
<title>expert_linear1_3_15_0&#45;&gt;expert_activation_3_15_0</title>
<path fill="none" stroke="black" d="M7419.71,-844.87C7419.61,-836.89 7419.51,-827.93 7419.41,-819.38"/>
<polygon fill="black" stroke="black" points="7422.91,-819.21 7419.3,-809.25 7415.91,-819.29 7422.91,-819.21"/>
</g>
<!-- expert_linear2_3_15_0 -->
<g id="node537" class="node">
<title>expert_linear2_3_15_0</title>
<polygon fill="lightgreen" stroke="black" points="7438.5,-720 7265.5,-720 7265.5,-667 7438.5,-667 7438.5,-720"/>
<text text-anchor="middle" x="7352" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 28 Linear 2</text>
<text text-anchor="middle" x="7352" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7352" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_3_15_0&#45;&gt;expert_linear2_3_15_0 -->
<g id="edge636" class="edge">
<title>expert_activation_3_15_0&#45;&gt;expert_linear2_3_15_0</title>
<path fill="none" stroke="black" d="M7399.26,-755.87C7392.64,-747.27 7385.15,-737.55 7378.12,-728.42"/>
<polygon fill="black" stroke="black" points="7380.7,-726.04 7371.83,-720.25 7375.16,-730.31 7380.7,-726.04"/>
</g>
<!-- expert_linear2_3_15_0&#45;&gt;aggregate_3 -->
<g id="edge677" class="edge">
<title>expert_linear2_3_15_0&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M7265.24,-676.79C7240.97,-672.96 7214.52,-669.3 7190,-667 6670.75,-618.29 5073.26,-590.07 4529.47,-581.67"/>
<polygon fill="black" stroke="black" points="4529.23,-578.17 4519.18,-581.51 4529.12,-585.17 4529.23,-578.17"/>
</g>
<!-- expert_linear1_3_15_1 -->
<g id="node539" class="node">
<title>expert_linear1_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="7784,-898 7602,-898 7602,-845 7784,-845 7784,-898"/>
<text text-anchor="middle" x="7693" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 29 Linear 1</text>
<text text-anchor="middle" x="7693" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7693" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_3_15_1&#45;&gt;expert_linear1_3_15_1 -->
<g id="edge638" class="edge">
<title>route_to_expert_3_15_1&#45;&gt;expert_linear1_3_15_1</title>
<path fill="none" stroke="black" d="M7738.8,-934.83C7731.97,-925.53 7724.62,-915.53 7717.86,-906.33"/>
<polygon fill="black" stroke="black" points="7720.59,-904.13 7711.85,-898.15 7714.95,-908.28 7720.59,-904.13"/>
</g>
<!-- expert_activation_3_15_1 -->
<g id="node540" class="node">
<title>expert_activation_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="7757,-809 7575,-809 7575,-756 7757,-756 7757,-809"/>
<text text-anchor="middle" x="7666" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 29 GELU</text>
<text text-anchor="middle" x="7666" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7666" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_3_15_1&#45;&gt;expert_activation_3_15_1 -->
<g id="edge639" class="edge">
<title>expert_linear1_3_15_1&#45;&gt;expert_activation_3_15_1</title>
<path fill="none" stroke="black" d="M7685.05,-844.87C7682.51,-836.71 7679.67,-827.54 7676.96,-818.82"/>
<polygon fill="black" stroke="black" points="7680.3,-817.76 7673.99,-809.25 7673.61,-819.84 7680.3,-817.76"/>
</g>
<!-- expert_linear2_3_15_1 -->
<g id="node541" class="node">
<title>expert_linear2_3_15_1</title>
<polygon fill="lightgreen" stroke="black" points="7704.5,-720 7531.5,-720 7531.5,-667 7704.5,-667 7704.5,-720"/>
<text text-anchor="middle" x="7618" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 29 Linear 2</text>
<text text-anchor="middle" x="7618" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7618" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_3_15_1&#45;&gt;expert_linear2_3_15_1 -->
<g id="edge640" class="edge">
<title>expert_activation_3_15_1&#45;&gt;expert_linear2_3_15_1</title>
<path fill="none" stroke="black" d="M7651.86,-755.87C7647.26,-747.53 7642.08,-738.14 7637.18,-729.26"/>
<polygon fill="black" stroke="black" points="7640.1,-727.31 7632.21,-720.25 7633.97,-730.7 7640.1,-727.31"/>
</g>
<!-- expert_linear2_3_15_1&#45;&gt;aggregate_3 -->
<g id="edge678" class="edge">
<title>expert_linear2_3_15_1&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M7531.32,-677.44C7504.67,-673.36 7475.2,-669.42 7448,-667 6875.82,-616.16 5104.52,-588.96 4528.81,-581.29"/>
<polygon fill="black" stroke="black" points="4528.8,-577.79 4518.75,-581.16 4528.7,-584.79 4528.8,-577.79"/>
</g>
<!-- expert_linear1_3_15_2 -->
<g id="node543" class="node">
<title>expert_linear1_3_15_2</title>
<polygon fill="lightgreen" stroke="black" points="8019,-898 7837,-898 7837,-845 8019,-845 8019,-898"/>
<text text-anchor="middle" x="7928" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 30 Linear 1</text>
<text text-anchor="middle" x="7928" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7928" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_3_15_2&#45;&gt;expert_linear1_3_15_2 -->
<g id="edge642" class="edge">
<title>route_to_expert_3_15_2&#45;&gt;expert_linear1_3_15_2</title>
<path fill="none" stroke="black" d="M7992.18,-935.38C7982.18,-925.58 7971.35,-914.97 7961.48,-905.31"/>
<polygon fill="black" stroke="black" points="7963.75,-902.63 7954.16,-898.13 7958.85,-907.63 7963.75,-902.63"/>
</g>
<!-- expert_activation_3_15_2 -->
<g id="node544" class="node">
<title>expert_activation_3_15_2</title>
<polygon fill="lightgreen" stroke="black" points="7982,-809 7800,-809 7800,-756 7982,-756 7982,-809"/>
<text text-anchor="middle" x="7891" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 30 GELU</text>
<text text-anchor="middle" x="7891" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="7891" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_3_15_2&#45;&gt;expert_activation_3_15_2 -->
<g id="edge643" class="edge">
<title>expert_linear1_3_15_2&#45;&gt;expert_activation_3_15_2</title>
<path fill="none" stroke="black" d="M7917.1,-844.87C7913.59,-836.62 7909.64,-827.34 7905.9,-818.54"/>
<polygon fill="black" stroke="black" points="7909.09,-817.08 7901.95,-809.25 7902.64,-819.82 7909.09,-817.08"/>
</g>
<!-- expert_linear2_3_15_2 -->
<g id="node545" class="node">
<title>expert_linear2_3_15_2</title>
<polygon fill="lightgreen" stroke="black" points="7949.5,-720 7776.5,-720 7776.5,-667 7949.5,-667 7949.5,-720"/>
<text text-anchor="middle" x="7863" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 30 Linear 2</text>
<text text-anchor="middle" x="7863" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="7863" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_3_15_2&#45;&gt;expert_linear2_3_15_2 -->
<g id="edge644" class="edge">
<title>expert_activation_3_15_2&#45;&gt;expert_linear2_3_15_2</title>
<path fill="none" stroke="black" d="M7882.75,-755.87C7880.13,-747.71 7877.17,-738.54 7874.37,-729.82"/>
<polygon fill="black" stroke="black" points="7877.68,-728.7 7871.29,-720.25 7871.02,-730.84 7877.68,-728.7"/>
</g>
<!-- expert_linear2_3_15_2&#45;&gt;aggregate_3 -->
<g id="edge679" class="edge">
<title>expert_linear2_3_15_2&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M7776.22,-675.49C7755.88,-672.11 7734.24,-668.99 7714,-667 7087.75,-605.55 5135.07,-585.23 4527.99,-580.31"/>
<polygon fill="black" stroke="black" points="4527.86,-576.81 4517.83,-580.23 4527.8,-583.81 4527.86,-576.81"/>
</g>
<!-- expert_linear1_3_15_3 -->
<g id="node547" class="node">
<title>expert_linear1_3_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8283,-898 8101,-898 8101,-845 8283,-845 8283,-898"/>
<text text-anchor="middle" x="8192" y="-882.8" font-family="Times,serif" font-size="14.00">Expert 31 Linear 1</text>
<text text-anchor="middle" x="8192" y="-867.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8192" y="-852.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- route_to_expert_3_15_3&#45;&gt;expert_linear1_3_15_3 -->
<g id="edge646" class="edge">
<title>route_to_expert_3_15_3&#45;&gt;expert_linear1_3_15_3</title>
<path fill="none" stroke="black" d="M8255.54,-935.38C8245.63,-925.58 8234.91,-914.97 8225.15,-905.31"/>
<polygon fill="black" stroke="black" points="8227.47,-902.68 8217.9,-898.13 8222.54,-907.65 8227.47,-902.68"/>
</g>
<!-- expert_activation_3_15_3 -->
<g id="node548" class="node">
<title>expert_activation_3_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8231,-809 8049,-809 8049,-756 8231,-756 8231,-809"/>
<text text-anchor="middle" x="8140" y="-793.8" font-family="Times,serif" font-size="14.00">Expert 31 GELU</text>
<text text-anchor="middle" x="8140" y="-778.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 32768)</text>
<text text-anchor="middle" x="8140" y="-763.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_linear1_3_15_3&#45;&gt;expert_activation_3_15_3 -->
<g id="edge647" class="edge">
<title>expert_linear1_3_15_3&#45;&gt;expert_activation_3_15_3</title>
<path fill="none" stroke="black" d="M8176.68,-844.87C8171.65,-836.45 8165.97,-826.95 8160.61,-817.98"/>
<polygon fill="black" stroke="black" points="8163.53,-816.04 8155.39,-809.25 8157.52,-819.63 8163.53,-816.04"/>
</g>
<!-- expert_linear2_3_15_3 -->
<g id="node549" class="node">
<title>expert_linear2_3_15_3</title>
<polygon fill="lightgreen" stroke="black" points="8196.5,-720 8023.5,-720 8023.5,-667 8196.5,-667 8196.5,-720"/>
<text text-anchor="middle" x="8110" y="-704.8" font-family="Times,serif" font-size="14.00">Expert 31 Linear 2</text>
<text text-anchor="middle" x="8110" y="-689.8" font-family="Times,serif" font-size="14.00">Shape: (tokens, 8192)</text>
<text text-anchor="middle" x="8110" y="-674.8" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- expert_activation_3_15_3&#45;&gt;expert_linear2_3_15_3 -->
<g id="edge648" class="edge">
<title>expert_activation_3_15_3&#45;&gt;expert_linear2_3_15_3</title>
<path fill="none" stroke="black" d="M8131.16,-755.87C8128.35,-747.71 8125.19,-738.54 8122.18,-729.82"/>
<polygon fill="black" stroke="black" points="8125.45,-728.56 8118.88,-720.25 8118.83,-730.84 8125.45,-728.56"/>
</g>
<!-- expert_linear2_3_15_3&#45;&gt;aggregate_3 -->
<g id="edge680" class="edge">
<title>expert_linear2_3_15_3&#45;&gt;aggregate_3</title>
<path fill="none" stroke="black" d="M8023.25,-675.67C8002.29,-672.21 7979.91,-669.01 7959,-667 7282.37,-601.96 5162.9,-583.98 4527.69,-579.99"/>
<polygon fill="black" stroke="black" points="4527.55,-576.49 4517.53,-579.92 4527.5,-583.49 4527.55,-576.49"/>
</g>
<!-- aggregate_3&#45;&gt;moe_residual_3 -->
<g id="edge682" class="edge">
<title>aggregate_3&#45;&gt;moe_residual_3</title>
<path fill="none" stroke="black" d="M4505.99,-565.51C4875.78,-538.96 5785.57,-473.65 6145.71,-447.79"/>
<polygon fill="black" stroke="black" points="6146.22,-451.26 6155.94,-447.06 6145.72,-444.28 6146.22,-451.26"/>
</g>
<!-- ln2_3 -->
<g id="node552" class="node">
<title>ln2_3</title>
<polygon fill="lightgreen" stroke="black" points="6385.5,-347 6206.5,-347 6206.5,-294 6385.5,-294 6385.5,-347"/>
<text text-anchor="middle" x="6296" y="-331.8" font-family="Times,serif" font-size="14.00">Layer Norm 2</text>
<text text-anchor="middle" x="6296" y="-316.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6296" y="-301.8" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- moe_residual_3&#45;&gt;ln2_3 -->
<g id="edge683" class="edge">
<title>moe_residual_3&#45;&gt;ln2_3</title>
<path fill="none" stroke="black" d="M6296,-382.9C6296,-374.23 6296,-365.41 6296,-357.27"/>
<polygon fill="black" stroke="black" points="6299.5,-357.01 6296,-347.01 6292.5,-357.01 6299.5,-357.01"/>
</g>
<!-- final_norm -->
<g id="node553" class="node">
<title>final_norm</title>
<polygon fill="lightgreen" stroke="black" points="6385.5,-247 6206.5,-247 6206.5,-194 6385.5,-194 6385.5,-247"/>
<text text-anchor="middle" x="6296" y="-231.8" font-family="Times,serif" font-size="14.00">Final Layer Norm</text>
<text text-anchor="middle" x="6296" y="-216.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, 8192)</text>
<text text-anchor="middle" x="6296" y="-201.8" font-family="Times,serif" font-size="14.00">GPU: Stage 1</text>
</g>
<!-- ln2_3&#45;&gt;final_norm -->
<g id="edge684" class="edge">
<title>ln2_3&#45;&gt;final_norm</title>
<path fill="none" stroke="black" d="M6296,-293.75C6296,-282.61 6296,-269.38 6296,-257.31"/>
<polygon fill="black" stroke="black" points="6299.5,-257.08 6296,-247.08 6292.5,-257.08 6299.5,-257.08"/>
</g>
<!-- output_linear -->
<g id="node554" class="node">
<title>output_linear</title>
<polygon fill="lightgreen" stroke="black" points="6405.5,-158 6186.5,-158 6186.5,-105 6405.5,-105 6405.5,-158"/>
<text text-anchor="middle" x="6296" y="-142.8" font-family="Times,serif" font-size="14.00">Output Linear</text>
<text text-anchor="middle" x="6296" y="-127.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, vocab_size)</text>
<text text-anchor="middle" x="6296" y="-112.8" font-family="Times,serif" font-size="14.00">GPU: Stage 1</text>
</g>
<!-- final_norm&#45;&gt;output_linear -->
<g id="edge685" class="edge">
<title>final_norm&#45;&gt;output_linear</title>
<path fill="none" stroke="black" d="M6296,-193.87C6296,-185.89 6296,-176.93 6296,-168.38"/>
<polygon fill="black" stroke="black" points="6299.5,-168.25 6296,-158.25 6292.5,-168.25 6299.5,-168.25"/>
</g>
<!-- softmax -->
<g id="node555" class="node">
<title>softmax</title>
<polygon fill="lightgreen" stroke="black" points="6405.5,-69 6186.5,-69 6186.5,-16 6405.5,-16 6405.5,-69"/>
<text text-anchor="middle" x="6296" y="-53.8" font-family="Times,serif" font-size="14.00">Softmax</text>
<text text-anchor="middle" x="6296" y="-38.8" font-family="Times,serif" font-size="14.00">Shape: (1024, 1, vocab_size)</text>
<text text-anchor="middle" x="6296" y="-23.8" font-family="Times,serif" font-size="14.00">GPU: Stage 1</text>
</g>
<!-- output_linear&#45;&gt;softmax -->
<g id="edge686" class="edge">
<title>output_linear&#45;&gt;softmax</title>
<path fill="none" stroke="black" d="M6296,-104.87C6296,-96.89 6296,-87.93 6296,-79.38"/>
<polygon fill="black" stroke="black" points="6299.5,-79.25 6296,-69.25 6292.5,-79.25 6299.5,-79.25"/>
</g>
</g>
</svg>
