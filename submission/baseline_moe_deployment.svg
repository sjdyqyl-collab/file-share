<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="1076pt"
 viewBox="0.00 0.00 1440.00 1075.73" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.37 0.37) rotate(0) translate(4 2869.85)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2869.85 3843,-2869.85 3843,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<path fill="none" stroke="black" d="M1743,-2776.43C1743,-2776.43 1927,-2776.43 1927,-2776.43 1933,-2776.43 1939,-2782.43 1939,-2788.43 1939,-2788.43 1939,-2845.85 1939,-2845.85 1939,-2851.85 1933,-2857.85 1927,-2857.85 1927,-2857.85 1743,-2857.85 1743,-2857.85 1737,-2857.85 1731,-2851.85 1731,-2845.85 1731,-2845.85 1731,-2788.43 1731,-2788.43 1731,-2782.43 1737,-2776.43 1743,-2776.43"/>
<text text-anchor="middle" x="1835" y="-2842.65" font-family="Times,serif" font-size="14.00">Input (Batch: 1024 tokens)</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_pipeline0</title>
<path fill="none" stroke="blue" d="M23,-1873.43C23,-1873.43 3819,-1873.43 3819,-1873.43 3825,-1873.43 3831,-1879.43 3831,-1885.43 3831,-1885.43 3831,-2745.43 3831,-2745.43 3831,-2751.43 3825,-2757.43 3819,-2757.43 3819,-2757.43 23,-2757.43 23,-2757.43 17,-2757.43 11,-2751.43 11,-2745.43 11,-2745.43 11,-1885.43 11,-1885.43 11,-1879.43 17,-1873.43 23,-1873.43"/>
<text text-anchor="middle" x="1921" y="-2742.23" font-family="Times,serif" font-size="14.00">Pipeline Stage 0 (Layers 0&#45;1)</text>
<text text-anchor="middle" x="1921" y="-2727.23" font-family="Times,serif" font-size="14.00">GPUs 0&#45;7</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_layer0</title>
<path fill="none" stroke="blue" d="M31,-1881.43C31,-1881.43 3811,-1881.43 3811,-1881.43 3817,-1881.43 3823,-1887.43 3823,-1893.43 3823,-1893.43 3823,-2699.43 3823,-2699.43 3823,-2705.43 3817,-2711.43 3811,-2711.43 3811,-2711.43 31,-2711.43 31,-2711.43 25,-2711.43 19,-2705.43 19,-2699.43 19,-2699.43 19,-1893.43 19,-1893.43 19,-1887.43 25,-1881.43 31,-1881.43"/>
<text text-anchor="middle" x="1921" y="-2696.23" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_gpu0</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="27,-2000.43 27,-2337.43 492,-2337.43 492,-2000.43 27,-2000.43"/>
<text text-anchor="middle" x="259.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 0</text>
</g>
<g id="clust5" class="cluster">
<title>cluster_gpu1</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="500,-2000.43 500,-2337.43 965,-2337.43 965,-2000.43 500,-2000.43"/>
<text text-anchor="middle" x="732.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 1</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_gpu2</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="973,-2000.43 973,-2337.43 1438,-2337.43 1438,-2000.43 973,-2000.43"/>
<text text-anchor="middle" x="1205.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 2</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_gpu3</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="1446,-2000.43 1446,-2337.43 1911,-2337.43 1911,-2000.43 1446,-2000.43"/>
<text text-anchor="middle" x="1678.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 3</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_gpu4</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="1919,-2000.43 1919,-2337.43 2384,-2337.43 2384,-2000.43 1919,-2000.43"/>
<text text-anchor="middle" x="2151.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 4</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_gpu5</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="2392,-2000.43 2392,-2337.43 2857,-2337.43 2857,-2000.43 2392,-2000.43"/>
<text text-anchor="middle" x="2624.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 5</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_gpu6</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="2865,-2000.43 2865,-2337.43 3330,-2337.43 3330,-2000.43 2865,-2000.43"/>
<text text-anchor="middle" x="3097.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 6</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_gpu7</title>
<polygon fill="none" stroke="blue" stroke-dasharray="5,2" points="3338,-2000.43 3338,-2337.43 3803,-2337.43 3803,-2000.43 3338,-2000.43"/>
<text text-anchor="middle" x="3570.5" y="-2322.23" font-family="Times,serif" font-size="14.00">GPU 7</text>
</g>
<g id="clust12" class="cluster">
<title>cluster_pipeline1</title>
<path fill="none" stroke="red" d="M20,-106.43C20,-106.43 3816,-106.43 3816,-106.43 3822,-106.43 3828,-112.43 3828,-118.43 3828,-118.43 3828,-1827.43 3828,-1827.43 3828,-1833.43 3822,-1839.43 3816,-1839.43 3816,-1839.43 20,-1839.43 20,-1839.43 14,-1839.43 8,-1833.43 8,-1827.43 8,-1827.43 8,-118.43 8,-118.43 8,-112.43 14,-106.43 20,-106.43"/>
<text text-anchor="middle" x="1918" y="-1824.23" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (Layers 2&#45;3)</text>
<text text-anchor="middle" x="1918" y="-1809.23" font-family="Times,serif" font-size="14.00">GPUs 8&#45;15</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_layer2</title>
<path fill="none" stroke="red" d="M28,-963.43C28,-963.43 3808,-963.43 3808,-963.43 3814,-963.43 3820,-969.43 3820,-975.43 3820,-975.43 3820,-1781.43 3820,-1781.43 3820,-1787.43 3814,-1793.43 3808,-1793.43 3808,-1793.43 28,-1793.43 28,-1793.43 22,-1793.43 16,-1787.43 16,-1781.43 16,-1781.43 16,-975.43 16,-975.43 16,-969.43 22,-963.43 28,-963.43"/>
<text text-anchor="middle" x="1918" y="-1778.23" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust14" class="cluster">
<title>cluster_gpu16</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="24,-1082.43 24,-1419.43 489,-1419.43 489,-1082.43 24,-1082.43"/>
<text text-anchor="middle" x="256.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 16</text>
</g>
<g id="clust15" class="cluster">
<title>cluster_gpu17</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="497,-1082.43 497,-1419.43 962,-1419.43 962,-1082.43 497,-1082.43"/>
<text text-anchor="middle" x="729.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 17</text>
</g>
<g id="clust16" class="cluster">
<title>cluster_gpu18</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="970,-1082.43 970,-1419.43 1435,-1419.43 1435,-1082.43 970,-1082.43"/>
<text text-anchor="middle" x="1202.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 18</text>
</g>
<g id="clust17" class="cluster">
<title>cluster_gpu19</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1443,-1082.43 1443,-1419.43 1908,-1419.43 1908,-1082.43 1443,-1082.43"/>
<text text-anchor="middle" x="1675.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 19</text>
</g>
<g id="clust18" class="cluster">
<title>cluster_gpu20</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1916,-1082.43 1916,-1419.43 2381,-1419.43 2381,-1082.43 1916,-1082.43"/>
<text text-anchor="middle" x="2148.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 20</text>
</g>
<g id="clust19" class="cluster">
<title>cluster_gpu21</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="2389,-1082.43 2389,-1419.43 2854,-1419.43 2854,-1082.43 2389,-1082.43"/>
<text text-anchor="middle" x="2621.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 21</text>
</g>
<g id="clust20" class="cluster">
<title>cluster_gpu22</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="2862,-1082.43 2862,-1419.43 3327,-1419.43 3327,-1082.43 2862,-1082.43"/>
<text text-anchor="middle" x="3094.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 22</text>
</g>
<g id="clust21" class="cluster">
<title>cluster_gpu23</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="3335,-1082.43 3335,-1419.43 3800,-1419.43 3800,-1082.43 3335,-1082.43"/>
<text text-anchor="middle" x="3567.5" y="-1404.23" font-family="Times,serif" font-size="14.00">GPU 23</text>
</g>
<g id="clust22" class="cluster">
<title>cluster_layer3</title>
<path fill="none" stroke="red" d="M28,-114.43C28,-114.43 3808,-114.43 3808,-114.43 3814,-114.43 3820,-120.43 3820,-126.43 3820,-126.43 3820,-932.43 3820,-932.43 3820,-938.43 3814,-944.43 3808,-944.43 3808,-944.43 28,-944.43 28,-944.43 22,-944.43 16,-938.43 16,-932.43 16,-932.43 16,-126.43 16,-126.43 16,-120.43 22,-114.43 28,-114.43"/>
<text text-anchor="middle" x="1918" y="-929.23" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust23" class="cluster">
<title>cluster_gpu24</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="24,-233.43 24,-570.43 489,-570.43 489,-233.43 24,-233.43"/>
<text text-anchor="middle" x="256.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 24</text>
</g>
<g id="clust24" class="cluster">
<title>cluster_gpu25</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="497,-233.43 497,-570.43 962,-570.43 962,-233.43 497,-233.43"/>
<text text-anchor="middle" x="729.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 25</text>
</g>
<g id="clust25" class="cluster">
<title>cluster_gpu26</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="970,-233.43 970,-570.43 1435,-570.43 1435,-233.43 970,-233.43"/>
<text text-anchor="middle" x="1202.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 26</text>
</g>
<g id="clust26" class="cluster">
<title>cluster_gpu27</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1443,-233.43 1443,-570.43 1908,-570.43 1908,-233.43 1443,-233.43"/>
<text text-anchor="middle" x="1675.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 27</text>
</g>
<g id="clust27" class="cluster">
<title>cluster_gpu28</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="1916,-233.43 1916,-570.43 2381,-570.43 2381,-233.43 1916,-233.43"/>
<text text-anchor="middle" x="2148.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 28</text>
</g>
<g id="clust28" class="cluster">
<title>cluster_gpu29</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="2389,-233.43 2389,-570.43 2854,-570.43 2854,-233.43 2389,-233.43"/>
<text text-anchor="middle" x="2621.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 29</text>
</g>
<g id="clust29" class="cluster">
<title>cluster_gpu30</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="2862,-233.43 2862,-570.43 3327,-570.43 3327,-233.43 2862,-233.43"/>
<text text-anchor="middle" x="3094.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 30</text>
</g>
<g id="clust30" class="cluster">
<title>cluster_gpu31</title>
<polygon fill="none" stroke="red" stroke-dasharray="5,2" points="3335,-233.43 3335,-570.43 3800,-570.43 3800,-233.43 3335,-233.43"/>
<text text-anchor="middle" x="3567.5" y="-555.23" font-family="Times,serif" font-size="14.00">GPU 31</text>
</g>
<g id="clust31" class="cluster">
<title>cluster_output</title>
<path fill="none" stroke="black" d="M2095,-8C2095,-8 2201,-8 2201,-8 2207,-8 2213,-14 2213,-20 2213,-20 2213,-77.43 2213,-77.43 2213,-83.43 2207,-89.43 2201,-89.43 2201,-89.43 2095,-89.43 2095,-89.43 2089,-89.43 2083,-83.43 2083,-77.43 2083,-77.43 2083,-20 2083,-20 2083,-14 2089,-8 2095,-8"/>
<text text-anchor="middle" x="2148" y="-74.23" font-family="Times,serif" font-size="14.00">Output</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<ellipse fill="none" stroke="black" cx="1835" cy="-2805.64" rx="50.82" ry="21.43"/>
<text text-anchor="middle" x="1835" y="-2808.64" font-family="Arial" font-size="10.00">Input Tokens</text>
<text text-anchor="middle" x="1835" y="-2797.64" font-family="Arial" font-size="10.00">[1024, 8192]</text>
</g>
<!-- l0_mha_qkv -->
<g id="node2" class="node">
<title>l0_mha_qkv</title>
<polygon fill="none" stroke="black" points="1840.5,-2680.43 1677.5,-2680.43 1677.5,-2639.43 1840.5,-2639.43 1840.5,-2680.43"/>
<text text-anchor="middle" x="1759" y="-2668.43" font-family="Arial" font-size="10.00">MHA QKV Linear</text>
<text text-anchor="middle" x="1759" y="-2657.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="1759" y="-2646.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;l0_mha_qkv -->
<g id="edge1" class="edge">
<title>input&#45;&gt;l0_mha_qkv</title>
<path fill="none" stroke="black" d="M1824.43,-2784.66C1811.39,-2759.99 1789.11,-2717.86 1774.22,-2689.7"/>
<polygon fill="black" stroke="black" points="1777.25,-2687.94 1769.48,-2680.74 1771.06,-2691.22 1777.25,-2687.94"/>
</g>
<!-- l0_mha_res -->
<g id="node5" class="node">
<title>l0_mha_res</title>
<polygon fill="none" stroke="black" points="1982.07,-2446.43 1756.07,-2446.43 1697.93,-2364.43 1923.93,-2364.43 1982.07,-2446.43"/>
<text text-anchor="middle" x="1840" y="-2413.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="1840" y="-2402.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="1840" y="-2391.93" font-family="Arial" font-size="10.00">All GPUs 0&#45;7</text>
</g>
<!-- input&#45;&gt;l0_mha_res -->
<g id="edge5" class="edge">
<title>input&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M1842.89,-2784.53C1852.93,-2757.06 1869,-2706.05 1869,-2660.93 1869,-2660.93 1869,-2660.93 1869,-2502.93 1869,-2487.43 1865.53,-2471.11 1860.99,-2456.39"/>
<polygon fill="black" stroke="black" points="1864.17,-2454.87 1857.7,-2446.48 1857.53,-2457.07 1864.17,-2454.87"/>
</g>
<!-- l0_mha_attn -->
<g id="node3" class="node">
<title>l0_mha_attn</title>
<polygon fill="none" stroke="black" points="1820.5,-2602.43 1701.5,-2602.43 1701.5,-2561.43 1820.5,-2561.43 1820.5,-2602.43"/>
<text text-anchor="middle" x="1761" y="-2590.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1761" y="-2579.43" font-family="Arial" font-size="10.00">[1024, 16×512]</text>
<text text-anchor="middle" x="1761" y="-2568.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l0_mha_qkv&#45;&gt;l0_mha_attn -->
<g id="edge2" class="edge">
<title>l0_mha_qkv&#45;&gt;l0_mha_attn</title>
<path fill="none" stroke="black" d="M1759.52,-2639.35C1759.73,-2631.2 1759.98,-2621.55 1760.22,-2612.56"/>
<polygon fill="black" stroke="black" points="1763.72,-2612.52 1760.49,-2602.43 1756.72,-2612.34 1763.72,-2612.52"/>
</g>
<!-- l0_mha_out -->
<g id="node4" class="node">
<title>l0_mha_out</title>
<polygon fill="none" stroke="black" points="1838,-2524.43 1698,-2524.43 1698,-2483.43 1838,-2483.43 1838,-2524.43"/>
<text text-anchor="middle" x="1768" y="-2512.43" font-family="Arial" font-size="10.00">MHA Output Linear</text>
<text text-anchor="middle" x="1768" y="-2501.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="1768" y="-2490.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l0_mha_attn&#45;&gt;l0_mha_out -->
<g id="edge3" class="edge">
<title>l0_mha_attn&#45;&gt;l0_mha_out</title>
<path fill="none" stroke="black" d="M1762.8,-2561.35C1763.55,-2553.2 1764.44,-2543.55 1765.27,-2534.56"/>
<polygon fill="black" stroke="black" points="1768.77,-2534.71 1766.2,-2524.43 1761.8,-2534.07 1768.77,-2534.71"/>
</g>
<!-- l0_mha_out&#45;&gt;l0_mha_res -->
<g id="edge4" class="edge">
<title>l0_mha_out&#45;&gt;l0_mha_res</title>
<path fill="none" stroke="black" d="M1782.57,-2483.4C1788.8,-2475.05 1796.37,-2464.91 1803.94,-2454.76"/>
<polygon fill="black" stroke="black" points="1806.81,-2456.76 1809.99,-2446.65 1801.2,-2452.57 1806.81,-2456.76"/>
</g>
<!-- l0_gate_0 -->
<g id="node6" class="node">
<title>l0_gate_0</title>
<polygon fill="none" stroke="black" points="483.56,-2306.43 269.51,-2306.43 214.44,-2224.43 428.49,-2224.43 483.56,-2306.43"/>
<text text-anchor="middle" x="349" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="349" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="349" y="-2251.93" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_0 -->
<g id="edge6" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_0</title>
<path fill="none" stroke="black" d="M1726.29,-2404.56C1444.37,-2404.02 719.52,-2396.77 487,-2337.43 463.57,-2331.45 439.43,-2321.57 417.99,-2311.05"/>
<polygon fill="black" stroke="black" points="419.49,-2307.89 408.98,-2306.52 416.34,-2314.14 419.49,-2307.89"/>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_0 -->
<g id="edge7" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_0</title>
<path fill="none" stroke="black" d="M1726.12,-2404.54C1446.99,-2403.86 735.05,-2396.14 505,-2337.43 481.47,-2331.42 457.22,-2321.48 435.03,-2310.91"/>
<polygon fill="black" stroke="black" points="436.51,-2307.74 425.98,-2306.52 433.45,-2314.03 436.51,-2307.74"/>
</g>
<!-- l0_gate_1 -->
<g id="node10" class="node">
<title>l0_gate_1</title>
<polygon fill="none" stroke="black" points="956.56,-2306.43 742.51,-2306.43 687.44,-2224.43 901.49,-2224.43 956.56,-2306.43"/>
<text text-anchor="middle" x="822" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="822" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="822" y="-2251.93" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_1 -->
<g id="edge13" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_1</title>
<path fill="none" stroke="black" d="M1834.45,-2364.22C1831.59,-2356.88 1827.33,-2350.08 1821,-2345.43 1801.94,-2331.4 992.05,-2342.81 969,-2337.43 944.99,-2331.81 920.32,-2321.81 898.21,-2311.06"/>
<polygon fill="black" stroke="black" points="899.73,-2307.91 889.22,-2306.58 896.61,-2314.17 899.73,-2307.91"/>
</g>
<!-- l0_gate_2 -->
<g id="node14" class="node">
<title>l0_gate_2</title>
<polygon fill="none" stroke="black" points="1429.56,-2306.43 1215.51,-2306.43 1160.44,-2224.43 1374.49,-2224.43 1429.56,-2306.43"/>
<text text-anchor="middle" x="1295" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1295" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1295" y="-2251.93" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_2 -->
<g id="edge19" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_2</title>
<path fill="none" stroke="black" d="M1839.27,-2364.28C1837.26,-2357.03 1833.78,-2350.25 1828,-2345.43 1811.53,-2331.68 1462.86,-2342.43 1442,-2337.43 1418.25,-2331.73 1393.82,-2321.82 1371.88,-2311.18"/>
<polygon fill="black" stroke="black" points="1373.15,-2307.91 1362.63,-2306.59 1370.03,-2314.17 1373.15,-2307.91"/>
</g>
<!-- l0_gate_3 -->
<g id="node18" class="node">
<title>l0_gate_3</title>
<polygon fill="none" stroke="black" points="1902.56,-2306.43 1688.51,-2306.43 1633.44,-2224.43 1847.49,-2224.43 1902.56,-2306.43"/>
<text text-anchor="middle" x="1768" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1768" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1768" y="-2251.93" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_3 -->
<g id="edge25" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_3</title>
<path fill="none" stroke="black" d="M1839.95,-2364.27C1839,-2357.81 1837.45,-2351.31 1835,-2345.43 1830.47,-2334.53 1823.86,-2324.03 1816.53,-2314.43"/>
<polygon fill="black" stroke="black" points="1819.23,-2312.2 1810.24,-2306.6 1813.77,-2316.59 1819.23,-2312.2"/>
</g>
<!-- l0_gate_4 -->
<g id="node22" class="node">
<title>l0_gate_4</title>
<polygon fill="none" stroke="black" points="2196.56,-2306.43 1982.51,-2306.43 1927.44,-2224.43 2141.49,-2224.43 2196.56,-2306.43"/>
<text text-anchor="middle" x="2062" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2062" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2062" y="-2251.93" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_4 -->
<g id="edge31" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_4</title>
<path fill="none" stroke="black" d="M1904.51,-2364.33C1930.85,-2347.95 1961.45,-2328.93 1988.63,-2312.03"/>
<polygon fill="black" stroke="black" points="1990.68,-2314.88 1997.33,-2306.63 1986.99,-2308.93 1990.68,-2314.88"/>
</g>
<!-- l0_gate_5 -->
<g id="node26" class="node">
<title>l0_gate_5</title>
<polygon fill="none" stroke="black" points="2669.56,-2306.43 2455.51,-2306.43 2400.44,-2224.43 2614.49,-2224.43 2669.56,-2306.43"/>
<text text-anchor="middle" x="2535" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2535" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2535" y="-2251.93" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_5 -->
<g id="edge37" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_5</title>
<path fill="none" stroke="black" d="M1950.27,-2401.52C2062.48,-2396.12 2240.41,-2380.8 2388,-2337.43 2410.38,-2330.85 2433.57,-2321.16 2454.73,-2311.04"/>
<polygon fill="black" stroke="black" points="2456.53,-2314.06 2463.98,-2306.53 2453.46,-2307.77 2456.53,-2314.06"/>
</g>
<!-- l0_gate_6 -->
<g id="node30" class="node">
<title>l0_gate_6</title>
<polygon fill="none" stroke="black" points="3142.56,-2306.43 2928.51,-2306.43 2873.44,-2224.43 3087.49,-2224.43 3142.56,-2306.43"/>
<text text-anchor="middle" x="3008" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3008" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3008" y="-2251.93" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_6 -->
<g id="edge43" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_6</title>
<path fill="none" stroke="black" d="M1951.17,-2402.49C2179.05,-2397.64 2691.91,-2382 2861,-2337.43 2884.26,-2331.29 2908.26,-2321.42 2929.94,-2310.97"/>
<polygon fill="black" stroke="black" points="2931.66,-2314.02 2939.09,-2306.46 2928.57,-2307.74 2931.66,-2314.02"/>
</g>
<!-- l0_gate_7 -->
<g id="node34" class="node">
<title>l0_gate_7</title>
<polygon fill="none" stroke="black" points="3615.56,-2306.43 3401.51,-2306.43 3346.44,-2224.43 3560.49,-2224.43 3615.56,-2306.43"/>
<text text-anchor="middle" x="3481" y="-2273.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3481" y="-2262.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3481" y="-2251.93" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_gate_7 -->
<g id="edge49" class="edge">
<title>l0_mha_res&#45;&gt;l0_gate_7</title>
<path fill="none" stroke="black" d="M1952.97,-2405.23C2254.49,-2406.43 3072.99,-2403.35 3334,-2337.43 3357.44,-2331.51 3381.59,-2321.65 3403.36,-2311.13"/>
<polygon fill="black" stroke="black" points="3405.12,-2314.16 3412.54,-2306.59 3402.02,-2307.89 3405.12,-2314.16"/>
</g>
<!-- l0_moe_res -->
<g id="node38" class="node">
<title>l0_moe_res</title>
<polygon fill="none" stroke="black" points="2208.07,-1971.43 1982.07,-1971.43 1923.93,-1889.43 2149.93,-1889.43 2208.07,-1971.43"/>
<text text-anchor="middle" x="2066" y="-1938.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2066" y="-1927.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="2066" y="-1916.93" font-family="Arial" font-size="10.00">All GPUs 0&#45;7</text>
</g>
<!-- l0_mha_res&#45;&gt;l0_moe_res -->
<g id="edge55" class="edge">
<title>l0_mha_res&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M1952.66,-2404.65C2360.45,-2404.92 3739.08,-2401.12 3807,-2337.43 3830.13,-2315.74 3814,-2298.13 3814,-2266.43 3814,-2266.43 3814,-2266.43 3814,-2048.43 3814,-2026.87 3823.02,-2014.85 3807,-2000.43 3747.07,-1946.49 2579.07,-1934.53 2190.51,-1932.04"/>
<polygon fill="black" stroke="black" points="2190.38,-1928.54 2180.36,-1931.98 2190.33,-1935.54 2190.38,-1928.54"/>
</g>
<!-- l0_exp0 -->
<g id="node7" class="node">
<title>l0_exp0</title>
<polygon fill="none" stroke="black" points="250.5,-2179.43 35.5,-2179.43 35.5,-2127.43 250.5,-2127.43 250.5,-2179.43"/>
<text text-anchor="middle" x="143" y="-2167.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="143" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="143" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="143" y="-2134.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- l0_gate_0&#45;&gt;l0_exp0 -->
<g id="edge8" class="edge">
<title>l0_gate_0&#45;&gt;l0_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M274.05,-2224.4C249.27,-2211.17 222.14,-2196.69 199.03,-2184.35"/>
<polygon fill="black" stroke="black" points="200.52,-2181.18 190.05,-2179.55 197.23,-2187.35 200.52,-2181.18"/>
<text text-anchor="middle" x="248.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp1 -->
<g id="node8" class="node">
<title>l0_exp1</title>
<polygon fill="none" stroke="black" points="483.5,-2179.43 268.5,-2179.43 268.5,-2127.43 483.5,-2127.43 483.5,-2179.43"/>
<text text-anchor="middle" x="376" y="-2167.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="376" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="376" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="376" y="-2134.43" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- l0_gate_0&#45;&gt;l0_exp1 -->
<g id="edge10" class="edge">
<title>l0_gate_0&#45;&gt;l0_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M358.82,-2224.4C361.64,-2212.93 364.69,-2200.51 367.42,-2189.37"/>
<polygon fill="black" stroke="black" points="370.85,-2190.1 369.83,-2179.55 364.05,-2188.43 370.85,-2190.1"/>
<text text-anchor="middle" x="373.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_0 -->
<g id="node9" class="node">
<title>l0_agg_0</title>
<polygon fill="none" stroke="black" points="478.78,-2090.43 315.28,-2090.43 273.22,-2008.43 436.72,-2008.43 478.78,-2090.43"/>
<text text-anchor="middle" x="376" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="376" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="376" y="-2035.93" font-family="Arial" font-size="10.00">GPU 0</text>
</g>
<!-- l0_exp0&#45;&gt;l0_agg_0 -->
<g id="edge9" class="edge">
<title>l0_exp0&#45;&gt;l0_agg_0</title>
<path fill="none" stroke="black" d="M200.3,-2127.34C230.34,-2114.19 267.55,-2097.9 299.97,-2083.71"/>
<polygon fill="black" stroke="black" points="301.67,-2086.79 309.42,-2079.57 298.86,-2080.38 301.67,-2086.79"/>
</g>
<!-- l0_exp1&#45;&gt;l0_agg_0 -->
<g id="edge11" class="edge">
<title>l0_exp1&#45;&gt;l0_agg_0</title>
<path fill="none" stroke="black" d="M376,-2127.21C376,-2119.07 376,-2109.73 376,-2100.44"/>
<polygon fill="black" stroke="black" points="379.5,-2100.43 376,-2090.43 372.5,-2100.43 379.5,-2100.43"/>
</g>
<!-- l0_agg_0&#45;&gt;l0_moe_res -->
<g id="edge12" class="edge">
<title>l0_agg_0&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M441.71,-2017.54C459.01,-2010.7 477.9,-2004.33 496,-2000.43 771.39,-1941.09 1624.11,-1932.58 1943.53,-1931.51"/>
<polygon fill="black" stroke="black" points="1943.75,-1935.01 1953.74,-1931.48 1943.73,-1928.01 1943.75,-1935.01"/>
</g>
<!-- l0_exp2 -->
<g id="node11" class="node">
<title>l0_exp2</title>
<polygon fill="none" stroke="black" points="723.5,-2179.43 508.5,-2179.43 508.5,-2127.43 723.5,-2127.43 723.5,-2179.43"/>
<text text-anchor="middle" x="616" y="-2167.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="616" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="616" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="616" y="-2134.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- l0_gate_1&#45;&gt;l0_exp2 -->
<g id="edge14" class="edge">
<title>l0_gate_1&#45;&gt;l0_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M747.05,-2224.4C722.27,-2211.17 695.14,-2196.69 672.03,-2184.35"/>
<polygon fill="black" stroke="black" points="673.52,-2181.18 663.05,-2179.55 670.23,-2187.35 673.52,-2181.18"/>
<text text-anchor="middle" x="721.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp3 -->
<g id="node12" class="node">
<title>l0_exp3</title>
<polygon fill="none" stroke="black" points="956.5,-2179.43 741.5,-2179.43 741.5,-2127.43 956.5,-2127.43 956.5,-2179.43"/>
<text text-anchor="middle" x="849" y="-2167.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="849" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="849" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="849" y="-2134.43" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- l0_gate_1&#45;&gt;l0_exp3 -->
<g id="edge16" class="edge">
<title>l0_gate_1&#45;&gt;l0_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M831.82,-2224.4C834.64,-2212.93 837.69,-2200.51 840.42,-2189.37"/>
<polygon fill="black" stroke="black" points="843.85,-2190.1 842.83,-2179.55 837.05,-2188.43 843.85,-2190.1"/>
<text text-anchor="middle" x="846.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_1 -->
<g id="node13" class="node">
<title>l0_agg_1</title>
<polygon fill="none" stroke="black" points="951.78,-2090.43 788.28,-2090.43 746.22,-2008.43 909.72,-2008.43 951.78,-2090.43"/>
<text text-anchor="middle" x="849" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="849" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="849" y="-2035.93" font-family="Arial" font-size="10.00">GPU 1</text>
</g>
<!-- l0_exp2&#45;&gt;l0_agg_1 -->
<g id="edge15" class="edge">
<title>l0_exp2&#45;&gt;l0_agg_1</title>
<path fill="none" stroke="black" d="M673.3,-2127.34C703.34,-2114.19 740.55,-2097.9 772.97,-2083.71"/>
<polygon fill="black" stroke="black" points="774.67,-2086.79 782.42,-2079.57 771.86,-2080.38 774.67,-2086.79"/>
</g>
<!-- l0_exp3&#45;&gt;l0_agg_1 -->
<g id="edge17" class="edge">
<title>l0_exp3&#45;&gt;l0_agg_1</title>
<path fill="none" stroke="black" d="M849,-2127.21C849,-2119.07 849,-2109.73 849,-2100.44"/>
<polygon fill="black" stroke="black" points="852.5,-2100.43 849,-2090.43 845.5,-2100.43 852.5,-2100.43"/>
</g>
<!-- l0_agg_1&#45;&gt;l0_moe_res -->
<g id="edge18" class="edge">
<title>l0_agg_1&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M914.76,-2017.78C932.06,-2010.93 950.94,-2004.5 969,-2000.43 1151.81,-1959.23 1699.8,-1940.63 1945.04,-1934.21"/>
<polygon fill="black" stroke="black" points="1945.16,-1937.7 1955.07,-1933.95 1944.98,-1930.71 1945.16,-1937.7"/>
</g>
<!-- l0_exp4 -->
<g id="node15" class="node">
<title>l0_exp4</title>
<polygon fill="none" stroke="black" points="1196.5,-2179.43 981.5,-2179.43 981.5,-2127.43 1196.5,-2127.43 1196.5,-2179.43"/>
<text text-anchor="middle" x="1089" y="-2167.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1089" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1089" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1089" y="-2134.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- l0_gate_2&#45;&gt;l0_exp4 -->
<g id="edge20" class="edge">
<title>l0_gate_2&#45;&gt;l0_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1220.05,-2224.4C1195.27,-2211.17 1168.14,-2196.69 1145.03,-2184.35"/>
<polygon fill="black" stroke="black" points="1146.52,-2181.18 1136.05,-2179.55 1143.23,-2187.35 1146.52,-2181.18"/>
<text text-anchor="middle" x="1194.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp5 -->
<g id="node16" class="node">
<title>l0_exp5</title>
<polygon fill="none" stroke="black" points="1429.5,-2179.43 1214.5,-2179.43 1214.5,-2127.43 1429.5,-2127.43 1429.5,-2179.43"/>
<text text-anchor="middle" x="1322" y="-2167.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1322" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1322" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1322" y="-2134.43" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- l0_gate_2&#45;&gt;l0_exp5 -->
<g id="edge22" class="edge">
<title>l0_gate_2&#45;&gt;l0_exp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1304.82,-2224.4C1307.64,-2212.93 1310.69,-2200.51 1313.42,-2189.37"/>
<polygon fill="black" stroke="black" points="1316.85,-2190.1 1315.83,-2179.55 1310.05,-2188.43 1316.85,-2190.1"/>
<text text-anchor="middle" x="1319.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_2 -->
<g id="node17" class="node">
<title>l0_agg_2</title>
<polygon fill="none" stroke="black" points="1424.78,-2090.43 1261.28,-2090.43 1219.22,-2008.43 1382.72,-2008.43 1424.78,-2090.43"/>
<text text-anchor="middle" x="1322" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1322" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1322" y="-2035.93" font-family="Arial" font-size="10.00">GPU 2</text>
</g>
<!-- l0_exp4&#45;&gt;l0_agg_2 -->
<g id="edge21" class="edge">
<title>l0_exp4&#45;&gt;l0_agg_2</title>
<path fill="none" stroke="black" d="M1146.3,-2127.34C1176.34,-2114.19 1213.55,-2097.9 1245.97,-2083.71"/>
<polygon fill="black" stroke="black" points="1247.67,-2086.79 1255.42,-2079.57 1244.86,-2080.38 1247.67,-2086.79"/>
</g>
<!-- l0_exp5&#45;&gt;l0_agg_2 -->
<g id="edge23" class="edge">
<title>l0_exp5&#45;&gt;l0_agg_2</title>
<path fill="none" stroke="black" d="M1322,-2127.21C1322,-2119.07 1322,-2109.73 1322,-2100.44"/>
<polygon fill="black" stroke="black" points="1325.5,-2100.43 1322,-2090.43 1318.5,-2100.43 1325.5,-2100.43"/>
</g>
<!-- l0_agg_2&#45;&gt;l0_moe_res -->
<g id="edge24" class="edge">
<title>l0_agg_2&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M1387.9,-2018.36C1405.2,-2011.51 1424.04,-2004.92 1442,-2000.43 1613.79,-1957.42 1818.87,-1941.21 1945.78,-1935.1"/>
<polygon fill="black" stroke="black" points="1946.1,-1938.59 1955.92,-1934.63 1945.77,-1931.6 1946.1,-1938.59"/>
</g>
<!-- l0_exp6 -->
<g id="node19" class="node">
<title>l0_exp6</title>
<polygon fill="none" stroke="black" points="1669.5,-2179.43 1454.5,-2179.43 1454.5,-2127.43 1669.5,-2127.43 1669.5,-2179.43"/>
<text text-anchor="middle" x="1562" y="-2167.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1562" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1562" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1562" y="-2134.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- l0_gate_3&#45;&gt;l0_exp6 -->
<g id="edge26" class="edge">
<title>l0_gate_3&#45;&gt;l0_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1693.05,-2224.4C1668.27,-2211.17 1641.14,-2196.69 1618.03,-2184.35"/>
<polygon fill="black" stroke="black" points="1619.52,-2181.18 1609.05,-2179.55 1616.23,-2187.35 1619.52,-2181.18"/>
<text text-anchor="middle" x="1667.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp7 -->
<g id="node20" class="node">
<title>l0_exp7</title>
<polygon fill="none" stroke="black" points="1902.5,-2179.43 1687.5,-2179.43 1687.5,-2127.43 1902.5,-2127.43 1902.5,-2179.43"/>
<text text-anchor="middle" x="1795" y="-2167.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1795" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1795" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1795" y="-2134.43" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- l0_gate_3&#45;&gt;l0_exp7 -->
<g id="edge28" class="edge">
<title>l0_gate_3&#45;&gt;l0_exp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1777.82,-2224.4C1780.64,-2212.93 1783.69,-2200.51 1786.42,-2189.37"/>
<polygon fill="black" stroke="black" points="1789.85,-2190.1 1788.83,-2179.55 1783.05,-2188.43 1789.85,-2190.1"/>
<text text-anchor="middle" x="1792.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_3 -->
<g id="node21" class="node">
<title>l0_agg_3</title>
<polygon fill="none" stroke="black" points="1897.78,-2090.43 1734.28,-2090.43 1692.22,-2008.43 1855.72,-2008.43 1897.78,-2090.43"/>
<text text-anchor="middle" x="1795" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1795" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1795" y="-2035.93" font-family="Arial" font-size="10.00">GPU 3</text>
</g>
<!-- l0_exp6&#45;&gt;l0_agg_3 -->
<g id="edge27" class="edge">
<title>l0_exp6&#45;&gt;l0_agg_3</title>
<path fill="none" stroke="black" d="M1619.3,-2127.34C1649.34,-2114.19 1686.55,-2097.9 1718.97,-2083.71"/>
<polygon fill="black" stroke="black" points="1720.67,-2086.79 1728.42,-2079.57 1717.86,-2080.38 1720.67,-2086.79"/>
</g>
<!-- l0_exp7&#45;&gt;l0_agg_3 -->
<g id="edge29" class="edge">
<title>l0_exp7&#45;&gt;l0_agg_3</title>
<path fill="none" stroke="black" d="M1795,-2127.21C1795,-2119.07 1795,-2109.73 1795,-2100.44"/>
<polygon fill="black" stroke="black" points="1798.5,-2100.43 1795,-2090.43 1791.5,-2100.43 1798.5,-2100.43"/>
</g>
<!-- l0_agg_3&#45;&gt;l0_moe_res -->
<g id="edge30" class="edge">
<title>l0_agg_3&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M1861.64,-2019.66C1894.37,-2005.52 1934.4,-1988.24 1970.33,-1972.73"/>
<polygon fill="black" stroke="black" points="1972.06,-1975.8 1979.85,-1968.62 1969.29,-1969.37 1972.06,-1975.8"/>
</g>
<!-- l0_exp8 -->
<g id="node23" class="node">
<title>l0_exp8</title>
<polygon fill="none" stroke="black" points="2142.5,-2179.43 1927.5,-2179.43 1927.5,-2127.43 2142.5,-2127.43 2142.5,-2179.43"/>
<text text-anchor="middle" x="2035" y="-2167.43" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2035" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2035" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2035" y="-2134.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- l0_gate_4&#45;&gt;l0_exp8 -->
<g id="edge32" class="edge">
<title>l0_gate_4&#45;&gt;l0_exp8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2052.18,-2224.4C2049.36,-2212.93 2046.31,-2200.51 2043.58,-2189.37"/>
<polygon fill="black" stroke="black" points="2046.95,-2188.43 2041.17,-2179.55 2040.15,-2190.1 2046.95,-2188.43"/>
<text text-anchor="middle" x="2056.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp9 -->
<g id="node24" class="node">
<title>l0_exp9</title>
<polygon fill="none" stroke="black" points="2375.5,-2179.43 2160.5,-2179.43 2160.5,-2127.43 2375.5,-2127.43 2375.5,-2179.43"/>
<text text-anchor="middle" x="2268" y="-2167.43" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="2268" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2268" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2268" y="-2134.43" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- l0_gate_4&#45;&gt;l0_exp9 -->
<g id="edge34" class="edge">
<title>l0_gate_4&#45;&gt;l0_exp9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2136.95,-2224.4C2161.73,-2211.17 2188.86,-2196.69 2211.97,-2184.35"/>
<polygon fill="black" stroke="black" points="2213.77,-2187.35 2220.95,-2179.55 2210.48,-2181.18 2213.77,-2187.35"/>
<text text-anchor="middle" x="2192.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_4 -->
<g id="node25" class="node">
<title>l0_agg_4</title>
<polygon fill="none" stroke="black" points="2168.78,-2090.43 2005.28,-2090.43 1963.22,-2008.43 2126.72,-2008.43 2168.78,-2090.43"/>
<text text-anchor="middle" x="2066" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2066" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2066" y="-2035.93" font-family="Arial" font-size="10.00">GPU 4</text>
</g>
<!-- l0_exp8&#45;&gt;l0_agg_4 -->
<g id="edge33" class="edge">
<title>l0_exp8&#45;&gt;l0_agg_4</title>
<path fill="none" stroke="black" d="M2042.66,-2127.21C2045.16,-2118.98 2048.04,-2109.53 2050.89,-2100.14"/>
<polygon fill="black" stroke="black" points="2054.28,-2101.02 2053.84,-2090.43 2047.58,-2098.98 2054.28,-2101.02"/>
</g>
<!-- l0_exp9&#45;&gt;l0_agg_4 -->
<g id="edge35" class="edge">
<title>l0_exp9&#45;&gt;l0_agg_4</title>
<path fill="none" stroke="black" d="M2218.33,-2127.34C2199.02,-2117.6 2176.32,-2106.13 2154.41,-2095.07"/>
<polygon fill="black" stroke="black" points="2155.92,-2091.91 2145.41,-2090.53 2152.76,-2098.16 2155.92,-2091.91"/>
</g>
<!-- l0_agg_4&#45;&gt;l0_moe_res -->
<g id="edge36" class="edge">
<title>l0_agg_4&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M2066,-2008.16C2066,-1999.7 2066,-1990.68 2066,-1981.91"/>
<polygon fill="black" stroke="black" points="2069.5,-1981.77 2066,-1971.77 2062.5,-1981.77 2069.5,-1981.77"/>
</g>
<!-- l0_exp10 -->
<g id="node27" class="node">
<title>l0_exp10</title>
<polygon fill="none" stroke="black" points="2615.5,-2179.43 2400.5,-2179.43 2400.5,-2127.43 2615.5,-2127.43 2615.5,-2179.43"/>
<text text-anchor="middle" x="2508" y="-2167.43" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="2508" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2508" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2508" y="-2134.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- l0_gate_5&#45;&gt;l0_exp10 -->
<g id="edge38" class="edge">
<title>l0_gate_5&#45;&gt;l0_exp10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2525.18,-2224.4C2522.36,-2212.93 2519.31,-2200.51 2516.58,-2189.37"/>
<polygon fill="black" stroke="black" points="2519.95,-2188.43 2514.17,-2179.55 2513.15,-2190.1 2519.95,-2188.43"/>
<text text-anchor="middle" x="2529.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp11 -->
<g id="node28" class="node">
<title>l0_exp11</title>
<polygon fill="none" stroke="black" points="2848.5,-2179.43 2633.5,-2179.43 2633.5,-2127.43 2848.5,-2127.43 2848.5,-2179.43"/>
<text text-anchor="middle" x="2741" y="-2167.43" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="2741" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2741" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2741" y="-2134.43" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- l0_gate_5&#45;&gt;l0_exp11 -->
<g id="edge40" class="edge">
<title>l0_gate_5&#45;&gt;l0_exp11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2609.95,-2224.4C2634.73,-2211.17 2661.86,-2196.69 2684.97,-2184.35"/>
<polygon fill="black" stroke="black" points="2686.77,-2187.35 2693.95,-2179.55 2683.48,-2181.18 2686.77,-2187.35"/>
<text text-anchor="middle" x="2665.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_5 -->
<g id="node29" class="node">
<title>l0_agg_5</title>
<polygon fill="none" stroke="black" points="2610.78,-2090.43 2447.28,-2090.43 2405.22,-2008.43 2568.72,-2008.43 2610.78,-2090.43"/>
<text text-anchor="middle" x="2508" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2508" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2508" y="-2035.93" font-family="Arial" font-size="10.00">GPU 5</text>
</g>
<!-- l0_exp10&#45;&gt;l0_agg_5 -->
<g id="edge39" class="edge">
<title>l0_exp10&#45;&gt;l0_agg_5</title>
<path fill="none" stroke="black" d="M2508,-2127.21C2508,-2119.07 2508,-2109.73 2508,-2100.44"/>
<polygon fill="black" stroke="black" points="2511.5,-2100.43 2508,-2090.43 2504.5,-2100.43 2511.5,-2100.43"/>
</g>
<!-- l0_exp11&#45;&gt;l0_agg_5 -->
<g id="edge41" class="edge">
<title>l0_exp11&#45;&gt;l0_agg_5</title>
<path fill="none" stroke="black" d="M2683.7,-2127.34C2661.14,-2117.47 2634.55,-2105.82 2608.97,-2094.63"/>
<polygon fill="black" stroke="black" points="2610.16,-2091.33 2599.6,-2090.53 2607.36,-2097.74 2610.16,-2091.33"/>
</g>
<!-- l0_agg_5&#45;&gt;l0_moe_res -->
<g id="edge42" class="edge">
<title>l0_agg_5&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M2411.9,-2008.34C2403.87,-2005.5 2395.83,-2002.81 2388,-2000.43 2329.06,-1982.47 2262.69,-1967.4 2205.58,-1955.97"/>
<polygon fill="black" stroke="black" points="2206.25,-1952.54 2195.76,-1954.03 2204.89,-1959.41 2206.25,-1952.54"/>
</g>
<!-- l0_exp12 -->
<g id="node31" class="node">
<title>l0_exp12</title>
<polygon fill="none" stroke="black" points="3088.5,-2179.43 2873.5,-2179.43 2873.5,-2127.43 3088.5,-2127.43 3088.5,-2179.43"/>
<text text-anchor="middle" x="2981" y="-2167.43" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="2981" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2981" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2981" y="-2134.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- l0_gate_6&#45;&gt;l0_exp12 -->
<g id="edge44" class="edge">
<title>l0_gate_6&#45;&gt;l0_exp12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2998.18,-2224.4C2995.36,-2212.93 2992.31,-2200.51 2989.58,-2189.37"/>
<polygon fill="black" stroke="black" points="2992.95,-2188.43 2987.17,-2179.55 2986.15,-2190.1 2992.95,-2188.43"/>
<text text-anchor="middle" x="3002.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp13 -->
<g id="node32" class="node">
<title>l0_exp13</title>
<polygon fill="none" stroke="black" points="3321.5,-2179.43 3106.5,-2179.43 3106.5,-2127.43 3321.5,-2127.43 3321.5,-2179.43"/>
<text text-anchor="middle" x="3214" y="-2167.43" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="3214" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3214" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3214" y="-2134.43" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- l0_gate_6&#45;&gt;l0_exp13 -->
<g id="edge46" class="edge">
<title>l0_gate_6&#45;&gt;l0_exp13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3082.95,-2224.4C3107.73,-2211.17 3134.86,-2196.69 3157.97,-2184.35"/>
<polygon fill="black" stroke="black" points="3159.77,-2187.35 3166.95,-2179.55 3156.48,-2181.18 3159.77,-2187.35"/>
<text text-anchor="middle" x="3138.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_6 -->
<g id="node33" class="node">
<title>l0_agg_6</title>
<polygon fill="none" stroke="black" points="3083.78,-2090.43 2920.28,-2090.43 2878.22,-2008.43 3041.72,-2008.43 3083.78,-2090.43"/>
<text text-anchor="middle" x="2981" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2981" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2981" y="-2035.93" font-family="Arial" font-size="10.00">GPU 6</text>
</g>
<!-- l0_exp12&#45;&gt;l0_agg_6 -->
<g id="edge45" class="edge">
<title>l0_exp12&#45;&gt;l0_agg_6</title>
<path fill="none" stroke="black" d="M2981,-2127.21C2981,-2119.07 2981,-2109.73 2981,-2100.44"/>
<polygon fill="black" stroke="black" points="2984.5,-2100.43 2981,-2090.43 2977.5,-2100.43 2984.5,-2100.43"/>
</g>
<!-- l0_exp13&#45;&gt;l0_agg_6 -->
<g id="edge47" class="edge">
<title>l0_exp13&#45;&gt;l0_agg_6</title>
<path fill="none" stroke="black" d="M3156.7,-2127.34C3134.14,-2117.47 3107.55,-2105.82 3081.97,-2094.63"/>
<polygon fill="black" stroke="black" points="3083.16,-2091.33 3072.6,-2090.53 3080.36,-2097.74 3083.16,-2091.33"/>
</g>
<!-- l0_agg_6&#45;&gt;l0_moe_res -->
<g id="edge48" class="edge">
<title>l0_agg_6&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M2888.52,-2008.34C2879.33,-2005.3 2870.06,-2002.58 2861,-2000.43 2628.23,-1945.05 2347.69,-1932.99 2189.79,-1931"/>
<polygon fill="black" stroke="black" points="2189.6,-1927.5 2179.56,-1930.88 2189.52,-1934.5 2189.6,-1927.5"/>
</g>
<!-- l0_exp14 -->
<g id="node35" class="node">
<title>l0_exp14</title>
<polygon fill="none" stroke="black" points="3561.5,-2179.43 3346.5,-2179.43 3346.5,-2127.43 3561.5,-2127.43 3561.5,-2179.43"/>
<text text-anchor="middle" x="3454" y="-2167.43" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="3454" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3454" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3454" y="-2134.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- l0_gate_7&#45;&gt;l0_exp14 -->
<g id="edge50" class="edge">
<title>l0_gate_7&#45;&gt;l0_exp14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3471.18,-2224.4C3468.36,-2212.93 3465.31,-2200.51 3462.58,-2189.37"/>
<polygon fill="black" stroke="black" points="3465.95,-2188.43 3460.17,-2179.55 3459.15,-2190.1 3465.95,-2188.43"/>
<text text-anchor="middle" x="3475.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_exp15 -->
<g id="node36" class="node">
<title>l0_exp15</title>
<polygon fill="none" stroke="black" points="3794.5,-2179.43 3579.5,-2179.43 3579.5,-2127.43 3794.5,-2127.43 3794.5,-2179.43"/>
<text text-anchor="middle" x="3687" y="-2167.43" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="3687" y="-2156.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3687" y="-2145.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3687" y="-2134.43" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- l0_gate_7&#45;&gt;l0_exp15 -->
<g id="edge52" class="edge">
<title>l0_gate_7&#45;&gt;l0_exp15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3546.72,-2224.39C3562.38,-2215.24 3579.15,-2205.76 3595,-2197.43 3603.66,-2192.87 3612.89,-2188.27 3622.03,-2183.86"/>
<polygon fill="black" stroke="black" points="3623.61,-2186.98 3631.13,-2179.51 3620.59,-2180.67 3623.61,-2186.98"/>
<text text-anchor="middle" x="3604.5" y="-2200.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l0_agg_7 -->
<g id="node37" class="node">
<title>l0_agg_7</title>
<polygon fill="none" stroke="black" points="3556.78,-2090.43 3393.28,-2090.43 3351.22,-2008.43 3514.72,-2008.43 3556.78,-2090.43"/>
<text text-anchor="middle" x="3454" y="-2057.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3454" y="-2046.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="3454" y="-2035.93" font-family="Arial" font-size="10.00">GPU 7</text>
</g>
<!-- l0_exp14&#45;&gt;l0_agg_7 -->
<g id="edge51" class="edge">
<title>l0_exp14&#45;&gt;l0_agg_7</title>
<path fill="none" stroke="black" d="M3454,-2127.21C3454,-2119.07 3454,-2109.73 3454,-2100.44"/>
<polygon fill="black" stroke="black" points="3457.5,-2100.43 3454,-2090.43 3450.5,-2100.43 3457.5,-2100.43"/>
</g>
<!-- l0_exp15&#45;&gt;l0_agg_7 -->
<g id="edge53" class="edge">
<title>l0_exp15&#45;&gt;l0_agg_7</title>
<path fill="none" stroke="black" d="M3622.2,-2127.38C3607.9,-2121.65 3592.88,-2115.46 3579,-2109.43 3568.34,-2104.79 3557.24,-2099.8 3546.24,-2094.75"/>
<polygon fill="black" stroke="black" points="3547.59,-2091.52 3537.05,-2090.5 3544.66,-2097.88 3547.59,-2091.52"/>
</g>
<!-- l0_agg_7&#45;&gt;l0_moe_res -->
<g id="edge54" class="edge">
<title>l0_agg_7&#45;&gt;l0_moe_res</title>
<path fill="none" stroke="black" d="M3362.59,-2008.36C3353.06,-2005.24 3343.42,-2002.51 3334,-2000.43 3118.83,-1952.89 2466.51,-1937.52 2190.97,-1933.07"/>
<polygon fill="black" stroke="black" points="2190.99,-1929.57 2180.93,-1932.91 2190.87,-1936.57 2190.99,-1929.57"/>
</g>
<!-- l2_mha_qkv -->
<g id="node39" class="node">
<title>l2_mha_qkv</title>
<polygon fill="none" stroke="black" points="2147.5,-1762.43 1984.5,-1762.43 1984.5,-1721.43 2147.5,-1721.43 2147.5,-1762.43"/>
<text text-anchor="middle" x="2066" y="-1750.43" font-family="Arial" font-size="10.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2066" y="-1739.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="2066" y="-1728.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l0_moe_res&#45;&gt;l2_mha_qkv -->
<g id="edge56" class="edge">
<title>l0_moe_res&#45;&gt;l2_mha_qkv</title>
<path fill="none" stroke="black" d="M2066,-1889.42C2066,-1854.57 2066,-1804.8 2066,-1773.18"/>
<polygon fill="black" stroke="black" points="2069.5,-1772.81 2066,-1762.81 2062.5,-1772.81 2069.5,-1772.81"/>
<text text-anchor="middle" x="2098.5" y="-1859.03" font-family="Arial" font-size="8.00">PP stage transfer</text>
<text text-anchor="middle" x="2098.5" y="-1850.03" font-family="Arial" font-size="8.00">GPUs 0&#45;7 → 8&#45;15</text>
</g>
<!-- l2_mha_attn -->
<g id="node40" class="node">
<title>l2_mha_attn</title>
<polygon fill="none" stroke="black" points="2064.5,-1684.43 1945.5,-1684.43 1945.5,-1643.43 2064.5,-1643.43 2064.5,-1684.43"/>
<text text-anchor="middle" x="2005" y="-1672.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="2005" y="-1661.43" font-family="Arial" font-size="10.00">[1024, 16×512]</text>
<text text-anchor="middle" x="2005" y="-1650.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_attn -->
<g id="edge57" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_attn</title>
<path fill="none" stroke="black" d="M2050.29,-1721.35C2043.25,-1712.58 2034.81,-1702.07 2027.14,-1692.52"/>
<polygon fill="black" stroke="black" points="2029.64,-1690.04 2020.66,-1684.43 2024.19,-1694.42 2029.64,-1690.04"/>
</g>
<!-- l2_mha_res -->
<g id="node42" class="node">
<title>l2_mha_res</title>
<polygon fill="none" stroke="black" points="2187.07,-1528.43 1961.07,-1528.43 1902.93,-1446.43 2128.93,-1446.43 2187.07,-1528.43"/>
<text text-anchor="middle" x="2045" y="-1495.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2045" y="-1484.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="2045" y="-1473.93" font-family="Arial" font-size="10.00">All GPUs 0&#45;7</text>
</g>
<!-- l2_mha_qkv&#45;&gt;l2_mha_res -->
<g id="edge60" class="edge">
<title>l2_mha_qkv&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M2071.02,-1721.21C2078.55,-1688.48 2090.73,-1621.03 2079,-1565.43 2077.07,-1556.29 2073.99,-1546.92 2070.45,-1538"/>
<polygon fill="black" stroke="black" points="2073.57,-1536.38 2066.46,-1528.53 2067.12,-1539.1 2073.57,-1536.38"/>
</g>
<!-- l2_mha_out -->
<g id="node41" class="node">
<title>l2_mha_out</title>
<polygon fill="none" stroke="black" points="2070,-1606.43 1930,-1606.43 1930,-1565.43 2070,-1565.43 2070,-1606.43"/>
<text text-anchor="middle" x="2000" y="-1594.43" font-family="Arial" font-size="10.00">MHA Output Linear</text>
<text text-anchor="middle" x="2000" y="-1583.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="2000" y="-1572.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 0&#45;7</text>
</g>
<!-- l2_mha_attn&#45;&gt;l2_mha_out -->
<g id="edge58" class="edge">
<title>l2_mha_attn&#45;&gt;l2_mha_out</title>
<path fill="none" stroke="black" d="M2003.71,-1643.35C2003.18,-1635.2 2002.54,-1625.55 2001.95,-1616.56"/>
<polygon fill="black" stroke="black" points="2005.43,-1616.18 2001.28,-1606.43 1998.45,-1616.64 2005.43,-1616.18"/>
</g>
<!-- l2_mha_out&#45;&gt;l2_mha_res -->
<g id="edge59" class="edge">
<title>l2_mha_out&#45;&gt;l2_mha_res</title>
<path fill="none" stroke="black" d="M2009.11,-1565.4C2012.84,-1557.39 2017.35,-1547.71 2021.9,-1537.97"/>
<polygon fill="black" stroke="black" points="2025.19,-1539.19 2026.24,-1528.65 2018.84,-1536.24 2025.19,-1539.19"/>
</g>
<!-- l2_gate_16 -->
<g id="node43" class="node">
<title>l2_gate_16</title>
<polygon fill="none" stroke="black" points="480.56,-1388.43 266.51,-1388.43 211.44,-1306.43 425.49,-1306.43 480.56,-1388.43"/>
<text text-anchor="middle" x="346" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="346" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="346" y="-1333.93" font-family="Arial" font-size="10.00">GPU 16</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_16 -->
<g id="edge61" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_16</title>
<path fill="none" stroke="black" d="M1929.53,-1484.22C1591.98,-1477.27 622.33,-1454.24 484,-1419.43 460.43,-1413.5 436.16,-1403.57 414.64,-1392.99"/>
<polygon fill="black" stroke="black" points="416.1,-1389.81 405.59,-1388.43 412.94,-1396.06 416.1,-1389.81"/>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_16 -->
<g id="edge62" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_16</title>
<path fill="none" stroke="black" d="M1929.41,-1484.05C1594.57,-1476.9 639.23,-1453.96 502,-1419.43 478.33,-1413.47 453.94,-1403.48 431.66,-1392.85"/>
<polygon fill="black" stroke="black" points="433.1,-1389.66 422.58,-1388.43 430.04,-1395.96 433.1,-1389.66"/>
</g>
<!-- l2_gate_17 -->
<g id="node47" class="node">
<title>l2_gate_17</title>
<polygon fill="none" stroke="black" points="953.56,-1388.43 739.51,-1388.43 684.44,-1306.43 898.49,-1306.43 953.56,-1388.43"/>
<text text-anchor="middle" x="819" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="819" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="819" y="-1333.93" font-family="Arial" font-size="10.00">GPU 17</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_17 -->
<g id="edge68" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_17</title>
<path fill="none" stroke="black" d="M2039.46,-1446.21C2036.6,-1438.87 2032.33,-1432.08 2026,-1427.43 2014.13,-1418.71 980.34,-1422.76 966,-1419.43 941.98,-1413.83 917.31,-1403.84 895.2,-1393.09"/>
<polygon fill="black" stroke="black" points="896.73,-1389.94 886.22,-1388.61 893.6,-1396.2 896.73,-1389.94"/>
</g>
<!-- l2_gate_18 -->
<g id="node51" class="node">
<title>l2_gate_18</title>
<polygon fill="none" stroke="black" points="1426.56,-1388.43 1212.51,-1388.43 1157.44,-1306.43 1371.49,-1306.43 1426.56,-1388.43"/>
<text text-anchor="middle" x="1292" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1292" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1292" y="-1333.93" font-family="Arial" font-size="10.00">GPU 18</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_18 -->
<g id="edge74" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_18</title>
<path fill="none" stroke="black" d="M2044.3,-1446.24C2042.28,-1438.99 2038.8,-1432.23 2033,-1427.43 2020.29,-1416.9 1455.06,-1423.22 1439,-1419.43 1415,-1413.76 1390.33,-1403.75 1368.22,-1392.99"/>
<polygon fill="black" stroke="black" points="1369.75,-1389.84 1359.24,-1388.51 1366.63,-1396.11 1369.75,-1389.84"/>
</g>
<!-- l2_gate_19 -->
<g id="node55" class="node">
<title>l2_gate_19</title>
<polygon fill="none" stroke="black" points="1899.56,-1388.43 1685.51,-1388.43 1630.44,-1306.43 1844.49,-1306.43 1899.56,-1388.43"/>
<text text-anchor="middle" x="1765" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1765" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1765" y="-1333.93" font-family="Arial" font-size="10.00">GPU 19</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_19 -->
<g id="edge80" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_19</title>
<path fill="none" stroke="black" d="M2049.06,-1446.22C2047.85,-1439.15 2045.14,-1432.46 2040,-1427.43 2029.81,-1417.46 1925.78,-1423.04 1912,-1419.43 1888.73,-1413.33 1864.73,-1403.47 1843.05,-1393.02"/>
<polygon fill="black" stroke="black" points="1844.42,-1389.79 1833.9,-1388.51 1841.32,-1396.07 1844.42,-1389.79"/>
</g>
<!-- l2_gate_20 -->
<g id="node59" class="node">
<title>l2_gate_20</title>
<polygon fill="none" stroke="black" points="2193.56,-1388.43 1979.51,-1388.43 1924.44,-1306.43 2138.49,-1306.43 2193.56,-1388.43"/>
<text text-anchor="middle" x="2059" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2059" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2059" y="-1333.93" font-family="Arial" font-size="10.00">GPU 20</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_20 -->
<g id="edge86" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_20</title>
<path fill="none" stroke="black" d="M2049.09,-1446.14C2050.6,-1431.26 2052.33,-1414.21 2053.91,-1398.57"/>
<polygon fill="black" stroke="black" points="2057.4,-1398.83 2054.93,-1388.52 2050.44,-1398.12 2057.4,-1398.83"/>
</g>
<!-- l2_gate_21 -->
<g id="node63" class="node">
<title>l2_gate_21</title>
<polygon fill="none" stroke="black" points="2666.56,-1388.43 2452.51,-1388.43 2397.44,-1306.43 2611.49,-1306.43 2666.56,-1388.43"/>
<text text-anchor="middle" x="2532" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2532" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2532" y="-1333.93" font-family="Arial" font-size="10.00">GPU 21</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_21 -->
<g id="edge92" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_21</title>
<path fill="none" stroke="black" d="M2147.92,-1473.14C2216.28,-1462.63 2307.39,-1445.34 2385,-1419.43 2406.43,-1412.27 2428.76,-1402.69 2449.36,-1392.89"/>
<polygon fill="black" stroke="black" points="2450.9,-1396.03 2458.38,-1388.53 2447.86,-1389.73 2450.9,-1396.03"/>
</g>
<!-- l2_gate_22 -->
<g id="node67" class="node">
<title>l2_gate_22</title>
<polygon fill="none" stroke="black" points="3139.56,-1388.43 2925.51,-1388.43 2870.44,-1306.43 3084.49,-1306.43 3139.56,-1388.43"/>
<text text-anchor="middle" x="3005" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3005" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3005" y="-1333.93" font-family="Arial" font-size="10.00">GPU 22</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_22 -->
<g id="edge98" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_22</title>
<path fill="none" stroke="black" d="M2154.49,-1482.37C2344.75,-1474.5 2728.45,-1454.74 2858,-1419.43 2880.97,-1413.17 2904.69,-1403.37 2926.2,-1393.03"/>
<polygon fill="black" stroke="black" points="2927.84,-1396.13 2935.27,-1388.58 2924.76,-1389.84 2927.84,-1396.13"/>
</g>
<!-- l2_gate_23 -->
<g id="node71" class="node">
<title>l2_gate_23</title>
<polygon fill="none" stroke="black" points="3612.56,-1388.43 3398.51,-1388.43 3343.44,-1306.43 3557.49,-1306.43 3612.56,-1388.43"/>
<text text-anchor="middle" x="3478" y="-1355.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3478" y="-1344.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3478" y="-1333.93" font-family="Arial" font-size="10.00">GPU 23</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_gate_23 -->
<g id="edge104" class="edge">
<title>l2_mha_res&#45;&gt;l2_gate_23</title>
<path fill="none" stroke="black" d="M2157.27,-1486.26C2428,-1484.94 3110.65,-1475.93 3331,-1419.43 3354.42,-1413.42 3378.56,-1403.53 3400.33,-1393.02"/>
<polygon fill="black" stroke="black" points="3402.09,-1396.05 3409.51,-1388.48 3398.99,-1389.77 3402.09,-1396.05"/>
</g>
<!-- l2_moe_res -->
<g id="node75" class="node">
<title>l2_moe_res</title>
<polygon fill="none" stroke="black" points="2210.07,-1053.43 1984.07,-1053.43 1925.93,-971.43 2151.93,-971.43 2210.07,-1053.43"/>
<text text-anchor="middle" x="2068" y="-1020.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2068" y="-1009.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="2068" y="-998.93" font-family="Arial" font-size="10.00">All GPUs 0&#45;7</text>
</g>
<!-- l2_mha_res&#45;&gt;l2_moe_res -->
<g id="edge110" class="edge">
<title>l2_mha_res&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M2157.33,-1486.17C2535.77,-1484.78 3743.99,-1475.92 3804,-1419.43 3827.09,-1397.69 3811,-1380.13 3811,-1348.43 3811,-1348.43 3811,-1348.43 3811,-1130.43 3811,-1108.87 3820.02,-1096.85 3804,-1082.43 3744.26,-1028.66 2580.28,-1016.59 2192.49,-1014.06"/>
<polygon fill="black" stroke="black" points="2192.38,-1010.56 2182.36,-1013.99 2192.33,-1017.56 2192.38,-1010.56"/>
</g>
<!-- l2_exp0 -->
<g id="node44" class="node">
<title>l2_exp0</title>
<polygon fill="none" stroke="black" points="247.5,-1261.43 32.5,-1261.43 32.5,-1209.43 247.5,-1209.43 247.5,-1261.43"/>
<text text-anchor="middle" x="140" y="-1249.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="140" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="140" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="140" y="-1216.43" font-family="Arial" font-size="10.00">GPU 16</text>
</g>
<!-- l2_gate_16&#45;&gt;l2_exp0 -->
<g id="edge63" class="edge">
<title>l2_gate_16&#45;&gt;l2_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M271.05,-1306.4C246.27,-1293.17 219.14,-1278.69 196.03,-1266.35"/>
<polygon fill="black" stroke="black" points="197.52,-1263.18 187.05,-1261.55 194.23,-1269.35 197.52,-1263.18"/>
<text text-anchor="middle" x="245.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp1 -->
<g id="node45" class="node">
<title>l2_exp1</title>
<polygon fill="none" stroke="black" points="480.5,-1261.43 265.5,-1261.43 265.5,-1209.43 480.5,-1209.43 480.5,-1261.43"/>
<text text-anchor="middle" x="373" y="-1249.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="373" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="373" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="373" y="-1216.43" font-family="Arial" font-size="10.00">GPU 16</text>
</g>
<!-- l2_gate_16&#45;&gt;l2_exp1 -->
<g id="edge65" class="edge">
<title>l2_gate_16&#45;&gt;l2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M355.82,-1306.4C358.64,-1294.93 361.69,-1282.51 364.42,-1271.37"/>
<polygon fill="black" stroke="black" points="367.85,-1272.1 366.83,-1261.55 361.05,-1270.43 367.85,-1272.1"/>
<text text-anchor="middle" x="370.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_16 -->
<g id="node46" class="node">
<title>l2_agg_16</title>
<polygon fill="none" stroke="black" points="475.78,-1172.43 312.28,-1172.43 270.22,-1090.43 433.72,-1090.43 475.78,-1172.43"/>
<text text-anchor="middle" x="373" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="373" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="373" y="-1117.93" font-family="Arial" font-size="10.00">GPU 16</text>
</g>
<!-- l2_exp0&#45;&gt;l2_agg_16 -->
<g id="edge64" class="edge">
<title>l2_exp0&#45;&gt;l2_agg_16</title>
<path fill="none" stroke="black" d="M197.3,-1209.34C227.34,-1196.19 264.55,-1179.9 296.97,-1165.71"/>
<polygon fill="black" stroke="black" points="298.67,-1168.79 306.42,-1161.57 295.86,-1162.38 298.67,-1168.79"/>
</g>
<!-- l2_exp1&#45;&gt;l2_agg_16 -->
<g id="edge66" class="edge">
<title>l2_exp1&#45;&gt;l2_agg_16</title>
<path fill="none" stroke="black" d="M373,-1209.21C373,-1201.07 373,-1191.73 373,-1182.44"/>
<polygon fill="black" stroke="black" points="376.5,-1182.43 373,-1172.43 369.5,-1182.43 376.5,-1182.43"/>
</g>
<!-- l2_agg_16&#45;&gt;l2_moe_res -->
<g id="edge67" class="edge">
<title>l2_agg_16&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M438.71,-1099.54C456.01,-1092.69 474.9,-1086.32 493,-1082.43 769.35,-1022.9 1625.21,-1014.51 1945.42,-1013.49"/>
<polygon fill="black" stroke="black" points="1945.67,-1016.99 1955.66,-1013.46 1945.65,-1009.99 1945.67,-1016.99"/>
</g>
<!-- l2_exp2 -->
<g id="node48" class="node">
<title>l2_exp2</title>
<polygon fill="none" stroke="black" points="720.5,-1261.43 505.5,-1261.43 505.5,-1209.43 720.5,-1209.43 720.5,-1261.43"/>
<text text-anchor="middle" x="613" y="-1249.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="613" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="613" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="613" y="-1216.43" font-family="Arial" font-size="10.00">GPU 17</text>
</g>
<!-- l2_gate_17&#45;&gt;l2_exp2 -->
<g id="edge69" class="edge">
<title>l2_gate_17&#45;&gt;l2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M744.05,-1306.4C719.27,-1293.17 692.14,-1278.69 669.03,-1266.35"/>
<polygon fill="black" stroke="black" points="670.52,-1263.18 660.05,-1261.55 667.23,-1269.35 670.52,-1263.18"/>
<text text-anchor="middle" x="718.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp3 -->
<g id="node49" class="node">
<title>l2_exp3</title>
<polygon fill="none" stroke="black" points="953.5,-1261.43 738.5,-1261.43 738.5,-1209.43 953.5,-1209.43 953.5,-1261.43"/>
<text text-anchor="middle" x="846" y="-1249.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="846" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="846" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="846" y="-1216.43" font-family="Arial" font-size="10.00">GPU 17</text>
</g>
<!-- l2_gate_17&#45;&gt;l2_exp3 -->
<g id="edge71" class="edge">
<title>l2_gate_17&#45;&gt;l2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M828.82,-1306.4C831.64,-1294.93 834.69,-1282.51 837.42,-1271.37"/>
<polygon fill="black" stroke="black" points="840.85,-1272.1 839.83,-1261.55 834.05,-1270.43 840.85,-1272.1"/>
<text text-anchor="middle" x="843.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_17 -->
<g id="node50" class="node">
<title>l2_agg_17</title>
<polygon fill="none" stroke="black" points="948.78,-1172.43 785.28,-1172.43 743.22,-1090.43 906.72,-1090.43 948.78,-1172.43"/>
<text text-anchor="middle" x="846" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="846" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="846" y="-1117.93" font-family="Arial" font-size="10.00">GPU 17</text>
</g>
<!-- l2_exp2&#45;&gt;l2_agg_17 -->
<g id="edge70" class="edge">
<title>l2_exp2&#45;&gt;l2_agg_17</title>
<path fill="none" stroke="black" d="M670.3,-1209.34C700.34,-1196.19 737.55,-1179.9 769.97,-1165.71"/>
<polygon fill="black" stroke="black" points="771.67,-1168.79 779.42,-1161.57 768.86,-1162.38 771.67,-1168.79"/>
</g>
<!-- l2_exp3&#45;&gt;l2_agg_17 -->
<g id="edge72" class="edge">
<title>l2_exp3&#45;&gt;l2_agg_17</title>
<path fill="none" stroke="black" d="M846,-1209.21C846,-1201.07 846,-1191.73 846,-1182.44"/>
<polygon fill="black" stroke="black" points="849.5,-1182.43 846,-1172.43 842.5,-1182.43 849.5,-1182.43"/>
</g>
<!-- l2_agg_17&#45;&gt;l2_moe_res -->
<g id="edge73" class="edge">
<title>l2_agg_17&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M911.76,-1099.77C929.06,-1092.92 947.94,-1086.49 966,-1082.43 1149.76,-1041.04 1700.83,-1022.53 1946.96,-1016.17"/>
<polygon fill="black" stroke="black" points="1947.11,-1019.66 1957.01,-1015.91 1946.93,-1012.67 1947.11,-1019.66"/>
</g>
<!-- l2_exp4 -->
<g id="node52" class="node">
<title>l2_exp4</title>
<polygon fill="none" stroke="black" points="1193.5,-1261.43 978.5,-1261.43 978.5,-1209.43 1193.5,-1209.43 1193.5,-1261.43"/>
<text text-anchor="middle" x="1086" y="-1249.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1086" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1086" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1086" y="-1216.43" font-family="Arial" font-size="10.00">GPU 18</text>
</g>
<!-- l2_gate_18&#45;&gt;l2_exp4 -->
<g id="edge75" class="edge">
<title>l2_gate_18&#45;&gt;l2_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1217.05,-1306.4C1192.27,-1293.17 1165.14,-1278.69 1142.03,-1266.35"/>
<polygon fill="black" stroke="black" points="1143.52,-1263.18 1133.05,-1261.55 1140.23,-1269.35 1143.52,-1263.18"/>
<text text-anchor="middle" x="1191.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp5 -->
<g id="node53" class="node">
<title>l2_exp5</title>
<polygon fill="none" stroke="black" points="1426.5,-1261.43 1211.5,-1261.43 1211.5,-1209.43 1426.5,-1209.43 1426.5,-1261.43"/>
<text text-anchor="middle" x="1319" y="-1249.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1319" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1319" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1319" y="-1216.43" font-family="Arial" font-size="10.00">GPU 18</text>
</g>
<!-- l2_gate_18&#45;&gt;l2_exp5 -->
<g id="edge77" class="edge">
<title>l2_gate_18&#45;&gt;l2_exp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1301.82,-1306.4C1304.64,-1294.93 1307.69,-1282.51 1310.42,-1271.37"/>
<polygon fill="black" stroke="black" points="1313.85,-1272.1 1312.83,-1261.55 1307.05,-1270.43 1313.85,-1272.1"/>
<text text-anchor="middle" x="1316.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_18 -->
<g id="node54" class="node">
<title>l2_agg_18</title>
<polygon fill="none" stroke="black" points="1421.78,-1172.43 1258.28,-1172.43 1216.22,-1090.43 1379.72,-1090.43 1421.78,-1172.43"/>
<text text-anchor="middle" x="1319" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1319" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1319" y="-1117.93" font-family="Arial" font-size="10.00">GPU 18</text>
</g>
<!-- l2_exp4&#45;&gt;l2_agg_18 -->
<g id="edge76" class="edge">
<title>l2_exp4&#45;&gt;l2_agg_18</title>
<path fill="none" stroke="black" d="M1143.3,-1209.34C1173.34,-1196.19 1210.55,-1179.9 1242.97,-1165.71"/>
<polygon fill="black" stroke="black" points="1244.67,-1168.79 1252.42,-1161.57 1241.86,-1162.38 1244.67,-1168.79"/>
</g>
<!-- l2_exp5&#45;&gt;l2_agg_18 -->
<g id="edge78" class="edge">
<title>l2_exp5&#45;&gt;l2_agg_18</title>
<path fill="none" stroke="black" d="M1319,-1209.21C1319,-1201.07 1319,-1191.73 1319,-1182.44"/>
<polygon fill="black" stroke="black" points="1322.5,-1182.43 1319,-1172.43 1315.5,-1182.43 1322.5,-1182.43"/>
</g>
<!-- l2_agg_18&#45;&gt;l2_moe_res -->
<g id="edge79" class="edge">
<title>l2_agg_18&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M1384.9,-1100.35C1402.19,-1093.49 1421.04,-1086.91 1439,-1082.43 1612.42,-1039.09 1819.51,-1022.97 1947.4,-1016.97"/>
<polygon fill="black" stroke="black" points="1947.78,-1020.46 1957.61,-1016.51 1947.46,-1013.47 1947.78,-1020.46"/>
</g>
<!-- l2_exp6 -->
<g id="node56" class="node">
<title>l2_exp6</title>
<polygon fill="none" stroke="black" points="1666.5,-1261.43 1451.5,-1261.43 1451.5,-1209.43 1666.5,-1209.43 1666.5,-1261.43"/>
<text text-anchor="middle" x="1559" y="-1249.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1559" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1559" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1559" y="-1216.43" font-family="Arial" font-size="10.00">GPU 19</text>
</g>
<!-- l2_gate_19&#45;&gt;l2_exp6 -->
<g id="edge81" class="edge">
<title>l2_gate_19&#45;&gt;l2_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1690.05,-1306.4C1665.27,-1293.17 1638.14,-1278.69 1615.03,-1266.35"/>
<polygon fill="black" stroke="black" points="1616.52,-1263.18 1606.05,-1261.55 1613.23,-1269.35 1616.52,-1263.18"/>
<text text-anchor="middle" x="1664.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp7 -->
<g id="node57" class="node">
<title>l2_exp7</title>
<polygon fill="none" stroke="black" points="1899.5,-1261.43 1684.5,-1261.43 1684.5,-1209.43 1899.5,-1209.43 1899.5,-1261.43"/>
<text text-anchor="middle" x="1792" y="-1249.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1792" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1792" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1792" y="-1216.43" font-family="Arial" font-size="10.00">GPU 19</text>
</g>
<!-- l2_gate_19&#45;&gt;l2_exp7 -->
<g id="edge83" class="edge">
<title>l2_gate_19&#45;&gt;l2_exp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1774.82,-1306.4C1777.64,-1294.93 1780.69,-1282.51 1783.42,-1271.37"/>
<polygon fill="black" stroke="black" points="1786.85,-1272.1 1785.83,-1261.55 1780.05,-1270.43 1786.85,-1272.1"/>
<text text-anchor="middle" x="1789.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_19 -->
<g id="node58" class="node">
<title>l2_agg_19</title>
<polygon fill="none" stroke="black" points="1894.78,-1172.43 1731.28,-1172.43 1689.22,-1090.43 1852.72,-1090.43 1894.78,-1172.43"/>
<text text-anchor="middle" x="1792" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1792" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1792" y="-1117.93" font-family="Arial" font-size="10.00">GPU 19</text>
</g>
<!-- l2_exp6&#45;&gt;l2_agg_19 -->
<g id="edge82" class="edge">
<title>l2_exp6&#45;&gt;l2_agg_19</title>
<path fill="none" stroke="black" d="M1616.3,-1209.34C1646.34,-1196.19 1683.55,-1179.9 1715.97,-1165.71"/>
<polygon fill="black" stroke="black" points="1717.67,-1168.79 1725.42,-1161.57 1714.86,-1162.38 1717.67,-1168.79"/>
</g>
<!-- l2_exp7&#45;&gt;l2_agg_19 -->
<g id="edge84" class="edge">
<title>l2_exp7&#45;&gt;l2_agg_19</title>
<path fill="none" stroke="black" d="M1792,-1209.21C1792,-1201.07 1792,-1191.73 1792,-1182.44"/>
<polygon fill="black" stroke="black" points="1795.5,-1182.43 1792,-1172.43 1788.5,-1182.43 1795.5,-1182.43"/>
</g>
<!-- l2_agg_19&#45;&gt;l2_moe_res -->
<g id="edge85" class="edge">
<title>l2_agg_19&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M1858.81,-1102.1C1892.79,-1087.7 1934.69,-1069.94 1972.04,-1054.1"/>
<polygon fill="black" stroke="black" points="1973.59,-1057.25 1981.44,-1050.12 1970.86,-1050.8 1973.59,-1057.25"/>
</g>
<!-- l2_exp8 -->
<g id="node60" class="node">
<title>l2_exp8</title>
<polygon fill="none" stroke="black" points="2139.5,-1261.43 1924.5,-1261.43 1924.5,-1209.43 2139.5,-1209.43 2139.5,-1261.43"/>
<text text-anchor="middle" x="2032" y="-1249.43" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2032" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2032" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2032" y="-1216.43" font-family="Arial" font-size="10.00">GPU 20</text>
</g>
<!-- l2_gate_20&#45;&gt;l2_exp8 -->
<g id="edge87" class="edge">
<title>l2_gate_20&#45;&gt;l2_exp8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2049.18,-1306.4C2046.36,-1294.93 2043.31,-1282.51 2040.58,-1271.37"/>
<polygon fill="black" stroke="black" points="2043.95,-1270.43 2038.17,-1261.55 2037.15,-1272.1 2043.95,-1270.43"/>
<text text-anchor="middle" x="2053.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp9 -->
<g id="node61" class="node">
<title>l2_exp9</title>
<polygon fill="none" stroke="black" points="2372.5,-1261.43 2157.5,-1261.43 2157.5,-1209.43 2372.5,-1209.43 2372.5,-1261.43"/>
<text text-anchor="middle" x="2265" y="-1249.43" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="2265" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2265" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2265" y="-1216.43" font-family="Arial" font-size="10.00">GPU 20</text>
</g>
<!-- l2_gate_20&#45;&gt;l2_exp9 -->
<g id="edge89" class="edge">
<title>l2_gate_20&#45;&gt;l2_exp9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2133.95,-1306.4C2158.73,-1293.17 2185.86,-1278.69 2208.97,-1266.35"/>
<polygon fill="black" stroke="black" points="2210.77,-1269.35 2217.95,-1261.55 2207.48,-1263.18 2210.77,-1269.35"/>
<text text-anchor="middle" x="2189.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_20 -->
<g id="node62" class="node">
<title>l2_agg_20</title>
<polygon fill="none" stroke="black" points="2170.78,-1172.43 2007.28,-1172.43 1965.22,-1090.43 2128.72,-1090.43 2170.78,-1172.43"/>
<text text-anchor="middle" x="2068" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2068" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2068" y="-1117.93" font-family="Arial" font-size="10.00">GPU 20</text>
</g>
<!-- l2_exp8&#45;&gt;l2_agg_20 -->
<g id="edge88" class="edge">
<title>l2_exp8&#45;&gt;l2_agg_20</title>
<path fill="none" stroke="black" d="M2040.9,-1209.21C2043.8,-1200.98 2047.14,-1191.53 2050.45,-1182.14"/>
<polygon fill="black" stroke="black" points="2053.85,-1183.03 2053.88,-1172.43 2047.25,-1180.7 2053.85,-1183.03"/>
</g>
<!-- l2_exp9&#45;&gt;l2_agg_20 -->
<g id="edge90" class="edge">
<title>l2_exp9&#45;&gt;l2_agg_20</title>
<path fill="none" stroke="black" d="M2216.56,-1209.34C2197.82,-1199.64 2175.78,-1188.23 2154.51,-1177.22"/>
<polygon fill="black" stroke="black" points="2155.94,-1174.02 2145.45,-1172.53 2152.72,-1180.23 2155.94,-1174.02"/>
</g>
<!-- l2_agg_20&#45;&gt;l2_moe_res -->
<g id="edge91" class="edge">
<title>l2_agg_20&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M2068,-1090.16C2068,-1081.7 2068,-1072.68 2068,-1063.91"/>
<polygon fill="black" stroke="black" points="2071.5,-1063.77 2068,-1053.77 2064.5,-1063.77 2071.5,-1063.77"/>
</g>
<!-- l2_exp10 -->
<g id="node64" class="node">
<title>l2_exp10</title>
<polygon fill="none" stroke="black" points="2612.5,-1261.43 2397.5,-1261.43 2397.5,-1209.43 2612.5,-1209.43 2612.5,-1261.43"/>
<text text-anchor="middle" x="2505" y="-1249.43" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="2505" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2505" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2505" y="-1216.43" font-family="Arial" font-size="10.00">GPU 21</text>
</g>
<!-- l2_gate_21&#45;&gt;l2_exp10 -->
<g id="edge93" class="edge">
<title>l2_gate_21&#45;&gt;l2_exp10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2522.18,-1306.4C2519.36,-1294.93 2516.31,-1282.51 2513.58,-1271.37"/>
<polygon fill="black" stroke="black" points="2516.95,-1270.43 2511.17,-1261.55 2510.15,-1272.1 2516.95,-1270.43"/>
<text text-anchor="middle" x="2526.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp11 -->
<g id="node65" class="node">
<title>l2_exp11</title>
<polygon fill="none" stroke="black" points="2845.5,-1261.43 2630.5,-1261.43 2630.5,-1209.43 2845.5,-1209.43 2845.5,-1261.43"/>
<text text-anchor="middle" x="2738" y="-1249.43" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="2738" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2738" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2738" y="-1216.43" font-family="Arial" font-size="10.00">GPU 21</text>
</g>
<!-- l2_gate_21&#45;&gt;l2_exp11 -->
<g id="edge95" class="edge">
<title>l2_gate_21&#45;&gt;l2_exp11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2606.95,-1306.4C2631.73,-1293.17 2658.86,-1278.69 2681.97,-1266.35"/>
<polygon fill="black" stroke="black" points="2683.77,-1269.35 2690.95,-1261.55 2680.48,-1263.18 2683.77,-1269.35"/>
<text text-anchor="middle" x="2662.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_21 -->
<g id="node66" class="node">
<title>l2_agg_21</title>
<polygon fill="none" stroke="black" points="2607.78,-1172.43 2444.28,-1172.43 2402.22,-1090.43 2565.72,-1090.43 2607.78,-1172.43"/>
<text text-anchor="middle" x="2505" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2505" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2505" y="-1117.93" font-family="Arial" font-size="10.00">GPU 21</text>
</g>
<!-- l2_exp10&#45;&gt;l2_agg_21 -->
<g id="edge94" class="edge">
<title>l2_exp10&#45;&gt;l2_agg_21</title>
<path fill="none" stroke="black" d="M2505,-1209.21C2505,-1201.07 2505,-1191.73 2505,-1182.44"/>
<polygon fill="black" stroke="black" points="2508.5,-1182.43 2505,-1172.43 2501.5,-1182.43 2508.5,-1182.43"/>
</g>
<!-- l2_exp11&#45;&gt;l2_agg_21 -->
<g id="edge96" class="edge">
<title>l2_exp11&#45;&gt;l2_agg_21</title>
<path fill="none" stroke="black" d="M2680.7,-1209.34C2658.14,-1199.47 2631.55,-1187.82 2605.97,-1176.63"/>
<polygon fill="black" stroke="black" points="2607.16,-1173.33 2596.6,-1172.53 2604.36,-1179.74 2607.16,-1173.33"/>
</g>
<!-- l2_agg_21&#45;&gt;l2_moe_res -->
<g id="edge97" class="edge">
<title>l2_agg_21&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M2408.89,-1090.37C2400.87,-1087.52 2392.83,-1084.83 2385,-1082.43 2327.98,-1064.95 2263.89,-1050.12 2208.34,-1038.75"/>
<polygon fill="black" stroke="black" points="2208.92,-1035.3 2198.43,-1036.74 2207.53,-1042.16 2208.92,-1035.3"/>
</g>
<!-- l2_exp12 -->
<g id="node68" class="node">
<title>l2_exp12</title>
<polygon fill="none" stroke="black" points="3085.5,-1261.43 2870.5,-1261.43 2870.5,-1209.43 3085.5,-1209.43 3085.5,-1261.43"/>
<text text-anchor="middle" x="2978" y="-1249.43" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="2978" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2978" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2978" y="-1216.43" font-family="Arial" font-size="10.00">GPU 22</text>
</g>
<!-- l2_gate_22&#45;&gt;l2_exp12 -->
<g id="edge99" class="edge">
<title>l2_gate_22&#45;&gt;l2_exp12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2995.18,-1306.4C2992.36,-1294.93 2989.31,-1282.51 2986.58,-1271.37"/>
<polygon fill="black" stroke="black" points="2989.95,-1270.43 2984.17,-1261.55 2983.15,-1272.1 2989.95,-1270.43"/>
<text text-anchor="middle" x="2999.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp13 -->
<g id="node69" class="node">
<title>l2_exp13</title>
<polygon fill="none" stroke="black" points="3318.5,-1261.43 3103.5,-1261.43 3103.5,-1209.43 3318.5,-1209.43 3318.5,-1261.43"/>
<text text-anchor="middle" x="3211" y="-1249.43" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="3211" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3211" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3211" y="-1216.43" font-family="Arial" font-size="10.00">GPU 22</text>
</g>
<!-- l2_gate_22&#45;&gt;l2_exp13 -->
<g id="edge101" class="edge">
<title>l2_gate_22&#45;&gt;l2_exp13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3079.95,-1306.4C3104.73,-1293.17 3131.86,-1278.69 3154.97,-1266.35"/>
<polygon fill="black" stroke="black" points="3156.77,-1269.35 3163.95,-1261.55 3153.48,-1263.18 3156.77,-1269.35"/>
<text text-anchor="middle" x="3135.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_22 -->
<g id="node70" class="node">
<title>l2_agg_22</title>
<polygon fill="none" stroke="black" points="3080.78,-1172.43 2917.28,-1172.43 2875.22,-1090.43 3038.72,-1090.43 3080.78,-1172.43"/>
<text text-anchor="middle" x="2978" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2978" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2978" y="-1117.93" font-family="Arial" font-size="10.00">GPU 22</text>
</g>
<!-- l2_exp12&#45;&gt;l2_agg_22 -->
<g id="edge100" class="edge">
<title>l2_exp12&#45;&gt;l2_agg_22</title>
<path fill="none" stroke="black" d="M2978,-1209.21C2978,-1201.07 2978,-1191.73 2978,-1182.44"/>
<polygon fill="black" stroke="black" points="2981.5,-1182.43 2978,-1172.43 2974.5,-1182.43 2981.5,-1182.43"/>
</g>
<!-- l2_exp13&#45;&gt;l2_agg_22 -->
<g id="edge102" class="edge">
<title>l2_exp13&#45;&gt;l2_agg_22</title>
<path fill="none" stroke="black" d="M3153.7,-1209.34C3131.14,-1199.47 3104.55,-1187.82 3078.97,-1176.63"/>
<polygon fill="black" stroke="black" points="3080.16,-1173.33 3069.6,-1172.53 3077.36,-1179.74 3080.16,-1173.33"/>
</g>
<!-- l2_agg_22&#45;&gt;l2_moe_res -->
<g id="edge103" class="edge">
<title>l2_agg_22&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M2885.52,-1090.35C2876.33,-1087.3 2867.06,-1084.58 2858,-1082.43 2627.02,-1027.41 2348.71,-1015.21 2191.68,-1013.1"/>
<polygon fill="black" stroke="black" points="2191.55,-1009.6 2181.51,-1012.98 2191.47,-1016.6 2191.55,-1009.6"/>
</g>
<!-- l2_exp14 -->
<g id="node72" class="node">
<title>l2_exp14</title>
<polygon fill="none" stroke="black" points="3558.5,-1261.43 3343.5,-1261.43 3343.5,-1209.43 3558.5,-1209.43 3558.5,-1261.43"/>
<text text-anchor="middle" x="3451" y="-1249.43" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="3451" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3451" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3451" y="-1216.43" font-family="Arial" font-size="10.00">GPU 23</text>
</g>
<!-- l2_gate_23&#45;&gt;l2_exp14 -->
<g id="edge105" class="edge">
<title>l2_gate_23&#45;&gt;l2_exp14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3468.18,-1306.4C3465.36,-1294.93 3462.31,-1282.51 3459.58,-1271.37"/>
<polygon fill="black" stroke="black" points="3462.95,-1270.43 3457.17,-1261.55 3456.15,-1272.1 3462.95,-1270.43"/>
<text text-anchor="middle" x="3472.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_exp15 -->
<g id="node73" class="node">
<title>l2_exp15</title>
<polygon fill="none" stroke="black" points="3791.5,-1261.43 3576.5,-1261.43 3576.5,-1209.43 3791.5,-1209.43 3791.5,-1261.43"/>
<text text-anchor="middle" x="3684" y="-1249.43" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="3684" y="-1238.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3684" y="-1227.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3684" y="-1216.43" font-family="Arial" font-size="10.00">GPU 23</text>
</g>
<!-- l2_gate_23&#45;&gt;l2_exp15 -->
<g id="edge107" class="edge">
<title>l2_gate_23&#45;&gt;l2_exp15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3543.72,-1306.39C3559.38,-1297.24 3576.15,-1287.76 3592,-1279.43 3600.66,-1274.87 3609.89,-1270.27 3619.03,-1265.86"/>
<polygon fill="black" stroke="black" points="3620.61,-1268.98 3628.13,-1261.51 3617.59,-1262.67 3620.61,-1268.98"/>
<text text-anchor="middle" x="3601.5" y="-1282.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l2_agg_23 -->
<g id="node74" class="node">
<title>l2_agg_23</title>
<polygon fill="none" stroke="black" points="3553.78,-1172.43 3390.28,-1172.43 3348.22,-1090.43 3511.72,-1090.43 3553.78,-1172.43"/>
<text text-anchor="middle" x="3451" y="-1139.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3451" y="-1128.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="3451" y="-1117.93" font-family="Arial" font-size="10.00">GPU 23</text>
</g>
<!-- l2_exp14&#45;&gt;l2_agg_23 -->
<g id="edge106" class="edge">
<title>l2_exp14&#45;&gt;l2_agg_23</title>
<path fill="none" stroke="black" d="M3451,-1209.21C3451,-1201.07 3451,-1191.73 3451,-1182.44"/>
<polygon fill="black" stroke="black" points="3454.5,-1182.43 3451,-1172.43 3447.5,-1182.43 3454.5,-1182.43"/>
</g>
<!-- l2_exp15&#45;&gt;l2_agg_23 -->
<g id="edge108" class="edge">
<title>l2_exp15&#45;&gt;l2_agg_23</title>
<path fill="none" stroke="black" d="M3619.2,-1209.38C3604.9,-1203.65 3589.88,-1197.46 3576,-1191.43 3565.34,-1186.79 3554.24,-1181.8 3543.24,-1176.75"/>
<polygon fill="black" stroke="black" points="3544.59,-1173.52 3534.05,-1172.5 3541.66,-1179.88 3544.59,-1173.52"/>
</g>
<!-- l2_agg_23&#45;&gt;l2_moe_res -->
<g id="edge109" class="edge">
<title>l2_agg_23&#45;&gt;l2_moe_res</title>
<path fill="none" stroke="black" d="M3359.59,-1090.36C3350.06,-1087.25 3340.42,-1084.51 3331,-1082.43 3116.81,-1035.08 2467.74,-1019.61 2192.99,-1015.1"/>
<polygon fill="black" stroke="black" points="2193.03,-1011.6 2182.98,-1014.94 2192.92,-1018.6 2193.03,-1011.6"/>
</g>
<!-- l3_mha_qkv -->
<g id="node76" class="node">
<title>l3_mha_qkv</title>
<polygon fill="none" stroke="black" points="2149.5,-913.43 1986.5,-913.43 1986.5,-872.43 2149.5,-872.43 2149.5,-913.43"/>
<text text-anchor="middle" x="2068" y="-901.43" font-family="Arial" font-size="10.00">MHA QKV Linear</text>
<text text-anchor="middle" x="2068" y="-890.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 3×16×512]</text>
<text text-anchor="middle" x="2068" y="-879.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 8&#45;15</text>
</g>
<!-- l2_moe_res&#45;&gt;l3_mha_qkv -->
<g id="edge111" class="edge">
<title>l2_moe_res&#45;&gt;l3_mha_qkv</title>
<path fill="none" stroke="black" d="M2068,-971.32C2068,-955.74 2068,-938.22 2068,-923.79"/>
<polygon fill="black" stroke="black" points="2071.5,-923.44 2068,-913.44 2064.5,-923.44 2071.5,-923.44"/>
</g>
<!-- l3_mha_attn -->
<g id="node77" class="node">
<title>l3_mha_attn</title>
<polygon fill="none" stroke="black" points="2055.5,-835.43 1930.5,-835.43 1930.5,-794.43 2055.5,-794.43 2055.5,-835.43"/>
<text text-anchor="middle" x="1993" y="-823.43" font-family="Arial" font-size="10.00">MHA Attention</text>
<text text-anchor="middle" x="1993" y="-812.43" font-family="Arial" font-size="10.00">[1024, 16×512]</text>
<text text-anchor="middle" x="1993" y="-801.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 8&#45;15</text>
</g>
<!-- l3_mha_qkv&#45;&gt;l3_mha_attn -->
<g id="edge112" class="edge">
<title>l3_mha_qkv&#45;&gt;l3_mha_attn</title>
<path fill="none" stroke="black" d="M2048.69,-872.35C2039.76,-863.31 2029.03,-852.43 2019.37,-842.65"/>
<polygon fill="black" stroke="black" points="2021.76,-840.09 2012.25,-835.43 2016.78,-845.01 2021.76,-840.09"/>
</g>
<!-- l3_mha_res -->
<g id="node79" class="node">
<title>l3_mha_res</title>
<polygon fill="none" stroke="black" points="2176.07,-679.43 1950.07,-679.43 1891.93,-597.43 2117.93,-597.43 2176.07,-679.43"/>
<text text-anchor="middle" x="2034" y="-646.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2034" y="-635.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="2034" y="-624.93" font-family="Arial" font-size="10.00">All GPUs 8&#45;15</text>
</g>
<!-- l3_mha_qkv&#45;&gt;l3_mha_res -->
<g id="edge115" class="edge">
<title>l3_mha_qkv&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M2070.62,-872.17C2074.4,-839.4 2079.7,-771.88 2068,-716.43 2066.07,-707.29 2062.99,-697.92 2059.45,-689"/>
<polygon fill="black" stroke="black" points="2062.57,-687.38 2055.46,-679.53 2056.12,-690.1 2062.57,-687.38"/>
</g>
<!-- l3_mha_out -->
<g id="node78" class="node">
<title>l3_mha_out</title>
<polygon fill="none" stroke="black" points="2059,-757.43 1919,-757.43 1919,-716.43 2059,-716.43 2059,-757.43"/>
<text text-anchor="middle" x="1989" y="-745.43" font-family="Arial" font-size="10.00">MHA Output Linear</text>
<text text-anchor="middle" x="1989" y="-734.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 8192]</text>
<text text-anchor="middle" x="1989" y="-723.43" font-family="Arial" font-size="10.00">TP=8 across GPUs 8&#45;15</text>
</g>
<!-- l3_mha_attn&#45;&gt;l3_mha_out -->
<g id="edge113" class="edge">
<title>l3_mha_attn&#45;&gt;l3_mha_out</title>
<path fill="none" stroke="black" d="M1991.97,-794.35C1991.54,-786.2 1991.03,-776.55 1990.56,-767.56"/>
<polygon fill="black" stroke="black" points="1994.05,-767.23 1990.03,-757.43 1987.06,-767.6 1994.05,-767.23"/>
</g>
<!-- l3_mha_out&#45;&gt;l3_mha_res -->
<g id="edge114" class="edge">
<title>l3_mha_out&#45;&gt;l3_mha_res</title>
<path fill="none" stroke="black" d="M1998.11,-716.4C2001.84,-708.39 2006.35,-698.71 2010.9,-688.97"/>
<polygon fill="black" stroke="black" points="2014.19,-690.19 2015.24,-679.65 2007.84,-687.24 2014.19,-690.19"/>
</g>
<!-- l3_gate_24 -->
<g id="node80" class="node">
<title>l3_gate_24</title>
<polygon fill="none" stroke="black" points="480.56,-539.43 266.51,-539.43 211.44,-457.43 425.49,-457.43 480.56,-539.43"/>
<text text-anchor="middle" x="346" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="346" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="346" y="-484.93" font-family="Arial" font-size="10.00">GPU 24</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_24 -->
<g id="edge116" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_24</title>
<path fill="none" stroke="black" d="M1918.42,-635.18C1582.42,-628.15 621.22,-604.98 484,-570.43 460.43,-564.49 436.16,-554.57 414.64,-543.99"/>
<polygon fill="black" stroke="black" points="416.1,-540.81 405.59,-539.43 412.94,-547.06 416.1,-540.81"/>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_24 -->
<g id="edge117" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_24</title>
<path fill="none" stroke="black" d="M1918.37,-635.01C1585.13,-627.78 638.13,-604.71 502,-570.43 478.33,-564.46 453.94,-554.48 431.66,-543.85"/>
<polygon fill="black" stroke="black" points="433.11,-540.66 422.58,-539.43 430.04,-546.95 433.11,-540.66"/>
</g>
<!-- l3_gate_25 -->
<g id="node84" class="node">
<title>l3_gate_25</title>
<polygon fill="none" stroke="black" points="953.56,-539.43 739.51,-539.43 684.44,-457.43 898.49,-457.43 953.56,-539.43"/>
<text text-anchor="middle" x="819" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="819" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="819" y="-484.93" font-family="Arial" font-size="10.00">GPU 25</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_25 -->
<g id="edge123" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_25</title>
<path fill="none" stroke="black" d="M2028.46,-597.21C2025.6,-589.87 2021.33,-583.08 2015,-578.43 2003.26,-569.8 980.19,-573.73 966,-570.43 941.98,-564.83 917.31,-554.84 895.2,-544.08"/>
<polygon fill="black" stroke="black" points="896.73,-540.93 886.22,-539.6 893.6,-547.2 896.73,-540.93"/>
</g>
<!-- l3_gate_26 -->
<g id="node88" class="node">
<title>l3_gate_26</title>
<polygon fill="none" stroke="black" points="1426.56,-539.43 1212.51,-539.43 1157.44,-457.43 1371.49,-457.43 1426.56,-539.43"/>
<text text-anchor="middle" x="1292" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1292" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1292" y="-484.93" font-family="Arial" font-size="10.00">GPU 26</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_26 -->
<g id="edge129" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_26</title>
<path fill="none" stroke="black" d="M2033.3,-597.24C2031.28,-590 2027.8,-583.23 2022,-578.43 2009.53,-568.09 1454.76,-574.15 1439,-570.43 1415,-564.76 1390.33,-554.74 1368.22,-543.99"/>
<polygon fill="black" stroke="black" points="1369.75,-540.84 1359.24,-539.51 1366.63,-547.1 1369.75,-540.84"/>
</g>
<!-- l3_gate_27 -->
<g id="node92" class="node">
<title>l3_gate_27</title>
<polygon fill="none" stroke="black" points="1899.56,-539.43 1685.51,-539.43 1630.44,-457.43 1844.49,-457.43 1899.56,-539.43"/>
<text text-anchor="middle" x="1765" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="1765" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="1765" y="-484.93" font-family="Arial" font-size="10.00">GPU 27</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_27 -->
<g id="edge135" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_27</title>
<path fill="none" stroke="black" d="M2038.04,-597.24C2036.83,-590.17 2034.13,-583.47 2029,-578.43 2019.71,-569.29 1924.6,-573.77 1912,-570.43 1888.87,-564.29 1865,-554.48 1843.41,-544.09"/>
<polygon fill="black" stroke="black" points="1844.81,-540.88 1834.3,-539.61 1841.72,-547.16 1844.81,-540.88"/>
</g>
<!-- l3_gate_28 -->
<g id="node96" class="node">
<title>l3_gate_28</title>
<polygon fill="none" stroke="black" points="2193.56,-539.43 1979.51,-539.43 1924.44,-457.43 2138.49,-457.43 2193.56,-539.43"/>
<text text-anchor="middle" x="2059" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2059" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2059" y="-484.93" font-family="Arial" font-size="10.00">GPU 28</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_28 -->
<g id="edge141" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_28</title>
<path fill="none" stroke="black" d="M2041.3,-597.14C2043.99,-582.26 2047.08,-565.21 2049.92,-549.57"/>
<polygon fill="black" stroke="black" points="2053.4,-549.99 2051.74,-539.52 2046.51,-548.74 2053.4,-549.99"/>
</g>
<!-- l3_gate_29 -->
<g id="node100" class="node">
<title>l3_gate_29</title>
<polygon fill="none" stroke="black" points="2666.56,-539.43 2452.51,-539.43 2397.44,-457.43 2611.49,-457.43 2666.56,-539.43"/>
<text text-anchor="middle" x="2532" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="2532" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="2532" y="-484.93" font-family="Arial" font-size="10.00">GPU 29</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_29 -->
<g id="edge147" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_29</title>
<path fill="none" stroke="black" d="M2137.55,-624.92C2208.42,-614.61 2303.86,-597.25 2385,-570.43 2406.57,-563.3 2429.03,-553.67 2449.73,-543.82"/>
<polygon fill="black" stroke="black" points="2451.31,-546.94 2458.79,-539.43 2448.26,-540.64 2451.31,-546.94"/>
</g>
<!-- l3_gate_30 -->
<g id="node104" class="node">
<title>l3_gate_30</title>
<polygon fill="none" stroke="black" points="3139.56,-539.43 2925.51,-539.43 2870.44,-457.43 3084.49,-457.43 3139.56,-539.43"/>
<text text-anchor="middle" x="3005" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3005" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3005" y="-484.93" font-family="Arial" font-size="10.00">GPU 30</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_30 -->
<g id="edge153" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_30</title>
<path fill="none" stroke="black" d="M2143.83,-633.5C2336.26,-625.78 2726.43,-606.21 2858,-570.43 2880.97,-564.18 2904.7,-554.39 2926.2,-544.05"/>
<polygon fill="black" stroke="black" points="2927.84,-547.14 2935.28,-539.59 2924.76,-540.86 2927.84,-547.14"/>
</g>
<!-- l3_gate_31 -->
<g id="node108" class="node">
<title>l3_gate_31</title>
<polygon fill="none" stroke="black" points="3612.56,-539.43 3398.51,-539.43 3343.44,-457.43 3557.49,-457.43 3612.56,-539.43"/>
<text text-anchor="middle" x="3478" y="-506.93" font-family="Arial" font-size="10.00">Gate</text>
<text text-anchor="middle" x="3478" y="-495.93" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 16]</text>
<text text-anchor="middle" x="3478" y="-484.93" font-family="Arial" font-size="10.00">GPU 31</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_gate_31 -->
<g id="edge159" class="edge">
<title>l3_mha_res&#45;&gt;l3_gate_31</title>
<path fill="none" stroke="black" d="M2146.23,-637.32C2418.58,-636.14 3108.48,-627.43 3331,-570.43 3354.42,-564.43 3378.56,-554.54 3400.33,-544.02"/>
<polygon fill="black" stroke="black" points="3402.1,-547.06 3409.51,-539.49 3399,-540.78 3402.1,-547.06"/>
</g>
<!-- l3_moe_res -->
<g id="node112" class="node">
<title>l3_moe_res</title>
<polygon fill="none" stroke="black" points="2290.07,-204.43 2064.07,-204.43 2005.93,-122.43 2231.93,-122.43 2290.07,-204.43"/>
<text text-anchor="middle" x="2148" y="-171.93" font-family="Arial" font-size="10.00">Residual Add</text>
<text text-anchor="middle" x="2148" y="-160.93" font-family="Arial" font-size="10.00">[1024, 8192] + [1024, 8192]</text>
<text text-anchor="middle" x="2148" y="-149.93" font-family="Arial" font-size="10.00">All GPUs 8&#45;15</text>
</g>
<!-- l3_mha_res&#45;&gt;l3_moe_res -->
<g id="edge165" class="edge">
<title>l3_mha_res&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M2146.37,-637.2C2526.43,-635.9 3743.58,-627.3 3804,-570.43 3827.09,-548.69 3811,-531.13 3811,-499.43 3811,-499.43 3811,-499.43 3811,-281.43 3811,-259.87 3820.01,-247.86 3804,-233.43 3747.35,-182.34 2648.17,-168.54 2272.57,-165.31"/>
<polygon fill="black" stroke="black" points="2272.51,-161.81 2262.48,-165.23 2272.45,-168.81 2272.51,-161.81"/>
</g>
<!-- l3_exp0 -->
<g id="node81" class="node">
<title>l3_exp0</title>
<polygon fill="none" stroke="black" points="247.5,-412.43 32.5,-412.43 32.5,-360.43 247.5,-360.43 247.5,-412.43"/>
<text text-anchor="middle" x="140" y="-400.43" font-family="Arial" font-size="10.00">Expert 0</text>
<text text-anchor="middle" x="140" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="140" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="140" y="-367.43" font-family="Arial" font-size="10.00">GPU 24</text>
</g>
<!-- l3_gate_24&#45;&gt;l3_exp0 -->
<g id="edge118" class="edge">
<title>l3_gate_24&#45;&gt;l3_exp0</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M271.05,-457.4C246.27,-444.17 219.14,-429.69 196.03,-417.35"/>
<polygon fill="black" stroke="black" points="197.52,-414.18 187.05,-412.55 194.23,-420.35 197.52,-414.18"/>
<text text-anchor="middle" x="245.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp1 -->
<g id="node82" class="node">
<title>l3_exp1</title>
<polygon fill="none" stroke="black" points="480.5,-412.43 265.5,-412.43 265.5,-360.43 480.5,-360.43 480.5,-412.43"/>
<text text-anchor="middle" x="373" y="-400.43" font-family="Arial" font-size="10.00">Expert 1</text>
<text text-anchor="middle" x="373" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="373" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="373" y="-367.43" font-family="Arial" font-size="10.00">GPU 24</text>
</g>
<!-- l3_gate_24&#45;&gt;l3_exp1 -->
<g id="edge120" class="edge">
<title>l3_gate_24&#45;&gt;l3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M355.82,-457.4C358.64,-445.93 361.69,-433.51 364.42,-422.37"/>
<polygon fill="black" stroke="black" points="367.85,-423.1 366.83,-412.55 361.05,-421.43 367.85,-423.1"/>
<text text-anchor="middle" x="370.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_24 -->
<g id="node83" class="node">
<title>l3_agg_24</title>
<polygon fill="none" stroke="black" points="475.78,-323.43 312.28,-323.43 270.22,-241.43 433.72,-241.43 475.78,-323.43"/>
<text text-anchor="middle" x="373" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="373" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="373" y="-268.93" font-family="Arial" font-size="10.00">GPU 24</text>
</g>
<!-- l3_exp0&#45;&gt;l3_agg_24 -->
<g id="edge119" class="edge">
<title>l3_exp0&#45;&gt;l3_agg_24</title>
<path fill="none" stroke="black" d="M197.3,-360.34C227.34,-347.19 264.55,-330.9 296.97,-316.71"/>
<polygon fill="black" stroke="black" points="298.67,-319.79 306.42,-312.57 295.86,-313.38 298.67,-319.79"/>
</g>
<!-- l3_exp1&#45;&gt;l3_agg_24 -->
<g id="edge121" class="edge">
<title>l3_exp1&#45;&gt;l3_agg_24</title>
<path fill="none" stroke="black" d="M373,-360.21C373,-352.07 373,-342.73 373,-333.44"/>
<polygon fill="black" stroke="black" points="376.5,-333.43 373,-323.43 369.5,-333.43 376.5,-333.43"/>
</g>
<!-- l3_agg_24&#45;&gt;l3_moe_res -->
<g id="edge122" class="edge">
<title>l3_agg_24&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M438.7,-250.51C456,-243.67 474.9,-237.3 493,-233.43 785.23,-170.81 1693.88,-164.39 2025.38,-164.19"/>
<polygon fill="black" stroke="black" points="2025.5,-167.69 2035.49,-164.18 2025.49,-160.69 2025.5,-167.69"/>
</g>
<!-- l3_exp2 -->
<g id="node85" class="node">
<title>l3_exp2</title>
<polygon fill="none" stroke="black" points="720.5,-412.43 505.5,-412.43 505.5,-360.43 720.5,-360.43 720.5,-412.43"/>
<text text-anchor="middle" x="613" y="-400.43" font-family="Arial" font-size="10.00">Expert 2</text>
<text text-anchor="middle" x="613" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="613" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="613" y="-367.43" font-family="Arial" font-size="10.00">GPU 25</text>
</g>
<!-- l3_gate_25&#45;&gt;l3_exp2 -->
<g id="edge124" class="edge">
<title>l3_gate_25&#45;&gt;l3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M744.05,-457.4C719.27,-444.17 692.14,-429.69 669.03,-417.35"/>
<polygon fill="black" stroke="black" points="670.52,-414.18 660.05,-412.55 667.23,-420.35 670.52,-414.18"/>
<text text-anchor="middle" x="718.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp3 -->
<g id="node86" class="node">
<title>l3_exp3</title>
<polygon fill="none" stroke="black" points="953.5,-412.43 738.5,-412.43 738.5,-360.43 953.5,-360.43 953.5,-412.43"/>
<text text-anchor="middle" x="846" y="-400.43" font-family="Arial" font-size="10.00">Expert 3</text>
<text text-anchor="middle" x="846" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="846" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="846" y="-367.43" font-family="Arial" font-size="10.00">GPU 25</text>
</g>
<!-- l3_gate_25&#45;&gt;l3_exp3 -->
<g id="edge126" class="edge">
<title>l3_gate_25&#45;&gt;l3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M828.82,-457.4C831.64,-445.93 834.69,-433.51 837.42,-422.37"/>
<polygon fill="black" stroke="black" points="840.85,-423.1 839.83,-412.55 834.05,-421.43 840.85,-423.1"/>
<text text-anchor="middle" x="843.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_25 -->
<g id="node87" class="node">
<title>l3_agg_25</title>
<polygon fill="none" stroke="black" points="948.78,-323.43 785.28,-323.43 743.22,-241.43 906.72,-241.43 948.78,-323.43"/>
<text text-anchor="middle" x="846" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="846" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="846" y="-268.93" font-family="Arial" font-size="10.00">GPU 25</text>
</g>
<!-- l3_exp2&#45;&gt;l3_agg_25 -->
<g id="edge125" class="edge">
<title>l3_exp2&#45;&gt;l3_agg_25</title>
<path fill="none" stroke="black" d="M670.3,-360.34C700.34,-347.19 737.55,-330.9 769.97,-316.71"/>
<polygon fill="black" stroke="black" points="771.67,-319.79 779.42,-312.57 768.86,-313.38 771.67,-319.79"/>
</g>
<!-- l3_exp3&#45;&gt;l3_agg_25 -->
<g id="edge127" class="edge">
<title>l3_exp3&#45;&gt;l3_agg_25</title>
<path fill="none" stroke="black" d="M846,-360.21C846,-352.07 846,-342.73 846,-333.44"/>
<polygon fill="black" stroke="black" points="849.5,-333.43 846,-323.43 842.5,-333.43 849.5,-333.43"/>
</g>
<!-- l3_agg_25&#45;&gt;l3_moe_res -->
<g id="edge128" class="edge">
<title>l3_agg_25&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M911.75,-250.72C929.05,-243.87 947.93,-237.46 966,-233.43 1165.22,-189 1766.69,-171.98 2026.41,-166.58"/>
<polygon fill="black" stroke="black" points="2026.71,-170.07 2036.64,-166.37 2026.57,-163.07 2026.71,-170.07"/>
</g>
<!-- l3_exp4 -->
<g id="node89" class="node">
<title>l3_exp4</title>
<polygon fill="none" stroke="black" points="1193.5,-412.43 978.5,-412.43 978.5,-360.43 1193.5,-360.43 1193.5,-412.43"/>
<text text-anchor="middle" x="1086" y="-400.43" font-family="Arial" font-size="10.00">Expert 4</text>
<text text-anchor="middle" x="1086" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1086" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1086" y="-367.43" font-family="Arial" font-size="10.00">GPU 26</text>
</g>
<!-- l3_gate_26&#45;&gt;l3_exp4 -->
<g id="edge130" class="edge">
<title>l3_gate_26&#45;&gt;l3_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1217.05,-457.4C1192.27,-444.17 1165.14,-429.69 1142.03,-417.35"/>
<polygon fill="black" stroke="black" points="1143.52,-414.18 1133.05,-412.55 1140.23,-420.35 1143.52,-414.18"/>
<text text-anchor="middle" x="1191.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp5 -->
<g id="node90" class="node">
<title>l3_exp5</title>
<polygon fill="none" stroke="black" points="1426.5,-412.43 1211.5,-412.43 1211.5,-360.43 1426.5,-360.43 1426.5,-412.43"/>
<text text-anchor="middle" x="1319" y="-400.43" font-family="Arial" font-size="10.00">Expert 5</text>
<text text-anchor="middle" x="1319" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1319" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1319" y="-367.43" font-family="Arial" font-size="10.00">GPU 26</text>
</g>
<!-- l3_gate_26&#45;&gt;l3_exp5 -->
<g id="edge132" class="edge">
<title>l3_gate_26&#45;&gt;l3_exp5</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1301.82,-457.4C1304.64,-445.93 1307.69,-433.51 1310.42,-422.37"/>
<polygon fill="black" stroke="black" points="1313.85,-423.1 1312.83,-412.55 1307.05,-421.43 1313.85,-423.1"/>
<text text-anchor="middle" x="1316.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_26 -->
<g id="node91" class="node">
<title>l3_agg_26</title>
<polygon fill="none" stroke="black" points="1421.78,-323.43 1258.28,-323.43 1216.22,-241.43 1379.72,-241.43 1421.78,-323.43"/>
<text text-anchor="middle" x="1319" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1319" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1319" y="-268.93" font-family="Arial" font-size="10.00">GPU 26</text>
</g>
<!-- l3_exp4&#45;&gt;l3_agg_26 -->
<g id="edge131" class="edge">
<title>l3_exp4&#45;&gt;l3_agg_26</title>
<path fill="none" stroke="black" d="M1143.3,-360.34C1173.34,-347.19 1210.55,-330.9 1242.97,-316.71"/>
<polygon fill="black" stroke="black" points="1244.67,-319.79 1252.42,-312.57 1241.86,-313.38 1244.67,-319.79"/>
</g>
<!-- l3_exp5&#45;&gt;l3_agg_26 -->
<g id="edge133" class="edge">
<title>l3_exp5&#45;&gt;l3_agg_26</title>
<path fill="none" stroke="black" d="M1319,-360.21C1319,-352.07 1319,-342.73 1319,-333.44"/>
<polygon fill="black" stroke="black" points="1322.5,-333.43 1319,-323.43 1315.5,-333.43 1322.5,-333.43"/>
</g>
<!-- l3_agg_26&#45;&gt;l3_moe_res -->
<g id="edge134" class="edge">
<title>l3_agg_26&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M1384.86,-251.2C1402.16,-244.35 1421.01,-237.8 1439,-233.43 1641.13,-184.23 1883.74,-169.89 2026.37,-165.85"/>
<polygon fill="black" stroke="black" points="2026.56,-169.34 2036.46,-165.57 2026.37,-162.35 2026.56,-169.34"/>
</g>
<!-- l3_exp6 -->
<g id="node93" class="node">
<title>l3_exp6</title>
<polygon fill="none" stroke="black" points="1666.5,-412.43 1451.5,-412.43 1451.5,-360.43 1666.5,-360.43 1666.5,-412.43"/>
<text text-anchor="middle" x="1559" y="-400.43" font-family="Arial" font-size="10.00">Expert 6</text>
<text text-anchor="middle" x="1559" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1559" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1559" y="-367.43" font-family="Arial" font-size="10.00">GPU 27</text>
</g>
<!-- l3_gate_27&#45;&gt;l3_exp6 -->
<g id="edge136" class="edge">
<title>l3_gate_27&#45;&gt;l3_exp6</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1690.05,-457.4C1665.27,-444.17 1638.14,-429.69 1615.03,-417.35"/>
<polygon fill="black" stroke="black" points="1616.52,-414.18 1606.05,-412.55 1613.23,-420.35 1616.52,-414.18"/>
<text text-anchor="middle" x="1664.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp7 -->
<g id="node94" class="node">
<title>l3_exp7</title>
<polygon fill="none" stroke="black" points="1899.5,-412.43 1684.5,-412.43 1684.5,-360.43 1899.5,-360.43 1899.5,-412.43"/>
<text text-anchor="middle" x="1792" y="-400.43" font-family="Arial" font-size="10.00">Expert 7</text>
<text text-anchor="middle" x="1792" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="1792" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="1792" y="-367.43" font-family="Arial" font-size="10.00">GPU 27</text>
</g>
<!-- l3_gate_27&#45;&gt;l3_exp7 -->
<g id="edge138" class="edge">
<title>l3_gate_27&#45;&gt;l3_exp7</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1774.82,-457.4C1777.64,-445.93 1780.69,-433.51 1783.42,-422.37"/>
<polygon fill="black" stroke="black" points="1786.85,-423.1 1785.83,-412.55 1780.05,-421.43 1786.85,-423.1"/>
<text text-anchor="middle" x="1789.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_27 -->
<g id="node95" class="node">
<title>l3_agg_27</title>
<polygon fill="none" stroke="black" points="1894.78,-323.43 1731.28,-323.43 1689.22,-241.43 1852.72,-241.43 1894.78,-323.43"/>
<text text-anchor="middle" x="1792" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="1792" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="1792" y="-268.93" font-family="Arial" font-size="10.00">GPU 27</text>
</g>
<!-- l3_exp6&#45;&gt;l3_agg_27 -->
<g id="edge137" class="edge">
<title>l3_exp6&#45;&gt;l3_agg_27</title>
<path fill="none" stroke="black" d="M1616.3,-360.34C1646.34,-347.19 1683.55,-330.9 1715.97,-316.71"/>
<polygon fill="black" stroke="black" points="1717.67,-319.79 1725.42,-312.57 1714.86,-313.38 1717.67,-319.79"/>
</g>
<!-- l3_exp7&#45;&gt;l3_agg_27 -->
<g id="edge139" class="edge">
<title>l3_exp7&#45;&gt;l3_agg_27</title>
<path fill="none" stroke="black" d="M1792,-360.21C1792,-352.07 1792,-342.73 1792,-333.44"/>
<polygon fill="black" stroke="black" points="1795.5,-333.43 1792,-323.43 1788.5,-333.43 1795.5,-333.43"/>
</g>
<!-- l3_agg_27&#45;&gt;l3_moe_res -->
<g id="edge140" class="edge">
<title>l3_agg_27&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M1858.85,-253.37C1876.05,-246.51 1894.61,-239.43 1912,-233.43 1954.68,-218.69 2002.38,-204.35 2043.66,-192.6"/>
<polygon fill="black" stroke="black" points="2044.79,-195.92 2053.46,-189.82 2042.89,-189.18 2044.79,-195.92"/>
</g>
<!-- l3_exp8 -->
<g id="node97" class="node">
<title>l3_exp8</title>
<polygon fill="none" stroke="black" points="2139.5,-412.43 1924.5,-412.43 1924.5,-360.43 2139.5,-360.43 2139.5,-412.43"/>
<text text-anchor="middle" x="2032" y="-400.43" font-family="Arial" font-size="10.00">Expert 8</text>
<text text-anchor="middle" x="2032" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2032" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2032" y="-367.43" font-family="Arial" font-size="10.00">GPU 28</text>
</g>
<!-- l3_gate_28&#45;&gt;l3_exp8 -->
<g id="edge142" class="edge">
<title>l3_gate_28&#45;&gt;l3_exp8</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2049.18,-457.4C2046.36,-445.93 2043.31,-433.51 2040.58,-422.37"/>
<polygon fill="black" stroke="black" points="2043.95,-421.43 2038.17,-412.55 2037.15,-423.1 2043.95,-421.43"/>
<text text-anchor="middle" x="2053.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp9 -->
<g id="node98" class="node">
<title>l3_exp9</title>
<polygon fill="none" stroke="black" points="2372.5,-412.43 2157.5,-412.43 2157.5,-360.43 2372.5,-360.43 2372.5,-412.43"/>
<text text-anchor="middle" x="2265" y="-400.43" font-family="Arial" font-size="10.00">Expert 9</text>
<text text-anchor="middle" x="2265" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2265" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2265" y="-367.43" font-family="Arial" font-size="10.00">GPU 28</text>
</g>
<!-- l3_gate_28&#45;&gt;l3_exp9 -->
<g id="edge144" class="edge">
<title>l3_gate_28&#45;&gt;l3_exp9</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2133.95,-457.4C2158.73,-444.17 2185.86,-429.69 2208.97,-417.35"/>
<polygon fill="black" stroke="black" points="2210.77,-420.35 2217.95,-412.55 2207.48,-414.18 2210.77,-420.35"/>
<text text-anchor="middle" x="2189.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_28 -->
<g id="node99" class="node">
<title>l3_agg_28</title>
<polygon fill="none" stroke="black" points="2250.78,-323.43 2087.28,-323.43 2045.22,-241.43 2208.72,-241.43 2250.78,-323.43"/>
<text text-anchor="middle" x="2148" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2148" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2148" y="-268.93" font-family="Arial" font-size="10.00">GPU 28</text>
</g>
<!-- l3_exp8&#45;&gt;l3_agg_28 -->
<g id="edge143" class="edge">
<title>l3_exp8&#45;&gt;l3_agg_28</title>
<path fill="none" stroke="black" d="M2060.67,-360.21C2071.02,-351.11 2083.06,-340.53 2094.83,-330.18"/>
<polygon fill="black" stroke="black" points="2097.3,-332.66 2102.5,-323.43 2092.68,-327.41 2097.3,-332.66"/>
</g>
<!-- l3_exp9&#45;&gt;l3_agg_28 -->
<g id="edge145" class="edge">
<title>l3_exp9&#45;&gt;l3_agg_28</title>
<path fill="none" stroke="black" d="M2236.08,-360.21C2225.64,-351.11 2213.5,-340.53 2201.63,-330.18"/>
<polygon fill="black" stroke="black" points="2203.73,-327.37 2193.89,-323.43 2199.13,-332.64 2203.73,-327.37"/>
</g>
<!-- l3_agg_28&#45;&gt;l3_moe_res -->
<g id="edge146" class="edge">
<title>l3_agg_28&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M2148,-241.16C2148,-232.7 2148,-223.68 2148,-214.91"/>
<polygon fill="black" stroke="black" points="2151.5,-214.77 2148,-204.77 2144.5,-214.77 2151.5,-214.77"/>
</g>
<!-- l3_exp10 -->
<g id="node101" class="node">
<title>l3_exp10</title>
<polygon fill="none" stroke="black" points="2612.5,-412.43 2397.5,-412.43 2397.5,-360.43 2612.5,-360.43 2612.5,-412.43"/>
<text text-anchor="middle" x="2505" y="-400.43" font-family="Arial" font-size="10.00">Expert 10</text>
<text text-anchor="middle" x="2505" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2505" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2505" y="-367.43" font-family="Arial" font-size="10.00">GPU 29</text>
</g>
<!-- l3_gate_29&#45;&gt;l3_exp10 -->
<g id="edge148" class="edge">
<title>l3_gate_29&#45;&gt;l3_exp10</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2522.18,-457.4C2519.36,-445.93 2516.31,-433.51 2513.58,-422.37"/>
<polygon fill="black" stroke="black" points="2516.95,-421.43 2511.17,-412.55 2510.15,-423.1 2516.95,-421.43"/>
<text text-anchor="middle" x="2526.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp11 -->
<g id="node102" class="node">
<title>l3_exp11</title>
<polygon fill="none" stroke="black" points="2845.5,-412.43 2630.5,-412.43 2630.5,-360.43 2845.5,-360.43 2845.5,-412.43"/>
<text text-anchor="middle" x="2738" y="-400.43" font-family="Arial" font-size="10.00">Expert 11</text>
<text text-anchor="middle" x="2738" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2738" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2738" y="-367.43" font-family="Arial" font-size="10.00">GPU 29</text>
</g>
<!-- l3_gate_29&#45;&gt;l3_exp11 -->
<g id="edge150" class="edge">
<title>l3_gate_29&#45;&gt;l3_exp11</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2606.95,-457.4C2631.73,-444.17 2658.86,-429.69 2681.97,-417.35"/>
<polygon fill="black" stroke="black" points="2683.77,-420.35 2690.95,-412.55 2680.48,-414.18 2683.77,-420.35"/>
<text text-anchor="middle" x="2662.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_29 -->
<g id="node103" class="node">
<title>l3_agg_29</title>
<polygon fill="none" stroke="black" points="2607.78,-323.43 2444.28,-323.43 2402.22,-241.43 2565.72,-241.43 2607.78,-323.43"/>
<text text-anchor="middle" x="2505" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2505" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2505" y="-268.93" font-family="Arial" font-size="10.00">GPU 29</text>
</g>
<!-- l3_exp10&#45;&gt;l3_agg_29 -->
<g id="edge149" class="edge">
<title>l3_exp10&#45;&gt;l3_agg_29</title>
<path fill="none" stroke="black" d="M2505,-360.21C2505,-352.07 2505,-342.73 2505,-333.44"/>
<polygon fill="black" stroke="black" points="2508.5,-333.43 2505,-323.43 2501.5,-333.43 2508.5,-333.43"/>
</g>
<!-- l3_exp11&#45;&gt;l3_agg_29 -->
<g id="edge151" class="edge">
<title>l3_exp11&#45;&gt;l3_agg_29</title>
<path fill="none" stroke="black" d="M2680.7,-360.34C2658.14,-350.47 2631.55,-338.82 2605.97,-327.63"/>
<polygon fill="black" stroke="black" points="2607.16,-324.33 2596.6,-323.53 2604.36,-330.74 2607.16,-324.33"/>
</g>
<!-- l3_agg_29&#45;&gt;l3_moe_res -->
<g id="edge152" class="edge">
<title>l3_agg_29&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M2407.06,-241.35C2399.63,-238.58 2392.21,-235.91 2385,-233.43 2357.43,-223.92 2327.76,-214.6 2299.07,-206.02"/>
<polygon fill="black" stroke="black" points="2299.97,-202.64 2289.38,-203.15 2297.97,-209.35 2299.97,-202.64"/>
</g>
<!-- l3_exp12 -->
<g id="node105" class="node">
<title>l3_exp12</title>
<polygon fill="none" stroke="black" points="3085.5,-412.43 2870.5,-412.43 2870.5,-360.43 3085.5,-360.43 3085.5,-412.43"/>
<text text-anchor="middle" x="2978" y="-400.43" font-family="Arial" font-size="10.00">Expert 12</text>
<text text-anchor="middle" x="2978" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="2978" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="2978" y="-367.43" font-family="Arial" font-size="10.00">GPU 30</text>
</g>
<!-- l3_gate_30&#45;&gt;l3_exp12 -->
<g id="edge154" class="edge">
<title>l3_gate_30&#45;&gt;l3_exp12</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2995.18,-457.4C2992.36,-445.93 2989.31,-433.51 2986.58,-422.37"/>
<polygon fill="black" stroke="black" points="2989.95,-421.43 2984.17,-412.55 2983.15,-423.1 2989.95,-421.43"/>
<text text-anchor="middle" x="2999.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp13 -->
<g id="node106" class="node">
<title>l3_exp13</title>
<polygon fill="none" stroke="black" points="3318.5,-412.43 3103.5,-412.43 3103.5,-360.43 3318.5,-360.43 3318.5,-412.43"/>
<text text-anchor="middle" x="3211" y="-400.43" font-family="Arial" font-size="10.00">Expert 13</text>
<text text-anchor="middle" x="3211" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3211" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3211" y="-367.43" font-family="Arial" font-size="10.00">GPU 30</text>
</g>
<!-- l3_gate_30&#45;&gt;l3_exp13 -->
<g id="edge156" class="edge">
<title>l3_gate_30&#45;&gt;l3_exp13</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3079.95,-457.4C3104.73,-444.17 3131.86,-429.69 3154.97,-417.35"/>
<polygon fill="black" stroke="black" points="3156.77,-420.35 3163.95,-412.55 3153.48,-414.18 3156.77,-420.35"/>
<text text-anchor="middle" x="3135.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_30 -->
<g id="node107" class="node">
<title>l3_agg_30</title>
<polygon fill="none" stroke="black" points="3080.78,-323.43 2917.28,-323.43 2875.22,-241.43 3038.72,-241.43 3080.78,-323.43"/>
<text text-anchor="middle" x="2978" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="2978" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="2978" y="-268.93" font-family="Arial" font-size="10.00">GPU 30</text>
</g>
<!-- l3_exp12&#45;&gt;l3_agg_30 -->
<g id="edge155" class="edge">
<title>l3_exp12&#45;&gt;l3_agg_30</title>
<path fill="none" stroke="black" d="M2978,-360.21C2978,-352.07 2978,-342.73 2978,-333.44"/>
<polygon fill="black" stroke="black" points="2981.5,-333.43 2978,-323.43 2974.5,-333.43 2981.5,-333.43"/>
</g>
<!-- l3_exp13&#45;&gt;l3_agg_30 -->
<g id="edge157" class="edge">
<title>l3_exp13&#45;&gt;l3_agg_30</title>
<path fill="none" stroke="black" d="M3153.7,-360.34C3131.14,-350.47 3104.55,-338.82 3078.97,-327.63"/>
<polygon fill="black" stroke="black" points="3080.16,-324.33 3069.6,-323.53 3077.36,-330.74 3080.16,-324.33"/>
</g>
<!-- l3_agg_30&#45;&gt;l3_moe_res -->
<g id="edge158" class="edge">
<title>l3_agg_30&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M2885.16,-241.33C2876.09,-238.31 2866.94,-235.6 2858,-233.43 2657.05,-184.53 2416.15,-170.06 2272.93,-165.92"/>
<polygon fill="black" stroke="black" points="2272.88,-162.41 2262.79,-165.64 2272.69,-169.41 2272.88,-162.41"/>
</g>
<!-- l3_exp14 -->
<g id="node109" class="node">
<title>l3_exp14</title>
<polygon fill="none" stroke="black" points="3558.5,-412.43 3343.5,-412.43 3343.5,-360.43 3558.5,-360.43 3558.5,-412.43"/>
<text text-anchor="middle" x="3451" y="-400.43" font-family="Arial" font-size="10.00">Expert 14</text>
<text text-anchor="middle" x="3451" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3451" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3451" y="-367.43" font-family="Arial" font-size="10.00">GPU 31</text>
</g>
<!-- l3_gate_31&#45;&gt;l3_exp14 -->
<g id="edge160" class="edge">
<title>l3_gate_31&#45;&gt;l3_exp14</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3468.18,-457.4C3465.36,-445.93 3462.31,-433.51 3459.58,-422.37"/>
<polygon fill="black" stroke="black" points="3462.95,-421.43 3457.17,-412.55 3456.15,-423.1 3462.95,-421.43"/>
<text text-anchor="middle" x="3472.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_exp15 -->
<g id="node110" class="node">
<title>l3_exp15</title>
<polygon fill="none" stroke="black" points="3791.5,-412.43 3576.5,-412.43 3576.5,-360.43 3791.5,-360.43 3791.5,-412.43"/>
<text text-anchor="middle" x="3684" y="-400.43" font-family="Arial" font-size="10.00">Expert 15</text>
<text text-anchor="middle" x="3684" y="-389.43" font-family="Arial" font-size="10.00">MLP</text>
<text text-anchor="middle" x="3684" y="-378.43" font-family="Arial" font-size="10.00">[1024, 8192] → [1024, 32768] → [1024, 8192]</text>
<text text-anchor="middle" x="3684" y="-367.43" font-family="Arial" font-size="10.00">GPU 31</text>
</g>
<!-- l3_gate_31&#45;&gt;l3_exp15 -->
<g id="edge162" class="edge">
<title>l3_gate_31&#45;&gt;l3_exp15</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3543.72,-457.39C3559.38,-448.24 3576.15,-438.76 3592,-430.43 3600.66,-425.87 3609.89,-421.27 3619.03,-416.86"/>
<polygon fill="black" stroke="black" points="3620.61,-419.98 3628.13,-412.51 3617.59,-413.67 3620.61,-419.98"/>
<text text-anchor="middle" x="3601.5" y="-433.03" font-family="Arial" font-size="8.00">route</text>
</g>
<!-- l3_agg_31 -->
<g id="node111" class="node">
<title>l3_agg_31</title>
<polygon fill="none" stroke="black" points="3553.78,-323.43 3390.28,-323.43 3348.22,-241.43 3511.72,-241.43 3553.78,-323.43"/>
<text text-anchor="middle" x="3451" y="-290.93" font-family="Arial" font-size="10.00">Expert Aggregation</text>
<text text-anchor="middle" x="3451" y="-279.93" font-family="Arial" font-size="10.00">[1024, 8192]</text>
<text text-anchor="middle" x="3451" y="-268.93" font-family="Arial" font-size="10.00">GPU 31</text>
</g>
<!-- l3_exp14&#45;&gt;l3_agg_31 -->
<g id="edge161" class="edge">
<title>l3_exp14&#45;&gt;l3_agg_31</title>
<path fill="none" stroke="black" d="M3451,-360.21C3451,-352.07 3451,-342.73 3451,-333.44"/>
<polygon fill="black" stroke="black" points="3454.5,-333.43 3451,-323.43 3447.5,-333.43 3454.5,-333.43"/>
</g>
<!-- l3_exp15&#45;&gt;l3_agg_31 -->
<g id="edge163" class="edge">
<title>l3_exp15&#45;&gt;l3_agg_31</title>
<path fill="none" stroke="black" d="M3619.2,-360.38C3604.9,-354.65 3589.88,-348.46 3576,-342.43 3565.34,-337.79 3554.24,-332.8 3543.24,-327.75"/>
<polygon fill="black" stroke="black" points="3544.59,-324.52 3534.05,-323.5 3541.66,-330.88 3544.59,-324.52"/>
</g>
<!-- l3_agg_31&#45;&gt;l3_moe_res -->
<g id="edge164" class="edge">
<title>l3_agg_31&#45;&gt;l3_moe_res</title>
<path fill="none" stroke="black" d="M3359.58,-241.4C3350.06,-238.27 3340.42,-235.53 3331,-233.43 3132.6,-189.19 2535.6,-172.13 2273.59,-166.65"/>
<polygon fill="black" stroke="black" points="2273.34,-163.15 2263.27,-166.44 2273.2,-170.15 2273.34,-163.15"/>
</g>
<!-- output -->
<g id="node113" class="node">
<title>output</title>
<ellipse fill="none" stroke="black" cx="2148" cy="-37.21" rx="56.64" ry="21.43"/>
<text text-anchor="middle" x="2148" y="-40.21" font-family="Arial" font-size="10.00">Output Tokens</text>
<text text-anchor="middle" x="2148" y="-29.21" font-family="Arial" font-size="10.00">[1024, 8192]</text>
</g>
<!-- l3_moe_res&#45;&gt;output -->
<g id="edge166" class="edge">
<title>l3_moe_res&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2148,-122.1C2148,-104.83 2148,-84.99 2148,-68.94"/>
<polygon fill="black" stroke="black" points="2151.5,-68.52 2148,-58.52 2144.5,-68.52 2151.5,-68.52"/>
</g>
</g>
</svg>
