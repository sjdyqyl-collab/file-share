<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="5086pt" height="3262pt"
 viewBox="0.00 0.00 5086.00 3262.43" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 3258.43)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-3258.43 5082,-3258.43 5082,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="white" stroke="black" stroke-dasharray="5,2" points="2875,-3153.69 2875,-3246.43 3111,-3246.43 3111,-3153.69 2875,-3153.69"/>
<text text-anchor="middle" x="2993" y="-3231.23" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_stage1</title>
<polygon fill="white" stroke="black" points="8,-1682.69 8,-3145.69 5070,-3145.69 5070,-1682.69 8,-1682.69"/>
<text text-anchor="middle" x="2539" y="-3130.49" font-family="Times,serif" font-size="14.00">Pipeline Stage 1 (GPUs 1&#45;8)</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_stage2</title>
<polygon fill="white" stroke="black" points="8,-108.74 8,-1571.74 5070,-1571.74 5070,-108.74 8,-108.74"/>
<text text-anchor="middle" x="2539" y="-1556.54" font-family="Times,serif" font-size="14.00">Pipeline Stage 2 (GPUs 1&#45;8)</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_output</title>
<polygon fill="white" stroke="black" stroke-dasharray="5,2" points="2607,-8 2607,-100.74 2843,-100.74 2843,-8 2607,-8"/>
<text text-anchor="middle" x="2725" y="-85.54" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input_tokens -->
<g id="node1" class="node">
<title>input_tokens</title>
<ellipse fill="lightblue" stroke="black" cx="2993" cy="-3188.56" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2993" y="-3192.36" font-family="Times,serif" font-size="14.00">Input Tokens</text>
<text text-anchor="middle" x="2993" y="-3177.36" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_1_gpu1 -->
<g id="node2" class="node">
<title>mha_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1248.5,-3114.69 1093.5,-3114.69 1093.5,-3061.69 1248.5,-3061.69 1248.5,-3114.69"/>
<text text-anchor="middle" x="1171" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="1171" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1171" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu1 -->
<g id="edge1" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu1</title>
<path fill="none" stroke="black" d="M2883.66,-3185.75C2673.13,-3181.8 2196.95,-3170.72 1797,-3145.69 1604.73,-3133.66 1379.95,-3111.36 1258.93,-3098.67"/>
<polygon fill="black" stroke="black" points="1259.28,-3095.19 1248.97,-3097.62 1258.55,-3102.15 1259.28,-3095.19"/>
</g>
<!-- residual1_1_gpu1 -->
<g id="node3" class="node">
<title>residual1_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1133.5,-3025.69 978.5,-3025.69 978.5,-2972.69 1133.5,-2972.69 1133.5,-3025.69"/>
<text text-anchor="middle" x="1056" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1056" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1056" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu1 -->
<g id="edge3" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu1</title>
<path fill="none" stroke="black" d="M3017.97,-3162.23C3021.67,-3157.12 3024.93,-3151.52 3027,-3145.69 3039.49,-3110.51 3053.09,-3088.4 3027,-3061.69 2997.12,-3031.1 1530.73,-3027.45 1488,-3025.69 1368.68,-3020.78 1230.98,-3012.14 1143.73,-3006.29"/>
<polygon fill="black" stroke="black" points="1143.82,-3002.79 1133.61,-3005.61 1143.35,-3009.77 1143.82,-3002.79"/>
</g>
<!-- mha_1_gpu2 -->
<g id="node11" class="node">
<title>mha_1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1960.5,-3114.69 1805.5,-3114.69 1805.5,-3061.69 1960.5,-3061.69 1960.5,-3114.69"/>
<text text-anchor="middle" x="1883" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="1883" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1883" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu2 -->
<g id="edge15" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu2</title>
<path fill="none" stroke="black" d="M2883.42,-3186.35C2637.22,-3183.16 2055.11,-3172.81 1970,-3145.69 1953.09,-3140.31 1936.31,-3130.69 1922.06,-3120.91"/>
<polygon fill="black" stroke="black" points="1923.71,-3117.79 1913.54,-3114.83 1919.64,-3123.48 1923.71,-3117.79"/>
</g>
<!-- residual1_1_gpu2 -->
<g id="node12" class="node">
<title>residual1_1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1651.5,-3025.69 1496.5,-3025.69 1496.5,-2972.69 1651.5,-2972.69 1651.5,-3025.69"/>
<text text-anchor="middle" x="1574" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1574" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1574" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu2 -->
<g id="edge17" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu2</title>
<path fill="none" stroke="black" d="M3043.34,-3164.43C3050.02,-3159.22 3055.94,-3153.01 3060,-3145.69 3078.1,-3113.04 3085.99,-3088.5 3060,-3061.69 3014.77,-3015.05 1955.88,-3029.3 1891,-3025.69 1813.42,-3021.38 1725.35,-3014.1 1661.76,-3008.43"/>
<polygon fill="black" stroke="black" points="1662.04,-3004.94 1651.77,-3007.53 1661.41,-3011.91 1662.04,-3004.94"/>
</g>
<!-- mha_1_gpu3 -->
<g id="node20" class="node">
<title>mha_1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2133.5,-3114.69 1978.5,-3114.69 1978.5,-3061.69 2133.5,-3061.69 2133.5,-3114.69"/>
<text text-anchor="middle" x="2056" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2056" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="2056" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu3 -->
<g id="edge29" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu3</title>
<path fill="none" stroke="black" d="M2883.3,-3187.95C2689.5,-3187.65 2294.52,-3182.37 2162,-3145.69 2141.63,-3140.06 2120.78,-3130.03 2103.02,-3119.97"/>
<polygon fill="black" stroke="black" points="2104.43,-3116.74 2094.03,-3114.73 2100.91,-3122.79 2104.43,-3116.74"/>
</g>
<!-- residual1_1_gpu3 -->
<g id="node21" class="node">
<title>residual1_1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="2054.5,-3025.69 1899.5,-3025.69 1899.5,-2972.69 2054.5,-2972.69 2054.5,-3025.69"/>
<text text-anchor="middle" x="1977" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1977" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1977" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu3 -->
<g id="edge31" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu3</title>
<path fill="none" stroke="black" d="M3070.49,-3169.36C3081.34,-3163.54 3091.12,-3155.85 3098,-3145.69 3118.95,-3114.79 3123.78,-3088.7 3098,-3061.69 3068.24,-3030.52 2366.02,-3028.28 2323,-3025.69 2235.04,-3020.41 2134.61,-3012.84 2064.69,-3007.32"/>
<polygon fill="black" stroke="black" points="2064.85,-3003.82 2054.6,-3006.52 2064.29,-3010.8 2064.85,-3003.82"/>
</g>
<!-- mha_1_gpu4 -->
<g id="node29" class="node">
<title>mha_1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2325.5,-3114.69 2170.5,-3114.69 2170.5,-3061.69 2325.5,-3061.69 2325.5,-3114.69"/>
<text text-anchor="middle" x="2248" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2248" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2248" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu4 -->
<g id="edge43" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu4</title>
<path fill="none" stroke="black" d="M2883.31,-3187.29C2723.15,-3185.74 2433.61,-3178.35 2335,-3145.69 2318.29,-3140.16 2301.66,-3130.62 2287.49,-3120.94"/>
<polygon fill="black" stroke="black" points="2289.18,-3117.85 2279,-3114.92 2285.14,-3123.56 2289.18,-3117.85"/>
</g>
<!-- residual1_1_gpu4 -->
<g id="node30" class="node">
<title>residual1_1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2486.5,-3025.69 2331.5,-3025.69 2331.5,-2972.69 2486.5,-2972.69 2486.5,-3025.69"/>
<text text-anchor="middle" x="2409" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2409" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2409" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu4 -->
<g id="edge45" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu4</title>
<path fill="none" stroke="black" d="M3091.49,-3176.73C3108.86,-3170.3 3124.91,-3160.5 3136,-3145.69 3158.38,-3115.82 3161.26,-3089.18 3136,-3061.69 3114.64,-3038.45 2685.78,-3014.12 2496.96,-3004.48"/>
<polygon fill="black" stroke="black" points="2496.95,-3000.98 2486.78,-3003.97 2496.59,-3007.97 2496.95,-3000.98"/>
</g>
<!-- mha_1_gpu5 -->
<g id="node38" class="node">
<title>mha_1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2498.5,-3114.69 2343.5,-3114.69 2343.5,-3061.69 2498.5,-3061.69 2498.5,-3114.69"/>
<text text-anchor="middle" x="2421" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2421" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2421" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu5 -->
<g id="edge57" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu5</title>
<path fill="none" stroke="black" d="M2884.54,-3184.31C2763.31,-3179.61 2575.19,-3168.79 2508,-3145.69 2491.36,-3139.97 2474.74,-3130.39 2460.56,-3120.72"/>
<polygon fill="black" stroke="black" points="2462.26,-3117.63 2452.07,-3114.73 2458.22,-3123.35 2462.26,-3117.63"/>
</g>
<!-- residual1_1_gpu5 -->
<g id="node39" class="node">
<title>residual1_1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3076.5,-3025.69 2921.5,-3025.69 2921.5,-2972.69 3076.5,-2972.69 3076.5,-3025.69"/>
<text text-anchor="middle" x="2999" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2999" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2999" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu5 -->
<g id="edge59" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu5</title>
<path fill="none" stroke="black" d="M3090.21,-3176.06C3127.03,-3169.53 3162.81,-3159.77 3174,-3145.69 3197.23,-3116.47 3195.58,-3092.16 3174,-3061.69 3153.92,-3033.36 3119.7,-3017.98 3086.82,-3009.67"/>
<polygon fill="black" stroke="black" points="3087.21,-3006.17 3076.68,-3007.32 3085.63,-3012.99 3087.21,-3006.17"/>
</g>
<!-- mha_1_gpu6 -->
<g id="node47" class="node">
<title>mha_1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="2671.5,-3114.69 2516.5,-3114.69 2516.5,-3061.69 2671.5,-3061.69 2671.5,-3114.69"/>
<text text-anchor="middle" x="2594" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2594" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="2594" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu6 -->
<g id="edge71" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu6</title>
<path fill="none" stroke="black" d="M2884.39,-3184.72C2823.08,-3180.25 2745.96,-3169.75 2681,-3145.69 2664.78,-3139.68 2648.48,-3130.23 2634.45,-3120.76"/>
<polygon fill="black" stroke="black" points="2636.23,-3117.74 2626.02,-3114.89 2632.23,-3123.48 2636.23,-3117.74"/>
</g>
<!-- residual1_1_gpu6 -->
<g id="node48" class="node">
<title>residual1_1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3402.5,-3025.69 3247.5,-3025.69 3247.5,-2972.69 3402.5,-2972.69 3402.5,-3025.69"/>
<text text-anchor="middle" x="3325" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3325" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3325" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu6 -->
<g id="edge73" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu6</title>
<path fill="none" stroke="black" d="M3096.21,-3179.31C3129.7,-3173.31 3165.94,-3163.08 3196,-3145.69 3242.94,-3118.54 3281.77,-3068.17 3304.18,-3034.41"/>
<polygon fill="black" stroke="black" points="3307.27,-3036.08 3309.79,-3025.79 3301.4,-3032.27 3307.27,-3036.08"/>
</g>
<!-- mha_1_gpu7 -->
<g id="node56" class="node">
<title>mha_1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="2844.5,-3114.69 2689.5,-3114.69 2689.5,-3061.69 2844.5,-3061.69 2844.5,-3114.69"/>
<text text-anchor="middle" x="2767" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2767" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="2767" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu7 -->
<g id="edge85" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu7</title>
<path fill="none" stroke="black" d="M2917.26,-3168.98C2896.32,-3162.71 2873.89,-3154.92 2854,-3145.69 2839.12,-3138.79 2823.82,-3129.65 2810.28,-3120.74"/>
<polygon fill="black" stroke="black" points="2811.91,-3117.62 2801.66,-3114.94 2808.01,-3123.43 2811.91,-3117.62"/>
</g>
<!-- residual1_1_gpu7 -->
<g id="node57" class="node">
<title>residual1_1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="3882.5,-3025.69 3727.5,-3025.69 3727.5,-2972.69 3882.5,-2972.69 3882.5,-3025.69"/>
<text text-anchor="middle" x="3805" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3805" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3805" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu7 -->
<g id="edge87" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu7</title>
<path fill="none" stroke="black" d="M3086.98,-3174.7C3136.57,-3167.34 3198.32,-3157.27 3253,-3145.69 3418.71,-3110.6 3609.2,-3057.51 3717.52,-3026.1"/>
<polygon fill="black" stroke="black" points="3718.79,-3029.37 3727.42,-3023.22 3716.84,-3022.65 3718.79,-3029.37"/>
</g>
<!-- mha_1_gpu8 -->
<g id="node65" class="node">
<title>mha_1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="3017.5,-3114.69 2862.5,-3114.69 2862.5,-3061.69 3017.5,-3061.69 3017.5,-3114.69"/>
<text text-anchor="middle" x="2940" y="-3099.49" font-family="Times,serif" font-size="14.00">MHA Layer 1</text>
<text text-anchor="middle" x="2940" y="-3084.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="2940" y="-3069.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- input_tokens&#45;&gt;mha_1_gpu8 -->
<g id="edge99" class="edge">
<title>input_tokens&#45;&gt;mha_1_gpu8</title>
<path fill="none" stroke="black" d="M2979.07,-3161.72C2972.81,-3150.08 2965.32,-3136.18 2958.58,-3123.67"/>
<polygon fill="black" stroke="black" points="2961.66,-3122.01 2953.83,-3114.87 2955.49,-3125.33 2961.66,-3122.01"/>
</g>
<!-- residual1_1_gpu8 -->
<g id="node66" class="node">
<title>residual1_1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4438.5,-3025.69 4283.5,-3025.69 4283.5,-2972.69 4438.5,-2972.69 4438.5,-3025.69"/>
<text text-anchor="middle" x="4361" y="-3010.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4361" y="-2995.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4361" y="-2980.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- input_tokens&#45;&gt;residual1_1_gpu8 -->
<g id="edge101" class="edge">
<title>input_tokens&#45;&gt;residual1_1_gpu8</title>
<path fill="none" stroke="black" d="M3096.29,-3179.45C3185.17,-3172.04 3316.75,-3160.08 3431,-3145.69 3741.88,-3106.55 4108.77,-3044.42 4273.38,-3015.7"/>
<polygon fill="black" stroke="black" points="4274.2,-3019.11 4283.45,-3013.94 4273,-3012.21 4274.2,-3019.11"/>
</g>
<!-- mha_1_gpu1&#45;&gt;residual1_1_gpu1 -->
<g id="edge2" class="edge">
<title>mha_1_gpu1&#45;&gt;residual1_1_gpu1</title>
<path fill="none" stroke="black" d="M1137.12,-3061.56C1124.94,-3052.35 1111.06,-3041.85 1098.26,-3032.17"/>
<polygon fill="black" stroke="black" points="1100.12,-3029.19 1090.04,-3025.94 1095.9,-3034.77 1100.12,-3029.19"/>
</g>
<!-- gate_1_gpu1 -->
<g id="node8" class="node">
<title>gate_1_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="529.92,-2936.69 307.34,-2936.69 250.08,-2800.69 472.66,-2800.69 529.92,-2936.69"/>
<text text-anchor="middle" x="390" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="390" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="390" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu1&#45;&gt;gate_1_gpu1 -->
<g id="edge4" class="edge">
<title>residual1_1_gpu1&#45;&gt;gate_1_gpu1</title>
<path fill="none" stroke="black" d="M978.36,-2990.33C891.64,-2980.81 747.35,-2962.74 625,-2936.69 593.51,-2929.99 560.03,-2921.37 528.52,-2912.56"/>
<polygon fill="black" stroke="black" points="529.38,-2909.17 518.8,-2909.83 527.48,-2915.91 529.38,-2909.17"/>
</g>
<!-- residual2_1_gpu1 -->
<g id="node10" class="node">
<title>residual2_1_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="503.5,-2488.69 348.5,-2488.69 348.5,-2420.69 503.5,-2420.69 503.5,-2488.69"/>
<text text-anchor="middle" x="426" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="426" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="426" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="426" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu1&#45;&gt;residual2_1_gpu1 -->
<g id="edge14" class="edge">
<title>residual1_1_gpu1&#45;&gt;residual2_1_gpu1</title>
<path fill="none" stroke="black" d="M978.14,-2977.66C945.07,-2967.49 906.69,-2953.71 874,-2936.69 759.51,-2877.11 714.81,-2869.88 640,-2764.69 621.67,-2738.92 628.8,-2726.77 619,-2696.69 593.96,-2619.85 612.85,-2585.83 560,-2524.69 547.1,-2509.78 530.19,-2497.66 512.73,-2487.99"/>
<polygon fill="black" stroke="black" points="514.06,-2484.73 503.58,-2483.16 510.79,-2490.92 514.06,-2484.73"/>
</g>
<!-- expert_1_gpu1_exp1 -->
<g id="node4" class="node">
<title>expert_1_gpu1_exp1</title>
<polygon fill="lightgreen" stroke="black" points="610.5,-2764.69 475.5,-2764.69 475.5,-2696.69 610.5,-2696.69 610.5,-2764.69"/>
<text text-anchor="middle" x="543" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="543" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="543" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="543" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu1 -->
<g id="node9" class="node">
<title>agg_1_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="550.89,-2660.69 294.95,-2660.69 229.11,-2524.69 485.05,-2524.69 550.89,-2660.69"/>
<text text-anchor="middle" x="390" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="390" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="390" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu1_exp1&#45;&gt;agg_1_gpu1 -->
<g id="edge9" class="edge">
<title>expert_1_gpu1_exp1&#45;&gt;agg_1_gpu1</title>
<path fill="none" stroke="black" d="M505.57,-2696.42C495.72,-2687.67 484.7,-2677.87 473.47,-2667.89"/>
<polygon fill="black" stroke="black" points="475.47,-2664.98 465.67,-2660.96 470.82,-2670.22 475.47,-2664.98"/>
</g>
<!-- expert_1_gpu1_exp2 -->
<g id="node5" class="node">
<title>expert_1_gpu1_exp2</title>
<polygon fill="lightgreen" stroke="black" points="151.5,-2764.69 16.5,-2764.69 16.5,-2696.69 151.5,-2696.69 151.5,-2764.69"/>
<text text-anchor="middle" x="84" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="84" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="84" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="84" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu1_exp2&#45;&gt;agg_1_gpu1 -->
<g id="edge10" class="edge">
<title>expert_1_gpu1_exp2&#45;&gt;agg_1_gpu1</title>
<path fill="none" stroke="black" d="M151.53,-2699.68C188.02,-2683.46 234.05,-2663.01 275.91,-2644.4"/>
<polygon fill="black" stroke="black" points="277.34,-2647.6 285.06,-2640.34 274.5,-2641.2 277.34,-2647.6"/>
</g>
<!-- expert_1_gpu1_exp3 -->
<g id="node6" class="node">
<title>expert_1_gpu1_exp3</title>
<polygon fill="lightgreen" stroke="black" points="304.5,-2764.69 169.5,-2764.69 169.5,-2696.69 304.5,-2696.69 304.5,-2764.69"/>
<text text-anchor="middle" x="237" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="237" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="237" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="237" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu1_exp3&#45;&gt;agg_1_gpu1 -->
<g id="edge11" class="edge">
<title>expert_1_gpu1_exp3&#45;&gt;agg_1_gpu1</title>
<path fill="none" stroke="black" d="M274.43,-2696.42C284.28,-2687.67 295.3,-2677.87 306.53,-2667.89"/>
<polygon fill="black" stroke="black" points="309.18,-2670.22 314.33,-2660.96 304.53,-2664.98 309.18,-2670.22"/>
</g>
<!-- expert_1_gpu1_exp4 -->
<g id="node7" class="node">
<title>expert_1_gpu1_exp4</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-2764.69 322.5,-2764.69 322.5,-2696.69 457.5,-2696.69 457.5,-2764.69"/>
<text text-anchor="middle" x="390" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="390" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="390" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu1_exp4&#45;&gt;agg_1_gpu1 -->
<g id="edge12" class="edge">
<title>expert_1_gpu1_exp4&#45;&gt;agg_1_gpu1</title>
<path fill="none" stroke="black" d="M390,-2696.42C390,-2688.6 390,-2679.93 390,-2671.05"/>
<polygon fill="black" stroke="black" points="393.5,-2670.96 390,-2660.96 386.5,-2670.96 393.5,-2670.96"/>
</g>
<!-- gate_1_gpu1&#45;&gt;expert_1_gpu1_exp1 -->
<g id="edge5" class="edge">
<title>gate_1_gpu1&#45;&gt;expert_1_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M465.6,-2800.49C476.76,-2790.57 487.95,-2780.63 498.21,-2771.51"/>
<polygon fill="black" stroke="black" points="500.71,-2773.97 505.86,-2764.71 496.06,-2768.74 500.71,-2773.97"/>
</g>
<!-- gate_1_gpu1&#45;&gt;expert_1_gpu1_exp2 -->
<g id="edge6" class="edge">
<title>gate_1_gpu1&#45;&gt;expert_1_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M252.22,-2806.46C220.86,-2792.52 188.65,-2778.2 160.91,-2765.87"/>
<polygon fill="black" stroke="black" points="162.24,-2762.64 151.68,-2761.77 159.4,-2769.03 162.24,-2762.64"/>
</g>
<!-- gate_1_gpu1&#45;&gt;expert_1_gpu1_exp3 -->
<g id="edge7" class="edge">
<title>gate_1_gpu1&#45;&gt;expert_1_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M314.4,-2800.49C303.24,-2790.57 292.05,-2780.63 281.79,-2771.51"/>
<polygon fill="black" stroke="black" points="283.94,-2768.74 274.14,-2764.71 279.29,-2773.97 283.94,-2768.74"/>
</g>
<!-- gate_1_gpu1&#45;&gt;expert_1_gpu1_exp4 -->
<g id="edge8" class="edge">
<title>gate_1_gpu1&#45;&gt;expert_1_gpu1_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390,-2800.49C390,-2791.74 390,-2782.97 390,-2774.76"/>
<polygon fill="black" stroke="black" points="393.5,-2774.71 390,-2764.71 386.5,-2774.71 393.5,-2774.71"/>
</g>
<!-- agg_1_gpu1&#45;&gt;residual2_1_gpu1 -->
<g id="edge13" class="edge">
<title>agg_1_gpu1&#45;&gt;residual2_1_gpu1</title>
<path fill="none" stroke="black" d="M407.79,-2524.49C410.13,-2515.64 412.48,-2506.77 414.67,-2498.49"/>
<polygon fill="black" stroke="black" points="418.08,-2499.27 417.26,-2488.71 411.32,-2497.48 418.08,-2499.27"/>
</g>
<!-- mha_2_gpu1 -->
<g id="node74" class="node">
<title>mha_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="442.5,-2384.69 287.5,-2384.69 287.5,-2331.69 442.5,-2331.69 442.5,-2384.69"/>
<text text-anchor="middle" x="365" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="365" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="365" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu1&#45;&gt;mha_2_gpu1 -->
<g id="edge113" class="edge">
<title>residual2_1_gpu1&#45;&gt;mha_2_gpu1</title>
<path fill="none" stroke="black" d="M404.67,-2420.64C399,-2411.86 392.86,-2402.36 387.15,-2393.51"/>
<polygon fill="black" stroke="black" points="389.98,-2391.43 381.61,-2384.93 384.1,-2395.23 389.98,-2391.43"/>
</g>
<!-- residual1_2_gpu1 -->
<g id="node75" class="node">
<title>residual1_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="491.5,-2295.69 336.5,-2295.69 336.5,-2242.69 491.5,-2242.69 491.5,-2295.69"/>
<text text-anchor="middle" x="414" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="414" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="414" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu1&#45;&gt;residual1_2_gpu1 -->
<g id="edge115" class="edge">
<title>residual2_1_gpu1&#45;&gt;residual1_2_gpu1</title>
<path fill="none" stroke="black" d="M441.25,-2420.52C450.56,-2395.82 459.24,-2361.38 451,-2331.69 448.43,-2322.44 444.05,-2313.17 439.19,-2304.75"/>
<polygon fill="black" stroke="black" points="442.01,-2302.66 433.78,-2295.98 436.05,-2306.33 442.01,-2302.66"/>
</g>
<!-- mha_1_gpu2&#45;&gt;residual1_1_gpu2 -->
<g id="edge16" class="edge">
<title>mha_1_gpu2&#45;&gt;residual1_1_gpu2</title>
<path fill="none" stroke="black" d="M1805.43,-3065.35C1761.62,-3053.02 1706.74,-3037.57 1661.42,-3024.81"/>
<polygon fill="black" stroke="black" points="1662.18,-3021.39 1651.61,-3022.04 1660.28,-3028.12 1662.18,-3021.39"/>
</g>
<!-- gate_1_gpu2 -->
<g id="node17" class="node">
<title>gate_1_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="1162.92,-2936.69 940.34,-2936.69 883.08,-2800.69 1105.66,-2800.69 1162.92,-2936.69"/>
<text text-anchor="middle" x="1023" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1023" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1023" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu2&#45;&gt;gate_1_gpu2 -->
<g id="edge18" class="edge">
<title>residual1_1_gpu2&#45;&gt;gate_1_gpu2</title>
<path fill="none" stroke="black" d="M1496.33,-2984.99C1432.12,-2973.62 1338.72,-2956.02 1258,-2936.69 1226.4,-2929.13 1192.68,-2920.1 1160.94,-2911.15"/>
<polygon fill="black" stroke="black" points="1161.73,-2907.73 1151.15,-2908.38 1159.82,-2914.47 1161.73,-2907.73"/>
</g>
<!-- residual2_1_gpu2 -->
<g id="node19" class="node">
<title>residual2_1_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1208.5,-2488.69 1053.5,-2488.69 1053.5,-2420.69 1208.5,-2420.69 1208.5,-2488.69"/>
<text text-anchor="middle" x="1131" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1131" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1131" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1131" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu2&#45;&gt;residual2_1_gpu2 -->
<g id="edge28" class="edge">
<title>residual1_1_gpu2&#45;&gt;residual2_1_gpu2</title>
<path fill="none" stroke="black" d="M1524.44,-2972.55C1457.67,-2935.52 1339.51,-2860.82 1273,-2764.69 1255,-2738.68 1261.8,-2726.77 1252,-2696.69 1226.96,-2619.85 1233.94,-2594.37 1193,-2524.69 1187.26,-2514.92 1179.99,-2505.31 1172.46,-2496.5"/>
<polygon fill="black" stroke="black" points="1175.06,-2494.16 1165.81,-2488.99 1169.82,-2498.8 1175.06,-2494.16"/>
</g>
<!-- expert_1_gpu2_exp1 -->
<g id="node13" class="node">
<title>expert_1_gpu2_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1090.5,-2764.69 955.5,-2764.69 955.5,-2696.69 1090.5,-2696.69 1090.5,-2764.69"/>
<text text-anchor="middle" x="1023" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1023" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1023" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu2 -->
<g id="node18" class="node">
<title>agg_1_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="1183.89,-2660.69 927.95,-2660.69 862.11,-2524.69 1118.05,-2524.69 1183.89,-2660.69"/>
<text text-anchor="middle" x="1023" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1023" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1023" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu2_exp1&#45;&gt;agg_1_gpu2 -->
<g id="edge23" class="edge">
<title>expert_1_gpu2_exp1&#45;&gt;agg_1_gpu2</title>
<path fill="none" stroke="black" d="M1023,-2696.42C1023,-2688.6 1023,-2679.93 1023,-2671.05"/>
<polygon fill="black" stroke="black" points="1026.5,-2670.96 1023,-2660.96 1019.5,-2670.96 1026.5,-2670.96"/>
</g>
<!-- expert_1_gpu2_exp2 -->
<g id="node14" class="node">
<title>expert_1_gpu2_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1243.5,-2764.69 1108.5,-2764.69 1108.5,-2696.69 1243.5,-2696.69 1243.5,-2764.69"/>
<text text-anchor="middle" x="1176" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1176" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1176" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1176" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu2_exp2&#45;&gt;agg_1_gpu2 -->
<g id="edge24" class="edge">
<title>expert_1_gpu2_exp2&#45;&gt;agg_1_gpu2</title>
<path fill="none" stroke="black" d="M1138.57,-2696.42C1128.72,-2687.67 1117.7,-2677.87 1106.47,-2667.89"/>
<polygon fill="black" stroke="black" points="1108.47,-2664.98 1098.67,-2660.96 1103.82,-2670.22 1108.47,-2664.98"/>
</g>
<!-- expert_1_gpu2_exp3 -->
<g id="node15" class="node">
<title>expert_1_gpu2_exp3</title>
<polygon fill="lightgreen" stroke="black" points="784.5,-2764.69 649.5,-2764.69 649.5,-2696.69 784.5,-2696.69 784.5,-2764.69"/>
<text text-anchor="middle" x="717" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="717" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="717" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="717" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu2_exp3&#45;&gt;agg_1_gpu2 -->
<g id="edge25" class="edge">
<title>expert_1_gpu2_exp3&#45;&gt;agg_1_gpu2</title>
<path fill="none" stroke="black" d="M784.53,-2699.68C821.02,-2683.46 867.05,-2663.01 908.91,-2644.4"/>
<polygon fill="black" stroke="black" points="910.34,-2647.6 918.06,-2640.34 907.5,-2641.2 910.34,-2647.6"/>
</g>
<!-- expert_1_gpu2_exp4 -->
<g id="node16" class="node">
<title>expert_1_gpu2_exp4</title>
<polygon fill="lightgreen" stroke="black" points="937.5,-2764.69 802.5,-2764.69 802.5,-2696.69 937.5,-2696.69 937.5,-2764.69"/>
<text text-anchor="middle" x="870" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="870" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="870" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="870" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu2_exp4&#45;&gt;agg_1_gpu2 -->
<g id="edge26" class="edge">
<title>expert_1_gpu2_exp4&#45;&gt;agg_1_gpu2</title>
<path fill="none" stroke="black" d="M907.43,-2696.42C917.28,-2687.67 928.3,-2677.87 939.53,-2667.89"/>
<polygon fill="black" stroke="black" points="942.18,-2670.22 947.33,-2660.96 937.53,-2664.98 942.18,-2670.22"/>
</g>
<!-- gate_1_gpu2&#45;&gt;expert_1_gpu2_exp1 -->
<g id="edge19" class="edge">
<title>gate_1_gpu2&#45;&gt;expert_1_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1023,-2800.49C1023,-2791.74 1023,-2782.97 1023,-2774.76"/>
<polygon fill="black" stroke="black" points="1026.5,-2774.71 1023,-2764.71 1019.5,-2774.71 1026.5,-2774.71"/>
</g>
<!-- gate_1_gpu2&#45;&gt;expert_1_gpu2_exp2 -->
<g id="edge20" class="edge">
<title>gate_1_gpu2&#45;&gt;expert_1_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1098.6,-2800.49C1109.76,-2790.57 1120.95,-2780.63 1131.21,-2771.51"/>
<polygon fill="black" stroke="black" points="1133.71,-2773.97 1138.86,-2764.71 1129.06,-2768.74 1133.71,-2773.97"/>
</g>
<!-- gate_1_gpu2&#45;&gt;expert_1_gpu2_exp3 -->
<g id="edge21" class="edge">
<title>gate_1_gpu2&#45;&gt;expert_1_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M885.22,-2806.46C853.86,-2792.52 821.65,-2778.2 793.91,-2765.87"/>
<polygon fill="black" stroke="black" points="795.24,-2762.64 784.68,-2761.77 792.4,-2769.03 795.24,-2762.64"/>
</g>
<!-- gate_1_gpu2&#45;&gt;expert_1_gpu2_exp4 -->
<g id="edge22" class="edge">
<title>gate_1_gpu2&#45;&gt;expert_1_gpu2_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M947.4,-2800.49C936.24,-2790.57 925.05,-2780.63 914.79,-2771.51"/>
<polygon fill="black" stroke="black" points="916.94,-2768.74 907.14,-2764.71 912.29,-2773.97 916.94,-2768.74"/>
</g>
<!-- agg_1_gpu2&#45;&gt;residual2_1_gpu2 -->
<g id="edge27" class="edge">
<title>agg_1_gpu2&#45;&gt;residual2_1_gpu2</title>
<path fill="none" stroke="black" d="M1076.37,-2524.49C1083.94,-2514.96 1091.52,-2505.41 1098.53,-2496.59"/>
<polygon fill="black" stroke="black" points="1101.3,-2498.72 1104.78,-2488.71 1095.82,-2494.36 1101.3,-2498.72"/>
</g>
<!-- mha_2_gpu2 -->
<g id="node83" class="node">
<title>mha_2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1184.5,-2384.69 1029.5,-2384.69 1029.5,-2331.69 1184.5,-2331.69 1184.5,-2384.69"/>
<text text-anchor="middle" x="1107" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="1107" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1107" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu2&#45;&gt;mha_2_gpu2 -->
<g id="edge128" class="edge">
<title>residual2_1_gpu2&#45;&gt;mha_2_gpu2</title>
<path fill="none" stroke="black" d="M1122.61,-2420.64C1120.49,-2412.32 1118.21,-2403.34 1116.07,-2394.9"/>
<polygon fill="black" stroke="black" points="1119.39,-2393.76 1113.54,-2384.93 1112.61,-2395.48 1119.39,-2393.76"/>
</g>
<!-- residual1_2_gpu2 -->
<g id="node84" class="node">
<title>residual1_2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1232.5,-2295.69 1077.5,-2295.69 1077.5,-2242.69 1232.5,-2242.69 1232.5,-2295.69"/>
<text text-anchor="middle" x="1155" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1155" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1155" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu2&#45;&gt;residual1_2_gpu2 -->
<g id="edge130" class="edge">
<title>residual2_1_gpu2&#45;&gt;residual1_2_gpu2</title>
<path fill="none" stroke="black" d="M1169.51,-2420.65C1179.02,-2410.22 1187.93,-2397.93 1193,-2384.69 1201.43,-2362.7 1199.44,-2354.35 1193,-2331.69 1190.33,-2322.28 1185.76,-2312.91 1180.7,-2304.41"/>
<polygon fill="black" stroke="black" points="1183.62,-2302.48 1175.31,-2295.91 1177.71,-2306.23 1183.62,-2302.48"/>
</g>
<!-- mha_1_gpu3&#45;&gt;residual1_1_gpu3 -->
<g id="edge30" class="edge">
<title>mha_1_gpu3&#45;&gt;residual1_1_gpu3</title>
<path fill="none" stroke="black" d="M2032.72,-3061.56C2024.76,-3052.79 2015.73,-3042.84 2007.29,-3033.55"/>
<polygon fill="black" stroke="black" points="2009.7,-3030.99 2000.38,-3025.94 2004.51,-3035.7 2009.7,-3030.99"/>
</g>
<!-- gate_1_gpu3 -->
<g id="node26" class="node">
<title>gate_1_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="1795.92,-2936.69 1573.34,-2936.69 1516.08,-2800.69 1738.66,-2800.69 1795.92,-2936.69"/>
<text text-anchor="middle" x="1656" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1656" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1656" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu3&#45;&gt;gate_1_gpu3 -->
<g id="edge32" class="edge">
<title>residual1_1_gpu3&#45;&gt;gate_1_gpu3</title>
<path fill="none" stroke="black" d="M1913.2,-2972.65C1880.7,-2959.64 1839.76,-2943.26 1800.17,-2927.41"/>
<polygon fill="black" stroke="black" points="1801.26,-2924.07 1790.68,-2923.61 1798.66,-2930.57 1801.26,-2924.07"/>
</g>
<!-- residual2_1_gpu3 -->
<g id="node28" class="node">
<title>residual2_1_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1853.5,-2488.69 1698.5,-2488.69 1698.5,-2420.69 1853.5,-2420.69 1853.5,-2488.69"/>
<text text-anchor="middle" x="1776" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1776" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1776" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1776" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu3&#45;&gt;residual2_1_gpu3 -->
<g id="edge42" class="edge">
<title>residual1_1_gpu3&#45;&gt;residual2_1_gpu3</title>
<path fill="none" stroke="black" d="M1969.24,-2972.24C1948.85,-2904.12 1894.75,-2723.6 1886,-2696.69 1860.96,-2619.7 1863.48,-2596.46 1826,-2524.69 1821.12,-2515.35 1815.09,-2505.87 1808.92,-2497.04"/>
<polygon fill="black" stroke="black" points="1811.67,-2494.88 1802.99,-2488.81 1805.99,-2498.97 1811.67,-2494.88"/>
</g>
<!-- expert_1_gpu3_exp1 -->
<g id="node22" class="node">
<title>expert_1_gpu3_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1570.5,-2764.69 1435.5,-2764.69 1435.5,-2696.69 1570.5,-2696.69 1570.5,-2764.69"/>
<text text-anchor="middle" x="1503" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1503" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1503" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1503" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu3 -->
<g id="node27" class="node">
<title>agg_1_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="1816.89,-2660.69 1560.95,-2660.69 1495.11,-2524.69 1751.05,-2524.69 1816.89,-2660.69"/>
<text text-anchor="middle" x="1656" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1656" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1656" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu3_exp1&#45;&gt;agg_1_gpu3 -->
<g id="edge37" class="edge">
<title>expert_1_gpu3_exp1&#45;&gt;agg_1_gpu3</title>
<path fill="none" stroke="black" d="M1540.43,-2696.42C1550.28,-2687.67 1561.3,-2677.87 1572.53,-2667.89"/>
<polygon fill="black" stroke="black" points="1575.18,-2670.22 1580.33,-2660.96 1570.53,-2664.98 1575.18,-2670.22"/>
</g>
<!-- expert_1_gpu3_exp2 -->
<g id="node23" class="node">
<title>expert_1_gpu3_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1723.5,-2764.69 1588.5,-2764.69 1588.5,-2696.69 1723.5,-2696.69 1723.5,-2764.69"/>
<text text-anchor="middle" x="1656" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1656" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1656" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu3_exp2&#45;&gt;agg_1_gpu3 -->
<g id="edge38" class="edge">
<title>expert_1_gpu3_exp2&#45;&gt;agg_1_gpu3</title>
<path fill="none" stroke="black" d="M1656,-2696.42C1656,-2688.6 1656,-2679.93 1656,-2671.05"/>
<polygon fill="black" stroke="black" points="1659.5,-2670.96 1656,-2660.96 1652.5,-2670.96 1659.5,-2670.96"/>
</g>
<!-- expert_1_gpu3_exp3 -->
<g id="node24" class="node">
<title>expert_1_gpu3_exp3</title>
<polygon fill="lightgreen" stroke="black" points="1876.5,-2764.69 1741.5,-2764.69 1741.5,-2696.69 1876.5,-2696.69 1876.5,-2764.69"/>
<text text-anchor="middle" x="1809" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1809" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1809" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1809" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu3_exp3&#45;&gt;agg_1_gpu3 -->
<g id="edge39" class="edge">
<title>expert_1_gpu3_exp3&#45;&gt;agg_1_gpu3</title>
<path fill="none" stroke="black" d="M1771.57,-2696.42C1761.72,-2687.67 1750.7,-2677.87 1739.47,-2667.89"/>
<polygon fill="black" stroke="black" points="1741.47,-2664.98 1731.67,-2660.96 1736.82,-2670.22 1741.47,-2664.98"/>
</g>
<!-- expert_1_gpu3_exp4 -->
<g id="node25" class="node">
<title>expert_1_gpu3_exp4</title>
<polygon fill="lightgreen" stroke="black" points="1417.5,-2764.69 1282.5,-2764.69 1282.5,-2696.69 1417.5,-2696.69 1417.5,-2764.69"/>
<text text-anchor="middle" x="1350" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1350" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1350" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1350" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu3_exp4&#45;&gt;agg_1_gpu3 -->
<g id="edge40" class="edge">
<title>expert_1_gpu3_exp4&#45;&gt;agg_1_gpu3</title>
<path fill="none" stroke="black" d="M1417.53,-2699.68C1454.02,-2683.46 1500.05,-2663.01 1541.91,-2644.4"/>
<polygon fill="black" stroke="black" points="1543.34,-2647.6 1551.06,-2640.34 1540.5,-2641.2 1543.34,-2647.6"/>
</g>
<!-- gate_1_gpu3&#45;&gt;expert_1_gpu3_exp1 -->
<g id="edge33" class="edge">
<title>gate_1_gpu3&#45;&gt;expert_1_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1580.4,-2800.49C1569.24,-2790.57 1558.05,-2780.63 1547.79,-2771.51"/>
<polygon fill="black" stroke="black" points="1549.94,-2768.74 1540.14,-2764.71 1545.29,-2773.97 1549.94,-2768.74"/>
</g>
<!-- gate_1_gpu3&#45;&gt;expert_1_gpu3_exp2 -->
<g id="edge34" class="edge">
<title>gate_1_gpu3&#45;&gt;expert_1_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1656,-2800.49C1656,-2791.74 1656,-2782.97 1656,-2774.76"/>
<polygon fill="black" stroke="black" points="1659.5,-2774.71 1656,-2764.71 1652.5,-2774.71 1659.5,-2774.71"/>
</g>
<!-- gate_1_gpu3&#45;&gt;expert_1_gpu3_exp3 -->
<g id="edge35" class="edge">
<title>gate_1_gpu3&#45;&gt;expert_1_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1731.6,-2800.49C1742.76,-2790.57 1753.95,-2780.63 1764.21,-2771.51"/>
<polygon fill="black" stroke="black" points="1766.71,-2773.97 1771.86,-2764.71 1762.06,-2768.74 1766.71,-2773.97"/>
</g>
<!-- gate_1_gpu3&#45;&gt;expert_1_gpu3_exp4 -->
<g id="edge36" class="edge">
<title>gate_1_gpu3&#45;&gt;expert_1_gpu3_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1518.22,-2806.46C1486.86,-2792.52 1454.65,-2778.2 1426.91,-2765.87"/>
<polygon fill="black" stroke="black" points="1428.24,-2762.64 1417.68,-2761.77 1425.4,-2769.03 1428.24,-2762.64"/>
</g>
<!-- agg_1_gpu3&#45;&gt;residual2_1_gpu3 -->
<g id="edge41" class="edge">
<title>agg_1_gpu3&#45;&gt;residual2_1_gpu3</title>
<path fill="none" stroke="black" d="M1715.3,-2524.49C1723.79,-2514.86 1732.3,-2505.21 1740.16,-2496.32"/>
<polygon fill="black" stroke="black" points="1742.88,-2498.52 1746.87,-2488.71 1737.63,-2493.89 1742.88,-2498.52"/>
</g>
<!-- mha_2_gpu3 -->
<g id="node92" class="node">
<title>mha_2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1805.5,-2384.69 1650.5,-2384.69 1650.5,-2331.69 1805.5,-2331.69 1805.5,-2384.69"/>
<text text-anchor="middle" x="1728" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="1728" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1728" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu3&#45;&gt;mha_2_gpu3 -->
<g id="edge143" class="edge">
<title>residual2_1_gpu3&#45;&gt;mha_2_gpu3</title>
<path fill="none" stroke="black" d="M1759.21,-2420.64C1754.84,-2412.04 1750.12,-2402.75 1745.71,-2394.06"/>
<polygon fill="black" stroke="black" points="1748.72,-2392.26 1741.07,-2384.93 1742.48,-2395.43 1748.72,-2392.26"/>
</g>
<!-- residual1_2_gpu3 -->
<g id="node93" class="node">
<title>residual1_2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1853.5,-2295.69 1698.5,-2295.69 1698.5,-2242.69 1853.5,-2242.69 1853.5,-2295.69"/>
<text text-anchor="middle" x="1776" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1776" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1776" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu3&#45;&gt;residual1_2_gpu3 -->
<g id="edge145" class="edge">
<title>residual2_1_gpu3&#45;&gt;residual1_2_gpu3</title>
<path fill="none" stroke="black" d="M1799.34,-2420.45C1805.71,-2409.56 1811.74,-2397.07 1815,-2384.69 1820.99,-2361.91 1821.57,-2354.31 1815,-2331.69 1812.25,-2322.23 1807.56,-2312.83 1802.37,-2304.33"/>
<polygon fill="black" stroke="black" points="1805.23,-2302.3 1796.84,-2295.84 1799.36,-2306.13 1805.23,-2302.3"/>
</g>
<!-- mha_1_gpu4&#45;&gt;residual1_1_gpu4 -->
<g id="edge44" class="edge">
<title>mha_1_gpu4&#45;&gt;residual1_1_gpu4</title>
<path fill="none" stroke="black" d="M2295.43,-3061.56C2313.37,-3051.87 2333.96,-3040.75 2352.63,-3030.65"/>
<polygon fill="black" stroke="black" points="2354.49,-3033.63 2361.63,-3025.79 2351.16,-3027.47 2354.49,-3033.63"/>
</g>
<!-- gate_1_gpu4 -->
<g id="node35" class="node">
<title>gate_1_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="2428.92,-2936.69 2206.34,-2936.69 2149.08,-2800.69 2371.66,-2800.69 2428.92,-2936.69"/>
<text text-anchor="middle" x="2289" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2289" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2289" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu4&#45;&gt;gate_1_gpu4 -->
<g id="edge46" class="edge">
<title>residual1_1_gpu4&#45;&gt;gate_1_gpu4</title>
<path fill="none" stroke="black" d="M2385,-2972.5C2377.19,-2964.13 2368.08,-2954.38 2358.65,-2944.27"/>
<polygon fill="black" stroke="black" points="2361.11,-2941.79 2351.73,-2936.87 2356,-2946.57 2361.11,-2941.79"/>
</g>
<!-- residual2_1_gpu4 -->
<g id="node37" class="node">
<title>residual2_1_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2474.5,-2488.69 2319.5,-2488.69 2319.5,-2420.69 2474.5,-2420.69 2474.5,-2488.69"/>
<text text-anchor="middle" x="2397" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2397" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2397" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2397" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu4&#45;&gt;residual2_1_gpu4 -->
<g id="edge56" class="edge">
<title>residual1_1_gpu4&#45;&gt;residual2_1_gpu4</title>
<path fill="none" stroke="black" d="M2428.41,-2972.46C2464.57,-2921.46 2537.06,-2803.27 2519,-2696.69 2505.48,-2616.87 2500.2,-2594.39 2459,-2524.69 2453.23,-2514.94 2445.95,-2505.33 2438.42,-2496.52"/>
<polygon fill="black" stroke="black" points="2441.02,-2494.18 2431.77,-2489.01 2435.78,-2498.82 2441.02,-2494.18"/>
</g>
<!-- expert_1_gpu4_exp1 -->
<g id="node31" class="node">
<title>expert_1_gpu4_exp1</title>
<polygon fill="lightgreen" stroke="black" points="2050.5,-2764.69 1915.5,-2764.69 1915.5,-2696.69 2050.5,-2696.69 2050.5,-2764.69"/>
<text text-anchor="middle" x="1983" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1983" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="1983" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1983" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu4 -->
<g id="node36" class="node">
<title>agg_1_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="2449.89,-2660.69 2193.95,-2660.69 2128.11,-2524.69 2384.05,-2524.69 2449.89,-2660.69"/>
<text text-anchor="middle" x="2289" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2289" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2289" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu4_exp1&#45;&gt;agg_1_gpu4 -->
<g id="edge51" class="edge">
<title>expert_1_gpu4_exp1&#45;&gt;agg_1_gpu4</title>
<path fill="none" stroke="black" d="M2050.53,-2699.68C2087.02,-2683.46 2133.05,-2663.01 2174.91,-2644.4"/>
<polygon fill="black" stroke="black" points="2176.34,-2647.6 2184.06,-2640.34 2173.5,-2641.2 2176.34,-2647.6"/>
</g>
<!-- expert_1_gpu4_exp2 -->
<g id="node32" class="node">
<title>expert_1_gpu4_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2203.5,-2764.69 2068.5,-2764.69 2068.5,-2696.69 2203.5,-2696.69 2203.5,-2764.69"/>
<text text-anchor="middle" x="2136" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2136" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2136" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2136" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu4_exp2&#45;&gt;agg_1_gpu4 -->
<g id="edge52" class="edge">
<title>expert_1_gpu4_exp2&#45;&gt;agg_1_gpu4</title>
<path fill="none" stroke="black" d="M2173.43,-2696.42C2183.28,-2687.67 2194.3,-2677.87 2205.53,-2667.89"/>
<polygon fill="black" stroke="black" points="2208.18,-2670.22 2213.33,-2660.96 2203.53,-2664.98 2208.18,-2670.22"/>
</g>
<!-- expert_1_gpu4_exp3 -->
<g id="node33" class="node">
<title>expert_1_gpu4_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2356.5,-2764.69 2221.5,-2764.69 2221.5,-2696.69 2356.5,-2696.69 2356.5,-2764.69"/>
<text text-anchor="middle" x="2289" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2289" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2289" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu4_exp3&#45;&gt;agg_1_gpu4 -->
<g id="edge53" class="edge">
<title>expert_1_gpu4_exp3&#45;&gt;agg_1_gpu4</title>
<path fill="none" stroke="black" d="M2289,-2696.42C2289,-2688.6 2289,-2679.93 2289,-2671.05"/>
<polygon fill="black" stroke="black" points="2292.5,-2670.96 2289,-2660.96 2285.5,-2670.96 2292.5,-2670.96"/>
</g>
<!-- expert_1_gpu4_exp4 -->
<g id="node34" class="node">
<title>expert_1_gpu4_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2509.5,-2764.69 2374.5,-2764.69 2374.5,-2696.69 2509.5,-2696.69 2509.5,-2764.69"/>
<text text-anchor="middle" x="2442" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2442" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2442" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2442" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu4_exp4&#45;&gt;agg_1_gpu4 -->
<g id="edge54" class="edge">
<title>expert_1_gpu4_exp4&#45;&gt;agg_1_gpu4</title>
<path fill="none" stroke="black" d="M2404.57,-2696.42C2394.72,-2687.67 2383.7,-2677.87 2372.47,-2667.89"/>
<polygon fill="black" stroke="black" points="2374.47,-2664.98 2364.67,-2660.96 2369.82,-2670.22 2374.47,-2664.98"/>
</g>
<!-- gate_1_gpu4&#45;&gt;expert_1_gpu4_exp1 -->
<g id="edge47" class="edge">
<title>gate_1_gpu4&#45;&gt;expert_1_gpu4_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2151.22,-2806.46C2119.86,-2792.52 2087.65,-2778.2 2059.91,-2765.87"/>
<polygon fill="black" stroke="black" points="2061.24,-2762.64 2050.68,-2761.77 2058.4,-2769.03 2061.24,-2762.64"/>
</g>
<!-- gate_1_gpu4&#45;&gt;expert_1_gpu4_exp2 -->
<g id="edge48" class="edge">
<title>gate_1_gpu4&#45;&gt;expert_1_gpu4_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2213.4,-2800.49C2202.24,-2790.57 2191.05,-2780.63 2180.79,-2771.51"/>
<polygon fill="black" stroke="black" points="2182.94,-2768.74 2173.14,-2764.71 2178.29,-2773.97 2182.94,-2768.74"/>
</g>
<!-- gate_1_gpu4&#45;&gt;expert_1_gpu4_exp3 -->
<g id="edge49" class="edge">
<title>gate_1_gpu4&#45;&gt;expert_1_gpu4_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2289,-2800.49C2289,-2791.74 2289,-2782.97 2289,-2774.76"/>
<polygon fill="black" stroke="black" points="2292.5,-2774.71 2289,-2764.71 2285.5,-2774.71 2292.5,-2774.71"/>
</g>
<!-- gate_1_gpu4&#45;&gt;expert_1_gpu4_exp4 -->
<g id="edge50" class="edge">
<title>gate_1_gpu4&#45;&gt;expert_1_gpu4_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2364.6,-2800.49C2375.76,-2790.57 2386.95,-2780.63 2397.21,-2771.51"/>
<polygon fill="black" stroke="black" points="2399.71,-2773.97 2404.86,-2764.71 2395.06,-2768.74 2399.71,-2773.97"/>
</g>
<!-- agg_1_gpu4&#45;&gt;residual2_1_gpu4 -->
<g id="edge55" class="edge">
<title>agg_1_gpu4&#45;&gt;residual2_1_gpu4</title>
<path fill="none" stroke="black" d="M2342.37,-2524.49C2349.94,-2514.96 2357.52,-2505.41 2364.53,-2496.59"/>
<polygon fill="black" stroke="black" points="2367.3,-2498.72 2370.78,-2488.71 2361.82,-2494.36 2367.3,-2498.72"/>
</g>
<!-- mha_2_gpu4 -->
<g id="node101" class="node">
<title>mha_2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2450.5,-2384.69 2295.5,-2384.69 2295.5,-2331.69 2450.5,-2331.69 2450.5,-2384.69"/>
<text text-anchor="middle" x="2373" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="2373" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2373" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu4&#45;&gt;mha_2_gpu4 -->
<g id="edge158" class="edge">
<title>residual2_1_gpu4&#45;&gt;mha_2_gpu4</title>
<path fill="none" stroke="black" d="M2388.61,-2420.64C2386.49,-2412.32 2384.21,-2403.34 2382.07,-2394.9"/>
<polygon fill="black" stroke="black" points="2385.39,-2393.76 2379.54,-2384.93 2378.61,-2395.48 2385.39,-2393.76"/>
</g>
<!-- residual1_2_gpu4 -->
<g id="node102" class="node">
<title>residual1_2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2498.5,-2295.69 2343.5,-2295.69 2343.5,-2242.69 2498.5,-2242.69 2498.5,-2295.69"/>
<text text-anchor="middle" x="2421" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2421" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2421" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu4&#45;&gt;residual1_2_gpu4 -->
<g id="edge160" class="edge">
<title>residual2_1_gpu4&#45;&gt;residual1_2_gpu4</title>
<path fill="none" stroke="black" d="M2436.45,-2420.39C2445.99,-2410.03 2454.9,-2397.85 2460,-2384.69 2468.52,-2362.73 2466.57,-2354.31 2460,-2331.69 2457.25,-2322.23 2452.56,-2312.83 2447.37,-2304.33"/>
<polygon fill="black" stroke="black" points="2450.23,-2302.3 2441.84,-2295.84 2444.36,-2306.13 2450.23,-2302.3"/>
</g>
<!-- mha_1_gpu5&#45;&gt;residual1_1_gpu5 -->
<g id="edge58" class="edge">
<title>mha_1_gpu5&#45;&gt;residual1_1_gpu5</title>
<path fill="none" stroke="black" d="M2498.63,-3063.77C2501.79,-3063.03 2504.92,-3062.33 2508,-3061.69 2647.53,-3032.7 2812.39,-3015.46 2911.17,-3006.91"/>
<polygon fill="black" stroke="black" points="2911.74,-3010.38 2921.4,-3006.04 2911.14,-3003.4 2911.74,-3010.38"/>
</g>
<!-- gate_1_gpu5 -->
<g id="node44" class="node">
<title>gate_1_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="3061.92,-2936.69 2839.34,-2936.69 2782.08,-2800.69 3004.66,-2800.69 3061.92,-2936.69"/>
<text text-anchor="middle" x="2922" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2922" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2922" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu5&#45;&gt;gate_1_gpu5 -->
<g id="edge60" class="edge">
<title>residual1_1_gpu5&#45;&gt;gate_1_gpu5</title>
<path fill="none" stroke="black" d="M2983.6,-2972.5C2978.78,-2964.45 2973.2,-2955.13 2967.39,-2945.45"/>
<polygon fill="black" stroke="black" points="2970.39,-2943.65 2962.25,-2936.87 2964.39,-2947.24 2970.39,-2943.65"/>
</g>
<!-- residual2_1_gpu5 -->
<g id="node46" class="node">
<title>residual2_1_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3035.5,-2488.69 2880.5,-2488.69 2880.5,-2420.69 3035.5,-2420.69 3035.5,-2488.69"/>
<text text-anchor="middle" x="2958" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2958" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2958" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2958" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu5&#45;&gt;residual2_1_gpu5 -->
<g id="edge70" class="edge">
<title>residual1_1_gpu5&#45;&gt;residual2_1_gpu5</title>
<path fill="none" stroke="black" d="M3034.77,-2972.67C3047.33,-2962.49 3060.83,-2950.02 3071,-2936.69 3139.31,-2847.21 3170.8,-2807.69 3152,-2696.69 3138.48,-2616.87 3145.11,-2585.8 3092,-2524.69 3079.06,-2509.81 3062.13,-2497.71 3044.68,-2488.04"/>
<polygon fill="black" stroke="black" points="3046,-2484.78 3035.52,-2483.21 3042.73,-2490.97 3046,-2484.78"/>
</g>
<!-- expert_1_gpu5_exp1 -->
<g id="node40" class="node">
<title>expert_1_gpu5_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-2764.69 3007.5,-2764.69 3007.5,-2696.69 3142.5,-2696.69 3142.5,-2764.69"/>
<text text-anchor="middle" x="3075" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3075" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3075" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3075" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu5 -->
<g id="node45" class="node">
<title>agg_1_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="3082.89,-2660.69 2826.95,-2660.69 2761.11,-2524.69 3017.05,-2524.69 3082.89,-2660.69"/>
<text text-anchor="middle" x="2922" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2922" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2922" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu5_exp1&#45;&gt;agg_1_gpu5 -->
<g id="edge65" class="edge">
<title>expert_1_gpu5_exp1&#45;&gt;agg_1_gpu5</title>
<path fill="none" stroke="black" d="M3037.57,-2696.42C3027.72,-2687.67 3016.7,-2677.87 3005.47,-2667.89"/>
<polygon fill="black" stroke="black" points="3007.47,-2664.98 2997.67,-2660.96 3002.82,-2670.22 3007.47,-2664.98"/>
</g>
<!-- expert_1_gpu5_exp2 -->
<g id="node41" class="node">
<title>expert_1_gpu5_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2683.5,-2764.69 2548.5,-2764.69 2548.5,-2696.69 2683.5,-2696.69 2683.5,-2764.69"/>
<text text-anchor="middle" x="2616" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2616" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2616" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2616" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu5_exp2&#45;&gt;agg_1_gpu5 -->
<g id="edge66" class="edge">
<title>expert_1_gpu5_exp2&#45;&gt;agg_1_gpu5</title>
<path fill="none" stroke="black" d="M2683.53,-2699.68C2720.02,-2683.46 2766.05,-2663.01 2807.91,-2644.4"/>
<polygon fill="black" stroke="black" points="2809.34,-2647.6 2817.06,-2640.34 2806.5,-2641.2 2809.34,-2647.6"/>
</g>
<!-- expert_1_gpu5_exp3 -->
<g id="node42" class="node">
<title>expert_1_gpu5_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2836.5,-2764.69 2701.5,-2764.69 2701.5,-2696.69 2836.5,-2696.69 2836.5,-2764.69"/>
<text text-anchor="middle" x="2769" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2769" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2769" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2769" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu5_exp3&#45;&gt;agg_1_gpu5 -->
<g id="edge67" class="edge">
<title>expert_1_gpu5_exp3&#45;&gt;agg_1_gpu5</title>
<path fill="none" stroke="black" d="M2806.43,-2696.42C2816.28,-2687.67 2827.3,-2677.87 2838.53,-2667.89"/>
<polygon fill="black" stroke="black" points="2841.18,-2670.22 2846.33,-2660.96 2836.53,-2664.98 2841.18,-2670.22"/>
</g>
<!-- expert_1_gpu5_exp4 -->
<g id="node43" class="node">
<title>expert_1_gpu5_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-2764.69 2854.5,-2764.69 2854.5,-2696.69 2989.5,-2696.69 2989.5,-2764.69"/>
<text text-anchor="middle" x="2922" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2922" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="2922" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu5_exp4&#45;&gt;agg_1_gpu5 -->
<g id="edge68" class="edge">
<title>expert_1_gpu5_exp4&#45;&gt;agg_1_gpu5</title>
<path fill="none" stroke="black" d="M2922,-2696.42C2922,-2688.6 2922,-2679.93 2922,-2671.05"/>
<polygon fill="black" stroke="black" points="2925.5,-2670.96 2922,-2660.96 2918.5,-2670.96 2925.5,-2670.96"/>
</g>
<!-- gate_1_gpu5&#45;&gt;expert_1_gpu5_exp1 -->
<g id="edge61" class="edge">
<title>gate_1_gpu5&#45;&gt;expert_1_gpu5_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.6,-2800.49C3008.76,-2790.57 3019.95,-2780.63 3030.21,-2771.51"/>
<polygon fill="black" stroke="black" points="3032.71,-2773.97 3037.86,-2764.71 3028.06,-2768.74 3032.71,-2773.97"/>
</g>
<!-- gate_1_gpu5&#45;&gt;expert_1_gpu5_exp2 -->
<g id="edge62" class="edge">
<title>gate_1_gpu5&#45;&gt;expert_1_gpu5_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2784.22,-2806.46C2752.86,-2792.52 2720.65,-2778.2 2692.91,-2765.87"/>
<polygon fill="black" stroke="black" points="2694.24,-2762.64 2683.68,-2761.77 2691.4,-2769.03 2694.24,-2762.64"/>
</g>
<!-- gate_1_gpu5&#45;&gt;expert_1_gpu5_exp3 -->
<g id="edge63" class="edge">
<title>gate_1_gpu5&#45;&gt;expert_1_gpu5_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2846.4,-2800.49C2835.24,-2790.57 2824.05,-2780.63 2813.79,-2771.51"/>
<polygon fill="black" stroke="black" points="2815.94,-2768.74 2806.14,-2764.71 2811.29,-2773.97 2815.94,-2768.74"/>
</g>
<!-- gate_1_gpu5&#45;&gt;expert_1_gpu5_exp4 -->
<g id="edge64" class="edge">
<title>gate_1_gpu5&#45;&gt;expert_1_gpu5_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2922,-2800.49C2922,-2791.74 2922,-2782.97 2922,-2774.76"/>
<polygon fill="black" stroke="black" points="2925.5,-2774.71 2922,-2764.71 2918.5,-2774.71 2925.5,-2774.71"/>
</g>
<!-- agg_1_gpu5&#45;&gt;residual2_1_gpu5 -->
<g id="edge69" class="edge">
<title>agg_1_gpu5&#45;&gt;residual2_1_gpu5</title>
<path fill="none" stroke="black" d="M2939.79,-2524.49C2942.13,-2515.64 2944.48,-2506.77 2946.67,-2498.49"/>
<polygon fill="black" stroke="black" points="2950.08,-2499.27 2949.26,-2488.71 2943.32,-2497.48 2950.08,-2499.27"/>
</g>
<!-- mha_2_gpu5 -->
<g id="node110" class="node">
<title>mha_2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3011.5,-2384.69 2856.5,-2384.69 2856.5,-2331.69 3011.5,-2331.69 3011.5,-2384.69"/>
<text text-anchor="middle" x="2934" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="2934" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2934" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu5&#45;&gt;mha_2_gpu5 -->
<g id="edge173" class="edge">
<title>residual2_1_gpu5&#45;&gt;mha_2_gpu5</title>
<path fill="none" stroke="black" d="M2949.61,-2420.64C2947.49,-2412.32 2945.21,-2403.34 2943.07,-2394.9"/>
<polygon fill="black" stroke="black" points="2946.39,-2393.76 2940.54,-2384.93 2939.61,-2395.48 2946.39,-2393.76"/>
</g>
<!-- residual1_2_gpu5 -->
<g id="node111" class="node">
<title>residual1_2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3047.5,-2295.69 2892.5,-2295.69 2892.5,-2242.69 3047.5,-2242.69 3047.5,-2295.69"/>
<text text-anchor="middle" x="2970" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2970" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2970" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu5&#45;&gt;residual1_2_gpu5 -->
<g id="edge175" class="edge">
<title>residual2_1_gpu5&#45;&gt;residual1_2_gpu5</title>
<path fill="none" stroke="black" d="M2997.45,-2420.39C3006.99,-2410.03 3015.9,-2397.85 3021,-2384.69 3029.52,-2362.73 3028.99,-2353.85 3021,-2331.69 3017.36,-2321.61 3011.27,-2312.01 3004.54,-2303.52"/>
<polygon fill="black" stroke="black" points="3007.09,-2301.1 2997.95,-2295.74 3001.74,-2305.63 3007.09,-2301.1"/>
</g>
<!-- mha_1_gpu6&#45;&gt;residual1_1_gpu6 -->
<g id="edge72" class="edge">
<title>mha_1_gpu6&#45;&gt;residual1_1_gpu6</title>
<path fill="none" stroke="black" d="M2671.6,-3063.63C2674.77,-3062.93 2677.91,-3062.28 2681,-3061.69 2858.56,-3028.12 2906.15,-3043.28 3086,-3025.69 3136.1,-3020.79 3192.05,-3014.85 3237.21,-3009.93"/>
<polygon fill="black" stroke="black" points="3237.71,-3013.4 3247.27,-3008.84 3236.95,-3006.44 3237.71,-3013.4"/>
</g>
<!-- gate_1_gpu6 -->
<g id="node53" class="node">
<title>gate_1_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="3541.92,-2936.69 3319.34,-2936.69 3262.08,-2800.69 3484.66,-2800.69 3541.92,-2936.69"/>
<text text-anchor="middle" x="3402" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3402" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3402" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3402" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu6&#45;&gt;gate_1_gpu6 -->
<g id="edge74" class="edge">
<title>residual1_1_gpu6&#45;&gt;gate_1_gpu6</title>
<path fill="none" stroke="black" d="M3340.4,-2972.5C3345.22,-2964.45 3350.8,-2955.13 3356.61,-2945.45"/>
<polygon fill="black" stroke="black" points="3359.61,-2947.24 3361.75,-2936.87 3353.61,-2943.65 3359.61,-2947.24"/>
</g>
<!-- residual2_1_gpu6 -->
<g id="node55" class="node">
<title>residual2_1_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3848.5,-2488.69 3693.5,-2488.69 3693.5,-2420.69 3848.5,-2420.69 3848.5,-2488.69"/>
<text text-anchor="middle" x="3771" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3771" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3771" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3771" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu6&#45;&gt;residual2_1_gpu6 -->
<g id="edge84" class="edge">
<title>residual1_1_gpu6&#45;&gt;residual2_1_gpu6</title>
<path fill="none" stroke="black" d="M3402.85,-2986.79C3513.81,-2965.7 3712.11,-2908.73 3785,-2764.69 3828.53,-2678.68 3804.13,-2561.36 3785.66,-2498.93"/>
<polygon fill="black" stroke="black" points="3788.91,-2497.58 3782.64,-2489.03 3782.21,-2499.62 3788.91,-2497.58"/>
</g>
<!-- expert_1_gpu6_exp1 -->
<g id="node49" class="node">
<title>expert_1_gpu6_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3622.5,-2764.69 3487.5,-2764.69 3487.5,-2696.69 3622.5,-2696.69 3622.5,-2764.69"/>
<text text-anchor="middle" x="3555" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3555" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3555" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu6 -->
<g id="node54" class="node">
<title>agg_1_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="3715.89,-2660.69 3459.95,-2660.69 3394.11,-2524.69 3650.05,-2524.69 3715.89,-2660.69"/>
<text text-anchor="middle" x="3555" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="3555" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3555" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu6_exp1&#45;&gt;agg_1_gpu6 -->
<g id="edge79" class="edge">
<title>expert_1_gpu6_exp1&#45;&gt;agg_1_gpu6</title>
<path fill="none" stroke="black" d="M3555,-2696.42C3555,-2688.6 3555,-2679.93 3555,-2671.05"/>
<polygon fill="black" stroke="black" points="3558.5,-2670.96 3555,-2660.96 3551.5,-2670.96 3558.5,-2670.96"/>
</g>
<!-- expert_1_gpu6_exp2 -->
<g id="node50" class="node">
<title>expert_1_gpu6_exp2</title>
<polygon fill="lightgreen" stroke="black" points="3775.5,-2764.69 3640.5,-2764.69 3640.5,-2696.69 3775.5,-2696.69 3775.5,-2764.69"/>
<text text-anchor="middle" x="3708" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3708" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3708" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3708" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu6_exp2&#45;&gt;agg_1_gpu6 -->
<g id="edge80" class="edge">
<title>expert_1_gpu6_exp2&#45;&gt;agg_1_gpu6</title>
<path fill="none" stroke="black" d="M3670.57,-2696.42C3660.72,-2687.67 3649.7,-2677.87 3638.47,-2667.89"/>
<polygon fill="black" stroke="black" points="3640.47,-2664.98 3630.67,-2660.96 3635.82,-2670.22 3640.47,-2664.98"/>
</g>
<!-- expert_1_gpu6_exp3 -->
<g id="node51" class="node">
<title>expert_1_gpu6_exp3</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-2764.69 3181.5,-2764.69 3181.5,-2696.69 3316.5,-2696.69 3316.5,-2764.69"/>
<text text-anchor="middle" x="3249" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3249" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3249" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3249" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu6_exp3&#45;&gt;agg_1_gpu6 -->
<g id="edge81" class="edge">
<title>expert_1_gpu6_exp3&#45;&gt;agg_1_gpu6</title>
<path fill="none" stroke="black" d="M3316.53,-2699.68C3353.02,-2683.46 3399.05,-2663.01 3440.91,-2644.4"/>
<polygon fill="black" stroke="black" points="3442.34,-2647.6 3450.06,-2640.34 3439.5,-2641.2 3442.34,-2647.6"/>
</g>
<!-- expert_1_gpu6_exp4 -->
<g id="node52" class="node">
<title>expert_1_gpu6_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3469.5,-2764.69 3334.5,-2764.69 3334.5,-2696.69 3469.5,-2696.69 3469.5,-2764.69"/>
<text text-anchor="middle" x="3402" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3402" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3402" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3402" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu6_exp4&#45;&gt;agg_1_gpu6 -->
<g id="edge82" class="edge">
<title>expert_1_gpu6_exp4&#45;&gt;agg_1_gpu6</title>
<path fill="none" stroke="black" d="M3439.43,-2696.42C3449.28,-2687.67 3460.3,-2677.87 3471.53,-2667.89"/>
<polygon fill="black" stroke="black" points="3474.18,-2670.22 3479.33,-2660.96 3469.53,-2664.98 3474.18,-2670.22"/>
</g>
<!-- gate_1_gpu6&#45;&gt;expert_1_gpu6_exp1 -->
<g id="edge75" class="edge">
<title>gate_1_gpu6&#45;&gt;expert_1_gpu6_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3477.6,-2800.49C3488.76,-2790.57 3499.95,-2780.63 3510.21,-2771.51"/>
<polygon fill="black" stroke="black" points="3512.71,-2773.97 3517.86,-2764.71 3508.06,-2768.74 3512.71,-2773.97"/>
</g>
<!-- gate_1_gpu6&#45;&gt;expert_1_gpu6_exp2 -->
<g id="edge76" class="edge">
<title>gate_1_gpu6&#45;&gt;expert_1_gpu6_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3495.47,-2826.15C3538.94,-2806.83 3590,-2784.14 3631.17,-2765.84"/>
<polygon fill="black" stroke="black" points="3632.62,-2769.03 3640.34,-2761.77 3629.78,-2762.63 3632.62,-2769.03"/>
</g>
<!-- gate_1_gpu6&#45;&gt;expert_1_gpu6_exp3 -->
<g id="edge77" class="edge">
<title>gate_1_gpu6&#45;&gt;expert_1_gpu6_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3326.4,-2800.49C3315.24,-2790.57 3304.05,-2780.63 3293.79,-2771.51"/>
<polygon fill="black" stroke="black" points="3295.94,-2768.74 3286.14,-2764.71 3291.29,-2773.97 3295.94,-2768.74"/>
</g>
<!-- gate_1_gpu6&#45;&gt;expert_1_gpu6_exp4 -->
<g id="edge78" class="edge">
<title>gate_1_gpu6&#45;&gt;expert_1_gpu6_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3402,-2800.49C3402,-2791.74 3402,-2782.97 3402,-2774.76"/>
<polygon fill="black" stroke="black" points="3405.5,-2774.71 3402,-2764.71 3398.5,-2774.71 3405.5,-2774.71"/>
</g>
<!-- agg_1_gpu6&#45;&gt;residual2_1_gpu6 -->
<g id="edge83" class="edge">
<title>agg_1_gpu6&#45;&gt;residual2_1_gpu6</title>
<path fill="none" stroke="black" d="M3652.89,-2530.06C3672.27,-2517.86 3692.08,-2505.38 3709.81,-2494.22"/>
<polygon fill="black" stroke="black" points="3711.74,-2497.14 3718.33,-2488.85 3708.01,-2491.22 3711.74,-2497.14"/>
</g>
<!-- mha_2_gpu6 -->
<g id="node119" class="node">
<title>mha_2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3788.5,-2384.69 3633.5,-2384.69 3633.5,-2331.69 3788.5,-2331.69 3788.5,-2384.69"/>
<text text-anchor="middle" x="3711" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="3711" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3711" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu6&#45;&gt;mha_2_gpu6 -->
<g id="edge188" class="edge">
<title>residual2_1_gpu6&#45;&gt;mha_2_gpu6</title>
<path fill="none" stroke="black" d="M3750.01,-2420.64C3744.44,-2411.86 3738.41,-2402.36 3732.79,-2393.51"/>
<polygon fill="black" stroke="black" points="3735.66,-2391.5 3727.34,-2384.93 3729.75,-2395.25 3735.66,-2391.5"/>
</g>
<!-- residual1_2_gpu6 -->
<g id="node120" class="node">
<title>residual1_2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3836.5,-2295.69 3681.5,-2295.69 3681.5,-2242.69 3836.5,-2242.69 3836.5,-2295.69"/>
<text text-anchor="middle" x="3759" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3759" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3759" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu6&#45;&gt;residual1_2_gpu6 -->
<g id="edge190" class="edge">
<title>residual2_1_gpu6&#45;&gt;residual1_2_gpu6</title>
<path fill="none" stroke="black" d="M3787.3,-2420.52C3797.28,-2395.82 3806.62,-2361.38 3798,-2331.69 3795.25,-2322.23 3790.56,-2312.83 3785.37,-2304.33"/>
<polygon fill="black" stroke="black" points="3788.23,-2302.3 3779.84,-2295.84 3782.36,-2306.13 3788.23,-2302.3"/>
</g>
<!-- mha_1_gpu7&#45;&gt;residual1_1_gpu7 -->
<g id="edge86" class="edge">
<title>mha_1_gpu7&#45;&gt;residual1_1_gpu7</title>
<path fill="none" stroke="black" d="M2844.59,-3063.53C2847.75,-3062.86 2850.9,-3062.24 2854,-3061.69 3098.73,-3018.48 3164,-3041.74 3412,-3025.69 3517.02,-3018.9 3637.82,-3011.06 3717.46,-3005.88"/>
<polygon fill="black" stroke="black" points="3717.7,-3009.37 3727.45,-3005.23 3717.24,-3002.39 3717.7,-3009.37"/>
</g>
<!-- gate_1_gpu7 -->
<g id="node62" class="node">
<title>gate_1_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="4174.92,-2936.69 3952.34,-2936.69 3895.08,-2800.69 4117.66,-2800.69 4174.92,-2936.69"/>
<text text-anchor="middle" x="4035" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4035" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4035" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4035" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu7&#45;&gt;gate_1_gpu7 -->
<g id="edge88" class="edge">
<title>residual1_1_gpu7&#45;&gt;gate_1_gpu7</title>
<path fill="none" stroke="black" d="M3850.72,-2972.65C3875.28,-2958.93 3906.56,-2941.45 3936.35,-2924.81"/>
<polygon fill="black" stroke="black" points="3938.1,-2927.84 3945.13,-2919.91 3934.69,-2921.73 3938.1,-2927.84"/>
</g>
<!-- residual2_1_gpu7 -->
<g id="node64" class="node">
<title>residual2_1_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4457.5,-2488.69 4302.5,-2488.69 4302.5,-2420.69 4457.5,-2420.69 4457.5,-2488.69"/>
<text text-anchor="middle" x="4380" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4380" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4380" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4380" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu7&#45;&gt;residual2_1_gpu7 -->
<g id="edge98" class="edge">
<title>residual1_1_gpu7&#45;&gt;residual2_1_gpu7</title>
<path fill="none" stroke="black" d="M3882.55,-2998.28C4024.21,-2993.54 4319.34,-2959.66 4418,-2764.69 4461.9,-2677.94 4425.35,-2560.55 4399.73,-2498.4"/>
<polygon fill="black" stroke="black" points="4402.84,-2496.76 4395.72,-2488.91 4396.39,-2499.49 4402.84,-2496.76"/>
</g>
<!-- expert_1_gpu7_exp1 -->
<g id="node58" class="node">
<title>expert_1_gpu7_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4102.5,-2764.69 3967.5,-2764.69 3967.5,-2696.69 4102.5,-2696.69 4102.5,-2764.69"/>
<text text-anchor="middle" x="4035" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4035" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4035" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4035" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu7 -->
<g id="node63" class="node">
<title>agg_1_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="4348.89,-2660.69 4092.95,-2660.69 4027.11,-2524.69 4283.05,-2524.69 4348.89,-2660.69"/>
<text text-anchor="middle" x="4188" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4188" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4188" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu7_exp1&#45;&gt;agg_1_gpu7 -->
<g id="edge93" class="edge">
<title>expert_1_gpu7_exp1&#45;&gt;agg_1_gpu7</title>
<path fill="none" stroke="black" d="M4072.43,-2696.42C4082.28,-2687.67 4093.3,-2677.87 4104.53,-2667.89"/>
<polygon fill="black" stroke="black" points="4107.18,-2670.22 4112.33,-2660.96 4102.53,-2664.98 4107.18,-2670.22"/>
</g>
<!-- expert_1_gpu7_exp2 -->
<g id="node59" class="node">
<title>expert_1_gpu7_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4255.5,-2764.69 4120.5,-2764.69 4120.5,-2696.69 4255.5,-2696.69 4255.5,-2764.69"/>
<text text-anchor="middle" x="4188" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4188" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4188" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu7_exp2&#45;&gt;agg_1_gpu7 -->
<g id="edge94" class="edge">
<title>expert_1_gpu7_exp2&#45;&gt;agg_1_gpu7</title>
<path fill="none" stroke="black" d="M4188,-2696.42C4188,-2688.6 4188,-2679.93 4188,-2671.05"/>
<polygon fill="black" stroke="black" points="4191.5,-2670.96 4188,-2660.96 4184.5,-2670.96 4191.5,-2670.96"/>
</g>
<!-- expert_1_gpu7_exp3 -->
<g id="node60" class="node">
<title>expert_1_gpu7_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4408.5,-2764.69 4273.5,-2764.69 4273.5,-2696.69 4408.5,-2696.69 4408.5,-2764.69"/>
<text text-anchor="middle" x="4341" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4341" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4341" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4341" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu7_exp3&#45;&gt;agg_1_gpu7 -->
<g id="edge95" class="edge">
<title>expert_1_gpu7_exp3&#45;&gt;agg_1_gpu7</title>
<path fill="none" stroke="black" d="M4303.57,-2696.42C4293.72,-2687.67 4282.7,-2677.87 4271.47,-2667.89"/>
<polygon fill="black" stroke="black" points="4273.47,-2664.98 4263.67,-2660.96 4268.82,-2670.22 4273.47,-2664.98"/>
</g>
<!-- expert_1_gpu7_exp4 -->
<g id="node61" class="node">
<title>expert_1_gpu7_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3949.5,-2764.69 3814.5,-2764.69 3814.5,-2696.69 3949.5,-2696.69 3949.5,-2764.69"/>
<text text-anchor="middle" x="3882" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3882" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="3882" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3882" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu7_exp4&#45;&gt;agg_1_gpu7 -->
<g id="edge96" class="edge">
<title>expert_1_gpu7_exp4&#45;&gt;agg_1_gpu7</title>
<path fill="none" stroke="black" d="M3949.53,-2699.68C3986.02,-2683.46 4032.05,-2663.01 4073.91,-2644.4"/>
<polygon fill="black" stroke="black" points="4075.34,-2647.6 4083.06,-2640.34 4072.5,-2641.2 4075.34,-2647.6"/>
</g>
<!-- gate_1_gpu7&#45;&gt;expert_1_gpu7_exp1 -->
<g id="edge89" class="edge">
<title>gate_1_gpu7&#45;&gt;expert_1_gpu7_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4035,-2800.49C4035,-2791.74 4035,-2782.97 4035,-2774.76"/>
<polygon fill="black" stroke="black" points="4038.5,-2774.71 4035,-2764.71 4031.5,-2774.71 4038.5,-2774.71"/>
</g>
<!-- gate_1_gpu7&#45;&gt;expert_1_gpu7_exp2 -->
<g id="edge90" class="edge">
<title>gate_1_gpu7&#45;&gt;expert_1_gpu7_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4110.6,-2800.49C4121.76,-2790.57 4132.95,-2780.63 4143.21,-2771.51"/>
<polygon fill="black" stroke="black" points="4145.71,-2773.97 4150.86,-2764.71 4141.06,-2768.74 4145.71,-2773.97"/>
</g>
<!-- gate_1_gpu7&#45;&gt;expert_1_gpu7_exp3 -->
<g id="edge91" class="edge">
<title>gate_1_gpu7&#45;&gt;expert_1_gpu7_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4128.47,-2826.15C4171.94,-2806.83 4223,-2784.14 4264.17,-2765.84"/>
<polygon fill="black" stroke="black" points="4265.62,-2769.03 4273.34,-2761.77 4262.78,-2762.63 4265.62,-2769.03"/>
</g>
<!-- gate_1_gpu7&#45;&gt;expert_1_gpu7_exp4 -->
<g id="edge92" class="edge">
<title>gate_1_gpu7&#45;&gt;expert_1_gpu7_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3959.4,-2800.49C3948.24,-2790.57 3937.05,-2780.63 3926.79,-2771.51"/>
<polygon fill="black" stroke="black" points="3928.94,-2768.74 3919.14,-2764.71 3924.29,-2773.97 3928.94,-2768.74"/>
</g>
<!-- agg_1_gpu7&#45;&gt;residual2_1_gpu7 -->
<g id="edge97" class="edge">
<title>agg_1_gpu7&#45;&gt;residual2_1_gpu7</title>
<path fill="none" stroke="black" d="M4282.59,-2524.69C4297.04,-2514.46 4311.52,-2504.2 4324.74,-2494.84"/>
<polygon fill="black" stroke="black" points="4327.09,-2497.46 4333.23,-2488.82 4323.05,-2491.74 4327.09,-2497.46"/>
</g>
<!-- mha_2_gpu7 -->
<g id="node128" class="node">
<title>mha_2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4421.5,-2384.69 4266.5,-2384.69 4266.5,-2331.69 4421.5,-2331.69 4421.5,-2384.69"/>
<text text-anchor="middle" x="4344" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="4344" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4344" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu7&#45;&gt;mha_2_gpu7 -->
<g id="edge203" class="edge">
<title>residual2_1_gpu7&#45;&gt;mha_2_gpu7</title>
<path fill="none" stroke="black" d="M4367.41,-2420.64C4364.17,-2412.13 4360.67,-2402.95 4357.39,-2394.34"/>
<polygon fill="black" stroke="black" points="4360.64,-2393.03 4353.8,-2384.93 4354.09,-2395.52 4360.64,-2393.03"/>
</g>
<!-- residual1_2_gpu7 -->
<g id="node129" class="node">
<title>residual1_2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4481.5,-2295.69 4326.5,-2295.69 4326.5,-2242.69 4481.5,-2242.69 4481.5,-2295.69"/>
<text text-anchor="middle" x="4404" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4404" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4404" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu7&#45;&gt;residual1_2_gpu7 -->
<g id="edge205" class="edge">
<title>residual2_1_gpu7&#45;&gt;residual1_2_gpu7</title>
<path fill="none" stroke="black" d="M4411.23,-2420.34C4419.26,-2409.74 4426.8,-2397.43 4431,-2384.69 4438.37,-2362.32 4435.84,-2354.75 4431,-2331.69 4429.12,-2322.74 4425.86,-2313.5 4422.23,-2304.98"/>
<polygon fill="black" stroke="black" points="4425.36,-2303.4 4418.04,-2295.73 4418.98,-2306.29 4425.36,-2303.4"/>
</g>
<!-- mha_1_gpu8&#45;&gt;residual1_1_gpu8 -->
<g id="edge100" class="edge">
<title>mha_1_gpu8&#45;&gt;residual1_1_gpu8</title>
<path fill="none" stroke="black" d="M3017.66,-3082.44C3262.13,-3067.47 4014.9,-3021.38 4273.05,-3005.58"/>
<polygon fill="black" stroke="black" points="4273.36,-3009.07 4283.13,-3004.96 4272.93,-3002.08 4273.36,-3009.07"/>
</g>
<!-- gate_1_gpu8 -->
<g id="node71" class="node">
<title>gate_1_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4807.92,-2936.69 4585.34,-2936.69 4528.08,-2800.69 4750.66,-2800.69 4807.92,-2936.69"/>
<text text-anchor="middle" x="4668" y="-2887.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4668" y="-2872.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4668" y="-2857.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4668" y="-2842.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_1_gpu8&#45;&gt;gate_1_gpu8 -->
<g id="edge102" class="edge">
<title>residual1_1_gpu8&#45;&gt;gate_1_gpu8</title>
<path fill="none" stroke="black" d="M4422.02,-2972.65C4462.59,-2955.67 4516.91,-2932.93 4564.18,-2913.15"/>
<polygon fill="black" stroke="black" points="4565.66,-2916.32 4573.54,-2909.23 4562.96,-2909.86 4565.66,-2916.32"/>
</g>
<!-- residual2_1_gpu8 -->
<g id="node73" class="node">
<title>residual2_1_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4934.5,-2488.69 4779.5,-2488.69 4779.5,-2420.69 4934.5,-2420.69 4934.5,-2488.69"/>
<text text-anchor="middle" x="4857" y="-2473.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4857" y="-2458.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4857" y="-2443.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4857" y="-2428.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_1_gpu8&#45;&gt;residual2_1_gpu8 -->
<g id="edge112" class="edge">
<title>residual1_1_gpu8&#45;&gt;residual2_1_gpu8</title>
<path fill="none" stroke="black" d="M4438.69,-2992.39C4550.33,-2983.25 4750.06,-2963.74 4817,-2936.69 4936.67,-2888.34 4992.72,-2879.86 5051,-2764.69 5087.46,-2692.64 4998.72,-2533.58 4991,-2524.69 4978.06,-2509.81 4961.13,-2497.71 4943.68,-2488.04"/>
<polygon fill="black" stroke="black" points="4945,-2484.78 4934.52,-2483.21 4941.73,-2490.97 4945,-2484.78"/>
</g>
<!-- expert_1_gpu8_exp1 -->
<g id="node67" class="node">
<title>expert_1_gpu8_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4582.5,-2764.69 4447.5,-2764.69 4447.5,-2696.69 4582.5,-2696.69 4582.5,-2764.69"/>
<text text-anchor="middle" x="4515" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4515" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4515" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4515" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_1_gpu8 -->
<g id="node72" class="node">
<title>agg_1_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="4981.89,-2660.69 4725.95,-2660.69 4660.11,-2524.69 4916.05,-2524.69 4981.89,-2660.69"/>
<text text-anchor="middle" x="4821" y="-2611.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4821" y="-2596.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4821" y="-2581.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-2566.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_1_gpu8_exp1&#45;&gt;agg_1_gpu8 -->
<g id="edge107" class="edge">
<title>expert_1_gpu8_exp1&#45;&gt;agg_1_gpu8</title>
<path fill="none" stroke="black" d="M4582.53,-2699.68C4619.02,-2683.46 4665.05,-2663.01 4706.91,-2644.4"/>
<polygon fill="black" stroke="black" points="4708.34,-2647.6 4716.06,-2640.34 4705.5,-2641.2 4708.34,-2647.6"/>
</g>
<!-- expert_1_gpu8_exp2 -->
<g id="node68" class="node">
<title>expert_1_gpu8_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4735.5,-2764.69 4600.5,-2764.69 4600.5,-2696.69 4735.5,-2696.69 4735.5,-2764.69"/>
<text text-anchor="middle" x="4668" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4668" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4668" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4668" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu8_exp2&#45;&gt;agg_1_gpu8 -->
<g id="edge108" class="edge">
<title>expert_1_gpu8_exp2&#45;&gt;agg_1_gpu8</title>
<path fill="none" stroke="black" d="M4705.43,-2696.42C4715.28,-2687.67 4726.3,-2677.87 4737.53,-2667.89"/>
<polygon fill="black" stroke="black" points="4740.18,-2670.22 4745.33,-2660.96 4735.53,-2664.98 4740.18,-2670.22"/>
</g>
<!-- expert_1_gpu8_exp3 -->
<g id="node69" class="node">
<title>expert_1_gpu8_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4888.5,-2764.69 4753.5,-2764.69 4753.5,-2696.69 4888.5,-2696.69 4888.5,-2764.69"/>
<text text-anchor="middle" x="4821" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4821" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4821" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu8_exp3&#45;&gt;agg_1_gpu8 -->
<g id="edge109" class="edge">
<title>expert_1_gpu8_exp3&#45;&gt;agg_1_gpu8</title>
<path fill="none" stroke="black" d="M4821,-2696.42C4821,-2688.6 4821,-2679.93 4821,-2671.05"/>
<polygon fill="black" stroke="black" points="4824.5,-2670.96 4821,-2660.96 4817.5,-2670.96 4824.5,-2670.96"/>
</g>
<!-- expert_1_gpu8_exp4 -->
<g id="node70" class="node">
<title>expert_1_gpu8_exp4</title>
<polygon fill="lightgreen" stroke="black" points="5041.5,-2764.69 4906.5,-2764.69 4906.5,-2696.69 5041.5,-2696.69 5041.5,-2764.69"/>
<text text-anchor="middle" x="4974" y="-2749.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4974" y="-2734.49" font-family="Times,serif" font-size="14.00">Layer 1</text>
<text text-anchor="middle" x="4974" y="-2719.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4974" y="-2704.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_1_gpu8_exp4&#45;&gt;agg_1_gpu8 -->
<g id="edge110" class="edge">
<title>expert_1_gpu8_exp4&#45;&gt;agg_1_gpu8</title>
<path fill="none" stroke="black" d="M4936.57,-2696.42C4926.72,-2687.67 4915.7,-2677.87 4904.47,-2667.89"/>
<polygon fill="black" stroke="black" points="4906.47,-2664.98 4896.67,-2660.96 4901.82,-2670.22 4906.47,-2664.98"/>
</g>
<!-- gate_1_gpu8&#45;&gt;expert_1_gpu8_exp1 -->
<g id="edge103" class="edge">
<title>gate_1_gpu8&#45;&gt;expert_1_gpu8_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4592.4,-2800.49C4581.24,-2790.57 4570.05,-2780.63 4559.79,-2771.51"/>
<polygon fill="black" stroke="black" points="4561.94,-2768.74 4552.14,-2764.71 4557.29,-2773.97 4561.94,-2768.74"/>
</g>
<!-- gate_1_gpu8&#45;&gt;expert_1_gpu8_exp2 -->
<g id="edge104" class="edge">
<title>gate_1_gpu8&#45;&gt;expert_1_gpu8_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4668,-2800.49C4668,-2791.74 4668,-2782.97 4668,-2774.76"/>
<polygon fill="black" stroke="black" points="4671.5,-2774.71 4668,-2764.71 4664.5,-2774.71 4671.5,-2774.71"/>
</g>
<!-- gate_1_gpu8&#45;&gt;expert_1_gpu8_exp3 -->
<g id="edge105" class="edge">
<title>gate_1_gpu8&#45;&gt;expert_1_gpu8_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4743.6,-2800.49C4754.76,-2790.57 4765.95,-2780.63 4776.21,-2771.51"/>
<polygon fill="black" stroke="black" points="4778.71,-2773.97 4783.86,-2764.71 4774.06,-2768.74 4778.71,-2773.97"/>
</g>
<!-- gate_1_gpu8&#45;&gt;expert_1_gpu8_exp4 -->
<g id="edge106" class="edge">
<title>gate_1_gpu8&#45;&gt;expert_1_gpu8_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4761.47,-2826.15C4804.94,-2806.83 4856,-2784.14 4897.17,-2765.84"/>
<polygon fill="black" stroke="black" points="4898.62,-2769.03 4906.34,-2761.77 4895.78,-2762.63 4898.62,-2769.03"/>
</g>
<!-- agg_1_gpu8&#45;&gt;residual2_1_gpu8 -->
<g id="edge111" class="edge">
<title>agg_1_gpu8&#45;&gt;residual2_1_gpu8</title>
<path fill="none" stroke="black" d="M4838.79,-2524.49C4841.13,-2515.64 4843.48,-2506.77 4845.67,-2498.49"/>
<polygon fill="black" stroke="black" points="4849.08,-2499.27 4848.26,-2488.71 4842.32,-2497.48 4849.08,-2499.27"/>
</g>
<!-- mha_2_gpu8 -->
<g id="node137" class="node">
<title>mha_2_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4910.5,-2384.69 4755.5,-2384.69 4755.5,-2331.69 4910.5,-2331.69 4910.5,-2384.69"/>
<text text-anchor="middle" x="4833" y="-2369.49" font-family="Times,serif" font-size="14.00">MHA Layer 2</text>
<text text-anchor="middle" x="4833" y="-2354.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4833" y="-2339.49" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_1_gpu8&#45;&gt;mha_2_gpu8 -->
<g id="edge218" class="edge">
<title>residual2_1_gpu8&#45;&gt;mha_2_gpu8</title>
<path fill="none" stroke="black" d="M4848.61,-2420.64C4846.49,-2412.32 4844.21,-2403.34 4842.07,-2394.9"/>
<polygon fill="black" stroke="black" points="4845.39,-2393.76 4839.54,-2384.93 4838.61,-2395.48 4845.39,-2393.76"/>
</g>
<!-- residual1_2_gpu8 -->
<g id="node138" class="node">
<title>residual1_2_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4946.5,-2295.69 4791.5,-2295.69 4791.5,-2242.69 4946.5,-2242.69 4946.5,-2295.69"/>
<text text-anchor="middle" x="4869" y="-2280.49" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4869" y="-2265.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4869" y="-2250.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_1_gpu8&#45;&gt;residual1_2_gpu8 -->
<g id="edge220" class="edge">
<title>residual2_1_gpu8&#45;&gt;residual1_2_gpu8</title>
<path fill="none" stroke="black" d="M4896.45,-2420.39C4905.99,-2410.03 4914.9,-2397.85 4920,-2384.69 4928.52,-2362.73 4927.99,-2353.85 4920,-2331.69 4916.36,-2321.61 4910.27,-2312.01 4903.54,-2303.52"/>
<polygon fill="black" stroke="black" points="4906.09,-2301.1 4896.95,-2295.74 4900.74,-2305.63 4906.09,-2301.1"/>
</g>
<!-- mha_2_gpu1&#45;&gt;residual1_2_gpu1 -->
<g id="edge114" class="edge">
<title>mha_2_gpu1&#45;&gt;residual1_2_gpu1</title>
<path fill="none" stroke="black" d="M379.44,-2331.56C384.18,-2323.14 389.53,-2313.64 394.58,-2304.67"/>
<polygon fill="black" stroke="black" points="397.64,-2306.37 399.5,-2295.94 391.54,-2302.94 397.64,-2306.37"/>
</g>
<!-- gate_2_gpu1 -->
<g id="node80" class="node">
<title>gate_2_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="529.92,-2206.69 307.34,-2206.69 250.08,-2070.69 472.66,-2070.69 529.92,-2206.69"/>
<text text-anchor="middle" x="390" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="390" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="390" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu1&#45;&gt;gate_2_gpu1 -->
<g id="edge116" class="edge">
<title>residual1_2_gpu1&#45;&gt;gate_2_gpu1</title>
<path fill="none" stroke="black" d="M409.2,-2242.5C407.77,-2234.86 406.13,-2226.07 404.42,-2216.91"/>
<polygon fill="black" stroke="black" points="407.82,-2216.05 402.55,-2206.87 400.94,-2217.34 407.82,-2216.05"/>
</g>
<!-- residual2_2_gpu1 -->
<g id="node82" class="node">
<title>residual2_2_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="707.5,-1758.69 552.5,-1758.69 552.5,-1690.69 707.5,-1690.69 707.5,-1758.69"/>
<text text-anchor="middle" x="630" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="630" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="630" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="630" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu1&#45;&gt;residual2_2_gpu1 -->
<g id="edge126" class="edge">
<title>residual1_2_gpu1&#45;&gt;residual2_2_gpu1</title>
<path fill="none" stroke="black" d="M486.59,-2242.68C505.35,-2233.52 524.37,-2221.65 539,-2206.69 597.96,-2146.43 599.33,-2116.68 619,-2034.69 641.21,-1942.12 637.93,-1829.51 633.81,-1769.05"/>
<polygon fill="black" stroke="black" points="637.28,-1768.47 633.07,-1758.75 630.3,-1768.97 637.28,-1768.47"/>
</g>
<!-- expert_2_gpu1_exp1 -->
<g id="node76" class="node">
<title>expert_2_gpu1_exp1</title>
<polygon fill="lightgreen" stroke="black" points="610.5,-2034.69 475.5,-2034.69 475.5,-1966.69 610.5,-1966.69 610.5,-2034.69"/>
<text text-anchor="middle" x="543" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="543" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="543" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="543" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu1 -->
<g id="node81" class="node">
<title>agg_2_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="550.89,-1930.69 294.95,-1930.69 229.11,-1794.69 485.05,-1794.69 550.89,-1930.69"/>
<text text-anchor="middle" x="390" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="390" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="390" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu1_exp1&#45;&gt;agg_2_gpu1 -->
<g id="edge121" class="edge">
<title>expert_2_gpu1_exp1&#45;&gt;agg_2_gpu1</title>
<path fill="none" stroke="black" d="M505.57,-1966.42C495.72,-1957.67 484.7,-1947.87 473.47,-1937.89"/>
<polygon fill="black" stroke="black" points="475.47,-1934.98 465.67,-1930.96 470.82,-1940.22 475.47,-1934.98"/>
</g>
<!-- expert_2_gpu1_exp2 -->
<g id="node77" class="node">
<title>expert_2_gpu1_exp2</title>
<polygon fill="lightgreen" stroke="black" points="151.5,-2034.69 16.5,-2034.69 16.5,-1966.69 151.5,-1966.69 151.5,-2034.69"/>
<text text-anchor="middle" x="84" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="84" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="84" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="84" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu1_exp2&#45;&gt;agg_2_gpu1 -->
<g id="edge122" class="edge">
<title>expert_2_gpu1_exp2&#45;&gt;agg_2_gpu1</title>
<path fill="none" stroke="black" d="M151.53,-1969.68C188.02,-1953.46 234.05,-1933.01 275.91,-1914.4"/>
<polygon fill="black" stroke="black" points="277.34,-1917.6 285.06,-1910.34 274.5,-1911.2 277.34,-1917.6"/>
</g>
<!-- expert_2_gpu1_exp3 -->
<g id="node78" class="node">
<title>expert_2_gpu1_exp3</title>
<polygon fill="lightgreen" stroke="black" points="304.5,-2034.69 169.5,-2034.69 169.5,-1966.69 304.5,-1966.69 304.5,-2034.69"/>
<text text-anchor="middle" x="237" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="237" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="237" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="237" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu1_exp3&#45;&gt;agg_2_gpu1 -->
<g id="edge123" class="edge">
<title>expert_2_gpu1_exp3&#45;&gt;agg_2_gpu1</title>
<path fill="none" stroke="black" d="M274.43,-1966.42C284.28,-1957.67 295.3,-1947.87 306.53,-1937.89"/>
<polygon fill="black" stroke="black" points="309.18,-1940.22 314.33,-1930.96 304.53,-1934.98 309.18,-1940.22"/>
</g>
<!-- expert_2_gpu1_exp4 -->
<g id="node79" class="node">
<title>expert_2_gpu1_exp4</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-2034.69 322.5,-2034.69 322.5,-1966.69 457.5,-1966.69 457.5,-2034.69"/>
<text text-anchor="middle" x="390" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="390" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="390" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu1_exp4&#45;&gt;agg_2_gpu1 -->
<g id="edge124" class="edge">
<title>expert_2_gpu1_exp4&#45;&gt;agg_2_gpu1</title>
<path fill="none" stroke="black" d="M390,-1966.42C390,-1958.6 390,-1949.93 390,-1941.05"/>
<polygon fill="black" stroke="black" points="393.5,-1940.96 390,-1930.96 386.5,-1940.96 393.5,-1940.96"/>
</g>
<!-- gate_2_gpu1&#45;&gt;expert_2_gpu1_exp1 -->
<g id="edge117" class="edge">
<title>gate_2_gpu1&#45;&gt;expert_2_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M465.6,-2070.49C476.76,-2060.57 487.95,-2050.63 498.21,-2041.51"/>
<polygon fill="black" stroke="black" points="500.71,-2043.97 505.86,-2034.71 496.06,-2038.74 500.71,-2043.97"/>
</g>
<!-- gate_2_gpu1&#45;&gt;expert_2_gpu1_exp2 -->
<g id="edge118" class="edge">
<title>gate_2_gpu1&#45;&gt;expert_2_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M252.22,-2076.46C220.86,-2062.52 188.65,-2048.2 160.91,-2035.87"/>
<polygon fill="black" stroke="black" points="162.24,-2032.64 151.68,-2031.77 159.4,-2039.03 162.24,-2032.64"/>
</g>
<!-- gate_2_gpu1&#45;&gt;expert_2_gpu1_exp3 -->
<g id="edge119" class="edge">
<title>gate_2_gpu1&#45;&gt;expert_2_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M314.4,-2070.49C303.24,-2060.57 292.05,-2050.63 281.79,-2041.51"/>
<polygon fill="black" stroke="black" points="283.94,-2038.74 274.14,-2034.71 279.29,-2043.97 283.94,-2038.74"/>
</g>
<!-- gate_2_gpu1&#45;&gt;expert_2_gpu1_exp4 -->
<g id="edge120" class="edge">
<title>gate_2_gpu1&#45;&gt;expert_2_gpu1_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390,-2070.49C390,-2061.74 390,-2052.97 390,-2044.76"/>
<polygon fill="black" stroke="black" points="393.5,-2044.71 390,-2034.71 386.5,-2044.71 393.5,-2044.71"/>
</g>
<!-- agg_2_gpu1&#45;&gt;residual2_2_gpu1 -->
<g id="edge125" class="edge">
<title>agg_2_gpu1&#45;&gt;residual2_2_gpu1</title>
<path fill="none" stroke="black" d="M490.04,-1805C514.57,-1791.1 540.24,-1776.56 562.8,-1763.77"/>
<polygon fill="black" stroke="black" points="564.64,-1766.76 571.61,-1758.78 561.18,-1760.67 564.64,-1766.76"/>
</g>
<!-- comm_stage1_to_stage2_gpu1 -->
<g id="node290" class="node">
<title>comm_stage1_to_stage2_gpu1</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="630" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="630" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="630" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 1 Stage12</text>
<text text-anchor="middle" x="630" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu1&#45;&gt;comm_stage1_to_stage2_gpu1 -->
<g id="edge127" class="edge">
<title>residual2_2_gpu1&#45;&gt;comm_stage1_to_stage2_gpu1</title>
<path fill="none" stroke="black" d="M630,-1690.61C630,-1682.45 630,-1673.55 630,-1664.87"/>
<polygon fill="black" stroke="black" points="633.5,-1664.85 630,-1654.85 626.5,-1664.85 633.5,-1664.85"/>
</g>
<!-- mha_2_gpu2&#45;&gt;residual1_2_gpu2 -->
<g id="edge129" class="edge">
<title>mha_2_gpu2&#45;&gt;residual1_2_gpu2</title>
<path fill="none" stroke="black" d="M1121.14,-2331.56C1125.74,-2323.23 1130.92,-2313.84 1135.82,-2304.95"/>
<polygon fill="black" stroke="black" points="1139.03,-2306.39 1140.79,-2295.94 1132.9,-2303.01 1139.03,-2306.39"/>
</g>
<!-- gate_2_gpu2 -->
<g id="node89" class="node">
<title>gate_2_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="1162.92,-2206.69 940.34,-2206.69 883.08,-2070.69 1105.66,-2070.69 1162.92,-2206.69"/>
<text text-anchor="middle" x="1023" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1023" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1023" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu2&#45;&gt;gate_2_gpu2 -->
<g id="edge131" class="edge">
<title>residual1_2_gpu2&#45;&gt;gate_2_gpu2</title>
<path fill="none" stroke="black" d="M1128.61,-2242.5C1119.92,-2234.05 1109.79,-2224.19 1099.31,-2213.98"/>
<polygon fill="black" stroke="black" points="1101.61,-2211.34 1092,-2206.87 1096.73,-2216.35 1101.61,-2211.34"/>
</g>
<!-- residual2_2_gpu2 -->
<g id="node91" class="node">
<title>residual2_2_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1323.5,-1758.69 1168.5,-1758.69 1168.5,-1690.69 1323.5,-1690.69 1323.5,-1758.69"/>
<text text-anchor="middle" x="1246" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1246" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1246" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1246" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu2&#45;&gt;residual2_2_gpu2 -->
<g id="edge141" class="edge">
<title>residual1_2_gpu2&#45;&gt;residual2_2_gpu2</title>
<path fill="none" stroke="black" d="M1169.58,-2242.65C1192.53,-2200.81 1236.12,-2114.33 1252,-2034.69 1270.6,-1941.43 1260.57,-1829.18 1252.64,-1768.95"/>
<polygon fill="black" stroke="black" points="1256.1,-1768.47 1251.29,-1759.03 1249.17,-1769.41 1256.1,-1768.47"/>
</g>
<!-- expert_2_gpu2_exp1 -->
<g id="node85" class="node">
<title>expert_2_gpu2_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1090.5,-2034.69 955.5,-2034.69 955.5,-1966.69 1090.5,-1966.69 1090.5,-2034.69"/>
<text text-anchor="middle" x="1023" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1023" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1023" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu2 -->
<g id="node90" class="node">
<title>agg_2_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="1183.89,-1930.69 927.95,-1930.69 862.11,-1794.69 1118.05,-1794.69 1183.89,-1930.69"/>
<text text-anchor="middle" x="1023" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1023" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1023" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu2_exp1&#45;&gt;agg_2_gpu2 -->
<g id="edge136" class="edge">
<title>expert_2_gpu2_exp1&#45;&gt;agg_2_gpu2</title>
<path fill="none" stroke="black" d="M1023,-1966.42C1023,-1958.6 1023,-1949.93 1023,-1941.05"/>
<polygon fill="black" stroke="black" points="1026.5,-1940.96 1023,-1930.96 1019.5,-1940.96 1026.5,-1940.96"/>
</g>
<!-- expert_2_gpu2_exp2 -->
<g id="node86" class="node">
<title>expert_2_gpu2_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1243.5,-2034.69 1108.5,-2034.69 1108.5,-1966.69 1243.5,-1966.69 1243.5,-2034.69"/>
<text text-anchor="middle" x="1176" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1176" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1176" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1176" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu2_exp2&#45;&gt;agg_2_gpu2 -->
<g id="edge137" class="edge">
<title>expert_2_gpu2_exp2&#45;&gt;agg_2_gpu2</title>
<path fill="none" stroke="black" d="M1138.57,-1966.42C1128.72,-1957.67 1117.7,-1947.87 1106.47,-1937.89"/>
<polygon fill="black" stroke="black" points="1108.47,-1934.98 1098.67,-1930.96 1103.82,-1940.22 1108.47,-1934.98"/>
</g>
<!-- expert_2_gpu2_exp3 -->
<g id="node87" class="node">
<title>expert_2_gpu2_exp3</title>
<polygon fill="lightgreen" stroke="black" points="784.5,-2034.69 649.5,-2034.69 649.5,-1966.69 784.5,-1966.69 784.5,-2034.69"/>
<text text-anchor="middle" x="717" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="717" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="717" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="717" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu2_exp3&#45;&gt;agg_2_gpu2 -->
<g id="edge138" class="edge">
<title>expert_2_gpu2_exp3&#45;&gt;agg_2_gpu2</title>
<path fill="none" stroke="black" d="M784.53,-1969.68C821.02,-1953.46 867.05,-1933.01 908.91,-1914.4"/>
<polygon fill="black" stroke="black" points="910.34,-1917.6 918.06,-1910.34 907.5,-1911.2 910.34,-1917.6"/>
</g>
<!-- expert_2_gpu2_exp4 -->
<g id="node88" class="node">
<title>expert_2_gpu2_exp4</title>
<polygon fill="lightgreen" stroke="black" points="937.5,-2034.69 802.5,-2034.69 802.5,-1966.69 937.5,-1966.69 937.5,-2034.69"/>
<text text-anchor="middle" x="870" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="870" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="870" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="870" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu2_exp4&#45;&gt;agg_2_gpu2 -->
<g id="edge139" class="edge">
<title>expert_2_gpu2_exp4&#45;&gt;agg_2_gpu2</title>
<path fill="none" stroke="black" d="M907.43,-1966.42C917.28,-1957.67 928.3,-1947.87 939.53,-1937.89"/>
<polygon fill="black" stroke="black" points="942.18,-1940.22 947.33,-1930.96 937.53,-1934.98 942.18,-1940.22"/>
</g>
<!-- gate_2_gpu2&#45;&gt;expert_2_gpu2_exp1 -->
<g id="edge132" class="edge">
<title>gate_2_gpu2&#45;&gt;expert_2_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1023,-2070.49C1023,-2061.74 1023,-2052.97 1023,-2044.76"/>
<polygon fill="black" stroke="black" points="1026.5,-2044.71 1023,-2034.71 1019.5,-2044.71 1026.5,-2044.71"/>
</g>
<!-- gate_2_gpu2&#45;&gt;expert_2_gpu2_exp2 -->
<g id="edge133" class="edge">
<title>gate_2_gpu2&#45;&gt;expert_2_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1098.6,-2070.49C1109.76,-2060.57 1120.95,-2050.63 1131.21,-2041.51"/>
<polygon fill="black" stroke="black" points="1133.71,-2043.97 1138.86,-2034.71 1129.06,-2038.74 1133.71,-2043.97"/>
</g>
<!-- gate_2_gpu2&#45;&gt;expert_2_gpu2_exp3 -->
<g id="edge134" class="edge">
<title>gate_2_gpu2&#45;&gt;expert_2_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M885.22,-2076.46C853.86,-2062.52 821.65,-2048.2 793.91,-2035.87"/>
<polygon fill="black" stroke="black" points="795.24,-2032.64 784.68,-2031.77 792.4,-2039.03 795.24,-2032.64"/>
</g>
<!-- gate_2_gpu2&#45;&gt;expert_2_gpu2_exp4 -->
<g id="edge135" class="edge">
<title>gate_2_gpu2&#45;&gt;expert_2_gpu2_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M947.4,-2070.49C936.24,-2060.57 925.05,-2050.63 914.79,-2041.51"/>
<polygon fill="black" stroke="black" points="916.94,-2038.74 907.14,-2034.71 912.29,-2043.97 916.94,-2038.74"/>
</g>
<!-- agg_2_gpu2&#45;&gt;residual2_2_gpu2 -->
<g id="edge140" class="edge">
<title>agg_2_gpu2&#45;&gt;residual2_2_gpu2</title>
<path fill="none" stroke="black" d="M1121.46,-1801.65C1142.4,-1788.87 1163.97,-1775.72 1183.15,-1764.02"/>
<polygon fill="black" stroke="black" points="1185.07,-1766.95 1191.78,-1758.76 1181.42,-1760.98 1185.07,-1766.95"/>
</g>
<!-- comm_stage1_to_stage2_gpu2 -->
<g id="node291" class="node">
<title>comm_stage1_to_stage2_gpu2</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1246" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="1246" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="1246" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 2 Stage12</text>
<text text-anchor="middle" x="1246" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu2&#45;&gt;comm_stage1_to_stage2_gpu2 -->
<g id="edge142" class="edge">
<title>residual2_2_gpu2&#45;&gt;comm_stage1_to_stage2_gpu2</title>
<path fill="none" stroke="black" d="M1246,-1690.61C1246,-1682.45 1246,-1673.55 1246,-1664.87"/>
<polygon fill="black" stroke="black" points="1249.5,-1664.85 1246,-1654.85 1242.5,-1664.85 1249.5,-1664.85"/>
</g>
<!-- mha_2_gpu3&#45;&gt;residual1_2_gpu3 -->
<g id="edge144" class="edge">
<title>mha_2_gpu3&#45;&gt;residual1_2_gpu3</title>
<path fill="none" stroke="black" d="M1742.14,-2331.56C1746.74,-2323.23 1751.92,-2313.84 1756.82,-2304.95"/>
<polygon fill="black" stroke="black" points="1760.03,-2306.39 1761.79,-2295.94 1753.9,-2303.01 1760.03,-2306.39"/>
</g>
<!-- gate_2_gpu3 -->
<g id="node98" class="node">
<title>gate_2_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="1795.92,-2206.69 1573.34,-2206.69 1516.08,-2070.69 1738.66,-2070.69 1795.92,-2206.69"/>
<text text-anchor="middle" x="1656" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1656" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1656" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu3&#45;&gt;gate_2_gpu3 -->
<g id="edge146" class="edge">
<title>residual1_2_gpu3&#45;&gt;gate_2_gpu3</title>
<path fill="none" stroke="black" d="M1752,-2242.5C1744.19,-2234.13 1735.08,-2224.38 1725.65,-2214.27"/>
<polygon fill="black" stroke="black" points="1728.11,-2211.79 1718.73,-2206.87 1723,-2216.57 1728.11,-2211.79"/>
</g>
<!-- residual2_2_gpu3 -->
<g id="node100" class="node">
<title>residual2_2_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1758.5,-1758.69 1603.5,-1758.69 1603.5,-1690.69 1758.5,-1690.69 1758.5,-1758.69"/>
<text text-anchor="middle" x="1681" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1681" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1681" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1681" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu3&#45;&gt;residual2_2_gpu3 -->
<g id="edge156" class="edge">
<title>residual1_2_gpu3&#45;&gt;residual2_2_gpu3</title>
<path fill="none" stroke="black" d="M1795.41,-2242.46C1831.57,-2191.46 1904.06,-2073.27 1886,-1966.69 1872.48,-1886.87 1880.06,-1854.96 1826,-1794.69 1810.28,-1777.17 1789.16,-1763.7 1767.9,-1753.52"/>
<polygon fill="black" stroke="black" points="1769.35,-1750.33 1758.8,-1749.35 1766.44,-1756.69 1769.35,-1750.33"/>
</g>
<!-- expert_2_gpu3_exp1 -->
<g id="node94" class="node">
<title>expert_2_gpu3_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1570.5,-2034.69 1435.5,-2034.69 1435.5,-1966.69 1570.5,-1966.69 1570.5,-2034.69"/>
<text text-anchor="middle" x="1503" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1503" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1503" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1503" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu3 -->
<g id="node99" class="node">
<title>agg_2_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="1816.89,-1930.69 1560.95,-1930.69 1495.11,-1794.69 1751.05,-1794.69 1816.89,-1930.69"/>
<text text-anchor="middle" x="1656" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1656" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1656" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu3_exp1&#45;&gt;agg_2_gpu3 -->
<g id="edge151" class="edge">
<title>expert_2_gpu3_exp1&#45;&gt;agg_2_gpu3</title>
<path fill="none" stroke="black" d="M1540.43,-1966.42C1550.28,-1957.67 1561.3,-1947.87 1572.53,-1937.89"/>
<polygon fill="black" stroke="black" points="1575.18,-1940.22 1580.33,-1930.96 1570.53,-1934.98 1575.18,-1940.22"/>
</g>
<!-- expert_2_gpu3_exp2 -->
<g id="node95" class="node">
<title>expert_2_gpu3_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1723.5,-2034.69 1588.5,-2034.69 1588.5,-1966.69 1723.5,-1966.69 1723.5,-2034.69"/>
<text text-anchor="middle" x="1656" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1656" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1656" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu3_exp2&#45;&gt;agg_2_gpu3 -->
<g id="edge152" class="edge">
<title>expert_2_gpu3_exp2&#45;&gt;agg_2_gpu3</title>
<path fill="none" stroke="black" d="M1656,-1966.42C1656,-1958.6 1656,-1949.93 1656,-1941.05"/>
<polygon fill="black" stroke="black" points="1659.5,-1940.96 1656,-1930.96 1652.5,-1940.96 1659.5,-1940.96"/>
</g>
<!-- expert_2_gpu3_exp3 -->
<g id="node96" class="node">
<title>expert_2_gpu3_exp3</title>
<polygon fill="lightgreen" stroke="black" points="1876.5,-2034.69 1741.5,-2034.69 1741.5,-1966.69 1876.5,-1966.69 1876.5,-2034.69"/>
<text text-anchor="middle" x="1809" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1809" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1809" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1809" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu3_exp3&#45;&gt;agg_2_gpu3 -->
<g id="edge153" class="edge">
<title>expert_2_gpu3_exp3&#45;&gt;agg_2_gpu3</title>
<path fill="none" stroke="black" d="M1771.57,-1966.42C1761.72,-1957.67 1750.7,-1947.87 1739.47,-1937.89"/>
<polygon fill="black" stroke="black" points="1741.47,-1934.98 1731.67,-1930.96 1736.82,-1940.22 1741.47,-1934.98"/>
</g>
<!-- expert_2_gpu3_exp4 -->
<g id="node97" class="node">
<title>expert_2_gpu3_exp4</title>
<polygon fill="lightgreen" stroke="black" points="1417.5,-2034.69 1282.5,-2034.69 1282.5,-1966.69 1417.5,-1966.69 1417.5,-2034.69"/>
<text text-anchor="middle" x="1350" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1350" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1350" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1350" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu3_exp4&#45;&gt;agg_2_gpu3 -->
<g id="edge154" class="edge">
<title>expert_2_gpu3_exp4&#45;&gt;agg_2_gpu3</title>
<path fill="none" stroke="black" d="M1417.53,-1969.68C1454.02,-1953.46 1500.05,-1933.01 1541.91,-1914.4"/>
<polygon fill="black" stroke="black" points="1543.34,-1917.6 1551.06,-1910.34 1540.5,-1911.2 1543.34,-1917.6"/>
</g>
<!-- gate_2_gpu3&#45;&gt;expert_2_gpu3_exp1 -->
<g id="edge147" class="edge">
<title>gate_2_gpu3&#45;&gt;expert_2_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1580.4,-2070.49C1569.24,-2060.57 1558.05,-2050.63 1547.79,-2041.51"/>
<polygon fill="black" stroke="black" points="1549.94,-2038.74 1540.14,-2034.71 1545.29,-2043.97 1549.94,-2038.74"/>
</g>
<!-- gate_2_gpu3&#45;&gt;expert_2_gpu3_exp2 -->
<g id="edge148" class="edge">
<title>gate_2_gpu3&#45;&gt;expert_2_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1656,-2070.49C1656,-2061.74 1656,-2052.97 1656,-2044.76"/>
<polygon fill="black" stroke="black" points="1659.5,-2044.71 1656,-2034.71 1652.5,-2044.71 1659.5,-2044.71"/>
</g>
<!-- gate_2_gpu3&#45;&gt;expert_2_gpu3_exp3 -->
<g id="edge149" class="edge">
<title>gate_2_gpu3&#45;&gt;expert_2_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1731.6,-2070.49C1742.76,-2060.57 1753.95,-2050.63 1764.21,-2041.51"/>
<polygon fill="black" stroke="black" points="1766.71,-2043.97 1771.86,-2034.71 1762.06,-2038.74 1766.71,-2043.97"/>
</g>
<!-- gate_2_gpu3&#45;&gt;expert_2_gpu3_exp4 -->
<g id="edge150" class="edge">
<title>gate_2_gpu3&#45;&gt;expert_2_gpu3_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1518.22,-2076.46C1486.86,-2062.52 1454.65,-2048.2 1426.91,-2035.87"/>
<polygon fill="black" stroke="black" points="1428.24,-2032.64 1417.68,-2031.77 1425.4,-2039.03 1428.24,-2032.64"/>
</g>
<!-- agg_2_gpu3&#45;&gt;residual2_2_gpu3 -->
<g id="edge155" class="edge">
<title>agg_2_gpu3&#45;&gt;residual2_2_gpu3</title>
<path fill="none" stroke="black" d="M1668.35,-1794.49C1669.96,-1785.74 1671.57,-1776.97 1673.08,-1768.76"/>
<polygon fill="black" stroke="black" points="1676.57,-1769.18 1674.93,-1758.71 1669.68,-1767.91 1676.57,-1769.18"/>
</g>
<!-- comm_stage1_to_stage2_gpu3 -->
<g id="node292" class="node">
<title>comm_stage1_to_stage2_gpu3</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="1681" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="1681" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="1681" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 3 Stage12</text>
<text text-anchor="middle" x="1681" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu3&#45;&gt;comm_stage1_to_stage2_gpu3 -->
<g id="edge157" class="edge">
<title>residual2_2_gpu3&#45;&gt;comm_stage1_to_stage2_gpu3</title>
<path fill="none" stroke="black" d="M1681,-1690.61C1681,-1682.45 1681,-1673.55 1681,-1664.87"/>
<polygon fill="black" stroke="black" points="1684.5,-1664.85 1681,-1654.85 1677.5,-1664.85 1684.5,-1664.85"/>
</g>
<!-- mha_2_gpu4&#45;&gt;residual1_2_gpu4 -->
<g id="edge159" class="edge">
<title>mha_2_gpu4&#45;&gt;residual1_2_gpu4</title>
<path fill="none" stroke="black" d="M2387.14,-2331.56C2391.74,-2323.23 2396.92,-2313.84 2401.82,-2304.95"/>
<polygon fill="black" stroke="black" points="2405.03,-2306.39 2406.79,-2295.94 2398.9,-2303.01 2405.03,-2306.39"/>
</g>
<!-- gate_2_gpu4 -->
<g id="node107" class="node">
<title>gate_2_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="2428.92,-2206.69 2206.34,-2206.69 2149.08,-2070.69 2371.66,-2070.69 2428.92,-2206.69"/>
<text text-anchor="middle" x="2289" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2289" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2289" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu4&#45;&gt;gate_2_gpu4 -->
<g id="edge161" class="edge">
<title>residual1_2_gpu4&#45;&gt;gate_2_gpu4</title>
<path fill="none" stroke="black" d="M2394.61,-2242.5C2385.92,-2234.05 2375.79,-2224.19 2365.31,-2213.98"/>
<polygon fill="black" stroke="black" points="2367.61,-2211.34 2358,-2206.87 2362.73,-2216.35 2367.61,-2211.34"/>
</g>
<!-- residual2_2_gpu4 -->
<g id="node109" class="node">
<title>residual2_2_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2327.5,-1758.69 2172.5,-1758.69 2172.5,-1690.69 2327.5,-1690.69 2327.5,-1758.69"/>
<text text-anchor="middle" x="2250" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2250" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2250" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2250" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu4&#45;&gt;residual2_2_gpu4 -->
<g id="edge171" class="edge">
<title>residual1_2_gpu4&#45;&gt;residual2_2_gpu4</title>
<path fill="none" stroke="black" d="M2439.76,-2242.66C2475.34,-2191.04 2546.71,-2070.38 2519,-1966.69 2496.23,-1881.48 2486.48,-1852.66 2420,-1794.69 2396.49,-1774.19 2366.09,-1759.28 2337.51,-1748.68"/>
<polygon fill="black" stroke="black" points="2338.5,-1745.32 2327.9,-1745.25 2336.14,-1751.91 2338.5,-1745.32"/>
</g>
<!-- expert_2_gpu4_exp1 -->
<g id="node103" class="node">
<title>expert_2_gpu4_exp1</title>
<polygon fill="lightgreen" stroke="black" points="2050.5,-2034.69 1915.5,-2034.69 1915.5,-1966.69 2050.5,-1966.69 2050.5,-2034.69"/>
<text text-anchor="middle" x="1983" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1983" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="1983" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1983" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu4 -->
<g id="node108" class="node">
<title>agg_2_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="2410.89,-1930.69 2154.95,-1930.69 2089.11,-1794.69 2345.05,-1794.69 2410.89,-1930.69"/>
<text text-anchor="middle" x="2250" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2250" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2250" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2250" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu4_exp1&#45;&gt;agg_2_gpu4 -->
<g id="edge166" class="edge">
<title>expert_2_gpu4_exp1&#45;&gt;agg_2_gpu4</title>
<path fill="none" stroke="black" d="M2047.97,-1966.6C2075.23,-1952.72 2107.71,-1936.17 2138.58,-1920.45"/>
<polygon fill="black" stroke="black" points="2140.34,-1923.48 2147.66,-1915.82 2137.16,-1917.24 2140.34,-1923.48"/>
</g>
<!-- expert_2_gpu4_exp2 -->
<g id="node104" class="node">
<title>expert_2_gpu4_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2203.5,-2034.69 2068.5,-2034.69 2068.5,-1966.69 2203.5,-1966.69 2203.5,-2034.69"/>
<text text-anchor="middle" x="2136" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2136" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2136" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2136" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu4_exp2&#45;&gt;agg_2_gpu4 -->
<g id="edge167" class="edge">
<title>expert_2_gpu4_exp2&#45;&gt;agg_2_gpu4</title>
<path fill="none" stroke="black" d="M2163.89,-1966.42C2171.01,-1957.92 2178.97,-1948.43 2187.09,-1938.75"/>
<polygon fill="black" stroke="black" points="2189.88,-1940.87 2193.62,-1930.96 2184.51,-1936.37 2189.88,-1940.87"/>
</g>
<!-- expert_2_gpu4_exp3 -->
<g id="node105" class="node">
<title>expert_2_gpu4_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2356.5,-2034.69 2221.5,-2034.69 2221.5,-1966.69 2356.5,-1966.69 2356.5,-2034.69"/>
<text text-anchor="middle" x="2289" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2289" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2289" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu4_exp3&#45;&gt;agg_2_gpu4 -->
<g id="edge168" class="edge">
<title>expert_2_gpu4_exp3&#45;&gt;agg_2_gpu4</title>
<path fill="none" stroke="black" d="M2279.46,-1966.42C2277.19,-1958.51 2274.68,-1949.74 2272.1,-1940.76"/>
<polygon fill="black" stroke="black" points="2275.41,-1939.6 2269.29,-1930.96 2268.68,-1941.53 2275.41,-1939.6"/>
</g>
<!-- expert_2_gpu4_exp4 -->
<g id="node106" class="node">
<title>expert_2_gpu4_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2509.5,-2034.69 2374.5,-2034.69 2374.5,-1966.69 2509.5,-1966.69 2509.5,-2034.69"/>
<text text-anchor="middle" x="2442" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2442" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2442" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2442" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu4_exp4&#45;&gt;agg_2_gpu4 -->
<g id="edge169" class="edge">
<title>expert_2_gpu4_exp4&#45;&gt;agg_2_gpu4</title>
<path fill="none" stroke="black" d="M2395.03,-1966.42C2382.32,-1957.42 2368.03,-1947.3 2353.52,-1937.02"/>
<polygon fill="black" stroke="black" points="2355.14,-1933.88 2344.96,-1930.96 2351.1,-1939.59 2355.14,-1933.88"/>
</g>
<!-- gate_2_gpu4&#45;&gt;expert_2_gpu4_exp1 -->
<g id="edge162" class="edge">
<title>gate_2_gpu4&#45;&gt;expert_2_gpu4_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2151.22,-2076.46C2119.86,-2062.52 2087.65,-2048.2 2059.91,-2035.87"/>
<polygon fill="black" stroke="black" points="2061.24,-2032.64 2050.68,-2031.77 2058.4,-2039.03 2061.24,-2032.64"/>
</g>
<!-- gate_2_gpu4&#45;&gt;expert_2_gpu4_exp2 -->
<g id="edge163" class="edge">
<title>gate_2_gpu4&#45;&gt;expert_2_gpu4_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2213.4,-2070.49C2202.24,-2060.57 2191.05,-2050.63 2180.79,-2041.51"/>
<polygon fill="black" stroke="black" points="2182.94,-2038.74 2173.14,-2034.71 2178.29,-2043.97 2182.94,-2038.74"/>
</g>
<!-- gate_2_gpu4&#45;&gt;expert_2_gpu4_exp3 -->
<g id="edge164" class="edge">
<title>gate_2_gpu4&#45;&gt;expert_2_gpu4_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2289,-2070.49C2289,-2061.74 2289,-2052.97 2289,-2044.76"/>
<polygon fill="black" stroke="black" points="2292.5,-2044.71 2289,-2034.71 2285.5,-2044.71 2292.5,-2044.71"/>
</g>
<!-- gate_2_gpu4&#45;&gt;expert_2_gpu4_exp4 -->
<g id="edge165" class="edge">
<title>gate_2_gpu4&#45;&gt;expert_2_gpu4_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2364.6,-2070.49C2375.76,-2060.57 2386.95,-2050.63 2397.21,-2041.51"/>
<polygon fill="black" stroke="black" points="2399.71,-2043.97 2404.86,-2034.71 2395.06,-2038.74 2399.71,-2043.97"/>
</g>
<!-- agg_2_gpu4&#45;&gt;residual2_2_gpu4 -->
<g id="edge170" class="edge">
<title>agg_2_gpu4&#45;&gt;residual2_2_gpu4</title>
<path fill="none" stroke="black" d="M2250,-1794.49C2250,-1785.74 2250,-1776.97 2250,-1768.76"/>
<polygon fill="black" stroke="black" points="2253.5,-1768.71 2250,-1758.71 2246.5,-1768.71 2253.5,-1768.71"/>
</g>
<!-- comm_stage1_to_stage2_gpu4 -->
<g id="node293" class="node">
<title>comm_stage1_to_stage2_gpu4</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="2212" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="2212" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="2212" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 4 Stage12</text>
<text text-anchor="middle" x="2212" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu4&#45;&gt;comm_stage1_to_stage2_gpu4 -->
<g id="edge172" class="edge">
<title>residual2_2_gpu4&#45;&gt;comm_stage1_to_stage2_gpu4</title>
<path fill="none" stroke="black" d="M2238.08,-1690.61C2235.04,-1682.18 2231.73,-1672.97 2228.5,-1664.03"/>
<polygon fill="black" stroke="black" points="2231.75,-1662.7 2225.06,-1654.48 2225.16,-1665.07 2231.75,-1662.7"/>
</g>
<!-- mha_2_gpu5&#45;&gt;residual1_2_gpu5 -->
<g id="edge174" class="edge">
<title>mha_2_gpu5&#45;&gt;residual1_2_gpu5</title>
<path fill="none" stroke="black" d="M2944.61,-2331.56C2948.02,-2323.32 2951.86,-2314.03 2955.5,-2305.23"/>
<polygon fill="black" stroke="black" points="2958.76,-2306.52 2959.34,-2295.94 2952.29,-2303.85 2958.76,-2306.52"/>
</g>
<!-- gate_2_gpu5 -->
<g id="node116" class="node">
<title>gate_2_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="3061.92,-2206.69 2839.34,-2206.69 2782.08,-2070.69 3004.66,-2070.69 3061.92,-2206.69"/>
<text text-anchor="middle" x="2922" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2922" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2922" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu5&#45;&gt;gate_2_gpu5 -->
<g id="edge176" class="edge">
<title>residual1_2_gpu5&#45;&gt;gate_2_gpu5</title>
<path fill="none" stroke="black" d="M2960.4,-2242.5C2957.49,-2234.7 2954.13,-2225.69 2950.63,-2216.33"/>
<polygon fill="black" stroke="black" points="2953.87,-2215.01 2947.09,-2206.87 2947.31,-2217.46 2953.87,-2215.01"/>
</g>
<!-- residual2_2_gpu5 -->
<g id="node118" class="node">
<title>residual2_2_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3239.5,-1758.69 3084.5,-1758.69 3084.5,-1690.69 3239.5,-1690.69 3239.5,-1758.69"/>
<text text-anchor="middle" x="3162" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3162" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3162" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3162" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu5&#45;&gt;residual2_2_gpu5 -->
<g id="edge186" class="edge">
<title>residual1_2_gpu5&#45;&gt;residual2_2_gpu5</title>
<path fill="none" stroke="black" d="M3024.91,-2242.57C3041.24,-2233.02 3058.17,-2220.97 3071,-2206.69 3127.47,-2143.84 3132.22,-2116.84 3152,-2034.69 3174.28,-1942.15 3170.49,-1829.53 3166.06,-1769.06"/>
<polygon fill="black" stroke="black" points="3169.52,-1768.45 3165.26,-1758.75 3162.54,-1768.99 3169.52,-1768.45"/>
</g>
<!-- expert_2_gpu5_exp1 -->
<g id="node112" class="node">
<title>expert_2_gpu5_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-2034.69 3007.5,-2034.69 3007.5,-1966.69 3142.5,-1966.69 3142.5,-2034.69"/>
<text text-anchor="middle" x="3075" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3075" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3075" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3075" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu5 -->
<g id="node117" class="node">
<title>agg_2_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="3082.89,-1930.69 2826.95,-1930.69 2761.11,-1794.69 3017.05,-1794.69 3082.89,-1930.69"/>
<text text-anchor="middle" x="2922" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2922" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2922" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu5_exp1&#45;&gt;agg_2_gpu5 -->
<g id="edge181" class="edge">
<title>expert_2_gpu5_exp1&#45;&gt;agg_2_gpu5</title>
<path fill="none" stroke="black" d="M3037.57,-1966.42C3027.72,-1957.67 3016.7,-1947.87 3005.47,-1937.89"/>
<polygon fill="black" stroke="black" points="3007.47,-1934.98 2997.67,-1930.96 3002.82,-1940.22 3007.47,-1934.98"/>
</g>
<!-- expert_2_gpu5_exp2 -->
<g id="node113" class="node">
<title>expert_2_gpu5_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2683.5,-2034.69 2548.5,-2034.69 2548.5,-1966.69 2683.5,-1966.69 2683.5,-2034.69"/>
<text text-anchor="middle" x="2616" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2616" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2616" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2616" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu5_exp2&#45;&gt;agg_2_gpu5 -->
<g id="edge182" class="edge">
<title>expert_2_gpu5_exp2&#45;&gt;agg_2_gpu5</title>
<path fill="none" stroke="black" d="M2683.53,-1969.68C2720.02,-1953.46 2766.05,-1933.01 2807.91,-1914.4"/>
<polygon fill="black" stroke="black" points="2809.34,-1917.6 2817.06,-1910.34 2806.5,-1911.2 2809.34,-1917.6"/>
</g>
<!-- expert_2_gpu5_exp3 -->
<g id="node114" class="node">
<title>expert_2_gpu5_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2836.5,-2034.69 2701.5,-2034.69 2701.5,-1966.69 2836.5,-1966.69 2836.5,-2034.69"/>
<text text-anchor="middle" x="2769" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2769" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2769" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2769" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu5_exp3&#45;&gt;agg_2_gpu5 -->
<g id="edge183" class="edge">
<title>expert_2_gpu5_exp3&#45;&gt;agg_2_gpu5</title>
<path fill="none" stroke="black" d="M2806.43,-1966.42C2816.28,-1957.67 2827.3,-1947.87 2838.53,-1937.89"/>
<polygon fill="black" stroke="black" points="2841.18,-1940.22 2846.33,-1930.96 2836.53,-1934.98 2841.18,-1940.22"/>
</g>
<!-- expert_2_gpu5_exp4 -->
<g id="node115" class="node">
<title>expert_2_gpu5_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-2034.69 2854.5,-2034.69 2854.5,-1966.69 2989.5,-1966.69 2989.5,-2034.69"/>
<text text-anchor="middle" x="2922" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2922" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="2922" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu5_exp4&#45;&gt;agg_2_gpu5 -->
<g id="edge184" class="edge">
<title>expert_2_gpu5_exp4&#45;&gt;agg_2_gpu5</title>
<path fill="none" stroke="black" d="M2922,-1966.42C2922,-1958.6 2922,-1949.93 2922,-1941.05"/>
<polygon fill="black" stroke="black" points="2925.5,-1940.96 2922,-1930.96 2918.5,-1940.96 2925.5,-1940.96"/>
</g>
<!-- gate_2_gpu5&#45;&gt;expert_2_gpu5_exp1 -->
<g id="edge177" class="edge">
<title>gate_2_gpu5&#45;&gt;expert_2_gpu5_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.6,-2070.49C3008.76,-2060.57 3019.95,-2050.63 3030.21,-2041.51"/>
<polygon fill="black" stroke="black" points="3032.71,-2043.97 3037.86,-2034.71 3028.06,-2038.74 3032.71,-2043.97"/>
</g>
<!-- gate_2_gpu5&#45;&gt;expert_2_gpu5_exp2 -->
<g id="edge178" class="edge">
<title>gate_2_gpu5&#45;&gt;expert_2_gpu5_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2784.22,-2076.46C2752.86,-2062.52 2720.65,-2048.2 2692.91,-2035.87"/>
<polygon fill="black" stroke="black" points="2694.24,-2032.64 2683.68,-2031.77 2691.4,-2039.03 2694.24,-2032.64"/>
</g>
<!-- gate_2_gpu5&#45;&gt;expert_2_gpu5_exp3 -->
<g id="edge179" class="edge">
<title>gate_2_gpu5&#45;&gt;expert_2_gpu5_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2846.4,-2070.49C2835.24,-2060.57 2824.05,-2050.63 2813.79,-2041.51"/>
<polygon fill="black" stroke="black" points="2815.94,-2038.74 2806.14,-2034.71 2811.29,-2043.97 2815.94,-2038.74"/>
</g>
<!-- gate_2_gpu5&#45;&gt;expert_2_gpu5_exp4 -->
<g id="edge180" class="edge">
<title>gate_2_gpu5&#45;&gt;expert_2_gpu5_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2922,-2070.49C2922,-2061.74 2922,-2052.97 2922,-2044.76"/>
<polygon fill="black" stroke="black" points="2925.5,-2044.71 2922,-2034.71 2918.5,-2044.71 2925.5,-2044.71"/>
</g>
<!-- agg_2_gpu5&#45;&gt;residual2_2_gpu5 -->
<g id="edge185" class="edge">
<title>agg_2_gpu5&#45;&gt;residual2_2_gpu5</title>
<path fill="none" stroke="black" d="M3022.04,-1805C3046.57,-1791.1 3072.24,-1776.56 3094.8,-1763.77"/>
<polygon fill="black" stroke="black" points="3096.64,-1766.76 3103.61,-1758.78 3093.18,-1760.67 3096.64,-1766.76"/>
</g>
<!-- comm_stage1_to_stage2_gpu5 -->
<g id="node294" class="node">
<title>comm_stage1_to_stage2_gpu5</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3162" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="3162" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="3162" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 5 Stage12</text>
<text text-anchor="middle" x="3162" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu5&#45;&gt;comm_stage1_to_stage2_gpu5 -->
<g id="edge187" class="edge">
<title>residual2_2_gpu5&#45;&gt;comm_stage1_to_stage2_gpu5</title>
<path fill="none" stroke="black" d="M3162,-1690.61C3162,-1682.45 3162,-1673.55 3162,-1664.87"/>
<polygon fill="black" stroke="black" points="3165.5,-1664.85 3162,-1654.85 3158.5,-1664.85 3165.5,-1664.85"/>
</g>
<!-- mha_2_gpu6&#45;&gt;residual1_2_gpu6 -->
<g id="edge189" class="edge">
<title>mha_2_gpu6&#45;&gt;residual1_2_gpu6</title>
<path fill="none" stroke="black" d="M3725.14,-2331.56C3729.74,-2323.23 3734.92,-2313.84 3739.82,-2304.95"/>
<polygon fill="black" stroke="black" points="3743.03,-2306.39 3744.79,-2295.94 3736.9,-2303.01 3743.03,-2306.39"/>
</g>
<!-- gate_2_gpu6 -->
<g id="node125" class="node">
<title>gate_2_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="3694.92,-2206.69 3472.34,-2206.69 3415.08,-2070.69 3637.66,-2070.69 3694.92,-2206.69"/>
<text text-anchor="middle" x="3555" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3555" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3555" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu6&#45;&gt;gate_2_gpu6 -->
<g id="edge191" class="edge">
<title>residual1_2_gpu6&#45;&gt;gate_2_gpu6</title>
<path fill="none" stroke="black" d="M3718.21,-2242.5C3704.02,-2233.56 3687.32,-2223.04 3670.12,-2212.21"/>
<polygon fill="black" stroke="black" points="3671.97,-2209.24 3661.64,-2206.87 3668.24,-2215.16 3671.97,-2209.24"/>
</g>
<!-- residual2_2_gpu6 -->
<g id="node127" class="node">
<title>residual2_2_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3821.5,-1758.69 3666.5,-1758.69 3666.5,-1690.69 3821.5,-1690.69 3821.5,-1758.69"/>
<text text-anchor="middle" x="3744" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3744" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3744" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3744" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu6&#45;&gt;residual2_2_gpu6 -->
<g id="edge201" class="edge">
<title>residual1_2_gpu6&#45;&gt;residual2_2_gpu6</title>
<path fill="none" stroke="black" d="M3762.83,-2242.36C3768.98,-2199.38 3780.8,-2110.44 3785,-2034.69 3786.67,-2004.52 3787.54,-1996.81 3785,-1966.69 3779.11,-1896.96 3763.8,-1817.06 3753.64,-1769.04"/>
<polygon fill="black" stroke="black" points="3757.01,-1768.04 3751.5,-1758.99 3750.16,-1769.51 3757.01,-1768.04"/>
</g>
<!-- expert_2_gpu6_exp1 -->
<g id="node121" class="node">
<title>expert_2_gpu6_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3622.5,-2034.69 3487.5,-2034.69 3487.5,-1966.69 3622.5,-1966.69 3622.5,-2034.69"/>
<text text-anchor="middle" x="3555" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3555" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3555" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu6 -->
<g id="node126" class="node">
<title>agg_2_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="3715.89,-1930.69 3459.95,-1930.69 3394.11,-1794.69 3650.05,-1794.69 3715.89,-1930.69"/>
<text text-anchor="middle" x="3555" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="3555" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3555" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu6_exp1&#45;&gt;agg_2_gpu6 -->
<g id="edge196" class="edge">
<title>expert_2_gpu6_exp1&#45;&gt;agg_2_gpu6</title>
<path fill="none" stroke="black" d="M3555,-1966.42C3555,-1958.6 3555,-1949.93 3555,-1941.05"/>
<polygon fill="black" stroke="black" points="3558.5,-1940.96 3555,-1930.96 3551.5,-1940.96 3558.5,-1940.96"/>
</g>
<!-- expert_2_gpu6_exp2 -->
<g id="node122" class="node">
<title>expert_2_gpu6_exp2</title>
<polygon fill="lightgreen" stroke="black" points="3775.5,-2034.69 3640.5,-2034.69 3640.5,-1966.69 3775.5,-1966.69 3775.5,-2034.69"/>
<text text-anchor="middle" x="3708" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3708" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3708" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3708" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu6_exp2&#45;&gt;agg_2_gpu6 -->
<g id="edge197" class="edge">
<title>expert_2_gpu6_exp2&#45;&gt;agg_2_gpu6</title>
<path fill="none" stroke="black" d="M3670.57,-1966.42C3660.72,-1957.67 3649.7,-1947.87 3638.47,-1937.89"/>
<polygon fill="black" stroke="black" points="3640.47,-1934.98 3630.67,-1930.96 3635.82,-1940.22 3640.47,-1934.98"/>
</g>
<!-- expert_2_gpu6_exp3 -->
<g id="node123" class="node">
<title>expert_2_gpu6_exp3</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-2034.69 3181.5,-2034.69 3181.5,-1966.69 3316.5,-1966.69 3316.5,-2034.69"/>
<text text-anchor="middle" x="3249" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3249" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3249" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3249" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu6_exp3&#45;&gt;agg_2_gpu6 -->
<g id="edge198" class="edge">
<title>expert_2_gpu6_exp3&#45;&gt;agg_2_gpu6</title>
<path fill="none" stroke="black" d="M3316.53,-1969.68C3353.02,-1953.46 3399.05,-1933.01 3440.91,-1914.4"/>
<polygon fill="black" stroke="black" points="3442.34,-1917.6 3450.06,-1910.34 3439.5,-1911.2 3442.34,-1917.6"/>
</g>
<!-- expert_2_gpu6_exp4 -->
<g id="node124" class="node">
<title>expert_2_gpu6_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3469.5,-2034.69 3334.5,-2034.69 3334.5,-1966.69 3469.5,-1966.69 3469.5,-2034.69"/>
<text text-anchor="middle" x="3402" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3402" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3402" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3402" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu6_exp4&#45;&gt;agg_2_gpu6 -->
<g id="edge199" class="edge">
<title>expert_2_gpu6_exp4&#45;&gt;agg_2_gpu6</title>
<path fill="none" stroke="black" d="M3439.43,-1966.42C3449.28,-1957.67 3460.3,-1947.87 3471.53,-1937.89"/>
<polygon fill="black" stroke="black" points="3474.18,-1940.22 3479.33,-1930.96 3469.53,-1934.98 3474.18,-1940.22"/>
</g>
<!-- gate_2_gpu6&#45;&gt;expert_2_gpu6_exp1 -->
<g id="edge192" class="edge">
<title>gate_2_gpu6&#45;&gt;expert_2_gpu6_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3555,-2070.49C3555,-2061.74 3555,-2052.97 3555,-2044.76"/>
<polygon fill="black" stroke="black" points="3558.5,-2044.71 3555,-2034.71 3551.5,-2044.71 3558.5,-2044.71"/>
</g>
<!-- gate_2_gpu6&#45;&gt;expert_2_gpu6_exp2 -->
<g id="edge193" class="edge">
<title>gate_2_gpu6&#45;&gt;expert_2_gpu6_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3630.6,-2070.49C3641.76,-2060.57 3652.95,-2050.63 3663.21,-2041.51"/>
<polygon fill="black" stroke="black" points="3665.71,-2043.97 3670.86,-2034.71 3661.06,-2038.74 3665.71,-2043.97"/>
</g>
<!-- gate_2_gpu6&#45;&gt;expert_2_gpu6_exp3 -->
<g id="edge194" class="edge">
<title>gate_2_gpu6&#45;&gt;expert_2_gpu6_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3417.22,-2076.46C3385.86,-2062.52 3353.65,-2048.2 3325.91,-2035.87"/>
<polygon fill="black" stroke="black" points="3327.24,-2032.64 3316.68,-2031.77 3324.4,-2039.03 3327.24,-2032.64"/>
</g>
<!-- gate_2_gpu6&#45;&gt;expert_2_gpu6_exp4 -->
<g id="edge195" class="edge">
<title>gate_2_gpu6&#45;&gt;expert_2_gpu6_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3479.4,-2070.49C3468.24,-2060.57 3457.05,-2050.63 3446.79,-2041.51"/>
<polygon fill="black" stroke="black" points="3448.94,-2038.74 3439.14,-2034.71 3444.29,-2043.97 3448.94,-2038.74"/>
</g>
<!-- agg_2_gpu6&#45;&gt;residual2_2_gpu6 -->
<g id="edge200" class="edge">
<title>agg_2_gpu6&#45;&gt;residual2_2_gpu6</title>
<path fill="none" stroke="black" d="M3648.12,-1794.69C3662.33,-1784.46 3676.59,-1774.2 3689.6,-1764.84"/>
<polygon fill="black" stroke="black" points="3691.89,-1767.5 3697.96,-1758.82 3687.8,-1761.82 3691.89,-1767.5"/>
</g>
<!-- comm_stage1_to_stage2_gpu6 -->
<g id="node295" class="node">
<title>comm_stage1_to_stage2_gpu6</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="3744" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="3744" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="3744" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 6 Stage12</text>
<text text-anchor="middle" x="3744" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu6&#45;&gt;comm_stage1_to_stage2_gpu6 -->
<g id="edge202" class="edge">
<title>residual2_2_gpu6&#45;&gt;comm_stage1_to_stage2_gpu6</title>
<path fill="none" stroke="black" d="M3744,-1690.61C3744,-1682.45 3744,-1673.55 3744,-1664.87"/>
<polygon fill="black" stroke="black" points="3747.5,-1664.85 3744,-1654.85 3740.5,-1664.85 3747.5,-1664.85"/>
</g>
<!-- mha_2_gpu7&#45;&gt;residual1_2_gpu7 -->
<g id="edge204" class="edge">
<title>mha_2_gpu7&#45;&gt;residual1_2_gpu7</title>
<path fill="none" stroke="black" d="M4361.68,-2331.56C4367.55,-2323.05 4374.17,-2313.44 4380.41,-2304.39"/>
<polygon fill="black" stroke="black" points="4383.45,-2306.16 4386.24,-2295.94 4377.68,-2302.19 4383.45,-2306.16"/>
</g>
<!-- gate_2_gpu7 -->
<g id="node134" class="node">
<title>gate_2_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="4327.92,-2206.69 4105.34,-2206.69 4048.08,-2070.69 4270.66,-2070.69 4327.92,-2206.69"/>
<text text-anchor="middle" x="4188" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4188" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4188" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu7&#45;&gt;gate_2_gpu7 -->
<g id="edge206" class="edge">
<title>residual1_2_gpu7&#45;&gt;gate_2_gpu7</title>
<path fill="none" stroke="black" d="M4361.07,-2242.65C4345.88,-2233.62 4327.95,-2222.95 4309.49,-2211.97"/>
<polygon fill="black" stroke="black" points="4311.08,-2208.84 4300.69,-2206.73 4307.5,-2214.86 4311.08,-2208.84"/>
</g>
<!-- residual2_2_gpu7 -->
<g id="node136" class="node">
<title>residual2_2_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4282.5,-1758.69 4127.5,-1758.69 4127.5,-1690.69 4282.5,-1690.69 4282.5,-1758.69"/>
<text text-anchor="middle" x="4205" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4205" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4205" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4205" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu7&#45;&gt;residual2_2_gpu7 -->
<g id="edge216" class="edge">
<title>residual1_2_gpu7&#45;&gt;residual2_2_gpu7</title>
<path fill="none" stroke="black" d="M4410.87,-2242.48C4430.19,-2163.81 4476.24,-1923.83 4358,-1794.69 4340.28,-1775.34 4316.1,-1761.07 4292.19,-1750.69"/>
<polygon fill="black" stroke="black" points="4293.28,-1747.35 4282.7,-1746.76 4290.6,-1753.82 4293.28,-1747.35"/>
</g>
<!-- expert_2_gpu7_exp1 -->
<g id="node130" class="node">
<title>expert_2_gpu7_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4102.5,-2034.69 3967.5,-2034.69 3967.5,-1966.69 4102.5,-1966.69 4102.5,-2034.69"/>
<text text-anchor="middle" x="4035" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4035" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4035" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4035" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu7 -->
<g id="node135" class="node">
<title>agg_2_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="4348.89,-1930.69 4092.95,-1930.69 4027.11,-1794.69 4283.05,-1794.69 4348.89,-1930.69"/>
<text text-anchor="middle" x="4188" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4188" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4188" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu7_exp1&#45;&gt;agg_2_gpu7 -->
<g id="edge211" class="edge">
<title>expert_2_gpu7_exp1&#45;&gt;agg_2_gpu7</title>
<path fill="none" stroke="black" d="M4072.43,-1966.42C4082.28,-1957.67 4093.3,-1947.87 4104.53,-1937.89"/>
<polygon fill="black" stroke="black" points="4107.18,-1940.22 4112.33,-1930.96 4102.53,-1934.98 4107.18,-1940.22"/>
</g>
<!-- expert_2_gpu7_exp2 -->
<g id="node131" class="node">
<title>expert_2_gpu7_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4255.5,-2034.69 4120.5,-2034.69 4120.5,-1966.69 4255.5,-1966.69 4255.5,-2034.69"/>
<text text-anchor="middle" x="4188" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4188" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4188" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu7_exp2&#45;&gt;agg_2_gpu7 -->
<g id="edge212" class="edge">
<title>expert_2_gpu7_exp2&#45;&gt;agg_2_gpu7</title>
<path fill="none" stroke="black" d="M4188,-1966.42C4188,-1958.6 4188,-1949.93 4188,-1941.05"/>
<polygon fill="black" stroke="black" points="4191.5,-1940.96 4188,-1930.96 4184.5,-1940.96 4191.5,-1940.96"/>
</g>
<!-- expert_2_gpu7_exp3 -->
<g id="node132" class="node">
<title>expert_2_gpu7_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4408.5,-2034.69 4273.5,-2034.69 4273.5,-1966.69 4408.5,-1966.69 4408.5,-2034.69"/>
<text text-anchor="middle" x="4341" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4341" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4341" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4341" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu7_exp3&#45;&gt;agg_2_gpu7 -->
<g id="edge213" class="edge">
<title>expert_2_gpu7_exp3&#45;&gt;agg_2_gpu7</title>
<path fill="none" stroke="black" d="M4303.57,-1966.42C4293.72,-1957.67 4282.7,-1947.87 4271.47,-1937.89"/>
<polygon fill="black" stroke="black" points="4273.47,-1934.98 4263.67,-1930.96 4268.82,-1940.22 4273.47,-1934.98"/>
</g>
<!-- expert_2_gpu7_exp4 -->
<g id="node133" class="node">
<title>expert_2_gpu7_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3949.5,-2034.69 3814.5,-2034.69 3814.5,-1966.69 3949.5,-1966.69 3949.5,-2034.69"/>
<text text-anchor="middle" x="3882" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3882" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="3882" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3882" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu7_exp4&#45;&gt;agg_2_gpu7 -->
<g id="edge214" class="edge">
<title>expert_2_gpu7_exp4&#45;&gt;agg_2_gpu7</title>
<path fill="none" stroke="black" d="M3949.53,-1969.68C3986.02,-1953.46 4032.05,-1933.01 4073.91,-1914.4"/>
<polygon fill="black" stroke="black" points="4075.34,-1917.6 4083.06,-1910.34 4072.5,-1911.2 4075.34,-1917.6"/>
</g>
<!-- gate_2_gpu7&#45;&gt;expert_2_gpu7_exp1 -->
<g id="edge207" class="edge">
<title>gate_2_gpu7&#45;&gt;expert_2_gpu7_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4112.4,-2070.49C4101.24,-2060.57 4090.05,-2050.63 4079.79,-2041.51"/>
<polygon fill="black" stroke="black" points="4081.94,-2038.74 4072.14,-2034.71 4077.29,-2043.97 4081.94,-2038.74"/>
</g>
<!-- gate_2_gpu7&#45;&gt;expert_2_gpu7_exp2 -->
<g id="edge208" class="edge">
<title>gate_2_gpu7&#45;&gt;expert_2_gpu7_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4188,-2070.49C4188,-2061.74 4188,-2052.97 4188,-2044.76"/>
<polygon fill="black" stroke="black" points="4191.5,-2044.71 4188,-2034.71 4184.5,-2044.71 4191.5,-2044.71"/>
</g>
<!-- gate_2_gpu7&#45;&gt;expert_2_gpu7_exp3 -->
<g id="edge209" class="edge">
<title>gate_2_gpu7&#45;&gt;expert_2_gpu7_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4263.6,-2070.49C4274.76,-2060.57 4285.95,-2050.63 4296.21,-2041.51"/>
<polygon fill="black" stroke="black" points="4298.71,-2043.97 4303.86,-2034.71 4294.06,-2038.74 4298.71,-2043.97"/>
</g>
<!-- gate_2_gpu7&#45;&gt;expert_2_gpu7_exp4 -->
<g id="edge210" class="edge">
<title>gate_2_gpu7&#45;&gt;expert_2_gpu7_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.22,-2076.46C4018.86,-2062.52 3986.65,-2048.2 3958.91,-2035.87"/>
<polygon fill="black" stroke="black" points="3960.24,-2032.64 3949.68,-2031.77 3957.4,-2039.03 3960.24,-2032.64"/>
</g>
<!-- agg_2_gpu7&#45;&gt;residual2_2_gpu7 -->
<g id="edge215" class="edge">
<title>agg_2_gpu7&#45;&gt;residual2_2_gpu7</title>
<path fill="none" stroke="black" d="M4196.4,-1794.49C4197.49,-1785.74 4198.59,-1776.97 4199.62,-1768.76"/>
<polygon fill="black" stroke="black" points="4203.11,-1769.07 4200.87,-1758.71 4196.16,-1768.2 4203.11,-1769.07"/>
</g>
<!-- comm_stage1_to_stage2_gpu7 -->
<g id="node296" class="node">
<title>comm_stage1_to_stage2_gpu7</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4205" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="4205" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="4205" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 7 Stage12</text>
<text text-anchor="middle" x="4205" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu7&#45;&gt;comm_stage1_to_stage2_gpu7 -->
<g id="edge217" class="edge">
<title>residual2_2_gpu7&#45;&gt;comm_stage1_to_stage2_gpu7</title>
<path fill="none" stroke="black" d="M4205,-1690.61C4205,-1682.45 4205,-1673.55 4205,-1664.87"/>
<polygon fill="black" stroke="black" points="4208.5,-1664.85 4205,-1654.85 4201.5,-1664.85 4208.5,-1664.85"/>
</g>
<!-- mha_2_gpu8&#45;&gt;residual1_2_gpu8 -->
<g id="edge219" class="edge">
<title>mha_2_gpu8&#45;&gt;residual1_2_gpu8</title>
<path fill="none" stroke="black" d="M4843.61,-2331.56C4847.02,-2323.32 4850.86,-2314.03 4854.5,-2305.23"/>
<polygon fill="black" stroke="black" points="4857.76,-2306.52 4858.34,-2295.94 4851.29,-2303.85 4857.76,-2306.52"/>
</g>
<!-- gate_2_gpu8 -->
<g id="node143" class="node">
<title>gate_2_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4960.92,-2206.69 4738.34,-2206.69 4681.08,-2070.69 4903.66,-2070.69 4960.92,-2206.69"/>
<text text-anchor="middle" x="4821" y="-2157.49" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4821" y="-2142.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4821" y="-2127.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-2112.49" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_2_gpu8&#45;&gt;gate_2_gpu8 -->
<g id="edge221" class="edge">
<title>residual1_2_gpu8&#45;&gt;gate_2_gpu8</title>
<path fill="none" stroke="black" d="M4859.4,-2242.5C4856.49,-2234.7 4853.13,-2225.69 4849.63,-2216.33"/>
<polygon fill="black" stroke="black" points="4852.87,-2215.01 4846.09,-2206.87 4846.31,-2217.46 4852.87,-2215.01"/>
</g>
<!-- residual2_2_gpu8 -->
<g id="node145" class="node">
<title>residual2_2_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4821.5,-1758.69 4666.5,-1758.69 4666.5,-1690.69 4821.5,-1690.69 4821.5,-1758.69"/>
<text text-anchor="middle" x="4744" y="-1743.49" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4744" y="-1728.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4744" y="-1713.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-1698.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_2_gpu8&#45;&gt;residual2_2_gpu8 -->
<g id="edge231" class="edge">
<title>residual1_2_gpu8&#45;&gt;residual2_2_gpu8</title>
<path fill="none" stroke="black" d="M4923.91,-2242.57C4940.24,-2233.02 4957.17,-2220.97 4970,-2206.69 5045.24,-2122.95 5088.15,-2072.96 5051,-1966.69 5018.75,-1874.44 4992.28,-1853.2 4914,-1794.69 4889.36,-1776.28 4859.11,-1761.93 4831,-1751.21"/>
<polygon fill="black" stroke="black" points="4832.15,-1747.91 4821.56,-1747.72 4829.72,-1754.47 4832.15,-1747.91"/>
</g>
<!-- expert_2_gpu8_exp1 -->
<g id="node139" class="node">
<title>expert_2_gpu8_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4582.5,-2034.69 4447.5,-2034.69 4447.5,-1966.69 4582.5,-1966.69 4582.5,-2034.69"/>
<text text-anchor="middle" x="4515" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4515" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4515" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4515" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_2_gpu8 -->
<g id="node144" class="node">
<title>agg_2_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="4904.89,-1930.69 4648.95,-1930.69 4583.11,-1794.69 4839.05,-1794.69 4904.89,-1930.69"/>
<text text-anchor="middle" x="4744" y="-1881.49" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4744" y="-1866.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4744" y="-1851.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-1836.49" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_2_gpu8_exp1&#45;&gt;agg_2_gpu8 -->
<g id="edge226" class="edge">
<title>expert_2_gpu8_exp1&#45;&gt;agg_2_gpu8</title>
<path fill="none" stroke="black" d="M4570.73,-1966.6C4590.45,-1954.89 4613.36,-1941.28 4635.94,-1927.87"/>
<polygon fill="black" stroke="black" points="4637.76,-1930.86 4644.57,-1922.74 4634.19,-1924.84 4637.76,-1930.86"/>
</g>
<!-- expert_2_gpu8_exp2 -->
<g id="node140" class="node">
<title>expert_2_gpu8_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4735.5,-2034.69 4600.5,-2034.69 4600.5,-1966.69 4735.5,-1966.69 4735.5,-2034.69"/>
<text text-anchor="middle" x="4668" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4668" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4668" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4668" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu8_exp2&#45;&gt;agg_2_gpu8 -->
<g id="edge227" class="edge">
<title>expert_2_gpu8_exp2&#45;&gt;agg_2_gpu8</title>
<path fill="none" stroke="black" d="M4686.59,-1966.42C4691.15,-1958.26 4696.23,-1949.18 4701.41,-1939.9"/>
<polygon fill="black" stroke="black" points="4704.59,-1941.39 4706.41,-1930.96 4698.48,-1937.98 4704.59,-1941.39"/>
</g>
<!-- expert_2_gpu8_exp3 -->
<g id="node141" class="node">
<title>expert_2_gpu8_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4888.5,-2034.69 4753.5,-2034.69 4753.5,-1966.69 4888.5,-1966.69 4888.5,-2034.69"/>
<text text-anchor="middle" x="4821" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4821" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4821" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu8_exp3&#45;&gt;agg_2_gpu8 -->
<g id="edge228" class="edge">
<title>expert_2_gpu8_exp3&#45;&gt;agg_2_gpu8</title>
<path fill="none" stroke="black" d="M4802.16,-1966.42C4797.54,-1958.26 4792.4,-1949.18 4787.15,-1939.9"/>
<polygon fill="black" stroke="black" points="4790.06,-1937.93 4782.08,-1930.96 4783.96,-1941.38 4790.06,-1937.93"/>
</g>
<!-- expert_2_gpu8_exp4 -->
<g id="node142" class="node">
<title>expert_2_gpu8_exp4</title>
<polygon fill="lightgreen" stroke="black" points="5041.5,-2034.69 4906.5,-2034.69 4906.5,-1966.69 5041.5,-1966.69 5041.5,-2034.69"/>
<text text-anchor="middle" x="4974" y="-2019.49" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4974" y="-2004.49" font-family="Times,serif" font-size="14.00">Layer 2</text>
<text text-anchor="middle" x="4974" y="-1989.49" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4974" y="-1974.49" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_2_gpu8_exp4&#45;&gt;agg_2_gpu8 -->
<g id="edge229" class="edge">
<title>expert_2_gpu8_exp4&#45;&gt;agg_2_gpu8</title>
<path fill="none" stroke="black" d="M4918.03,-1966.6C4902.26,-1957.27 4884.46,-1946.75 4866.41,-1936.08"/>
<polygon fill="black" stroke="black" points="4867.93,-1932.91 4857.54,-1930.83 4864.37,-1938.93 4867.93,-1932.91"/>
</g>
<!-- gate_2_gpu8&#45;&gt;expert_2_gpu8_exp1 -->
<g id="edge222" class="edge">
<title>gate_2_gpu8&#45;&gt;expert_2_gpu8_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4683.22,-2076.46C4651.86,-2062.52 4619.65,-2048.2 4591.91,-2035.87"/>
<polygon fill="black" stroke="black" points="4593.24,-2032.64 4582.68,-2031.77 4590.4,-2039.03 4593.24,-2032.64"/>
</g>
<!-- gate_2_gpu8&#45;&gt;expert_2_gpu8_exp2 -->
<g id="edge223" class="edge">
<title>gate_2_gpu8&#45;&gt;expert_2_gpu8_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4745.4,-2070.49C4734.24,-2060.57 4723.05,-2050.63 4712.79,-2041.51"/>
<polygon fill="black" stroke="black" points="4714.94,-2038.74 4705.14,-2034.71 4710.29,-2043.97 4714.94,-2038.74"/>
</g>
<!-- gate_2_gpu8&#45;&gt;expert_2_gpu8_exp3 -->
<g id="edge224" class="edge">
<title>gate_2_gpu8&#45;&gt;expert_2_gpu8_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4821,-2070.49C4821,-2061.74 4821,-2052.97 4821,-2044.76"/>
<polygon fill="black" stroke="black" points="4824.5,-2044.71 4821,-2034.71 4817.5,-2044.71 4824.5,-2044.71"/>
</g>
<!-- gate_2_gpu8&#45;&gt;expert_2_gpu8_exp4 -->
<g id="edge225" class="edge">
<title>gate_2_gpu8&#45;&gt;expert_2_gpu8_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4896.6,-2070.49C4907.76,-2060.57 4918.95,-2050.63 4929.21,-2041.51"/>
<polygon fill="black" stroke="black" points="4931.71,-2043.97 4936.86,-2034.71 4927.06,-2038.74 4931.71,-2043.97"/>
</g>
<!-- agg_2_gpu8&#45;&gt;residual2_2_gpu8 -->
<g id="edge230" class="edge">
<title>agg_2_gpu8&#45;&gt;residual2_2_gpu8</title>
<path fill="none" stroke="black" d="M4744,-1794.49C4744,-1785.74 4744,-1776.97 4744,-1768.76"/>
<polygon fill="black" stroke="black" points="4747.5,-1768.71 4744,-1758.71 4740.5,-1768.71 4747.5,-1768.71"/>
</g>
<!-- comm_stage1_to_stage2_gpu8 -->
<g id="node297" class="node">
<title>comm_stage1_to_stage2_gpu8</title>
<ellipse fill="none" stroke="black" stroke-dasharray="5,2" cx="4744" cy="-1617.22" rx="109.7" ry="37.45"/>
<text text-anchor="middle" x="4744" y="-1628.52" font-family="Times,serif" font-size="14.00">Pipeline Comm</text>
<text text-anchor="middle" x="4744" y="-1613.52" font-family="Times,serif" font-size="14.00">GPU 8 Stage12</text>
<text text-anchor="middle" x="4744" y="-1598.52" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_2_gpu8&#45;&gt;comm_stage1_to_stage2_gpu8 -->
<g id="edge232" class="edge">
<title>residual2_2_gpu8&#45;&gt;comm_stage1_to_stage2_gpu8</title>
<path fill="none" stroke="black" d="M4744,-1690.61C4744,-1682.45 4744,-1673.55 4744,-1664.87"/>
<polygon fill="black" stroke="black" points="4747.5,-1664.85 4744,-1654.85 4740.5,-1664.85 4747.5,-1664.85"/>
</g>
<!-- mha_3_gpu1 -->
<g id="node146" class="node">
<title>mha_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="1438.5,-1540.74 1283.5,-1540.74 1283.5,-1487.74 1438.5,-1487.74 1438.5,-1540.74"/>
<text text-anchor="middle" x="1361" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="1361" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="1361" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu1 -->
<g id="node147" class="node">
<title>residual1_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="707.5,-1451.74 552.5,-1451.74 552.5,-1398.74 707.5,-1398.74 707.5,-1451.74"/>
<text text-anchor="middle" x="630" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="630" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="630" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu1&#45;&gt;residual1_3_gpu1 -->
<g id="edge234" class="edge">
<title>mha_3_gpu1&#45;&gt;residual1_3_gpu1</title>
<path fill="none" stroke="black" d="M1283.46,-1504.01C1146.3,-1487.69 861.79,-1453.83 717.7,-1436.68"/>
<polygon fill="black" stroke="black" points="717.91,-1433.18 707.57,-1435.47 717.08,-1440.13 717.91,-1433.18"/>
</g>
<!-- gate_3_gpu1 -->
<g id="node152" class="node">
<title>gate_3_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="529.92,-1362.74 307.34,-1362.74 250.08,-1226.74 472.66,-1226.74 529.92,-1362.74"/>
<text text-anchor="middle" x="390" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="390" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="390" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu1&#45;&gt;gate_3_gpu1 -->
<g id="edge236" class="edge">
<title>residual1_3_gpu1&#45;&gt;gate_3_gpu1</title>
<path fill="none" stroke="black" d="M582.3,-1398.7C565.19,-1389.54 544.96,-1378.71 524.16,-1367.57"/>
<polygon fill="black" stroke="black" points="525.68,-1364.42 515.21,-1362.78 522.38,-1370.59 525.68,-1364.42"/>
</g>
<!-- residual2_3_gpu1 -->
<g id="node154" class="node">
<title>residual2_3_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="587.5,-914.74 432.5,-914.74 432.5,-846.74 587.5,-846.74 587.5,-914.74"/>
<text text-anchor="middle" x="510" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="510" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="510" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="510" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu1&#45;&gt;residual2_3_gpu1 -->
<g id="edge246" class="edge">
<title>residual1_3_gpu1&#45;&gt;residual2_3_gpu1</title>
<path fill="none" stroke="black" d="M631.58,-1398.55C634.24,-1346.16 637.68,-1223.42 619,-1122.74 604.26,-1043.28 597.23,-1022.47 560,-950.74 555.15,-941.39 549.12,-931.9 542.95,-923.07"/>
<polygon fill="black" stroke="black" points="545.71,-920.91 537.03,-914.84 540.03,-925 545.71,-920.91"/>
</g>
<!-- expert_3_gpu1_exp1 -->
<g id="node148" class="node">
<title>expert_3_gpu1_exp1</title>
<polygon fill="lightgreen" stroke="black" points="610.5,-1190.74 475.5,-1190.74 475.5,-1122.74 610.5,-1122.74 610.5,-1190.74"/>
<text text-anchor="middle" x="543" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="543" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="543" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="543" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu1 -->
<g id="node153" class="node">
<title>agg_3_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="550.89,-1086.74 294.95,-1086.74 229.11,-950.74 485.05,-950.74 550.89,-1086.74"/>
<text text-anchor="middle" x="390" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="390" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="390" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu1_exp1&#45;&gt;agg_3_gpu1 -->
<g id="edge241" class="edge">
<title>expert_3_gpu1_exp1&#45;&gt;agg_3_gpu1</title>
<path fill="none" stroke="black" d="M505.57,-1122.47C495.72,-1113.72 484.7,-1103.91 473.47,-1093.93"/>
<polygon fill="black" stroke="black" points="475.47,-1091.03 465.67,-1087 470.82,-1096.26 475.47,-1091.03"/>
</g>
<!-- expert_3_gpu1_exp2 -->
<g id="node149" class="node">
<title>expert_3_gpu1_exp2</title>
<polygon fill="lightgreen" stroke="black" points="151.5,-1190.74 16.5,-1190.74 16.5,-1122.74 151.5,-1122.74 151.5,-1190.74"/>
<text text-anchor="middle" x="84" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="84" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="84" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="84" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu1_exp2&#45;&gt;agg_3_gpu1 -->
<g id="edge242" class="edge">
<title>expert_3_gpu1_exp2&#45;&gt;agg_3_gpu1</title>
<path fill="none" stroke="black" d="M151.53,-1125.73C188.02,-1109.51 234.05,-1089.05 275.91,-1070.45"/>
<polygon fill="black" stroke="black" points="277.34,-1073.64 285.06,-1066.38 274.5,-1067.25 277.34,-1073.64"/>
</g>
<!-- expert_3_gpu1_exp3 -->
<g id="node150" class="node">
<title>expert_3_gpu1_exp3</title>
<polygon fill="lightgreen" stroke="black" points="304.5,-1190.74 169.5,-1190.74 169.5,-1122.74 304.5,-1122.74 304.5,-1190.74"/>
<text text-anchor="middle" x="237" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="237" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="237" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="237" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu1_exp3&#45;&gt;agg_3_gpu1 -->
<g id="edge243" class="edge">
<title>expert_3_gpu1_exp3&#45;&gt;agg_3_gpu1</title>
<path fill="none" stroke="black" d="M274.43,-1122.47C284.28,-1113.72 295.3,-1103.91 306.53,-1093.93"/>
<polygon fill="black" stroke="black" points="309.18,-1096.26 314.33,-1087 304.53,-1091.03 309.18,-1096.26"/>
</g>
<!-- expert_3_gpu1_exp4 -->
<g id="node151" class="node">
<title>expert_3_gpu1_exp4</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-1190.74 322.5,-1190.74 322.5,-1122.74 457.5,-1122.74 457.5,-1190.74"/>
<text text-anchor="middle" x="390" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="390" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="390" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu1_exp4&#45;&gt;agg_3_gpu1 -->
<g id="edge244" class="edge">
<title>expert_3_gpu1_exp4&#45;&gt;agg_3_gpu1</title>
<path fill="none" stroke="black" d="M390,-1122.47C390,-1114.64 390,-1105.98 390,-1097.09"/>
<polygon fill="black" stroke="black" points="393.5,-1097 390,-1087 386.5,-1097 393.5,-1097"/>
</g>
<!-- gate_3_gpu1&#45;&gt;expert_3_gpu1_exp1 -->
<g id="edge237" class="edge">
<title>gate_3_gpu1&#45;&gt;expert_3_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M465.6,-1226.54C476.76,-1216.62 487.95,-1206.68 498.21,-1197.56"/>
<polygon fill="black" stroke="black" points="500.71,-1200.02 505.86,-1190.76 496.06,-1194.78 500.71,-1200.02"/>
</g>
<!-- gate_3_gpu1&#45;&gt;expert_3_gpu1_exp2 -->
<g id="edge238" class="edge">
<title>gate_3_gpu1&#45;&gt;expert_3_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M252.22,-1232.5C220.86,-1218.57 188.65,-1204.25 160.91,-1191.92"/>
<polygon fill="black" stroke="black" points="162.24,-1188.68 151.68,-1187.82 159.4,-1195.08 162.24,-1188.68"/>
</g>
<!-- gate_3_gpu1&#45;&gt;expert_3_gpu1_exp3 -->
<g id="edge239" class="edge">
<title>gate_3_gpu1&#45;&gt;expert_3_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M314.4,-1226.54C303.24,-1216.62 292.05,-1206.68 281.79,-1197.56"/>
<polygon fill="black" stroke="black" points="283.94,-1194.78 274.14,-1190.76 279.29,-1200.02 283.94,-1194.78"/>
</g>
<!-- gate_3_gpu1&#45;&gt;expert_3_gpu1_exp4 -->
<g id="edge240" class="edge">
<title>gate_3_gpu1&#45;&gt;expert_3_gpu1_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390,-1226.54C390,-1217.78 390,-1209.02 390,-1200.81"/>
<polygon fill="black" stroke="black" points="393.5,-1200.76 390,-1190.76 386.5,-1200.76 393.5,-1200.76"/>
</g>
<!-- agg_3_gpu1&#45;&gt;residual2_3_gpu1 -->
<g id="edge245" class="edge">
<title>agg_3_gpu1&#45;&gt;residual2_3_gpu1</title>
<path fill="none" stroke="black" d="M449.3,-950.54C457.79,-940.91 466.3,-931.26 474.16,-922.36"/>
<polygon fill="black" stroke="black" points="476.88,-924.57 480.87,-914.76 471.63,-919.94 476.88,-924.57"/>
</g>
<!-- mha_4_gpu1 -->
<g id="node218" class="node">
<title>mha_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="539.5,-810.74 384.5,-810.74 384.5,-757.74 539.5,-757.74 539.5,-810.74"/>
<text text-anchor="middle" x="462" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="462" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="462" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu1&#45;&gt;mha_4_gpu1 -->
<g id="edge247" class="edge">
<title>residual2_3_gpu1&#45;&gt;mha_4_gpu1</title>
<path fill="none" stroke="black" d="M493.21,-846.69C488.84,-838.09 484.12,-828.8 479.71,-820.11"/>
<polygon fill="black" stroke="black" points="482.72,-818.31 475.07,-810.98 476.48,-821.48 482.72,-818.31"/>
</g>
<!-- residual1_4_gpu1 -->
<g id="node219" class="node">
<title>residual1_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="587.5,-721.74 432.5,-721.74 432.5,-668.74 587.5,-668.74 587.5,-721.74"/>
<text text-anchor="middle" x="510" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="510" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="510" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu1&#45;&gt;residual1_4_gpu1 -->
<g id="edge249" class="edge">
<title>residual2_3_gpu1&#45;&gt;residual1_4_gpu1</title>
<path fill="none" stroke="black" d="M532.75,-846.42C538.95,-835.53 544.83,-823.06 548,-810.74 553.87,-787.93 554.44,-780.4 548,-757.74 545.33,-748.33 540.76,-738.95 535.7,-730.46"/>
<polygon fill="black" stroke="black" points="538.62,-728.53 530.31,-721.96 532.71,-732.28 538.62,-728.53"/>
</g>
<!-- mha_3_gpu2 -->
<g id="node155" class="node">
<title>mha_3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1611.5,-1540.74 1456.5,-1540.74 1456.5,-1487.74 1611.5,-1487.74 1611.5,-1540.74"/>
<text text-anchor="middle" x="1534" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="1534" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1534" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu2 -->
<g id="node156" class="node">
<title>residual1_3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1298.5,-1451.74 1143.5,-1451.74 1143.5,-1398.74 1298.5,-1398.74 1298.5,-1451.74"/>
<text text-anchor="middle" x="1221" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1221" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1221" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu2&#45;&gt;residual1_3_gpu2 -->
<g id="edge263" class="edge">
<title>mha_3_gpu2&#45;&gt;residual1_3_gpu2</title>
<path fill="none" stroke="black" d="M1456.21,-1490.08C1453.44,-1489.29 1450.7,-1488.51 1448,-1487.74 1401.99,-1474.69 1350.57,-1460.71 1308.31,-1449.38"/>
<polygon fill="black" stroke="black" points="1309.17,-1445.99 1298.61,-1446.78 1307.36,-1452.75 1309.17,-1445.99"/>
</g>
<!-- gate_3_gpu2 -->
<g id="node161" class="node">
<title>gate_3_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="1162.92,-1362.74 940.34,-1362.74 883.08,-1226.74 1105.66,-1226.74 1162.92,-1362.74"/>
<text text-anchor="middle" x="1023" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1023" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1023" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu2&#45;&gt;gate_3_gpu2 -->
<g id="edge265" class="edge">
<title>residual1_3_gpu2&#45;&gt;gate_3_gpu2</title>
<path fill="none" stroke="black" d="M1181.41,-1398.55C1167.76,-1389.69 1151.72,-1379.28 1135.19,-1368.55"/>
<polygon fill="black" stroke="black" points="1136.8,-1365.42 1126.51,-1362.91 1132.99,-1371.29 1136.8,-1365.42"/>
</g>
<!-- residual2_3_gpu2 -->
<g id="node163" class="node">
<title>residual2_3_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1136.5,-914.74 981.5,-914.74 981.5,-846.74 1136.5,-846.74 1136.5,-914.74"/>
<text text-anchor="middle" x="1059" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1059" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1059" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1059" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu2&#45;&gt;residual2_3_gpu2 -->
<g id="edge275" class="edge">
<title>residual1_3_gpu2&#45;&gt;residual2_3_gpu2</title>
<path fill="none" stroke="black" d="M1228.21,-1398.68C1241.92,-1346.53 1268.92,-1224.21 1252,-1122.74 1238.71,-1043.02 1245.85,-1011.88 1193,-950.74 1180.1,-935.82 1163.19,-923.71 1145.73,-914.04"/>
<polygon fill="black" stroke="black" points="1147.06,-910.78 1136.58,-909.2 1143.79,-916.97 1147.06,-910.78"/>
</g>
<!-- expert_3_gpu2_exp1 -->
<g id="node157" class="node">
<title>expert_3_gpu2_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1090.5,-1190.74 955.5,-1190.74 955.5,-1122.74 1090.5,-1122.74 1090.5,-1190.74"/>
<text text-anchor="middle" x="1023" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1023" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1023" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu2 -->
<g id="node162" class="node">
<title>agg_3_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="1183.89,-1086.74 927.95,-1086.74 862.11,-950.74 1118.05,-950.74 1183.89,-1086.74"/>
<text text-anchor="middle" x="1023" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1023" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1023" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu2_exp1&#45;&gt;agg_3_gpu2 -->
<g id="edge270" class="edge">
<title>expert_3_gpu2_exp1&#45;&gt;agg_3_gpu2</title>
<path fill="none" stroke="black" d="M1023,-1122.47C1023,-1114.64 1023,-1105.98 1023,-1097.09"/>
<polygon fill="black" stroke="black" points="1026.5,-1097 1023,-1087 1019.5,-1097 1026.5,-1097"/>
</g>
<!-- expert_3_gpu2_exp2 -->
<g id="node158" class="node">
<title>expert_3_gpu2_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1243.5,-1190.74 1108.5,-1190.74 1108.5,-1122.74 1243.5,-1122.74 1243.5,-1190.74"/>
<text text-anchor="middle" x="1176" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1176" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1176" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1176" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu2_exp2&#45;&gt;agg_3_gpu2 -->
<g id="edge271" class="edge">
<title>expert_3_gpu2_exp2&#45;&gt;agg_3_gpu2</title>
<path fill="none" stroke="black" d="M1138.57,-1122.47C1128.72,-1113.72 1117.7,-1103.91 1106.47,-1093.93"/>
<polygon fill="black" stroke="black" points="1108.47,-1091.03 1098.67,-1087 1103.82,-1096.26 1108.47,-1091.03"/>
</g>
<!-- expert_3_gpu2_exp3 -->
<g id="node159" class="node">
<title>expert_3_gpu2_exp3</title>
<polygon fill="lightgreen" stroke="black" points="784.5,-1190.74 649.5,-1190.74 649.5,-1122.74 784.5,-1122.74 784.5,-1190.74"/>
<text text-anchor="middle" x="717" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="717" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="717" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="717" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu2_exp3&#45;&gt;agg_3_gpu2 -->
<g id="edge272" class="edge">
<title>expert_3_gpu2_exp3&#45;&gt;agg_3_gpu2</title>
<path fill="none" stroke="black" d="M784.53,-1125.73C821.02,-1109.51 867.05,-1089.05 908.91,-1070.45"/>
<polygon fill="black" stroke="black" points="910.34,-1073.64 918.06,-1066.38 907.5,-1067.25 910.34,-1073.64"/>
</g>
<!-- expert_3_gpu2_exp4 -->
<g id="node160" class="node">
<title>expert_3_gpu2_exp4</title>
<polygon fill="lightgreen" stroke="black" points="937.5,-1190.74 802.5,-1190.74 802.5,-1122.74 937.5,-1122.74 937.5,-1190.74"/>
<text text-anchor="middle" x="870" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="870" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="870" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="870" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu2_exp4&#45;&gt;agg_3_gpu2 -->
<g id="edge273" class="edge">
<title>expert_3_gpu2_exp4&#45;&gt;agg_3_gpu2</title>
<path fill="none" stroke="black" d="M907.43,-1122.47C917.28,-1113.72 928.3,-1103.91 939.53,-1093.93"/>
<polygon fill="black" stroke="black" points="942.18,-1096.26 947.33,-1087 937.53,-1091.03 942.18,-1096.26"/>
</g>
<!-- gate_3_gpu2&#45;&gt;expert_3_gpu2_exp1 -->
<g id="edge266" class="edge">
<title>gate_3_gpu2&#45;&gt;expert_3_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1023,-1226.54C1023,-1217.78 1023,-1209.02 1023,-1200.81"/>
<polygon fill="black" stroke="black" points="1026.5,-1200.76 1023,-1190.76 1019.5,-1200.76 1026.5,-1200.76"/>
</g>
<!-- gate_3_gpu2&#45;&gt;expert_3_gpu2_exp2 -->
<g id="edge267" class="edge">
<title>gate_3_gpu2&#45;&gt;expert_3_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1098.6,-1226.54C1109.76,-1216.62 1120.95,-1206.68 1131.21,-1197.56"/>
<polygon fill="black" stroke="black" points="1133.71,-1200.02 1138.86,-1190.76 1129.06,-1194.78 1133.71,-1200.02"/>
</g>
<!-- gate_3_gpu2&#45;&gt;expert_3_gpu2_exp3 -->
<g id="edge268" class="edge">
<title>gate_3_gpu2&#45;&gt;expert_3_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M885.22,-1232.5C853.86,-1218.57 821.65,-1204.25 793.91,-1191.92"/>
<polygon fill="black" stroke="black" points="795.24,-1188.68 784.68,-1187.82 792.4,-1195.08 795.24,-1188.68"/>
</g>
<!-- gate_3_gpu2&#45;&gt;expert_3_gpu2_exp4 -->
<g id="edge269" class="edge">
<title>gate_3_gpu2&#45;&gt;expert_3_gpu2_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M947.4,-1226.54C936.24,-1216.62 925.05,-1206.68 914.79,-1197.56"/>
<polygon fill="black" stroke="black" points="916.94,-1194.78 907.14,-1190.76 912.29,-1200.02 916.94,-1194.78"/>
</g>
<!-- agg_3_gpu2&#45;&gt;residual2_3_gpu2 -->
<g id="edge274" class="edge">
<title>agg_3_gpu2&#45;&gt;residual2_3_gpu2</title>
<path fill="none" stroke="black" d="M1040.79,-950.54C1043.13,-941.69 1045.48,-932.82 1047.67,-924.53"/>
<polygon fill="black" stroke="black" points="1051.08,-925.32 1050.26,-914.76 1044.32,-923.53 1051.08,-925.32"/>
</g>
<!-- mha_4_gpu2 -->
<g id="node227" class="node">
<title>mha_4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1112.5,-810.74 957.5,-810.74 957.5,-757.74 1112.5,-757.74 1112.5,-810.74"/>
<text text-anchor="middle" x="1035" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="1035" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1035" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu2&#45;&gt;mha_4_gpu2 -->
<g id="edge276" class="edge">
<title>residual2_3_gpu2&#45;&gt;mha_4_gpu2</title>
<path fill="none" stroke="black" d="M1050.61,-846.69C1048.49,-838.36 1046.21,-829.39 1044.07,-820.94"/>
<polygon fill="black" stroke="black" points="1047.39,-819.81 1041.54,-810.98 1040.61,-821.53 1047.39,-819.81"/>
</g>
<!-- residual1_4_gpu2 -->
<g id="node228" class="node">
<title>residual1_4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1148.5,-721.74 993.5,-721.74 993.5,-668.74 1148.5,-668.74 1148.5,-721.74"/>
<text text-anchor="middle" x="1071" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1071" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1071" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu2&#45;&gt;residual1_4_gpu2 -->
<g id="edge278" class="edge">
<title>residual2_3_gpu2&#45;&gt;residual1_4_gpu2</title>
<path fill="none" stroke="black" d="M1097.51,-846.69C1107.02,-836.26 1115.93,-823.97 1121,-810.74 1129.43,-788.74 1128.88,-779.94 1121,-757.74 1117.44,-747.72 1111.47,-738.14 1104.87,-729.65"/>
<polygon fill="black" stroke="black" points="1107.49,-727.33 1098.41,-721.87 1102.11,-731.8 1107.49,-727.33"/>
</g>
<!-- mha_3_gpu3 -->
<g id="node164" class="node">
<title>mha_3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1784.5,-1540.74 1629.5,-1540.74 1629.5,-1487.74 1784.5,-1487.74 1784.5,-1540.74"/>
<text text-anchor="middle" x="1707" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="1707" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1707" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu3 -->
<g id="node165" class="node">
<title>residual1_3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1767.5,-1451.74 1612.5,-1451.74 1612.5,-1398.74 1767.5,-1398.74 1767.5,-1451.74"/>
<text text-anchor="middle" x="1690" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1690" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1690" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu3&#45;&gt;residual1_3_gpu3 -->
<g id="edge292" class="edge">
<title>mha_3_gpu3&#45;&gt;residual1_3_gpu3</title>
<path fill="none" stroke="black" d="M1701.99,-1487.61C1700.41,-1479.54 1698.64,-1470.48 1696.96,-1461.84"/>
<polygon fill="black" stroke="black" points="1700.38,-1461.13 1695.03,-1451.99 1693.51,-1462.48 1700.38,-1461.13"/>
</g>
<!-- gate_3_gpu3 -->
<g id="node170" class="node">
<title>gate_3_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="1795.92,-1362.74 1573.34,-1362.74 1516.08,-1226.74 1738.66,-1226.74 1795.92,-1362.74"/>
<text text-anchor="middle" x="1656" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1656" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1656" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu3&#45;&gt;gate_3_gpu3 -->
<g id="edge294" class="edge">
<title>residual1_3_gpu3&#45;&gt;gate_3_gpu3</title>
<path fill="none" stroke="black" d="M1683.2,-1398.55C1681.16,-1390.83 1678.8,-1381.93 1676.35,-1372.67"/>
<polygon fill="black" stroke="black" points="1679.72,-1371.69 1673.77,-1362.91 1672.95,-1373.48 1679.72,-1371.69"/>
</g>
<!-- residual2_3_gpu3 -->
<g id="node172" class="node">
<title>residual2_3_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1841.5,-914.74 1686.5,-914.74 1686.5,-846.74 1841.5,-846.74 1841.5,-914.74"/>
<text text-anchor="middle" x="1764" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1764" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1764" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1764" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu3&#45;&gt;residual2_3_gpu3 -->
<g id="edge304" class="edge">
<title>residual1_3_gpu3&#45;&gt;residual2_3_gpu3</title>
<path fill="none" stroke="black" d="M1754.95,-1398.68C1772.79,-1389.36 1791.04,-1377.43 1805,-1362.74 1863.21,-1301.49 1867.56,-1273.2 1886,-1190.74 1910,-1083.44 1881.95,-1045.39 1826,-950.74 1820.23,-940.98 1812.95,-931.37 1805.42,-922.57"/>
<polygon fill="black" stroke="black" points="1808.02,-920.23 1798.77,-915.06 1802.78,-924.87 1808.02,-920.23"/>
</g>
<!-- expert_3_gpu3_exp1 -->
<g id="node166" class="node">
<title>expert_3_gpu3_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1570.5,-1190.74 1435.5,-1190.74 1435.5,-1122.74 1570.5,-1122.74 1570.5,-1190.74"/>
<text text-anchor="middle" x="1503" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1503" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1503" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1503" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu3 -->
<g id="node171" class="node">
<title>agg_3_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="1816.89,-1086.74 1560.95,-1086.74 1495.11,-950.74 1751.05,-950.74 1816.89,-1086.74"/>
<text text-anchor="middle" x="1656" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1656" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1656" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu3_exp1&#45;&gt;agg_3_gpu3 -->
<g id="edge299" class="edge">
<title>expert_3_gpu3_exp1&#45;&gt;agg_3_gpu3</title>
<path fill="none" stroke="black" d="M1540.43,-1122.47C1550.28,-1113.72 1561.3,-1103.91 1572.53,-1093.93"/>
<polygon fill="black" stroke="black" points="1575.18,-1096.26 1580.33,-1087 1570.53,-1091.03 1575.18,-1096.26"/>
</g>
<!-- expert_3_gpu3_exp2 -->
<g id="node167" class="node">
<title>expert_3_gpu3_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1723.5,-1190.74 1588.5,-1190.74 1588.5,-1122.74 1723.5,-1122.74 1723.5,-1190.74"/>
<text text-anchor="middle" x="1656" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1656" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1656" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu3_exp2&#45;&gt;agg_3_gpu3 -->
<g id="edge300" class="edge">
<title>expert_3_gpu3_exp2&#45;&gt;agg_3_gpu3</title>
<path fill="none" stroke="black" d="M1656,-1122.47C1656,-1114.64 1656,-1105.98 1656,-1097.09"/>
<polygon fill="black" stroke="black" points="1659.5,-1097 1656,-1087 1652.5,-1097 1659.5,-1097"/>
</g>
<!-- expert_3_gpu3_exp3 -->
<g id="node168" class="node">
<title>expert_3_gpu3_exp3</title>
<polygon fill="lightgreen" stroke="black" points="1876.5,-1190.74 1741.5,-1190.74 1741.5,-1122.74 1876.5,-1122.74 1876.5,-1190.74"/>
<text text-anchor="middle" x="1809" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1809" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1809" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1809" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu3_exp3&#45;&gt;agg_3_gpu3 -->
<g id="edge301" class="edge">
<title>expert_3_gpu3_exp3&#45;&gt;agg_3_gpu3</title>
<path fill="none" stroke="black" d="M1771.57,-1122.47C1761.72,-1113.72 1750.7,-1103.91 1739.47,-1093.93"/>
<polygon fill="black" stroke="black" points="1741.47,-1091.03 1731.67,-1087 1736.82,-1096.26 1741.47,-1091.03"/>
</g>
<!-- expert_3_gpu3_exp4 -->
<g id="node169" class="node">
<title>expert_3_gpu3_exp4</title>
<polygon fill="lightgreen" stroke="black" points="1417.5,-1190.74 1282.5,-1190.74 1282.5,-1122.74 1417.5,-1122.74 1417.5,-1190.74"/>
<text text-anchor="middle" x="1350" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1350" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1350" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1350" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu3_exp4&#45;&gt;agg_3_gpu3 -->
<g id="edge302" class="edge">
<title>expert_3_gpu3_exp4&#45;&gt;agg_3_gpu3</title>
<path fill="none" stroke="black" d="M1417.53,-1125.73C1454.02,-1109.51 1500.05,-1089.05 1541.91,-1070.45"/>
<polygon fill="black" stroke="black" points="1543.34,-1073.64 1551.06,-1066.38 1540.5,-1067.25 1543.34,-1073.64"/>
</g>
<!-- gate_3_gpu3&#45;&gt;expert_3_gpu3_exp1 -->
<g id="edge295" class="edge">
<title>gate_3_gpu3&#45;&gt;expert_3_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1580.4,-1226.54C1569.24,-1216.62 1558.05,-1206.68 1547.79,-1197.56"/>
<polygon fill="black" stroke="black" points="1549.94,-1194.78 1540.14,-1190.76 1545.29,-1200.02 1549.94,-1194.78"/>
</g>
<!-- gate_3_gpu3&#45;&gt;expert_3_gpu3_exp2 -->
<g id="edge296" class="edge">
<title>gate_3_gpu3&#45;&gt;expert_3_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1656,-1226.54C1656,-1217.78 1656,-1209.02 1656,-1200.81"/>
<polygon fill="black" stroke="black" points="1659.5,-1200.76 1656,-1190.76 1652.5,-1200.76 1659.5,-1200.76"/>
</g>
<!-- gate_3_gpu3&#45;&gt;expert_3_gpu3_exp3 -->
<g id="edge297" class="edge">
<title>gate_3_gpu3&#45;&gt;expert_3_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1731.6,-1226.54C1742.76,-1216.62 1753.95,-1206.68 1764.21,-1197.56"/>
<polygon fill="black" stroke="black" points="1766.71,-1200.02 1771.86,-1190.76 1762.06,-1194.78 1766.71,-1200.02"/>
</g>
<!-- gate_3_gpu3&#45;&gt;expert_3_gpu3_exp4 -->
<g id="edge298" class="edge">
<title>gate_3_gpu3&#45;&gt;expert_3_gpu3_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1518.22,-1232.5C1486.86,-1218.57 1454.65,-1204.25 1426.91,-1191.92"/>
<polygon fill="black" stroke="black" points="1428.24,-1188.68 1417.68,-1187.82 1425.4,-1195.08 1428.24,-1188.68"/>
</g>
<!-- agg_3_gpu3&#45;&gt;residual2_3_gpu3 -->
<g id="edge303" class="edge">
<title>agg_3_gpu3&#45;&gt;residual2_3_gpu3</title>
<path fill="none" stroke="black" d="M1709.37,-950.54C1716.94,-941.01 1724.52,-931.46 1731.53,-922.63"/>
<polygon fill="black" stroke="black" points="1734.3,-924.76 1737.78,-914.76 1728.82,-920.41 1734.3,-924.76"/>
</g>
<!-- mha_4_gpu3 -->
<g id="node236" class="node">
<title>mha_4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1817.5,-810.74 1662.5,-810.74 1662.5,-757.74 1817.5,-757.74 1817.5,-810.74"/>
<text text-anchor="middle" x="1740" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="1740" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1740" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu3&#45;&gt;mha_4_gpu3 -->
<g id="edge305" class="edge">
<title>residual2_3_gpu3&#45;&gt;mha_4_gpu3</title>
<path fill="none" stroke="black" d="M1755.61,-846.69C1753.49,-838.36 1751.21,-829.39 1749.07,-820.94"/>
<polygon fill="black" stroke="black" points="1752.39,-819.81 1746.54,-810.98 1745.61,-821.53 1752.39,-819.81"/>
</g>
<!-- residual1_4_gpu3 -->
<g id="node237" class="node">
<title>residual1_4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1865.5,-721.74 1710.5,-721.74 1710.5,-668.74 1865.5,-668.74 1865.5,-721.74"/>
<text text-anchor="middle" x="1788" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="1788" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1788" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu3&#45;&gt;residual1_4_gpu3 -->
<g id="edge307" class="edge">
<title>residual2_3_gpu3&#45;&gt;residual1_4_gpu3</title>
<path fill="none" stroke="black" d="M1803.45,-846.43C1812.99,-836.08 1821.9,-823.9 1827,-810.74 1835.52,-788.78 1833.57,-780.36 1827,-757.74 1824.25,-748.28 1819.56,-738.88 1814.37,-730.38"/>
<polygon fill="black" stroke="black" points="1817.23,-728.35 1808.84,-721.88 1811.36,-732.17 1817.23,-728.35"/>
</g>
<!-- mha_3_gpu4 -->
<g id="node173" class="node">
<title>mha_3_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2289.5,-1540.74 2134.5,-1540.74 2134.5,-1487.74 2289.5,-1487.74 2289.5,-1540.74"/>
<text text-anchor="middle" x="2212" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="2212" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2212" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu4 -->
<g id="node174" class="node">
<title>residual1_3_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2289.5,-1451.74 2134.5,-1451.74 2134.5,-1398.74 2289.5,-1398.74 2289.5,-1451.74"/>
<text text-anchor="middle" x="2212" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2212" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2212" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu4&#45;&gt;residual1_3_gpu4 -->
<g id="edge321" class="edge">
<title>mha_3_gpu4&#45;&gt;residual1_3_gpu4</title>
<path fill="none" stroke="black" d="M2212,-1487.61C2212,-1479.63 2212,-1470.67 2212,-1462.12"/>
<polygon fill="black" stroke="black" points="2215.5,-1461.99 2212,-1451.99 2208.5,-1461.99 2215.5,-1461.99"/>
</g>
<!-- gate_3_gpu4 -->
<g id="node179" class="node">
<title>gate_3_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="2351.92,-1362.74 2129.34,-1362.74 2072.08,-1226.74 2294.66,-1226.74 2351.92,-1362.74"/>
<text text-anchor="middle" x="2212" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2212" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2212" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2212" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu4&#45;&gt;gate_3_gpu4 -->
<g id="edge323" class="edge">
<title>residual1_3_gpu4&#45;&gt;gate_3_gpu4</title>
<path fill="none" stroke="black" d="M2212,-1398.55C2212,-1390.91 2212,-1382.12 2212,-1372.96"/>
<polygon fill="black" stroke="black" points="2215.5,-1372.91 2212,-1362.91 2208.5,-1372.91 2215.5,-1372.91"/>
</g>
<!-- residual2_3_gpu4 -->
<g id="node181" class="node">
<title>residual2_3_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2486.5,-914.74 2331.5,-914.74 2331.5,-846.74 2486.5,-846.74 2486.5,-914.74"/>
<text text-anchor="middle" x="2409" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2409" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2409" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2409" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu4&#45;&gt;residual2_3_gpu4 -->
<g id="edge333" class="edge">
<title>residual1_3_gpu4&#45;&gt;residual2_3_gpu4</title>
<path fill="none" stroke="black" d="M2289.58,-1399.62C2313.61,-1390.09 2339.43,-1377.8 2361,-1362.74 2446.1,-1303.31 2481.32,-1287.46 2519,-1190.74 2556.02,-1095.72 2487.42,-982.44 2442.85,-922.93"/>
<polygon fill="black" stroke="black" points="2445.58,-920.74 2436.74,-914.9 2440.01,-924.98 2445.58,-920.74"/>
</g>
<!-- expert_3_gpu4_exp1 -->
<g id="node175" class="node">
<title>expert_3_gpu4_exp1</title>
<polygon fill="lightgreen" stroke="black" points="2050.5,-1190.74 1915.5,-1190.74 1915.5,-1122.74 2050.5,-1122.74 2050.5,-1190.74"/>
<text text-anchor="middle" x="1983" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1983" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="1983" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1983" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu4 -->
<g id="node180" class="node">
<title>agg_3_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="2449.89,-1086.74 2193.95,-1086.74 2128.11,-950.74 2384.05,-950.74 2449.89,-1086.74"/>
<text text-anchor="middle" x="2289" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2289" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2289" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu4_exp1&#45;&gt;agg_3_gpu4 -->
<g id="edge328" class="edge">
<title>expert_3_gpu4_exp1&#45;&gt;agg_3_gpu4</title>
<path fill="none" stroke="black" d="M2050.53,-1125.73C2087.02,-1109.51 2133.05,-1089.05 2174.91,-1070.45"/>
<polygon fill="black" stroke="black" points="2176.34,-1073.64 2184.06,-1066.38 2173.5,-1067.25 2176.34,-1073.64"/>
</g>
<!-- expert_3_gpu4_exp2 -->
<g id="node176" class="node">
<title>expert_3_gpu4_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2203.5,-1190.74 2068.5,-1190.74 2068.5,-1122.74 2203.5,-1122.74 2203.5,-1190.74"/>
<text text-anchor="middle" x="2136" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2136" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2136" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2136" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu4_exp2&#45;&gt;agg_3_gpu4 -->
<g id="edge329" class="edge">
<title>expert_3_gpu4_exp2&#45;&gt;agg_3_gpu4</title>
<path fill="none" stroke="black" d="M2173.43,-1122.47C2183.28,-1113.72 2194.3,-1103.91 2205.53,-1093.93"/>
<polygon fill="black" stroke="black" points="2208.18,-1096.26 2213.33,-1087 2203.53,-1091.03 2208.18,-1096.26"/>
</g>
<!-- expert_3_gpu4_exp3 -->
<g id="node177" class="node">
<title>expert_3_gpu4_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2356.5,-1190.74 2221.5,-1190.74 2221.5,-1122.74 2356.5,-1122.74 2356.5,-1190.74"/>
<text text-anchor="middle" x="2289" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2289" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2289" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu4_exp3&#45;&gt;agg_3_gpu4 -->
<g id="edge330" class="edge">
<title>expert_3_gpu4_exp3&#45;&gt;agg_3_gpu4</title>
<path fill="none" stroke="black" d="M2289,-1122.47C2289,-1114.64 2289,-1105.98 2289,-1097.09"/>
<polygon fill="black" stroke="black" points="2292.5,-1097 2289,-1087 2285.5,-1097 2292.5,-1097"/>
</g>
<!-- expert_3_gpu4_exp4 -->
<g id="node178" class="node">
<title>expert_3_gpu4_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2509.5,-1190.74 2374.5,-1190.74 2374.5,-1122.74 2509.5,-1122.74 2509.5,-1190.74"/>
<text text-anchor="middle" x="2442" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2442" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2442" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2442" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu4_exp4&#45;&gt;agg_3_gpu4 -->
<g id="edge331" class="edge">
<title>expert_3_gpu4_exp4&#45;&gt;agg_3_gpu4</title>
<path fill="none" stroke="black" d="M2404.57,-1122.47C2394.72,-1113.72 2383.7,-1103.91 2372.47,-1093.93"/>
<polygon fill="black" stroke="black" points="2374.47,-1091.03 2364.67,-1087 2369.82,-1096.26 2374.47,-1091.03"/>
</g>
<!-- gate_3_gpu4&#45;&gt;expert_3_gpu4_exp1 -->
<g id="edge324" class="edge">
<title>gate_3_gpu4&#45;&gt;expert_3_gpu4_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2099.18,-1226.74C2081.46,-1216.21 2063.69,-1205.66 2047.56,-1196.08"/>
<polygon fill="black" stroke="black" points="2049.17,-1192.96 2038.78,-1190.87 2045.59,-1198.98 2049.17,-1192.96"/>
</g>
<!-- gate_3_gpu4&#45;&gt;expert_3_gpu4_exp2 -->
<g id="edge325" class="edge">
<title>gate_3_gpu4&#45;&gt;expert_3_gpu4_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2174.45,-1226.54C2169.34,-1217.4 2164.22,-1208.24 2159.46,-1199.72"/>
<polygon fill="black" stroke="black" points="2162.38,-1197.78 2154.45,-1190.76 2156.27,-1201.19 2162.38,-1197.78"/>
</g>
<!-- gate_3_gpu4&#45;&gt;expert_3_gpu4_exp3 -->
<g id="edge326" class="edge">
<title>gate_3_gpu4&#45;&gt;expert_3_gpu4_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2250.05,-1226.54C2255.22,-1217.4 2260.41,-1208.24 2265.23,-1199.72"/>
<polygon fill="black" stroke="black" points="2268.43,-1201.18 2270.31,-1190.76 2262.33,-1197.73 2268.43,-1201.18"/>
</g>
<!-- gate_3_gpu4&#45;&gt;expert_3_gpu4_exp4 -->
<g id="edge327" class="edge">
<title>gate_3_gpu4&#45;&gt;expert_3_gpu4_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2300.92,-1241.16C2326.26,-1226.18 2353.37,-1210.15 2376.99,-1196.18"/>
<polygon fill="black" stroke="black" points="2379.04,-1199.04 2385.86,-1190.93 2375.47,-1193.01 2379.04,-1199.04"/>
</g>
<!-- agg_3_gpu4&#45;&gt;residual2_3_gpu4 -->
<g id="edge332" class="edge">
<title>agg_3_gpu4&#45;&gt;residual2_3_gpu4</title>
<path fill="none" stroke="black" d="M2348.3,-950.54C2356.79,-940.91 2365.3,-931.26 2373.16,-922.36"/>
<polygon fill="black" stroke="black" points="2375.88,-924.57 2379.87,-914.76 2370.63,-919.94 2375.88,-924.57"/>
</g>
<!-- mha_4_gpu4 -->
<g id="node245" class="node">
<title>mha_4_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2438.5,-810.74 2283.5,-810.74 2283.5,-757.74 2438.5,-757.74 2438.5,-810.74"/>
<text text-anchor="middle" x="2361" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="2361" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2361" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu4&#45;&gt;mha_4_gpu4 -->
<g id="edge334" class="edge">
<title>residual2_3_gpu4&#45;&gt;mha_4_gpu4</title>
<path fill="none" stroke="black" d="M2392.21,-846.69C2387.84,-838.09 2383.12,-828.8 2378.71,-820.11"/>
<polygon fill="black" stroke="black" points="2381.72,-818.31 2374.07,-810.98 2375.48,-821.48 2381.72,-818.31"/>
</g>
<!-- residual1_4_gpu4 -->
<g id="node246" class="node">
<title>residual1_4_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2486.5,-721.74 2331.5,-721.74 2331.5,-668.74 2486.5,-668.74 2486.5,-721.74"/>
<text text-anchor="middle" x="2409" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2409" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2409" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu4&#45;&gt;residual1_4_gpu4 -->
<g id="edge336" class="edge">
<title>residual2_3_gpu4&#45;&gt;residual1_4_gpu4</title>
<path fill="none" stroke="black" d="M2432.34,-846.49C2438.71,-835.61 2444.74,-823.12 2448,-810.74 2453.99,-787.96 2454.57,-780.36 2448,-757.74 2445.25,-748.28 2440.56,-738.88 2435.37,-730.38"/>
<polygon fill="black" stroke="black" points="2438.23,-728.35 2429.84,-721.88 2432.36,-732.17 2438.23,-728.35"/>
</g>
<!-- mha_3_gpu5 -->
<g id="node182" class="node">
<title>mha_3_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3239.5,-1540.74 3084.5,-1540.74 3084.5,-1487.74 3239.5,-1487.74 3239.5,-1540.74"/>
<text text-anchor="middle" x="3162" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="3162" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3162" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu5 -->
<g id="node183" class="node">
<title>residual1_3_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3239.5,-1451.74 3084.5,-1451.74 3084.5,-1398.74 3239.5,-1398.74 3239.5,-1451.74"/>
<text text-anchor="middle" x="3162" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3162" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3162" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu5&#45;&gt;residual1_3_gpu5 -->
<g id="edge350" class="edge">
<title>mha_3_gpu5&#45;&gt;residual1_3_gpu5</title>
<path fill="none" stroke="black" d="M3162,-1487.61C3162,-1479.63 3162,-1470.67 3162,-1462.12"/>
<polygon fill="black" stroke="black" points="3165.5,-1461.99 3162,-1451.99 3158.5,-1461.99 3165.5,-1461.99"/>
</g>
<!-- gate_3_gpu5 -->
<g id="node188" class="node">
<title>gate_3_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="3061.92,-1362.74 2839.34,-1362.74 2782.08,-1226.74 3004.66,-1226.74 3061.92,-1362.74"/>
<text text-anchor="middle" x="2922" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2922" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2922" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu5&#45;&gt;gate_3_gpu5 -->
<g id="edge352" class="edge">
<title>residual1_3_gpu5&#45;&gt;gate_3_gpu5</title>
<path fill="none" stroke="black" d="M3114.3,-1398.7C3097.19,-1389.54 3076.96,-1378.71 3056.16,-1367.57"/>
<polygon fill="black" stroke="black" points="3057.68,-1364.42 3047.21,-1362.78 3054.38,-1370.59 3057.68,-1364.42"/>
</g>
<!-- residual2_3_gpu5 -->
<g id="node190" class="node">
<title>residual2_3_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3107.5,-914.74 2952.5,-914.74 2952.5,-846.74 3107.5,-846.74 3107.5,-914.74"/>
<text text-anchor="middle" x="3030" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3030" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3030" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3030" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu5&#45;&gt;residual2_3_gpu5 -->
<g id="edge362" class="edge">
<title>residual1_3_gpu5&#45;&gt;residual2_3_gpu5</title>
<path fill="none" stroke="black" d="M3163.73,-1398.55C3166.71,-1346.15 3170.77,-1223.39 3152,-1122.74 3137.16,-1043.15 3133.2,-1020.44 3092,-950.74 3086.23,-940.98 3078.95,-931.37 3071.42,-922.57"/>
<polygon fill="black" stroke="black" points="3074.02,-920.23 3064.77,-915.06 3068.78,-924.87 3074.02,-920.23"/>
</g>
<!-- expert_3_gpu5_exp1 -->
<g id="node184" class="node">
<title>expert_3_gpu5_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-1190.74 3007.5,-1190.74 3007.5,-1122.74 3142.5,-1122.74 3142.5,-1190.74"/>
<text text-anchor="middle" x="3075" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3075" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3075" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3075" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu5 -->
<g id="node189" class="node">
<title>agg_3_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="3082.89,-1086.74 2826.95,-1086.74 2761.11,-950.74 3017.05,-950.74 3082.89,-1086.74"/>
<text text-anchor="middle" x="2922" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2922" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2922" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu5_exp1&#45;&gt;agg_3_gpu5 -->
<g id="edge357" class="edge">
<title>expert_3_gpu5_exp1&#45;&gt;agg_3_gpu5</title>
<path fill="none" stroke="black" d="M3037.57,-1122.47C3027.72,-1113.72 3016.7,-1103.91 3005.47,-1093.93"/>
<polygon fill="black" stroke="black" points="3007.47,-1091.03 2997.67,-1087 3002.82,-1096.26 3007.47,-1091.03"/>
</g>
<!-- expert_3_gpu5_exp2 -->
<g id="node185" class="node">
<title>expert_3_gpu5_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2683.5,-1190.74 2548.5,-1190.74 2548.5,-1122.74 2683.5,-1122.74 2683.5,-1190.74"/>
<text text-anchor="middle" x="2616" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2616" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2616" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2616" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu5_exp2&#45;&gt;agg_3_gpu5 -->
<g id="edge358" class="edge">
<title>expert_3_gpu5_exp2&#45;&gt;agg_3_gpu5</title>
<path fill="none" stroke="black" d="M2683.53,-1125.73C2720.02,-1109.51 2766.05,-1089.05 2807.91,-1070.45"/>
<polygon fill="black" stroke="black" points="2809.34,-1073.64 2817.06,-1066.38 2806.5,-1067.25 2809.34,-1073.64"/>
</g>
<!-- expert_3_gpu5_exp3 -->
<g id="node186" class="node">
<title>expert_3_gpu5_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2836.5,-1190.74 2701.5,-1190.74 2701.5,-1122.74 2836.5,-1122.74 2836.5,-1190.74"/>
<text text-anchor="middle" x="2769" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2769" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2769" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2769" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu5_exp3&#45;&gt;agg_3_gpu5 -->
<g id="edge359" class="edge">
<title>expert_3_gpu5_exp3&#45;&gt;agg_3_gpu5</title>
<path fill="none" stroke="black" d="M2806.43,-1122.47C2816.28,-1113.72 2827.3,-1103.91 2838.53,-1093.93"/>
<polygon fill="black" stroke="black" points="2841.18,-1096.26 2846.33,-1087 2836.53,-1091.03 2841.18,-1096.26"/>
</g>
<!-- expert_3_gpu5_exp4 -->
<g id="node187" class="node">
<title>expert_3_gpu5_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-1190.74 2854.5,-1190.74 2854.5,-1122.74 2989.5,-1122.74 2989.5,-1190.74"/>
<text text-anchor="middle" x="2922" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2922" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="2922" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu5_exp4&#45;&gt;agg_3_gpu5 -->
<g id="edge360" class="edge">
<title>expert_3_gpu5_exp4&#45;&gt;agg_3_gpu5</title>
<path fill="none" stroke="black" d="M2922,-1122.47C2922,-1114.64 2922,-1105.98 2922,-1097.09"/>
<polygon fill="black" stroke="black" points="2925.5,-1097 2922,-1087 2918.5,-1097 2925.5,-1097"/>
</g>
<!-- gate_3_gpu5&#45;&gt;expert_3_gpu5_exp1 -->
<g id="edge353" class="edge">
<title>gate_3_gpu5&#45;&gt;expert_3_gpu5_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.6,-1226.54C3008.76,-1216.62 3019.95,-1206.68 3030.21,-1197.56"/>
<polygon fill="black" stroke="black" points="3032.71,-1200.02 3037.86,-1190.76 3028.06,-1194.78 3032.71,-1200.02"/>
</g>
<!-- gate_3_gpu5&#45;&gt;expert_3_gpu5_exp2 -->
<g id="edge354" class="edge">
<title>gate_3_gpu5&#45;&gt;expert_3_gpu5_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2784.22,-1232.5C2752.86,-1218.57 2720.65,-1204.25 2692.91,-1191.92"/>
<polygon fill="black" stroke="black" points="2694.24,-1188.68 2683.68,-1187.82 2691.4,-1195.08 2694.24,-1188.68"/>
</g>
<!-- gate_3_gpu5&#45;&gt;expert_3_gpu5_exp3 -->
<g id="edge355" class="edge">
<title>gate_3_gpu5&#45;&gt;expert_3_gpu5_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2846.4,-1226.54C2835.24,-1216.62 2824.05,-1206.68 2813.79,-1197.56"/>
<polygon fill="black" stroke="black" points="2815.94,-1194.78 2806.14,-1190.76 2811.29,-1200.02 2815.94,-1194.78"/>
</g>
<!-- gate_3_gpu5&#45;&gt;expert_3_gpu5_exp4 -->
<g id="edge356" class="edge">
<title>gate_3_gpu5&#45;&gt;expert_3_gpu5_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2922,-1226.54C2922,-1217.78 2922,-1209.02 2922,-1200.81"/>
<polygon fill="black" stroke="black" points="2925.5,-1200.76 2922,-1190.76 2918.5,-1200.76 2925.5,-1200.76"/>
</g>
<!-- agg_3_gpu5&#45;&gt;residual2_3_gpu5 -->
<g id="edge361" class="edge">
<title>agg_3_gpu5&#45;&gt;residual2_3_gpu5</title>
<path fill="none" stroke="black" d="M2975.37,-950.54C2982.94,-941.01 2990.52,-931.46 2997.53,-922.63"/>
<polygon fill="black" stroke="black" points="3000.3,-924.76 3003.78,-914.76 2994.82,-920.41 3000.3,-924.76"/>
</g>
<!-- mha_4_gpu5 -->
<g id="node254" class="node">
<title>mha_4_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3083.5,-810.74 2928.5,-810.74 2928.5,-757.74 3083.5,-757.74 3083.5,-810.74"/>
<text text-anchor="middle" x="3006" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="3006" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3006" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu5&#45;&gt;mha_4_gpu5 -->
<g id="edge363" class="edge">
<title>residual2_3_gpu5&#45;&gt;mha_4_gpu5</title>
<path fill="none" stroke="black" d="M3021.61,-846.69C3019.49,-838.36 3017.21,-829.39 3015.07,-820.94"/>
<polygon fill="black" stroke="black" points="3018.39,-819.81 3012.54,-810.98 3011.61,-821.53 3018.39,-819.81"/>
</g>
<!-- residual1_4_gpu5 -->
<g id="node255" class="node">
<title>residual1_4_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="3131.5,-721.74 2976.5,-721.74 2976.5,-668.74 3131.5,-668.74 3131.5,-721.74"/>
<text text-anchor="middle" x="3054" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3054" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3054" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu5&#45;&gt;residual1_4_gpu5 -->
<g id="edge365" class="edge">
<title>residual2_3_gpu5&#45;&gt;residual1_4_gpu5</title>
<path fill="none" stroke="black" d="M3069.45,-846.43C3078.99,-836.08 3087.9,-823.9 3093,-810.74 3101.52,-788.78 3099.57,-780.36 3093,-757.74 3090.25,-748.28 3085.56,-738.88 3080.37,-730.38"/>
<polygon fill="black" stroke="black" points="3083.23,-728.35 3074.84,-721.88 3077.36,-732.17 3083.23,-728.35"/>
</g>
<!-- mha_3_gpu6 -->
<g id="node191" class="node">
<title>mha_3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3821.5,-1540.74 3666.5,-1540.74 3666.5,-1487.74 3821.5,-1487.74 3821.5,-1540.74"/>
<text text-anchor="middle" x="3744" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="3744" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3744" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu6 -->
<g id="node192" class="node">
<title>residual1_3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3855.5,-1451.74 3700.5,-1451.74 3700.5,-1398.74 3855.5,-1398.74 3855.5,-1451.74"/>
<text text-anchor="middle" x="3778" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3778" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3778" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu6&#45;&gt;residual1_3_gpu6 -->
<g id="edge379" class="edge">
<title>mha_3_gpu6&#45;&gt;residual1_3_gpu6</title>
<path fill="none" stroke="black" d="M3754.02,-1487.61C3757.21,-1479.45 3760.79,-1470.28 3764.2,-1461.56"/>
<polygon fill="black" stroke="black" points="3767.56,-1462.58 3767.94,-1451.99 3761.04,-1460.03 3767.56,-1462.58"/>
</g>
<!-- gate_3_gpu6 -->
<g id="node197" class="node">
<title>gate_3_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="3694.92,-1362.74 3472.34,-1362.74 3415.08,-1226.74 3637.66,-1226.74 3694.92,-1362.74"/>
<text text-anchor="middle" x="3555" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3555" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3555" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu6&#45;&gt;gate_3_gpu6 -->
<g id="edge381" class="edge">
<title>residual1_3_gpu6&#45;&gt;gate_3_gpu6</title>
<path fill="none" stroke="black" d="M3733.68,-1398.7C3717.92,-1389.62 3699.32,-1378.9 3680.17,-1367.87"/>
<polygon fill="black" stroke="black" points="3681.76,-1364.74 3671.34,-1362.78 3678.26,-1370.81 3681.76,-1364.74"/>
</g>
<!-- residual2_3_gpu6 -->
<g id="node199" class="node">
<title>residual2_3_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3740.5,-914.74 3585.5,-914.74 3585.5,-846.74 3740.5,-846.74 3740.5,-914.74"/>
<text text-anchor="middle" x="3663" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3663" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3663" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3663" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu6&#45;&gt;residual2_3_gpu6 -->
<g id="edge391" class="edge">
<title>residual1_3_gpu6&#45;&gt;residual2_3_gpu6</title>
<path fill="none" stroke="black" d="M3781.85,-1398.59C3789,-1346.27 3802.1,-1223.66 3785,-1122.74 3771.48,-1042.92 3766.2,-1020.44 3725,-950.74 3719.23,-940.98 3711.95,-931.37 3704.42,-922.57"/>
<polygon fill="black" stroke="black" points="3707.02,-920.23 3697.77,-915.06 3701.78,-924.87 3707.02,-920.23"/>
</g>
<!-- expert_3_gpu6_exp1 -->
<g id="node193" class="node">
<title>expert_3_gpu6_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3622.5,-1190.74 3487.5,-1190.74 3487.5,-1122.74 3622.5,-1122.74 3622.5,-1190.74"/>
<text text-anchor="middle" x="3555" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3555" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3555" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu6 -->
<g id="node198" class="node">
<title>agg_3_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="3715.89,-1086.74 3459.95,-1086.74 3394.11,-950.74 3650.05,-950.74 3715.89,-1086.74"/>
<text text-anchor="middle" x="3555" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="3555" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3555" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu6_exp1&#45;&gt;agg_3_gpu6 -->
<g id="edge386" class="edge">
<title>expert_3_gpu6_exp1&#45;&gt;agg_3_gpu6</title>
<path fill="none" stroke="black" d="M3555,-1122.47C3555,-1114.64 3555,-1105.98 3555,-1097.09"/>
<polygon fill="black" stroke="black" points="3558.5,-1097 3555,-1087 3551.5,-1097 3558.5,-1097"/>
</g>
<!-- expert_3_gpu6_exp2 -->
<g id="node194" class="node">
<title>expert_3_gpu6_exp2</title>
<polygon fill="lightgreen" stroke="black" points="3775.5,-1190.74 3640.5,-1190.74 3640.5,-1122.74 3775.5,-1122.74 3775.5,-1190.74"/>
<text text-anchor="middle" x="3708" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3708" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3708" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3708" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu6_exp2&#45;&gt;agg_3_gpu6 -->
<g id="edge387" class="edge">
<title>expert_3_gpu6_exp2&#45;&gt;agg_3_gpu6</title>
<path fill="none" stroke="black" d="M3670.57,-1122.47C3660.72,-1113.72 3649.7,-1103.91 3638.47,-1093.93"/>
<polygon fill="black" stroke="black" points="3640.47,-1091.03 3630.67,-1087 3635.82,-1096.26 3640.47,-1091.03"/>
</g>
<!-- expert_3_gpu6_exp3 -->
<g id="node195" class="node">
<title>expert_3_gpu6_exp3</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-1190.74 3181.5,-1190.74 3181.5,-1122.74 3316.5,-1122.74 3316.5,-1190.74"/>
<text text-anchor="middle" x="3249" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3249" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3249" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3249" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu6_exp3&#45;&gt;agg_3_gpu6 -->
<g id="edge388" class="edge">
<title>expert_3_gpu6_exp3&#45;&gt;agg_3_gpu6</title>
<path fill="none" stroke="black" d="M3316.53,-1125.73C3353.02,-1109.51 3399.05,-1089.05 3440.91,-1070.45"/>
<polygon fill="black" stroke="black" points="3442.34,-1073.64 3450.06,-1066.38 3439.5,-1067.25 3442.34,-1073.64"/>
</g>
<!-- expert_3_gpu6_exp4 -->
<g id="node196" class="node">
<title>expert_3_gpu6_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3469.5,-1190.74 3334.5,-1190.74 3334.5,-1122.74 3469.5,-1122.74 3469.5,-1190.74"/>
<text text-anchor="middle" x="3402" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3402" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3402" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3402" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu6_exp4&#45;&gt;agg_3_gpu6 -->
<g id="edge389" class="edge">
<title>expert_3_gpu6_exp4&#45;&gt;agg_3_gpu6</title>
<path fill="none" stroke="black" d="M3439.43,-1122.47C3449.28,-1113.72 3460.3,-1103.91 3471.53,-1093.93"/>
<polygon fill="black" stroke="black" points="3474.18,-1096.26 3479.33,-1087 3469.53,-1091.03 3474.18,-1096.26"/>
</g>
<!-- gate_3_gpu6&#45;&gt;expert_3_gpu6_exp1 -->
<g id="edge382" class="edge">
<title>gate_3_gpu6&#45;&gt;expert_3_gpu6_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3555,-1226.54C3555,-1217.78 3555,-1209.02 3555,-1200.81"/>
<polygon fill="black" stroke="black" points="3558.5,-1200.76 3555,-1190.76 3551.5,-1200.76 3558.5,-1200.76"/>
</g>
<!-- gate_3_gpu6&#45;&gt;expert_3_gpu6_exp2 -->
<g id="edge383" class="edge">
<title>gate_3_gpu6&#45;&gt;expert_3_gpu6_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3630.6,-1226.54C3641.76,-1216.62 3652.95,-1206.68 3663.21,-1197.56"/>
<polygon fill="black" stroke="black" points="3665.71,-1200.02 3670.86,-1190.76 3661.06,-1194.78 3665.71,-1200.02"/>
</g>
<!-- gate_3_gpu6&#45;&gt;expert_3_gpu6_exp3 -->
<g id="edge384" class="edge">
<title>gate_3_gpu6&#45;&gt;expert_3_gpu6_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3417.22,-1232.5C3385.86,-1218.57 3353.65,-1204.25 3325.91,-1191.92"/>
<polygon fill="black" stroke="black" points="3327.24,-1188.68 3316.68,-1187.82 3324.4,-1195.08 3327.24,-1188.68"/>
</g>
<!-- gate_3_gpu6&#45;&gt;expert_3_gpu6_exp4 -->
<g id="edge385" class="edge">
<title>gate_3_gpu6&#45;&gt;expert_3_gpu6_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3479.4,-1226.54C3468.24,-1216.62 3457.05,-1206.68 3446.79,-1197.56"/>
<polygon fill="black" stroke="black" points="3448.94,-1194.78 3439.14,-1190.76 3444.29,-1200.02 3448.94,-1194.78"/>
</g>
<!-- agg_3_gpu6&#45;&gt;residual2_3_gpu6 -->
<g id="edge390" class="edge">
<title>agg_3_gpu6&#45;&gt;residual2_3_gpu6</title>
<path fill="none" stroke="black" d="M3608.37,-950.54C3615.94,-941.01 3623.52,-931.46 3630.53,-922.63"/>
<polygon fill="black" stroke="black" points="3633.3,-924.76 3636.78,-914.76 3627.82,-920.41 3633.3,-924.76"/>
</g>
<!-- mha_4_gpu6 -->
<g id="node263" class="node">
<title>mha_4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3716.5,-810.74 3561.5,-810.74 3561.5,-757.74 3716.5,-757.74 3716.5,-810.74"/>
<text text-anchor="middle" x="3639" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="3639" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3639" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu6&#45;&gt;mha_4_gpu6 -->
<g id="edge392" class="edge">
<title>residual2_3_gpu6&#45;&gt;mha_4_gpu6</title>
<path fill="none" stroke="black" d="M3654.61,-846.69C3652.49,-838.36 3650.21,-829.39 3648.07,-820.94"/>
<polygon fill="black" stroke="black" points="3651.39,-819.81 3645.54,-810.98 3644.61,-821.53 3651.39,-819.81"/>
</g>
<!-- residual1_4_gpu6 -->
<g id="node264" class="node">
<title>residual1_4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3764.5,-721.74 3609.5,-721.74 3609.5,-668.74 3764.5,-668.74 3764.5,-721.74"/>
<text text-anchor="middle" x="3687" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3687" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3687" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu6&#45;&gt;residual1_4_gpu6 -->
<g id="edge394" class="edge">
<title>residual2_3_gpu6&#45;&gt;residual1_4_gpu6</title>
<path fill="none" stroke="black" d="M3702.45,-846.43C3711.99,-836.08 3720.9,-823.9 3726,-810.74 3734.52,-788.78 3732.57,-780.36 3726,-757.74 3723.25,-748.28 3718.56,-738.88 3713.37,-730.38"/>
<polygon fill="black" stroke="black" points="3716.23,-728.35 3707.84,-721.88 3710.36,-732.17 3716.23,-728.35"/>
</g>
<!-- mha_3_gpu7 -->
<g id="node200" class="node">
<title>mha_3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="3994.5,-1540.74 3839.5,-1540.74 3839.5,-1487.74 3994.5,-1487.74 3994.5,-1540.74"/>
<text text-anchor="middle" x="3917" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="3917" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3917" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu7 -->
<g id="node201" class="node">
<title>residual1_3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4282.5,-1451.74 4127.5,-1451.74 4127.5,-1398.74 4282.5,-1398.74 4282.5,-1451.74"/>
<text text-anchor="middle" x="4205" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4205" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4205" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu7&#45;&gt;residual1_3_gpu7 -->
<g id="edge408" class="edge">
<title>mha_3_gpu7&#45;&gt;residual1_3_gpu7</title>
<path fill="none" stroke="black" d="M3994.56,-1489.81C4032.49,-1478.35 4078.31,-1464.51 4117.49,-1452.67"/>
<polygon fill="black" stroke="black" points="4118.74,-1455.95 4127.3,-1449.71 4116.72,-1449.25 4118.74,-1455.95"/>
</g>
<!-- gate_3_gpu7 -->
<g id="node206" class="node">
<title>gate_3_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="4327.92,-1362.74 4105.34,-1362.74 4048.08,-1226.74 4270.66,-1226.74 4327.92,-1362.74"/>
<text text-anchor="middle" x="4188" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4188" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4188" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu7&#45;&gt;gate_3_gpu7 -->
<g id="edge410" class="edge">
<title>residual1_3_gpu7&#45;&gt;gate_3_gpu7</title>
<path fill="none" stroke="black" d="M4201.6,-1398.55C4200.59,-1390.91 4199.43,-1382.12 4198.22,-1372.96"/>
<polygon fill="black" stroke="black" points="4201.67,-1372.37 4196.89,-1362.91 4194.73,-1373.29 4201.67,-1372.37"/>
</g>
<!-- residual2_3_gpu7 -->
<g id="node208" class="node">
<title>residual2_3_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4457.5,-914.74 4302.5,-914.74 4302.5,-846.74 4457.5,-846.74 4457.5,-914.74"/>
<text text-anchor="middle" x="4380" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4380" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4380" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4380" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu7&#45;&gt;residual2_3_gpu7 -->
<g id="edge420" class="edge">
<title>residual1_3_gpu7&#45;&gt;residual2_3_gpu7</title>
<path fill="none" stroke="black" d="M4282.63,-1398.88C4302.11,-1389.78 4321.77,-1377.9 4337,-1362.74 4396.87,-1303.11 4399.56,-1273.2 4418,-1190.74 4438.91,-1097.25 4412.65,-985.09 4394.51,-924.93"/>
<polygon fill="black" stroke="black" points="4397.75,-923.55 4391.46,-915.03 4391.06,-925.62 4397.75,-923.55"/>
</g>
<!-- expert_3_gpu7_exp1 -->
<g id="node202" class="node">
<title>expert_3_gpu7_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4102.5,-1190.74 3967.5,-1190.74 3967.5,-1122.74 4102.5,-1122.74 4102.5,-1190.74"/>
<text text-anchor="middle" x="4035" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4035" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4035" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4035" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu7 -->
<g id="node207" class="node">
<title>agg_3_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="4348.89,-1086.74 4092.95,-1086.74 4027.11,-950.74 4283.05,-950.74 4348.89,-1086.74"/>
<text text-anchor="middle" x="4188" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4188" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4188" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu7_exp1&#45;&gt;agg_3_gpu7 -->
<g id="edge415" class="edge">
<title>expert_3_gpu7_exp1&#45;&gt;agg_3_gpu7</title>
<path fill="none" stroke="black" d="M4072.43,-1122.47C4082.28,-1113.72 4093.3,-1103.91 4104.53,-1093.93"/>
<polygon fill="black" stroke="black" points="4107.18,-1096.26 4112.33,-1087 4102.53,-1091.03 4107.18,-1096.26"/>
</g>
<!-- expert_3_gpu7_exp2 -->
<g id="node203" class="node">
<title>expert_3_gpu7_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4255.5,-1190.74 4120.5,-1190.74 4120.5,-1122.74 4255.5,-1122.74 4255.5,-1190.74"/>
<text text-anchor="middle" x="4188" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4188" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4188" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu7_exp2&#45;&gt;agg_3_gpu7 -->
<g id="edge416" class="edge">
<title>expert_3_gpu7_exp2&#45;&gt;agg_3_gpu7</title>
<path fill="none" stroke="black" d="M4188,-1122.47C4188,-1114.64 4188,-1105.98 4188,-1097.09"/>
<polygon fill="black" stroke="black" points="4191.5,-1097 4188,-1087 4184.5,-1097 4191.5,-1097"/>
</g>
<!-- expert_3_gpu7_exp3 -->
<g id="node204" class="node">
<title>expert_3_gpu7_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4408.5,-1190.74 4273.5,-1190.74 4273.5,-1122.74 4408.5,-1122.74 4408.5,-1190.74"/>
<text text-anchor="middle" x="4341" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4341" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4341" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4341" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu7_exp3&#45;&gt;agg_3_gpu7 -->
<g id="edge417" class="edge">
<title>expert_3_gpu7_exp3&#45;&gt;agg_3_gpu7</title>
<path fill="none" stroke="black" d="M4303.57,-1122.47C4293.72,-1113.72 4282.7,-1103.91 4271.47,-1093.93"/>
<polygon fill="black" stroke="black" points="4273.47,-1091.03 4263.67,-1087 4268.82,-1096.26 4273.47,-1091.03"/>
</g>
<!-- expert_3_gpu7_exp4 -->
<g id="node205" class="node">
<title>expert_3_gpu7_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3949.5,-1190.74 3814.5,-1190.74 3814.5,-1122.74 3949.5,-1122.74 3949.5,-1190.74"/>
<text text-anchor="middle" x="3882" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3882" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="3882" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3882" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu7_exp4&#45;&gt;agg_3_gpu7 -->
<g id="edge418" class="edge">
<title>expert_3_gpu7_exp4&#45;&gt;agg_3_gpu7</title>
<path fill="none" stroke="black" d="M3949.53,-1125.73C3986.02,-1109.51 4032.05,-1089.05 4073.91,-1070.45"/>
<polygon fill="black" stroke="black" points="4075.34,-1073.64 4083.06,-1066.38 4072.5,-1067.25 4075.34,-1073.64"/>
</g>
<!-- gate_3_gpu7&#45;&gt;expert_3_gpu7_exp1 -->
<g id="edge411" class="edge">
<title>gate_3_gpu7&#45;&gt;expert_3_gpu7_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4112.4,-1226.54C4101.24,-1216.62 4090.05,-1206.68 4079.79,-1197.56"/>
<polygon fill="black" stroke="black" points="4081.94,-1194.78 4072.14,-1190.76 4077.29,-1200.02 4081.94,-1194.78"/>
</g>
<!-- gate_3_gpu7&#45;&gt;expert_3_gpu7_exp2 -->
<g id="edge412" class="edge">
<title>gate_3_gpu7&#45;&gt;expert_3_gpu7_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4188,-1226.54C4188,-1217.78 4188,-1209.02 4188,-1200.81"/>
<polygon fill="black" stroke="black" points="4191.5,-1200.76 4188,-1190.76 4184.5,-1200.76 4191.5,-1200.76"/>
</g>
<!-- gate_3_gpu7&#45;&gt;expert_3_gpu7_exp3 -->
<g id="edge413" class="edge">
<title>gate_3_gpu7&#45;&gt;expert_3_gpu7_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4263.6,-1226.54C4274.76,-1216.62 4285.95,-1206.68 4296.21,-1197.56"/>
<polygon fill="black" stroke="black" points="4298.71,-1200.02 4303.86,-1190.76 4294.06,-1194.78 4298.71,-1200.02"/>
</g>
<!-- gate_3_gpu7&#45;&gt;expert_3_gpu7_exp4 -->
<g id="edge414" class="edge">
<title>gate_3_gpu7&#45;&gt;expert_3_gpu7_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.22,-1232.5C4018.86,-1218.57 3986.65,-1204.25 3958.91,-1191.92"/>
<polygon fill="black" stroke="black" points="3960.24,-1188.68 3949.68,-1187.82 3957.4,-1195.08 3960.24,-1188.68"/>
</g>
<!-- agg_3_gpu7&#45;&gt;residual2_3_gpu7 -->
<g id="edge419" class="edge">
<title>agg_3_gpu7&#45;&gt;residual2_3_gpu7</title>
<path fill="none" stroke="black" d="M4282.59,-950.74C4297.04,-940.51 4311.52,-930.25 4324.74,-920.88"/>
<polygon fill="black" stroke="black" points="4327.09,-923.5 4333.23,-914.87 4323.05,-917.79 4327.09,-923.5"/>
</g>
<!-- mha_4_gpu7 -->
<g id="node272" class="node">
<title>mha_4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4433.5,-810.74 4278.5,-810.74 4278.5,-757.74 4433.5,-757.74 4433.5,-810.74"/>
<text text-anchor="middle" x="4356" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="4356" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4356" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu7&#45;&gt;mha_4_gpu7 -->
<g id="edge421" class="edge">
<title>residual2_3_gpu7&#45;&gt;mha_4_gpu7</title>
<path fill="none" stroke="black" d="M4371.61,-846.69C4369.49,-838.36 4367.21,-829.39 4365.07,-820.94"/>
<polygon fill="black" stroke="black" points="4368.39,-819.81 4362.54,-810.98 4361.61,-821.53 4368.39,-819.81"/>
</g>
<!-- residual1_4_gpu7 -->
<g id="node273" class="node">
<title>residual1_4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4505.5,-721.74 4350.5,-721.74 4350.5,-668.74 4505.5,-668.74 4505.5,-721.74"/>
<text text-anchor="middle" x="4428" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4428" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4428" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu7&#45;&gt;residual1_4_gpu7 -->
<g id="edge423" class="edge">
<title>residual2_3_gpu7&#45;&gt;residual1_4_gpu7</title>
<path fill="none" stroke="black" d="M4419.45,-846.43C4428.99,-836.08 4437.9,-823.9 4443,-810.74 4452.79,-785.5 4448.08,-755.04 4441.44,-731.88"/>
<polygon fill="black" stroke="black" points="4444.72,-730.63 4438.41,-722.12 4438.03,-732.7 4444.72,-730.63"/>
</g>
<!-- mha_3_gpu8 -->
<g id="node209" class="node">
<title>mha_3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4167.5,-1540.74 4012.5,-1540.74 4012.5,-1487.74 4167.5,-1487.74 4167.5,-1540.74"/>
<text text-anchor="middle" x="4090" y="-1525.54" font-family="Times,serif" font-size="14.00">MHA Layer 3</text>
<text text-anchor="middle" x="4090" y="-1510.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4090" y="-1495.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual1_3_gpu8 -->
<g id="node210" class="node">
<title>residual1_3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4821.5,-1451.74 4666.5,-1451.74 4666.5,-1398.74 4821.5,-1398.74 4821.5,-1451.74"/>
<text text-anchor="middle" x="4744" y="-1436.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4744" y="-1421.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-1406.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- mha_3_gpu8&#45;&gt;residual1_3_gpu8 -->
<g id="edge437" class="edge">
<title>mha_3_gpu8&#45;&gt;residual1_3_gpu8</title>
<path fill="none" stroke="black" d="M4167.59,-1502.92C4290.06,-1486.63 4527.43,-1455.05 4656.05,-1437.94"/>
<polygon fill="black" stroke="black" points="4656.81,-1441.37 4666.26,-1436.58 4655.88,-1434.43 4656.81,-1441.37"/>
</g>
<!-- gate_3_gpu8 -->
<g id="node215" class="node">
<title>gate_3_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4883.92,-1362.74 4661.34,-1362.74 4604.08,-1226.74 4826.66,-1226.74 4883.92,-1362.74"/>
<text text-anchor="middle" x="4744" y="-1313.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4744" y="-1298.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4744" y="-1283.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-1268.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_3_gpu8&#45;&gt;gate_3_gpu8 -->
<g id="edge439" class="edge">
<title>residual1_3_gpu8&#45;&gt;gate_3_gpu8</title>
<path fill="none" stroke="black" d="M4744,-1398.55C4744,-1390.91 4744,-1382.12 4744,-1372.96"/>
<polygon fill="black" stroke="black" points="4747.5,-1372.91 4744,-1362.91 4740.5,-1372.91 4747.5,-1372.91"/>
</g>
<!-- residual2_3_gpu8 -->
<g id="node217" class="node">
<title>residual2_3_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4934.5,-914.74 4779.5,-914.74 4779.5,-846.74 4934.5,-846.74 4934.5,-914.74"/>
<text text-anchor="middle" x="4857" y="-899.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4857" y="-884.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4857" y="-869.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4857" y="-854.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_3_gpu8&#45;&gt;residual2_3_gpu8 -->
<g id="edge449" class="edge">
<title>residual1_3_gpu8&#45;&gt;residual2_3_gpu8</title>
<path fill="none" stroke="black" d="M4821.58,-1399.62C4845.61,-1390.09 4871.43,-1377.8 4893,-1362.74 4978.1,-1303.31 5013.32,-1287.46 5051,-1190.74 5090.91,-1088.29 5063.12,-1033.73 4991,-950.74 4978.06,-935.86 4961.13,-923.75 4943.68,-914.09"/>
<polygon fill="black" stroke="black" points="4945,-910.83 4934.52,-909.25 4941.73,-917.02 4945,-910.83"/>
</g>
<!-- expert_3_gpu8_exp1 -->
<g id="node211" class="node">
<title>expert_3_gpu8_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4582.5,-1190.74 4447.5,-1190.74 4447.5,-1122.74 4582.5,-1122.74 4582.5,-1190.74"/>
<text text-anchor="middle" x="4515" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4515" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4515" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4515" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_3_gpu8 -->
<g id="node216" class="node">
<title>agg_3_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="4981.89,-1086.74 4725.95,-1086.74 4660.11,-950.74 4916.05,-950.74 4981.89,-1086.74"/>
<text text-anchor="middle" x="4821" y="-1037.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4821" y="-1022.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4821" y="-1007.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-992.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_3_gpu8_exp1&#45;&gt;agg_3_gpu8 -->
<g id="edge444" class="edge">
<title>expert_3_gpu8_exp1&#45;&gt;agg_3_gpu8</title>
<path fill="none" stroke="black" d="M4582.53,-1125.73C4619.02,-1109.51 4665.05,-1089.05 4706.91,-1070.45"/>
<polygon fill="black" stroke="black" points="4708.34,-1073.64 4716.06,-1066.38 4705.5,-1067.25 4708.34,-1073.64"/>
</g>
<!-- expert_3_gpu8_exp2 -->
<g id="node212" class="node">
<title>expert_3_gpu8_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4735.5,-1190.74 4600.5,-1190.74 4600.5,-1122.74 4735.5,-1122.74 4735.5,-1190.74"/>
<text text-anchor="middle" x="4668" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4668" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4668" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4668" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu8_exp2&#45;&gt;agg_3_gpu8 -->
<g id="edge445" class="edge">
<title>expert_3_gpu8_exp2&#45;&gt;agg_3_gpu8</title>
<path fill="none" stroke="black" d="M4705.43,-1122.47C4715.28,-1113.72 4726.3,-1103.91 4737.53,-1093.93"/>
<polygon fill="black" stroke="black" points="4740.18,-1096.26 4745.33,-1087 4735.53,-1091.03 4740.18,-1096.26"/>
</g>
<!-- expert_3_gpu8_exp3 -->
<g id="node213" class="node">
<title>expert_3_gpu8_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4888.5,-1190.74 4753.5,-1190.74 4753.5,-1122.74 4888.5,-1122.74 4888.5,-1190.74"/>
<text text-anchor="middle" x="4821" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4821" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4821" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu8_exp3&#45;&gt;agg_3_gpu8 -->
<g id="edge446" class="edge">
<title>expert_3_gpu8_exp3&#45;&gt;agg_3_gpu8</title>
<path fill="none" stroke="black" d="M4821,-1122.47C4821,-1114.64 4821,-1105.98 4821,-1097.09"/>
<polygon fill="black" stroke="black" points="4824.5,-1097 4821,-1087 4817.5,-1097 4824.5,-1097"/>
</g>
<!-- expert_3_gpu8_exp4 -->
<g id="node214" class="node">
<title>expert_3_gpu8_exp4</title>
<polygon fill="lightgreen" stroke="black" points="5041.5,-1190.74 4906.5,-1190.74 4906.5,-1122.74 5041.5,-1122.74 5041.5,-1190.74"/>
<text text-anchor="middle" x="4974" y="-1175.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4974" y="-1160.54" font-family="Times,serif" font-size="14.00">Layer 3</text>
<text text-anchor="middle" x="4974" y="-1145.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4974" y="-1130.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_3_gpu8_exp4&#45;&gt;agg_3_gpu8 -->
<g id="edge447" class="edge">
<title>expert_3_gpu8_exp4&#45;&gt;agg_3_gpu8</title>
<path fill="none" stroke="black" d="M4936.57,-1122.47C4926.72,-1113.72 4915.7,-1103.91 4904.47,-1093.93"/>
<polygon fill="black" stroke="black" points="4906.47,-1091.03 4896.67,-1087 4901.82,-1096.26 4906.47,-1091.03"/>
</g>
<!-- gate_3_gpu8&#45;&gt;expert_3_gpu8_exp1 -->
<g id="edge440" class="edge">
<title>gate_3_gpu8&#45;&gt;expert_3_gpu8_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4631.18,-1226.74C4613.46,-1216.21 4595.69,-1205.66 4579.56,-1196.08"/>
<polygon fill="black" stroke="black" points="4581.17,-1192.96 4570.78,-1190.87 4577.59,-1198.98 4581.17,-1192.96"/>
</g>
<!-- gate_3_gpu8&#45;&gt;expert_3_gpu8_exp2 -->
<g id="edge441" class="edge">
<title>gate_3_gpu8&#45;&gt;expert_3_gpu8_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4706.45,-1226.54C4701.34,-1217.4 4696.22,-1208.24 4691.46,-1199.72"/>
<polygon fill="black" stroke="black" points="4694.38,-1197.78 4686.45,-1190.76 4688.27,-1201.19 4694.38,-1197.78"/>
</g>
<!-- gate_3_gpu8&#45;&gt;expert_3_gpu8_exp3 -->
<g id="edge442" class="edge">
<title>gate_3_gpu8&#45;&gt;expert_3_gpu8_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4782.05,-1226.54C4787.22,-1217.4 4792.41,-1208.24 4797.23,-1199.72"/>
<polygon fill="black" stroke="black" points="4800.43,-1201.18 4802.31,-1190.76 4794.33,-1197.73 4800.43,-1201.18"/>
</g>
<!-- gate_3_gpu8&#45;&gt;expert_3_gpu8_exp4 -->
<g id="edge443" class="edge">
<title>gate_3_gpu8&#45;&gt;expert_3_gpu8_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4832.92,-1241.16C4858.26,-1226.18 4885.37,-1210.15 4908.99,-1196.18"/>
<polygon fill="black" stroke="black" points="4911.04,-1199.04 4917.86,-1190.93 4907.47,-1193.01 4911.04,-1199.04"/>
</g>
<!-- agg_3_gpu8&#45;&gt;residual2_3_gpu8 -->
<g id="edge448" class="edge">
<title>agg_3_gpu8&#45;&gt;residual2_3_gpu8</title>
<path fill="none" stroke="black" d="M4838.79,-950.54C4841.13,-941.69 4843.48,-932.82 4845.67,-924.53"/>
<polygon fill="black" stroke="black" points="4849.08,-925.32 4848.26,-914.76 4842.32,-923.53 4849.08,-925.32"/>
</g>
<!-- mha_4_gpu8 -->
<g id="node281" class="node">
<title>mha_4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4873.5,-810.74 4718.5,-810.74 4718.5,-757.74 4873.5,-757.74 4873.5,-810.74"/>
<text text-anchor="middle" x="4796" y="-795.54" font-family="Times,serif" font-size="14.00">MHA Layer 4</text>
<text text-anchor="middle" x="4796" y="-780.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4796" y="-765.54" font-family="Times,serif" font-size="14.00">(B=1024, H=1024)</text>
</g>
<!-- residual2_3_gpu8&#45;&gt;mha_4_gpu8 -->
<g id="edge450" class="edge">
<title>residual2_3_gpu8&#45;&gt;mha_4_gpu8</title>
<path fill="none" stroke="black" d="M4835.67,-846.69C4830,-837.91 4823.86,-828.4 4818.15,-819.56"/>
<polygon fill="black" stroke="black" points="4820.98,-817.48 4812.61,-810.98 4815.1,-821.28 4820.98,-817.48"/>
</g>
<!-- residual1_4_gpu8 -->
<g id="node282" class="node">
<title>residual1_4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4922.5,-721.74 4767.5,-721.74 4767.5,-668.74 4922.5,-668.74 4922.5,-721.74"/>
<text text-anchor="middle" x="4845" y="-706.54" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="4845" y="-691.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4845" y="-676.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_3_gpu8&#45;&gt;residual1_4_gpu8 -->
<g id="edge452" class="edge">
<title>residual2_3_gpu8&#45;&gt;residual1_4_gpu8</title>
<path fill="none" stroke="black" d="M4872.77,-846.57C4882.42,-821.86 4891.43,-787.43 4883,-757.74 4880.33,-748.33 4875.76,-738.95 4870.7,-730.46"/>
<polygon fill="black" stroke="black" points="4873.62,-728.53 4865.31,-721.96 4867.71,-732.28 4873.62,-728.53"/>
</g>
<!-- mha_4_gpu1&#45;&gt;residual1_4_gpu1 -->
<g id="edge248" class="edge">
<title>mha_4_gpu1&#45;&gt;residual1_4_gpu1</title>
<path fill="none" stroke="black" d="M476.14,-757.61C480.74,-749.27 485.92,-739.88 490.82,-731"/>
<polygon fill="black" stroke="black" points="494.03,-732.44 495.79,-721.99 487.9,-729.05 494.03,-732.44"/>
</g>
<!-- gate_4_gpu1 -->
<g id="node224" class="node">
<title>gate_4_gpu1</title>
<polygon fill="lightcoral" stroke="black" points="529.92,-632.74 307.34,-632.74 250.08,-496.74 472.66,-496.74 529.92,-632.74"/>
<text text-anchor="middle" x="390" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="390" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="390" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu1&#45;&gt;gate_4_gpu1 -->
<g id="edge250" class="edge">
<title>residual1_4_gpu1&#45;&gt;gate_4_gpu1</title>
<path fill="none" stroke="black" d="M486,-668.55C478.19,-660.18 469.08,-650.42 459.65,-640.32"/>
<polygon fill="black" stroke="black" points="462.11,-637.83 452.73,-632.91 457,-642.61 462.11,-637.83"/>
</g>
<!-- residual2_4_gpu1 -->
<g id="node226" class="node">
<title>residual2_4_gpu1</title>
<polygon fill="lightgreen" stroke="black" points="707.5,-184.74 552.5,-184.74 552.5,-116.74 707.5,-116.74 707.5,-184.74"/>
<text text-anchor="middle" x="630" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="630" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="630" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="630" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu1&#45;&gt;residual2_4_gpu1 -->
<g id="edge260" class="edge">
<title>residual1_4_gpu1&#45;&gt;residual2_4_gpu1</title>
<path fill="none" stroke="black" d="M526.25,-668.55C551.63,-626.86 599.74,-541 619,-460.74 641.21,-368.17 637.93,-255.56 633.81,-195.1"/>
<polygon fill="black" stroke="black" points="637.28,-194.51 633.07,-184.79 630.3,-195.02 637.28,-194.51"/>
</g>
<!-- expert_4_gpu1_exp1 -->
<g id="node220" class="node">
<title>expert_4_gpu1_exp1</title>
<polygon fill="lightgreen" stroke="black" points="610.5,-460.74 475.5,-460.74 475.5,-392.74 610.5,-392.74 610.5,-460.74"/>
<text text-anchor="middle" x="543" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="543" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="543" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="543" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu1 -->
<g id="node225" class="node">
<title>agg_4_gpu1</title>
<polygon fill="lightyellow" stroke="black" points="550.89,-356.74 294.95,-356.74 229.11,-220.74 485.05,-220.74 550.89,-356.74"/>
<text text-anchor="middle" x="390" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="390" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="390" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu1_exp1&#45;&gt;agg_4_gpu1 -->
<g id="edge255" class="edge">
<title>expert_4_gpu1_exp1&#45;&gt;agg_4_gpu1</title>
<path fill="none" stroke="black" d="M505.57,-392.47C495.72,-383.72 484.7,-373.91 473.47,-363.93"/>
<polygon fill="black" stroke="black" points="475.47,-361.03 465.67,-357 470.82,-366.26 475.47,-361.03"/>
</g>
<!-- expert_4_gpu1_exp2 -->
<g id="node221" class="node">
<title>expert_4_gpu1_exp2</title>
<polygon fill="lightgreen" stroke="black" points="151.5,-460.74 16.5,-460.74 16.5,-392.74 151.5,-392.74 151.5,-460.74"/>
<text text-anchor="middle" x="84" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="84" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="84" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="84" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu1_exp2&#45;&gt;agg_4_gpu1 -->
<g id="edge256" class="edge">
<title>expert_4_gpu1_exp2&#45;&gt;agg_4_gpu1</title>
<path fill="none" stroke="black" d="M151.53,-395.73C188.02,-379.51 234.05,-359.05 275.91,-340.45"/>
<polygon fill="black" stroke="black" points="277.34,-343.64 285.06,-336.38 274.5,-337.25 277.34,-343.64"/>
</g>
<!-- expert_4_gpu1_exp3 -->
<g id="node222" class="node">
<title>expert_4_gpu1_exp3</title>
<polygon fill="lightgreen" stroke="black" points="304.5,-460.74 169.5,-460.74 169.5,-392.74 304.5,-392.74 304.5,-460.74"/>
<text text-anchor="middle" x="237" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="237" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="237" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="237" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu1_exp3&#45;&gt;agg_4_gpu1 -->
<g id="edge257" class="edge">
<title>expert_4_gpu1_exp3&#45;&gt;agg_4_gpu1</title>
<path fill="none" stroke="black" d="M274.43,-392.47C284.28,-383.72 295.3,-373.91 306.53,-363.93"/>
<polygon fill="black" stroke="black" points="309.18,-366.26 314.33,-357 304.53,-361.03 309.18,-366.26"/>
</g>
<!-- expert_4_gpu1_exp4 -->
<g id="node223" class="node">
<title>expert_4_gpu1_exp4</title>
<polygon fill="lightgreen" stroke="black" points="457.5,-460.74 322.5,-460.74 322.5,-392.74 457.5,-392.74 457.5,-460.74"/>
<text text-anchor="middle" x="390" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="390" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="390" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 1</text>
<text text-anchor="middle" x="390" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu1_exp4&#45;&gt;agg_4_gpu1 -->
<g id="edge258" class="edge">
<title>expert_4_gpu1_exp4&#45;&gt;agg_4_gpu1</title>
<path fill="none" stroke="black" d="M390,-392.47C390,-384.64 390,-375.98 390,-367.09"/>
<polygon fill="black" stroke="black" points="393.5,-367 390,-357 386.5,-367 393.5,-367"/>
</g>
<!-- gate_4_gpu1&#45;&gt;expert_4_gpu1_exp1 -->
<g id="edge251" class="edge">
<title>gate_4_gpu1&#45;&gt;expert_4_gpu1_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M465.6,-496.54C476.76,-486.62 487.95,-476.68 498.21,-467.56"/>
<polygon fill="black" stroke="black" points="500.71,-470.02 505.86,-460.76 496.06,-464.78 500.71,-470.02"/>
</g>
<!-- gate_4_gpu1&#45;&gt;expert_4_gpu1_exp2 -->
<g id="edge252" class="edge">
<title>gate_4_gpu1&#45;&gt;expert_4_gpu1_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M252.22,-502.5C220.86,-488.57 188.65,-474.25 160.91,-461.92"/>
<polygon fill="black" stroke="black" points="162.24,-458.68 151.68,-457.82 159.4,-465.08 162.24,-458.68"/>
</g>
<!-- gate_4_gpu1&#45;&gt;expert_4_gpu1_exp3 -->
<g id="edge253" class="edge">
<title>gate_4_gpu1&#45;&gt;expert_4_gpu1_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M314.4,-496.54C303.24,-486.62 292.05,-476.68 281.79,-467.56"/>
<polygon fill="black" stroke="black" points="283.94,-464.78 274.14,-460.76 279.29,-470.02 283.94,-464.78"/>
</g>
<!-- gate_4_gpu1&#45;&gt;expert_4_gpu1_exp4 -->
<g id="edge254" class="edge">
<title>gate_4_gpu1&#45;&gt;expert_4_gpu1_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M390,-496.54C390,-487.78 390,-479.02 390,-470.81"/>
<polygon fill="black" stroke="black" points="393.5,-470.76 390,-460.76 386.5,-470.76 393.5,-470.76"/>
</g>
<!-- agg_4_gpu1&#45;&gt;residual2_4_gpu1 -->
<g id="edge259" class="edge">
<title>agg_4_gpu1&#45;&gt;residual2_4_gpu1</title>
<path fill="none" stroke="black" d="M490.04,-231.05C514.57,-217.15 540.24,-202.6 562.8,-189.82"/>
<polygon fill="black" stroke="black" points="564.64,-192.8 571.61,-184.83 561.18,-186.71 564.64,-192.8"/>
</g>
<!-- output_tokens -->
<g id="node298" class="node">
<title>output_tokens</title>
<ellipse fill="lightblue" stroke="black" cx="2725" cy="-42.87" rx="109.7" ry="26.74"/>
<text text-anchor="middle" x="2725" y="-46.67" font-family="Times,serif" font-size="14.00">Output Tokens</text>
<text text-anchor="middle" x="2725" y="-31.67" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual2_4_gpu1&#45;&gt;output_tokens -->
<g id="edge261" class="edge">
<title>residual2_4_gpu1&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M707.7,-143.09C813.54,-134.22 1008.98,-118.51 1176,-108.74 1709.3,-77.56 2346.74,-55.73 2606.29,-47.5"/>
<polygon fill="black" stroke="black" points="2606.6,-50.99 2616.49,-47.18 2606.38,-44 2606.6,-50.99"/>
</g>
<!-- mha_4_gpu2&#45;&gt;residual1_4_gpu2 -->
<g id="edge277" class="edge">
<title>mha_4_gpu2&#45;&gt;residual1_4_gpu2</title>
<path fill="none" stroke="black" d="M1045.61,-757.61C1049.02,-749.36 1052.86,-740.08 1056.5,-731.28"/>
<polygon fill="black" stroke="black" points="1059.76,-732.57 1060.34,-721.99 1053.29,-729.89 1059.76,-732.57"/>
</g>
<!-- gate_4_gpu2 -->
<g id="node233" class="node">
<title>gate_4_gpu2</title>
<polygon fill="lightcoral" stroke="black" points="1162.92,-632.74 940.34,-632.74 883.08,-496.74 1105.66,-496.74 1162.92,-632.74"/>
<text text-anchor="middle" x="1023" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1023" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1023" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu2&#45;&gt;gate_4_gpu2 -->
<g id="edge279" class="edge">
<title>residual1_4_gpu2&#45;&gt;gate_4_gpu2</title>
<path fill="none" stroke="black" d="M1061.4,-668.55C1058.49,-660.74 1055.13,-651.74 1051.63,-642.37"/>
<polygon fill="black" stroke="black" points="1054.87,-641.06 1048.09,-632.91 1048.31,-643.51 1054.87,-641.06"/>
</g>
<!-- residual2_4_gpu2 -->
<g id="node235" class="node">
<title>residual2_4_gpu2</title>
<polygon fill="lightgreen" stroke="black" points="1340.5,-184.74 1185.5,-184.74 1185.5,-116.74 1340.5,-116.74 1340.5,-184.74"/>
<text text-anchor="middle" x="1263" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1263" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1263" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1263" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu2&#45;&gt;residual2_4_gpu2 -->
<g id="edge289" class="edge">
<title>residual1_4_gpu2&#45;&gt;residual2_4_gpu2</title>
<path fill="none" stroke="black" d="M1125.96,-668.66C1142.28,-659.11 1159.2,-647.05 1172,-632.74 1228.2,-569.89 1232.33,-542.72 1252,-460.74 1274.21,-368.17 1270.93,-255.56 1266.81,-195.1"/>
<polygon fill="black" stroke="black" points="1270.28,-194.51 1266.07,-184.79 1263.3,-195.02 1270.28,-194.51"/>
</g>
<!-- expert_4_gpu2_exp1 -->
<g id="node229" class="node">
<title>expert_4_gpu2_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1090.5,-460.74 955.5,-460.74 955.5,-392.74 1090.5,-392.74 1090.5,-460.74"/>
<text text-anchor="middle" x="1023" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1023" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1023" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu2 -->
<g id="node234" class="node">
<title>agg_4_gpu2</title>
<polygon fill="lightyellow" stroke="black" points="1183.89,-356.74 927.95,-356.74 862.11,-220.74 1118.05,-220.74 1183.89,-356.74"/>
<text text-anchor="middle" x="1023" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1023" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1023" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1023" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu2_exp1&#45;&gt;agg_4_gpu2 -->
<g id="edge284" class="edge">
<title>expert_4_gpu2_exp1&#45;&gt;agg_4_gpu2</title>
<path fill="none" stroke="black" d="M1023,-392.47C1023,-384.64 1023,-375.98 1023,-367.09"/>
<polygon fill="black" stroke="black" points="1026.5,-367 1023,-357 1019.5,-367 1026.5,-367"/>
</g>
<!-- expert_4_gpu2_exp2 -->
<g id="node230" class="node">
<title>expert_4_gpu2_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1243.5,-460.74 1108.5,-460.74 1108.5,-392.74 1243.5,-392.74 1243.5,-460.74"/>
<text text-anchor="middle" x="1176" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1176" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1176" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="1176" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu2_exp2&#45;&gt;agg_4_gpu2 -->
<g id="edge285" class="edge">
<title>expert_4_gpu2_exp2&#45;&gt;agg_4_gpu2</title>
<path fill="none" stroke="black" d="M1138.57,-392.47C1128.72,-383.72 1117.7,-373.91 1106.47,-363.93"/>
<polygon fill="black" stroke="black" points="1108.47,-361.03 1098.67,-357 1103.82,-366.26 1108.47,-361.03"/>
</g>
<!-- expert_4_gpu2_exp3 -->
<g id="node231" class="node">
<title>expert_4_gpu2_exp3</title>
<polygon fill="lightgreen" stroke="black" points="784.5,-460.74 649.5,-460.74 649.5,-392.74 784.5,-392.74 784.5,-460.74"/>
<text text-anchor="middle" x="717" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="717" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="717" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="717" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu2_exp3&#45;&gt;agg_4_gpu2 -->
<g id="edge286" class="edge">
<title>expert_4_gpu2_exp3&#45;&gt;agg_4_gpu2</title>
<path fill="none" stroke="black" d="M784.53,-395.73C821.02,-379.51 867.05,-359.05 908.91,-340.45"/>
<polygon fill="black" stroke="black" points="910.34,-343.64 918.06,-336.38 907.5,-337.25 910.34,-343.64"/>
</g>
<!-- expert_4_gpu2_exp4 -->
<g id="node232" class="node">
<title>expert_4_gpu2_exp4</title>
<polygon fill="lightgreen" stroke="black" points="937.5,-460.74 802.5,-460.74 802.5,-392.74 937.5,-392.74 937.5,-460.74"/>
<text text-anchor="middle" x="870" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="870" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="870" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 2</text>
<text text-anchor="middle" x="870" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu2_exp4&#45;&gt;agg_4_gpu2 -->
<g id="edge287" class="edge">
<title>expert_4_gpu2_exp4&#45;&gt;agg_4_gpu2</title>
<path fill="none" stroke="black" d="M907.43,-392.47C917.28,-383.72 928.3,-373.91 939.53,-363.93"/>
<polygon fill="black" stroke="black" points="942.18,-366.26 947.33,-357 937.53,-361.03 942.18,-366.26"/>
</g>
<!-- gate_4_gpu2&#45;&gt;expert_4_gpu2_exp1 -->
<g id="edge280" class="edge">
<title>gate_4_gpu2&#45;&gt;expert_4_gpu2_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1023,-496.54C1023,-487.78 1023,-479.02 1023,-470.81"/>
<polygon fill="black" stroke="black" points="1026.5,-470.76 1023,-460.76 1019.5,-470.76 1026.5,-470.76"/>
</g>
<!-- gate_4_gpu2&#45;&gt;expert_4_gpu2_exp2 -->
<g id="edge281" class="edge">
<title>gate_4_gpu2&#45;&gt;expert_4_gpu2_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1098.6,-496.54C1109.76,-486.62 1120.95,-476.68 1131.21,-467.56"/>
<polygon fill="black" stroke="black" points="1133.71,-470.02 1138.86,-460.76 1129.06,-464.78 1133.71,-470.02"/>
</g>
<!-- gate_4_gpu2&#45;&gt;expert_4_gpu2_exp3 -->
<g id="edge282" class="edge">
<title>gate_4_gpu2&#45;&gt;expert_4_gpu2_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M885.22,-502.5C853.86,-488.57 821.65,-474.25 793.91,-461.92"/>
<polygon fill="black" stroke="black" points="795.24,-458.68 784.68,-457.82 792.4,-465.08 795.24,-458.68"/>
</g>
<!-- gate_4_gpu2&#45;&gt;expert_4_gpu2_exp4 -->
<g id="edge283" class="edge">
<title>gate_4_gpu2&#45;&gt;expert_4_gpu2_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M947.4,-496.54C936.24,-486.62 925.05,-476.68 914.79,-467.56"/>
<polygon fill="black" stroke="black" points="916.94,-464.78 907.14,-460.76 912.29,-470.02 916.94,-464.78"/>
</g>
<!-- agg_4_gpu2&#45;&gt;residual2_4_gpu2 -->
<g id="edge288" class="edge">
<title>agg_4_gpu2&#45;&gt;residual2_4_gpu2</title>
<path fill="none" stroke="black" d="M1123.04,-231.05C1147.57,-217.15 1173.24,-202.6 1195.8,-189.82"/>
<polygon fill="black" stroke="black" points="1197.64,-192.8 1204.61,-184.83 1194.18,-186.71 1197.64,-192.8"/>
</g>
<!-- residual2_4_gpu2&#45;&gt;output_tokens -->
<g id="edge290" class="edge">
<title>residual2_4_gpu2&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M1340.89,-143.8C1446.98,-135.74 1642.84,-120.93 1810,-108.74 2098.1,-87.73 2437.3,-63.93 2610.55,-51.84"/>
<polygon fill="black" stroke="black" points="2610.97,-55.31 2620.7,-51.13 2610.48,-48.33 2610.97,-55.31"/>
</g>
<!-- mha_4_gpu3&#45;&gt;residual1_4_gpu3 -->
<g id="edge306" class="edge">
<title>mha_4_gpu3&#45;&gt;residual1_4_gpu3</title>
<path fill="none" stroke="black" d="M1754.14,-757.61C1758.74,-749.27 1763.92,-739.88 1768.82,-731"/>
<polygon fill="black" stroke="black" points="1772.03,-732.44 1773.79,-721.99 1765.9,-729.05 1772.03,-732.44"/>
</g>
<!-- gate_4_gpu3 -->
<g id="node242" class="node">
<title>gate_4_gpu3</title>
<polygon fill="lightcoral" stroke="black" points="1795.92,-632.74 1573.34,-632.74 1516.08,-496.74 1738.66,-496.74 1795.92,-632.74"/>
<text text-anchor="middle" x="1656" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="1656" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1656" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu3&#45;&gt;gate_4_gpu3 -->
<g id="edge308" class="edge">
<title>residual1_4_gpu3&#45;&gt;gate_4_gpu3</title>
<path fill="none" stroke="black" d="M1761.61,-668.55C1752.92,-660.09 1742.79,-650.23 1732.31,-640.02"/>
<polygon fill="black" stroke="black" points="1734.61,-637.38 1725,-632.91 1729.73,-642.4 1734.61,-637.38"/>
</g>
<!-- residual2_4_gpu3 -->
<g id="node244" class="node">
<title>residual2_4_gpu3</title>
<polygon fill="lightgreen" stroke="black" points="1973.5,-184.74 1818.5,-184.74 1818.5,-116.74 1973.5,-116.74 1973.5,-184.74"/>
<text text-anchor="middle" x="1896" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="1896" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1896" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1896" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu3&#45;&gt;residual2_4_gpu3 -->
<g id="edge318" class="edge">
<title>residual1_4_gpu3&#45;&gt;residual2_4_gpu3</title>
<path fill="none" stroke="black" d="M1802.43,-668.66C1825.2,-626.76 1868.66,-540.2 1886,-460.74 1906.24,-367.98 1903.29,-255.89 1899.53,-195.46"/>
<polygon fill="black" stroke="black" points="1903,-194.9 1898.84,-185.15 1896.01,-195.36 1903,-194.9"/>
</g>
<!-- expert_4_gpu3_exp1 -->
<g id="node238" class="node">
<title>expert_4_gpu3_exp1</title>
<polygon fill="lightgreen" stroke="black" points="1570.5,-460.74 1435.5,-460.74 1435.5,-392.74 1570.5,-392.74 1570.5,-460.74"/>
<text text-anchor="middle" x="1503" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1503" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1503" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1503" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu3 -->
<g id="node243" class="node">
<title>agg_4_gpu3</title>
<polygon fill="lightyellow" stroke="black" points="1816.89,-356.74 1560.95,-356.74 1495.11,-220.74 1751.05,-220.74 1816.89,-356.74"/>
<text text-anchor="middle" x="1656" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="1656" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1656" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu3_exp1&#45;&gt;agg_4_gpu3 -->
<g id="edge313" class="edge">
<title>expert_4_gpu3_exp1&#45;&gt;agg_4_gpu3</title>
<path fill="none" stroke="black" d="M1540.43,-392.47C1550.28,-383.72 1561.3,-373.91 1572.53,-363.93"/>
<polygon fill="black" stroke="black" points="1575.18,-366.26 1580.33,-357 1570.53,-361.03 1575.18,-366.26"/>
</g>
<!-- expert_4_gpu3_exp2 -->
<g id="node239" class="node">
<title>expert_4_gpu3_exp2</title>
<polygon fill="lightgreen" stroke="black" points="1723.5,-460.74 1588.5,-460.74 1588.5,-392.74 1723.5,-392.74 1723.5,-460.74"/>
<text text-anchor="middle" x="1656" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="1656" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1656" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1656" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu3_exp2&#45;&gt;agg_4_gpu3 -->
<g id="edge314" class="edge">
<title>expert_4_gpu3_exp2&#45;&gt;agg_4_gpu3</title>
<path fill="none" stroke="black" d="M1656,-392.47C1656,-384.64 1656,-375.98 1656,-367.09"/>
<polygon fill="black" stroke="black" points="1659.5,-367 1656,-357 1652.5,-367 1659.5,-367"/>
</g>
<!-- expert_4_gpu3_exp3 -->
<g id="node240" class="node">
<title>expert_4_gpu3_exp3</title>
<polygon fill="lightgreen" stroke="black" points="1876.5,-460.74 1741.5,-460.74 1741.5,-392.74 1876.5,-392.74 1876.5,-460.74"/>
<text text-anchor="middle" x="1809" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="1809" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1809" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1809" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu3_exp3&#45;&gt;agg_4_gpu3 -->
<g id="edge315" class="edge">
<title>expert_4_gpu3_exp3&#45;&gt;agg_4_gpu3</title>
<path fill="none" stroke="black" d="M1771.57,-392.47C1761.72,-383.72 1750.7,-373.91 1739.47,-363.93"/>
<polygon fill="black" stroke="black" points="1741.47,-361.03 1731.67,-357 1736.82,-366.26 1741.47,-361.03"/>
</g>
<!-- expert_4_gpu3_exp4 -->
<g id="node241" class="node">
<title>expert_4_gpu3_exp4</title>
<polygon fill="lightgreen" stroke="black" points="1417.5,-460.74 1282.5,-460.74 1282.5,-392.74 1417.5,-392.74 1417.5,-460.74"/>
<text text-anchor="middle" x="1350" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="1350" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1350" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 3</text>
<text text-anchor="middle" x="1350" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu3_exp4&#45;&gt;agg_4_gpu3 -->
<g id="edge316" class="edge">
<title>expert_4_gpu3_exp4&#45;&gt;agg_4_gpu3</title>
<path fill="none" stroke="black" d="M1417.53,-395.73C1454.02,-379.51 1500.05,-359.05 1541.91,-340.45"/>
<polygon fill="black" stroke="black" points="1543.34,-343.64 1551.06,-336.38 1540.5,-337.25 1543.34,-343.64"/>
</g>
<!-- gate_4_gpu3&#45;&gt;expert_4_gpu3_exp1 -->
<g id="edge309" class="edge">
<title>gate_4_gpu3&#45;&gt;expert_4_gpu3_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1580.4,-496.54C1569.24,-486.62 1558.05,-476.68 1547.79,-467.56"/>
<polygon fill="black" stroke="black" points="1549.94,-464.78 1540.14,-460.76 1545.29,-470.02 1549.94,-464.78"/>
</g>
<!-- gate_4_gpu3&#45;&gt;expert_4_gpu3_exp2 -->
<g id="edge310" class="edge">
<title>gate_4_gpu3&#45;&gt;expert_4_gpu3_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1656,-496.54C1656,-487.78 1656,-479.02 1656,-470.81"/>
<polygon fill="black" stroke="black" points="1659.5,-470.76 1656,-460.76 1652.5,-470.76 1659.5,-470.76"/>
</g>
<!-- gate_4_gpu3&#45;&gt;expert_4_gpu3_exp3 -->
<g id="edge311" class="edge">
<title>gate_4_gpu3&#45;&gt;expert_4_gpu3_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1731.6,-496.54C1742.76,-486.62 1753.95,-476.68 1764.21,-467.56"/>
<polygon fill="black" stroke="black" points="1766.71,-470.02 1771.86,-460.76 1762.06,-464.78 1766.71,-470.02"/>
</g>
<!-- gate_4_gpu3&#45;&gt;expert_4_gpu3_exp4 -->
<g id="edge312" class="edge">
<title>gate_4_gpu3&#45;&gt;expert_4_gpu3_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M1518.22,-502.5C1486.86,-488.57 1454.65,-474.25 1426.91,-461.92"/>
<polygon fill="black" stroke="black" points="1428.24,-458.68 1417.68,-457.82 1425.4,-465.08 1428.24,-458.68"/>
</g>
<!-- agg_4_gpu3&#45;&gt;residual2_4_gpu3 -->
<g id="edge317" class="edge">
<title>agg_4_gpu3&#45;&gt;residual2_4_gpu3</title>
<path fill="none" stroke="black" d="M1756.04,-231.05C1780.57,-217.15 1806.24,-202.6 1828.8,-189.82"/>
<polygon fill="black" stroke="black" points="1830.64,-192.8 1837.61,-184.83 1827.18,-186.71 1830.64,-192.8"/>
</g>
<!-- residual2_4_gpu3&#45;&gt;output_tokens -->
<g id="edge319" class="edge">
<title>residual2_4_gpu3&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M1973.62,-139.83C2122.92,-120.76 2450.25,-78.96 2619.3,-57.37"/>
<polygon fill="black" stroke="black" points="2619.98,-60.81 2629.46,-56.07 2619.1,-53.87 2619.98,-60.81"/>
</g>
<!-- mha_4_gpu4&#45;&gt;residual1_4_gpu4 -->
<g id="edge335" class="edge">
<title>mha_4_gpu4&#45;&gt;residual1_4_gpu4</title>
<path fill="none" stroke="black" d="M2375.14,-757.61C2379.74,-749.27 2384.92,-739.88 2389.82,-731"/>
<polygon fill="black" stroke="black" points="2393.03,-732.44 2394.79,-721.99 2386.9,-729.05 2393.03,-732.44"/>
</g>
<!-- gate_4_gpu4 -->
<g id="node251" class="node">
<title>gate_4_gpu4</title>
<polygon fill="lightcoral" stroke="black" points="2428.92,-632.74 2206.34,-632.74 2149.08,-496.74 2371.66,-496.74 2428.92,-632.74"/>
<text text-anchor="middle" x="2289" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2289" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2289" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu4&#45;&gt;gate_4_gpu4 -->
<g id="edge337" class="edge">
<title>residual1_4_gpu4&#45;&gt;gate_4_gpu4</title>
<path fill="none" stroke="black" d="M2385,-668.55C2377.19,-660.18 2368.08,-650.42 2358.65,-640.32"/>
<polygon fill="black" stroke="black" points="2361.11,-637.83 2351.73,-632.91 2356,-642.61 2361.11,-637.83"/>
</g>
<!-- residual2_4_gpu4 -->
<g id="node253" class="node">
<title>residual2_4_gpu4</title>
<polygon fill="lightgreen" stroke="black" points="2606.5,-184.74 2451.5,-184.74 2451.5,-116.74 2606.5,-116.74 2606.5,-184.74"/>
<text text-anchor="middle" x="2529" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2529" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2529" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2529" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu4&#45;&gt;residual2_4_gpu4 -->
<g id="edge347" class="edge">
<title>residual1_4_gpu4&#45;&gt;residual2_4_gpu4</title>
<path fill="none" stroke="black" d="M2425.42,-668.58C2451.06,-626.92 2499.65,-541.12 2519,-460.74 2541.28,-368.19 2537.49,-255.57 2533.06,-195.11"/>
<polygon fill="black" stroke="black" points="2536.52,-194.5 2532.26,-184.8 2529.54,-195.04 2536.52,-194.5"/>
</g>
<!-- expert_4_gpu4_exp1 -->
<g id="node247" class="node">
<title>expert_4_gpu4_exp1</title>
<polygon fill="lightgreen" stroke="black" points="2050.5,-460.74 1915.5,-460.74 1915.5,-392.74 2050.5,-392.74 2050.5,-460.74"/>
<text text-anchor="middle" x="1983" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="1983" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="1983" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="1983" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu4 -->
<g id="node252" class="node">
<title>agg_4_gpu4</title>
<polygon fill="lightyellow" stroke="black" points="2449.89,-356.74 2193.95,-356.74 2128.11,-220.74 2384.05,-220.74 2449.89,-356.74"/>
<text text-anchor="middle" x="2289" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2289" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2289" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu4_exp1&#45;&gt;agg_4_gpu4 -->
<g id="edge342" class="edge">
<title>expert_4_gpu4_exp1&#45;&gt;agg_4_gpu4</title>
<path fill="none" stroke="black" d="M2050.53,-395.73C2087.02,-379.51 2133.05,-359.05 2174.91,-340.45"/>
<polygon fill="black" stroke="black" points="2176.34,-343.64 2184.06,-336.38 2173.5,-337.25 2176.34,-343.64"/>
</g>
<!-- expert_4_gpu4_exp2 -->
<g id="node248" class="node">
<title>expert_4_gpu4_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2203.5,-460.74 2068.5,-460.74 2068.5,-392.74 2203.5,-392.74 2203.5,-460.74"/>
<text text-anchor="middle" x="2136" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2136" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2136" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2136" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu4_exp2&#45;&gt;agg_4_gpu4 -->
<g id="edge343" class="edge">
<title>expert_4_gpu4_exp2&#45;&gt;agg_4_gpu4</title>
<path fill="none" stroke="black" d="M2173.43,-392.47C2183.28,-383.72 2194.3,-373.91 2205.53,-363.93"/>
<polygon fill="black" stroke="black" points="2208.18,-366.26 2213.33,-357 2203.53,-361.03 2208.18,-366.26"/>
</g>
<!-- expert_4_gpu4_exp3 -->
<g id="node249" class="node">
<title>expert_4_gpu4_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2356.5,-460.74 2221.5,-460.74 2221.5,-392.74 2356.5,-392.74 2356.5,-460.74"/>
<text text-anchor="middle" x="2289" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2289" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2289" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2289" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu4_exp3&#45;&gt;agg_4_gpu4 -->
<g id="edge344" class="edge">
<title>expert_4_gpu4_exp3&#45;&gt;agg_4_gpu4</title>
<path fill="none" stroke="black" d="M2289,-392.47C2289,-384.64 2289,-375.98 2289,-367.09"/>
<polygon fill="black" stroke="black" points="2292.5,-367 2289,-357 2285.5,-367 2292.5,-367"/>
</g>
<!-- expert_4_gpu4_exp4 -->
<g id="node250" class="node">
<title>expert_4_gpu4_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2509.5,-460.74 2374.5,-460.74 2374.5,-392.74 2509.5,-392.74 2509.5,-460.74"/>
<text text-anchor="middle" x="2442" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2442" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2442" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 4</text>
<text text-anchor="middle" x="2442" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu4_exp4&#45;&gt;agg_4_gpu4 -->
<g id="edge345" class="edge">
<title>expert_4_gpu4_exp4&#45;&gt;agg_4_gpu4</title>
<path fill="none" stroke="black" d="M2404.57,-392.47C2394.72,-383.72 2383.7,-373.91 2372.47,-363.93"/>
<polygon fill="black" stroke="black" points="2374.47,-361.03 2364.67,-357 2369.82,-366.26 2374.47,-361.03"/>
</g>
<!-- gate_4_gpu4&#45;&gt;expert_4_gpu4_exp1 -->
<g id="edge338" class="edge">
<title>gate_4_gpu4&#45;&gt;expert_4_gpu4_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2151.22,-502.5C2119.86,-488.57 2087.65,-474.25 2059.91,-461.92"/>
<polygon fill="black" stroke="black" points="2061.24,-458.68 2050.68,-457.82 2058.4,-465.08 2061.24,-458.68"/>
</g>
<!-- gate_4_gpu4&#45;&gt;expert_4_gpu4_exp2 -->
<g id="edge339" class="edge">
<title>gate_4_gpu4&#45;&gt;expert_4_gpu4_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2213.4,-496.54C2202.24,-486.62 2191.05,-476.68 2180.79,-467.56"/>
<polygon fill="black" stroke="black" points="2182.94,-464.78 2173.14,-460.76 2178.29,-470.02 2182.94,-464.78"/>
</g>
<!-- gate_4_gpu4&#45;&gt;expert_4_gpu4_exp3 -->
<g id="edge340" class="edge">
<title>gate_4_gpu4&#45;&gt;expert_4_gpu4_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2289,-496.54C2289,-487.78 2289,-479.02 2289,-470.81"/>
<polygon fill="black" stroke="black" points="2292.5,-470.76 2289,-460.76 2285.5,-470.76 2292.5,-470.76"/>
</g>
<!-- gate_4_gpu4&#45;&gt;expert_4_gpu4_exp4 -->
<g id="edge341" class="edge">
<title>gate_4_gpu4&#45;&gt;expert_4_gpu4_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2364.6,-496.54C2375.76,-486.62 2386.95,-476.68 2397.21,-467.56"/>
<polygon fill="black" stroke="black" points="2399.71,-470.02 2404.86,-460.76 2395.06,-464.78 2399.71,-470.02"/>
</g>
<!-- agg_4_gpu4&#45;&gt;residual2_4_gpu4 -->
<g id="edge346" class="edge">
<title>agg_4_gpu4&#45;&gt;residual2_4_gpu4</title>
<path fill="none" stroke="black" d="M2389.04,-231.05C2413.57,-217.15 2439.24,-202.6 2461.8,-189.82"/>
<polygon fill="black" stroke="black" points="2463.64,-192.8 2470.61,-184.83 2460.18,-186.71 2463.64,-192.8"/>
</g>
<!-- residual2_4_gpu4&#45;&gt;output_tokens -->
<g id="edge348" class="edge">
<title>residual2_4_gpu4&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M2590.21,-116.68C2616.42,-102.52 2646.74,-86.14 2671.97,-72.51"/>
<polygon fill="black" stroke="black" points="2673.89,-75.46 2681.02,-67.62 2670.56,-69.3 2673.89,-75.46"/>
</g>
<!-- mha_4_gpu5&#45;&gt;residual1_4_gpu5 -->
<g id="edge364" class="edge">
<title>mha_4_gpu5&#45;&gt;residual1_4_gpu5</title>
<path fill="none" stroke="black" d="M3020.14,-757.61C3024.74,-749.27 3029.92,-739.88 3034.82,-731"/>
<polygon fill="black" stroke="black" points="3038.03,-732.44 3039.79,-721.99 3031.9,-729.05 3038.03,-732.44"/>
</g>
<!-- gate_4_gpu5 -->
<g id="node260" class="node">
<title>gate_4_gpu5</title>
<polygon fill="lightcoral" stroke="black" points="3061.92,-632.74 2839.34,-632.74 2782.08,-496.74 3004.66,-496.74 3061.92,-632.74"/>
<text text-anchor="middle" x="2922" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="2922" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2922" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu5&#45;&gt;gate_4_gpu5 -->
<g id="edge366" class="edge">
<title>residual1_4_gpu5&#45;&gt;gate_4_gpu5</title>
<path fill="none" stroke="black" d="M3027.61,-668.55C3018.92,-660.09 3008.79,-650.23 2998.31,-640.02"/>
<polygon fill="black" stroke="black" points="3000.61,-637.38 2991,-632.91 2995.73,-642.4 3000.61,-637.38"/>
</g>
<!-- residual2_4_gpu5 -->
<g id="node262" class="node">
<title>residual2_4_gpu5</title>
<polygon fill="lightgreen" stroke="black" points="2923.5,-184.74 2768.5,-184.74 2768.5,-116.74 2923.5,-116.74 2923.5,-184.74"/>
<text text-anchor="middle" x="2846" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="2846" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2846" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2846" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu5&#45;&gt;residual2_4_gpu5 -->
<g id="edge376" class="edge">
<title>residual1_4_gpu5&#45;&gt;residual2_4_gpu5</title>
<path fill="none" stroke="black" d="M3073.75,-668.71C3111.54,-616.61 3187.33,-494.38 3152,-392.74 3120,-300.69 3093.95,-279.22 3016,-220.74 2991.39,-202.28 2961.15,-187.93 2933.04,-177.21"/>
<polygon fill="black" stroke="black" points="2934.19,-173.9 2923.6,-173.71 2931.76,-180.47 2934.19,-173.9"/>
</g>
<!-- expert_4_gpu5_exp1 -->
<g id="node256" class="node">
<title>expert_4_gpu5_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3142.5,-460.74 3007.5,-460.74 3007.5,-392.74 3142.5,-392.74 3142.5,-460.74"/>
<text text-anchor="middle" x="3075" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3075" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3075" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="3075" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu5 -->
<g id="node261" class="node">
<title>agg_4_gpu5</title>
<polygon fill="lightyellow" stroke="black" points="3006.89,-356.74 2750.95,-356.74 2685.11,-220.74 2941.05,-220.74 3006.89,-356.74"/>
<text text-anchor="middle" x="2846" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="2846" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2846" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2846" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu5_exp1&#45;&gt;agg_4_gpu5 -->
<g id="edge371" class="edge">
<title>expert_4_gpu5_exp1&#45;&gt;agg_4_gpu5</title>
<path fill="none" stroke="black" d="M3019.27,-392.64C3003.57,-383.32 2985.85,-372.79 2967.88,-362.12"/>
<polygon fill="black" stroke="black" points="2969.43,-358.98 2959.05,-356.88 2965.86,-364.99 2969.43,-358.98"/>
</g>
<!-- expert_4_gpu5_exp2 -->
<g id="node257" class="node">
<title>expert_4_gpu5_exp2</title>
<polygon fill="lightgreen" stroke="black" points="2683.5,-460.74 2548.5,-460.74 2548.5,-392.74 2683.5,-392.74 2683.5,-460.74"/>
<text text-anchor="middle" x="2616" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="2616" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2616" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2616" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu5_exp2&#45;&gt;agg_4_gpu5 -->
<g id="edge372" class="edge">
<title>expert_4_gpu5_exp2&#45;&gt;agg_4_gpu5</title>
<path fill="none" stroke="black" d="M2671.97,-392.64C2691.9,-380.86 2715.07,-367.16 2737.88,-353.67"/>
<polygon fill="black" stroke="black" points="2739.77,-356.62 2746.59,-348.52 2736.2,-350.6 2739.77,-356.62"/>
</g>
<!-- expert_4_gpu5_exp3 -->
<g id="node258" class="node">
<title>expert_4_gpu5_exp3</title>
<polygon fill="lightgreen" stroke="black" points="2836.5,-460.74 2701.5,-460.74 2701.5,-392.74 2836.5,-392.74 2836.5,-460.74"/>
<text text-anchor="middle" x="2769" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="2769" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2769" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2769" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu5_exp3&#45;&gt;agg_4_gpu5 -->
<g id="edge373" class="edge">
<title>expert_4_gpu5_exp3&#45;&gt;agg_4_gpu5</title>
<path fill="none" stroke="black" d="M2787.84,-392.47C2792.46,-384.31 2797.6,-375.23 2802.85,-365.95"/>
<polygon fill="black" stroke="black" points="2806.04,-367.43 2807.92,-357 2799.94,-363.98 2806.04,-367.43"/>
</g>
<!-- expert_4_gpu5_exp4 -->
<g id="node259" class="node">
<title>expert_4_gpu5_exp4</title>
<polygon fill="lightgreen" stroke="black" points="2989.5,-460.74 2854.5,-460.74 2854.5,-392.74 2989.5,-392.74 2989.5,-460.74"/>
<text text-anchor="middle" x="2922" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="2922" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="2922" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 5</text>
<text text-anchor="middle" x="2922" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu5_exp4&#45;&gt;agg_4_gpu5 -->
<g id="edge374" class="edge">
<title>expert_4_gpu5_exp4&#45;&gt;agg_4_gpu5</title>
<path fill="none" stroke="black" d="M2903.41,-392.47C2898.85,-384.31 2893.77,-375.23 2888.59,-365.95"/>
<polygon fill="black" stroke="black" points="2891.52,-364.03 2883.59,-357 2885.41,-367.44 2891.52,-364.03"/>
</g>
<!-- gate_4_gpu5&#45;&gt;expert_4_gpu5_exp1 -->
<g id="edge367" class="edge">
<title>gate_4_gpu5&#45;&gt;expert_4_gpu5_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2997.6,-496.54C3008.76,-486.62 3019.95,-476.68 3030.21,-467.56"/>
<polygon fill="black" stroke="black" points="3032.71,-470.02 3037.86,-460.76 3028.06,-464.78 3032.71,-470.02"/>
</g>
<!-- gate_4_gpu5&#45;&gt;expert_4_gpu5_exp2 -->
<g id="edge368" class="edge">
<title>gate_4_gpu5&#45;&gt;expert_4_gpu5_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2784.22,-502.5C2752.86,-488.57 2720.65,-474.25 2692.91,-461.92"/>
<polygon fill="black" stroke="black" points="2694.24,-458.68 2683.68,-457.82 2691.4,-465.08 2694.24,-458.68"/>
</g>
<!-- gate_4_gpu5&#45;&gt;expert_4_gpu5_exp3 -->
<g id="edge369" class="edge">
<title>gate_4_gpu5&#45;&gt;expert_4_gpu5_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2846.4,-496.54C2835.24,-486.62 2824.05,-476.68 2813.79,-467.56"/>
<polygon fill="black" stroke="black" points="2815.94,-464.78 2806.14,-460.76 2811.29,-470.02 2815.94,-464.78"/>
</g>
<!-- gate_4_gpu5&#45;&gt;expert_4_gpu5_exp4 -->
<g id="edge370" class="edge">
<title>gate_4_gpu5&#45;&gt;expert_4_gpu5_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M2922,-496.54C2922,-487.78 2922,-479.02 2922,-470.81"/>
<polygon fill="black" stroke="black" points="2925.5,-470.76 2922,-460.76 2918.5,-470.76 2925.5,-470.76"/>
</g>
<!-- agg_4_gpu5&#45;&gt;residual2_4_gpu5 -->
<g id="edge375" class="edge">
<title>agg_4_gpu5&#45;&gt;residual2_4_gpu5</title>
<path fill="none" stroke="black" d="M2846,-220.54C2846,-211.78 2846,-203.02 2846,-194.81"/>
<polygon fill="black" stroke="black" points="2849.5,-194.76 2846,-184.76 2842.5,-194.76 2849.5,-194.76"/>
</g>
<!-- residual2_4_gpu5&#45;&gt;output_tokens -->
<g id="edge377" class="edge">
<title>residual2_4_gpu5&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M2808.05,-116.53C2793.19,-103.54 2776.22,-88.69 2761.51,-75.82"/>
<polygon fill="black" stroke="black" points="2763.43,-72.84 2753.6,-68.89 2758.82,-78.11 2763.43,-72.84"/>
</g>
<!-- mha_4_gpu6&#45;&gt;residual1_4_gpu6 -->
<g id="edge393" class="edge">
<title>mha_4_gpu6&#45;&gt;residual1_4_gpu6</title>
<path fill="none" stroke="black" d="M3653.14,-757.61C3657.74,-749.27 3662.92,-739.88 3667.82,-731"/>
<polygon fill="black" stroke="black" points="3671.03,-732.44 3672.79,-721.99 3664.9,-729.05 3671.03,-732.44"/>
</g>
<!-- gate_4_gpu6 -->
<g id="node269" class="node">
<title>gate_4_gpu6</title>
<polygon fill="lightcoral" stroke="black" points="3694.92,-632.74 3472.34,-632.74 3415.08,-496.74 3637.66,-496.74 3694.92,-632.74"/>
<text text-anchor="middle" x="3555" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="3555" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3555" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu6&#45;&gt;gate_4_gpu6 -->
<g id="edge395" class="edge">
<title>residual1_4_gpu6&#45;&gt;gate_4_gpu6</title>
<path fill="none" stroke="black" d="M3660.61,-668.55C3651.92,-660.09 3641.79,-650.23 3631.31,-640.02"/>
<polygon fill="black" stroke="black" points="3633.61,-637.38 3624,-632.91 3628.73,-642.4 3633.61,-637.38"/>
</g>
<!-- residual2_4_gpu6 -->
<g id="node271" class="node">
<title>residual2_4_gpu6</title>
<polygon fill="lightgreen" stroke="black" points="3556.5,-184.74 3401.5,-184.74 3401.5,-116.74 3556.5,-116.74 3556.5,-184.74"/>
<text text-anchor="middle" x="3479" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="3479" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3479" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3479" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu6&#45;&gt;residual2_4_gpu6 -->
<g id="edge405" class="edge">
<title>residual1_4_gpu6&#45;&gt;residual2_4_gpu6</title>
<path fill="none" stroke="black" d="M3706.75,-668.71C3744.54,-616.61 3820.33,-494.38 3785,-392.74 3753,-300.69 3726.95,-279.22 3649,-220.74 3624.39,-202.28 3594.15,-187.93 3566.04,-177.21"/>
<polygon fill="black" stroke="black" points="3567.19,-173.9 3556.6,-173.71 3564.76,-180.47 3567.19,-173.9"/>
</g>
<!-- expert_4_gpu6_exp1 -->
<g id="node265" class="node">
<title>expert_4_gpu6_exp1</title>
<polygon fill="lightgreen" stroke="black" points="3622.5,-460.74 3487.5,-460.74 3487.5,-392.74 3622.5,-392.74 3622.5,-460.74"/>
<text text-anchor="middle" x="3555" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="3555" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3555" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3555" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu6 -->
<g id="node270" class="node">
<title>agg_4_gpu6</title>
<polygon fill="lightyellow" stroke="black" points="3639.89,-356.74 3383.95,-356.74 3318.11,-220.74 3574.05,-220.74 3639.89,-356.74"/>
<text text-anchor="middle" x="3479" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="3479" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3479" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3479" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu6_exp1&#45;&gt;agg_4_gpu6 -->
<g id="edge400" class="edge">
<title>expert_4_gpu6_exp1&#45;&gt;agg_4_gpu6</title>
<path fill="none" stroke="black" d="M3536.41,-392.47C3531.85,-384.31 3526.77,-375.23 3521.59,-365.95"/>
<polygon fill="black" stroke="black" points="3524.52,-364.03 3516.59,-357 3518.41,-367.44 3524.52,-364.03"/>
</g>
<!-- expert_4_gpu6_exp2 -->
<g id="node266" class="node">
<title>expert_4_gpu6_exp2</title>
<polygon fill="lightgreen" stroke="black" points="3775.5,-460.74 3640.5,-460.74 3640.5,-392.74 3775.5,-392.74 3775.5,-460.74"/>
<text text-anchor="middle" x="3708" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="3708" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3708" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3708" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu6_exp2&#45;&gt;agg_4_gpu6 -->
<g id="edge401" class="edge">
<title>expert_4_gpu6_exp2&#45;&gt;agg_4_gpu6</title>
<path fill="none" stroke="black" d="M3652.27,-392.64C3636.57,-383.32 3618.85,-372.79 3600.88,-362.12"/>
<polygon fill="black" stroke="black" points="3602.43,-358.98 3592.05,-356.88 3598.86,-364.99 3602.43,-358.98"/>
</g>
<!-- expert_4_gpu6_exp3 -->
<g id="node267" class="node">
<title>expert_4_gpu6_exp3</title>
<polygon fill="lightgreen" stroke="black" points="3316.5,-460.74 3181.5,-460.74 3181.5,-392.74 3316.5,-392.74 3316.5,-460.74"/>
<text text-anchor="middle" x="3249" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="3249" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3249" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3249" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu6_exp3&#45;&gt;agg_4_gpu6 -->
<g id="edge402" class="edge">
<title>expert_4_gpu6_exp3&#45;&gt;agg_4_gpu6</title>
<path fill="none" stroke="black" d="M3304.97,-392.64C3324.9,-380.86 3348.07,-367.16 3370.88,-353.67"/>
<polygon fill="black" stroke="black" points="3372.77,-356.62 3379.59,-348.52 3369.2,-350.6 3372.77,-356.62"/>
</g>
<!-- expert_4_gpu6_exp4 -->
<g id="node268" class="node">
<title>expert_4_gpu6_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3469.5,-460.74 3334.5,-460.74 3334.5,-392.74 3469.5,-392.74 3469.5,-460.74"/>
<text text-anchor="middle" x="3402" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3402" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3402" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 6</text>
<text text-anchor="middle" x="3402" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu6_exp4&#45;&gt;agg_4_gpu6 -->
<g id="edge403" class="edge">
<title>expert_4_gpu6_exp4&#45;&gt;agg_4_gpu6</title>
<path fill="none" stroke="black" d="M3420.84,-392.47C3425.46,-384.31 3430.6,-375.23 3435.85,-365.95"/>
<polygon fill="black" stroke="black" points="3439.04,-367.43 3440.92,-357 3432.94,-363.98 3439.04,-367.43"/>
</g>
<!-- gate_4_gpu6&#45;&gt;expert_4_gpu6_exp1 -->
<g id="edge396" class="edge">
<title>gate_4_gpu6&#45;&gt;expert_4_gpu6_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3555,-496.54C3555,-487.78 3555,-479.02 3555,-470.81"/>
<polygon fill="black" stroke="black" points="3558.5,-470.76 3555,-460.76 3551.5,-470.76 3558.5,-470.76"/>
</g>
<!-- gate_4_gpu6&#45;&gt;expert_4_gpu6_exp2 -->
<g id="edge397" class="edge">
<title>gate_4_gpu6&#45;&gt;expert_4_gpu6_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3630.6,-496.54C3641.76,-486.62 3652.95,-476.68 3663.21,-467.56"/>
<polygon fill="black" stroke="black" points="3665.71,-470.02 3670.86,-460.76 3661.06,-464.78 3665.71,-470.02"/>
</g>
<!-- gate_4_gpu6&#45;&gt;expert_4_gpu6_exp3 -->
<g id="edge398" class="edge">
<title>gate_4_gpu6&#45;&gt;expert_4_gpu6_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3417.22,-502.5C3385.86,-488.57 3353.65,-474.25 3325.91,-461.92"/>
<polygon fill="black" stroke="black" points="3327.24,-458.68 3316.68,-457.82 3324.4,-465.08 3327.24,-458.68"/>
</g>
<!-- gate_4_gpu6&#45;&gt;expert_4_gpu6_exp4 -->
<g id="edge399" class="edge">
<title>gate_4_gpu6&#45;&gt;expert_4_gpu6_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M3479.4,-496.54C3468.24,-486.62 3457.05,-476.68 3446.79,-467.56"/>
<polygon fill="black" stroke="black" points="3448.94,-464.78 3439.14,-460.76 3444.29,-470.02 3448.94,-464.78"/>
</g>
<!-- agg_4_gpu6&#45;&gt;residual2_4_gpu6 -->
<g id="edge404" class="edge">
<title>agg_4_gpu6&#45;&gt;residual2_4_gpu6</title>
<path fill="none" stroke="black" d="M3479,-220.54C3479,-211.78 3479,-203.02 3479,-194.81"/>
<polygon fill="black" stroke="black" points="3482.5,-194.76 3479,-184.76 3475.5,-194.76 3482.5,-194.76"/>
</g>
<!-- residual2_4_gpu6&#45;&gt;output_tokens -->
<g id="edge406" class="edge">
<title>residual2_4_gpu6&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M3401.15,-138.81C3264.6,-119.64 2981.92,-79.94 2828.87,-58.45"/>
<polygon fill="black" stroke="black" points="2828.92,-54.93 2818.53,-57 2827.95,-61.86 2828.92,-54.93"/>
</g>
<!-- mha_4_gpu7&#45;&gt;residual1_4_gpu7 -->
<g id="edge422" class="edge">
<title>mha_4_gpu7&#45;&gt;residual1_4_gpu7</title>
<path fill="none" stroke="black" d="M4377.21,-757.61C4384.4,-748.92 4392.54,-739.09 4400.16,-729.88"/>
<polygon fill="black" stroke="black" points="4403.01,-731.93 4406.69,-721.99 4397.62,-727.46 4403.01,-731.93"/>
</g>
<!-- gate_4_gpu7 -->
<g id="node278" class="node">
<title>gate_4_gpu7</title>
<polygon fill="lightcoral" stroke="black" points="4327.92,-632.74 4105.34,-632.74 4048.08,-496.74 4270.66,-496.74 4327.92,-632.74"/>
<text text-anchor="middle" x="4188" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4188" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4188" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu7&#45;&gt;gate_4_gpu7 -->
<g id="edge424" class="edge">
<title>residual1_4_gpu7&#45;&gt;gate_4_gpu7</title>
<path fill="none" stroke="black" d="M4380.3,-668.7C4363.19,-659.54 4342.96,-648.71 4322.16,-637.57"/>
<polygon fill="black" stroke="black" points="4323.68,-634.42 4313.21,-632.78 4320.38,-640.59 4323.68,-634.42"/>
</g>
<!-- residual2_4_gpu7 -->
<g id="node280" class="node">
<title>residual2_4_gpu7</title>
<polygon fill="lightgreen" stroke="black" points="4188.5,-184.74 4033.5,-184.74 4033.5,-116.74 4188.5,-116.74 4188.5,-184.74"/>
<text text-anchor="middle" x="4111" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4111" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4111" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4111" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu7&#45;&gt;residual2_4_gpu7 -->
<g id="edge434" class="edge">
<title>residual1_4_gpu7&#45;&gt;residual2_4_gpu7</title>
<path fill="none" stroke="black" d="M4432.39,-668.6C4440.42,-615.27 4453.57,-489.31 4418,-392.74 4384.22,-301.03 4359.28,-279.25 4281,-220.74 4256.36,-202.32 4226.11,-187.98 4198,-177.26"/>
<polygon fill="black" stroke="black" points="4199.15,-173.95 4188.56,-173.76 4196.72,-180.52 4199.15,-173.95"/>
</g>
<!-- expert_4_gpu7_exp1 -->
<g id="node274" class="node">
<title>expert_4_gpu7_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4102.5,-460.74 3967.5,-460.74 3967.5,-392.74 4102.5,-392.74 4102.5,-460.74"/>
<text text-anchor="middle" x="4035" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4035" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4035" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4035" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu7 -->
<g id="node279" class="node">
<title>agg_4_gpu7</title>
<polygon fill="lightyellow" stroke="black" points="4271.89,-356.74 4015.95,-356.74 3950.11,-220.74 4206.05,-220.74 4271.89,-356.74"/>
<text text-anchor="middle" x="4111" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4111" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4111" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4111" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu7_exp1&#45;&gt;agg_4_gpu7 -->
<g id="edge429" class="edge">
<title>expert_4_gpu7_exp1&#45;&gt;agg_4_gpu7</title>
<path fill="none" stroke="black" d="M4053.59,-392.47C4058.15,-384.31 4063.23,-375.23 4068.41,-365.95"/>
<polygon fill="black" stroke="black" points="4071.59,-367.44 4073.41,-357 4065.48,-364.03 4071.59,-367.44"/>
</g>
<!-- expert_4_gpu7_exp2 -->
<g id="node275" class="node">
<title>expert_4_gpu7_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4255.5,-460.74 4120.5,-460.74 4120.5,-392.74 4255.5,-392.74 4255.5,-460.74"/>
<text text-anchor="middle" x="4188" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4188" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4188" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4188" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu7_exp2&#45;&gt;agg_4_gpu7 -->
<g id="edge430" class="edge">
<title>expert_4_gpu7_exp2&#45;&gt;agg_4_gpu7</title>
<path fill="none" stroke="black" d="M4169.16,-392.47C4164.54,-384.31 4159.4,-375.23 4154.15,-365.95"/>
<polygon fill="black" stroke="black" points="4157.06,-363.98 4149.08,-357 4150.96,-367.43 4157.06,-363.98"/>
</g>
<!-- expert_4_gpu7_exp3 -->
<g id="node276" class="node">
<title>expert_4_gpu7_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4408.5,-460.74 4273.5,-460.74 4273.5,-392.74 4408.5,-392.74 4408.5,-460.74"/>
<text text-anchor="middle" x="4341" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4341" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4341" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="4341" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu7_exp3&#45;&gt;agg_4_gpu7 -->
<g id="edge431" class="edge">
<title>expert_4_gpu7_exp3&#45;&gt;agg_4_gpu7</title>
<path fill="none" stroke="black" d="M4285.03,-392.64C4269.26,-383.32 4251.46,-372.79 4233.41,-362.12"/>
<polygon fill="black" stroke="black" points="4234.93,-358.96 4224.54,-356.88 4231.37,-364.98 4234.93,-358.96"/>
</g>
<!-- expert_4_gpu7_exp4 -->
<g id="node277" class="node">
<title>expert_4_gpu7_exp4</title>
<polygon fill="lightgreen" stroke="black" points="3949.5,-460.74 3814.5,-460.74 3814.5,-392.74 3949.5,-392.74 3949.5,-460.74"/>
<text text-anchor="middle" x="3882" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="3882" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="3882" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 7</text>
<text text-anchor="middle" x="3882" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu7_exp4&#45;&gt;agg_4_gpu7 -->
<g id="edge432" class="edge">
<title>expert_4_gpu7_exp4&#45;&gt;agg_4_gpu7</title>
<path fill="none" stroke="black" d="M3937.73,-392.64C3957.45,-380.93 3980.36,-367.32 4002.94,-353.91"/>
<polygon fill="black" stroke="black" points="4004.76,-356.9 4011.57,-348.79 4001.19,-350.89 4004.76,-356.9"/>
</g>
<!-- gate_4_gpu7&#45;&gt;expert_4_gpu7_exp1 -->
<g id="edge425" class="edge">
<title>gate_4_gpu7&#45;&gt;expert_4_gpu7_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4112.4,-496.54C4101.24,-486.62 4090.05,-476.68 4079.79,-467.56"/>
<polygon fill="black" stroke="black" points="4081.94,-464.78 4072.14,-460.76 4077.29,-470.02 4081.94,-464.78"/>
</g>
<!-- gate_4_gpu7&#45;&gt;expert_4_gpu7_exp2 -->
<g id="edge426" class="edge">
<title>gate_4_gpu7&#45;&gt;expert_4_gpu7_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4188,-496.54C4188,-487.78 4188,-479.02 4188,-470.81"/>
<polygon fill="black" stroke="black" points="4191.5,-470.76 4188,-460.76 4184.5,-470.76 4191.5,-470.76"/>
</g>
<!-- gate_4_gpu7&#45;&gt;expert_4_gpu7_exp3 -->
<g id="edge427" class="edge">
<title>gate_4_gpu7&#45;&gt;expert_4_gpu7_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4263.6,-496.54C4274.76,-486.62 4285.95,-476.68 4296.21,-467.56"/>
<polygon fill="black" stroke="black" points="4298.71,-470.02 4303.86,-460.76 4294.06,-464.78 4298.71,-470.02"/>
</g>
<!-- gate_4_gpu7&#45;&gt;expert_4_gpu7_exp4 -->
<g id="edge428" class="edge">
<title>gate_4_gpu7&#45;&gt;expert_4_gpu7_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4050.22,-502.5C4018.86,-488.57 3986.65,-474.25 3958.91,-461.92"/>
<polygon fill="black" stroke="black" points="3960.24,-458.68 3949.68,-457.82 3957.4,-465.08 3960.24,-458.68"/>
</g>
<!-- agg_4_gpu7&#45;&gt;residual2_4_gpu7 -->
<g id="edge433" class="edge">
<title>agg_4_gpu7&#45;&gt;residual2_4_gpu7</title>
<path fill="none" stroke="black" d="M4111,-220.54C4111,-211.78 4111,-203.02 4111,-194.81"/>
<polygon fill="black" stroke="black" points="4114.5,-194.76 4111,-184.76 4107.5,-194.76 4114.5,-194.76"/>
</g>
<!-- residual2_4_gpu7&#45;&gt;output_tokens -->
<g id="edge435" class="edge">
<title>residual2_4_gpu7&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M4033.01,-143.78C3800.74,-126.04 3112.71,-73.49 2839.09,-52.58"/>
<polygon fill="black" stroke="black" points="2838.98,-49.07 2828.74,-51.79 2838.45,-56.05 2838.98,-49.07"/>
</g>
<!-- mha_4_gpu8&#45;&gt;residual1_4_gpu8 -->
<g id="edge451" class="edge">
<title>mha_4_gpu8&#45;&gt;residual1_4_gpu8</title>
<path fill="none" stroke="black" d="M4810.44,-757.61C4815.18,-749.19 4820.53,-739.69 4825.58,-730.72"/>
<polygon fill="black" stroke="black" points="4828.64,-732.42 4830.5,-721.99 4822.54,-728.99 4828.64,-732.42"/>
</g>
<!-- gate_4_gpu8 -->
<g id="node287" class="node">
<title>gate_4_gpu8</title>
<polygon fill="lightcoral" stroke="black" points="4960.92,-632.74 4738.34,-632.74 4681.08,-496.74 4903.66,-496.74 4960.92,-632.74"/>
<text text-anchor="middle" x="4821" y="-583.54" font-family="Times,serif" font-size="14.00">Gate</text>
<text text-anchor="middle" x="4821" y="-568.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4821" y="-553.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-538.54" font-family="Times,serif" font-size="14.00">(B=1024, E=64)</text>
</g>
<!-- residual1_4_gpu8&#45;&gt;gate_4_gpu8 -->
<g id="edge453" class="edge">
<title>residual1_4_gpu8&#45;&gt;gate_4_gpu8</title>
<path fill="none" stroke="black" d="M4840.2,-668.55C4838.77,-660.91 4837.13,-652.12 4835.42,-642.96"/>
<polygon fill="black" stroke="black" points="4838.82,-642.1 4833.55,-632.91 4831.94,-643.39 4838.82,-642.1"/>
</g>
<!-- residual2_4_gpu8 -->
<g id="node289" class="node">
<title>residual2_4_gpu8</title>
<polygon fill="lightgreen" stroke="black" points="4821.5,-184.74 4666.5,-184.74 4666.5,-116.74 4821.5,-116.74 4821.5,-184.74"/>
<text text-anchor="middle" x="4744" y="-169.54" font-family="Times,serif" font-size="14.00">Final Residual</text>
<text text-anchor="middle" x="4744" y="-154.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4744" y="-139.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-124.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- residual1_4_gpu8&#45;&gt;residual2_4_gpu8 -->
<g id="edge463" class="edge">
<title>residual1_4_gpu8&#45;&gt;residual2_4_gpu8</title>
<path fill="none" stroke="black" d="M4917.54,-668.68C4936.31,-659.52 4955.33,-647.66 4970,-632.74 5048.92,-552.46 5088.15,-499.01 5051,-392.74 5018.75,-300.48 4992.28,-279.25 4914,-220.74 4889.36,-202.32 4859.11,-187.98 4831,-177.26"/>
<polygon fill="black" stroke="black" points="4832.15,-173.95 4821.56,-173.76 4829.72,-180.52 4832.15,-173.95"/>
</g>
<!-- expert_4_gpu8_exp1 -->
<g id="node283" class="node">
<title>expert_4_gpu8_exp1</title>
<polygon fill="lightgreen" stroke="black" points="4582.5,-460.74 4447.5,-460.74 4447.5,-392.74 4582.5,-392.74 4582.5,-460.74"/>
<text text-anchor="middle" x="4515" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 1</text>
<text text-anchor="middle" x="4515" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4515" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4515" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- agg_4_gpu8 -->
<g id="node288" class="node">
<title>agg_4_gpu8</title>
<polygon fill="lightyellow" stroke="black" points="4904.89,-356.74 4648.95,-356.74 4583.11,-220.74 4839.05,-220.74 4904.89,-356.74"/>
<text text-anchor="middle" x="4744" y="-307.54" font-family="Times,serif" font-size="14.00">Expert Agg</text>
<text text-anchor="middle" x="4744" y="-292.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4744" y="-277.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4744" y="-262.54" font-family="Times,serif" font-size="14.00">(B=1024, H=8192)</text>
</g>
<!-- expert_4_gpu8_exp1&#45;&gt;agg_4_gpu8 -->
<g id="edge458" class="edge">
<title>expert_4_gpu8_exp1&#45;&gt;agg_4_gpu8</title>
<path fill="none" stroke="black" d="M4570.73,-392.64C4590.45,-380.93 4613.36,-367.32 4635.94,-353.91"/>
<polygon fill="black" stroke="black" points="4637.76,-356.9 4644.57,-348.79 4634.19,-350.89 4637.76,-356.9"/>
</g>
<!-- expert_4_gpu8_exp2 -->
<g id="node284" class="node">
<title>expert_4_gpu8_exp2</title>
<polygon fill="lightgreen" stroke="black" points="4735.5,-460.74 4600.5,-460.74 4600.5,-392.74 4735.5,-392.74 4735.5,-460.74"/>
<text text-anchor="middle" x="4668" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 2</text>
<text text-anchor="middle" x="4668" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4668" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4668" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu8_exp2&#45;&gt;agg_4_gpu8 -->
<g id="edge459" class="edge">
<title>expert_4_gpu8_exp2&#45;&gt;agg_4_gpu8</title>
<path fill="none" stroke="black" d="M4686.59,-392.47C4691.15,-384.31 4696.23,-375.23 4701.41,-365.95"/>
<polygon fill="black" stroke="black" points="4704.59,-367.44 4706.41,-357 4698.48,-364.03 4704.59,-367.44"/>
</g>
<!-- expert_4_gpu8_exp3 -->
<g id="node285" class="node">
<title>expert_4_gpu8_exp3</title>
<polygon fill="lightgreen" stroke="black" points="4888.5,-460.74 4753.5,-460.74 4753.5,-392.74 4888.5,-392.74 4888.5,-460.74"/>
<text text-anchor="middle" x="4821" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 3</text>
<text text-anchor="middle" x="4821" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4821" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4821" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu8_exp3&#45;&gt;agg_4_gpu8 -->
<g id="edge460" class="edge">
<title>expert_4_gpu8_exp3&#45;&gt;agg_4_gpu8</title>
<path fill="none" stroke="black" d="M4802.16,-392.47C4797.54,-384.31 4792.4,-375.23 4787.15,-365.95"/>
<polygon fill="black" stroke="black" points="4790.06,-363.98 4782.08,-357 4783.96,-367.43 4790.06,-363.98"/>
</g>
<!-- expert_4_gpu8_exp4 -->
<g id="node286" class="node">
<title>expert_4_gpu8_exp4</title>
<polygon fill="lightgreen" stroke="black" points="5041.5,-460.74 4906.5,-460.74 4906.5,-392.74 5041.5,-392.74 5041.5,-460.74"/>
<text text-anchor="middle" x="4974" y="-445.54" font-family="Times,serif" font-size="14.00">Expert 4</text>
<text text-anchor="middle" x="4974" y="-430.54" font-family="Times,serif" font-size="14.00">Layer 4</text>
<text text-anchor="middle" x="4974" y="-415.54" font-family="Times,serif" font-size="14.00">GPU 8</text>
<text text-anchor="middle" x="4974" y="-400.54" font-family="Times,serif" font-size="14.00">(B=?, H=32768)</text>
</g>
<!-- expert_4_gpu8_exp4&#45;&gt;agg_4_gpu8 -->
<g id="edge461" class="edge">
<title>expert_4_gpu8_exp4&#45;&gt;agg_4_gpu8</title>
<path fill="none" stroke="black" d="M4918.03,-392.64C4902.26,-383.32 4884.46,-372.79 4866.41,-362.12"/>
<polygon fill="black" stroke="black" points="4867.93,-358.96 4857.54,-356.88 4864.37,-364.98 4867.93,-358.96"/>
</g>
<!-- gate_4_gpu8&#45;&gt;expert_4_gpu8_exp1 -->
<g id="edge454" class="edge">
<title>gate_4_gpu8&#45;&gt;expert_4_gpu8_exp1</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4683.22,-502.5C4651.86,-488.57 4619.65,-474.25 4591.91,-461.92"/>
<polygon fill="black" stroke="black" points="4593.24,-458.68 4582.68,-457.82 4590.4,-465.08 4593.24,-458.68"/>
</g>
<!-- gate_4_gpu8&#45;&gt;expert_4_gpu8_exp2 -->
<g id="edge455" class="edge">
<title>gate_4_gpu8&#45;&gt;expert_4_gpu8_exp2</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4745.4,-496.54C4734.24,-486.62 4723.05,-476.68 4712.79,-467.56"/>
<polygon fill="black" stroke="black" points="4714.94,-464.78 4705.14,-460.76 4710.29,-470.02 4714.94,-464.78"/>
</g>
<!-- gate_4_gpu8&#45;&gt;expert_4_gpu8_exp3 -->
<g id="edge456" class="edge">
<title>gate_4_gpu8&#45;&gt;expert_4_gpu8_exp3</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4821,-496.54C4821,-487.78 4821,-479.02 4821,-470.81"/>
<polygon fill="black" stroke="black" points="4824.5,-470.76 4821,-460.76 4817.5,-470.76 4824.5,-470.76"/>
</g>
<!-- gate_4_gpu8&#45;&gt;expert_4_gpu8_exp4 -->
<g id="edge457" class="edge">
<title>gate_4_gpu8&#45;&gt;expert_4_gpu8_exp4</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M4896.6,-496.54C4907.76,-486.62 4918.95,-476.68 4929.21,-467.56"/>
<polygon fill="black" stroke="black" points="4931.71,-470.02 4936.86,-460.76 4927.06,-464.78 4931.71,-470.02"/>
</g>
<!-- agg_4_gpu8&#45;&gt;residual2_4_gpu8 -->
<g id="edge462" class="edge">
<title>agg_4_gpu8&#45;&gt;residual2_4_gpu8</title>
<path fill="none" stroke="black" d="M4744,-220.54C4744,-211.78 4744,-203.02 4744,-194.81"/>
<polygon fill="black" stroke="black" points="4747.5,-194.76 4744,-184.76 4740.5,-194.76 4747.5,-194.76"/>
</g>
<!-- residual2_4_gpu8&#45;&gt;output_tokens -->
<g id="edge464" class="edge">
<title>residual2_4_gpu8&#45;&gt;output_tokens</title>
<path fill="none" stroke="black" d="M4666.29,-143.14C4560.45,-134.33 4365.01,-118.69 4198,-108.74 3694.57,-78.76 3093.58,-56.5 2843.37,-47.84"/>
<polygon fill="black" stroke="black" points="2843.28,-44.33 2833.17,-47.49 2843.04,-51.33 2843.28,-44.33"/>
</g>
<!-- comm_stage1_to_stage2_gpu1&#45;&gt;mha_3_gpu1 -->
<g id="edge233" class="edge">
<title>comm_stage1_to_stage2_gpu1&#45;&gt;mha_3_gpu1</title>
<path fill="none" stroke="black" d="M730.87,-1602.28C874.93,-1582.38 1137.18,-1546.16 1273.48,-1527.33"/>
<polygon fill="black" stroke="black" points="1274.05,-1530.78 1283.47,-1525.95 1273.09,-1523.85 1274.05,-1530.78"/>
</g>
<!-- comm_stage1_to_stage2_gpu1&#45;&gt;residual1_3_gpu1 -->
<g id="edge235" class="edge">
<title>comm_stage1_to_stage2_gpu1&#45;&gt;residual1_3_gpu1</title>
<path fill="none" stroke="black" d="M630,-1579.59C630,-1545.73 630,-1495.72 630,-1462.11"/>
<polygon fill="black" stroke="black" points="633.5,-1461.81 630,-1451.81 626.5,-1461.81 633.5,-1461.81"/>
</g>
<!-- comm_stage1_to_stage2_gpu2&#45;&gt;mha_3_gpu2 -->
<g id="edge262" class="edge">
<title>comm_stage1_to_stage2_gpu2&#45;&gt;mha_3_gpu2</title>
<path fill="none" stroke="black" d="M1345.83,-1601.72C1379.13,-1594.93 1415.9,-1585.27 1448,-1571.74 1463.54,-1565.19 1479.31,-1555.78 1493.04,-1546.52"/>
<polygon fill="black" stroke="black" points="1495.07,-1549.38 1501.29,-1540.8 1491.08,-1543.62 1495.07,-1549.38"/>
</g>
<!-- comm_stage1_to_stage2_gpu2&#45;&gt;residual1_3_gpu2 -->
<g id="edge264" class="edge">
<title>comm_stage1_to_stage2_gpu2&#45;&gt;residual1_3_gpu2</title>
<path fill="none" stroke="black" d="M1231,-1579.59C1230.23,-1576.96 1229.55,-1574.33 1229,-1571.74 1221.16,-1534.94 1219.73,-1491.79 1219.91,-1462.08"/>
<polygon fill="black" stroke="black" points="1223.41,-1461.83 1220.03,-1451.79 1216.41,-1461.74 1223.41,-1461.83"/>
</g>
<!-- comm_stage1_to_stage2_gpu3&#45;&gt;mha_3_gpu3 -->
<g id="edge291" class="edge">
<title>comm_stage1_to_stage2_gpu3&#45;&gt;mha_3_gpu3</title>
<path fill="none" stroke="black" d="M1690.39,-1579.76C1692.82,-1570.3 1695.44,-1560.13 1697.86,-1550.72"/>
<polygon fill="black" stroke="black" points="1701.29,-1551.44 1700.4,-1540.88 1694.51,-1549.7 1701.29,-1551.44"/>
</g>
<!-- comm_stage1_to_stage2_gpu3&#45;&gt;residual1_3_gpu3 -->
<g id="edge293" class="edge">
<title>comm_stage1_to_stage2_gpu3&#45;&gt;residual1_3_gpu3</title>
<path fill="none" stroke="black" d="M1579.01,-1603.27C1517.17,-1595.71 1436.62,-1586.38 1365,-1579.74 1352.36,-1578.57 1259.66,-1581.03 1251,-1571.74 1225.54,-1544.43 1226.5,-1515.91 1251,-1487.74 1295.55,-1436.51 1487.2,-1426.69 1602.03,-1425.52"/>
<polygon fill="black" stroke="black" points="1602.24,-1429.02 1612.21,-1425.44 1602.19,-1422.02 1602.24,-1429.02"/>
</g>
<!-- comm_stage1_to_stage2_gpu4&#45;&gt;mha_3_gpu4 -->
<g id="edge320" class="edge">
<title>comm_stage1_to_stage2_gpu4&#45;&gt;mha_3_gpu4</title>
<path fill="none" stroke="black" d="M2212,-1579.48C2212,-1570.22 2212,-1560.29 2212,-1551.08"/>
<polygon fill="black" stroke="black" points="2215.5,-1551.05 2212,-1541.05 2208.5,-1551.05 2215.5,-1551.05"/>
</g>
<!-- comm_stage1_to_stage2_gpu4&#45;&gt;residual1_3_gpu4 -->
<g id="edge322" class="edge">
<title>comm_stage1_to_stage2_gpu4&#45;&gt;residual1_3_gpu4</title>
<path fill="none" stroke="black" d="M2108.44,-1604.94C2025.21,-1596.38 1905.24,-1585.19 1800,-1579.74 1785.41,-1578.98 1284.25,-1582.15 1274,-1571.74 1247.8,-1545.14 1248.48,-1514.99 1274,-1487.74 1277.62,-1483.88 1891.86,-1445.86 2124.28,-1431.6"/>
<polygon fill="black" stroke="black" points="2124.62,-1435.09 2134.39,-1430.98 2124.19,-1428.1 2124.62,-1435.09"/>
</g>
<!-- comm_stage1_to_stage2_gpu5&#45;&gt;mha_3_gpu5 -->
<g id="edge349" class="edge">
<title>comm_stage1_to_stage2_gpu5&#45;&gt;mha_3_gpu5</title>
<path fill="none" stroke="black" d="M3162,-1579.48C3162,-1570.22 3162,-1560.29 3162,-1551.08"/>
<polygon fill="black" stroke="black" points="3165.5,-1551.05 3162,-1541.05 3158.5,-1551.05 3165.5,-1551.05"/>
</g>
<!-- comm_stage1_to_stage2_gpu5&#45;&gt;residual1_3_gpu5 -->
<g id="edge351" class="edge">
<title>comm_stage1_to_stage2_gpu5&#45;&gt;residual1_3_gpu5</title>
<path fill="none" stroke="black" d="M3266.69,-1606.04C3360.46,-1597.39 3501.77,-1585.48 3625,-1579.74 3632.66,-1579.38 4171.62,-1577.2 4177,-1571.74 4203.21,-1545.15 4202.59,-1514.93 4177,-1487.74 4169.08,-1479.33 3495.22,-1443.54 3249.98,-1430.78"/>
<polygon fill="black" stroke="black" points="3249.85,-1427.27 3239.68,-1430.25 3249.49,-1434.26 3249.85,-1427.27"/>
</g>
<!-- comm_stage1_to_stage2_gpu6&#45;&gt;mha_3_gpu6 -->
<g id="edge378" class="edge">
<title>comm_stage1_to_stage2_gpu6&#45;&gt;mha_3_gpu6</title>
<path fill="none" stroke="black" d="M3744,-1579.48C3744,-1570.22 3744,-1560.29 3744,-1551.08"/>
<polygon fill="black" stroke="black" points="3747.5,-1551.05 3744,-1541.05 3740.5,-1551.05 3747.5,-1551.05"/>
</g>
<!-- comm_stage1_to_stage2_gpu6&#45;&gt;residual1_3_gpu6 -->
<g id="edge380" class="edge">
<title>comm_stage1_to_stage2_gpu6&#45;&gt;residual1_3_gpu6</title>
<path fill="none" stroke="black" d="M3847.17,-1604.23C3914.99,-1596.59 4005.7,-1586.84 4086,-1579.74 4098.65,-1578.62 4191.34,-1581.03 4200,-1571.74 4225.46,-1544.43 4224.42,-1515.98 4200,-1487.74 4178.47,-1462.85 3983.25,-1442.86 3866.01,-1432.98"/>
<polygon fill="black" stroke="black" points="3866.23,-1429.48 3855.97,-1432.14 3865.64,-1436.46 3866.23,-1429.48"/>
</g>
<!-- comm_stage1_to_stage2_gpu7&#45;&gt;mha_3_gpu7 -->
<g id="edge407" class="edge">
<title>comm_stage1_to_stage2_gpu7&#45;&gt;mha_3_gpu7</title>
<path fill="none" stroke="black" d="M4105.45,-1601.51C4072.39,-1594.72 4035.89,-1585.11 4004,-1571.74 3988.32,-1565.17 3972.37,-1555.76 3958.49,-1546.5"/>
<polygon fill="black" stroke="black" points="3960.36,-1543.54 3950.13,-1540.78 3956.41,-1549.32 3960.36,-1543.54"/>
</g>
<!-- comm_stage1_to_stage2_gpu7&#45;&gt;residual1_3_gpu7 -->
<g id="edge409" class="edge">
<title>comm_stage1_to_stage2_gpu7&#45;&gt;residual1_3_gpu7</title>
<path fill="none" stroke="black" d="M4242.66,-1581.8C4244.76,-1578.59 4246.59,-1575.23 4248,-1571.74 4262,-1537.13 4259.21,-1523.35 4248,-1487.74 4244.95,-1478.05 4239.76,-1468.55 4234.03,-1460.03"/>
<polygon fill="black" stroke="black" points="4236.85,-1457.95 4228.17,-1451.87 4231.16,-1462.03 4236.85,-1457.95"/>
</g>
<!-- comm_stage1_to_stage2_gpu8&#45;&gt;mha_3_gpu8 -->
<g id="edge436" class="edge">
<title>comm_stage1_to_stage2_gpu8&#45;&gt;mha_3_gpu8</title>
<path fill="none" stroke="black" d="M4645.03,-1600.94C4517.91,-1581.31 4299.24,-1547.55 4177.78,-1528.79"/>
<polygon fill="black" stroke="black" points="4178.19,-1525.32 4167.77,-1527.25 4177.12,-1532.23 4178.19,-1525.32"/>
</g>
<!-- comm_stage1_to_stage2_gpu8&#45;&gt;residual1_3_gpu8 -->
<g id="edge438" class="edge">
<title>comm_stage1_to_stage2_gpu8&#45;&gt;residual1_3_gpu8</title>
<path fill="none" stroke="black" d="M4744,-1579.59C4744,-1545.73 4744,-1495.72 4744,-1462.11"/>
<polygon fill="black" stroke="black" points="4747.5,-1461.81 4744,-1451.81 4740.5,-1461.81 4747.5,-1461.81"/>
</g>
</g>
</svg>
