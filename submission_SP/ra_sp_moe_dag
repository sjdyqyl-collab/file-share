// MoE Transformer RA+SP (16 GPUs)
digraph {
	rankdir=TB size="25,40"
	node [color=lightblue shape=ellipse style=filled]
	node [color=lightgreen shape=rectangle style=filled]
	node [color=lightyellow shape=parallelogram style=filled]
	node [color=lightcoral shape=diamond style=filled]
	subgraph cluster_input {
		label="Input Layer"
		input [label="Input
X: [B, L, d_model]
GPU: Host" shape=parallelogram]
	}
	subgraph cluster_sp_split {
		label="Sequence Parallel Split"
		sp_split [label="Sequence Parallel Split
X: [B, L/16, d_model]
GPU: 0-15" shape=parallelogram]
	}
	subgraph cluster_ra_sp0 {
		label="Ring Attention + Sequence Parallel"
		qkv0_0 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		qkv0_1 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		qkv0_2 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		qkv0_3 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		qkv0_4 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		qkv0_5 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		qkv0_6 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		qkv0_7 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		qkv0_8 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		qkv0_9 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		qkv0_10 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		qkv0_11 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		qkv0_12 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		qkv0_13 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		qkv0_14 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		qkv0_15 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		ring_stage0_0_0 [label="Ring Stage 0
Compute: Q_0×K_0×V_0
GPU: 0" shape=rectangle]
		ring_stage0_0_1 [label="Ring Stage 0
Compute: Q_1×K_1×V_1
GPU: 1" shape=rectangle]
		ring_stage0_0_2 [label="Ring Stage 0
Compute: Q_2×K_2×V_2
GPU: 2" shape=rectangle]
		ring_stage0_0_3 [label="Ring Stage 0
Compute: Q_3×K_3×V_3
GPU: 3" shape=rectangle]
		ring_stage0_0_4 [label="Ring Stage 0
Compute: Q_4×K_4×V_4
GPU: 4" shape=rectangle]
		ring_stage0_0_5 [label="Ring Stage 0
Compute: Q_5×K_5×V_5
GPU: 5" shape=rectangle]
		ring_stage0_0_6 [label="Ring Stage 0
Compute: Q_6×K_6×V_6
GPU: 6" shape=rectangle]
		ring_stage0_0_7 [label="Ring Stage 0
Compute: Q_7×K_7×V_7
GPU: 7" shape=rectangle]
		ring_stage0_0_8 [label="Ring Stage 0
Compute: Q_8×K_8×V_8
GPU: 8" shape=rectangle]
		ring_stage0_0_9 [label="Ring Stage 0
Compute: Q_9×K_9×V_9
GPU: 9" shape=rectangle]
		ring_stage0_0_10 [label="Ring Stage 0
Compute: Q_10×K_10×V_10
GPU: 10" shape=rectangle]
		ring_stage0_0_11 [label="Ring Stage 0
Compute: Q_11×K_11×V_11
GPU: 11" shape=rectangle]
		ring_stage0_0_12 [label="Ring Stage 0
Compute: Q_12×K_12×V_12
GPU: 12" shape=rectangle]
		ring_stage0_0_13 [label="Ring Stage 0
Compute: Q_13×K_13×V_13
GPU: 13" shape=rectangle]
		ring_stage0_0_14 [label="Ring Stage 0
Compute: Q_14×K_14×V_14
GPU: 14" shape=rectangle]
		ring_stage0_0_15 [label="Ring Stage 0
Compute: Q_15×K_15×V_15
GPU: 15" shape=rectangle]
		kv_send0_0_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_0_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_0_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_0_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_0_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_0_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_0_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_0_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_0_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_0_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_0_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_0_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_0_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_0_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_0_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_0_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_1_0 [label="Ring Stage 1
Compute: Q_0×K_15×V_15
GPU: 0" shape=rectangle]
		ring_stage0_1_1 [label="Ring Stage 1
Compute: Q_1×K_0×V_0
GPU: 1" shape=rectangle]
		ring_stage0_1_2 [label="Ring Stage 1
Compute: Q_2×K_1×V_1
GPU: 2" shape=rectangle]
		ring_stage0_1_3 [label="Ring Stage 1
Compute: Q_3×K_2×V_2
GPU: 3" shape=rectangle]
		ring_stage0_1_4 [label="Ring Stage 1
Compute: Q_4×K_3×V_3
GPU: 4" shape=rectangle]
		ring_stage0_1_5 [label="Ring Stage 1
Compute: Q_5×K_4×V_4
GPU: 5" shape=rectangle]
		ring_stage0_1_6 [label="Ring Stage 1
Compute: Q_6×K_5×V_5
GPU: 6" shape=rectangle]
		ring_stage0_1_7 [label="Ring Stage 1
Compute: Q_7×K_6×V_6
GPU: 7" shape=rectangle]
		ring_stage0_1_8 [label="Ring Stage 1
Compute: Q_8×K_7×V_7
GPU: 8" shape=rectangle]
		ring_stage0_1_9 [label="Ring Stage 1
Compute: Q_9×K_8×V_8
GPU: 9" shape=rectangle]
		ring_stage0_1_10 [label="Ring Stage 1
Compute: Q_10×K_9×V_9
GPU: 10" shape=rectangle]
		ring_stage0_1_11 [label="Ring Stage 1
Compute: Q_11×K_10×V_10
GPU: 11" shape=rectangle]
		ring_stage0_1_12 [label="Ring Stage 1
Compute: Q_12×K_11×V_11
GPU: 12" shape=rectangle]
		ring_stage0_1_13 [label="Ring Stage 1
Compute: Q_13×K_12×V_12
GPU: 13" shape=rectangle]
		ring_stage0_1_14 [label="Ring Stage 1
Compute: Q_14×K_13×V_13
GPU: 14" shape=rectangle]
		ring_stage0_1_15 [label="Ring Stage 1
Compute: Q_15×K_14×V_14
GPU: 15" shape=rectangle]
		kv_send0_1_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_1_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_1_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_1_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_1_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_1_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_1_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_1_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_1_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_1_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_1_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_1_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_1_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_1_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_1_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_1_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_2_0 [label="Ring Stage 2
Compute: Q_0×K_14×V_14
GPU: 0" shape=rectangle]
		ring_stage0_2_1 [label="Ring Stage 2
Compute: Q_1×K_15×V_15
GPU: 1" shape=rectangle]
		ring_stage0_2_2 [label="Ring Stage 2
Compute: Q_2×K_0×V_0
GPU: 2" shape=rectangle]
		ring_stage0_2_3 [label="Ring Stage 2
Compute: Q_3×K_1×V_1
GPU: 3" shape=rectangle]
		ring_stage0_2_4 [label="Ring Stage 2
Compute: Q_4×K_2×V_2
GPU: 4" shape=rectangle]
		ring_stage0_2_5 [label="Ring Stage 2
Compute: Q_5×K_3×V_3
GPU: 5" shape=rectangle]
		ring_stage0_2_6 [label="Ring Stage 2
Compute: Q_6×K_4×V_4
GPU: 6" shape=rectangle]
		ring_stage0_2_7 [label="Ring Stage 2
Compute: Q_7×K_5×V_5
GPU: 7" shape=rectangle]
		ring_stage0_2_8 [label="Ring Stage 2
Compute: Q_8×K_6×V_6
GPU: 8" shape=rectangle]
		ring_stage0_2_9 [label="Ring Stage 2
Compute: Q_9×K_7×V_7
GPU: 9" shape=rectangle]
		ring_stage0_2_10 [label="Ring Stage 2
Compute: Q_10×K_8×V_8
GPU: 10" shape=rectangle]
		ring_stage0_2_11 [label="Ring Stage 2
Compute: Q_11×K_9×V_9
GPU: 11" shape=rectangle]
		ring_stage0_2_12 [label="Ring Stage 2
Compute: Q_12×K_10×V_10
GPU: 12" shape=rectangle]
		ring_stage0_2_13 [label="Ring Stage 2
Compute: Q_13×K_11×V_11
GPU: 13" shape=rectangle]
		ring_stage0_2_14 [label="Ring Stage 2
Compute: Q_14×K_12×V_12
GPU: 14" shape=rectangle]
		ring_stage0_2_15 [label="Ring Stage 2
Compute: Q_15×K_13×V_13
GPU: 15" shape=rectangle]
		kv_send0_2_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_2_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_2_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_2_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_2_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_2_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_2_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_2_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_2_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_2_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_2_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_2_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_2_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_2_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_2_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_2_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_3_0 [label="Ring Stage 3
Compute: Q_0×K_13×V_13
GPU: 0" shape=rectangle]
		ring_stage0_3_1 [label="Ring Stage 3
Compute: Q_1×K_14×V_14
GPU: 1" shape=rectangle]
		ring_stage0_3_2 [label="Ring Stage 3
Compute: Q_2×K_15×V_15
GPU: 2" shape=rectangle]
		ring_stage0_3_3 [label="Ring Stage 3
Compute: Q_3×K_0×V_0
GPU: 3" shape=rectangle]
		ring_stage0_3_4 [label="Ring Stage 3
Compute: Q_4×K_1×V_1
GPU: 4" shape=rectangle]
		ring_stage0_3_5 [label="Ring Stage 3
Compute: Q_5×K_2×V_2
GPU: 5" shape=rectangle]
		ring_stage0_3_6 [label="Ring Stage 3
Compute: Q_6×K_3×V_3
GPU: 6" shape=rectangle]
		ring_stage0_3_7 [label="Ring Stage 3
Compute: Q_7×K_4×V_4
GPU: 7" shape=rectangle]
		ring_stage0_3_8 [label="Ring Stage 3
Compute: Q_8×K_5×V_5
GPU: 8" shape=rectangle]
		ring_stage0_3_9 [label="Ring Stage 3
Compute: Q_9×K_6×V_6
GPU: 9" shape=rectangle]
		ring_stage0_3_10 [label="Ring Stage 3
Compute: Q_10×K_7×V_7
GPU: 10" shape=rectangle]
		ring_stage0_3_11 [label="Ring Stage 3
Compute: Q_11×K_8×V_8
GPU: 11" shape=rectangle]
		ring_stage0_3_12 [label="Ring Stage 3
Compute: Q_12×K_9×V_9
GPU: 12" shape=rectangle]
		ring_stage0_3_13 [label="Ring Stage 3
Compute: Q_13×K_10×V_10
GPU: 13" shape=rectangle]
		ring_stage0_3_14 [label="Ring Stage 3
Compute: Q_14×K_11×V_11
GPU: 14" shape=rectangle]
		ring_stage0_3_15 [label="Ring Stage 3
Compute: Q_15×K_12×V_12
GPU: 15" shape=rectangle]
		kv_send0_3_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_3_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_3_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_3_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_3_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_3_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_3_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_3_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_3_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_3_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_3_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_3_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_3_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_3_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_3_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_3_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_4_0 [label="Ring Stage 4
Compute: Q_0×K_12×V_12
GPU: 0" shape=rectangle]
		ring_stage0_4_1 [label="Ring Stage 4
Compute: Q_1×K_13×V_13
GPU: 1" shape=rectangle]
		ring_stage0_4_2 [label="Ring Stage 4
Compute: Q_2×K_14×V_14
GPU: 2" shape=rectangle]
		ring_stage0_4_3 [label="Ring Stage 4
Compute: Q_3×K_15×V_15
GPU: 3" shape=rectangle]
		ring_stage0_4_4 [label="Ring Stage 4
Compute: Q_4×K_0×V_0
GPU: 4" shape=rectangle]
		ring_stage0_4_5 [label="Ring Stage 4
Compute: Q_5×K_1×V_1
GPU: 5" shape=rectangle]
		ring_stage0_4_6 [label="Ring Stage 4
Compute: Q_6×K_2×V_2
GPU: 6" shape=rectangle]
		ring_stage0_4_7 [label="Ring Stage 4
Compute: Q_7×K_3×V_3
GPU: 7" shape=rectangle]
		ring_stage0_4_8 [label="Ring Stage 4
Compute: Q_8×K_4×V_4
GPU: 8" shape=rectangle]
		ring_stage0_4_9 [label="Ring Stage 4
Compute: Q_9×K_5×V_5
GPU: 9" shape=rectangle]
		ring_stage0_4_10 [label="Ring Stage 4
Compute: Q_10×K_6×V_6
GPU: 10" shape=rectangle]
		ring_stage0_4_11 [label="Ring Stage 4
Compute: Q_11×K_7×V_7
GPU: 11" shape=rectangle]
		ring_stage0_4_12 [label="Ring Stage 4
Compute: Q_12×K_8×V_8
GPU: 12" shape=rectangle]
		ring_stage0_4_13 [label="Ring Stage 4
Compute: Q_13×K_9×V_9
GPU: 13" shape=rectangle]
		ring_stage0_4_14 [label="Ring Stage 4
Compute: Q_14×K_10×V_10
GPU: 14" shape=rectangle]
		ring_stage0_4_15 [label="Ring Stage 4
Compute: Q_15×K_11×V_11
GPU: 15" shape=rectangle]
		kv_send0_4_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_4_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_4_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_4_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_4_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_4_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_4_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_4_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_4_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_4_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_4_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_4_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_4_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_4_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_4_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_4_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_5_0 [label="Ring Stage 5
Compute: Q_0×K_11×V_11
GPU: 0" shape=rectangle]
		ring_stage0_5_1 [label="Ring Stage 5
Compute: Q_1×K_12×V_12
GPU: 1" shape=rectangle]
		ring_stage0_5_2 [label="Ring Stage 5
Compute: Q_2×K_13×V_13
GPU: 2" shape=rectangle]
		ring_stage0_5_3 [label="Ring Stage 5
Compute: Q_3×K_14×V_14
GPU: 3" shape=rectangle]
		ring_stage0_5_4 [label="Ring Stage 5
Compute: Q_4×K_15×V_15
GPU: 4" shape=rectangle]
		ring_stage0_5_5 [label="Ring Stage 5
Compute: Q_5×K_0×V_0
GPU: 5" shape=rectangle]
		ring_stage0_5_6 [label="Ring Stage 5
Compute: Q_6×K_1×V_1
GPU: 6" shape=rectangle]
		ring_stage0_5_7 [label="Ring Stage 5
Compute: Q_7×K_2×V_2
GPU: 7" shape=rectangle]
		ring_stage0_5_8 [label="Ring Stage 5
Compute: Q_8×K_3×V_3
GPU: 8" shape=rectangle]
		ring_stage0_5_9 [label="Ring Stage 5
Compute: Q_9×K_4×V_4
GPU: 9" shape=rectangle]
		ring_stage0_5_10 [label="Ring Stage 5
Compute: Q_10×K_5×V_5
GPU: 10" shape=rectangle]
		ring_stage0_5_11 [label="Ring Stage 5
Compute: Q_11×K_6×V_6
GPU: 11" shape=rectangle]
		ring_stage0_5_12 [label="Ring Stage 5
Compute: Q_12×K_7×V_7
GPU: 12" shape=rectangle]
		ring_stage0_5_13 [label="Ring Stage 5
Compute: Q_13×K_8×V_8
GPU: 13" shape=rectangle]
		ring_stage0_5_14 [label="Ring Stage 5
Compute: Q_14×K_9×V_9
GPU: 14" shape=rectangle]
		ring_stage0_5_15 [label="Ring Stage 5
Compute: Q_15×K_10×V_10
GPU: 15" shape=rectangle]
		kv_send0_5_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_5_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_5_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_5_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_5_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_5_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_5_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_5_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_5_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_5_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_5_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_5_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_5_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_5_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_5_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_5_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_6_0 [label="Ring Stage 6
Compute: Q_0×K_10×V_10
GPU: 0" shape=rectangle]
		ring_stage0_6_1 [label="Ring Stage 6
Compute: Q_1×K_11×V_11
GPU: 1" shape=rectangle]
		ring_stage0_6_2 [label="Ring Stage 6
Compute: Q_2×K_12×V_12
GPU: 2" shape=rectangle]
		ring_stage0_6_3 [label="Ring Stage 6
Compute: Q_3×K_13×V_13
GPU: 3" shape=rectangle]
		ring_stage0_6_4 [label="Ring Stage 6
Compute: Q_4×K_14×V_14
GPU: 4" shape=rectangle]
		ring_stage0_6_5 [label="Ring Stage 6
Compute: Q_5×K_15×V_15
GPU: 5" shape=rectangle]
		ring_stage0_6_6 [label="Ring Stage 6
Compute: Q_6×K_0×V_0
GPU: 6" shape=rectangle]
		ring_stage0_6_7 [label="Ring Stage 6
Compute: Q_7×K_1×V_1
GPU: 7" shape=rectangle]
		ring_stage0_6_8 [label="Ring Stage 6
Compute: Q_8×K_2×V_2
GPU: 8" shape=rectangle]
		ring_stage0_6_9 [label="Ring Stage 6
Compute: Q_9×K_3×V_3
GPU: 9" shape=rectangle]
		ring_stage0_6_10 [label="Ring Stage 6
Compute: Q_10×K_4×V_4
GPU: 10" shape=rectangle]
		ring_stage0_6_11 [label="Ring Stage 6
Compute: Q_11×K_5×V_5
GPU: 11" shape=rectangle]
		ring_stage0_6_12 [label="Ring Stage 6
Compute: Q_12×K_6×V_6
GPU: 12" shape=rectangle]
		ring_stage0_6_13 [label="Ring Stage 6
Compute: Q_13×K_7×V_7
GPU: 13" shape=rectangle]
		ring_stage0_6_14 [label="Ring Stage 6
Compute: Q_14×K_8×V_8
GPU: 14" shape=rectangle]
		ring_stage0_6_15 [label="Ring Stage 6
Compute: Q_15×K_9×V_9
GPU: 15" shape=rectangle]
		kv_send0_6_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_6_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_6_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_6_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_6_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_6_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_6_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_6_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_6_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_6_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_6_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_6_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_6_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_6_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_6_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_6_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_7_0 [label="Ring Stage 7
Compute: Q_0×K_9×V_9
GPU: 0" shape=rectangle]
		ring_stage0_7_1 [label="Ring Stage 7
Compute: Q_1×K_10×V_10
GPU: 1" shape=rectangle]
		ring_stage0_7_2 [label="Ring Stage 7
Compute: Q_2×K_11×V_11
GPU: 2" shape=rectangle]
		ring_stage0_7_3 [label="Ring Stage 7
Compute: Q_3×K_12×V_12
GPU: 3" shape=rectangle]
		ring_stage0_7_4 [label="Ring Stage 7
Compute: Q_4×K_13×V_13
GPU: 4" shape=rectangle]
		ring_stage0_7_5 [label="Ring Stage 7
Compute: Q_5×K_14×V_14
GPU: 5" shape=rectangle]
		ring_stage0_7_6 [label="Ring Stage 7
Compute: Q_6×K_15×V_15
GPU: 6" shape=rectangle]
		ring_stage0_7_7 [label="Ring Stage 7
Compute: Q_7×K_0×V_0
GPU: 7" shape=rectangle]
		ring_stage0_7_8 [label="Ring Stage 7
Compute: Q_8×K_1×V_1
GPU: 8" shape=rectangle]
		ring_stage0_7_9 [label="Ring Stage 7
Compute: Q_9×K_2×V_2
GPU: 9" shape=rectangle]
		ring_stage0_7_10 [label="Ring Stage 7
Compute: Q_10×K_3×V_3
GPU: 10" shape=rectangle]
		ring_stage0_7_11 [label="Ring Stage 7
Compute: Q_11×K_4×V_4
GPU: 11" shape=rectangle]
		ring_stage0_7_12 [label="Ring Stage 7
Compute: Q_12×K_5×V_5
GPU: 12" shape=rectangle]
		ring_stage0_7_13 [label="Ring Stage 7
Compute: Q_13×K_6×V_6
GPU: 13" shape=rectangle]
		ring_stage0_7_14 [label="Ring Stage 7
Compute: Q_14×K_7×V_7
GPU: 14" shape=rectangle]
		ring_stage0_7_15 [label="Ring Stage 7
Compute: Q_15×K_8×V_8
GPU: 15" shape=rectangle]
		kv_send0_7_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_7_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_7_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_7_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_7_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_7_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_7_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_7_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_7_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_7_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_7_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_7_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_7_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_7_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_7_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_7_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_8_0 [label="Ring Stage 8
Compute: Q_0×K_8×V_8
GPU: 0" shape=rectangle]
		ring_stage0_8_1 [label="Ring Stage 8
Compute: Q_1×K_9×V_9
GPU: 1" shape=rectangle]
		ring_stage0_8_2 [label="Ring Stage 8
Compute: Q_2×K_10×V_10
GPU: 2" shape=rectangle]
		ring_stage0_8_3 [label="Ring Stage 8
Compute: Q_3×K_11×V_11
GPU: 3" shape=rectangle]
		ring_stage0_8_4 [label="Ring Stage 8
Compute: Q_4×K_12×V_12
GPU: 4" shape=rectangle]
		ring_stage0_8_5 [label="Ring Stage 8
Compute: Q_5×K_13×V_13
GPU: 5" shape=rectangle]
		ring_stage0_8_6 [label="Ring Stage 8
Compute: Q_6×K_14×V_14
GPU: 6" shape=rectangle]
		ring_stage0_8_7 [label="Ring Stage 8
Compute: Q_7×K_15×V_15
GPU: 7" shape=rectangle]
		ring_stage0_8_8 [label="Ring Stage 8
Compute: Q_8×K_0×V_0
GPU: 8" shape=rectangle]
		ring_stage0_8_9 [label="Ring Stage 8
Compute: Q_9×K_1×V_1
GPU: 9" shape=rectangle]
		ring_stage0_8_10 [label="Ring Stage 8
Compute: Q_10×K_2×V_2
GPU: 10" shape=rectangle]
		ring_stage0_8_11 [label="Ring Stage 8
Compute: Q_11×K_3×V_3
GPU: 11" shape=rectangle]
		ring_stage0_8_12 [label="Ring Stage 8
Compute: Q_12×K_4×V_4
GPU: 12" shape=rectangle]
		ring_stage0_8_13 [label="Ring Stage 8
Compute: Q_13×K_5×V_5
GPU: 13" shape=rectangle]
		ring_stage0_8_14 [label="Ring Stage 8
Compute: Q_14×K_6×V_6
GPU: 14" shape=rectangle]
		ring_stage0_8_15 [label="Ring Stage 8
Compute: Q_15×K_7×V_7
GPU: 15" shape=rectangle]
		kv_send0_8_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_8_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_8_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_8_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_8_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_8_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_8_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_8_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_8_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_8_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_8_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_8_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_8_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_8_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_8_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_8_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_9_0 [label="Ring Stage 9
Compute: Q_0×K_7×V_7
GPU: 0" shape=rectangle]
		ring_stage0_9_1 [label="Ring Stage 9
Compute: Q_1×K_8×V_8
GPU: 1" shape=rectangle]
		ring_stage0_9_2 [label="Ring Stage 9
Compute: Q_2×K_9×V_9
GPU: 2" shape=rectangle]
		ring_stage0_9_3 [label="Ring Stage 9
Compute: Q_3×K_10×V_10
GPU: 3" shape=rectangle]
		ring_stage0_9_4 [label="Ring Stage 9
Compute: Q_4×K_11×V_11
GPU: 4" shape=rectangle]
		ring_stage0_9_5 [label="Ring Stage 9
Compute: Q_5×K_12×V_12
GPU: 5" shape=rectangle]
		ring_stage0_9_6 [label="Ring Stage 9
Compute: Q_6×K_13×V_13
GPU: 6" shape=rectangle]
		ring_stage0_9_7 [label="Ring Stage 9
Compute: Q_7×K_14×V_14
GPU: 7" shape=rectangle]
		ring_stage0_9_8 [label="Ring Stage 9
Compute: Q_8×K_15×V_15
GPU: 8" shape=rectangle]
		ring_stage0_9_9 [label="Ring Stage 9
Compute: Q_9×K_0×V_0
GPU: 9" shape=rectangle]
		ring_stage0_9_10 [label="Ring Stage 9
Compute: Q_10×K_1×V_1
GPU: 10" shape=rectangle]
		ring_stage0_9_11 [label="Ring Stage 9
Compute: Q_11×K_2×V_2
GPU: 11" shape=rectangle]
		ring_stage0_9_12 [label="Ring Stage 9
Compute: Q_12×K_3×V_3
GPU: 12" shape=rectangle]
		ring_stage0_9_13 [label="Ring Stage 9
Compute: Q_13×K_4×V_4
GPU: 13" shape=rectangle]
		ring_stage0_9_14 [label="Ring Stage 9
Compute: Q_14×K_5×V_5
GPU: 14" shape=rectangle]
		ring_stage0_9_15 [label="Ring Stage 9
Compute: Q_15×K_6×V_6
GPU: 15" shape=rectangle]
		kv_send0_9_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_9_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_9_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_9_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_9_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_9_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_9_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_9_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_9_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_9_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_9_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_9_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_9_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_9_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_9_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_9_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_10_0 [label="Ring Stage 10
Compute: Q_0×K_6×V_6
GPU: 0" shape=rectangle]
		ring_stage0_10_1 [label="Ring Stage 10
Compute: Q_1×K_7×V_7
GPU: 1" shape=rectangle]
		ring_stage0_10_2 [label="Ring Stage 10
Compute: Q_2×K_8×V_8
GPU: 2" shape=rectangle]
		ring_stage0_10_3 [label="Ring Stage 10
Compute: Q_3×K_9×V_9
GPU: 3" shape=rectangle]
		ring_stage0_10_4 [label="Ring Stage 10
Compute: Q_4×K_10×V_10
GPU: 4" shape=rectangle]
		ring_stage0_10_5 [label="Ring Stage 10
Compute: Q_5×K_11×V_11
GPU: 5" shape=rectangle]
		ring_stage0_10_6 [label="Ring Stage 10
Compute: Q_6×K_12×V_12
GPU: 6" shape=rectangle]
		ring_stage0_10_7 [label="Ring Stage 10
Compute: Q_7×K_13×V_13
GPU: 7" shape=rectangle]
		ring_stage0_10_8 [label="Ring Stage 10
Compute: Q_8×K_14×V_14
GPU: 8" shape=rectangle]
		ring_stage0_10_9 [label="Ring Stage 10
Compute: Q_9×K_15×V_15
GPU: 9" shape=rectangle]
		ring_stage0_10_10 [label="Ring Stage 10
Compute: Q_10×K_0×V_0
GPU: 10" shape=rectangle]
		ring_stage0_10_11 [label="Ring Stage 10
Compute: Q_11×K_1×V_1
GPU: 11" shape=rectangle]
		ring_stage0_10_12 [label="Ring Stage 10
Compute: Q_12×K_2×V_2
GPU: 12" shape=rectangle]
		ring_stage0_10_13 [label="Ring Stage 10
Compute: Q_13×K_3×V_3
GPU: 13" shape=rectangle]
		ring_stage0_10_14 [label="Ring Stage 10
Compute: Q_14×K_4×V_4
GPU: 14" shape=rectangle]
		ring_stage0_10_15 [label="Ring Stage 10
Compute: Q_15×K_5×V_5
GPU: 15" shape=rectangle]
		kv_send0_10_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_10_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_10_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_10_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_10_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_10_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_10_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_10_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_10_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_10_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_10_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_10_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_10_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_10_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_10_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_10_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_11_0 [label="Ring Stage 11
Compute: Q_0×K_5×V_5
GPU: 0" shape=rectangle]
		ring_stage0_11_1 [label="Ring Stage 11
Compute: Q_1×K_6×V_6
GPU: 1" shape=rectangle]
		ring_stage0_11_2 [label="Ring Stage 11
Compute: Q_2×K_7×V_7
GPU: 2" shape=rectangle]
		ring_stage0_11_3 [label="Ring Stage 11
Compute: Q_3×K_8×V_8
GPU: 3" shape=rectangle]
		ring_stage0_11_4 [label="Ring Stage 11
Compute: Q_4×K_9×V_9
GPU: 4" shape=rectangle]
		ring_stage0_11_5 [label="Ring Stage 11
Compute: Q_5×K_10×V_10
GPU: 5" shape=rectangle]
		ring_stage0_11_6 [label="Ring Stage 11
Compute: Q_6×K_11×V_11
GPU: 6" shape=rectangle]
		ring_stage0_11_7 [label="Ring Stage 11
Compute: Q_7×K_12×V_12
GPU: 7" shape=rectangle]
		ring_stage0_11_8 [label="Ring Stage 11
Compute: Q_8×K_13×V_13
GPU: 8" shape=rectangle]
		ring_stage0_11_9 [label="Ring Stage 11
Compute: Q_9×K_14×V_14
GPU: 9" shape=rectangle]
		ring_stage0_11_10 [label="Ring Stage 11
Compute: Q_10×K_15×V_15
GPU: 10" shape=rectangle]
		ring_stage0_11_11 [label="Ring Stage 11
Compute: Q_11×K_0×V_0
GPU: 11" shape=rectangle]
		ring_stage0_11_12 [label="Ring Stage 11
Compute: Q_12×K_1×V_1
GPU: 12" shape=rectangle]
		ring_stage0_11_13 [label="Ring Stage 11
Compute: Q_13×K_2×V_2
GPU: 13" shape=rectangle]
		ring_stage0_11_14 [label="Ring Stage 11
Compute: Q_14×K_3×V_3
GPU: 14" shape=rectangle]
		ring_stage0_11_15 [label="Ring Stage 11
Compute: Q_15×K_4×V_4
GPU: 15" shape=rectangle]
		kv_send0_11_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_11_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_11_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_11_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_11_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_11_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_11_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_11_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_11_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_11_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_11_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_11_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_11_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_11_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_11_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_11_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_12_0 [label="Ring Stage 12
Compute: Q_0×K_4×V_4
GPU: 0" shape=rectangle]
		ring_stage0_12_1 [label="Ring Stage 12
Compute: Q_1×K_5×V_5
GPU: 1" shape=rectangle]
		ring_stage0_12_2 [label="Ring Stage 12
Compute: Q_2×K_6×V_6
GPU: 2" shape=rectangle]
		ring_stage0_12_3 [label="Ring Stage 12
Compute: Q_3×K_7×V_7
GPU: 3" shape=rectangle]
		ring_stage0_12_4 [label="Ring Stage 12
Compute: Q_4×K_8×V_8
GPU: 4" shape=rectangle]
		ring_stage0_12_5 [label="Ring Stage 12
Compute: Q_5×K_9×V_9
GPU: 5" shape=rectangle]
		ring_stage0_12_6 [label="Ring Stage 12
Compute: Q_6×K_10×V_10
GPU: 6" shape=rectangle]
		ring_stage0_12_7 [label="Ring Stage 12
Compute: Q_7×K_11×V_11
GPU: 7" shape=rectangle]
		ring_stage0_12_8 [label="Ring Stage 12
Compute: Q_8×K_12×V_12
GPU: 8" shape=rectangle]
		ring_stage0_12_9 [label="Ring Stage 12
Compute: Q_9×K_13×V_13
GPU: 9" shape=rectangle]
		ring_stage0_12_10 [label="Ring Stage 12
Compute: Q_10×K_14×V_14
GPU: 10" shape=rectangle]
		ring_stage0_12_11 [label="Ring Stage 12
Compute: Q_11×K_15×V_15
GPU: 11" shape=rectangle]
		ring_stage0_12_12 [label="Ring Stage 12
Compute: Q_12×K_0×V_0
GPU: 12" shape=rectangle]
		ring_stage0_12_13 [label="Ring Stage 12
Compute: Q_13×K_1×V_1
GPU: 13" shape=rectangle]
		ring_stage0_12_14 [label="Ring Stage 12
Compute: Q_14×K_2×V_2
GPU: 14" shape=rectangle]
		ring_stage0_12_15 [label="Ring Stage 12
Compute: Q_15×K_3×V_3
GPU: 15" shape=rectangle]
		kv_send0_12_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_12_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_12_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_12_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_12_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_12_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_12_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_12_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_12_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_12_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_12_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_12_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_12_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_12_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_12_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_12_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_13_0 [label="Ring Stage 13
Compute: Q_0×K_3×V_3
GPU: 0" shape=rectangle]
		ring_stage0_13_1 [label="Ring Stage 13
Compute: Q_1×K_4×V_4
GPU: 1" shape=rectangle]
		ring_stage0_13_2 [label="Ring Stage 13
Compute: Q_2×K_5×V_5
GPU: 2" shape=rectangle]
		ring_stage0_13_3 [label="Ring Stage 13
Compute: Q_3×K_6×V_6
GPU: 3" shape=rectangle]
		ring_stage0_13_4 [label="Ring Stage 13
Compute: Q_4×K_7×V_7
GPU: 4" shape=rectangle]
		ring_stage0_13_5 [label="Ring Stage 13
Compute: Q_5×K_8×V_8
GPU: 5" shape=rectangle]
		ring_stage0_13_6 [label="Ring Stage 13
Compute: Q_6×K_9×V_9
GPU: 6" shape=rectangle]
		ring_stage0_13_7 [label="Ring Stage 13
Compute: Q_7×K_10×V_10
GPU: 7" shape=rectangle]
		ring_stage0_13_8 [label="Ring Stage 13
Compute: Q_8×K_11×V_11
GPU: 8" shape=rectangle]
		ring_stage0_13_9 [label="Ring Stage 13
Compute: Q_9×K_12×V_12
GPU: 9" shape=rectangle]
		ring_stage0_13_10 [label="Ring Stage 13
Compute: Q_10×K_13×V_13
GPU: 10" shape=rectangle]
		ring_stage0_13_11 [label="Ring Stage 13
Compute: Q_11×K_14×V_14
GPU: 11" shape=rectangle]
		ring_stage0_13_12 [label="Ring Stage 13
Compute: Q_12×K_15×V_15
GPU: 12" shape=rectangle]
		ring_stage0_13_13 [label="Ring Stage 13
Compute: Q_13×K_0×V_0
GPU: 13" shape=rectangle]
		ring_stage0_13_14 [label="Ring Stage 13
Compute: Q_14×K_1×V_1
GPU: 14" shape=rectangle]
		ring_stage0_13_15 [label="Ring Stage 13
Compute: Q_15×K_2×V_2
GPU: 15" shape=rectangle]
		kv_send0_13_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_13_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_13_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_13_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_13_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_13_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_13_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_13_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_13_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_13_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_13_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_13_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_13_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_13_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_13_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_13_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_14_0 [label="Ring Stage 14
Compute: Q_0×K_2×V_2
GPU: 0" shape=rectangle]
		ring_stage0_14_1 [label="Ring Stage 14
Compute: Q_1×K_3×V_3
GPU: 1" shape=rectangle]
		ring_stage0_14_2 [label="Ring Stage 14
Compute: Q_2×K_4×V_4
GPU: 2" shape=rectangle]
		ring_stage0_14_3 [label="Ring Stage 14
Compute: Q_3×K_5×V_5
GPU: 3" shape=rectangle]
		ring_stage0_14_4 [label="Ring Stage 14
Compute: Q_4×K_6×V_6
GPU: 4" shape=rectangle]
		ring_stage0_14_5 [label="Ring Stage 14
Compute: Q_5×K_7×V_7
GPU: 5" shape=rectangle]
		ring_stage0_14_6 [label="Ring Stage 14
Compute: Q_6×K_8×V_8
GPU: 6" shape=rectangle]
		ring_stage0_14_7 [label="Ring Stage 14
Compute: Q_7×K_9×V_9
GPU: 7" shape=rectangle]
		ring_stage0_14_8 [label="Ring Stage 14
Compute: Q_8×K_10×V_10
GPU: 8" shape=rectangle]
		ring_stage0_14_9 [label="Ring Stage 14
Compute: Q_9×K_11×V_11
GPU: 9" shape=rectangle]
		ring_stage0_14_10 [label="Ring Stage 14
Compute: Q_10×K_12×V_12
GPU: 10" shape=rectangle]
		ring_stage0_14_11 [label="Ring Stage 14
Compute: Q_11×K_13×V_13
GPU: 11" shape=rectangle]
		ring_stage0_14_12 [label="Ring Stage 14
Compute: Q_12×K_14×V_14
GPU: 12" shape=rectangle]
		ring_stage0_14_13 [label="Ring Stage 14
Compute: Q_13×K_15×V_15
GPU: 13" shape=rectangle]
		ring_stage0_14_14 [label="Ring Stage 14
Compute: Q_14×K_0×V_0
GPU: 14" shape=rectangle]
		ring_stage0_14_15 [label="Ring Stage 14
Compute: Q_15×K_1×V_1
GPU: 15" shape=rectangle]
		kv_send0_14_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_14_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_14_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_14_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_14_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_14_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_14_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_14_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_14_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_14_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_14_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_14_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_14_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_14_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_14_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_14_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage0_15_0 [label="Ring Stage 15
Compute: Q_0×K_1×V_1
GPU: 0" shape=rectangle]
		ring_stage0_15_1 [label="Ring Stage 15
Compute: Q_1×K_2×V_2
GPU: 1" shape=rectangle]
		ring_stage0_15_2 [label="Ring Stage 15
Compute: Q_2×K_3×V_3
GPU: 2" shape=rectangle]
		ring_stage0_15_3 [label="Ring Stage 15
Compute: Q_3×K_4×V_4
GPU: 3" shape=rectangle]
		ring_stage0_15_4 [label="Ring Stage 15
Compute: Q_4×K_5×V_5
GPU: 4" shape=rectangle]
		ring_stage0_15_5 [label="Ring Stage 15
Compute: Q_5×K_6×V_6
GPU: 5" shape=rectangle]
		ring_stage0_15_6 [label="Ring Stage 15
Compute: Q_6×K_7×V_7
GPU: 6" shape=rectangle]
		ring_stage0_15_7 [label="Ring Stage 15
Compute: Q_7×K_8×V_8
GPU: 7" shape=rectangle]
		ring_stage0_15_8 [label="Ring Stage 15
Compute: Q_8×K_9×V_9
GPU: 8" shape=rectangle]
		ring_stage0_15_9 [label="Ring Stage 15
Compute: Q_9×K_10×V_10
GPU: 9" shape=rectangle]
		ring_stage0_15_10 [label="Ring Stage 15
Compute: Q_10×K_11×V_11
GPU: 10" shape=rectangle]
		ring_stage0_15_11 [label="Ring Stage 15
Compute: Q_11×K_12×V_12
GPU: 11" shape=rectangle]
		ring_stage0_15_12 [label="Ring Stage 15
Compute: Q_12×K_13×V_13
GPU: 12" shape=rectangle]
		ring_stage0_15_13 [label="Ring Stage 15
Compute: Q_13×K_14×V_14
GPU: 13" shape=rectangle]
		ring_stage0_15_14 [label="Ring Stage 15
Compute: Q_14×K_15×V_15
GPU: 14" shape=rectangle]
		ring_stage0_15_15 [label="Ring Stage 15
Compute: Q_15×K_0×V_0
GPU: 15" shape=rectangle]
		kv_send0_15_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send0_15_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send0_15_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send0_15_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send0_15_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send0_15_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send0_15_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send0_15_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send0_15_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send0_15_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send0_15_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send0_15_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send0_15_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send0_15_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send0_15_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send0_15_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		accum0_0 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		accum0_1 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		accum0_2 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		accum0_3 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		accum0_4 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		accum0_5 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		accum0_6 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		accum0_7 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		accum0_8 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		accum0_9 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		accum0_10 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		accum0_11 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		accum0_12 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		accum0_13 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		accum0_14 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		accum0_15 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		out_proj0_0 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		out_proj0_1 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		out_proj0_2 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		out_proj0_3 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		out_proj0_4 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		out_proj0_5 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		out_proj0_6 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		out_proj0_7 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		out_proj0_8 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		out_proj0_9 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		out_proj0_10 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		out_proj0_11 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		out_proj0_12 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		out_proj0_13 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		out_proj0_14 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		out_proj0_15 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
	}
	subgraph cluster_moe0 {
		label="Mixture of Experts"
		gate0_0 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 0" shape=diamond]
		gate0_1 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 1" shape=diamond]
		gate0_2 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 2" shape=diamond]
		gate0_3 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 3" shape=diamond]
		gate0_4 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 4" shape=diamond]
		gate0_5 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 5" shape=diamond]
		gate0_6 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 6" shape=diamond]
		gate0_7 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 7" shape=diamond]
		gate0_8 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 8" shape=diamond]
		gate0_9 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 9" shape=diamond]
		gate0_10 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 10" shape=diamond]
		gate0_11 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 11" shape=diamond]
		gate0_12 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 12" shape=diamond]
		gate0_13 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 13" shape=diamond]
		gate0_14 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 14" shape=diamond]
		gate0_15 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 15" shape=diamond]
		select0_0 [label="Select Top-2 Experts
GPU: 0" shape=parallelogram]
		select0_1 [label="Select Top-2 Experts
GPU: 1" shape=parallelogram]
		select0_2 [label="Select Top-2 Experts
GPU: 2" shape=parallelogram]
		select0_3 [label="Select Top-2 Experts
GPU: 3" shape=parallelogram]
		select0_4 [label="Select Top-2 Experts
GPU: 4" shape=parallelogram]
		select0_5 [label="Select Top-2 Experts
GPU: 5" shape=parallelogram]
		select0_6 [label="Select Top-2 Experts
GPU: 6" shape=parallelogram]
		select0_7 [label="Select Top-2 Experts
GPU: 7" shape=parallelogram]
		select0_8 [label="Select Top-2 Experts
GPU: 8" shape=parallelogram]
		select0_9 [label="Select Top-2 Experts
GPU: 9" shape=parallelogram]
		select0_10 [label="Select Top-2 Experts
GPU: 10" shape=parallelogram]
		select0_11 [label="Select Top-2 Experts
GPU: 11" shape=parallelogram]
		select0_12 [label="Select Top-2 Experts
GPU: 12" shape=parallelogram]
		select0_13 [label="Select Top-2 Experts
GPU: 13" shape=parallelogram]
		select0_14 [label="Select Top-2 Experts
GPU: 14" shape=parallelogram]
		select0_15 [label="Select Top-2 Experts
GPU: 15" shape=parallelogram]
		expert0_0_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_0 [label="Expert 0 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_1 [label="Expert 1 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_2 [label="Expert 2 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_3 [label="Expert 3 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_4 [label="Expert 4 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_5 [label="Expert 5 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_6 [label="Expert 6 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_0_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act0_0_7 [label="Expert 7 GELU
GPU: 0" shape=rectangle]
		expert_out0_0_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert0_1_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_0 [label="Expert 0 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_1 [label="Expert 1 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_2 [label="Expert 2 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_3 [label="Expert 3 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_4 [label="Expert 4 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_5 [label="Expert 5 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_6 [label="Expert 6 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_1_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act0_1_7 [label="Expert 7 GELU
GPU: 1" shape=rectangle]
		expert_out0_1_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert0_2_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_0 [label="Expert 0 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_1 [label="Expert 1 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_2 [label="Expert 2 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_3 [label="Expert 3 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_4 [label="Expert 4 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_5 [label="Expert 5 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_6 [label="Expert 6 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_2_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act0_2_7 [label="Expert 7 GELU
GPU: 2" shape=rectangle]
		expert_out0_2_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert0_3_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_0 [label="Expert 0 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_1 [label="Expert 1 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_2 [label="Expert 2 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_3 [label="Expert 3 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_4 [label="Expert 4 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_5 [label="Expert 5 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_6 [label="Expert 6 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_3_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act0_3_7 [label="Expert 7 GELU
GPU: 3" shape=rectangle]
		expert_out0_3_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert0_4_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_0 [label="Expert 0 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_1 [label="Expert 1 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_2 [label="Expert 2 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_3 [label="Expert 3 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_4 [label="Expert 4 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_5 [label="Expert 5 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_6 [label="Expert 6 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_4_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act0_4_7 [label="Expert 7 GELU
GPU: 4" shape=rectangle]
		expert_out0_4_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert0_5_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_0 [label="Expert 0 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_1 [label="Expert 1 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_2 [label="Expert 2 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_3 [label="Expert 3 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_4 [label="Expert 4 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_5 [label="Expert 5 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_6 [label="Expert 6 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_5_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act0_5_7 [label="Expert 7 GELU
GPU: 5" shape=rectangle]
		expert_out0_5_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert0_6_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_0 [label="Expert 0 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_1 [label="Expert 1 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_2 [label="Expert 2 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_3 [label="Expert 3 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_4 [label="Expert 4 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_5 [label="Expert 5 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_6 [label="Expert 6 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_6_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act0_6_7 [label="Expert 7 GELU
GPU: 6" shape=rectangle]
		expert_out0_6_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert0_7_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_0 [label="Expert 0 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_1 [label="Expert 1 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_2 [label="Expert 2 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_3 [label="Expert 3 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_4 [label="Expert 4 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_5 [label="Expert 5 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_6 [label="Expert 6 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_7_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act0_7_7 [label="Expert 7 GELU
GPU: 7" shape=rectangle]
		expert_out0_7_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert0_8_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_0 [label="Expert 0 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_1 [label="Expert 1 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_2 [label="Expert 2 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_3 [label="Expert 3 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_4 [label="Expert 4 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_5 [label="Expert 5 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_6 [label="Expert 6 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_8_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act0_8_7 [label="Expert 7 GELU
GPU: 8" shape=rectangle]
		expert_out0_8_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert0_9_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_0 [label="Expert 0 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_1 [label="Expert 1 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_2 [label="Expert 2 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_3 [label="Expert 3 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_4 [label="Expert 4 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_5 [label="Expert 5 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_6 [label="Expert 6 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_9_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act0_9_7 [label="Expert 7 GELU
GPU: 9" shape=rectangle]
		expert_out0_9_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert0_10_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_0 [label="Expert 0 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_1 [label="Expert 1 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_2 [label="Expert 2 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_3 [label="Expert 3 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_4 [label="Expert 4 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_5 [label="Expert 5 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_6 [label="Expert 6 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_10_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act0_10_7 [label="Expert 7 GELU
GPU: 10" shape=rectangle]
		expert_out0_10_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert0_11_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_0 [label="Expert 0 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_1 [label="Expert 1 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_2 [label="Expert 2 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_3 [label="Expert 3 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_4 [label="Expert 4 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_5 [label="Expert 5 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_6 [label="Expert 6 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_11_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act0_11_7 [label="Expert 7 GELU
GPU: 11" shape=rectangle]
		expert_out0_11_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert0_12_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_0 [label="Expert 0 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_1 [label="Expert 1 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_2 [label="Expert 2 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_3 [label="Expert 3 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_4 [label="Expert 4 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_5 [label="Expert 5 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_6 [label="Expert 6 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_12_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act0_12_7 [label="Expert 7 GELU
GPU: 12" shape=rectangle]
		expert_out0_12_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert0_13_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_0 [label="Expert 0 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_1 [label="Expert 1 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_2 [label="Expert 2 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_3 [label="Expert 3 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_4 [label="Expert 4 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_5 [label="Expert 5 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_6 [label="Expert 6 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_13_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act0_13_7 [label="Expert 7 GELU
GPU: 13" shape=rectangle]
		expert_out0_13_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert0_14_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_0 [label="Expert 0 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_1 [label="Expert 1 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_2 [label="Expert 2 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_3 [label="Expert 3 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_4 [label="Expert 4 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_5 [label="Expert 5 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_6 [label="Expert 6 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_14_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act0_14_7 [label="Expert 7 GELU
GPU: 14" shape=rectangle]
		expert_out0_14_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert0_15_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_0 [label="Expert 0 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_1 [label="Expert 1 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_2 [label="Expert 2 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_3 [label="Expert 3 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_4 [label="Expert 4 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_5 [label="Expert 5 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_6 [label="Expert 6 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert0_15_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act0_15_7 [label="Expert 7 GELU
GPU: 15" shape=rectangle]
		expert_out0_15_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		combine0_0 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 0" shape=parallelogram]
		combine0_1 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 1" shape=parallelogram]
		combine0_2 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 2" shape=parallelogram]
		combine0_3 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 3" shape=parallelogram]
		combine0_4 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 4" shape=parallelogram]
		combine0_5 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 5" shape=parallelogram]
		combine0_6 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 6" shape=parallelogram]
		combine0_7 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 7" shape=parallelogram]
		combine0_8 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 8" shape=parallelogram]
		combine0_9 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 9" shape=parallelogram]
		combine0_10 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 10" shape=parallelogram]
		combine0_11 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 11" shape=parallelogram]
		combine0_12 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 12" shape=parallelogram]
		combine0_13 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 13" shape=parallelogram]
		combine0_14 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 14" shape=parallelogram]
		combine0_15 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_layer0 {
		label="Layer 0"
		res_attn0_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_attn0_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_attn0_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_attn0_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_attn0_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_attn0_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_attn0_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_attn0_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_attn0_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_attn0_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_attn0_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_attn0_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_attn0_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_attn0_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_attn0_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_attn0_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		res_moe0_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_moe0_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_moe0_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_moe0_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_moe0_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_moe0_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_moe0_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_moe0_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_moe0_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_moe0_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_moe0_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_moe0_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_moe0_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_moe0_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_moe0_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_moe0_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_ra_sp1 {
		label="Ring Attention + Sequence Parallel"
		qkv1_0 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		qkv1_1 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		qkv1_2 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		qkv1_3 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		qkv1_4 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		qkv1_5 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		qkv1_6 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		qkv1_7 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		qkv1_8 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		qkv1_9 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		qkv1_10 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		qkv1_11 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		qkv1_12 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		qkv1_13 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		qkv1_14 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		qkv1_15 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		ring_stage1_0_0 [label="Ring Stage 0
Compute: Q_0×K_0×V_0
GPU: 0" shape=rectangle]
		ring_stage1_0_1 [label="Ring Stage 0
Compute: Q_1×K_1×V_1
GPU: 1" shape=rectangle]
		ring_stage1_0_2 [label="Ring Stage 0
Compute: Q_2×K_2×V_2
GPU: 2" shape=rectangle]
		ring_stage1_0_3 [label="Ring Stage 0
Compute: Q_3×K_3×V_3
GPU: 3" shape=rectangle]
		ring_stage1_0_4 [label="Ring Stage 0
Compute: Q_4×K_4×V_4
GPU: 4" shape=rectangle]
		ring_stage1_0_5 [label="Ring Stage 0
Compute: Q_5×K_5×V_5
GPU: 5" shape=rectangle]
		ring_stage1_0_6 [label="Ring Stage 0
Compute: Q_6×K_6×V_6
GPU: 6" shape=rectangle]
		ring_stage1_0_7 [label="Ring Stage 0
Compute: Q_7×K_7×V_7
GPU: 7" shape=rectangle]
		ring_stage1_0_8 [label="Ring Stage 0
Compute: Q_8×K_8×V_8
GPU: 8" shape=rectangle]
		ring_stage1_0_9 [label="Ring Stage 0
Compute: Q_9×K_9×V_9
GPU: 9" shape=rectangle]
		ring_stage1_0_10 [label="Ring Stage 0
Compute: Q_10×K_10×V_10
GPU: 10" shape=rectangle]
		ring_stage1_0_11 [label="Ring Stage 0
Compute: Q_11×K_11×V_11
GPU: 11" shape=rectangle]
		ring_stage1_0_12 [label="Ring Stage 0
Compute: Q_12×K_12×V_12
GPU: 12" shape=rectangle]
		ring_stage1_0_13 [label="Ring Stage 0
Compute: Q_13×K_13×V_13
GPU: 13" shape=rectangle]
		ring_stage1_0_14 [label="Ring Stage 0
Compute: Q_14×K_14×V_14
GPU: 14" shape=rectangle]
		ring_stage1_0_15 [label="Ring Stage 0
Compute: Q_15×K_15×V_15
GPU: 15" shape=rectangle]
		kv_send1_0_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_0_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_0_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_0_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_0_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_0_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_0_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_0_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_0_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_0_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_0_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_0_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_0_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_0_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_0_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_0_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_1_0 [label="Ring Stage 1
Compute: Q_0×K_15×V_15
GPU: 0" shape=rectangle]
		ring_stage1_1_1 [label="Ring Stage 1
Compute: Q_1×K_0×V_0
GPU: 1" shape=rectangle]
		ring_stage1_1_2 [label="Ring Stage 1
Compute: Q_2×K_1×V_1
GPU: 2" shape=rectangle]
		ring_stage1_1_3 [label="Ring Stage 1
Compute: Q_3×K_2×V_2
GPU: 3" shape=rectangle]
		ring_stage1_1_4 [label="Ring Stage 1
Compute: Q_4×K_3×V_3
GPU: 4" shape=rectangle]
		ring_stage1_1_5 [label="Ring Stage 1
Compute: Q_5×K_4×V_4
GPU: 5" shape=rectangle]
		ring_stage1_1_6 [label="Ring Stage 1
Compute: Q_6×K_5×V_5
GPU: 6" shape=rectangle]
		ring_stage1_1_7 [label="Ring Stage 1
Compute: Q_7×K_6×V_6
GPU: 7" shape=rectangle]
		ring_stage1_1_8 [label="Ring Stage 1
Compute: Q_8×K_7×V_7
GPU: 8" shape=rectangle]
		ring_stage1_1_9 [label="Ring Stage 1
Compute: Q_9×K_8×V_8
GPU: 9" shape=rectangle]
		ring_stage1_1_10 [label="Ring Stage 1
Compute: Q_10×K_9×V_9
GPU: 10" shape=rectangle]
		ring_stage1_1_11 [label="Ring Stage 1
Compute: Q_11×K_10×V_10
GPU: 11" shape=rectangle]
		ring_stage1_1_12 [label="Ring Stage 1
Compute: Q_12×K_11×V_11
GPU: 12" shape=rectangle]
		ring_stage1_1_13 [label="Ring Stage 1
Compute: Q_13×K_12×V_12
GPU: 13" shape=rectangle]
		ring_stage1_1_14 [label="Ring Stage 1
Compute: Q_14×K_13×V_13
GPU: 14" shape=rectangle]
		ring_stage1_1_15 [label="Ring Stage 1
Compute: Q_15×K_14×V_14
GPU: 15" shape=rectangle]
		kv_send1_1_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_1_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_1_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_1_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_1_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_1_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_1_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_1_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_1_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_1_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_1_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_1_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_1_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_1_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_1_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_1_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_2_0 [label="Ring Stage 2
Compute: Q_0×K_14×V_14
GPU: 0" shape=rectangle]
		ring_stage1_2_1 [label="Ring Stage 2
Compute: Q_1×K_15×V_15
GPU: 1" shape=rectangle]
		ring_stage1_2_2 [label="Ring Stage 2
Compute: Q_2×K_0×V_0
GPU: 2" shape=rectangle]
		ring_stage1_2_3 [label="Ring Stage 2
Compute: Q_3×K_1×V_1
GPU: 3" shape=rectangle]
		ring_stage1_2_4 [label="Ring Stage 2
Compute: Q_4×K_2×V_2
GPU: 4" shape=rectangle]
		ring_stage1_2_5 [label="Ring Stage 2
Compute: Q_5×K_3×V_3
GPU: 5" shape=rectangle]
		ring_stage1_2_6 [label="Ring Stage 2
Compute: Q_6×K_4×V_4
GPU: 6" shape=rectangle]
		ring_stage1_2_7 [label="Ring Stage 2
Compute: Q_7×K_5×V_5
GPU: 7" shape=rectangle]
		ring_stage1_2_8 [label="Ring Stage 2
Compute: Q_8×K_6×V_6
GPU: 8" shape=rectangle]
		ring_stage1_2_9 [label="Ring Stage 2
Compute: Q_9×K_7×V_7
GPU: 9" shape=rectangle]
		ring_stage1_2_10 [label="Ring Stage 2
Compute: Q_10×K_8×V_8
GPU: 10" shape=rectangle]
		ring_stage1_2_11 [label="Ring Stage 2
Compute: Q_11×K_9×V_9
GPU: 11" shape=rectangle]
		ring_stage1_2_12 [label="Ring Stage 2
Compute: Q_12×K_10×V_10
GPU: 12" shape=rectangle]
		ring_stage1_2_13 [label="Ring Stage 2
Compute: Q_13×K_11×V_11
GPU: 13" shape=rectangle]
		ring_stage1_2_14 [label="Ring Stage 2
Compute: Q_14×K_12×V_12
GPU: 14" shape=rectangle]
		ring_stage1_2_15 [label="Ring Stage 2
Compute: Q_15×K_13×V_13
GPU: 15" shape=rectangle]
		kv_send1_2_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_2_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_2_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_2_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_2_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_2_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_2_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_2_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_2_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_2_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_2_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_2_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_2_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_2_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_2_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_2_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_3_0 [label="Ring Stage 3
Compute: Q_0×K_13×V_13
GPU: 0" shape=rectangle]
		ring_stage1_3_1 [label="Ring Stage 3
Compute: Q_1×K_14×V_14
GPU: 1" shape=rectangle]
		ring_stage1_3_2 [label="Ring Stage 3
Compute: Q_2×K_15×V_15
GPU: 2" shape=rectangle]
		ring_stage1_3_3 [label="Ring Stage 3
Compute: Q_3×K_0×V_0
GPU: 3" shape=rectangle]
		ring_stage1_3_4 [label="Ring Stage 3
Compute: Q_4×K_1×V_1
GPU: 4" shape=rectangle]
		ring_stage1_3_5 [label="Ring Stage 3
Compute: Q_5×K_2×V_2
GPU: 5" shape=rectangle]
		ring_stage1_3_6 [label="Ring Stage 3
Compute: Q_6×K_3×V_3
GPU: 6" shape=rectangle]
		ring_stage1_3_7 [label="Ring Stage 3
Compute: Q_7×K_4×V_4
GPU: 7" shape=rectangle]
		ring_stage1_3_8 [label="Ring Stage 3
Compute: Q_8×K_5×V_5
GPU: 8" shape=rectangle]
		ring_stage1_3_9 [label="Ring Stage 3
Compute: Q_9×K_6×V_6
GPU: 9" shape=rectangle]
		ring_stage1_3_10 [label="Ring Stage 3
Compute: Q_10×K_7×V_7
GPU: 10" shape=rectangle]
		ring_stage1_3_11 [label="Ring Stage 3
Compute: Q_11×K_8×V_8
GPU: 11" shape=rectangle]
		ring_stage1_3_12 [label="Ring Stage 3
Compute: Q_12×K_9×V_9
GPU: 12" shape=rectangle]
		ring_stage1_3_13 [label="Ring Stage 3
Compute: Q_13×K_10×V_10
GPU: 13" shape=rectangle]
		ring_stage1_3_14 [label="Ring Stage 3
Compute: Q_14×K_11×V_11
GPU: 14" shape=rectangle]
		ring_stage1_3_15 [label="Ring Stage 3
Compute: Q_15×K_12×V_12
GPU: 15" shape=rectangle]
		kv_send1_3_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_3_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_3_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_3_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_3_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_3_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_3_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_3_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_3_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_3_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_3_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_3_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_3_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_3_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_3_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_3_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_4_0 [label="Ring Stage 4
Compute: Q_0×K_12×V_12
GPU: 0" shape=rectangle]
		ring_stage1_4_1 [label="Ring Stage 4
Compute: Q_1×K_13×V_13
GPU: 1" shape=rectangle]
		ring_stage1_4_2 [label="Ring Stage 4
Compute: Q_2×K_14×V_14
GPU: 2" shape=rectangle]
		ring_stage1_4_3 [label="Ring Stage 4
Compute: Q_3×K_15×V_15
GPU: 3" shape=rectangle]
		ring_stage1_4_4 [label="Ring Stage 4
Compute: Q_4×K_0×V_0
GPU: 4" shape=rectangle]
		ring_stage1_4_5 [label="Ring Stage 4
Compute: Q_5×K_1×V_1
GPU: 5" shape=rectangle]
		ring_stage1_4_6 [label="Ring Stage 4
Compute: Q_6×K_2×V_2
GPU: 6" shape=rectangle]
		ring_stage1_4_7 [label="Ring Stage 4
Compute: Q_7×K_3×V_3
GPU: 7" shape=rectangle]
		ring_stage1_4_8 [label="Ring Stage 4
Compute: Q_8×K_4×V_4
GPU: 8" shape=rectangle]
		ring_stage1_4_9 [label="Ring Stage 4
Compute: Q_9×K_5×V_5
GPU: 9" shape=rectangle]
		ring_stage1_4_10 [label="Ring Stage 4
Compute: Q_10×K_6×V_6
GPU: 10" shape=rectangle]
		ring_stage1_4_11 [label="Ring Stage 4
Compute: Q_11×K_7×V_7
GPU: 11" shape=rectangle]
		ring_stage1_4_12 [label="Ring Stage 4
Compute: Q_12×K_8×V_8
GPU: 12" shape=rectangle]
		ring_stage1_4_13 [label="Ring Stage 4
Compute: Q_13×K_9×V_9
GPU: 13" shape=rectangle]
		ring_stage1_4_14 [label="Ring Stage 4
Compute: Q_14×K_10×V_10
GPU: 14" shape=rectangle]
		ring_stage1_4_15 [label="Ring Stage 4
Compute: Q_15×K_11×V_11
GPU: 15" shape=rectangle]
		kv_send1_4_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_4_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_4_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_4_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_4_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_4_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_4_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_4_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_4_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_4_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_4_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_4_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_4_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_4_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_4_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_4_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_5_0 [label="Ring Stage 5
Compute: Q_0×K_11×V_11
GPU: 0" shape=rectangle]
		ring_stage1_5_1 [label="Ring Stage 5
Compute: Q_1×K_12×V_12
GPU: 1" shape=rectangle]
		ring_stage1_5_2 [label="Ring Stage 5
Compute: Q_2×K_13×V_13
GPU: 2" shape=rectangle]
		ring_stage1_5_3 [label="Ring Stage 5
Compute: Q_3×K_14×V_14
GPU: 3" shape=rectangle]
		ring_stage1_5_4 [label="Ring Stage 5
Compute: Q_4×K_15×V_15
GPU: 4" shape=rectangle]
		ring_stage1_5_5 [label="Ring Stage 5
Compute: Q_5×K_0×V_0
GPU: 5" shape=rectangle]
		ring_stage1_5_6 [label="Ring Stage 5
Compute: Q_6×K_1×V_1
GPU: 6" shape=rectangle]
		ring_stage1_5_7 [label="Ring Stage 5
Compute: Q_7×K_2×V_2
GPU: 7" shape=rectangle]
		ring_stage1_5_8 [label="Ring Stage 5
Compute: Q_8×K_3×V_3
GPU: 8" shape=rectangle]
		ring_stage1_5_9 [label="Ring Stage 5
Compute: Q_9×K_4×V_4
GPU: 9" shape=rectangle]
		ring_stage1_5_10 [label="Ring Stage 5
Compute: Q_10×K_5×V_5
GPU: 10" shape=rectangle]
		ring_stage1_5_11 [label="Ring Stage 5
Compute: Q_11×K_6×V_6
GPU: 11" shape=rectangle]
		ring_stage1_5_12 [label="Ring Stage 5
Compute: Q_12×K_7×V_7
GPU: 12" shape=rectangle]
		ring_stage1_5_13 [label="Ring Stage 5
Compute: Q_13×K_8×V_8
GPU: 13" shape=rectangle]
		ring_stage1_5_14 [label="Ring Stage 5
Compute: Q_14×K_9×V_9
GPU: 14" shape=rectangle]
		ring_stage1_5_15 [label="Ring Stage 5
Compute: Q_15×K_10×V_10
GPU: 15" shape=rectangle]
		kv_send1_5_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_5_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_5_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_5_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_5_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_5_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_5_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_5_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_5_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_5_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_5_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_5_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_5_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_5_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_5_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_5_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_6_0 [label="Ring Stage 6
Compute: Q_0×K_10×V_10
GPU: 0" shape=rectangle]
		ring_stage1_6_1 [label="Ring Stage 6
Compute: Q_1×K_11×V_11
GPU: 1" shape=rectangle]
		ring_stage1_6_2 [label="Ring Stage 6
Compute: Q_2×K_12×V_12
GPU: 2" shape=rectangle]
		ring_stage1_6_3 [label="Ring Stage 6
Compute: Q_3×K_13×V_13
GPU: 3" shape=rectangle]
		ring_stage1_6_4 [label="Ring Stage 6
Compute: Q_4×K_14×V_14
GPU: 4" shape=rectangle]
		ring_stage1_6_5 [label="Ring Stage 6
Compute: Q_5×K_15×V_15
GPU: 5" shape=rectangle]
		ring_stage1_6_6 [label="Ring Stage 6
Compute: Q_6×K_0×V_0
GPU: 6" shape=rectangle]
		ring_stage1_6_7 [label="Ring Stage 6
Compute: Q_7×K_1×V_1
GPU: 7" shape=rectangle]
		ring_stage1_6_8 [label="Ring Stage 6
Compute: Q_8×K_2×V_2
GPU: 8" shape=rectangle]
		ring_stage1_6_9 [label="Ring Stage 6
Compute: Q_9×K_3×V_3
GPU: 9" shape=rectangle]
		ring_stage1_6_10 [label="Ring Stage 6
Compute: Q_10×K_4×V_4
GPU: 10" shape=rectangle]
		ring_stage1_6_11 [label="Ring Stage 6
Compute: Q_11×K_5×V_5
GPU: 11" shape=rectangle]
		ring_stage1_6_12 [label="Ring Stage 6
Compute: Q_12×K_6×V_6
GPU: 12" shape=rectangle]
		ring_stage1_6_13 [label="Ring Stage 6
Compute: Q_13×K_7×V_7
GPU: 13" shape=rectangle]
		ring_stage1_6_14 [label="Ring Stage 6
Compute: Q_14×K_8×V_8
GPU: 14" shape=rectangle]
		ring_stage1_6_15 [label="Ring Stage 6
Compute: Q_15×K_9×V_9
GPU: 15" shape=rectangle]
		kv_send1_6_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_6_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_6_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_6_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_6_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_6_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_6_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_6_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_6_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_6_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_6_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_6_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_6_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_6_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_6_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_6_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_7_0 [label="Ring Stage 7
Compute: Q_0×K_9×V_9
GPU: 0" shape=rectangle]
		ring_stage1_7_1 [label="Ring Stage 7
Compute: Q_1×K_10×V_10
GPU: 1" shape=rectangle]
		ring_stage1_7_2 [label="Ring Stage 7
Compute: Q_2×K_11×V_11
GPU: 2" shape=rectangle]
		ring_stage1_7_3 [label="Ring Stage 7
Compute: Q_3×K_12×V_12
GPU: 3" shape=rectangle]
		ring_stage1_7_4 [label="Ring Stage 7
Compute: Q_4×K_13×V_13
GPU: 4" shape=rectangle]
		ring_stage1_7_5 [label="Ring Stage 7
Compute: Q_5×K_14×V_14
GPU: 5" shape=rectangle]
		ring_stage1_7_6 [label="Ring Stage 7
Compute: Q_6×K_15×V_15
GPU: 6" shape=rectangle]
		ring_stage1_7_7 [label="Ring Stage 7
Compute: Q_7×K_0×V_0
GPU: 7" shape=rectangle]
		ring_stage1_7_8 [label="Ring Stage 7
Compute: Q_8×K_1×V_1
GPU: 8" shape=rectangle]
		ring_stage1_7_9 [label="Ring Stage 7
Compute: Q_9×K_2×V_2
GPU: 9" shape=rectangle]
		ring_stage1_7_10 [label="Ring Stage 7
Compute: Q_10×K_3×V_3
GPU: 10" shape=rectangle]
		ring_stage1_7_11 [label="Ring Stage 7
Compute: Q_11×K_4×V_4
GPU: 11" shape=rectangle]
		ring_stage1_7_12 [label="Ring Stage 7
Compute: Q_12×K_5×V_5
GPU: 12" shape=rectangle]
		ring_stage1_7_13 [label="Ring Stage 7
Compute: Q_13×K_6×V_6
GPU: 13" shape=rectangle]
		ring_stage1_7_14 [label="Ring Stage 7
Compute: Q_14×K_7×V_7
GPU: 14" shape=rectangle]
		ring_stage1_7_15 [label="Ring Stage 7
Compute: Q_15×K_8×V_8
GPU: 15" shape=rectangle]
		kv_send1_7_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_7_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_7_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_7_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_7_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_7_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_7_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_7_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_7_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_7_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_7_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_7_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_7_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_7_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_7_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_7_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_8_0 [label="Ring Stage 8
Compute: Q_0×K_8×V_8
GPU: 0" shape=rectangle]
		ring_stage1_8_1 [label="Ring Stage 8
Compute: Q_1×K_9×V_9
GPU: 1" shape=rectangle]
		ring_stage1_8_2 [label="Ring Stage 8
Compute: Q_2×K_10×V_10
GPU: 2" shape=rectangle]
		ring_stage1_8_3 [label="Ring Stage 8
Compute: Q_3×K_11×V_11
GPU: 3" shape=rectangle]
		ring_stage1_8_4 [label="Ring Stage 8
Compute: Q_4×K_12×V_12
GPU: 4" shape=rectangle]
		ring_stage1_8_5 [label="Ring Stage 8
Compute: Q_5×K_13×V_13
GPU: 5" shape=rectangle]
		ring_stage1_8_6 [label="Ring Stage 8
Compute: Q_6×K_14×V_14
GPU: 6" shape=rectangle]
		ring_stage1_8_7 [label="Ring Stage 8
Compute: Q_7×K_15×V_15
GPU: 7" shape=rectangle]
		ring_stage1_8_8 [label="Ring Stage 8
Compute: Q_8×K_0×V_0
GPU: 8" shape=rectangle]
		ring_stage1_8_9 [label="Ring Stage 8
Compute: Q_9×K_1×V_1
GPU: 9" shape=rectangle]
		ring_stage1_8_10 [label="Ring Stage 8
Compute: Q_10×K_2×V_2
GPU: 10" shape=rectangle]
		ring_stage1_8_11 [label="Ring Stage 8
Compute: Q_11×K_3×V_3
GPU: 11" shape=rectangle]
		ring_stage1_8_12 [label="Ring Stage 8
Compute: Q_12×K_4×V_4
GPU: 12" shape=rectangle]
		ring_stage1_8_13 [label="Ring Stage 8
Compute: Q_13×K_5×V_5
GPU: 13" shape=rectangle]
		ring_stage1_8_14 [label="Ring Stage 8
Compute: Q_14×K_6×V_6
GPU: 14" shape=rectangle]
		ring_stage1_8_15 [label="Ring Stage 8
Compute: Q_15×K_7×V_7
GPU: 15" shape=rectangle]
		kv_send1_8_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_8_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_8_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_8_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_8_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_8_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_8_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_8_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_8_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_8_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_8_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_8_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_8_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_8_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_8_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_8_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_9_0 [label="Ring Stage 9
Compute: Q_0×K_7×V_7
GPU: 0" shape=rectangle]
		ring_stage1_9_1 [label="Ring Stage 9
Compute: Q_1×K_8×V_8
GPU: 1" shape=rectangle]
		ring_stage1_9_2 [label="Ring Stage 9
Compute: Q_2×K_9×V_9
GPU: 2" shape=rectangle]
		ring_stage1_9_3 [label="Ring Stage 9
Compute: Q_3×K_10×V_10
GPU: 3" shape=rectangle]
		ring_stage1_9_4 [label="Ring Stage 9
Compute: Q_4×K_11×V_11
GPU: 4" shape=rectangle]
		ring_stage1_9_5 [label="Ring Stage 9
Compute: Q_5×K_12×V_12
GPU: 5" shape=rectangle]
		ring_stage1_9_6 [label="Ring Stage 9
Compute: Q_6×K_13×V_13
GPU: 6" shape=rectangle]
		ring_stage1_9_7 [label="Ring Stage 9
Compute: Q_7×K_14×V_14
GPU: 7" shape=rectangle]
		ring_stage1_9_8 [label="Ring Stage 9
Compute: Q_8×K_15×V_15
GPU: 8" shape=rectangle]
		ring_stage1_9_9 [label="Ring Stage 9
Compute: Q_9×K_0×V_0
GPU: 9" shape=rectangle]
		ring_stage1_9_10 [label="Ring Stage 9
Compute: Q_10×K_1×V_1
GPU: 10" shape=rectangle]
		ring_stage1_9_11 [label="Ring Stage 9
Compute: Q_11×K_2×V_2
GPU: 11" shape=rectangle]
		ring_stage1_9_12 [label="Ring Stage 9
Compute: Q_12×K_3×V_3
GPU: 12" shape=rectangle]
		ring_stage1_9_13 [label="Ring Stage 9
Compute: Q_13×K_4×V_4
GPU: 13" shape=rectangle]
		ring_stage1_9_14 [label="Ring Stage 9
Compute: Q_14×K_5×V_5
GPU: 14" shape=rectangle]
		ring_stage1_9_15 [label="Ring Stage 9
Compute: Q_15×K_6×V_6
GPU: 15" shape=rectangle]
		kv_send1_9_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_9_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_9_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_9_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_9_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_9_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_9_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_9_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_9_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_9_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_9_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_9_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_9_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_9_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_9_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_9_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_10_0 [label="Ring Stage 10
Compute: Q_0×K_6×V_6
GPU: 0" shape=rectangle]
		ring_stage1_10_1 [label="Ring Stage 10
Compute: Q_1×K_7×V_7
GPU: 1" shape=rectangle]
		ring_stage1_10_2 [label="Ring Stage 10
Compute: Q_2×K_8×V_8
GPU: 2" shape=rectangle]
		ring_stage1_10_3 [label="Ring Stage 10
Compute: Q_3×K_9×V_9
GPU: 3" shape=rectangle]
		ring_stage1_10_4 [label="Ring Stage 10
Compute: Q_4×K_10×V_10
GPU: 4" shape=rectangle]
		ring_stage1_10_5 [label="Ring Stage 10
Compute: Q_5×K_11×V_11
GPU: 5" shape=rectangle]
		ring_stage1_10_6 [label="Ring Stage 10
Compute: Q_6×K_12×V_12
GPU: 6" shape=rectangle]
		ring_stage1_10_7 [label="Ring Stage 10
Compute: Q_7×K_13×V_13
GPU: 7" shape=rectangle]
		ring_stage1_10_8 [label="Ring Stage 10
Compute: Q_8×K_14×V_14
GPU: 8" shape=rectangle]
		ring_stage1_10_9 [label="Ring Stage 10
Compute: Q_9×K_15×V_15
GPU: 9" shape=rectangle]
		ring_stage1_10_10 [label="Ring Stage 10
Compute: Q_10×K_0×V_0
GPU: 10" shape=rectangle]
		ring_stage1_10_11 [label="Ring Stage 10
Compute: Q_11×K_1×V_1
GPU: 11" shape=rectangle]
		ring_stage1_10_12 [label="Ring Stage 10
Compute: Q_12×K_2×V_2
GPU: 12" shape=rectangle]
		ring_stage1_10_13 [label="Ring Stage 10
Compute: Q_13×K_3×V_3
GPU: 13" shape=rectangle]
		ring_stage1_10_14 [label="Ring Stage 10
Compute: Q_14×K_4×V_4
GPU: 14" shape=rectangle]
		ring_stage1_10_15 [label="Ring Stage 10
Compute: Q_15×K_5×V_5
GPU: 15" shape=rectangle]
		kv_send1_10_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_10_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_10_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_10_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_10_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_10_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_10_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_10_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_10_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_10_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_10_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_10_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_10_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_10_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_10_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_10_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_11_0 [label="Ring Stage 11
Compute: Q_0×K_5×V_5
GPU: 0" shape=rectangle]
		ring_stage1_11_1 [label="Ring Stage 11
Compute: Q_1×K_6×V_6
GPU: 1" shape=rectangle]
		ring_stage1_11_2 [label="Ring Stage 11
Compute: Q_2×K_7×V_7
GPU: 2" shape=rectangle]
		ring_stage1_11_3 [label="Ring Stage 11
Compute: Q_3×K_8×V_8
GPU: 3" shape=rectangle]
		ring_stage1_11_4 [label="Ring Stage 11
Compute: Q_4×K_9×V_9
GPU: 4" shape=rectangle]
		ring_stage1_11_5 [label="Ring Stage 11
Compute: Q_5×K_10×V_10
GPU: 5" shape=rectangle]
		ring_stage1_11_6 [label="Ring Stage 11
Compute: Q_6×K_11×V_11
GPU: 6" shape=rectangle]
		ring_stage1_11_7 [label="Ring Stage 11
Compute: Q_7×K_12×V_12
GPU: 7" shape=rectangle]
		ring_stage1_11_8 [label="Ring Stage 11
Compute: Q_8×K_13×V_13
GPU: 8" shape=rectangle]
		ring_stage1_11_9 [label="Ring Stage 11
Compute: Q_9×K_14×V_14
GPU: 9" shape=rectangle]
		ring_stage1_11_10 [label="Ring Stage 11
Compute: Q_10×K_15×V_15
GPU: 10" shape=rectangle]
		ring_stage1_11_11 [label="Ring Stage 11
Compute: Q_11×K_0×V_0
GPU: 11" shape=rectangle]
		ring_stage1_11_12 [label="Ring Stage 11
Compute: Q_12×K_1×V_1
GPU: 12" shape=rectangle]
		ring_stage1_11_13 [label="Ring Stage 11
Compute: Q_13×K_2×V_2
GPU: 13" shape=rectangle]
		ring_stage1_11_14 [label="Ring Stage 11
Compute: Q_14×K_3×V_3
GPU: 14" shape=rectangle]
		ring_stage1_11_15 [label="Ring Stage 11
Compute: Q_15×K_4×V_4
GPU: 15" shape=rectangle]
		kv_send1_11_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_11_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_11_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_11_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_11_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_11_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_11_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_11_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_11_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_11_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_11_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_11_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_11_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_11_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_11_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_11_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_12_0 [label="Ring Stage 12
Compute: Q_0×K_4×V_4
GPU: 0" shape=rectangle]
		ring_stage1_12_1 [label="Ring Stage 12
Compute: Q_1×K_5×V_5
GPU: 1" shape=rectangle]
		ring_stage1_12_2 [label="Ring Stage 12
Compute: Q_2×K_6×V_6
GPU: 2" shape=rectangle]
		ring_stage1_12_3 [label="Ring Stage 12
Compute: Q_3×K_7×V_7
GPU: 3" shape=rectangle]
		ring_stage1_12_4 [label="Ring Stage 12
Compute: Q_4×K_8×V_8
GPU: 4" shape=rectangle]
		ring_stage1_12_5 [label="Ring Stage 12
Compute: Q_5×K_9×V_9
GPU: 5" shape=rectangle]
		ring_stage1_12_6 [label="Ring Stage 12
Compute: Q_6×K_10×V_10
GPU: 6" shape=rectangle]
		ring_stage1_12_7 [label="Ring Stage 12
Compute: Q_7×K_11×V_11
GPU: 7" shape=rectangle]
		ring_stage1_12_8 [label="Ring Stage 12
Compute: Q_8×K_12×V_12
GPU: 8" shape=rectangle]
		ring_stage1_12_9 [label="Ring Stage 12
Compute: Q_9×K_13×V_13
GPU: 9" shape=rectangle]
		ring_stage1_12_10 [label="Ring Stage 12
Compute: Q_10×K_14×V_14
GPU: 10" shape=rectangle]
		ring_stage1_12_11 [label="Ring Stage 12
Compute: Q_11×K_15×V_15
GPU: 11" shape=rectangle]
		ring_stage1_12_12 [label="Ring Stage 12
Compute: Q_12×K_0×V_0
GPU: 12" shape=rectangle]
		ring_stage1_12_13 [label="Ring Stage 12
Compute: Q_13×K_1×V_1
GPU: 13" shape=rectangle]
		ring_stage1_12_14 [label="Ring Stage 12
Compute: Q_14×K_2×V_2
GPU: 14" shape=rectangle]
		ring_stage1_12_15 [label="Ring Stage 12
Compute: Q_15×K_3×V_3
GPU: 15" shape=rectangle]
		kv_send1_12_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_12_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_12_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_12_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_12_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_12_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_12_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_12_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_12_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_12_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_12_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_12_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_12_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_12_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_12_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_12_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_13_0 [label="Ring Stage 13
Compute: Q_0×K_3×V_3
GPU: 0" shape=rectangle]
		ring_stage1_13_1 [label="Ring Stage 13
Compute: Q_1×K_4×V_4
GPU: 1" shape=rectangle]
		ring_stage1_13_2 [label="Ring Stage 13
Compute: Q_2×K_5×V_5
GPU: 2" shape=rectangle]
		ring_stage1_13_3 [label="Ring Stage 13
Compute: Q_3×K_6×V_6
GPU: 3" shape=rectangle]
		ring_stage1_13_4 [label="Ring Stage 13
Compute: Q_4×K_7×V_7
GPU: 4" shape=rectangle]
		ring_stage1_13_5 [label="Ring Stage 13
Compute: Q_5×K_8×V_8
GPU: 5" shape=rectangle]
		ring_stage1_13_6 [label="Ring Stage 13
Compute: Q_6×K_9×V_9
GPU: 6" shape=rectangle]
		ring_stage1_13_7 [label="Ring Stage 13
Compute: Q_7×K_10×V_10
GPU: 7" shape=rectangle]
		ring_stage1_13_8 [label="Ring Stage 13
Compute: Q_8×K_11×V_11
GPU: 8" shape=rectangle]
		ring_stage1_13_9 [label="Ring Stage 13
Compute: Q_9×K_12×V_12
GPU: 9" shape=rectangle]
		ring_stage1_13_10 [label="Ring Stage 13
Compute: Q_10×K_13×V_13
GPU: 10" shape=rectangle]
		ring_stage1_13_11 [label="Ring Stage 13
Compute: Q_11×K_14×V_14
GPU: 11" shape=rectangle]
		ring_stage1_13_12 [label="Ring Stage 13
Compute: Q_12×K_15×V_15
GPU: 12" shape=rectangle]
		ring_stage1_13_13 [label="Ring Stage 13
Compute: Q_13×K_0×V_0
GPU: 13" shape=rectangle]
		ring_stage1_13_14 [label="Ring Stage 13
Compute: Q_14×K_1×V_1
GPU: 14" shape=rectangle]
		ring_stage1_13_15 [label="Ring Stage 13
Compute: Q_15×K_2×V_2
GPU: 15" shape=rectangle]
		kv_send1_13_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_13_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_13_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_13_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_13_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_13_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_13_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_13_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_13_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_13_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_13_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_13_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_13_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_13_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_13_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_13_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_14_0 [label="Ring Stage 14
Compute: Q_0×K_2×V_2
GPU: 0" shape=rectangle]
		ring_stage1_14_1 [label="Ring Stage 14
Compute: Q_1×K_3×V_3
GPU: 1" shape=rectangle]
		ring_stage1_14_2 [label="Ring Stage 14
Compute: Q_2×K_4×V_4
GPU: 2" shape=rectangle]
		ring_stage1_14_3 [label="Ring Stage 14
Compute: Q_3×K_5×V_5
GPU: 3" shape=rectangle]
		ring_stage1_14_4 [label="Ring Stage 14
Compute: Q_4×K_6×V_6
GPU: 4" shape=rectangle]
		ring_stage1_14_5 [label="Ring Stage 14
Compute: Q_5×K_7×V_7
GPU: 5" shape=rectangle]
		ring_stage1_14_6 [label="Ring Stage 14
Compute: Q_6×K_8×V_8
GPU: 6" shape=rectangle]
		ring_stage1_14_7 [label="Ring Stage 14
Compute: Q_7×K_9×V_9
GPU: 7" shape=rectangle]
		ring_stage1_14_8 [label="Ring Stage 14
Compute: Q_8×K_10×V_10
GPU: 8" shape=rectangle]
		ring_stage1_14_9 [label="Ring Stage 14
Compute: Q_9×K_11×V_11
GPU: 9" shape=rectangle]
		ring_stage1_14_10 [label="Ring Stage 14
Compute: Q_10×K_12×V_12
GPU: 10" shape=rectangle]
		ring_stage1_14_11 [label="Ring Stage 14
Compute: Q_11×K_13×V_13
GPU: 11" shape=rectangle]
		ring_stage1_14_12 [label="Ring Stage 14
Compute: Q_12×K_14×V_14
GPU: 12" shape=rectangle]
		ring_stage1_14_13 [label="Ring Stage 14
Compute: Q_13×K_15×V_15
GPU: 13" shape=rectangle]
		ring_stage1_14_14 [label="Ring Stage 14
Compute: Q_14×K_0×V_0
GPU: 14" shape=rectangle]
		ring_stage1_14_15 [label="Ring Stage 14
Compute: Q_15×K_1×V_1
GPU: 15" shape=rectangle]
		kv_send1_14_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_14_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_14_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_14_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_14_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_14_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_14_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_14_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_14_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_14_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_14_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_14_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_14_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_14_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_14_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_14_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage1_15_0 [label="Ring Stage 15
Compute: Q_0×K_1×V_1
GPU: 0" shape=rectangle]
		ring_stage1_15_1 [label="Ring Stage 15
Compute: Q_1×K_2×V_2
GPU: 1" shape=rectangle]
		ring_stage1_15_2 [label="Ring Stage 15
Compute: Q_2×K_3×V_3
GPU: 2" shape=rectangle]
		ring_stage1_15_3 [label="Ring Stage 15
Compute: Q_3×K_4×V_4
GPU: 3" shape=rectangle]
		ring_stage1_15_4 [label="Ring Stage 15
Compute: Q_4×K_5×V_5
GPU: 4" shape=rectangle]
		ring_stage1_15_5 [label="Ring Stage 15
Compute: Q_5×K_6×V_6
GPU: 5" shape=rectangle]
		ring_stage1_15_6 [label="Ring Stage 15
Compute: Q_6×K_7×V_7
GPU: 6" shape=rectangle]
		ring_stage1_15_7 [label="Ring Stage 15
Compute: Q_7×K_8×V_8
GPU: 7" shape=rectangle]
		ring_stage1_15_8 [label="Ring Stage 15
Compute: Q_8×K_9×V_9
GPU: 8" shape=rectangle]
		ring_stage1_15_9 [label="Ring Stage 15
Compute: Q_9×K_10×V_10
GPU: 9" shape=rectangle]
		ring_stage1_15_10 [label="Ring Stage 15
Compute: Q_10×K_11×V_11
GPU: 10" shape=rectangle]
		ring_stage1_15_11 [label="Ring Stage 15
Compute: Q_11×K_12×V_12
GPU: 11" shape=rectangle]
		ring_stage1_15_12 [label="Ring Stage 15
Compute: Q_12×K_13×V_13
GPU: 12" shape=rectangle]
		ring_stage1_15_13 [label="Ring Stage 15
Compute: Q_13×K_14×V_14
GPU: 13" shape=rectangle]
		ring_stage1_15_14 [label="Ring Stage 15
Compute: Q_14×K_15×V_15
GPU: 14" shape=rectangle]
		ring_stage1_15_15 [label="Ring Stage 15
Compute: Q_15×K_0×V_0
GPU: 15" shape=rectangle]
		kv_send1_15_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send1_15_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send1_15_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send1_15_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send1_15_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send1_15_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send1_15_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send1_15_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send1_15_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send1_15_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send1_15_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send1_15_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send1_15_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send1_15_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send1_15_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send1_15_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		accum1_0 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		accum1_1 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		accum1_2 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		accum1_3 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		accum1_4 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		accum1_5 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		accum1_6 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		accum1_7 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		accum1_8 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		accum1_9 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		accum1_10 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		accum1_11 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		accum1_12 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		accum1_13 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		accum1_14 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		accum1_15 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		out_proj1_0 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		out_proj1_1 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		out_proj1_2 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		out_proj1_3 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		out_proj1_4 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		out_proj1_5 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		out_proj1_6 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		out_proj1_7 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		out_proj1_8 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		out_proj1_9 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		out_proj1_10 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		out_proj1_11 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		out_proj1_12 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		out_proj1_13 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		out_proj1_14 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		out_proj1_15 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
	}
	subgraph cluster_moe1 {
		label="Mixture of Experts"
		gate1_0 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 0" shape=diamond]
		gate1_1 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 1" shape=diamond]
		gate1_2 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 2" shape=diamond]
		gate1_3 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 3" shape=diamond]
		gate1_4 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 4" shape=diamond]
		gate1_5 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 5" shape=diamond]
		gate1_6 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 6" shape=diamond]
		gate1_7 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 7" shape=diamond]
		gate1_8 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 8" shape=diamond]
		gate1_9 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 9" shape=diamond]
		gate1_10 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 10" shape=diamond]
		gate1_11 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 11" shape=diamond]
		gate1_12 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 12" shape=diamond]
		gate1_13 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 13" shape=diamond]
		gate1_14 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 14" shape=diamond]
		gate1_15 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 15" shape=diamond]
		select1_0 [label="Select Top-2 Experts
GPU: 0" shape=parallelogram]
		select1_1 [label="Select Top-2 Experts
GPU: 1" shape=parallelogram]
		select1_2 [label="Select Top-2 Experts
GPU: 2" shape=parallelogram]
		select1_3 [label="Select Top-2 Experts
GPU: 3" shape=parallelogram]
		select1_4 [label="Select Top-2 Experts
GPU: 4" shape=parallelogram]
		select1_5 [label="Select Top-2 Experts
GPU: 5" shape=parallelogram]
		select1_6 [label="Select Top-2 Experts
GPU: 6" shape=parallelogram]
		select1_7 [label="Select Top-2 Experts
GPU: 7" shape=parallelogram]
		select1_8 [label="Select Top-2 Experts
GPU: 8" shape=parallelogram]
		select1_9 [label="Select Top-2 Experts
GPU: 9" shape=parallelogram]
		select1_10 [label="Select Top-2 Experts
GPU: 10" shape=parallelogram]
		select1_11 [label="Select Top-2 Experts
GPU: 11" shape=parallelogram]
		select1_12 [label="Select Top-2 Experts
GPU: 12" shape=parallelogram]
		select1_13 [label="Select Top-2 Experts
GPU: 13" shape=parallelogram]
		select1_14 [label="Select Top-2 Experts
GPU: 14" shape=parallelogram]
		select1_15 [label="Select Top-2 Experts
GPU: 15" shape=parallelogram]
		expert1_0_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_0 [label="Expert 0 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_1 [label="Expert 1 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_2 [label="Expert 2 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_3 [label="Expert 3 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_4 [label="Expert 4 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_5 [label="Expert 5 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_6 [label="Expert 6 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_0_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act1_0_7 [label="Expert 7 GELU
GPU: 0" shape=rectangle]
		expert_out1_0_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert1_1_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_0 [label="Expert 0 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_1 [label="Expert 1 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_2 [label="Expert 2 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_3 [label="Expert 3 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_4 [label="Expert 4 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_5 [label="Expert 5 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_6 [label="Expert 6 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_1_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act1_1_7 [label="Expert 7 GELU
GPU: 1" shape=rectangle]
		expert_out1_1_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert1_2_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_0 [label="Expert 0 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_1 [label="Expert 1 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_2 [label="Expert 2 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_3 [label="Expert 3 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_4 [label="Expert 4 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_5 [label="Expert 5 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_6 [label="Expert 6 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_2_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act1_2_7 [label="Expert 7 GELU
GPU: 2" shape=rectangle]
		expert_out1_2_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert1_3_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_0 [label="Expert 0 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_1 [label="Expert 1 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_2 [label="Expert 2 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_3 [label="Expert 3 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_4 [label="Expert 4 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_5 [label="Expert 5 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_6 [label="Expert 6 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_3_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act1_3_7 [label="Expert 7 GELU
GPU: 3" shape=rectangle]
		expert_out1_3_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert1_4_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_0 [label="Expert 0 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_1 [label="Expert 1 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_2 [label="Expert 2 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_3 [label="Expert 3 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_4 [label="Expert 4 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_5 [label="Expert 5 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_6 [label="Expert 6 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_4_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act1_4_7 [label="Expert 7 GELU
GPU: 4" shape=rectangle]
		expert_out1_4_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert1_5_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_0 [label="Expert 0 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_1 [label="Expert 1 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_2 [label="Expert 2 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_3 [label="Expert 3 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_4 [label="Expert 4 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_5 [label="Expert 5 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_6 [label="Expert 6 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_5_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act1_5_7 [label="Expert 7 GELU
GPU: 5" shape=rectangle]
		expert_out1_5_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert1_6_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_0 [label="Expert 0 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_1 [label="Expert 1 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_2 [label="Expert 2 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_3 [label="Expert 3 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_4 [label="Expert 4 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_5 [label="Expert 5 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_6 [label="Expert 6 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_6_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act1_6_7 [label="Expert 7 GELU
GPU: 6" shape=rectangle]
		expert_out1_6_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert1_7_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_0 [label="Expert 0 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_1 [label="Expert 1 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_2 [label="Expert 2 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_3 [label="Expert 3 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_4 [label="Expert 4 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_5 [label="Expert 5 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_6 [label="Expert 6 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_7_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act1_7_7 [label="Expert 7 GELU
GPU: 7" shape=rectangle]
		expert_out1_7_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert1_8_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_0 [label="Expert 0 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_1 [label="Expert 1 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_2 [label="Expert 2 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_3 [label="Expert 3 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_4 [label="Expert 4 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_5 [label="Expert 5 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_6 [label="Expert 6 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_8_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act1_8_7 [label="Expert 7 GELU
GPU: 8" shape=rectangle]
		expert_out1_8_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert1_9_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_0 [label="Expert 0 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_1 [label="Expert 1 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_2 [label="Expert 2 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_3 [label="Expert 3 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_4 [label="Expert 4 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_5 [label="Expert 5 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_6 [label="Expert 6 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_9_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act1_9_7 [label="Expert 7 GELU
GPU: 9" shape=rectangle]
		expert_out1_9_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert1_10_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_0 [label="Expert 0 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_1 [label="Expert 1 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_2 [label="Expert 2 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_3 [label="Expert 3 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_4 [label="Expert 4 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_5 [label="Expert 5 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_6 [label="Expert 6 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_10_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act1_10_7 [label="Expert 7 GELU
GPU: 10" shape=rectangle]
		expert_out1_10_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert1_11_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_0 [label="Expert 0 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_1 [label="Expert 1 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_2 [label="Expert 2 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_3 [label="Expert 3 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_4 [label="Expert 4 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_5 [label="Expert 5 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_6 [label="Expert 6 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_11_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act1_11_7 [label="Expert 7 GELU
GPU: 11" shape=rectangle]
		expert_out1_11_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert1_12_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_0 [label="Expert 0 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_1 [label="Expert 1 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_2 [label="Expert 2 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_3 [label="Expert 3 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_4 [label="Expert 4 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_5 [label="Expert 5 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_6 [label="Expert 6 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_12_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act1_12_7 [label="Expert 7 GELU
GPU: 12" shape=rectangle]
		expert_out1_12_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert1_13_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_0 [label="Expert 0 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_1 [label="Expert 1 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_2 [label="Expert 2 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_3 [label="Expert 3 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_4 [label="Expert 4 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_5 [label="Expert 5 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_6 [label="Expert 6 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_13_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act1_13_7 [label="Expert 7 GELU
GPU: 13" shape=rectangle]
		expert_out1_13_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert1_14_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_0 [label="Expert 0 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_1 [label="Expert 1 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_2 [label="Expert 2 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_3 [label="Expert 3 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_4 [label="Expert 4 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_5 [label="Expert 5 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_6 [label="Expert 6 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_14_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act1_14_7 [label="Expert 7 GELU
GPU: 14" shape=rectangle]
		expert_out1_14_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert1_15_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_0 [label="Expert 0 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_1 [label="Expert 1 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_2 [label="Expert 2 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_3 [label="Expert 3 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_4 [label="Expert 4 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_5 [label="Expert 5 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_6 [label="Expert 6 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert1_15_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act1_15_7 [label="Expert 7 GELU
GPU: 15" shape=rectangle]
		expert_out1_15_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		combine1_0 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 0" shape=parallelogram]
		combine1_1 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 1" shape=parallelogram]
		combine1_2 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 2" shape=parallelogram]
		combine1_3 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 3" shape=parallelogram]
		combine1_4 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 4" shape=parallelogram]
		combine1_5 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 5" shape=parallelogram]
		combine1_6 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 6" shape=parallelogram]
		combine1_7 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 7" shape=parallelogram]
		combine1_8 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 8" shape=parallelogram]
		combine1_9 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 9" shape=parallelogram]
		combine1_10 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 10" shape=parallelogram]
		combine1_11 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 11" shape=parallelogram]
		combine1_12 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 12" shape=parallelogram]
		combine1_13 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 13" shape=parallelogram]
		combine1_14 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 14" shape=parallelogram]
		combine1_15 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_layer1 {
		label="Layer 1"
		res_attn1_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_attn1_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_attn1_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_attn1_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_attn1_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_attn1_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_attn1_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_attn1_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_attn1_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_attn1_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_attn1_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_attn1_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_attn1_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_attn1_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_attn1_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_attn1_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		res_moe1_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_moe1_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_moe1_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_moe1_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_moe1_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_moe1_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_moe1_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_moe1_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_moe1_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_moe1_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_moe1_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_moe1_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_moe1_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_moe1_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_moe1_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_moe1_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_ra_sp2 {
		label="Ring Attention + Sequence Parallel"
		qkv2_0 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		qkv2_1 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		qkv2_2 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		qkv2_3 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		qkv2_4 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		qkv2_5 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		qkv2_6 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		qkv2_7 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		qkv2_8 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		qkv2_9 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		qkv2_10 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		qkv2_11 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		qkv2_12 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		qkv2_13 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		qkv2_14 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		qkv2_15 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		ring_stage2_0_0 [label="Ring Stage 0
Compute: Q_0×K_0×V_0
GPU: 0" shape=rectangle]
		ring_stage2_0_1 [label="Ring Stage 0
Compute: Q_1×K_1×V_1
GPU: 1" shape=rectangle]
		ring_stage2_0_2 [label="Ring Stage 0
Compute: Q_2×K_2×V_2
GPU: 2" shape=rectangle]
		ring_stage2_0_3 [label="Ring Stage 0
Compute: Q_3×K_3×V_3
GPU: 3" shape=rectangle]
		ring_stage2_0_4 [label="Ring Stage 0
Compute: Q_4×K_4×V_4
GPU: 4" shape=rectangle]
		ring_stage2_0_5 [label="Ring Stage 0
Compute: Q_5×K_5×V_5
GPU: 5" shape=rectangle]
		ring_stage2_0_6 [label="Ring Stage 0
Compute: Q_6×K_6×V_6
GPU: 6" shape=rectangle]
		ring_stage2_0_7 [label="Ring Stage 0
Compute: Q_7×K_7×V_7
GPU: 7" shape=rectangle]
		ring_stage2_0_8 [label="Ring Stage 0
Compute: Q_8×K_8×V_8
GPU: 8" shape=rectangle]
		ring_stage2_0_9 [label="Ring Stage 0
Compute: Q_9×K_9×V_9
GPU: 9" shape=rectangle]
		ring_stage2_0_10 [label="Ring Stage 0
Compute: Q_10×K_10×V_10
GPU: 10" shape=rectangle]
		ring_stage2_0_11 [label="Ring Stage 0
Compute: Q_11×K_11×V_11
GPU: 11" shape=rectangle]
		ring_stage2_0_12 [label="Ring Stage 0
Compute: Q_12×K_12×V_12
GPU: 12" shape=rectangle]
		ring_stage2_0_13 [label="Ring Stage 0
Compute: Q_13×K_13×V_13
GPU: 13" shape=rectangle]
		ring_stage2_0_14 [label="Ring Stage 0
Compute: Q_14×K_14×V_14
GPU: 14" shape=rectangle]
		ring_stage2_0_15 [label="Ring Stage 0
Compute: Q_15×K_15×V_15
GPU: 15" shape=rectangle]
		kv_send2_0_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_0_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_0_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_0_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_0_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_0_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_0_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_0_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_0_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_0_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_0_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_0_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_0_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_0_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_0_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_0_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_1_0 [label="Ring Stage 1
Compute: Q_0×K_15×V_15
GPU: 0" shape=rectangle]
		ring_stage2_1_1 [label="Ring Stage 1
Compute: Q_1×K_0×V_0
GPU: 1" shape=rectangle]
		ring_stage2_1_2 [label="Ring Stage 1
Compute: Q_2×K_1×V_1
GPU: 2" shape=rectangle]
		ring_stage2_1_3 [label="Ring Stage 1
Compute: Q_3×K_2×V_2
GPU: 3" shape=rectangle]
		ring_stage2_1_4 [label="Ring Stage 1
Compute: Q_4×K_3×V_3
GPU: 4" shape=rectangle]
		ring_stage2_1_5 [label="Ring Stage 1
Compute: Q_5×K_4×V_4
GPU: 5" shape=rectangle]
		ring_stage2_1_6 [label="Ring Stage 1
Compute: Q_6×K_5×V_5
GPU: 6" shape=rectangle]
		ring_stage2_1_7 [label="Ring Stage 1
Compute: Q_7×K_6×V_6
GPU: 7" shape=rectangle]
		ring_stage2_1_8 [label="Ring Stage 1
Compute: Q_8×K_7×V_7
GPU: 8" shape=rectangle]
		ring_stage2_1_9 [label="Ring Stage 1
Compute: Q_9×K_8×V_8
GPU: 9" shape=rectangle]
		ring_stage2_1_10 [label="Ring Stage 1
Compute: Q_10×K_9×V_9
GPU: 10" shape=rectangle]
		ring_stage2_1_11 [label="Ring Stage 1
Compute: Q_11×K_10×V_10
GPU: 11" shape=rectangle]
		ring_stage2_1_12 [label="Ring Stage 1
Compute: Q_12×K_11×V_11
GPU: 12" shape=rectangle]
		ring_stage2_1_13 [label="Ring Stage 1
Compute: Q_13×K_12×V_12
GPU: 13" shape=rectangle]
		ring_stage2_1_14 [label="Ring Stage 1
Compute: Q_14×K_13×V_13
GPU: 14" shape=rectangle]
		ring_stage2_1_15 [label="Ring Stage 1
Compute: Q_15×K_14×V_14
GPU: 15" shape=rectangle]
		kv_send2_1_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_1_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_1_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_1_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_1_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_1_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_1_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_1_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_1_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_1_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_1_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_1_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_1_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_1_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_1_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_1_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_2_0 [label="Ring Stage 2
Compute: Q_0×K_14×V_14
GPU: 0" shape=rectangle]
		ring_stage2_2_1 [label="Ring Stage 2
Compute: Q_1×K_15×V_15
GPU: 1" shape=rectangle]
		ring_stage2_2_2 [label="Ring Stage 2
Compute: Q_2×K_0×V_0
GPU: 2" shape=rectangle]
		ring_stage2_2_3 [label="Ring Stage 2
Compute: Q_3×K_1×V_1
GPU: 3" shape=rectangle]
		ring_stage2_2_4 [label="Ring Stage 2
Compute: Q_4×K_2×V_2
GPU: 4" shape=rectangle]
		ring_stage2_2_5 [label="Ring Stage 2
Compute: Q_5×K_3×V_3
GPU: 5" shape=rectangle]
		ring_stage2_2_6 [label="Ring Stage 2
Compute: Q_6×K_4×V_4
GPU: 6" shape=rectangle]
		ring_stage2_2_7 [label="Ring Stage 2
Compute: Q_7×K_5×V_5
GPU: 7" shape=rectangle]
		ring_stage2_2_8 [label="Ring Stage 2
Compute: Q_8×K_6×V_6
GPU: 8" shape=rectangle]
		ring_stage2_2_9 [label="Ring Stage 2
Compute: Q_9×K_7×V_7
GPU: 9" shape=rectangle]
		ring_stage2_2_10 [label="Ring Stage 2
Compute: Q_10×K_8×V_8
GPU: 10" shape=rectangle]
		ring_stage2_2_11 [label="Ring Stage 2
Compute: Q_11×K_9×V_9
GPU: 11" shape=rectangle]
		ring_stage2_2_12 [label="Ring Stage 2
Compute: Q_12×K_10×V_10
GPU: 12" shape=rectangle]
		ring_stage2_2_13 [label="Ring Stage 2
Compute: Q_13×K_11×V_11
GPU: 13" shape=rectangle]
		ring_stage2_2_14 [label="Ring Stage 2
Compute: Q_14×K_12×V_12
GPU: 14" shape=rectangle]
		ring_stage2_2_15 [label="Ring Stage 2
Compute: Q_15×K_13×V_13
GPU: 15" shape=rectangle]
		kv_send2_2_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_2_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_2_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_2_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_2_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_2_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_2_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_2_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_2_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_2_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_2_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_2_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_2_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_2_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_2_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_2_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_3_0 [label="Ring Stage 3
Compute: Q_0×K_13×V_13
GPU: 0" shape=rectangle]
		ring_stage2_3_1 [label="Ring Stage 3
Compute: Q_1×K_14×V_14
GPU: 1" shape=rectangle]
		ring_stage2_3_2 [label="Ring Stage 3
Compute: Q_2×K_15×V_15
GPU: 2" shape=rectangle]
		ring_stage2_3_3 [label="Ring Stage 3
Compute: Q_3×K_0×V_0
GPU: 3" shape=rectangle]
		ring_stage2_3_4 [label="Ring Stage 3
Compute: Q_4×K_1×V_1
GPU: 4" shape=rectangle]
		ring_stage2_3_5 [label="Ring Stage 3
Compute: Q_5×K_2×V_2
GPU: 5" shape=rectangle]
		ring_stage2_3_6 [label="Ring Stage 3
Compute: Q_6×K_3×V_3
GPU: 6" shape=rectangle]
		ring_stage2_3_7 [label="Ring Stage 3
Compute: Q_7×K_4×V_4
GPU: 7" shape=rectangle]
		ring_stage2_3_8 [label="Ring Stage 3
Compute: Q_8×K_5×V_5
GPU: 8" shape=rectangle]
		ring_stage2_3_9 [label="Ring Stage 3
Compute: Q_9×K_6×V_6
GPU: 9" shape=rectangle]
		ring_stage2_3_10 [label="Ring Stage 3
Compute: Q_10×K_7×V_7
GPU: 10" shape=rectangle]
		ring_stage2_3_11 [label="Ring Stage 3
Compute: Q_11×K_8×V_8
GPU: 11" shape=rectangle]
		ring_stage2_3_12 [label="Ring Stage 3
Compute: Q_12×K_9×V_9
GPU: 12" shape=rectangle]
		ring_stage2_3_13 [label="Ring Stage 3
Compute: Q_13×K_10×V_10
GPU: 13" shape=rectangle]
		ring_stage2_3_14 [label="Ring Stage 3
Compute: Q_14×K_11×V_11
GPU: 14" shape=rectangle]
		ring_stage2_3_15 [label="Ring Stage 3
Compute: Q_15×K_12×V_12
GPU: 15" shape=rectangle]
		kv_send2_3_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_3_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_3_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_3_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_3_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_3_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_3_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_3_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_3_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_3_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_3_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_3_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_3_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_3_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_3_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_3_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_4_0 [label="Ring Stage 4
Compute: Q_0×K_12×V_12
GPU: 0" shape=rectangle]
		ring_stage2_4_1 [label="Ring Stage 4
Compute: Q_1×K_13×V_13
GPU: 1" shape=rectangle]
		ring_stage2_4_2 [label="Ring Stage 4
Compute: Q_2×K_14×V_14
GPU: 2" shape=rectangle]
		ring_stage2_4_3 [label="Ring Stage 4
Compute: Q_3×K_15×V_15
GPU: 3" shape=rectangle]
		ring_stage2_4_4 [label="Ring Stage 4
Compute: Q_4×K_0×V_0
GPU: 4" shape=rectangle]
		ring_stage2_4_5 [label="Ring Stage 4
Compute: Q_5×K_1×V_1
GPU: 5" shape=rectangle]
		ring_stage2_4_6 [label="Ring Stage 4
Compute: Q_6×K_2×V_2
GPU: 6" shape=rectangle]
		ring_stage2_4_7 [label="Ring Stage 4
Compute: Q_7×K_3×V_3
GPU: 7" shape=rectangle]
		ring_stage2_4_8 [label="Ring Stage 4
Compute: Q_8×K_4×V_4
GPU: 8" shape=rectangle]
		ring_stage2_4_9 [label="Ring Stage 4
Compute: Q_9×K_5×V_5
GPU: 9" shape=rectangle]
		ring_stage2_4_10 [label="Ring Stage 4
Compute: Q_10×K_6×V_6
GPU: 10" shape=rectangle]
		ring_stage2_4_11 [label="Ring Stage 4
Compute: Q_11×K_7×V_7
GPU: 11" shape=rectangle]
		ring_stage2_4_12 [label="Ring Stage 4
Compute: Q_12×K_8×V_8
GPU: 12" shape=rectangle]
		ring_stage2_4_13 [label="Ring Stage 4
Compute: Q_13×K_9×V_9
GPU: 13" shape=rectangle]
		ring_stage2_4_14 [label="Ring Stage 4
Compute: Q_14×K_10×V_10
GPU: 14" shape=rectangle]
		ring_stage2_4_15 [label="Ring Stage 4
Compute: Q_15×K_11×V_11
GPU: 15" shape=rectangle]
		kv_send2_4_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_4_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_4_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_4_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_4_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_4_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_4_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_4_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_4_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_4_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_4_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_4_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_4_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_4_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_4_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_4_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_5_0 [label="Ring Stage 5
Compute: Q_0×K_11×V_11
GPU: 0" shape=rectangle]
		ring_stage2_5_1 [label="Ring Stage 5
Compute: Q_1×K_12×V_12
GPU: 1" shape=rectangle]
		ring_stage2_5_2 [label="Ring Stage 5
Compute: Q_2×K_13×V_13
GPU: 2" shape=rectangle]
		ring_stage2_5_3 [label="Ring Stage 5
Compute: Q_3×K_14×V_14
GPU: 3" shape=rectangle]
		ring_stage2_5_4 [label="Ring Stage 5
Compute: Q_4×K_15×V_15
GPU: 4" shape=rectangle]
		ring_stage2_5_5 [label="Ring Stage 5
Compute: Q_5×K_0×V_0
GPU: 5" shape=rectangle]
		ring_stage2_5_6 [label="Ring Stage 5
Compute: Q_6×K_1×V_1
GPU: 6" shape=rectangle]
		ring_stage2_5_7 [label="Ring Stage 5
Compute: Q_7×K_2×V_2
GPU: 7" shape=rectangle]
		ring_stage2_5_8 [label="Ring Stage 5
Compute: Q_8×K_3×V_3
GPU: 8" shape=rectangle]
		ring_stage2_5_9 [label="Ring Stage 5
Compute: Q_9×K_4×V_4
GPU: 9" shape=rectangle]
		ring_stage2_5_10 [label="Ring Stage 5
Compute: Q_10×K_5×V_5
GPU: 10" shape=rectangle]
		ring_stage2_5_11 [label="Ring Stage 5
Compute: Q_11×K_6×V_6
GPU: 11" shape=rectangle]
		ring_stage2_5_12 [label="Ring Stage 5
Compute: Q_12×K_7×V_7
GPU: 12" shape=rectangle]
		ring_stage2_5_13 [label="Ring Stage 5
Compute: Q_13×K_8×V_8
GPU: 13" shape=rectangle]
		ring_stage2_5_14 [label="Ring Stage 5
Compute: Q_14×K_9×V_9
GPU: 14" shape=rectangle]
		ring_stage2_5_15 [label="Ring Stage 5
Compute: Q_15×K_10×V_10
GPU: 15" shape=rectangle]
		kv_send2_5_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_5_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_5_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_5_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_5_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_5_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_5_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_5_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_5_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_5_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_5_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_5_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_5_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_5_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_5_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_5_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_6_0 [label="Ring Stage 6
Compute: Q_0×K_10×V_10
GPU: 0" shape=rectangle]
		ring_stage2_6_1 [label="Ring Stage 6
Compute: Q_1×K_11×V_11
GPU: 1" shape=rectangle]
		ring_stage2_6_2 [label="Ring Stage 6
Compute: Q_2×K_12×V_12
GPU: 2" shape=rectangle]
		ring_stage2_6_3 [label="Ring Stage 6
Compute: Q_3×K_13×V_13
GPU: 3" shape=rectangle]
		ring_stage2_6_4 [label="Ring Stage 6
Compute: Q_4×K_14×V_14
GPU: 4" shape=rectangle]
		ring_stage2_6_5 [label="Ring Stage 6
Compute: Q_5×K_15×V_15
GPU: 5" shape=rectangle]
		ring_stage2_6_6 [label="Ring Stage 6
Compute: Q_6×K_0×V_0
GPU: 6" shape=rectangle]
		ring_stage2_6_7 [label="Ring Stage 6
Compute: Q_7×K_1×V_1
GPU: 7" shape=rectangle]
		ring_stage2_6_8 [label="Ring Stage 6
Compute: Q_8×K_2×V_2
GPU: 8" shape=rectangle]
		ring_stage2_6_9 [label="Ring Stage 6
Compute: Q_9×K_3×V_3
GPU: 9" shape=rectangle]
		ring_stage2_6_10 [label="Ring Stage 6
Compute: Q_10×K_4×V_4
GPU: 10" shape=rectangle]
		ring_stage2_6_11 [label="Ring Stage 6
Compute: Q_11×K_5×V_5
GPU: 11" shape=rectangle]
		ring_stage2_6_12 [label="Ring Stage 6
Compute: Q_12×K_6×V_6
GPU: 12" shape=rectangle]
		ring_stage2_6_13 [label="Ring Stage 6
Compute: Q_13×K_7×V_7
GPU: 13" shape=rectangle]
		ring_stage2_6_14 [label="Ring Stage 6
Compute: Q_14×K_8×V_8
GPU: 14" shape=rectangle]
		ring_stage2_6_15 [label="Ring Stage 6
Compute: Q_15×K_9×V_9
GPU: 15" shape=rectangle]
		kv_send2_6_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_6_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_6_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_6_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_6_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_6_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_6_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_6_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_6_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_6_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_6_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_6_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_6_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_6_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_6_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_6_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_7_0 [label="Ring Stage 7
Compute: Q_0×K_9×V_9
GPU: 0" shape=rectangle]
		ring_stage2_7_1 [label="Ring Stage 7
Compute: Q_1×K_10×V_10
GPU: 1" shape=rectangle]
		ring_stage2_7_2 [label="Ring Stage 7
Compute: Q_2×K_11×V_11
GPU: 2" shape=rectangle]
		ring_stage2_7_3 [label="Ring Stage 7
Compute: Q_3×K_12×V_12
GPU: 3" shape=rectangle]
		ring_stage2_7_4 [label="Ring Stage 7
Compute: Q_4×K_13×V_13
GPU: 4" shape=rectangle]
		ring_stage2_7_5 [label="Ring Stage 7
Compute: Q_5×K_14×V_14
GPU: 5" shape=rectangle]
		ring_stage2_7_6 [label="Ring Stage 7
Compute: Q_6×K_15×V_15
GPU: 6" shape=rectangle]
		ring_stage2_7_7 [label="Ring Stage 7
Compute: Q_7×K_0×V_0
GPU: 7" shape=rectangle]
		ring_stage2_7_8 [label="Ring Stage 7
Compute: Q_8×K_1×V_1
GPU: 8" shape=rectangle]
		ring_stage2_7_9 [label="Ring Stage 7
Compute: Q_9×K_2×V_2
GPU: 9" shape=rectangle]
		ring_stage2_7_10 [label="Ring Stage 7
Compute: Q_10×K_3×V_3
GPU: 10" shape=rectangle]
		ring_stage2_7_11 [label="Ring Stage 7
Compute: Q_11×K_4×V_4
GPU: 11" shape=rectangle]
		ring_stage2_7_12 [label="Ring Stage 7
Compute: Q_12×K_5×V_5
GPU: 12" shape=rectangle]
		ring_stage2_7_13 [label="Ring Stage 7
Compute: Q_13×K_6×V_6
GPU: 13" shape=rectangle]
		ring_stage2_7_14 [label="Ring Stage 7
Compute: Q_14×K_7×V_7
GPU: 14" shape=rectangle]
		ring_stage2_7_15 [label="Ring Stage 7
Compute: Q_15×K_8×V_8
GPU: 15" shape=rectangle]
		kv_send2_7_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_7_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_7_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_7_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_7_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_7_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_7_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_7_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_7_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_7_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_7_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_7_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_7_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_7_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_7_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_7_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_8_0 [label="Ring Stage 8
Compute: Q_0×K_8×V_8
GPU: 0" shape=rectangle]
		ring_stage2_8_1 [label="Ring Stage 8
Compute: Q_1×K_9×V_9
GPU: 1" shape=rectangle]
		ring_stage2_8_2 [label="Ring Stage 8
Compute: Q_2×K_10×V_10
GPU: 2" shape=rectangle]
		ring_stage2_8_3 [label="Ring Stage 8
Compute: Q_3×K_11×V_11
GPU: 3" shape=rectangle]
		ring_stage2_8_4 [label="Ring Stage 8
Compute: Q_4×K_12×V_12
GPU: 4" shape=rectangle]
		ring_stage2_8_5 [label="Ring Stage 8
Compute: Q_5×K_13×V_13
GPU: 5" shape=rectangle]
		ring_stage2_8_6 [label="Ring Stage 8
Compute: Q_6×K_14×V_14
GPU: 6" shape=rectangle]
		ring_stage2_8_7 [label="Ring Stage 8
Compute: Q_7×K_15×V_15
GPU: 7" shape=rectangle]
		ring_stage2_8_8 [label="Ring Stage 8
Compute: Q_8×K_0×V_0
GPU: 8" shape=rectangle]
		ring_stage2_8_9 [label="Ring Stage 8
Compute: Q_9×K_1×V_1
GPU: 9" shape=rectangle]
		ring_stage2_8_10 [label="Ring Stage 8
Compute: Q_10×K_2×V_2
GPU: 10" shape=rectangle]
		ring_stage2_8_11 [label="Ring Stage 8
Compute: Q_11×K_3×V_3
GPU: 11" shape=rectangle]
		ring_stage2_8_12 [label="Ring Stage 8
Compute: Q_12×K_4×V_4
GPU: 12" shape=rectangle]
		ring_stage2_8_13 [label="Ring Stage 8
Compute: Q_13×K_5×V_5
GPU: 13" shape=rectangle]
		ring_stage2_8_14 [label="Ring Stage 8
Compute: Q_14×K_6×V_6
GPU: 14" shape=rectangle]
		ring_stage2_8_15 [label="Ring Stage 8
Compute: Q_15×K_7×V_7
GPU: 15" shape=rectangle]
		kv_send2_8_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_8_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_8_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_8_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_8_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_8_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_8_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_8_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_8_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_8_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_8_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_8_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_8_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_8_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_8_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_8_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_9_0 [label="Ring Stage 9
Compute: Q_0×K_7×V_7
GPU: 0" shape=rectangle]
		ring_stage2_9_1 [label="Ring Stage 9
Compute: Q_1×K_8×V_8
GPU: 1" shape=rectangle]
		ring_stage2_9_2 [label="Ring Stage 9
Compute: Q_2×K_9×V_9
GPU: 2" shape=rectangle]
		ring_stage2_9_3 [label="Ring Stage 9
Compute: Q_3×K_10×V_10
GPU: 3" shape=rectangle]
		ring_stage2_9_4 [label="Ring Stage 9
Compute: Q_4×K_11×V_11
GPU: 4" shape=rectangle]
		ring_stage2_9_5 [label="Ring Stage 9
Compute: Q_5×K_12×V_12
GPU: 5" shape=rectangle]
		ring_stage2_9_6 [label="Ring Stage 9
Compute: Q_6×K_13×V_13
GPU: 6" shape=rectangle]
		ring_stage2_9_7 [label="Ring Stage 9
Compute: Q_7×K_14×V_14
GPU: 7" shape=rectangle]
		ring_stage2_9_8 [label="Ring Stage 9
Compute: Q_8×K_15×V_15
GPU: 8" shape=rectangle]
		ring_stage2_9_9 [label="Ring Stage 9
Compute: Q_9×K_0×V_0
GPU: 9" shape=rectangle]
		ring_stage2_9_10 [label="Ring Stage 9
Compute: Q_10×K_1×V_1
GPU: 10" shape=rectangle]
		ring_stage2_9_11 [label="Ring Stage 9
Compute: Q_11×K_2×V_2
GPU: 11" shape=rectangle]
		ring_stage2_9_12 [label="Ring Stage 9
Compute: Q_12×K_3×V_3
GPU: 12" shape=rectangle]
		ring_stage2_9_13 [label="Ring Stage 9
Compute: Q_13×K_4×V_4
GPU: 13" shape=rectangle]
		ring_stage2_9_14 [label="Ring Stage 9
Compute: Q_14×K_5×V_5
GPU: 14" shape=rectangle]
		ring_stage2_9_15 [label="Ring Stage 9
Compute: Q_15×K_6×V_6
GPU: 15" shape=rectangle]
		kv_send2_9_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_9_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_9_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_9_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_9_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_9_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_9_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_9_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_9_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_9_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_9_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_9_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_9_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_9_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_9_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_9_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_10_0 [label="Ring Stage 10
Compute: Q_0×K_6×V_6
GPU: 0" shape=rectangle]
		ring_stage2_10_1 [label="Ring Stage 10
Compute: Q_1×K_7×V_7
GPU: 1" shape=rectangle]
		ring_stage2_10_2 [label="Ring Stage 10
Compute: Q_2×K_8×V_8
GPU: 2" shape=rectangle]
		ring_stage2_10_3 [label="Ring Stage 10
Compute: Q_3×K_9×V_9
GPU: 3" shape=rectangle]
		ring_stage2_10_4 [label="Ring Stage 10
Compute: Q_4×K_10×V_10
GPU: 4" shape=rectangle]
		ring_stage2_10_5 [label="Ring Stage 10
Compute: Q_5×K_11×V_11
GPU: 5" shape=rectangle]
		ring_stage2_10_6 [label="Ring Stage 10
Compute: Q_6×K_12×V_12
GPU: 6" shape=rectangle]
		ring_stage2_10_7 [label="Ring Stage 10
Compute: Q_7×K_13×V_13
GPU: 7" shape=rectangle]
		ring_stage2_10_8 [label="Ring Stage 10
Compute: Q_8×K_14×V_14
GPU: 8" shape=rectangle]
		ring_stage2_10_9 [label="Ring Stage 10
Compute: Q_9×K_15×V_15
GPU: 9" shape=rectangle]
		ring_stage2_10_10 [label="Ring Stage 10
Compute: Q_10×K_0×V_0
GPU: 10" shape=rectangle]
		ring_stage2_10_11 [label="Ring Stage 10
Compute: Q_11×K_1×V_1
GPU: 11" shape=rectangle]
		ring_stage2_10_12 [label="Ring Stage 10
Compute: Q_12×K_2×V_2
GPU: 12" shape=rectangle]
		ring_stage2_10_13 [label="Ring Stage 10
Compute: Q_13×K_3×V_3
GPU: 13" shape=rectangle]
		ring_stage2_10_14 [label="Ring Stage 10
Compute: Q_14×K_4×V_4
GPU: 14" shape=rectangle]
		ring_stage2_10_15 [label="Ring Stage 10
Compute: Q_15×K_5×V_5
GPU: 15" shape=rectangle]
		kv_send2_10_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_10_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_10_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_10_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_10_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_10_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_10_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_10_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_10_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_10_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_10_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_10_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_10_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_10_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_10_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_10_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_11_0 [label="Ring Stage 11
Compute: Q_0×K_5×V_5
GPU: 0" shape=rectangle]
		ring_stage2_11_1 [label="Ring Stage 11
Compute: Q_1×K_6×V_6
GPU: 1" shape=rectangle]
		ring_stage2_11_2 [label="Ring Stage 11
Compute: Q_2×K_7×V_7
GPU: 2" shape=rectangle]
		ring_stage2_11_3 [label="Ring Stage 11
Compute: Q_3×K_8×V_8
GPU: 3" shape=rectangle]
		ring_stage2_11_4 [label="Ring Stage 11
Compute: Q_4×K_9×V_9
GPU: 4" shape=rectangle]
		ring_stage2_11_5 [label="Ring Stage 11
Compute: Q_5×K_10×V_10
GPU: 5" shape=rectangle]
		ring_stage2_11_6 [label="Ring Stage 11
Compute: Q_6×K_11×V_11
GPU: 6" shape=rectangle]
		ring_stage2_11_7 [label="Ring Stage 11
Compute: Q_7×K_12×V_12
GPU: 7" shape=rectangle]
		ring_stage2_11_8 [label="Ring Stage 11
Compute: Q_8×K_13×V_13
GPU: 8" shape=rectangle]
		ring_stage2_11_9 [label="Ring Stage 11
Compute: Q_9×K_14×V_14
GPU: 9" shape=rectangle]
		ring_stage2_11_10 [label="Ring Stage 11
Compute: Q_10×K_15×V_15
GPU: 10" shape=rectangle]
		ring_stage2_11_11 [label="Ring Stage 11
Compute: Q_11×K_0×V_0
GPU: 11" shape=rectangle]
		ring_stage2_11_12 [label="Ring Stage 11
Compute: Q_12×K_1×V_1
GPU: 12" shape=rectangle]
		ring_stage2_11_13 [label="Ring Stage 11
Compute: Q_13×K_2×V_2
GPU: 13" shape=rectangle]
		ring_stage2_11_14 [label="Ring Stage 11
Compute: Q_14×K_3×V_3
GPU: 14" shape=rectangle]
		ring_stage2_11_15 [label="Ring Stage 11
Compute: Q_15×K_4×V_4
GPU: 15" shape=rectangle]
		kv_send2_11_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_11_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_11_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_11_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_11_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_11_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_11_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_11_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_11_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_11_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_11_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_11_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_11_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_11_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_11_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_11_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_12_0 [label="Ring Stage 12
Compute: Q_0×K_4×V_4
GPU: 0" shape=rectangle]
		ring_stage2_12_1 [label="Ring Stage 12
Compute: Q_1×K_5×V_5
GPU: 1" shape=rectangle]
		ring_stage2_12_2 [label="Ring Stage 12
Compute: Q_2×K_6×V_6
GPU: 2" shape=rectangle]
		ring_stage2_12_3 [label="Ring Stage 12
Compute: Q_3×K_7×V_7
GPU: 3" shape=rectangle]
		ring_stage2_12_4 [label="Ring Stage 12
Compute: Q_4×K_8×V_8
GPU: 4" shape=rectangle]
		ring_stage2_12_5 [label="Ring Stage 12
Compute: Q_5×K_9×V_9
GPU: 5" shape=rectangle]
		ring_stage2_12_6 [label="Ring Stage 12
Compute: Q_6×K_10×V_10
GPU: 6" shape=rectangle]
		ring_stage2_12_7 [label="Ring Stage 12
Compute: Q_7×K_11×V_11
GPU: 7" shape=rectangle]
		ring_stage2_12_8 [label="Ring Stage 12
Compute: Q_8×K_12×V_12
GPU: 8" shape=rectangle]
		ring_stage2_12_9 [label="Ring Stage 12
Compute: Q_9×K_13×V_13
GPU: 9" shape=rectangle]
		ring_stage2_12_10 [label="Ring Stage 12
Compute: Q_10×K_14×V_14
GPU: 10" shape=rectangle]
		ring_stage2_12_11 [label="Ring Stage 12
Compute: Q_11×K_15×V_15
GPU: 11" shape=rectangle]
		ring_stage2_12_12 [label="Ring Stage 12
Compute: Q_12×K_0×V_0
GPU: 12" shape=rectangle]
		ring_stage2_12_13 [label="Ring Stage 12
Compute: Q_13×K_1×V_1
GPU: 13" shape=rectangle]
		ring_stage2_12_14 [label="Ring Stage 12
Compute: Q_14×K_2×V_2
GPU: 14" shape=rectangle]
		ring_stage2_12_15 [label="Ring Stage 12
Compute: Q_15×K_3×V_3
GPU: 15" shape=rectangle]
		kv_send2_12_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_12_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_12_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_12_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_12_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_12_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_12_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_12_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_12_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_12_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_12_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_12_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_12_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_12_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_12_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_12_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_13_0 [label="Ring Stage 13
Compute: Q_0×K_3×V_3
GPU: 0" shape=rectangle]
		ring_stage2_13_1 [label="Ring Stage 13
Compute: Q_1×K_4×V_4
GPU: 1" shape=rectangle]
		ring_stage2_13_2 [label="Ring Stage 13
Compute: Q_2×K_5×V_5
GPU: 2" shape=rectangle]
		ring_stage2_13_3 [label="Ring Stage 13
Compute: Q_3×K_6×V_6
GPU: 3" shape=rectangle]
		ring_stage2_13_4 [label="Ring Stage 13
Compute: Q_4×K_7×V_7
GPU: 4" shape=rectangle]
		ring_stage2_13_5 [label="Ring Stage 13
Compute: Q_5×K_8×V_8
GPU: 5" shape=rectangle]
		ring_stage2_13_6 [label="Ring Stage 13
Compute: Q_6×K_9×V_9
GPU: 6" shape=rectangle]
		ring_stage2_13_7 [label="Ring Stage 13
Compute: Q_7×K_10×V_10
GPU: 7" shape=rectangle]
		ring_stage2_13_8 [label="Ring Stage 13
Compute: Q_8×K_11×V_11
GPU: 8" shape=rectangle]
		ring_stage2_13_9 [label="Ring Stage 13
Compute: Q_9×K_12×V_12
GPU: 9" shape=rectangle]
		ring_stage2_13_10 [label="Ring Stage 13
Compute: Q_10×K_13×V_13
GPU: 10" shape=rectangle]
		ring_stage2_13_11 [label="Ring Stage 13
Compute: Q_11×K_14×V_14
GPU: 11" shape=rectangle]
		ring_stage2_13_12 [label="Ring Stage 13
Compute: Q_12×K_15×V_15
GPU: 12" shape=rectangle]
		ring_stage2_13_13 [label="Ring Stage 13
Compute: Q_13×K_0×V_0
GPU: 13" shape=rectangle]
		ring_stage2_13_14 [label="Ring Stage 13
Compute: Q_14×K_1×V_1
GPU: 14" shape=rectangle]
		ring_stage2_13_15 [label="Ring Stage 13
Compute: Q_15×K_2×V_2
GPU: 15" shape=rectangle]
		kv_send2_13_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_13_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_13_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_13_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_13_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_13_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_13_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_13_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_13_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_13_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_13_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_13_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_13_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_13_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_13_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_13_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_14_0 [label="Ring Stage 14
Compute: Q_0×K_2×V_2
GPU: 0" shape=rectangle]
		ring_stage2_14_1 [label="Ring Stage 14
Compute: Q_1×K_3×V_3
GPU: 1" shape=rectangle]
		ring_stage2_14_2 [label="Ring Stage 14
Compute: Q_2×K_4×V_4
GPU: 2" shape=rectangle]
		ring_stage2_14_3 [label="Ring Stage 14
Compute: Q_3×K_5×V_5
GPU: 3" shape=rectangle]
		ring_stage2_14_4 [label="Ring Stage 14
Compute: Q_4×K_6×V_6
GPU: 4" shape=rectangle]
		ring_stage2_14_5 [label="Ring Stage 14
Compute: Q_5×K_7×V_7
GPU: 5" shape=rectangle]
		ring_stage2_14_6 [label="Ring Stage 14
Compute: Q_6×K_8×V_8
GPU: 6" shape=rectangle]
		ring_stage2_14_7 [label="Ring Stage 14
Compute: Q_7×K_9×V_9
GPU: 7" shape=rectangle]
		ring_stage2_14_8 [label="Ring Stage 14
Compute: Q_8×K_10×V_10
GPU: 8" shape=rectangle]
		ring_stage2_14_9 [label="Ring Stage 14
Compute: Q_9×K_11×V_11
GPU: 9" shape=rectangle]
		ring_stage2_14_10 [label="Ring Stage 14
Compute: Q_10×K_12×V_12
GPU: 10" shape=rectangle]
		ring_stage2_14_11 [label="Ring Stage 14
Compute: Q_11×K_13×V_13
GPU: 11" shape=rectangle]
		ring_stage2_14_12 [label="Ring Stage 14
Compute: Q_12×K_14×V_14
GPU: 12" shape=rectangle]
		ring_stage2_14_13 [label="Ring Stage 14
Compute: Q_13×K_15×V_15
GPU: 13" shape=rectangle]
		ring_stage2_14_14 [label="Ring Stage 14
Compute: Q_14×K_0×V_0
GPU: 14" shape=rectangle]
		ring_stage2_14_15 [label="Ring Stage 14
Compute: Q_15×K_1×V_1
GPU: 15" shape=rectangle]
		kv_send2_14_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_14_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_14_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_14_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_14_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_14_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_14_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_14_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_14_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_14_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_14_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_14_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_14_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_14_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_14_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_14_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage2_15_0 [label="Ring Stage 15
Compute: Q_0×K_1×V_1
GPU: 0" shape=rectangle]
		ring_stage2_15_1 [label="Ring Stage 15
Compute: Q_1×K_2×V_2
GPU: 1" shape=rectangle]
		ring_stage2_15_2 [label="Ring Stage 15
Compute: Q_2×K_3×V_3
GPU: 2" shape=rectangle]
		ring_stage2_15_3 [label="Ring Stage 15
Compute: Q_3×K_4×V_4
GPU: 3" shape=rectangle]
		ring_stage2_15_4 [label="Ring Stage 15
Compute: Q_4×K_5×V_5
GPU: 4" shape=rectangle]
		ring_stage2_15_5 [label="Ring Stage 15
Compute: Q_5×K_6×V_6
GPU: 5" shape=rectangle]
		ring_stage2_15_6 [label="Ring Stage 15
Compute: Q_6×K_7×V_7
GPU: 6" shape=rectangle]
		ring_stage2_15_7 [label="Ring Stage 15
Compute: Q_7×K_8×V_8
GPU: 7" shape=rectangle]
		ring_stage2_15_8 [label="Ring Stage 15
Compute: Q_8×K_9×V_9
GPU: 8" shape=rectangle]
		ring_stage2_15_9 [label="Ring Stage 15
Compute: Q_9×K_10×V_10
GPU: 9" shape=rectangle]
		ring_stage2_15_10 [label="Ring Stage 15
Compute: Q_10×K_11×V_11
GPU: 10" shape=rectangle]
		ring_stage2_15_11 [label="Ring Stage 15
Compute: Q_11×K_12×V_12
GPU: 11" shape=rectangle]
		ring_stage2_15_12 [label="Ring Stage 15
Compute: Q_12×K_13×V_13
GPU: 12" shape=rectangle]
		ring_stage2_15_13 [label="Ring Stage 15
Compute: Q_13×K_14×V_14
GPU: 13" shape=rectangle]
		ring_stage2_15_14 [label="Ring Stage 15
Compute: Q_14×K_15×V_15
GPU: 14" shape=rectangle]
		ring_stage2_15_15 [label="Ring Stage 15
Compute: Q_15×K_0×V_0
GPU: 15" shape=rectangle]
		kv_send2_15_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send2_15_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send2_15_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send2_15_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send2_15_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send2_15_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send2_15_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send2_15_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send2_15_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send2_15_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send2_15_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send2_15_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send2_15_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send2_15_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send2_15_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send2_15_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		accum2_0 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		accum2_1 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		accum2_2 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		accum2_3 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		accum2_4 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		accum2_5 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		accum2_6 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		accum2_7 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		accum2_8 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		accum2_9 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		accum2_10 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		accum2_11 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		accum2_12 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		accum2_13 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		accum2_14 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		accum2_15 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		out_proj2_0 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		out_proj2_1 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		out_proj2_2 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		out_proj2_3 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		out_proj2_4 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		out_proj2_5 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		out_proj2_6 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		out_proj2_7 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		out_proj2_8 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		out_proj2_9 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		out_proj2_10 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		out_proj2_11 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		out_proj2_12 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		out_proj2_13 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		out_proj2_14 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		out_proj2_15 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
	}
	subgraph cluster_moe2 {
		label="Mixture of Experts"
		gate2_0 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 0" shape=diamond]
		gate2_1 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 1" shape=diamond]
		gate2_2 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 2" shape=diamond]
		gate2_3 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 3" shape=diamond]
		gate2_4 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 4" shape=diamond]
		gate2_5 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 5" shape=diamond]
		gate2_6 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 6" shape=diamond]
		gate2_7 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 7" shape=diamond]
		gate2_8 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 8" shape=diamond]
		gate2_9 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 9" shape=diamond]
		gate2_10 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 10" shape=diamond]
		gate2_11 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 11" shape=diamond]
		gate2_12 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 12" shape=diamond]
		gate2_13 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 13" shape=diamond]
		gate2_14 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 14" shape=diamond]
		gate2_15 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 15" shape=diamond]
		select2_0 [label="Select Top-2 Experts
GPU: 0" shape=parallelogram]
		select2_1 [label="Select Top-2 Experts
GPU: 1" shape=parallelogram]
		select2_2 [label="Select Top-2 Experts
GPU: 2" shape=parallelogram]
		select2_3 [label="Select Top-2 Experts
GPU: 3" shape=parallelogram]
		select2_4 [label="Select Top-2 Experts
GPU: 4" shape=parallelogram]
		select2_5 [label="Select Top-2 Experts
GPU: 5" shape=parallelogram]
		select2_6 [label="Select Top-2 Experts
GPU: 6" shape=parallelogram]
		select2_7 [label="Select Top-2 Experts
GPU: 7" shape=parallelogram]
		select2_8 [label="Select Top-2 Experts
GPU: 8" shape=parallelogram]
		select2_9 [label="Select Top-2 Experts
GPU: 9" shape=parallelogram]
		select2_10 [label="Select Top-2 Experts
GPU: 10" shape=parallelogram]
		select2_11 [label="Select Top-2 Experts
GPU: 11" shape=parallelogram]
		select2_12 [label="Select Top-2 Experts
GPU: 12" shape=parallelogram]
		select2_13 [label="Select Top-2 Experts
GPU: 13" shape=parallelogram]
		select2_14 [label="Select Top-2 Experts
GPU: 14" shape=parallelogram]
		select2_15 [label="Select Top-2 Experts
GPU: 15" shape=parallelogram]
		expert2_0_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_0 [label="Expert 0 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_1 [label="Expert 1 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_2 [label="Expert 2 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_3 [label="Expert 3 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_4 [label="Expert 4 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_5 [label="Expert 5 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_6 [label="Expert 6 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_0_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act2_0_7 [label="Expert 7 GELU
GPU: 0" shape=rectangle]
		expert_out2_0_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert2_1_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_0 [label="Expert 0 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_1 [label="Expert 1 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_2 [label="Expert 2 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_3 [label="Expert 3 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_4 [label="Expert 4 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_5 [label="Expert 5 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_6 [label="Expert 6 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_1_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act2_1_7 [label="Expert 7 GELU
GPU: 1" shape=rectangle]
		expert_out2_1_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert2_2_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_0 [label="Expert 0 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_1 [label="Expert 1 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_2 [label="Expert 2 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_3 [label="Expert 3 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_4 [label="Expert 4 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_5 [label="Expert 5 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_6 [label="Expert 6 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_2_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act2_2_7 [label="Expert 7 GELU
GPU: 2" shape=rectangle]
		expert_out2_2_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert2_3_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_0 [label="Expert 0 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_1 [label="Expert 1 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_2 [label="Expert 2 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_3 [label="Expert 3 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_4 [label="Expert 4 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_5 [label="Expert 5 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_6 [label="Expert 6 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_3_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act2_3_7 [label="Expert 7 GELU
GPU: 3" shape=rectangle]
		expert_out2_3_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert2_4_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_0 [label="Expert 0 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_1 [label="Expert 1 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_2 [label="Expert 2 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_3 [label="Expert 3 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_4 [label="Expert 4 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_5 [label="Expert 5 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_6 [label="Expert 6 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_4_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act2_4_7 [label="Expert 7 GELU
GPU: 4" shape=rectangle]
		expert_out2_4_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert2_5_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_0 [label="Expert 0 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_1 [label="Expert 1 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_2 [label="Expert 2 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_3 [label="Expert 3 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_4 [label="Expert 4 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_5 [label="Expert 5 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_6 [label="Expert 6 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_5_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act2_5_7 [label="Expert 7 GELU
GPU: 5" shape=rectangle]
		expert_out2_5_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert2_6_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_0 [label="Expert 0 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_1 [label="Expert 1 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_2 [label="Expert 2 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_3 [label="Expert 3 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_4 [label="Expert 4 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_5 [label="Expert 5 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_6 [label="Expert 6 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_6_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act2_6_7 [label="Expert 7 GELU
GPU: 6" shape=rectangle]
		expert_out2_6_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert2_7_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_0 [label="Expert 0 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_1 [label="Expert 1 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_2 [label="Expert 2 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_3 [label="Expert 3 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_4 [label="Expert 4 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_5 [label="Expert 5 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_6 [label="Expert 6 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_7_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act2_7_7 [label="Expert 7 GELU
GPU: 7" shape=rectangle]
		expert_out2_7_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert2_8_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_0 [label="Expert 0 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_1 [label="Expert 1 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_2 [label="Expert 2 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_3 [label="Expert 3 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_4 [label="Expert 4 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_5 [label="Expert 5 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_6 [label="Expert 6 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_8_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act2_8_7 [label="Expert 7 GELU
GPU: 8" shape=rectangle]
		expert_out2_8_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert2_9_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_0 [label="Expert 0 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_1 [label="Expert 1 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_2 [label="Expert 2 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_3 [label="Expert 3 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_4 [label="Expert 4 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_5 [label="Expert 5 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_6 [label="Expert 6 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_9_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act2_9_7 [label="Expert 7 GELU
GPU: 9" shape=rectangle]
		expert_out2_9_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert2_10_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_0 [label="Expert 0 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_1 [label="Expert 1 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_2 [label="Expert 2 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_3 [label="Expert 3 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_4 [label="Expert 4 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_5 [label="Expert 5 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_6 [label="Expert 6 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_10_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act2_10_7 [label="Expert 7 GELU
GPU: 10" shape=rectangle]
		expert_out2_10_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert2_11_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_0 [label="Expert 0 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_1 [label="Expert 1 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_2 [label="Expert 2 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_3 [label="Expert 3 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_4 [label="Expert 4 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_5 [label="Expert 5 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_6 [label="Expert 6 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_11_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act2_11_7 [label="Expert 7 GELU
GPU: 11" shape=rectangle]
		expert_out2_11_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert2_12_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_0 [label="Expert 0 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_1 [label="Expert 1 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_2 [label="Expert 2 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_3 [label="Expert 3 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_4 [label="Expert 4 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_5 [label="Expert 5 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_6 [label="Expert 6 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_12_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act2_12_7 [label="Expert 7 GELU
GPU: 12" shape=rectangle]
		expert_out2_12_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert2_13_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_0 [label="Expert 0 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_1 [label="Expert 1 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_2 [label="Expert 2 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_3 [label="Expert 3 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_4 [label="Expert 4 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_5 [label="Expert 5 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_6 [label="Expert 6 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_13_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act2_13_7 [label="Expert 7 GELU
GPU: 13" shape=rectangle]
		expert_out2_13_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert2_14_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_0 [label="Expert 0 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_1 [label="Expert 1 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_2 [label="Expert 2 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_3 [label="Expert 3 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_4 [label="Expert 4 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_5 [label="Expert 5 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_6 [label="Expert 6 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_14_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act2_14_7 [label="Expert 7 GELU
GPU: 14" shape=rectangle]
		expert_out2_14_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert2_15_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_0 [label="Expert 0 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_1 [label="Expert 1 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_2 [label="Expert 2 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_3 [label="Expert 3 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_4 [label="Expert 4 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_5 [label="Expert 5 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_6 [label="Expert 6 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert2_15_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act2_15_7 [label="Expert 7 GELU
GPU: 15" shape=rectangle]
		expert_out2_15_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		combine2_0 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 0" shape=parallelogram]
		combine2_1 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 1" shape=parallelogram]
		combine2_2 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 2" shape=parallelogram]
		combine2_3 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 3" shape=parallelogram]
		combine2_4 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 4" shape=parallelogram]
		combine2_5 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 5" shape=parallelogram]
		combine2_6 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 6" shape=parallelogram]
		combine2_7 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 7" shape=parallelogram]
		combine2_8 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 8" shape=parallelogram]
		combine2_9 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 9" shape=parallelogram]
		combine2_10 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 10" shape=parallelogram]
		combine2_11 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 11" shape=parallelogram]
		combine2_12 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 12" shape=parallelogram]
		combine2_13 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 13" shape=parallelogram]
		combine2_14 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 14" shape=parallelogram]
		combine2_15 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_layer2 {
		label="Layer 2"
		res_attn2_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_attn2_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_attn2_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_attn2_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_attn2_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_attn2_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_attn2_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_attn2_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_attn2_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_attn2_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_attn2_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_attn2_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_attn2_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_attn2_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_attn2_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_attn2_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		res_moe2_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_moe2_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_moe2_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_moe2_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_moe2_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_moe2_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_moe2_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_moe2_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_moe2_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_moe2_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_moe2_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_moe2_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_moe2_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_moe2_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_moe2_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_moe2_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_ra_sp3 {
		label="Ring Attention + Sequence Parallel"
		qkv3_0 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		qkv3_1 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		qkv3_2 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		qkv3_3 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		qkv3_4 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		qkv3_5 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		qkv3_6 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		qkv3_7 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		qkv3_8 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		qkv3_9 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		qkv3_10 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		qkv3_11 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		qkv3_12 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		qkv3_13 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		qkv3_14 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		qkv3_15 [label="QKV Projection
[Q,K,V]: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		ring_stage3_0_0 [label="Ring Stage 0
Compute: Q_0×K_0×V_0
GPU: 0" shape=rectangle]
		ring_stage3_0_1 [label="Ring Stage 0
Compute: Q_1×K_1×V_1
GPU: 1" shape=rectangle]
		ring_stage3_0_2 [label="Ring Stage 0
Compute: Q_2×K_2×V_2
GPU: 2" shape=rectangle]
		ring_stage3_0_3 [label="Ring Stage 0
Compute: Q_3×K_3×V_3
GPU: 3" shape=rectangle]
		ring_stage3_0_4 [label="Ring Stage 0
Compute: Q_4×K_4×V_4
GPU: 4" shape=rectangle]
		ring_stage3_0_5 [label="Ring Stage 0
Compute: Q_5×K_5×V_5
GPU: 5" shape=rectangle]
		ring_stage3_0_6 [label="Ring Stage 0
Compute: Q_6×K_6×V_6
GPU: 6" shape=rectangle]
		ring_stage3_0_7 [label="Ring Stage 0
Compute: Q_7×K_7×V_7
GPU: 7" shape=rectangle]
		ring_stage3_0_8 [label="Ring Stage 0
Compute: Q_8×K_8×V_8
GPU: 8" shape=rectangle]
		ring_stage3_0_9 [label="Ring Stage 0
Compute: Q_9×K_9×V_9
GPU: 9" shape=rectangle]
		ring_stage3_0_10 [label="Ring Stage 0
Compute: Q_10×K_10×V_10
GPU: 10" shape=rectangle]
		ring_stage3_0_11 [label="Ring Stage 0
Compute: Q_11×K_11×V_11
GPU: 11" shape=rectangle]
		ring_stage3_0_12 [label="Ring Stage 0
Compute: Q_12×K_12×V_12
GPU: 12" shape=rectangle]
		ring_stage3_0_13 [label="Ring Stage 0
Compute: Q_13×K_13×V_13
GPU: 13" shape=rectangle]
		ring_stage3_0_14 [label="Ring Stage 0
Compute: Q_14×K_14×V_14
GPU: 14" shape=rectangle]
		ring_stage3_0_15 [label="Ring Stage 0
Compute: Q_15×K_15×V_15
GPU: 15" shape=rectangle]
		kv_send3_0_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_0_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_0_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_0_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_0_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_0_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_0_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_0_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_0_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_0_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_0_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_0_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_0_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_0_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_0_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_0_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_1_0 [label="Ring Stage 1
Compute: Q_0×K_15×V_15
GPU: 0" shape=rectangle]
		ring_stage3_1_1 [label="Ring Stage 1
Compute: Q_1×K_0×V_0
GPU: 1" shape=rectangle]
		ring_stage3_1_2 [label="Ring Stage 1
Compute: Q_2×K_1×V_1
GPU: 2" shape=rectangle]
		ring_stage3_1_3 [label="Ring Stage 1
Compute: Q_3×K_2×V_2
GPU: 3" shape=rectangle]
		ring_stage3_1_4 [label="Ring Stage 1
Compute: Q_4×K_3×V_3
GPU: 4" shape=rectangle]
		ring_stage3_1_5 [label="Ring Stage 1
Compute: Q_5×K_4×V_4
GPU: 5" shape=rectangle]
		ring_stage3_1_6 [label="Ring Stage 1
Compute: Q_6×K_5×V_5
GPU: 6" shape=rectangle]
		ring_stage3_1_7 [label="Ring Stage 1
Compute: Q_7×K_6×V_6
GPU: 7" shape=rectangle]
		ring_stage3_1_8 [label="Ring Stage 1
Compute: Q_8×K_7×V_7
GPU: 8" shape=rectangle]
		ring_stage3_1_9 [label="Ring Stage 1
Compute: Q_9×K_8×V_8
GPU: 9" shape=rectangle]
		ring_stage3_1_10 [label="Ring Stage 1
Compute: Q_10×K_9×V_9
GPU: 10" shape=rectangle]
		ring_stage3_1_11 [label="Ring Stage 1
Compute: Q_11×K_10×V_10
GPU: 11" shape=rectangle]
		ring_stage3_1_12 [label="Ring Stage 1
Compute: Q_12×K_11×V_11
GPU: 12" shape=rectangle]
		ring_stage3_1_13 [label="Ring Stage 1
Compute: Q_13×K_12×V_12
GPU: 13" shape=rectangle]
		ring_stage3_1_14 [label="Ring Stage 1
Compute: Q_14×K_13×V_13
GPU: 14" shape=rectangle]
		ring_stage3_1_15 [label="Ring Stage 1
Compute: Q_15×K_14×V_14
GPU: 15" shape=rectangle]
		kv_send3_1_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_1_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_1_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_1_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_1_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_1_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_1_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_1_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_1_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_1_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_1_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_1_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_1_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_1_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_1_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_1_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_2_0 [label="Ring Stage 2
Compute: Q_0×K_14×V_14
GPU: 0" shape=rectangle]
		ring_stage3_2_1 [label="Ring Stage 2
Compute: Q_1×K_15×V_15
GPU: 1" shape=rectangle]
		ring_stage3_2_2 [label="Ring Stage 2
Compute: Q_2×K_0×V_0
GPU: 2" shape=rectangle]
		ring_stage3_2_3 [label="Ring Stage 2
Compute: Q_3×K_1×V_1
GPU: 3" shape=rectangle]
		ring_stage3_2_4 [label="Ring Stage 2
Compute: Q_4×K_2×V_2
GPU: 4" shape=rectangle]
		ring_stage3_2_5 [label="Ring Stage 2
Compute: Q_5×K_3×V_3
GPU: 5" shape=rectangle]
		ring_stage3_2_6 [label="Ring Stage 2
Compute: Q_6×K_4×V_4
GPU: 6" shape=rectangle]
		ring_stage3_2_7 [label="Ring Stage 2
Compute: Q_7×K_5×V_5
GPU: 7" shape=rectangle]
		ring_stage3_2_8 [label="Ring Stage 2
Compute: Q_8×K_6×V_6
GPU: 8" shape=rectangle]
		ring_stage3_2_9 [label="Ring Stage 2
Compute: Q_9×K_7×V_7
GPU: 9" shape=rectangle]
		ring_stage3_2_10 [label="Ring Stage 2
Compute: Q_10×K_8×V_8
GPU: 10" shape=rectangle]
		ring_stage3_2_11 [label="Ring Stage 2
Compute: Q_11×K_9×V_9
GPU: 11" shape=rectangle]
		ring_stage3_2_12 [label="Ring Stage 2
Compute: Q_12×K_10×V_10
GPU: 12" shape=rectangle]
		ring_stage3_2_13 [label="Ring Stage 2
Compute: Q_13×K_11×V_11
GPU: 13" shape=rectangle]
		ring_stage3_2_14 [label="Ring Stage 2
Compute: Q_14×K_12×V_12
GPU: 14" shape=rectangle]
		ring_stage3_2_15 [label="Ring Stage 2
Compute: Q_15×K_13×V_13
GPU: 15" shape=rectangle]
		kv_send3_2_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_2_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_2_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_2_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_2_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_2_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_2_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_2_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_2_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_2_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_2_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_2_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_2_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_2_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_2_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_2_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_3_0 [label="Ring Stage 3
Compute: Q_0×K_13×V_13
GPU: 0" shape=rectangle]
		ring_stage3_3_1 [label="Ring Stage 3
Compute: Q_1×K_14×V_14
GPU: 1" shape=rectangle]
		ring_stage3_3_2 [label="Ring Stage 3
Compute: Q_2×K_15×V_15
GPU: 2" shape=rectangle]
		ring_stage3_3_3 [label="Ring Stage 3
Compute: Q_3×K_0×V_0
GPU: 3" shape=rectangle]
		ring_stage3_3_4 [label="Ring Stage 3
Compute: Q_4×K_1×V_1
GPU: 4" shape=rectangle]
		ring_stage3_3_5 [label="Ring Stage 3
Compute: Q_5×K_2×V_2
GPU: 5" shape=rectangle]
		ring_stage3_3_6 [label="Ring Stage 3
Compute: Q_6×K_3×V_3
GPU: 6" shape=rectangle]
		ring_stage3_3_7 [label="Ring Stage 3
Compute: Q_7×K_4×V_4
GPU: 7" shape=rectangle]
		ring_stage3_3_8 [label="Ring Stage 3
Compute: Q_8×K_5×V_5
GPU: 8" shape=rectangle]
		ring_stage3_3_9 [label="Ring Stage 3
Compute: Q_9×K_6×V_6
GPU: 9" shape=rectangle]
		ring_stage3_3_10 [label="Ring Stage 3
Compute: Q_10×K_7×V_7
GPU: 10" shape=rectangle]
		ring_stage3_3_11 [label="Ring Stage 3
Compute: Q_11×K_8×V_8
GPU: 11" shape=rectangle]
		ring_stage3_3_12 [label="Ring Stage 3
Compute: Q_12×K_9×V_9
GPU: 12" shape=rectangle]
		ring_stage3_3_13 [label="Ring Stage 3
Compute: Q_13×K_10×V_10
GPU: 13" shape=rectangle]
		ring_stage3_3_14 [label="Ring Stage 3
Compute: Q_14×K_11×V_11
GPU: 14" shape=rectangle]
		ring_stage3_3_15 [label="Ring Stage 3
Compute: Q_15×K_12×V_12
GPU: 15" shape=rectangle]
		kv_send3_3_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_3_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_3_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_3_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_3_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_3_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_3_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_3_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_3_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_3_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_3_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_3_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_3_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_3_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_3_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_3_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_4_0 [label="Ring Stage 4
Compute: Q_0×K_12×V_12
GPU: 0" shape=rectangle]
		ring_stage3_4_1 [label="Ring Stage 4
Compute: Q_1×K_13×V_13
GPU: 1" shape=rectangle]
		ring_stage3_4_2 [label="Ring Stage 4
Compute: Q_2×K_14×V_14
GPU: 2" shape=rectangle]
		ring_stage3_4_3 [label="Ring Stage 4
Compute: Q_3×K_15×V_15
GPU: 3" shape=rectangle]
		ring_stage3_4_4 [label="Ring Stage 4
Compute: Q_4×K_0×V_0
GPU: 4" shape=rectangle]
		ring_stage3_4_5 [label="Ring Stage 4
Compute: Q_5×K_1×V_1
GPU: 5" shape=rectangle]
		ring_stage3_4_6 [label="Ring Stage 4
Compute: Q_6×K_2×V_2
GPU: 6" shape=rectangle]
		ring_stage3_4_7 [label="Ring Stage 4
Compute: Q_7×K_3×V_3
GPU: 7" shape=rectangle]
		ring_stage3_4_8 [label="Ring Stage 4
Compute: Q_8×K_4×V_4
GPU: 8" shape=rectangle]
		ring_stage3_4_9 [label="Ring Stage 4
Compute: Q_9×K_5×V_5
GPU: 9" shape=rectangle]
		ring_stage3_4_10 [label="Ring Stage 4
Compute: Q_10×K_6×V_6
GPU: 10" shape=rectangle]
		ring_stage3_4_11 [label="Ring Stage 4
Compute: Q_11×K_7×V_7
GPU: 11" shape=rectangle]
		ring_stage3_4_12 [label="Ring Stage 4
Compute: Q_12×K_8×V_8
GPU: 12" shape=rectangle]
		ring_stage3_4_13 [label="Ring Stage 4
Compute: Q_13×K_9×V_9
GPU: 13" shape=rectangle]
		ring_stage3_4_14 [label="Ring Stage 4
Compute: Q_14×K_10×V_10
GPU: 14" shape=rectangle]
		ring_stage3_4_15 [label="Ring Stage 4
Compute: Q_15×K_11×V_11
GPU: 15" shape=rectangle]
		kv_send3_4_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_4_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_4_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_4_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_4_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_4_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_4_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_4_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_4_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_4_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_4_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_4_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_4_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_4_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_4_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_4_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_5_0 [label="Ring Stage 5
Compute: Q_0×K_11×V_11
GPU: 0" shape=rectangle]
		ring_stage3_5_1 [label="Ring Stage 5
Compute: Q_1×K_12×V_12
GPU: 1" shape=rectangle]
		ring_stage3_5_2 [label="Ring Stage 5
Compute: Q_2×K_13×V_13
GPU: 2" shape=rectangle]
		ring_stage3_5_3 [label="Ring Stage 5
Compute: Q_3×K_14×V_14
GPU: 3" shape=rectangle]
		ring_stage3_5_4 [label="Ring Stage 5
Compute: Q_4×K_15×V_15
GPU: 4" shape=rectangle]
		ring_stage3_5_5 [label="Ring Stage 5
Compute: Q_5×K_0×V_0
GPU: 5" shape=rectangle]
		ring_stage3_5_6 [label="Ring Stage 5
Compute: Q_6×K_1×V_1
GPU: 6" shape=rectangle]
		ring_stage3_5_7 [label="Ring Stage 5
Compute: Q_7×K_2×V_2
GPU: 7" shape=rectangle]
		ring_stage3_5_8 [label="Ring Stage 5
Compute: Q_8×K_3×V_3
GPU: 8" shape=rectangle]
		ring_stage3_5_9 [label="Ring Stage 5
Compute: Q_9×K_4×V_4
GPU: 9" shape=rectangle]
		ring_stage3_5_10 [label="Ring Stage 5
Compute: Q_10×K_5×V_5
GPU: 10" shape=rectangle]
		ring_stage3_5_11 [label="Ring Stage 5
Compute: Q_11×K_6×V_6
GPU: 11" shape=rectangle]
		ring_stage3_5_12 [label="Ring Stage 5
Compute: Q_12×K_7×V_7
GPU: 12" shape=rectangle]
		ring_stage3_5_13 [label="Ring Stage 5
Compute: Q_13×K_8×V_8
GPU: 13" shape=rectangle]
		ring_stage3_5_14 [label="Ring Stage 5
Compute: Q_14×K_9×V_9
GPU: 14" shape=rectangle]
		ring_stage3_5_15 [label="Ring Stage 5
Compute: Q_15×K_10×V_10
GPU: 15" shape=rectangle]
		kv_send3_5_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_5_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_5_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_5_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_5_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_5_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_5_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_5_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_5_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_5_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_5_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_5_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_5_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_5_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_5_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_5_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_6_0 [label="Ring Stage 6
Compute: Q_0×K_10×V_10
GPU: 0" shape=rectangle]
		ring_stage3_6_1 [label="Ring Stage 6
Compute: Q_1×K_11×V_11
GPU: 1" shape=rectangle]
		ring_stage3_6_2 [label="Ring Stage 6
Compute: Q_2×K_12×V_12
GPU: 2" shape=rectangle]
		ring_stage3_6_3 [label="Ring Stage 6
Compute: Q_3×K_13×V_13
GPU: 3" shape=rectangle]
		ring_stage3_6_4 [label="Ring Stage 6
Compute: Q_4×K_14×V_14
GPU: 4" shape=rectangle]
		ring_stage3_6_5 [label="Ring Stage 6
Compute: Q_5×K_15×V_15
GPU: 5" shape=rectangle]
		ring_stage3_6_6 [label="Ring Stage 6
Compute: Q_6×K_0×V_0
GPU: 6" shape=rectangle]
		ring_stage3_6_7 [label="Ring Stage 6
Compute: Q_7×K_1×V_1
GPU: 7" shape=rectangle]
		ring_stage3_6_8 [label="Ring Stage 6
Compute: Q_8×K_2×V_2
GPU: 8" shape=rectangle]
		ring_stage3_6_9 [label="Ring Stage 6
Compute: Q_9×K_3×V_3
GPU: 9" shape=rectangle]
		ring_stage3_6_10 [label="Ring Stage 6
Compute: Q_10×K_4×V_4
GPU: 10" shape=rectangle]
		ring_stage3_6_11 [label="Ring Stage 6
Compute: Q_11×K_5×V_5
GPU: 11" shape=rectangle]
		ring_stage3_6_12 [label="Ring Stage 6
Compute: Q_12×K_6×V_6
GPU: 12" shape=rectangle]
		ring_stage3_6_13 [label="Ring Stage 6
Compute: Q_13×K_7×V_7
GPU: 13" shape=rectangle]
		ring_stage3_6_14 [label="Ring Stage 6
Compute: Q_14×K_8×V_8
GPU: 14" shape=rectangle]
		ring_stage3_6_15 [label="Ring Stage 6
Compute: Q_15×K_9×V_9
GPU: 15" shape=rectangle]
		kv_send3_6_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_6_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_6_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_6_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_6_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_6_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_6_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_6_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_6_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_6_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_6_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_6_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_6_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_6_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_6_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_6_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_7_0 [label="Ring Stage 7
Compute: Q_0×K_9×V_9
GPU: 0" shape=rectangle]
		ring_stage3_7_1 [label="Ring Stage 7
Compute: Q_1×K_10×V_10
GPU: 1" shape=rectangle]
		ring_stage3_7_2 [label="Ring Stage 7
Compute: Q_2×K_11×V_11
GPU: 2" shape=rectangle]
		ring_stage3_7_3 [label="Ring Stage 7
Compute: Q_3×K_12×V_12
GPU: 3" shape=rectangle]
		ring_stage3_7_4 [label="Ring Stage 7
Compute: Q_4×K_13×V_13
GPU: 4" shape=rectangle]
		ring_stage3_7_5 [label="Ring Stage 7
Compute: Q_5×K_14×V_14
GPU: 5" shape=rectangle]
		ring_stage3_7_6 [label="Ring Stage 7
Compute: Q_6×K_15×V_15
GPU: 6" shape=rectangle]
		ring_stage3_7_7 [label="Ring Stage 7
Compute: Q_7×K_0×V_0
GPU: 7" shape=rectangle]
		ring_stage3_7_8 [label="Ring Stage 7
Compute: Q_8×K_1×V_1
GPU: 8" shape=rectangle]
		ring_stage3_7_9 [label="Ring Stage 7
Compute: Q_9×K_2×V_2
GPU: 9" shape=rectangle]
		ring_stage3_7_10 [label="Ring Stage 7
Compute: Q_10×K_3×V_3
GPU: 10" shape=rectangle]
		ring_stage3_7_11 [label="Ring Stage 7
Compute: Q_11×K_4×V_4
GPU: 11" shape=rectangle]
		ring_stage3_7_12 [label="Ring Stage 7
Compute: Q_12×K_5×V_5
GPU: 12" shape=rectangle]
		ring_stage3_7_13 [label="Ring Stage 7
Compute: Q_13×K_6×V_6
GPU: 13" shape=rectangle]
		ring_stage3_7_14 [label="Ring Stage 7
Compute: Q_14×K_7×V_7
GPU: 14" shape=rectangle]
		ring_stage3_7_15 [label="Ring Stage 7
Compute: Q_15×K_8×V_8
GPU: 15" shape=rectangle]
		kv_send3_7_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_7_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_7_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_7_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_7_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_7_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_7_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_7_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_7_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_7_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_7_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_7_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_7_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_7_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_7_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_7_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_8_0 [label="Ring Stage 8
Compute: Q_0×K_8×V_8
GPU: 0" shape=rectangle]
		ring_stage3_8_1 [label="Ring Stage 8
Compute: Q_1×K_9×V_9
GPU: 1" shape=rectangle]
		ring_stage3_8_2 [label="Ring Stage 8
Compute: Q_2×K_10×V_10
GPU: 2" shape=rectangle]
		ring_stage3_8_3 [label="Ring Stage 8
Compute: Q_3×K_11×V_11
GPU: 3" shape=rectangle]
		ring_stage3_8_4 [label="Ring Stage 8
Compute: Q_4×K_12×V_12
GPU: 4" shape=rectangle]
		ring_stage3_8_5 [label="Ring Stage 8
Compute: Q_5×K_13×V_13
GPU: 5" shape=rectangle]
		ring_stage3_8_6 [label="Ring Stage 8
Compute: Q_6×K_14×V_14
GPU: 6" shape=rectangle]
		ring_stage3_8_7 [label="Ring Stage 8
Compute: Q_7×K_15×V_15
GPU: 7" shape=rectangle]
		ring_stage3_8_8 [label="Ring Stage 8
Compute: Q_8×K_0×V_0
GPU: 8" shape=rectangle]
		ring_stage3_8_9 [label="Ring Stage 8
Compute: Q_9×K_1×V_1
GPU: 9" shape=rectangle]
		ring_stage3_8_10 [label="Ring Stage 8
Compute: Q_10×K_2×V_2
GPU: 10" shape=rectangle]
		ring_stage3_8_11 [label="Ring Stage 8
Compute: Q_11×K_3×V_3
GPU: 11" shape=rectangle]
		ring_stage3_8_12 [label="Ring Stage 8
Compute: Q_12×K_4×V_4
GPU: 12" shape=rectangle]
		ring_stage3_8_13 [label="Ring Stage 8
Compute: Q_13×K_5×V_5
GPU: 13" shape=rectangle]
		ring_stage3_8_14 [label="Ring Stage 8
Compute: Q_14×K_6×V_6
GPU: 14" shape=rectangle]
		ring_stage3_8_15 [label="Ring Stage 8
Compute: Q_15×K_7×V_7
GPU: 15" shape=rectangle]
		kv_send3_8_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_8_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_8_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_8_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_8_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_8_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_8_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_8_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_8_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_8_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_8_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_8_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_8_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_8_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_8_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_8_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_9_0 [label="Ring Stage 9
Compute: Q_0×K_7×V_7
GPU: 0" shape=rectangle]
		ring_stage3_9_1 [label="Ring Stage 9
Compute: Q_1×K_8×V_8
GPU: 1" shape=rectangle]
		ring_stage3_9_2 [label="Ring Stage 9
Compute: Q_2×K_9×V_9
GPU: 2" shape=rectangle]
		ring_stage3_9_3 [label="Ring Stage 9
Compute: Q_3×K_10×V_10
GPU: 3" shape=rectangle]
		ring_stage3_9_4 [label="Ring Stage 9
Compute: Q_4×K_11×V_11
GPU: 4" shape=rectangle]
		ring_stage3_9_5 [label="Ring Stage 9
Compute: Q_5×K_12×V_12
GPU: 5" shape=rectangle]
		ring_stage3_9_6 [label="Ring Stage 9
Compute: Q_6×K_13×V_13
GPU: 6" shape=rectangle]
		ring_stage3_9_7 [label="Ring Stage 9
Compute: Q_7×K_14×V_14
GPU: 7" shape=rectangle]
		ring_stage3_9_8 [label="Ring Stage 9
Compute: Q_8×K_15×V_15
GPU: 8" shape=rectangle]
		ring_stage3_9_9 [label="Ring Stage 9
Compute: Q_9×K_0×V_0
GPU: 9" shape=rectangle]
		ring_stage3_9_10 [label="Ring Stage 9
Compute: Q_10×K_1×V_1
GPU: 10" shape=rectangle]
		ring_stage3_9_11 [label="Ring Stage 9
Compute: Q_11×K_2×V_2
GPU: 11" shape=rectangle]
		ring_stage3_9_12 [label="Ring Stage 9
Compute: Q_12×K_3×V_3
GPU: 12" shape=rectangle]
		ring_stage3_9_13 [label="Ring Stage 9
Compute: Q_13×K_4×V_4
GPU: 13" shape=rectangle]
		ring_stage3_9_14 [label="Ring Stage 9
Compute: Q_14×K_5×V_5
GPU: 14" shape=rectangle]
		ring_stage3_9_15 [label="Ring Stage 9
Compute: Q_15×K_6×V_6
GPU: 15" shape=rectangle]
		kv_send3_9_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_9_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_9_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_9_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_9_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_9_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_9_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_9_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_9_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_9_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_9_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_9_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_9_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_9_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_9_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_9_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_10_0 [label="Ring Stage 10
Compute: Q_0×K_6×V_6
GPU: 0" shape=rectangle]
		ring_stage3_10_1 [label="Ring Stage 10
Compute: Q_1×K_7×V_7
GPU: 1" shape=rectangle]
		ring_stage3_10_2 [label="Ring Stage 10
Compute: Q_2×K_8×V_8
GPU: 2" shape=rectangle]
		ring_stage3_10_3 [label="Ring Stage 10
Compute: Q_3×K_9×V_9
GPU: 3" shape=rectangle]
		ring_stage3_10_4 [label="Ring Stage 10
Compute: Q_4×K_10×V_10
GPU: 4" shape=rectangle]
		ring_stage3_10_5 [label="Ring Stage 10
Compute: Q_5×K_11×V_11
GPU: 5" shape=rectangle]
		ring_stage3_10_6 [label="Ring Stage 10
Compute: Q_6×K_12×V_12
GPU: 6" shape=rectangle]
		ring_stage3_10_7 [label="Ring Stage 10
Compute: Q_7×K_13×V_13
GPU: 7" shape=rectangle]
		ring_stage3_10_8 [label="Ring Stage 10
Compute: Q_8×K_14×V_14
GPU: 8" shape=rectangle]
		ring_stage3_10_9 [label="Ring Stage 10
Compute: Q_9×K_15×V_15
GPU: 9" shape=rectangle]
		ring_stage3_10_10 [label="Ring Stage 10
Compute: Q_10×K_0×V_0
GPU: 10" shape=rectangle]
		ring_stage3_10_11 [label="Ring Stage 10
Compute: Q_11×K_1×V_1
GPU: 11" shape=rectangle]
		ring_stage3_10_12 [label="Ring Stage 10
Compute: Q_12×K_2×V_2
GPU: 12" shape=rectangle]
		ring_stage3_10_13 [label="Ring Stage 10
Compute: Q_13×K_3×V_3
GPU: 13" shape=rectangle]
		ring_stage3_10_14 [label="Ring Stage 10
Compute: Q_14×K_4×V_4
GPU: 14" shape=rectangle]
		ring_stage3_10_15 [label="Ring Stage 10
Compute: Q_15×K_5×V_5
GPU: 15" shape=rectangle]
		kv_send3_10_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_10_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_10_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_10_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_10_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_10_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_10_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_10_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_10_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_10_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_10_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_10_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_10_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_10_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_10_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_10_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_11_0 [label="Ring Stage 11
Compute: Q_0×K_5×V_5
GPU: 0" shape=rectangle]
		ring_stage3_11_1 [label="Ring Stage 11
Compute: Q_1×K_6×V_6
GPU: 1" shape=rectangle]
		ring_stage3_11_2 [label="Ring Stage 11
Compute: Q_2×K_7×V_7
GPU: 2" shape=rectangle]
		ring_stage3_11_3 [label="Ring Stage 11
Compute: Q_3×K_8×V_8
GPU: 3" shape=rectangle]
		ring_stage3_11_4 [label="Ring Stage 11
Compute: Q_4×K_9×V_9
GPU: 4" shape=rectangle]
		ring_stage3_11_5 [label="Ring Stage 11
Compute: Q_5×K_10×V_10
GPU: 5" shape=rectangle]
		ring_stage3_11_6 [label="Ring Stage 11
Compute: Q_6×K_11×V_11
GPU: 6" shape=rectangle]
		ring_stage3_11_7 [label="Ring Stage 11
Compute: Q_7×K_12×V_12
GPU: 7" shape=rectangle]
		ring_stage3_11_8 [label="Ring Stage 11
Compute: Q_8×K_13×V_13
GPU: 8" shape=rectangle]
		ring_stage3_11_9 [label="Ring Stage 11
Compute: Q_9×K_14×V_14
GPU: 9" shape=rectangle]
		ring_stage3_11_10 [label="Ring Stage 11
Compute: Q_10×K_15×V_15
GPU: 10" shape=rectangle]
		ring_stage3_11_11 [label="Ring Stage 11
Compute: Q_11×K_0×V_0
GPU: 11" shape=rectangle]
		ring_stage3_11_12 [label="Ring Stage 11
Compute: Q_12×K_1×V_1
GPU: 12" shape=rectangle]
		ring_stage3_11_13 [label="Ring Stage 11
Compute: Q_13×K_2×V_2
GPU: 13" shape=rectangle]
		ring_stage3_11_14 [label="Ring Stage 11
Compute: Q_14×K_3×V_3
GPU: 14" shape=rectangle]
		ring_stage3_11_15 [label="Ring Stage 11
Compute: Q_15×K_4×V_4
GPU: 15" shape=rectangle]
		kv_send3_11_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_11_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_11_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_11_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_11_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_11_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_11_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_11_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_11_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_11_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_11_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_11_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_11_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_11_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_11_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_11_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_12_0 [label="Ring Stage 12
Compute: Q_0×K_4×V_4
GPU: 0" shape=rectangle]
		ring_stage3_12_1 [label="Ring Stage 12
Compute: Q_1×K_5×V_5
GPU: 1" shape=rectangle]
		ring_stage3_12_2 [label="Ring Stage 12
Compute: Q_2×K_6×V_6
GPU: 2" shape=rectangle]
		ring_stage3_12_3 [label="Ring Stage 12
Compute: Q_3×K_7×V_7
GPU: 3" shape=rectangle]
		ring_stage3_12_4 [label="Ring Stage 12
Compute: Q_4×K_8×V_8
GPU: 4" shape=rectangle]
		ring_stage3_12_5 [label="Ring Stage 12
Compute: Q_5×K_9×V_9
GPU: 5" shape=rectangle]
		ring_stage3_12_6 [label="Ring Stage 12
Compute: Q_6×K_10×V_10
GPU: 6" shape=rectangle]
		ring_stage3_12_7 [label="Ring Stage 12
Compute: Q_7×K_11×V_11
GPU: 7" shape=rectangle]
		ring_stage3_12_8 [label="Ring Stage 12
Compute: Q_8×K_12×V_12
GPU: 8" shape=rectangle]
		ring_stage3_12_9 [label="Ring Stage 12
Compute: Q_9×K_13×V_13
GPU: 9" shape=rectangle]
		ring_stage3_12_10 [label="Ring Stage 12
Compute: Q_10×K_14×V_14
GPU: 10" shape=rectangle]
		ring_stage3_12_11 [label="Ring Stage 12
Compute: Q_11×K_15×V_15
GPU: 11" shape=rectangle]
		ring_stage3_12_12 [label="Ring Stage 12
Compute: Q_12×K_0×V_0
GPU: 12" shape=rectangle]
		ring_stage3_12_13 [label="Ring Stage 12
Compute: Q_13×K_1×V_1
GPU: 13" shape=rectangle]
		ring_stage3_12_14 [label="Ring Stage 12
Compute: Q_14×K_2×V_2
GPU: 14" shape=rectangle]
		ring_stage3_12_15 [label="Ring Stage 12
Compute: Q_15×K_3×V_3
GPU: 15" shape=rectangle]
		kv_send3_12_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_12_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_12_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_12_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_12_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_12_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_12_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_12_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_12_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_12_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_12_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_12_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_12_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_12_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_12_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_12_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_13_0 [label="Ring Stage 13
Compute: Q_0×K_3×V_3
GPU: 0" shape=rectangle]
		ring_stage3_13_1 [label="Ring Stage 13
Compute: Q_1×K_4×V_4
GPU: 1" shape=rectangle]
		ring_stage3_13_2 [label="Ring Stage 13
Compute: Q_2×K_5×V_5
GPU: 2" shape=rectangle]
		ring_stage3_13_3 [label="Ring Stage 13
Compute: Q_3×K_6×V_6
GPU: 3" shape=rectangle]
		ring_stage3_13_4 [label="Ring Stage 13
Compute: Q_4×K_7×V_7
GPU: 4" shape=rectangle]
		ring_stage3_13_5 [label="Ring Stage 13
Compute: Q_5×K_8×V_8
GPU: 5" shape=rectangle]
		ring_stage3_13_6 [label="Ring Stage 13
Compute: Q_6×K_9×V_9
GPU: 6" shape=rectangle]
		ring_stage3_13_7 [label="Ring Stage 13
Compute: Q_7×K_10×V_10
GPU: 7" shape=rectangle]
		ring_stage3_13_8 [label="Ring Stage 13
Compute: Q_8×K_11×V_11
GPU: 8" shape=rectangle]
		ring_stage3_13_9 [label="Ring Stage 13
Compute: Q_9×K_12×V_12
GPU: 9" shape=rectangle]
		ring_stage3_13_10 [label="Ring Stage 13
Compute: Q_10×K_13×V_13
GPU: 10" shape=rectangle]
		ring_stage3_13_11 [label="Ring Stage 13
Compute: Q_11×K_14×V_14
GPU: 11" shape=rectangle]
		ring_stage3_13_12 [label="Ring Stage 13
Compute: Q_12×K_15×V_15
GPU: 12" shape=rectangle]
		ring_stage3_13_13 [label="Ring Stage 13
Compute: Q_13×K_0×V_0
GPU: 13" shape=rectangle]
		ring_stage3_13_14 [label="Ring Stage 13
Compute: Q_14×K_1×V_1
GPU: 14" shape=rectangle]
		ring_stage3_13_15 [label="Ring Stage 13
Compute: Q_15×K_2×V_2
GPU: 15" shape=rectangle]
		kv_send3_13_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_13_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_13_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_13_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_13_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_13_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_13_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_13_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_13_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_13_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_13_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_13_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_13_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_13_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_13_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_13_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_14_0 [label="Ring Stage 14
Compute: Q_0×K_2×V_2
GPU: 0" shape=rectangle]
		ring_stage3_14_1 [label="Ring Stage 14
Compute: Q_1×K_3×V_3
GPU: 1" shape=rectangle]
		ring_stage3_14_2 [label="Ring Stage 14
Compute: Q_2×K_4×V_4
GPU: 2" shape=rectangle]
		ring_stage3_14_3 [label="Ring Stage 14
Compute: Q_3×K_5×V_5
GPU: 3" shape=rectangle]
		ring_stage3_14_4 [label="Ring Stage 14
Compute: Q_4×K_6×V_6
GPU: 4" shape=rectangle]
		ring_stage3_14_5 [label="Ring Stage 14
Compute: Q_5×K_7×V_7
GPU: 5" shape=rectangle]
		ring_stage3_14_6 [label="Ring Stage 14
Compute: Q_6×K_8×V_8
GPU: 6" shape=rectangle]
		ring_stage3_14_7 [label="Ring Stage 14
Compute: Q_7×K_9×V_9
GPU: 7" shape=rectangle]
		ring_stage3_14_8 [label="Ring Stage 14
Compute: Q_8×K_10×V_10
GPU: 8" shape=rectangle]
		ring_stage3_14_9 [label="Ring Stage 14
Compute: Q_9×K_11×V_11
GPU: 9" shape=rectangle]
		ring_stage3_14_10 [label="Ring Stage 14
Compute: Q_10×K_12×V_12
GPU: 10" shape=rectangle]
		ring_stage3_14_11 [label="Ring Stage 14
Compute: Q_11×K_13×V_13
GPU: 11" shape=rectangle]
		ring_stage3_14_12 [label="Ring Stage 14
Compute: Q_12×K_14×V_14
GPU: 12" shape=rectangle]
		ring_stage3_14_13 [label="Ring Stage 14
Compute: Q_13×K_15×V_15
GPU: 13" shape=rectangle]
		ring_stage3_14_14 [label="Ring Stage 14
Compute: Q_14×K_0×V_0
GPU: 14" shape=rectangle]
		ring_stage3_14_15 [label="Ring Stage 14
Compute: Q_15×K_1×V_1
GPU: 15" shape=rectangle]
		kv_send3_14_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_14_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_14_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_14_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_14_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_14_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_14_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_14_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_14_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_14_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_14_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_14_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_14_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_14_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_14_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_14_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		ring_stage3_15_0 [label="Ring Stage 15
Compute: Q_0×K_1×V_1
GPU: 0" shape=rectangle]
		ring_stage3_15_1 [label="Ring Stage 15
Compute: Q_1×K_2×V_2
GPU: 1" shape=rectangle]
		ring_stage3_15_2 [label="Ring Stage 15
Compute: Q_2×K_3×V_3
GPU: 2" shape=rectangle]
		ring_stage3_15_3 [label="Ring Stage 15
Compute: Q_3×K_4×V_4
GPU: 3" shape=rectangle]
		ring_stage3_15_4 [label="Ring Stage 15
Compute: Q_4×K_5×V_5
GPU: 4" shape=rectangle]
		ring_stage3_15_5 [label="Ring Stage 15
Compute: Q_5×K_6×V_6
GPU: 5" shape=rectangle]
		ring_stage3_15_6 [label="Ring Stage 15
Compute: Q_6×K_7×V_7
GPU: 6" shape=rectangle]
		ring_stage3_15_7 [label="Ring Stage 15
Compute: Q_7×K_8×V_8
GPU: 7" shape=rectangle]
		ring_stage3_15_8 [label="Ring Stage 15
Compute: Q_8×K_9×V_9
GPU: 8" shape=rectangle]
		ring_stage3_15_9 [label="Ring Stage 15
Compute: Q_9×K_10×V_10
GPU: 9" shape=rectangle]
		ring_stage3_15_10 [label="Ring Stage 15
Compute: Q_10×K_11×V_11
GPU: 10" shape=rectangle]
		ring_stage3_15_11 [label="Ring Stage 15
Compute: Q_11×K_12×V_12
GPU: 11" shape=rectangle]
		ring_stage3_15_12 [label="Ring Stage 15
Compute: Q_12×K_13×V_13
GPU: 12" shape=rectangle]
		ring_stage3_15_13 [label="Ring Stage 15
Compute: Q_13×K_14×V_14
GPU: 13" shape=rectangle]
		ring_stage3_15_14 [label="Ring Stage 15
Compute: Q_14×K_15×V_15
GPU: 14" shape=rectangle]
		ring_stage3_15_15 [label="Ring Stage 15
Compute: Q_15×K_0×V_0
GPU: 15" shape=rectangle]
		kv_send3_15_0 [label="Send KV to GPU 1
GPU: 0→1" shape=ellipse]
		kv_send3_15_1 [label="Send KV to GPU 2
GPU: 1→2" shape=ellipse]
		kv_send3_15_2 [label="Send KV to GPU 3
GPU: 2→3" shape=ellipse]
		kv_send3_15_3 [label="Send KV to GPU 4
GPU: 3→4" shape=ellipse]
		kv_send3_15_4 [label="Send KV to GPU 5
GPU: 4→5" shape=ellipse]
		kv_send3_15_5 [label="Send KV to GPU 6
GPU: 5→6" shape=ellipse]
		kv_send3_15_6 [label="Send KV to GPU 7
GPU: 6→7" shape=ellipse]
		kv_send3_15_7 [label="Send KV to GPU 8
GPU: 7→8" shape=ellipse]
		kv_send3_15_8 [label="Send KV to GPU 9
GPU: 8→9" shape=ellipse]
		kv_send3_15_9 [label="Send KV to GPU 10
GPU: 9→10" shape=ellipse]
		kv_send3_15_10 [label="Send KV to GPU 11
GPU: 10→11" shape=ellipse]
		kv_send3_15_11 [label="Send KV to GPU 12
GPU: 11→12" shape=ellipse]
		kv_send3_15_12 [label="Send KV to GPU 13
GPU: 12→13" shape=ellipse]
		kv_send3_15_13 [label="Send KV to GPU 14
GPU: 13→14" shape=ellipse]
		kv_send3_15_14 [label="Send KV to GPU 15
GPU: 14→15" shape=ellipse]
		kv_send3_15_15 [label="Send KV to GPU 0
GPU: 15→0" shape=ellipse]
		accum3_0 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		accum3_1 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		accum3_2 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		accum3_3 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		accum3_4 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		accum3_5 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		accum3_6 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		accum3_7 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		accum3_8 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		accum3_9 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		accum3_10 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		accum3_11 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		accum3_12 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		accum3_13 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		accum3_14 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		accum3_15 [label="Accumulate Results
Output: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		out_proj3_0 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		out_proj3_1 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		out_proj3_2 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		out_proj3_3 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		out_proj3_4 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		out_proj3_5 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		out_proj3_6 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		out_proj3_7 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		out_proj3_8 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		out_proj3_9 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		out_proj3_10 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		out_proj3_11 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		out_proj3_12 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		out_proj3_13 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		out_proj3_14 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		out_proj3_15 [label="Output Projection
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
	}
	subgraph cluster_moe3 {
		label="Mixture of Experts"
		gate3_0 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 0" shape=diamond]
		gate3_1 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 1" shape=diamond]
		gate3_2 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 2" shape=diamond]
		gate3_3 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 3" shape=diamond]
		gate3_4 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 4" shape=diamond]
		gate3_5 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 5" shape=diamond]
		gate3_6 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 6" shape=diamond]
		gate3_7 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 7" shape=diamond]
		gate3_8 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 8" shape=diamond]
		gate3_9 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 9" shape=diamond]
		gate3_10 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 10" shape=diamond]
		gate3_11 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 11" shape=diamond]
		gate3_12 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 12" shape=diamond]
		gate3_13 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 13" shape=diamond]
		gate3_14 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 14" shape=diamond]
		gate3_15 [label="Gate
Compute routing scores
Input: [B, L/16, d_model]
GPU: 15" shape=diamond]
		select3_0 [label="Select Top-2 Experts
GPU: 0" shape=parallelogram]
		select3_1 [label="Select Top-2 Experts
GPU: 1" shape=parallelogram]
		select3_2 [label="Select Top-2 Experts
GPU: 2" shape=parallelogram]
		select3_3 [label="Select Top-2 Experts
GPU: 3" shape=parallelogram]
		select3_4 [label="Select Top-2 Experts
GPU: 4" shape=parallelogram]
		select3_5 [label="Select Top-2 Experts
GPU: 5" shape=parallelogram]
		select3_6 [label="Select Top-2 Experts
GPU: 6" shape=parallelogram]
		select3_7 [label="Select Top-2 Experts
GPU: 7" shape=parallelogram]
		select3_8 [label="Select Top-2 Experts
GPU: 8" shape=parallelogram]
		select3_9 [label="Select Top-2 Experts
GPU: 9" shape=parallelogram]
		select3_10 [label="Select Top-2 Experts
GPU: 10" shape=parallelogram]
		select3_11 [label="Select Top-2 Experts
GPU: 11" shape=parallelogram]
		select3_12 [label="Select Top-2 Experts
GPU: 12" shape=parallelogram]
		select3_13 [label="Select Top-2 Experts
GPU: 13" shape=parallelogram]
		select3_14 [label="Select Top-2 Experts
GPU: 14" shape=parallelogram]
		select3_15 [label="Select Top-2 Experts
GPU: 15" shape=parallelogram]
		expert3_0_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_0 [label="Expert 0 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_1 [label="Expert 1 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_2 [label="Expert 2 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_3 [label="Expert 3 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_4 [label="Expert 4 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_5 [label="Expert 5 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_6 [label="Expert 6 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_0_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 0" shape=rectangle]
		expert_act3_0_7 [label="Expert 7 GELU
GPU: 0" shape=rectangle]
		expert_out3_0_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 0" shape=rectangle]
		expert3_1_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_0 [label="Expert 0 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_1 [label="Expert 1 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_2 [label="Expert 2 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_3 [label="Expert 3 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_4 [label="Expert 4 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_5 [label="Expert 5 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_6 [label="Expert 6 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_1_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 1" shape=rectangle]
		expert_act3_1_7 [label="Expert 7 GELU
GPU: 1" shape=rectangle]
		expert_out3_1_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 1" shape=rectangle]
		expert3_2_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_0 [label="Expert 0 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_1 [label="Expert 1 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_2 [label="Expert 2 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_3 [label="Expert 3 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_4 [label="Expert 4 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_5 [label="Expert 5 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_6 [label="Expert 6 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_2_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 2" shape=rectangle]
		expert_act3_2_7 [label="Expert 7 GELU
GPU: 2" shape=rectangle]
		expert_out3_2_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 2" shape=rectangle]
		expert3_3_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_0 [label="Expert 0 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_1 [label="Expert 1 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_2 [label="Expert 2 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_3 [label="Expert 3 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_4 [label="Expert 4 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_5 [label="Expert 5 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_6 [label="Expert 6 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_3_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 3" shape=rectangle]
		expert_act3_3_7 [label="Expert 7 GELU
GPU: 3" shape=rectangle]
		expert_out3_3_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 3" shape=rectangle]
		expert3_4_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_0 [label="Expert 0 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_1 [label="Expert 1 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_2 [label="Expert 2 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_3 [label="Expert 3 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_4 [label="Expert 4 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_5 [label="Expert 5 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_6 [label="Expert 6 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_4_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 4" shape=rectangle]
		expert_act3_4_7 [label="Expert 7 GELU
GPU: 4" shape=rectangle]
		expert_out3_4_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 4" shape=rectangle]
		expert3_5_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_0 [label="Expert 0 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_1 [label="Expert 1 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_2 [label="Expert 2 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_3 [label="Expert 3 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_4 [label="Expert 4 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_5 [label="Expert 5 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_6 [label="Expert 6 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_5_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 5" shape=rectangle]
		expert_act3_5_7 [label="Expert 7 GELU
GPU: 5" shape=rectangle]
		expert_out3_5_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 5" shape=rectangle]
		expert3_6_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_0 [label="Expert 0 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_1 [label="Expert 1 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_2 [label="Expert 2 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_3 [label="Expert 3 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_4 [label="Expert 4 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_5 [label="Expert 5 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_6 [label="Expert 6 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_6_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 6" shape=rectangle]
		expert_act3_6_7 [label="Expert 7 GELU
GPU: 6" shape=rectangle]
		expert_out3_6_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 6" shape=rectangle]
		expert3_7_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_0 [label="Expert 0 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_1 [label="Expert 1 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_2 [label="Expert 2 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_3 [label="Expert 3 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_4 [label="Expert 4 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_5 [label="Expert 5 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_6 [label="Expert 6 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_7_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 7" shape=rectangle]
		expert_act3_7_7 [label="Expert 7 GELU
GPU: 7" shape=rectangle]
		expert_out3_7_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 7" shape=rectangle]
		expert3_8_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_0 [label="Expert 0 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_1 [label="Expert 1 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_2 [label="Expert 2 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_3 [label="Expert 3 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_4 [label="Expert 4 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_5 [label="Expert 5 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_6 [label="Expert 6 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_8_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 8" shape=rectangle]
		expert_act3_8_7 [label="Expert 7 GELU
GPU: 8" shape=rectangle]
		expert_out3_8_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 8" shape=rectangle]
		expert3_9_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_0 [label="Expert 0 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_1 [label="Expert 1 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_2 [label="Expert 2 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_3 [label="Expert 3 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_4 [label="Expert 4 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_5 [label="Expert 5 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_6 [label="Expert 6 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_9_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 9" shape=rectangle]
		expert_act3_9_7 [label="Expert 7 GELU
GPU: 9" shape=rectangle]
		expert_out3_9_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 9" shape=rectangle]
		expert3_10_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_0 [label="Expert 0 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_1 [label="Expert 1 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_2 [label="Expert 2 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_3 [label="Expert 3 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_4 [label="Expert 4 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_5 [label="Expert 5 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_6 [label="Expert 6 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_10_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 10" shape=rectangle]
		expert_act3_10_7 [label="Expert 7 GELU
GPU: 10" shape=rectangle]
		expert_out3_10_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 10" shape=rectangle]
		expert3_11_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_0 [label="Expert 0 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_1 [label="Expert 1 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_2 [label="Expert 2 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_3 [label="Expert 3 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_4 [label="Expert 4 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_5 [label="Expert 5 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_6 [label="Expert 6 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_11_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 11" shape=rectangle]
		expert_act3_11_7 [label="Expert 7 GELU
GPU: 11" shape=rectangle]
		expert_out3_11_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 11" shape=rectangle]
		expert3_12_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_0 [label="Expert 0 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_1 [label="Expert 1 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_2 [label="Expert 2 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_3 [label="Expert 3 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_4 [label="Expert 4 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_5 [label="Expert 5 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_6 [label="Expert 6 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_12_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 12" shape=rectangle]
		expert_act3_12_7 [label="Expert 7 GELU
GPU: 12" shape=rectangle]
		expert_out3_12_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 12" shape=rectangle]
		expert3_13_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_0 [label="Expert 0 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_1 [label="Expert 1 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_2 [label="Expert 2 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_3 [label="Expert 3 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_4 [label="Expert 4 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_5 [label="Expert 5 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_6 [label="Expert 6 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_13_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 13" shape=rectangle]
		expert_act3_13_7 [label="Expert 7 GELU
GPU: 13" shape=rectangle]
		expert_out3_13_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 13" shape=rectangle]
		expert3_14_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_0 [label="Expert 0 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_1 [label="Expert 1 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_2 [label="Expert 2 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_3 [label="Expert 3 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_4 [label="Expert 4 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_5 [label="Expert 5 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_6 [label="Expert 6 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_14_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 14" shape=rectangle]
		expert_act3_14_7 [label="Expert 7 GELU
GPU: 14" shape=rectangle]
		expert_out3_14_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 14" shape=rectangle]
		expert3_15_0 [label="Expert 0
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_0 [label="Expert 0 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_0 [label="Expert 0 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_1 [label="Expert 1
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_1 [label="Expert 1 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_1 [label="Expert 1 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_2 [label="Expert 2
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_2 [label="Expert 2 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_2 [label="Expert 2 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_3 [label="Expert 3
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_3 [label="Expert 3 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_3 [label="Expert 3 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_4 [label="Expert 4
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_4 [label="Expert 4 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_4 [label="Expert 4 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_5 [label="Expert 5
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_5 [label="Expert 5 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_5 [label="Expert 5 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_6 [label="Expert 6
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_6 [label="Expert 6 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_6 [label="Expert 6 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		expert3_15_7 [label="Expert 7
Output: [B, L/16, ffn_dim]
GPU: 15" shape=rectangle]
		expert_act3_15_7 [label="Expert 7 GELU
GPU: 15" shape=rectangle]
		expert_out3_15_7 [label="Expert 7 Output
Output: [B, L/16, d_model]
GPU: 15" shape=rectangle]
		combine3_0 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 0" shape=parallelogram]
		combine3_1 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 1" shape=parallelogram]
		combine3_2 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 2" shape=parallelogram]
		combine3_3 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 3" shape=parallelogram]
		combine3_4 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 4" shape=parallelogram]
		combine3_5 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 5" shape=parallelogram]
		combine3_6 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 6" shape=parallelogram]
		combine3_7 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 7" shape=parallelogram]
		combine3_8 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 8" shape=parallelogram]
		combine3_9 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 9" shape=parallelogram]
		combine3_10 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 10" shape=parallelogram]
		combine3_11 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 11" shape=parallelogram]
		combine3_12 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 12" shape=parallelogram]
		combine3_13 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 13" shape=parallelogram]
		combine3_14 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 14" shape=parallelogram]
		combine3_15 [label="Combine Expert Outputs
Weighted sum by gate scores
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_layer3 {
		label="Layer 3"
		res_attn3_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_attn3_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_attn3_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_attn3_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_attn3_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_attn3_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_attn3_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_attn3_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_attn3_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_attn3_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_attn3_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_attn3_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_attn3_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_attn3_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_attn3_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_attn3_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
		res_moe3_0 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 0" shape=parallelogram]
		res_moe3_1 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 1" shape=parallelogram]
		res_moe3_2 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 2" shape=parallelogram]
		res_moe3_3 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 3" shape=parallelogram]
		res_moe3_4 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 4" shape=parallelogram]
		res_moe3_5 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 5" shape=parallelogram]
		res_moe3_6 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 6" shape=parallelogram]
		res_moe3_7 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 7" shape=parallelogram]
		res_moe3_8 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 8" shape=parallelogram]
		res_moe3_9 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 9" shape=parallelogram]
		res_moe3_10 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 10" shape=parallelogram]
		res_moe3_11 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 11" shape=parallelogram]
		res_moe3_12 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 12" shape=parallelogram]
		res_moe3_13 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 13" shape=parallelogram]
		res_moe3_14 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 14" shape=parallelogram]
		res_moe3_15 [label="Residual Add
Input: [B, L/16, d_model]
GPU: 15" shape=parallelogram]
	}
	subgraph cluster_sp_gather {
		label="Sequence Parallel Gather"
		sp_gather [label="Sequence Parallel Gather
X: [B, L, d_model]
GPU: 0-15 → Host" shape=parallelogram]
	}
	subgraph cluster_output {
		label="Output Layer"
		output [label="Output
X: [B, L, d_model]
GPU: Host" shape=parallelogram]
	}
	input -> sp_split
	sp_split -> qkv0_0
	sp_split -> qkv0_1
	sp_split -> qkv0_2
	sp_split -> qkv0_3
	sp_split -> qkv0_4
	sp_split -> qkv0_5
	sp_split -> qkv0_6
	sp_split -> qkv0_7
	sp_split -> qkv0_8
	sp_split -> qkv0_9
	sp_split -> qkv0_10
	sp_split -> qkv0_11
	sp_split -> qkv0_12
	sp_split -> qkv0_13
	sp_split -> qkv0_14
	sp_split -> qkv0_15
	qkv0_0 -> ring_stage0_0_0
	qkv0_1 -> ring_stage0_0_1
	qkv0_2 -> ring_stage0_0_2
	qkv0_3 -> ring_stage0_0_3
	qkv0_4 -> ring_stage0_0_4
	qkv0_5 -> ring_stage0_0_5
	qkv0_6 -> ring_stage0_0_6
	qkv0_7 -> ring_stage0_0_7
	qkv0_8 -> ring_stage0_0_8
	qkv0_9 -> ring_stage0_0_9
	qkv0_10 -> ring_stage0_0_10
	qkv0_11 -> ring_stage0_0_11
	qkv0_12 -> ring_stage0_0_12
	qkv0_13 -> ring_stage0_0_13
	qkv0_14 -> ring_stage0_0_14
	qkv0_15 -> ring_stage0_0_15
	ring_stage0_0_0 -> kv_send0_0_0
	ring_stage0_0_1 -> kv_send0_0_1
	ring_stage0_0_2 -> kv_send0_0_2
	ring_stage0_0_3 -> kv_send0_0_3
	ring_stage0_0_4 -> kv_send0_0_4
	ring_stage0_0_5 -> kv_send0_0_5
	ring_stage0_0_6 -> kv_send0_0_6
	ring_stage0_0_7 -> kv_send0_0_7
	ring_stage0_0_8 -> kv_send0_0_8
	ring_stage0_0_9 -> kv_send0_0_9
	ring_stage0_0_10 -> kv_send0_0_10
	ring_stage0_0_11 -> kv_send0_0_11
	ring_stage0_0_12 -> kv_send0_0_12
	ring_stage0_0_13 -> kv_send0_0_13
	ring_stage0_0_14 -> kv_send0_0_14
	ring_stage0_0_15 -> kv_send0_0_15
	ring_stage0_0_0 -> ring_stage0_1_0
	kv_send0_0_15 -> ring_stage0_1_0
	ring_stage0_1_0 -> kv_send0_1_0
	ring_stage0_0_1 -> ring_stage0_1_1
	kv_send0_0_0 -> ring_stage0_1_1
	ring_stage0_1_1 -> kv_send0_1_1
	ring_stage0_0_2 -> ring_stage0_1_2
	kv_send0_0_1 -> ring_stage0_1_2
	ring_stage0_1_2 -> kv_send0_1_2
	ring_stage0_0_3 -> ring_stage0_1_3
	kv_send0_0_2 -> ring_stage0_1_3
	ring_stage0_1_3 -> kv_send0_1_3
	ring_stage0_0_4 -> ring_stage0_1_4
	kv_send0_0_3 -> ring_stage0_1_4
	ring_stage0_1_4 -> kv_send0_1_4
	ring_stage0_0_5 -> ring_stage0_1_5
	kv_send0_0_4 -> ring_stage0_1_5
	ring_stage0_1_5 -> kv_send0_1_5
	ring_stage0_0_6 -> ring_stage0_1_6
	kv_send0_0_5 -> ring_stage0_1_6
	ring_stage0_1_6 -> kv_send0_1_6
	ring_stage0_0_7 -> ring_stage0_1_7
	kv_send0_0_6 -> ring_stage0_1_7
	ring_stage0_1_7 -> kv_send0_1_7
	ring_stage0_0_8 -> ring_stage0_1_8
	kv_send0_0_7 -> ring_stage0_1_8
	ring_stage0_1_8 -> kv_send0_1_8
	ring_stage0_0_9 -> ring_stage0_1_9
	kv_send0_0_8 -> ring_stage0_1_9
	ring_stage0_1_9 -> kv_send0_1_9
	ring_stage0_0_10 -> ring_stage0_1_10
	kv_send0_0_9 -> ring_stage0_1_10
	ring_stage0_1_10 -> kv_send0_1_10
	ring_stage0_0_11 -> ring_stage0_1_11
	kv_send0_0_10 -> ring_stage0_1_11
	ring_stage0_1_11 -> kv_send0_1_11
	ring_stage0_0_12 -> ring_stage0_1_12
	kv_send0_0_11 -> ring_stage0_1_12
	ring_stage0_1_12 -> kv_send0_1_12
	ring_stage0_0_13 -> ring_stage0_1_13
	kv_send0_0_12 -> ring_stage0_1_13
	ring_stage0_1_13 -> kv_send0_1_13
	ring_stage0_0_14 -> ring_stage0_1_14
	kv_send0_0_13 -> ring_stage0_1_14
	ring_stage0_1_14 -> kv_send0_1_14
	ring_stage0_0_15 -> ring_stage0_1_15
	kv_send0_0_14 -> ring_stage0_1_15
	ring_stage0_1_15 -> kv_send0_1_15
	ring_stage0_1_0 -> ring_stage0_2_0
	kv_send0_1_15 -> ring_stage0_2_0
	ring_stage0_2_0 -> kv_send0_2_0
	ring_stage0_1_1 -> ring_stage0_2_1
	kv_send0_1_0 -> ring_stage0_2_1
	ring_stage0_2_1 -> kv_send0_2_1
	ring_stage0_1_2 -> ring_stage0_2_2
	kv_send0_1_1 -> ring_stage0_2_2
	ring_stage0_2_2 -> kv_send0_2_2
	ring_stage0_1_3 -> ring_stage0_2_3
	kv_send0_1_2 -> ring_stage0_2_3
	ring_stage0_2_3 -> kv_send0_2_3
	ring_stage0_1_4 -> ring_stage0_2_4
	kv_send0_1_3 -> ring_stage0_2_4
	ring_stage0_2_4 -> kv_send0_2_4
	ring_stage0_1_5 -> ring_stage0_2_5
	kv_send0_1_4 -> ring_stage0_2_5
	ring_stage0_2_5 -> kv_send0_2_5
	ring_stage0_1_6 -> ring_stage0_2_6
	kv_send0_1_5 -> ring_stage0_2_6
	ring_stage0_2_6 -> kv_send0_2_6
	ring_stage0_1_7 -> ring_stage0_2_7
	kv_send0_1_6 -> ring_stage0_2_7
	ring_stage0_2_7 -> kv_send0_2_7
	ring_stage0_1_8 -> ring_stage0_2_8
	kv_send0_1_7 -> ring_stage0_2_8
	ring_stage0_2_8 -> kv_send0_2_8
	ring_stage0_1_9 -> ring_stage0_2_9
	kv_send0_1_8 -> ring_stage0_2_9
	ring_stage0_2_9 -> kv_send0_2_9
	ring_stage0_1_10 -> ring_stage0_2_10
	kv_send0_1_9 -> ring_stage0_2_10
	ring_stage0_2_10 -> kv_send0_2_10
	ring_stage0_1_11 -> ring_stage0_2_11
	kv_send0_1_10 -> ring_stage0_2_11
	ring_stage0_2_11 -> kv_send0_2_11
	ring_stage0_1_12 -> ring_stage0_2_12
	kv_send0_1_11 -> ring_stage0_2_12
	ring_stage0_2_12 -> kv_send0_2_12
	ring_stage0_1_13 -> ring_stage0_2_13
	kv_send0_1_12 -> ring_stage0_2_13
	ring_stage0_2_13 -> kv_send0_2_13
	ring_stage0_1_14 -> ring_stage0_2_14
	kv_send0_1_13 -> ring_stage0_2_14
	ring_stage0_2_14 -> kv_send0_2_14
	ring_stage0_1_15 -> ring_stage0_2_15
	kv_send0_1_14 -> ring_stage0_2_15
	ring_stage0_2_15 -> kv_send0_2_15
	ring_stage0_2_0 -> ring_stage0_3_0
	kv_send0_2_15 -> ring_stage0_3_0
	ring_stage0_3_0 -> kv_send0_3_0
	ring_stage0_2_1 -> ring_stage0_3_1
	kv_send0_2_0 -> ring_stage0_3_1
	ring_stage0_3_1 -> kv_send0_3_1
	ring_stage0_2_2 -> ring_stage0_3_2
	kv_send0_2_1 -> ring_stage0_3_2
	ring_stage0_3_2 -> kv_send0_3_2
	ring_stage0_2_3 -> ring_stage0_3_3
	kv_send0_2_2 -> ring_stage0_3_3
	ring_stage0_3_3 -> kv_send0_3_3
	ring_stage0_2_4 -> ring_stage0_3_4
	kv_send0_2_3 -> ring_stage0_3_4
	ring_stage0_3_4 -> kv_send0_3_4
	ring_stage0_2_5 -> ring_stage0_3_5
	kv_send0_2_4 -> ring_stage0_3_5
	ring_stage0_3_5 -> kv_send0_3_5
	ring_stage0_2_6 -> ring_stage0_3_6
	kv_send0_2_5 -> ring_stage0_3_6
	ring_stage0_3_6 -> kv_send0_3_6
	ring_stage0_2_7 -> ring_stage0_3_7
	kv_send0_2_6 -> ring_stage0_3_7
	ring_stage0_3_7 -> kv_send0_3_7
	ring_stage0_2_8 -> ring_stage0_3_8
	kv_send0_2_7 -> ring_stage0_3_8
	ring_stage0_3_8 -> kv_send0_3_8
	ring_stage0_2_9 -> ring_stage0_3_9
	kv_send0_2_8 -> ring_stage0_3_9
	ring_stage0_3_9 -> kv_send0_3_9
	ring_stage0_2_10 -> ring_stage0_3_10
	kv_send0_2_9 -> ring_stage0_3_10
	ring_stage0_3_10 -> kv_send0_3_10
	ring_stage0_2_11 -> ring_stage0_3_11
	kv_send0_2_10 -> ring_stage0_3_11
	ring_stage0_3_11 -> kv_send0_3_11
	ring_stage0_2_12 -> ring_stage0_3_12
	kv_send0_2_11 -> ring_stage0_3_12
	ring_stage0_3_12 -> kv_send0_3_12
	ring_stage0_2_13 -> ring_stage0_3_13
	kv_send0_2_12 -> ring_stage0_3_13
	ring_stage0_3_13 -> kv_send0_3_13
	ring_stage0_2_14 -> ring_stage0_3_14
	kv_send0_2_13 -> ring_stage0_3_14
	ring_stage0_3_14 -> kv_send0_3_14
	ring_stage0_2_15 -> ring_stage0_3_15
	kv_send0_2_14 -> ring_stage0_3_15
	ring_stage0_3_15 -> kv_send0_3_15
	ring_stage0_3_0 -> ring_stage0_4_0
	kv_send0_3_15 -> ring_stage0_4_0
	ring_stage0_4_0 -> kv_send0_4_0
	ring_stage0_3_1 -> ring_stage0_4_1
	kv_send0_3_0 -> ring_stage0_4_1
	ring_stage0_4_1 -> kv_send0_4_1
	ring_stage0_3_2 -> ring_stage0_4_2
	kv_send0_3_1 -> ring_stage0_4_2
	ring_stage0_4_2 -> kv_send0_4_2
	ring_stage0_3_3 -> ring_stage0_4_3
	kv_send0_3_2 -> ring_stage0_4_3
	ring_stage0_4_3 -> kv_send0_4_3
	ring_stage0_3_4 -> ring_stage0_4_4
	kv_send0_3_3 -> ring_stage0_4_4
	ring_stage0_4_4 -> kv_send0_4_4
	ring_stage0_3_5 -> ring_stage0_4_5
	kv_send0_3_4 -> ring_stage0_4_5
	ring_stage0_4_5 -> kv_send0_4_5
	ring_stage0_3_6 -> ring_stage0_4_6
	kv_send0_3_5 -> ring_stage0_4_6
	ring_stage0_4_6 -> kv_send0_4_6
	ring_stage0_3_7 -> ring_stage0_4_7
	kv_send0_3_6 -> ring_stage0_4_7
	ring_stage0_4_7 -> kv_send0_4_7
	ring_stage0_3_8 -> ring_stage0_4_8
	kv_send0_3_7 -> ring_stage0_4_8
	ring_stage0_4_8 -> kv_send0_4_8
	ring_stage0_3_9 -> ring_stage0_4_9
	kv_send0_3_8 -> ring_stage0_4_9
	ring_stage0_4_9 -> kv_send0_4_9
	ring_stage0_3_10 -> ring_stage0_4_10
	kv_send0_3_9 -> ring_stage0_4_10
	ring_stage0_4_10 -> kv_send0_4_10
	ring_stage0_3_11 -> ring_stage0_4_11
	kv_send0_3_10 -> ring_stage0_4_11
	ring_stage0_4_11 -> kv_send0_4_11
	ring_stage0_3_12 -> ring_stage0_4_12
	kv_send0_3_11 -> ring_stage0_4_12
	ring_stage0_4_12 -> kv_send0_4_12
	ring_stage0_3_13 -> ring_stage0_4_13
	kv_send0_3_12 -> ring_stage0_4_13
	ring_stage0_4_13 -> kv_send0_4_13
	ring_stage0_3_14 -> ring_stage0_4_14
	kv_send0_3_13 -> ring_stage0_4_14
	ring_stage0_4_14 -> kv_send0_4_14
	ring_stage0_3_15 -> ring_stage0_4_15
	kv_send0_3_14 -> ring_stage0_4_15
	ring_stage0_4_15 -> kv_send0_4_15
	ring_stage0_4_0 -> ring_stage0_5_0
	kv_send0_4_15 -> ring_stage0_5_0
	ring_stage0_5_0 -> kv_send0_5_0
	ring_stage0_4_1 -> ring_stage0_5_1
	kv_send0_4_0 -> ring_stage0_5_1
	ring_stage0_5_1 -> kv_send0_5_1
	ring_stage0_4_2 -> ring_stage0_5_2
	kv_send0_4_1 -> ring_stage0_5_2
	ring_stage0_5_2 -> kv_send0_5_2
	ring_stage0_4_3 -> ring_stage0_5_3
	kv_send0_4_2 -> ring_stage0_5_3
	ring_stage0_5_3 -> kv_send0_5_3
	ring_stage0_4_4 -> ring_stage0_5_4
	kv_send0_4_3 -> ring_stage0_5_4
	ring_stage0_5_4 -> kv_send0_5_4
	ring_stage0_4_5 -> ring_stage0_5_5
	kv_send0_4_4 -> ring_stage0_5_5
	ring_stage0_5_5 -> kv_send0_5_5
	ring_stage0_4_6 -> ring_stage0_5_6
	kv_send0_4_5 -> ring_stage0_5_6
	ring_stage0_5_6 -> kv_send0_5_6
	ring_stage0_4_7 -> ring_stage0_5_7
	kv_send0_4_6 -> ring_stage0_5_7
	ring_stage0_5_7 -> kv_send0_5_7
	ring_stage0_4_8 -> ring_stage0_5_8
	kv_send0_4_7 -> ring_stage0_5_8
	ring_stage0_5_8 -> kv_send0_5_8
	ring_stage0_4_9 -> ring_stage0_5_9
	kv_send0_4_8 -> ring_stage0_5_9
	ring_stage0_5_9 -> kv_send0_5_9
	ring_stage0_4_10 -> ring_stage0_5_10
	kv_send0_4_9 -> ring_stage0_5_10
	ring_stage0_5_10 -> kv_send0_5_10
	ring_stage0_4_11 -> ring_stage0_5_11
	kv_send0_4_10 -> ring_stage0_5_11
	ring_stage0_5_11 -> kv_send0_5_11
	ring_stage0_4_12 -> ring_stage0_5_12
	kv_send0_4_11 -> ring_stage0_5_12
	ring_stage0_5_12 -> kv_send0_5_12
	ring_stage0_4_13 -> ring_stage0_5_13
	kv_send0_4_12 -> ring_stage0_5_13
	ring_stage0_5_13 -> kv_send0_5_13
	ring_stage0_4_14 -> ring_stage0_5_14
	kv_send0_4_13 -> ring_stage0_5_14
	ring_stage0_5_14 -> kv_send0_5_14
	ring_stage0_4_15 -> ring_stage0_5_15
	kv_send0_4_14 -> ring_stage0_5_15
	ring_stage0_5_15 -> kv_send0_5_15
	ring_stage0_5_0 -> ring_stage0_6_0
	kv_send0_5_15 -> ring_stage0_6_0
	ring_stage0_6_0 -> kv_send0_6_0
	ring_stage0_5_1 -> ring_stage0_6_1
	kv_send0_5_0 -> ring_stage0_6_1
	ring_stage0_6_1 -> kv_send0_6_1
	ring_stage0_5_2 -> ring_stage0_6_2
	kv_send0_5_1 -> ring_stage0_6_2
	ring_stage0_6_2 -> kv_send0_6_2
	ring_stage0_5_3 -> ring_stage0_6_3
	kv_send0_5_2 -> ring_stage0_6_3
	ring_stage0_6_3 -> kv_send0_6_3
	ring_stage0_5_4 -> ring_stage0_6_4
	kv_send0_5_3 -> ring_stage0_6_4
	ring_stage0_6_4 -> kv_send0_6_4
	ring_stage0_5_5 -> ring_stage0_6_5
	kv_send0_5_4 -> ring_stage0_6_5
	ring_stage0_6_5 -> kv_send0_6_5
	ring_stage0_5_6 -> ring_stage0_6_6
	kv_send0_5_5 -> ring_stage0_6_6
	ring_stage0_6_6 -> kv_send0_6_6
	ring_stage0_5_7 -> ring_stage0_6_7
	kv_send0_5_6 -> ring_stage0_6_7
	ring_stage0_6_7 -> kv_send0_6_7
	ring_stage0_5_8 -> ring_stage0_6_8
	kv_send0_5_7 -> ring_stage0_6_8
	ring_stage0_6_8 -> kv_send0_6_8
	ring_stage0_5_9 -> ring_stage0_6_9
	kv_send0_5_8 -> ring_stage0_6_9
	ring_stage0_6_9 -> kv_send0_6_9
	ring_stage0_5_10 -> ring_stage0_6_10
	kv_send0_5_9 -> ring_stage0_6_10
	ring_stage0_6_10 -> kv_send0_6_10
	ring_stage0_5_11 -> ring_stage0_6_11
	kv_send0_5_10 -> ring_stage0_6_11
	ring_stage0_6_11 -> kv_send0_6_11
	ring_stage0_5_12 -> ring_stage0_6_12
	kv_send0_5_11 -> ring_stage0_6_12
	ring_stage0_6_12 -> kv_send0_6_12
	ring_stage0_5_13 -> ring_stage0_6_13
	kv_send0_5_12 -> ring_stage0_6_13
	ring_stage0_6_13 -> kv_send0_6_13
	ring_stage0_5_14 -> ring_stage0_6_14
	kv_send0_5_13 -> ring_stage0_6_14
	ring_stage0_6_14 -> kv_send0_6_14
	ring_stage0_5_15 -> ring_stage0_6_15
	kv_send0_5_14 -> ring_stage0_6_15
	ring_stage0_6_15 -> kv_send0_6_15
	ring_stage0_6_0 -> ring_stage0_7_0
	kv_send0_6_15 -> ring_stage0_7_0
	ring_stage0_7_0 -> kv_send0_7_0
	ring_stage0_6_1 -> ring_stage0_7_1
	kv_send0_6_0 -> ring_stage0_7_1
	ring_stage0_7_1 -> kv_send0_7_1
	ring_stage0_6_2 -> ring_stage0_7_2
	kv_send0_6_1 -> ring_stage0_7_2
	ring_stage0_7_2 -> kv_send0_7_2
	ring_stage0_6_3 -> ring_stage0_7_3
	kv_send0_6_2 -> ring_stage0_7_3
	ring_stage0_7_3 -> kv_send0_7_3
	ring_stage0_6_4 -> ring_stage0_7_4
	kv_send0_6_3 -> ring_stage0_7_4
	ring_stage0_7_4 -> kv_send0_7_4
	ring_stage0_6_5 -> ring_stage0_7_5
	kv_send0_6_4 -> ring_stage0_7_5
	ring_stage0_7_5 -> kv_send0_7_5
	ring_stage0_6_6 -> ring_stage0_7_6
	kv_send0_6_5 -> ring_stage0_7_6
	ring_stage0_7_6 -> kv_send0_7_6
	ring_stage0_6_7 -> ring_stage0_7_7
	kv_send0_6_6 -> ring_stage0_7_7
	ring_stage0_7_7 -> kv_send0_7_7
	ring_stage0_6_8 -> ring_stage0_7_8
	kv_send0_6_7 -> ring_stage0_7_8
	ring_stage0_7_8 -> kv_send0_7_8
	ring_stage0_6_9 -> ring_stage0_7_9
	kv_send0_6_8 -> ring_stage0_7_9
	ring_stage0_7_9 -> kv_send0_7_9
	ring_stage0_6_10 -> ring_stage0_7_10
	kv_send0_6_9 -> ring_stage0_7_10
	ring_stage0_7_10 -> kv_send0_7_10
	ring_stage0_6_11 -> ring_stage0_7_11
	kv_send0_6_10 -> ring_stage0_7_11
	ring_stage0_7_11 -> kv_send0_7_11
	ring_stage0_6_12 -> ring_stage0_7_12
	kv_send0_6_11 -> ring_stage0_7_12
	ring_stage0_7_12 -> kv_send0_7_12
	ring_stage0_6_13 -> ring_stage0_7_13
	kv_send0_6_12 -> ring_stage0_7_13
	ring_stage0_7_13 -> kv_send0_7_13
	ring_stage0_6_14 -> ring_stage0_7_14
	kv_send0_6_13 -> ring_stage0_7_14
	ring_stage0_7_14 -> kv_send0_7_14
	ring_stage0_6_15 -> ring_stage0_7_15
	kv_send0_6_14 -> ring_stage0_7_15
	ring_stage0_7_15 -> kv_send0_7_15
	ring_stage0_7_0 -> ring_stage0_8_0
	kv_send0_7_15 -> ring_stage0_8_0
	ring_stage0_8_0 -> kv_send0_8_0
	ring_stage0_7_1 -> ring_stage0_8_1
	kv_send0_7_0 -> ring_stage0_8_1
	ring_stage0_8_1 -> kv_send0_8_1
	ring_stage0_7_2 -> ring_stage0_8_2
	kv_send0_7_1 -> ring_stage0_8_2
	ring_stage0_8_2 -> kv_send0_8_2
	ring_stage0_7_3 -> ring_stage0_8_3
	kv_send0_7_2 -> ring_stage0_8_3
	ring_stage0_8_3 -> kv_send0_8_3
	ring_stage0_7_4 -> ring_stage0_8_4
	kv_send0_7_3 -> ring_stage0_8_4
	ring_stage0_8_4 -> kv_send0_8_4
	ring_stage0_7_5 -> ring_stage0_8_5
	kv_send0_7_4 -> ring_stage0_8_5
	ring_stage0_8_5 -> kv_send0_8_5
	ring_stage0_7_6 -> ring_stage0_8_6
	kv_send0_7_5 -> ring_stage0_8_6
	ring_stage0_8_6 -> kv_send0_8_6
	ring_stage0_7_7 -> ring_stage0_8_7
	kv_send0_7_6 -> ring_stage0_8_7
	ring_stage0_8_7 -> kv_send0_8_7
	ring_stage0_7_8 -> ring_stage0_8_8
	kv_send0_7_7 -> ring_stage0_8_8
	ring_stage0_8_8 -> kv_send0_8_8
	ring_stage0_7_9 -> ring_stage0_8_9
	kv_send0_7_8 -> ring_stage0_8_9
	ring_stage0_8_9 -> kv_send0_8_9
	ring_stage0_7_10 -> ring_stage0_8_10
	kv_send0_7_9 -> ring_stage0_8_10
	ring_stage0_8_10 -> kv_send0_8_10
	ring_stage0_7_11 -> ring_stage0_8_11
	kv_send0_7_10 -> ring_stage0_8_11
	ring_stage0_8_11 -> kv_send0_8_11
	ring_stage0_7_12 -> ring_stage0_8_12
	kv_send0_7_11 -> ring_stage0_8_12
	ring_stage0_8_12 -> kv_send0_8_12
	ring_stage0_7_13 -> ring_stage0_8_13
	kv_send0_7_12 -> ring_stage0_8_13
	ring_stage0_8_13 -> kv_send0_8_13
	ring_stage0_7_14 -> ring_stage0_8_14
	kv_send0_7_13 -> ring_stage0_8_14
	ring_stage0_8_14 -> kv_send0_8_14
	ring_stage0_7_15 -> ring_stage0_8_15
	kv_send0_7_14 -> ring_stage0_8_15
	ring_stage0_8_15 -> kv_send0_8_15
	ring_stage0_8_0 -> ring_stage0_9_0
	kv_send0_8_15 -> ring_stage0_9_0
	ring_stage0_9_0 -> kv_send0_9_0
	ring_stage0_8_1 -> ring_stage0_9_1
	kv_send0_8_0 -> ring_stage0_9_1
	ring_stage0_9_1 -> kv_send0_9_1
	ring_stage0_8_2 -> ring_stage0_9_2
	kv_send0_8_1 -> ring_stage0_9_2
	ring_stage0_9_2 -> kv_send0_9_2
	ring_stage0_8_3 -> ring_stage0_9_3
	kv_send0_8_2 -> ring_stage0_9_3
	ring_stage0_9_3 -> kv_send0_9_3
	ring_stage0_8_4 -> ring_stage0_9_4
	kv_send0_8_3 -> ring_stage0_9_4
	ring_stage0_9_4 -> kv_send0_9_4
	ring_stage0_8_5 -> ring_stage0_9_5
	kv_send0_8_4 -> ring_stage0_9_5
	ring_stage0_9_5 -> kv_send0_9_5
	ring_stage0_8_6 -> ring_stage0_9_6
	kv_send0_8_5 -> ring_stage0_9_6
	ring_stage0_9_6 -> kv_send0_9_6
	ring_stage0_8_7 -> ring_stage0_9_7
	kv_send0_8_6 -> ring_stage0_9_7
	ring_stage0_9_7 -> kv_send0_9_7
	ring_stage0_8_8 -> ring_stage0_9_8
	kv_send0_8_7 -> ring_stage0_9_8
	ring_stage0_9_8 -> kv_send0_9_8
	ring_stage0_8_9 -> ring_stage0_9_9
	kv_send0_8_8 -> ring_stage0_9_9
	ring_stage0_9_9 -> kv_send0_9_9
	ring_stage0_8_10 -> ring_stage0_9_10
	kv_send0_8_9 -> ring_stage0_9_10
	ring_stage0_9_10 -> kv_send0_9_10
	ring_stage0_8_11 -> ring_stage0_9_11
	kv_send0_8_10 -> ring_stage0_9_11
	ring_stage0_9_11 -> kv_send0_9_11
	ring_stage0_8_12 -> ring_stage0_9_12
	kv_send0_8_11 -> ring_stage0_9_12
	ring_stage0_9_12 -> kv_send0_9_12
	ring_stage0_8_13 -> ring_stage0_9_13
	kv_send0_8_12 -> ring_stage0_9_13
	ring_stage0_9_13 -> kv_send0_9_13
	ring_stage0_8_14 -> ring_stage0_9_14
	kv_send0_8_13 -> ring_stage0_9_14
	ring_stage0_9_14 -> kv_send0_9_14
	ring_stage0_8_15 -> ring_stage0_9_15
	kv_send0_8_14 -> ring_stage0_9_15
	ring_stage0_9_15 -> kv_send0_9_15
	ring_stage0_9_0 -> ring_stage0_10_0
	kv_send0_9_15 -> ring_stage0_10_0
	ring_stage0_10_0 -> kv_send0_10_0
	ring_stage0_9_1 -> ring_stage0_10_1
	kv_send0_9_0 -> ring_stage0_10_1
	ring_stage0_10_1 -> kv_send0_10_1
	ring_stage0_9_2 -> ring_stage0_10_2
	kv_send0_9_1 -> ring_stage0_10_2
	ring_stage0_10_2 -> kv_send0_10_2
	ring_stage0_9_3 -> ring_stage0_10_3
	kv_send0_9_2 -> ring_stage0_10_3
	ring_stage0_10_3 -> kv_send0_10_3
	ring_stage0_9_4 -> ring_stage0_10_4
	kv_send0_9_3 -> ring_stage0_10_4
	ring_stage0_10_4 -> kv_send0_10_4
	ring_stage0_9_5 -> ring_stage0_10_5
	kv_send0_9_4 -> ring_stage0_10_5
	ring_stage0_10_5 -> kv_send0_10_5
	ring_stage0_9_6 -> ring_stage0_10_6
	kv_send0_9_5 -> ring_stage0_10_6
	ring_stage0_10_6 -> kv_send0_10_6
	ring_stage0_9_7 -> ring_stage0_10_7
	kv_send0_9_6 -> ring_stage0_10_7
	ring_stage0_10_7 -> kv_send0_10_7
	ring_stage0_9_8 -> ring_stage0_10_8
	kv_send0_9_7 -> ring_stage0_10_8
	ring_stage0_10_8 -> kv_send0_10_8
	ring_stage0_9_9 -> ring_stage0_10_9
	kv_send0_9_8 -> ring_stage0_10_9
	ring_stage0_10_9 -> kv_send0_10_9
	ring_stage0_9_10 -> ring_stage0_10_10
	kv_send0_9_9 -> ring_stage0_10_10
	ring_stage0_10_10 -> kv_send0_10_10
	ring_stage0_9_11 -> ring_stage0_10_11
	kv_send0_9_10 -> ring_stage0_10_11
	ring_stage0_10_11 -> kv_send0_10_11
	ring_stage0_9_12 -> ring_stage0_10_12
	kv_send0_9_11 -> ring_stage0_10_12
	ring_stage0_10_12 -> kv_send0_10_12
	ring_stage0_9_13 -> ring_stage0_10_13
	kv_send0_9_12 -> ring_stage0_10_13
	ring_stage0_10_13 -> kv_send0_10_13
	ring_stage0_9_14 -> ring_stage0_10_14
	kv_send0_9_13 -> ring_stage0_10_14
	ring_stage0_10_14 -> kv_send0_10_14
	ring_stage0_9_15 -> ring_stage0_10_15
	kv_send0_9_14 -> ring_stage0_10_15
	ring_stage0_10_15 -> kv_send0_10_15
	ring_stage0_10_0 -> ring_stage0_11_0
	kv_send0_10_15 -> ring_stage0_11_0
	ring_stage0_11_0 -> kv_send0_11_0
	ring_stage0_10_1 -> ring_stage0_11_1
	kv_send0_10_0 -> ring_stage0_11_1
	ring_stage0_11_1 -> kv_send0_11_1
	ring_stage0_10_2 -> ring_stage0_11_2
	kv_send0_10_1 -> ring_stage0_11_2
	ring_stage0_11_2 -> kv_send0_11_2
	ring_stage0_10_3 -> ring_stage0_11_3
	kv_send0_10_2 -> ring_stage0_11_3
	ring_stage0_11_3 -> kv_send0_11_3
	ring_stage0_10_4 -> ring_stage0_11_4
	kv_send0_10_3 -> ring_stage0_11_4
	ring_stage0_11_4 -> kv_send0_11_4
	ring_stage0_10_5 -> ring_stage0_11_5
	kv_send0_10_4 -> ring_stage0_11_5
	ring_stage0_11_5 -> kv_send0_11_5
	ring_stage0_10_6 -> ring_stage0_11_6
	kv_send0_10_5 -> ring_stage0_11_6
	ring_stage0_11_6 -> kv_send0_11_6
	ring_stage0_10_7 -> ring_stage0_11_7
	kv_send0_10_6 -> ring_stage0_11_7
	ring_stage0_11_7 -> kv_send0_11_7
	ring_stage0_10_8 -> ring_stage0_11_8
	kv_send0_10_7 -> ring_stage0_11_8
	ring_stage0_11_8 -> kv_send0_11_8
	ring_stage0_10_9 -> ring_stage0_11_9
	kv_send0_10_8 -> ring_stage0_11_9
	ring_stage0_11_9 -> kv_send0_11_9
	ring_stage0_10_10 -> ring_stage0_11_10
	kv_send0_10_9 -> ring_stage0_11_10
	ring_stage0_11_10 -> kv_send0_11_10
	ring_stage0_10_11 -> ring_stage0_11_11
	kv_send0_10_10 -> ring_stage0_11_11
	ring_stage0_11_11 -> kv_send0_11_11
	ring_stage0_10_12 -> ring_stage0_11_12
	kv_send0_10_11 -> ring_stage0_11_12
	ring_stage0_11_12 -> kv_send0_11_12
	ring_stage0_10_13 -> ring_stage0_11_13
	kv_send0_10_12 -> ring_stage0_11_13
	ring_stage0_11_13 -> kv_send0_11_13
	ring_stage0_10_14 -> ring_stage0_11_14
	kv_send0_10_13 -> ring_stage0_11_14
	ring_stage0_11_14 -> kv_send0_11_14
	ring_stage0_10_15 -> ring_stage0_11_15
	kv_send0_10_14 -> ring_stage0_11_15
	ring_stage0_11_15 -> kv_send0_11_15
	ring_stage0_11_0 -> ring_stage0_12_0
	kv_send0_11_15 -> ring_stage0_12_0
	ring_stage0_12_0 -> kv_send0_12_0
	ring_stage0_11_1 -> ring_stage0_12_1
	kv_send0_11_0 -> ring_stage0_12_1
	ring_stage0_12_1 -> kv_send0_12_1
	ring_stage0_11_2 -> ring_stage0_12_2
	kv_send0_11_1 -> ring_stage0_12_2
	ring_stage0_12_2 -> kv_send0_12_2
	ring_stage0_11_3 -> ring_stage0_12_3
	kv_send0_11_2 -> ring_stage0_12_3
	ring_stage0_12_3 -> kv_send0_12_3
	ring_stage0_11_4 -> ring_stage0_12_4
	kv_send0_11_3 -> ring_stage0_12_4
	ring_stage0_12_4 -> kv_send0_12_4
	ring_stage0_11_5 -> ring_stage0_12_5
	kv_send0_11_4 -> ring_stage0_12_5
	ring_stage0_12_5 -> kv_send0_12_5
	ring_stage0_11_6 -> ring_stage0_12_6
	kv_send0_11_5 -> ring_stage0_12_6
	ring_stage0_12_6 -> kv_send0_12_6
	ring_stage0_11_7 -> ring_stage0_12_7
	kv_send0_11_6 -> ring_stage0_12_7
	ring_stage0_12_7 -> kv_send0_12_7
	ring_stage0_11_8 -> ring_stage0_12_8
	kv_send0_11_7 -> ring_stage0_12_8
	ring_stage0_12_8 -> kv_send0_12_8
	ring_stage0_11_9 -> ring_stage0_12_9
	kv_send0_11_8 -> ring_stage0_12_9
	ring_stage0_12_9 -> kv_send0_12_9
	ring_stage0_11_10 -> ring_stage0_12_10
	kv_send0_11_9 -> ring_stage0_12_10
	ring_stage0_12_10 -> kv_send0_12_10
	ring_stage0_11_11 -> ring_stage0_12_11
	kv_send0_11_10 -> ring_stage0_12_11
	ring_stage0_12_11 -> kv_send0_12_11
	ring_stage0_11_12 -> ring_stage0_12_12
	kv_send0_11_11 -> ring_stage0_12_12
	ring_stage0_12_12 -> kv_send0_12_12
	ring_stage0_11_13 -> ring_stage0_12_13
	kv_send0_11_12 -> ring_stage0_12_13
	ring_stage0_12_13 -> kv_send0_12_13
	ring_stage0_11_14 -> ring_stage0_12_14
	kv_send0_11_13 -> ring_stage0_12_14
	ring_stage0_12_14 -> kv_send0_12_14
	ring_stage0_11_15 -> ring_stage0_12_15
	kv_send0_11_14 -> ring_stage0_12_15
	ring_stage0_12_15 -> kv_send0_12_15
	ring_stage0_12_0 -> ring_stage0_13_0
	kv_send0_12_15 -> ring_stage0_13_0
	ring_stage0_13_0 -> kv_send0_13_0
	ring_stage0_12_1 -> ring_stage0_13_1
	kv_send0_12_0 -> ring_stage0_13_1
	ring_stage0_13_1 -> kv_send0_13_1
	ring_stage0_12_2 -> ring_stage0_13_2
	kv_send0_12_1 -> ring_stage0_13_2
	ring_stage0_13_2 -> kv_send0_13_2
	ring_stage0_12_3 -> ring_stage0_13_3
	kv_send0_12_2 -> ring_stage0_13_3
	ring_stage0_13_3 -> kv_send0_13_3
	ring_stage0_12_4 -> ring_stage0_13_4
	kv_send0_12_3 -> ring_stage0_13_4
	ring_stage0_13_4 -> kv_send0_13_4
	ring_stage0_12_5 -> ring_stage0_13_5
	kv_send0_12_4 -> ring_stage0_13_5
	ring_stage0_13_5 -> kv_send0_13_5
	ring_stage0_12_6 -> ring_stage0_13_6
	kv_send0_12_5 -> ring_stage0_13_6
	ring_stage0_13_6 -> kv_send0_13_6
	ring_stage0_12_7 -> ring_stage0_13_7
	kv_send0_12_6 -> ring_stage0_13_7
	ring_stage0_13_7 -> kv_send0_13_7
	ring_stage0_12_8 -> ring_stage0_13_8
	kv_send0_12_7 -> ring_stage0_13_8
	ring_stage0_13_8 -> kv_send0_13_8
	ring_stage0_12_9 -> ring_stage0_13_9
	kv_send0_12_8 -> ring_stage0_13_9
	ring_stage0_13_9 -> kv_send0_13_9
	ring_stage0_12_10 -> ring_stage0_13_10
	kv_send0_12_9 -> ring_stage0_13_10
	ring_stage0_13_10 -> kv_send0_13_10
	ring_stage0_12_11 -> ring_stage0_13_11
	kv_send0_12_10 -> ring_stage0_13_11
	ring_stage0_13_11 -> kv_send0_13_11
	ring_stage0_12_12 -> ring_stage0_13_12
	kv_send0_12_11 -> ring_stage0_13_12
	ring_stage0_13_12 -> kv_send0_13_12
	ring_stage0_12_13 -> ring_stage0_13_13
	kv_send0_12_12 -> ring_stage0_13_13
	ring_stage0_13_13 -> kv_send0_13_13
	ring_stage0_12_14 -> ring_stage0_13_14
	kv_send0_12_13 -> ring_stage0_13_14
	ring_stage0_13_14 -> kv_send0_13_14
	ring_stage0_12_15 -> ring_stage0_13_15
	kv_send0_12_14 -> ring_stage0_13_15
	ring_stage0_13_15 -> kv_send0_13_15
	ring_stage0_13_0 -> ring_stage0_14_0
	kv_send0_13_15 -> ring_stage0_14_0
	ring_stage0_14_0 -> kv_send0_14_0
	ring_stage0_13_1 -> ring_stage0_14_1
	kv_send0_13_0 -> ring_stage0_14_1
	ring_stage0_14_1 -> kv_send0_14_1
	ring_stage0_13_2 -> ring_stage0_14_2
	kv_send0_13_1 -> ring_stage0_14_2
	ring_stage0_14_2 -> kv_send0_14_2
	ring_stage0_13_3 -> ring_stage0_14_3
	kv_send0_13_2 -> ring_stage0_14_3
	ring_stage0_14_3 -> kv_send0_14_3
	ring_stage0_13_4 -> ring_stage0_14_4
	kv_send0_13_3 -> ring_stage0_14_4
	ring_stage0_14_4 -> kv_send0_14_4
	ring_stage0_13_5 -> ring_stage0_14_5
	kv_send0_13_4 -> ring_stage0_14_5
	ring_stage0_14_5 -> kv_send0_14_5
	ring_stage0_13_6 -> ring_stage0_14_6
	kv_send0_13_5 -> ring_stage0_14_6
	ring_stage0_14_6 -> kv_send0_14_6
	ring_stage0_13_7 -> ring_stage0_14_7
	kv_send0_13_6 -> ring_stage0_14_7
	ring_stage0_14_7 -> kv_send0_14_7
	ring_stage0_13_8 -> ring_stage0_14_8
	kv_send0_13_7 -> ring_stage0_14_8
	ring_stage0_14_8 -> kv_send0_14_8
	ring_stage0_13_9 -> ring_stage0_14_9
	kv_send0_13_8 -> ring_stage0_14_9
	ring_stage0_14_9 -> kv_send0_14_9
	ring_stage0_13_10 -> ring_stage0_14_10
	kv_send0_13_9 -> ring_stage0_14_10
	ring_stage0_14_10 -> kv_send0_14_10
	ring_stage0_13_11 -> ring_stage0_14_11
	kv_send0_13_10 -> ring_stage0_14_11
	ring_stage0_14_11 -> kv_send0_14_11
	ring_stage0_13_12 -> ring_stage0_14_12
	kv_send0_13_11 -> ring_stage0_14_12
	ring_stage0_14_12 -> kv_send0_14_12
	ring_stage0_13_13 -> ring_stage0_14_13
	kv_send0_13_12 -> ring_stage0_14_13
	ring_stage0_14_13 -> kv_send0_14_13
	ring_stage0_13_14 -> ring_stage0_14_14
	kv_send0_13_13 -> ring_stage0_14_14
	ring_stage0_14_14 -> kv_send0_14_14
	ring_stage0_13_15 -> ring_stage0_14_15
	kv_send0_13_14 -> ring_stage0_14_15
	ring_stage0_14_15 -> kv_send0_14_15
	ring_stage0_14_0 -> ring_stage0_15_0
	kv_send0_14_15 -> ring_stage0_15_0
	ring_stage0_14_1 -> ring_stage0_15_1
	kv_send0_14_0 -> ring_stage0_15_1
	ring_stage0_14_2 -> ring_stage0_15_2
	kv_send0_14_1 -> ring_stage0_15_2
	ring_stage0_14_3 -> ring_stage0_15_3
	kv_send0_14_2 -> ring_stage0_15_3
	ring_stage0_14_4 -> ring_stage0_15_4
	kv_send0_14_3 -> ring_stage0_15_4
	ring_stage0_14_5 -> ring_stage0_15_5
	kv_send0_14_4 -> ring_stage0_15_5
	ring_stage0_14_6 -> ring_stage0_15_6
	kv_send0_14_5 -> ring_stage0_15_6
	ring_stage0_14_7 -> ring_stage0_15_7
	kv_send0_14_6 -> ring_stage0_15_7
	ring_stage0_14_8 -> ring_stage0_15_8
	kv_send0_14_7 -> ring_stage0_15_8
	ring_stage0_14_9 -> ring_stage0_15_9
	kv_send0_14_8 -> ring_stage0_15_9
	ring_stage0_14_10 -> ring_stage0_15_10
	kv_send0_14_9 -> ring_stage0_15_10
	ring_stage0_14_11 -> ring_stage0_15_11
	kv_send0_14_10 -> ring_stage0_15_11
	ring_stage0_14_12 -> ring_stage0_15_12
	kv_send0_14_11 -> ring_stage0_15_12
	ring_stage0_14_13 -> ring_stage0_15_13
	kv_send0_14_12 -> ring_stage0_15_13
	ring_stage0_14_14 -> ring_stage0_15_14
	kv_send0_14_13 -> ring_stage0_15_14
	ring_stage0_14_15 -> ring_stage0_15_15
	kv_send0_14_14 -> ring_stage0_15_15
	ring_stage0_15_0 -> accum0_0
	accum0_0 -> out_proj0_0
	out_proj0_0 -> res_attn0_0
	sp_split -> res_attn0_0
	res_attn0_0 -> gate0_0
	gate0_0 -> select0_0
	select0_0 -> expert0_0_0 [label="if selected" style=dashed]
	expert0_0_0 -> expert_act0_0_0
	expert_act0_0_0 -> expert_out0_0_0
	expert_out0_0_0 -> combine0_0
	select0_0 -> expert0_0_1 [label="if selected" style=dashed]
	expert0_0_1 -> expert_act0_0_1
	expert_act0_0_1 -> expert_out0_0_1
	expert_out0_0_1 -> combine0_0
	select0_0 -> expert0_0_2 [label="if selected" style=dashed]
	expert0_0_2 -> expert_act0_0_2
	expert_act0_0_2 -> expert_out0_0_2
	expert_out0_0_2 -> combine0_0
	select0_0 -> expert0_0_3 [label="if selected" style=dashed]
	expert0_0_3 -> expert_act0_0_3
	expert_act0_0_3 -> expert_out0_0_3
	expert_out0_0_3 -> combine0_0
	select0_0 -> expert0_0_4 [label="if selected" style=dashed]
	expert0_0_4 -> expert_act0_0_4
	expert_act0_0_4 -> expert_out0_0_4
	expert_out0_0_4 -> combine0_0
	select0_0 -> expert0_0_5 [label="if selected" style=dashed]
	expert0_0_5 -> expert_act0_0_5
	expert_act0_0_5 -> expert_out0_0_5
	expert_out0_0_5 -> combine0_0
	select0_0 -> expert0_0_6 [label="if selected" style=dashed]
	expert0_0_6 -> expert_act0_0_6
	expert_act0_0_6 -> expert_out0_0_6
	expert_out0_0_6 -> combine0_0
	select0_0 -> expert0_0_7 [label="if selected" style=dashed]
	expert0_0_7 -> expert_act0_0_7
	expert_act0_0_7 -> expert_out0_0_7
	expert_out0_0_7 -> combine0_0
	combine0_0 -> res_moe0_0
	res_attn0_0 -> res_moe0_0
	ring_stage0_15_1 -> accum0_1
	accum0_1 -> out_proj0_1
	out_proj0_1 -> res_attn0_1
	sp_split -> res_attn0_1
	res_attn0_1 -> gate0_1
	gate0_1 -> select0_1
	select0_1 -> expert0_1_0 [label="if selected" style=dashed]
	expert0_1_0 -> expert_act0_1_0
	expert_act0_1_0 -> expert_out0_1_0
	expert_out0_1_0 -> combine0_1
	select0_1 -> expert0_1_1 [label="if selected" style=dashed]
	expert0_1_1 -> expert_act0_1_1
	expert_act0_1_1 -> expert_out0_1_1
	expert_out0_1_1 -> combine0_1
	select0_1 -> expert0_1_2 [label="if selected" style=dashed]
	expert0_1_2 -> expert_act0_1_2
	expert_act0_1_2 -> expert_out0_1_2
	expert_out0_1_2 -> combine0_1
	select0_1 -> expert0_1_3 [label="if selected" style=dashed]
	expert0_1_3 -> expert_act0_1_3
	expert_act0_1_3 -> expert_out0_1_3
	expert_out0_1_3 -> combine0_1
	select0_1 -> expert0_1_4 [label="if selected" style=dashed]
	expert0_1_4 -> expert_act0_1_4
	expert_act0_1_4 -> expert_out0_1_4
	expert_out0_1_4 -> combine0_1
	select0_1 -> expert0_1_5 [label="if selected" style=dashed]
	expert0_1_5 -> expert_act0_1_5
	expert_act0_1_5 -> expert_out0_1_5
	expert_out0_1_5 -> combine0_1
	select0_1 -> expert0_1_6 [label="if selected" style=dashed]
	expert0_1_6 -> expert_act0_1_6
	expert_act0_1_6 -> expert_out0_1_6
	expert_out0_1_6 -> combine0_1
	select0_1 -> expert0_1_7 [label="if selected" style=dashed]
	expert0_1_7 -> expert_act0_1_7
	expert_act0_1_7 -> expert_out0_1_7
	expert_out0_1_7 -> combine0_1
	combine0_1 -> res_moe0_1
	res_attn0_1 -> res_moe0_1
	ring_stage0_15_2 -> accum0_2
	accum0_2 -> out_proj0_2
	out_proj0_2 -> res_attn0_2
	sp_split -> res_attn0_2
	res_attn0_2 -> gate0_2
	gate0_2 -> select0_2
	select0_2 -> expert0_2_0 [label="if selected" style=dashed]
	expert0_2_0 -> expert_act0_2_0
	expert_act0_2_0 -> expert_out0_2_0
	expert_out0_2_0 -> combine0_2
	select0_2 -> expert0_2_1 [label="if selected" style=dashed]
	expert0_2_1 -> expert_act0_2_1
	expert_act0_2_1 -> expert_out0_2_1
	expert_out0_2_1 -> combine0_2
	select0_2 -> expert0_2_2 [label="if selected" style=dashed]
	expert0_2_2 -> expert_act0_2_2
	expert_act0_2_2 -> expert_out0_2_2
	expert_out0_2_2 -> combine0_2
	select0_2 -> expert0_2_3 [label="if selected" style=dashed]
	expert0_2_3 -> expert_act0_2_3
	expert_act0_2_3 -> expert_out0_2_3
	expert_out0_2_3 -> combine0_2
	select0_2 -> expert0_2_4 [label="if selected" style=dashed]
	expert0_2_4 -> expert_act0_2_4
	expert_act0_2_4 -> expert_out0_2_4
	expert_out0_2_4 -> combine0_2
	select0_2 -> expert0_2_5 [label="if selected" style=dashed]
	expert0_2_5 -> expert_act0_2_5
	expert_act0_2_5 -> expert_out0_2_5
	expert_out0_2_5 -> combine0_2
	select0_2 -> expert0_2_6 [label="if selected" style=dashed]
	expert0_2_6 -> expert_act0_2_6
	expert_act0_2_6 -> expert_out0_2_6
	expert_out0_2_6 -> combine0_2
	select0_2 -> expert0_2_7 [label="if selected" style=dashed]
	expert0_2_7 -> expert_act0_2_7
	expert_act0_2_7 -> expert_out0_2_7
	expert_out0_2_7 -> combine0_2
	combine0_2 -> res_moe0_2
	res_attn0_2 -> res_moe0_2
	ring_stage0_15_3 -> accum0_3
	accum0_3 -> out_proj0_3
	out_proj0_3 -> res_attn0_3
	sp_split -> res_attn0_3
	res_attn0_3 -> gate0_3
	gate0_3 -> select0_3
	select0_3 -> expert0_3_0 [label="if selected" style=dashed]
	expert0_3_0 -> expert_act0_3_0
	expert_act0_3_0 -> expert_out0_3_0
	expert_out0_3_0 -> combine0_3
	select0_3 -> expert0_3_1 [label="if selected" style=dashed]
	expert0_3_1 -> expert_act0_3_1
	expert_act0_3_1 -> expert_out0_3_1
	expert_out0_3_1 -> combine0_3
	select0_3 -> expert0_3_2 [label="if selected" style=dashed]
	expert0_3_2 -> expert_act0_3_2
	expert_act0_3_2 -> expert_out0_3_2
	expert_out0_3_2 -> combine0_3
	select0_3 -> expert0_3_3 [label="if selected" style=dashed]
	expert0_3_3 -> expert_act0_3_3
	expert_act0_3_3 -> expert_out0_3_3
	expert_out0_3_3 -> combine0_3
	select0_3 -> expert0_3_4 [label="if selected" style=dashed]
	expert0_3_4 -> expert_act0_3_4
	expert_act0_3_4 -> expert_out0_3_4
	expert_out0_3_4 -> combine0_3
	select0_3 -> expert0_3_5 [label="if selected" style=dashed]
	expert0_3_5 -> expert_act0_3_5
	expert_act0_3_5 -> expert_out0_3_5
	expert_out0_3_5 -> combine0_3
	select0_3 -> expert0_3_6 [label="if selected" style=dashed]
	expert0_3_6 -> expert_act0_3_6
	expert_act0_3_6 -> expert_out0_3_6
	expert_out0_3_6 -> combine0_3
	select0_3 -> expert0_3_7 [label="if selected" style=dashed]
	expert0_3_7 -> expert_act0_3_7
	expert_act0_3_7 -> expert_out0_3_7
	expert_out0_3_7 -> combine0_3
	combine0_3 -> res_moe0_3
	res_attn0_3 -> res_moe0_3
	ring_stage0_15_4 -> accum0_4
	accum0_4 -> out_proj0_4
	out_proj0_4 -> res_attn0_4
	sp_split -> res_attn0_4
	res_attn0_4 -> gate0_4
	gate0_4 -> select0_4
	select0_4 -> expert0_4_0 [label="if selected" style=dashed]
	expert0_4_0 -> expert_act0_4_0
	expert_act0_4_0 -> expert_out0_4_0
	expert_out0_4_0 -> combine0_4
	select0_4 -> expert0_4_1 [label="if selected" style=dashed]
	expert0_4_1 -> expert_act0_4_1
	expert_act0_4_1 -> expert_out0_4_1
	expert_out0_4_1 -> combine0_4
	select0_4 -> expert0_4_2 [label="if selected" style=dashed]
	expert0_4_2 -> expert_act0_4_2
	expert_act0_4_2 -> expert_out0_4_2
	expert_out0_4_2 -> combine0_4
	select0_4 -> expert0_4_3 [label="if selected" style=dashed]
	expert0_4_3 -> expert_act0_4_3
	expert_act0_4_3 -> expert_out0_4_3
	expert_out0_4_3 -> combine0_4
	select0_4 -> expert0_4_4 [label="if selected" style=dashed]
	expert0_4_4 -> expert_act0_4_4
	expert_act0_4_4 -> expert_out0_4_4
	expert_out0_4_4 -> combine0_4
	select0_4 -> expert0_4_5 [label="if selected" style=dashed]
	expert0_4_5 -> expert_act0_4_5
	expert_act0_4_5 -> expert_out0_4_5
	expert_out0_4_5 -> combine0_4
	select0_4 -> expert0_4_6 [label="if selected" style=dashed]
	expert0_4_6 -> expert_act0_4_6
	expert_act0_4_6 -> expert_out0_4_6
	expert_out0_4_6 -> combine0_4
	select0_4 -> expert0_4_7 [label="if selected" style=dashed]
	expert0_4_7 -> expert_act0_4_7
	expert_act0_4_7 -> expert_out0_4_7
	expert_out0_4_7 -> combine0_4
	combine0_4 -> res_moe0_4
	res_attn0_4 -> res_moe0_4
	ring_stage0_15_5 -> accum0_5
	accum0_5 -> out_proj0_5
	out_proj0_5 -> res_attn0_5
	sp_split -> res_attn0_5
	res_attn0_5 -> gate0_5
	gate0_5 -> select0_5
	select0_5 -> expert0_5_0 [label="if selected" style=dashed]
	expert0_5_0 -> expert_act0_5_0
	expert_act0_5_0 -> expert_out0_5_0
	expert_out0_5_0 -> combine0_5
	select0_5 -> expert0_5_1 [label="if selected" style=dashed]
	expert0_5_1 -> expert_act0_5_1
	expert_act0_5_1 -> expert_out0_5_1
	expert_out0_5_1 -> combine0_5
	select0_5 -> expert0_5_2 [label="if selected" style=dashed]
	expert0_5_2 -> expert_act0_5_2
	expert_act0_5_2 -> expert_out0_5_2
	expert_out0_5_2 -> combine0_5
	select0_5 -> expert0_5_3 [label="if selected" style=dashed]
	expert0_5_3 -> expert_act0_5_3
	expert_act0_5_3 -> expert_out0_5_3
	expert_out0_5_3 -> combine0_5
	select0_5 -> expert0_5_4 [label="if selected" style=dashed]
	expert0_5_4 -> expert_act0_5_4
	expert_act0_5_4 -> expert_out0_5_4
	expert_out0_5_4 -> combine0_5
	select0_5 -> expert0_5_5 [label="if selected" style=dashed]
	expert0_5_5 -> expert_act0_5_5
	expert_act0_5_5 -> expert_out0_5_5
	expert_out0_5_5 -> combine0_5
	select0_5 -> expert0_5_6 [label="if selected" style=dashed]
	expert0_5_6 -> expert_act0_5_6
	expert_act0_5_6 -> expert_out0_5_6
	expert_out0_5_6 -> combine0_5
	select0_5 -> expert0_5_7 [label="if selected" style=dashed]
	expert0_5_7 -> expert_act0_5_7
	expert_act0_5_7 -> expert_out0_5_7
	expert_out0_5_7 -> combine0_5
	combine0_5 -> res_moe0_5
	res_attn0_5 -> res_moe0_5
	ring_stage0_15_6 -> accum0_6
	accum0_6 -> out_proj0_6
	out_proj0_6 -> res_attn0_6
	sp_split -> res_attn0_6
	res_attn0_6 -> gate0_6
	gate0_6 -> select0_6
	select0_6 -> expert0_6_0 [label="if selected" style=dashed]
	expert0_6_0 -> expert_act0_6_0
	expert_act0_6_0 -> expert_out0_6_0
	expert_out0_6_0 -> combine0_6
	select0_6 -> expert0_6_1 [label="if selected" style=dashed]
	expert0_6_1 -> expert_act0_6_1
	expert_act0_6_1 -> expert_out0_6_1
	expert_out0_6_1 -> combine0_6
	select0_6 -> expert0_6_2 [label="if selected" style=dashed]
	expert0_6_2 -> expert_act0_6_2
	expert_act0_6_2 -> expert_out0_6_2
	expert_out0_6_2 -> combine0_6
	select0_6 -> expert0_6_3 [label="if selected" style=dashed]
	expert0_6_3 -> expert_act0_6_3
	expert_act0_6_3 -> expert_out0_6_3
	expert_out0_6_3 -> combine0_6
	select0_6 -> expert0_6_4 [label="if selected" style=dashed]
	expert0_6_4 -> expert_act0_6_4
	expert_act0_6_4 -> expert_out0_6_4
	expert_out0_6_4 -> combine0_6
	select0_6 -> expert0_6_5 [label="if selected" style=dashed]
	expert0_6_5 -> expert_act0_6_5
	expert_act0_6_5 -> expert_out0_6_5
	expert_out0_6_5 -> combine0_6
	select0_6 -> expert0_6_6 [label="if selected" style=dashed]
	expert0_6_6 -> expert_act0_6_6
	expert_act0_6_6 -> expert_out0_6_6
	expert_out0_6_6 -> combine0_6
	select0_6 -> expert0_6_7 [label="if selected" style=dashed]
	expert0_6_7 -> expert_act0_6_7
	expert_act0_6_7 -> expert_out0_6_7
	expert_out0_6_7 -> combine0_6
	combine0_6 -> res_moe0_6
	res_attn0_6 -> res_moe0_6
	ring_stage0_15_7 -> accum0_7
	accum0_7 -> out_proj0_7
	out_proj0_7 -> res_attn0_7
	sp_split -> res_attn0_7
	res_attn0_7 -> gate0_7
	gate0_7 -> select0_7
	select0_7 -> expert0_7_0 [label="if selected" style=dashed]
	expert0_7_0 -> expert_act0_7_0
	expert_act0_7_0 -> expert_out0_7_0
	expert_out0_7_0 -> combine0_7
	select0_7 -> expert0_7_1 [label="if selected" style=dashed]
	expert0_7_1 -> expert_act0_7_1
	expert_act0_7_1 -> expert_out0_7_1
	expert_out0_7_1 -> combine0_7
	select0_7 -> expert0_7_2 [label="if selected" style=dashed]
	expert0_7_2 -> expert_act0_7_2
	expert_act0_7_2 -> expert_out0_7_2
	expert_out0_7_2 -> combine0_7
	select0_7 -> expert0_7_3 [label="if selected" style=dashed]
	expert0_7_3 -> expert_act0_7_3
	expert_act0_7_3 -> expert_out0_7_3
	expert_out0_7_3 -> combine0_7
	select0_7 -> expert0_7_4 [label="if selected" style=dashed]
	expert0_7_4 -> expert_act0_7_4
	expert_act0_7_4 -> expert_out0_7_4
	expert_out0_7_4 -> combine0_7
	select0_7 -> expert0_7_5 [label="if selected" style=dashed]
	expert0_7_5 -> expert_act0_7_5
	expert_act0_7_5 -> expert_out0_7_5
	expert_out0_7_5 -> combine0_7
	select0_7 -> expert0_7_6 [label="if selected" style=dashed]
	expert0_7_6 -> expert_act0_7_6
	expert_act0_7_6 -> expert_out0_7_6
	expert_out0_7_6 -> combine0_7
	select0_7 -> expert0_7_7 [label="if selected" style=dashed]
	expert0_7_7 -> expert_act0_7_7
	expert_act0_7_7 -> expert_out0_7_7
	expert_out0_7_7 -> combine0_7
	combine0_7 -> res_moe0_7
	res_attn0_7 -> res_moe0_7
	ring_stage0_15_8 -> accum0_8
	accum0_8 -> out_proj0_8
	out_proj0_8 -> res_attn0_8
	sp_split -> res_attn0_8
	res_attn0_8 -> gate0_8
	gate0_8 -> select0_8
	select0_8 -> expert0_8_0 [label="if selected" style=dashed]
	expert0_8_0 -> expert_act0_8_0
	expert_act0_8_0 -> expert_out0_8_0
	expert_out0_8_0 -> combine0_8
	select0_8 -> expert0_8_1 [label="if selected" style=dashed]
	expert0_8_1 -> expert_act0_8_1
	expert_act0_8_1 -> expert_out0_8_1
	expert_out0_8_1 -> combine0_8
	select0_8 -> expert0_8_2 [label="if selected" style=dashed]
	expert0_8_2 -> expert_act0_8_2
	expert_act0_8_2 -> expert_out0_8_2
	expert_out0_8_2 -> combine0_8
	select0_8 -> expert0_8_3 [label="if selected" style=dashed]
	expert0_8_3 -> expert_act0_8_3
	expert_act0_8_3 -> expert_out0_8_3
	expert_out0_8_3 -> combine0_8
	select0_8 -> expert0_8_4 [label="if selected" style=dashed]
	expert0_8_4 -> expert_act0_8_4
	expert_act0_8_4 -> expert_out0_8_4
	expert_out0_8_4 -> combine0_8
	select0_8 -> expert0_8_5 [label="if selected" style=dashed]
	expert0_8_5 -> expert_act0_8_5
	expert_act0_8_5 -> expert_out0_8_5
	expert_out0_8_5 -> combine0_8
	select0_8 -> expert0_8_6 [label="if selected" style=dashed]
	expert0_8_6 -> expert_act0_8_6
	expert_act0_8_6 -> expert_out0_8_6
	expert_out0_8_6 -> combine0_8
	select0_8 -> expert0_8_7 [label="if selected" style=dashed]
	expert0_8_7 -> expert_act0_8_7
	expert_act0_8_7 -> expert_out0_8_7
	expert_out0_8_7 -> combine0_8
	combine0_8 -> res_moe0_8
	res_attn0_8 -> res_moe0_8
	ring_stage0_15_9 -> accum0_9
	accum0_9 -> out_proj0_9
	out_proj0_9 -> res_attn0_9
	sp_split -> res_attn0_9
	res_attn0_9 -> gate0_9
	gate0_9 -> select0_9
	select0_9 -> expert0_9_0 [label="if selected" style=dashed]
	expert0_9_0 -> expert_act0_9_0
	expert_act0_9_0 -> expert_out0_9_0
	expert_out0_9_0 -> combine0_9
	select0_9 -> expert0_9_1 [label="if selected" style=dashed]
	expert0_9_1 -> expert_act0_9_1
	expert_act0_9_1 -> expert_out0_9_1
	expert_out0_9_1 -> combine0_9
	select0_9 -> expert0_9_2 [label="if selected" style=dashed]
	expert0_9_2 -> expert_act0_9_2
	expert_act0_9_2 -> expert_out0_9_2
	expert_out0_9_2 -> combine0_9
	select0_9 -> expert0_9_3 [label="if selected" style=dashed]
	expert0_9_3 -> expert_act0_9_3
	expert_act0_9_3 -> expert_out0_9_3
	expert_out0_9_3 -> combine0_9
	select0_9 -> expert0_9_4 [label="if selected" style=dashed]
	expert0_9_4 -> expert_act0_9_4
	expert_act0_9_4 -> expert_out0_9_4
	expert_out0_9_4 -> combine0_9
	select0_9 -> expert0_9_5 [label="if selected" style=dashed]
	expert0_9_5 -> expert_act0_9_5
	expert_act0_9_5 -> expert_out0_9_5
	expert_out0_9_5 -> combine0_9
	select0_9 -> expert0_9_6 [label="if selected" style=dashed]
	expert0_9_6 -> expert_act0_9_6
	expert_act0_9_6 -> expert_out0_9_6
	expert_out0_9_6 -> combine0_9
	select0_9 -> expert0_9_7 [label="if selected" style=dashed]
	expert0_9_7 -> expert_act0_9_7
	expert_act0_9_7 -> expert_out0_9_7
	expert_out0_9_7 -> combine0_9
	combine0_9 -> res_moe0_9
	res_attn0_9 -> res_moe0_9
	ring_stage0_15_10 -> accum0_10
	accum0_10 -> out_proj0_10
	out_proj0_10 -> res_attn0_10
	sp_split -> res_attn0_10
	res_attn0_10 -> gate0_10
	gate0_10 -> select0_10
	select0_10 -> expert0_10_0 [label="if selected" style=dashed]
	expert0_10_0 -> expert_act0_10_0
	expert_act0_10_0 -> expert_out0_10_0
	expert_out0_10_0 -> combine0_10
	select0_10 -> expert0_10_1 [label="if selected" style=dashed]
	expert0_10_1 -> expert_act0_10_1
	expert_act0_10_1 -> expert_out0_10_1
	expert_out0_10_1 -> combine0_10
	select0_10 -> expert0_10_2 [label="if selected" style=dashed]
	expert0_10_2 -> expert_act0_10_2
	expert_act0_10_2 -> expert_out0_10_2
	expert_out0_10_2 -> combine0_10
	select0_10 -> expert0_10_3 [label="if selected" style=dashed]
	expert0_10_3 -> expert_act0_10_3
	expert_act0_10_3 -> expert_out0_10_3
	expert_out0_10_3 -> combine0_10
	select0_10 -> expert0_10_4 [label="if selected" style=dashed]
	expert0_10_4 -> expert_act0_10_4
	expert_act0_10_4 -> expert_out0_10_4
	expert_out0_10_4 -> combine0_10
	select0_10 -> expert0_10_5 [label="if selected" style=dashed]
	expert0_10_5 -> expert_act0_10_5
	expert_act0_10_5 -> expert_out0_10_5
	expert_out0_10_5 -> combine0_10
	select0_10 -> expert0_10_6 [label="if selected" style=dashed]
	expert0_10_6 -> expert_act0_10_6
	expert_act0_10_6 -> expert_out0_10_6
	expert_out0_10_6 -> combine0_10
	select0_10 -> expert0_10_7 [label="if selected" style=dashed]
	expert0_10_7 -> expert_act0_10_7
	expert_act0_10_7 -> expert_out0_10_7
	expert_out0_10_7 -> combine0_10
	combine0_10 -> res_moe0_10
	res_attn0_10 -> res_moe0_10
	ring_stage0_15_11 -> accum0_11
	accum0_11 -> out_proj0_11
	out_proj0_11 -> res_attn0_11
	sp_split -> res_attn0_11
	res_attn0_11 -> gate0_11
	gate0_11 -> select0_11
	select0_11 -> expert0_11_0 [label="if selected" style=dashed]
	expert0_11_0 -> expert_act0_11_0
	expert_act0_11_0 -> expert_out0_11_0
	expert_out0_11_0 -> combine0_11
	select0_11 -> expert0_11_1 [label="if selected" style=dashed]
	expert0_11_1 -> expert_act0_11_1
	expert_act0_11_1 -> expert_out0_11_1
	expert_out0_11_1 -> combine0_11
	select0_11 -> expert0_11_2 [label="if selected" style=dashed]
	expert0_11_2 -> expert_act0_11_2
	expert_act0_11_2 -> expert_out0_11_2
	expert_out0_11_2 -> combine0_11
	select0_11 -> expert0_11_3 [label="if selected" style=dashed]
	expert0_11_3 -> expert_act0_11_3
	expert_act0_11_3 -> expert_out0_11_3
	expert_out0_11_3 -> combine0_11
	select0_11 -> expert0_11_4 [label="if selected" style=dashed]
	expert0_11_4 -> expert_act0_11_4
	expert_act0_11_4 -> expert_out0_11_4
	expert_out0_11_4 -> combine0_11
	select0_11 -> expert0_11_5 [label="if selected" style=dashed]
	expert0_11_5 -> expert_act0_11_5
	expert_act0_11_5 -> expert_out0_11_5
	expert_out0_11_5 -> combine0_11
	select0_11 -> expert0_11_6 [label="if selected" style=dashed]
	expert0_11_6 -> expert_act0_11_6
	expert_act0_11_6 -> expert_out0_11_6
	expert_out0_11_6 -> combine0_11
	select0_11 -> expert0_11_7 [label="if selected" style=dashed]
	expert0_11_7 -> expert_act0_11_7
	expert_act0_11_7 -> expert_out0_11_7
	expert_out0_11_7 -> combine0_11
	combine0_11 -> res_moe0_11
	res_attn0_11 -> res_moe0_11
	ring_stage0_15_12 -> accum0_12
	accum0_12 -> out_proj0_12
	out_proj0_12 -> res_attn0_12
	sp_split -> res_attn0_12
	res_attn0_12 -> gate0_12
	gate0_12 -> select0_12
	select0_12 -> expert0_12_0 [label="if selected" style=dashed]
	expert0_12_0 -> expert_act0_12_0
	expert_act0_12_0 -> expert_out0_12_0
	expert_out0_12_0 -> combine0_12
	select0_12 -> expert0_12_1 [label="if selected" style=dashed]
	expert0_12_1 -> expert_act0_12_1
	expert_act0_12_1 -> expert_out0_12_1
	expert_out0_12_1 -> combine0_12
	select0_12 -> expert0_12_2 [label="if selected" style=dashed]
	expert0_12_2 -> expert_act0_12_2
	expert_act0_12_2 -> expert_out0_12_2
	expert_out0_12_2 -> combine0_12
	select0_12 -> expert0_12_3 [label="if selected" style=dashed]
	expert0_12_3 -> expert_act0_12_3
	expert_act0_12_3 -> expert_out0_12_3
	expert_out0_12_3 -> combine0_12
	select0_12 -> expert0_12_4 [label="if selected" style=dashed]
	expert0_12_4 -> expert_act0_12_4
	expert_act0_12_4 -> expert_out0_12_4
	expert_out0_12_4 -> combine0_12
	select0_12 -> expert0_12_5 [label="if selected" style=dashed]
	expert0_12_5 -> expert_act0_12_5
	expert_act0_12_5 -> expert_out0_12_5
	expert_out0_12_5 -> combine0_12
	select0_12 -> expert0_12_6 [label="if selected" style=dashed]
	expert0_12_6 -> expert_act0_12_6
	expert_act0_12_6 -> expert_out0_12_6
	expert_out0_12_6 -> combine0_12
	select0_12 -> expert0_12_7 [label="if selected" style=dashed]
	expert0_12_7 -> expert_act0_12_7
	expert_act0_12_7 -> expert_out0_12_7
	expert_out0_12_7 -> combine0_12
	combine0_12 -> res_moe0_12
	res_attn0_12 -> res_moe0_12
	ring_stage0_15_13 -> accum0_13
	accum0_13 -> out_proj0_13
	out_proj0_13 -> res_attn0_13
	sp_split -> res_attn0_13
	res_attn0_13 -> gate0_13
	gate0_13 -> select0_13
	select0_13 -> expert0_13_0 [label="if selected" style=dashed]
	expert0_13_0 -> expert_act0_13_0
	expert_act0_13_0 -> expert_out0_13_0
	expert_out0_13_0 -> combine0_13
	select0_13 -> expert0_13_1 [label="if selected" style=dashed]
	expert0_13_1 -> expert_act0_13_1
	expert_act0_13_1 -> expert_out0_13_1
	expert_out0_13_1 -> combine0_13
	select0_13 -> expert0_13_2 [label="if selected" style=dashed]
	expert0_13_2 -> expert_act0_13_2
	expert_act0_13_2 -> expert_out0_13_2
	expert_out0_13_2 -> combine0_13
	select0_13 -> expert0_13_3 [label="if selected" style=dashed]
	expert0_13_3 -> expert_act0_13_3
	expert_act0_13_3 -> expert_out0_13_3
	expert_out0_13_3 -> combine0_13
	select0_13 -> expert0_13_4 [label="if selected" style=dashed]
	expert0_13_4 -> expert_act0_13_4
	expert_act0_13_4 -> expert_out0_13_4
	expert_out0_13_4 -> combine0_13
	select0_13 -> expert0_13_5 [label="if selected" style=dashed]
	expert0_13_5 -> expert_act0_13_5
	expert_act0_13_5 -> expert_out0_13_5
	expert_out0_13_5 -> combine0_13
	select0_13 -> expert0_13_6 [label="if selected" style=dashed]
	expert0_13_6 -> expert_act0_13_6
	expert_act0_13_6 -> expert_out0_13_6
	expert_out0_13_6 -> combine0_13
	select0_13 -> expert0_13_7 [label="if selected" style=dashed]
	expert0_13_7 -> expert_act0_13_7
	expert_act0_13_7 -> expert_out0_13_7
	expert_out0_13_7 -> combine0_13
	combine0_13 -> res_moe0_13
	res_attn0_13 -> res_moe0_13
	ring_stage0_15_14 -> accum0_14
	accum0_14 -> out_proj0_14
	out_proj0_14 -> res_attn0_14
	sp_split -> res_attn0_14
	res_attn0_14 -> gate0_14
	gate0_14 -> select0_14
	select0_14 -> expert0_14_0 [label="if selected" style=dashed]
	expert0_14_0 -> expert_act0_14_0
	expert_act0_14_0 -> expert_out0_14_0
	expert_out0_14_0 -> combine0_14
	select0_14 -> expert0_14_1 [label="if selected" style=dashed]
	expert0_14_1 -> expert_act0_14_1
	expert_act0_14_1 -> expert_out0_14_1
	expert_out0_14_1 -> combine0_14
	select0_14 -> expert0_14_2 [label="if selected" style=dashed]
	expert0_14_2 -> expert_act0_14_2
	expert_act0_14_2 -> expert_out0_14_2
	expert_out0_14_2 -> combine0_14
	select0_14 -> expert0_14_3 [label="if selected" style=dashed]
	expert0_14_3 -> expert_act0_14_3
	expert_act0_14_3 -> expert_out0_14_3
	expert_out0_14_3 -> combine0_14
	select0_14 -> expert0_14_4 [label="if selected" style=dashed]
	expert0_14_4 -> expert_act0_14_4
	expert_act0_14_4 -> expert_out0_14_4
	expert_out0_14_4 -> combine0_14
	select0_14 -> expert0_14_5 [label="if selected" style=dashed]
	expert0_14_5 -> expert_act0_14_5
	expert_act0_14_5 -> expert_out0_14_5
	expert_out0_14_5 -> combine0_14
	select0_14 -> expert0_14_6 [label="if selected" style=dashed]
	expert0_14_6 -> expert_act0_14_6
	expert_act0_14_6 -> expert_out0_14_6
	expert_out0_14_6 -> combine0_14
	select0_14 -> expert0_14_7 [label="if selected" style=dashed]
	expert0_14_7 -> expert_act0_14_7
	expert_act0_14_7 -> expert_out0_14_7
	expert_out0_14_7 -> combine0_14
	combine0_14 -> res_moe0_14
	res_attn0_14 -> res_moe0_14
	ring_stage0_15_15 -> accum0_15
	accum0_15 -> out_proj0_15
	out_proj0_15 -> res_attn0_15
	sp_split -> res_attn0_15
	res_attn0_15 -> gate0_15
	gate0_15 -> select0_15
	select0_15 -> expert0_15_0 [label="if selected" style=dashed]
	expert0_15_0 -> expert_act0_15_0
	expert_act0_15_0 -> expert_out0_15_0
	expert_out0_15_0 -> combine0_15
	select0_15 -> expert0_15_1 [label="if selected" style=dashed]
	expert0_15_1 -> expert_act0_15_1
	expert_act0_15_1 -> expert_out0_15_1
	expert_out0_15_1 -> combine0_15
	select0_15 -> expert0_15_2 [label="if selected" style=dashed]
	expert0_15_2 -> expert_act0_15_2
	expert_act0_15_2 -> expert_out0_15_2
	expert_out0_15_2 -> combine0_15
	select0_15 -> expert0_15_3 [label="if selected" style=dashed]
	expert0_15_3 -> expert_act0_15_3
	expert_act0_15_3 -> expert_out0_15_3
	expert_out0_15_3 -> combine0_15
	select0_15 -> expert0_15_4 [label="if selected" style=dashed]
	expert0_15_4 -> expert_act0_15_4
	expert_act0_15_4 -> expert_out0_15_4
	expert_out0_15_4 -> combine0_15
	select0_15 -> expert0_15_5 [label="if selected" style=dashed]
	expert0_15_5 -> expert_act0_15_5
	expert_act0_15_5 -> expert_out0_15_5
	expert_out0_15_5 -> combine0_15
	select0_15 -> expert0_15_6 [label="if selected" style=dashed]
	expert0_15_6 -> expert_act0_15_6
	expert_act0_15_6 -> expert_out0_15_6
	expert_out0_15_6 -> combine0_15
	select0_15 -> expert0_15_7 [label="if selected" style=dashed]
	expert0_15_7 -> expert_act0_15_7
	expert_act0_15_7 -> expert_out0_15_7
	expert_out0_15_7 -> combine0_15
	combine0_15 -> res_moe0_15
	res_attn0_15 -> res_moe0_15
	res_moe0_0 -> qkv1_0
	res_moe0_1 -> qkv1_1
	res_moe0_2 -> qkv1_2
	res_moe0_3 -> qkv1_3
	res_moe0_4 -> qkv1_4
	res_moe0_5 -> qkv1_5
	res_moe0_6 -> qkv1_6
	res_moe0_7 -> qkv1_7
	res_moe0_8 -> qkv1_8
	res_moe0_9 -> qkv1_9
	res_moe0_10 -> qkv1_10
	res_moe0_11 -> qkv1_11
	res_moe0_12 -> qkv1_12
	res_moe0_13 -> qkv1_13
	res_moe0_14 -> qkv1_14
	res_moe0_15 -> qkv1_15
	qkv1_0 -> ring_stage1_0_0
	qkv1_1 -> ring_stage1_0_1
	qkv1_2 -> ring_stage1_0_2
	qkv1_3 -> ring_stage1_0_3
	qkv1_4 -> ring_stage1_0_4
	qkv1_5 -> ring_stage1_0_5
	qkv1_6 -> ring_stage1_0_6
	qkv1_7 -> ring_stage1_0_7
	qkv1_8 -> ring_stage1_0_8
	qkv1_9 -> ring_stage1_0_9
	qkv1_10 -> ring_stage1_0_10
	qkv1_11 -> ring_stage1_0_11
	qkv1_12 -> ring_stage1_0_12
	qkv1_13 -> ring_stage1_0_13
	qkv1_14 -> ring_stage1_0_14
	qkv1_15 -> ring_stage1_0_15
	ring_stage1_0_0 -> kv_send1_0_0
	ring_stage1_0_1 -> kv_send1_0_1
	ring_stage1_0_2 -> kv_send1_0_2
	ring_stage1_0_3 -> kv_send1_0_3
	ring_stage1_0_4 -> kv_send1_0_4
	ring_stage1_0_5 -> kv_send1_0_5
	ring_stage1_0_6 -> kv_send1_0_6
	ring_stage1_0_7 -> kv_send1_0_7
	ring_stage1_0_8 -> kv_send1_0_8
	ring_stage1_0_9 -> kv_send1_0_9
	ring_stage1_0_10 -> kv_send1_0_10
	ring_stage1_0_11 -> kv_send1_0_11
	ring_stage1_0_12 -> kv_send1_0_12
	ring_stage1_0_13 -> kv_send1_0_13
	ring_stage1_0_14 -> kv_send1_0_14
	ring_stage1_0_15 -> kv_send1_0_15
	ring_stage1_0_0 -> ring_stage1_1_0
	kv_send1_0_15 -> ring_stage1_1_0
	ring_stage1_1_0 -> kv_send1_1_0
	ring_stage1_0_1 -> ring_stage1_1_1
	kv_send1_0_0 -> ring_stage1_1_1
	ring_stage1_1_1 -> kv_send1_1_1
	ring_stage1_0_2 -> ring_stage1_1_2
	kv_send1_0_1 -> ring_stage1_1_2
	ring_stage1_1_2 -> kv_send1_1_2
	ring_stage1_0_3 -> ring_stage1_1_3
	kv_send1_0_2 -> ring_stage1_1_3
	ring_stage1_1_3 -> kv_send1_1_3
	ring_stage1_0_4 -> ring_stage1_1_4
	kv_send1_0_3 -> ring_stage1_1_4
	ring_stage1_1_4 -> kv_send1_1_4
	ring_stage1_0_5 -> ring_stage1_1_5
	kv_send1_0_4 -> ring_stage1_1_5
	ring_stage1_1_5 -> kv_send1_1_5
	ring_stage1_0_6 -> ring_stage1_1_6
	kv_send1_0_5 -> ring_stage1_1_6
	ring_stage1_1_6 -> kv_send1_1_6
	ring_stage1_0_7 -> ring_stage1_1_7
	kv_send1_0_6 -> ring_stage1_1_7
	ring_stage1_1_7 -> kv_send1_1_7
	ring_stage1_0_8 -> ring_stage1_1_8
	kv_send1_0_7 -> ring_stage1_1_8
	ring_stage1_1_8 -> kv_send1_1_8
	ring_stage1_0_9 -> ring_stage1_1_9
	kv_send1_0_8 -> ring_stage1_1_9
	ring_stage1_1_9 -> kv_send1_1_9
	ring_stage1_0_10 -> ring_stage1_1_10
	kv_send1_0_9 -> ring_stage1_1_10
	ring_stage1_1_10 -> kv_send1_1_10
	ring_stage1_0_11 -> ring_stage1_1_11
	kv_send1_0_10 -> ring_stage1_1_11
	ring_stage1_1_11 -> kv_send1_1_11
	ring_stage1_0_12 -> ring_stage1_1_12
	kv_send1_0_11 -> ring_stage1_1_12
	ring_stage1_1_12 -> kv_send1_1_12
	ring_stage1_0_13 -> ring_stage1_1_13
	kv_send1_0_12 -> ring_stage1_1_13
	ring_stage1_1_13 -> kv_send1_1_13
	ring_stage1_0_14 -> ring_stage1_1_14
	kv_send1_0_13 -> ring_stage1_1_14
	ring_stage1_1_14 -> kv_send1_1_14
	ring_stage1_0_15 -> ring_stage1_1_15
	kv_send1_0_14 -> ring_stage1_1_15
	ring_stage1_1_15 -> kv_send1_1_15
	ring_stage1_1_0 -> ring_stage1_2_0
	kv_send1_1_15 -> ring_stage1_2_0
	ring_stage1_2_0 -> kv_send1_2_0
	ring_stage1_1_1 -> ring_stage1_2_1
	kv_send1_1_0 -> ring_stage1_2_1
	ring_stage1_2_1 -> kv_send1_2_1
	ring_stage1_1_2 -> ring_stage1_2_2
	kv_send1_1_1 -> ring_stage1_2_2
	ring_stage1_2_2 -> kv_send1_2_2
	ring_stage1_1_3 -> ring_stage1_2_3
	kv_send1_1_2 -> ring_stage1_2_3
	ring_stage1_2_3 -> kv_send1_2_3
	ring_stage1_1_4 -> ring_stage1_2_4
	kv_send1_1_3 -> ring_stage1_2_4
	ring_stage1_2_4 -> kv_send1_2_4
	ring_stage1_1_5 -> ring_stage1_2_5
	kv_send1_1_4 -> ring_stage1_2_5
	ring_stage1_2_5 -> kv_send1_2_5
	ring_stage1_1_6 -> ring_stage1_2_6
	kv_send1_1_5 -> ring_stage1_2_6
	ring_stage1_2_6 -> kv_send1_2_6
	ring_stage1_1_7 -> ring_stage1_2_7
	kv_send1_1_6 -> ring_stage1_2_7
	ring_stage1_2_7 -> kv_send1_2_7
	ring_stage1_1_8 -> ring_stage1_2_8
	kv_send1_1_7 -> ring_stage1_2_8
	ring_stage1_2_8 -> kv_send1_2_8
	ring_stage1_1_9 -> ring_stage1_2_9
	kv_send1_1_8 -> ring_stage1_2_9
	ring_stage1_2_9 -> kv_send1_2_9
	ring_stage1_1_10 -> ring_stage1_2_10
	kv_send1_1_9 -> ring_stage1_2_10
	ring_stage1_2_10 -> kv_send1_2_10
	ring_stage1_1_11 -> ring_stage1_2_11
	kv_send1_1_10 -> ring_stage1_2_11
	ring_stage1_2_11 -> kv_send1_2_11
	ring_stage1_1_12 -> ring_stage1_2_12
	kv_send1_1_11 -> ring_stage1_2_12
	ring_stage1_2_12 -> kv_send1_2_12
	ring_stage1_1_13 -> ring_stage1_2_13
	kv_send1_1_12 -> ring_stage1_2_13
	ring_stage1_2_13 -> kv_send1_2_13
	ring_stage1_1_14 -> ring_stage1_2_14
	kv_send1_1_13 -> ring_stage1_2_14
	ring_stage1_2_14 -> kv_send1_2_14
	ring_stage1_1_15 -> ring_stage1_2_15
	kv_send1_1_14 -> ring_stage1_2_15
	ring_stage1_2_15 -> kv_send1_2_15
	ring_stage1_2_0 -> ring_stage1_3_0
	kv_send1_2_15 -> ring_stage1_3_0
	ring_stage1_3_0 -> kv_send1_3_0
	ring_stage1_2_1 -> ring_stage1_3_1
	kv_send1_2_0 -> ring_stage1_3_1
	ring_stage1_3_1 -> kv_send1_3_1
	ring_stage1_2_2 -> ring_stage1_3_2
	kv_send1_2_1 -> ring_stage1_3_2
	ring_stage1_3_2 -> kv_send1_3_2
	ring_stage1_2_3 -> ring_stage1_3_3
	kv_send1_2_2 -> ring_stage1_3_3
	ring_stage1_3_3 -> kv_send1_3_3
	ring_stage1_2_4 -> ring_stage1_3_4
	kv_send1_2_3 -> ring_stage1_3_4
	ring_stage1_3_4 -> kv_send1_3_4
	ring_stage1_2_5 -> ring_stage1_3_5
	kv_send1_2_4 -> ring_stage1_3_5
	ring_stage1_3_5 -> kv_send1_3_5
	ring_stage1_2_6 -> ring_stage1_3_6
	kv_send1_2_5 -> ring_stage1_3_6
	ring_stage1_3_6 -> kv_send1_3_6
	ring_stage1_2_7 -> ring_stage1_3_7
	kv_send1_2_6 -> ring_stage1_3_7
	ring_stage1_3_7 -> kv_send1_3_7
	ring_stage1_2_8 -> ring_stage1_3_8
	kv_send1_2_7 -> ring_stage1_3_8
	ring_stage1_3_8 -> kv_send1_3_8
	ring_stage1_2_9 -> ring_stage1_3_9
	kv_send1_2_8 -> ring_stage1_3_9
	ring_stage1_3_9 -> kv_send1_3_9
	ring_stage1_2_10 -> ring_stage1_3_10
	kv_send1_2_9 -> ring_stage1_3_10
	ring_stage1_3_10 -> kv_send1_3_10
	ring_stage1_2_11 -> ring_stage1_3_11
	kv_send1_2_10 -> ring_stage1_3_11
	ring_stage1_3_11 -> kv_send1_3_11
	ring_stage1_2_12 -> ring_stage1_3_12
	kv_send1_2_11 -> ring_stage1_3_12
	ring_stage1_3_12 -> kv_send1_3_12
	ring_stage1_2_13 -> ring_stage1_3_13
	kv_send1_2_12 -> ring_stage1_3_13
	ring_stage1_3_13 -> kv_send1_3_13
	ring_stage1_2_14 -> ring_stage1_3_14
	kv_send1_2_13 -> ring_stage1_3_14
	ring_stage1_3_14 -> kv_send1_3_14
	ring_stage1_2_15 -> ring_stage1_3_15
	kv_send1_2_14 -> ring_stage1_3_15
	ring_stage1_3_15 -> kv_send1_3_15
	ring_stage1_3_0 -> ring_stage1_4_0
	kv_send1_3_15 -> ring_stage1_4_0
	ring_stage1_4_0 -> kv_send1_4_0
	ring_stage1_3_1 -> ring_stage1_4_1
	kv_send1_3_0 -> ring_stage1_4_1
	ring_stage1_4_1 -> kv_send1_4_1
	ring_stage1_3_2 -> ring_stage1_4_2
	kv_send1_3_1 -> ring_stage1_4_2
	ring_stage1_4_2 -> kv_send1_4_2
	ring_stage1_3_3 -> ring_stage1_4_3
	kv_send1_3_2 -> ring_stage1_4_3
	ring_stage1_4_3 -> kv_send1_4_3
	ring_stage1_3_4 -> ring_stage1_4_4
	kv_send1_3_3 -> ring_stage1_4_4
	ring_stage1_4_4 -> kv_send1_4_4
	ring_stage1_3_5 -> ring_stage1_4_5
	kv_send1_3_4 -> ring_stage1_4_5
	ring_stage1_4_5 -> kv_send1_4_5
	ring_stage1_3_6 -> ring_stage1_4_6
	kv_send1_3_5 -> ring_stage1_4_6
	ring_stage1_4_6 -> kv_send1_4_6
	ring_stage1_3_7 -> ring_stage1_4_7
	kv_send1_3_6 -> ring_stage1_4_7
	ring_stage1_4_7 -> kv_send1_4_7
	ring_stage1_3_8 -> ring_stage1_4_8
	kv_send1_3_7 -> ring_stage1_4_8
	ring_stage1_4_8 -> kv_send1_4_8
	ring_stage1_3_9 -> ring_stage1_4_9
	kv_send1_3_8 -> ring_stage1_4_9
	ring_stage1_4_9 -> kv_send1_4_9
	ring_stage1_3_10 -> ring_stage1_4_10
	kv_send1_3_9 -> ring_stage1_4_10
	ring_stage1_4_10 -> kv_send1_4_10
	ring_stage1_3_11 -> ring_stage1_4_11
	kv_send1_3_10 -> ring_stage1_4_11
	ring_stage1_4_11 -> kv_send1_4_11
	ring_stage1_3_12 -> ring_stage1_4_12
	kv_send1_3_11 -> ring_stage1_4_12
	ring_stage1_4_12 -> kv_send1_4_12
	ring_stage1_3_13 -> ring_stage1_4_13
	kv_send1_3_12 -> ring_stage1_4_13
	ring_stage1_4_13 -> kv_send1_4_13
	ring_stage1_3_14 -> ring_stage1_4_14
	kv_send1_3_13 -> ring_stage1_4_14
	ring_stage1_4_14 -> kv_send1_4_14
	ring_stage1_3_15 -> ring_stage1_4_15
	kv_send1_3_14 -> ring_stage1_4_15
	ring_stage1_4_15 -> kv_send1_4_15
	ring_stage1_4_0 -> ring_stage1_5_0
	kv_send1_4_15 -> ring_stage1_5_0
	ring_stage1_5_0 -> kv_send1_5_0
	ring_stage1_4_1 -> ring_stage1_5_1
	kv_send1_4_0 -> ring_stage1_5_1
	ring_stage1_5_1 -> kv_send1_5_1
	ring_stage1_4_2 -> ring_stage1_5_2
	kv_send1_4_1 -> ring_stage1_5_2
	ring_stage1_5_2 -> kv_send1_5_2
	ring_stage1_4_3 -> ring_stage1_5_3
	kv_send1_4_2 -> ring_stage1_5_3
	ring_stage1_5_3 -> kv_send1_5_3
	ring_stage1_4_4 -> ring_stage1_5_4
	kv_send1_4_3 -> ring_stage1_5_4
	ring_stage1_5_4 -> kv_send1_5_4
	ring_stage1_4_5 -> ring_stage1_5_5
	kv_send1_4_4 -> ring_stage1_5_5
	ring_stage1_5_5 -> kv_send1_5_5
	ring_stage1_4_6 -> ring_stage1_5_6
	kv_send1_4_5 -> ring_stage1_5_6
	ring_stage1_5_6 -> kv_send1_5_6
	ring_stage1_4_7 -> ring_stage1_5_7
	kv_send1_4_6 -> ring_stage1_5_7
	ring_stage1_5_7 -> kv_send1_5_7
	ring_stage1_4_8 -> ring_stage1_5_8
	kv_send1_4_7 -> ring_stage1_5_8
	ring_stage1_5_8 -> kv_send1_5_8
	ring_stage1_4_9 -> ring_stage1_5_9
	kv_send1_4_8 -> ring_stage1_5_9
	ring_stage1_5_9 -> kv_send1_5_9
	ring_stage1_4_10 -> ring_stage1_5_10
	kv_send1_4_9 -> ring_stage1_5_10
	ring_stage1_5_10 -> kv_send1_5_10
	ring_stage1_4_11 -> ring_stage1_5_11
	kv_send1_4_10 -> ring_stage1_5_11
	ring_stage1_5_11 -> kv_send1_5_11
	ring_stage1_4_12 -> ring_stage1_5_12
	kv_send1_4_11 -> ring_stage1_5_12
	ring_stage1_5_12 -> kv_send1_5_12
	ring_stage1_4_13 -> ring_stage1_5_13
	kv_send1_4_12 -> ring_stage1_5_13
	ring_stage1_5_13 -> kv_send1_5_13
	ring_stage1_4_14 -> ring_stage1_5_14
	kv_send1_4_13 -> ring_stage1_5_14
	ring_stage1_5_14 -> kv_send1_5_14
	ring_stage1_4_15 -> ring_stage1_5_15
	kv_send1_4_14 -> ring_stage1_5_15
	ring_stage1_5_15 -> kv_send1_5_15
	ring_stage1_5_0 -> ring_stage1_6_0
	kv_send1_5_15 -> ring_stage1_6_0
	ring_stage1_6_0 -> kv_send1_6_0
	ring_stage1_5_1 -> ring_stage1_6_1
	kv_send1_5_0 -> ring_stage1_6_1
	ring_stage1_6_1 -> kv_send1_6_1
	ring_stage1_5_2 -> ring_stage1_6_2
	kv_send1_5_1 -> ring_stage1_6_2
	ring_stage1_6_2 -> kv_send1_6_2
	ring_stage1_5_3 -> ring_stage1_6_3
	kv_send1_5_2 -> ring_stage1_6_3
	ring_stage1_6_3 -> kv_send1_6_3
	ring_stage1_5_4 -> ring_stage1_6_4
	kv_send1_5_3 -> ring_stage1_6_4
	ring_stage1_6_4 -> kv_send1_6_4
	ring_stage1_5_5 -> ring_stage1_6_5
	kv_send1_5_4 -> ring_stage1_6_5
	ring_stage1_6_5 -> kv_send1_6_5
	ring_stage1_5_6 -> ring_stage1_6_6
	kv_send1_5_5 -> ring_stage1_6_6
	ring_stage1_6_6 -> kv_send1_6_6
	ring_stage1_5_7 -> ring_stage1_6_7
	kv_send1_5_6 -> ring_stage1_6_7
	ring_stage1_6_7 -> kv_send1_6_7
	ring_stage1_5_8 -> ring_stage1_6_8
	kv_send1_5_7 -> ring_stage1_6_8
	ring_stage1_6_8 -> kv_send1_6_8
	ring_stage1_5_9 -> ring_stage1_6_9
	kv_send1_5_8 -> ring_stage1_6_9
	ring_stage1_6_9 -> kv_send1_6_9
	ring_stage1_5_10 -> ring_stage1_6_10
	kv_send1_5_9 -> ring_stage1_6_10
	ring_stage1_6_10 -> kv_send1_6_10
	ring_stage1_5_11 -> ring_stage1_6_11
	kv_send1_5_10 -> ring_stage1_6_11
	ring_stage1_6_11 -> kv_send1_6_11
	ring_stage1_5_12 -> ring_stage1_6_12
	kv_send1_5_11 -> ring_stage1_6_12
	ring_stage1_6_12 -> kv_send1_6_12
	ring_stage1_5_13 -> ring_stage1_6_13
	kv_send1_5_12 -> ring_stage1_6_13
	ring_stage1_6_13 -> kv_send1_6_13
	ring_stage1_5_14 -> ring_stage1_6_14
	kv_send1_5_13 -> ring_stage1_6_14
	ring_stage1_6_14 -> kv_send1_6_14
	ring_stage1_5_15 -> ring_stage1_6_15
	kv_send1_5_14 -> ring_stage1_6_15
	ring_stage1_6_15 -> kv_send1_6_15
	ring_stage1_6_0 -> ring_stage1_7_0
	kv_send1_6_15 -> ring_stage1_7_0
	ring_stage1_7_0 -> kv_send1_7_0
	ring_stage1_6_1 -> ring_stage1_7_1
	kv_send1_6_0 -> ring_stage1_7_1
	ring_stage1_7_1 -> kv_send1_7_1
	ring_stage1_6_2 -> ring_stage1_7_2
	kv_send1_6_1 -> ring_stage1_7_2
	ring_stage1_7_2 -> kv_send1_7_2
	ring_stage1_6_3 -> ring_stage1_7_3
	kv_send1_6_2 -> ring_stage1_7_3
	ring_stage1_7_3 -> kv_send1_7_3
	ring_stage1_6_4 -> ring_stage1_7_4
	kv_send1_6_3 -> ring_stage1_7_4
	ring_stage1_7_4 -> kv_send1_7_4
	ring_stage1_6_5 -> ring_stage1_7_5
	kv_send1_6_4 -> ring_stage1_7_5
	ring_stage1_7_5 -> kv_send1_7_5
	ring_stage1_6_6 -> ring_stage1_7_6
	kv_send1_6_5 -> ring_stage1_7_6
	ring_stage1_7_6 -> kv_send1_7_6
	ring_stage1_6_7 -> ring_stage1_7_7
	kv_send1_6_6 -> ring_stage1_7_7
	ring_stage1_7_7 -> kv_send1_7_7
	ring_stage1_6_8 -> ring_stage1_7_8
	kv_send1_6_7 -> ring_stage1_7_8
	ring_stage1_7_8 -> kv_send1_7_8
	ring_stage1_6_9 -> ring_stage1_7_9
	kv_send1_6_8 -> ring_stage1_7_9
	ring_stage1_7_9 -> kv_send1_7_9
	ring_stage1_6_10 -> ring_stage1_7_10
	kv_send1_6_9 -> ring_stage1_7_10
	ring_stage1_7_10 -> kv_send1_7_10
	ring_stage1_6_11 -> ring_stage1_7_11
	kv_send1_6_10 -> ring_stage1_7_11
	ring_stage1_7_11 -> kv_send1_7_11
	ring_stage1_6_12 -> ring_stage1_7_12
	kv_send1_6_11 -> ring_stage1_7_12
	ring_stage1_7_12 -> kv_send1_7_12
	ring_stage1_6_13 -> ring_stage1_7_13
	kv_send1_6_12 -> ring_stage1_7_13
	ring_stage1_7_13 -> kv_send1_7_13
	ring_stage1_6_14 -> ring_stage1_7_14
	kv_send1_6_13 -> ring_stage1_7_14
	ring_stage1_7_14 -> kv_send1_7_14
	ring_stage1_6_15 -> ring_stage1_7_15
	kv_send1_6_14 -> ring_stage1_7_15
	ring_stage1_7_15 -> kv_send1_7_15
	ring_stage1_7_0 -> ring_stage1_8_0
	kv_send1_7_15 -> ring_stage1_8_0
	ring_stage1_8_0 -> kv_send1_8_0
	ring_stage1_7_1 -> ring_stage1_8_1
	kv_send1_7_0 -> ring_stage1_8_1
	ring_stage1_8_1 -> kv_send1_8_1
	ring_stage1_7_2 -> ring_stage1_8_2
	kv_send1_7_1 -> ring_stage1_8_2
	ring_stage1_8_2 -> kv_send1_8_2
	ring_stage1_7_3 -> ring_stage1_8_3
	kv_send1_7_2 -> ring_stage1_8_3
	ring_stage1_8_3 -> kv_send1_8_3
	ring_stage1_7_4 -> ring_stage1_8_4
	kv_send1_7_3 -> ring_stage1_8_4
	ring_stage1_8_4 -> kv_send1_8_4
	ring_stage1_7_5 -> ring_stage1_8_5
	kv_send1_7_4 -> ring_stage1_8_5
	ring_stage1_8_5 -> kv_send1_8_5
	ring_stage1_7_6 -> ring_stage1_8_6
	kv_send1_7_5 -> ring_stage1_8_6
	ring_stage1_8_6 -> kv_send1_8_6
	ring_stage1_7_7 -> ring_stage1_8_7
	kv_send1_7_6 -> ring_stage1_8_7
	ring_stage1_8_7 -> kv_send1_8_7
	ring_stage1_7_8 -> ring_stage1_8_8
	kv_send1_7_7 -> ring_stage1_8_8
	ring_stage1_8_8 -> kv_send1_8_8
	ring_stage1_7_9 -> ring_stage1_8_9
	kv_send1_7_8 -> ring_stage1_8_9
	ring_stage1_8_9 -> kv_send1_8_9
	ring_stage1_7_10 -> ring_stage1_8_10
	kv_send1_7_9 -> ring_stage1_8_10
	ring_stage1_8_10 -> kv_send1_8_10
	ring_stage1_7_11 -> ring_stage1_8_11
	kv_send1_7_10 -> ring_stage1_8_11
	ring_stage1_8_11 -> kv_send1_8_11
	ring_stage1_7_12 -> ring_stage1_8_12
	kv_send1_7_11 -> ring_stage1_8_12
	ring_stage1_8_12 -> kv_send1_8_12
	ring_stage1_7_13 -> ring_stage1_8_13
	kv_send1_7_12 -> ring_stage1_8_13
	ring_stage1_8_13 -> kv_send1_8_13
	ring_stage1_7_14 -> ring_stage1_8_14
	kv_send1_7_13 -> ring_stage1_8_14
	ring_stage1_8_14 -> kv_send1_8_14
	ring_stage1_7_15 -> ring_stage1_8_15
	kv_send1_7_14 -> ring_stage1_8_15
	ring_stage1_8_15 -> kv_send1_8_15
	ring_stage1_8_0 -> ring_stage1_9_0
	kv_send1_8_15 -> ring_stage1_9_0
	ring_stage1_9_0 -> kv_send1_9_0
	ring_stage1_8_1 -> ring_stage1_9_1
	kv_send1_8_0 -> ring_stage1_9_1
	ring_stage1_9_1 -> kv_send1_9_1
	ring_stage1_8_2 -> ring_stage1_9_2
	kv_send1_8_1 -> ring_stage1_9_2
	ring_stage1_9_2 -> kv_send1_9_2
	ring_stage1_8_3 -> ring_stage1_9_3
	kv_send1_8_2 -> ring_stage1_9_3
	ring_stage1_9_3 -> kv_send1_9_3
	ring_stage1_8_4 -> ring_stage1_9_4
	kv_send1_8_3 -> ring_stage1_9_4
	ring_stage1_9_4 -> kv_send1_9_4
	ring_stage1_8_5 -> ring_stage1_9_5
	kv_send1_8_4 -> ring_stage1_9_5
	ring_stage1_9_5 -> kv_send1_9_5
	ring_stage1_8_6 -> ring_stage1_9_6
	kv_send1_8_5 -> ring_stage1_9_6
	ring_stage1_9_6 -> kv_send1_9_6
	ring_stage1_8_7 -> ring_stage1_9_7
	kv_send1_8_6 -> ring_stage1_9_7
	ring_stage1_9_7 -> kv_send1_9_7
	ring_stage1_8_8 -> ring_stage1_9_8
	kv_send1_8_7 -> ring_stage1_9_8
	ring_stage1_9_8 -> kv_send1_9_8
	ring_stage1_8_9 -> ring_stage1_9_9
	kv_send1_8_8 -> ring_stage1_9_9
	ring_stage1_9_9 -> kv_send1_9_9
	ring_stage1_8_10 -> ring_stage1_9_10
	kv_send1_8_9 -> ring_stage1_9_10
	ring_stage1_9_10 -> kv_send1_9_10
	ring_stage1_8_11 -> ring_stage1_9_11
	kv_send1_8_10 -> ring_stage1_9_11
	ring_stage1_9_11 -> kv_send1_9_11
	ring_stage1_8_12 -> ring_stage1_9_12
	kv_send1_8_11 -> ring_stage1_9_12
	ring_stage1_9_12 -> kv_send1_9_12
	ring_stage1_8_13 -> ring_stage1_9_13
	kv_send1_8_12 -> ring_stage1_9_13
	ring_stage1_9_13 -> kv_send1_9_13
	ring_stage1_8_14 -> ring_stage1_9_14
	kv_send1_8_13 -> ring_stage1_9_14
	ring_stage1_9_14 -> kv_send1_9_14
	ring_stage1_8_15 -> ring_stage1_9_15
	kv_send1_8_14 -> ring_stage1_9_15
	ring_stage1_9_15 -> kv_send1_9_15
	ring_stage1_9_0 -> ring_stage1_10_0
	kv_send1_9_15 -> ring_stage1_10_0
	ring_stage1_10_0 -> kv_send1_10_0
	ring_stage1_9_1 -> ring_stage1_10_1
	kv_send1_9_0 -> ring_stage1_10_1
	ring_stage1_10_1 -> kv_send1_10_1
	ring_stage1_9_2 -> ring_stage1_10_2
	kv_send1_9_1 -> ring_stage1_10_2
	ring_stage1_10_2 -> kv_send1_10_2
	ring_stage1_9_3 -> ring_stage1_10_3
	kv_send1_9_2 -> ring_stage1_10_3
	ring_stage1_10_3 -> kv_send1_10_3
	ring_stage1_9_4 -> ring_stage1_10_4
	kv_send1_9_3 -> ring_stage1_10_4
	ring_stage1_10_4 -> kv_send1_10_4
	ring_stage1_9_5 -> ring_stage1_10_5
	kv_send1_9_4 -> ring_stage1_10_5
	ring_stage1_10_5 -> kv_send1_10_5
	ring_stage1_9_6 -> ring_stage1_10_6
	kv_send1_9_5 -> ring_stage1_10_6
	ring_stage1_10_6 -> kv_send1_10_6
	ring_stage1_9_7 -> ring_stage1_10_7
	kv_send1_9_6 -> ring_stage1_10_7
	ring_stage1_10_7 -> kv_send1_10_7
	ring_stage1_9_8 -> ring_stage1_10_8
	kv_send1_9_7 -> ring_stage1_10_8
	ring_stage1_10_8 -> kv_send1_10_8
	ring_stage1_9_9 -> ring_stage1_10_9
	kv_send1_9_8 -> ring_stage1_10_9
	ring_stage1_10_9 -> kv_send1_10_9
	ring_stage1_9_10 -> ring_stage1_10_10
	kv_send1_9_9 -> ring_stage1_10_10
	ring_stage1_10_10 -> kv_send1_10_10
	ring_stage1_9_11 -> ring_stage1_10_11
	kv_send1_9_10 -> ring_stage1_10_11
	ring_stage1_10_11 -> kv_send1_10_11
	ring_stage1_9_12 -> ring_stage1_10_12
	kv_send1_9_11 -> ring_stage1_10_12
	ring_stage1_10_12 -> kv_send1_10_12
	ring_stage1_9_13 -> ring_stage1_10_13
	kv_send1_9_12 -> ring_stage1_10_13
	ring_stage1_10_13 -> kv_send1_10_13
	ring_stage1_9_14 -> ring_stage1_10_14
	kv_send1_9_13 -> ring_stage1_10_14
	ring_stage1_10_14 -> kv_send1_10_14
	ring_stage1_9_15 -> ring_stage1_10_15
	kv_send1_9_14 -> ring_stage1_10_15
	ring_stage1_10_15 -> kv_send1_10_15
	ring_stage1_10_0 -> ring_stage1_11_0
	kv_send1_10_15 -> ring_stage1_11_0
	ring_stage1_11_0 -> kv_send1_11_0
	ring_stage1_10_1 -> ring_stage1_11_1
	kv_send1_10_0 -> ring_stage1_11_1
	ring_stage1_11_1 -> kv_send1_11_1
	ring_stage1_10_2 -> ring_stage1_11_2
	kv_send1_10_1 -> ring_stage1_11_2
	ring_stage1_11_2 -> kv_send1_11_2
	ring_stage1_10_3 -> ring_stage1_11_3
	kv_send1_10_2 -> ring_stage1_11_3
	ring_stage1_11_3 -> kv_send1_11_3
	ring_stage1_10_4 -> ring_stage1_11_4
	kv_send1_10_3 -> ring_stage1_11_4
	ring_stage1_11_4 -> kv_send1_11_4
	ring_stage1_10_5 -> ring_stage1_11_5
	kv_send1_10_4 -> ring_stage1_11_5
	ring_stage1_11_5 -> kv_send1_11_5
	ring_stage1_10_6 -> ring_stage1_11_6
	kv_send1_10_5 -> ring_stage1_11_6
	ring_stage1_11_6 -> kv_send1_11_6
	ring_stage1_10_7 -> ring_stage1_11_7
	kv_send1_10_6 -> ring_stage1_11_7
	ring_stage1_11_7 -> kv_send1_11_7
	ring_stage1_10_8 -> ring_stage1_11_8
	kv_send1_10_7 -> ring_stage1_11_8
	ring_stage1_11_8 -> kv_send1_11_8
	ring_stage1_10_9 -> ring_stage1_11_9
	kv_send1_10_8 -> ring_stage1_11_9
	ring_stage1_11_9 -> kv_send1_11_9
	ring_stage1_10_10 -> ring_stage1_11_10
	kv_send1_10_9 -> ring_stage1_11_10
	ring_stage1_11_10 -> kv_send1_11_10
	ring_stage1_10_11 -> ring_stage1_11_11
	kv_send1_10_10 -> ring_stage1_11_11
	ring_stage1_11_11 -> kv_send1_11_11
	ring_stage1_10_12 -> ring_stage1_11_12
	kv_send1_10_11 -> ring_stage1_11_12
	ring_stage1_11_12 -> kv_send1_11_12
	ring_stage1_10_13 -> ring_stage1_11_13
	kv_send1_10_12 -> ring_stage1_11_13
	ring_stage1_11_13 -> kv_send1_11_13
	ring_stage1_10_14 -> ring_stage1_11_14
	kv_send1_10_13 -> ring_stage1_11_14
	ring_stage1_11_14 -> kv_send1_11_14
	ring_stage1_10_15 -> ring_stage1_11_15
	kv_send1_10_14 -> ring_stage1_11_15
	ring_stage1_11_15 -> kv_send1_11_15
	ring_stage1_11_0 -> ring_stage1_12_0
	kv_send1_11_15 -> ring_stage1_12_0
	ring_stage1_12_0 -> kv_send1_12_0
	ring_stage1_11_1 -> ring_stage1_12_1
	kv_send1_11_0 -> ring_stage1_12_1
	ring_stage1_12_1 -> kv_send1_12_1
	ring_stage1_11_2 -> ring_stage1_12_2
	kv_send1_11_1 -> ring_stage1_12_2
	ring_stage1_12_2 -> kv_send1_12_2
	ring_stage1_11_3 -> ring_stage1_12_3
	kv_send1_11_2 -> ring_stage1_12_3
	ring_stage1_12_3 -> kv_send1_12_3
	ring_stage1_11_4 -> ring_stage1_12_4
	kv_send1_11_3 -> ring_stage1_12_4
	ring_stage1_12_4 -> kv_send1_12_4
	ring_stage1_11_5 -> ring_stage1_12_5
	kv_send1_11_4 -> ring_stage1_12_5
	ring_stage1_12_5 -> kv_send1_12_5
	ring_stage1_11_6 -> ring_stage1_12_6
	kv_send1_11_5 -> ring_stage1_12_6
	ring_stage1_12_6 -> kv_send1_12_6
	ring_stage1_11_7 -> ring_stage1_12_7
	kv_send1_11_6 -> ring_stage1_12_7
	ring_stage1_12_7 -> kv_send1_12_7
	ring_stage1_11_8 -> ring_stage1_12_8
	kv_send1_11_7 -> ring_stage1_12_8
	ring_stage1_12_8 -> kv_send1_12_8
	ring_stage1_11_9 -> ring_stage1_12_9
	kv_send1_11_8 -> ring_stage1_12_9
	ring_stage1_12_9 -> kv_send1_12_9
	ring_stage1_11_10 -> ring_stage1_12_10
	kv_send1_11_9 -> ring_stage1_12_10
	ring_stage1_12_10 -> kv_send1_12_10
	ring_stage1_11_11 -> ring_stage1_12_11
	kv_send1_11_10 -> ring_stage1_12_11
	ring_stage1_12_11 -> kv_send1_12_11
	ring_stage1_11_12 -> ring_stage1_12_12
	kv_send1_11_11 -> ring_stage1_12_12
	ring_stage1_12_12 -> kv_send1_12_12
	ring_stage1_11_13 -> ring_stage1_12_13
	kv_send1_11_12 -> ring_stage1_12_13
	ring_stage1_12_13 -> kv_send1_12_13
	ring_stage1_11_14 -> ring_stage1_12_14
	kv_send1_11_13 -> ring_stage1_12_14
	ring_stage1_12_14 -> kv_send1_12_14
	ring_stage1_11_15 -> ring_stage1_12_15
	kv_send1_11_14 -> ring_stage1_12_15
	ring_stage1_12_15 -> kv_send1_12_15
	ring_stage1_12_0 -> ring_stage1_13_0
	kv_send1_12_15 -> ring_stage1_13_0
	ring_stage1_13_0 -> kv_send1_13_0
	ring_stage1_12_1 -> ring_stage1_13_1
	kv_send1_12_0 -> ring_stage1_13_1
	ring_stage1_13_1 -> kv_send1_13_1
	ring_stage1_12_2 -> ring_stage1_13_2
	kv_send1_12_1 -> ring_stage1_13_2
	ring_stage1_13_2 -> kv_send1_13_2
	ring_stage1_12_3 -> ring_stage1_13_3
	kv_send1_12_2 -> ring_stage1_13_3
	ring_stage1_13_3 -> kv_send1_13_3
	ring_stage1_12_4 -> ring_stage1_13_4
	kv_send1_12_3 -> ring_stage1_13_4
	ring_stage1_13_4 -> kv_send1_13_4
	ring_stage1_12_5 -> ring_stage1_13_5
	kv_send1_12_4 -> ring_stage1_13_5
	ring_stage1_13_5 -> kv_send1_13_5
	ring_stage1_12_6 -> ring_stage1_13_6
	kv_send1_12_5 -> ring_stage1_13_6
	ring_stage1_13_6 -> kv_send1_13_6
	ring_stage1_12_7 -> ring_stage1_13_7
	kv_send1_12_6 -> ring_stage1_13_7
	ring_stage1_13_7 -> kv_send1_13_7
	ring_stage1_12_8 -> ring_stage1_13_8
	kv_send1_12_7 -> ring_stage1_13_8
	ring_stage1_13_8 -> kv_send1_13_8
	ring_stage1_12_9 -> ring_stage1_13_9
	kv_send1_12_8 -> ring_stage1_13_9
	ring_stage1_13_9 -> kv_send1_13_9
	ring_stage1_12_10 -> ring_stage1_13_10
	kv_send1_12_9 -> ring_stage1_13_10
	ring_stage1_13_10 -> kv_send1_13_10
	ring_stage1_12_11 -> ring_stage1_13_11
	kv_send1_12_10 -> ring_stage1_13_11
	ring_stage1_13_11 -> kv_send1_13_11
	ring_stage1_12_12 -> ring_stage1_13_12
	kv_send1_12_11 -> ring_stage1_13_12
	ring_stage1_13_12 -> kv_send1_13_12
	ring_stage1_12_13 -> ring_stage1_13_13
	kv_send1_12_12 -> ring_stage1_13_13
	ring_stage1_13_13 -> kv_send1_13_13
	ring_stage1_12_14 -> ring_stage1_13_14
	kv_send1_12_13 -> ring_stage1_13_14
	ring_stage1_13_14 -> kv_send1_13_14
	ring_stage1_12_15 -> ring_stage1_13_15
	kv_send1_12_14 -> ring_stage1_13_15
	ring_stage1_13_15 -> kv_send1_13_15
	ring_stage1_13_0 -> ring_stage1_14_0
	kv_send1_13_15 -> ring_stage1_14_0
	ring_stage1_14_0 -> kv_send1_14_0
	ring_stage1_13_1 -> ring_stage1_14_1
	kv_send1_13_0 -> ring_stage1_14_1
	ring_stage1_14_1 -> kv_send1_14_1
	ring_stage1_13_2 -> ring_stage1_14_2
	kv_send1_13_1 -> ring_stage1_14_2
	ring_stage1_14_2 -> kv_send1_14_2
	ring_stage1_13_3 -> ring_stage1_14_3
	kv_send1_13_2 -> ring_stage1_14_3
	ring_stage1_14_3 -> kv_send1_14_3
	ring_stage1_13_4 -> ring_stage1_14_4
	kv_send1_13_3 -> ring_stage1_14_4
	ring_stage1_14_4 -> kv_send1_14_4
	ring_stage1_13_5 -> ring_stage1_14_5
	kv_send1_13_4 -> ring_stage1_14_5
	ring_stage1_14_5 -> kv_send1_14_5
	ring_stage1_13_6 -> ring_stage1_14_6
	kv_send1_13_5 -> ring_stage1_14_6
	ring_stage1_14_6 -> kv_send1_14_6
	ring_stage1_13_7 -> ring_stage1_14_7
	kv_send1_13_6 -> ring_stage1_14_7
	ring_stage1_14_7 -> kv_send1_14_7
	ring_stage1_13_8 -> ring_stage1_14_8
	kv_send1_13_7 -> ring_stage1_14_8
	ring_stage1_14_8 -> kv_send1_14_8
	ring_stage1_13_9 -> ring_stage1_14_9
	kv_send1_13_8 -> ring_stage1_14_9
	ring_stage1_14_9 -> kv_send1_14_9
	ring_stage1_13_10 -> ring_stage1_14_10
	kv_send1_13_9 -> ring_stage1_14_10
	ring_stage1_14_10 -> kv_send1_14_10
	ring_stage1_13_11 -> ring_stage1_14_11
	kv_send1_13_10 -> ring_stage1_14_11
	ring_stage1_14_11 -> kv_send1_14_11
	ring_stage1_13_12 -> ring_stage1_14_12
	kv_send1_13_11 -> ring_stage1_14_12
	ring_stage1_14_12 -> kv_send1_14_12
	ring_stage1_13_13 -> ring_stage1_14_13
	kv_send1_13_12 -> ring_stage1_14_13
	ring_stage1_14_13 -> kv_send1_14_13
	ring_stage1_13_14 -> ring_stage1_14_14
	kv_send1_13_13 -> ring_stage1_14_14
	ring_stage1_14_14 -> kv_send1_14_14
	ring_stage1_13_15 -> ring_stage1_14_15
	kv_send1_13_14 -> ring_stage1_14_15
	ring_stage1_14_15 -> kv_send1_14_15
	ring_stage1_14_0 -> ring_stage1_15_0
	kv_send1_14_15 -> ring_stage1_15_0
	ring_stage1_14_1 -> ring_stage1_15_1
	kv_send1_14_0 -> ring_stage1_15_1
	ring_stage1_14_2 -> ring_stage1_15_2
	kv_send1_14_1 -> ring_stage1_15_2
	ring_stage1_14_3 -> ring_stage1_15_3
	kv_send1_14_2 -> ring_stage1_15_3
	ring_stage1_14_4 -> ring_stage1_15_4
	kv_send1_14_3 -> ring_stage1_15_4
	ring_stage1_14_5 -> ring_stage1_15_5
	kv_send1_14_4 -> ring_stage1_15_5
	ring_stage1_14_6 -> ring_stage1_15_6
	kv_send1_14_5 -> ring_stage1_15_6
	ring_stage1_14_7 -> ring_stage1_15_7
	kv_send1_14_6 -> ring_stage1_15_7
	ring_stage1_14_8 -> ring_stage1_15_8
	kv_send1_14_7 -> ring_stage1_15_8
	ring_stage1_14_9 -> ring_stage1_15_9
	kv_send1_14_8 -> ring_stage1_15_9
	ring_stage1_14_10 -> ring_stage1_15_10
	kv_send1_14_9 -> ring_stage1_15_10
	ring_stage1_14_11 -> ring_stage1_15_11
	kv_send1_14_10 -> ring_stage1_15_11
	ring_stage1_14_12 -> ring_stage1_15_12
	kv_send1_14_11 -> ring_stage1_15_12
	ring_stage1_14_13 -> ring_stage1_15_13
	kv_send1_14_12 -> ring_stage1_15_13
	ring_stage1_14_14 -> ring_stage1_15_14
	kv_send1_14_13 -> ring_stage1_15_14
	ring_stage1_14_15 -> ring_stage1_15_15
	kv_send1_14_14 -> ring_stage1_15_15
	ring_stage1_15_0 -> accum1_0
	accum1_0 -> out_proj1_0
	out_proj1_0 -> res_attn1_0
	res_moe0_0 -> res_attn1_0
	res_attn1_0 -> gate1_0
	gate1_0 -> select1_0
	select1_0 -> expert1_0_0 [label="if selected" style=dashed]
	expert1_0_0 -> expert_act1_0_0
	expert_act1_0_0 -> expert_out1_0_0
	expert_out1_0_0 -> combine1_0
	select1_0 -> expert1_0_1 [label="if selected" style=dashed]
	expert1_0_1 -> expert_act1_0_1
	expert_act1_0_1 -> expert_out1_0_1
	expert_out1_0_1 -> combine1_0
	select1_0 -> expert1_0_2 [label="if selected" style=dashed]
	expert1_0_2 -> expert_act1_0_2
	expert_act1_0_2 -> expert_out1_0_2
	expert_out1_0_2 -> combine1_0
	select1_0 -> expert1_0_3 [label="if selected" style=dashed]
	expert1_0_3 -> expert_act1_0_3
	expert_act1_0_3 -> expert_out1_0_3
	expert_out1_0_3 -> combine1_0
	select1_0 -> expert1_0_4 [label="if selected" style=dashed]
	expert1_0_4 -> expert_act1_0_4
	expert_act1_0_4 -> expert_out1_0_4
	expert_out1_0_4 -> combine1_0
	select1_0 -> expert1_0_5 [label="if selected" style=dashed]
	expert1_0_5 -> expert_act1_0_5
	expert_act1_0_5 -> expert_out1_0_5
	expert_out1_0_5 -> combine1_0
	select1_0 -> expert1_0_6 [label="if selected" style=dashed]
	expert1_0_6 -> expert_act1_0_6
	expert_act1_0_6 -> expert_out1_0_6
	expert_out1_0_6 -> combine1_0
	select1_0 -> expert1_0_7 [label="if selected" style=dashed]
	expert1_0_7 -> expert_act1_0_7
	expert_act1_0_7 -> expert_out1_0_7
	expert_out1_0_7 -> combine1_0
	combine1_0 -> res_moe1_0
	res_attn1_0 -> res_moe1_0
	ring_stage1_15_1 -> accum1_1
	accum1_1 -> out_proj1_1
	out_proj1_1 -> res_attn1_1
	res_moe0_1 -> res_attn1_1
	res_attn1_1 -> gate1_1
	gate1_1 -> select1_1
	select1_1 -> expert1_1_0 [label="if selected" style=dashed]
	expert1_1_0 -> expert_act1_1_0
	expert_act1_1_0 -> expert_out1_1_0
	expert_out1_1_0 -> combine1_1
	select1_1 -> expert1_1_1 [label="if selected" style=dashed]
	expert1_1_1 -> expert_act1_1_1
	expert_act1_1_1 -> expert_out1_1_1
	expert_out1_1_1 -> combine1_1
	select1_1 -> expert1_1_2 [label="if selected" style=dashed]
	expert1_1_2 -> expert_act1_1_2
	expert_act1_1_2 -> expert_out1_1_2
	expert_out1_1_2 -> combine1_1
	select1_1 -> expert1_1_3 [label="if selected" style=dashed]
	expert1_1_3 -> expert_act1_1_3
	expert_act1_1_3 -> expert_out1_1_3
	expert_out1_1_3 -> combine1_1
	select1_1 -> expert1_1_4 [label="if selected" style=dashed]
	expert1_1_4 -> expert_act1_1_4
	expert_act1_1_4 -> expert_out1_1_4
	expert_out1_1_4 -> combine1_1
	select1_1 -> expert1_1_5 [label="if selected" style=dashed]
	expert1_1_5 -> expert_act1_1_5
	expert_act1_1_5 -> expert_out1_1_5
	expert_out1_1_5 -> combine1_1
	select1_1 -> expert1_1_6 [label="if selected" style=dashed]
	expert1_1_6 -> expert_act1_1_6
	expert_act1_1_6 -> expert_out1_1_6
	expert_out1_1_6 -> combine1_1
	select1_1 -> expert1_1_7 [label="if selected" style=dashed]
	expert1_1_7 -> expert_act1_1_7
	expert_act1_1_7 -> expert_out1_1_7
	expert_out1_1_7 -> combine1_1
	combine1_1 -> res_moe1_1
	res_attn1_1 -> res_moe1_1
	ring_stage1_15_2 -> accum1_2
	accum1_2 -> out_proj1_2
	out_proj1_2 -> res_attn1_2
	res_moe0_2 -> res_attn1_2
	res_attn1_2 -> gate1_2
	gate1_2 -> select1_2
	select1_2 -> expert1_2_0 [label="if selected" style=dashed]
	expert1_2_0 -> expert_act1_2_0
	expert_act1_2_0 -> expert_out1_2_0
	expert_out1_2_0 -> combine1_2
	select1_2 -> expert1_2_1 [label="if selected" style=dashed]
	expert1_2_1 -> expert_act1_2_1
	expert_act1_2_1 -> expert_out1_2_1
	expert_out1_2_1 -> combine1_2
	select1_2 -> expert1_2_2 [label="if selected" style=dashed]
	expert1_2_2 -> expert_act1_2_2
	expert_act1_2_2 -> expert_out1_2_2
	expert_out1_2_2 -> combine1_2
	select1_2 -> expert1_2_3 [label="if selected" style=dashed]
	expert1_2_3 -> expert_act1_2_3
	expert_act1_2_3 -> expert_out1_2_3
	expert_out1_2_3 -> combine1_2
	select1_2 -> expert1_2_4 [label="if selected" style=dashed]
	expert1_2_4 -> expert_act1_2_4
	expert_act1_2_4 -> expert_out1_2_4
	expert_out1_2_4 -> combine1_2
	select1_2 -> expert1_2_5 [label="if selected" style=dashed]
	expert1_2_5 -> expert_act1_2_5
	expert_act1_2_5 -> expert_out1_2_5
	expert_out1_2_5 -> combine1_2
	select1_2 -> expert1_2_6 [label="if selected" style=dashed]
	expert1_2_6 -> expert_act1_2_6
	expert_act1_2_6 -> expert_out1_2_6
	expert_out1_2_6 -> combine1_2
	select1_2 -> expert1_2_7 [label="if selected" style=dashed]
	expert1_2_7 -> expert_act1_2_7
	expert_act1_2_7 -> expert_out1_2_7
	expert_out1_2_7 -> combine1_2
	combine1_2 -> res_moe1_2
	res_attn1_2 -> res_moe1_2
	ring_stage1_15_3 -> accum1_3
	accum1_3 -> out_proj1_3
	out_proj1_3 -> res_attn1_3
	res_moe0_3 -> res_attn1_3
	res_attn1_3 -> gate1_3
	gate1_3 -> select1_3
	select1_3 -> expert1_3_0 [label="if selected" style=dashed]
	expert1_3_0 -> expert_act1_3_0
	expert_act1_3_0 -> expert_out1_3_0
	expert_out1_3_0 -> combine1_3
	select1_3 -> expert1_3_1 [label="if selected" style=dashed]
	expert1_3_1 -> expert_act1_3_1
	expert_act1_3_1 -> expert_out1_3_1
	expert_out1_3_1 -> combine1_3
	select1_3 -> expert1_3_2 [label="if selected" style=dashed]
	expert1_3_2 -> expert_act1_3_2
	expert_act1_3_2 -> expert_out1_3_2
	expert_out1_3_2 -> combine1_3
	select1_3 -> expert1_3_3 [label="if selected" style=dashed]
	expert1_3_3 -> expert_act1_3_3
	expert_act1_3_3 -> expert_out1_3_3
	expert_out1_3_3 -> combine1_3
	select1_3 -> expert1_3_4 [label="if selected" style=dashed]
	expert1_3_4 -> expert_act1_3_4
	expert_act1_3_4 -> expert_out1_3_4
	expert_out1_3_4 -> combine1_3
	select1_3 -> expert1_3_5 [label="if selected" style=dashed]
	expert1_3_5 -> expert_act1_3_5
	expert_act1_3_5 -> expert_out1_3_5
	expert_out1_3_5 -> combine1_3
	select1_3 -> expert1_3_6 [label="if selected" style=dashed]
	expert1_3_6 -> expert_act1_3_6
	expert_act1_3_6 -> expert_out1_3_6
	expert_out1_3_6 -> combine1_3
	select1_3 -> expert1_3_7 [label="if selected" style=dashed]
	expert1_3_7 -> expert_act1_3_7
	expert_act1_3_7 -> expert_out1_3_7
	expert_out1_3_7 -> combine1_3
	combine1_3 -> res_moe1_3
	res_attn1_3 -> res_moe1_3
	ring_stage1_15_4 -> accum1_4
	accum1_4 -> out_proj1_4
	out_proj1_4 -> res_attn1_4
	res_moe0_4 -> res_attn1_4
	res_attn1_4 -> gate1_4
	gate1_4 -> select1_4
	select1_4 -> expert1_4_0 [label="if selected" style=dashed]
	expert1_4_0 -> expert_act1_4_0
	expert_act1_4_0 -> expert_out1_4_0
	expert_out1_4_0 -> combine1_4
	select1_4 -> expert1_4_1 [label="if selected" style=dashed]
	expert1_4_1 -> expert_act1_4_1
	expert_act1_4_1 -> expert_out1_4_1
	expert_out1_4_1 -> combine1_4
	select1_4 -> expert1_4_2 [label="if selected" style=dashed]
	expert1_4_2 -> expert_act1_4_2
	expert_act1_4_2 -> expert_out1_4_2
	expert_out1_4_2 -> combine1_4
	select1_4 -> expert1_4_3 [label="if selected" style=dashed]
	expert1_4_3 -> expert_act1_4_3
	expert_act1_4_3 -> expert_out1_4_3
	expert_out1_4_3 -> combine1_4
	select1_4 -> expert1_4_4 [label="if selected" style=dashed]
	expert1_4_4 -> expert_act1_4_4
	expert_act1_4_4 -> expert_out1_4_4
	expert_out1_4_4 -> combine1_4
	select1_4 -> expert1_4_5 [label="if selected" style=dashed]
	expert1_4_5 -> expert_act1_4_5
	expert_act1_4_5 -> expert_out1_4_5
	expert_out1_4_5 -> combine1_4
	select1_4 -> expert1_4_6 [label="if selected" style=dashed]
	expert1_4_6 -> expert_act1_4_6
	expert_act1_4_6 -> expert_out1_4_6
	expert_out1_4_6 -> combine1_4
	select1_4 -> expert1_4_7 [label="if selected" style=dashed]
	expert1_4_7 -> expert_act1_4_7
	expert_act1_4_7 -> expert_out1_4_7
	expert_out1_4_7 -> combine1_4
	combine1_4 -> res_moe1_4
	res_attn1_4 -> res_moe1_4
	ring_stage1_15_5 -> accum1_5
	accum1_5 -> out_proj1_5
	out_proj1_5 -> res_attn1_5
	res_moe0_5 -> res_attn1_5
	res_attn1_5 -> gate1_5
	gate1_5 -> select1_5
	select1_5 -> expert1_5_0 [label="if selected" style=dashed]
	expert1_5_0 -> expert_act1_5_0
	expert_act1_5_0 -> expert_out1_5_0
	expert_out1_5_0 -> combine1_5
	select1_5 -> expert1_5_1 [label="if selected" style=dashed]
	expert1_5_1 -> expert_act1_5_1
	expert_act1_5_1 -> expert_out1_5_1
	expert_out1_5_1 -> combine1_5
	select1_5 -> expert1_5_2 [label="if selected" style=dashed]
	expert1_5_2 -> expert_act1_5_2
	expert_act1_5_2 -> expert_out1_5_2
	expert_out1_5_2 -> combine1_5
	select1_5 -> expert1_5_3 [label="if selected" style=dashed]
	expert1_5_3 -> expert_act1_5_3
	expert_act1_5_3 -> expert_out1_5_3
	expert_out1_5_3 -> combine1_5
	select1_5 -> expert1_5_4 [label="if selected" style=dashed]
	expert1_5_4 -> expert_act1_5_4
	expert_act1_5_4 -> expert_out1_5_4
	expert_out1_5_4 -> combine1_5
	select1_5 -> expert1_5_5 [label="if selected" style=dashed]
	expert1_5_5 -> expert_act1_5_5
	expert_act1_5_5 -> expert_out1_5_5
	expert_out1_5_5 -> combine1_5
	select1_5 -> expert1_5_6 [label="if selected" style=dashed]
	expert1_5_6 -> expert_act1_5_6
	expert_act1_5_6 -> expert_out1_5_6
	expert_out1_5_6 -> combine1_5
	select1_5 -> expert1_5_7 [label="if selected" style=dashed]
	expert1_5_7 -> expert_act1_5_7
	expert_act1_5_7 -> expert_out1_5_7
	expert_out1_5_7 -> combine1_5
	combine1_5 -> res_moe1_5
	res_attn1_5 -> res_moe1_5
	ring_stage1_15_6 -> accum1_6
	accum1_6 -> out_proj1_6
	out_proj1_6 -> res_attn1_6
	res_moe0_6 -> res_attn1_6
	res_attn1_6 -> gate1_6
	gate1_6 -> select1_6
	select1_6 -> expert1_6_0 [label="if selected" style=dashed]
	expert1_6_0 -> expert_act1_6_0
	expert_act1_6_0 -> expert_out1_6_0
	expert_out1_6_0 -> combine1_6
	select1_6 -> expert1_6_1 [label="if selected" style=dashed]
	expert1_6_1 -> expert_act1_6_1
	expert_act1_6_1 -> expert_out1_6_1
	expert_out1_6_1 -> combine1_6
	select1_6 -> expert1_6_2 [label="if selected" style=dashed]
	expert1_6_2 -> expert_act1_6_2
	expert_act1_6_2 -> expert_out1_6_2
	expert_out1_6_2 -> combine1_6
	select1_6 -> expert1_6_3 [label="if selected" style=dashed]
	expert1_6_3 -> expert_act1_6_3
	expert_act1_6_3 -> expert_out1_6_3
	expert_out1_6_3 -> combine1_6
	select1_6 -> expert1_6_4 [label="if selected" style=dashed]
	expert1_6_4 -> expert_act1_6_4
	expert_act1_6_4 -> expert_out1_6_4
	expert_out1_6_4 -> combine1_6
	select1_6 -> expert1_6_5 [label="if selected" style=dashed]
	expert1_6_5 -> expert_act1_6_5
	expert_act1_6_5 -> expert_out1_6_5
	expert_out1_6_5 -> combine1_6
	select1_6 -> expert1_6_6 [label="if selected" style=dashed]
	expert1_6_6 -> expert_act1_6_6
	expert_act1_6_6 -> expert_out1_6_6
	expert_out1_6_6 -> combine1_6
	select1_6 -> expert1_6_7 [label="if selected" style=dashed]
	expert1_6_7 -> expert_act1_6_7
	expert_act1_6_7 -> expert_out1_6_7
	expert_out1_6_7 -> combine1_6
	combine1_6 -> res_moe1_6
	res_attn1_6 -> res_moe1_6
	ring_stage1_15_7 -> accum1_7
	accum1_7 -> out_proj1_7
	out_proj1_7 -> res_attn1_7
	res_moe0_7 -> res_attn1_7
	res_attn1_7 -> gate1_7
	gate1_7 -> select1_7
	select1_7 -> expert1_7_0 [label="if selected" style=dashed]
	expert1_7_0 -> expert_act1_7_0
	expert_act1_7_0 -> expert_out1_7_0
	expert_out1_7_0 -> combine1_7
	select1_7 -> expert1_7_1 [label="if selected" style=dashed]
	expert1_7_1 -> expert_act1_7_1
	expert_act1_7_1 -> expert_out1_7_1
	expert_out1_7_1 -> combine1_7
	select1_7 -> expert1_7_2 [label="if selected" style=dashed]
	expert1_7_2 -> expert_act1_7_2
	expert_act1_7_2 -> expert_out1_7_2
	expert_out1_7_2 -> combine1_7
	select1_7 -> expert1_7_3 [label="if selected" style=dashed]
	expert1_7_3 -> expert_act1_7_3
	expert_act1_7_3 -> expert_out1_7_3
	expert_out1_7_3 -> combine1_7
	select1_7 -> expert1_7_4 [label="if selected" style=dashed]
	expert1_7_4 -> expert_act1_7_4
	expert_act1_7_4 -> expert_out1_7_4
	expert_out1_7_4 -> combine1_7
	select1_7 -> expert1_7_5 [label="if selected" style=dashed]
	expert1_7_5 -> expert_act1_7_5
	expert_act1_7_5 -> expert_out1_7_5
	expert_out1_7_5 -> combine1_7
	select1_7 -> expert1_7_6 [label="if selected" style=dashed]
	expert1_7_6 -> expert_act1_7_6
	expert_act1_7_6 -> expert_out1_7_6
	expert_out1_7_6 -> combine1_7
	select1_7 -> expert1_7_7 [label="if selected" style=dashed]
	expert1_7_7 -> expert_act1_7_7
	expert_act1_7_7 -> expert_out1_7_7
	expert_out1_7_7 -> combine1_7
	combine1_7 -> res_moe1_7
	res_attn1_7 -> res_moe1_7
	ring_stage1_15_8 -> accum1_8
	accum1_8 -> out_proj1_8
	out_proj1_8 -> res_attn1_8
	res_moe0_8 -> res_attn1_8
	res_attn1_8 -> gate1_8
	gate1_8 -> select1_8
	select1_8 -> expert1_8_0 [label="if selected" style=dashed]
	expert1_8_0 -> expert_act1_8_0
	expert_act1_8_0 -> expert_out1_8_0
	expert_out1_8_0 -> combine1_8
	select1_8 -> expert1_8_1 [label="if selected" style=dashed]
	expert1_8_1 -> expert_act1_8_1
	expert_act1_8_1 -> expert_out1_8_1
	expert_out1_8_1 -> combine1_8
	select1_8 -> expert1_8_2 [label="if selected" style=dashed]
	expert1_8_2 -> expert_act1_8_2
	expert_act1_8_2 -> expert_out1_8_2
	expert_out1_8_2 -> combine1_8
	select1_8 -> expert1_8_3 [label="if selected" style=dashed]
	expert1_8_3 -> expert_act1_8_3
	expert_act1_8_3 -> expert_out1_8_3
	expert_out1_8_3 -> combine1_8
	select1_8 -> expert1_8_4 [label="if selected" style=dashed]
	expert1_8_4 -> expert_act1_8_4
	expert_act1_8_4 -> expert_out1_8_4
	expert_out1_8_4 -> combine1_8
	select1_8 -> expert1_8_5 [label="if selected" style=dashed]
	expert1_8_5 -> expert_act1_8_5
	expert_act1_8_5 -> expert_out1_8_5
	expert_out1_8_5 -> combine1_8
	select1_8 -> expert1_8_6 [label="if selected" style=dashed]
	expert1_8_6 -> expert_act1_8_6
	expert_act1_8_6 -> expert_out1_8_6
	expert_out1_8_6 -> combine1_8
	select1_8 -> expert1_8_7 [label="if selected" style=dashed]
	expert1_8_7 -> expert_act1_8_7
	expert_act1_8_7 -> expert_out1_8_7
	expert_out1_8_7 -> combine1_8
	combine1_8 -> res_moe1_8
	res_attn1_8 -> res_moe1_8
	ring_stage1_15_9 -> accum1_9
	accum1_9 -> out_proj1_9
	out_proj1_9 -> res_attn1_9
	res_moe0_9 -> res_attn1_9
	res_attn1_9 -> gate1_9
	gate1_9 -> select1_9
	select1_9 -> expert1_9_0 [label="if selected" style=dashed]
	expert1_9_0 -> expert_act1_9_0
	expert_act1_9_0 -> expert_out1_9_0
	expert_out1_9_0 -> combine1_9
	select1_9 -> expert1_9_1 [label="if selected" style=dashed]
	expert1_9_1 -> expert_act1_9_1
	expert_act1_9_1 -> expert_out1_9_1
	expert_out1_9_1 -> combine1_9
	select1_9 -> expert1_9_2 [label="if selected" style=dashed]
	expert1_9_2 -> expert_act1_9_2
	expert_act1_9_2 -> expert_out1_9_2
	expert_out1_9_2 -> combine1_9
	select1_9 -> expert1_9_3 [label="if selected" style=dashed]
	expert1_9_3 -> expert_act1_9_3
	expert_act1_9_3 -> expert_out1_9_3
	expert_out1_9_3 -> combine1_9
	select1_9 -> expert1_9_4 [label="if selected" style=dashed]
	expert1_9_4 -> expert_act1_9_4
	expert_act1_9_4 -> expert_out1_9_4
	expert_out1_9_4 -> combine1_9
	select1_9 -> expert1_9_5 [label="if selected" style=dashed]
	expert1_9_5 -> expert_act1_9_5
	expert_act1_9_5 -> expert_out1_9_5
	expert_out1_9_5 -> combine1_9
	select1_9 -> expert1_9_6 [label="if selected" style=dashed]
	expert1_9_6 -> expert_act1_9_6
	expert_act1_9_6 -> expert_out1_9_6
	expert_out1_9_6 -> combine1_9
	select1_9 -> expert1_9_7 [label="if selected" style=dashed]
	expert1_9_7 -> expert_act1_9_7
	expert_act1_9_7 -> expert_out1_9_7
	expert_out1_9_7 -> combine1_9
	combine1_9 -> res_moe1_9
	res_attn1_9 -> res_moe1_9
	ring_stage1_15_10 -> accum1_10
	accum1_10 -> out_proj1_10
	out_proj1_10 -> res_attn1_10
	res_moe0_10 -> res_attn1_10
	res_attn1_10 -> gate1_10
	gate1_10 -> select1_10
	select1_10 -> expert1_10_0 [label="if selected" style=dashed]
	expert1_10_0 -> expert_act1_10_0
	expert_act1_10_0 -> expert_out1_10_0
	expert_out1_10_0 -> combine1_10
	select1_10 -> expert1_10_1 [label="if selected" style=dashed]
	expert1_10_1 -> expert_act1_10_1
	expert_act1_10_1 -> expert_out1_10_1
	expert_out1_10_1 -> combine1_10
	select1_10 -> expert1_10_2 [label="if selected" style=dashed]
	expert1_10_2 -> expert_act1_10_2
	expert_act1_10_2 -> expert_out1_10_2
	expert_out1_10_2 -> combine1_10
	select1_10 -> expert1_10_3 [label="if selected" style=dashed]
	expert1_10_3 -> expert_act1_10_3
	expert_act1_10_3 -> expert_out1_10_3
	expert_out1_10_3 -> combine1_10
	select1_10 -> expert1_10_4 [label="if selected" style=dashed]
	expert1_10_4 -> expert_act1_10_4
	expert_act1_10_4 -> expert_out1_10_4
	expert_out1_10_4 -> combine1_10
	select1_10 -> expert1_10_5 [label="if selected" style=dashed]
	expert1_10_5 -> expert_act1_10_5
	expert_act1_10_5 -> expert_out1_10_5
	expert_out1_10_5 -> combine1_10
	select1_10 -> expert1_10_6 [label="if selected" style=dashed]
	expert1_10_6 -> expert_act1_10_6
	expert_act1_10_6 -> expert_out1_10_6
	expert_out1_10_6 -> combine1_10
	select1_10 -> expert1_10_7 [label="if selected" style=dashed]
	expert1_10_7 -> expert_act1_10_7
	expert_act1_10_7 -> expert_out1_10_7
	expert_out1_10_7 -> combine1_10
	combine1_10 -> res_moe1_10
	res_attn1_10 -> res_moe1_10
	ring_stage1_15_11 -> accum1_11
	accum1_11 -> out_proj1_11
	out_proj1_11 -> res_attn1_11
	res_moe0_11 -> res_attn1_11
	res_attn1_11 -> gate1_11
	gate1_11 -> select1_11
	select1_11 -> expert1_11_0 [label="if selected" style=dashed]
	expert1_11_0 -> expert_act1_11_0
	expert_act1_11_0 -> expert_out1_11_0
	expert_out1_11_0 -> combine1_11
	select1_11 -> expert1_11_1 [label="if selected" style=dashed]
	expert1_11_1 -> expert_act1_11_1
	expert_act1_11_1 -> expert_out1_11_1
	expert_out1_11_1 -> combine1_11
	select1_11 -> expert1_11_2 [label="if selected" style=dashed]
	expert1_11_2 -> expert_act1_11_2
	expert_act1_11_2 -> expert_out1_11_2
	expert_out1_11_2 -> combine1_11
	select1_11 -> expert1_11_3 [label="if selected" style=dashed]
	expert1_11_3 -> expert_act1_11_3
	expert_act1_11_3 -> expert_out1_11_3
	expert_out1_11_3 -> combine1_11
	select1_11 -> expert1_11_4 [label="if selected" style=dashed]
	expert1_11_4 -> expert_act1_11_4
	expert_act1_11_4 -> expert_out1_11_4
	expert_out1_11_4 -> combine1_11
	select1_11 -> expert1_11_5 [label="if selected" style=dashed]
	expert1_11_5 -> expert_act1_11_5
	expert_act1_11_5 -> expert_out1_11_5
	expert_out1_11_5 -> combine1_11
	select1_11 -> expert1_11_6 [label="if selected" style=dashed]
	expert1_11_6 -> expert_act1_11_6
	expert_act1_11_6 -> expert_out1_11_6
	expert_out1_11_6 -> combine1_11
	select1_11 -> expert1_11_7 [label="if selected" style=dashed]
	expert1_11_7 -> expert_act1_11_7
	expert_act1_11_7 -> expert_out1_11_7
	expert_out1_11_7 -> combine1_11
	combine1_11 -> res_moe1_11
	res_attn1_11 -> res_moe1_11
	ring_stage1_15_12 -> accum1_12
	accum1_12 -> out_proj1_12
	out_proj1_12 -> res_attn1_12
	res_moe0_12 -> res_attn1_12
	res_attn1_12 -> gate1_12
	gate1_12 -> select1_12
	select1_12 -> expert1_12_0 [label="if selected" style=dashed]
	expert1_12_0 -> expert_act1_12_0
	expert_act1_12_0 -> expert_out1_12_0
	expert_out1_12_0 -> combine1_12
	select1_12 -> expert1_12_1 [label="if selected" style=dashed]
	expert1_12_1 -> expert_act1_12_1
	expert_act1_12_1 -> expert_out1_12_1
	expert_out1_12_1 -> combine1_12
	select1_12 -> expert1_12_2 [label="if selected" style=dashed]
	expert1_12_2 -> expert_act1_12_2
	expert_act1_12_2 -> expert_out1_12_2
	expert_out1_12_2 -> combine1_12
	select1_12 -> expert1_12_3 [label="if selected" style=dashed]
	expert1_12_3 -> expert_act1_12_3
	expert_act1_12_3 -> expert_out1_12_3
	expert_out1_12_3 -> combine1_12
	select1_12 -> expert1_12_4 [label="if selected" style=dashed]
	expert1_12_4 -> expert_act1_12_4
	expert_act1_12_4 -> expert_out1_12_4
	expert_out1_12_4 -> combine1_12
	select1_12 -> expert1_12_5 [label="if selected" style=dashed]
	expert1_12_5 -> expert_act1_12_5
	expert_act1_12_5 -> expert_out1_12_5
	expert_out1_12_5 -> combine1_12
	select1_12 -> expert1_12_6 [label="if selected" style=dashed]
	expert1_12_6 -> expert_act1_12_6
	expert_act1_12_6 -> expert_out1_12_6
	expert_out1_12_6 -> combine1_12
	select1_12 -> expert1_12_7 [label="if selected" style=dashed]
	expert1_12_7 -> expert_act1_12_7
	expert_act1_12_7 -> expert_out1_12_7
	expert_out1_12_7 -> combine1_12
	combine1_12 -> res_moe1_12
	res_attn1_12 -> res_moe1_12
	ring_stage1_15_13 -> accum1_13
	accum1_13 -> out_proj1_13
	out_proj1_13 -> res_attn1_13
	res_moe0_13 -> res_attn1_13
	res_attn1_13 -> gate1_13
	gate1_13 -> select1_13
	select1_13 -> expert1_13_0 [label="if selected" style=dashed]
	expert1_13_0 -> expert_act1_13_0
	expert_act1_13_0 -> expert_out1_13_0
	expert_out1_13_0 -> combine1_13
	select1_13 -> expert1_13_1 [label="if selected" style=dashed]
	expert1_13_1 -> expert_act1_13_1
	expert_act1_13_1 -> expert_out1_13_1
	expert_out1_13_1 -> combine1_13
	select1_13 -> expert1_13_2 [label="if selected" style=dashed]
	expert1_13_2 -> expert_act1_13_2
	expert_act1_13_2 -> expert_out1_13_2
	expert_out1_13_2 -> combine1_13
	select1_13 -> expert1_13_3 [label="if selected" style=dashed]
	expert1_13_3 -> expert_act1_13_3
	expert_act1_13_3 -> expert_out1_13_3
	expert_out1_13_3 -> combine1_13
	select1_13 -> expert1_13_4 [label="if selected" style=dashed]
	expert1_13_4 -> expert_act1_13_4
	expert_act1_13_4 -> expert_out1_13_4
	expert_out1_13_4 -> combine1_13
	select1_13 -> expert1_13_5 [label="if selected" style=dashed]
	expert1_13_5 -> expert_act1_13_5
	expert_act1_13_5 -> expert_out1_13_5
	expert_out1_13_5 -> combine1_13
	select1_13 -> expert1_13_6 [label="if selected" style=dashed]
	expert1_13_6 -> expert_act1_13_6
	expert_act1_13_6 -> expert_out1_13_6
	expert_out1_13_6 -> combine1_13
	select1_13 -> expert1_13_7 [label="if selected" style=dashed]
	expert1_13_7 -> expert_act1_13_7
	expert_act1_13_7 -> expert_out1_13_7
	expert_out1_13_7 -> combine1_13
	combine1_13 -> res_moe1_13
	res_attn1_13 -> res_moe1_13
	ring_stage1_15_14 -> accum1_14
	accum1_14 -> out_proj1_14
	out_proj1_14 -> res_attn1_14
	res_moe0_14 -> res_attn1_14
	res_attn1_14 -> gate1_14
	gate1_14 -> select1_14
	select1_14 -> expert1_14_0 [label="if selected" style=dashed]
	expert1_14_0 -> expert_act1_14_0
	expert_act1_14_0 -> expert_out1_14_0
	expert_out1_14_0 -> combine1_14
	select1_14 -> expert1_14_1 [label="if selected" style=dashed]
	expert1_14_1 -> expert_act1_14_1
	expert_act1_14_1 -> expert_out1_14_1
	expert_out1_14_1 -> combine1_14
	select1_14 -> expert1_14_2 [label="if selected" style=dashed]
	expert1_14_2 -> expert_act1_14_2
	expert_act1_14_2 -> expert_out1_14_2
	expert_out1_14_2 -> combine1_14
	select1_14 -> expert1_14_3 [label="if selected" style=dashed]
	expert1_14_3 -> expert_act1_14_3
	expert_act1_14_3 -> expert_out1_14_3
	expert_out1_14_3 -> combine1_14
	select1_14 -> expert1_14_4 [label="if selected" style=dashed]
	expert1_14_4 -> expert_act1_14_4
	expert_act1_14_4 -> expert_out1_14_4
	expert_out1_14_4 -> combine1_14
	select1_14 -> expert1_14_5 [label="if selected" style=dashed]
	expert1_14_5 -> expert_act1_14_5
	expert_act1_14_5 -> expert_out1_14_5
	expert_out1_14_5 -> combine1_14
	select1_14 -> expert1_14_6 [label="if selected" style=dashed]
	expert1_14_6 -> expert_act1_14_6
	expert_act1_14_6 -> expert_out1_14_6
	expert_out1_14_6 -> combine1_14
	select1_14 -> expert1_14_7 [label="if selected" style=dashed]
	expert1_14_7 -> expert_act1_14_7
	expert_act1_14_7 -> expert_out1_14_7
	expert_out1_14_7 -> combine1_14
	combine1_14 -> res_moe1_14
	res_attn1_14 -> res_moe1_14
	ring_stage1_15_15 -> accum1_15
	accum1_15 -> out_proj1_15
	out_proj1_15 -> res_attn1_15
	res_moe0_15 -> res_attn1_15
	res_attn1_15 -> gate1_15
	gate1_15 -> select1_15
	select1_15 -> expert1_15_0 [label="if selected" style=dashed]
	expert1_15_0 -> expert_act1_15_0
	expert_act1_15_0 -> expert_out1_15_0
	expert_out1_15_0 -> combine1_15
	select1_15 -> expert1_15_1 [label="if selected" style=dashed]
	expert1_15_1 -> expert_act1_15_1
	expert_act1_15_1 -> expert_out1_15_1
	expert_out1_15_1 -> combine1_15
	select1_15 -> expert1_15_2 [label="if selected" style=dashed]
	expert1_15_2 -> expert_act1_15_2
	expert_act1_15_2 -> expert_out1_15_2
	expert_out1_15_2 -> combine1_15
	select1_15 -> expert1_15_3 [label="if selected" style=dashed]
	expert1_15_3 -> expert_act1_15_3
	expert_act1_15_3 -> expert_out1_15_3
	expert_out1_15_3 -> combine1_15
	select1_15 -> expert1_15_4 [label="if selected" style=dashed]
	expert1_15_4 -> expert_act1_15_4
	expert_act1_15_4 -> expert_out1_15_4
	expert_out1_15_4 -> combine1_15
	select1_15 -> expert1_15_5 [label="if selected" style=dashed]
	expert1_15_5 -> expert_act1_15_5
	expert_act1_15_5 -> expert_out1_15_5
	expert_out1_15_5 -> combine1_15
	select1_15 -> expert1_15_6 [label="if selected" style=dashed]
	expert1_15_6 -> expert_act1_15_6
	expert_act1_15_6 -> expert_out1_15_6
	expert_out1_15_6 -> combine1_15
	select1_15 -> expert1_15_7 [label="if selected" style=dashed]
	expert1_15_7 -> expert_act1_15_7
	expert_act1_15_7 -> expert_out1_15_7
	expert_out1_15_7 -> combine1_15
	combine1_15 -> res_moe1_15
	res_attn1_15 -> res_moe1_15
	res_moe1_0 -> qkv2_0
	res_moe1_1 -> qkv2_1
	res_moe1_2 -> qkv2_2
	res_moe1_3 -> qkv2_3
	res_moe1_4 -> qkv2_4
	res_moe1_5 -> qkv2_5
	res_moe1_6 -> qkv2_6
	res_moe1_7 -> qkv2_7
	res_moe1_8 -> qkv2_8
	res_moe1_9 -> qkv2_9
	res_moe1_10 -> qkv2_10
	res_moe1_11 -> qkv2_11
	res_moe1_12 -> qkv2_12
	res_moe1_13 -> qkv2_13
	res_moe1_14 -> qkv2_14
	res_moe1_15 -> qkv2_15
	qkv2_0 -> ring_stage2_0_0
	qkv2_1 -> ring_stage2_0_1
	qkv2_2 -> ring_stage2_0_2
	qkv2_3 -> ring_stage2_0_3
	qkv2_4 -> ring_stage2_0_4
	qkv2_5 -> ring_stage2_0_5
	qkv2_6 -> ring_stage2_0_6
	qkv2_7 -> ring_stage2_0_7
	qkv2_8 -> ring_stage2_0_8
	qkv2_9 -> ring_stage2_0_9
	qkv2_10 -> ring_stage2_0_10
	qkv2_11 -> ring_stage2_0_11
	qkv2_12 -> ring_stage2_0_12
	qkv2_13 -> ring_stage2_0_13
	qkv2_14 -> ring_stage2_0_14
	qkv2_15 -> ring_stage2_0_15
	ring_stage2_0_0 -> kv_send2_0_0
	ring_stage2_0_1 -> kv_send2_0_1
	ring_stage2_0_2 -> kv_send2_0_2
	ring_stage2_0_3 -> kv_send2_0_3
	ring_stage2_0_4 -> kv_send2_0_4
	ring_stage2_0_5 -> kv_send2_0_5
	ring_stage2_0_6 -> kv_send2_0_6
	ring_stage2_0_7 -> kv_send2_0_7
	ring_stage2_0_8 -> kv_send2_0_8
	ring_stage2_0_9 -> kv_send2_0_9
	ring_stage2_0_10 -> kv_send2_0_10
	ring_stage2_0_11 -> kv_send2_0_11
	ring_stage2_0_12 -> kv_send2_0_12
	ring_stage2_0_13 -> kv_send2_0_13
	ring_stage2_0_14 -> kv_send2_0_14
	ring_stage2_0_15 -> kv_send2_0_15
	ring_stage2_0_0 -> ring_stage2_1_0
	kv_send2_0_15 -> ring_stage2_1_0
	ring_stage2_1_0 -> kv_send2_1_0
	ring_stage2_0_1 -> ring_stage2_1_1
	kv_send2_0_0 -> ring_stage2_1_1
	ring_stage2_1_1 -> kv_send2_1_1
	ring_stage2_0_2 -> ring_stage2_1_2
	kv_send2_0_1 -> ring_stage2_1_2
	ring_stage2_1_2 -> kv_send2_1_2
	ring_stage2_0_3 -> ring_stage2_1_3
	kv_send2_0_2 -> ring_stage2_1_3
	ring_stage2_1_3 -> kv_send2_1_3
	ring_stage2_0_4 -> ring_stage2_1_4
	kv_send2_0_3 -> ring_stage2_1_4
	ring_stage2_1_4 -> kv_send2_1_4
	ring_stage2_0_5 -> ring_stage2_1_5
	kv_send2_0_4 -> ring_stage2_1_5
	ring_stage2_1_5 -> kv_send2_1_5
	ring_stage2_0_6 -> ring_stage2_1_6
	kv_send2_0_5 -> ring_stage2_1_6
	ring_stage2_1_6 -> kv_send2_1_6
	ring_stage2_0_7 -> ring_stage2_1_7
	kv_send2_0_6 -> ring_stage2_1_7
	ring_stage2_1_7 -> kv_send2_1_7
	ring_stage2_0_8 -> ring_stage2_1_8
	kv_send2_0_7 -> ring_stage2_1_8
	ring_stage2_1_8 -> kv_send2_1_8
	ring_stage2_0_9 -> ring_stage2_1_9
	kv_send2_0_8 -> ring_stage2_1_9
	ring_stage2_1_9 -> kv_send2_1_9
	ring_stage2_0_10 -> ring_stage2_1_10
	kv_send2_0_9 -> ring_stage2_1_10
	ring_stage2_1_10 -> kv_send2_1_10
	ring_stage2_0_11 -> ring_stage2_1_11
	kv_send2_0_10 -> ring_stage2_1_11
	ring_stage2_1_11 -> kv_send2_1_11
	ring_stage2_0_12 -> ring_stage2_1_12
	kv_send2_0_11 -> ring_stage2_1_12
	ring_stage2_1_12 -> kv_send2_1_12
	ring_stage2_0_13 -> ring_stage2_1_13
	kv_send2_0_12 -> ring_stage2_1_13
	ring_stage2_1_13 -> kv_send2_1_13
	ring_stage2_0_14 -> ring_stage2_1_14
	kv_send2_0_13 -> ring_stage2_1_14
	ring_stage2_1_14 -> kv_send2_1_14
	ring_stage2_0_15 -> ring_stage2_1_15
	kv_send2_0_14 -> ring_stage2_1_15
	ring_stage2_1_15 -> kv_send2_1_15
	ring_stage2_1_0 -> ring_stage2_2_0
	kv_send2_1_15 -> ring_stage2_2_0
	ring_stage2_2_0 -> kv_send2_2_0
	ring_stage2_1_1 -> ring_stage2_2_1
	kv_send2_1_0 -> ring_stage2_2_1
	ring_stage2_2_1 -> kv_send2_2_1
	ring_stage2_1_2 -> ring_stage2_2_2
	kv_send2_1_1 -> ring_stage2_2_2
	ring_stage2_2_2 -> kv_send2_2_2
	ring_stage2_1_3 -> ring_stage2_2_3
	kv_send2_1_2 -> ring_stage2_2_3
	ring_stage2_2_3 -> kv_send2_2_3
	ring_stage2_1_4 -> ring_stage2_2_4
	kv_send2_1_3 -> ring_stage2_2_4
	ring_stage2_2_4 -> kv_send2_2_4
	ring_stage2_1_5 -> ring_stage2_2_5
	kv_send2_1_4 -> ring_stage2_2_5
	ring_stage2_2_5 -> kv_send2_2_5
	ring_stage2_1_6 -> ring_stage2_2_6
	kv_send2_1_5 -> ring_stage2_2_6
	ring_stage2_2_6 -> kv_send2_2_6
	ring_stage2_1_7 -> ring_stage2_2_7
	kv_send2_1_6 -> ring_stage2_2_7
	ring_stage2_2_7 -> kv_send2_2_7
	ring_stage2_1_8 -> ring_stage2_2_8
	kv_send2_1_7 -> ring_stage2_2_8
	ring_stage2_2_8 -> kv_send2_2_8
	ring_stage2_1_9 -> ring_stage2_2_9
	kv_send2_1_8 -> ring_stage2_2_9
	ring_stage2_2_9 -> kv_send2_2_9
	ring_stage2_1_10 -> ring_stage2_2_10
	kv_send2_1_9 -> ring_stage2_2_10
	ring_stage2_2_10 -> kv_send2_2_10
	ring_stage2_1_11 -> ring_stage2_2_11
	kv_send2_1_10 -> ring_stage2_2_11
	ring_stage2_2_11 -> kv_send2_2_11
	ring_stage2_1_12 -> ring_stage2_2_12
	kv_send2_1_11 -> ring_stage2_2_12
	ring_stage2_2_12 -> kv_send2_2_12
	ring_stage2_1_13 -> ring_stage2_2_13
	kv_send2_1_12 -> ring_stage2_2_13
	ring_stage2_2_13 -> kv_send2_2_13
	ring_stage2_1_14 -> ring_stage2_2_14
	kv_send2_1_13 -> ring_stage2_2_14
	ring_stage2_2_14 -> kv_send2_2_14
	ring_stage2_1_15 -> ring_stage2_2_15
	kv_send2_1_14 -> ring_stage2_2_15
	ring_stage2_2_15 -> kv_send2_2_15
	ring_stage2_2_0 -> ring_stage2_3_0
	kv_send2_2_15 -> ring_stage2_3_0
	ring_stage2_3_0 -> kv_send2_3_0
	ring_stage2_2_1 -> ring_stage2_3_1
	kv_send2_2_0 -> ring_stage2_3_1
	ring_stage2_3_1 -> kv_send2_3_1
	ring_stage2_2_2 -> ring_stage2_3_2
	kv_send2_2_1 -> ring_stage2_3_2
	ring_stage2_3_2 -> kv_send2_3_2
	ring_stage2_2_3 -> ring_stage2_3_3
	kv_send2_2_2 -> ring_stage2_3_3
	ring_stage2_3_3 -> kv_send2_3_3
	ring_stage2_2_4 -> ring_stage2_3_4
	kv_send2_2_3 -> ring_stage2_3_4
	ring_stage2_3_4 -> kv_send2_3_4
	ring_stage2_2_5 -> ring_stage2_3_5
	kv_send2_2_4 -> ring_stage2_3_5
	ring_stage2_3_5 -> kv_send2_3_5
	ring_stage2_2_6 -> ring_stage2_3_6
	kv_send2_2_5 -> ring_stage2_3_6
	ring_stage2_3_6 -> kv_send2_3_6
	ring_stage2_2_7 -> ring_stage2_3_7
	kv_send2_2_6 -> ring_stage2_3_7
	ring_stage2_3_7 -> kv_send2_3_7
	ring_stage2_2_8 -> ring_stage2_3_8
	kv_send2_2_7 -> ring_stage2_3_8
	ring_stage2_3_8 -> kv_send2_3_8
	ring_stage2_2_9 -> ring_stage2_3_9
	kv_send2_2_8 -> ring_stage2_3_9
	ring_stage2_3_9 -> kv_send2_3_9
	ring_stage2_2_10 -> ring_stage2_3_10
	kv_send2_2_9 -> ring_stage2_3_10
	ring_stage2_3_10 -> kv_send2_3_10
	ring_stage2_2_11 -> ring_stage2_3_11
	kv_send2_2_10 -> ring_stage2_3_11
	ring_stage2_3_11 -> kv_send2_3_11
	ring_stage2_2_12 -> ring_stage2_3_12
	kv_send2_2_11 -> ring_stage2_3_12
	ring_stage2_3_12 -> kv_send2_3_12
	ring_stage2_2_13 -> ring_stage2_3_13
	kv_send2_2_12 -> ring_stage2_3_13
	ring_stage2_3_13 -> kv_send2_3_13
	ring_stage2_2_14 -> ring_stage2_3_14
	kv_send2_2_13 -> ring_stage2_3_14
	ring_stage2_3_14 -> kv_send2_3_14
	ring_stage2_2_15 -> ring_stage2_3_15
	kv_send2_2_14 -> ring_stage2_3_15
	ring_stage2_3_15 -> kv_send2_3_15
	ring_stage2_3_0 -> ring_stage2_4_0
	kv_send2_3_15 -> ring_stage2_4_0
	ring_stage2_4_0 -> kv_send2_4_0
	ring_stage2_3_1 -> ring_stage2_4_1
	kv_send2_3_0 -> ring_stage2_4_1
	ring_stage2_4_1 -> kv_send2_4_1
	ring_stage2_3_2 -> ring_stage2_4_2
	kv_send2_3_1 -> ring_stage2_4_2
	ring_stage2_4_2 -> kv_send2_4_2
	ring_stage2_3_3 -> ring_stage2_4_3
	kv_send2_3_2 -> ring_stage2_4_3
	ring_stage2_4_3 -> kv_send2_4_3
	ring_stage2_3_4 -> ring_stage2_4_4
	kv_send2_3_3 -> ring_stage2_4_4
	ring_stage2_4_4 -> kv_send2_4_4
	ring_stage2_3_5 -> ring_stage2_4_5
	kv_send2_3_4 -> ring_stage2_4_5
	ring_stage2_4_5 -> kv_send2_4_5
	ring_stage2_3_6 -> ring_stage2_4_6
	kv_send2_3_5 -> ring_stage2_4_6
	ring_stage2_4_6 -> kv_send2_4_6
	ring_stage2_3_7 -> ring_stage2_4_7
	kv_send2_3_6 -> ring_stage2_4_7
	ring_stage2_4_7 -> kv_send2_4_7
	ring_stage2_3_8 -> ring_stage2_4_8
	kv_send2_3_7 -> ring_stage2_4_8
	ring_stage2_4_8 -> kv_send2_4_8
	ring_stage2_3_9 -> ring_stage2_4_9
	kv_send2_3_8 -> ring_stage2_4_9
	ring_stage2_4_9 -> kv_send2_4_9
	ring_stage2_3_10 -> ring_stage2_4_10
	kv_send2_3_9 -> ring_stage2_4_10
	ring_stage2_4_10 -> kv_send2_4_10
	ring_stage2_3_11 -> ring_stage2_4_11
	kv_send2_3_10 -> ring_stage2_4_11
	ring_stage2_4_11 -> kv_send2_4_11
	ring_stage2_3_12 -> ring_stage2_4_12
	kv_send2_3_11 -> ring_stage2_4_12
	ring_stage2_4_12 -> kv_send2_4_12
	ring_stage2_3_13 -> ring_stage2_4_13
	kv_send2_3_12 -> ring_stage2_4_13
	ring_stage2_4_13 -> kv_send2_4_13
	ring_stage2_3_14 -> ring_stage2_4_14
	kv_send2_3_13 -> ring_stage2_4_14
	ring_stage2_4_14 -> kv_send2_4_14
	ring_stage2_3_15 -> ring_stage2_4_15
	kv_send2_3_14 -> ring_stage2_4_15
	ring_stage2_4_15 -> kv_send2_4_15
	ring_stage2_4_0 -> ring_stage2_5_0
	kv_send2_4_15 -> ring_stage2_5_0
	ring_stage2_5_0 -> kv_send2_5_0
	ring_stage2_4_1 -> ring_stage2_5_1
	kv_send2_4_0 -> ring_stage2_5_1
	ring_stage2_5_1 -> kv_send2_5_1
	ring_stage2_4_2 -> ring_stage2_5_2
	kv_send2_4_1 -> ring_stage2_5_2
	ring_stage2_5_2 -> kv_send2_5_2
	ring_stage2_4_3 -> ring_stage2_5_3
	kv_send2_4_2 -> ring_stage2_5_3
	ring_stage2_5_3 -> kv_send2_5_3
	ring_stage2_4_4 -> ring_stage2_5_4
	kv_send2_4_3 -> ring_stage2_5_4
	ring_stage2_5_4 -> kv_send2_5_4
	ring_stage2_4_5 -> ring_stage2_5_5
	kv_send2_4_4 -> ring_stage2_5_5
	ring_stage2_5_5 -> kv_send2_5_5
	ring_stage2_4_6 -> ring_stage2_5_6
	kv_send2_4_5 -> ring_stage2_5_6
	ring_stage2_5_6 -> kv_send2_5_6
	ring_stage2_4_7 -> ring_stage2_5_7
	kv_send2_4_6 -> ring_stage2_5_7
	ring_stage2_5_7 -> kv_send2_5_7
	ring_stage2_4_8 -> ring_stage2_5_8
	kv_send2_4_7 -> ring_stage2_5_8
	ring_stage2_5_8 -> kv_send2_5_8
	ring_stage2_4_9 -> ring_stage2_5_9
	kv_send2_4_8 -> ring_stage2_5_9
	ring_stage2_5_9 -> kv_send2_5_9
	ring_stage2_4_10 -> ring_stage2_5_10
	kv_send2_4_9 -> ring_stage2_5_10
	ring_stage2_5_10 -> kv_send2_5_10
	ring_stage2_4_11 -> ring_stage2_5_11
	kv_send2_4_10 -> ring_stage2_5_11
	ring_stage2_5_11 -> kv_send2_5_11
	ring_stage2_4_12 -> ring_stage2_5_12
	kv_send2_4_11 -> ring_stage2_5_12
	ring_stage2_5_12 -> kv_send2_5_12
	ring_stage2_4_13 -> ring_stage2_5_13
	kv_send2_4_12 -> ring_stage2_5_13
	ring_stage2_5_13 -> kv_send2_5_13
	ring_stage2_4_14 -> ring_stage2_5_14
	kv_send2_4_13 -> ring_stage2_5_14
	ring_stage2_5_14 -> kv_send2_5_14
	ring_stage2_4_15 -> ring_stage2_5_15
	kv_send2_4_14 -> ring_stage2_5_15
	ring_stage2_5_15 -> kv_send2_5_15
	ring_stage2_5_0 -> ring_stage2_6_0
	kv_send2_5_15 -> ring_stage2_6_0
	ring_stage2_6_0 -> kv_send2_6_0
	ring_stage2_5_1 -> ring_stage2_6_1
	kv_send2_5_0 -> ring_stage2_6_1
	ring_stage2_6_1 -> kv_send2_6_1
	ring_stage2_5_2 -> ring_stage2_6_2
	kv_send2_5_1 -> ring_stage2_6_2
	ring_stage2_6_2 -> kv_send2_6_2
	ring_stage2_5_3 -> ring_stage2_6_3
	kv_send2_5_2 -> ring_stage2_6_3
	ring_stage2_6_3 -> kv_send2_6_3
	ring_stage2_5_4 -> ring_stage2_6_4
	kv_send2_5_3 -> ring_stage2_6_4
	ring_stage2_6_4 -> kv_send2_6_4
	ring_stage2_5_5 -> ring_stage2_6_5
	kv_send2_5_4 -> ring_stage2_6_5
	ring_stage2_6_5 -> kv_send2_6_5
	ring_stage2_5_6 -> ring_stage2_6_6
	kv_send2_5_5 -> ring_stage2_6_6
	ring_stage2_6_6 -> kv_send2_6_6
	ring_stage2_5_7 -> ring_stage2_6_7
	kv_send2_5_6 -> ring_stage2_6_7
	ring_stage2_6_7 -> kv_send2_6_7
	ring_stage2_5_8 -> ring_stage2_6_8
	kv_send2_5_7 -> ring_stage2_6_8
	ring_stage2_6_8 -> kv_send2_6_8
	ring_stage2_5_9 -> ring_stage2_6_9
	kv_send2_5_8 -> ring_stage2_6_9
	ring_stage2_6_9 -> kv_send2_6_9
	ring_stage2_5_10 -> ring_stage2_6_10
	kv_send2_5_9 -> ring_stage2_6_10
	ring_stage2_6_10 -> kv_send2_6_10
	ring_stage2_5_11 -> ring_stage2_6_11
	kv_send2_5_10 -> ring_stage2_6_11
	ring_stage2_6_11 -> kv_send2_6_11
	ring_stage2_5_12 -> ring_stage2_6_12
	kv_send2_5_11 -> ring_stage2_6_12
	ring_stage2_6_12 -> kv_send2_6_12
	ring_stage2_5_13 -> ring_stage2_6_13
	kv_send2_5_12 -> ring_stage2_6_13
	ring_stage2_6_13 -> kv_send2_6_13
	ring_stage2_5_14 -> ring_stage2_6_14
	kv_send2_5_13 -> ring_stage2_6_14
	ring_stage2_6_14 -> kv_send2_6_14
	ring_stage2_5_15 -> ring_stage2_6_15
	kv_send2_5_14 -> ring_stage2_6_15
	ring_stage2_6_15 -> kv_send2_6_15
	ring_stage2_6_0 -> ring_stage2_7_0
	kv_send2_6_15 -> ring_stage2_7_0
	ring_stage2_7_0 -> kv_send2_7_0
	ring_stage2_6_1 -> ring_stage2_7_1
	kv_send2_6_0 -> ring_stage2_7_1
	ring_stage2_7_1 -> kv_send2_7_1
	ring_stage2_6_2 -> ring_stage2_7_2
	kv_send2_6_1 -> ring_stage2_7_2
	ring_stage2_7_2 -> kv_send2_7_2
	ring_stage2_6_3 -> ring_stage2_7_3
	kv_send2_6_2 -> ring_stage2_7_3
	ring_stage2_7_3 -> kv_send2_7_3
	ring_stage2_6_4 -> ring_stage2_7_4
	kv_send2_6_3 -> ring_stage2_7_4
	ring_stage2_7_4 -> kv_send2_7_4
	ring_stage2_6_5 -> ring_stage2_7_5
	kv_send2_6_4 -> ring_stage2_7_5
	ring_stage2_7_5 -> kv_send2_7_5
	ring_stage2_6_6 -> ring_stage2_7_6
	kv_send2_6_5 -> ring_stage2_7_6
	ring_stage2_7_6 -> kv_send2_7_6
	ring_stage2_6_7 -> ring_stage2_7_7
	kv_send2_6_6 -> ring_stage2_7_7
	ring_stage2_7_7 -> kv_send2_7_7
	ring_stage2_6_8 -> ring_stage2_7_8
	kv_send2_6_7 -> ring_stage2_7_8
	ring_stage2_7_8 -> kv_send2_7_8
	ring_stage2_6_9 -> ring_stage2_7_9
	kv_send2_6_8 -> ring_stage2_7_9
	ring_stage2_7_9 -> kv_send2_7_9
	ring_stage2_6_10 -> ring_stage2_7_10
	kv_send2_6_9 -> ring_stage2_7_10
	ring_stage2_7_10 -> kv_send2_7_10
	ring_stage2_6_11 -> ring_stage2_7_11
	kv_send2_6_10 -> ring_stage2_7_11
	ring_stage2_7_11 -> kv_send2_7_11
	ring_stage2_6_12 -> ring_stage2_7_12
	kv_send2_6_11 -> ring_stage2_7_12
	ring_stage2_7_12 -> kv_send2_7_12
	ring_stage2_6_13 -> ring_stage2_7_13
	kv_send2_6_12 -> ring_stage2_7_13
	ring_stage2_7_13 -> kv_send2_7_13
	ring_stage2_6_14 -> ring_stage2_7_14
	kv_send2_6_13 -> ring_stage2_7_14
	ring_stage2_7_14 -> kv_send2_7_14
	ring_stage2_6_15 -> ring_stage2_7_15
	kv_send2_6_14 -> ring_stage2_7_15
	ring_stage2_7_15 -> kv_send2_7_15
	ring_stage2_7_0 -> ring_stage2_8_0
	kv_send2_7_15 -> ring_stage2_8_0
	ring_stage2_8_0 -> kv_send2_8_0
	ring_stage2_7_1 -> ring_stage2_8_1
	kv_send2_7_0 -> ring_stage2_8_1
	ring_stage2_8_1 -> kv_send2_8_1
	ring_stage2_7_2 -> ring_stage2_8_2
	kv_send2_7_1 -> ring_stage2_8_2
	ring_stage2_8_2 -> kv_send2_8_2
	ring_stage2_7_3 -> ring_stage2_8_3
	kv_send2_7_2 -> ring_stage2_8_3
	ring_stage2_8_3 -> kv_send2_8_3
	ring_stage2_7_4 -> ring_stage2_8_4
	kv_send2_7_3 -> ring_stage2_8_4
	ring_stage2_8_4 -> kv_send2_8_4
	ring_stage2_7_5 -> ring_stage2_8_5
	kv_send2_7_4 -> ring_stage2_8_5
	ring_stage2_8_5 -> kv_send2_8_5
	ring_stage2_7_6 -> ring_stage2_8_6
	kv_send2_7_5 -> ring_stage2_8_6
	ring_stage2_8_6 -> kv_send2_8_6
	ring_stage2_7_7 -> ring_stage2_8_7
	kv_send2_7_6 -> ring_stage2_8_7
	ring_stage2_8_7 -> kv_send2_8_7
	ring_stage2_7_8 -> ring_stage2_8_8
	kv_send2_7_7 -> ring_stage2_8_8
	ring_stage2_8_8 -> kv_send2_8_8
	ring_stage2_7_9 -> ring_stage2_8_9
	kv_send2_7_8 -> ring_stage2_8_9
	ring_stage2_8_9 -> kv_send2_8_9
	ring_stage2_7_10 -> ring_stage2_8_10
	kv_send2_7_9 -> ring_stage2_8_10
	ring_stage2_8_10 -> kv_send2_8_10
	ring_stage2_7_11 -> ring_stage2_8_11
	kv_send2_7_10 -> ring_stage2_8_11
	ring_stage2_8_11 -> kv_send2_8_11
	ring_stage2_7_12 -> ring_stage2_8_12
	kv_send2_7_11 -> ring_stage2_8_12
	ring_stage2_8_12 -> kv_send2_8_12
	ring_stage2_7_13 -> ring_stage2_8_13
	kv_send2_7_12 -> ring_stage2_8_13
	ring_stage2_8_13 -> kv_send2_8_13
	ring_stage2_7_14 -> ring_stage2_8_14
	kv_send2_7_13 -> ring_stage2_8_14
	ring_stage2_8_14 -> kv_send2_8_14
	ring_stage2_7_15 -> ring_stage2_8_15
	kv_send2_7_14 -> ring_stage2_8_15
	ring_stage2_8_15 -> kv_send2_8_15
	ring_stage2_8_0 -> ring_stage2_9_0
	kv_send2_8_15 -> ring_stage2_9_0
	ring_stage2_9_0 -> kv_send2_9_0
	ring_stage2_8_1 -> ring_stage2_9_1
	kv_send2_8_0 -> ring_stage2_9_1
	ring_stage2_9_1 -> kv_send2_9_1
	ring_stage2_8_2 -> ring_stage2_9_2
	kv_send2_8_1 -> ring_stage2_9_2
	ring_stage2_9_2 -> kv_send2_9_2
	ring_stage2_8_3 -> ring_stage2_9_3
	kv_send2_8_2 -> ring_stage2_9_3
	ring_stage2_9_3 -> kv_send2_9_3
	ring_stage2_8_4 -> ring_stage2_9_4
	kv_send2_8_3 -> ring_stage2_9_4
	ring_stage2_9_4 -> kv_send2_9_4
	ring_stage2_8_5 -> ring_stage2_9_5
	kv_send2_8_4 -> ring_stage2_9_5
	ring_stage2_9_5 -> kv_send2_9_5
	ring_stage2_8_6 -> ring_stage2_9_6
	kv_send2_8_5 -> ring_stage2_9_6
	ring_stage2_9_6 -> kv_send2_9_6
	ring_stage2_8_7 -> ring_stage2_9_7
	kv_send2_8_6 -> ring_stage2_9_7
	ring_stage2_9_7 -> kv_send2_9_7
	ring_stage2_8_8 -> ring_stage2_9_8
	kv_send2_8_7 -> ring_stage2_9_8
	ring_stage2_9_8 -> kv_send2_9_8
	ring_stage2_8_9 -> ring_stage2_9_9
	kv_send2_8_8 -> ring_stage2_9_9
	ring_stage2_9_9 -> kv_send2_9_9
	ring_stage2_8_10 -> ring_stage2_9_10
	kv_send2_8_9 -> ring_stage2_9_10
	ring_stage2_9_10 -> kv_send2_9_10
	ring_stage2_8_11 -> ring_stage2_9_11
	kv_send2_8_10 -> ring_stage2_9_11
	ring_stage2_9_11 -> kv_send2_9_11
	ring_stage2_8_12 -> ring_stage2_9_12
	kv_send2_8_11 -> ring_stage2_9_12
	ring_stage2_9_12 -> kv_send2_9_12
	ring_stage2_8_13 -> ring_stage2_9_13
	kv_send2_8_12 -> ring_stage2_9_13
	ring_stage2_9_13 -> kv_send2_9_13
	ring_stage2_8_14 -> ring_stage2_9_14
	kv_send2_8_13 -> ring_stage2_9_14
	ring_stage2_9_14 -> kv_send2_9_14
	ring_stage2_8_15 -> ring_stage2_9_15
	kv_send2_8_14 -> ring_stage2_9_15
	ring_stage2_9_15 -> kv_send2_9_15
	ring_stage2_9_0 -> ring_stage2_10_0
	kv_send2_9_15 -> ring_stage2_10_0
	ring_stage2_10_0 -> kv_send2_10_0
	ring_stage2_9_1 -> ring_stage2_10_1
	kv_send2_9_0 -> ring_stage2_10_1
	ring_stage2_10_1 -> kv_send2_10_1
	ring_stage2_9_2 -> ring_stage2_10_2
	kv_send2_9_1 -> ring_stage2_10_2
	ring_stage2_10_2 -> kv_send2_10_2
	ring_stage2_9_3 -> ring_stage2_10_3
	kv_send2_9_2 -> ring_stage2_10_3
	ring_stage2_10_3 -> kv_send2_10_3
	ring_stage2_9_4 -> ring_stage2_10_4
	kv_send2_9_3 -> ring_stage2_10_4
	ring_stage2_10_4 -> kv_send2_10_4
	ring_stage2_9_5 -> ring_stage2_10_5
	kv_send2_9_4 -> ring_stage2_10_5
	ring_stage2_10_5 -> kv_send2_10_5
	ring_stage2_9_6 -> ring_stage2_10_6
	kv_send2_9_5 -> ring_stage2_10_6
	ring_stage2_10_6 -> kv_send2_10_6
	ring_stage2_9_7 -> ring_stage2_10_7
	kv_send2_9_6 -> ring_stage2_10_7
	ring_stage2_10_7 -> kv_send2_10_7
	ring_stage2_9_8 -> ring_stage2_10_8
	kv_send2_9_7 -> ring_stage2_10_8
	ring_stage2_10_8 -> kv_send2_10_8
	ring_stage2_9_9 -> ring_stage2_10_9
	kv_send2_9_8 -> ring_stage2_10_9
	ring_stage2_10_9 -> kv_send2_10_9
	ring_stage2_9_10 -> ring_stage2_10_10
	kv_send2_9_9 -> ring_stage2_10_10
	ring_stage2_10_10 -> kv_send2_10_10
	ring_stage2_9_11 -> ring_stage2_10_11
	kv_send2_9_10 -> ring_stage2_10_11
	ring_stage2_10_11 -> kv_send2_10_11
	ring_stage2_9_12 -> ring_stage2_10_12
	kv_send2_9_11 -> ring_stage2_10_12
	ring_stage2_10_12 -> kv_send2_10_12
	ring_stage2_9_13 -> ring_stage2_10_13
	kv_send2_9_12 -> ring_stage2_10_13
	ring_stage2_10_13 -> kv_send2_10_13
	ring_stage2_9_14 -> ring_stage2_10_14
	kv_send2_9_13 -> ring_stage2_10_14
	ring_stage2_10_14 -> kv_send2_10_14
	ring_stage2_9_15 -> ring_stage2_10_15
	kv_send2_9_14 -> ring_stage2_10_15
	ring_stage2_10_15 -> kv_send2_10_15
	ring_stage2_10_0 -> ring_stage2_11_0
	kv_send2_10_15 -> ring_stage2_11_0
	ring_stage2_11_0 -> kv_send2_11_0
	ring_stage2_10_1 -> ring_stage2_11_1
	kv_send2_10_0 -> ring_stage2_11_1
	ring_stage2_11_1 -> kv_send2_11_1
	ring_stage2_10_2 -> ring_stage2_11_2
	kv_send2_10_1 -> ring_stage2_11_2
	ring_stage2_11_2 -> kv_send2_11_2
	ring_stage2_10_3 -> ring_stage2_11_3
	kv_send2_10_2 -> ring_stage2_11_3
	ring_stage2_11_3 -> kv_send2_11_3
	ring_stage2_10_4 -> ring_stage2_11_4
	kv_send2_10_3 -> ring_stage2_11_4
	ring_stage2_11_4 -> kv_send2_11_4
	ring_stage2_10_5 -> ring_stage2_11_5
	kv_send2_10_4 -> ring_stage2_11_5
	ring_stage2_11_5 -> kv_send2_11_5
	ring_stage2_10_6 -> ring_stage2_11_6
	kv_send2_10_5 -> ring_stage2_11_6
	ring_stage2_11_6 -> kv_send2_11_6
	ring_stage2_10_7 -> ring_stage2_11_7
	kv_send2_10_6 -> ring_stage2_11_7
	ring_stage2_11_7 -> kv_send2_11_7
	ring_stage2_10_8 -> ring_stage2_11_8
	kv_send2_10_7 -> ring_stage2_11_8
	ring_stage2_11_8 -> kv_send2_11_8
	ring_stage2_10_9 -> ring_stage2_11_9
	kv_send2_10_8 -> ring_stage2_11_9
	ring_stage2_11_9 -> kv_send2_11_9
	ring_stage2_10_10 -> ring_stage2_11_10
	kv_send2_10_9 -> ring_stage2_11_10
	ring_stage2_11_10 -> kv_send2_11_10
	ring_stage2_10_11 -> ring_stage2_11_11
	kv_send2_10_10 -> ring_stage2_11_11
	ring_stage2_11_11 -> kv_send2_11_11
	ring_stage2_10_12 -> ring_stage2_11_12
	kv_send2_10_11 -> ring_stage2_11_12
	ring_stage2_11_12 -> kv_send2_11_12
	ring_stage2_10_13 -> ring_stage2_11_13
	kv_send2_10_12 -> ring_stage2_11_13
	ring_stage2_11_13 -> kv_send2_11_13
	ring_stage2_10_14 -> ring_stage2_11_14
	kv_send2_10_13 -> ring_stage2_11_14
	ring_stage2_11_14 -> kv_send2_11_14
	ring_stage2_10_15 -> ring_stage2_11_15
	kv_send2_10_14 -> ring_stage2_11_15
	ring_stage2_11_15 -> kv_send2_11_15
	ring_stage2_11_0 -> ring_stage2_12_0
	kv_send2_11_15 -> ring_stage2_12_0
	ring_stage2_12_0 -> kv_send2_12_0
	ring_stage2_11_1 -> ring_stage2_12_1
	kv_send2_11_0 -> ring_stage2_12_1
	ring_stage2_12_1 -> kv_send2_12_1
	ring_stage2_11_2 -> ring_stage2_12_2
	kv_send2_11_1 -> ring_stage2_12_2
	ring_stage2_12_2 -> kv_send2_12_2
	ring_stage2_11_3 -> ring_stage2_12_3
	kv_send2_11_2 -> ring_stage2_12_3
	ring_stage2_12_3 -> kv_send2_12_3
	ring_stage2_11_4 -> ring_stage2_12_4
	kv_send2_11_3 -> ring_stage2_12_4
	ring_stage2_12_4 -> kv_send2_12_4
	ring_stage2_11_5 -> ring_stage2_12_5
	kv_send2_11_4 -> ring_stage2_12_5
	ring_stage2_12_5 -> kv_send2_12_5
	ring_stage2_11_6 -> ring_stage2_12_6
	kv_send2_11_5 -> ring_stage2_12_6
	ring_stage2_12_6 -> kv_send2_12_6
	ring_stage2_11_7 -> ring_stage2_12_7
	kv_send2_11_6 -> ring_stage2_12_7
	ring_stage2_12_7 -> kv_send2_12_7
	ring_stage2_11_8 -> ring_stage2_12_8
	kv_send2_11_7 -> ring_stage2_12_8
	ring_stage2_12_8 -> kv_send2_12_8
	ring_stage2_11_9 -> ring_stage2_12_9
	kv_send2_11_8 -> ring_stage2_12_9
	ring_stage2_12_9 -> kv_send2_12_9
	ring_stage2_11_10 -> ring_stage2_12_10
	kv_send2_11_9 -> ring_stage2_12_10
	ring_stage2_12_10 -> kv_send2_12_10
	ring_stage2_11_11 -> ring_stage2_12_11
	kv_send2_11_10 -> ring_stage2_12_11
	ring_stage2_12_11 -> kv_send2_12_11
	ring_stage2_11_12 -> ring_stage2_12_12
	kv_send2_11_11 -> ring_stage2_12_12
	ring_stage2_12_12 -> kv_send2_12_12
	ring_stage2_11_13 -> ring_stage2_12_13
	kv_send2_11_12 -> ring_stage2_12_13
	ring_stage2_12_13 -> kv_send2_12_13
	ring_stage2_11_14 -> ring_stage2_12_14
	kv_send2_11_13 -> ring_stage2_12_14
	ring_stage2_12_14 -> kv_send2_12_14
	ring_stage2_11_15 -> ring_stage2_12_15
	kv_send2_11_14 -> ring_stage2_12_15
	ring_stage2_12_15 -> kv_send2_12_15
	ring_stage2_12_0 -> ring_stage2_13_0
	kv_send2_12_15 -> ring_stage2_13_0
	ring_stage2_13_0 -> kv_send2_13_0
	ring_stage2_12_1 -> ring_stage2_13_1
	kv_send2_12_0 -> ring_stage2_13_1
	ring_stage2_13_1 -> kv_send2_13_1
	ring_stage2_12_2 -> ring_stage2_13_2
	kv_send2_12_1 -> ring_stage2_13_2
	ring_stage2_13_2 -> kv_send2_13_2
	ring_stage2_12_3 -> ring_stage2_13_3
	kv_send2_12_2 -> ring_stage2_13_3
	ring_stage2_13_3 -> kv_send2_13_3
	ring_stage2_12_4 -> ring_stage2_13_4
	kv_send2_12_3 -> ring_stage2_13_4
	ring_stage2_13_4 -> kv_send2_13_4
	ring_stage2_12_5 -> ring_stage2_13_5
	kv_send2_12_4 -> ring_stage2_13_5
	ring_stage2_13_5 -> kv_send2_13_5
	ring_stage2_12_6 -> ring_stage2_13_6
	kv_send2_12_5 -> ring_stage2_13_6
	ring_stage2_13_6 -> kv_send2_13_6
	ring_stage2_12_7 -> ring_stage2_13_7
	kv_send2_12_6 -> ring_stage2_13_7
	ring_stage2_13_7 -> kv_send2_13_7
	ring_stage2_12_8 -> ring_stage2_13_8
	kv_send2_12_7 -> ring_stage2_13_8
	ring_stage2_13_8 -> kv_send2_13_8
	ring_stage2_12_9 -> ring_stage2_13_9
	kv_send2_12_8 -> ring_stage2_13_9
	ring_stage2_13_9 -> kv_send2_13_9
	ring_stage2_12_10 -> ring_stage2_13_10
	kv_send2_12_9 -> ring_stage2_13_10
	ring_stage2_13_10 -> kv_send2_13_10
	ring_stage2_12_11 -> ring_stage2_13_11
	kv_send2_12_10 -> ring_stage2_13_11
	ring_stage2_13_11 -> kv_send2_13_11
	ring_stage2_12_12 -> ring_stage2_13_12
	kv_send2_12_11 -> ring_stage2_13_12
	ring_stage2_13_12 -> kv_send2_13_12
	ring_stage2_12_13 -> ring_stage2_13_13
	kv_send2_12_12 -> ring_stage2_13_13
	ring_stage2_13_13 -> kv_send2_13_13
	ring_stage2_12_14 -> ring_stage2_13_14
	kv_send2_12_13 -> ring_stage2_13_14
	ring_stage2_13_14 -> kv_send2_13_14
	ring_stage2_12_15 -> ring_stage2_13_15
	kv_send2_12_14 -> ring_stage2_13_15
	ring_stage2_13_15 -> kv_send2_13_15
	ring_stage2_13_0 -> ring_stage2_14_0
	kv_send2_13_15 -> ring_stage2_14_0
	ring_stage2_14_0 -> kv_send2_14_0
	ring_stage2_13_1 -> ring_stage2_14_1
	kv_send2_13_0 -> ring_stage2_14_1
	ring_stage2_14_1 -> kv_send2_14_1
	ring_stage2_13_2 -> ring_stage2_14_2
	kv_send2_13_1 -> ring_stage2_14_2
	ring_stage2_14_2 -> kv_send2_14_2
	ring_stage2_13_3 -> ring_stage2_14_3
	kv_send2_13_2 -> ring_stage2_14_3
	ring_stage2_14_3 -> kv_send2_14_3
	ring_stage2_13_4 -> ring_stage2_14_4
	kv_send2_13_3 -> ring_stage2_14_4
	ring_stage2_14_4 -> kv_send2_14_4
	ring_stage2_13_5 -> ring_stage2_14_5
	kv_send2_13_4 -> ring_stage2_14_5
	ring_stage2_14_5 -> kv_send2_14_5
	ring_stage2_13_6 -> ring_stage2_14_6
	kv_send2_13_5 -> ring_stage2_14_6
	ring_stage2_14_6 -> kv_send2_14_6
	ring_stage2_13_7 -> ring_stage2_14_7
	kv_send2_13_6 -> ring_stage2_14_7
	ring_stage2_14_7 -> kv_send2_14_7
	ring_stage2_13_8 -> ring_stage2_14_8
	kv_send2_13_7 -> ring_stage2_14_8
	ring_stage2_14_8 -> kv_send2_14_8
	ring_stage2_13_9 -> ring_stage2_14_9
	kv_send2_13_8 -> ring_stage2_14_9
	ring_stage2_14_9 -> kv_send2_14_9
	ring_stage2_13_10 -> ring_stage2_14_10
	kv_send2_13_9 -> ring_stage2_14_10
	ring_stage2_14_10 -> kv_send2_14_10
	ring_stage2_13_11 -> ring_stage2_14_11
	kv_send2_13_10 -> ring_stage2_14_11
	ring_stage2_14_11 -> kv_send2_14_11
	ring_stage2_13_12 -> ring_stage2_14_12
	kv_send2_13_11 -> ring_stage2_14_12
	ring_stage2_14_12 -> kv_send2_14_12
	ring_stage2_13_13 -> ring_stage2_14_13
	kv_send2_13_12 -> ring_stage2_14_13
	ring_stage2_14_13 -> kv_send2_14_13
	ring_stage2_13_14 -> ring_stage2_14_14
	kv_send2_13_13 -> ring_stage2_14_14
	ring_stage2_14_14 -> kv_send2_14_14
	ring_stage2_13_15 -> ring_stage2_14_15
	kv_send2_13_14 -> ring_stage2_14_15
	ring_stage2_14_15 -> kv_send2_14_15
	ring_stage2_14_0 -> ring_stage2_15_0
	kv_send2_14_15 -> ring_stage2_15_0
	ring_stage2_14_1 -> ring_stage2_15_1
	kv_send2_14_0 -> ring_stage2_15_1
	ring_stage2_14_2 -> ring_stage2_15_2
	kv_send2_14_1 -> ring_stage2_15_2
	ring_stage2_14_3 -> ring_stage2_15_3
	kv_send2_14_2 -> ring_stage2_15_3
	ring_stage2_14_4 -> ring_stage2_15_4
	kv_send2_14_3 -> ring_stage2_15_4
	ring_stage2_14_5 -> ring_stage2_15_5
	kv_send2_14_4 -> ring_stage2_15_5
	ring_stage2_14_6 -> ring_stage2_15_6
	kv_send2_14_5 -> ring_stage2_15_6
	ring_stage2_14_7 -> ring_stage2_15_7
	kv_send2_14_6 -> ring_stage2_15_7
	ring_stage2_14_8 -> ring_stage2_15_8
	kv_send2_14_7 -> ring_stage2_15_8
	ring_stage2_14_9 -> ring_stage2_15_9
	kv_send2_14_8 -> ring_stage2_15_9
	ring_stage2_14_10 -> ring_stage2_15_10
	kv_send2_14_9 -> ring_stage2_15_10
	ring_stage2_14_11 -> ring_stage2_15_11
	kv_send2_14_10 -> ring_stage2_15_11
	ring_stage2_14_12 -> ring_stage2_15_12
	kv_send2_14_11 -> ring_stage2_15_12
	ring_stage2_14_13 -> ring_stage2_15_13
	kv_send2_14_12 -> ring_stage2_15_13
	ring_stage2_14_14 -> ring_stage2_15_14
	kv_send2_14_13 -> ring_stage2_15_14
	ring_stage2_14_15 -> ring_stage2_15_15
	kv_send2_14_14 -> ring_stage2_15_15
	ring_stage2_15_0 -> accum2_0
	accum2_0 -> out_proj2_0
	out_proj2_0 -> res_attn2_0
	res_moe1_0 -> res_attn2_0
	res_attn2_0 -> gate2_0
	gate2_0 -> select2_0
	select2_0 -> expert2_0_0 [label="if selected" style=dashed]
	expert2_0_0 -> expert_act2_0_0
	expert_act2_0_0 -> expert_out2_0_0
	expert_out2_0_0 -> combine2_0
	select2_0 -> expert2_0_1 [label="if selected" style=dashed]
	expert2_0_1 -> expert_act2_0_1
	expert_act2_0_1 -> expert_out2_0_1
	expert_out2_0_1 -> combine2_0
	select2_0 -> expert2_0_2 [label="if selected" style=dashed]
	expert2_0_2 -> expert_act2_0_2
	expert_act2_0_2 -> expert_out2_0_2
	expert_out2_0_2 -> combine2_0
	select2_0 -> expert2_0_3 [label="if selected" style=dashed]
	expert2_0_3 -> expert_act2_0_3
	expert_act2_0_3 -> expert_out2_0_3
	expert_out2_0_3 -> combine2_0
	select2_0 -> expert2_0_4 [label="if selected" style=dashed]
	expert2_0_4 -> expert_act2_0_4
	expert_act2_0_4 -> expert_out2_0_4
	expert_out2_0_4 -> combine2_0
	select2_0 -> expert2_0_5 [label="if selected" style=dashed]
	expert2_0_5 -> expert_act2_0_5
	expert_act2_0_5 -> expert_out2_0_5
	expert_out2_0_5 -> combine2_0
	select2_0 -> expert2_0_6 [label="if selected" style=dashed]
	expert2_0_6 -> expert_act2_0_6
	expert_act2_0_6 -> expert_out2_0_6
	expert_out2_0_6 -> combine2_0
	select2_0 -> expert2_0_7 [label="if selected" style=dashed]
	expert2_0_7 -> expert_act2_0_7
	expert_act2_0_7 -> expert_out2_0_7
	expert_out2_0_7 -> combine2_0
	combine2_0 -> res_moe2_0
	res_attn2_0 -> res_moe2_0
	ring_stage2_15_1 -> accum2_1
	accum2_1 -> out_proj2_1
	out_proj2_1 -> res_attn2_1
	res_moe1_1 -> res_attn2_1
	res_attn2_1 -> gate2_1
	gate2_1 -> select2_1
	select2_1 -> expert2_1_0 [label="if selected" style=dashed]
	expert2_1_0 -> expert_act2_1_0
	expert_act2_1_0 -> expert_out2_1_0
	expert_out2_1_0 -> combine2_1
	select2_1 -> expert2_1_1 [label="if selected" style=dashed]
	expert2_1_1 -> expert_act2_1_1
	expert_act2_1_1 -> expert_out2_1_1
	expert_out2_1_1 -> combine2_1
	select2_1 -> expert2_1_2 [label="if selected" style=dashed]
	expert2_1_2 -> expert_act2_1_2
	expert_act2_1_2 -> expert_out2_1_2
	expert_out2_1_2 -> combine2_1
	select2_1 -> expert2_1_3 [label="if selected" style=dashed]
	expert2_1_3 -> expert_act2_1_3
	expert_act2_1_3 -> expert_out2_1_3
	expert_out2_1_3 -> combine2_1
	select2_1 -> expert2_1_4 [label="if selected" style=dashed]
	expert2_1_4 -> expert_act2_1_4
	expert_act2_1_4 -> expert_out2_1_4
	expert_out2_1_4 -> combine2_1
	select2_1 -> expert2_1_5 [label="if selected" style=dashed]
	expert2_1_5 -> expert_act2_1_5
	expert_act2_1_5 -> expert_out2_1_5
	expert_out2_1_5 -> combine2_1
	select2_1 -> expert2_1_6 [label="if selected" style=dashed]
	expert2_1_6 -> expert_act2_1_6
	expert_act2_1_6 -> expert_out2_1_6
	expert_out2_1_6 -> combine2_1
	select2_1 -> expert2_1_7 [label="if selected" style=dashed]
	expert2_1_7 -> expert_act2_1_7
	expert_act2_1_7 -> expert_out2_1_7
	expert_out2_1_7 -> combine2_1
	combine2_1 -> res_moe2_1
	res_attn2_1 -> res_moe2_1
	ring_stage2_15_2 -> accum2_2
	accum2_2 -> out_proj2_2
	out_proj2_2 -> res_attn2_2
	res_moe1_2 -> res_attn2_2
	res_attn2_2 -> gate2_2
	gate2_2 -> select2_2
	select2_2 -> expert2_2_0 [label="if selected" style=dashed]
	expert2_2_0 -> expert_act2_2_0
	expert_act2_2_0 -> expert_out2_2_0
	expert_out2_2_0 -> combine2_2
	select2_2 -> expert2_2_1 [label="if selected" style=dashed]
	expert2_2_1 -> expert_act2_2_1
	expert_act2_2_1 -> expert_out2_2_1
	expert_out2_2_1 -> combine2_2
	select2_2 -> expert2_2_2 [label="if selected" style=dashed]
	expert2_2_2 -> expert_act2_2_2
	expert_act2_2_2 -> expert_out2_2_2
	expert_out2_2_2 -> combine2_2
	select2_2 -> expert2_2_3 [label="if selected" style=dashed]
	expert2_2_3 -> expert_act2_2_3
	expert_act2_2_3 -> expert_out2_2_3
	expert_out2_2_3 -> combine2_2
	select2_2 -> expert2_2_4 [label="if selected" style=dashed]
	expert2_2_4 -> expert_act2_2_4
	expert_act2_2_4 -> expert_out2_2_4
	expert_out2_2_4 -> combine2_2
	select2_2 -> expert2_2_5 [label="if selected" style=dashed]
	expert2_2_5 -> expert_act2_2_5
	expert_act2_2_5 -> expert_out2_2_5
	expert_out2_2_5 -> combine2_2
	select2_2 -> expert2_2_6 [label="if selected" style=dashed]
	expert2_2_6 -> expert_act2_2_6
	expert_act2_2_6 -> expert_out2_2_6
	expert_out2_2_6 -> combine2_2
	select2_2 -> expert2_2_7 [label="if selected" style=dashed]
	expert2_2_7 -> expert_act2_2_7
	expert_act2_2_7 -> expert_out2_2_7
	expert_out2_2_7 -> combine2_2
	combine2_2 -> res_moe2_2
	res_attn2_2 -> res_moe2_2
	ring_stage2_15_3 -> accum2_3
	accum2_3 -> out_proj2_3
	out_proj2_3 -> res_attn2_3
	res_moe1_3 -> res_attn2_3
	res_attn2_3 -> gate2_3
	gate2_3 -> select2_3
	select2_3 -> expert2_3_0 [label="if selected" style=dashed]
	expert2_3_0 -> expert_act2_3_0
	expert_act2_3_0 -> expert_out2_3_0
	expert_out2_3_0 -> combine2_3
	select2_3 -> expert2_3_1 [label="if selected" style=dashed]
	expert2_3_1 -> expert_act2_3_1
	expert_act2_3_1 -> expert_out2_3_1
	expert_out2_3_1 -> combine2_3
	select2_3 -> expert2_3_2 [label="if selected" style=dashed]
	expert2_3_2 -> expert_act2_3_2
	expert_act2_3_2 -> expert_out2_3_2
	expert_out2_3_2 -> combine2_3
	select2_3 -> expert2_3_3 [label="if selected" style=dashed]
	expert2_3_3 -> expert_act2_3_3
	expert_act2_3_3 -> expert_out2_3_3
	expert_out2_3_3 -> combine2_3
	select2_3 -> expert2_3_4 [label="if selected" style=dashed]
	expert2_3_4 -> expert_act2_3_4
	expert_act2_3_4 -> expert_out2_3_4
	expert_out2_3_4 -> combine2_3
	select2_3 -> expert2_3_5 [label="if selected" style=dashed]
	expert2_3_5 -> expert_act2_3_5
	expert_act2_3_5 -> expert_out2_3_5
	expert_out2_3_5 -> combine2_3
	select2_3 -> expert2_3_6 [label="if selected" style=dashed]
	expert2_3_6 -> expert_act2_3_6
	expert_act2_3_6 -> expert_out2_3_6
	expert_out2_3_6 -> combine2_3
	select2_3 -> expert2_3_7 [label="if selected" style=dashed]
	expert2_3_7 -> expert_act2_3_7
	expert_act2_3_7 -> expert_out2_3_7
	expert_out2_3_7 -> combine2_3
	combine2_3 -> res_moe2_3
	res_attn2_3 -> res_moe2_3
	ring_stage2_15_4 -> accum2_4
	accum2_4 -> out_proj2_4
	out_proj2_4 -> res_attn2_4
	res_moe1_4 -> res_attn2_4
	res_attn2_4 -> gate2_4
	gate2_4 -> select2_4
	select2_4 -> expert2_4_0 [label="if selected" style=dashed]
	expert2_4_0 -> expert_act2_4_0
	expert_act2_4_0 -> expert_out2_4_0
	expert_out2_4_0 -> combine2_4
	select2_4 -> expert2_4_1 [label="if selected" style=dashed]
	expert2_4_1 -> expert_act2_4_1
	expert_act2_4_1 -> expert_out2_4_1
	expert_out2_4_1 -> combine2_4
	select2_4 -> expert2_4_2 [label="if selected" style=dashed]
	expert2_4_2 -> expert_act2_4_2
	expert_act2_4_2 -> expert_out2_4_2
	expert_out2_4_2 -> combine2_4
	select2_4 -> expert2_4_3 [label="if selected" style=dashed]
	expert2_4_3 -> expert_act2_4_3
	expert_act2_4_3 -> expert_out2_4_3
	expert_out2_4_3 -> combine2_4
	select2_4 -> expert2_4_4 [label="if selected" style=dashed]
	expert2_4_4 -> expert_act2_4_4
	expert_act2_4_4 -> expert_out2_4_4
	expert_out2_4_4 -> combine2_4
	select2_4 -> expert2_4_5 [label="if selected" style=dashed]
	expert2_4_5 -> expert_act2_4_5
	expert_act2_4_5 -> expert_out2_4_5
	expert_out2_4_5 -> combine2_4
	select2_4 -> expert2_4_6 [label="if selected" style=dashed]
	expert2_4_6 -> expert_act2_4_6
	expert_act2_4_6 -> expert_out2_4_6
	expert_out2_4_6 -> combine2_4
	select2_4 -> expert2_4_7 [label="if selected" style=dashed]
	expert2_4_7 -> expert_act2_4_7
	expert_act2_4_7 -> expert_out2_4_7
	expert_out2_4_7 -> combine2_4
	combine2_4 -> res_moe2_4
	res_attn2_4 -> res_moe2_4
	ring_stage2_15_5 -> accum2_5
	accum2_5 -> out_proj2_5
	out_proj2_5 -> res_attn2_5
	res_moe1_5 -> res_attn2_5
	res_attn2_5 -> gate2_5
	gate2_5 -> select2_5
	select2_5 -> expert2_5_0 [label="if selected" style=dashed]
	expert2_5_0 -> expert_act2_5_0
	expert_act2_5_0 -> expert_out2_5_0
	expert_out2_5_0 -> combine2_5
	select2_5 -> expert2_5_1 [label="if selected" style=dashed]
	expert2_5_1 -> expert_act2_5_1
	expert_act2_5_1 -> expert_out2_5_1
	expert_out2_5_1 -> combine2_5
	select2_5 -> expert2_5_2 [label="if selected" style=dashed]
	expert2_5_2 -> expert_act2_5_2
	expert_act2_5_2 -> expert_out2_5_2
	expert_out2_5_2 -> combine2_5
	select2_5 -> expert2_5_3 [label="if selected" style=dashed]
	expert2_5_3 -> expert_act2_5_3
	expert_act2_5_3 -> expert_out2_5_3
	expert_out2_5_3 -> combine2_5
	select2_5 -> expert2_5_4 [label="if selected" style=dashed]
	expert2_5_4 -> expert_act2_5_4
	expert_act2_5_4 -> expert_out2_5_4
	expert_out2_5_4 -> combine2_5
	select2_5 -> expert2_5_5 [label="if selected" style=dashed]
	expert2_5_5 -> expert_act2_5_5
	expert_act2_5_5 -> expert_out2_5_5
	expert_out2_5_5 -> combine2_5
	select2_5 -> expert2_5_6 [label="if selected" style=dashed]
	expert2_5_6 -> expert_act2_5_6
	expert_act2_5_6 -> expert_out2_5_6
	expert_out2_5_6 -> combine2_5
	select2_5 -> expert2_5_7 [label="if selected" style=dashed]
	expert2_5_7 -> expert_act2_5_7
	expert_act2_5_7 -> expert_out2_5_7
	expert_out2_5_7 -> combine2_5
	combine2_5 -> res_moe2_5
	res_attn2_5 -> res_moe2_5
	ring_stage2_15_6 -> accum2_6
	accum2_6 -> out_proj2_6
	out_proj2_6 -> res_attn2_6
	res_moe1_6 -> res_attn2_6
	res_attn2_6 -> gate2_6
	gate2_6 -> select2_6
	select2_6 -> expert2_6_0 [label="if selected" style=dashed]
	expert2_6_0 -> expert_act2_6_0
	expert_act2_6_0 -> expert_out2_6_0
	expert_out2_6_0 -> combine2_6
	select2_6 -> expert2_6_1 [label="if selected" style=dashed]
	expert2_6_1 -> expert_act2_6_1
	expert_act2_6_1 -> expert_out2_6_1
	expert_out2_6_1 -> combine2_6
	select2_6 -> expert2_6_2 [label="if selected" style=dashed]
	expert2_6_2 -> expert_act2_6_2
	expert_act2_6_2 -> expert_out2_6_2
	expert_out2_6_2 -> combine2_6
	select2_6 -> expert2_6_3 [label="if selected" style=dashed]
	expert2_6_3 -> expert_act2_6_3
	expert_act2_6_3 -> expert_out2_6_3
	expert_out2_6_3 -> combine2_6
	select2_6 -> expert2_6_4 [label="if selected" style=dashed]
	expert2_6_4 -> expert_act2_6_4
	expert_act2_6_4 -> expert_out2_6_4
	expert_out2_6_4 -> combine2_6
	select2_6 -> expert2_6_5 [label="if selected" style=dashed]
	expert2_6_5 -> expert_act2_6_5
	expert_act2_6_5 -> expert_out2_6_5
	expert_out2_6_5 -> combine2_6
	select2_6 -> expert2_6_6 [label="if selected" style=dashed]
	expert2_6_6 -> expert_act2_6_6
	expert_act2_6_6 -> expert_out2_6_6
	expert_out2_6_6 -> combine2_6
	select2_6 -> expert2_6_7 [label="if selected" style=dashed]
	expert2_6_7 -> expert_act2_6_7
	expert_act2_6_7 -> expert_out2_6_7
	expert_out2_6_7 -> combine2_6
	combine2_6 -> res_moe2_6
	res_attn2_6 -> res_moe2_6
	ring_stage2_15_7 -> accum2_7
	accum2_7 -> out_proj2_7
	out_proj2_7 -> res_attn2_7
	res_moe1_7 -> res_attn2_7
	res_attn2_7 -> gate2_7
	gate2_7 -> select2_7
	select2_7 -> expert2_7_0 [label="if selected" style=dashed]
	expert2_7_0 -> expert_act2_7_0
	expert_act2_7_0 -> expert_out2_7_0
	expert_out2_7_0 -> combine2_7
	select2_7 -> expert2_7_1 [label="if selected" style=dashed]
	expert2_7_1 -> expert_act2_7_1
	expert_act2_7_1 -> expert_out2_7_1
	expert_out2_7_1 -> combine2_7
	select2_7 -> expert2_7_2 [label="if selected" style=dashed]
	expert2_7_2 -> expert_act2_7_2
	expert_act2_7_2 -> expert_out2_7_2
	expert_out2_7_2 -> combine2_7
	select2_7 -> expert2_7_3 [label="if selected" style=dashed]
	expert2_7_3 -> expert_act2_7_3
	expert_act2_7_3 -> expert_out2_7_3
	expert_out2_7_3 -> combine2_7
	select2_7 -> expert2_7_4 [label="if selected" style=dashed]
	expert2_7_4 -> expert_act2_7_4
	expert_act2_7_4 -> expert_out2_7_4
	expert_out2_7_4 -> combine2_7
	select2_7 -> expert2_7_5 [label="if selected" style=dashed]
	expert2_7_5 -> expert_act2_7_5
	expert_act2_7_5 -> expert_out2_7_5
	expert_out2_7_5 -> combine2_7
	select2_7 -> expert2_7_6 [label="if selected" style=dashed]
	expert2_7_6 -> expert_act2_7_6
	expert_act2_7_6 -> expert_out2_7_6
	expert_out2_7_6 -> combine2_7
	select2_7 -> expert2_7_7 [label="if selected" style=dashed]
	expert2_7_7 -> expert_act2_7_7
	expert_act2_7_7 -> expert_out2_7_7
	expert_out2_7_7 -> combine2_7
	combine2_7 -> res_moe2_7
	res_attn2_7 -> res_moe2_7
	ring_stage2_15_8 -> accum2_8
	accum2_8 -> out_proj2_8
	out_proj2_8 -> res_attn2_8
	res_moe1_8 -> res_attn2_8
	res_attn2_8 -> gate2_8
	gate2_8 -> select2_8
	select2_8 -> expert2_8_0 [label="if selected" style=dashed]
	expert2_8_0 -> expert_act2_8_0
	expert_act2_8_0 -> expert_out2_8_0
	expert_out2_8_0 -> combine2_8
	select2_8 -> expert2_8_1 [label="if selected" style=dashed]
	expert2_8_1 -> expert_act2_8_1
	expert_act2_8_1 -> expert_out2_8_1
	expert_out2_8_1 -> combine2_8
	select2_8 -> expert2_8_2 [label="if selected" style=dashed]
	expert2_8_2 -> expert_act2_8_2
	expert_act2_8_2 -> expert_out2_8_2
	expert_out2_8_2 -> combine2_8
	select2_8 -> expert2_8_3 [label="if selected" style=dashed]
	expert2_8_3 -> expert_act2_8_3
	expert_act2_8_3 -> expert_out2_8_3
	expert_out2_8_3 -> combine2_8
	select2_8 -> expert2_8_4 [label="if selected" style=dashed]
	expert2_8_4 -> expert_act2_8_4
	expert_act2_8_4 -> expert_out2_8_4
	expert_out2_8_4 -> combine2_8
	select2_8 -> expert2_8_5 [label="if selected" style=dashed]
	expert2_8_5 -> expert_act2_8_5
	expert_act2_8_5 -> expert_out2_8_5
	expert_out2_8_5 -> combine2_8
	select2_8 -> expert2_8_6 [label="if selected" style=dashed]
	expert2_8_6 -> expert_act2_8_6
	expert_act2_8_6 -> expert_out2_8_6
	expert_out2_8_6 -> combine2_8
	select2_8 -> expert2_8_7 [label="if selected" style=dashed]
	expert2_8_7 -> expert_act2_8_7
	expert_act2_8_7 -> expert_out2_8_7
	expert_out2_8_7 -> combine2_8
	combine2_8 -> res_moe2_8
	res_attn2_8 -> res_moe2_8
	ring_stage2_15_9 -> accum2_9
	accum2_9 -> out_proj2_9
	out_proj2_9 -> res_attn2_9
	res_moe1_9 -> res_attn2_9
	res_attn2_9 -> gate2_9
	gate2_9 -> select2_9
	select2_9 -> expert2_9_0 [label="if selected" style=dashed]
	expert2_9_0 -> expert_act2_9_0
	expert_act2_9_0 -> expert_out2_9_0
	expert_out2_9_0 -> combine2_9
	select2_9 -> expert2_9_1 [label="if selected" style=dashed]
	expert2_9_1 -> expert_act2_9_1
	expert_act2_9_1 -> expert_out2_9_1
	expert_out2_9_1 -> combine2_9
	select2_9 -> expert2_9_2 [label="if selected" style=dashed]
	expert2_9_2 -> expert_act2_9_2
	expert_act2_9_2 -> expert_out2_9_2
	expert_out2_9_2 -> combine2_9
	select2_9 -> expert2_9_3 [label="if selected" style=dashed]
	expert2_9_3 -> expert_act2_9_3
	expert_act2_9_3 -> expert_out2_9_3
	expert_out2_9_3 -> combine2_9
	select2_9 -> expert2_9_4 [label="if selected" style=dashed]
	expert2_9_4 -> expert_act2_9_4
	expert_act2_9_4 -> expert_out2_9_4
	expert_out2_9_4 -> combine2_9
	select2_9 -> expert2_9_5 [label="if selected" style=dashed]
	expert2_9_5 -> expert_act2_9_5
	expert_act2_9_5 -> expert_out2_9_5
	expert_out2_9_5 -> combine2_9
	select2_9 -> expert2_9_6 [label="if selected" style=dashed]
	expert2_9_6 -> expert_act2_9_6
	expert_act2_9_6 -> expert_out2_9_6
	expert_out2_9_6 -> combine2_9
	select2_9 -> expert2_9_7 [label="if selected" style=dashed]
	expert2_9_7 -> expert_act2_9_7
	expert_act2_9_7 -> expert_out2_9_7
	expert_out2_9_7 -> combine2_9
	combine2_9 -> res_moe2_9
	res_attn2_9 -> res_moe2_9
	ring_stage2_15_10 -> accum2_10
	accum2_10 -> out_proj2_10
	out_proj2_10 -> res_attn2_10
	res_moe1_10 -> res_attn2_10
	res_attn2_10 -> gate2_10
	gate2_10 -> select2_10
	select2_10 -> expert2_10_0 [label="if selected" style=dashed]
	expert2_10_0 -> expert_act2_10_0
	expert_act2_10_0 -> expert_out2_10_0
	expert_out2_10_0 -> combine2_10
	select2_10 -> expert2_10_1 [label="if selected" style=dashed]
	expert2_10_1 -> expert_act2_10_1
	expert_act2_10_1 -> expert_out2_10_1
	expert_out2_10_1 -> combine2_10
	select2_10 -> expert2_10_2 [label="if selected" style=dashed]
	expert2_10_2 -> expert_act2_10_2
	expert_act2_10_2 -> expert_out2_10_2
	expert_out2_10_2 -> combine2_10
	select2_10 -> expert2_10_3 [label="if selected" style=dashed]
	expert2_10_3 -> expert_act2_10_3
	expert_act2_10_3 -> expert_out2_10_3
	expert_out2_10_3 -> combine2_10
	select2_10 -> expert2_10_4 [label="if selected" style=dashed]
	expert2_10_4 -> expert_act2_10_4
	expert_act2_10_4 -> expert_out2_10_4
	expert_out2_10_4 -> combine2_10
	select2_10 -> expert2_10_5 [label="if selected" style=dashed]
	expert2_10_5 -> expert_act2_10_5
	expert_act2_10_5 -> expert_out2_10_5
	expert_out2_10_5 -> combine2_10
	select2_10 -> expert2_10_6 [label="if selected" style=dashed]
	expert2_10_6 -> expert_act2_10_6
	expert_act2_10_6 -> expert_out2_10_6
	expert_out2_10_6 -> combine2_10
	select2_10 -> expert2_10_7 [label="if selected" style=dashed]
	expert2_10_7 -> expert_act2_10_7
	expert_act2_10_7 -> expert_out2_10_7
	expert_out2_10_7 -> combine2_10
	combine2_10 -> res_moe2_10
	res_attn2_10 -> res_moe2_10
	ring_stage2_15_11 -> accum2_11
	accum2_11 -> out_proj2_11
	out_proj2_11 -> res_attn2_11
	res_moe1_11 -> res_attn2_11
	res_attn2_11 -> gate2_11
	gate2_11 -> select2_11
	select2_11 -> expert2_11_0 [label="if selected" style=dashed]
	expert2_11_0 -> expert_act2_11_0
	expert_act2_11_0 -> expert_out2_11_0
	expert_out2_11_0 -> combine2_11
	select2_11 -> expert2_11_1 [label="if selected" style=dashed]
	expert2_11_1 -> expert_act2_11_1
	expert_act2_11_1 -> expert_out2_11_1
	expert_out2_11_1 -> combine2_11
	select2_11 -> expert2_11_2 [label="if selected" style=dashed]
	expert2_11_2 -> expert_act2_11_2
	expert_act2_11_2 -> expert_out2_11_2
	expert_out2_11_2 -> combine2_11
	select2_11 -> expert2_11_3 [label="if selected" style=dashed]
	expert2_11_3 -> expert_act2_11_3
	expert_act2_11_3 -> expert_out2_11_3
	expert_out2_11_3 -> combine2_11
	select2_11 -> expert2_11_4 [label="if selected" style=dashed]
	expert2_11_4 -> expert_act2_11_4
	expert_act2_11_4 -> expert_out2_11_4
	expert_out2_11_4 -> combine2_11
	select2_11 -> expert2_11_5 [label="if selected" style=dashed]
	expert2_11_5 -> expert_act2_11_5
	expert_act2_11_5 -> expert_out2_11_5
	expert_out2_11_5 -> combine2_11
	select2_11 -> expert2_11_6 [label="if selected" style=dashed]
	expert2_11_6 -> expert_act2_11_6
	expert_act2_11_6 -> expert_out2_11_6
	expert_out2_11_6 -> combine2_11
	select2_11 -> expert2_11_7 [label="if selected" style=dashed]
	expert2_11_7 -> expert_act2_11_7
	expert_act2_11_7 -> expert_out2_11_7
	expert_out2_11_7 -> combine2_11
	combine2_11 -> res_moe2_11
	res_attn2_11 -> res_moe2_11
	ring_stage2_15_12 -> accum2_12
	accum2_12 -> out_proj2_12
	out_proj2_12 -> res_attn2_12
	res_moe1_12 -> res_attn2_12
	res_attn2_12 -> gate2_12
	gate2_12 -> select2_12
	select2_12 -> expert2_12_0 [label="if selected" style=dashed]
	expert2_12_0 -> expert_act2_12_0
	expert_act2_12_0 -> expert_out2_12_0
	expert_out2_12_0 -> combine2_12
	select2_12 -> expert2_12_1 [label="if selected" style=dashed]
	expert2_12_1 -> expert_act2_12_1
	expert_act2_12_1 -> expert_out2_12_1
	expert_out2_12_1 -> combine2_12
	select2_12 -> expert2_12_2 [label="if selected" style=dashed]
	expert2_12_2 -> expert_act2_12_2
	expert_act2_12_2 -> expert_out2_12_2
	expert_out2_12_2 -> combine2_12
	select2_12 -> expert2_12_3 [label="if selected" style=dashed]
	expert2_12_3 -> expert_act2_12_3
	expert_act2_12_3 -> expert_out2_12_3
	expert_out2_12_3 -> combine2_12
	select2_12 -> expert2_12_4 [label="if selected" style=dashed]
	expert2_12_4 -> expert_act2_12_4
	expert_act2_12_4 -> expert_out2_12_4
	expert_out2_12_4 -> combine2_12
	select2_12 -> expert2_12_5 [label="if selected" style=dashed]
	expert2_12_5 -> expert_act2_12_5
	expert_act2_12_5 -> expert_out2_12_5
	expert_out2_12_5 -> combine2_12
	select2_12 -> expert2_12_6 [label="if selected" style=dashed]
	expert2_12_6 -> expert_act2_12_6
	expert_act2_12_6 -> expert_out2_12_6
	expert_out2_12_6 -> combine2_12
	select2_12 -> expert2_12_7 [label="if selected" style=dashed]
	expert2_12_7 -> expert_act2_12_7
	expert_act2_12_7 -> expert_out2_12_7
	expert_out2_12_7 -> combine2_12
	combine2_12 -> res_moe2_12
	res_attn2_12 -> res_moe2_12
	ring_stage2_15_13 -> accum2_13
	accum2_13 -> out_proj2_13
	out_proj2_13 -> res_attn2_13
	res_moe1_13 -> res_attn2_13
	res_attn2_13 -> gate2_13
	gate2_13 -> select2_13
	select2_13 -> expert2_13_0 [label="if selected" style=dashed]
	expert2_13_0 -> expert_act2_13_0
	expert_act2_13_0 -> expert_out2_13_0
	expert_out2_13_0 -> combine2_13
	select2_13 -> expert2_13_1 [label="if selected" style=dashed]
	expert2_13_1 -> expert_act2_13_1
	expert_act2_13_1 -> expert_out2_13_1
	expert_out2_13_1 -> combine2_13
	select2_13 -> expert2_13_2 [label="if selected" style=dashed]
	expert2_13_2 -> expert_act2_13_2
	expert_act2_13_2 -> expert_out2_13_2
	expert_out2_13_2 -> combine2_13
	select2_13 -> expert2_13_3 [label="if selected" style=dashed]
	expert2_13_3 -> expert_act2_13_3
	expert_act2_13_3 -> expert_out2_13_3
	expert_out2_13_3 -> combine2_13
	select2_13 -> expert2_13_4 [label="if selected" style=dashed]
	expert2_13_4 -> expert_act2_13_4
	expert_act2_13_4 -> expert_out2_13_4
	expert_out2_13_4 -> combine2_13
	select2_13 -> expert2_13_5 [label="if selected" style=dashed]
	expert2_13_5 -> expert_act2_13_5
	expert_act2_13_5 -> expert_out2_13_5
	expert_out2_13_5 -> combine2_13
	select2_13 -> expert2_13_6 [label="if selected" style=dashed]
	expert2_13_6 -> expert_act2_13_6
	expert_act2_13_6 -> expert_out2_13_6
	expert_out2_13_6 -> combine2_13
	select2_13 -> expert2_13_7 [label="if selected" style=dashed]
	expert2_13_7 -> expert_act2_13_7
	expert_act2_13_7 -> expert_out2_13_7
	expert_out2_13_7 -> combine2_13
	combine2_13 -> res_moe2_13
	res_attn2_13 -> res_moe2_13
	ring_stage2_15_14 -> accum2_14
	accum2_14 -> out_proj2_14
	out_proj2_14 -> res_attn2_14
	res_moe1_14 -> res_attn2_14
	res_attn2_14 -> gate2_14
	gate2_14 -> select2_14
	select2_14 -> expert2_14_0 [label="if selected" style=dashed]
	expert2_14_0 -> expert_act2_14_0
	expert_act2_14_0 -> expert_out2_14_0
	expert_out2_14_0 -> combine2_14
	select2_14 -> expert2_14_1 [label="if selected" style=dashed]
	expert2_14_1 -> expert_act2_14_1
	expert_act2_14_1 -> expert_out2_14_1
	expert_out2_14_1 -> combine2_14
	select2_14 -> expert2_14_2 [label="if selected" style=dashed]
	expert2_14_2 -> expert_act2_14_2
	expert_act2_14_2 -> expert_out2_14_2
	expert_out2_14_2 -> combine2_14
	select2_14 -> expert2_14_3 [label="if selected" style=dashed]
	expert2_14_3 -> expert_act2_14_3
	expert_act2_14_3 -> expert_out2_14_3
	expert_out2_14_3 -> combine2_14
	select2_14 -> expert2_14_4 [label="if selected" style=dashed]
	expert2_14_4 -> expert_act2_14_4
	expert_act2_14_4 -> expert_out2_14_4
	expert_out2_14_4 -> combine2_14
	select2_14 -> expert2_14_5 [label="if selected" style=dashed]
	expert2_14_5 -> expert_act2_14_5
	expert_act2_14_5 -> expert_out2_14_5
	expert_out2_14_5 -> combine2_14
	select2_14 -> expert2_14_6 [label="if selected" style=dashed]
	expert2_14_6 -> expert_act2_14_6
	expert_act2_14_6 -> expert_out2_14_6
	expert_out2_14_6 -> combine2_14
	select2_14 -> expert2_14_7 [label="if selected" style=dashed]
	expert2_14_7 -> expert_act2_14_7
	expert_act2_14_7 -> expert_out2_14_7
	expert_out2_14_7 -> combine2_14
	combine2_14 -> res_moe2_14
	res_attn2_14 -> res_moe2_14
	ring_stage2_15_15 -> accum2_15
	accum2_15 -> out_proj2_15
	out_proj2_15 -> res_attn2_15
	res_moe1_15 -> res_attn2_15
	res_attn2_15 -> gate2_15
	gate2_15 -> select2_15
	select2_15 -> expert2_15_0 [label="if selected" style=dashed]
	expert2_15_0 -> expert_act2_15_0
	expert_act2_15_0 -> expert_out2_15_0
	expert_out2_15_0 -> combine2_15
	select2_15 -> expert2_15_1 [label="if selected" style=dashed]
	expert2_15_1 -> expert_act2_15_1
	expert_act2_15_1 -> expert_out2_15_1
	expert_out2_15_1 -> combine2_15
	select2_15 -> expert2_15_2 [label="if selected" style=dashed]
	expert2_15_2 -> expert_act2_15_2
	expert_act2_15_2 -> expert_out2_15_2
	expert_out2_15_2 -> combine2_15
	select2_15 -> expert2_15_3 [label="if selected" style=dashed]
	expert2_15_3 -> expert_act2_15_3
	expert_act2_15_3 -> expert_out2_15_3
	expert_out2_15_3 -> combine2_15
	select2_15 -> expert2_15_4 [label="if selected" style=dashed]
	expert2_15_4 -> expert_act2_15_4
	expert_act2_15_4 -> expert_out2_15_4
	expert_out2_15_4 -> combine2_15
	select2_15 -> expert2_15_5 [label="if selected" style=dashed]
	expert2_15_5 -> expert_act2_15_5
	expert_act2_15_5 -> expert_out2_15_5
	expert_out2_15_5 -> combine2_15
	select2_15 -> expert2_15_6 [label="if selected" style=dashed]
	expert2_15_6 -> expert_act2_15_6
	expert_act2_15_6 -> expert_out2_15_6
	expert_out2_15_6 -> combine2_15
	select2_15 -> expert2_15_7 [label="if selected" style=dashed]
	expert2_15_7 -> expert_act2_15_7
	expert_act2_15_7 -> expert_out2_15_7
	expert_out2_15_7 -> combine2_15
	combine2_15 -> res_moe2_15
	res_attn2_15 -> res_moe2_15
	res_moe2_0 -> qkv3_0
	res_moe2_1 -> qkv3_1
	res_moe2_2 -> qkv3_2
	res_moe2_3 -> qkv3_3
	res_moe2_4 -> qkv3_4
	res_moe2_5 -> qkv3_5
	res_moe2_6 -> qkv3_6
	res_moe2_7 -> qkv3_7
	res_moe2_8 -> qkv3_8
	res_moe2_9 -> qkv3_9
	res_moe2_10 -> qkv3_10
	res_moe2_11 -> qkv3_11
	res_moe2_12 -> qkv3_12
	res_moe2_13 -> qkv3_13
	res_moe2_14 -> qkv3_14
	res_moe2_15 -> qkv3_15
	qkv3_0 -> ring_stage3_0_0
	qkv3_1 -> ring_stage3_0_1
	qkv3_2 -> ring_stage3_0_2
	qkv3_3 -> ring_stage3_0_3
	qkv3_4 -> ring_stage3_0_4
	qkv3_5 -> ring_stage3_0_5
	qkv3_6 -> ring_stage3_0_6
	qkv3_7 -> ring_stage3_0_7
	qkv3_8 -> ring_stage3_0_8
	qkv3_9 -> ring_stage3_0_9
	qkv3_10 -> ring_stage3_0_10
	qkv3_11 -> ring_stage3_0_11
	qkv3_12 -> ring_stage3_0_12
	qkv3_13 -> ring_stage3_0_13
	qkv3_14 -> ring_stage3_0_14
	qkv3_15 -> ring_stage3_0_15
	ring_stage3_0_0 -> kv_send3_0_0
	ring_stage3_0_1 -> kv_send3_0_1
	ring_stage3_0_2 -> kv_send3_0_2
	ring_stage3_0_3 -> kv_send3_0_3
	ring_stage3_0_4 -> kv_send3_0_4
	ring_stage3_0_5 -> kv_send3_0_5
	ring_stage3_0_6 -> kv_send3_0_6
	ring_stage3_0_7 -> kv_send3_0_7
	ring_stage3_0_8 -> kv_send3_0_8
	ring_stage3_0_9 -> kv_send3_0_9
	ring_stage3_0_10 -> kv_send3_0_10
	ring_stage3_0_11 -> kv_send3_0_11
	ring_stage3_0_12 -> kv_send3_0_12
	ring_stage3_0_13 -> kv_send3_0_13
	ring_stage3_0_14 -> kv_send3_0_14
	ring_stage3_0_15 -> kv_send3_0_15
	ring_stage3_0_0 -> ring_stage3_1_0
	kv_send3_0_15 -> ring_stage3_1_0
	ring_stage3_1_0 -> kv_send3_1_0
	ring_stage3_0_1 -> ring_stage3_1_1
	kv_send3_0_0 -> ring_stage3_1_1
	ring_stage3_1_1 -> kv_send3_1_1
	ring_stage3_0_2 -> ring_stage3_1_2
	kv_send3_0_1 -> ring_stage3_1_2
	ring_stage3_1_2 -> kv_send3_1_2
	ring_stage3_0_3 -> ring_stage3_1_3
	kv_send3_0_2 -> ring_stage3_1_3
	ring_stage3_1_3 -> kv_send3_1_3
	ring_stage3_0_4 -> ring_stage3_1_4
	kv_send3_0_3 -> ring_stage3_1_4
	ring_stage3_1_4 -> kv_send3_1_4
	ring_stage3_0_5 -> ring_stage3_1_5
	kv_send3_0_4 -> ring_stage3_1_5
	ring_stage3_1_5 -> kv_send3_1_5
	ring_stage3_0_6 -> ring_stage3_1_6
	kv_send3_0_5 -> ring_stage3_1_6
	ring_stage3_1_6 -> kv_send3_1_6
	ring_stage3_0_7 -> ring_stage3_1_7
	kv_send3_0_6 -> ring_stage3_1_7
	ring_stage3_1_7 -> kv_send3_1_7
	ring_stage3_0_8 -> ring_stage3_1_8
	kv_send3_0_7 -> ring_stage3_1_8
	ring_stage3_1_8 -> kv_send3_1_8
	ring_stage3_0_9 -> ring_stage3_1_9
	kv_send3_0_8 -> ring_stage3_1_9
	ring_stage3_1_9 -> kv_send3_1_9
	ring_stage3_0_10 -> ring_stage3_1_10
	kv_send3_0_9 -> ring_stage3_1_10
	ring_stage3_1_10 -> kv_send3_1_10
	ring_stage3_0_11 -> ring_stage3_1_11
	kv_send3_0_10 -> ring_stage3_1_11
	ring_stage3_1_11 -> kv_send3_1_11
	ring_stage3_0_12 -> ring_stage3_1_12
	kv_send3_0_11 -> ring_stage3_1_12
	ring_stage3_1_12 -> kv_send3_1_12
	ring_stage3_0_13 -> ring_stage3_1_13
	kv_send3_0_12 -> ring_stage3_1_13
	ring_stage3_1_13 -> kv_send3_1_13
	ring_stage3_0_14 -> ring_stage3_1_14
	kv_send3_0_13 -> ring_stage3_1_14
	ring_stage3_1_14 -> kv_send3_1_14
	ring_stage3_0_15 -> ring_stage3_1_15
	kv_send3_0_14 -> ring_stage3_1_15
	ring_stage3_1_15 -> kv_send3_1_15
	ring_stage3_1_0 -> ring_stage3_2_0
	kv_send3_1_15 -> ring_stage3_2_0
	ring_stage3_2_0 -> kv_send3_2_0
	ring_stage3_1_1 -> ring_stage3_2_1
	kv_send3_1_0 -> ring_stage3_2_1
	ring_stage3_2_1 -> kv_send3_2_1
	ring_stage3_1_2 -> ring_stage3_2_2
	kv_send3_1_1 -> ring_stage3_2_2
	ring_stage3_2_2 -> kv_send3_2_2
	ring_stage3_1_3 -> ring_stage3_2_3
	kv_send3_1_2 -> ring_stage3_2_3
	ring_stage3_2_3 -> kv_send3_2_3
	ring_stage3_1_4 -> ring_stage3_2_4
	kv_send3_1_3 -> ring_stage3_2_4
	ring_stage3_2_4 -> kv_send3_2_4
	ring_stage3_1_5 -> ring_stage3_2_5
	kv_send3_1_4 -> ring_stage3_2_5
	ring_stage3_2_5 -> kv_send3_2_5
	ring_stage3_1_6 -> ring_stage3_2_6
	kv_send3_1_5 -> ring_stage3_2_6
	ring_stage3_2_6 -> kv_send3_2_6
	ring_stage3_1_7 -> ring_stage3_2_7
	kv_send3_1_6 -> ring_stage3_2_7
	ring_stage3_2_7 -> kv_send3_2_7
	ring_stage3_1_8 -> ring_stage3_2_8
	kv_send3_1_7 -> ring_stage3_2_8
	ring_stage3_2_8 -> kv_send3_2_8
	ring_stage3_1_9 -> ring_stage3_2_9
	kv_send3_1_8 -> ring_stage3_2_9
	ring_stage3_2_9 -> kv_send3_2_9
	ring_stage3_1_10 -> ring_stage3_2_10
	kv_send3_1_9 -> ring_stage3_2_10
	ring_stage3_2_10 -> kv_send3_2_10
	ring_stage3_1_11 -> ring_stage3_2_11
	kv_send3_1_10 -> ring_stage3_2_11
	ring_stage3_2_11 -> kv_send3_2_11
	ring_stage3_1_12 -> ring_stage3_2_12
	kv_send3_1_11 -> ring_stage3_2_12
	ring_stage3_2_12 -> kv_send3_2_12
	ring_stage3_1_13 -> ring_stage3_2_13
	kv_send3_1_12 -> ring_stage3_2_13
	ring_stage3_2_13 -> kv_send3_2_13
	ring_stage3_1_14 -> ring_stage3_2_14
	kv_send3_1_13 -> ring_stage3_2_14
	ring_stage3_2_14 -> kv_send3_2_14
	ring_stage3_1_15 -> ring_stage3_2_15
	kv_send3_1_14 -> ring_stage3_2_15
	ring_stage3_2_15 -> kv_send3_2_15
	ring_stage3_2_0 -> ring_stage3_3_0
	kv_send3_2_15 -> ring_stage3_3_0
	ring_stage3_3_0 -> kv_send3_3_0
	ring_stage3_2_1 -> ring_stage3_3_1
	kv_send3_2_0 -> ring_stage3_3_1
	ring_stage3_3_1 -> kv_send3_3_1
	ring_stage3_2_2 -> ring_stage3_3_2
	kv_send3_2_1 -> ring_stage3_3_2
	ring_stage3_3_2 -> kv_send3_3_2
	ring_stage3_2_3 -> ring_stage3_3_3
	kv_send3_2_2 -> ring_stage3_3_3
	ring_stage3_3_3 -> kv_send3_3_3
	ring_stage3_2_4 -> ring_stage3_3_4
	kv_send3_2_3 -> ring_stage3_3_4
	ring_stage3_3_4 -> kv_send3_3_4
	ring_stage3_2_5 -> ring_stage3_3_5
	kv_send3_2_4 -> ring_stage3_3_5
	ring_stage3_3_5 -> kv_send3_3_5
	ring_stage3_2_6 -> ring_stage3_3_6
	kv_send3_2_5 -> ring_stage3_3_6
	ring_stage3_3_6 -> kv_send3_3_6
	ring_stage3_2_7 -> ring_stage3_3_7
	kv_send3_2_6 -> ring_stage3_3_7
	ring_stage3_3_7 -> kv_send3_3_7
	ring_stage3_2_8 -> ring_stage3_3_8
	kv_send3_2_7 -> ring_stage3_3_8
	ring_stage3_3_8 -> kv_send3_3_8
	ring_stage3_2_9 -> ring_stage3_3_9
	kv_send3_2_8 -> ring_stage3_3_9
	ring_stage3_3_9 -> kv_send3_3_9
	ring_stage3_2_10 -> ring_stage3_3_10
	kv_send3_2_9 -> ring_stage3_3_10
	ring_stage3_3_10 -> kv_send3_3_10
	ring_stage3_2_11 -> ring_stage3_3_11
	kv_send3_2_10 -> ring_stage3_3_11
	ring_stage3_3_11 -> kv_send3_3_11
	ring_stage3_2_12 -> ring_stage3_3_12
	kv_send3_2_11 -> ring_stage3_3_12
	ring_stage3_3_12 -> kv_send3_3_12
	ring_stage3_2_13 -> ring_stage3_3_13
	kv_send3_2_12 -> ring_stage3_3_13
	ring_stage3_3_13 -> kv_send3_3_13
	ring_stage3_2_14 -> ring_stage3_3_14
	kv_send3_2_13 -> ring_stage3_3_14
	ring_stage3_3_14 -> kv_send3_3_14
	ring_stage3_2_15 -> ring_stage3_3_15
	kv_send3_2_14 -> ring_stage3_3_15
	ring_stage3_3_15 -> kv_send3_3_15
	ring_stage3_3_0 -> ring_stage3_4_0
	kv_send3_3_15 -> ring_stage3_4_0
	ring_stage3_4_0 -> kv_send3_4_0
	ring_stage3_3_1 -> ring_stage3_4_1
	kv_send3_3_0 -> ring_stage3_4_1
	ring_stage3_4_1 -> kv_send3_4_1
	ring_stage3_3_2 -> ring_stage3_4_2
	kv_send3_3_1 -> ring_stage3_4_2
	ring_stage3_4_2 -> kv_send3_4_2
	ring_stage3_3_3 -> ring_stage3_4_3
	kv_send3_3_2 -> ring_stage3_4_3
	ring_stage3_4_3 -> kv_send3_4_3
	ring_stage3_3_4 -> ring_stage3_4_4
	kv_send3_3_3 -> ring_stage3_4_4
	ring_stage3_4_4 -> kv_send3_4_4
	ring_stage3_3_5 -> ring_stage3_4_5
	kv_send3_3_4 -> ring_stage3_4_5
	ring_stage3_4_5 -> kv_send3_4_5
	ring_stage3_3_6 -> ring_stage3_4_6
	kv_send3_3_5 -> ring_stage3_4_6
	ring_stage3_4_6 -> kv_send3_4_6
	ring_stage3_3_7 -> ring_stage3_4_7
	kv_send3_3_6 -> ring_stage3_4_7
	ring_stage3_4_7 -> kv_send3_4_7
	ring_stage3_3_8 -> ring_stage3_4_8
	kv_send3_3_7 -> ring_stage3_4_8
	ring_stage3_4_8 -> kv_send3_4_8
	ring_stage3_3_9 -> ring_stage3_4_9
	kv_send3_3_8 -> ring_stage3_4_9
	ring_stage3_4_9 -> kv_send3_4_9
	ring_stage3_3_10 -> ring_stage3_4_10
	kv_send3_3_9 -> ring_stage3_4_10
	ring_stage3_4_10 -> kv_send3_4_10
	ring_stage3_3_11 -> ring_stage3_4_11
	kv_send3_3_10 -> ring_stage3_4_11
	ring_stage3_4_11 -> kv_send3_4_11
	ring_stage3_3_12 -> ring_stage3_4_12
	kv_send3_3_11 -> ring_stage3_4_12
	ring_stage3_4_12 -> kv_send3_4_12
	ring_stage3_3_13 -> ring_stage3_4_13
	kv_send3_3_12 -> ring_stage3_4_13
	ring_stage3_4_13 -> kv_send3_4_13
	ring_stage3_3_14 -> ring_stage3_4_14
	kv_send3_3_13 -> ring_stage3_4_14
	ring_stage3_4_14 -> kv_send3_4_14
	ring_stage3_3_15 -> ring_stage3_4_15
	kv_send3_3_14 -> ring_stage3_4_15
	ring_stage3_4_15 -> kv_send3_4_15
	ring_stage3_4_0 -> ring_stage3_5_0
	kv_send3_4_15 -> ring_stage3_5_0
	ring_stage3_5_0 -> kv_send3_5_0
	ring_stage3_4_1 -> ring_stage3_5_1
	kv_send3_4_0 -> ring_stage3_5_1
	ring_stage3_5_1 -> kv_send3_5_1
	ring_stage3_4_2 -> ring_stage3_5_2
	kv_send3_4_1 -> ring_stage3_5_2
	ring_stage3_5_2 -> kv_send3_5_2
	ring_stage3_4_3 -> ring_stage3_5_3
	kv_send3_4_2 -> ring_stage3_5_3
	ring_stage3_5_3 -> kv_send3_5_3
	ring_stage3_4_4 -> ring_stage3_5_4
	kv_send3_4_3 -> ring_stage3_5_4
	ring_stage3_5_4 -> kv_send3_5_4
	ring_stage3_4_5 -> ring_stage3_5_5
	kv_send3_4_4 -> ring_stage3_5_5
	ring_stage3_5_5 -> kv_send3_5_5
	ring_stage3_4_6 -> ring_stage3_5_6
	kv_send3_4_5 -> ring_stage3_5_6
	ring_stage3_5_6 -> kv_send3_5_6
	ring_stage3_4_7 -> ring_stage3_5_7
	kv_send3_4_6 -> ring_stage3_5_7
	ring_stage3_5_7 -> kv_send3_5_7
	ring_stage3_4_8 -> ring_stage3_5_8
	kv_send3_4_7 -> ring_stage3_5_8
	ring_stage3_5_8 -> kv_send3_5_8
	ring_stage3_4_9 -> ring_stage3_5_9
	kv_send3_4_8 -> ring_stage3_5_9
	ring_stage3_5_9 -> kv_send3_5_9
	ring_stage3_4_10 -> ring_stage3_5_10
	kv_send3_4_9 -> ring_stage3_5_10
	ring_stage3_5_10 -> kv_send3_5_10
	ring_stage3_4_11 -> ring_stage3_5_11
	kv_send3_4_10 -> ring_stage3_5_11
	ring_stage3_5_11 -> kv_send3_5_11
	ring_stage3_4_12 -> ring_stage3_5_12
	kv_send3_4_11 -> ring_stage3_5_12
	ring_stage3_5_12 -> kv_send3_5_12
	ring_stage3_4_13 -> ring_stage3_5_13
	kv_send3_4_12 -> ring_stage3_5_13
	ring_stage3_5_13 -> kv_send3_5_13
	ring_stage3_4_14 -> ring_stage3_5_14
	kv_send3_4_13 -> ring_stage3_5_14
	ring_stage3_5_14 -> kv_send3_5_14
	ring_stage3_4_15 -> ring_stage3_5_15
	kv_send3_4_14 -> ring_stage3_5_15
	ring_stage3_5_15 -> kv_send3_5_15
	ring_stage3_5_0 -> ring_stage3_6_0
	kv_send3_5_15 -> ring_stage3_6_0
	ring_stage3_6_0 -> kv_send3_6_0
	ring_stage3_5_1 -> ring_stage3_6_1
	kv_send3_5_0 -> ring_stage3_6_1
	ring_stage3_6_1 -> kv_send3_6_1
	ring_stage3_5_2 -> ring_stage3_6_2
	kv_send3_5_1 -> ring_stage3_6_2
	ring_stage3_6_2 -> kv_send3_6_2
	ring_stage3_5_3 -> ring_stage3_6_3
	kv_send3_5_2 -> ring_stage3_6_3
	ring_stage3_6_3 -> kv_send3_6_3
	ring_stage3_5_4 -> ring_stage3_6_4
	kv_send3_5_3 -> ring_stage3_6_4
	ring_stage3_6_4 -> kv_send3_6_4
	ring_stage3_5_5 -> ring_stage3_6_5
	kv_send3_5_4 -> ring_stage3_6_5
	ring_stage3_6_5 -> kv_send3_6_5
	ring_stage3_5_6 -> ring_stage3_6_6
	kv_send3_5_5 -> ring_stage3_6_6
	ring_stage3_6_6 -> kv_send3_6_6
	ring_stage3_5_7 -> ring_stage3_6_7
	kv_send3_5_6 -> ring_stage3_6_7
	ring_stage3_6_7 -> kv_send3_6_7
	ring_stage3_5_8 -> ring_stage3_6_8
	kv_send3_5_7 -> ring_stage3_6_8
	ring_stage3_6_8 -> kv_send3_6_8
	ring_stage3_5_9 -> ring_stage3_6_9
	kv_send3_5_8 -> ring_stage3_6_9
	ring_stage3_6_9 -> kv_send3_6_9
	ring_stage3_5_10 -> ring_stage3_6_10
	kv_send3_5_9 -> ring_stage3_6_10
	ring_stage3_6_10 -> kv_send3_6_10
	ring_stage3_5_11 -> ring_stage3_6_11
	kv_send3_5_10 -> ring_stage3_6_11
	ring_stage3_6_11 -> kv_send3_6_11
	ring_stage3_5_12 -> ring_stage3_6_12
	kv_send3_5_11 -> ring_stage3_6_12
	ring_stage3_6_12 -> kv_send3_6_12
	ring_stage3_5_13 -> ring_stage3_6_13
	kv_send3_5_12 -> ring_stage3_6_13
	ring_stage3_6_13 -> kv_send3_6_13
	ring_stage3_5_14 -> ring_stage3_6_14
	kv_send3_5_13 -> ring_stage3_6_14
	ring_stage3_6_14 -> kv_send3_6_14
	ring_stage3_5_15 -> ring_stage3_6_15
	kv_send3_5_14 -> ring_stage3_6_15
	ring_stage3_6_15 -> kv_send3_6_15
	ring_stage3_6_0 -> ring_stage3_7_0
	kv_send3_6_15 -> ring_stage3_7_0
	ring_stage3_7_0 -> kv_send3_7_0
	ring_stage3_6_1 -> ring_stage3_7_1
	kv_send3_6_0 -> ring_stage3_7_1
	ring_stage3_7_1 -> kv_send3_7_1
	ring_stage3_6_2 -> ring_stage3_7_2
	kv_send3_6_1 -> ring_stage3_7_2
	ring_stage3_7_2 -> kv_send3_7_2
	ring_stage3_6_3 -> ring_stage3_7_3
	kv_send3_6_2 -> ring_stage3_7_3
	ring_stage3_7_3 -> kv_send3_7_3
	ring_stage3_6_4 -> ring_stage3_7_4
	kv_send3_6_3 -> ring_stage3_7_4
	ring_stage3_7_4 -> kv_send3_7_4
	ring_stage3_6_5 -> ring_stage3_7_5
	kv_send3_6_4 -> ring_stage3_7_5
	ring_stage3_7_5 -> kv_send3_7_5
	ring_stage3_6_6 -> ring_stage3_7_6
	kv_send3_6_5 -> ring_stage3_7_6
	ring_stage3_7_6 -> kv_send3_7_6
	ring_stage3_6_7 -> ring_stage3_7_7
	kv_send3_6_6 -> ring_stage3_7_7
	ring_stage3_7_7 -> kv_send3_7_7
	ring_stage3_6_8 -> ring_stage3_7_8
	kv_send3_6_7 -> ring_stage3_7_8
	ring_stage3_7_8 -> kv_send3_7_8
	ring_stage3_6_9 -> ring_stage3_7_9
	kv_send3_6_8 -> ring_stage3_7_9
	ring_stage3_7_9 -> kv_send3_7_9
	ring_stage3_6_10 -> ring_stage3_7_10
	kv_send3_6_9 -> ring_stage3_7_10
	ring_stage3_7_10 -> kv_send3_7_10
	ring_stage3_6_11 -> ring_stage3_7_11
	kv_send3_6_10 -> ring_stage3_7_11
	ring_stage3_7_11 -> kv_send3_7_11
	ring_stage3_6_12 -> ring_stage3_7_12
	kv_send3_6_11 -> ring_stage3_7_12
	ring_stage3_7_12 -> kv_send3_7_12
	ring_stage3_6_13 -> ring_stage3_7_13
	kv_send3_6_12 -> ring_stage3_7_13
	ring_stage3_7_13 -> kv_send3_7_13
	ring_stage3_6_14 -> ring_stage3_7_14
	kv_send3_6_13 -> ring_stage3_7_14
	ring_stage3_7_14 -> kv_send3_7_14
	ring_stage3_6_15 -> ring_stage3_7_15
	kv_send3_6_14 -> ring_stage3_7_15
	ring_stage3_7_15 -> kv_send3_7_15
	ring_stage3_7_0 -> ring_stage3_8_0
	kv_send3_7_15 -> ring_stage3_8_0
	ring_stage3_8_0 -> kv_send3_8_0
	ring_stage3_7_1 -> ring_stage3_8_1
	kv_send3_7_0 -> ring_stage3_8_1
	ring_stage3_8_1 -> kv_send3_8_1
	ring_stage3_7_2 -> ring_stage3_8_2
	kv_send3_7_1 -> ring_stage3_8_2
	ring_stage3_8_2 -> kv_send3_8_2
	ring_stage3_7_3 -> ring_stage3_8_3
	kv_send3_7_2 -> ring_stage3_8_3
	ring_stage3_8_3 -> kv_send3_8_3
	ring_stage3_7_4 -> ring_stage3_8_4
	kv_send3_7_3 -> ring_stage3_8_4
	ring_stage3_8_4 -> kv_send3_8_4
	ring_stage3_7_5 -> ring_stage3_8_5
	kv_send3_7_4 -> ring_stage3_8_5
	ring_stage3_8_5 -> kv_send3_8_5
	ring_stage3_7_6 -> ring_stage3_8_6
	kv_send3_7_5 -> ring_stage3_8_6
	ring_stage3_8_6 -> kv_send3_8_6
	ring_stage3_7_7 -> ring_stage3_8_7
	kv_send3_7_6 -> ring_stage3_8_7
	ring_stage3_8_7 -> kv_send3_8_7
	ring_stage3_7_8 -> ring_stage3_8_8
	kv_send3_7_7 -> ring_stage3_8_8
	ring_stage3_8_8 -> kv_send3_8_8
	ring_stage3_7_9 -> ring_stage3_8_9
	kv_send3_7_8 -> ring_stage3_8_9
	ring_stage3_8_9 -> kv_send3_8_9
	ring_stage3_7_10 -> ring_stage3_8_10
	kv_send3_7_9 -> ring_stage3_8_10
	ring_stage3_8_10 -> kv_send3_8_10
	ring_stage3_7_11 -> ring_stage3_8_11
	kv_send3_7_10 -> ring_stage3_8_11
	ring_stage3_8_11 -> kv_send3_8_11
	ring_stage3_7_12 -> ring_stage3_8_12
	kv_send3_7_11 -> ring_stage3_8_12
	ring_stage3_8_12 -> kv_send3_8_12
	ring_stage3_7_13 -> ring_stage3_8_13
	kv_send3_7_12 -> ring_stage3_8_13
	ring_stage3_8_13 -> kv_send3_8_13
	ring_stage3_7_14 -> ring_stage3_8_14
	kv_send3_7_13 -> ring_stage3_8_14
	ring_stage3_8_14 -> kv_send3_8_14
	ring_stage3_7_15 -> ring_stage3_8_15
	kv_send3_7_14 -> ring_stage3_8_15
	ring_stage3_8_15 -> kv_send3_8_15
	ring_stage3_8_0 -> ring_stage3_9_0
	kv_send3_8_15 -> ring_stage3_9_0
	ring_stage3_9_0 -> kv_send3_9_0
	ring_stage3_8_1 -> ring_stage3_9_1
	kv_send3_8_0 -> ring_stage3_9_1
	ring_stage3_9_1 -> kv_send3_9_1
	ring_stage3_8_2 -> ring_stage3_9_2
	kv_send3_8_1 -> ring_stage3_9_2
	ring_stage3_9_2 -> kv_send3_9_2
	ring_stage3_8_3 -> ring_stage3_9_3
	kv_send3_8_2 -> ring_stage3_9_3
	ring_stage3_9_3 -> kv_send3_9_3
	ring_stage3_8_4 -> ring_stage3_9_4
	kv_send3_8_3 -> ring_stage3_9_4
	ring_stage3_9_4 -> kv_send3_9_4
	ring_stage3_8_5 -> ring_stage3_9_5
	kv_send3_8_4 -> ring_stage3_9_5
	ring_stage3_9_5 -> kv_send3_9_5
	ring_stage3_8_6 -> ring_stage3_9_6
	kv_send3_8_5 -> ring_stage3_9_6
	ring_stage3_9_6 -> kv_send3_9_6
	ring_stage3_8_7 -> ring_stage3_9_7
	kv_send3_8_6 -> ring_stage3_9_7
	ring_stage3_9_7 -> kv_send3_9_7
	ring_stage3_8_8 -> ring_stage3_9_8
	kv_send3_8_7 -> ring_stage3_9_8
	ring_stage3_9_8 -> kv_send3_9_8
	ring_stage3_8_9 -> ring_stage3_9_9
	kv_send3_8_8 -> ring_stage3_9_9
	ring_stage3_9_9 -> kv_send3_9_9
	ring_stage3_8_10 -> ring_stage3_9_10
	kv_send3_8_9 -> ring_stage3_9_10
	ring_stage3_9_10 -> kv_send3_9_10
	ring_stage3_8_11 -> ring_stage3_9_11
	kv_send3_8_10 -> ring_stage3_9_11
	ring_stage3_9_11 -> kv_send3_9_11
	ring_stage3_8_12 -> ring_stage3_9_12
	kv_send3_8_11 -> ring_stage3_9_12
	ring_stage3_9_12 -> kv_send3_9_12
	ring_stage3_8_13 -> ring_stage3_9_13
	kv_send3_8_12 -> ring_stage3_9_13
	ring_stage3_9_13 -> kv_send3_9_13
	ring_stage3_8_14 -> ring_stage3_9_14
	kv_send3_8_13 -> ring_stage3_9_14
	ring_stage3_9_14 -> kv_send3_9_14
	ring_stage3_8_15 -> ring_stage3_9_15
	kv_send3_8_14 -> ring_stage3_9_15
	ring_stage3_9_15 -> kv_send3_9_15
	ring_stage3_9_0 -> ring_stage3_10_0
	kv_send3_9_15 -> ring_stage3_10_0
	ring_stage3_10_0 -> kv_send3_10_0
	ring_stage3_9_1 -> ring_stage3_10_1
	kv_send3_9_0 -> ring_stage3_10_1
	ring_stage3_10_1 -> kv_send3_10_1
	ring_stage3_9_2 -> ring_stage3_10_2
	kv_send3_9_1 -> ring_stage3_10_2
	ring_stage3_10_2 -> kv_send3_10_2
	ring_stage3_9_3 -> ring_stage3_10_3
	kv_send3_9_2 -> ring_stage3_10_3
	ring_stage3_10_3 -> kv_send3_10_3
	ring_stage3_9_4 -> ring_stage3_10_4
	kv_send3_9_3 -> ring_stage3_10_4
	ring_stage3_10_4 -> kv_send3_10_4
	ring_stage3_9_5 -> ring_stage3_10_5
	kv_send3_9_4 -> ring_stage3_10_5
	ring_stage3_10_5 -> kv_send3_10_5
	ring_stage3_9_6 -> ring_stage3_10_6
	kv_send3_9_5 -> ring_stage3_10_6
	ring_stage3_10_6 -> kv_send3_10_6
	ring_stage3_9_7 -> ring_stage3_10_7
	kv_send3_9_6 -> ring_stage3_10_7
	ring_stage3_10_7 -> kv_send3_10_7
	ring_stage3_9_8 -> ring_stage3_10_8
	kv_send3_9_7 -> ring_stage3_10_8
	ring_stage3_10_8 -> kv_send3_10_8
	ring_stage3_9_9 -> ring_stage3_10_9
	kv_send3_9_8 -> ring_stage3_10_9
	ring_stage3_10_9 -> kv_send3_10_9
	ring_stage3_9_10 -> ring_stage3_10_10
	kv_send3_9_9 -> ring_stage3_10_10
	ring_stage3_10_10 -> kv_send3_10_10
	ring_stage3_9_11 -> ring_stage3_10_11
	kv_send3_9_10 -> ring_stage3_10_11
	ring_stage3_10_11 -> kv_send3_10_11
	ring_stage3_9_12 -> ring_stage3_10_12
	kv_send3_9_11 -> ring_stage3_10_12
	ring_stage3_10_12 -> kv_send3_10_12
	ring_stage3_9_13 -> ring_stage3_10_13
	kv_send3_9_12 -> ring_stage3_10_13
	ring_stage3_10_13 -> kv_send3_10_13
	ring_stage3_9_14 -> ring_stage3_10_14
	kv_send3_9_13 -> ring_stage3_10_14
	ring_stage3_10_14 -> kv_send3_10_14
	ring_stage3_9_15 -> ring_stage3_10_15
	kv_send3_9_14 -> ring_stage3_10_15
	ring_stage3_10_15 -> kv_send3_10_15
	ring_stage3_10_0 -> ring_stage3_11_0
	kv_send3_10_15 -> ring_stage3_11_0
	ring_stage3_11_0 -> kv_send3_11_0
	ring_stage3_10_1 -> ring_stage3_11_1
	kv_send3_10_0 -> ring_stage3_11_1
	ring_stage3_11_1 -> kv_send3_11_1
	ring_stage3_10_2 -> ring_stage3_11_2
	kv_send3_10_1 -> ring_stage3_11_2
	ring_stage3_11_2 -> kv_send3_11_2
	ring_stage3_10_3 -> ring_stage3_11_3
	kv_send3_10_2 -> ring_stage3_11_3
	ring_stage3_11_3 -> kv_send3_11_3
	ring_stage3_10_4 -> ring_stage3_11_4
	kv_send3_10_3 -> ring_stage3_11_4
	ring_stage3_11_4 -> kv_send3_11_4
	ring_stage3_10_5 -> ring_stage3_11_5
	kv_send3_10_4 -> ring_stage3_11_5
	ring_stage3_11_5 -> kv_send3_11_5
	ring_stage3_10_6 -> ring_stage3_11_6
	kv_send3_10_5 -> ring_stage3_11_6
	ring_stage3_11_6 -> kv_send3_11_6
	ring_stage3_10_7 -> ring_stage3_11_7
	kv_send3_10_6 -> ring_stage3_11_7
	ring_stage3_11_7 -> kv_send3_11_7
	ring_stage3_10_8 -> ring_stage3_11_8
	kv_send3_10_7 -> ring_stage3_11_8
	ring_stage3_11_8 -> kv_send3_11_8
	ring_stage3_10_9 -> ring_stage3_11_9
	kv_send3_10_8 -> ring_stage3_11_9
	ring_stage3_11_9 -> kv_send3_11_9
	ring_stage3_10_10 -> ring_stage3_11_10
	kv_send3_10_9 -> ring_stage3_11_10
	ring_stage3_11_10 -> kv_send3_11_10
	ring_stage3_10_11 -> ring_stage3_11_11
	kv_send3_10_10 -> ring_stage3_11_11
	ring_stage3_11_11 -> kv_send3_11_11
	ring_stage3_10_12 -> ring_stage3_11_12
	kv_send3_10_11 -> ring_stage3_11_12
	ring_stage3_11_12 -> kv_send3_11_12
	ring_stage3_10_13 -> ring_stage3_11_13
	kv_send3_10_12 -> ring_stage3_11_13
	ring_stage3_11_13 -> kv_send3_11_13
	ring_stage3_10_14 -> ring_stage3_11_14
	kv_send3_10_13 -> ring_stage3_11_14
	ring_stage3_11_14 -> kv_send3_11_14
	ring_stage3_10_15 -> ring_stage3_11_15
	kv_send3_10_14 -> ring_stage3_11_15
	ring_stage3_11_15 -> kv_send3_11_15
	ring_stage3_11_0 -> ring_stage3_12_0
	kv_send3_11_15 -> ring_stage3_12_0
	ring_stage3_12_0 -> kv_send3_12_0
	ring_stage3_11_1 -> ring_stage3_12_1
	kv_send3_11_0 -> ring_stage3_12_1
	ring_stage3_12_1 -> kv_send3_12_1
	ring_stage3_11_2 -> ring_stage3_12_2
	kv_send3_11_1 -> ring_stage3_12_2
	ring_stage3_12_2 -> kv_send3_12_2
	ring_stage3_11_3 -> ring_stage3_12_3
	kv_send3_11_2 -> ring_stage3_12_3
	ring_stage3_12_3 -> kv_send3_12_3
	ring_stage3_11_4 -> ring_stage3_12_4
	kv_send3_11_3 -> ring_stage3_12_4
	ring_stage3_12_4 -> kv_send3_12_4
	ring_stage3_11_5 -> ring_stage3_12_5
	kv_send3_11_4 -> ring_stage3_12_5
	ring_stage3_12_5 -> kv_send3_12_5
	ring_stage3_11_6 -> ring_stage3_12_6
	kv_send3_11_5 -> ring_stage3_12_6
	ring_stage3_12_6 -> kv_send3_12_6
	ring_stage3_11_7 -> ring_stage3_12_7
	kv_send3_11_6 -> ring_stage3_12_7
	ring_stage3_12_7 -> kv_send3_12_7
	ring_stage3_11_8 -> ring_stage3_12_8
	kv_send3_11_7 -> ring_stage3_12_8
	ring_stage3_12_8 -> kv_send3_12_8
	ring_stage3_11_9 -> ring_stage3_12_9
	kv_send3_11_8 -> ring_stage3_12_9
	ring_stage3_12_9 -> kv_send3_12_9
	ring_stage3_11_10 -> ring_stage3_12_10
	kv_send3_11_9 -> ring_stage3_12_10
	ring_stage3_12_10 -> kv_send3_12_10
	ring_stage3_11_11 -> ring_stage3_12_11
	kv_send3_11_10 -> ring_stage3_12_11
	ring_stage3_12_11 -> kv_send3_12_11
	ring_stage3_11_12 -> ring_stage3_12_12
	kv_send3_11_11 -> ring_stage3_12_12
	ring_stage3_12_12 -> kv_send3_12_12
	ring_stage3_11_13 -> ring_stage3_12_13
	kv_send3_11_12 -> ring_stage3_12_13
	ring_stage3_12_13 -> kv_send3_12_13
	ring_stage3_11_14 -> ring_stage3_12_14
	kv_send3_11_13 -> ring_stage3_12_14
	ring_stage3_12_14 -> kv_send3_12_14
	ring_stage3_11_15 -> ring_stage3_12_15
	kv_send3_11_14 -> ring_stage3_12_15
	ring_stage3_12_15 -> kv_send3_12_15
	ring_stage3_12_0 -> ring_stage3_13_0
	kv_send3_12_15 -> ring_stage3_13_0
	ring_stage3_13_0 -> kv_send3_13_0
	ring_stage3_12_1 -> ring_stage3_13_1
	kv_send3_12_0 -> ring_stage3_13_1
	ring_stage3_13_1 -> kv_send3_13_1
	ring_stage3_12_2 -> ring_stage3_13_2
	kv_send3_12_1 -> ring_stage3_13_2
	ring_stage3_13_2 -> kv_send3_13_2
	ring_stage3_12_3 -> ring_stage3_13_3
	kv_send3_12_2 -> ring_stage3_13_3
	ring_stage3_13_3 -> kv_send3_13_3
	ring_stage3_12_4 -> ring_stage3_13_4
	kv_send3_12_3 -> ring_stage3_13_4
	ring_stage3_13_4 -> kv_send3_13_4
	ring_stage3_12_5 -> ring_stage3_13_5
	kv_send3_12_4 -> ring_stage3_13_5
	ring_stage3_13_5 -> kv_send3_13_5
	ring_stage3_12_6 -> ring_stage3_13_6
	kv_send3_12_5 -> ring_stage3_13_6
	ring_stage3_13_6 -> kv_send3_13_6
	ring_stage3_12_7 -> ring_stage3_13_7
	kv_send3_12_6 -> ring_stage3_13_7
	ring_stage3_13_7 -> kv_send3_13_7
	ring_stage3_12_8 -> ring_stage3_13_8
	kv_send3_12_7 -> ring_stage3_13_8
	ring_stage3_13_8 -> kv_send3_13_8
	ring_stage3_12_9 -> ring_stage3_13_9
	kv_send3_12_8 -> ring_stage3_13_9
	ring_stage3_13_9 -> kv_send3_13_9
	ring_stage3_12_10 -> ring_stage3_13_10
	kv_send3_12_9 -> ring_stage3_13_10
	ring_stage3_13_10 -> kv_send3_13_10
	ring_stage3_12_11 -> ring_stage3_13_11
	kv_send3_12_10 -> ring_stage3_13_11
	ring_stage3_13_11 -> kv_send3_13_11
	ring_stage3_12_12 -> ring_stage3_13_12
	kv_send3_12_11 -> ring_stage3_13_12
	ring_stage3_13_12 -> kv_send3_13_12
	ring_stage3_12_13 -> ring_stage3_13_13
	kv_send3_12_12 -> ring_stage3_13_13
	ring_stage3_13_13 -> kv_send3_13_13
	ring_stage3_12_14 -> ring_stage3_13_14
	kv_send3_12_13 -> ring_stage3_13_14
	ring_stage3_13_14 -> kv_send3_13_14
	ring_stage3_12_15 -> ring_stage3_13_15
	kv_send3_12_14 -> ring_stage3_13_15
	ring_stage3_13_15 -> kv_send3_13_15
	ring_stage3_13_0 -> ring_stage3_14_0
	kv_send3_13_15 -> ring_stage3_14_0
	ring_stage3_14_0 -> kv_send3_14_0
	ring_stage3_13_1 -> ring_stage3_14_1
	kv_send3_13_0 -> ring_stage3_14_1
	ring_stage3_14_1 -> kv_send3_14_1
	ring_stage3_13_2 -> ring_stage3_14_2
	kv_send3_13_1 -> ring_stage3_14_2
	ring_stage3_14_2 -> kv_send3_14_2
	ring_stage3_13_3 -> ring_stage3_14_3
	kv_send3_13_2 -> ring_stage3_14_3
	ring_stage3_14_3 -> kv_send3_14_3
	ring_stage3_13_4 -> ring_stage3_14_4
	kv_send3_13_3 -> ring_stage3_14_4
	ring_stage3_14_4 -> kv_send3_14_4
	ring_stage3_13_5 -> ring_stage3_14_5
	kv_send3_13_4 -> ring_stage3_14_5
	ring_stage3_14_5 -> kv_send3_14_5
	ring_stage3_13_6 -> ring_stage3_14_6
	kv_send3_13_5 -> ring_stage3_14_6
	ring_stage3_14_6 -> kv_send3_14_6
	ring_stage3_13_7 -> ring_stage3_14_7
	kv_send3_13_6 -> ring_stage3_14_7
	ring_stage3_14_7 -> kv_send3_14_7
	ring_stage3_13_8 -> ring_stage3_14_8
	kv_send3_13_7 -> ring_stage3_14_8
	ring_stage3_14_8 -> kv_send3_14_8
	ring_stage3_13_9 -> ring_stage3_14_9
	kv_send3_13_8 -> ring_stage3_14_9
	ring_stage3_14_9 -> kv_send3_14_9
	ring_stage3_13_10 -> ring_stage3_14_10
	kv_send3_13_9 -> ring_stage3_14_10
	ring_stage3_14_10 -> kv_send3_14_10
	ring_stage3_13_11 -> ring_stage3_14_11
	kv_send3_13_10 -> ring_stage3_14_11
	ring_stage3_14_11 -> kv_send3_14_11
	ring_stage3_13_12 -> ring_stage3_14_12
	kv_send3_13_11 -> ring_stage3_14_12
	ring_stage3_14_12 -> kv_send3_14_12
	ring_stage3_13_13 -> ring_stage3_14_13
	kv_send3_13_12 -> ring_stage3_14_13
	ring_stage3_14_13 -> kv_send3_14_13
	ring_stage3_13_14 -> ring_stage3_14_14
	kv_send3_13_13 -> ring_stage3_14_14
	ring_stage3_14_14 -> kv_send3_14_14
	ring_stage3_13_15 -> ring_stage3_14_15
	kv_send3_13_14 -> ring_stage3_14_15
	ring_stage3_14_15 -> kv_send3_14_15
	ring_stage3_14_0 -> ring_stage3_15_0
	kv_send3_14_15 -> ring_stage3_15_0
	ring_stage3_14_1 -> ring_stage3_15_1
	kv_send3_14_0 -> ring_stage3_15_1
	ring_stage3_14_2 -> ring_stage3_15_2
	kv_send3_14_1 -> ring_stage3_15_2
	ring_stage3_14_3 -> ring_stage3_15_3
	kv_send3_14_2 -> ring_stage3_15_3
	ring_stage3_14_4 -> ring_stage3_15_4
	kv_send3_14_3 -> ring_stage3_15_4
	ring_stage3_14_5 -> ring_stage3_15_5
	kv_send3_14_4 -> ring_stage3_15_5
	ring_stage3_14_6 -> ring_stage3_15_6
	kv_send3_14_5 -> ring_stage3_15_6
	ring_stage3_14_7 -> ring_stage3_15_7
	kv_send3_14_6 -> ring_stage3_15_7
	ring_stage3_14_8 -> ring_stage3_15_8
	kv_send3_14_7 -> ring_stage3_15_8
	ring_stage3_14_9 -> ring_stage3_15_9
	kv_send3_14_8 -> ring_stage3_15_9
	ring_stage3_14_10 -> ring_stage3_15_10
	kv_send3_14_9 -> ring_stage3_15_10
	ring_stage3_14_11 -> ring_stage3_15_11
	kv_send3_14_10 -> ring_stage3_15_11
	ring_stage3_14_12 -> ring_stage3_15_12
	kv_send3_14_11 -> ring_stage3_15_12
	ring_stage3_14_13 -> ring_stage3_15_13
	kv_send3_14_12 -> ring_stage3_15_13
	ring_stage3_14_14 -> ring_stage3_15_14
	kv_send3_14_13 -> ring_stage3_15_14
	ring_stage3_14_15 -> ring_stage3_15_15
	kv_send3_14_14 -> ring_stage3_15_15
	ring_stage3_15_0 -> accum3_0
	accum3_0 -> out_proj3_0
	out_proj3_0 -> res_attn3_0
	res_moe2_0 -> res_attn3_0
	res_attn3_0 -> gate3_0
	gate3_0 -> select3_0
	select3_0 -> expert3_0_0 [label="if selected" style=dashed]
	expert3_0_0 -> expert_act3_0_0
	expert_act3_0_0 -> expert_out3_0_0
	expert_out3_0_0 -> combine3_0
	select3_0 -> expert3_0_1 [label="if selected" style=dashed]
	expert3_0_1 -> expert_act3_0_1
	expert_act3_0_1 -> expert_out3_0_1
	expert_out3_0_1 -> combine3_0
	select3_0 -> expert3_0_2 [label="if selected" style=dashed]
	expert3_0_2 -> expert_act3_0_2
	expert_act3_0_2 -> expert_out3_0_2
	expert_out3_0_2 -> combine3_0
	select3_0 -> expert3_0_3 [label="if selected" style=dashed]
	expert3_0_3 -> expert_act3_0_3
	expert_act3_0_3 -> expert_out3_0_3
	expert_out3_0_3 -> combine3_0
	select3_0 -> expert3_0_4 [label="if selected" style=dashed]
	expert3_0_4 -> expert_act3_0_4
	expert_act3_0_4 -> expert_out3_0_4
	expert_out3_0_4 -> combine3_0
	select3_0 -> expert3_0_5 [label="if selected" style=dashed]
	expert3_0_5 -> expert_act3_0_5
	expert_act3_0_5 -> expert_out3_0_5
	expert_out3_0_5 -> combine3_0
	select3_0 -> expert3_0_6 [label="if selected" style=dashed]
	expert3_0_6 -> expert_act3_0_6
	expert_act3_0_6 -> expert_out3_0_6
	expert_out3_0_6 -> combine3_0
	select3_0 -> expert3_0_7 [label="if selected" style=dashed]
	expert3_0_7 -> expert_act3_0_7
	expert_act3_0_7 -> expert_out3_0_7
	expert_out3_0_7 -> combine3_0
	combine3_0 -> res_moe3_0
	res_attn3_0 -> res_moe3_0
	ring_stage3_15_1 -> accum3_1
	accum3_1 -> out_proj3_1
	out_proj3_1 -> res_attn3_1
	res_moe2_1 -> res_attn3_1
	res_attn3_1 -> gate3_1
	gate3_1 -> select3_1
	select3_1 -> expert3_1_0 [label="if selected" style=dashed]
	expert3_1_0 -> expert_act3_1_0
	expert_act3_1_0 -> expert_out3_1_0
	expert_out3_1_0 -> combine3_1
	select3_1 -> expert3_1_1 [label="if selected" style=dashed]
	expert3_1_1 -> expert_act3_1_1
	expert_act3_1_1 -> expert_out3_1_1
	expert_out3_1_1 -> combine3_1
	select3_1 -> expert3_1_2 [label="if selected" style=dashed]
	expert3_1_2 -> expert_act3_1_2
	expert_act3_1_2 -> expert_out3_1_2
	expert_out3_1_2 -> combine3_1
	select3_1 -> expert3_1_3 [label="if selected" style=dashed]
	expert3_1_3 -> expert_act3_1_3
	expert_act3_1_3 -> expert_out3_1_3
	expert_out3_1_3 -> combine3_1
	select3_1 -> expert3_1_4 [label="if selected" style=dashed]
	expert3_1_4 -> expert_act3_1_4
	expert_act3_1_4 -> expert_out3_1_4
	expert_out3_1_4 -> combine3_1
	select3_1 -> expert3_1_5 [label="if selected" style=dashed]
	expert3_1_5 -> expert_act3_1_5
	expert_act3_1_5 -> expert_out3_1_5
	expert_out3_1_5 -> combine3_1
	select3_1 -> expert3_1_6 [label="if selected" style=dashed]
	expert3_1_6 -> expert_act3_1_6
	expert_act3_1_6 -> expert_out3_1_6
	expert_out3_1_6 -> combine3_1
	select3_1 -> expert3_1_7 [label="if selected" style=dashed]
	expert3_1_7 -> expert_act3_1_7
	expert_act3_1_7 -> expert_out3_1_7
	expert_out3_1_7 -> combine3_1
	combine3_1 -> res_moe3_1
	res_attn3_1 -> res_moe3_1
	ring_stage3_15_2 -> accum3_2
	accum3_2 -> out_proj3_2
	out_proj3_2 -> res_attn3_2
	res_moe2_2 -> res_attn3_2
	res_attn3_2 -> gate3_2
	gate3_2 -> select3_2
	select3_2 -> expert3_2_0 [label="if selected" style=dashed]
	expert3_2_0 -> expert_act3_2_0
	expert_act3_2_0 -> expert_out3_2_0
	expert_out3_2_0 -> combine3_2
	select3_2 -> expert3_2_1 [label="if selected" style=dashed]
	expert3_2_1 -> expert_act3_2_1
	expert_act3_2_1 -> expert_out3_2_1
	expert_out3_2_1 -> combine3_2
	select3_2 -> expert3_2_2 [label="if selected" style=dashed]
	expert3_2_2 -> expert_act3_2_2
	expert_act3_2_2 -> expert_out3_2_2
	expert_out3_2_2 -> combine3_2
	select3_2 -> expert3_2_3 [label="if selected" style=dashed]
	expert3_2_3 -> expert_act3_2_3
	expert_act3_2_3 -> expert_out3_2_3
	expert_out3_2_3 -> combine3_2
	select3_2 -> expert3_2_4 [label="if selected" style=dashed]
	expert3_2_4 -> expert_act3_2_4
	expert_act3_2_4 -> expert_out3_2_4
	expert_out3_2_4 -> combine3_2
	select3_2 -> expert3_2_5 [label="if selected" style=dashed]
	expert3_2_5 -> expert_act3_2_5
	expert_act3_2_5 -> expert_out3_2_5
	expert_out3_2_5 -> combine3_2
	select3_2 -> expert3_2_6 [label="if selected" style=dashed]
	expert3_2_6 -> expert_act3_2_6
	expert_act3_2_6 -> expert_out3_2_6
	expert_out3_2_6 -> combine3_2
	select3_2 -> expert3_2_7 [label="if selected" style=dashed]
	expert3_2_7 -> expert_act3_2_7
	expert_act3_2_7 -> expert_out3_2_7
	expert_out3_2_7 -> combine3_2
	combine3_2 -> res_moe3_2
	res_attn3_2 -> res_moe3_2
	ring_stage3_15_3 -> accum3_3
	accum3_3 -> out_proj3_3
	out_proj3_3 -> res_attn3_3
	res_moe2_3 -> res_attn3_3
	res_attn3_3 -> gate3_3
	gate3_3 -> select3_3
	select3_3 -> expert3_3_0 [label="if selected" style=dashed]
	expert3_3_0 -> expert_act3_3_0
	expert_act3_3_0 -> expert_out3_3_0
	expert_out3_3_0 -> combine3_3
	select3_3 -> expert3_3_1 [label="if selected" style=dashed]
	expert3_3_1 -> expert_act3_3_1
	expert_act3_3_1 -> expert_out3_3_1
	expert_out3_3_1 -> combine3_3
	select3_3 -> expert3_3_2 [label="if selected" style=dashed]
	expert3_3_2 -> expert_act3_3_2
	expert_act3_3_2 -> expert_out3_3_2
	expert_out3_3_2 -> combine3_3
	select3_3 -> expert3_3_3 [label="if selected" style=dashed]
	expert3_3_3 -> expert_act3_3_3
	expert_act3_3_3 -> expert_out3_3_3
	expert_out3_3_3 -> combine3_3
	select3_3 -> expert3_3_4 [label="if selected" style=dashed]
	expert3_3_4 -> expert_act3_3_4
	expert_act3_3_4 -> expert_out3_3_4
	expert_out3_3_4 -> combine3_3
	select3_3 -> expert3_3_5 [label="if selected" style=dashed]
	expert3_3_5 -> expert_act3_3_5
	expert_act3_3_5 -> expert_out3_3_5
	expert_out3_3_5 -> combine3_3
	select3_3 -> expert3_3_6 [label="if selected" style=dashed]
	expert3_3_6 -> expert_act3_3_6
	expert_act3_3_6 -> expert_out3_3_6
	expert_out3_3_6 -> combine3_3
	select3_3 -> expert3_3_7 [label="if selected" style=dashed]
	expert3_3_7 -> expert_act3_3_7
	expert_act3_3_7 -> expert_out3_3_7
	expert_out3_3_7 -> combine3_3
	combine3_3 -> res_moe3_3
	res_attn3_3 -> res_moe3_3
	ring_stage3_15_4 -> accum3_4
	accum3_4 -> out_proj3_4
	out_proj3_4 -> res_attn3_4
	res_moe2_4 -> res_attn3_4
	res_attn3_4 -> gate3_4
	gate3_4 -> select3_4
	select3_4 -> expert3_4_0 [label="if selected" style=dashed]
	expert3_4_0 -> expert_act3_4_0
	expert_act3_4_0 -> expert_out3_4_0
	expert_out3_4_0 -> combine3_4
	select3_4 -> expert3_4_1 [label="if selected" style=dashed]
	expert3_4_1 -> expert_act3_4_1
	expert_act3_4_1 -> expert_out3_4_1
	expert_out3_4_1 -> combine3_4
	select3_4 -> expert3_4_2 [label="if selected" style=dashed]
	expert3_4_2 -> expert_act3_4_2
	expert_act3_4_2 -> expert_out3_4_2
	expert_out3_4_2 -> combine3_4
	select3_4 -> expert3_4_3 [label="if selected" style=dashed]
	expert3_4_3 -> expert_act3_4_3
	expert_act3_4_3 -> expert_out3_4_3
	expert_out3_4_3 -> combine3_4
	select3_4 -> expert3_4_4 [label="if selected" style=dashed]
	expert3_4_4 -> expert_act3_4_4
	expert_act3_4_4 -> expert_out3_4_4
	expert_out3_4_4 -> combine3_4
	select3_4 -> expert3_4_5 [label="if selected" style=dashed]
	expert3_4_5 -> expert_act3_4_5
	expert_act3_4_5 -> expert_out3_4_5
	expert_out3_4_5 -> combine3_4
	select3_4 -> expert3_4_6 [label="if selected" style=dashed]
	expert3_4_6 -> expert_act3_4_6
	expert_act3_4_6 -> expert_out3_4_6
	expert_out3_4_6 -> combine3_4
	select3_4 -> expert3_4_7 [label="if selected" style=dashed]
	expert3_4_7 -> expert_act3_4_7
	expert_act3_4_7 -> expert_out3_4_7
	expert_out3_4_7 -> combine3_4
	combine3_4 -> res_moe3_4
	res_attn3_4 -> res_moe3_4
	ring_stage3_15_5 -> accum3_5
	accum3_5 -> out_proj3_5
	out_proj3_5 -> res_attn3_5
	res_moe2_5 -> res_attn3_5
	res_attn3_5 -> gate3_5
	gate3_5 -> select3_5
	select3_5 -> expert3_5_0 [label="if selected" style=dashed]
	expert3_5_0 -> expert_act3_5_0
	expert_act3_5_0 -> expert_out3_5_0
	expert_out3_5_0 -> combine3_5
	select3_5 -> expert3_5_1 [label="if selected" style=dashed]
	expert3_5_1 -> expert_act3_5_1
	expert_act3_5_1 -> expert_out3_5_1
	expert_out3_5_1 -> combine3_5
	select3_5 -> expert3_5_2 [label="if selected" style=dashed]
	expert3_5_2 -> expert_act3_5_2
	expert_act3_5_2 -> expert_out3_5_2
	expert_out3_5_2 -> combine3_5
	select3_5 -> expert3_5_3 [label="if selected" style=dashed]
	expert3_5_3 -> expert_act3_5_3
	expert_act3_5_3 -> expert_out3_5_3
	expert_out3_5_3 -> combine3_5
	select3_5 -> expert3_5_4 [label="if selected" style=dashed]
	expert3_5_4 -> expert_act3_5_4
	expert_act3_5_4 -> expert_out3_5_4
	expert_out3_5_4 -> combine3_5
	select3_5 -> expert3_5_5 [label="if selected" style=dashed]
	expert3_5_5 -> expert_act3_5_5
	expert_act3_5_5 -> expert_out3_5_5
	expert_out3_5_5 -> combine3_5
	select3_5 -> expert3_5_6 [label="if selected" style=dashed]
	expert3_5_6 -> expert_act3_5_6
	expert_act3_5_6 -> expert_out3_5_6
	expert_out3_5_6 -> combine3_5
	select3_5 -> expert3_5_7 [label="if selected" style=dashed]
	expert3_5_7 -> expert_act3_5_7
	expert_act3_5_7 -> expert_out3_5_7
	expert_out3_5_7 -> combine3_5
	combine3_5 -> res_moe3_5
	res_attn3_5 -> res_moe3_5
	ring_stage3_15_6 -> accum3_6
	accum3_6 -> out_proj3_6
	out_proj3_6 -> res_attn3_6
	res_moe2_6 -> res_attn3_6
	res_attn3_6 -> gate3_6
	gate3_6 -> select3_6
	select3_6 -> expert3_6_0 [label="if selected" style=dashed]
	expert3_6_0 -> expert_act3_6_0
	expert_act3_6_0 -> expert_out3_6_0
	expert_out3_6_0 -> combine3_6
	select3_6 -> expert3_6_1 [label="if selected" style=dashed]
	expert3_6_1 -> expert_act3_6_1
	expert_act3_6_1 -> expert_out3_6_1
	expert_out3_6_1 -> combine3_6
	select3_6 -> expert3_6_2 [label="if selected" style=dashed]
	expert3_6_2 -> expert_act3_6_2
	expert_act3_6_2 -> expert_out3_6_2
	expert_out3_6_2 -> combine3_6
	select3_6 -> expert3_6_3 [label="if selected" style=dashed]
	expert3_6_3 -> expert_act3_6_3
	expert_act3_6_3 -> expert_out3_6_3
	expert_out3_6_3 -> combine3_6
	select3_6 -> expert3_6_4 [label="if selected" style=dashed]
	expert3_6_4 -> expert_act3_6_4
	expert_act3_6_4 -> expert_out3_6_4
	expert_out3_6_4 -> combine3_6
	select3_6 -> expert3_6_5 [label="if selected" style=dashed]
	expert3_6_5 -> expert_act3_6_5
	expert_act3_6_5 -> expert_out3_6_5
	expert_out3_6_5 -> combine3_6
	select3_6 -> expert3_6_6 [label="if selected" style=dashed]
	expert3_6_6 -> expert_act3_6_6
	expert_act3_6_6 -> expert_out3_6_6
	expert_out3_6_6 -> combine3_6
	select3_6 -> expert3_6_7 [label="if selected" style=dashed]
	expert3_6_7 -> expert_act3_6_7
	expert_act3_6_7 -> expert_out3_6_7
	expert_out3_6_7 -> combine3_6
	combine3_6 -> res_moe3_6
	res_attn3_6 -> res_moe3_6
	ring_stage3_15_7 -> accum3_7
	accum3_7 -> out_proj3_7
	out_proj3_7 -> res_attn3_7
	res_moe2_7 -> res_attn3_7
	res_attn3_7 -> gate3_7
	gate3_7 -> select3_7
	select3_7 -> expert3_7_0 [label="if selected" style=dashed]
	expert3_7_0 -> expert_act3_7_0
	expert_act3_7_0 -> expert_out3_7_0
	expert_out3_7_0 -> combine3_7
	select3_7 -> expert3_7_1 [label="if selected" style=dashed]
	expert3_7_1 -> expert_act3_7_1
	expert_act3_7_1 -> expert_out3_7_1
	expert_out3_7_1 -> combine3_7
	select3_7 -> expert3_7_2 [label="if selected" style=dashed]
	expert3_7_2 -> expert_act3_7_2
	expert_act3_7_2 -> expert_out3_7_2
	expert_out3_7_2 -> combine3_7
	select3_7 -> expert3_7_3 [label="if selected" style=dashed]
	expert3_7_3 -> expert_act3_7_3
	expert_act3_7_3 -> expert_out3_7_3
	expert_out3_7_3 -> combine3_7
	select3_7 -> expert3_7_4 [label="if selected" style=dashed]
	expert3_7_4 -> expert_act3_7_4
	expert_act3_7_4 -> expert_out3_7_4
	expert_out3_7_4 -> combine3_7
	select3_7 -> expert3_7_5 [label="if selected" style=dashed]
	expert3_7_5 -> expert_act3_7_5
	expert_act3_7_5 -> expert_out3_7_5
	expert_out3_7_5 -> combine3_7
	select3_7 -> expert3_7_6 [label="if selected" style=dashed]
	expert3_7_6 -> expert_act3_7_6
	expert_act3_7_6 -> expert_out3_7_6
	expert_out3_7_6 -> combine3_7
	select3_7 -> expert3_7_7 [label="if selected" style=dashed]
	expert3_7_7 -> expert_act3_7_7
	expert_act3_7_7 -> expert_out3_7_7
	expert_out3_7_7 -> combine3_7
	combine3_7 -> res_moe3_7
	res_attn3_7 -> res_moe3_7
	ring_stage3_15_8 -> accum3_8
	accum3_8 -> out_proj3_8
	out_proj3_8 -> res_attn3_8
	res_moe2_8 -> res_attn3_8
	res_attn3_8 -> gate3_8
	gate3_8 -> select3_8
	select3_8 -> expert3_8_0 [label="if selected" style=dashed]
	expert3_8_0 -> expert_act3_8_0
	expert_act3_8_0 -> expert_out3_8_0
	expert_out3_8_0 -> combine3_8
	select3_8 -> expert3_8_1 [label="if selected" style=dashed]
	expert3_8_1 -> expert_act3_8_1
	expert_act3_8_1 -> expert_out3_8_1
	expert_out3_8_1 -> combine3_8
	select3_8 -> expert3_8_2 [label="if selected" style=dashed]
	expert3_8_2 -> expert_act3_8_2
	expert_act3_8_2 -> expert_out3_8_2
	expert_out3_8_2 -> combine3_8
	select3_8 -> expert3_8_3 [label="if selected" style=dashed]
	expert3_8_3 -> expert_act3_8_3
	expert_act3_8_3 -> expert_out3_8_3
	expert_out3_8_3 -> combine3_8
	select3_8 -> expert3_8_4 [label="if selected" style=dashed]
	expert3_8_4 -> expert_act3_8_4
	expert_act3_8_4 -> expert_out3_8_4
	expert_out3_8_4 -> combine3_8
	select3_8 -> expert3_8_5 [label="if selected" style=dashed]
	expert3_8_5 -> expert_act3_8_5
	expert_act3_8_5 -> expert_out3_8_5
	expert_out3_8_5 -> combine3_8
	select3_8 -> expert3_8_6 [label="if selected" style=dashed]
	expert3_8_6 -> expert_act3_8_6
	expert_act3_8_6 -> expert_out3_8_6
	expert_out3_8_6 -> combine3_8
	select3_8 -> expert3_8_7 [label="if selected" style=dashed]
	expert3_8_7 -> expert_act3_8_7
	expert_act3_8_7 -> expert_out3_8_7
	expert_out3_8_7 -> combine3_8
	combine3_8 -> res_moe3_8
	res_attn3_8 -> res_moe3_8
	ring_stage3_15_9 -> accum3_9
	accum3_9 -> out_proj3_9
	out_proj3_9 -> res_attn3_9
	res_moe2_9 -> res_attn3_9
	res_attn3_9 -> gate3_9
	gate3_9 -> select3_9
	select3_9 -> expert3_9_0 [label="if selected" style=dashed]
	expert3_9_0 -> expert_act3_9_0
	expert_act3_9_0 -> expert_out3_9_0
	expert_out3_9_0 -> combine3_9
	select3_9 -> expert3_9_1 [label="if selected" style=dashed]
	expert3_9_1 -> expert_act3_9_1
	expert_act3_9_1 -> expert_out3_9_1
	expert_out3_9_1 -> combine3_9
	select3_9 -> expert3_9_2 [label="if selected" style=dashed]
	expert3_9_2 -> expert_act3_9_2
	expert_act3_9_2 -> expert_out3_9_2
	expert_out3_9_2 -> combine3_9
	select3_9 -> expert3_9_3 [label="if selected" style=dashed]
	expert3_9_3 -> expert_act3_9_3
	expert_act3_9_3 -> expert_out3_9_3
	expert_out3_9_3 -> combine3_9
	select3_9 -> expert3_9_4 [label="if selected" style=dashed]
	expert3_9_4 -> expert_act3_9_4
	expert_act3_9_4 -> expert_out3_9_4
	expert_out3_9_4 -> combine3_9
	select3_9 -> expert3_9_5 [label="if selected" style=dashed]
	expert3_9_5 -> expert_act3_9_5
	expert_act3_9_5 -> expert_out3_9_5
	expert_out3_9_5 -> combine3_9
	select3_9 -> expert3_9_6 [label="if selected" style=dashed]
	expert3_9_6 -> expert_act3_9_6
	expert_act3_9_6 -> expert_out3_9_6
	expert_out3_9_6 -> combine3_9
	select3_9 -> expert3_9_7 [label="if selected" style=dashed]
	expert3_9_7 -> expert_act3_9_7
	expert_act3_9_7 -> expert_out3_9_7
	expert_out3_9_7 -> combine3_9
	combine3_9 -> res_moe3_9
	res_attn3_9 -> res_moe3_9
	ring_stage3_15_10 -> accum3_10
	accum3_10 -> out_proj3_10
	out_proj3_10 -> res_attn3_10
	res_moe2_10 -> res_attn3_10
	res_attn3_10 -> gate3_10
	gate3_10 -> select3_10
	select3_10 -> expert3_10_0 [label="if selected" style=dashed]
	expert3_10_0 -> expert_act3_10_0
	expert_act3_10_0 -> expert_out3_10_0
	expert_out3_10_0 -> combine3_10
	select3_10 -> expert3_10_1 [label="if selected" style=dashed]
	expert3_10_1 -> expert_act3_10_1
	expert_act3_10_1 -> expert_out3_10_1
	expert_out3_10_1 -> combine3_10
	select3_10 -> expert3_10_2 [label="if selected" style=dashed]
	expert3_10_2 -> expert_act3_10_2
	expert_act3_10_2 -> expert_out3_10_2
	expert_out3_10_2 -> combine3_10
	select3_10 -> expert3_10_3 [label="if selected" style=dashed]
	expert3_10_3 -> expert_act3_10_3
	expert_act3_10_3 -> expert_out3_10_3
	expert_out3_10_3 -> combine3_10
	select3_10 -> expert3_10_4 [label="if selected" style=dashed]
	expert3_10_4 -> expert_act3_10_4
	expert_act3_10_4 -> expert_out3_10_4
	expert_out3_10_4 -> combine3_10
	select3_10 -> expert3_10_5 [label="if selected" style=dashed]
	expert3_10_5 -> expert_act3_10_5
	expert_act3_10_5 -> expert_out3_10_5
	expert_out3_10_5 -> combine3_10
	select3_10 -> expert3_10_6 [label="if selected" style=dashed]
	expert3_10_6 -> expert_act3_10_6
	expert_act3_10_6 -> expert_out3_10_6
	expert_out3_10_6 -> combine3_10
	select3_10 -> expert3_10_7 [label="if selected" style=dashed]
	expert3_10_7 -> expert_act3_10_7
	expert_act3_10_7 -> expert_out3_10_7
	expert_out3_10_7 -> combine3_10
	combine3_10 -> res_moe3_10
	res_attn3_10 -> res_moe3_10
	ring_stage3_15_11 -> accum3_11
	accum3_11 -> out_proj3_11
	out_proj3_11 -> res_attn3_11
	res_moe2_11 -> res_attn3_11
	res_attn3_11 -> gate3_11
	gate3_11 -> select3_11
	select3_11 -> expert3_11_0 [label="if selected" style=dashed]
	expert3_11_0 -> expert_act3_11_0
	expert_act3_11_0 -> expert_out3_11_0
	expert_out3_11_0 -> combine3_11
	select3_11 -> expert3_11_1 [label="if selected" style=dashed]
	expert3_11_1 -> expert_act3_11_1
	expert_act3_11_1 -> expert_out3_11_1
	expert_out3_11_1 -> combine3_11
	select3_11 -> expert3_11_2 [label="if selected" style=dashed]
	expert3_11_2 -> expert_act3_11_2
	expert_act3_11_2 -> expert_out3_11_2
	expert_out3_11_2 -> combine3_11
	select3_11 -> expert3_11_3 [label="if selected" style=dashed]
	expert3_11_3 -> expert_act3_11_3
	expert_act3_11_3 -> expert_out3_11_3
	expert_out3_11_3 -> combine3_11
	select3_11 -> expert3_11_4 [label="if selected" style=dashed]
	expert3_11_4 -> expert_act3_11_4
	expert_act3_11_4 -> expert_out3_11_4
	expert_out3_11_4 -> combine3_11
	select3_11 -> expert3_11_5 [label="if selected" style=dashed]
	expert3_11_5 -> expert_act3_11_5
	expert_act3_11_5 -> expert_out3_11_5
	expert_out3_11_5 -> combine3_11
	select3_11 -> expert3_11_6 [label="if selected" style=dashed]
	expert3_11_6 -> expert_act3_11_6
	expert_act3_11_6 -> expert_out3_11_6
	expert_out3_11_6 -> combine3_11
	select3_11 -> expert3_11_7 [label="if selected" style=dashed]
	expert3_11_7 -> expert_act3_11_7
	expert_act3_11_7 -> expert_out3_11_7
	expert_out3_11_7 -> combine3_11
	combine3_11 -> res_moe3_11
	res_attn3_11 -> res_moe3_11
	ring_stage3_15_12 -> accum3_12
	accum3_12 -> out_proj3_12
	out_proj3_12 -> res_attn3_12
	res_moe2_12 -> res_attn3_12
	res_attn3_12 -> gate3_12
	gate3_12 -> select3_12
	select3_12 -> expert3_12_0 [label="if selected" style=dashed]
	expert3_12_0 -> expert_act3_12_0
	expert_act3_12_0 -> expert_out3_12_0
	expert_out3_12_0 -> combine3_12
	select3_12 -> expert3_12_1 [label="if selected" style=dashed]
	expert3_12_1 -> expert_act3_12_1
	expert_act3_12_1 -> expert_out3_12_1
	expert_out3_12_1 -> combine3_12
	select3_12 -> expert3_12_2 [label="if selected" style=dashed]
	expert3_12_2 -> expert_act3_12_2
	expert_act3_12_2 -> expert_out3_12_2
	expert_out3_12_2 -> combine3_12
	select3_12 -> expert3_12_3 [label="if selected" style=dashed]
	expert3_12_3 -> expert_act3_12_3
	expert_act3_12_3 -> expert_out3_12_3
	expert_out3_12_3 -> combine3_12
	select3_12 -> expert3_12_4 [label="if selected" style=dashed]
	expert3_12_4 -> expert_act3_12_4
	expert_act3_12_4 -> expert_out3_12_4
	expert_out3_12_4 -> combine3_12
	select3_12 -> expert3_12_5 [label="if selected" style=dashed]
	expert3_12_5 -> expert_act3_12_5
	expert_act3_12_5 -> expert_out3_12_5
	expert_out3_12_5 -> combine3_12
	select3_12 -> expert3_12_6 [label="if selected" style=dashed]
	expert3_12_6 -> expert_act3_12_6
	expert_act3_12_6 -> expert_out3_12_6
	expert_out3_12_6 -> combine3_12
	select3_12 -> expert3_12_7 [label="if selected" style=dashed]
	expert3_12_7 -> expert_act3_12_7
	expert_act3_12_7 -> expert_out3_12_7
	expert_out3_12_7 -> combine3_12
	combine3_12 -> res_moe3_12
	res_attn3_12 -> res_moe3_12
	ring_stage3_15_13 -> accum3_13
	accum3_13 -> out_proj3_13
	out_proj3_13 -> res_attn3_13
	res_moe2_13 -> res_attn3_13
	res_attn3_13 -> gate3_13
	gate3_13 -> select3_13
	select3_13 -> expert3_13_0 [label="if selected" style=dashed]
	expert3_13_0 -> expert_act3_13_0
	expert_act3_13_0 -> expert_out3_13_0
	expert_out3_13_0 -> combine3_13
	select3_13 -> expert3_13_1 [label="if selected" style=dashed]
	expert3_13_1 -> expert_act3_13_1
	expert_act3_13_1 -> expert_out3_13_1
	expert_out3_13_1 -> combine3_13
	select3_13 -> expert3_13_2 [label="if selected" style=dashed]
	expert3_13_2 -> expert_act3_13_2
	expert_act3_13_2 -> expert_out3_13_2
	expert_out3_13_2 -> combine3_13
	select3_13 -> expert3_13_3 [label="if selected" style=dashed]
	expert3_13_3 -> expert_act3_13_3
	expert_act3_13_3 -> expert_out3_13_3
	expert_out3_13_3 -> combine3_13
	select3_13 -> expert3_13_4 [label="if selected" style=dashed]
	expert3_13_4 -> expert_act3_13_4
	expert_act3_13_4 -> expert_out3_13_4
	expert_out3_13_4 -> combine3_13
	select3_13 -> expert3_13_5 [label="if selected" style=dashed]
	expert3_13_5 -> expert_act3_13_5
	expert_act3_13_5 -> expert_out3_13_5
	expert_out3_13_5 -> combine3_13
	select3_13 -> expert3_13_6 [label="if selected" style=dashed]
	expert3_13_6 -> expert_act3_13_6
	expert_act3_13_6 -> expert_out3_13_6
	expert_out3_13_6 -> combine3_13
	select3_13 -> expert3_13_7 [label="if selected" style=dashed]
	expert3_13_7 -> expert_act3_13_7
	expert_act3_13_7 -> expert_out3_13_7
	expert_out3_13_7 -> combine3_13
	combine3_13 -> res_moe3_13
	res_attn3_13 -> res_moe3_13
	ring_stage3_15_14 -> accum3_14
	accum3_14 -> out_proj3_14
	out_proj3_14 -> res_attn3_14
	res_moe2_14 -> res_attn3_14
	res_attn3_14 -> gate3_14
	gate3_14 -> select3_14
	select3_14 -> expert3_14_0 [label="if selected" style=dashed]
	expert3_14_0 -> expert_act3_14_0
	expert_act3_14_0 -> expert_out3_14_0
	expert_out3_14_0 -> combine3_14
	select3_14 -> expert3_14_1 [label="if selected" style=dashed]
	expert3_14_1 -> expert_act3_14_1
	expert_act3_14_1 -> expert_out3_14_1
	expert_out3_14_1 -> combine3_14
	select3_14 -> expert3_14_2 [label="if selected" style=dashed]
	expert3_14_2 -> expert_act3_14_2
	expert_act3_14_2 -> expert_out3_14_2
	expert_out3_14_2 -> combine3_14
	select3_14 -> expert3_14_3 [label="if selected" style=dashed]
	expert3_14_3 -> expert_act3_14_3
	expert_act3_14_3 -> expert_out3_14_3
	expert_out3_14_3 -> combine3_14
	select3_14 -> expert3_14_4 [label="if selected" style=dashed]
	expert3_14_4 -> expert_act3_14_4
	expert_act3_14_4 -> expert_out3_14_4
	expert_out3_14_4 -> combine3_14
	select3_14 -> expert3_14_5 [label="if selected" style=dashed]
	expert3_14_5 -> expert_act3_14_5
	expert_act3_14_5 -> expert_out3_14_5
	expert_out3_14_5 -> combine3_14
	select3_14 -> expert3_14_6 [label="if selected" style=dashed]
	expert3_14_6 -> expert_act3_14_6
	expert_act3_14_6 -> expert_out3_14_6
	expert_out3_14_6 -> combine3_14
	select3_14 -> expert3_14_7 [label="if selected" style=dashed]
	expert3_14_7 -> expert_act3_14_7
	expert_act3_14_7 -> expert_out3_14_7
	expert_out3_14_7 -> combine3_14
	combine3_14 -> res_moe3_14
	res_attn3_14 -> res_moe3_14
	ring_stage3_15_15 -> accum3_15
	accum3_15 -> out_proj3_15
	out_proj3_15 -> res_attn3_15
	res_moe2_15 -> res_attn3_15
	res_attn3_15 -> gate3_15
	gate3_15 -> select3_15
	select3_15 -> expert3_15_0 [label="if selected" style=dashed]
	expert3_15_0 -> expert_act3_15_0
	expert_act3_15_0 -> expert_out3_15_0
	expert_out3_15_0 -> combine3_15
	select3_15 -> expert3_15_1 [label="if selected" style=dashed]
	expert3_15_1 -> expert_act3_15_1
	expert_act3_15_1 -> expert_out3_15_1
	expert_out3_15_1 -> combine3_15
	select3_15 -> expert3_15_2 [label="if selected" style=dashed]
	expert3_15_2 -> expert_act3_15_2
	expert_act3_15_2 -> expert_out3_15_2
	expert_out3_15_2 -> combine3_15
	select3_15 -> expert3_15_3 [label="if selected" style=dashed]
	expert3_15_3 -> expert_act3_15_3
	expert_act3_15_3 -> expert_out3_15_3
	expert_out3_15_3 -> combine3_15
	select3_15 -> expert3_15_4 [label="if selected" style=dashed]
	expert3_15_4 -> expert_act3_15_4
	expert_act3_15_4 -> expert_out3_15_4
	expert_out3_15_4 -> combine3_15
	select3_15 -> expert3_15_5 [label="if selected" style=dashed]
	expert3_15_5 -> expert_act3_15_5
	expert_act3_15_5 -> expert_out3_15_5
	expert_out3_15_5 -> combine3_15
	select3_15 -> expert3_15_6 [label="if selected" style=dashed]
	expert3_15_6 -> expert_act3_15_6
	expert_act3_15_6 -> expert_out3_15_6
	expert_out3_15_6 -> combine3_15
	select3_15 -> expert3_15_7 [label="if selected" style=dashed]
	expert3_15_7 -> expert_act3_15_7
	expert_act3_15_7 -> expert_out3_15_7
	expert_out3_15_7 -> combine3_15
	combine3_15 -> res_moe3_15
	res_attn3_15 -> res_moe3_15
	res_moe3_0 -> sp_gather
	res_moe3_1 -> sp_gather
	res_moe3_2 -> sp_gather
	res_moe3_3 -> sp_gather
	res_moe3_4 -> sp_gather
	res_moe3_5 -> sp_gather
	res_moe3_6 -> sp_gather
	res_moe3_7 -> sp_gather
	res_moe3_8 -> sp_gather
	res_moe3_9 -> sp_gather
	res_moe3_10 -> sp_gather
	res_moe3_11 -> sp_gather
	res_moe3_12 -> sp_gather
	res_moe3_13 -> sp_gather
	res_moe3_14 -> sp_gather
	res_moe3_15 -> sp_gather
	sp_gather -> output
}
