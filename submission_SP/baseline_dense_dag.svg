<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: %3 Pages: 1 -->
<svg width="1440pt" height="300pt"
 viewBox="0.00 0.00 1440.00 299.72" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(0.13 0.13) rotate(0) translate(4 2244.72)">
<title>%3</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-2244.72 10800,-2244.72 10800,4 -4,4"/>
<g id="clust1" class="cluster">
<title>cluster_input</title>
<polygon fill="none" stroke="black" points="6806,-2087.72 6806,-2232.72 7118,-2232.72 7118,-2087.72 6806,-2087.72"/>
<text text-anchor="middle" x="6962" y="-2217.52" font-family="Times,serif" font-size="14.00">Input Layer</text>
</g>
<g id="clust2" class="cluster">
<title>cluster_mha0</title>
<polygon fill="none" stroke="black" points="8982,-1425.81 8982,-1911.22 10788,-1911.22 10788,-1425.81 8982,-1425.81"/>
<text text-anchor="middle" x="9885" y="-1896.02" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust3" class="cluster">
<title>cluster_ffn0</title>
<polygon fill="none" stroke="black" points="7138,-1299.34 7138,-1769.22 8944,-1769.22 8944,-1299.34 7138,-1299.34"/>
<text text-anchor="middle" x="8041" y="-1754.02" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust4" class="cluster">
<title>cluster_layer0</title>
<polygon fill="none" stroke="black" points="6736,-1650.72 6736,-2079.72 7130,-2079.72 7130,-1650.72 6736,-1650.72"/>
<text text-anchor="middle" x="6933" y="-2064.52" font-family="Times,serif" font-size="14.00">Layer 0</text>
</g>
<g id="clust6" class="cluster">
<title>cluster_mha2</title>
<polygon fill="none" stroke="black" points="5324,-930.86 5324,-1402.31 7130,-1402.31 7130,-930.86 5324,-930.86"/>
<text text-anchor="middle" x="6227" y="-1387.11" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust7" class="cluster">
<title>cluster_ffn2</title>
<polygon fill="none" stroke="black" points="3480,-819.91 3480,-1260.31 5286,-1260.31 5286,-819.91 3480,-819.91"/>
<text text-anchor="middle" x="4383" y="-1245.11" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust8" class="cluster">
<title>cluster_layer2</title>
<polygon fill="none" stroke="black" points="3078,-1141.81 3078,-1539.77 3472,-1539.77 3472,-1141.81 3078,-1141.81"/>
<text text-anchor="middle" x="3275" y="-1524.57" font-family="Times,serif" font-size="14.00">Layer 2</text>
</g>
<g id="clust9" class="cluster">
<title>cluster_mha3</title>
<polygon fill="none" stroke="black" points="1634,-708.95 1634,-1133.81 3440,-1133.81 3440,-708.95 1634,-708.95"/>
<text text-anchor="middle" x="2537" y="-1118.61" font-family="Times,serif" font-size="14.00">Multi&#45;Head Attention</text>
</g>
<g id="clust10" class="cluster">
<title>cluster_ffn3</title>
<polygon fill="none" stroke="black" points="8,-8 8,-532.45 1814,-532.45 1814,-8 8,-8"/>
<text text-anchor="middle" x="911" y="-517.25" font-family="Times,serif" font-size="14.00">Feed Forward Network</text>
</g>
<g id="clust11" class="cluster">
<title>cluster_layer3</title>
<polygon fill="none" stroke="black" points="1822,-413.95 1822,-700.95 2216,-700.95 2216,-413.95 1822,-413.95"/>
<text text-anchor="middle" x="2019" y="-685.75" font-family="Times,serif" font-size="14.00">Layer 3</text>
</g>
<g id="clust13" class="cluster">
<title>cluster_output</title>
<polygon fill="none" stroke="black" points="1854,-118.95 1854,-405.95 2216,-405.95 2216,-118.95 1854,-118.95"/>
<text text-anchor="middle" x="2035" y="-390.75" font-family="Times,serif" font-size="14.00">Output Layer</text>
</g>
<!-- input -->
<g id="node1" class="node">
<title>input</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7110.01,-2201.72 6874.56,-2201.72 6813.99,-2095.72 7049.44,-2095.72 7110.01,-2201.72"/>
<text text-anchor="middle" x="6962" y="-2160.02" font-family="Times,serif" font-size="14.00">Input</text>
<text text-anchor="middle" x="6962" y="-2145.02" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="6962" y="-2130.02" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- split0 -->
<g id="node52" class="node">
<title>split0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7121.82,-2048.72 6867.58,-2048.72 6802.18,-1942.72 7056.42,-1942.72 7121.82,-2048.72"/>
<text text-anchor="middle" x="6962" y="-2007.02" font-family="Times,serif" font-size="14.00">Split for Pipeline</text>
<text text-anchor="middle" x="6962" y="-1992.02" font-family="Times,serif" font-size="14.00">X: [B, L/P, d_model]</text>
<text text-anchor="middle" x="6962" y="-1977.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- input&#45;&gt;split0 -->
<g id="edge1" class="edge">
<title>input&#45;&gt;split0</title>
<path fill="none" stroke="black" d="M6962,-2095.33C6962,-2083.55 6962,-2070.94 6962,-2058.81"/>
<polygon fill="black" stroke="black" points="6965.5,-2058.76 6962,-2048.76 6958.5,-2058.76 6965.5,-2058.76"/>
</g>
<!-- qkv0_0 -->
<g id="node2" class="node">
<title>qkv0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10780,-1880.22 10572,-1880.22 10572,-1827.22 10780,-1827.22 10780,-1880.22"/>
<text text-anchor="middle" x="10676" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 0</text>
<text text-anchor="middle" x="10676" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10676" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn0_0 -->
<g id="node10" class="node">
<title>attn0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10780,-1738.22 10572,-1738.22 10572,-1685.22 10780,-1685.22 10780,-1738.22"/>
<text text-anchor="middle" x="10676" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 0</text>
<text text-anchor="middle" x="10676" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10676" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- qkv0_0&#45;&gt;attn0_0 -->
<g id="edge3" class="edge">
<title>qkv0_0&#45;&gt;attn0_0</title>
<path fill="none" stroke="black" d="M10676,-1827.04C10676,-1804.94 10676,-1772.82 10676,-1748.25"/>
<polygon fill="black" stroke="black" points="10679.5,-1748.24 10676,-1738.24 10672.5,-1748.24 10679.5,-1748.24"/>
</g>
<!-- qkv0_1 -->
<g id="node3" class="node">
<title>qkv0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10554,-1880.22 10346,-1880.22 10346,-1827.22 10554,-1827.22 10554,-1880.22"/>
<text text-anchor="middle" x="10450" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 1</text>
<text text-anchor="middle" x="10450" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10450" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attn0_1 -->
<g id="node11" class="node">
<title>attn0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10554,-1738.22 10346,-1738.22 10346,-1685.22 10554,-1685.22 10554,-1738.22"/>
<text text-anchor="middle" x="10450" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 1</text>
<text text-anchor="middle" x="10450" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10450" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- qkv0_1&#45;&gt;attn0_1 -->
<g id="edge7" class="edge">
<title>qkv0_1&#45;&gt;attn0_1</title>
<path fill="none" stroke="black" d="M10450,-1827.04C10450,-1804.94 10450,-1772.82 10450,-1748.25"/>
<polygon fill="black" stroke="black" points="10453.5,-1748.24 10450,-1738.24 10446.5,-1748.24 10453.5,-1748.24"/>
</g>
<!-- qkv0_2 -->
<g id="node4" class="node">
<title>qkv0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10328,-1880.22 10120,-1880.22 10120,-1827.22 10328,-1827.22 10328,-1880.22"/>
<text text-anchor="middle" x="10224" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 2</text>
<text text-anchor="middle" x="10224" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10224" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attn0_2 -->
<g id="node12" class="node">
<title>attn0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10328,-1738.22 10120,-1738.22 10120,-1685.22 10328,-1685.22 10328,-1738.22"/>
<text text-anchor="middle" x="10224" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 2</text>
<text text-anchor="middle" x="10224" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10224" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- qkv0_2&#45;&gt;attn0_2 -->
<g id="edge11" class="edge">
<title>qkv0_2&#45;&gt;attn0_2</title>
<path fill="none" stroke="black" d="M10224,-1827.04C10224,-1804.94 10224,-1772.82 10224,-1748.25"/>
<polygon fill="black" stroke="black" points="10227.5,-1748.24 10224,-1738.24 10220.5,-1748.24 10227.5,-1748.24"/>
</g>
<!-- qkv0_3 -->
<g id="node5" class="node">
<title>qkv0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10102,-1880.22 9894,-1880.22 9894,-1827.22 10102,-1827.22 10102,-1880.22"/>
<text text-anchor="middle" x="9998" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 3</text>
<text text-anchor="middle" x="9998" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9998" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attn0_3 -->
<g id="node13" class="node">
<title>attn0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10102,-1738.22 9894,-1738.22 9894,-1685.22 10102,-1685.22 10102,-1738.22"/>
<text text-anchor="middle" x="9998" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 3</text>
<text text-anchor="middle" x="9998" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9998" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- qkv0_3&#45;&gt;attn0_3 -->
<g id="edge15" class="edge">
<title>qkv0_3&#45;&gt;attn0_3</title>
<path fill="none" stroke="black" d="M9998,-1827.04C9998,-1804.94 9998,-1772.82 9998,-1748.25"/>
<polygon fill="black" stroke="black" points="10001.5,-1748.24 9998,-1738.24 9994.5,-1748.24 10001.5,-1748.24"/>
</g>
<!-- qkv0_4 -->
<g id="node6" class="node">
<title>qkv0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9876,-1880.22 9668,-1880.22 9668,-1827.22 9876,-1827.22 9876,-1880.22"/>
<text text-anchor="middle" x="9772" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 4</text>
<text text-anchor="middle" x="9772" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9772" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attn0_4 -->
<g id="node14" class="node">
<title>attn0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9876,-1738.22 9668,-1738.22 9668,-1685.22 9876,-1685.22 9876,-1738.22"/>
<text text-anchor="middle" x="9772" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 4</text>
<text text-anchor="middle" x="9772" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9772" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- qkv0_4&#45;&gt;attn0_4 -->
<g id="edge19" class="edge">
<title>qkv0_4&#45;&gt;attn0_4</title>
<path fill="none" stroke="black" d="M9772,-1827.04C9772,-1804.94 9772,-1772.82 9772,-1748.25"/>
<polygon fill="black" stroke="black" points="9775.5,-1748.24 9772,-1738.24 9768.5,-1748.24 9775.5,-1748.24"/>
</g>
<!-- qkv0_5 -->
<g id="node7" class="node">
<title>qkv0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9650,-1880.22 9442,-1880.22 9442,-1827.22 9650,-1827.22 9650,-1880.22"/>
<text text-anchor="middle" x="9546" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 5</text>
<text text-anchor="middle" x="9546" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9546" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attn0_5 -->
<g id="node15" class="node">
<title>attn0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9650,-1738.22 9442,-1738.22 9442,-1685.22 9650,-1685.22 9650,-1738.22"/>
<text text-anchor="middle" x="9546" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 5</text>
<text text-anchor="middle" x="9546" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9546" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- qkv0_5&#45;&gt;attn0_5 -->
<g id="edge23" class="edge">
<title>qkv0_5&#45;&gt;attn0_5</title>
<path fill="none" stroke="black" d="M9546,-1827.04C9546,-1804.94 9546,-1772.82 9546,-1748.25"/>
<polygon fill="black" stroke="black" points="9549.5,-1748.24 9546,-1738.24 9542.5,-1748.24 9549.5,-1748.24"/>
</g>
<!-- qkv0_6 -->
<g id="node8" class="node">
<title>qkv0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9424,-1880.22 9216,-1880.22 9216,-1827.22 9424,-1827.22 9424,-1880.22"/>
<text text-anchor="middle" x="9320" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 6</text>
<text text-anchor="middle" x="9320" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9320" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attn0_6 -->
<g id="node16" class="node">
<title>attn0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9424,-1738.22 9216,-1738.22 9216,-1685.22 9424,-1685.22 9424,-1738.22"/>
<text text-anchor="middle" x="9320" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 6</text>
<text text-anchor="middle" x="9320" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9320" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- qkv0_6&#45;&gt;attn0_6 -->
<g id="edge27" class="edge">
<title>qkv0_6&#45;&gt;attn0_6</title>
<path fill="none" stroke="black" d="M9320,-1827.04C9320,-1804.94 9320,-1772.82 9320,-1748.25"/>
<polygon fill="black" stroke="black" points="9323.5,-1748.24 9320,-1738.24 9316.5,-1748.24 9323.5,-1748.24"/>
</g>
<!-- qkv0_7 -->
<g id="node9" class="node">
<title>qkv0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9198,-1880.22 8990,-1880.22 8990,-1827.22 9198,-1827.22 9198,-1880.22"/>
<text text-anchor="middle" x="9094" y="-1865.02" font-family="Times,serif" font-size="14.00">QKV Projection 7</text>
<text text-anchor="middle" x="9094" y="-1850.02" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9094" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attn0_7 -->
<g id="node17" class="node">
<title>attn0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9198,-1738.22 8990,-1738.22 8990,-1685.22 9198,-1685.22 9198,-1738.22"/>
<text text-anchor="middle" x="9094" y="-1723.02" font-family="Times,serif" font-size="14.00">Attention 7</text>
<text text-anchor="middle" x="9094" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9094" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- qkv0_7&#45;&gt;attn0_7 -->
<g id="edge31" class="edge">
<title>qkv0_7&#45;&gt;attn0_7</title>
<path fill="none" stroke="black" d="M9094,-1827.04C9094,-1804.94 9094,-1772.82 9094,-1748.25"/>
<polygon fill="black" stroke="black" points="9097.5,-1748.24 9094,-1738.24 9090.5,-1748.24 9097.5,-1748.24"/>
</g>
<!-- out0_0 -->
<g id="node18" class="node">
<title>out0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10780,-1611.74 10572,-1611.74 10572,-1558.74 10780,-1558.74 10780,-1611.74"/>
<text text-anchor="middle" x="10676" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 0</text>
<text text-anchor="middle" x="10676" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10676" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- attn0_0&#45;&gt;out0_0 -->
<g id="edge4" class="edge">
<title>attn0_0&#45;&gt;out0_0</title>
<path fill="none" stroke="black" d="M10676,-1684.93C10676,-1666.74 10676,-1642.13 10676,-1622.04"/>
<polygon fill="black" stroke="black" points="10679.5,-1622 10676,-1612 10672.5,-1622 10679.5,-1622"/>
</g>
<!-- out0_1 -->
<g id="node19" class="node">
<title>out0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10554,-1611.74 10346,-1611.74 10346,-1558.74 10554,-1558.74 10554,-1611.74"/>
<text text-anchor="middle" x="10450" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 1</text>
<text text-anchor="middle" x="10450" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10450" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- attn0_1&#45;&gt;out0_1 -->
<g id="edge8" class="edge">
<title>attn0_1&#45;&gt;out0_1</title>
<path fill="none" stroke="black" d="M10450,-1684.93C10450,-1666.74 10450,-1642.13 10450,-1622.04"/>
<polygon fill="black" stroke="black" points="10453.5,-1622 10450,-1612 10446.5,-1622 10453.5,-1622"/>
</g>
<!-- out0_2 -->
<g id="node20" class="node">
<title>out0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10328,-1611.74 10120,-1611.74 10120,-1558.74 10328,-1558.74 10328,-1611.74"/>
<text text-anchor="middle" x="10224" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 2</text>
<text text-anchor="middle" x="10224" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="10224" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- attn0_2&#45;&gt;out0_2 -->
<g id="edge12" class="edge">
<title>attn0_2&#45;&gt;out0_2</title>
<path fill="none" stroke="black" d="M10224,-1684.93C10224,-1666.74 10224,-1642.13 10224,-1622.04"/>
<polygon fill="black" stroke="black" points="10227.5,-1622 10224,-1612 10220.5,-1622 10227.5,-1622"/>
</g>
<!-- out0_3 -->
<g id="node21" class="node">
<title>out0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="10102,-1611.74 9894,-1611.74 9894,-1558.74 10102,-1558.74 10102,-1611.74"/>
<text text-anchor="middle" x="9998" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 3</text>
<text text-anchor="middle" x="9998" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9998" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- attn0_3&#45;&gt;out0_3 -->
<g id="edge16" class="edge">
<title>attn0_3&#45;&gt;out0_3</title>
<path fill="none" stroke="black" d="M9998,-1684.93C9998,-1666.74 9998,-1642.13 9998,-1622.04"/>
<polygon fill="black" stroke="black" points="10001.5,-1622 9998,-1612 9994.5,-1622 10001.5,-1622"/>
</g>
<!-- out0_4 -->
<g id="node22" class="node">
<title>out0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9876,-1611.74 9668,-1611.74 9668,-1558.74 9876,-1558.74 9876,-1611.74"/>
<text text-anchor="middle" x="9772" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 4</text>
<text text-anchor="middle" x="9772" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9772" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- attn0_4&#45;&gt;out0_4 -->
<g id="edge20" class="edge">
<title>attn0_4&#45;&gt;out0_4</title>
<path fill="none" stroke="black" d="M9772,-1684.93C9772,-1666.74 9772,-1642.13 9772,-1622.04"/>
<polygon fill="black" stroke="black" points="9775.5,-1622 9772,-1612 9768.5,-1622 9775.5,-1622"/>
</g>
<!-- out0_5 -->
<g id="node23" class="node">
<title>out0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9650,-1611.74 9442,-1611.74 9442,-1558.74 9650,-1558.74 9650,-1611.74"/>
<text text-anchor="middle" x="9546" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 5</text>
<text text-anchor="middle" x="9546" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9546" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- attn0_5&#45;&gt;out0_5 -->
<g id="edge24" class="edge">
<title>attn0_5&#45;&gt;out0_5</title>
<path fill="none" stroke="black" d="M9546,-1684.93C9546,-1666.74 9546,-1642.13 9546,-1622.04"/>
<polygon fill="black" stroke="black" points="9549.5,-1622 9546,-1612 9542.5,-1622 9549.5,-1622"/>
</g>
<!-- out0_6 -->
<g id="node24" class="node">
<title>out0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9424,-1611.74 9216,-1611.74 9216,-1558.74 9424,-1558.74 9424,-1611.74"/>
<text text-anchor="middle" x="9320" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 6</text>
<text text-anchor="middle" x="9320" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9320" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- attn0_6&#45;&gt;out0_6 -->
<g id="edge28" class="edge">
<title>attn0_6&#45;&gt;out0_6</title>
<path fill="none" stroke="black" d="M9320,-1684.93C9320,-1666.74 9320,-1642.13 9320,-1622.04"/>
<polygon fill="black" stroke="black" points="9323.5,-1622 9320,-1612 9316.5,-1622 9323.5,-1622"/>
</g>
<!-- out0_7 -->
<g id="node25" class="node">
<title>out0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="9198,-1611.74 8990,-1611.74 8990,-1558.74 9198,-1558.74 9198,-1611.74"/>
<text text-anchor="middle" x="9094" y="-1596.54" font-family="Times,serif" font-size="14.00">Output Proj 7</text>
<text text-anchor="middle" x="9094" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="9094" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- attn0_7&#45;&gt;out0_7 -->
<g id="edge32" class="edge">
<title>attn0_7&#45;&gt;out0_7</title>
<path fill="none" stroke="black" d="M9094,-1684.93C9094,-1666.74 9094,-1642.13 9094,-1622.04"/>
<polygon fill="black" stroke="black" points="9097.5,-1622 9094,-1612 9090.5,-1622 9097.5,-1622"/>
</g>
<!-- ar0 -->
<g id="node26" class="node">
<title>ar0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="9772" cy="-1471.29" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="9772" y="-1482.59" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="9772" y="-1467.59" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="9772" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- out0_0&#45;&gt;ar0 -->
<g id="edge5" class="edge">
<title>out0_0&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M10604.89,-1558.71C10591.14,-1554.51 10576.73,-1550.6 10563,-1547.77 10328.68,-1499.37 10048.79,-1481.91 9892.63,-1475.68"/>
<polygon fill="black" stroke="black" points="9892.65,-1472.17 9882.52,-1475.28 9892.38,-1479.17 9892.65,-1472.17"/>
</g>
<!-- out0_1&#45;&gt;ar0 -->
<g id="edge9" class="edge">
<title>out0_1&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M10377.29,-1558.66C10364,-1554.59 10350.17,-1550.75 10337,-1547.77 10184.4,-1513.24 10004.78,-1492.57 9889.73,-1481.81"/>
<polygon fill="black" stroke="black" points="9889.77,-1478.3 9879.49,-1480.87 9889.13,-1485.27 9889.77,-1478.3"/>
</g>
<!-- out0_2&#45;&gt;ar0 -->
<g id="edge13" class="edge">
<title>out0_2&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M10148.31,-1558.74C10135.9,-1554.87 10123.13,-1551.07 10111,-1547.77 10033.25,-1526.61 9944.29,-1506.97 9877.02,-1493.04"/>
<polygon fill="black" stroke="black" points="9877.33,-1489.53 9866.83,-1490.94 9875.92,-1496.38 9877.33,-1489.53"/>
</g>
<!-- out0_3&#45;&gt;ar0 -->
<g id="edge17" class="edge">
<title>out0_3&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M9946.43,-1558.7C9915.71,-1543.48 9876.28,-1523.95 9842.69,-1507.31"/>
<polygon fill="black" stroke="black" points="9843.89,-1504 9833.38,-1502.7 9840.79,-1510.27 9843.89,-1504"/>
</g>
<!-- out0_4&#45;&gt;ar0 -->
<g id="edge21" class="edge">
<title>out0_4&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M9772,-1558.56C9772,-1546.83 9772,-1532.56 9772,-1519.03"/>
<polygon fill="black" stroke="black" points="9775.5,-1518.89 9772,-1508.89 9768.5,-1518.89 9775.5,-1518.89"/>
</g>
<!-- out0_5&#45;&gt;ar0 -->
<g id="edge25" class="edge">
<title>out0_5&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M9597.57,-1558.7C9628.29,-1543.48 9667.72,-1523.95 9701.31,-1507.31"/>
<polygon fill="black" stroke="black" points="9703.21,-1510.27 9710.62,-1502.7 9700.11,-1504 9703.21,-1510.27"/>
</g>
<!-- out0_6&#45;&gt;ar0 -->
<g id="edge29" class="edge">
<title>out0_6&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M9395.69,-1558.74C9408.1,-1554.87 9420.87,-1551.07 9433,-1547.77 9510.75,-1526.61 9599.71,-1506.97 9666.98,-1493.04"/>
<polygon fill="black" stroke="black" points="9668.08,-1496.38 9677.17,-1490.94 9666.67,-1489.53 9668.08,-1496.38"/>
</g>
<!-- out0_7&#45;&gt;ar0 -->
<g id="edge33" class="edge">
<title>out0_7&#45;&gt;ar0</title>
<path fill="none" stroke="black" d="M9166.71,-1558.66C9180,-1554.59 9193.83,-1550.75 9207,-1547.77 9359.6,-1513.24 9539.22,-1492.57 9654.27,-1481.81"/>
<polygon fill="black" stroke="black" points="9654.87,-1485.27 9664.51,-1480.87 9654.23,-1478.3 9654.87,-1485.27"/>
</g>
<!-- res0 -->
<g id="node53" class="node">
<title>res0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7121.88,-1906.72 6821.42,-1906.72 6744.12,-1800.72 7044.58,-1800.72 7121.88,-1906.72"/>
<text text-anchor="middle" x="6933" y="-1865.02" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6933" y="-1850.02" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="6933" y="-1835.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ar0&#45;&gt;res0 -->
<g id="edge34" class="edge">
<title>ar0&#45;&gt;res0</title>
<path fill="none" stroke="black" d="M9661.44,-1475.4C9455.45,-1482.27 9029.35,-1501.9 8981,-1547.77 8908.8,-1616.25 9022.01,-1702.7 8948,-1769.22 8879.34,-1830.93 7555.7,-1847.64 7091.9,-1851.61"/>
<polygon fill="black" stroke="black" points="7091.75,-1848.11 7081.78,-1851.69 7091.81,-1855.11 7091.75,-1848.11"/>
</g>
<!-- ffn1_0_0 -->
<g id="node27" class="node">
<title>ffn1_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8880.5,-1738.22 8679.5,-1738.22 8679.5,-1685.22 8880.5,-1685.22 8880.5,-1738.22"/>
<text text-anchor="middle" x="8780" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 0</text>
<text text-anchor="middle" x="8780" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8780" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act0_0 -->
<g id="node35" class="node">
<title>act0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8925.5,-1611.74 8724.5,-1611.74 8724.5,-1558.74 8925.5,-1558.74 8925.5,-1611.74"/>
<text text-anchor="middle" x="8825" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 0</text>
<text text-anchor="middle" x="8825" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8825" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- ffn1_0_0&#45;&gt;act0_0 -->
<g id="edge37" class="edge">
<title>ffn1_0_0&#45;&gt;act0_0</title>
<path fill="none" stroke="black" d="M8789.32,-1684.93C8795.96,-1666.57 8804.96,-1641.68 8812.26,-1621.49"/>
<polygon fill="black" stroke="black" points="8815.58,-1622.6 8815.69,-1612 8809,-1620.22 8815.58,-1622.6"/>
</g>
<!-- ffn1_0_1 -->
<g id="node28" class="node">
<title>ffn1_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8661.5,-1738.22 8460.5,-1738.22 8460.5,-1685.22 8661.5,-1685.22 8661.5,-1738.22"/>
<text text-anchor="middle" x="8561" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 1</text>
<text text-anchor="middle" x="8561" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8561" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act0_1 -->
<g id="node36" class="node">
<title>act0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8699.5,-1611.74 8498.5,-1611.74 8498.5,-1558.74 8699.5,-1558.74 8699.5,-1611.74"/>
<text text-anchor="middle" x="8599" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 1</text>
<text text-anchor="middle" x="8599" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8599" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- ffn1_0_1&#45;&gt;act0_1 -->
<g id="edge41" class="edge">
<title>ffn1_0_1&#45;&gt;act0_1</title>
<path fill="none" stroke="black" d="M8568.87,-1684.93C8574.45,-1666.65 8582.01,-1641.9 8588.16,-1621.76"/>
<polygon fill="black" stroke="black" points="8591.56,-1622.59 8591.14,-1612 8584.87,-1620.54 8591.56,-1622.59"/>
</g>
<!-- ffn1_0_2 -->
<g id="node29" class="node">
<title>ffn1_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8442.5,-1738.22 8241.5,-1738.22 8241.5,-1685.22 8442.5,-1685.22 8442.5,-1738.22"/>
<text text-anchor="middle" x="8342" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 2</text>
<text text-anchor="middle" x="8342" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8342" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act0_2 -->
<g id="node37" class="node">
<title>act0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8473.5,-1611.74 8272.5,-1611.74 8272.5,-1558.74 8473.5,-1558.74 8473.5,-1611.74"/>
<text text-anchor="middle" x="8373" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 2</text>
<text text-anchor="middle" x="8373" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8373" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- ffn1_0_2&#45;&gt;act0_2 -->
<g id="edge45" class="edge">
<title>ffn1_0_2&#45;&gt;act0_2</title>
<path fill="none" stroke="black" d="M8348.42,-1684.93C8352.97,-1666.65 8359.14,-1641.9 8364.15,-1621.76"/>
<polygon fill="black" stroke="black" points="8367.56,-1622.55 8366.59,-1612 8360.77,-1620.86 8367.56,-1622.55"/>
</g>
<!-- ffn1_0_3 -->
<g id="node30" class="node">
<title>ffn1_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8223.5,-1738.22 8022.5,-1738.22 8022.5,-1685.22 8223.5,-1685.22 8223.5,-1738.22"/>
<text text-anchor="middle" x="8123" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 3</text>
<text text-anchor="middle" x="8123" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8123" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act0_3 -->
<g id="node38" class="node">
<title>act0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8247.5,-1611.74 8046.5,-1611.74 8046.5,-1558.74 8247.5,-1558.74 8247.5,-1611.74"/>
<text text-anchor="middle" x="8147" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 3</text>
<text text-anchor="middle" x="8147" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="8147" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- ffn1_0_3&#45;&gt;act0_3 -->
<g id="edge49" class="edge">
<title>ffn1_0_3&#45;&gt;act0_3</title>
<path fill="none" stroke="black" d="M8127.97,-1684.93C8131.48,-1666.74 8136.22,-1642.13 8140.1,-1622.04"/>
<polygon fill="black" stroke="black" points="8143.58,-1622.48 8142.03,-1612 8136.7,-1621.16 8143.58,-1622.48"/>
</g>
<!-- ffn1_0_4 -->
<g id="node31" class="node">
<title>ffn1_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8004.5,-1738.22 7803.5,-1738.22 7803.5,-1685.22 8004.5,-1685.22 8004.5,-1738.22"/>
<text text-anchor="middle" x="7904" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 4</text>
<text text-anchor="middle" x="7904" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7904" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act0_4 -->
<g id="node39" class="node">
<title>act0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8021.5,-1611.74 7820.5,-1611.74 7820.5,-1558.74 8021.5,-1558.74 8021.5,-1611.74"/>
<text text-anchor="middle" x="7921" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 4</text>
<text text-anchor="middle" x="7921" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7921" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- ffn1_0_4&#45;&gt;act0_4 -->
<g id="edge53" class="edge">
<title>ffn1_0_4&#45;&gt;act0_4</title>
<path fill="none" stroke="black" d="M7907.52,-1684.93C7910.01,-1666.74 7913.37,-1642.13 7916.11,-1622.04"/>
<polygon fill="black" stroke="black" points="7919.6,-1622.38 7917.48,-1612 7912.66,-1621.44 7919.6,-1622.38"/>
</g>
<!-- ffn1_0_5 -->
<g id="node32" class="node">
<title>ffn1_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7785.5,-1738.22 7584.5,-1738.22 7584.5,-1685.22 7785.5,-1685.22 7785.5,-1738.22"/>
<text text-anchor="middle" x="7685" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 5</text>
<text text-anchor="middle" x="7685" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7685" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act0_5 -->
<g id="node40" class="node">
<title>act0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7796.5,-1611.74 7595.5,-1611.74 7595.5,-1558.74 7796.5,-1558.74 7796.5,-1611.74"/>
<text text-anchor="middle" x="7696" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 5</text>
<text text-anchor="middle" x="7696" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7696" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- ffn1_0_5&#45;&gt;act0_5 -->
<g id="edge57" class="edge">
<title>ffn1_0_5&#45;&gt;act0_5</title>
<path fill="none" stroke="black" d="M7687.28,-1684.93C7688.89,-1666.74 7691.06,-1642.13 7692.84,-1622.04"/>
<polygon fill="black" stroke="black" points="7696.33,-1622.27 7693.72,-1612 7689.36,-1621.65 7696.33,-1622.27"/>
</g>
<!-- ffn1_0_6 -->
<g id="node33" class="node">
<title>ffn1_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7566.5,-1738.22 7365.5,-1738.22 7365.5,-1685.22 7566.5,-1685.22 7566.5,-1738.22"/>
<text text-anchor="middle" x="7466" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 6</text>
<text text-anchor="middle" x="7466" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7466" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act0_6 -->
<g id="node41" class="node">
<title>act0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7571.5,-1611.74 7370.5,-1611.74 7370.5,-1558.74 7571.5,-1558.74 7571.5,-1611.74"/>
<text text-anchor="middle" x="7471" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 6</text>
<text text-anchor="middle" x="7471" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7471" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- ffn1_0_6&#45;&gt;act0_6 -->
<g id="edge61" class="edge">
<title>ffn1_0_6&#45;&gt;act0_6</title>
<path fill="none" stroke="black" d="M7467.04,-1684.93C7467.77,-1666.74 7468.76,-1642.13 7469.56,-1622.04"/>
<polygon fill="black" stroke="black" points="7473.06,-1622.13 7469.97,-1612 7466.07,-1621.85 7473.06,-1622.13"/>
</g>
<!-- ffn1_0_7 -->
<g id="node34" class="node">
<title>ffn1_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7347.5,-1738.22 7146.5,-1738.22 7146.5,-1685.22 7347.5,-1685.22 7347.5,-1738.22"/>
<text text-anchor="middle" x="7247" y="-1723.02" font-family="Times,serif" font-size="14.00">FFN Linear1 7</text>
<text text-anchor="middle" x="7247" y="-1708.02" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7247" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act0_7 -->
<g id="node42" class="node">
<title>act0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7348.5,-1611.74 7147.5,-1611.74 7147.5,-1558.74 7348.5,-1558.74 7348.5,-1611.74"/>
<text text-anchor="middle" x="7248" y="-1596.54" font-family="Times,serif" font-size="14.00">GELU 7</text>
<text text-anchor="middle" x="7248" y="-1581.54" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="7248" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- ffn1_0_7&#45;&gt;act0_7 -->
<g id="edge65" class="edge">
<title>ffn1_0_7&#45;&gt;act0_7</title>
<path fill="none" stroke="black" d="M7247.21,-1684.93C7247.35,-1666.74 7247.55,-1642.13 7247.71,-1622.04"/>
<polygon fill="black" stroke="black" points="7251.21,-1622.03 7247.79,-1612 7244.21,-1621.97 7251.21,-1622.03"/>
</g>
<!-- ffn2_0_0 -->
<g id="node43" class="node">
<title>ffn2_0_0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8936,-1497.79 8728,-1497.79 8728,-1444.79 8936,-1444.79 8936,-1497.79"/>
<text text-anchor="middle" x="8832" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 0</text>
<text text-anchor="middle" x="8832" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="8832" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 0</text>
</g>
<!-- act0_0&#45;&gt;ffn2_0_0 -->
<g id="edge38" class="edge">
<title>act0_0&#45;&gt;ffn2_0_0</title>
<path fill="none" stroke="black" d="M8826.61,-1558.56C8827.54,-1543.63 8828.73,-1524.58 8829.76,-1508.18"/>
<polygon fill="black" stroke="black" points="8833.27,-1508.05 8830.4,-1497.85 8826.28,-1507.62 8833.27,-1508.05"/>
</g>
<!-- ffn2_0_1 -->
<g id="node44" class="node">
<title>ffn2_0_1</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8710,-1497.79 8502,-1497.79 8502,-1444.79 8710,-1444.79 8710,-1497.79"/>
<text text-anchor="middle" x="8606" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 1</text>
<text text-anchor="middle" x="8606" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="8606" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 1</text>
</g>
<!-- act0_1&#45;&gt;ffn2_0_1 -->
<g id="edge42" class="edge">
<title>act0_1&#45;&gt;ffn2_0_1</title>
<path fill="none" stroke="black" d="M8600.61,-1558.56C8601.54,-1543.63 8602.73,-1524.58 8603.76,-1508.18"/>
<polygon fill="black" stroke="black" points="8607.27,-1508.05 8604.4,-1497.85 8600.28,-1507.62 8607.27,-1508.05"/>
</g>
<!-- ffn2_0_2 -->
<g id="node45" class="node">
<title>ffn2_0_2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8484,-1497.79 8276,-1497.79 8276,-1444.79 8484,-1444.79 8484,-1497.79"/>
<text text-anchor="middle" x="8380" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 2</text>
<text text-anchor="middle" x="8380" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="8380" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 2</text>
</g>
<!-- act0_2&#45;&gt;ffn2_0_2 -->
<g id="edge46" class="edge">
<title>act0_2&#45;&gt;ffn2_0_2</title>
<path fill="none" stroke="black" d="M8374.61,-1558.56C8375.54,-1543.63 8376.73,-1524.58 8377.76,-1508.18"/>
<polygon fill="black" stroke="black" points="8381.27,-1508.05 8378.4,-1497.85 8374.28,-1507.62 8381.27,-1508.05"/>
</g>
<!-- ffn2_0_3 -->
<g id="node46" class="node">
<title>ffn2_0_3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8258,-1497.79 8050,-1497.79 8050,-1444.79 8258,-1444.79 8258,-1497.79"/>
<text text-anchor="middle" x="8154" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 3</text>
<text text-anchor="middle" x="8154" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="8154" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 3</text>
</g>
<!-- act0_3&#45;&gt;ffn2_0_3 -->
<g id="edge50" class="edge">
<title>act0_3&#45;&gt;ffn2_0_3</title>
<path fill="none" stroke="black" d="M8148.61,-1558.56C8149.54,-1543.63 8150.73,-1524.58 8151.76,-1508.18"/>
<polygon fill="black" stroke="black" points="8155.27,-1508.05 8152.4,-1497.85 8148.28,-1507.62 8155.27,-1508.05"/>
</g>
<!-- ffn2_0_4 -->
<g id="node47" class="node">
<title>ffn2_0_4</title>
<polygon fill="lightyellow" stroke="lightyellow" points="8032,-1497.79 7824,-1497.79 7824,-1444.79 8032,-1444.79 8032,-1497.79"/>
<text text-anchor="middle" x="7928" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 4</text>
<text text-anchor="middle" x="7928" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7928" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 4</text>
</g>
<!-- act0_4&#45;&gt;ffn2_0_4 -->
<g id="edge54" class="edge">
<title>act0_4&#45;&gt;ffn2_0_4</title>
<path fill="none" stroke="black" d="M7922.61,-1558.56C7923.54,-1543.63 7924.73,-1524.58 7925.76,-1508.18"/>
<polygon fill="black" stroke="black" points="7929.27,-1508.05 7926.4,-1497.85 7922.28,-1507.62 7929.27,-1508.05"/>
</g>
<!-- ffn2_0_5 -->
<g id="node48" class="node">
<title>ffn2_0_5</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7806,-1497.79 7598,-1497.79 7598,-1444.79 7806,-1444.79 7806,-1497.79"/>
<text text-anchor="middle" x="7702" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 5</text>
<text text-anchor="middle" x="7702" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7702" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 5</text>
</g>
<!-- act0_5&#45;&gt;ffn2_0_5 -->
<g id="edge58" class="edge">
<title>act0_5&#45;&gt;ffn2_0_5</title>
<path fill="none" stroke="black" d="M7697.38,-1558.56C7698.18,-1543.63 7699.2,-1524.58 7700.08,-1508.18"/>
<polygon fill="black" stroke="black" points="7703.59,-1508.03 7700.63,-1497.85 7696.6,-1507.65 7703.59,-1508.03"/>
</g>
<!-- ffn2_0_6 -->
<g id="node49" class="node">
<title>ffn2_0_6</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7580,-1497.79 7372,-1497.79 7372,-1444.79 7580,-1444.79 7580,-1497.79"/>
<text text-anchor="middle" x="7476" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 6</text>
<text text-anchor="middle" x="7476" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7476" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 6</text>
</g>
<!-- act0_6&#45;&gt;ffn2_0_6 -->
<g id="edge62" class="edge">
<title>act0_6&#45;&gt;ffn2_0_6</title>
<path fill="none" stroke="black" d="M7472.15,-1558.56C7472.81,-1543.63 7473.66,-1524.58 7474.4,-1508.18"/>
<polygon fill="black" stroke="black" points="7477.91,-1508 7474.86,-1497.85 7470.92,-1507.69 7477.91,-1508"/>
</g>
<!-- ffn2_0_7 -->
<g id="node50" class="node">
<title>ffn2_0_7</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7354,-1497.79 7146,-1497.79 7146,-1444.79 7354,-1444.79 7354,-1497.79"/>
<text text-anchor="middle" x="7250" y="-1482.59" font-family="Times,serif" font-size="14.00">FFN Linear2 7</text>
<text text-anchor="middle" x="7250" y="-1467.59" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7250" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 7</text>
</g>
<!-- act0_7&#45;&gt;ffn2_0_7 -->
<g id="edge66" class="edge">
<title>act0_7&#45;&gt;ffn2_0_7</title>
<path fill="none" stroke="black" d="M7248.46,-1558.56C7248.73,-1543.63 7249.07,-1524.58 7249.36,-1508.18"/>
<polygon fill="black" stroke="black" points="7252.86,-1507.92 7249.54,-1497.85 7245.87,-1507.79 7252.86,-1507.92"/>
</g>
<!-- ar_ffn0 -->
<g id="node51" class="node">
<title>ar_ffn0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="7928" cy="-1344.81" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="7928" y="-1356.11" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="7928" y="-1341.11" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="7928" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ffn2_0_0&#45;&gt;ar_ffn0 -->
<g id="edge39" class="edge">
<title>ffn2_0_0&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M8776.08,-1444.78C8758.18,-1437.57 8738.05,-1430.43 8719,-1425.81 8486.35,-1369.4 8205.86,-1352.71 8049.15,-1347.81"/>
<polygon fill="black" stroke="black" points="8049.11,-1344.3 8039,-1347.5 8048.89,-1351.3 8049.11,-1344.3"/>
</g>
<!-- ffn2_0_1&#45;&gt;ar_ffn0 -->
<g id="edge43" class="edge">
<title>ffn2_0_1&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M8548.8,-1444.77C8531.19,-1437.74 8511.55,-1430.71 8493,-1425.81 8341.66,-1385.91 8161.94,-1364.79 8046.5,-1354.47"/>
<polygon fill="black" stroke="black" points="8046.5,-1350.95 8036.23,-1353.56 8045.88,-1357.92 8046.5,-1350.95"/>
</g>
<!-- ffn2_0_2&#45;&gt;ar_ffn0 -->
<g id="edge47" class="edge">
<title>ffn2_0_2&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M8319.87,-1444.78C8302.95,-1438.11 8284.4,-1431.26 8267,-1425.81 8189.58,-1401.58 8100.21,-1380.78 8032.67,-1366.46"/>
<polygon fill="black" stroke="black" points="8033.38,-1363.03 8022.87,-1364.4 8031.93,-1369.88 8033.38,-1363.03"/>
</g>
<!-- ffn2_0_3&#45;&gt;ar_ffn0 -->
<g id="edge51" class="edge">
<title>ffn2_0_3&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M8107.45,-1444.65C8074.69,-1426.61 8030.38,-1402.2 7993.98,-1382.15"/>
<polygon fill="black" stroke="black" points="7995.36,-1378.92 7984.91,-1377.16 7991.98,-1385.05 7995.36,-1378.92"/>
</g>
<!-- ffn2_0_4&#45;&gt;ar_ffn0 -->
<g id="edge55" class="edge">
<title>ffn2_0_4&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M7928,-1444.5C7928,-1429.5 7928,-1410.13 7928,-1392.54"/>
<polygon fill="black" stroke="black" points="7931.5,-1392.43 7928,-1382.43 7924.5,-1392.43 7931.5,-1392.43"/>
</g>
<!-- ffn2_0_5&#45;&gt;ar_ffn0 -->
<g id="edge59" class="edge">
<title>ffn2_0_5&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M7748.55,-1444.65C7781.31,-1426.61 7825.62,-1402.2 7862.02,-1382.15"/>
<polygon fill="black" stroke="black" points="7864.02,-1385.05 7871.09,-1377.16 7860.64,-1378.92 7864.02,-1385.05"/>
</g>
<!-- ffn2_0_6&#45;&gt;ar_ffn0 -->
<g id="edge63" class="edge">
<title>ffn2_0_6&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M7536.13,-1444.78C7553.05,-1438.11 7571.6,-1431.26 7589,-1425.81 7666.42,-1401.58 7755.79,-1380.78 7823.33,-1366.46"/>
<polygon fill="black" stroke="black" points="7824.07,-1369.88 7833.13,-1364.4 7822.62,-1363.03 7824.07,-1369.88"/>
</g>
<!-- ffn2_0_7&#45;&gt;ar_ffn0 -->
<g id="edge67" class="edge">
<title>ffn2_0_7&#45;&gt;ar_ffn0</title>
<path fill="none" stroke="black" d="M7307.2,-1444.77C7324.81,-1437.74 7344.45,-1430.71 7363,-1425.81 7514.34,-1385.91 7694.06,-1364.79 7809.5,-1354.47"/>
<polygon fill="black" stroke="black" points="7810.12,-1357.92 7819.77,-1353.56 7809.5,-1350.95 7810.12,-1357.92"/>
</g>
<!-- res_ffn0 -->
<g id="node54" class="node">
<title>res_ffn0</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7121.88,-1764.72 6821.42,-1764.72 6744.12,-1658.72 7044.58,-1658.72 7121.88,-1764.72"/>
<text text-anchor="middle" x="6933" y="-1723.02" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="6933" y="-1708.02" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="6933" y="-1693.02" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7</text>
</g>
<!-- ar_ffn0&#45;&gt;res_ffn0 -->
<g id="edge68" class="edge">
<title>ar_ffn0&#45;&gt;res_ffn0</title>
<path fill="none" stroke="black" d="M7817.01,-1345.95C7627.22,-1347.98 7249.86,-1360.43 7137,-1425.81 7049.27,-1476.64 6989.31,-1582.04 6958.14,-1649.41"/>
<polygon fill="black" stroke="black" points="6954.89,-1648.11 6953.93,-1658.66 6961.26,-1651.01 6954.89,-1648.11"/>
</g>
<!-- split0&#45;&gt;qkv0_0 -->
<g id="edge2" class="edge">
<title>split0&#45;&gt;qkv0_0</title>
<path fill="none" stroke="black" d="M7089.09,-1995.07C7688.81,-1996.25 10220.95,-1996.16 10563,-1911.22 10585.05,-1905.74 10607.76,-1895.45 10626.98,-1885.13"/>
<polygon fill="black" stroke="black" points="10628.77,-1888.14 10635.84,-1880.24 10625.39,-1882.01 10628.77,-1888.14"/>
</g>
<!-- split0&#45;&gt;qkv0_1 -->
<g id="edge6" class="edge">
<title>split0&#45;&gt;qkv0_1</title>
<path fill="none" stroke="black" d="M7088.7,-1994.85C7664.23,-1995.01 10017.89,-1990.73 10337,-1911.22 10359.05,-1905.73 10381.76,-1895.43 10400.98,-1885.11"/>
<polygon fill="black" stroke="black" points="10402.77,-1888.12 10409.83,-1880.23 10399.39,-1881.99 10402.77,-1888.12"/>
</g>
<!-- split0&#45;&gt;qkv0_2 -->
<g id="edge10" class="edge">
<title>split0&#45;&gt;qkv0_2</title>
<path fill="none" stroke="black" d="M7088.88,-1994.61C7640.4,-1993.67 9814.89,-1985.28 10111,-1911.22 10132.95,-1905.73 10155.56,-1895.49 10174.73,-1885.22"/>
<polygon fill="black" stroke="black" points="10176.5,-1888.24 10183.57,-1880.36 10173.12,-1882.11 10176.5,-1888.24"/>
</g>
<!-- split0&#45;&gt;qkv0_3 -->
<g id="edge14" class="edge">
<title>split0&#45;&gt;qkv0_3</title>
<path fill="none" stroke="black" d="M7088.52,-1994.32C7614.28,-1992.25 9611.73,-1979.86 9885,-1911.22 9906.95,-1905.71 9929.55,-1895.46 9948.73,-1885.19"/>
<polygon fill="black" stroke="black" points="9950.49,-1888.22 9957.56,-1880.33 9947.11,-1882.09 9950.49,-1888.22"/>
</g>
<!-- split0&#45;&gt;qkv0_4 -->
<g id="edge18" class="edge">
<title>split0&#45;&gt;qkv0_4</title>
<path fill="none" stroke="black" d="M7088.34,-1994C7587.66,-1990.71 9408.55,-1974.45 9659,-1911.22 9680.94,-1905.68 9703.55,-1895.43 9722.72,-1885.17"/>
<polygon fill="black" stroke="black" points="9724.48,-1888.19 9731.56,-1880.31 9721.11,-1882.06 9724.48,-1888.19"/>
</g>
<!-- split0&#45;&gt;qkv0_5 -->
<g id="edge22" class="edge">
<title>split0&#45;&gt;qkv0_5</title>
<path fill="none" stroke="black" d="M7088.06,-1993.61C7559.75,-1989.04 9205.29,-1969.05 9433,-1911.22 9454.93,-1905.65 9477.54,-1895.39 9496.71,-1885.13"/>
<polygon fill="black" stroke="black" points="9498.47,-1888.16 9505.55,-1880.28 9495.1,-1882.03 9498.47,-1888.16"/>
</g>
<!-- split0&#45;&gt;qkv0_6 -->
<g id="edge26" class="edge">
<title>split0&#45;&gt;qkv0_6</title>
<path fill="none" stroke="black" d="M7087.78,-1993.15C7530.62,-1987.21 9001.95,-1963.67 9207,-1911.22 9228.92,-1905.61 9251.53,-1895.35 9270.7,-1885.09"/>
<polygon fill="black" stroke="black" points="9272.46,-1888.12 9279.54,-1880.24 9269.09,-1881.99 9272.46,-1888.12"/>
</g>
<!-- split0&#45;&gt;qkv0_7 -->
<g id="edge30" class="edge">
<title>split0&#45;&gt;qkv0_7</title>
<path fill="none" stroke="black" d="M7083.9,-1986.72C7462.06,-1961.88 8611.95,-1886.37 8979.64,-1862.23"/>
<polygon fill="black" stroke="black" points="8980.02,-1865.71 8989.77,-1861.56 8979.56,-1858.73 8980.02,-1865.71"/>
</g>
<!-- split0&#45;&gt;res0 -->
<g id="edge35" class="edge">
<title>split0&#45;&gt;res0</title>
<path fill="none" stroke="black" d="M6951.2,-1942.59C6949.47,-1934.21 6947.65,-1925.46 6945.87,-1916.87"/>
<polygon fill="black" stroke="black" points="6949.26,-1915.98 6943.81,-1906.89 6942.41,-1917.4 6949.26,-1915.98"/>
</g>
<!-- res0&#45;&gt;ffn1_0_0 -->
<g id="edge36" class="edge">
<title>res0&#45;&gt;ffn1_0_0</title>
<path fill="none" stroke="black" d="M7080.21,-1849.25C7471.82,-1839.52 8519.69,-1809.98 8671,-1769.22 8692.05,-1763.55 8713.67,-1753.39 8732.06,-1743.24"/>
<polygon fill="black" stroke="black" points="8733.83,-1746.26 8740.8,-1738.28 8730.38,-1740.17 8733.83,-1746.26"/>
</g>
<!-- res0&#45;&gt;ffn1_0_1 -->
<g id="edge40" class="edge">
<title>res0&#45;&gt;ffn1_0_1</title>
<path fill="none" stroke="black" d="M7082.37,-1852.47C7412.92,-1850.63 8197.14,-1838.81 8452,-1769.22 8472.94,-1763.5 8494.47,-1753.39 8512.8,-1743.29"/>
<polygon fill="black" stroke="black" points="8514.55,-1746.32 8521.53,-1738.35 8511.1,-1740.23 8514.55,-1746.32"/>
</g>
<!-- res0&#45;&gt;ffn1_0_2 -->
<g id="edge44" class="edge">
<title>res0&#45;&gt;ffn1_0_2</title>
<path fill="none" stroke="black" d="M7081.38,-1850.85C7375,-1845.88 8020.14,-1828.4 8233,-1769.22 8253.91,-1763.41 8275.44,-1753.28 8293.77,-1743.19"/>
<polygon fill="black" stroke="black" points="8295.52,-1746.22 8302.5,-1738.25 8292.08,-1740.12 8295.52,-1746.22"/>
</g>
<!-- res0&#45;&gt;ffn1_0_3 -->
<g id="edge48" class="edge">
<title>res0&#45;&gt;ffn1_0_3</title>
<path fill="none" stroke="black" d="M7079.72,-1848.62C7333.23,-1840.34 7842.59,-1818.07 8014,-1769.22 8034.6,-1763.35 8055.82,-1753.38 8074,-1743.44"/>
<polygon fill="black" stroke="black" points="8076.21,-1746.21 8083.21,-1738.26 8072.78,-1740.11 8076.21,-1746.21"/>
</g>
<!-- res0&#45;&gt;ffn1_0_4 -->
<g id="edge52" class="edge">
<title>res0&#45;&gt;ffn1_0_4</title>
<path fill="none" stroke="black" d="M7077.57,-1845.37C7287.11,-1833.6 7664.42,-1807.82 7795,-1769.22 7815.37,-1763.2 7836.39,-1753.31 7854.47,-1743.47"/>
<polygon fill="black" stroke="black" points="7856.62,-1746.28 7863.64,-1738.35 7853.21,-1740.17 7856.62,-1746.28"/>
</g>
<!-- res0&#45;&gt;ffn1_0_5 -->
<g id="edge56" class="edge">
<title>res0&#45;&gt;ffn1_0_5</title>
<path fill="none" stroke="black" d="M7079.43,-1848.19C7211.81,-1840.71 7410.71,-1821.02 7576,-1769.22 7596.09,-1762.92 7616.91,-1753.07 7634.9,-1743.35"/>
<polygon fill="black" stroke="black" points="7636.97,-1746.2 7644.03,-1738.3 7633.58,-1740.08 7636.97,-1746.2"/>
</g>
<!-- res0&#45;&gt;ffn1_0_6 -->
<g id="edge60" class="edge">
<title>res0&#45;&gt;ffn1_0_6</title>
<path fill="none" stroke="black" d="M7070.23,-1835.78C7154.54,-1822.92 7263.87,-1801.78 7357,-1769.22 7376.45,-1762.42 7396.75,-1752.7 7414.48,-1743.24"/>
<polygon fill="black" stroke="black" points="7416.4,-1746.18 7423.51,-1738.33 7413.05,-1740.03 7416.4,-1746.18"/>
</g>
<!-- res0&#45;&gt;ffn1_0_7 -->
<g id="edge64" class="edge">
<title>res0&#45;&gt;ffn1_0_7</title>
<path fill="none" stroke="black" d="M7048.66,-1806.29C7076.75,-1794.57 7106.59,-1781.75 7134,-1769.22 7152.01,-1760.99 7171.36,-1751.54 7188.88,-1742.75"/>
<polygon fill="black" stroke="black" points="7190.5,-1745.85 7197.86,-1738.23 7187.35,-1739.6 7190.5,-1745.85"/>
</g>
<!-- res0&#45;&gt;res_ffn0 -->
<g id="edge69" class="edge">
<title>res0&#45;&gt;res_ffn0</title>
<path fill="none" stroke="black" d="M6933,-1800.59C6933,-1792.3 6933,-1783.65 6933,-1775.15"/>
<polygon fill="black" stroke="black" points="6936.5,-1774.89 6933,-1764.89 6929.5,-1774.89 6936.5,-1774.89"/>
</g>
<!-- send_stage0 -->
<g id="node55" class="node">
<title>send_stage0</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="5162" cy="-1585.24" rx="108.79" ry="37.45"/>
<text text-anchor="middle" x="5162" y="-1596.54" font-family="Times,serif" font-size="14.00">Send to Stage 1</text>
<text text-anchor="middle" x="5162" y="-1581.54" font-family="Times,serif" font-size="14.00">X: [B, L/P, d_model]</text>
<text text-anchor="middle" x="5162" y="-1566.54" font-family="Times,serif" font-size="14.00">GPU: 0&#45;7  8&#45;15</text>
</g>
<!-- res_ffn0&#45;&gt;send_stage0 -->
<g id="edge70" class="edge">
<title>res_ffn0&#45;&gt;send_stage0</title>
<path fill="none" stroke="black" d="M6773.5,-1699.51C6421.77,-1674.79 5586.42,-1616.07 5278.55,-1594.44"/>
<polygon fill="black" stroke="black" points="5278.49,-1590.92 5268.27,-1593.71 5278,-1597.9 5278.49,-1590.92"/>
</g>
<!-- recv_stage1 -->
<g id="node106" class="node">
<title>recv_stage1</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="3344" cy="-1471.29" rx="120.42" ry="37.45"/>
<text text-anchor="middle" x="3344" y="-1482.59" font-family="Times,serif" font-size="14.00">Receive from Stage 0</text>
<text text-anchor="middle" x="3344" y="-1467.59" font-family="Times,serif" font-size="14.00">X: [B, L/P, d_model]</text>
<text text-anchor="middle" x="3344" y="-1452.59" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- send_stage0&#45;&gt;recv_stage1 -->
<g id="edge71" class="edge">
<title>send_stage0&#45;&gt;recv_stage1</title>
<path fill="none" stroke="black" d="M5055.06,-1577.66C4739.34,-1558.22 3812.1,-1501.12 3471.44,-1480.14"/>
<polygon fill="black" stroke="black" points="3471.48,-1476.63 3461.29,-1479.51 3471.05,-1483.62 3471.48,-1476.63"/>
</g>
<!-- qkv2_8 -->
<g id="node56" class="node">
<title>qkv2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7122,-1371.31 6914,-1371.31 6914,-1318.31 7122,-1318.31 7122,-1371.31"/>
<text text-anchor="middle" x="7018" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 8</text>
<text text-anchor="middle" x="7018" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7018" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attn2_8 -->
<g id="node64" class="node">
<title>attn2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7122,-1229.31 6914,-1229.31 6914,-1176.31 7122,-1176.31 7122,-1229.31"/>
<text text-anchor="middle" x="7018" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 8</text>
<text text-anchor="middle" x="7018" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7018" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv2_8&#45;&gt;attn2_8 -->
<g id="edge73" class="edge">
<title>qkv2_8&#45;&gt;attn2_8</title>
<path fill="none" stroke="black" d="M7018,-1318.14C7018,-1296.03 7018,-1263.91 7018,-1239.34"/>
<polygon fill="black" stroke="black" points="7021.5,-1239.33 7018,-1229.33 7014.5,-1239.33 7021.5,-1239.33"/>
</g>
<!-- qkv2_9 -->
<g id="node57" class="node">
<title>qkv2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6896,-1371.31 6688,-1371.31 6688,-1318.31 6896,-1318.31 6896,-1371.31"/>
<text text-anchor="middle" x="6792" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 9</text>
<text text-anchor="middle" x="6792" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6792" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attn2_9 -->
<g id="node65" class="node">
<title>attn2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6896,-1229.31 6688,-1229.31 6688,-1176.31 6896,-1176.31 6896,-1229.31"/>
<text text-anchor="middle" x="6792" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 9</text>
<text text-anchor="middle" x="6792" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6792" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv2_9&#45;&gt;attn2_9 -->
<g id="edge77" class="edge">
<title>qkv2_9&#45;&gt;attn2_9</title>
<path fill="none" stroke="black" d="M6792,-1318.14C6792,-1296.03 6792,-1263.91 6792,-1239.34"/>
<polygon fill="black" stroke="black" points="6795.5,-1239.33 6792,-1229.33 6788.5,-1239.33 6795.5,-1239.33"/>
</g>
<!-- qkv2_10 -->
<g id="node58" class="node">
<title>qkv2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6670,-1371.31 6462,-1371.31 6462,-1318.31 6670,-1318.31 6670,-1371.31"/>
<text text-anchor="middle" x="6566" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 10</text>
<text text-anchor="middle" x="6566" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6566" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attn2_10 -->
<g id="node66" class="node">
<title>attn2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6670,-1229.31 6462,-1229.31 6462,-1176.31 6670,-1176.31 6670,-1229.31"/>
<text text-anchor="middle" x="6566" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 10</text>
<text text-anchor="middle" x="6566" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6566" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv2_10&#45;&gt;attn2_10 -->
<g id="edge81" class="edge">
<title>qkv2_10&#45;&gt;attn2_10</title>
<path fill="none" stroke="black" d="M6566,-1318.14C6566,-1296.03 6566,-1263.91 6566,-1239.34"/>
<polygon fill="black" stroke="black" points="6569.5,-1239.33 6566,-1229.33 6562.5,-1239.33 6569.5,-1239.33"/>
</g>
<!-- qkv2_11 -->
<g id="node59" class="node">
<title>qkv2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6444,-1371.31 6236,-1371.31 6236,-1318.31 6444,-1318.31 6444,-1371.31"/>
<text text-anchor="middle" x="6340" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 11</text>
<text text-anchor="middle" x="6340" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6340" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attn2_11 -->
<g id="node67" class="node">
<title>attn2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6444,-1229.31 6236,-1229.31 6236,-1176.31 6444,-1176.31 6444,-1229.31"/>
<text text-anchor="middle" x="6340" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 11</text>
<text text-anchor="middle" x="6340" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6340" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv2_11&#45;&gt;attn2_11 -->
<g id="edge85" class="edge">
<title>qkv2_11&#45;&gt;attn2_11</title>
<path fill="none" stroke="black" d="M6340,-1318.14C6340,-1296.03 6340,-1263.91 6340,-1239.34"/>
<polygon fill="black" stroke="black" points="6343.5,-1239.33 6340,-1229.33 6336.5,-1239.33 6343.5,-1239.33"/>
</g>
<!-- qkv2_12 -->
<g id="node60" class="node">
<title>qkv2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6218,-1371.31 6010,-1371.31 6010,-1318.31 6218,-1318.31 6218,-1371.31"/>
<text text-anchor="middle" x="6114" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 12</text>
<text text-anchor="middle" x="6114" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6114" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attn2_12 -->
<g id="node68" class="node">
<title>attn2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6218,-1229.31 6010,-1229.31 6010,-1176.31 6218,-1176.31 6218,-1229.31"/>
<text text-anchor="middle" x="6114" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 12</text>
<text text-anchor="middle" x="6114" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6114" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv2_12&#45;&gt;attn2_12 -->
<g id="edge89" class="edge">
<title>qkv2_12&#45;&gt;attn2_12</title>
<path fill="none" stroke="black" d="M6114,-1318.14C6114,-1296.03 6114,-1263.91 6114,-1239.34"/>
<polygon fill="black" stroke="black" points="6117.5,-1239.33 6114,-1229.33 6110.5,-1239.33 6117.5,-1239.33"/>
</g>
<!-- qkv2_13 -->
<g id="node61" class="node">
<title>qkv2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5992,-1371.31 5784,-1371.31 5784,-1318.31 5992,-1318.31 5992,-1371.31"/>
<text text-anchor="middle" x="5888" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 13</text>
<text text-anchor="middle" x="5888" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5888" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attn2_13 -->
<g id="node69" class="node">
<title>attn2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5992,-1229.31 5784,-1229.31 5784,-1176.31 5992,-1176.31 5992,-1229.31"/>
<text text-anchor="middle" x="5888" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 13</text>
<text text-anchor="middle" x="5888" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5888" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv2_13&#45;&gt;attn2_13 -->
<g id="edge93" class="edge">
<title>qkv2_13&#45;&gt;attn2_13</title>
<path fill="none" stroke="black" d="M5888,-1318.14C5888,-1296.03 5888,-1263.91 5888,-1239.34"/>
<polygon fill="black" stroke="black" points="5891.5,-1239.33 5888,-1229.33 5884.5,-1239.33 5891.5,-1239.33"/>
</g>
<!-- qkv2_14 -->
<g id="node62" class="node">
<title>qkv2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5766,-1371.31 5558,-1371.31 5558,-1318.31 5766,-1318.31 5766,-1371.31"/>
<text text-anchor="middle" x="5662" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 14</text>
<text text-anchor="middle" x="5662" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5662" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attn2_14 -->
<g id="node70" class="node">
<title>attn2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5766,-1229.31 5558,-1229.31 5558,-1176.31 5766,-1176.31 5766,-1229.31"/>
<text text-anchor="middle" x="5662" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 14</text>
<text text-anchor="middle" x="5662" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5662" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv2_14&#45;&gt;attn2_14 -->
<g id="edge97" class="edge">
<title>qkv2_14&#45;&gt;attn2_14</title>
<path fill="none" stroke="black" d="M5662,-1318.14C5662,-1296.03 5662,-1263.91 5662,-1239.34"/>
<polygon fill="black" stroke="black" points="5665.5,-1239.33 5662,-1229.33 5658.5,-1239.33 5665.5,-1239.33"/>
</g>
<!-- qkv2_15 -->
<g id="node63" class="node">
<title>qkv2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5540,-1371.31 5332,-1371.31 5332,-1318.31 5540,-1318.31 5540,-1371.31"/>
<text text-anchor="middle" x="5436" y="-1356.11" font-family="Times,serif" font-size="14.00">QKV Projection 15</text>
<text text-anchor="middle" x="5436" y="-1341.11" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5436" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attn2_15 -->
<g id="node71" class="node">
<title>attn2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5540,-1229.31 5332,-1229.31 5332,-1176.31 5540,-1176.31 5540,-1229.31"/>
<text text-anchor="middle" x="5436" y="-1214.11" font-family="Times,serif" font-size="14.00">Attention 15</text>
<text text-anchor="middle" x="5436" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5436" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv2_15&#45;&gt;attn2_15 -->
<g id="edge101" class="edge">
<title>qkv2_15&#45;&gt;attn2_15</title>
<path fill="none" stroke="black" d="M5436,-1318.14C5436,-1296.03 5436,-1263.91 5436,-1239.34"/>
<polygon fill="black" stroke="black" points="5439.5,-1239.33 5436,-1229.33 5432.5,-1239.33 5439.5,-1239.33"/>
</g>
<!-- out2_8 -->
<g id="node72" class="node">
<title>out2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="7122,-1102.81 6914,-1102.81 6914,-1049.81 7122,-1049.81 7122,-1102.81"/>
<text text-anchor="middle" x="7018" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 8</text>
<text text-anchor="middle" x="7018" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="7018" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attn2_8&#45;&gt;out2_8 -->
<g id="edge74" class="edge">
<title>attn2_8&#45;&gt;out2_8</title>
<path fill="none" stroke="black" d="M7018,-1176.02C7018,-1157.82 7018,-1133.21 7018,-1113.12"/>
<polygon fill="black" stroke="black" points="7021.5,-1113.08 7018,-1103.08 7014.5,-1113.08 7021.5,-1113.08"/>
</g>
<!-- out2_9 -->
<g id="node73" class="node">
<title>out2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6896,-1102.81 6688,-1102.81 6688,-1049.81 6896,-1049.81 6896,-1102.81"/>
<text text-anchor="middle" x="6792" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 9</text>
<text text-anchor="middle" x="6792" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6792" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attn2_9&#45;&gt;out2_9 -->
<g id="edge78" class="edge">
<title>attn2_9&#45;&gt;out2_9</title>
<path fill="none" stroke="black" d="M6792,-1176.02C6792,-1157.82 6792,-1133.21 6792,-1113.12"/>
<polygon fill="black" stroke="black" points="6795.5,-1113.08 6792,-1103.08 6788.5,-1113.08 6795.5,-1113.08"/>
</g>
<!-- out2_10 -->
<g id="node74" class="node">
<title>out2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6670,-1102.81 6462,-1102.81 6462,-1049.81 6670,-1049.81 6670,-1102.81"/>
<text text-anchor="middle" x="6566" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 10</text>
<text text-anchor="middle" x="6566" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6566" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attn2_10&#45;&gt;out2_10 -->
<g id="edge82" class="edge">
<title>attn2_10&#45;&gt;out2_10</title>
<path fill="none" stroke="black" d="M6566,-1176.02C6566,-1157.82 6566,-1133.21 6566,-1113.12"/>
<polygon fill="black" stroke="black" points="6569.5,-1113.08 6566,-1103.08 6562.5,-1113.08 6569.5,-1113.08"/>
</g>
<!-- out2_11 -->
<g id="node75" class="node">
<title>out2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6444,-1102.81 6236,-1102.81 6236,-1049.81 6444,-1049.81 6444,-1102.81"/>
<text text-anchor="middle" x="6340" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 11</text>
<text text-anchor="middle" x="6340" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6340" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attn2_11&#45;&gt;out2_11 -->
<g id="edge86" class="edge">
<title>attn2_11&#45;&gt;out2_11</title>
<path fill="none" stroke="black" d="M6340,-1176.02C6340,-1157.82 6340,-1133.21 6340,-1113.12"/>
<polygon fill="black" stroke="black" points="6343.5,-1113.08 6340,-1103.08 6336.5,-1113.08 6343.5,-1113.08"/>
</g>
<!-- out2_12 -->
<g id="node76" class="node">
<title>out2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="6218,-1102.81 6010,-1102.81 6010,-1049.81 6218,-1049.81 6218,-1102.81"/>
<text text-anchor="middle" x="6114" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 12</text>
<text text-anchor="middle" x="6114" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="6114" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attn2_12&#45;&gt;out2_12 -->
<g id="edge90" class="edge">
<title>attn2_12&#45;&gt;out2_12</title>
<path fill="none" stroke="black" d="M6114,-1176.02C6114,-1157.82 6114,-1133.21 6114,-1113.12"/>
<polygon fill="black" stroke="black" points="6117.5,-1113.08 6114,-1103.08 6110.5,-1113.08 6117.5,-1113.08"/>
</g>
<!-- out2_13 -->
<g id="node77" class="node">
<title>out2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5992,-1102.81 5784,-1102.81 5784,-1049.81 5992,-1049.81 5992,-1102.81"/>
<text text-anchor="middle" x="5888" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 13</text>
<text text-anchor="middle" x="5888" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5888" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attn2_13&#45;&gt;out2_13 -->
<g id="edge94" class="edge">
<title>attn2_13&#45;&gt;out2_13</title>
<path fill="none" stroke="black" d="M5888,-1176.02C5888,-1157.82 5888,-1133.21 5888,-1113.12"/>
<polygon fill="black" stroke="black" points="5891.5,-1113.08 5888,-1103.08 5884.5,-1113.08 5891.5,-1113.08"/>
</g>
<!-- out2_14 -->
<g id="node78" class="node">
<title>out2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5766,-1102.81 5558,-1102.81 5558,-1049.81 5766,-1049.81 5766,-1102.81"/>
<text text-anchor="middle" x="5662" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 14</text>
<text text-anchor="middle" x="5662" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5662" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attn2_14&#45;&gt;out2_14 -->
<g id="edge98" class="edge">
<title>attn2_14&#45;&gt;out2_14</title>
<path fill="none" stroke="black" d="M5662,-1176.02C5662,-1157.82 5662,-1133.21 5662,-1113.12"/>
<polygon fill="black" stroke="black" points="5665.5,-1113.08 5662,-1103.08 5658.5,-1113.08 5665.5,-1113.08"/>
</g>
<!-- out2_15 -->
<g id="node79" class="node">
<title>out2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5540,-1102.81 5332,-1102.81 5332,-1049.81 5540,-1049.81 5540,-1102.81"/>
<text text-anchor="middle" x="5436" y="-1087.61" font-family="Times,serif" font-size="14.00">Output Proj 15</text>
<text text-anchor="middle" x="5436" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5436" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attn2_15&#45;&gt;out2_15 -->
<g id="edge102" class="edge">
<title>attn2_15&#45;&gt;out2_15</title>
<path fill="none" stroke="black" d="M5436,-1176.02C5436,-1157.82 5436,-1133.21 5436,-1113.12"/>
<polygon fill="black" stroke="black" points="5439.5,-1113.08 5436,-1103.08 5432.5,-1113.08 5439.5,-1113.08"/>
</g>
<!-- ar2 -->
<g id="node80" class="node">
<title>ar2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="6114" cy="-976.34" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="6114" y="-987.64" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="6114" y="-972.64" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="6114" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- out2_8&#45;&gt;ar2 -->
<g id="edge75" class="edge">
<title>out2_8&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M6913.74,-1051.26C6910.8,-1050.75 6907.88,-1050.27 6905,-1049.81 6668.58,-1012.47 6389.15,-992.45 6233.7,-983.43"/>
<polygon fill="black" stroke="black" points="6233.82,-979.93 6223.64,-982.85 6233.42,-986.92 6233.82,-979.93"/>
</g>
<!-- out2_9&#45;&gt;ar2 -->
<g id="edge79" class="edge">
<title>out2_9&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M6687.71,-1051.4C6684.78,-1050.85 6681.87,-1050.32 6679,-1049.81 6524.55,-1022.54 6344.64,-1001.25 6230.08,-988.99"/>
<polygon fill="black" stroke="black" points="6230.2,-985.48 6219.88,-987.9 6229.46,-992.44 6230.2,-985.48"/>
</g>
<!-- out2_10&#45;&gt;ar2 -->
<g id="edge83" class="edge">
<title>out2_10&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M6461.95,-1051.79C6458.94,-1051.12 6455.95,-1050.46 6453,-1049.81 6373.88,-1032.43 6284.26,-1013.29 6217.04,-999.05"/>
<polygon fill="black" stroke="black" points="6217.37,-995.54 6206.87,-996.9 6215.92,-1002.39 6217.37,-995.54"/>
</g>
<!-- out2_11&#45;&gt;ar2 -->
<g id="edge87" class="edge">
<title>out2_11&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M6280.92,-1049.7C6253.3,-1037.73 6220.08,-1023.32 6190.56,-1010.53"/>
<polygon fill="black" stroke="black" points="6191.69,-1007.2 6181.12,-1006.44 6188.91,-1013.62 6191.69,-1007.2"/>
</g>
<!-- out2_12&#45;&gt;ar2 -->
<g id="edge91" class="edge">
<title>out2_12&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M6114,-1049.57C6114,-1041.75 6114,-1032.89 6114,-1024.13"/>
<polygon fill="black" stroke="black" points="6117.5,-1023.96 6114,-1013.96 6110.5,-1023.96 6117.5,-1023.96"/>
</g>
<!-- out2_13&#45;&gt;ar2 -->
<g id="edge95" class="edge">
<title>out2_13&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M5947.08,-1049.7C5974.7,-1037.73 6007.92,-1023.32 6037.44,-1010.53"/>
<polygon fill="black" stroke="black" points="6039.09,-1013.62 6046.88,-1006.44 6036.31,-1007.2 6039.09,-1013.62"/>
</g>
<!-- out2_14&#45;&gt;ar2 -->
<g id="edge99" class="edge">
<title>out2_14&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M5766.05,-1051.79C5769.06,-1051.12 5772.05,-1050.46 5775,-1049.81 5854.12,-1032.43 5943.74,-1013.29 6010.96,-999.05"/>
<polygon fill="black" stroke="black" points="6012.08,-1002.39 6021.13,-996.9 6010.63,-995.54 6012.08,-1002.39"/>
</g>
<!-- out2_15&#45;&gt;ar2 -->
<g id="edge103" class="edge">
<title>out2_15&#45;&gt;ar2</title>
<path fill="none" stroke="black" d="M5540.29,-1051.4C5543.22,-1050.85 5546.13,-1050.32 5549,-1049.81 5703.45,-1022.54 5883.36,-1001.25 5997.92,-988.99"/>
<polygon fill="black" stroke="black" points="5998.54,-992.44 6008.12,-987.9 5997.8,-985.48 5998.54,-992.44"/>
</g>
<!-- res2 -->
<g id="node107" class="node">
<title>res2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3463.88,-1397.81 3163.42,-1397.81 3086.12,-1291.81 3386.58,-1291.81 3463.88,-1397.81"/>
<text text-anchor="middle" x="3275" y="-1356.11" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3275" y="-1341.11" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="3275" y="-1326.11" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ar2&#45;&gt;res2 -->
<g id="edge104" class="edge">
<title>ar2&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M6003.48,-980.05C5797.57,-986.17 5371.6,-1004.24 5323,-1049.81 5253.93,-1114.59 5360.67,-1197.28 5290,-1260.31 5221.1,-1321.77 3897.62,-1338.64 3433.88,-1342.67"/>
<polygon fill="black" stroke="black" points="3433.73,-1339.18 3423.76,-1342.76 3433.79,-1346.18 3433.73,-1339.18"/>
</g>
<!-- ffn1_2_8 -->
<g id="node81" class="node">
<title>ffn1_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5260.5,-1229.31 5059.5,-1229.31 5059.5,-1176.31 5260.5,-1176.31 5260.5,-1229.31"/>
<text text-anchor="middle" x="5160" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 8</text>
<text text-anchor="middle" x="5160" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="5160" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act2_8 -->
<g id="node89" class="node">
<title>act2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5267.5,-1102.81 5066.5,-1102.81 5066.5,-1049.81 5267.5,-1049.81 5267.5,-1102.81"/>
<text text-anchor="middle" x="5167" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 8</text>
<text text-anchor="middle" x="5167" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="5167" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_2_8&#45;&gt;act2_8 -->
<g id="edge107" class="edge">
<title>ffn1_2_8&#45;&gt;act2_8</title>
<path fill="none" stroke="black" d="M5161.45,-1176.02C5162.47,-1157.82 5163.86,-1133.21 5164.99,-1113.12"/>
<polygon fill="black" stroke="black" points="5168.48,-1113.26 5165.55,-1103.08 5161.5,-1112.86 5168.48,-1113.26"/>
</g>
<!-- ffn1_2_9 -->
<g id="node82" class="node">
<title>ffn1_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5034.5,-1229.31 4833.5,-1229.31 4833.5,-1176.31 5034.5,-1176.31 5034.5,-1229.31"/>
<text text-anchor="middle" x="4934" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 9</text>
<text text-anchor="middle" x="4934" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4934" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act2_9 -->
<g id="node90" class="node">
<title>act2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5041.5,-1102.81 4840.5,-1102.81 4840.5,-1049.81 5041.5,-1049.81 5041.5,-1102.81"/>
<text text-anchor="middle" x="4941" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 9</text>
<text text-anchor="middle" x="4941" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4941" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_2_9&#45;&gt;act2_9 -->
<g id="edge111" class="edge">
<title>ffn1_2_9&#45;&gt;act2_9</title>
<path fill="none" stroke="black" d="M4935.45,-1176.02C4936.47,-1157.82 4937.86,-1133.21 4938.99,-1113.12"/>
<polygon fill="black" stroke="black" points="4942.48,-1113.26 4939.55,-1103.08 4935.5,-1112.86 4942.48,-1113.26"/>
</g>
<!-- ffn1_2_10 -->
<g id="node83" class="node">
<title>ffn1_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4808.5,-1229.31 4607.5,-1229.31 4607.5,-1176.31 4808.5,-1176.31 4808.5,-1229.31"/>
<text text-anchor="middle" x="4708" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 10</text>
<text text-anchor="middle" x="4708" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4708" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act2_10 -->
<g id="node91" class="node">
<title>act2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4815.5,-1102.81 4614.5,-1102.81 4614.5,-1049.81 4815.5,-1049.81 4815.5,-1102.81"/>
<text text-anchor="middle" x="4715" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 10</text>
<text text-anchor="middle" x="4715" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4715" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_2_10&#45;&gt;act2_10 -->
<g id="edge115" class="edge">
<title>ffn1_2_10&#45;&gt;act2_10</title>
<path fill="none" stroke="black" d="M4709.45,-1176.02C4710.47,-1157.82 4711.86,-1133.21 4712.99,-1113.12"/>
<polygon fill="black" stroke="black" points="4716.48,-1113.26 4713.55,-1103.08 4709.5,-1112.86 4716.48,-1113.26"/>
</g>
<!-- ffn1_2_11 -->
<g id="node84" class="node">
<title>ffn1_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4582.5,-1229.31 4381.5,-1229.31 4381.5,-1176.31 4582.5,-1176.31 4582.5,-1229.31"/>
<text text-anchor="middle" x="4482" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 11</text>
<text text-anchor="middle" x="4482" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4482" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act2_11 -->
<g id="node92" class="node">
<title>act2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4589.5,-1102.81 4388.5,-1102.81 4388.5,-1049.81 4589.5,-1049.81 4589.5,-1102.81"/>
<text text-anchor="middle" x="4489" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 11</text>
<text text-anchor="middle" x="4489" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4489" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_2_11&#45;&gt;act2_11 -->
<g id="edge119" class="edge">
<title>ffn1_2_11&#45;&gt;act2_11</title>
<path fill="none" stroke="black" d="M4483.45,-1176.02C4484.47,-1157.82 4485.86,-1133.21 4486.99,-1113.12"/>
<polygon fill="black" stroke="black" points="4490.48,-1113.26 4487.55,-1103.08 4483.5,-1112.86 4490.48,-1113.26"/>
</g>
<!-- ffn1_2_12 -->
<g id="node85" class="node">
<title>ffn1_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4357.5,-1229.31 4156.5,-1229.31 4156.5,-1176.31 4357.5,-1176.31 4357.5,-1229.31"/>
<text text-anchor="middle" x="4257" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 12</text>
<text text-anchor="middle" x="4257" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4257" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act2_12 -->
<g id="node93" class="node">
<title>act2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4363.5,-1102.81 4162.5,-1102.81 4162.5,-1049.81 4363.5,-1049.81 4363.5,-1102.81"/>
<text text-anchor="middle" x="4263" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 12</text>
<text text-anchor="middle" x="4263" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4263" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_2_12&#45;&gt;act2_12 -->
<g id="edge123" class="edge">
<title>ffn1_2_12&#45;&gt;act2_12</title>
<path fill="none" stroke="black" d="M4258.24,-1176.02C4259.12,-1157.82 4260.31,-1133.21 4261.27,-1113.12"/>
<polygon fill="black" stroke="black" points="4264.77,-1113.23 4261.76,-1103.08 4257.78,-1112.9 4264.77,-1113.23"/>
</g>
<!-- ffn1_2_13 -->
<g id="node86" class="node">
<title>ffn1_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4133.5,-1229.31 3932.5,-1229.31 3932.5,-1176.31 4133.5,-1176.31 4133.5,-1229.31"/>
<text text-anchor="middle" x="4033" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 13</text>
<text text-anchor="middle" x="4033" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4033" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act2_13 -->
<g id="node94" class="node">
<title>act2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4138.5,-1102.81 3937.5,-1102.81 3937.5,-1049.81 4138.5,-1049.81 4138.5,-1102.81"/>
<text text-anchor="middle" x="4038" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 13</text>
<text text-anchor="middle" x="4038" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="4038" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_2_13&#45;&gt;act2_13 -->
<g id="edge127" class="edge">
<title>ffn1_2_13&#45;&gt;act2_13</title>
<path fill="none" stroke="black" d="M4034.04,-1176.02C4034.77,-1157.82 4035.76,-1133.21 4036.56,-1113.12"/>
<polygon fill="black" stroke="black" points="4040.06,-1113.21 4036.97,-1103.08 4033.07,-1112.93 4040.06,-1113.21"/>
</g>
<!-- ffn1_2_14 -->
<g id="node87" class="node">
<title>ffn1_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3910.5,-1229.31 3709.5,-1229.31 3709.5,-1176.31 3910.5,-1176.31 3910.5,-1229.31"/>
<text text-anchor="middle" x="3810" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 14</text>
<text text-anchor="middle" x="3810" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="3810" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act2_14 -->
<g id="node95" class="node">
<title>act2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3913.5,-1102.81 3712.5,-1102.81 3712.5,-1049.81 3913.5,-1049.81 3913.5,-1102.81"/>
<text text-anchor="middle" x="3813" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 14</text>
<text text-anchor="middle" x="3813" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="3813" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_2_14&#45;&gt;act2_14 -->
<g id="edge131" class="edge">
<title>ffn1_2_14&#45;&gt;act2_14</title>
<path fill="none" stroke="black" d="M3810.62,-1176.02C3811.06,-1157.82 3811.65,-1133.21 3812.14,-1113.12"/>
<polygon fill="black" stroke="black" points="3815.64,-1113.16 3812.38,-1103.08 3808.64,-1112.99 3815.64,-1113.16"/>
</g>
<!-- ffn1_2_15 -->
<g id="node88" class="node">
<title>ffn1_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3689.5,-1229.31 3488.5,-1229.31 3488.5,-1176.31 3689.5,-1176.31 3689.5,-1229.31"/>
<text text-anchor="middle" x="3589" y="-1214.11" font-family="Times,serif" font-size="14.00">FFN Linear1 15</text>
<text text-anchor="middle" x="3589" y="-1199.11" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="3589" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act2_15 -->
<g id="node96" class="node">
<title>act2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3690.5,-1102.81 3489.5,-1102.81 3489.5,-1049.81 3690.5,-1049.81 3690.5,-1102.81"/>
<text text-anchor="middle" x="3590" y="-1087.61" font-family="Times,serif" font-size="14.00">GELU 15</text>
<text text-anchor="middle" x="3590" y="-1072.61" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="3590" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_2_15&#45;&gt;act2_15 -->
<g id="edge135" class="edge">
<title>ffn1_2_15&#45;&gt;act2_15</title>
<path fill="none" stroke="black" d="M3589.21,-1176.02C3589.35,-1157.82 3589.55,-1133.21 3589.71,-1113.12"/>
<polygon fill="black" stroke="black" points="3593.21,-1113.1 3589.79,-1103.08 3586.21,-1113.05 3593.21,-1113.1"/>
</g>
<!-- ffn2_2_8 -->
<g id="node97" class="node">
<title>ffn2_2_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5278,-1002.84 5070,-1002.84 5070,-949.84 5278,-949.84 5278,-1002.84"/>
<text text-anchor="middle" x="5174" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 8</text>
<text text-anchor="middle" x="5174" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="5174" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act2_8&#45;&gt;ffn2_2_8 -->
<g id="edge108" class="edge">
<title>act2_8&#45;&gt;ffn2_2_8</title>
<path fill="none" stroke="black" d="M5168.84,-1049.57C5169.63,-1038.43 5170.58,-1025.21 5171.44,-1013.14"/>
<polygon fill="black" stroke="black" points="5174.95,-1013.13 5172.17,-1002.91 5167.97,-1012.63 5174.95,-1013.13"/>
</g>
<!-- ffn2_2_9 -->
<g id="node98" class="node">
<title>ffn2_2_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="5052,-1002.84 4844,-1002.84 4844,-949.84 5052,-949.84 5052,-1002.84"/>
<text text-anchor="middle" x="4948" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 9</text>
<text text-anchor="middle" x="4948" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="4948" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act2_9&#45;&gt;ffn2_2_9 -->
<g id="edge112" class="edge">
<title>act2_9&#45;&gt;ffn2_2_9</title>
<path fill="none" stroke="black" d="M4942.84,-1049.57C4943.63,-1038.43 4944.58,-1025.21 4945.44,-1013.14"/>
<polygon fill="black" stroke="black" points="4948.95,-1013.13 4946.17,-1002.91 4941.97,-1012.63 4948.95,-1013.13"/>
</g>
<!-- ffn2_2_10 -->
<g id="node99" class="node">
<title>ffn2_2_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4826,-1002.84 4618,-1002.84 4618,-949.84 4826,-949.84 4826,-1002.84"/>
<text text-anchor="middle" x="4722" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 10</text>
<text text-anchor="middle" x="4722" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="4722" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act2_10&#45;&gt;ffn2_2_10 -->
<g id="edge116" class="edge">
<title>act2_10&#45;&gt;ffn2_2_10</title>
<path fill="none" stroke="black" d="M4716.84,-1049.57C4717.63,-1038.43 4718.58,-1025.21 4719.44,-1013.14"/>
<polygon fill="black" stroke="black" points="4722.95,-1013.13 4720.17,-1002.91 4715.97,-1012.63 4722.95,-1013.13"/>
</g>
<!-- ffn2_2_11 -->
<g id="node100" class="node">
<title>ffn2_2_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4600,-1002.84 4392,-1002.84 4392,-949.84 4600,-949.84 4600,-1002.84"/>
<text text-anchor="middle" x="4496" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 11</text>
<text text-anchor="middle" x="4496" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="4496" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act2_11&#45;&gt;ffn2_2_11 -->
<g id="edge120" class="edge">
<title>act2_11&#45;&gt;ffn2_2_11</title>
<path fill="none" stroke="black" d="M4490.84,-1049.57C4491.63,-1038.43 4492.58,-1025.21 4493.44,-1013.14"/>
<polygon fill="black" stroke="black" points="4496.95,-1013.13 4494.17,-1002.91 4489.97,-1012.63 4496.95,-1013.13"/>
</g>
<!-- ffn2_2_12 -->
<g id="node101" class="node">
<title>ffn2_2_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4374,-1002.84 4166,-1002.84 4166,-949.84 4374,-949.84 4374,-1002.84"/>
<text text-anchor="middle" x="4270" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 12</text>
<text text-anchor="middle" x="4270" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="4270" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act2_12&#45;&gt;ffn2_2_12 -->
<g id="edge124" class="edge">
<title>act2_12&#45;&gt;ffn2_2_12</title>
<path fill="none" stroke="black" d="M4264.84,-1049.57C4265.63,-1038.43 4266.58,-1025.21 4267.44,-1013.14"/>
<polygon fill="black" stroke="black" points="4270.95,-1013.13 4268.17,-1002.91 4263.97,-1012.63 4270.95,-1013.13"/>
</g>
<!-- ffn2_2_13 -->
<g id="node102" class="node">
<title>ffn2_2_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="4148,-1002.84 3940,-1002.84 3940,-949.84 4148,-949.84 4148,-1002.84"/>
<text text-anchor="middle" x="4044" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 13</text>
<text text-anchor="middle" x="4044" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="4044" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act2_13&#45;&gt;ffn2_2_13 -->
<g id="edge128" class="edge">
<title>act2_13&#45;&gt;ffn2_2_13</title>
<path fill="none" stroke="black" d="M4039.58,-1049.57C4040.26,-1038.43 4041.07,-1025.21 4041.81,-1013.14"/>
<polygon fill="black" stroke="black" points="4045.32,-1013.1 4042.43,-1002.91 4038.33,-1012.67 4045.32,-1013.1"/>
</g>
<!-- ffn2_2_14 -->
<g id="node103" class="node">
<title>ffn2_2_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3922,-1002.84 3714,-1002.84 3714,-949.84 3922,-949.84 3922,-1002.84"/>
<text text-anchor="middle" x="3818" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 14</text>
<text text-anchor="middle" x="3818" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3818" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act2_14&#45;&gt;ffn2_2_14 -->
<g id="edge132" class="edge">
<title>act2_14&#45;&gt;ffn2_2_14</title>
<path fill="none" stroke="black" d="M3814.31,-1049.57C3814.88,-1038.43 3815.56,-1025.21 3816.17,-1013.14"/>
<polygon fill="black" stroke="black" points="3819.68,-1013.07 3816.7,-1002.91 3812.69,-1012.72 3819.68,-1013.07"/>
</g>
<!-- ffn2_2_15 -->
<g id="node104" class="node">
<title>ffn2_2_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3696,-1002.84 3488,-1002.84 3488,-949.84 3696,-949.84 3696,-1002.84"/>
<text text-anchor="middle" x="3592" y="-987.64" font-family="Times,serif" font-size="14.00">FFN Linear2 15</text>
<text text-anchor="middle" x="3592" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3592" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act2_15&#45;&gt;ffn2_2_15 -->
<g id="edge136" class="edge">
<title>act2_15&#45;&gt;ffn2_2_15</title>
<path fill="none" stroke="black" d="M3590.53,-1049.57C3590.75,-1038.43 3591.02,-1025.21 3591.27,-1013.14"/>
<polygon fill="black" stroke="black" points="3594.77,-1012.98 3591.48,-1002.91 3587.77,-1012.83 3594.77,-1012.98"/>
</g>
<!-- ar_ffn2 -->
<g id="node105" class="node">
<title>ar_ffn2</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="4270" cy="-865.38" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="4270" y="-876.68" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="4270" y="-861.68" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="4270" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ffn2_2_8&#45;&gt;ar_ffn2 -->
<g id="edge109" class="edge">
<title>ffn2_2_8&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M5118.71,-949.83C5100.67,-942.53 5080.3,-935.34 5061,-930.86 4936.87,-902.04 4579.16,-881.2 4390.22,-871.86"/>
<polygon fill="black" stroke="black" points="4390.12,-868.35 4379.96,-871.36 4389.78,-875.35 4390.12,-868.35"/>
</g>
<!-- ffn2_2_9&#45;&gt;ar_ffn2 -->
<g id="edge113" class="edge">
<title>ffn2_2_9&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M4891.46,-949.74C4873.71,-942.62 4853.82,-935.55 4835,-930.86 4684.47,-893.34 4505.87,-877.59 4390.37,-871.02"/>
<polygon fill="black" stroke="black" points="4390.26,-867.5 4380.08,-870.45 4389.88,-874.49 4390.26,-867.5"/>
</g>
<!-- ffn2_2_10&#45;&gt;ar_ffn2 -->
<g id="edge117" class="edge">
<title>ffn2_2_10&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M4663.2,-949.79C4645.96,-942.96 4626.92,-936.04 4609,-930.86 4534.41,-909.29 4448.47,-893.04 4381.78,-882.25"/>
<polygon fill="black" stroke="black" points="4382.09,-878.75 4371.66,-880.63 4380.98,-885.66 4382.09,-878.75"/>
</g>
<!-- ffn2_2_11&#45;&gt;ar_ffn2 -->
<g id="edge121" class="edge">
<title>ffn2_2_11&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M4443.01,-949.79C4412.84,-935.25 4374.63,-916.82 4341.79,-901"/>
<polygon fill="black" stroke="black" points="4343.22,-897.79 4332.69,-896.6 4340.18,-904.1 4343.22,-897.79"/>
</g>
<!-- ffn2_2_12&#45;&gt;ar_ffn2 -->
<g id="edge125" class="edge">
<title>ffn2_2_12&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M4270,-949.79C4270,-938.88 4270,-925.79 4270,-913.25"/>
<polygon fill="black" stroke="black" points="4273.5,-912.91 4270,-902.91 4266.5,-912.91 4273.5,-912.91"/>
</g>
<!-- ffn2_2_13&#45;&gt;ar_ffn2 -->
<g id="edge129" class="edge">
<title>ffn2_2_13&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M4096.99,-949.79C4127.16,-935.25 4165.37,-916.82 4198.21,-901"/>
<polygon fill="black" stroke="black" points="4199.82,-904.1 4207.31,-896.6 4196.78,-897.79 4199.82,-904.1"/>
</g>
<!-- ffn2_2_14&#45;&gt;ar_ffn2 -->
<g id="edge133" class="edge">
<title>ffn2_2_14&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M3876.8,-949.79C3894.04,-942.96 3913.08,-936.04 3931,-930.86 4005.59,-909.29 4091.53,-893.04 4158.22,-882.25"/>
<polygon fill="black" stroke="black" points="4159.02,-885.66 4168.34,-880.63 4157.91,-878.75 4159.02,-885.66"/>
</g>
<!-- ffn2_2_15&#45;&gt;ar_ffn2 -->
<g id="edge137" class="edge">
<title>ffn2_2_15&#45;&gt;ar_ffn2</title>
<path fill="none" stroke="black" d="M3648.54,-949.74C3666.29,-942.62 3686.18,-935.55 3705,-930.86 3855.53,-893.34 4034.13,-877.59 4149.63,-871.02"/>
<polygon fill="black" stroke="black" points="4150.12,-874.49 4159.92,-870.45 4149.74,-867.5 4150.12,-874.49"/>
</g>
<!-- res_ffn2 -->
<g id="node108" class="node">
<title>res_ffn2</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3463.88,-1255.81 3163.42,-1255.81 3086.12,-1149.81 3386.58,-1149.81 3463.88,-1255.81"/>
<text text-anchor="middle" x="3275" y="-1214.11" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="3275" y="-1199.11" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="3275" y="-1184.11" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ar_ffn2&#45;&gt;res_ffn2 -->
<g id="edge138" class="edge">
<title>ar_ffn2&#45;&gt;res_ffn2</title>
<path fill="none" stroke="black" d="M4159.18,-868.02C3953.28,-872.12 3528.09,-885.97 3479,-930.86 3411.45,-992.63 3501.52,-1062.61 3444,-1133.81 3434.46,-1145.62 3422.56,-1155.39 3409.52,-1163.47"/>
<polygon fill="black" stroke="black" points="3407.68,-1160.49 3400.8,-1168.54 3411.2,-1166.54 3407.68,-1160.49"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_8 -->
<g id="edge72" class="edge">
<title>recv_stage1&#45;&gt;qkv2_8</title>
<path fill="none" stroke="black" d="M3464.18,-1469.49C4066.49,-1465.26 6734.63,-1444.25 6905,-1402.31 6927.06,-1396.88 6949.77,-1386.59 6969,-1376.27"/>
<polygon fill="black" stroke="black" points="6970.79,-1379.28 6977.85,-1371.38 6967.4,-1373.15 6970.79,-1379.28"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_9 -->
<g id="edge76" class="edge">
<title>recv_stage1&#45;&gt;qkv2_9</title>
<path fill="none" stroke="black" d="M3464.12,-1469.32C4042.62,-1464.48 6520.17,-1441.52 6679,-1402.31 6701.06,-1396.87 6723.77,-1386.58 6742.99,-1376.26"/>
<polygon fill="black" stroke="black" points="6744.78,-1379.26 6751.85,-1371.37 6741.4,-1373.14 6744.78,-1379.26"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_10 -->
<g id="edge80" class="edge">
<title>recv_stage1&#45;&gt;qkv2_10</title>
<path fill="none" stroke="black" d="M3464.17,-1469.14C4018.22,-1463.64 6305.69,-1438.79 6453,-1402.31 6475.06,-1396.85 6497.77,-1386.56 6516.99,-1376.24"/>
<polygon fill="black" stroke="black" points="6518.78,-1379.25 6525.84,-1371.35 6515.4,-1373.12 6518.78,-1379.25"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_11 -->
<g id="edge84" class="edge">
<title>recv_stage1&#45;&gt;qkv2_11</title>
<path fill="none" stroke="black" d="M3464.44,-1470.55C3976.21,-1471.25 5956.58,-1469.53 6227,-1402.31 6249.05,-1396.83 6271.76,-1386.54 6290.98,-1376.22"/>
<polygon fill="black" stroke="black" points="6292.77,-1379.23 6299.84,-1371.33 6289.39,-1373.1 6292.77,-1379.23"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_12 -->
<g id="edge88" class="edge">
<title>recv_stage1&#45;&gt;qkv2_12</title>
<path fill="none" stroke="black" d="M3464.3,-1470.29C3950.17,-1469.87 5753.44,-1464.11 6001,-1402.31 6022.95,-1396.83 6045.56,-1386.59 6064.74,-1376.32"/>
<polygon fill="black" stroke="black" points="6066.5,-1379.35 6073.57,-1371.46 6063.12,-1373.22 6066.5,-1379.35"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_13 -->
<g id="edge92" class="edge">
<title>recv_stage1&#45;&gt;qkv2_13</title>
<path fill="none" stroke="black" d="M3464.46,-1469.98C3923.71,-1468.36 5550.27,-1458.69 5775,-1402.31 5796.95,-1396.81 5819.56,-1386.56 5838.73,-1376.3"/>
<polygon fill="black" stroke="black" points="5840.49,-1379.32 5847.56,-1371.43 5837.12,-1373.19 5840.49,-1379.32"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_14 -->
<g id="edge96" class="edge">
<title>recv_stage1&#45;&gt;qkv2_14</title>
<path fill="none" stroke="black" d="M3464.17,-1469.6C3894.95,-1466.73 5346.96,-1453.31 5549,-1402.31 5570.94,-1396.78 5593.55,-1386.53 5612.72,-1376.26"/>
<polygon fill="black" stroke="black" points="5614.48,-1379.29 5621.56,-1371.4 5611.11,-1373.15 5614.48,-1379.29"/>
</g>
<!-- recv_stage1&#45;&gt;qkv2_15 -->
<g id="edge100" class="edge">
<title>recv_stage1&#45;&gt;qkv2_15</title>
<path fill="none" stroke="black" d="M3461.71,-1463.29C3830.18,-1441.36 4958.48,-1374.23 5321.91,-1352.6"/>
<polygon fill="black" stroke="black" points="5322.14,-1356.09 5331.92,-1352.01 5321.73,-1349.11 5322.14,-1356.09"/>
</g>
<!-- recv_stage1&#45;&gt;res2 -->
<g id="edge105" class="edge">
<title>recv_stage1&#45;&gt;res2</title>
<path fill="none" stroke="black" d="M3324.04,-1434.29C3319.28,-1425.69 3314.06,-1416.27 3308.86,-1406.89"/>
<polygon fill="black" stroke="black" points="3311.8,-1404.99 3303.9,-1397.94 3305.68,-1408.38 3311.8,-1404.99"/>
</g>
<!-- res2&#45;&gt;ffn1_2_8 -->
<g id="edge106" class="edge">
<title>res2&#45;&gt;ffn1_2_8</title>
<path fill="none" stroke="black" d="M3425.01,-1344.49C3794.34,-1344.9 4739.69,-1338.08 5044,-1260.31 5066.3,-1254.62 5089.38,-1244.39 5109.02,-1234.19"/>
<polygon fill="black" stroke="black" points="5110.9,-1237.16 5118.08,-1229.37 5107.61,-1230.98 5110.9,-1237.16"/>
</g>
<!-- res2&#45;&gt;ffn1_2_9 -->
<g id="edge110" class="edge">
<title>res2&#45;&gt;ffn1_2_9</title>
<path fill="none" stroke="black" d="M3424.1,-1343.26C3758.13,-1340.8 4557.58,-1327.82 4818,-1260.31 4840.18,-1254.56 4863.16,-1244.39 4882.75,-1234.24"/>
<polygon fill="black" stroke="black" points="4884.6,-1237.22 4891.79,-1229.44 4881.32,-1231.04 4884.6,-1237.22"/>
</g>
<!-- res2&#45;&gt;ffn1_2_10 -->
<g id="edge114" class="edge">
<title>res2&#45;&gt;ffn1_2_10</title>
<path fill="none" stroke="black" d="M3423.2,-1341.64C3719.5,-1336.11 4375.13,-1317.61 4592,-1260.31 4614.16,-1254.46 4637.13,-1244.26 4656.73,-1234.13"/>
<polygon fill="black" stroke="black" points="4658.57,-1237.11 4665.77,-1229.33 4655.29,-1230.93 4658.57,-1237.11"/>
</g>
<!-- res2&#45;&gt;ffn1_2_11 -->
<g id="edge118" class="edge">
<title>res2&#45;&gt;ffn1_2_11</title>
<path fill="none" stroke="black" d="M3421.58,-1339.48C3676.99,-1330.78 4192.98,-1307.82 4367,-1260.31 4388.86,-1254.35 4411.53,-1244.18 4430.91,-1234.1"/>
<polygon fill="black" stroke="black" points="4432.67,-1237.13 4439.85,-1229.34 4429.38,-1230.95 4432.67,-1237.13"/>
</g>
<!-- res2&#45;&gt;ffn1_2_12 -->
<g id="edge122" class="edge">
<title>res2&#45;&gt;ffn1_2_12</title>
<path fill="none" stroke="black" d="M3419.18,-1336.29C3629.8,-1324.23 4010.89,-1298.02 4143,-1260.31 4164.45,-1254.19 4186.72,-1244.1 4205.83,-1234.13"/>
<polygon fill="black" stroke="black" points="4207.48,-1237.22 4214.65,-1229.42 4204.18,-1231.05 4207.48,-1237.22"/>
</g>
<!-- res2&#45;&gt;ffn1_2_13 -->
<g id="edge126" class="edge">
<title>res2&#45;&gt;ffn1_2_13</title>
<path fill="none" stroke="black" d="M3421.06,-1338.8C3553.73,-1331.01 3753.55,-1311.11 3920,-1260.31 3940.91,-1253.93 3962.67,-1243.95 3981.45,-1234.15"/>
<polygon fill="black" stroke="black" points="3983.24,-1237.16 3990.41,-1229.36 3979.94,-1230.98 3983.24,-1237.16"/>
</g>
<!-- res2&#45;&gt;ffn1_2_14 -->
<g id="edge130" class="edge">
<title>res2&#45;&gt;ffn1_2_14</title>
<path fill="none" stroke="black" d="M3412.14,-1326.63C3496.42,-1313.68 3605.75,-1292.53 3699,-1260.31 3718.75,-1253.49 3739.41,-1243.76 3757.48,-1234.3"/>
<polygon fill="black" stroke="black" points="3759.5,-1237.19 3766.67,-1229.39 3756.2,-1231.02 3759.5,-1237.19"/>
</g>
<!-- res2&#45;&gt;ffn1_2_15 -->
<g id="edge134" class="edge">
<title>res2&#45;&gt;ffn1_2_15</title>
<path fill="none" stroke="black" d="M3390.66,-1297.39C3418.75,-1285.67 3448.59,-1272.84 3476,-1260.31 3494.01,-1252.08 3513.36,-1242.63 3530.88,-1233.85"/>
<polygon fill="black" stroke="black" points="3532.5,-1236.95 3539.86,-1229.32 3529.35,-1230.7 3532.5,-1236.95"/>
</g>
<!-- res2&#45;&gt;res_ffn2 -->
<g id="edge139" class="edge">
<title>res2&#45;&gt;res_ffn2</title>
<path fill="none" stroke="black" d="M3275,-1291.68C3275,-1283.39 3275,-1274.74 3275,-1266.24"/>
<polygon fill="black" stroke="black" points="3278.5,-1265.99 3275,-1255.99 3271.5,-1265.99 3278.5,-1265.99"/>
</g>
<!-- qkv3_8 -->
<g id="node109" class="node">
<title>qkv3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3432,-1102.81 3224,-1102.81 3224,-1049.81 3432,-1049.81 3432,-1102.81"/>
<text text-anchor="middle" x="3328" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 8</text>
<text text-anchor="middle" x="3328" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3328" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_8 -->
<g id="edge140" class="edge">
<title>res_ffn2&#45;&gt;qkv3_8</title>
<path fill="none" stroke="black" d="M3297.17,-1149.74C3302.53,-1137.14 3308.14,-1123.97 3313.08,-1112.37"/>
<polygon fill="black" stroke="black" points="3316.35,-1113.61 3317.05,-1103.04 3309.91,-1110.87 3316.35,-1113.61"/>
</g>
<!-- qkv3_9 -->
<g id="node110" class="node">
<title>qkv3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3206,-1102.81 2998,-1102.81 2998,-1049.81 3206,-1049.81 3206,-1102.81"/>
<text text-anchor="middle" x="3102" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 9</text>
<text text-anchor="middle" x="3102" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3102" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_9 -->
<g id="edge144" class="edge">
<title>res_ffn2&#45;&gt;qkv3_9</title>
<path fill="none" stroke="black" d="M3202.63,-1149.74C3183.38,-1135.88 3163.16,-1121.33 3145.94,-1108.94"/>
<polygon fill="black" stroke="black" points="3147.91,-1106.04 3137.75,-1103.04 3143.82,-1111.72 3147.91,-1106.04"/>
</g>
<!-- qkv3_10 -->
<g id="node111" class="node">
<title>qkv3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2980,-1102.81 2772,-1102.81 2772,-1049.81 2980,-1049.81 2980,-1102.81"/>
<text text-anchor="middle" x="2876" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 10</text>
<text text-anchor="middle" x="2876" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2876" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_10 -->
<g id="edge148" class="edge">
<title>res_ffn2&#45;&gt;qkv3_10</title>
<path fill="none" stroke="black" d="M3098.05,-1166.47C3061.53,-1157.31 3023.66,-1146.41 2989,-1133.81 2969.25,-1126.64 2948.45,-1116.92 2930.16,-1107.56"/>
<polygon fill="black" stroke="black" points="2931.61,-1104.37 2921.12,-1102.87 2928.38,-1110.58 2931.61,-1104.37"/>
</g>
<!-- qkv3_11 -->
<g id="node112" class="node">
<title>qkv3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2754,-1102.81 2546,-1102.81 2546,-1049.81 2754,-1049.81 2754,-1102.81"/>
<text text-anchor="middle" x="2650" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 11</text>
<text text-anchor="middle" x="2650" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2650" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_11 -->
<g id="edge152" class="edge">
<title>res_ffn2&#45;&gt;qkv3_11</title>
<path fill="none" stroke="black" d="M3118.68,-1194.5C3015.79,-1186.43 2879.15,-1169.47 2763,-1133.81 2742.1,-1127.4 2720.34,-1117.41 2701.56,-1107.61"/>
<polygon fill="black" stroke="black" points="2703.07,-1104.44 2692.6,-1102.83 2699.77,-1110.62 2703.07,-1104.44"/>
</g>
<!-- qkv3_12 -->
<g id="node113" class="node">
<title>qkv3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2528,-1102.81 2320,-1102.81 2320,-1049.81 2528,-1049.81 2528,-1102.81"/>
<text text-anchor="middle" x="2424" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 12</text>
<text text-anchor="middle" x="2424" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2424" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_12 -->
<g id="edge156" class="edge">
<title>res_ffn2&#45;&gt;qkv3_12</title>
<path fill="none" stroke="black" d="M3118.32,-1194.19C2934.82,-1184.07 2642.48,-1163.89 2537,-1133.81 2515.7,-1127.74 2493.62,-1117.67 2474.7,-1107.7"/>
<polygon fill="black" stroke="black" points="2476.14,-1104.5 2465.67,-1102.83 2472.81,-1110.66 2476.14,-1104.5"/>
</g>
<!-- qkv3_13 -->
<g id="node114" class="node">
<title>qkv3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2302,-1102.81 2094,-1102.81 2094,-1049.81 2302,-1049.81 2302,-1102.81"/>
<text text-anchor="middle" x="2198" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 13</text>
<text text-anchor="middle" x="2198" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2198" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_13 -->
<g id="edge160" class="edge">
<title>res_ffn2&#45;&gt;qkv3_13</title>
<path fill="none" stroke="black" d="M3121.14,-1198.27C2888.64,-1191.69 2459.18,-1174.35 2311,-1133.81 2289.55,-1127.94 2267.36,-1117.86 2248.38,-1107.82"/>
<polygon fill="black" stroke="black" points="2249.8,-1104.61 2239.34,-1102.91 2246.46,-1110.76 2249.8,-1104.61"/>
</g>
<!-- qkv3_14 -->
<g id="node115" class="node">
<title>qkv3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2076,-1102.81 1868,-1102.81 1868,-1049.81 2076,-1049.81 2076,-1102.81"/>
<text text-anchor="middle" x="1972" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 14</text>
<text text-anchor="middle" x="1972" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1972" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_14 -->
<g id="edge164" class="edge">
<title>res_ffn2&#45;&gt;qkv3_14</title>
<path fill="none" stroke="black" d="M3123.17,-1200.76C2847.74,-1197.58 2276.52,-1184.84 2085,-1133.81 2063.32,-1128.04 2040.92,-1117.86 2021.84,-1107.71"/>
<polygon fill="black" stroke="black" points="2023.5,-1104.63 2013.04,-1102.91 2020.15,-1110.77 2023.5,-1104.63"/>
</g>
<!-- qkv3_15 -->
<g id="node116" class="node">
<title>qkv3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1850,-1102.81 1642,-1102.81 1642,-1049.81 1850,-1049.81 1850,-1102.81"/>
<text text-anchor="middle" x="1746" y="-1087.61" font-family="Times,serif" font-size="14.00">QKV Projection 15</text>
<text text-anchor="middle" x="1746" y="-1072.61" font-family="Times,serif" font-size="14.00">[Q,K,V]: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1746" y="-1057.61" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- res_ffn2&#45;&gt;qkv3_15 -->
<g id="edge168" class="edge">
<title>res_ffn2&#45;&gt;qkv3_15</title>
<path fill="none" stroke="black" d="M3124.4,-1202.42C2810.15,-1202.4 2094.28,-1195.35 1859,-1133.81 1837.2,-1128.11 1814.7,-1117.89 1795.57,-1107.69"/>
<polygon fill="black" stroke="black" points="1797.21,-1104.59 1786.75,-1102.86 1793.85,-1110.73 1797.21,-1104.59"/>
</g>
<!-- res3 -->
<g id="node159" class="node">
<title>res3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2207.88,-669.95 1907.42,-669.95 1830.12,-563.95 2130.58,-563.95 2207.88,-669.95"/>
<text text-anchor="middle" x="2019" y="-628.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2019" y="-613.25" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="2019" y="-598.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- res_ffn2&#45;&gt;res3 -->
<g id="edge173" class="edge">
<title>res_ffn2&#45;&gt;res3</title>
<path fill="none" stroke="black" d="M3123.19,-1200.86C2726.16,-1197.68 1683.86,-1184.5 1630,-1133.81 1579.09,-1085.9 1614,-1047.24 1614,-977.34 1614,-977.34 1614,-977.34 1614,-864.38 1614,-794.94 1584.12,-761.08 1630,-708.95 1661.95,-672.66 1774.51,-648.9 1870.38,-634.8"/>
<polygon fill="black" stroke="black" points="1871.09,-638.23 1880.49,-633.33 1870.09,-631.3 1871.09,-638.23"/>
</g>
<!-- attn3_8 -->
<g id="node117" class="node">
<title>attn3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3432,-1002.84 3224,-1002.84 3224,-949.84 3432,-949.84 3432,-1002.84"/>
<text text-anchor="middle" x="3328" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 8</text>
<text text-anchor="middle" x="3328" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3328" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- qkv3_8&#45;&gt;attn3_8 -->
<g id="edge141" class="edge">
<title>qkv3_8&#45;&gt;attn3_8</title>
<path fill="none" stroke="black" d="M3328,-1049.57C3328,-1038.43 3328,-1025.21 3328,-1013.14"/>
<polygon fill="black" stroke="black" points="3331.5,-1012.91 3328,-1002.91 3324.5,-1012.91 3331.5,-1012.91"/>
</g>
<!-- attn3_9 -->
<g id="node118" class="node">
<title>attn3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3206,-1002.84 2998,-1002.84 2998,-949.84 3206,-949.84 3206,-1002.84"/>
<text text-anchor="middle" x="3102" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 9</text>
<text text-anchor="middle" x="3102" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3102" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- qkv3_9&#45;&gt;attn3_9 -->
<g id="edge145" class="edge">
<title>qkv3_9&#45;&gt;attn3_9</title>
<path fill="none" stroke="black" d="M3102,-1049.57C3102,-1038.43 3102,-1025.21 3102,-1013.14"/>
<polygon fill="black" stroke="black" points="3105.5,-1012.91 3102,-1002.91 3098.5,-1012.91 3105.5,-1012.91"/>
</g>
<!-- attn3_10 -->
<g id="node119" class="node">
<title>attn3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2980,-1002.84 2772,-1002.84 2772,-949.84 2980,-949.84 2980,-1002.84"/>
<text text-anchor="middle" x="2876" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 10</text>
<text text-anchor="middle" x="2876" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2876" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- qkv3_10&#45;&gt;attn3_10 -->
<g id="edge149" class="edge">
<title>qkv3_10&#45;&gt;attn3_10</title>
<path fill="none" stroke="black" d="M2876,-1049.57C2876,-1038.43 2876,-1025.21 2876,-1013.14"/>
<polygon fill="black" stroke="black" points="2879.5,-1012.91 2876,-1002.91 2872.5,-1012.91 2879.5,-1012.91"/>
</g>
<!-- attn3_11 -->
<g id="node120" class="node">
<title>attn3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2754,-1002.84 2546,-1002.84 2546,-949.84 2754,-949.84 2754,-1002.84"/>
<text text-anchor="middle" x="2650" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 11</text>
<text text-anchor="middle" x="2650" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2650" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- qkv3_11&#45;&gt;attn3_11 -->
<g id="edge153" class="edge">
<title>qkv3_11&#45;&gt;attn3_11</title>
<path fill="none" stroke="black" d="M2650,-1049.57C2650,-1038.43 2650,-1025.21 2650,-1013.14"/>
<polygon fill="black" stroke="black" points="2653.5,-1012.91 2650,-1002.91 2646.5,-1012.91 2653.5,-1012.91"/>
</g>
<!-- attn3_12 -->
<g id="node121" class="node">
<title>attn3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2528,-1002.84 2320,-1002.84 2320,-949.84 2528,-949.84 2528,-1002.84"/>
<text text-anchor="middle" x="2424" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 12</text>
<text text-anchor="middle" x="2424" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2424" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- qkv3_12&#45;&gt;attn3_12 -->
<g id="edge157" class="edge">
<title>qkv3_12&#45;&gt;attn3_12</title>
<path fill="none" stroke="black" d="M2424,-1049.57C2424,-1038.43 2424,-1025.21 2424,-1013.14"/>
<polygon fill="black" stroke="black" points="2427.5,-1012.91 2424,-1002.91 2420.5,-1012.91 2427.5,-1012.91"/>
</g>
<!-- attn3_13 -->
<g id="node122" class="node">
<title>attn3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2302,-1002.84 2094,-1002.84 2094,-949.84 2302,-949.84 2302,-1002.84"/>
<text text-anchor="middle" x="2198" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 13</text>
<text text-anchor="middle" x="2198" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2198" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- qkv3_13&#45;&gt;attn3_13 -->
<g id="edge161" class="edge">
<title>qkv3_13&#45;&gt;attn3_13</title>
<path fill="none" stroke="black" d="M2198,-1049.57C2198,-1038.43 2198,-1025.21 2198,-1013.14"/>
<polygon fill="black" stroke="black" points="2201.5,-1012.91 2198,-1002.91 2194.5,-1012.91 2201.5,-1012.91"/>
</g>
<!-- attn3_14 -->
<g id="node123" class="node">
<title>attn3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2076,-1002.84 1868,-1002.84 1868,-949.84 2076,-949.84 2076,-1002.84"/>
<text text-anchor="middle" x="1972" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 14</text>
<text text-anchor="middle" x="1972" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1972" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- qkv3_14&#45;&gt;attn3_14 -->
<g id="edge165" class="edge">
<title>qkv3_14&#45;&gt;attn3_14</title>
<path fill="none" stroke="black" d="M1972,-1049.57C1972,-1038.43 1972,-1025.21 1972,-1013.14"/>
<polygon fill="black" stroke="black" points="1975.5,-1012.91 1972,-1002.91 1968.5,-1012.91 1975.5,-1012.91"/>
</g>
<!-- attn3_15 -->
<g id="node124" class="node">
<title>attn3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1850,-1002.84 1642,-1002.84 1642,-949.84 1850,-949.84 1850,-1002.84"/>
<text text-anchor="middle" x="1746" y="-987.64" font-family="Times,serif" font-size="14.00">Attention 15</text>
<text text-anchor="middle" x="1746" y="-972.64" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1746" y="-957.64" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- qkv3_15&#45;&gt;attn3_15 -->
<g id="edge169" class="edge">
<title>qkv3_15&#45;&gt;attn3_15</title>
<path fill="none" stroke="black" d="M1746,-1049.57C1746,-1038.43 1746,-1025.21 1746,-1013.14"/>
<polygon fill="black" stroke="black" points="1749.5,-1012.91 1746,-1002.91 1742.5,-1012.91 1749.5,-1012.91"/>
</g>
<!-- out3_8 -->
<g id="node125" class="node">
<title>out3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3432,-891.88 3224,-891.88 3224,-838.88 3432,-838.88 3432,-891.88"/>
<text text-anchor="middle" x="3328" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 8</text>
<text text-anchor="middle" x="3328" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3328" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- attn3_8&#45;&gt;out3_8 -->
<g id="edge142" class="edge">
<title>attn3_8&#45;&gt;out3_8</title>
<path fill="none" stroke="black" d="M3328,-949.79C3328,-935.69 3328,-917.94 3328,-902.44"/>
<polygon fill="black" stroke="black" points="3331.5,-902.15 3328,-892.15 3324.5,-902.15 3331.5,-902.15"/>
</g>
<!-- out3_9 -->
<g id="node126" class="node">
<title>out3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="3206,-891.88 2998,-891.88 2998,-838.88 3206,-838.88 3206,-891.88"/>
<text text-anchor="middle" x="3102" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 9</text>
<text text-anchor="middle" x="3102" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="3102" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- attn3_9&#45;&gt;out3_9 -->
<g id="edge146" class="edge">
<title>attn3_9&#45;&gt;out3_9</title>
<path fill="none" stroke="black" d="M3102,-949.79C3102,-935.69 3102,-917.94 3102,-902.44"/>
<polygon fill="black" stroke="black" points="3105.5,-902.15 3102,-892.15 3098.5,-902.15 3105.5,-902.15"/>
</g>
<!-- out3_10 -->
<g id="node127" class="node">
<title>out3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2980,-891.88 2772,-891.88 2772,-838.88 2980,-838.88 2980,-891.88"/>
<text text-anchor="middle" x="2876" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 10</text>
<text text-anchor="middle" x="2876" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2876" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- attn3_10&#45;&gt;out3_10 -->
<g id="edge150" class="edge">
<title>attn3_10&#45;&gt;out3_10</title>
<path fill="none" stroke="black" d="M2876,-949.79C2876,-935.69 2876,-917.94 2876,-902.44"/>
<polygon fill="black" stroke="black" points="2879.5,-902.15 2876,-892.15 2872.5,-902.15 2879.5,-902.15"/>
</g>
<!-- out3_11 -->
<g id="node128" class="node">
<title>out3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2754,-891.88 2546,-891.88 2546,-838.88 2754,-838.88 2754,-891.88"/>
<text text-anchor="middle" x="2650" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 11</text>
<text text-anchor="middle" x="2650" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2650" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- attn3_11&#45;&gt;out3_11 -->
<g id="edge154" class="edge">
<title>attn3_11&#45;&gt;out3_11</title>
<path fill="none" stroke="black" d="M2650,-949.79C2650,-935.69 2650,-917.94 2650,-902.44"/>
<polygon fill="black" stroke="black" points="2653.5,-902.15 2650,-892.15 2646.5,-902.15 2653.5,-902.15"/>
</g>
<!-- out3_12 -->
<g id="node129" class="node">
<title>out3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2528,-891.88 2320,-891.88 2320,-838.88 2528,-838.88 2528,-891.88"/>
<text text-anchor="middle" x="2424" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 12</text>
<text text-anchor="middle" x="2424" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2424" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- attn3_12&#45;&gt;out3_12 -->
<g id="edge158" class="edge">
<title>attn3_12&#45;&gt;out3_12</title>
<path fill="none" stroke="black" d="M2424,-949.79C2424,-935.69 2424,-917.94 2424,-902.44"/>
<polygon fill="black" stroke="black" points="2427.5,-902.15 2424,-892.15 2420.5,-902.15 2427.5,-902.15"/>
</g>
<!-- out3_13 -->
<g id="node130" class="node">
<title>out3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2302,-891.88 2094,-891.88 2094,-838.88 2302,-838.88 2302,-891.88"/>
<text text-anchor="middle" x="2198" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 13</text>
<text text-anchor="middle" x="2198" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="2198" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- attn3_13&#45;&gt;out3_13 -->
<g id="edge162" class="edge">
<title>attn3_13&#45;&gt;out3_13</title>
<path fill="none" stroke="black" d="M2198,-949.79C2198,-935.69 2198,-917.94 2198,-902.44"/>
<polygon fill="black" stroke="black" points="2201.5,-902.15 2198,-892.15 2194.5,-902.15 2201.5,-902.15"/>
</g>
<!-- out3_14 -->
<g id="node131" class="node">
<title>out3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2076,-891.88 1868,-891.88 1868,-838.88 2076,-838.88 2076,-891.88"/>
<text text-anchor="middle" x="1972" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 14</text>
<text text-anchor="middle" x="1972" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1972" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- attn3_14&#45;&gt;out3_14 -->
<g id="edge166" class="edge">
<title>attn3_14&#45;&gt;out3_14</title>
<path fill="none" stroke="black" d="M1972,-949.79C1972,-935.69 1972,-917.94 1972,-902.44"/>
<polygon fill="black" stroke="black" points="1975.5,-902.15 1972,-892.15 1968.5,-902.15 1975.5,-902.15"/>
</g>
<!-- out3_15 -->
<g id="node132" class="node">
<title>out3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1850,-891.88 1642,-891.88 1642,-838.88 1850,-838.88 1850,-891.88"/>
<text text-anchor="middle" x="1746" y="-876.68" font-family="Times,serif" font-size="14.00">Output Proj 15</text>
<text text-anchor="middle" x="1746" y="-861.68" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1746" y="-846.68" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- attn3_15&#45;&gt;out3_15 -->
<g id="edge170" class="edge">
<title>attn3_15&#45;&gt;out3_15</title>
<path fill="none" stroke="black" d="M1746,-949.79C1746,-935.69 1746,-917.94 1746,-902.44"/>
<polygon fill="black" stroke="black" points="1749.5,-902.15 1746,-892.15 1742.5,-902.15 1749.5,-902.15"/>
</g>
<!-- ar3 -->
<g id="node133" class="node">
<title>ar3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="2424" cy="-754.43" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="2424" y="-765.73" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="2424" y="-750.73" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="2424" y="-735.73" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- out3_8&#45;&gt;ar3 -->
<g id="edge143" class="edge">
<title>out3_8&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M3272.71,-838.88C3254.67,-831.58 3234.3,-824.39 3215,-819.91 3090.87,-791.08 2733.16,-770.25 2544.22,-760.91"/>
<polygon fill="black" stroke="black" points="2544.12,-757.4 2533.96,-760.41 2543.78,-764.39 2544.12,-757.4"/>
</g>
<!-- out3_9&#45;&gt;ar3 -->
<g id="edge147" class="edge">
<title>out3_9&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M3045.46,-838.79C3027.71,-831.66 3007.82,-824.6 2989,-819.91 2838.47,-782.38 2659.87,-766.63 2544.37,-760.06"/>
<polygon fill="black" stroke="black" points="2544.26,-756.55 2534.08,-759.49 2543.88,-763.54 2544.26,-756.55"/>
</g>
<!-- out3_10&#45;&gt;ar3 -->
<g id="edge151" class="edge">
<title>out3_10&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M2817.2,-838.83C2799.96,-832 2780.92,-825.09 2763,-819.91 2688.41,-798.34 2602.47,-782.09 2535.78,-771.29"/>
<polygon fill="black" stroke="black" points="2536.09,-767.8 2525.66,-769.67 2534.98,-774.71 2536.09,-767.8"/>
</g>
<!-- out3_11&#45;&gt;ar3 -->
<g id="edge155" class="edge">
<title>out3_11&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M2597.01,-838.84C2566.84,-824.29 2528.63,-805.87 2495.79,-790.04"/>
<polygon fill="black" stroke="black" points="2497.22,-786.84 2486.69,-785.65 2494.18,-793.15 2497.22,-786.84"/>
</g>
<!-- out3_12&#45;&gt;ar3 -->
<g id="edge159" class="edge">
<title>out3_12&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M2424,-838.84C2424,-827.93 2424,-814.84 2424,-802.3"/>
<polygon fill="black" stroke="black" points="2427.5,-801.95 2424,-791.95 2420.5,-801.95 2427.5,-801.95"/>
</g>
<!-- out3_13&#45;&gt;ar3 -->
<g id="edge163" class="edge">
<title>out3_13&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M2250.99,-838.84C2281.16,-824.29 2319.37,-805.87 2352.21,-790.04"/>
<polygon fill="black" stroke="black" points="2353.82,-793.15 2361.31,-785.65 2350.78,-786.84 2353.82,-793.15"/>
</g>
<!-- out3_14&#45;&gt;ar3 -->
<g id="edge167" class="edge">
<title>out3_14&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M2030.8,-838.83C2048.04,-832 2067.08,-825.09 2085,-819.91 2159.59,-798.34 2245.53,-782.09 2312.22,-771.29"/>
<polygon fill="black" stroke="black" points="2313.02,-774.71 2322.34,-769.67 2311.91,-767.8 2313.02,-774.71"/>
</g>
<!-- out3_15&#45;&gt;ar3 -->
<g id="edge171" class="edge">
<title>out3_15&#45;&gt;ar3</title>
<path fill="none" stroke="black" d="M1802.54,-838.79C1820.29,-831.66 1840.18,-824.6 1859,-819.91 2009.53,-782.38 2188.13,-766.63 2303.63,-760.06"/>
<polygon fill="black" stroke="black" points="2304.12,-763.54 2313.92,-759.49 2303.74,-756.55 2304.12,-763.54"/>
</g>
<!-- ar3&#45;&gt;res3 -->
<g id="edge172" class="edge">
<title>ar3&#45;&gt;res3</title>
<path fill="none" stroke="black" d="M2346.39,-727.47C2300.47,-712.11 2240.49,-692.04 2184.43,-673.29"/>
<polygon fill="black" stroke="black" points="2185.34,-669.91 2174.75,-670.05 2183.12,-676.54 2185.34,-669.91"/>
</g>
<!-- ffn1_3_8 -->
<g id="node134" class="node">
<title>ffn1_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1804.5,-501.45 1603.5,-501.45 1603.5,-448.45 1804.5,-448.45 1804.5,-501.45"/>
<text text-anchor="middle" x="1704" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 8</text>
<text text-anchor="middle" x="1704" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1704" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act3_8 -->
<g id="node142" class="node">
<title>act3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1803.5,-348.45 1602.5,-348.45 1602.5,-295.45 1803.5,-295.45 1803.5,-348.45"/>
<text text-anchor="middle" x="1703" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 8</text>
<text text-anchor="middle" x="1703" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1703" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- ffn1_3_8&#45;&gt;act3_8 -->
<g id="edge175" class="edge">
<title>ffn1_3_8&#45;&gt;act3_8</title>
<path fill="none" stroke="black" d="M1703.83,-448.34C1703.67,-423.72 1703.42,-386.28 1703.24,-358.73"/>
<polygon fill="black" stroke="black" points="1706.74,-358.67 1703.17,-348.69 1699.74,-358.72 1706.74,-358.67"/>
</g>
<!-- ffn1_3_9 -->
<g id="node135" class="node">
<title>ffn1_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1582.5,-501.45 1381.5,-501.45 1381.5,-448.45 1582.5,-448.45 1582.5,-501.45"/>
<text text-anchor="middle" x="1482" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 9</text>
<text text-anchor="middle" x="1482" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1482" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act3_9 -->
<g id="node143" class="node">
<title>act3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1580.5,-348.45 1379.5,-348.45 1379.5,-295.45 1580.5,-295.45 1580.5,-348.45"/>
<text text-anchor="middle" x="1480" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 9</text>
<text text-anchor="middle" x="1480" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1480" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- ffn1_3_9&#45;&gt;act3_9 -->
<g id="edge179" class="edge">
<title>ffn1_3_9&#45;&gt;act3_9</title>
<path fill="none" stroke="black" d="M1481.66,-448.34C1481.33,-423.72 1480.84,-386.28 1480.47,-358.73"/>
<polygon fill="black" stroke="black" points="1483.97,-358.65 1480.34,-348.69 1476.97,-358.74 1483.97,-358.65"/>
</g>
<!-- ffn1_3_10 -->
<g id="node136" class="node">
<title>ffn1_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1360.5,-501.45 1159.5,-501.45 1159.5,-448.45 1360.5,-448.45 1360.5,-501.45"/>
<text text-anchor="middle" x="1260" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 10</text>
<text text-anchor="middle" x="1260" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1260" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act3_10 -->
<g id="node144" class="node">
<title>act3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1358.5,-348.45 1157.5,-348.45 1157.5,-295.45 1358.5,-295.45 1358.5,-348.45"/>
<text text-anchor="middle" x="1258" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 10</text>
<text text-anchor="middle" x="1258" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1258" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- ffn1_3_10&#45;&gt;act3_10 -->
<g id="edge183" class="edge">
<title>ffn1_3_10&#45;&gt;act3_10</title>
<path fill="none" stroke="black" d="M1259.66,-448.34C1259.33,-423.72 1258.84,-386.28 1258.47,-358.73"/>
<polygon fill="black" stroke="black" points="1261.97,-358.65 1258.34,-348.69 1254.97,-358.74 1261.97,-358.65"/>
</g>
<!-- ffn1_3_11 -->
<g id="node137" class="node">
<title>ffn1_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1136.5,-501.45 935.5,-501.45 935.5,-448.45 1136.5,-448.45 1136.5,-501.45"/>
<text text-anchor="middle" x="1036" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 11</text>
<text text-anchor="middle" x="1036" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1036" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act3_11 -->
<g id="node145" class="node">
<title>act3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1131.5,-348.45 930.5,-348.45 930.5,-295.45 1131.5,-295.45 1131.5,-348.45"/>
<text text-anchor="middle" x="1031" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 11</text>
<text text-anchor="middle" x="1031" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="1031" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- ffn1_3_11&#45;&gt;act3_11 -->
<g id="edge187" class="edge">
<title>ffn1_3_11&#45;&gt;act3_11</title>
<path fill="none" stroke="black" d="M1035.15,-448.34C1034.34,-423.72 1033.1,-386.28 1032.18,-358.73"/>
<polygon fill="black" stroke="black" points="1035.68,-358.57 1031.85,-348.69 1028.69,-358.8 1035.68,-358.57"/>
</g>
<!-- ffn1_3_12 -->
<g id="node138" class="node">
<title>ffn1_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="911.5,-501.45 710.5,-501.45 710.5,-448.45 911.5,-448.45 911.5,-501.45"/>
<text text-anchor="middle" x="811" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 12</text>
<text text-anchor="middle" x="811" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="811" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act3_12 -->
<g id="node146" class="node">
<title>act3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="905.5,-348.45 704.5,-348.45 704.5,-295.45 905.5,-295.45 905.5,-348.45"/>
<text text-anchor="middle" x="805" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 12</text>
<text text-anchor="middle" x="805" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="805" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- ffn1_3_12&#45;&gt;act3_12 -->
<g id="edge191" class="edge">
<title>ffn1_3_12&#45;&gt;act3_12</title>
<path fill="none" stroke="black" d="M809.98,-448.34C809,-423.72 807.52,-386.28 806.42,-358.73"/>
<polygon fill="black" stroke="black" points="809.92,-358.55 806.02,-348.69 802.92,-358.83 809.92,-358.55"/>
</g>
<!-- ffn1_3_13 -->
<g id="node139" class="node">
<title>ffn1_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="685.5,-501.45 484.5,-501.45 484.5,-448.45 685.5,-448.45 685.5,-501.45"/>
<text text-anchor="middle" x="585" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 13</text>
<text text-anchor="middle" x="585" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="585" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act3_13 -->
<g id="node147" class="node">
<title>act3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="679.5,-348.45 478.5,-348.45 478.5,-295.45 679.5,-295.45 679.5,-348.45"/>
<text text-anchor="middle" x="579" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 13</text>
<text text-anchor="middle" x="579" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="579" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- ffn1_3_13&#45;&gt;act3_13 -->
<g id="edge195" class="edge">
<title>ffn1_3_13&#45;&gt;act3_13</title>
<path fill="none" stroke="black" d="M583.98,-448.34C583,-423.72 581.52,-386.28 580.42,-358.73"/>
<polygon fill="black" stroke="black" points="583.92,-358.55 580.02,-348.69 576.92,-358.83 583.92,-358.55"/>
</g>
<!-- ffn1_3_14 -->
<g id="node140" class="node">
<title>ffn1_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="459.5,-501.45 258.5,-501.45 258.5,-448.45 459.5,-448.45 459.5,-501.45"/>
<text text-anchor="middle" x="359" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 14</text>
<text text-anchor="middle" x="359" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="359" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act3_14 -->
<g id="node148" class="node">
<title>act3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="453.5,-348.45 252.5,-348.45 252.5,-295.45 453.5,-295.45 453.5,-348.45"/>
<text text-anchor="middle" x="353" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 14</text>
<text text-anchor="middle" x="353" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="353" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- ffn1_3_14&#45;&gt;act3_14 -->
<g id="edge199" class="edge">
<title>ffn1_3_14&#45;&gt;act3_14</title>
<path fill="none" stroke="black" d="M357.98,-448.34C357,-423.72 355.52,-386.28 354.42,-358.73"/>
<polygon fill="black" stroke="black" points="357.92,-358.55 354.02,-348.69 350.92,-358.83 357.92,-358.55"/>
</g>
<!-- ffn1_3_15 -->
<g id="node141" class="node">
<title>ffn1_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="233.5,-501.45 32.5,-501.45 32.5,-448.45 233.5,-448.45 233.5,-501.45"/>
<text text-anchor="middle" x="133" y="-486.25" font-family="Times,serif" font-size="14.00">FFN Linear1 15</text>
<text text-anchor="middle" x="133" y="-471.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="133" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act3_15 -->
<g id="node149" class="node">
<title>act3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="227.5,-348.45 26.5,-348.45 26.5,-295.45 227.5,-295.45 227.5,-348.45"/>
<text text-anchor="middle" x="127" y="-333.25" font-family="Times,serif" font-size="14.00">GELU 15</text>
<text text-anchor="middle" x="127" y="-318.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, ffn_dim/8]</text>
<text text-anchor="middle" x="127" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- ffn1_3_15&#45;&gt;act3_15 -->
<g id="edge203" class="edge">
<title>ffn1_3_15&#45;&gt;act3_15</title>
<path fill="none" stroke="black" d="M131.98,-448.34C131,-423.72 129.52,-386.28 128.42,-358.73"/>
<polygon fill="black" stroke="black" points="131.92,-358.55 128.02,-348.69 124.92,-358.83 131.92,-358.55"/>
</g>
<!-- ffn2_3_8 -->
<g id="node150" class="node">
<title>ffn2_3_8</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1806,-206.45 1598,-206.45 1598,-153.45 1806,-153.45 1806,-206.45"/>
<text text-anchor="middle" x="1702" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 8</text>
<text text-anchor="middle" x="1702" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1702" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 8</text>
</g>
<!-- act3_8&#45;&gt;ffn2_3_8 -->
<g id="edge176" class="edge">
<title>act3_8&#45;&gt;ffn2_3_8</title>
<path fill="none" stroke="black" d="M1702.82,-295.28C1702.66,-273.17 1702.43,-241.05 1702.25,-216.48"/>
<polygon fill="black" stroke="black" points="1705.75,-216.44 1702.18,-206.47 1698.75,-216.49 1705.75,-216.44"/>
</g>
<!-- ffn2_3_9 -->
<g id="node151" class="node">
<title>ffn2_3_9</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1580,-206.45 1372,-206.45 1372,-153.45 1580,-153.45 1580,-206.45"/>
<text text-anchor="middle" x="1476" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 9</text>
<text text-anchor="middle" x="1476" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1476" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 9</text>
</g>
<!-- act3_9&#45;&gt;ffn2_3_9 -->
<g id="edge180" class="edge">
<title>act3_9&#45;&gt;ffn2_3_9</title>
<path fill="none" stroke="black" d="M1479.27,-295.28C1478.63,-273.17 1477.72,-241.05 1477.02,-216.48"/>
<polygon fill="black" stroke="black" points="1480.51,-216.36 1476.73,-206.47 1473.52,-216.56 1480.51,-216.36"/>
</g>
<!-- ffn2_3_10 -->
<g id="node152" class="node">
<title>ffn2_3_10</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1354,-206.45 1146,-206.45 1146,-153.45 1354,-153.45 1354,-206.45"/>
<text text-anchor="middle" x="1250" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 10</text>
<text text-anchor="middle" x="1250" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1250" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 10</text>
</g>
<!-- act3_10&#45;&gt;ffn2_3_10 -->
<g id="edge184" class="edge">
<title>act3_10&#45;&gt;ffn2_3_10</title>
<path fill="none" stroke="black" d="M1256.53,-295.28C1255.27,-273.17 1253.43,-241.05 1252.03,-216.48"/>
<polygon fill="black" stroke="black" points="1255.52,-216.25 1251.46,-206.47 1248.53,-216.65 1255.52,-216.25"/>
</g>
<!-- ffn2_3_11 -->
<g id="node153" class="node">
<title>ffn2_3_11</title>
<polygon fill="lightyellow" stroke="lightyellow" points="1128,-206.45 920,-206.45 920,-153.45 1128,-153.45 1128,-206.45"/>
<text text-anchor="middle" x="1024" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 11</text>
<text text-anchor="middle" x="1024" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="1024" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 11</text>
</g>
<!-- act3_11&#45;&gt;ffn2_3_11 -->
<g id="edge188" class="edge">
<title>act3_11&#45;&gt;ffn2_3_11</title>
<path fill="none" stroke="black" d="M1029.72,-295.28C1028.61,-273.17 1027.01,-241.05 1025.78,-216.48"/>
<polygon fill="black" stroke="black" points="1029.27,-216.28 1025.28,-206.47 1022.28,-216.63 1029.27,-216.28"/>
</g>
<!-- ffn2_3_12 -->
<g id="node154" class="node">
<title>ffn2_3_12</title>
<polygon fill="lightyellow" stroke="lightyellow" points="902,-206.45 694,-206.45 694,-153.45 902,-153.45 902,-206.45"/>
<text text-anchor="middle" x="798" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 12</text>
<text text-anchor="middle" x="798" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="798" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 12</text>
</g>
<!-- act3_12&#45;&gt;ffn2_3_12 -->
<g id="edge192" class="edge">
<title>act3_12&#45;&gt;ffn2_3_12</title>
<path fill="none" stroke="black" d="M803.72,-295.28C802.61,-273.17 801.01,-241.05 799.78,-216.48"/>
<polygon fill="black" stroke="black" points="803.27,-216.28 799.28,-206.47 796.28,-216.63 803.27,-216.28"/>
</g>
<!-- ffn2_3_13 -->
<g id="node155" class="node">
<title>ffn2_3_13</title>
<polygon fill="lightyellow" stroke="lightyellow" points="676,-206.45 468,-206.45 468,-153.45 676,-153.45 676,-206.45"/>
<text text-anchor="middle" x="572" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 13</text>
<text text-anchor="middle" x="572" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="572" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 13</text>
</g>
<!-- act3_13&#45;&gt;ffn2_3_13 -->
<g id="edge196" class="edge">
<title>act3_13&#45;&gt;ffn2_3_13</title>
<path fill="none" stroke="black" d="M577.72,-295.28C576.61,-273.17 575.01,-241.05 573.78,-216.48"/>
<polygon fill="black" stroke="black" points="577.27,-216.28 573.28,-206.47 570.28,-216.63 577.27,-216.28"/>
</g>
<!-- ffn2_3_14 -->
<g id="node156" class="node">
<title>ffn2_3_14</title>
<polygon fill="lightyellow" stroke="lightyellow" points="450,-206.45 242,-206.45 242,-153.45 450,-153.45 450,-206.45"/>
<text text-anchor="middle" x="346" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 14</text>
<text text-anchor="middle" x="346" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="346" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 14</text>
</g>
<!-- act3_14&#45;&gt;ffn2_3_14 -->
<g id="edge200" class="edge">
<title>act3_14&#45;&gt;ffn2_3_14</title>
<path fill="none" stroke="black" d="M351.72,-295.28C350.61,-273.17 349.01,-241.05 347.78,-216.48"/>
<polygon fill="black" stroke="black" points="351.27,-216.28 347.28,-206.47 344.28,-216.63 351.27,-216.28"/>
</g>
<!-- ffn2_3_15 -->
<g id="node157" class="node">
<title>ffn2_3_15</title>
<polygon fill="lightyellow" stroke="lightyellow" points="224,-206.45 16,-206.45 16,-153.45 224,-153.45 224,-206.45"/>
<text text-anchor="middle" x="120" y="-191.25" font-family="Times,serif" font-size="14.00">FFN Linear2 15</text>
<text text-anchor="middle" x="120" y="-176.25" font-family="Times,serif" font-size="14.00">Output: [B, L/P, d_model/8]</text>
<text text-anchor="middle" x="120" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: 15</text>
</g>
<!-- act3_15&#45;&gt;ffn2_3_15 -->
<g id="edge204" class="edge">
<title>act3_15&#45;&gt;ffn2_3_15</title>
<path fill="none" stroke="black" d="M125.72,-295.28C124.61,-273.17 123.01,-241.05 121.78,-216.48"/>
<polygon fill="black" stroke="black" points="125.27,-216.28 121.28,-206.47 118.28,-216.63 125.27,-216.28"/>
</g>
<!-- ar_ffn3 -->
<g id="node158" class="node">
<title>ar_ffn3</title>
<ellipse fill="lightyellow" stroke="lightyellow" cx="1024" cy="-53.48" rx="111.03" ry="37.45"/>
<text text-anchor="middle" x="1024" y="-64.78" font-family="Times,serif" font-size="14.00">All&#45;Reduce</text>
<text text-anchor="middle" x="1024" y="-49.78" font-family="Times,serif" font-size="14.00">Sum across 8 GPUs</text>
<text text-anchor="middle" x="1024" y="-34.78" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ffn2_3_8&#45;&gt;ar_ffn3 -->
<g id="edge177" class="edge">
<title>ffn2_3_8&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M1662.8,-153.45C1641.76,-140.99 1614.88,-126.98 1589,-118.95 1440.69,-72.93 1261.33,-59.12 1145.07,-55.32"/>
<polygon fill="black" stroke="black" points="1145.17,-51.82 1135.07,-55.01 1144.96,-58.81 1145.17,-51.82"/>
</g>
<!-- ffn2_3_9&#45;&gt;ar_ffn3 -->
<g id="edge181" class="edge">
<title>ffn2_3_9&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M1434.98,-153.33C1414.11,-141.3 1387.94,-127.72 1363,-118.95 1290.56,-93.49 1205.68,-77.36 1138.98,-67.6"/>
<polygon fill="black" stroke="black" points="1139.25,-64.11 1128.85,-66.15 1138.25,-71.03 1139.25,-64.11"/>
</g>
<!-- ffn2_3_10&#45;&gt;ar_ffn3 -->
<g id="edge185" class="edge">
<title>ffn2_3_10&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M1203.45,-153.31C1170.69,-135.27 1126.38,-110.86 1089.98,-90.82"/>
<polygon fill="black" stroke="black" points="1091.36,-87.58 1080.91,-85.82 1087.98,-93.71 1091.36,-87.58"/>
</g>
<!-- ffn2_3_11&#45;&gt;ar_ffn3 -->
<g id="edge189" class="edge">
<title>ffn2_3_11&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M1024,-153.16C1024,-138.16 1024,-118.8 1024,-101.2"/>
<polygon fill="black" stroke="black" points="1027.5,-101.09 1024,-91.09 1020.5,-101.09 1027.5,-101.09"/>
</g>
<!-- ffn2_3_12&#45;&gt;ar_ffn3 -->
<g id="edge193" class="edge">
<title>ffn2_3_12&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M844.55,-153.31C877.31,-135.27 921.62,-110.86 958.02,-90.82"/>
<polygon fill="black" stroke="black" points="960.02,-93.71 967.09,-85.82 956.64,-87.58 960.02,-93.71"/>
</g>
<!-- ffn2_3_13&#45;&gt;ar_ffn3 -->
<g id="edge197" class="edge">
<title>ffn2_3_13&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M613.02,-153.33C633.89,-141.3 660.06,-127.72 685,-118.95 757.44,-93.49 842.32,-77.36 909.02,-67.6"/>
<polygon fill="black" stroke="black" points="909.75,-71.03 919.15,-66.15 908.75,-64.11 909.75,-71.03"/>
</g>
<!-- ffn2_3_14&#45;&gt;ar_ffn3 -->
<g id="edge201" class="edge">
<title>ffn2_3_14&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M385.2,-153.45C406.24,-140.99 433.12,-126.98 459,-118.95 607.31,-72.93 786.67,-59.12 902.93,-55.32"/>
<polygon fill="black" stroke="black" points="903.04,-58.81 912.93,-55.01 902.83,-51.82 903.04,-58.81"/>
</g>
<!-- ffn2_3_15&#45;&gt;ar_ffn3 -->
<g id="edge205" class="edge">
<title>ffn2_3_15&#45;&gt;ar_ffn3</title>
<path fill="none" stroke="black" d="M158.58,-153.41C179.67,-140.78 206.78,-126.63 233,-118.95 355.36,-83.14 714.18,-65.41 903.64,-58.34"/>
<polygon fill="black" stroke="black" points="903.78,-61.83 913.65,-57.97 903.52,-54.84 903.78,-61.83"/>
</g>
<!-- res_ffn3 -->
<g id="node160" class="node">
<title>res_ffn3</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2207.88,-527.95 1907.42,-527.95 1830.12,-421.95 2130.58,-421.95 2207.88,-527.95"/>
<text text-anchor="middle" x="2019" y="-486.25" font-family="Times,serif" font-size="14.00">Residual Add</text>
<text text-anchor="middle" x="2019" y="-471.25" font-family="Times,serif" font-size="14.00">Input: [B, L/P, d_model]</text>
<text text-anchor="middle" x="2019" y="-456.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15</text>
</g>
<!-- ar_ffn3&#45;&gt;res_ffn3 -->
<g id="edge206" class="edge">
<title>ar_ffn3&#45;&gt;res_ffn3</title>
<path fill="none" stroke="black" d="M1135.03,-55.89C1341.27,-59.62 1767.03,-72.87 1815,-118.95 1907.66,-207.98 1771.74,-304.03 1850,-405.95 1852.35,-409.02 1854.87,-411.95 1857.52,-414.74"/>
<polygon fill="black" stroke="black" points="1855.24,-417.4 1864.86,-421.84 1860.1,-412.37 1855.24,-417.4"/>
</g>
<!-- res3&#45;&gt;ffn1_3_8 -->
<g id="edge174" class="edge">
<title>res3&#45;&gt;ffn1_3_8</title>
<path fill="none" stroke="black" d="M1890.05,-563.87C1865.98,-553.73 1841.13,-542.98 1818,-532.45 1799.94,-524.24 1780.51,-514.83 1762.91,-506.08"/>
<polygon fill="black" stroke="black" points="1764.39,-502.91 1753.88,-501.57 1761.26,-509.17 1764.39,-502.91"/>
</g>
<!-- res3&#45;&gt;ffn1_3_9 -->
<g id="edge178" class="edge">
<title>res3&#45;&gt;ffn1_3_9</title>
<path fill="none" stroke="black" d="M1852.01,-593.97C1772.52,-580.78 1676.95,-560.92 1594,-532.45 1574,-525.59 1553.06,-515.8 1534.77,-506.3"/>
<polygon fill="black" stroke="black" points="1536.22,-503.11 1525.74,-501.52 1532.94,-509.3 1536.22,-503.11"/>
</g>
<!-- res3&#45;&gt;ffn1_3_10 -->
<g id="edge182" class="edge">
<title>res3&#45;&gt;ffn1_3_10</title>
<path fill="none" stroke="black" d="M1863.94,-610.64C1730.89,-602.63 1535.36,-582.59 1372,-532.45 1351.25,-526.08 1329.67,-516.11 1311.06,-506.3"/>
<polygon fill="black" stroke="black" points="1312.65,-503.18 1302.18,-501.51 1309.33,-509.34 1312.65,-503.18"/>
</g>
<!-- res3&#45;&gt;ffn1_3_11 -->
<g id="edge186" class="edge">
<title>res3&#45;&gt;ffn1_3_11</title>
<path fill="none" stroke="black" d="M1861.82,-607.7C1648.65,-595.34 1279.62,-569.44 1150,-532.45 1128.55,-526.33 1106.27,-516.24 1087.17,-506.28"/>
<polygon fill="black" stroke="black" points="1088.82,-503.19 1078.35,-501.56 1085.52,-509.36 1088.82,-503.19"/>
</g>
<!-- res3&#45;&gt;ffn1_3_12 -->
<g id="edge190" class="edge">
<title>res3&#45;&gt;ffn1_3_12</title>
<path fill="none" stroke="black" d="M1864.63,-611.36C1606.47,-602.48 1098.46,-579.53 926,-532.45 904.14,-526.49 881.47,-516.32 862.09,-506.25"/>
<polygon fill="black" stroke="black" points="863.62,-503.09 853.15,-501.48 860.33,-509.27 863.62,-503.09"/>
</g>
<!-- res3&#45;&gt;ffn1_3_13 -->
<g id="edge194" class="edge">
<title>res3&#45;&gt;ffn1_3_13</title>
<path fill="none" stroke="black" d="M1866.12,-613.7C1567.47,-608.07 916.92,-589.49 701,-532.45 678.84,-526.6 655.87,-516.4 636.27,-506.27"/>
<polygon fill="black" stroke="black" points="637.71,-503.07 627.23,-501.48 634.43,-509.25 637.71,-503.07"/>
</g>
<!-- res3&#45;&gt;ffn1_3_14 -->
<g id="edge198" class="edge">
<title>res3&#45;&gt;ffn1_3_14</title>
<path fill="none" stroke="black" d="M1867.61,-615.39C1532.07,-612.9 735.02,-599.86 475,-532.45 452.82,-526.7 429.84,-516.53 410.25,-506.38"/>
<polygon fill="black" stroke="black" points="411.68,-503.18 401.21,-501.58 408.4,-509.36 411.68,-503.18"/>
</g>
<!-- res3&#45;&gt;ffn1_3_15 -->
<g id="edge202" class="edge">
<title>res3&#45;&gt;ffn1_3_15</title>
<path fill="none" stroke="black" d="M1868.23,-616.63C1498.21,-617.05 553.3,-610.22 249,-532.45 226.7,-526.76 203.62,-516.53 183.98,-506.33"/>
<polygon fill="black" stroke="black" points="185.39,-503.12 174.92,-501.51 182.1,-509.3 185.39,-503.12"/>
</g>
<!-- res3&#45;&gt;res_ffn3 -->
<g id="edge207" class="edge">
<title>res3&#45;&gt;res_ffn3</title>
<path fill="none" stroke="black" d="M2019,-563.82C2019,-555.53 2019,-546.88 2019,-538.38"/>
<polygon fill="black" stroke="black" points="2022.5,-538.13 2019,-528.13 2015.5,-538.13 2022.5,-538.13"/>
</g>
<!-- gather -->
<g id="node161" class="node">
<title>gather</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2208.28,-374.95 1932.63,-374.95 1861.72,-268.95 2137.37,-268.95 2208.28,-374.95"/>
<text text-anchor="middle" x="2035" y="-333.25" font-family="Times,serif" font-size="14.00">Gather from Pipeline</text>
<text text-anchor="middle" x="2035" y="-318.25" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="2035" y="-303.25" font-family="Times,serif" font-size="14.00">GPU: 8&#45;15  Host</text>
</g>
<!-- res_ffn3&#45;&gt;gather -->
<g id="edge208" class="edge">
<title>res_ffn3&#45;&gt;gather</title>
<path fill="none" stroke="black" d="M2024.55,-421.56C2025.8,-409.79 2027.14,-397.18 2028.42,-385.04"/>
<polygon fill="black" stroke="black" points="2031.91,-385.31 2029.49,-374.99 2024.95,-384.57 2031.91,-385.31"/>
</g>
<!-- output -->
<g id="node162" class="node">
<title>output</title>
<polygon fill="lightyellow" stroke="lightyellow" points="2183.01,-232.95 1947.56,-232.95 1886.99,-126.95 2122.44,-126.95 2183.01,-232.95"/>
<text text-anchor="middle" x="2035" y="-191.25" font-family="Times,serif" font-size="14.00">Output</text>
<text text-anchor="middle" x="2035" y="-176.25" font-family="Times,serif" font-size="14.00">X: [B, L, d_model]</text>
<text text-anchor="middle" x="2035" y="-161.25" font-family="Times,serif" font-size="14.00">GPU: Host</text>
</g>
<!-- gather&#45;&gt;output -->
<g id="edge209" class="edge">
<title>gather&#45;&gt;output</title>
<path fill="none" stroke="black" d="M2035,-268.82C2035,-260.53 2035,-251.88 2035,-243.38"/>
<polygon fill="black" stroke="black" points="2038.5,-243.13 2035,-233.13 2031.5,-243.13 2038.5,-243.13"/>
</g>
</g>
</svg>
